- **Root cause of vulnerability**: The application fails to properly restrict database access. User access privileges are determined by the `USER_CODE` field.
- **Weaknesses/vulnerabilities present**: Authorization Bypass Through User-Controlled Key (CWE-639). The application uses the `USER_CODE` field to determine privileges, and a low-privileged user can modify this value to match that of a privileged user.
- **Impact of exploitation**: A remote, authenticated, low-privileged user can gain full access to privileged database functions, allowing them to submit specially crafted SQL queries, potentially leading to complete compromise of the application database.
- **Attack vectors**: The vulnerability can be exploited by modifying the `USER_CODE` field to match a privileged user's value and then submitting SQL queries.
- **Required attacker capabilities/position**: The attacker needs to be a valid authenticated user of the application.