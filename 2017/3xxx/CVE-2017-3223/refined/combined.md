=== Content from www.kb.cert.org_fdf36307_20250125_084339.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#547255

## Dahua IP cameras Sonia web interface is vulnerable to stack buffer overflow

#### Vulnerability Note VU#547255

Original Release Date: 2017-07-18 | Last Revised: 2017-07-26

---

### Overview

Dahua IP camera products using firmware versions prior to V2.400.0000.14.R.20170713 include a version of the Sonia web interface that may be vulnerable to a stack buffer overflow.

### Description

| [**CWE-121**](http://cwe.mitre.org/data/definitions/121.html)**: Stack-based Buffer Overflow -** CVE-2017-3223  Dahua IP camera products include an application known as Sonia (/usr/bin/sonia) that provides the web interface and other services for controlling the IP camera remotely.Versions of Sonia included in firmware versions prior to DH\_IPC-Consumer-Zi-Themis\_Eng\_P\_V2.408.0000.11.R.20170621 do not validate input data length for the 'password' field of the web interface. A remote, unauthenticated attacker may submit a crafted POST request to the IP camera's Sonia web interface that may lead to out-of-bounds memory operations and loss of availability or remote code execution.The issue was originally identified by the researcher in firmware version DH\_IPC-HX1X2X-Themis\_EngSpnFrn\_N\_V2.400.0000.30.R.20160803. |
| --- |

### Impact

| A remote, unauthenticated attacker may submit a crafted POST request to the IP camera's Sonia web interface that may lead to out-of-bounds memory operations and loss of availability or remote code execution. |
| --- |

### Solution

| **Apply update**Dahua has [released firmware](http://www.dahuasecurity.com/firmware_161.html) version DH\_IPC-ACK-Themis\_Eng\_P\_V2.400.0000.14.R.20170713.bin to address this issue. All affected users should update their firmware as soon as possible. If you have any questions, you may contact cybersecurity@dahuatech.com. |
| --- |

### Vendor Information

547255
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23547255/) to view vendors.**
### [Dahua Security](#GWAN-AMVUL5) Affected

Notified:  May 31, 2017  Updated: July 17, 2017

**Statement Date:   July 17, 2017**

### Status

Affected

### Vendor Statement

Dahua recommends all affected users to update the firmware of their device to new version.
You can download version from <http://www.dahuasecurity.com/>
If you have any questions, you can contact cybersecurity@dahuatech.com

### Vendor Information

Dahua has provided an updated firmware version DH\_IPC-ACK-Themis\_Eng\_P\_V2.400.0000.14.R.20170713.bin to address this issue.

### Vendor References

* <http://www.dahuasecurity.com/firmware_161.html>

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 10 | AV:N/AC:L/Au:N/C:C/I:C/A:C |
| Temporal | 7.8 | E:POC/RL:OF/RC:C |
| Environmental | 5.9 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://www.dahuasecurity.com/firmware_161.html>
* <http://cwe.mitre.org/data/definitions/121.html>
### Acknowledgements

Thanks to Ilya Smith of Positive Technologies for reporting this vulnerability.

This document was written by Garret Wassermann.

### Other Information

| **CVE IDs:** | [CVE-2017-3223](http://web.nvd.nist.gov/vuln/detail/CVE-2017-3223) |
| --- | --- |
| **Date Public:** | 2017-07-18 |
| **Date First Published:** | 2017-07-18 |
| **Date Last Updated:** | 2017-07-26 16:18 UTC |
| **Document Revision:** | 43 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


