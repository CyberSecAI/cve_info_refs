=== Content from github.com_d49a3c3c_20250124_225218.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPiwigo%2FPiwigo%2Fissues%2F705)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPiwigo%2FPiwigo%2Fissues%2F705)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Piwigo%2FPiwigo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Piwigo](/Piwigo)
/
**[Piwigo](/Piwigo/Piwigo)**
Public

* [Notifications](/login?return_to=%2FPiwigo%2FPiwigo) You must be signed in to change notification settings
* [Fork
  449](/login?return_to=%2FPiwigo%2FPiwigo)
* [Star
   3.3k](/login?return_to=%2FPiwigo%2FPiwigo)

* [Code](/Piwigo/Piwigo)
* [Issues
  625](/Piwigo/Piwigo/issues)
* [Pull requests
  88](/Piwigo/Piwigo/pulls)
* [Actions](/Piwigo/Piwigo/actions)
* [Projects
  0](/Piwigo/Piwigo/projects)
* [Wiki](/Piwigo/Piwigo/wiki)
* [Security](/Piwigo/Piwigo/security)
* [Insights](/Piwigo/Piwigo/pulse)

Additional navigation options

* [Code](/Piwigo/Piwigo)
* [Issues](/Piwigo/Piwigo/issues)
* [Pull requests](/Piwigo/Piwigo/pulls)
* [Actions](/Piwigo/Piwigo/actions)
* [Projects](/Piwigo/Piwigo/projects)
* [Wiki](/Piwigo/Piwigo/wiki)
* [Security](/Piwigo/Piwigo/security)
* [Insights](/Piwigo/Piwigo/pulse)

# user list backend, check input parameter #705

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[user list backend, check input parameter](#top)#705Copy linkAssignees [![plegall](https://avatars.githubusercontent.com/u/9326959?s=64&u=3227d666e9296ceba7214e61bc163791e11a9742&v=4)](/plegall)Labels[Section: Security](https://github.com/Piwigo/Piwigo/issues?q=state%3Aopen%20label%3A%22Section%3A%20Security%22)[Type: Enhancement](https://github.com/Piwigo/Piwigo/issues?q=state%3Aopen%20label%3A%22Type%3A%20Enhancement%22)Milestone[2.9.1](https://github.com/Piwigo/Piwigo/milestone/145)[![@plegall](https://avatars.githubusercontent.com/u/9326959?u=3227d666e9296ceba7214e61bc163791e11a9742&v=4&size=80)](/plegall)
## Description

[![@plegall](https://avatars.githubusercontent.com/u/9326959?u=3227d666e9296ceba7214e61bc163791e11a9742&v=4&size=48)](/plegall)[plegall](https://github.com/plegall)opened [on Jun 13, 2017](https://github.com/Piwigo/Piwigo/issues/705#issue-235508403)

To avoid any possible security issue, let's check the input parameters

Reported by Eric Fernando Castañeda Nazario

## Metadata

### Assignees

* [![@plegall](https://avatars.githubusercontent.com/u/9326959?s=64&u=3227d666e9296ceba7214e61bc163791e11a9742&v=4)plegall](/plegall)
### Labels

[Section: Security](https://github.com/Piwigo/Piwigo/issues?q=state%3Aopen%20label%3A%22Section%3A%20Security%22)[Type: Enhancement](https://github.com/Piwigo/Piwigo/issues?q=state%3Aopen%20label%3A%22Type%3A%20Enhancement%22)
### Type

No type
### Projects

No projects
### Milestone

* [2.9.1](https://github.com/Piwigo/Piwigo/milestone/145)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.wizlynxgroup.com_75597d3d_20250124_225219.html ===


[![wizlynx group | IT Security Services](/content/images/logo-nav.png)](/ch/de/)

[Contact Us](../../contact)

# Security Research & Advisories

### SQL Injection in Piwigo

| Vendor |  |
| --- | --- |
| Product | Piwigo |
| Affected Version(s) | 2.9.0 probably prior |
| Tested Version(s) | 2.9.0 |
| Vulnerability Discovery | May 29, 2017 |
| Vendor Notification | May 29, 2017 |
| Advisory Publication | June 2, 2017 [without technical details] |
| Vendor Acknowledgment | June 16, 2017 |
| Vendor Fix | June 14, 2017 |
| Public Disclosure | June 15, 2017 |
| Latest Modification | June 15, 2017 |
| CVE Identifier(s) | [CVE-2017-9463](https://nvd.nist.gov/vuln/detail/CVE-2017-9463) |
| Product Description | Piwigo is a full featured open source photo gallery for the web, built and supported by an active community of users and developers, make it easy and faster to deploy a photo gallery In just seconds. |
| Credits | Eric CastaÃ±eda, Security Researcher & Penetration Tester @wizlynx group |

## **Vulnerability Details**

| **SQL Injection** | | | |
| --- | --- | --- | --- |
| **Severity**: **Medium** | **CVSS Score**: 4.7 | **CWE-ID**: [**CWE-89**](https://cwe.mitre.org/data/definitions/89) | **Status**: Fixed |
| **Vulnerability Description** | | | |
| The application Piwigo is affected by a SQL injection vulnerability affecting version 2.9.0 and possible priors. These vulnerabilities could allow remote authenticated attackers to obtain information in the context of user used by application to retrieve data from database. | | | |
| **CVSS Base Score** | | | |
| **Attack Vector** | Network | **Scope** | Changed |
| **Attack Complexity** | Low | **Confidentiality Impact** | Low |
| **Privileges Required** | High | **Integrity Impact** | Low |
| **User Interaction** | None | **Availability Impact** | Low |

## **Description**

The Piwigo has a Blind time based SQL injection vulnerability due to lack of input validation on user list page, being possible to retrieve information like user name and database name through SQL sentences appended to iDisplayStart parameter.

### Example #1 SQL injection

**To replicate this issue an administrator level user is required.** On Piwigo application we should access to User List menu and retrieve some users, this show a user list which contain username, email address and level permissions. Through this feature is possible to retrieve some information from database.

The affecter URL is http://localhost/piwigo/admin/user\_list\_backend.php and the following data is sent via POST request to above URL:
sEcho=1&iColumns=7&sColumns=,,,,,,&i**DisplayStart=0**&iDisplayLength=10&mDataProp\_0=0&sSearch\_0=&bRegex\_0=false&bSearchable\_0=true&bSortable\_0=true&mDataProp\_1=1&sSearch\_1=&bRegex\_1=false&bSearchable\_1=true&bSortable\_1=true&mDataProp\_2=2&sSearch\_2=&bRegex\_2=false&bSearchable\_2=true&bSortable\_2=true&mDataProp\_3=3&sSearch\_3=&bRegex\_3=false&bSearchable\_3=true&bSortable\_3=true&mDataProp\_4=4&sSearch\_4=&bRegex\_4=false&bSearchable\_4=true&bSortable\_4=true&mDataProp\_5=5&sSearch\_5=&bRegex\_5=false&bSearchable\_5=true&bSortable\_5=true&mDataProp\_6=6&sSearch\_6=&bRegex\_6=false&bSearchable\_6=true&bSortable\_6=true&sSearch=&bRegex=false&iSortCol\_0=0&sSortDir\_0=&iSortingCols=1

Some parameters are not mandatory so an alternative post data can be use instead
sEcho=1&iColumns=7&sColumns=,,,,,,&iDisplayStart=0&iDisplayLength=10&sSearch=&iSortCol\_0=0&iSortingCols=0

[![](../../content/images/vuln/piwigo_sql_1.png)](../../content/images/vuln/piwigo_sql_1.png)

The content is retrieved from http://localhost/piwigo/admin/user\_list\_backend.php which is a webservice that return information via JSON

The following image shows a normal request and response

[![](../../content/images/vuln/piwigo_sql_2.png)](../../content/images/vuln/piwigo_sql_2.png)

If a single quote is passed as value on iDisplayStart parameter a MySQL syntax error is showed.

[![](../../content/images/vuln/piwigo_sql_3.png)](../../content/images/vuln/piwigo_sql_3.png)

the following screenshot shows the retrieval of the databaseâs name by automating the exploitation of the SQL injection via SQLmap:

[![](../../content/images/vuln/piwigo_sql_4.png)](../../content/images/vuln/piwigo_sql_4.png)

## **References**

* <https://github.com/Piwigo/Piwigo/issues/705>
* <https://github.com/Piwigo/Piwigo/commit/42920897ce927c236728d387f61bf03d117109a2>

[Top](#0)

![wizlynx group | IT Security Services](/content/images/WhiteWithRed.png)

wizlynx has not only built a solid foundation of information security, quality and project management know-how, but our associates are known for their ability to apply the right soft skills at the right time to best serve our customers. We make it a point to understand the infrastructure, needs and challenges of our customers, which enables us to deliver fast, effective and high quality results. It is our belief that this level of understanding can only be obtained with the most capable and experienced resources. Reach out to our associates at any time through our interactive competence centers to draw upon our knowledge of processes, procedures, guidelines and tools. Youâll be able to see, firsthand, the value our team will add to your organization.

---

---

©2024 wizlynx group - All Rights Reserved

* [Terms of Use](/terms-of-use)
* [Privacy](/privacy)



=== Content from github.com_7ef7ee1d_20250124_225214.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPiwigo%2FPiwigo%2Fcommit%2F42920897ce927c236728d387f61bf03d117109a2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPiwigo%2FPiwigo%2Fcommit%2F42920897ce927c236728d387f61bf03d117109a2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=Piwigo%2FPiwigo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Piwigo](/Piwigo)
/
**[Piwigo](/Piwigo/Piwigo)**
Public

* [Notifications](/login?return_to=%2FPiwigo%2FPiwigo) You must be signed in to change notification settings
* [Fork
  449](/login?return_to=%2FPiwigo%2FPiwigo)
* [Star
   3.3k](/login?return_to=%2FPiwigo%2FPiwigo)

* [Code](/Piwigo/Piwigo)
* [Issues
  625](/Piwigo/Piwigo/issues)
* [Pull requests
  88](/Piwigo/Piwigo/pulls)
* [Actions](/Piwigo/Piwigo/actions)
* [Projects
  0](/Piwigo/Piwigo/projects)
* [Wiki](/Piwigo/Piwigo/wiki)
* [Security](/Piwigo/Piwigo/security)
* [Insights](/Piwigo/Piwigo/pulse)

Additional navigation options

* [Code](/Piwigo/Piwigo)
* [Issues](/Piwigo/Piwigo/issues)
* [Pull requests](/Piwigo/Piwigo/pulls)
* [Actions](/Piwigo/Piwigo/actions)
* [Projects](/Piwigo/Piwigo/projects)
* [Wiki](/Piwigo/Piwigo/wiki)
* [Security](/Piwigo/Piwigo/security)
* [Insights](/Piwigo/Piwigo/pulse)

## Commit

[Permalink](/Piwigo/Piwigo/commit/42920897ce927c236728d387f61bf03d117109a2)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

(cp [6ce14fc](https://github.com/Piwigo/Piwigo/commit/6ce14fc95810c4bf8e1b017a2c34876c148daae6)) fixes [#705](https://github.com/Piwigo/Piwigo/issues/705), check user\_list\_backend.php input params

[Browse files](/Piwigo/Piwigo/tree/42920897ce927c236728d387f61bf03d117109a2)
Browse the repository at this point in the history

* Loading branch information

[![@plegall](https://avatars.githubusercontent.com/u/9326959?s=40&v=4)](/plegall)

[plegall](/Piwigo/Piwigo/commits?author=plegall "View all commits by plegall")
committed
Jun 13, 2017

1 parent
[10700c8](/Piwigo/Piwigo/commit/10700c8739ce212ffb23f173aebd1d32d6714f84)

commit 4292089

Showing
**1 changed file**
with
**4 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

5 changes: 4 additions & 1 deletion

5
[admin/user\_list\_backend.php](#diff-26da53f7036299953d06f28adf23153570c064e8bf6f8196d97221426e34b03e "admin/user_list_backend.php")

Show comments

[View file](/Piwigo/Piwigo/blob/42920897ce927c236728d387f61bf03d117109a2/admin/user_list_backend.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -27,7 +27,10 @@ |
|  |  | include\_once(PHPWG\_ROOT\_PATH.'include/common.inc.php'); |
|  |  |  |
|  |  | check\_status(ACCESS\_ADMINISTRATOR); |
|  |  |  |
|  |  |  |
|  |  | check\_input\_parameter('iDisplayStart', $\_REQUEST, false, PATTERN\_ID); |
|  |  | check\_input\_parameter('iDisplayLength', $\_REQUEST, false, PATTERN\_ID); |
|  |  |  |
|  |  | /\* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* |
|  |  | \* Easy set variables |
|  |  | \*/ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4292089`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPiwigo%2FPiwigo%2Fcommit%2F42920897ce927c236728d387f61bf03d117109a2) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


