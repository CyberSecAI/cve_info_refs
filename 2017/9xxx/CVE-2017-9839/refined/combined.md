=== Content from www.wizlynxgroup.com_55f2feff_20250124_205051.html ===


[![wizlynx group | IT Security Services](/content/images/logo-nav.png)](/ch/de/)

[Contact Us](../../contact)

# Security Research & Advisories

### Multiple SQL Injection Vulnerabilities in Dolibarr

| Vendor |  |
| --- | --- |
| Product | Dolibarr |
| Affected Version(s) | 5.0.3 probably prior |
| Tested Version(s) | 5.0.3 |
| Vulnerability Discovery | June 3, 2017 |
| Vendor Notification | June 6, 2017 |
| Advisory Publication | June 7, 2017 [without technical details] |
| Vendor Acknowledgment | June 18, 2017 |
| Vendor Fix | Partially fixed as of 5.0.4 |
| Public Disclosure | March 12, 2017 |
| Latest Modification | March 12, 2017 |
| CVE Identifier(s) | [CVE-2017-9839](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9839) |
| Product Description | Dolibarr ERP/CRM is an open source, free software package for small and medium companies, foundations or freelancers. It includes different features for enterprise resource planning (ERP) and customer relationship management (CRM) but also other features for different activities. |
| Credits | Yann ChalenÃ§on, Security Researcher & Penetration Tester @wizlynx group |

## **Vulnerability Details**

| **Multiple SQL Injection Vulnerabilities in Dolibarr** | | | |
| --- | --- | --- | --- |
| **Severity**: **Medium** | **CVSS Score**: 6.3 | **CWE-ID**: [**CWE-89**](https://cwe.mitre.org/data/definitions/89) | **Status**: Partial Fix |
| **Vulnerability Description** | | | |
| The application Dolibarr is affected by multiple SQL injection vulnerabilities affecting version 5.0.3 and prior. These vulnerabilities could allow remote authenticated attackers to inject arbitrary SQL code. | | | |
| **CVSS Base Score** | | | |
| **Attack Vector** | Network | **Scope** | Unchanged |
| **Attack Complexity** | Low | **Confidentiality Impact** | Low |
| **Privileges Required** | Low | **Integrity Impact** | Low |
| **User Interaction** | None | **Availability Impact** | Low |

## **Description**

The Dolibarr web application version 5.0.3 is vulnerable to SQL injection in multiple places. Exploiting this vulnerability leads to an authenticated user being able to inject arbitrary SQL statements, e.g. to dump the entire database.

In addition, the filter in use by Dolibarr to prevent SQL injections can be easily bypassed by URL encoding SQL payloads. This can as well be automated with SQLmap and tamper script âcharencodeâ.

The following screenshot shows the request when listing commercial proposals. To demonstrate the SQL injection vulnerability, we have inputted a single quote character in the viewstatut parameter. This resulted in a SQL error as displayed on the right side of the screenshot:

[![](../../content/images/vuln/dolibarr_10.png)](../../content/images/vuln/dolibarr_10.png)

To demonstrate further the SQL injection, we have inserted âSLEEPâ commands which if successfully ran by the database should delay response from the web server.
The first screenshot shows the baseline request without the SLEEP command. As you can see on the bottom right corner, the response is returned in 56 milliseconds

[![](../../content/images/vuln/dolibarr_11.png)](../../content/images/vuln/dolibarr_11.png)

We have then added â-SLEEP(1)â and response was returned in 4057 milliseconds

[![](../../content/images/vuln/dolibarr_12.png)](../../content/images/vuln/dolibarr_12.png)

We have then added â-SLEEP(2)â and response was returned in 8059 milliseconds

### **Other affected pages & parameters:**

**/htdocs/product/stats/card.php #type**

/dolibarr/htdocs/product/stats/card.php?id=all&leftmenu=stats&type=[SQL STATEMENT HERE]

**/dolibarr/htdocs/comm/propal/list.php #propal\_statut**

POST /dolibarr/htdocs/comm/propal/list.php HTTP/1.1

Host: 172.16.206.134

User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:45.0) Gecko/20100101 Firefox/45.0

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8

Accept-Language: en-US,en;q=0.5

DNT: 1

Referer: http://172.16.206.134/dolibarr/htdocs/comm/propal/list.php?leftmenu=propals

Cookie: DOLSESSID\_8c9db71eb2fd5bc470fdb2f0d0752f5d=9jsjp4ar13eqldf8o0mt0b0cl3

Connection: close

Content-Type: application/x-www-form-urlencoded

Content-Length: 444

token=c6e90d6743de455a542e1c7f62141eb4&formfilteraction=list&action=list&sortfield=p.ref&sortorder=DESC&massaction=0&confirmmassaction=Confirm&limit=25&search\_sale=0&search\_user=-1&selectedfields=p.ref%2Cp.ref\_client%2Cs.nom%2Cs.town%2Cs.zip%2Cp.date%2Cp.fin\_validite%2Cp.total\_ht%2Cu.login%2Cp.fk\_statut%2C&search\_ref=1&search\_refcustomer=&search\_societe=&search\_town=&search\_zip=&month=&year=&search\_montant\_ht=&search\_login=&propal\_statut=[SQL STATEMENT HERE]

**Note:** Most vulnerabilities have been fixed in Dolibarr version 5.0.4. However, the viewstatut parameter isstill vulnerable as of 7.0.0. As for parameter propal\_statut, it has been renamed to search\_statut in version 7.0.0 and is still vulnerable.

[Top](#0)

![wizlynx group | IT Security Services](/content/images/WhiteWithRed.png)

wizlynx has not only built a solid foundation of information security, quality and project management know-how, but our associates are known for their ability to apply the right soft skills at the right time to best serve our customers. We make it a point to understand the infrastructure, needs and challenges of our customers, which enables us to deliver fast, effective and high quality results. It is our belief that this level of understanding can only be obtained with the most capable and experienced resources. Reach out to our associates at any time through our interactive competence centers to draw upon our knowledge of processes, procedures, guidelines and tools. Youâll be able to see, firsthand, the value our team will add to your organization.

---

---

©2024 wizlynx group - All Rights Reserved

* [Terms of Use](/terms-of-use)
* [Privacy](/privacy)


