=== Content from github.com_4617ff9a_20250124_174119.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBastilleResearch%2FCableTap%2Fblob%2Fmaster%2Fdoc%2Fadvisories%2Fbastille-33.cross-site-request-forgery.txt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBastilleResearch%2FCableTap%2Fblob%2Fmaster%2Fdoc%2Fadvisories%2Fbastille-33.cross-site-request-forgery.txt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=BastilleResearch%2FCableTap)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[BastilleResearch](/BastilleResearch)
/
**[CableTap](/BastilleResearch/CableTap)**
Public

* [Notifications](/login?return_to=%2FBastilleResearch%2FCableTap) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2FBastilleResearch%2FCableTap)
* [Star
   78](/login?return_to=%2FBastilleResearch%2FCableTap)

* [Code](/BastilleResearch/CableTap)
* [Issues
  0](/BastilleResearch/CableTap/issues)
* [Pull requests
  0](/BastilleResearch/CableTap/pulls)
* [Actions](/BastilleResearch/CableTap/actions)
* [Projects
  0](/BastilleResearch/CableTap/projects)
* [Security](/BastilleResearch/CableTap/security)
* [Insights](/BastilleResearch/CableTap/pulse)

Additional navigation options

* [Code](/BastilleResearch/CableTap)
* [Issues](/BastilleResearch/CableTap/issues)
* [Pull requests](/BastilleResearch/CableTap/pulls)
* [Actions](/BastilleResearch/CableTap/actions)
* [Projects](/BastilleResearch/CableTap/projects)
* [Security](/BastilleResearch/CableTap/security)
* [Insights](/BastilleResearch/CableTap/pulse)

## Files

 master
## Breadcrumbs

1. [CableTap](/BastilleResearch/CableTap/tree/master)
2. /[doc](/BastilleResearch/CableTap/tree/master/doc)
3. /[advisories](/BastilleResearch/CableTap/tree/master/doc/advisories)
/
# bastille-33.cross-site-request-forgery.txt

Copy path Blame  Blame
## Latest commit

## History

[History](/BastilleResearch/CableTap/commits/master/doc/advisories/bastille-33.cross-site-request-forgery.txt)82 lines (40 loc) · 4 KB master
## Breadcrumbs

1. [CableTap](/BastilleResearch/CableTap/tree/master)
2. /[doc](/BastilleResearch/CableTap/tree/master/doc)
3. /[advisories](/BastilleResearch/CableTap/tree/master/doc/advisories)
/
# bastille-33.cross-site-request-forgery.txt

Top
## File metadata and controls

* Code
* Blame

82 lines (40 loc) · 4 KB[Raw](https://github.com/BastilleResearch/CableTap/raw/refs/heads/master/doc/advisories/bastille-33.cross-site-request-forgery.txt)12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182Bastille Tracking Number 33CVE-2017-9489CVE-2017-9490
Bastille Vulnerability Label: Cross-site Request ForgeryBastille Provided Severity: High
Overview
Web applications that are vulnerable to cross-site request forgery (CSRF) allow for malicious third-parties to submit forged HTTP requests on the behalf of application users. These requests can invoke any of the functionality exposed by the application that the affected user has permission to invoke. In the case of the Comcast modems identified in this disclosure, the presence of CSRF vulnerabilities enables attackers to log in to the affected modems with default credentials (if the user is not already authenticated) and administer users' home modems.
Affected Platforms
Cisco DPC3939B, firmware version dpc3939b-v303r204217-150321a-CMCSTArris TG1682G, eMTA&DOCSIS version 10.0.132.SIP.PC20.CT, software version TG1682\_2.2p7s2\_PROD\_sey
Proof-of-Concept
To observe the lack of CSRF protections, follow the steps below:
(1) Install Burp Suite proxy (https://portswigger.net/burp/)
(2) Open a browser and navigate the browser to a login page of one of the affected modems (typically http://10.0.0.1/)
(3) Configure the browser to use Burp Suite as an HTTP proxy (http://www.lib.berkeley.edu/using-the-libraries/proxy-chrome-windows)
(4) In the browser, log in to the portal and navigate to any page that allows the user to administer components of the modem. Once at an administration page, make any number of modifications to the modem configuration and submit the page.
(5) In Burp Suite's Proxy tab, view the contents of the HTTP POST request that was submitted to the modem and observe that no references to CSRF tokens or other CSRF protections are present.
(6) Right-click on the HTTP POST request in Burp Suite and choose "Send to Repeater".
(7) Click on the "Repeater" tab at the top of the Burp Suite user interface.
(8) In the "Repeater" interface, the HTTP POST request will be seen on the left. For completeness, the following tests can be conducted to prove that no CSRF protections are present:
- Add an HTTP request header with "Origin: <anything>" and re-submit the HTTP request. Observe that the request is successful.- Modify the "Referer" HTTP request header to anything other than its default value and re-submit the HTTP request. Observe that the request is successful.
Additional guidance for testing for the presence of CSRF vulnerabilities can be found here:
https://www.owasp.org/index.php/Testing\_for\_CSRF\_(OTG-SESS-005)
Test Environment
Cisco DPC3939B, firmware version dpc3939b-v303r204217-150321a-CMCSTArris TG1682G, eMTA&DOCSIS version 10.0.132.SIP.PC20.CT, software version TG1682\_2.2p7s2\_PROD\_sey
Mitigation
Protecting against cross-site request forgery requires a mechanism that ensures that requests originating from a user's browser are intentionally submitted by the user. While there are more than one approaches to mitigating CSRF, the least cumbersome is the "Double Submit Cookie." This method requires two things:
(1) Set a random (unguessable) value in a cookie field that is returned to the user.
(2) Require that the cookie value is submitted alongside all forms sent by the user.
The cookie value should be placed into the protected forms through JavaScript prior to form submission. This approach makes it so that an attacker must have access to cookie values in the affected user's browser to forge requests on their behalf. The main way that an attacker would have access to these values is through cross-site scripting, which by definition is a CSRF bypass already, thereby effectively mitigating the CSRF exposure.
It should be noted that this mitigation pattern was observed to be in place and working in the most recent firmware build of the Comcast DPC3939 modem.
Additional details on this mitigation pattern can be found here:
https://www.owasp.org/index.php/Cross-Site\_Request\_Forgery\_(CSRF)\_Prevention\_Cheat\_Sheet#Double\_Submit\_Cookie
Recommended Remediation
N/A
Credits
Marc Newlin and Logan Lamb, BastilleChris Grayson, Web Sight.IO

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


