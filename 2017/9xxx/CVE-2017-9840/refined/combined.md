=== Content from www.wizlynxgroup.com_80db4a58_20250124_140626.html ===


[![wizlynx group | IT Security Services](/content/images/logo-nav.png)](/ch/de/)

[Contact Us](../../contact)

# Security Research & Advisories

### Unrestricted Upload of File with Dangerous Type in Dolibarr

| Vendor |  |
| --- | --- |
| Product | Dolibarr |
| Affected Version(s) | 5.0.3 probably prior |
| Tested Version(s) | 5.0.3 |
| Vulnerability Discovery | June 3, 2017 |
| Vendor Notification | June 6, 2017 |
| Advisory Publication | June 7, 2017 [without technical details] |
| Vendor Acknowledgment | June 6, 2017 |
| Vendor Fix | Fixed as of 5.0.4 |
| Public Disclosure | March 12, 2017 |
| Latest Modification | March 12, 2017 |
| CVE Identifier(s) | [CVE-2017-9840](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9840) |
| Product Description | Dolibarr ERP/CRM is an open source, free software package for small and medium companies, foundations or freelancers. It includes different features for enterprise resource planning (ERP) and customer relationship management (CRM) but also other features for different activities. |
| Credits | Yann ChalenÃ§on, Security Researcher & Penetration Tester @wizlynx group |

## **Vulnerability Details**

| **Unrestricted Upload of File with Dangerous Type** | | | |
| --- | --- | --- | --- |
| **Severity**: **High** | **CVSS Score**: 8.8 | **CWE-ID**: [**CWE-434**](https://cwe.mitre.org/data/definitions/434) | **Status**: Closed |
| **Vulnerability Description** | | | |
| The application Dolibarr 5.0.3 and prior allows low-privilege users to upload files of dangerous types which can result in arbitrary code execution within the context of the vulnerable application. | | | |
| **CVSS Base Score** | | | |
| **Attack Vector** | Network | **Scope** | Unchanged |
| **Attack Complexity** | Low | **Confidentiality Impact** | High |
| **Privileges Required** | Low | **Integrity Impact** | High |
| **User Interaction** | None | **Availability Impact** | High |

## **Description**

Dolibarr application allows low-privilege users to upload files. However, the application does not whitelist only certain type of files (e.g. PDF, JPG, PNG, DOCX, etc), instead, any type of files can be uploaded to the filesystem via the application.

When uploading a file with extension â.phpâ, the application automatically append the extension â.noexeâ. Unfortunately, this mechanism can be bypassed by editing the fileâs name after upload and removing the noexe extension as described in the screenshots below:

The following screenshot shows the upload of a PHP webshell:

[![](../../content/images/vuln/dolibarr_5.png)](../../content/images/vuln/dolibarr_5.png)

The following screenshot shows the upload was successful and as previously explained, the application added the ânoexeâ extension preventing the file from executing. However, the application allows us to modify the fileâs name by clicking in the edit button shown by the red arrow:

[![](../../content/images/vuln/dolibarr_6.png)](../../content/images/vuln/dolibarr_6.png)

We can now remove the â.noexeâ extension:

[![](../../content/images/vuln/dolibarr_7.png)](../../content/images/vuln/dolibarr_7.png)

Removing the extension was successful as shown in the screenshot below:

[![](../../content/images/vuln/dolibarr_8.png)](../../content/images/vuln/dolibarr_8.png)

We can now call the webshell and use it to run command on the web server:

[![](../../content/images/vuln/dolibarr_9.png)](../../content/images/vuln/dolibarr_9.png)

**Note:** This vulnerability has been fixed in version 5.0.4

[Top](#0)

![wizlynx group | IT Security Services](/content/images/WhiteWithRed.png)

wizlynx has not only built a solid foundation of information security, quality and project management know-how, but our associates are known for their ability to apply the right soft skills at the right time to best serve our customers. We make it a point to understand the infrastructure, needs and challenges of our customers, which enables us to deliver fast, effective and high quality results. It is our belief that this level of understanding can only be obtained with the most capable and experienced resources. Reach out to our associates at any time through our interactive competence centers to draw upon our knowledge of processes, procedures, guidelines and tools. Youâll be able to see, firsthand, the value our team will add to your organization.

---

---

©2024 wizlynx group - All Rights Reserved

* [Terms of Use](/terms-of-use)
* [Privacy](/privacy)


