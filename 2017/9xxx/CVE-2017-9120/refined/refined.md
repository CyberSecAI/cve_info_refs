Based on the provided information, here's an analysis of CVE-2017-9120:

**Root Cause of Vulnerability:**

The vulnerability stems from an integer overflow within the `mysqli_real_escape_string()` function in PHP. The function allocates memory based on the input string length multiplied by 2, however, when a very large string is passed as input to the function, the multiplication results in an integer overflow, leading to allocation of a small buffer. Subsequently the `mysql_real_escape_string` attempts to write more data than allocated which causes a crash.

**Weaknesses/Vulnerabilities Present:**

*   **Integer Overflow:** The core weakness is the lack of proper bounds checking when calculating the required buffer size, allowing for an integer overflow.
*   **Buffer Overflow:** The integer overflow leads to a heap buffer overflow, because the allocated buffer is smaller than required by `mysql_real_escape_string`.

**Impact of Exploitation:**

*   **Denial of Service (DoS):** The primary impact is a crash of the PHP process due to the segmentation fault caused by the heap buffer overflow.
*   **Potential for Remote Code Execution (RCE):** One of the bug reports indicates the potential to cause RCE but that is not explicitly stated in other sources

**Attack Vectors:**

*   **Crafted SQL Query:** The attack vector involves an attacker sending a specially crafted SQL query to a PHP application that utilizes the `mysqli_real_escape_string()` function.

**Required Attacker Capabilities/Position:**

*   **Ability to Inject Input:** An attacker must have the capability to inject arbitrary input that will be passed into the vulnerable `mysqli_real_escape_string()` function. Usually, this could be via a web application or a service that receives external input.
*   **No authentication required:** There is no mention that authentication is required

**Additional Information from the Provided Content:**

*   **Affected Versions:** PHP versions before 5.6.37, 7.0.x before 7.0.31, 7.1.x before 7.1.20, and 7.2.x before 7.2.8 are vulnerable.
*   **Red Hat's Response:** Red Hat has addressed this issue in various Red Hat Software Collections via RHSA-2019:2519.
*   **Upstream Fix:** The upstream fix was made available in the PHP source code via a commit on GitHub.
*   **NetApp Products:** The NetApp security advisory states that none of their products are affected by this vulnerability.
*   **Severity:** Red Hat rates this as a medium severity vulnerability.
*   **CVSS Score:** The provided CVSS score for this CVE is 5.3 (Medium).

This information provides a comprehensive view of the vulnerability, its root cause, impact, attack vectors, and necessary attacker capabilities, as well as information on how to patch the vulnerability.