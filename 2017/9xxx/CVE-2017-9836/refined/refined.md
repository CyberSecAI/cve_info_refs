The provided content describes a stored Cross-Site Scripting (XSS) vulnerability in Piwigo.

**Root cause of vulnerability:**
- The vulnerability lies in the `virtual_name` parameter within `admin.php` when creating a new album. User-supplied input is not properly sanitized or encoded before being stored and displayed.

**Weaknesses/vulnerabilities present:**
- Stored XSS: Malicious JavaScript code is injected through the `virtual_name` parameter, stored in the database, and executed when the album name is displayed in the application.
- Lack of input sanitization/encoding: The application fails to sanitize or encode the user-provided input for the `virtual_name` field before storing it in the database and rendering it on the page.

**Impact of exploitation:**
- Arbitrary JavaScript execution: Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of a victim's browser when they view the affected album name. This can lead to various malicious activities, such as:
    - Stealing user session cookies
    - Redirecting users to malicious websites
    - Modifying the content of the web page
    - Performing actions on behalf of the user

**Attack vectors:**
- The attacker injects the malicious JavaScript payload into the `virtual_name` parameter when creating a new album via the web interface.

**Required attacker capabilities/position:**
- The attacker needs to be logged in as an administrator to create a new album and inject the malicious payload.

**Payload:**
- The provided payload is `>[![](a)](a)` , which after base64 encoding becomes `Ij48aW1nIHNyYz1hIG9uZXJyb3I9Y29uZmlybSgxKT4=`. This payload injects an `<img>` tag with an `onerror` event handler that executes `confirm(1)`, demonstrating the XSS vulnerability.

This issue was discovered by topsec(lizhiqiang).