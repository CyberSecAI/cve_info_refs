- **Root cause of vulnerability:** The `/remotedownload.php` script uses user-supplied input (`$_POST['file']`) in the `file_get_contents()` and `get_headers()` functions without proper validation.
- **Weaknesses/vulnerabilities present:** Server-Side Request Forgery (SSRF). The application fetches content from a URL provided by the user, making it possible to target internal network resources.
- **Impact of exploitation:** An attacker can leverage the vulnerability to scan internal networks, potentially accessing sensitive resources, or perform actions on internal systems that would not be accessible from the outside.
- **Attack vectors:** The attacker sends a POST request to `/remotedownload.php` with a `file` parameter containing a URL pointing to an internal resource, such as `http://192.168.1.1/vulnerable-router.php`.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP POST requests to the server running the vulnerable script.