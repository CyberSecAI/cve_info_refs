The provided content describes a vulnerability in the libtiff library, specifically related to a memory allocation failure when processing crafted TIFF documents using JBIG compression. This issue is tracked in Bugzilla as bug 2707.

**Root cause of vulnerability:**
- A crafted TIFF document leads to a memory allocation failure in the `tif_jbig.c` file of the libtiff library.
- The root cause is within the `jbg_dec_in()` function of the underlying libjbig library, where excessive memory allocation isn't properly handled.

**Weaknesses/vulnerabilities present:**
- Improper handling of memory allocation within the JBIG decoding process.
- Potential for very large memory allocation requests.

**Impact of exploitation:**
- The program aborts due to memory allocation failure, leading to a denial-of-service.
- Application crash due to excessive memory allocation.

**Attack vectors:**
- A malicious attacker can craft a specially crafted TIFF file.
- The vulnerability is triggered by processing this malicious TIFF file with applications that utilize the libtiff library (e.g., `tiff2pdf`).

**Required attacker capabilities/position:**
- The attacker needs the ability to provide the specially crafted TIFF document to an application using the vulnerable libtiff library.
- No specific privileges are required as the vulnerability is triggered within the application's normal execution flow.

**Additional details:**
- The issue was initially reported against libtiff but was later identified to be a problem within the libjbig library itself.
- The issue was triggered by a specific TIFF file, and a minimal example of the problematic JBIG strip content has been provided.
- The provided debugging information includes ASan output, a gdb backtrace, and valgrind output, all indicating the memory allocation issue within the jbg_dec_in function.
- The problematic code is triggered when using the jbig.c codec of jbigkit.
- The issue may be related to CVE-2013-6369, which was fixed in JBIG-KIT 2.1, although the reporter confirms the issue is present in versions using jbigkit 2.1 and later.