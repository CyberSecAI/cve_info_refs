=== Content from www.twistlock.com_83b2f38f_20250125_062656.html ===

AI-SPM is generally available to all Prisma® Cloud users as we continue the rollout of Secure AI by Design product portfolio.
[Let's go!](/prisma/cloud/ai-spm)![x close icon to close mobile navigation]()[![prisma logo]()](/)![magnifying glass search icon to open search field]()

* [Why Prisma Cloud](/prisma/whyprisma)
* Products
* Solutions
* Environments
* [Product Tour](/prisma/cloud/explore-prisma-cloud)
* Resources

* [Request a Trial](/prisma/request-a-prisma-cloud-trial)
![Palo Alto Networks logo icon](/etc/clientlibs/clean/imgs/logo-default.svg)![white arrow icon pointing left to return to main Palo Alto Networks site](/etc/clientlibs/clean/imgs/arrow-right-white.svg)Search
All

* [Tech Docs](https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25)
Close search modal
Your browser does not support HTML5 video.
# See the Future of Real-Time Cloud Security

###### THE ULTIMATE CYBERSECURITY TRANSFORMATION EVENT

###### | 1-HOUR VIRTUAL SUMMIT | FEB 19-20

* [Count me in](https://start.paloaltonetworks.com/symphony2025)
Your browser does not support HTML5 video.
CODE TO CLOUDTM SECURITY
# The future of cloud security is Precision AI™.

Rollout of our new Secure AI by Design product portfolio has begun!

* [Learn more](/prisma/cloud/ai-spm)

* [AI-SPM is now generally available](https://www.paloaltonetworks.com/blog/prisma-cloud/ai-spm/)
## RECOMMENDED

[![CRN ](/content/dam/pan/en_US/images/prisma/cloud/2025_Cloud_100_180x180_with-bg.jpg)
### Recognized in the CRN Cloud 100 List 9 years in a row

See why](http://crn.com/cloud100)[![GigaOm report](/content/dam/pan/en_US/images/prisma/thumbnail-gigaom-report-supply-chain-security.png)
### Leader in Software Supply Chain Security

Read the report](https://start.paloaltonetworks.com/gigaom-radar-for-software-supply-chain-security-report.html)[![O’REILLY E-BOOK](/content/dam/pan/en_US/images/prisma/pc-ebook-cnapp-oreilly-hp-tile_180x180.jpg)
### Securing cloud-native applications: A comprehensive guide to CNAPPs

Get your guide](https://start.paloaltonetworks.com/oreilly-cnapp-cloud-security-foundations.html)[![GigaOm](/content/dam/pan/en_US/images/prisma/cloud/PC-GigaOn-CNAPP-24-hp-thumbnail-180x180.png)
### Cloud Security Leader in First-Ever CNAPP Report

Read the report](https://start.paloaltonetworks.com/gigaom-cnapp-report.html)[![Learn expert strategies in safeguarding your AI-powered apps.]()
### Understanding the AI Ecosystem: How to Secure AI-Powered Applications

Watch now](https://start.paloaltonetworks.com/securing-ai-applications-webinar.html)[![DSPM and DDR]()
### Securing the Data and AI Landscape with DSPM and DDR

Watch now](https://start.paloaltonetworks.com/securing-the-data-and-ai-landscape-with-dspm-and-ddrs-on-demand-webinar.html)[![Defending Your AI Future eBook]()
### Defending Your AI Future with Prisma Cloud

Read the eBook](https://start.paloaltonetworks.com/defending-your-ai-future-with-prisma-cloud.html)[![Cloud Copilot logo]()
### Meet the Prisma Cloud Copilot

Watch now](https://www.youtube.com/watch?v=r22ofg9R3j8)[![cloud security logo]()
### Measure the True Value of Cloud Security.

Get custom report](https://tei.forrester.com/go/paloalto/prismacloud/index.html?lang=en-us)Today’s ChallengesProduct PortfolioProven SuccessIndustry ValidationResourcesEngage with Us[Today’s Challenges](#challenges)[Product Portfolio](#portfolio)[Proven Success](#success)[Industry Validation](#industry)[Resources](#resources)[Engage with Us](#nextSteps)
Your browser does not support the video tag.
## AI is moving faster than teams can scale.

## Making your cloud complex and vulnerable.

## Secure it all with

Prisma Cloud

The Code to Cloud platform that
 secures apps from design to runtime.

![cortex default]()![cortex]()![xsoar]()![]()![xdr]()CODE TO CLOUD PLATFORM
## Secure every stage of the application lifecycle.

Prioritize and eliminate risks across code/build, infrastructure and
runtime.

CODE
## Ship secure code by design.

Developer-friendly code security fixes risks before they
reach runtime.

[IaC Security](/prisma/cloud/infrastructure-as-code-security)[CI/CD Security](/content/pan/en_US/prisma/cloud/ci-cd-security.html)[Secrets Security](/prisma/cloud/secrets-security)[Software Composition Analysis (SCA)](/prisma/cloud/software-composition-analysis) INFRASTRUCTURE
## Protect the application infrastructure.

Protect the entire stack and harden the cloud estate.

[Cloud Security Posture Management](/prisma/cloud/cloud-security-posture-management)[API
Visibility](/prisma/cloud/api-security)[Cloud Infrastructure Entitlement Management](/prisma/cloud/cloud-infrastructure-entitlement-mgmt)[Agentless Workload Scanning](/prisma/cloud/vulnerability-management)Runtime
## Block advanced attacks in real time.

Stop active attacks with in-line protection and

defense-in-depth.

[Threat Detection](/prisma/cloud/cloud-threat-detection)[Serverless Security](/prisma/cloud/serverless-security)[Host Security](/prisma/cloud/host-security)[Web Application and API Security](/prisma/cloud/web-application-API-security)dive deeper
## Take an up-close look at the Code to Cloud Platform powered by Precision AI.

PRISMA CLOUD
## Eliminate risk across the application lifecycle.

Prioritize and fix security flaws in code during software development, detect and block untrusted images before deployment and protect cloud apps from zero-day threats at runtime.

[![Eliminate risk across the application lifecycle]()](/content/dam/pan/en_US/images/cnapp-24/cloud_platform_dashboard.png)

![See more]()
### See more

Prisma® Cloud analyzes 1T events every 24 hours to deliver unparalleled visibility and keep security teams steps ahead of attacks.

![Stop more]()
### Stop more

Prisma Cloud utilizes Precision AI to detect 1.5M new attacks every day.

![Respond faster]()
### Respond faster

Prisma Cloud helps you immediately take the right actions with guided investigations and response.

[![Secure your AI-powered applications.]()](/content/dam/pan/en_US/images/cnapp-24/ai-spm_secure_ai_powered_applications.png)
AI SPM
## Secure your AI-powered applications.

Gain visibility and control of the data you use for training, the integrity of your AI models and the access to your deployed models. Identify and prioritize model risk, secure data across model resources and protect the AI application ecosystem.

[Learn more](/prisma/cloud/ai-spm)
AI-powered risk insights
## Rapidly prioritize risk with AI.

For every threat, quickly understanding what’s reachable and how best to fix it is paramount. Prisma Cloud employs AI-powered risk prioritization to analyze the blast radius from at-risk assets, enabling your teams to uncover complex risks with ease.

[![Rapidly prioritize risk with AI.]()](/content/dam/pan/en_US/images/cnapp-24/ai_powered_risk_insights_full.png)

Prisma Cloud COPILOT
## Don’t just ask. Act.

Eliminate the need for specialized expertise. Simply have a conversation and get the answers you need, fast. Prisma Cloud Copilot analyzes vast amounts of data from code to cloud to help you fix faster and prevent breaches — all with a single click.

[Meet the Prisma Cloud Copilot](https://bcove.video/3yirjPK) ![Atlantic Logo](/content/dam/pan/en_US/images/cnapp-24/global_atlantic_logo.png)![Fortune 500 Logo](/content/dam/pan/en_US/images/cnapp-24/fortune_500_logo.png)![Pexa Logo](/content/dam/pan/en_US/images/cnapp-24/pexa_logo_resize.png)![Atlantic Logo](/content/dam/pan/en_US/images/cnapp-24/global_atlantic_logo.png)![Fortune 500 Logo](/content/dam/pan/en_US/images/cnapp-24/fortune_500_logo.png)![Pexa Logo](/content/dam/pan/en_US/images/cnapp-24/pexa_logo_resize.png)
## See how customers are putting our trusted, AI-powered platform to work.

 [See all customer stories](/prisma/cloud/customer-stories)
### 01Global Atlantic Financial group

![Global Atlantic Financial group]()play video

This leading U.S. financial group used Prisma Cloud to consolidate visibility in their diverse multicloud environment.

[Read the full story](/customers/global-atlantic-financial-group-shifts-left-by-integrating-security-into-the-development-process)

“Prisma Cloud empowers our organization to seamlessly scale with an array of cloud-native capabilities to maintain a formidable cybersecurity posture.”

Chris Bogaards, AVP, IT Information Security

[Read the full story](/customers/global-atlantic-financial-group-shifts-left-by-integrating-security-into-the-development-process)
### 02Fortune 500

#### Securing the online retailer of the future with Prisma Cloud.

“Retail is a race, and we need to be more agile than our competitors. We needed an integrated, best-in-class solution for securing any type of cloud-native workload throughout the development lifecycle.”

European multichannel retailer

#### Securing the online retailer of the future with Prisma Cloud.

“Retail is a race, and we need to be more agile than our competitors. We needed an integrated, best-in-class solution for securing any type of cloud-native workload throughout the development lifecycle.”

European multichannel retailer

* 35%

  faster time to patch vulnerabilities
* 90%

  reduction in management overhead
* 0

  cloud breaches in runtime

[Read the full story](/customers/securing-the-online-retailer-of-the-future-with-prisma-cloud-compute) ![Fortune 500]()
### 03Pexa Icon

#### PEXA (Property Exchange Australia) relies on Prisma Cloud for timely threat detection and comprehensive coverage across their cloud platform.

#### PEXA (Property Exchange Australia) relies on Prisma Cloud for timely threat detection and comprehensive coverage across their cloud platform.

* 89%

  market reach
* 40

  upstream providers
* 4x

  increase in footprint since day one

[Read the full story](/customers/pexa-relies-on-prisma-cloud-for-timely-threat-detection-and-mitigation) ![Pexa Icon]()
## Industry recognized. Constantly innovating.

### 9x Cloud Security Leaderopen

#### GigaOm Logo GigaOm Radar for CNAPPs

#### Forrester Logo Forrester Wave: Cloud Workload Security

#### Frost & Sullivan Logo Frost & Sullivan CNAPP Radar

#### GigaOm Logo GigaOm Radar for Policy as Code

#### GigaOm Logo GigaOm Radar for Cloud Infrastructure Entitlement Management

#### GigaOm Logo GigaOm Radar for CSPM

#### GigaOm Logo GigaOm Radar for Container Security

#### GigaOm Logo GigaOm Radar for Data Security Posture Management

#### GigaOm Logo GigaOm Radar for Software Supply Chain Security

## Secure your network with trusted resources.

[View all](/resources)[ANALYST REPORT
### Forrester Total Economic Impact™ Study Of Prisma Cloud

![Forrester Total Economic Impact™ Study Of Prisma Cloud]()](/prisma/forrester-tei-study-prisma-cloud)[GUIDE
### Securing the Data Landscape with DSPM and DDR

![Securing the Data Landscape with DSPM and DDR]()](/resources/guides/dspm-ddr-big-guide)[WEBINAR
### Protecting Data and AI in 2024: What CISOs Need to Know

![Protecting Data and AI in 2024]()](https://start.paloaltonetworks.com/PrismaCloud-DSPM-on-demand-Webinar-Protecting-Data-and-AI-in-2024-What-CISOs-Need-to-Know.html)[RESEARCH REPORT
### The State of Cloud-Native Security Report

![The State of Cloud-Native Security Report]()](/state-of-cloud-native-security)PrevNext
## Ready to meet youwhere you are.

Executives
Specialists
Partners
Customers
![Ignite on tour logo]()
### Ignite on Tour

Meet decision makers, experts and practitioners for a day of hands-on learning, strategy building and networking.

[Attend our global roadshow](https://register.paloaltonetworks.com/igniteontour)![man coding]()
### Under Attack? We’re Here.

Unit 42® Incident Response explains the breach, works with you to contain and remedy it, and gets you back to business.

[Our experts are standing by](https://start.paloaltonetworks.com/contact-unit42.html)![Executives in board room]()
### Executive Briefing Center

Get a customized plan to see how our platforms, threat intelligence and expert services help you secure the way forward.

[Plan a collaborative discussion](/about-us/executive-briefing-program)![woman on laptop]()
### Product Demo Center

Visit the demo center to see solution experts walk you through our comprehensive cybersecurity portfolio in action.

[Take our products for a spin](/demos)![specialist]()
### Events Around the World

Browse all scheduled SecOps global events by cybersecurity technology interest, industry, region, use case and more.

[Join us in-person or online](https://events.paloaltonetworks.com/#security-automation-events)![get started]()
#### Future-proof your Security

Meet the trusted, proven and awarded products that make a positive difference in your security and business outcomes.

[Get to know our products](/get-started)![typing on laptop]()
### Partner Portal

Don’t try to tackle security challenges alone. Tap into the world’s most interoperable cloud and AI security platform.

[Log into our partner interface](/partners/nextwave-partner-portal-login)![man thinking]()
### Become a Partner

Be part of a global community of world-class innovators committed to making security breaches a thing of the past.

[Apply to our partner community](https://paloaltonetworks.my.site.com/NextWavePartnerProgram/s/partnerregistration?type=becomepartner)![technicians collaborating]()
### Managed Services Program

Provide managed security services that reduce cost, increase average revenue per customer and maximize market reach.

[Experience specialized tech](/partners/managed-security-services-provider-program)![Customer login]()
### Customer Login

Security, performance and ease of use: Three qualities our customers like most about our cybersecurity products.

[Sign in or create an account](https://support.paloaltonetworks.com/SupportAccount/MyAccount)![Education and training]()
### Education and Training

Expand your wisdom and skills with world-class training, certification and accreditation, including digital learning.

[Learn from security experts](/services/education)![Customer success tools]()
### Customer Success Tools

Guidance, oversight and 24/7 support from cybersecurity experts to help expedite your setup and initial configuration.

[Make the most of our resources](/services/customer-success)
## Get the latest news, invites to events, and threat alerts

Enter your email now to subscribe!Sign up

By submitting this form, you agree to our
[Terms of Use](/legal-notices/terms-of-use)
and acknowledge our
[Privacy Statement](/legal-notices/privacy).

Sign up
## Products and Services

* [Network Security Platform](/network-security)
* [CLOUD DELIVERED SECURITY SERVICES](/network-security/security-subscriptions)
* [Advanced Threat Prevention](/network-security/advanced-threat-prevention)
* [Advanced WildFire](/network-security/advanced-wildfire)
* [DNS Security](/network-security/advanced-dns-security)
* [Data Loss Prevention](/network-security/enterprise-data-loss-prevention)
* [IoT Security](/network-security/enterprise-iot-security)
* [Next-Generation Firewalls](/network-security/next-generation-firewall)
* [Hardware Firewalls](/network-security/next-generation-firewall-hardware)
* [Strata Cloud Manager](/network-security/strata-cloud-manager)
* [SECURE ACCESS SERVICE EDGE](/sase)
* [Prisma Access](/sase/access)
* [Prisma SD-WAN](/sase/sd-wan)
* [Autonomous Digital Experience Management](/sase/adem)
* [Cloud Access Security Broker](/sase/next-gen-casb)
* [Zero Trust Network Access](/sase/ztna)

* [Code to Cloud Platform](/prisma/whyprisma)
* [Prisma Cloud](/prisma/cloud)

* [AI-Driven Security Operations Platform](/cortex)
* [Cortex XDR](/cortex/cortex-xdr)
* [Cortex XSOAR](/cortex/cortex-xsoar)
* [Cortex Xpanse](/cortex/cortex-xpanse)
* [Cortex XSIAM](/cortex/cortex-xsiam)
* [External Attack Surface Protection](/cortex/cortex-xpanse/attack-surface-management)
* [Security Automation](/cortex/security-operations-automation)
* [Threat Prevention, Detection & Response](/cortex/detection-and-response)

* [Threat Intel and Incident Response Services](/unit42)
* [Proactive Assessments](/unit42/assess)
* [Incident Response](/unit42/respond)
* [Transform Your Security Strategy](/unit42/transform)
* [Discover Threat Intelligence](/unit42/threat-intelligence-partners)
## Company

* [About Us](/about-us)
* [Careers](https://jobs.paloaltonetworks.com/en/)
* [Contact Us](/company/contact-sales)
* [Corporate Responsiblity](/about-us/corporate-responsibility)
* [Customers](/customers)
* [Investor Relations](https://investors.paloaltonetworks.com/)
* [Location](/about-us/locations)
* [Newsroom](/company/newsroom)
## Popular Links

* [Blog](/blog/)
* [Communities](/communities)
* [Content Library](/resources)
* [Cyberpedia](/cyberpedia)
* [Event Center](https://events.paloaltonetworks.com/)
* [Manage Email Preferences](https://start.paloaltonetworks.com/preference-center)
* [Products A-Z](/products/products-a-z)
* [Product Certifications](/legal-notices/trust-center/compliance)
* [Report a Vulnerability](/security-disclosure)
* [Sitemap](/sitemap)
* [Tech Docs](https://docs.paloaltonetworks.com/)
* [Unit 42](https://unit42.paloaltonetworks.com/)
* [Do Not Sell or Share My Personal Information](https://panwedd.exterro.net/portal/dsar.htm?target=panwedd)
![PAN logo]()

* [Privacy](/legal-notices/privacy)
* [Trust Center](/legal-notices/trust-center)
* [Terms of Use](/legal-notices/terms-of-use)
* [Documents](/legal)

Copyright © 2025 Palo Alto Networks. All Rights Reserved

* [![Youtube]()](https://www.youtube.com/user/paloaltonetworks)
* [![Twitter]()](https://twitter.com/PaloAltoNtwks)
* [![Facebook]()](https://www.facebook.com/PaloAltoNetworks/)
* [![LinkedIn]()](https://www.linkedin.com/company/palo-alto-networks)
* [![Podcast]()](https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/)
* ENSelect your language


=== Content from www.openwall.com_515a66e9_20250125_062656.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](../../../2017/06/26/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAMgJUL1gMQSuUPrqjuu07=ewRv=tA4m+qjMa0snUqWRvD0F8OA@mail.gmail.com>
Date: Sun, 25 Jun 2017 11:55:26 +0300
From: Ariel Zelivansky <ariel@...stlock.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2017-9669 and CVE-2017-9671: Exploitable buffer overflows in apk
 (Alpine's package manager)

Hello,

I'm a security researcher at Twistlock. I've recently found two heap
overflow vulnerabilities in apk (the package manager of Alpine Linux). With
either of these vulnerabilities I was able to achieve remote code execution
from a naive call to "apk update" (under some restrictions - i.e. no ASLR).
MITRE has assigned CVE-2017-9669 and CVE-2017-9671 for these issues.

I privately disclosed the issue with Timo Teräs (apk's maintainer) and he
had already released fixes to solve these issues. The fixes are available
from apk-tools 2.7.2 and 2.6.9 and all alpine repositories back to
3.2-stable are updated with it (3.3-stable is actually the latest supported
version but Timo updated 3.2 too).

I've discussed the possibility of publicly disclosing the vulnerabilities
with Timo and he agreed to have this advisory published. A blog post with
similar details is to be posted on Twistlock's blog in the following days.

Find below the original disclosure (plus a reasonable disclaimer):

1. blob_realloc
---------------
The function blob_realloc (archive.c:136) accepts a pointer to apk_blob_t
and a size - of type int - and resizes the underlying buffer to size using
realloc. [0] Before calling realloc, it compares the current buffer size to
the requested size. If it is bigger or equal, it does not call realloc and
returns 0. See line 139:

if (b->len >= newsize) return 0;

This is generally OK as long as the code around it also expects size to be
a signed int.

1.1 longname overflow (CVE-2017-9669)
-------------------------------------

The function apk_tar_parse (archive.c:189) is used to parse a tar stream.
One of the tar block types is a longname (or "GNU long name extension", see
line 242). Consult the tar format standard to learn about block types. [1]
When dealing with a longname block apk_tar_parse calls blob_realloc with
the size read from the block header plus one byte for null terminator. See
line 243:

if (blob_realloc(&longname, entry.size+1)) goto err_nomem;

After the call to blob_realloc, the name buffer is copied from the stream
to the allocated buffer. See lines 244-246:

entry.name = longname.ptr;
is->read(is, entry.name, entry.size);
entry.name[entry.size] = 0;

When the stream is a gzipped tar (tar.gz) such as with update files for
apk, the read function of the stream results in gzi_read (gunzip.c:40).
gzi_read accepts a size of size_t. This is significant because size_t is
unsigned by definition. So let's see what happens when we have a negative
size - the call to blob_realloc will not do anything and return 0 (the
buffer pointer is not changed), and later the call to gzi_read will attempt
to copy a huge amount of bytes - i.e. a number from 0x80000000 to
0xffffffff bytes. If the result buffer (the allocated buffer) is not null,
the bytes will be read from the gzipped stream, resulting in an overflow of
that buffer.

Versions affected
-----------------

The call to blob_realloc was added in 2.5.0_rc1 (from commit
36d5b91495e22fe8425277f2d793fd4a284ee2b6). However it seems that all
versions before it (from the first commit to archive.c) may be vulnerable
to an integer overflow that could lead to a buffer overflow after a failing
call to malloc... However vulnerabilities in older versions is beyond the
scope of this advisory.

1.2 pax header overflow (CVE-2017-9671)
---------------------------------------

The latter is also possible with the call to blob_realloc with a block type
of a pax header. See line 292:

if (blob_realloc(&pax, (paxlen + 511) & -512)) goto err_nomem;

A buffer overflow in the following call to is->read may be exploited in the
same fashion.

Versions affected
-----------------

Any version from 2.5.0_rc1 (same commit as 1.1. All versions before that
are not vulnerable because pax headers were not parsed).

2. Impact
---------
There are numerous ways in which these buffer overflows could be exploited.
To demonstrate the impact, I've crafted a malicious tar.gz file
(specifically, an APKINDEX.tar.gz file [2]) that leads the code to the
buffer overflow copy, in which a struct on the heap that has a function
pointer is overridden. The execution is then lead to a call to `system`
with a string that I control as a parameter.

To put it simply, a man in the middle attacker could result in code
execution when a call to apk update is made. At a later date, I may decide
to release the proof of concept with the details of such an attack.

It is also worth noting that even if the call to read failed, in some
scenarios it may also be possible to use the null byte write (line 246) to
write to specific addresses. This could be dangerous especially on 32-bit
(in 64-bit the addresses are too high to actually reach anything
significant such as the stack).

As another anecdote, I originally discovered this issue from a crash by a
null deference. When fuzzing, I used apk_tar_parse with the stream from a
file and not from the gzip stream. Unlike gzip_read, fdi_read (io.c:71)
calls lseek when the target buffer pointer is null. And it fails when there
is not enough data on the file (gzip just reads whatever it has before
failing). This resulted in a scenario where handle_extended_header is
called, and then in apk_blob_pull_uint a null deference occurred if the pax
buffer was never allocated. [3] I have not assigned a CVE ID for this issue
because I did not reach a scenario where apk_tar_parse gets a file stream,
besides my fuzzer, and since the previous CVE IDs can relate to the same
issue.

2.1 Attack examples
-------------------

Disclaimer: As a perquisite to the examples below, the attacker must be
able to fully predict the memory layout of the execution.

1. Remote shell by `apk update`: <https://asciinema>.
org/a/8ftsmf3yf2aiooh20p3wyrf38
2. Remote shell from within `docker build`: <https://asciinema.org/>
a/08gvjvegerli00xp8o8y1qsxy

3. Use https
------------

As a general suggestion, consider fully enforcing the use of HTTPS in your
CDN servers (and in the /etc/apk/repositories file). The impact of these
vulnerabilities would be significantly lower if a MITM attack was
infeasible (or at least difficult). [4]

Credits
-------

All bugs were found with the use of afl-fuzz.

Footnotes
---------

[0] All line references are from the apk branch of 2.7.1
[1] <http://www.gnu.org/software/tar/manual/html_node/Standard.html>
[2] <https://wiki.alpinelinux.org/wiki/Apkindex_format>
[3] This is still achievable in theory if we have a huge stream
(0x80000000+512*2 bytes) so gzip reads 0x80000000 bytes and then moves on
to the call to handle_extended_header, but the size is converted to off_t
as explained and it is 64-bit and I'm unlikely to hold more than
0xffffffff80000000 bytes in memory... at least in the meantime.
[4] Also consider certificate/PK pinning <https://www.owasp.org/>
index.php/Certificate_and_Public_Key_Pinning

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


