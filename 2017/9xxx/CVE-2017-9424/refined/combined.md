=== Content from breeze.github.io_9b1cbff4_20250124_141726.html ===

[.NET Server](/doc-net/)

* [Start with Nuget](nuget-packages.html)
* [Download](download.html)

  Toggle Dropdown
  + [Release Notes](release-notes.html)
* [For .NET Core](breeze-server-core)

  Toggle Dropdown
  + [The Web API Controller](webapi-controller-core.html)
  + [The PersistenceManager](persistencemanager-core.html)
  + [The EFPersistenceManager](ef-efpersistencemanager-core.html)
  + [EF - Server side model](ef-serverside-model-core.html)
  + [EF - Server-side validation](ef-serverside-validation-core.html)
* [For .NET 4.x](breeze-server-4x)

  Toggle Dropdown
  + [Web API routing](webapi-routing-4x)
  + [The Web API Controller](webapi-controller-4x.html)
  + [The ContextProvider](contextprovider-4x.html)
  + [Controlling Serialization](controlling-serialization-4x.html)
  + [EF - Server side model](ef-serverside-model-4x.html)
  + [EF - DBContext](ef-dbcontext-4x.html)
  + [EF - Context Provider](ef-efcontextprovider-4x.html)
  + [EF - Server-side validation](ef-serverside-validation-4x.html)
* [NHibernate Server](nh.html)

  Toggle Dropdown
  + [NHibernate details](nh-details.html)
* [Support for OData](odata.html)

[![Breeze](/images/logos/BreezeLogo_white_80.png)](/doc-main/)

.NET Server
.NET Server

* [Support](https://www.getbreezenow.com/support.html)
* Overview
* [Introduction](/doc-main/)
* Client technologies
* [JavaScript client](/doc-js/)
* [C# client](/doc-cs/)
* Server technologies
* [.NET server + Entity Framework or NHibernate](/doc-net/)
* [Node server + Sequelize](/doc-node-sequelize/)
* [Node server + MongoDB](/doc-node-mongodb/)
* [Java server + Hibernate](/doc-java-hib/)
* Other
* [Samples](/doc-samples/)
* [Blog](/doc-blog/)
* [Cool Breezes](/doc-cool-breezes/)
* [Breeze Labs](/doc-breeze-labs/)

[Support](https://www.getbreezenow.com/support.html)

[![](/images/logos/feed-icon-28x28.png)](http://breeze.github.io/rss-blog.xml "Breeze features")

Go!

[Need a hand with your app?
![](/images/pointing-hand.png)](https://www.ideablade.com/services "Ask IdeaBlade")

# Breeze.Server.NET Release Notes

## .NET Core Release Notes

### 7.3.0 May 15, 2024

Release for .NET 5, 6, 7, and 8

* Make separate BreezeQueryFilter and BreezeAsyncQueryFilter with cancellationToken handling. For issue [#195](https://github.com/Breeze/breeze.server.net/issues/195)
* Handle string or int enums via BreezeConfig.Instance.UseIntEnums flag - affects metadata generation and JSON serialization. For issue [#196](https://github.com/Breeze/breeze.server.net/issues/196)
* Add params to JsonSerializationFns.UpdateWithDefaults to toggle camelCasing and useIntEnums
* Add NoAnonSerializationBinder for optionally removing names from anonymous type serialization

### 7.2.2 April 30, 2024

Release for .NET 5, 6, 7, and 8

* Make QueryFilter inherit from ActionFilterAttribute so that OnActionExecutionAsyc method will be overridable. For issue [#195](https://github.com/Breeze/breeze.server.net/issues/195)

### 7.2.1 November 22, 2023

Release for .NET 5, 6, 7, and 8

* Fix bug in query handling for Enums. Now a where clause from the client can specify enums as strings or numbers, and the server will handle them correctly.

### 7.2.0 November 16, 2023

Release for .NET 5, 6, 7, and 8

* Add support for .NET 8 and EFCore 8
* Make BreezeQueryFilterAttribute implement IAsyncActionFilter and async query execution with CancellationToken - issue [#189](https://github.com/Breeze/breeze.server.net/issues/189) and PR [#191](https://github.com/Breeze/breeze.server.net/pull/191) - thanks @biegehydra
* Make Enum properties use Int32 datatype (instead of string) in metadata generation.

### 7.1.0 April 26, 2023

Release for .NET 5, 6, and 7

* Create multi-target Nuget package for .NET 5, 6, and 7
* Fix “same key” error in MetadataBuilder when same ComplexType is used twice in an entity - issue [#186](https://github.com/Breeze/breeze.server.net/issues/186)

### 7.0.2 Jan 27, 2023

Release for .NET 7

* Add support for `DateOnly` and `TimeOnly` data types
* Add `ApplyBreezeQuery` and `ApplyBreezeWhere` extension methods to QueryFns. These apply filtering conditions from the client/url before aggregation or other transformations

### 6.0.4 Jan 27, 2023

Release for .NET 6

* Add support for `DateOnly` and `TimeOnly` data types
* Add `ApplyBreezeQuery` and `ApplyBreezeWhere` extension methods to QueryFns. These apply filtering conditions from the client/url before aggregation or other transformations

### 7.0.1 Jan 4, 2023

Release for .NET 7

### 6.0.2 Mar 30, 2022

Release for .NET 6

* Fix issue with ‘in’ clause for non-String types [#127](https://github.com/Breeze/breeze.server.net/pull/127)

### 5.0.6 Mar 30, 2022

Release for .NET 5

* Fix issue with ‘in’ clause for non-String types [#127](https://github.com/Breeze/breeze.server.net/pull/127)

### 6.0.1 Jan 12, 2022

Release for .NET 6

* Update EntityFramework dependencies to version 6.0.1

### 5.0.5 May 3, 2021

Release for .NET 5

* Add async support to PersistenceManager ([#46](https://github.com/Breeze/breeze.server.net/issues/46))
* Add Metadata support for foreign keys that relate to a property other than a PK
* NH: Fix “Not an association” error on set of strings ([#48](https://github.com/Breeze/breeze.server.net/issues/48))
* Update EntityFramework dependencies to version 5.0.5
* Update NHibernate dependencies to version 5.3.8

### 3.1.4 April 20, 2021

Release for .NET Core 3.1

* Add DataAnnotationsValidator to Breeze.Persistence
* Fix processing of queryable result when returning error
* Fix duplicate properties in inheritance metadata ([#100](https://github.com/Breeze/breeze.server.net/issues/100))
* Add `Custom` property to DataProperty metadata, for sending custom metadata to client
* Add `Custom` property to EntityError, for sending custom error data to client
* Fix bug in overriding BreezeConfig ([#70](https://github.com/Breeze/breeze.server.net/issues/70))
* Update NHibernate version to 5.3.8
* Add EnumTypes to metadata ([#101](https://github.com/Breeze/breeze.server.net/issues/101))

### 5.0.4 April 19, 2021

Release for .NET 5

* Add DataAnnotationsValidator to Breeze.Persistence
* Fix processing of queryable result when returning error
* Fix duplicate properties in inheritance metadata ([#100](https://github.com/Breeze/breeze.server.net/issues/100))

### 5.0.3 March 30, 2021

Release for .NET 5

* Add `Custom` property to DataProperty metadata, for sending custom metadata to client
* Add `Custom` property to EntityError, for sending custom error data to client
* Fix bug in overriding BreezeConfig ([#70](https://github.com/Breeze/breeze.server.net/issues/70))
* Add NHibernate support to .NET 5
* Add EnumTypes to metadata ([#101](https://github.com/Breeze/breeze.server.net/issues/101))

> Please note that all further Breeze Server development will be on the .NET Core / .NET 5+ platform. .Net 4.x Breeze Server development has been frozen, except for essential bug fixes.

### 1.0.3 December 12, 2019

* Initial release of .NET Core 3 libraries

### 1.0.1 December 12, 2018

* Initial release of .NET Core 2 libraries

## .NET 4.x Release Notes

> **Please update to 1.6.5 or later**. All previous breeze.server.net releases have a security vulnerability in JSON deserialization.

### 2.0.3 February 10, 2023

* Release for .NET Framework 4.8

### 1.6.6 February 2, 2018

#### Breeze.Server.NET Fixed Bugs

* EFContextProvider: Fixed bug causing Enum properties to have their EF `OriginalValues` set incorrectly.
* EFContextProvider: Fixed bug causing EF `OriginalValues` to be set incorrectly for some properties when OriginalValues were null for other properties.
* Removed unneeded dependency on WebActivatorEx.

### 1.6.5 June 1, 2017

#### Breeze.Server.NET Fixed Bugs

* **Security Issue** in JSON deserialization. Changed TypeNameHandling to `TypeNameHandling.None` for JSON deserialization, to prevent a possible remote code execution vulnerability. **Thanks** to [Alvaro Muñoz](https://www.blackhat.com/us-17/speakers/Alvaro-Mu%C3%B1oz.html) and [Alexandr Mirosh](https://www.blackhat.com/us-17/speakers/Oleksandr-Mirosh.html) from Hewlett-Packard Enterprise Security for pointing out this flaw. See their [Black Hat Briefing](https://www.blackhat.com/us-17/briefings.html#friday-the-13th-json-attacks) regarding JSON vulnerabilities.

### 1.6.0 Dec. 1, 2016

#### Breeze.Server.NET Features

* Server-side deletes sent to client as DeletedKeys property of SaveResult
* Include .PDB files in NuGet packages (PR [#38](https://github.com/Breeze/breeze.server.net/pull/38))
* Updated NuGet dependencies

#### Breeze.Server.NET Fixed Bugs

* Querystring parameters not re-encoded on $expand, $orderby, or $select (PR [#44](https://github.com/Breeze/breeze.server.net/pull/44))

### 1.5.5 Feb. 2, 2016

#### Breeze.Server.NET Features

* Allow arrays in originalValuesMap (Issue [#2](https://github.com/Breeze/breeze.server.net/issues/2))
* NHibernate: Changed NHExpander to expand IEnumerable (includes collections and sets) (Issue [#28](https://github.com/Breeze/breeze.server.net/issues/28))
* NHibernate: Change support to NH 4
* Change to WebActivatorEx
* Add XML comment information to Nuget packages

#### Breeze.Server.NET Fixed Bugs

* NHibernate: Ordering of dependent entities during save
* NHibernate: Error when using formula column (thanks lnu)
* NHibernate: Transaction is rolled back twice, resulting in AdoTransaction error (thanks lnu)
* Inline count executed twice
* EFEntityError.ErrorName never set (thanks tschettler)
* Error when SaveMap contains unknown EntityType

See the prior [release notes](/doc-main/release-notes) for previous changes.

© IdeaBlade 2012-2023
[![](/images/logos/mit.png)](http://opensource.org/licenses/MIT) Free & open source
[![ideablade](/images/logos/ideablade-new-logo-h21.png)](http://www.ideablade.com/)



=== Content from www.blackhat.com_d91b792c_20250124_141727.html ===


* [![](https://www.blackhat.com/images/page-graphics/home.png)](https://www.blackhat.com)
* [USA](https://www.blackhat.com/upcoming.html)
* [Europe](https://www.blackhat.com/eu-17/)
* [Asia](https://www.blackhat.com/upcoming.html)
* [Trainings](https://www.blackhat.com/trainings/)

* [Archives](https://www.blackhat.com/html/archives.html)
* [Sponsorships](https://www.blackhat.com/html/sponsors.html)
* [Press](https://www.blackhat.com/html/press.html)
* About
  + [About Us](https://www.blackhat.com/about.html)
  + [Community](https://www.blackhat.com/community.html)
  + [Review Board](https://www.blackhat.com/review-board.html)
  + [Training Review Board](https://www.blackhat.com/training-review-board.html)
  + [Contact Us](https://www.blackhat.com/html/contact.html)
  + [Code of Conduct](https://www.blackhat.com/code-of-conduct.html)
  + [Privacy](http://legal.us.ubm.com/privacy-policy-highlights/)
  + [Upcoming Events](https://www.blackhat.com/upcoming.html)

[![Black Hat: Mailing List](https://www.blackhat.com/images/page-graphics/social-email-over.png)
![Black Hat: Mailing List](https://www.blackhat.com/images/page-graphics/social-email.png)](https://www.blackhat.com/mailing-list.html)
[![Black Hat: facebook](https://www.blackhat.com/images/page-graphics/social-fb-over.png)](https://www.facebook.com/Black-Hat-Events-107691635153/)
[![Black Hat: twitter](https://www.blackhat.com/images/page-graphics/social-tw-over.png)
![Black Hat: twitter](https://www.blackhat.com/images/page-graphics/social-tw.png)](https://twitter.com/BlackHatEvents)
[![Black Hat: LinkedIn](https://www.blackhat.com/images/page-graphics/social-in-over.png)
![Black Hat: LinkedIn](https://www.blackhat.com/images/page-graphics/social-in.png)](https://www.linkedin.com/company/black-hat/)
[![Black Hat: Youtube](https://www.blackhat.com/images/page-graphics/social-youtube-over.png)
![Black Hat: Youtube](https://www.blackhat.com/images/page-graphics/social-youtube.png)](https://www.youtube.com/user/BlackHatOfficialYT)
[![Black Hat: Google Plus](https://www.blackhat.com/images/page-graphics/social-google-over.png)
![Black Hat: Google Plus](https://www.blackhat.com/images/page-graphics/social-google.png)](https://www.google.com/%2BBlackHatOfficialYT)
[![Black Hat: Flickr](https://www.blackhat.com/images/page-graphics/social-fk-over.png)
![Black Hat: Flickr](https://www.blackhat.com/images/page-graphics/social-fk.png)](https://www.flickr.com/photos/blackhatevents/albums/)

[![Black Hat Home](https://www.blackhat.com/images/page-graphics-usa-17/logo.png)](https://www.blackhat.com/us-17)
![](https://www.blackhat.com/images/page-graphics-asia-17/register-now.png)
![](https://www.blackhat.com/images/page-graphics-usa-17/date.png)

* [![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-attend-hover.png)
  ![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-attend-static.png)](https://www.blackhat.com/us-17/registration.html)
  + [Attendee Registration](https://www.blackhat.com/us-17/registration.html)
  + [Pass Comparison](https://www.blackhat.com/us-17/pass-comparison.html)
  + [Scholarship Program](https://www.blackhat.com/us-17/student-scholarship.html)
  + [Media Registration](https://www.blackhat.com/us-17/media-registration.html)
  + [Travel](https://www.blackhat.com/us-17/travel.html)
  + [Attendee Resources](https://www.blackhat.com/us-17/attendee-resources.html)
  + [FAQ](https://www.blackhat.com/us-17/faq.html)
* [![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-trainings-hover.png)
  ![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-trainings-static.png)](https://www.blackhat.com/us-17/training/schedule/index.html)
  + [Trainings Abstracts](https://www.blackhat.com/us-17/training/index.html)
* [![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-briefings-hover.png)
  ![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-briefings-static.png)](https://www.blackhat.com/us-17/briefings/schedule/index.html)
  + [Briefings Abstracts](https://www.blackhat.com/us-17/briefings.html)
  + [Keynote](https://www.blackhat.com/us-17/briefings/schedule/index.html#stepping-up-our-game-re-focusing-the-security-community-on-defense-and-making-security-work-for-everyone-8227)
* [![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-arsenal-hover.png)
  ![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-arsenal-static.png)](https://www.blackhat.com/us-17/arsenal/schedule/index.html%20)
  + [Arsenal Lineup](https://www.blackhat.com/us-17/arsenal.html)
  + [Arsenal Overview](https://www.blackhat.com/us-17/arsenal-overview.html)
* [![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-features-hover.png)
  ![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-features-static.png)](https://www.blackhat.com/us-17/sponsors.html)
  + [Business Hall](https://www.blackhat.com/us-17/sponsors.html)
  + [Career Track](https://www.blackhat.com/us-17/career-track.html)

  + [CISO Summit](https://www.blackhat.com/us-17/ciso-summit.html)
  + [Day Zero](https://www.blackhat.com/us-17/day-zero.html)
  + [Diversity Programs](https://www.blackhat.com/us-17/diversity-programs.html)
  + [DEF CON](https://www.blackhat.com/us-17/defcon.html)
  + [Kali Linux Dojo](https://www.blackhat.com/us-17/kali-linux.html)
  + [Sponsor Activities](https://www.blackhat.com/us-17/sponsor-activities.html)
  + [Who's Hiring](https://www.blackhat.com/us-17/whos-hiring.html)
* [![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-schedule-hover.png)
  ![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-schedule-static.png)](https://www.blackhat.com/us-17/schedule.html)
* [![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-special-events-hover.png)
  ![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-special-events-static.png)](https://www.blackhat.com/us-17/special-events.html)
  + [Parties & Networking](https://www.blackhat.com/us-17/parties.html)
* [![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-sponsors-hover.png)
  ![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-sponsors-static.png)](https://www.blackhat.com/us-17/sponsors.html)
  + [Exhibit Now](https://www.blackhat.com/us-17/sponsors.html)
  + [Event Sponsor List](https://www.blackhat.com/us-17/event-sponsors.html)
  + [Sponsor News](https://www.blackhat.com/sponsor-news.html)
  + [Sponsor Portal](https://blackhat.tech.ubm.com/usa/2017/exhibitorreg/Sponsor)
  + [Sponsorship Opportunities](https://www.blackhat.com/html/sponsors.html)
* [![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-proposals-hover.png)
  ![](https://www.blackhat.com/images/page-graphics-usa-17/main-nav-proposals-static.png)](https://www.blackhat.com/us-17/call-for-papers.html)
  + [Call for Papers](https://www.blackhat.com/us-17/call-for-papers.html)
  + [Call for Tools](https://usa-arsenal-cfp.blackhat.com/)

## briefings

* [Lillian Ablon](#zero-days-thousands-of-nights-the-life-and-times-of-zero-day-vulnerabilities-and-their-exploits "Lillian Ablon")
* [Aaron Alva](#aaron-alva "Aaron Alva")
* [Hyrum Anderson](#hyrum-anderson "Hyrum Anderson")
* [Brad Antoniewicz](#brad-antoniewicz "Brad Antoniewicz")
* [Nitay Artenstein](#nitay-artenstein "Nitay Artenstein")
* [RÃ©mi Audebert](#rÃ©mi-audebert "RÃ©mi Audebert")
* [Jean-Philippe Aumasson](#jean-philippe-aumasson "Jean-Philippe Aumasson")
* [Norman Barbosa](#norman-barbosa "Norman Barbosa")
* [Alessandro Barenghi](#alessandro-barenghi "Alessandro Barenghi")
* [Nathan Bates](#nathan-bates "Nathan Bates")
* [Oleksandr Bazhaniuk](#oleksandr-bazhaniuk "Oleksandr Bazhaniuk")
* [Tal Be'ery](#tal-beery "Tal Be\'ery")
* [Noah Beddome](#noah-beddome "Noah Beddome")
* [Azzedine Benameur](#azzedine-benameur "Azzedine Benameur")
* [David Bianco](#david-bianco "David Bianco")
* [Andrew Blaich](#andrew-blaich "Andrew Blaich")
* [Daniel Bohannon](#daniel-bohannon "Daniel Bohannon")
* [Justine Bone](#justine-bone "Justine Bone")
* [Ravishankar Borgaonkar](#ravishankar-borgaonkar "Ravishankar Borgaonkar")
* [Rodrigo Branco](#rodrigo-branco "Rodrigo Branco")
* [Thomas Brandstetter](#thomas-brandstetter "Thomas Brandstetter")
* [Kenneth Brown](#kenneth-brown "Kenneth Brown")
* [Yuriy Bulygin](#yuriy-bulygin "Yuriy Bulygin")
* [Karla Burnett](#karla-burnett "Karla Burnett")
* [Elie Bursztein](#elie-bursztein "Elie Bursztein")
* [Jonathan Butts](#jonathan-butts "Jonathan Butts")
* [Luca Carettoni](#luca-carettoni "Luca Carettoni")
* [Anton Cherepanov](#anton-cherepanov "Anton Cherepanov")
* [Michael Cherny](#michael-cherny "Michael Cherny")
* [Harold Chun](#harold-chun "Harold Chun")
* [Simon Pak Ho Chung](#simon-pak-ho-chung "Simon Pak Ho Chung")
* [Tomer Cohen](#tomer-cohen "Tomer Cohen")
* [Romain Coltel](#romain-coltel "Romain Coltel")
* [Alberto Compagno](#alberto-compagno "Alberto Compagno")
* [Mauro Conti](#mauro-conti "Mauro Conti")
* [Andrea Continella](#andrea-continella "Andrea Continella")
* [Lorrie Cranor](#lorrie-cranor "Lorrie Cranor")
* [Dan Cvrcek](#dan-cvrcek "Dan Cvrcek")
* [Dino Dai Zovi](#dino-dai-zovi "Dino Dai Zovi")
* [George Danezis](#george-danezis "George Danezis")
* [Giulio De Pasquale](#giulio-de-pasquale "Giulio De Pasquale")
* [Craig Dods](#craig-dods "Craig Dods")
* [Christopher Domas](#christopher-domas "Christopher Domas")
* [Yuefeng Du](#yuefeng-du "Yuefeng Du")
* [Sagie Dulce](#sagie-dulce "Sagie Dulce")
* [Omar Eissa](#omar-eissa "Omar Eissa")
* [Alexander Ermolov](#alexander-ermolov "Alexander Ermolov")
* [Amir Etemadieh](#amir-etemadieh "Amir Etemadieh")
* [Dmitriy Evdokimov](#dmitriy-evdokimov "Dmitriy Evdokimov")
* [Siji Feng](#siji-feng "Siji Feng")
* [Matt Foley](#matt-foley "Matt Foley")
* [Yanick Fratantonio](#yanick-fratantonio "Yanick Fratantonio")
* [Andrew Furtak](#andrew-furtak "Andrew Furtak")
* [Clint Gibler](#clint-gibler "Clint Gibler")
* [Omer Gil](#omer-gil "Omer Gil")
* [Lidia Giuliano](#lidia-giuliano "Lidia Giuliano")
* [Eason Goodale](#eason-goodale "Eason Goodale")
* [Mikhail Gorobets](#mikhail-gorobets "Mikhail Gorobets")
* [Vlad Gostomelsky](#vlad-gostomelsky "Vlad Gostomelsky")
* [Waylon Grange](#waylon-grange "Waylon Grange")
* [Tom Grasso](#tom-grasso "Tom Grasso")
* [Nicholas Gray](#nicholas-gray "Nicholas Gray")
* [Alessandro Guagnelli](#alessandro-guagnelli "Alessandro Guagnelli")
* [Justin Harvey](#justin-harvey "Justin Harvey")
* [Jason Healey](#jason-healey "Jason Healey")
* [CJ Heres](#cj-heres "CJ Heres")
* [Trey Herr](#trey-herr "Trey Herr")
* [Lucca Hirschi](#lucca-hirschi "Lucca Hirschi")
* [Khoa Hoang](#khoa-hoang "Khoa Hoang")
* [Lee Holmes](#lee-holmes "Lee Holmes")
* [Lin Huang](#lin-huang "Lin Huang")
* [Khoo Boon Hui](#khoo-boon-hui "Khoo Boon Hui")
* [Mikko Hypponen](#mikko-hypponen "Mikko Hypponen")
* [Luca Invernizzi](#luca-invernizzi "Luca Invernizzi")
* [Chanil Jeon](#chanil-jeon "Chanil Jeon")
* [Xing Jin](#xing-jin "Xing Jin")
* [Richard Johnson](#richard-johnson "Richard Johnson")
* [Ryan Johnson](#ryan-johnson "Ryan Johnson")
* [Graham Jones](#graham-jones "Graham Jones")
* [Jinho Jung](#jinho-jung "Jinho Jung")
* [Mateusz Jurczyk](#mateusz-jurczyk "Mateusz Jurczyk")
* [Martin Kacer](#martin-kacer "Martin Kacer")
* [Paul Kalinin](#paul-kalinin "Paul Kalinin")
* [Marina Kaljurand](#marina-kaljurand "Marina Kaljurand")
* [Wang Kang](#wang-kang "Wang Kang")
* [Anastasis Keliris](#anastasis-keliris "Anastasis Keliris")
* [James Kettle](#james-kettle "James Kettle")
* [Taesoo Kim](#taesoo-kim "Taesoo Kim")
* [Amit Klein](#amit-klein "Amit Klein")
* [Wolfgang Kleinwachter](#wolfgang-kleinwachter "Wolfgang Kleinwachter")
* [Brian Knopf](#brian-knopf "Brian Knopf")
* [Charalambos Konstantinou](#charalambos-konstantinou "Charalambos Konstantinou")
* [Itzik Kotler](#itzik-kotler "Itzik Kotler")
* [Krzysztof Kotowicz](#krzysztof-kotowicz "Krzysztof Kotowicz")
* [Nick Kralevich](#nick-kralevich "Nick Kralevich")
* [Marina Krotofil](#marina-krotofil "Marina Krotofil")
* [Andrew Krug](#andrew-krug "Andrew Krug")
* [Bryce Kunz](#bryce-kunz "Bryce Kunz")
* [Zane Lackey](#zane-lackey "Zane Lackey")
* [Daniele Lain](#daniele-lain "Daniele Lain")
* [Dan Lake](#dan-lake "Dan Lake")
* [Philippe Langlois](#philippe-langlois "Philippe Langlois")
* [Yves Le Provost](#yves-le-provost "Yves Le Provost")
* [Robert Lee](#robert-lee "Robert Lee")
* [Wenke Lee](#wenke-lee "Wenke Lee")
* [Sebastian Lekies](#sebastian-lekies "Sebastian Lekies")
* [Jun Li](#jun-li "Jun Li")
* [Shangyuan LI](#shangyuan-li "Shangyuan LI")
* [Robert Lipovsky](#robert-lipovsky "Robert Lipovsky")
* [Ling Liu](#ling-liu "Ling Liu")
* [Lucas Lundgren](#lucas-lundgren "Lucas Lundgren")
* [Tongbo Luo](#tongbo-luo "Tongbo Luo")
* [Federico Maggi](#federico-maggi "Federico Maggi")
* [Dhia Mahjoub](#dhia-mahjoub "Dhia Mahjoub")
* [Maksim Malyutin](#maksim-malyutin "Maksim Malyutin")
* [Mihalis Maniatakos](#mihalis-maniatakos "Mihalis Maniatakos")
* [Tal Maor](#tal-maor "Tal Maor")
* [Andrew Martin](#andrew-martin "Andrew Martin")
* [Alex Matrosov](#alex-matrosov "Alex Matrosov")
* [Vasilios Mavroudis](#vasilios-mavroudis "Vasilios Mavroudis")
* [Nikita Mazurov](#nikita-mazurov "Nikita Mazurov")
* [Wesley McGrew](#wesley-mcgrew "Wesley McGrew")
* [Kylie McRoberts](#kylie-mcroberts "Kylie McRoberts")
* [Terrell McSweeny](#terrell-mcsweeny "Terrell McSweeny")
* [Haroon Meer](#haroon-meer "Haroon Meer")
* [Ben Miller](#ben-miller "Ben Miller")
* [Ty Miller](#ty-miller "Ty Miller")
* [Oleksandr Mirosh](#oleksandr-mirosh "Oleksandr Mirosh")
* [Nikhil Mittal](#nikhil-mittal "Nikhil Mittal")
* [Bruce Monroe](#bruce-monroe "Bruce Monroe")
* [Jeff Moss](#jeff-moss "Jeff Moss")
* [Katie Moussouris](#katie-moussouris "Katie Moussouris")
* [Alvaro MuÃ±oz](#alvaro-muÃ±oz "Alvaro MuÃ±oz")
* [Jens MÃ¼ller](#jens-mÃ¼ller "Jens MÃ¼ller")
* [Gabi Nakibly](#gabi-nakibly "Gabi Nakibly")
* [Karen Neuman](#karen-neuman "Karen Neuman")
* [Jason Nichols](#jason-nichols "Jason Nichols")
* [Sen Nie](#sen-nie "Sen Nie")
* [Joseph Nye](#joseph-nye "Joseph Nye")
* [Colin O'Flynn](#colin-oflynn "Colin O\'Flynn")
* [Rob Olson](#rob-olson "Rob Olson")
* [Jacob Osborn](#jacob-osborn "Jacob Osborn")
* [Michael Ossmann](#michael-ossmann "Michael Ossmann")
* [Xin Ouyang](#xin-ouyang "Xin Ouyang")
* [Aimin Pan](#aimin-pan "Aimin Pan")
* [Shinjo Park](#shinjo-park "Shinjo Park")
* [Jason Passwaters](#jason-passwaters "Jason Passwaters")
* [Jonas Pfoh](#jonas-pfoh "Jonas Pfoh")
* [Jean-Michel Picod](#jean-michel-picod "Jean-Michel Picod")
* [Marcello Pogliani](#marcello-pogliani "Marcello Pogliani")
* [Mario Polino](#mario-polino "Mario Polino")
* [Marios Pomonis](#marios-pomonis "Marios Pomonis")
* [Angelo Prado](#angelo-prado "Angelo Prado")
* [Stefan Prandl](#stefan-prandl "Stefan Prandl")
* [Kymberlee Price](#kymberlee-price "Kymberlee Price")
* [Chenxiong Qian](#chenxiong-qian "Chenxiong Qian")
* [Davide Quarta](#davide-quarta "Davide Quarta")
* [Alex Radocea](#alex-radocea "Alex Radocea")
* [Kyle Randolph](#kyle-randolph "Kyle Randolph")
* [Lori Rangel](#lori-rangel "Lori Rangel")
* [Billy Rios](#billy-rios "Billy Rios")
* [Andy Robbins](#andy-robbins "Andy Robbins")
* [David Rodriguez](#david-rodriguez "David Rodriguez")
* [Yolan Romailler](#yolan-romailler "Yolan Romailler")
* [Megan Ruthven](#megan-ruthven "Megan Ruthven")
* [Chaim Sanders](#chaim-sanders "Chaim Sanders")
* [Hillary Sanders](#hillary-sanders "Hillary Sanders")
* [Ruben Santamarta](#ruben-santamarta "Ruben Santamarta")
* [Morten Schenk](#morten-schenk "Morten Schenk")
* [Will Schroeder](#will-schroeder "Will Schroeder")
* [Jean-Pierre Seifert](#jean-pierre-seifert "Jean-Pierre Seifert")
* [Altaf Shaik](#altaf-shaik "Altaf Shaik")
* [Haoqi Shan](#haoqi-shan "Haoqi Shan")
* [Di Shen](#di-shen "Di Shen")
* [Kelly Shortridge](#kelly-shortridge "Kelly Shortridge")
* [Natalie Silvanovich](#natalie-silvanovich "Natalie Silvanovich")
* [Ankit Singh](#ankit-singh "Ankit Singh")
* [Marco Slaviero](#marco-slaviero "Marco Slaviero")
* [Joe Slowik](#joe-slowik "Joe Slowik")
* [Manuel Sommer](#manuel-sommer "Manuel Sommer")
* [Mike Spaulding](#mike-spaulding "Mike Spaulding")
* [Dominic Spill](#dominic-spill "Dominic Spill")
* [Jason Staggs](#jason-staggs "Jason Staggs")
* [Alex Stamos](#alex-stamos "Alex Stamos")
* [Angelos Stavrou](#angelos-stavrou "Angelos Stavrou")
* [Bart Stump](#bart-stump "Bart Stump")
* [Matt Suiche](#matt-suiche "Matt Suiche")
* [Petr Svenda](#petr-svenda "Petr Svenda")
* [Yogesh Swami](#yogesh-swami "Yogesh Swami")
* [Nikita Tarakanov](#nikita-tarakanov "Nikita Tarakanov")
* [Vijay Thaware](#vijay-thaware "Vijay Thaware")
* [Phuoc Tran-Gia](#phuoc-tran-gia "Phuoc Tran-Gia")
* [Anna Trikalinou](#anna-trikalinou "Anna Trikalinou")
* [Orange Tsai](#orange-tsai "Orange Tsai")
* [Gene Tsudik](#gene-tsudik "Gene Tsudik")
* [Charles Valentine](#charles-valentine "Charles Valentine")
* [Nir Valtman](#nir-valtman "Nir Valtman")
* [Mathy Vanhoef](#mathy-vanhoef "Mathy Vanhoef")
* [Eduardo Vela](#eduardo-vela "Eduardo Vela")
* [John Ventura](#john-ventura "John Ventura")
* [Arun Vishwanath](#arun-vishwanath "Arun Vishwanath")
* [Sebastian Vogl](#sebastian-vogl "Sebastian Vogl")
* [Mingming Wan](#mingming-wan "Mingming Wan")
* [Zhengbo Wang](#zhengbo-wang "Zhengbo Wang")
* [Patrick Wardle](#patrick-wardle "Patrick Wardle")
* [Max Wolotsky](#max-wolotsky "Max Wolotsky")
* [Bill Woodcock](#bill-woodcock "Bill Woodcock")
* [April C. Wright](#april-c.-wright "April C. Wright")
* [Neil Wyler](#neil-wyler "Neil Wyler")
* [Chris Wysopal](#chris-wysopal "Chris Wysopal")
* [Zhaoyan Xu](#zhaoyan-xu "Zhaoyan Xu")
* [Bo Yang](#bo-yang "Bo Yang")
* [Kun Yang](#kun-yang "Kun Yang")
* [Qing Yang](#qing-yang "Qing Yang")
* [Chui Yew Leong](#chui-yew-leong "Chui Yew Leong")
* [Insu Yun](#insu-yun "Insu Yun")
* [Timur Yunusov](#timur-yunusov "Timur Yunusov")
* [Andrea Maria Zanchettin](#andrea-maria-zanchettin "Andrea Maria Zanchettin")
* [Stefano Zanero](#stefano-zanero "Stefano Zanero")
* [Sarah Zatko](#sarah-zatko "Sarah Zatko")
* [Kim Zetter](#kim-zetter "Kim Zetter")
* [Yuwei Zheng](#yuwei-zheng "Yuwei Zheng")
* [Zhi Zhou](#zhi-zhou "Zhi Zhou")
* [Vincent Zimmer](#vincent-zimmer "Vincent Zimmer")
* [Giovanni Zingaro](#giovanni-zingaro "Giovanni Zingaro")
* [Thomas Zinner](#thomas-zinner "Thomas Zinner")
* [Ofri Ziv](#ofri-ziv "Ofri Ziv")

# briefings - july 26 & 27

## Keynote

---

## [Stepping Up Our Game: Re-focusing the Security Community on Defense and Making Security Work for Everyone](#stepping-up-our-game-re-focusing-the-security-community-on-defense-and-making-security-work-for-everyone "Stepping Up Our Game: Re-focusing the Security Community on Defense and Making Security Work for Everyone")

Since the first Black Hat conference 20 years ago, the security community, industry and the world have changed to the point that it's time to re-examine whether we're living up to our responsibilities and potential.

Long gone are the days when "hacking" conjured up a sense of mischief and light-heartedness, with limited risks and harm. The harsh reality of the now is that the security community hasn't kept pace with the importance of technology in our society, even as the stakes have grown higher than ever. Our adversaries are no longer motivated only by money, personal data or competitive intelligence, but are now driven to use the critical technologies of our lives to arrest journalists and activists, to suppress democracy and manipulate public opinion. In these times, our community has a responsibility to the people of the world that goes beyond traditional facets of information security.

This talk will explore how we can adapt to better confront the obstacles we face as security practitioners. Can we incentivize and celebrate defensive security research in the same way that we applaud the discovery of vulnerabilities? How do we foster intelligent discussion of real-world trade-offs while avoiding sensationalism? We will discuss real situations from the last year where our community could have risen to the occasion, we will analyze what failed, and propose how we can further help protect people.

### Presented By

[Alex Stamos](speakers/Alex-Stamos.html)

---

## Briefings

---

## ['Ghost Telephonist' Link Hijack Exploitations in 4G LTE CS Fallback](#ghost-telephonist-link-hijack-exploitations-in-4g-lte-cs-fallback "\'Ghost Telephonist\' Link Hijack Exploitations in 4G LTE CS Fallback")

In this presentation, one vulnerability in CSFB (Circuit Switched Fallback) in 4G LTE network is introduced. In the CSFB procedure, we found the authentication step is missing. The result is that an attacker can hijack the victim's communication. We named this attack as 'Ghost Telephonist.' Several exploitations can be made based on this vulnerability. When the call or SMS is not encrypted, or weakly encrypted, the attacker can get the content of the victim's call and SMS. The attacker can also initiate a call/SMS by impersonating the victim. Furthermore, Telephonist Attack can obtain the victim's phone number and then use the phone number to make advanced attack, e.g. breaking Internet online accounts. The victim will not sense being attacked since no 4G or 2G fake base station is used and no cell re-selection. These attacks can randomly choose victims or target a given victim. We verified these attacks with our own phones in operators' network in a small controllable scale. The experiments proved the vulnerability really exists. Finally, the countermeasures are proposed and now we are collaborating with operators and terminal manufactures to fix this vulnerability.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Yuwei-Ghost-Telephonist-Link-Hijack-Exploitations-In-4G-LTE-CS-Fallback.pdf)

### Presented By

[Haoqi Shan](speakers/Haoqi-Shan.html)
 &  [Jun Li](speakers/Jun-Li.html)
 &  [Yuwei Zheng](speakers/Yuwei-Zheng.html)
 &  [Lin Huang](speakers/Lin-Huang.html)
 &  [Qing Yang](speakers/Qing-Yang.html)

---

## [(in)Security in Building Automation: How to Create Dark Buildings with Light Speed](#insecurity-in-building-automation-how-to-create-dark-buildings-with-light-speed "(in)Security in Building Automation: How to Create Dark Buildings with Light Speed")

A number of talks in the last few years have addressed various topics in the generic area of industrial control system insecurity but only few have tapped into security of building automation systems, albeit its prevalence.

 The usage of building automation, regardless if in private homes or corporate buildings, aims to optimize comfort, energy efficiency and physical access for its users. Is cyber security part of the equation? Unfortunately, not to the extent one might expect, cyber security is quite often found to be sacrificed either for comfort or efficiency.

 The higher number of small and large-scale installations combination with easily exploitable vulnerabilities leads to a stronger exposure of building automation systems, which are often overlooked. Even worse, an adversary understanding the usage of regular building automation protocol functions for malicious purposes may not only create chaos within the breached building but can potentially even peak into internal networks over building protocols which are otherwise not reachable.

 This talk describes prototypic attack scenarios through building automation systems one should consider, and how even without exploits, a number of protocol functions in common building automation protocols like BACnet/IP and KNXnet/IP can support a malicious adversary going for those scenarious.

 For penetration testers who would like to explore this interesting field of industrial security research, we include a section on tooling. We will discuss noteworthy tools both from the security toolbox but also from the building automation toolbox for carrying out a number of attacks or their preparatory steps.

 We will close out talk by discussing existing security measures proposed by the building automation industry as well as their adoption problems found in this field.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Brandstetter-insecurity-In-Building-Automation-How-To-Create-Dark-Buildings-With-Light-Speed.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Brandstetter-insecurity-In-Building-Automation-How-To-Create-Dark-Buildings-With-Light-Speed-wp.pdf)

### Presented By

[Thomas Brandstetter](speakers/Thomas-Brandstetter.html)

---

## [A New Era of SSRF - Exploiting URL Parser in Trending Programming Languages!](#a-new-era-of-ssrf-exploiting-url-parser-in-trending-programming-languages "A New Era of SSRF - Exploiting URL Parser in Trending Programming Languages!")

We propose a new exploit technique that brings a whole-new attack surface to bypass SSRF (Server Side Request Forgery) protections. This is a very general attack approach, in which we used in combination with our own fuzzing tool to discover many 0days in built-in libraries of very widely-used programming languages, including Python, PHP, Perl, Ruby, Java, JavaScript, Wget and cURL. The root cause of the problem lies in the inconsistency of URL parsers and URL requesters.

Being a very fundamental problem that exists in built-in libraries, sophisticated web applications such as WordPress (27% of the Web), vBulletin, MyBB and GitHub can also suffer, and 0days have been discovered in them via this technique. This general technique can also adapt to various code contexts and lead to protocol smuggling and SSRF bypassing. Several scenarios will be demonstrated to illustrate how URL parsers can be exploited to bypass SSRF protection and achieve RCE (Remote Code Execution), which is the case in our GitHub Enterprise demo.

Understanding the basics of this technique, the audience won't be surprised to know that more than 20 vulnerabilities have been found in famous programming languages and web applications aforementioned via this technique.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf)

### Presented By

[Orange Tsai](speakers/Orange-Tsai.html)

---

## [Advanced Pre-Breach Planning: Utilizing a Purple Team to Measure Effectiveness vs. Maturity](#advanced-pre-breach-planning-utilizing-a-purple-team-to-measure-effectiveness-vs.-maturity "Advanced Pre-Breach Planning: Utilizing a Purple Team to Measure Effectiveness vs. Maturity")

For years, the cybersecurity industry has struggled with how to measure the cyber-readiness of an organization. While it is certainly a valid exercise to benchmark a cybersecurity program against a framework, such as NIST, these paper-work efforts articulate the **maturity.** To truly test the effectiveness of an organization's detect and response capabilities to a cyberattack, it's necessary to provide a sparring partner. This session will discuss the process of cycling the SOC and IR team through a realistic adversary simulation (from a prepared red team), and then observing the organization's response, from the eyes of an experienced blue team.

### Presented By

[Justin Harvey](speakers/Justin-Harvey.html)

---

## [Adventures in Attacking Wind Farm Control Networks](#adventures-in-attacking-wind-farm-control-networks "Adventures in Attacking Wind Farm Control Networks")

Wind farms are becoming a leading source for renewable energy. The increased reliance on wind energy makes wind farm control systems attractive targets for attackers. This talk explains how wind farm control networks work and how they can be attacked in order to negatively influence wind farm operations (e.g., wind turbine hijacking). Specifically, implementations of the IEC 61400-25 family of communications protocols are investigated (i.e., OPC XML-DA). This research is based on an empirical study of a variety of U.S. based wind farms conducted over a two year period. We explain how these security assessments reveal that wind farm vendor design and implementation flaws have left wind turbine programmable automation controllers and OPC servers vulnerable to attack. Additionally, proof-of-concept attack tools are developed in order to exploit wind farm control network design and implementation vulnerabilities.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Staggs-Adventures-In-Attacking-Wind-Farm-Control-Networks.pdf)

### Presented By

[Jason Staggs](speakers/Jason-Staggs.html)

---

## [All Your SMS & Contacts Belong to ADUPS & Others](#all-your-sms-and-contacts-belong-to-adups-and-others "All Your SMS & Contacts Belong to ADUPS & Others")

Our research has identified several models of Android mobile devices that contained firmware that collected sensitive personal data about their users and transmitted this sensitive data to third-party servers in China - without disclosure or the users' consent. These devices were available through major US-based online retailers (Amazon, BestBuy, for example) and included popular smartphones such as the BLU R1 HD and the BLU Life One X2. These devices actively transmitted user and device information including the full-body of text messages, call history with full telephone numbers, unique device identifiers including the International Mobile Subscriber Identity (IMSI), serial number, Media Access Control (MAC) address, and the International Mobile Equipment Identity (IMEI). The firmware could target specific users and text messages matching remotely-defined keywords. The firmware also collected and transmitted information about the use of applications installed on the monitored device, bypassed the Android permission model, executed remote commands with escalated (system) privileges, and was able to remotely reprogram the devices.

 The firmware that shipped with the mobile devices and subsequent updates allowed for the remote installation of applications without the users' consent and, in some versions of the software, the transmission of fine-grained device location information. The core of the monitoring activities took place using a commercial Firmware Over The Air (FOTA) update software system that was shipped with the Android devices we tested and were managed by a company named Shanghai Adups Technology Co. Ltd.
 Our findings are based on both code and network analysis of the firmware. The user and device information was collected automatically and transmitted periodically without the users' consent or knowledge. Some of the collected information was encrypted and then transmitted over secure web protocols to a server located in Shanghai. This software and behavior bypasses the detection of mobile anti-virus tools because they assume that software that ships with the device is not malware and thus, it is white-listed.

 In September 2016, Adups claimed on its web site to have a world-wide presence with over 700 million active users, and a market share exceeding 70% across over 150 countries and regions with offices in Shanghai, Shenzhen, Beijing, Tokyo, New Delhi, and Miami. The Adups web site also stated that it produces firmware that is integrated in more than 400 leading mobile operators, semiconductor vendors, and device manufacturers spanning from wearable and mobile devices to cars and televisions.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Johnson-All-Your-SMS-%26-Contacts-Belong-To-Adups-%26-Others.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Johnson-All-Your-SMS-%26-Contacts-Belong-To-Adups-%26-Others-wp.pdf)

### Presented By

[Ryan Johnson](speakers/Ryan-Johnson.html)
 &  [Angelos Stavrou](speakers/Angelos-Stavrou.html)
 &  [Azzedine Benameur](speakers/Azzedine-Benameur.html)

---

## [An ACE Up the Sleeve: Designing Active Directory DACL Backdoors](#an-ace-up-the-sleeve-designing-active-directory-dacl-backdoors "An ACE Up the Sleeve: Designing Active Directory DACL Backdoors")

Active Directory (AD) object discretionary access control lists (DACLs) are an untapped offensive landscape, often overlooked by attackers and defenders alike. The control relationships between AD objects align perfectly with the "attackers think in graphs" philosophy and expose an entire class of previously unseen control edges, dramatically expanding the number of paths to complete domain compromise.

 While DACL misconfigurations can provide numerous paths that facilitate elevation of domain rights, they also present a unique chance to covertly deploy Active Directory persistence. It's often difficult to determine whether a specific AD DACL misconfiguration was set intentionally or implemented by accident. This makes Active Directory DACL backdoors an excellent persistence opportunity: minimal forensic footprint, and maximum plausible deniability.

 This talk will cover Active Directory DACLs in depth, our "misconfiguration taxonomy," and enumeration/analysis with BloodHound's newly released feature set. We will cover the abuse of AD DACL misconfigurations for the purpose of domain rights elevation, including common misconfigurations encountered in the wild. We will then cover methods to design AD DACL backdoors, including ways to evade current detections, and will conclude with defensive mitigation/detection techniques for everything described.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Robbins-An-ACE-Up-The-Sleeve-Designing-Active-Directory-DACL-Backdoors-2018.pdf)

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Robbins-An-ACE-Up-The-Sleeve-Designing-Active-Directory-DACL-Backdoors-wp.pdf)

### Presented By

[Andy Robbins](speakers/Andy-Robbins.html)
 &  [Will Schroeder](speakers/Will-Schroeder.html)

---

## [And Then the Script-Kiddie Said Let There be No Light. Are Cyber-Attacks on the Power Grid Limited to Nation-State Actors?](#and-then-the-script-kiddie-said-let-there-be-no-light.-are-cyber-attacks-on-the-power-grid-limited-to-nation-state-actors "And Then the Script-Kiddie Said Let There be No Light. Are Cyber-Attacks on the Power Grid Limited to Nation-State Actors?")

Electricity is of paramount importance in our everyday lives. Our dependence on it is particularly evident during even brief power outages. You can think of power systems as the backbone of critical infrastructures. To date, cyber-attacks against power systems are considered to be extremely sophisticated and only within the reach of nation-states. However, through this presentation we will challenge this perception, and provide a structured methodology towards attacking a power system on a limited budget.

 When gathering information during the design phase of an attack, it is electrifying what you can find on the internet if you know what to look for. We will demonstrate information obtained from the web that can be leveraged to model and analyze a target power system, and how we can use this information to model power systems throughout the globe.

 However, this talk is not just about theory. We will demonstrate a critical vulnerability we discovered in General Electric Multilin products widely deployed in power systems. Essentially, we completely broke the home brew encryption algorithm used by these protection and management devices to authenticate users and allow privileged operations. Knowledge of the passcode enables an attacker to completely pwn the device and disconnect sectors of the power grid at will, locking operators out to prolong the attack. We will also show a technique for remotely fingerprinting affected devices over the network.

 The talk includes a live demo showcasing exploitation of the vulnerability on a feeder management relay and how this vulnerability can have significant impact on a nation. We will discuss mitigation strategies, including the specific firmware update that addresses this vulnerability, and provide our thoughts on what the next steps in securing the power infrastructure should be. Tune in for more.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Keliris-And-Then-The-Script-Kiddie-Said-Let-There-Be-No-Light-Are-Cyberattacks-On-The-Power-Grid-Limited-To-Nation-State-Actors-wp.pdf)

### Presented By

[Anastasis Keliris](speakers/Anastasis-Keliris.html)
 &  [Mihalis Maniatakos](speakers/Mihalis-Maniatakos.html)
 &  [Charalambos Konstantinou](speakers/Charalambos-Konstantinou.html)

---

## [Attacking Encrypted USB Keys the Hard(ware) Way](#attacking-encrypted-usb-keys-the-hardware-way "Attacking Encrypted USB Keys the Hard(ware) Way")

Ever wondered if your new shiny AES hardware-encrypted USB device really encrypts your data - or is just a fluke? If you have, come to our talk to find out if those products live up to the hype and hear about the results of the audit we conducted on multiples USB keys and hard drives that claim to securely encrypt data.

 In this talk, we will present our methodology to assess "secure" USB devices both from the software and the hardware perspectives. We will demonstrate how this methodology works in practice via a set of case-studies. We will demonstrate some of the practical attacks we found during our audit so you will learn what type of vulnerability to look for and how to exploit them. Armed with this knowledge and our tools, you will be able to evaluate the security of the USB device of your choice.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Picod-Attacking-Encrypted-USB-Keys-The-Hard%28ware%29-Way.pdf)

### Presented By

[Jean-Michel Picod](speakers/Jean-Michel-Picod.html)
 &  [RÃ©mi Audebert](speakers/R%C3%83%C2%A9mi-Audebert.html)
 &  [Elie Bursztein](speakers/Elie-Bursztein.html)

---

## [Automated Detection of Vulnerabilities in Black-Box Routers (and Other Network Devices)](#automated-detection-of-vulnerabilities-in-black-box-routers-and-other-network-devices "Automated Detection of Vulnerabilities in Black-Box Routers (and Other Network Devices)")

Network protocols are based on open standards. However, the Internet runs mostly on proprietary and closed-source network devices such as routers and switches of big-name vendors like Cisco. A slight deviation in a vendor's implementation of a standard protocol may weaken the robustness and security of the protocol, thus creating a logical vulnerability an attacker may be able to exploit. Such logical vulnerabilities will likely affect many models of devices made by that vendor. However, finding these logical vulnerabilities in protocol implementations of routers demands great efforts to reverse-engineer them.

In this work, we present a method that leverages a formal black-box method to unearth deviations of protocol implementations in closed-source network devices with no need to access the binary or source code of the device. Our method finds such deviations in a fully automatic manner while leveraging a model-based testing approach. We applied the method to several routers to check their routing protocols' implementations (specifically OSPF) using the tool we found logical vulnerabilities in routers by Cisco and Quagga. The vulnerabilities affect in total dozens of models of routers. This is a joint work with Adi Sosnovich and Orna Grumberg.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Nakibly-Automated-Detection-of-Vulnerabilities-in-Black-Box-Routers.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](us-17-Nakibly-Automated-Detection-of-Vulnerabilities-in-Black-Box-Routers-wp.pdf)

### Presented By

[Gabi Nakibly](speakers/Gabi-Nakibly.html)

---

## [Automated Testing of Crypto Software Using Differential Fuzzing](#automated-testing-of-crypto-software-using-differential-fuzzing "Automated Testing of Crypto Software Using Differential Fuzzing")

We present a new and efficient approach to systematic testing of cryptographic software: differential fuzzing. Unlike general purpose software fuzzing such as afl, differential fuzzing doesn't aim to find memory corruption bugs (although they might come as a by-product), but to find logic bugs. Compared to test vectors, differential fuzzing provides greater code coverage. Compared to formal verification, differential fuzzing is easier to apply, both for testers and developers.

 We'll release CDF, a tool that implements differential fuzzing for most common cryptographic APIs: RSA encryption and signatures, elliptic-curve cryptography, or any symmetric-key schemes through a unified interface. CDF combines differential fuzzing with a number of unit tests to detect vulnerabilities specific to the cryptographic functions tested. It can also detect timing leaks, thanks to state-of-the-art leakage detection techniques.

 CDF is coded in Go, and is trivially portable to various CPU architectures. Unlike other tools, CDF runs its tests in a totally black-box fashion: no source code is needed, you only need an executable file such as a binary program, Python script, or shell script calling a remote service.

 We ran CDF on high-profile, widely used crypto software components. CDF discovered issues in a number of libraries including Go's crypto package, OpenSSL, and mbedTLS.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Aumasson-Automated-Testing-Of-Crypto-Software-Using-Differential-Fuzzing.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_source-code.png "Presentation")](https://github.com/kudelskisecurity/cdf)

### Presented By

[Jean-Philippe Aumasson](speakers/Jean-Philippe-Aumasson.html)
 &  [Yolan Romailler](speakers/Yolan-Romailler.html)

---

## [AVPASS: Leaking and Bypassing Antivirus Detection Model Automatically](#avpass-leaking-and-bypassing-antivirus-detection-model-automatically "AVPASS: Leaking and Bypassing Antivirus Detection Model Automatically")

AVPASS is a tool for leaking the detection model of Android antivirus (AV) programs, and bypassing the AV detection by using the leaked information coupled with APK perturbation techniques. AVPASS is able to infer not only the detection features, but also hierarchy of detection rule chains. With help from the leaked model and the built-in APK perturbation functions, AVPASS is able to disguise any android malware as a benign application. Furthermore, using our novel additive mode, AVPASS supports safe querying and guarantees that one can test if the application will be detected by the AV without sending the whole or core parts of application. As a result, AVPASS leaked significant detection features of commercial AVs and achieved almost zero detection from VirusTotal when tested with more than 5,000 malware.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Jung-AVPASS-Leaking-And-Bypassing-Anitvirus-Detection-Model-Automatically.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_source-code.png "Presentation")](https://github.com/sslab-gatech/avpass)

### Presented By

[Jinho Jung](speakers/Jinho-Jung.html)
 &  [Chanil Jeon](speakers/Chanil-Jeon.html)
 &  [Max Wolotsky](speakers/Max-Wolotsky.html)
 &  [Insu Yun](speakers/Insu-Yun.html)
 &  [Taesoo Kim](speakers/Taesoo-Kim.html)

---

## [Behind the Plexiglass Curtain: Stats and Stories from the Black Hat NOC](#behind-the-plexiglass-curtain-stats-and-stories-from-the-black-hat-noc "Behind the Plexiglass Curtain: Stats and Stories from the Black Hat NOC")

There's always a lot to say about the Black Hat network. Some of it's true, some of it...not so much. Whether you're confidently connected with your own devices, or you're on your burner laptop, burner phone, and wearing a tinfoil hat, you've likely thought to yourself "What the hell did I just connect to?" Join us for the annual Black Hat network debrief. We'll let you know all the stats and stories from behind the plexiglass curtain.

### Presented By

[Neil Wyler](speakers/Neil-Wyler.html)
 &  [Bart Stump](speakers/Bart-Stump.html)

---

## [Betraying the BIOS: Where the Guardians of the BIOS are Failing](#betraying-the-bios-where-the-guardians-of-the-bios-are-failing "Betraying the BIOS: Where the Guardians of the BIOS are Failing")

For UEFI firmware, the barbarians are at the gate -- and the gate is open. On the one hand, well-intentioned researchers are increasingly active in the UEFI security space; on the other hand, so are attackers. Information about UEFI implants -- by HackingTeam and state-sponsored actors alike -- hints at the magnitude of the problem, but are these isolated incidents, or are they indicative of a more dire lapse in security? Just how breachable is the BIOS?

In this presentation, I'll explain UEFI security from the competing perspectives of attacker and defender. I'll cover topics including how hardware vendors have left SMM and SPI flash memory wide open to rootkits; how UEFI rootkits work, how technologies such as Intel Boot Guard and BIOS Guard (and the separate Authenticated Code Module CPU) aim to kill them; and weaknesses in these protective technologies. There are few public details; most of this information has been extracted by reverse engineering.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Matrosov-Betraying-The-BIOS-Where-The-Guardians-Of-The-BIOS-Are-Failing.pdf)

### Presented By

[Alex Matrosov](speakers/Alex-Matrosov.html)

---

## [Big Game Theory Hunting: The Peculiarities of Human Behavior in the InfoSec Game](#big-game-theory-hunting-the-peculiarities-of-human-behavior-in-the-infosec-game "Big Game Theory Hunting: The Peculiarities of Human Behavior in the InfoSec Game")

We all groan when we hear it's "time for some game theory," but traditional game theory â modelling conflict and cooperation between rational decision-makers â still pervades how we think of defensive strategy as an industry. This primitive analysis is a disservice to defenders, who are facing humans (and who are, in fact, humans themselves), but are modelling their own actions and opponent's actions based on the assumption of machine-like behavior.

 In this session, I will examine traditional game theory and propose why behavioral game theory should take its place in the philosophy of defense. Next, I'll review the first principles of game theory, through the lens of behavioral game theory, which empirically measures how humans actually behave in games, rather than assumes they will behave coldly rational.

 I'll explain the "rules" of the information security game and how traditional game theory is poorly suited to those conditions, along with the various behavioral models and why they are a superior fit. I'll then explore the two primarily methods that play into how humans make decisions in games â "thinking" and "learning" and what empirical data from behavioral game theory studies suggests on how to improve thinking and learning, extrapolating to applications for infosec defenders.

 Finally, I'll present new insights from my own research, examining how defenders and attackers play the infosec game specifically, and bridging from theory to practice, to see how the lessons from behavioral game theory can be tangibly incorporated into defenders' strategic decision making processes. I'll conclude the session by outlining the practical steps for improving threat modelling, countering offensive moves, and deciding which products to use, so that defenders can start gaining the high ground in the infosec game.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Shortridge-Big-Game-Theory-Hunting-The-Peculiarities-Of-Human-Behavior-In-The-Infosec-Game.pdf)

### Presented By

[Kelly Shortridge](speakers/Kelly-Shortridge.html)

---

## [Blue Pill for Your Phone](#blue-pill-for-your-phone "Blue Pill for Your Phone")

In this research, we've explored attack surface of hypervisors and TrustZone monitor in modern ARM based phones, using Google Nexus 5X, Nexus 6P, and Pixel as primary targets. We will explain different attack scenarios using SMC and other interfaces, as well as interaction methods between TrustZone and hypervisor privilege levels.

 We will explore attack vectors which could allow malicious operating system (EL1) level to escalate privileges to hypervisor (EL2) level and potentially install virtualization rootkit in the hypervisor. We will also explore attack vectors through SMC and other low level interfaces, interactions between TrustZone and hypervisor (EL2) privilege levels. To help with further low level ARM security research, we will release ARM support for CHIPSEC framework and new modules to test issues in ARM based hypervisors and TrustZone implementations, including SMC fuzzer.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Bazhaniuk-BluePill-For-Your-Phone.pdf)

### Presented By

[Oleksandr Bazhaniuk](speakers/Oleksandr-Bazhaniuk.html)
 &  [Yuriy Bulygin](speakers/Yuriy-Bulygin.html)

---

## [Bochspwn Reloaded: Detecting Kernel Memory Disclosure with x86 Emulation and Taint Tracking](#bochspwn-reloaded-detecting-kernel-memory-disclosure-with-x86-emulation-and-taint-tracking "Bochspwn Reloaded: Detecting Kernel Memory Disclosure with x86 Emulation and Taint Tracking")

In kernel-mode, buffer overflows and similar memory corruption issues in the internal logic are usually self-evident and can be detected with a number of static and dynamic approaches. On the contrary, flaws directly related to interactions with user-mode clients tend to be more subtle, and can survive unnoticed for many years, while still providing primitives similar to the classic bugs. One example of such flaws are so-called "double fetches" â repeated accesses to single user-mode memory units within the same semantic contexts, with the assumption that their values don't change in between the reads. These are race conditions which can be often exploited to achieve memory corruption, write-what-where conditions and other dangerous primitives; yet they never manifest themselves at runtime, unless being actively exploited. In 2013, Gynvael and I devised a project called "Bochspwn", which was used to discover at least 37 double fetches in the Windows kernel, by employing a custom full-system instrumentation built on top of the Bochs x86 emulator.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Jurczyk-Bochspwn-Reloaded-Detecting-Kernel-Memory-Disclosure-With-X86-Emulation-And-Taint-Tracking.pdf)

### Presented By

[Mateusz Jurczyk](speakers/Mateusz-Jurczyk.html)

---

## [Bot vs. Bot for Evading Machine Learning Malware Detection](#bot-vs.-bot-for-evading-machine-learning-malware-detection "Bot vs. Bot for Evading Machine Learning Malware Detection")

Machine learning offers opportunities to improve malware detection because of its ability to generalize to never-before-seen malware families and polymorphic strains. This has resulted in its practical use for either primary detection engines or supplementary heuristic detections by AV vendors. However, machine learning is also especially susceptible to evasion attacks by, ironically but unsurprisingly, other machine learning methods. We demonstrate how to evade machine learning malware detection by setting up an AI agent to compete against the malware detector that proactively probes it for blind spots that can be exploited. We focus on static Windows PE malware evasion, but the framework is generic and could be extended to other domains.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Anderson-Bot-Vs-Bot-Evading-Machine-Learning-Malware-Detection.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Anderson-Bot-Vs-Bot-Evading-Machine-Learning-Malware-Detection-wp.pdf)

### Presented By

[Hyrum Anderson](speakers/Hyrum-Anderson.html)

---

## [Break](#break "Break")

---

## [Breakfast (Sponsored by FireEye McAfee Qualys & Tenable Network Security)](#breakfast-sponsored-by-fireeye-mcafee-qualys-and-tenable-network-security "Breakfast (Sponsored by FireEye McAfee Qualys & Tenable Network Security)")

---

## [Breaking Electronic Door Locks Like You're on CSI: Cyber](#breaking-electronic-door-locks-like-youre-on-csi-cyber "Breaking Electronic Door Locks Like You\'re on CSI: Cyber")

Breaking electronic locks looks so fun in the movies â get your "tech wizard" member of the team to plug some gadget into the control panel on the locked door, the gadget scrolls through all the combinations, and then the door opens. The hardest part is figuring out what cool catch-phrase you'll use when the door opens.

 Why can't real life be like this? This talk will look at a few consumer grade electronic locks, and aims to break them like you'd see in the movies (roughly). Along the way it features a detailed tear-down of the electronics on these locks & discuss vulnerabilities a hardware hacker can exploit to bypass them.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-OFlynn-Breaking-Electronic-Locks.pdf)

### Presented By

[Colin O'Flynn](speakers/Colin-OFlynn.html)

---

## [Breaking the Laws of Robotics: Attacking Industrial Robots](#breaking-the-laws-of-robotics-attacking-industrial-robots "Breaking the Laws of Robotics: Attacking Industrial Robots")

Industrial robots are complex cyber-physical systems used for manufacturing, and a critical component of any modern factory. These robots aren't just electromechanical devices but include complex embedded controllers, which are often interconnected with other computers in the factory network, safety systems, and to the Internet for remote monitoring and maintenance. In this scenario, industrial routers also play a key role, because they directly expose the robot's controller. Therefore, the impact of a single, simple vulnerability can grant attackers an easy entry point.

 Industrial robots must follow three fundamental laws: accurately "read" from the physical world through sensors and "write" (i.e. perform actions) through actuators, refuse to execute self-damaging control logic, and most importantly, echoing Asimov, never harm humans. By combining a set of vulnerabilities we discovered on a real robot, we will demonstrate how remote attackers are able to violate such fundamental laws up to the point where they can alter the manufactured product, physically damage the robot, steal industry secrets, or injure humans.

 We will cover in-depth technical aspects (e.g., reverse engineering and vulnerability details, and attack PoCs), alongside a broader discussion on the security posture of industrial routers and robots: Why these devices are attractive for attackers? What could they achieve? Are they hard to compromise? How can their security be improved?

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Quarta-Breaking-The-Laws-Of-Robotics-Attacking-Industrial-Robots.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Quarta-Breaking-The-Laws-Of-Robotics-Attacking-Industrial-Robots-wp.pdf)

### Presented By

[Davide Quarta](speakers/Davide-Quarta.html)
 &  [Marcello Pogliani](speakers/Marcello-Pogliani.html)
 &  [Mario Polino](speakers/Mario-Polino.html)
 &  [Federico Maggi](speakers/Federico-Maggi.html)
 &  [Andrea Maria Zanchettin](speakers/Andrea-Maria-Zanchettin.html)
 &  [Stefano Zanero](speakers/Stefano-Zanero.html)

---

## [Breaking the x86 Instruction Set](#breaking-the-x86-instruction-set "Breaking the x86 Instruction Set")

A processor is not a trusted black box for running code; on the contrary, modern x86 chips are packed full of secret instructions and hardware bugs. In this talk, we'll demonstrate how page fault analysis and some creative processor fuzzing can be used to exhaustively search the x86 instruction set and uncover the secrets buried in your chipset. We'll disclose new x86 hardware glitches, previously unknown machine instructions, ubiquitous software bugs, and flaws in enterprise hypervisors. Best of all, we'll release our sandsifter toolset, so that you can audit - and break - your own processor.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Domas-Breaking-The-x86-ISA.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Domas-Breaking-The-x86-Instruction-Set-wp.pdf)

### Presented By

[Christopher Domas](speakers/Christopher-Domas.html)

---

## [Broadpwn: Remotely Compromising Android and iOS via a Bug in Broadcom's Wi-Fi Chipsets](#broadpwn-remotely-compromising-android-and-ios-via-a-bug-in-broadcoms-wi-fi-chipsets "Broadpwn: Remotely Compromising Android and iOS via a Bug in Broadcom\'s Wi-Fi Chipsets")

Remote exploits that compromise Android and iOS devices without user interaction have become an endangered species in recent years. Such exploits present a unique challenge: Without access to the rich scripting environment of the browser, exploit developers have been having a hard time bypassing mitigations such as DEP and ASLR.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Artenstein-Broadpwn-Remotely-Compromising-Android-And-iOS-Via-A-Bug-In-Broadcoms-Wifi-Chipsets.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Artenstein-Broadpwn-Remotely-Compromising-Android-And-iOS-Via-A-Bug-In-Broadcoms-Wifi-Chipsets-wp.pdf)

### Presented By

[Nitay Artenstein](speakers/Nitay-Artenstein.html)

---

## [Bug Collisions Meet Government Vulnerability Disclosure](#bug-collisions-meet-government-vulnerability-disclosure "Bug Collisions Meet Government Vulnerability Disclosure")

How often does someone find your secret bugs? The Vulnerability Equities Process (VEP) helps determine if a software vulnerability known to the U.S. government will be disclosed or kept secret. A key part of that calculation is the likelihood that some other party may have found the same vulnerability. Yet, for years there has been little to no good analysis to say how often two parties independently discover the same vulnerability.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Herr-Bug-Collisions-Meet-Government-Vulnerability-Disclosure.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Ablon-Bug-Collisions-Meet-Government-Vulnerability-Disclosure-Zero-Days-Thousands-Of-Nights-RAND.pdf)

### Presented By

[Trey Herr](speakers/Trey-Herr.html)
 &  [Jason Healey](speakers/Jason-Healey.html)
 &  [Kim Zetter](speakers/Kim-Zetter.html)
 &  [Lillian Ablon](speakers/Lillian-Ablon.html)
 &  [Katie Moussouris](speakers/Katie-Moussouris.html)

---

## [Business Hall Welcome Reception (Sponsored by Forcepoint McAfee LogRhythm & Tenable Network Security)](#business-hall-welcome-reception-sponsored-by-forcepoint-mcafee-logrhythm-and-tenable-network-security "Business Hall Welcome Reception (Sponsored by Forcepoint McAfee LogRhythm & Tenable Network Security)")

---

## [Challenges of Cooperation Across Cyberspace](#challenges-of-cooperation-across-cyberspace "Challenges of Cooperation Across Cyberspace")

Cyberspace is formed and governed by a range of different technical and policy communities. A major challenge is insufficient awareness and mutual acceptance among the various communities. The traditional government dialogues on international security, for instance within the United Nations, have struggled to work with this reality when addressing issues of war and peace in cyberspace.

During this talk, the Chair and Commissioners of the recently established Global Commission on the Stability of Cyberspace (GCSC) will address the challenges of cooperating across different communities when addressing issues of international security and cyberspace. Commissioners with backgrounds in information security, Internet governance, diplomacy, international relations and law enforcement will comment on why it is important that their respective communities cooperate outside of their own silos, what the main barriers are, and how these can be overcome.

The Commission brings together stakeholders from the international security and cyberspace communities to develop proposals for norms and policies to guide responsible state and non-state behavior in cyberspace.

### Presented By

[Jeff Moss](speakers/Jeff-Moss.html)
 &  [Marina Kaljurand](speakers/Marina-Kaljurand.html)
 &  [Joseph Nye](speakers/Joseph-Nye.html)
 &  [Bill Woodcock](speakers/Bill-Woodcock.html)
 &  [Khoo Boon Hui](speakers/Khoo-Boon-Hui.html)
 &  [Wolfgang Kleinwachter](speakers/Wolfgang-Kleinwachter.html)

---

## [Champagne Toast (Sponsored by ESET North America Fidelis Cybersecurity Fortinet Leidos Palo Alto Networks Raytheon & Symantec)](#champagne-toast-sponsored-by-eset-north-america-fidelis-cybersecurity-fortinet-leidos-palo-alto-networks-raytheon-and-symantec "Champagne Toast (Sponsored by ESET North America Fidelis Cybersecurity Fortinet Leidos Palo Alto Networks Raytheon & Symantec)")

---

## [Cloak & Dagger: From Two Permissions to Complete Control of the UI Feedback Loop](#cloak-and-dagger-from-two-permissions-to-complete-control-of-the-ui-feedback-loop "Cloak & Dagger: From Two Permissions to Complete Control of the UI Feedback Loop")

While both the SYSTEM\_ALERT\_WINDOW and the BIND\_ACCESSIBILITY\_SERVICE Android permissions have been abused individually (e.g., in UI redressing attacks, accessibility attacks), previous attacks based on these permissions failed to completely control the UI feedback loop and thus either rely on vanishing side-channels to time the appearance of overlay UI, cannot respond properly to user input, or make the attacks literally visible. In this work, we demonstrate how combining the capabilities of these permissions leads to complete control of the UI feedback loop and creates devastating and stealthy attacks. In particular, we demonstrate how an app with these two permissions can launch a variety of stealthy, powerful attacks, ranging from stealing user's login credentials and security PIN, to the silent installation of a God-like app with all permissions enabled. To make things even worse, we note that when installing an app targeting a recent Android SDK, the list of its required permissions is not shown to the user and that these attacks can be carried out without needing to lure the user to knowingly enable any permission, thus leaving him completely unsuspecting. In fact, we found that the SYSTEM\_ALERT\_WINDOW permission is automatically granted for apps installed from the Play Store and, even though the BIND\_ACCESSIBILITY\_SERVICE is not automatically granted, our experiment shows that it is very easy to lure users to unknowingly grant that permission by abusing capabilities from the SYSTEM\_ALERT\_WINDOW permission. We also found that it is straightforward to get a proof-of-concept app requiring both permissions accepted on the official store. We evaluated the practicality of these attacks by performing a user study: none of the 20 human subjects that took part of the experiment even suspected they had been attacked. We conclude with a number of observations and best-practices that Google and developers can adopt to secure the Android GUI.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Fratantonio-Cloak-And-Dagger-From-Two-Permissions-To-Complete-Control-Of-The-UI-Feedback-Loop.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Fratantonio-Cloak-And-Dagger-From-Two-Permissions-To-Complete-Control-Of-The-UI-Feedback-Loop-wp.pdf)

### Presented By

[Yanick Fratantonio](speakers/Yanick-Fratantonio.html)
 &  [Chenxiong Qian](speakers/Chenxiong-Qian.html)
 &  [Simon Pak Ho Chung](speakers/Simon-Pak-Ho-Chung.html)
 &  [Wenke Lee](speakers/Wenke-Lee.html)

---

## [Coffee Service](#coffee-service "Coffee Service")

---

## [Cracking the Lens: Targeting HTTP's Hidden Attack-Surface](#cracking-the-lens-targeting-https-hidden-attack-surface "Cracking the Lens: Targeting HTTP\'s Hidden Attack-Surface")

Modern websites are browsed through a lens of transparent systems built to enhance performance, extract analytics and supply numerous additional services. This almost invisible attack surface has been largely overlooked for years.

 In this presentation, I'll show how to use malformed requests and esoteric headers to coax these systems into revealing themselves and opening gateways into our victim's networks. I'll share how by combining these techniques with a little Bash I was able to thoroughly perforate DoD networks, trivially earn over $30k in vulnerability bounties, and accidentally exploit my own ISP.

 While deconstructing the damage, I'll also showcase several hidden systems it unveiled, including not only covert request interception by the UK's largest ISP, but a substantially more suspicious Columbian ISP, a confused Tor backend, and a system that enabled reflected XSS to be escalated into SSRF. You'll also learn strategies to unblinker blind SSRF using exploit chains and caching mechanisms.

 Finally, to further drag these systems out into the light, I'll release Collaborator Everywhere - an open source Burp Suite extension which augments your web traffic with a selection of the best techniques to harvest leads from cooperative websites.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Kettle-Cracking-The-Lens-Exploiting-HTTPs-Hidden-Attack-Surface.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Kettle-Cracking-The-Lens-Exploiting-HTTPs-Hidden-Attack-Surface-wp.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_source-code.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Kettle-Cracking-The-Lens-Exploiting-HTTPs-Hidden-Attack-Surface-tool.zip)

### Presented By

[James Kettle](speakers/James-Kettle.html)

---

## [Cyber Wargaming: Lessons Learned in Influencing Security Stakeholders Inside and Outside Your Organization](#cyber-wargaming-lessons-learned-in-influencing-security-stakeholders-inside-and-outside-your-organization "Cyber Wargaming: Lessons Learned in Influencing Security Stakeholders Inside and Outside Your Organization")

The security industry faces a tough and growing problem: many of the fundamental decisions made which affect security are made by people that don't have the right cyber skills or experiences. This talk describes how the creation of a realistic, hands-on wargame environment can be leveraged to not only teach participants about attack and defense but to enable other organizational advantages.

 The game environment puts two attacking teams competing in parallel with a single defending team, with all teams evaluated and scored. The game environment role-plays different attack motivation, technique and mindset with one team playing as hactivists and the other playing as nation state. The defending team manages a diverse mix of IT and OT assets, including an emulated oil refinery comprised of SCADA and HMI using industrial control protocol communications. And, the game leverages the human dimension, inclusive of insider threat and social engineering.

 The game is 2.5 hours start to finish, comprised of short intro brief, teams then move to their operations areas where they are given team briefings, then an hour of gameplay, concluding with team post-briefs. Winning teams often are those that communicate best. The defending team has the most scoring opportunity but faces the toughest challenges.

 This talk will present the technical architecture of the game environment for technical attendees interested in building their own. Our talk will present business value to the game for non-technical attendees interested in promoting their organizational capability, building brand awareness, or creating a customer-oriented training service. And, we will show screenshots, videos and detailed diagrams giving all attendees a close view of how the game is built and delivered.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Nichols-Cyber-Wargaming-Lessons-Learned-In-Influencing-Stakeholders-Inside-And-Outside-Your-Organization.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Nichols-Cyber-Wargaming-Lessons-Learned-In-Influencing-Stakeholders-Inside-And-Outside-Your-Organization-wp.pdf)

### Presented By

[Jason Nichols](speakers/Jason-Nichols.html)

---

## [Datacenter Orchestration Security and Insecurity: Assessing Kubernetes Mesos and Docker at Scale](#datacenter-orchestration-security-and-insecurity-assessing-kubernetes-mesos-and-docker-at-scale "Datacenter Orchestration Security and Insecurity: Assessing Kubernetes Mesos and Docker at Scale")

Your datacenter isn't a bunch of computers, it is \*a\* computer. While some large organizations have over a decade of experience running software-defined datacenters at massive scale, many more large organizations are just now laying the foundations for their own cloud-scale platforms based on similar ideas. Datacenter-level operating systems such as Kubernetes, Mesos, and Docker Enterprise significantly change both the computing and security paradigms of modern production environments, whether they are in the cloud, on-premises, or a hybrid of the two. The focus of a lot of security attention related to containers and DevOps has been on the kernel-level isolation mechanisms, but these modern datacenter orchestration systems make single-node privilege escalation and persistence significantly less useful. We'll go over the background of what security benefits modern datacenter-level orchestration systems provide and what challenges they also bring along with them. We'll also discuss how to think about attacking and defending entire clusters vs. single machines and what common attack patterns (privilege escalation, lateral movement, persistence) look like specific to the orchestration layers instead of through the traditional native operating systems.

### Presented By

[Dino Dai Zovi](speakers/Dino-Dai-Zovi.html)

---

## [Defeating Samsung KNOX with Zero Privilege](#defeating-samsung-knox-with-zero-privilege "Defeating Samsung KNOX with Zero Privilege")

The story started mid-2016 by exploiting CVE-2016-6787 (found by myself) and rooting large numbers of Android devices shipped with 3.18 Linux kernel. However, we realized that our exploit wasn't working on Samsung Galaxy S7 Edge; the usual way we used to bypass KNOX on Galaxy S6 had expired.

After KeenLab successfully worked out several rooting solutions on many old Samsung smartphones in past two years, Samsung KNOX unsurprisingly enforced Galaxy S7 series. This time, KNOX introduced the Data Flow Integrity (DFI) as a part of its Real time Kernel Protection (RKP) implemented in TrustZone. KNOX RKP tried to use DFI to prevent a process which has compromised the Linux kernel from gaining root privilege. Furthermore, KNOX introduced KASLR as an additional mitigation. KNOX also removed the global variable "selinux enforce" in kernel, and permissive domain is not permitted - this means SELinux cannot be disabled or inserted a permissive domain even if you have already achieve kernel code execution.

In this talk I will describe how I used an exploit chain to defeat the new Samsung KNOX with zero privilege (exploit chain can be executed by any untrusted application), including KASLR bypassing, DFI bypassing, SELinux fully bypassing and privilege escalation. All details of vulnerabilities and mitigation bypassing techniques will be given during the presentation.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Shen-Defeating-Samsung-KNOX-With-Zero-Privilege.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Shen-Defeating-Samsung-KNOX-With-Zero-Privilege-wp.pdf)

### Presented By

[Di Shen](speakers/Di-Shen.html)

---

## [Delivering Javascript to World+Dog](#delivering-javascript-to-world-plusdog "Delivering Javascript to World+Dog")

You've joined a startup building the next big enterprise unicorn. The product is delivered as javascript on all of your customers' websites. What could go wrong? The threat model of serving third party javascript all over the web will be reviewed. There's plenty of room for small engineering mistakes that lead to pwn-once, exploit everywhere fail. Strategies for focusing your SDL on these flaws will be discussed.

 Next, defenses in key points of the delivery architecture will be explored, from the SaaS platform to CDNs to browsers. Now for the money - what does it take to convince customers to serve your code? It's a big leap of faith for customers to trust you and your arbitrary javascript on their site. The deeper their pockets are, the higher they set the bar for you throughout your architecture. What do they expect in your SDL? Finally, how do you sell this in your organization? Going beyond SDL best practices, strategies for building a product & engineering culture of protecting javascript delivery will be shared.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Randolph-Delivering-Javascript-to-World-Plus-Dog.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Randolph-Delivering-Javascript-to-World-Plus-Dog-wp.pdf)

### Presented By

[Kyle Randolph](speakers/Kyle-Randolph.html)

---

## [Developing Trust and Gitting Betrayed](#developing-trust-and-gitting-betrayed "Developing Trust and Gitting Betrayed")

Trust is an implicit requirement of doing business - at some point, we must trust employees, peers, and technology to a degree. The lack of proper management or understanding of these various trust relationships is a leading cause of security exposure. This talk will cover the analysis and exploitation of the trust relationships between code, platforms, developers, and their parent organization. We will look at the software development life cycle and how it can be actively exploited to attack, evade defenses, and ultimately own a target organization.

 To support our discussion of attacking trust relationships, we will also be releasing and presenting GitPwnd, a tool to aid network penetration testers in compromising machines and spreading control within development-heavy environments. These environments tend to have heavily segmented networks and extensive logging and monitoring. Defensive tools often look for process activity and timing that differs from normal user behavior. GitPwnd evades these defenses by inserting itself into common development workflows. We'll describe GitPwnd's architecture, implementation choices to evade detection, and we'll conclude with a live demo of GitPwnd worming through a segmented network.

### Presented By

[Clint Gibler](speakers/Clint-Gibler.html)
 &  [Noah Beddome](speakers/Noah-Beddome.html)

---

## [Digital Vengeance: Exploiting the Most Notorious C&C Toolkits](#digital-vengeance-exploiting-the-most-notorious-candc-toolkits "Digital Vengeance: Exploiting the Most Notorious C&C Toolkits")

Every year thousands of organizations are compromised by targeted attacks. In many cases the attacks are labeled as advanced and persistent which suggests a high level of sophistication in the attack and tools used. Many times, this title is leveraged as an excuse that the events were inevitable or irresistible, as if the assailants' skill set is well beyond what defenders are capable of. To the contrary, often these assailants are not as untouchable as many would believe.

 If one looks at the many APT reports that have been released over the years, some clear patterns start to emerge. A small number of Remote Administration Tools (RATs) are preferred by actors and reused across multiple campaigns. Frequently sited tools include Gh0st RAT, Korplug/Plug-X, and XtremeRAT among others. Upon examination, the command and control components of these notorious RATs are riddled with vulnerabilities. Vulnerabilities that can be exploited to turn the tables from hunter to hunted.

 Although the material in this talk will provide tools for launching an offensive against attackers, this talk is not intended to be an instructional for hacking back. The ethics and legality of counter attacks will be touched on only briefly as that is a discussion beyond the scope of this talk.

 The presentation will disclose several exploits that could allow remote execution or remote information disclosure on computers running these well-known C&C components. It should serve as a warning to those actors who utilize such toolsets. That is to say, such actors live in glass houses and should stop throwing stones.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Grange-Digital-Vengeance-Exploiting-The-Most-Notorious-C%26C-Toolkits.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Grange-Digital-Vengeance-Exploiting-The-Most-Notorious-C%26C-Toolkits-wp.pdf)

### Presented By

[Waylon Grange](speakers/Waylon-Grange.html)

---

## [Don't Trust the DOM: Bypassing XSS Mitigations via Script Gadgets](#dont-trust-the-dom-bypassing-xss-mitigations-via-script-gadgets "Don\'t Trust the DOM: Bypassing XSS Mitigations via Script Gadgets")

Cross-Site Scripting is a constant problem of the Web platform. Over the years many techniques have been introduced to prevent or mitigate XSS. Most of these techniques, thereby, focus on script tags and event handlers. HTML sanitizers, for example, aim at removing potentially dangerous tags and attributes. Another example is the Content Security Policy, which forbids inline event handlers and aims at white listing of legitimate scripts.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Lekies-Dont-Trust-The-DOM-Bypassing-XSS-Mitigations-Via-Script-Gadgets.pdf)

### Presented By

[Sebastian Lekies](speakers/Sebastian-Lekies.html)
 &  [Krzysztof Kotowicz](speakers/Krzysztof-Kotowicz.html)
 &  [Eduardo Vela](speakers/Eduardo-Vela.html)

---

## [Electronegativity - A Study of Electron Security](#electronegativity-a-study-of-electron-security "Electronegativity - A Study of Electron Security")

Despite all predictions, native Desktop apps are back. After years porting stand-alone apps to the web, we are witnessing an inverse trend. Many companies have started providing native desktop apps built using the same technologies as their web counterparts. In this trend, Github's Electron has become a popular framework to build cross-platform desktop apps with JavaScript, HTML, and CSS. While it seems to be easy, embedding a webapp in a self-contained web environment (Chromium, Node.Js) introduces new security challenges.

 In this presentation, we will illustrate Electron's security model and describe current isolation mechanisms to prevent untrusted content from using Node.js primitives. Electron's IPC messaging, preloading and other internals will be comprehensively discussed. BrowserWindow and WebView security-relevant options will be also analyzed, together with design-level weaknesses and implementation bugs in Electron-based applications.

 As part of our study of Electron security, we have mapped the overall attack surface and derived a comprehensive checklist of anti-patterns. A new tool (electronegativity) to facilitate testing of Electron-based apps will be released.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Carettoni-Electronegativity-A-Study-Of-Electron-Security.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Carettoni-Electronegativity-A-Study-Of-Electron-Security-wp.pdf)

### Presented By

[Luca Carettoni](speakers/Luca-Carettoni.html)

---

## [Escalating Insider Threats Using VMware's API](#escalating-insider-threats-using-vmwares-api "Escalating Insider Threats Using VMware\'s API")

Enterprises often require that their IT teams have no access to data kept inside the machines they administer, a separation that is crucial for compliance, privacy and defense in depth. To this end, industries use VMWare's rich security model to separate the infrastructure domain from the guest machine domain. For example, most companies allow their IT teams to create, modify, backup and delete guest machines, but deny them guest machine operation functions such as file manipulation and console interaction.

 The VMWare VIX API allows users with the required vSphere permissions to automate guest operations functions across VMWare platform products. Using VIX to interact with a virtual machine requires the administrator to go through two distinct security domains: 1) The vSphere host; 2) The guest operating system. With this two step authentication, even high vSphere permissions wouldn't necessarily allow interaction with guest machines.

 VIX contains an undocumented functionality that breaks this security model, enabling a malicious user to bypass the guest domain authentication. To leverage this functionality an attacker would have to be able to modify the guest machine configuration in a way that will allow sending arbitrary commands to the guest machines and run them at root permissions. This method can be executed remotely, using an easy to use, well documented API, unlike other host-to-guest techniques which require high privileged access to the host.

 In this session, we will provide real world examples of VMWare networks that are exposed to this security design flaw. We will demonstrate the ease at which an attacker can move from configuring a virtual machine to running commands with root permissions inside the guest machine. We will also showcase a tool that will allow you to test which users are capable of taking over guest machines.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Ziv-Escalating-Insider-Threats-Using-Vmware%27s-Api.pdf)

### Presented By

[Ofri Ziv](speakers/Ofri-Ziv.html)

---

## [Evading Microsoft ATA for Active Directory Domination](#evading-microsoft-ata-for-active-directory-domination "Evading Microsoft ATA for Active Directory Domination")

Microsoft Advanced Threat Analytics (ATA) is a defense platform which reads information from multiple sources like traffic for certain protocols to the Domain Controller, Windows Event Logs and SIEM events. The information thus collected is used to detect Reconnaissance, Credentials replay, Lateral movement, Persistence attacks etc. Well known attacks like Pass-the-Hash, Pass-the-Ticket, Overpass-the-Hash, Golden Ticket, Directory services replication, Brute-force, Skeleton key etc. can be detected using ATA. Whenever communication to a Domain Controller is done using protocols like Kerberos, NTLM, RPC, DNS, LDAP etc., ATA will parse that traffic for gathering information about not only possible attacks but user behavior as well. It slowly builds an organizational graph and can detect deviations from normal behavior.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Mittal-Evading-MicrosoftATA-for-ActiveDirectory-Domination.pdf)

### Presented By

[Nikhil Mittal](speakers/Nikhil-Mittal.html)

---

## [Evil Bubbles or How to Deliver Attack Payload via the Physics of the Process](#evil-bubbles-or-how-to-deliver-attack-payload-via-the-physics-of-the-process "Evil Bubbles or How to Deliver Attack Payload via the Physics of the Process")

Until now, electronic communication was considered a single avenue for delivering attack payload. However, when it comes to cyber-physical systems, this assumption does not hold true. When field devices (sensors, valves, pumps, etc.) are inserted into the process, they become related to each other by the physics of the process. Physical process is a communication media for equipment and can be leveraged for delivering malicious payload even if the devices are segregated electronically. Sensors, valves, safety systems on an isolated network, analog equipment are all vulnerable to this attack vector.

 In proposed scenario, an analog pump is damaged by a targeted manipulation of the upstream valve positioner, evoking cavitation process. The final attack payload is delivered to the pump in form of cavitation bubbles over the liquid flow. We will show the damage scenario "in action" with a physical demo on stage. To make things complicated for the defender, we will forger the valve positioner sensor signal to hide the attack from the operator and to confuse operator about true cause of process upset.

 The second part of the talk will deal with the detection of this attack. After all, it is bad form to introduce a problem without having remedy. Forged sensor signals cannot be detected with any traditional IT security methods. The detection has to take form of process data plausibility and consistency checks. By monitoring health of pump we will be able to figure out the ongoing detrimental state of the process and accurately determine the ongoing cavitation process and its likely cause â all with a live demo on stage.

 By the end of this talk the audience will recognize that security and safety zoning should expand all the way into the physical process (to consider interaction of equipment via the physical process).

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Krotofil-Evil-Bubbles-Or-How-To-Deliver-Attack-Payload-Via-The-Physics-Of-The-Process.pdf)

### Presented By

[Marina Krotofil](speakers/Marina-Krotofil.html)

---

## [Evilsploit â A Universal Hardware Hacking Toolkit](#evilsploit-â-a-universal-hardware-hacking-toolkit "Evilsploit â A Universal Hardware Hacking Toolkit")

Hardware hacking is about to understand the inner working mechanism of hardware. Most of the time, the hardware hacking process starts from reversing. From the hardware point of view, reversing in static way includes uncovering the schematic and disassembling the binary. On the other hand, reversing in dynamic way includes finding a way to debug the hardware and to fuzz it accordingly.

 In practice, it is almost a standard operating procedure to obtain the binary of the hardware and reverse it consequently. As a supplementary technique for static binary reversing, debugging allows the real hardware operation process to be demystified in run time. In fact, the binary itself can be obtained by applying debugging technique- while it is not available from manufacturer. So, it is crucial to figure out the provisioning ports of the hardware in order to start performing hardware hacking.

 The conventional approach to identify provisioning ports is by using pin finder toolkits such as Jtagulator. However, it is impractical and inefficient once a provisioning port has been found; another toolkit such as Shikra has to be used to manipulate the provisioning port. It is not only prone to error, but not hacker-friendly. So, it is important to find a way to fill the gap between provisioning port identification and manipulation processes. With this, it allows the hardware hacking process to be automated by making it scriptable in high level.

 We will present a new method to allow provisioning port identification and manipulation by using connection matrix. With this, it is possible to construct arbitrary analog-alike connection in array form to implement all pattern of interconnect between bus interfacing chip and the target. Hence, once the appropriate provisioning port has been figured out, in the meantime, it is ready to be used for debugging or firmware dumping purposes. Besides, it is also an ideal assistive toolset for unknown signal analysis, side channel analysis (SCA), and fault injection (FI).

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Chui-Evilsploit-A-Universal-Hardware-Hacking-Toolkit.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Chui-Evilsploit-A-Universal-Hardware-Hacking-Toolkit-wp.pdf)

### Presented By

[Chui Yew Leong](speakers/Chui-Yew-Leong.html)
 &  [Mingming Wan](speakers/Mingming-Wan.html)

---

## [Evolutionary Kernel Fuzzing](#evolutionary-kernel-fuzzing "Evolutionary Kernel Fuzzing")

The modern model of vulnerability mitigation includes robust sandboxing and usermode privilege separation to contain inevitable flaws in the design and implementation of software. As adoption of containment technology spreads to browsers and other software, we see the value of exploits continue to rise as multiple vulnerabilities must be chained together with extreme levels of binary artistry to achieve full system control. As such, there has recently been a high demand to identify kernel vulnerabilities that can bypass sandboxes and process isolation to successfully achieve full system compromise.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Johnson-Evolutionary-Kernel-Fuzzing)

### Presented By

[Richard Johnson](speakers/Richard-Johnson.html)

---

## [Exploit Kit Cornucopia](#exploit-kit-cornucopia "Exploit Kit Cornucopia")

Detecting the compromised websites, gates, and dedicated hosts that make up the infrastructure used by Exploit Kits involves a variety of creative techniques. In this session, we will detail four approaches to uncovering these systems while explaining the underlying architecture of Exploit Kit networks. We will disclose a vulnerability in the injected code placed on compromised websites and exploit that vulnerability to uncover deeper infrastructure. Finally, we'll introduce a novel approach to obtaining the malware sent via phishing campaigns which is often the same result of an Exploit Kit compromise.

### Presented By

[Brad Antoniewicz](speakers/Brad-Antoniewicz.html)
 &  [Matt Foley](speakers/Matt-Foley.html)

---

## [Exploiting Network Printers](#exploiting-network-printers "Exploiting Network Printers")

The idea of a paperless office has been dreamed of for more than three decades. However, nowadays printers are still one of the most essential devices for daily work and common Internet users. Instead of removing them, printers evolved from simple devices into complex network computer systems, installed directly into company networks, and carrying considerable confidential data in their print jobs. This makes them to an attractive attack target.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Mueller-Exploiting-Network-Printers.pdf)

### Presented By

[Jens MÃ¼ller](speakers/Jens-M%C3%83%C2%BCller.html)

---

## [Fad or Future? Getting Past the Bug Bounty Hype](#fad-or-future-getting-past-the-bug-bounty-hype "Fad or Future? Getting Past the Bug Bounty Hype")

Ever want to talk to someone that runs a bug bounty program and get the real scoop on its impact to application security? Whether your company has a bounty program or is considering starting one, join this panel of bounty managers for real talk on signal vs noise, ROI, interacting with bounty hunters, and all the little things they wish they'd known before learning the hard way. Panelists will share strategies for day to day operations, handling conflicts and unsolicited disclosure, triage strategies and scope setting, and chat about which vulnerability types are found most often and why they still end up in production code after over a decade of advances in security tooling and secure development practices.

### Presented By

[Kymberlee Price](speakers/Kymberlee-Price.html)
 &  [Angelo Prado](speakers/Angelo-Prado.html)
 &  [Charles Valentine](speakers/Charles-Valentine.html)
 &  [Lori Rangel](speakers/Lori-Rangel.html)

---

## [Fighting Targeted Malware in the Mobile Ecosystem](#fighting-targeted-malware-in-the-mobile-ecosystem "Fighting Targeted Malware in the Mobile Ecosystem")

Meet Chrysaor, one of the most sophisticated and elusive mobile spyware products. Chrysaor, which is believed to be created by the NSO Group Technologies, is related to the iOS Pegasus malware. However, Google and Lookout hunted for their Android version from the end of 2016 to beginning of 2017, and were able to expose it in April.

This talk will recount how we pursued Chrysaor using a combination of on-device and cloud based security services. In particular, we will detail the methodology and techniques that allowed us to detect this malware that affect only dozens of devices out of the billions of security reports we get from Safetynet. We will also discuss how we used our installation graph engine to determine attribution.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Ruthven-Fighting-Targeted-Malware-In-The-Mobile-Ecosystem.pdf)

### Presented By

[Megan Ruthven](speakers/Megan-Ruthven.html)
 &  [Andrew Blaich](speakers/Andrew-Blaich.html)

---

## [Fighting the Previous War (aka: Attacking and Defending in the Era of the Cloud)](#fighting-the-previous-war-aka-attacking-and-defending-in-the-era-of-the-cloud "Fighting the Previous War (aka: Attacking and Defending in the Era of the Cloud)")

For years and years, network pen-testers have owned companies and networks with playbooks written in the 90's. With a good mix of footprinting, scripting and unexpected interdependence, even moderately skilled attackers have been able to reign supreme without ever needing a 0day. How does this change as organizations slip more and more into the cloud? What do rootkits look like & what does lateral movement mean when its between different SaaS products? While we have seen point attacks on cloud vendors there hasn't been enough attention paid to the interdependence of these systems and we have seen precious little on pivoting through or defending these setups. This talk attempts to update those playbooks from the 90's for both red and blue teamers.

### Presented By

[Haroon Meer](speakers/Haroon-Meer.html)
 &  [Marco Slaviero](speakers/Marco-Slaviero.html)

---

## [Firmware is the New Black - Analyzing Past Three Years of BIOS/UEFI Security Vulnerabilities](#firmware-is-the-new-black-analyzing-past-three-years-of-bios-uefi-security-vulnerabilities "Firmware is the New Black - Analyzing Past Three Years of BIOS/UEFI Security Vulnerabilities")

In recent years, we witnessed the rise of firmware-related vulnerabilities, likely a direct result of increasing adoption of exploit mitigations in major/widespread operating systems - including for mobile phones. Pairing that with the recent (and not so recent) leaks of government offensive capabilities abusing supply chains and using physical possession to persist on compromised systems, it is clear that firmware is the new black in security. This research looks into BIOS/UEFI platform firmware, trying to help making sense of the threat. We present a threat model, discuss new mitigations that could have prevented the issues and offer a categorization of bug classes that hopefully will help focusing investments in protecting systems (and finding new vulnerabilities). Our data set comprises of 90+ security vulnerabilities handled by Intel Product Security Incident Response Team (PSIRT) in the past 3 years and the analysis was manually performed, using white-box and counting with feedback from various BIOS developers within the company (and security researchers externally that reported some of the issues - most of the issues were found by internal teams, but PSIRT is involved since they were found to also affect released products).

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Branco-Firmware-Is-The-New-Black-Analyzing-Past-Three-Years-Of-BIOS-UEFI-Security-Vulnerabilities.pdf)

### Presented By

[Rodrigo Branco](speakers/Rodrigo-Branco.html)
 &  [Vincent Zimmer](speakers/Vincent-Zimmer.html)
 &  [Bruce Monroe](speakers/Bruce-Monroe.html)

---

## [FlowFuzz - A Framework for Fuzzing OpenFlow-Enabled Software and Hardware Switches](#flowfuzz-a-framework-for-fuzzing-openflow-enabled-software-and-hardware-switches "FlowFuzz - A Framework for Fuzzing OpenFlow-Enabled Software and Hardware Switches")

Software-defined Networking (SDN) is a new networking paradigm which aims for increasing the flexibility of current network deployments by separating the data from the control plane and by providing programmable interfaces to configure the network. Resulting in a more agile and eased network management and therefore in cost savings, SDN is already deployed in live networks i.e. Google's B4 backbone and NOKIA's cloud infrastructure. Despite these benefits, SDN broadens the attack surface as additional networking devices and protocols are deployed. Due their critical role within the softwarized management of the network, these devices and protocols are high ranked targets for potential attackers and thus require extensive testing and hardening.

 In this work, we present FlowFuzz a fuzzing framework for SDN-enabled software and hardware switches. In particular we focus on the OpenFlow protocol which is currently the de facto standard communication protocol between SDN-enabled switches and the central controlling instance. Whereas the framework utilizes the output of conventional tools such as AddressSanitizer for investigating software switches, it also evaluates data obtained from side channels, i.e., processing times and power consumption to identify unique code execution paths within hardware switches to optimize the fuzzing process. Furthermore, we use our framework implementation to perform a first evaluation of the OpenVSwitch and a total of four SDN-enabled hardware switches. We conclude by presenting our findings and outline future extensions of the fuzzing framework.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Gray-FlowFuzz-A-Framework-For-Fuzzing-OpenFlow-Enabled-Software-And-Hardware-Switches.pdf)

### Presented By

[Nicholas Gray](speakers/Nicholas-Gray.html)
 &  [Thomas Zinner](speakers/Thomas-Zinner.html)
 &  [Phuoc Tran-Gia](speakers/Phuoc-Tran-Gia.html)
 &  [Manuel Sommer](speakers/Manuel-Sommer.html)

---

## [Fractured Backbone: Breaking Modern OS Defenses with Firmware Attacks](#fractured-backbone-breaking-modern-os-defenses-with-firmware-attacks "Fractured Backbone: Breaking Modern OS Defenses with Firmware Attacks")

In this work we analyzed two recent trends. The first trend is the growing threat of firmware attacks which include recent disclosures of Vault7 Mac EFI implants. We will detail vulnerabilities and attacks we discovered recently in system firmware including UEFI, Mac EFI and Coreboot which could lead to stealth and persistent firmware implants. We have also developed multiple techniques that can be used to detect that something wrong is going on with the firmware using open source CHIPSEC framework.

The second trend is modern operating systems started adopting stronger software defenses based on virtualization technology. Windows 10 introduced Virtualization Based Security (VBS) to provide hypervisor-based isolated execution environment to critical OS components and to protect sensitive data such as domain credentials. Previously, we discovered multiple ways adversaries could leverage firmware in attacks against hypervisors. We also demonstrated the first proof-of-concept attack on Windows 10 VBS exposing domain credentials protected by Credential Guard technology. We will apply this knowledge to analyze the security of modern hypervisor based OS defenses from the perspective of firmware and hardware attacks. We will detail firmware assisted attack vectors which can be used to compromise Windows 10 VBS. We will also describe changes done by platform vendors and Windows to improve mitigation against these attacks.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Bulygin-Fractured-Backbone-Breaking-Modern-OS-Defenses-With-Firmware-Attacks.pdf)

### Presented By

[Yuriy Bulygin](speakers/Yuriy-Bulygin.html)
 &  [Mikhail Gorobets](speakers/Mikhail-Gorobets.html)
 &  [Oleksandr Bazhaniuk](speakers/Oleksandr-Bazhaniuk.html)
 &  [Andrew Furtak](speakers/Andrew-Furtak.html)

---

## [Free-Fall: Hacking Tesla from Wireless to CAN Bus](#free-fall-hacking-tesla-from-wireless-to-can-bus "Free-Fall: Hacking Tesla from Wireless to CAN Bus")

In today's world of connected cars, security is of vital importance. The security of these cars is not only a technological issue, but also an issue of human safety. In our research we focused on perhaps the most famous connected car model: Tesla.

 In September 2016, our team (Keen Security Lab of Tencent) successfully implemented a remote attack on the Tesla Model S in both Parking and Driving mode. This remote attack utilized a complex chain of vulnerabilities. We have proved that we can gain entrance from wireless (Wi-Fi/Cellular), compromise many in-vehicle systems like IC, CID, and Gateway, and then inject malicious CAN messages into the CAN Bus. Just 10 days after we submitted our research to Tesla, Tesla responded with an update using their OTA mechanism and introduced the code signing protection into Tesla cars.

 Our presentation will be in three parts: our research, Tesla's response, and the follow-up. We will, for the first time, share the details of the whole attack chain on the Tesla, and then reveal the implementation of Tesla's OTA and Code Signing features. Furthermore, we'll explore the new mitigation on Tesla and share our thoughts on them.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Nie-Free-Fall-Hacking-Tesla-From-Wireless-To-CAN-Bus.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Nie-Free-Fall-Hacking-Tesla-From-Wireless-To-CAN-Bus-wp.pdf)

### Presented By

[Sen Nie](speakers/Sen-Nie.html)
 &  [Ling Liu](speakers/Ling-Liu.html)
 &  [Yuefeng Du](speakers/Yuefeng-Du.html)

---

## [Friday the 13th: JSON Attacks](#friday-the-13th-json-attacks "Friday the 13th: JSON Attacks")

2016 was the year of Java deserialization apocalypse. Although Java Deserialization attacks were known for years, the publication of the Apache Commons Collection Remote Code Execution (RCE from now on) gadget finally brought this forgotten vulnerability to the spotlight and motivated the community to start finding and fixing these issues. One of the most suggested solutions for avoiding Java deserialization issues was to move away from Java Deserialization altogether and use safer formats such as JSON. In this talk, we will analyze the most popular JSON parsers in both .NET and Java for potential RCE vectors.

 We will demonstrate that RCE is also possible in these libraries and present details about the ones that are vulnerable to RCE by default. We will also discuss common configurations that make other libraries vulnerable. In addition to focusing on JSON format, we will generalize the attack techniques to other serialization formats. In particular, we will pay close attention to several serialization formats in .NET. These formats have also been known to be vulnerable since 2012 but the lack of known RCE gadgets led some software vendors to not take this issue seriously. We hope this talk will change this. With the intention of bringing the due attention to this vulnerability class in .NET, we will review the known vulnerable formats, present other formats which we found to be vulnerable, and conclude with presenting several gadgets from system libraries that may be used to achieve RCE in a stable way: no memory corruption -- just simple process invocation. Finally, we will provide recommendations on how to determine if your code is vulnerable, provide remediation advice, and discuss alternative approaches.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-JSON-Attacks-wp.pdf)

### Presented By

[Alvaro MuÃ±oz](speakers/Alvaro-Mu%C3%83%C2%B1oz.html)
 &  [Oleksandr Mirosh](speakers/Oleksandr-Mirosh.html)

---

## [Game of Chromes: Owning the Web with Zombie Chrome Extensions](#game-of-chromes-owning-the-web-with-zombie-chrome-extensions "Game of Chromes: Owning the Web with Zombie Chrome Extensions")

On April 16, 2016, an army of bots stormed upon Wix servers, creating new accounts and publishing shady websites in mass. The attack was carried by a malicious Chrome extension, installed on tens of thousands of devices, sending HTTP requests simultaneously. This "Extension Bot" has used Wix websites platform and Facebook messaging service, to distribute itself among users. Two months later, same attackers strike again. This time they used infectious notifications, popping up on Facebook and leading to a malicious Windows-runnable JSE file. Upon clicking, the file ran and installed a Chrome extension on the victim's browser. Then the extension used Facebook messaging once again to pass itself on to more victims.

Analyzing these attacks, we were amazed by the highly elusive nature of these bots, especially when it comes to bypassing web-based bot-detection systems. This shouldn't be surprising, since legit browser extensions are supposed to send Facebook messages, create Wix websites, or in fact perform any action on behalf of the user. On the other hand, smuggling a malicious extension into Google Web Store and distributing it among victims efficiently, like these attackers did, is let's say - not a stroll in the park. But don't worry, there are other options.

Recently, several popular Chrome extensions were found to be vulnerable to XSS. Yep, the same old XSS every rookie finds in so many web applications. So, browser extensions suffer from it too, and sadly, in their case it can be much deadlier than in regular websites. One noticeable example is the Adobe Acrobat Chrome extension, which was silently installed on January 10 by Adobe, on an insane number of 30 million devices. A DOM-based XSS vulnerability in the extension (found by Google Project Zero) allowed an attacker to craft a content that would run Javascript as the extension.

In this talk, I will show how such a flaw leads to full and permanent control over the victim's browser, turning the extension into zombie. Additionally, shedding more light on the 2016 attacks on Wix and Facebook described in the beginning, I will demonstrate how an attacker can use similar techniques to distribute her malicious payload efficiently on to new victims, through popular social platforms - creating the web's most powerful botnet ever.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Cohen-Game-Of-Chromes-Owning-The-Web-With-Zombie-Chrome-Extensions-wp.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Cohen-Game-Of-Chromes-Owning-The-Web-With-Zombie-Chrome-Extensions-wp.pdf)

### Presented By

[Tomer Cohen](speakers/Tomer-Cohen.html)

---

## [Garbage In Garbage Out: How Purportedly Great Machine Learning Models can be Screwed Up by Bad Data](#garbage-in-garbage-out-how-purportedly-great-machine-learning-models-can-be-screwed-up-by-bad-data "Garbage In Garbage Out: How Purportedly Great Machine Learning Models can be Screwed Up by Bad Data")

As processing power and deep learning techniques have improved, deep learning has become a powerful tool to detect and classify increasingly complex and obfuscated malware at scale.

 A plethora of white papers exist touting impressive malware detection and false positive rates using machine learning - often deep learning. However, virtually all of these rates are only shown in the context of a single source of data the authors choose to train and test on. Accuracy statistics are generally the result of training on a portion of some dataset (like VirusTotal data), and testing on a different portion of the same dataset. But model effectiveness (specifically detection rates in the extremely low false-positive-rate region) may vary significantly when used on new, different datasets - specifically, when used in the wild on actual consumer data.

 In this presentation, I will present sensitivity results from the same deep learning model designed to detect malicious URLs, trained and tested across 3 different sources of URL data. After reviewing the results, we'll dive into what caused our results by looking into: 1) surface differences between the different sources of data, and 2) higher level feature activations that our neural net identified in certain data sets, but failed to identify in others.

 Deep learning uses a massive amount of unseen complex features to predict results, which enables them to fit beautifully to datasets. But it also means that if the training and testing data is even slightly biased with respect to the real-world test case data, some of those unseen complex features will end up damaging accuracy instead of bolstering it. Even with great labels and a lot of data, if the data we use to train our deep learning models doesn't mimic the data it will eventually be tested on in the wild, our models are likely to miss out on a lot.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Sanders-Garbage-In-Garbage-Out-How-Purportedly-Great-ML-Models-Can-Be-Screwed-Up-By-Bad-Data.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Sanders-Garbage-In-Garbage-Out-How-Purportedly-Great-ML-Models-Can-Be-Screwed-Up-By-Bad-Data-wp.pdf)

### Presented By

[Hillary Sanders](speakers/Hillary-Sanders.html)

---

## [Go Nuclear: Breaking Radiation Monitoring Devices](#go-nuclear-breaking-radiation-monitoring-devices "Go Nuclear: Breaking Radiation Monitoring Devices")

USA, 1979: The Three Mile Island Nuclear Generating Station suffered a core meltdown. Operators were unable to cope with the ambiguous signals the plant's HMI was sending, leading to one of the most serious nuclear accidents on US soil. Spain, 2007: Bypassing security checks, someone stole approximately 70 fuel pellets of uranium oxide from a nuclear fuel facility. They were later found abandoned nearby. How this material ended up there is still a mystery. Are these scenarios possible now? Critical infrastructure such as nuclear power plants, seaports, borders, and even hospitals are equipped with radiation monitoring devices. This equipment detects and prevents threats ranging from nuclear material smuggling to radiation contamination.

 The purpose of this talk is to provide a comprehensive description of the technical details and approach used to discover multiple vulnerabilities that affect widely deployed radiation monitoring devices, involving software and firmware reverse engineering, RF analysis, and hardware hacking.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Santamarta-Go-Nuclear-Breaking%20Radition-Monitoring-Devices.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Santamarta-Go-Nuclear-Breaking%20Radition-Monitoring-Devices-wp.pdf)

### Presented By

[Ruben Santamarta](speakers/Ruben-Santamarta.html)

---

## [Go to Hunt Then Sleep](#go-to-hunt-then-sleep "Go to Hunt Then Sleep")

Are nightmares of data breaches and targeted attacks keeping your CISO up at night? You know you should be hunting for these threats, but where do you start? Told in the style of the popular children's story spoof, this soothing bedtime tale will lead Li'l Threat Hunters through the first five hunts they should do to find bad guys and, ultimately, help their CISOs "Go the F\*#k to Sleep."

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Bianco-Go-To-Hunt-Then-Sleep.pdf)

### Presented By

[David Bianco](speakers/David-Bianco.html)
 &  [Robert Lee](speakers/Robert-Lee.html)

---

## [Hacking Hardware with a $10 SD Card Reader](#hacking-hardware-with-a-$10-sd-card-reader "Hacking Hardware with a $10 SD Card Reader")

Dumping firmware from hardware, utilizing a non-eMMC flash storage device, can be a daunting task with expensive programmers required, 15+ wires to solder (or a pricey socket), and dumps that contain extra data to allow for error correction. With the growing widespread use of eMMC flash storage, the process can be simplified to 5 wires and a cheap SD card reader/writer allowing for direct access to the filesystem within flash in an interface similar to that of using an SD card.

 In this presentation, we will be showing attendees how to identify eMMC flash storage chips, how to reverse engineer the in circuit pinouts, and how to dump or modify the data within. We will be showcasing the tips and tricks to properly reverse engineer hardware containing eMMC flash storage (without bricking) along with a clear explanation of the process from identification to programming. The presentation will then finish with a demonstration of the process along with a number of free SD to eMMC breakouts for attendees.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Etemadieh-Hacking-Hardware-With-A-%2410-SD-Card-Reader.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Etemadieh-Hacking-Hardware-With-A-%2410-SD-Card-Reader-wp.pdf)

### Presented By

[Amir Etemadieh](speakers/Amir-Etemadieh.html)
 &  [Khoa Hoang](speakers/Khoa-Hoang.html)
 &  [CJ Heres](speakers/CJ-Heres.html)

---

## [Hacking Serverless Runtimes: Profiling AWS Lambda Azure Functions and More](#hacking-serverless-runtimes-profiling-aws-lambda-azure-functions-and-more "Hacking Serverless Runtimes: Profiling AWS Lambda Azure Functions and More")

Serverless technology is getting increasingly ubiquitous in the enterprise and startup communities. As micro-services multiply and single purpose services grow, how do you audit and defend serverless runtimes? The advantages of serverless runtimes are clear: increased agility, ease of use, and ephemerality (i.e., not managing a fleet of "pet" servers). There is a trade off for that convenience though - reduced transparency. In this talk, we will deep dive into both public data and information unearthed by our research to give you the full story on serverless, how it works, and attack chains in the serverless cloud(s) Azure, AWS, and a few other sandboxes. Who will be the victor in the great sandbox showdown?

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Krug-Hacking-Severless-Runtimes.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Krug-Hacking-Severless-Runtimes-wp.pdf)

### Presented By

[Andrew Krug](speakers/Andrew-Krug.html)
 &  [Graham Jones](speakers/Graham-Jones.html)

---

## [Honey I Shrunk the Attack Surface â Adventures in Android Security Hardening](#honey-i-shrunk-the-attack-surface-â-adventures-in-android-security-hardening "Honey I Shrunk the Attack Surface â Adventures in Android Security Hardening")

Information security is ever evolving, and Android's security posture is no different. Users and application developers have high expectations that their data will be kept safe, private, and secure, and it's the responsibility of the Android Security Team to enable this. To do this, Android has focused on four critical principles of information security: exploit mitigation, exploit containment, attack surface reduction, and safe-by-default features.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Kralevich-Honey-I-Shrunk-The-Attack-Surface-Adventures-In-Android-Security-Hardening.pdf)

### Presented By

[Nick Kralevich](speakers/Nick-Kralevich.html)

---

## [How We Created the First SHA-1 Collision and What it Means for Hash Security](#how-we-created-the-first-sha-1-collision-and-what-it-means-for-hash-security "How We Created the First SHA-1 Collision and What it Means for Hash Security")

In February 2017, we announced the first SHA-1 collision. This collision combined with a clever use of the PDF format allows attackers to forge PDF pairs that have identical SHA-1 hashes and yet display different content. This attack is the result of over two years of intense research. It took 6500 CPU years and 110 GPU years of computations which is still 100,000 times faster than a brute-force attack.

 In this talk, we recount how we found the first SHA-1 collision. We delve into the challenges we faced from developing a meaningful payload, to scaling the computation to that massive scale, to solving unexpected cryptanalytic challenges that occurred during this endeavor.

 We discuss the aftermath of the release including the positive changes it brought and its unforeseen consequences. For example it was discovered that SVN is vulnerable to SHA-1 collision attacks only after the WebKit SVN repository was brought down by the commit of a unit-test aimed at verifying that Webkit is immune to collision attacks.

 Building on the Github and Gmail examples we explain how to use counter-cryptanalysis to mitigate the risk of a collision attacks against software that has yet to move away from SHA-1. Finally, we look at the next generation of hash functions and what the future of hash security holds.

### Presented By

[Elie Bursztein](speakers/Elie-Bursztein.html)

---

## [Hunting GPS Jammers](#hunting-gps-jammers "Hunting GPS Jammers")

This presentation provides an introduction to the vulnerabilities of satellite navigation and timing systems and the ways in which these vulnerabilities have been exploited. First, the specific vulnerabilities of GPS-based systems are introduced â the main vulnerabilities of GPS are due to the very low signal strength of the satellite signals. The paper discusses the effect of RF interference on satellite navigation and timing systems and introduces some real examples of disruption caused by real interference events. Evidence is also produced to show that interference events are widespread. The spoofing of GPS position and timing is also introduced. This presentation shows that spoofing can be carried out either at the application layer (the Pokemon GO game is presented as an example of this kind of hacking) or at RF level, where it is also shown that there are real examples of this kind of attack. Real examples of exploitation of GPS vulnerabilities are presented.

These will include:

* Real examples of GPS jamming attacks (deliberate and even accidental)
* Real examples of GPS spoofing â At application layer, Pokemon GO game,
* Automatic Identification Service (AIS)
* At RF level â DEFCON examples/demos and the attempted spoofing of drones

Evidence will also be presented to show that there are a significant number of exploitations of RF interference by several groups of attackers with various motives. It will be shown that the groups who are attempting to exploit navigation and timing system vulnerabilities are the same types who have exploited IT systems. Approaches to mitigate systems and devices against the described vulnerabilities are proposed - a protective risk assessment and test framework are presented as being a method that can make significant improvements to existing systems.

We designed and built out a network that receives real-time data from purpose built detectors. The detectors are located at several airports, military bases, ranges, and along highways near tollbooths.

Receivers and sensors along with historical data have been used to hunt down willful and intentional GPS jamming by people wishing to evade tolls, trucking companies, employees wanting to evade employer surveillance as well as sophisticated jamming patterns and spoofing that would require a highly-sophisticated adversary and gear that is not available COTS/to civilians. Technology has been demonstrated to identify, track and report small time offenders, track down complex GPS network issues and assist in investigations where military assets have been targeted. We will demo the detection network, show of some of the historical data and bring sensors to Black Hat for everyone to see and play with. We will also talk through some of the cases where we tracked down sources of intentional jamming.

### Presented By

[Vlad Gostomelsky](speakers/Vlad-Gostomelsky.html)

---

## [Ice Cream Social (Sponsored by Code42 Software Core Security Cybereason Darktrace F5 Networks iboss Malwarebytes & Optiv Security)](#ice-cream-social-sponsored-by-code42-software-core-security-cybereason-darktrace-f5-networks-iboss-malwarebytes-and-optiv-security "Ice Cream Social (Sponsored by Code42 Software Core Security Cybereason Darktrace F5 Networks iboss Malwarebytes & Optiv Security)")

---

## [Ichthyology: Phishing as a Science](#ichthyology-phishing-as-a-science "Ichthyology: Phishing as a Science")

Many companies consider phishing inevitable: the best we can do is run training for our employees, and cross our fingers. But does phishing training actually work?

 In this talk we'll cover the psychology of phishing, then walk through a series of real-world attacks conducted against a Bay Area tech company - including conversion rates for each attack, and ways in which existing protections were bypassed. We'll cover recent technological advancements in this area, then combine these with our case studies to provide evidence-based techniques on how to prevent, not just mitigate, credential phishing.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Burnett-Ichthyology-Phishing-As-A-Science.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Burnett-Ichthyology-Phishing-As-A-Science-wp.pdf)

### Presented By

[Karla Burnett](speakers/Karla-Burnett.html)

---

## [Industroyer/Crashoverride: Zero Things Cool About a Threat Group Targeting the Power Grid](#industroyer-crashoverride-zero-things-cool-about-a-threat-group-targeting-the-power-grid "Industroyer/Crashoverride: Zero Things Cool About a Threat Group Targeting the Power Grid")

The cyber attack on Ukraine's power grid on December 17th, 2016 was the second time in history a power grid had been disrupted due to a digital attack. The first was Ukraine December 23rd, 2015. But unlike the 2015 attack, not much details have been public about the threat that faced the power grid in 2016 until now. In June, 2017 ESET released a report on a malware sample they identified as Industroyer. They passed the sample ahead of time to Dragos, Inc. who focused on the industrial control system (ICS) aspects of the malware and revealed new functionality that spelled a nightmare scenario for power grid operators: ICS tailored malware capable of disrupting grid operations at scale in environments independent of system choices. Dragos identified the malware family and new functionality as CRASHOVERRIDE.

This talk will walk through the Ukraine 2015 and Ukraine 2016 events with a central focus on the malware, technical analysis of it, and the impact to grid operations. There have only been three other pieces of ICS tailored malware publicly revealed before (Stuxnet, Havex, and BlackEnergy2) making this malware of particular interest in the community. The fact that it could be re-purposed immediately to target grids around Europe and with simple modifications target grids in the United States marks a hallmark event. Defense is doable and our grid operators are actively defending our infrastructure. But learning from such a significant threat is vital to making sure our defensible systems stay defended.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Lee-Industroyer-Crashoverride-Zero-Things-Cool-About-A-Threat-Group-Targeting-The-Power-Grid.pdf)

### Presented By

[Robert Lee](speakers/Robert-Lee.html)
 &  [Joe Slowik](speakers/Joe-Slowik.html)
 &  [Ben Miller](speakers/Ben-Miller.html)
 &  [Anton Cherepanov](speakers/Anton-Cherepanov.html)
 &  [Robert Lipovsky](speakers/Robert-Lipovsky.html)

---

## [Infecting the Enterprise: Abusing Office365+Powershell for Covert C2](#infecting-the-enterprise-abusing-office365-pluspowershell-for-covert-c2 "Infecting the Enterprise: Abusing Office365+Powershell for Covert C2")

As Enterprises rush to adopt Office365 for increased business agility and cost reduction, too few are taking time to truly evaluate the risk associated with this decision. This briefing will attempt to shine a light on the potential hazards of Microsoft's SaaS offerings while also demonstrating a practical example of what a malicious actor can do when Office365 is allowed into the Enterprise.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Dods-Infecting-The-Enterprise-Abusing-Office365-Powershell-For-Covert-C2.pdf)

### Presented By

[Craig Dods](speakers/Craig-Dods.html)

---

## [Influencing the Market to Improve Security](#influencing-the-market-to-improve-security "Influencing the Market to Improve Security")

Vulnerabilities have never been so marketable. There are many ways for security researchers to monetize their efforts: bug bounties, private markets, and of course work for hire. MedSec introduced us to a new way to monetize vulnerabilities by influencing market makers. What does the future hold for this approach? Are there other ways to fix the dysfunctional market around product security. With a fireside chat, Chris Wysopal will ask Justine Bone about the MedSec and Muddy Waters collaboration and how we can learn from this as we look to the future.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Nakibly-Automated-Detection-of-Vulnerabilities-in-Black-Box-Routers-wp.pdf)](https://www.blackhat.com/docs/us-17/thursday/us-17-Nakibly-Automated-Detection-of-Vulnerabilities-in-Black-Box-Routers.pdf)
### Presented By

[Justine Bone](speakers/Justine-Bone.html)
 &  [Chris Wysopal](speakers/Chris-Wysopal.html)

---

## [Intel AMT Stealth Breakthrough](#intel-amt-stealth-breakthrough "Intel AMT Stealth Breakthrough")

Every modern computer system based on Intel architecture has Intel Management Engine (ME) - a built-in subsystem with a wide array of powerful capabilities (such as full access to operating memory, out-of-band access to a network interface, running independently of CPU even when it is in a shutdown state, etc.). On the one hand, these capabilities allow Intel to implement many features and technologies based on Intel ME. On the other hand, it makes Intel ME a tempting target for an attacker. Especially, if an attack can be conducted remotely.

 Here, Intel Active Management Technology (AMT) fits perfectly â it is based on Intel ME and means for a remote administration of computer system. Soâ¦ during this talk we will discuss methods of remote pwning of almost every Intel based system, manufactured since 2010 or later.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Evdokimov-Intel-AMT-Stealth-Breakthrough.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Evdokimov-Intel-AMT-Stealth-Breakthrough-wp.pdf)

### Presented By

[Dmitriy Evdokimov](speakers/Dmitriy-Evdokimov.html)
 &  [Alexander Ermolov](speakers/Alexander-Ermolov.html)
 &  [Maksim Malyutin](speakers/Maksim-Malyutin.html)

---

## [Intel SGX Remote Attestation is Not Sufficient](#intel-sgx-remote-attestation-is-not-sufficient "Intel SGX Remote Attestation is Not Sufficient")

In this paper, we argue that SGX Remote Attestation provided by Intel is not sufficient to guarantee confidentiality and integrity for running unmodified applications in the cloud. In particular, we demonstrate cases where:

* A dishonest service provider instantiates both a valid enclave running on real hardware, as well as the same enclave running in a software simulator in parallel, is always able to respond correctly to Remote Attestation queries, all the while running the enclave inside a software simulator with full access to enclave's internal state.
* A dishonest service provider rewinds the "enclave's tape" and replays computation even though the data is encrypted with platform specific seal-keys. This is a form of replay attack.
* A dishonest service provider runs multiple instances of the same enclave in parallel and launches chosen cipher-text attacks on the protocol.

This talk will also discuss the details about Remote Attestation mechanism:

* What keys are embedded inside each SGX hardware, and what's the protocol for providing proof of knowledge? Are these protocols zero-knowledge, as claimed by Intel?
* How the EPID's zero-knowledge proof of knowledge works, what anonymity guarantees it provides, and can it be replaced with other simpler schemes where platform anonymity is not a concern.
* What key-exchanges take place between Intel Attestation Service, Software Vendor's own service, Intel Provided Platform Enclaves (e.g., launch enclave, etc.), and the enclave itself.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Swami-SGX-Remote-Attestation-Is-Not-Sufficient-wp.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Swami-SGX-Remote-Attestation-Is-Not-Sufficient-wp.pdf)

### Presented By

[Yogesh Swami](speakers/Yogesh-Swami.html)

---

## [Intercepting iCloud Keychain](#intercepting-icloud-keychain "Intercepting iCloud Keychain")

iCloud Keychain employs end-to-end encryption to synchronise secrets across devices enrolled in iCloud. We discovered a critical cryptographic implementation flaw which would have allowed sophisticated attackers with privileged access to iCloud communications to man-in-the-middle iCloud Keychain Sync and gain plaintext access to iCloud Keychain secrets.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Radocea-Intercepting-iCloud-Keychain.pdf)

### Presented By

[Alex Radocea](speakers/Alex-Radocea.html)

---

## [IoTCandyJar: Towards an Intelligent-Interaction Honeypot for IoT Devices](#iotcandyjar-towards-an-intelligent-interaction-honeypot-for-iot-devices "IoTCandyJar: Towards an Intelligent-Interaction Honeypot for IoT Devices")

In recent years, the emerging Internet-of-Things (IoT) has led to rising concerns about the security of networked embedded devices. There is a strong need to develop suitable and cost-efficient methods to find vulnerabilities in IoT devices - in order to address them before attackers take advantage of them. In the previous Black Hat conference, conventional honeypot technology has been discussed multiple times. In this work, we focus on the adaptation of honeypots for improving the security of IoTs, and argue why we need to have a huge innovation to build honeypot for IoT devices.
Due to the heterogeneity of IoT devices, manually crafting the low-interaction honeypot is not affordable; on the other hand, we cannot purchase all of the physical IoT devices to build high-interaction honeypot. This dilemma forced us to seek an innovative way to build honeypot for IoT devices. We propose an automatic way to learn the behavioral knowledge of IoT devices and build "intelligent-interaction" honeypot. We also leverage multiple machine learning techniques to improve the quality and quantity.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Luo-Iotcandyjar-Towards-An-Intelligent-Interaction-Honeypot-For-IoT-Devices.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Luo-Iotcandyjar-Towards-An-Intelligent-Interaction-Honeypot-For-IoT-Devices-wp.pdf)

### Presented By

[Tongbo Luo](speakers/Tongbo-Luo.html)
 &  [Zhaoyan Xu](speakers/Zhaoyan-Xu.html)
 &  [Xin Ouyang](speakers/Xin-Ouyang.html)
 &  [Xing Jin](speakers/Xing-Jin.html)

---

## [kR^X: Comprehensive Kernel Protection Against Just-In-Time Code Reuse](#kr^x-comprehensive-kernel-protection-against-just-in-time-code-reuse "kR^X: Comprehensive Kernel Protection Against Just-In-Time Code Reuse")

The abundance of memory corruption and disclosure vulnerabilities in kernel code necessitates the deployment of hardening techniques to prevent privilege escalation attacks. As more strict memory isolation mechanisms between the kernel and user space, like Intel's SMEP, become commonplace, attackers increasingly rely on code reuse techniques to exploit kernel vulnerabilities. Contrary to similar attacks in more restrictive settings, such as web browsers, in kernel exploitation, non-privileged local adversaries have great flexibility in abusing memory disclosure vulnerabilities to dynamically discover, or infer, the location of certain code snippets and construct code-reuse payloads.

In this talk, we present kR^X: a kernel hardening scheme that prevents kernel code reuse attacks. kR^X achieves this by coupling code diversification with the enforcement of a "read XOR execute" (R^X) memory safety policy. We demonstrate how to achieve this without employing a hypervisor or a super-privileged component, but rather with a self-hardening approach implemented mostly as a set of GCC plugins. We discuss multiple ways to prevent return address leaks that might allow attackers to infer the internal code layout, using encryption and deception techniques. Finally, we explore how to utilize hardware support, such as MPX on modern Intel CPUs to optimize performance.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Pomonis-KR%5EX-%20Comprehensive-%20Kernel-Protection-Against-Just-In-Time-Code-Reuse.pdf)

### Presented By

[Marios Pomonis](speakers/Marios-Pomonis.html)

---

## [Lies and Damn Lies: Getting Past the Hype of Endpoint Security Solutions](#lies-and-damn-lies-getting-past-the-hype-of-endpoint-security-solutions "Lies and Damn Lies: Getting Past the Hype of Endpoint Security Solutions")

Signatures are dead! We need to focus on machine learning, artificial intelligence, math models, lions, tigers and bears, Oh My!! - STOP!! - How many times have we heard all these buzzwords at conferences, or our managers saying that solution X will solve all our problems. I don't know about you, but I was tired of listening to the hype and the over-use of these terms that really made no sense.

One thing is true, signatures are dead. Today's malware is created with obfuscation and deception and our opponents do not play fair. Do you blame them? They want to get in. Who needs to rob a bank anymore at gun point when the security door is left open and traps are easy to bypass. Thank you Powershell! So what's the answer? Is it Next Generation AV or EDR, or it is Security 101? Over the past 5 months, we have invested significant time building a business case for an Endpoint protection system - understand the problem, creating testing scenarios to evaluate 5 solutions in the market. Over 30,000 pieces of malware were put to the test from our internal private collection, as well as known and unknown samples freely available. With all of the marketing hype, brochureware and buzzwords, it's hard to know what's the real deal. As we talk to colleagues from other companies, one thing is clear, many still struggle with good testing methodologies, what malware to test and how to test their endpoint security.

We will discuss key considerations used in our decision-making process. Testing malware for our company was important, but it was not our only testing criteria. We looked at the ease of installation on the agent, use of their UI, SaaS, on-prem, hybrid, reporting, performance of agent using different system resources, how much the agent replied on their cloud intelligence compared to on-box performance, powershell scenarios, and a variety of other factors. Companies additionally need to take into consideration the cost of any potential new infrastructure, cost per seat, professional services, one off costs, 1, 2, 3 year terms and other factors. Ultimately, we want to extend our resources to help others in the industry and discuss key differences between the solutions that were evaluated.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Giuliano-Lies-And-Damn-Lies-Getting-Past-The-Hype-Of-Endpoint-Security-Solutions.pdf)

### Presented By

[Lidia Giuliano](speakers/Lidia-Giuliano.html)
 &  [Mike Spaulding](speakers/Mike-Spaulding.html)

---

## [Lunch Break (Sponsored by Cisco Forcepoint LogRhythm & RSA)](#lunch-break-sponsored-by-cisco-forcepoint-logrhythm-and-rsa "Lunch Break (Sponsored by Cisco Forcepoint LogRhythm & RSA)")

---

## [Many Birds One Stone: Exploiting a Single SQLite Vulnerability Across Multiple Software](#many-birds-one-stone-exploiting-a-single-sqlite-vulnerability-across-multiple-software "Many Birds One Stone: Exploiting a Single SQLite Vulnerability Across Multiple Software")

SQLite is widely used as embedded database software for local/client storage in application software, such as web browsers and mobile applications. As a relational database, SQLite is vulnerable to SQL injection attack, which has been well-studied for a long time. Memory corruption bugs in SQLite are usually not considered security issues, since they are normally unlikely to be exploitable. In this talk, we will study several remotely exploitable memory corruption cases to show the dangerous attack surface in SQLite.

 The journey of SQLite exploitation starts with Web SQL. Web SQL Database is a web page API for storing data in databases that can be queried using SQL language. Although W3C working group has ceased working on the specification since 2010, many modern browsers including Google Chrome, Apple Safari and Opera have an implementation based on SQLite as the backend for years. We will go through several previous issues of SQLite and discuss how they affect the browsers and how they have been fixed. Also, we will present new vulnerabilities in SQLite that we used to compromise Apple Safari in Pwn2Own 2017. The new bugs exist in all browsers that support Web SQL Database, including browser components Android WebView and iOS UIWebView widely used in mobile applications. We will demonstrate our exploit against multiple browser targets from multiple platforms to show the impact of a single SQLite vulnerability.

 Many programming languages have a support of SQLite API bindings such as PHP, Lua and Java. Memory corruption bugs of SQLite may also affect security features of these programming languages. We will show SQLite exploitation in PHP SQLite extension to bypass PHP security restrictions, as an example.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Feng-Many-Birds-One-Stone-Exploiting-A-Single-SQLite-Vulnerability-Across-Multiple-Software.pdf)

### Presented By

[Siji Feng](speakers/Siji-Feng.html)
 &  [Zhi Zhou](speakers/Zhi-Zhou.html)
 &  [Kun Yang](speakers/Kun-Yang.html)

---

## [Mimosa Bar (Sponsored by AlienVault Arbor Networks Carbon Black CrowdStrike Cylance DarkMatter Digital Guardian & IBM)](#mimosa-bar-sponsored-by-alienvault-arbor-networks-carbon-black-crowdstrike-cylance-darkmatter-digital-guardian-and-ibm "Mimosa Bar (Sponsored by AlienVault Arbor Networks Carbon Black CrowdStrike Cylance DarkMatter Digital Guardian & IBM)")

---

## [Network Automation is Not Your Safe Haven: Protocol Analysis and Vulnerabilities of Autonomic Network](#network-automation-is-not-your-safe-haven-protocol-analysis-and-vulnerabilities-of-autonomic-network "Network Automation is Not Your Safe Haven: Protocol Analysis and Vulnerabilities of Autonomic Network")

Autonomic systems are smart systems which do not need any human management or intervention. Cisco is one of the first companies to deploy the technology in which the routers are just "Plug and Play" with no need for configuration. All that is needed is 5 commands to build fully automated network. It is already supported in pretty much all of the recent software images for enterprise level and carrier grade routers/switches. This is the bright side of the technology. On the other hand, the configuration is hidden and the interfaces are inaccessible. The protocol is proprietary and there is no mechanism to know what is running within your network.

In this talk, we will have a quick overview on Cisco's Autonomic Network Architecture, then I will reverse-engineer the proprietary protocol through its multiple phases. Finally, multiple vulnerabilities will be presented, one of which allows to crash systems remotely by knowing their IPv6 address.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Eissa-Network-Automation-Isn%27t-Your-Safe-Haven-Protocol-Analysis-And-Vulnerabilities-Of-Autonomic-Network.pdf)

### Presented By

[Omar Eissa](speakers/Omar-Eissa.html)

---

## [New Adventures in Spying 3G and 4G Users: Locate Track & Monitor](#new-adventures-in-spying-3g-and-4g-users-locate-track-and-monitor "New Adventures in Spying 3G and 4G Users: Locate Track & Monitor")

The 3G and 4G devices deployed worldwide are vulnerable to IMSI catcher aka Stingray devices. The next generation 5G network may address user's privacy issues related to these IMSI catcher attack techniques. However in this talk, we introduce new attack vectors that enable tracking and activity monitoring of mobile users.

 In particular, we uncover a new flaw in the widely deployed cryptographic protocol in 3G and 4G cellular networks. We discuss different methods to exploit this flaw using low-cost setup. Further, we present several attacks to demonstrate their impact on end-users carrying 3G and 4G devices. Lastly, we discuss countermeasures to address these privacy issues.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Borgaonkar-New-Adventures-In-Spying-3G-And-4G-Users-Locate-Track-And-Monitor.pdf)

### Presented By

[Ravishankar Borgaonkar](speakers/Ravishankar-Borgaonkar.html)
 &  [Shinjo Park](speakers/Shinjo-Park.html)
 &  [Lucca Hirschi](speakers/Lucca-Hirschi.html)
 &  [Altaf Shaik](speakers/Altaf-Shaik.html)
 &  [Andrew Martin](speakers/Andrew-Martin.html)
 &  [Jean-Pierre Seifert](speakers/Jean-Pierre-Seifert.html)

---

## [Ochko123 - How the Feds Caught Russian Mega-Carder Roman Seleznev](#ochko123-how-the-feds-caught-russian-mega-carder-roman-seleznev "Ochko123 - How the Feds Caught Russian Mega-Carder Roman Seleznev")

How did the Feds catch the notorious Russian computer hacker Roman Seleznev - the person responsible for over 400 point of sale hacks and at least $169 million in credit card fraud? What challenges did the government face piecing together the international trail of electronic evidence that he left? How was Seleznev located and ultimately arrested? This presentation will begin with a review of the investigation that will include a summary of the electronic evidence that was collected and the methods used to collect that evidence. The team that convicted Seleznev will show how that evidence of user attribution was used to finger Seleznev as the hacker and infamous credit card broker behind the online nics nCuX, Track2, Bulba and 2Pac. The presentation will further discuss efforts to locate Seleznev, a Russian national, and apprehend him while he vacationed in the Maldives. Finally, the presentation will cover the August 2016 federal jury trial with a focus on computer forensic issues, including how prosecutors used Microsoft Windows artifacts to successfully combat Seleznev's trial defense. They argued that the laptop he was arrested with had been tampered with and that evidence on the laptop had been planted by a mysterious super hacker.

### Presented By

[Harold Chun](speakers/Harold-Chun.html)
 &  [Norman Barbosa](speakers/Norman-Barbosa.html)

---

## [Offensive Malware Analysis: Dissecting OSX/FruitFly via a Custom C&C Server](#offensive-malware-analysis-dissecting-osx-fruitfly-via-a-custom-candc-server "Offensive Malware Analysis: Dissecting OSX/FruitFly via a Custom C&C Server")

Creating a custom command and control (C&C) server for someone else's malware has a myriad of benefits. If you can take over a domain, you then may able to fully hijack other hackers' infected hosts. A more prosaic benefit is expediting analysis. While hackers and governments may be more interested in the former, malware analysts can benefit from the latter.

 FruitFly, the first OS X/macOS malware of 2017, is a rather intriguing specimen. Selectively targeting biomedical research institutions, it is thought to have flown under the radar for many years. In this talk, we'll focus on the 'B' variant of FruitFly that, even now, is only detected by a handful of security products.

 We'll begin by analyzing the malware's dropper, an obfuscated perl script. As this language is rather archaic and uncommon in malware droppers, we'll discuss some debugging techniques and fully deconstruct the script.

 While this dropper component also communicates with the C&C server and supports some basic commands, it drops a binary payload in order to perform more complex actions. However, instead of fully reversing this piece of the malware, the talk will focus on an initial triage and show how this was sufficient for the creation of a custom C&C server. With such a server, we can easily coerce the malware to reveal it's full capabilities. For example, the malware invokes a handful of low-level mouse & graphics APIs, passing in a variety of dynamic parameters. Instead of spending hours reversing and debugging this complex code, via the C&C server, we can simply send it various commands and observe the effects.

 Of course, this approach hinges on the ability to closely observe the malware's actions. As such, we'll discuss macOS-specific tools that can monitor various events, and where necessary detail the creation of custom ones (e.g. a 'mouse sniffer' that locally observes and decodes commands sent from the malware to the OS, in order to control the mouse).

 While some of this talk is FruitFly and/or macOS specific, conceptually it should broadly apply to analyzing other malware, even on other operating systems :).

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Wardle-Offensive-Malware-Analysis-Dissecting-OSXFruitFly-Via-A-Custom-C%26C-Server.pdf)

### Presented By

[Patrick Wardle](speakers/Patrick-Wardle.html)

---

## [OpenCrypto: Unchaining the JavaCard Ecosystem](#opencrypto-unchaining-the-javacard-ecosystem "OpenCrypto: Unchaining the JavaCard Ecosystem")

JavaCard is a subset of Java that allows applets to run securely on smartcards and has been deployed to over 15 billion devices. Its main advantage compared to competing technologies is "applet interoperability." Unfortunately, over the years, several glitches in the ecosystem became apparent, and hindered its evolution. For instance, in practice, most applets are tailored for a specific card model, while there is at least a three-year gap between the time a JavaCard specification is released, and the time features appear in products.

 We argue that these inconsistencies between the JavaCard vision and practice are due to the control card vendors have over the ecosystem. Specifically, since JavaCard relies on vendors to implement the specification, this enables them to impose barriers to protect their market share. For instance, the cryptographic coprocessor is accessible only for high-level operations (e.g., ECDSA signing method), while low-level methods (e.g., ECPoint Addition) are available only in vendor-specific, proprietary APIs. Moreover, vendors often release new features of the specification in their own APIs.

 In this session, we present the OpenCrypto library that enables programmers to utilize all the capabilities of JavaCards (e.g., the cryptographic coprocessor) without being bound to a specific vendor. The library realizes classes for: 1) mutable Integers, 2) Elliptic Curve Points and 3) EC Curves. Currently, these classes are either not supported at all (even though they may be listed in the JC specification, e.g., Integers), or are available only through vendor-specific APIs (e.g., ECPoint). To overcome the vendor barriers, we use a combination of low-level byte manipulation tricks and mathematical properties to reconstruct low-level arithmetic operations (e.g., integer multiplication, ECPoint Addition) from high-level crypto methods (e.g., RSA encryption). Our final library supports all the methods found in the proprietary APIs, performs almost as fast, and eliminates vendor-specific dependencies from the ecosystem.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Mavroudis-Opencrypto-Unchaining-The-JavaCard-Ecosystem.pdf)

### Presented By

[Vasilios Mavroudis](speakers/Vasilios-Mavroudis.html)
 &  [George Danezis](speakers/George-Danezis.html)
 &  [Petr Svenda](speakers/Petr-Svenda.html)
 &  [Dan Cvrcek](speakers/Dan-Cvrcek.html)

---

## [Orange is the New Purple - How and Why to Integrate Development Teams with Red/Blue Teams to Build More Secure Software](#orange-is-the-new-purple-how-and-why-to-integrate-development-teams-with-red-blue-teams-to-build-more-secure-software "Orange is the New Purple - How and Why to Integrate Development Teams with Red/Blue Teams to Build More Secure Software")

Introducing a new paradigm for integrating developers with offensive and defensive teams to enhance SDLC. Utilizing Red, Blue, and now Yellow (Development) Teams in a structured way to provide knowledge sharing, strengthening of defenses, coverage, and response, and ultimately the development of a high level of security maturity over time. This new concept of "Red + Yellow == Orange && Blue + Yellow == Green" focuses on the role of Developers as a critical piece of security assurance activities when combined with Offensive and Defensive Teams. Orange Teams add value when they have been integrated into SDLC by creating a cycle of perpetual offensive testing and threat modeling to make software more secure over time through a high level of dedicated interaction. Green teams add value when they help ensure software is capable of providing good DFIR information. This talk will evaluate how different Team combinations can lead to more secure software.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Wright-Orange-Is-The-New-Purple.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/wednesday/us-17-Wright-Orange-Is-The-New-Purple-wp.pdf)

### Presented By

[April C. Wright](speakers/April-C-Wright.html)

---

## [PEIMA: Harnessing Power Laws to Detect Malicious Activities from Denial of Service to Intrusion Detection Traffic Analysis and Beyond](#peima-harnessing-power-laws-to-detect-malicious-activities-from-denial-of-service-to-intrusion-detection-traffic-analysis-and-beyond "PEIMA: Harnessing Power Laws to Detect Malicious Activities from Denial of Service to Intrusion Detection Traffic Analysis and Beyond")

Distributed denial of service attacks (DDoS) are a constant problem for network operators today. Thanks to low cost of entry, high effectiveness, and the difficulty present in filtering out such attacks from inbound network traffic, DDoS attacks are relatively common and difficult to mitigate against. Recent discoveries regarding the conformity of network traffic to certain power law distributions, namely Benford's and Zipf's laws, has allowed us to develop a new method of denial of service detection based entirely on packet header inspection.

Power law distributions are fascinating artifacts of natural processes, applications of which can be found in anywhere from word counts in books through to numbers used in bank statements. Our research can detect DDoS attacks by using such distributions to detect strongly unnatural network traffic scenarios with only minimal metadata. This however, is not the whole story. Power law potential in IDS is largely un-researched, and could be applied for more general anomaly based IDS purposes. It can even be used to filter for denial of service packets in live streams of data.

What makes Power Laws both fascinating and interesting is that they have an inbuilt "resistance" to attempts to tamper or subvert the data analysis. Given the low computational cost associated with Power law processing and the foolproof security inherent to the methods, Power law distributions make perfect tools for cyber defense, especially in the areas of DoS and intrusion detection.
In this talk, we will introduce and discuss the significance and power of power law distributions, how they relate to computers, and how this can be used to develop new anomaly detection systems.

[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_slides.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Prandl-PEIMA-Harnessing-Power-Laws-To-Detect-Malicious-Activities-From-Denial-Of-Service-To-Intrusion-Detection-Traffic-Analysis-And-Beyond.pdf)
[![](https://www.blackhat.com/images/page-graphics-usa-17/icon_whitepaper.png "Presentation")](https://www.blackhat.com/docs/us-17/thursday/us-17-Prandl-PEIMA-Harnessing-Power-Laws-To-Detect-Malicious-Activities-From-Denial-Of-Service-To-Intrusion-Detection-Traffic-Analysis-And-Beyond-wp.pdf)

[![UBM Tech](https://www.blackhat.com/images/logo_ubm_white.png)](http://tech.ubm.com/)

* Technology Group
* [Black Hat](https://www.blackhat.com/)
* [Content Marketing Institute](http://contentmarketinginstitute.com/)
* [Content Marketing World](http://www.contentmarketingworld.com/)
* [Dark Reading](http://www.darkreading.com/)

* [Enterprise Connect](http://www.enterpriseconnect.com/)
* [Fusion](http://www.servicemanagementfusion.com/)
* [GDC](http://www.gdconf.com/)
* [Gamasutra](http://www.gamasutra.com/)

* [HDI](http://www.thinkhdi.com/)
* [ICMI](http://www.icmi.com)
* [InformationWeek](http://www.informationweek.com/)
* [Interop ITX](http://www.interop.com)

* [Network Computing](http://www.networkcomputing.com/)
* [No Jitter](http://www.nojitter.com/)
* [VRDC](http://vrdconf.com/)

* COMMUNITIES SERVED
* [Content Marketing](http://tech.ubm.com/community-brands/content-marketing-2/)
* [Enterprise IT](http://tech.ubm.com/community-brands/enterprise-it/)
* [Enterprise Communications](http://tech.ubm.com/community-brands/enterprise-communications/)
* [Game Development](http://tech.ubm.com/community-brands/game-and-app-developers/)
* [Information Security](http://tech.ubm.com/community-brands/information-security/)
* [IT Services & Support](http://tech.ubm.com/community-brands/technical-service-and-support/)

* WORKING WITH US
* [Advertising Contacts](http://createyournextcustomer.techweb.com/contact-us/)
* [Event Calendar](http://events.ubm.com/?company=10)
* [Tech Marketing](http://createyournextcustomer.techweb.com/)
* [Solutions](http://createyournextcustomer.techweb.com/)
* [Contact Us](http://tech.ubm.com/contact-us/)
* [Licensing](http://wrightsmedia.com/sites/ubm/index.cfm)

* [Terms of Service](http://legal.us.ubm.com/terms-of-service/)
* [Privacy Statement](http://legal.us.ubm.com/privacy-policy/)


