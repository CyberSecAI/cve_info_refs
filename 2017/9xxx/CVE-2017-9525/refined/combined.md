=== Content from security-tracker.debian.org_cfe28b4a_20250126_081400.html ===

# CVE-2017-9525

| **Name** | CVE-2017-9525 |
| --- | --- |
| **Description** | In the cron package through 3.0pl1-128 on Debian, and through 3.0pl1-128ubuntu2 on Ubuntu, the postinst maintainer script allows for group-crontab-to-root privilege escalation via symlink attacks against unsafe usage of the chown and chmod programs. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2017-9525) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2017-9525); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2017-9525), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2017-9525), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2017-9525), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2017-9525), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-9525), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2017-9525), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2017-9525), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2017-9525)/[CVE](https://www.suse.com/security/cve/CVE-2017-9525/), GitHub [advisories](https://github.com/advisories?query=CVE-2017-9525)/[code](https://github.com/search?type=Code&q=%22CVE-2017-9525%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2017-9525%22), [web search](https://duckduckgo.com/html?q=%22CVE-2017-9525%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DLA-1723-1](/tracker/DLA-1723-1), [DLA-2801-1](/tracker/DLA-2801-1) |
| **Debian Bugs** | [864466](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=864466), [993731](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=993731) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [cron](/tracker/source-package/cron) ([PTS](https://tracker.debian.org/pkg/cron)) | bullseye | 3.0pl1-137 | fixed |
|  | bookworm | 3.0pl1-162 | fixed |
|  | sid, trixie | 3.0pl1-189 | fixed |
| [systemd-cron](/tracker/source-package/systemd-cron) ([PTS](https://tracker.debian.org/pkg/systemd-cron)) | bullseye | 1.5.16-1 | vulnerable |
|  | bookworm | 1.15.19-5 | fixed |
|  | sid, trixie | 2.4.1-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [cron](/tracker/source-package/cron) | source | jessie | 3.0pl1-127+deb8u2 |  | [DLA-1723-1](/tracker/DLA-1723-1) |  |
| [cron](/tracker/source-package/cron) | source | stretch | 3.0pl1-128+deb9u2 |  | [DLA-2801-1](/tracker/DLA-2801-1) |  |
| [cron](/tracker/source-package/cron) | source | (unstable) | 3.0pl1-129 |  |  | [864466](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=864466) |
| [systemd-cron](/tracker/source-package/systemd-cron) | source | (unstable) | 1.5.17-2 |  |  | [993731](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=993731) |

## Notes

```
[wheezy] - cron <no-dsa> (Minor issue)
[bullseye] - systemd-cron <no-dsa> (Minor issue)
[buster] - systemd-cron <no-dsa> (Minor issue)
[stretch] - systemd-cron <no-dsa> (Minor issue)
<https://www.openwall.com/lists/oss-security/2017/06/08/3>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from lists.debian.org_c72659fe_20250125_113332.html ===


---

[[Date Prev](msg00028.html)][[Date Next](msg00030.html)]
[[Thread Prev](msg00028.html)][[Thread Next](msg00030.html)]
[[Date Index](maillist.html#00029)]
[[Thread Index](threads.html#00029)]

# [SECURITY] [DLA 2801-1] cron security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2801-1] cron security update
* *From*: Adrian Bunk <bunk@debian.org>
* *Date*: Sat, 30 Oct 2021 21:16:57 +0300
* *Message-id*: <[[🔎]](/msgid-search/20211030181657.GA15091%40localhost) [20211030181657.GA15091@localhost](msg00029.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2801-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Adrian Bunk
October 30, 2021                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : cron
Version        : 3.0pl1-128+deb9u2
CVE ID         : CVE-2017-9525 CVE-2019-9704 CVE-2019-9705 CVE-2019-9706
Debian Bug     : 809167

Brief introduction

CVE-2017-9525

    Fix group crontab to root escalation via postinst.

CVE-2019-9704

    A very large crontab created by a user could crash the daemon.

CVE-2019-9705

    Enforce maximum crontab line count of 10000 to prevent a malicious
    user from creating an excessivly large crontab.

CVE-2019-9706

    Fix for possible DoS by use-after-free.

Additionally, a bypass of /etc/cron.{allow,deny} on failure to open has
been fixed. If these files exist, then they must be readable by the user
executing crontab(1). Users will now be denied by default if they aren't.

For Debian 9 stretch, these problems have been fixed in version
3.0pl1-128+deb9u2.

We recommend that you upgrade your cron packages.

For the detailed security status of cron please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/cron>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEOvp1f6xuoR0v9F3wiNJCh6LYmLEFAmF9jBkACgkQiNJCh6LY
mLF3Aw//cnjLj14oQ/efkvNPkd7H24K5D4Ae6Zf7kbO7xN+AkWscJW1Jjk8SCq/i
VvN1XMftnc8KSXK20W9pm3guJfjdgS49gLy30Dish8p8GDzIPvdJYFb+ZNtU4f+Q
JywUZMWTlIUqqj9Wj5ceYyGYbLt+FiPdrXglb+77ubr3+lHeAYmXLQVIejqkqACn
YgZ3C8feu1xat5UPxHahuhkHvNgP87y3v+kuQhV/69zXgpeWAAOSDFULHTVI23FR
fHYrnoybhaTBTtuRrnUjBC1vantdhVGLdHa2qwQpct26txComknGVzj4adh70jtP
3k4ET+EnwC71RPS2UlbvfUZu+QpkcxoTmhmco9lhqTVLbVwBftbbB+BXPqexoS+g
AeVsDyNgkPi1njiCC88HifI0XNgH3u4z9YdJf7fSovKY/D7cirFYZu4it7p1mLiQ
73WxFzAS2MtXbZcD43CTrqXbo37hqTNny4EW2/KXqjXgaOu73E5If6mJvykop2md
aNGaBbT/5ie6eJqMnu4q7pxdLtCuAC4kF5YfXbnqYtlJ60nQQtA3UauwtBMn2cd7
+zOnb26bVA5f8tQ4h2NVXKmswDYxA9sD4qy+08mgewoN3LjQrzBeeW5kpyP78za3
sNsGAW2uniSBaNr2OwZe2qNUhtIAOCW+SiEaYsGauJvE+AIzzJY=
=/Qf3
-----END PGP SIGNATURE-----

```

---



=== Content from bugs.debian.org_14ba65ab_20250125_113331.html ===

# Debian Bug report logs - #864466 cron: CVE-2017-9525: group crontab to root escalation via postinst

[![version graph](version.cgi?absolute=0;package=src%3Acron;width=2;collapse=1;height=2;found=cron%2F3.0pl1-127;fixed=cron%2F3.0pl1-129)](version.cgi?collapse=1;package=src%3Acron;fixed=cron%2F3.0pl1-129;found=cron%2F3.0pl1-127;info=1;absolute=0)

Package:
[src:cron](pkgreport.cgi?src=cron);
Maintainer for [src:cron](pkgreport.cgi?src=cron) is [Georges Khaznadar <georgesk@debian.org>](pkgreport.cgi?maint=georgesk%40debian.org);

Reported by: [Salvatore Bonaccorso <carnil@debian.org>](pkgreport.cgi?submitter=carnil%40debian.org)

Date: Fri, 9 Jun 2017 05:45:02 UTC

Severity: important

Tags: patch, security

Found in version cron/3.0pl1-127

Fixed in version cron/3.0pl1-129

**Done:** Javier Fernández-Sanguino Peña <jfs@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=864466;mbox=yes), [status mbox](bugreport.cgi?bug=864466;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=864466;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, carnil@debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Javier Fernández-Sanguino Peña <jfs@debian.org>`:

`Bug#864466`; Package `src:cron`.
(Fri, 09 Jun 2017 05:45:04 GMT) ([full text](bugreport.cgi?bug=864466;msg=2), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

New Bug report received and forwarded. Copy sent to `carnil@debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Javier Fernández-Sanguino Peña <jfs@debian.org>`.
(Fri, 09 Jun 2017 05:45:04 GMT) ([full text](bugreport.cgi?bug=864466;msg=4), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=864466;msg=5), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: cron: group crontab to root escalation via postinst
Date: Fri, 09 Jun 2017 07:40:18 +0200
```
Source: cron
Version: 3.0pl1-127
Severity: important
Tags: security

Hi

There is reported a group crontab to root escalation via the postinst
in Debian and Ubuntu, as stated in the oss-security post:

<http://www.openwall.com/lists/oss-security/2017/06/08/3>

Our postinst contains:

| # Fixup crontab , directory and files for new group 'crontab'.
| # Can't use dpkg-statoverride for this because it doesn't cooperate nicely
| # with cron alternatives such as bcron
| if [ -d $crondir/crontabs ] ; then
|     chown root:crontab $crondir/crontabs
|     chmod 1730 $crondir/crontabs
|     # This used to be done conditionally. For versions prior to "3.0pl1-81"
|     # It has been disabled to suit cron alternative such as bcron.
|     cd $crondir/crontabs
|     set +e
|     ls -1 | xargs -r -n 1 --replace=xxx  chown 'xxx:crontab' 'xxx'
|     ls -1 | xargs -r -n 1 chmod 600
|     set -e
| fi

which can be used for group-crontab-to-root escalation of privileges
as described by Qualys team in the above reference.

(note that for the first issue, we have already the kernel hardening
in place since Debian Wheezy).

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Javier Fernández-Sanguino Peña <jfs@debian.org>`:

`Bug#864466`; Package `src:cron`.
(Fri, 09 Jun 2017 18:27:02 GMT) ([full text](bugreport.cgi?bug=864466;msg=7), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Javier Fernández-Sanguino Peña <jfs@debian.org>`.
(Fri, 09 Jun 2017 18:27:03 GMT) ([full text](bugreport.cgi?bug=864466;msg=9), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 864466@bugs.debian.org ([full text](bugreport.cgi?bug=864466;msg=10), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 864466@bugs.debian.org
Subject: Re: Bug#864466: cron: group crontab to root escalation via postinst
Date: Fri, 9 Jun 2017 20:23:59 +0200
```
Control: retitle -1 cron: [CVE-2017-9525](https://security-tracker.debian.org/tracker/CVE-2017-9525): group crontab to root escalation via postinst

Hi,

On Fri, Jun 09, 2017 at 07:40:18AM +0200, Salvatore Bonaccorso wrote:
> There is reported a group crontab to root escalation via the postinst
> in Debian and Ubuntu, as stated in the oss-security post:
>
> <http://www.openwall.com/lists/oss-security/2017/06/08/3>
>
> Our postinst contains:
>
> | # Fixup crontab , directory and files for new group 'crontab'.
> | # Can't use dpkg-statoverride for this because it doesn't cooperate nicely
> | # with cron alternatives such as bcron
> | if [ -d $crondir/crontabs ] ; then
> |     chown root:crontab $crondir/crontabs
> |     chmod 1730 $crondir/crontabs
> |     # This used to be done conditionally. For versions prior to "3.0pl1-81"
> |     # It has been disabled to suit cron alternative such as bcron.
> |     cd $crondir/crontabs
> |     set +e
> |     ls -1 | xargs -r -n 1 --replace=xxx  chown 'xxx:crontab' 'xxx'
> |     ls -1 | xargs -r -n 1 chmod 600
> |     set -e
> | fi
>
> which can be used for group-crontab-to-root escalation of privileges
> as described by Qualys team in the above reference.

This has been assigned [CVE-2017-9525](https://security-tracker.debian.org/tracker/CVE-2017-9525).

Regards,
Salvatore

```

---

**Changed Bug title to 'cron: CVE-2017-9525: group crontab to root escalation via postinst' from 'cron: group crontab to root escalation via postinst'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `864466-submit@bugs.debian.org`.
(Fri, 09 Jun 2017 18:27:03 GMT) ([full text](bugreport.cgi?bug=864466;msg=12), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=12), [link](#11)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Javier Fernández-Sanguino Peña <jfs@debian.org>`:

`Bug#864466`; Package `src:cron`.
(Mon, 12 Jun 2017 21:54:04 GMT) ([full text](bugreport.cgi?bug=864466;msg=14), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent**
to `Christian Kastner <ckk@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Javier Fernández-Sanguino Peña <jfs@debian.org>`.
(Mon, 12 Jun 2017 21:54:05 GMT) ([full text](bugreport.cgi?bug=864466;msg=16), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 864466@bugs.debian.org ([full text](bugreport.cgi?bug=864466;msg=17), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=ckk%40debian.org)
From: Christian Kastner <ckk@debian.org>
To: Salvatore Bonaccorso <carnil@debian.org>, 864466@bugs.debian.org
Subject: Re: Bug#864466: cron: group crontab to root escalation via postinst
Date: Mon, 12 Jun 2017 23:17:50 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=864466;msg=17) (text/plain, inline)]
```
```
Control: tag -1 +patch

Hi Salvatore,

On 2017-06-09 20:23, Salvatore Bonaccorso wrote:
> On Fri, Jun 09, 2017 at 07:40:18AM +0200, Salvatore Bonaccorso wrote:
>> There is reported a group crontab to root escalation via the postinst
>> in Debian and Ubuntu, as stated in the oss-security post:
>>
>> <http://www.openwall.com/lists/oss-security/2017/06/08/3>
>>
>> Our postinst contains:
>>
>> | # Fixup crontab , directory and files for new group 'crontab'.
>> | # Can't use dpkg-statoverride for this because it doesn't cooperate nicely
>> | # with cron alternatives such as bcron
>> | if [ -d $crondir/crontabs ] ; then
>> |     chown root:crontab $crondir/crontabs
>> |     chmod 1730 $crondir/crontabs
>> |     # This used to be done conditionally. For versions prior to "3.0pl1-81"
>> |     # It has been disabled to suit cron alternative such as bcron.
>> |     cd $crondir/crontabs
>> |     set +e
>> |     ls -1 | xargs -r -n 1 --replace=xxx  chown 'xxx:crontab' 'xxx'
>> |     ls -1 | xargs -r -n 1 chmod 600
>> |     set -e
>> | fi
>>
>> which can be used for group-crontab-to-root escalation of privileges
>> as described by Qualys team in the above reference.
>
> This has been assigned [CVE-2017-9525](https://security-tracker.debian.org/tracker/CVE-2017-9525).

Please find attached a first draft of a (so far only rudimentally
tested) patch for this issue.

I replace the unconditional chown/chgrp of everything under
/var/spool/cron/crontabs with a conditional solution. A file in that
directory must now satisfy the following requirements:
  1. It must be a regular file
  2. It must have a hard link count of exactly 1
  3. It's name must match its owner (the daemon expects this)

We cannot really add a test for the group because the intention is to
change it from whatever it currently is to what we expect.

Adding a test for non-executability is something that could be
considered. We'd have to check interoperability with other cron
implementations.

Please let me know what you think.

Regards,
Christian

```
```
[[cve-2017-9525.patch](bugreport.cgi?att=1;bug=864466;filename=cve-2017-9525.patch;msg=17) (text/x-patch, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=864466;filename=signature.asc;msg=17) (application/pgp-signature, attachment)]
```

---

**Added tag(s) patch.**
Request was from `Christian Kastner <ckk@debian.org>`
to `864466-submit@bugs.debian.org`.
(Mon, 12 Jun 2017 21:54:05 GMT) ([full text](bugreport.cgi?bug=864466;msg=19), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=19), [link](#18)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Javier Fernández-Sanguino Peña <jfs@debian.org>`:

`Bug#864466`; Package `src:cron`.
(Mon, 12 Jun 2017 21:57:02 GMT) ([full text](bugreport.cgi?bug=864466;msg=21), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent**
to `Christian Kastner <ckk@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Javier Fernández-Sanguino Peña <jfs@debian.org>`.
(Mon, 12 Jun 2017 21:57:02 GMT) ([full text](bugreport.cgi?bug=864466;msg=23), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 864466@bugs.debian.org ([full text](bugreport.cgi?bug=864466;msg=24), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=ckk%40debian.org)
From: Christian Kastner <ckk@debian.org>
To: Salvatore Bonaccorso <carnil@debian.org>, 864466@bugs.debian.org
Subject: Re: Bug#864466: cron: group crontab to root escalation via postinst
Date: Mon, 12 Jun 2017 23:53:12 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=864466;msg=24) (text/plain, inline)]
```
```
On 2017-06-12 23:17, Christian Kastner wrote:
> Please find attached a first draft of a (so far only rudimentally
> tested) patch for this issue.

I attached an updated version in which I reverted a last-minute change
breaking the name comparison.

```
```
[[cve-2017-9525.patch](bugreport.cgi?att=1;bug=864466;filename=cve-2017-9525.patch;msg=24) (text/x-patch, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=864466;filename=signature.asc;msg=24) (application/pgp-signature, attachment)]
```

---

**Reply sent**
to `Javier Fernández-Sanguino Peña <jfs@debian.org>`:

You have taken responsibility.
(Sun, 11 Mar 2018 23:06:20 GMT) ([full text](bugreport.cgi?bug=864466;msg=26), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=26), [link](#25)).

---

**Notification sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug acknowledged by developer.
(Sun, 11 Mar 2018 23:06:21 GMT) ([full text](bugreport.cgi?bug=864466;msg=28), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 864466-close@bugs.debian.org ([full text](bugreport.cgi?bug=864466;msg=29), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=jfs%40debian.org)
From: Javier Fernández-Sanguino Peña <jfs@debian.org>
To: 864466-close@bugs.debian.org
Subject: Bug#864466: fixed in cron 3.0pl1-129
Date: Sun, 11 Mar 2018 23:04:21 +0000
```
Source: cron
Source-Version: 3.0pl1-129

We believe that the bug you reported is fixed in the latest version of
cron, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 864466@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Javier Fernández-Sanguino Peña <jfs@debian.org> (supplier of updated cron package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Sun, 11 Mar 2018 22:38:06 +0100
Source: cron
Binary: cron
Architecture: source i386
Version: 3.0pl1-129
Distribution: unstable
Urgency: medium
Maintainer: Javier Fernández-Sanguino Peña <jfs@debian.org>
Changed-By: Javier Fernández-Sanguino Peña <jfs@debian.org>
Description:
 cron       - process scheduling daemon
Closes: [767016](bugreport.cgi?bug=767016) [783665](bugreport.cgi?bug=783665) [801384](bugreport.cgi?bug=801384) [819832](bugreport.cgi?bug=819832) [864466](bugreport.cgi?bug=864466)
Changes:
 cron (3.0pl1-129) unstable; urgency=medium
 .
   * Acknowledge NMU
   * debian/cron.init, debian/cron.service: Make sure cron is started last and
     stopped first, with patch provided by Harald Dunke
     (Closes: #[767016](bugreport.cgi?bug=767016), #[801384](bugreport.cgi?bug=801384), #[783665](bugreport.cgi?bug=783665)) (LP: #1593317)
   * crontab.1: Document limitation due to account renaming as described in
     Ubuntu's bug 73398
   * crontab.5: Document the need to set the DISPLAY environment when running
     scheduled tasks that interact with the user's desktop environment
     (LP: #891869)
   * cron.8: Fix typo (Closes: [819832](bugreport.cgi?bug=819832))
   * debian/control: Replace dh-systemd dependency with debhelper (lintian fix)
   * debian/README.Debian: Update maintainer address
 .
   [ Christian Kastner ]
   * debian/postinst: Fix for [CVE-2017-9525](https://security-tracker.debian.org/tracker/CVE-2017-9525): group crontab to root escalation via postinst
   as described by Alexander Peslyak (Solar Designer) in
   <http://www.openwall.com/lists/oss-security/2017/06/08/3>
   (Closes: [864466](bugreport.cgi?bug=864466))
Checksums-Sha1:
 c39da58d644fe25595757acf8a36e551c52e1f97 1923 cron_3.0pl1-129.dsc
 f4c9296f8f8e37b439eca312fd837b729349f0b8 99872 cron_3.0pl1-129.diff.gz
 1760612136fc7fa609daf5c158856f69016bdfaf 78752 cron-dbgsym_3.0pl1-129_i386.deb
 127dfa254c2cba86a08aadad86bfa9288e792c0e 6329 cron_3.0pl1-129_i386.buildinfo
 694978c4128ef70924dd3fabb963959c200806ca 98092 cron_3.0pl1-129_i386.deb
Checksums-Sha256:
 b21e922cdc5b0b2f5e623da7086a38f69f8d2e3b230640620bd9e1cbd831204a 1923 cron_3.0pl1-129.dsc
 996bce2be55c5c46d145946b8d6a9d86f56cc32a8ff8ba7bf8965512ee398a67 99872 cron_3.0pl1-129.diff.gz
 341d093492bf55a5c25270d8117376a69ec65426e459b63a8ee39d33faac3f37 78752 cron-dbgsym_3.0pl1-129_i386.deb
 794f1648462df67c749294923c1546d2968d582276c609677cda58333384216a 6329 cron_3.0pl1-129_i386.buildinfo
 fd55c3a3cc1291e833730888f19fbfa370635798b31296ad08af2dd069eff957 98092 cron_3.0pl1-129_i386.deb
Files:
 b9fea6c16c4154d0e500f6fb465a5118 1923 admin important cron_3.0pl1-129.dsc
 fbc47dd4bb66d84c3a37e8f712ecb019 99872 admin important cron_3.0pl1-129.diff.gz
 ca5e626233fd34fc3617d6e975989307 78752 debug optional cron-dbgsym_3.0pl1-129_i386.deb
 d43255a230a9288caa03089d2e3a44c1 6329 admin important cron_3.0pl1-129_i386.buildinfo
 e08efce3c6b00eb7caa779e0b28d002e 98092 admin important cron_3.0pl1-129_i386.deb

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEFQ8Kq6ttIR3DT+AOix9vSKslf5gFAlqlsdcACgkQix9vSKsl
f5hfkhAAocm6FLihu56vY2kny+VbfUiKpPzoG5IZkogTUpQvYWJ4uVI8h8kCHXfO
qdVtAA++Jb/1aol2t2Qk8hju7FU0igF+yP+Hpgv7PHnjWg4CKiR2UFQh7ramNZaF
fjef9fztFOI6UQyfj8glESEe4wlOAhvrS2hNLHWsowcOA4iDF2uiw2WkffPZDi9w
KVGFyYQIlROA7FYP21gx3AMn64BL82uqQZTuoEXBlPHfW4Ji7Nt8t222IP+hSU9N
CnVWnwntlZ434MVGt1ArjFSR+4xU44WNQZjUiR6rxSXswheUfXMhKp3PHJ3jeGm7
z4omV+Um7CWZLDoHrhOYenweSk7+Q3UtuGR72dQSZQPIHhjIQGRCg7P/EwAr1FxS
jxXFjRYacYDVW5IHhQuQo5JOG4nMhYvSjbQ9grBxk7CM1REv2DnOGVGOVUAmQyrL
Na4H/2s+BISlAJIrGQmmdRcodLxKAPuRPKcLFRPgPXCI7Evk3m8K244UBY1IDFpw
hQ+yeMYOBGObSn3QcvZ8la3dX7V1t30Z+NfsQXbIhh06Oc10aF9hKSqw0Rr1Sc5S
//VC3pi/R//AfWWCUL7Dftqcy4Ke+T5IEuQMre+IHOMiKOFP7m7pErgpc32OI5qM
EW/diMdUVUoKMCw2ksZaAMy06IfREE66Bp/D1DtHc8wqk0yN7ac=
=eAvM
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 15 Apr 2018 07:29:01 GMT) ([full text](bugreport.cgi?bug=864466;msg=31), [mbox](bugreport.cgi?bug=864466;mbox=yes;msg=31), [link](#30)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=864466).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 11:33:31 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.openwall.com_154277b0_20250125_113332.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](12) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20170608180534.GA27098@openwall.com>
Date: Thu, 8 Jun 2017 20:05:34 +0200
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: Vixie/ISC Cron group crontab to root escalation

Hi,

Summary:

Two group crontab to root privsep bypasses were found: one in Cron
itself (with some dependency on the rest of the system) and the other in
Debian/Ubuntu postinst script for it.  These issues are minor because
they are only privsep bypasses, so to exploit them one would need to
gain group crontab first (via some other vulnerability).  Many systems
(and upstream ISC Cron default build/install) don't even have this
privsep layer, so there's nothing in those to bypass in the first place.
For those that do, it provides some defense-in-depth, even if
non-perfect.  Some fixes and workarounds have been developed and
proposed, some more are expected.

These findings are a result of a discussion with people from Qualys,
OpenBSD, Debian, and Ubuntu.

Detail:

Some historical notes on Vixie Cron (now ISC Cron):

<https://en.wikipedia.org/wiki/Cron#Modern_versions>

"[...] Vixie cron, originally coded by Paul Vixie in 1987.  Version 3 of
Vixie cron was released in late 1993.  Version 4.1 was renamed to ISC
Cron and was released in January 2004.  Version 3, with some minor
bugfixes, is used in most distributions of Linux and BSDs.

In 2007, Red Hat forked vixie-cron 4.1 to the cronie project and
included anacron 2.3 in 2009."

First, this issue isn't exactly a vulnerability in ISC Cron.  While
Paul Vixie kindly accepted changes into upstream ISC Cron implementing
optional support for installation with the crontab(1) program SGID to
group crontab, so that security-hardened systems have fewer changes to
maintain, this isn't how upstream ISC Cron is configured and installed
by default.  The current (and probably final?) upstream version is
"cron_4.1.shar 201 KB 01/23/2004" at ftp://ftp.isc.org/isc/cron/ (the
only remaining upstream URL?) and it has CRON_GROUP commented out and
installation as SUID root:

X                       /* Define this to run crontab setgid instead of
X                        * setuid root.  Group access will be used to read
X                        * the tabs/atjobs dirs and the allow/deny files.
X                        * If this is not defined then crontab and at
X                        * must be setuid root.
X                        */
X/*#define CRON_GROUP   "crontab"       /*-*/

and:

X                       $(INSTALL) -c -m 4111 -o root -s crontab $(DESTBIN)/

Thus, in a default install and on many systems this layer of privilege
separation is not enabled anyway, and so there's no "group crontab to
root escalation" since a suitable vulnerability in crontab(1) (or in the
SUID binary startup code in the kernel, dynamic linker, or libc) would
result in a root compromise right away.

It's only some systems that do install crontab(1) SGID crontab that are
affected by the issue described below, and only to the relatively minor
extent of at worst bringing them on par with the systems that did not
take advantage of this privilege separation layer.

Now let's proceed to the actual issue, fixed in OpenBSD yesterday.

In a mostly unrelated posting to the distros list, the Qualys Security
Advisory team casually mentioned that on OpenBSD "/usr/bin/at is
SGID-crontab (which can be escalated to full root privileges)".  I asked
them "How can group crontab be escalated to full root privileges?" and
on May 26 they provided the below detail:

| 1/ Group crontab can write to both:
|
|  25740    4 drwxrwx--T    2 root     crontab       512 Jul 26  2016 /var/cron/atjobs
|  25741    4 drwx-wx--T    2 root     crontab	   512 Jul 26  2016 /var/cron/tabs
|
| 2/ Both "at" and cron files are checked for the correct owner, but
| there's an exception for root-owned files. "at" files must have their
| user execute bit set so we couldn't exploit this loophole through "at"
| files, but there's no such check for cron files.
|
| 3/ On OpenBSD, at least one daemon allows you to create a temporary file
| (in /tmp) that belongs to root and contains your own (arbitrary) data,
| and you can then hard-link it to /var/cron/tabs.
|
| 4/ This doesn't give you root immediately, because there's already a
| /var/cron/tabs/root (and /var/cron/tabs is sticky), but:
|
| - you can either obtain an admin's privileges and trojan his su (or does
|   anyone have a better idea?);
|
| - or you can obtain the privileges of one of the system accounts, wait
|   until the next reboot, delete root's crontab through one of OpenBSD's
|   startup scripts, and then create your own root crontab.
|
| This includes a few OpenBSD-specific tricks, but maybe the main issue
| (hard-linked root-owned files whose content is attacker-controlled) is
| more generic?
|
| We thought this was a known issue

I wish that at this point we switched to public discussion on
oss-security, since the issue wasn't directly triggerable and was only a
privsep bypass, but out of inertia the discussion proceeded in private.

The gist of the attack is that the original program managing the
temporary file deletes its own link to the file, which results in the
remaining malicious link having st_nlink of 1, thus satisfying the
"st_nlink == 1" requirement.  When I first read Qualys' response above,
this detail looked potentially new to me.  However, further in the
discussion I looked at the patch I wrote for Owl back in 2000:

<http://cvsweb.openwall.com/cgi/cvsweb.cgi/~checkout~/Owl/packages/vixie-cron/Attic/vixie-cron-3.0.2.7-owl-sgid-crontab.diff?rev=1.4;content-type=text%2Fplain>

and found this comment in there:

+/*
+ * The link count check is not sufficient (the owner may delete their
+ * original link, reducing the link count back to 1), but this is all
+ * we've got.
+ */

So I hadn't exactly overlooked this issue, but more like neglected it
(at the time, Owl normally used -ow kernels that had hard link
restrictions by default, preventing the attack).

In 2002, Todd C. Miller made similar changes in OpenBSD, including the
st_nlink check, but not the comment.  The commit message said:

"crontab is no longer setuid root, it is now setgid crontab.
These changes were modelled after the Owl version of vixie-cron,
but developed independently."

These are also the changes that Paul Vixie partially accepted upstream.

We've since sync'ed the Vixie Cron package in Owl to newer OpenBSD's
(thus, gaining Todd's reimplementation of this functionality instead of
my original) in 2004 and again in 2006.  Dmitry V. Levin did the same in
ALT Linux, too.  This provided built-in support for "at", which isn't
found in upstream Vixie/ISC Cron (per Todd, it's something Paul chose
not to include in there).

In 2003, the original patch went from Owl into Debian (and thus Ubuntu),
along with the original comment above:

<https://anonscm.debian.org/cgit/pkg-cron/pkg-cron.git/commit/?id=ce8f4773590dd76505631bd71874e999a85de607>

Thanks to Salvatore Bonaccorso of Debian for locating the above URL for
the current discussion.  In there, we also see the addition of a
postinst script changing permissions on existing crontab files.  This
was also pointed out by Seth Arnold of Ubuntu, who wrote:

| - postinst scripts are already brittle
| - postinst scripts themselves become a target for elevating privileges if
|   they'll just set the permissions as needed
|
| But the Debian/Ubuntu packaging already has scripts for this purpose:
|
| <http://sources.debian.net/src/cron/3.0pl1-128/debian/postinst/#L53>
|
| ...
| # Fixup crontab , directory and files for new group 'crontab'.
| # Can't use dpkg-statoverride for this because it doesn't cooperate nicely
| # with cron alternatives such as bcron
| if [ -d $crondir/crontabs ] ; then
|     chown root:crontab $crondir/crontabs
|     chmod 1730 $crondir/crontabs
|     # This used to be done conditionally. For versions prior to "3.0pl1-81"
|     # It has been disabled to suit cron alternative such as bcron.
|     cd $crondir/crontabs
|     set +e
|     ls -1 | xargs -r -n 1 --replace=xxx  chown 'xxx:crontab' 'xxx'
|     ls -1 | xargs -r -n 1 chmod 600
|     set -e
| fi

Qualys promptly broke this script, replying to Seth:

| Hmmm, you're right, the script itself is vulnerable to
| group-crontab-to-root escalation of privileges:
|
| root@...ian:~# usermod --append --groups crontab nobody
| root@...ian:~# su --login --shell /bin/bash nobody
| No directory, logging in with HOME=/
|
| nobody@...ian:/$ id
| uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup),107(crontab)
|
| nobody@...ian:/$ cd /var/spool/cron/crontabs
|
| # for example, this exploits the chown
| nobody@...ian:/var/spool/cron/crontabs$ ln --symbolic /etc/passwd- nobody
|
| # for example, this exploits the chmod
| nobody@...ian:/var/spool/cron/crontabs$ touch ./--reference=.RFILE
| nobody@...ian:/var/spool/cron/crontabs$ chmod 0666 .RFILE > .RFILE
| nobody@...ian:/var/spool/cron/crontabs$ ln --symbolic /etc/passwd 600
|
| nobody@...ian:/var/spool/cron/crontabs$ ls -l /etc/passwd*
| -rw-r--r-- 1 root root 1378 May 10 17:16 /etc/passwd
| -rw------- 1 root root 1378 May 10 17:16 /etc/passwd-
|
| # run the postinst script
| root@...ian:~# dpkg-reconfigure cron
| chown: missing operand
| Try 'chown --help' for more information.
| update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
|
| nobody@...ian:/var/spool/cron/crontabs$ ls -l /etc/passwd*
| -rw-rw-rw- 1    600 crontab 1378 May 10 17:16 /etc/passwd
| -rw------- 1 nobody crontab 1378 May 10 17:16 /etc/passwd-
|
| So this is a known issue?  (there may be more ways to exploit it --
| spaces, newlines, option injections, etc).

So this looked like two issues to fix: the temporary file hard link
attack (in OpenBSD, Debian, Ubuntu, ALT Linux, and Owl) and the postinst
script (in Debian and Ubuntu).

For the first issue, I suggested that the Cron daemon should check group
ownership of crontab files and require them to be of group crontab.
Ditto for at job files.  Luckily, crontab files were already created
with group crontab on them.  The at job files (where supported) were
created with the user's group on them, but having them work across this
one-time Cron upgrade isn't as important.

This defeats attacks via hard links to unrelated daemons' temporary
files, as well as via daemons' log files that are rotated and daemons'
"constant" database files (like cdb) that are replaced atomically with
rename(2) - these are the various attack vectors that came up in the
discussion.  However, Qualys came up with another attack scenario:

| 1/ we have somehow obtained GID crontab privileges;
|
| 2/ we found a SUID-root binary (this is hypothetical) that creates a
| temporary file with suitable permissions and contents, that we can
| hard-link to the crontab directory (possible, since we have GID
| crontab).
|
| But since we have GID crontab, the SUID-root binary directly creates the
| temporary file with GID crontab, and once hard-linked to the crontab
| directory this file would therefore be accepted by crond

One way to defeat this attack would be to additionally mark intentional
crontabs and at jobs with unusual file permissions - such as setting the
sticky bit on them.  This was considered, but we decided against it so
far because to maintain existing cron jobs across this one Cron upgrade
we'd require something like Debian's postinst script, and that's risky.

One aspect where we can make a little bit use of file permissions anyway
is to defeat "cross-links" between crontabs and at jobs.  Luckily, these
files already differ in permissions: the at jobs have the u+x bit set on
them, whereas crontabs don't.  I proposed that we harden the permission
checks even further, to require the exact permission bits that these two
types of files are being created with.

As to dealing with Qualys' hypothetical attack via some unrelated SUID
binary, Todd went for hardening the file parsing, to require that both
types of files have the correct format.  This was already the case for
at jobs, but not for crontabs.  Todd's latest commit message in:

<https://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.sbin/cron/>

says:

"In cron(8), require that crontab and at files in the spool be owned
by group crontab.  The at(1) command now creates files owned by
group crontab, the crontab(1) command already does this.

Files in the crontab spool with parse errors are now ignored;
crontab(1) will not install a crontab file with parse errors.
The system crontab file (/etc/crontab) is not affected by this.

The required permissions on crontab files have been tightened.
Files in the cron spool must be mode 0600 (as created by crontab(1)).
The system crontab file may be readable/writable by the owner,
readable by group and readable by other.  The system crontab must
be readable by the owner."

That's it for OpenBSD.

For Debian and Ubuntu, I suggested:

| One way to fix the cron issue is to restrict hard links in the kernel.
| This is now the "fs.protected_hardlinks = 1" sysctl supported upstream.
| So maybe you just make this the default for your distro, if not already,
| and say that it's also the fix for the cron issue.  However, you will
| still need to fix the postinst script separately - or maybe remove that
| script since it's probably only still needed for upgrades from ancient
| versions of Debian, for which you probably no longer support direct
| upgrades for other reasons anyway.

Salvatore replied:

| Fortunately the first one is the default already in Debian since quite
| a long time:
|
| <https://bugs.debian.org/609455>, so since 3.2.9-1 (then the default was
| reverted, but Debian added on top the patch to enable it by default in
| <https://anonscm.debian.org/cgit/kernel/linux.git/commit/?id=7893fc2202b138cb9a7ec7b76ea248c2e7ac4503>)
|
| We will need to think about what to do with the postinst script yet.

and Moritz Muehlenhoff confirmed:

| > This is now the "fs.protected_hardlinks = 1" sysctl supported upstream.
| > So maybe you just make this the default for your distro, if not already,
|
| That is in fact the default since Debian 7/wheezy (and it's explicitly
| documented that that if someone builds a custom kernel instead of the
| kernel packages shipped in Debian, they need to enable it in a custom
| build as well).
|
| > However, you will
| > still need to fix the postinst script separately - or maybe remove that
| > script since it's probably only still needed for upgrades from ancient
| > versions of Debian, for which you probably no longer support direct
| > upgrades for other reasons anyway.
|
| Ack, but we need to loop in the Debian cron maintainers for further
| discussion, so I'm all for making this public.

For Owl, we had refocused from -ow patches (hardening the kernel) to
providing a safer userland and OpenVZ integration years ago, and
currently Owl is a legacy system that's barely maintained.  We might or
might not resume active development.  However, for now I backported
upstream's revision of the hardlink restrictions to the RHEL5/OpenVZ
kernels included in Owl-current.  I intend to also get this into
3.1-stable soon (almost the same kernels).  This is sufficient to deal
with the Cron issue, but we might also merge Todd's changes from OpenBSD
eventually.

I guess ALT Linux will go either route, or both, too.

In Owl, we have our patches relative to OpenBSD's revision of 4.1 from
2006 in:

<http://cvsweb.openwall.com/cgi/cvsweb.cgi/Owl/packages/vixie-cron/>

and the corresponding tarball as well as two older ones in e.g.:

<https://mirrors.kernel.org/openwall/Owl/pool/sources/vixie-cron/>

(as well as on other mirrors).  These tarballs do not contain our
patches yet - they're extracts from OpenBSD, and our patches from the
CVS tree above are applied on top of them at package build time.
This is very old code, but aside from this recently (re)discovered issue
it just worked for us so far.

ALT Linux has these same patches too, plus some of their own (such as
adding SELinux support), using the same base version from OpenBSD (we
shared some development effort on this):

<http://sisyphus.ru/en/srpm/Sisyphus/vixie-cron>
<http://git.altlinux.org/people/zerg/packages/?p=vixie-cron.git>

Gentoo has a wiki page describing their Vixie Cron here:

<https://wiki.gentoo.org/wiki/Cron#vixie-cron>

Per their description, it's based on 4.1 and has some Linux specifics
added (SELinux, PAM, etc.)  I don't know whether they use group crontab.

Ideally, we need a new upstream maintainer for ISC Cron, so that other
distros could easily introduce this privsep layer as well and readily
have the known issues fixed by simply using upstream code.  It'd be
great if Todd volunteered for this role.

I did not look at the Red Hat forks mentioned in the Wikipedia article,
though.  I doubt they're suitable to replace upstream, but maybe?
Someone should probably take a look before becoming the new upstream.

Sorry for the lengthy message.

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from wiki.debian.org_8d48714b_20250126_081359.html ===

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")

[Wiki](/FrontPage "Debian Wiki Homepage")

[Login](/LTS?action=login)

* [FrontPage](/FrontPage)
* [RecentChanges](/RecentChanges)
* [FindPage](/FindPage)
* [HelpContents](/HelpContents)
* [LTS](/LTS)

Search:

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")
[Wiki](/FrontPage "Debian Wiki Homepage")/

* [Login](/LTS?action=login)
* Comments
* [Info](/LTS?action=info)
* [Attachments](/LTS?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  ------------------------
  Load
  Save
  SlideShow

# * [LTS](/LTS)

[Translation(s)](/DebianWiki/EditorGuide#translation): [English](/LTS) - [Deutsch](/de/LTS) - [Español](/es/LTS) - [Français](/fr/LTS) - [Italiano](/it/LTS) - [한국어](/ko/LTS) - [Português](/pt/LTS) - [Português (Brasil)](/pt_BR/LTS) - [Русский](/ru/LTS)

# Debian Long Term Support

Debian Long Term Support (LTS) is a project to extend the lifetime of all Debian stable releases to (at least) 5 years. Debian LTS is not handled by the Debian Security and Release teams, but by a separate group of volunteers and companies interested in making it a success.

Thus the Debian LTS team takes over security maintenance of the various releases once the Debian Security team stops its work.

![/!\](/htdocs/debwiki/img/alert.png "/!\")

LTS ([last modified 2024-08-15 02:46:47](/LTS?action=info))

* Debian [privacy policy](https://www.debian.org/legal/privacy), Wiki [team](/Teams/DebianWiki), [bugs](https://bugs.debian.org/wiki.debian.org) and [config](https://salsa.debian.org/debian/wiki.debian.org).
* Powered by [MoinMoin](https://moinmo.in/ "This site uses the MoinMoin Wiki software.") and [Python](https://moinmo.in/Python "MoinMoin is written in Python."), with hosting provided by [Metropolitan Area Network Darmstadt](https://www.man-da.de/).



=== Content from lists.debian.org_8fa72611_20250125_113332.html ===


---

[[Date Prev](msg00024.html)][[Date Next](msg00026.html)]
[[Thread Prev](msg00024.html)][[Thread Next](msg00026.html)]
[[Date Index](maillist.html#00025)]
[[Thread Index](threads.html#00025)]

# [SECURITY] [DLA 1723-1] cron security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1723-1] cron security update
* *From*: Mike Gabriel <sunweaver@debian.org>
* *Date*: Thu, 21 Mar 2019 21:21:10 +0100
* *Message-id*: <[[🔎]](/msgid-search/20190321202107.GA19401%40minobo.das-netzwerkteam.de) [20190321202107.GA19401@minobo.das-netzwerkteam.de](msg00025.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : cron
Version        : 3.0pl1-127+deb8u2
CVE ID         : CVE-2017-9525 CVE-2019-9704 CVE-2019-9705 CVE-2019-9706
Debian Bug     : 809167

Various security problems have been discovered in Debian's CRON scheduler.

CVE-2017-9525

    Fix group crontab to root escalation via the Debian package's
    postinst script as described by Alexander Peslyak (Solar Designer) in
    <http://www.openwall.com/lists/oss-security/2017/06/08/3>

CVE-2019-9704

    DoS: Fix unchecked return of calloc(). Florian Weimer discovered that
    a missing check for the return value of calloc() could crash the
    daemon, which could be triggered by a very large crontab created by a
    user.

CVE-2019-9705

    Enforce maximum crontab line count of 1000 to prevent a malicious
    user from creating an excessivly large crontab. The daemon will log a
    warning for existing files, and crontab(1) will refuse to create new
    ones.

CVE-2019-9706

    A user reported a use-after-free condition in the cron daemon,
    leading to a possible Denial-of-Service scenario by crashing the
    daemon.

For Debian 8 "Jessie", these problems have been fixed in version
3.0pl1-127+deb8u2.

We recommend that you upgrade your cron packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--

mike gabriel aka sunweaver (Debian Developer)
fon: +49 (1520) 1976 148

GnuPG Fingerprint: 9BFB AEE8 6C0A A5FF BF22  0782 9AF4 6B30 2577 1B31
mail: sunweaver@debian.org, <http://sunweavers.net>

```

**Attachment:
[signature.asc](pgpl2dB581dRm.pgp)**

*Description:* PGP signature

---


