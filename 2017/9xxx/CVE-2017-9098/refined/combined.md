=== Content from scarybeastsecurity.blogspot.com_573053c7_20250125_200247.html ===


# [Security](https://scarybeastsecurity.blogspot.com/)

Hacking everything, by Chris Evans / scarybeasts

## Thursday, May 18, 2017

### \*bleed continues: 18 byte file, $14k bounty, for leaking private Yahoo! Mail images

**Overview**

\*bleed attacks are hot right now. Most notably, there's been [Heartbleed](https://en.wikipedia.org/wiki/Heartbleed) and [Cloudbleed](https://en.wikipedia.org/wiki/Cloudbleed). In both cases, out-of-bounds reads in server side code resulted in private server memory content being returned to clients. This leaked sensitive secrets from the server process' memory space, such as keys, tokens, cookies, etc. There was also a recent [client-side bleed in Microsoft's image libraries](https://bugs.chromium.org/p/project-zero/issues/detail?id=992), exposed through Internet Explorer. One of the reason \*bleed attacks are interesting is that they are not affected by most sandboxing, and they are relatively easy to exploit.

Presented here is Yahoobleed #1 (YB1), a way to slurp other users' private Yahoo! Mail image attachments from Yahoo servers.

YB1 abuses an 0-day I found in the [ImageMagick](https://www.imagemagick.org/script/index.php) image processing software. This vulnerability is now a so-called 1-day, because I promptly reported it to upstream ImageMagick and provided a 1-line patch to resolve the issue, which [landed here](http://git.imagemagick.org/repos/ImageMagick/commit/1c358ffe0049f768dd49a8a889c1cbf99ac9849b). You can refer to it as CESA-2017-0002.

The previous \*bleed vulnerabilities have typically been out-of-bounds reads, but this one is the use of uninitialized memory. An uninitialized image decode buffer is used as the basis for an image rendered back to the client. This leaks server side memory. This type of vulnerability is fairly stealthy compared to an out-of-bounds read because the server will never crash. However, the leaked secrets will be limited to those present in freed heap chunks.

**Yahoo! response**

The Yahoo! response has been one of best I've seen. In order:

1. They have a bug bounty program, which encourages and rewards security research and fosters positive hacker relations, etc.
2. Upon receiveing a bug, they serve a 90-day response deadline *on themselves*. This is very progressive and the polar opposite of e.g. Microsoft, who occasionally like to turn reasonable disclosure deadlines into a pointless fight.
3. And indeed the bug was fixed well within 90 days.
4. The communication was excellent, even when I was sending far too many ping requests.
5. The fix was particularly thorough: **ImageMagick was retired**.
6. A robust bounty of $14,000 was issued (for this combined with a similar issue, to be documented separately). $778 per byte -- lol!
7. I'm donating this reward to charity. Upon being asked about charitable matching, **Yahoo! accepted a suggestion to match (i.e. double) the reward to $28,000**.
8. :sunglasses\_like\_a\_boss:

**Demos**

The attack vector for these demos was to attach the 18-byte exploit file (or a variant) as a Yahoo! Mail attachment, send it to myself, and then click on the image in the received mail to launch the image preview pane. The resulting JPEG image served to my browser is based on uninitialized, or previously freed, memory content.

The following three images have had entropy stripped from them via a variety of transforms. Originals have been destroyed.

In image #1, you can see the capital letter A inside a black circle. Imagine suddenly and unexpectedly seeing this in a returned image while investigating a vulnerability you expected to be boring! There are various possible reasons for the repeated nature of the recovered image -- assuming the original in-memory image does not consist of a repeated nature.

Most obviously, the in-memory image dimensions probably don't match the dimensions of our uninitialized canvas, 1024x1024 in this particular case. Depending on how the in-memory image is stored, this will lead to repetition and / or offsetting as both seen here.

Also, the in-memory image representation might not match the colorspace, colorspace channel order or alpha channel status (yes or no) of the uninitialized RLE decode canvas. The thumbnail decode and re-encode pipeline will leave all sorts of different in memory artifacts in the course of doing its job.

Don't be in any doubt though: correct reconstruction of the original image would be possible, but that's a non-goal.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh_rG4Rlp-pc4Fku5_G3wTiqs_Nx8OhApvr1JSopo9vbYPhtGTGtWIYS7KW5fEwsLkzdL6mR3845kqPbMM84AUm8GrujEM9Uj8fw2sJoOzp2lzcSVUxBiruP384vMsWEY6u5DFssQDrFtCq/s1600/yahoo_letter_a_anon.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh_rG4Rlp-pc4Fku5_G3wTiqs_Nx8OhApvr1JSopo9vbYPhtGTGtWIYS7KW5fEwsLkzdL6mR3845kqPbMM84AUm8GrujEM9Uj8fw2sJoOzp2lzcSVUxBiruP384vMsWEY6u5DFssQDrFtCq/s1600/yahoo_letter_a_anon.jpg)

In image #2, you might still be able to make out the remains of a human face. Perhaps a forehead, perhaps a nose and even a forehead and cheekbone? Or maybe not, because of the stripping of entropy and transforms applied. But you can appreciate that at the time, seeing a random face was a shock and illustrated the severity of the leak. At that point, I ceased, desisted, destroyed all files based on uninitialized memory and reported the bug.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhHsOG80UsqTTr8YNzwmuVTS-VMy5BGmdfBiFQ2FjPIBaY8Ch6RIkAteOst4skIM1Cv6mVAm5QnNtkEtJCQ1rXNtSI6ca8Sgw8bzIivaQgcWjrLtgotPh3wLr7_GOFViV9IaojmKBuHknn9/s400/yahoo_leak_512_1_anonymized.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhHsOG80UsqTTr8YNzwmuVTS-VMy5BGmdfBiFQ2FjPIBaY8Ch6RIkAteOst4skIM1Cv6mVAm5QnNtkEtJCQ1rXNtSI6ca8Sgw8bzIivaQgcWjrLtgotPh3wLr7_GOFViV9IaojmKBuHknn9/s1600/yahoo_leak_512_1_anonymized.jpg)

In image #3, the color has been left in because the image shows interesting vertical bands of magenta, cyan and yellow. What in-memory structure leads to this pattern? I have no idea. At first I was thinking some CMYK colorspace representation but I don't think that makes sense. JPEGs are typically coded in the [YCbCr colorspace](https://en.wikipedia.org/wiki/YCbCr), so perhaps a partially encoded or decoded JPEG is involved.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjQ2v7_A0QtAIa7eK_ehZQU1piKSPLQ94Pdh6zYyQDlbhsDj4RHi_vBF4r6iDzMjiyqNKZJWaOOe46KEpbCJeMz5giAUceT4035kNqkfla3qE3AcFP_W8mOmkkCfzcPB4EIGP9IpjD0bloq/s320/yahoo_leak_cmy_bands.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjQ2v7_A0QtAIa7eK_ehZQU1piKSPLQ94Pdh6zYyQDlbhsDj4RHi_vBF4r6iDzMjiyqNKZJWaOOe46KEpbCJeMz5giAUceT4035kNqkfla3qE3AcFP_W8mOmkkCfzcPB4EIGP9IpjD0bloq/s1600/yahoo_leak_cmy_bands.jpg)

**The vulnerability**

The vulnerability exists in the obscure RLE (Utah Raster Toolkit Run Length Encoded) image format, which previously featured in my [blog post noting memory corruption in box.com](https://scarybeastsecurity.blogspot.com/2017/03/black-box-discovery-of-memory.html). The new ImageMagick 0-day is in this code snippet here, from coders/rle.c:

Â  Â  pixel\_info\_length=image->columns\*image->rows\*

Â  Â  Â  MagickMax(number\_planes\_filled,4);

Â  Â  pixels=(unsigned char \*) GetVirtualMemoryBlob(pixel\_info);

Â  Â  if ((flags & 0x01) && !(flags & 0x02))

Â  Â  Â  {

[...]

Â  Â  Â  Â  /\*

Â  Â  Â  Â  Â  Set background color.

Â  Â  Â  Â  \*/

Â  Â  Â  Â  p=pixels;

Â  Â  Â  Â  for (i=0; i < (ssize\_t) number\_pixels; i++)

Â  Â  Â  Â  {

[...]

Â  Â  Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  Â  for (j=0; j < (ssize\_t) (number\_planes-1); j++)

Â  Â  Â  Â  Â  Â  Â  Â  \*p++=background\_color[j];

Â  Â  Â  Â  Â  Â  Â  \*p++=0; Â /\* initialize matte channel \*/

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }

Â  Â  Â  }

Â  Â  /\*

Â  Â  Â  Read runlength-encoded image.

Â  Â  \*/

[...]

Â  Â  do

Â  Â  {

Â  Â  Â  switch (opcode & 0x3f)

[...]

Â  Â  Â  opcode=ReadBlobByte(image);

Â  Â  } while (((opcode & 0x3f) != EOFOp) && (opcode != EOF));

It's a tricky vulnerability to spot because of the abstraction and also because this is a vulnerability caused by the absence of a necessary line of code, not the presence of a buggy line of code. The logic is approximately:

1. Allocate a suitably sized canvas for the image decode. Note that the GetVirtualMemoryBlob call does NOT guarantee zero-filled memory, as you would expect if it were backed by mmap(). It's just backed by malloc().
2. Depending on some image header flags, either initialize the canvas to a background color, or don't.
3. Iterate a loop of RLE protocol commands, which may be long or may be empty.
4. After this code snippet, the decoded canvas is handed back to the ImageMagick pipeline for whatever processing is underway.

As you can now see, the attacker could simply create an RLE image that has header flags that do not request canvas initialization, followed by an empty list of RLE protocol commands. This will result in an uninitialized canvas being used as the result of the image decode. Here's an RLE file that accomplishes just that. It's just 18 bytes!

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi-FUzHKFJc5CZYEhydRc7JBa1yVWoKhaSKAJK9Ky0LsK3O0W0W1CfEycc9BXvneY6Ti8lZJiRs8iuN8TeEywG5uiTqkms0_iDJ47NZU2DbC5G7P7EFqR6FWEEJgizjJdlakcFoexM7rM4c/s1600/rle_18_byte_file.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi-FUzHKFJc5CZYEhydRc7JBa1yVWoKhaSKAJK9Ky0LsK3O0W0W1CfEycc9BXvneY6Ti8lZJiRs8iuN8TeEywG5uiTqkms0_iDJ47NZU2DbC5G7P7EFqR6FWEEJgizjJdlakcFoexM7rM4c/s1600/rle_18_byte_file.png)

And these 18 bytes parse as follows:

52 CC: Â  Â  Â  header

00 00 00 00: top, left at 0x0.

00 04 00 04: image dimensions 1024 x 1024

02: Â  Â  Â  Â  Â flags 0x02 (no background color)

01: Â  Â  Â  Â  Â 1 plane (i.e. grayscale image)

08: Â  Â  Â  Â  Â 8 bits per sample

00 00 00: Â  Â no color maps, 0 colormap length, padding

07: Â  Â  Â  Â  Â end of image (a protocol command is consumed pre-loop)

07: Â  Â  Â  Â  Â end of image (end the decode loop for real)

There are a few bytes that are important for experimentation of exploitation: the number of planes (i.e. a choice between a greyscale vs. a color image), and the image dimensions, which determine the size of the unininitialized malloc() chunk.

**Exploitation**

Exploitation is an interesting discussion. Here are some of the factors that affect exploitation of this vulnerability, both generally and in the Yahoo! case specifically:

* Decoder lockdown. Yahoo! did not appear to implement any form of whitelisting for only sane ImageMagick decoders. RLE is not a sane decoder on the modern web. Anyone using ImageMagick really needs to lock down the decoder list to just the ones needed.

* Sandboxing. As noted above, sandboxing doesn't have much of an effect on this vulnerability type. Although it doesn't make much difference, my best guess is that the server in question might be using Perl and PerlMagick, as well as handling various network traffic, suggesting that a tight sandbox policy is difficult without extensive refactoring.

* Process isolation. This is critical. \*bleed bugs for most usages of ImageMagick are mostly harmless because it's typical to kick off e.g. a thumbnail request by launching the ImageMagick convert binary, once per thumbnail request. This means that the process memory space of the exploited process is only likely to contain the attacker's image data, making exploitation much less interesting (but not irrelevant as we saw in my recent Box and DropBox blog posts).
  The Yahoo! Mail process which is handling thumbnailing has an unusual property, though: **it appears to be long lived and to process images from a variety of different users**. Suddenly, a memory content leak is a very serious vulnerability.

* Heap implementation. The heap implementation used is significant. For the input RLE file decomposed above, the canvas allocation is 1024 x 1024 x 4, or 4MB. This is large allocation and for example, the default malloc() tuning on Linux x86\_64 leads to such a large allocation being satisfied by mmap(), which zero-fills memory and will not lead to interesting memory content leakage! However, we definitely see leaked heap content with such a large allocation in the Yahoo! context, so a non-default heap setup is clearly in use. With our ability to leak heap content, we could likely fingerprint the exact heap implementation if we cared to do so. Who knows, maybe we'd find tcmalloc or jemalloc, both popular allocators with large service providers.

* Thumbnail dimensions. It's worth a brief note on thumbnail dimensions. If we're in a situation where our uninitialized canvas gets resized down to a smaller thumbnail, this would compress out detail from the original leaked memory content. This would spoil certain exploitation attempts. However, Yahoo! Mail's preview panel seems to display very large images (tested to 2048x2048) verbatim, so no worries here.

* Thumbnail compression. This one is interesting. Yahoo! Mail returns thumbnails and image previews as JPEG images. As we know, JPEG compression is lossy. This is not a particular issue if we're only interested in pulling image data out of Yahoo! servers. But if we're interested in looking at raw bytes of Yahoo! server memory, then lossy compression is losing us data.
  As an example of this, I tried to extract concrete pointer values from memory dumps -- perhaps we want to remotely defeat ASLR? I used greyscale images because JPEG compresses color data more than it compresses intensity data. But still, with a 16-byte sized data exfiltration I see pointer values such as 0x020081c5b0be476f and 0x00027c661ac2722a. Hmm. You can see that these may be trying to be Linux x86\_64 user space pointers (0x00007f....) but there's a lot of information loss there.
  I think it would be possible to overcome this exfiltration problem. Most likely, there's some thumbnailing endpoint that returns (or can be asked to return with some URL parameter) lossless PNG images, which would do the trick. Or for the brave, mathematical modelling of JPEG compression??

**Conclusions**

Broadly: in a world of decreasing memory corruption and increasing sandboxing, \*bleed bugs provide a compelling option for easily stealing information from servers.

On design: taking a long running process and linking in ImageMagick as a library has to be a discouraged design choice, as it takes bugs that might not be very serious and makes them very serious indeed. Limiting ImageMagick decoders to a minimal required set is a must for any processing of untrusted input.

GraphicsMagick vs. ImageMagick, again. Well, well, look at this :) GraphicsMagick fixed this issue in March 2016, for the v1.3.24 release, tucked away [in a changeset](http://hg.code.sf.net/p/graphicsmagick/code/diff/0a5b75e019b6/coders/rle.c) titled "Fix SourceForge bug #371 "out-of-bounds read in coders/rle.c:633:39" (see the second memset()). This is another case where tons of vulnerabilities are being found and fixed in both GraphicsMagick and ImageMagick with little co-ordination. This seems like a waste of effort and a risk of 0-day (or is it 1-day?) exposure. It goes both ways: the RLE memory corruption I referenced in my previous blog post was only [fixed in GraphicsMagick in March 2016](http://hg.code.sf.net/p/graphicsmagick/code/diff/c6a6ea253a35/coders/rle.c), having been previously [fixed in ImageMagick in Dec 2014](http://git.imagemagick.org/repos/ImageMagick/commit/7131d8ff451a1d5163e7e35b7a910df80cb54fab).

Linux distributions. This vulnerability is now 1-day in the sense that it is broadly unpatched by entities that repackage upstream ImageMagick, such as Linux distributions. (As a side note, it's worth noting that the RLE decoder in Ubuntu 16.04 LTS is totally borked due to a bogus check that can be seen [getting removed here](https://github.com/ImageMagick/ImageMagick/commit/f739cf56af7383b13d8e7b39961c27948fa14876#diff-04a2246f61d47b9ede94e0648dac2f44).)

But most significantly for this conclusion, I wanted to highlight some questions about ecosystem responsibility.

Researcher responsibility: what is a researcher's responsibility and where does it end? As a researcher who becomes aware of a software risk, I believe I have a responsibility to let the "owner" of that software immediately know about the issue and the fact that I think it's a security risk. Let's assume that the owner makes a fix in a reasonable time. Are we good now? Well, what about all the downstream usages (eventually cascading to end users) that don't yet have the fix? So is it my responsibility to go and find and harangue every cloud provider that is affected? No, probably not. We might let one or two providers with bounty programs know as a positive feedback for encouraging security research, but the broader problem remains.

Upstream vendor responsibility: how should the upstream vendor respond to a security report other than identifying it (if not already clearly flagged) and fixing it promptly? Personally, I think there should be some form of notification in a well defined place (mailing list; web site announcement area; etc.) and the upstream vendor could also take the burden of getting the CVE.

Consumer responsibility: what should consumers such as Yahoo!, Box, DropBox, Ubuntu, etc. do? Well, if the upstream vendor is doing a good job, the consumer security teams can all be subscribed to the same authoritative source and take action whenever a new announcement is made. (Probably less trivial than it sounds; both Box and Yahoo! appear to have been running old versions of ImageMagick with known vulnerabilities.)

Posted by

[Chris Evans](https://www.blogger.com/profile/01004765479735675808 "author profile")

at

[9:28â€¯PM](https://scarybeastsecurity.blogspot.com/2017/05/bleed-continues-18-byte-file-14k-bounty.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=3024470480937744884&postID=644508072740850512&from=pencil "Edit Post")

#### 2 comments:

[![](//www.blogger.com/img/blogger_logo_round_35.png "Unknown")](https://www.blogger.com/profile/15980298322083228076)
[Unknown](https://www.blogger.com/profile/15980298322083228076)
said...

When it comes to the upstream vendor / consumer responsibility then I think there should be a standardized protocol between the two. Maybe something like a standardized security RSS feed that upstream vendors provide for their products and consumers subscribe to.

On the consumer side the security reports from the feed should be automatically processed and the interested parties be notified with automatic escalation in case a security report isn't reacted to within a certain time.

This security report information could be handed even further down in case of Linux distributions as they could automatically include this information in their packages and then for an instance trigger security notices or reboot notifications with added security context.

[May 19, 2017 at 12:15â€¯PM](https://scarybeastsecurity.blogspot.com/2017/05/bleed-continues-18-byte-file-14k-bounty.html?showComment=1495221305656#c884998802527275648 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=884998802527275648 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "Stephan")](https://www.blogger.com/profile/12018589324568930732)
[Stephan](https://www.blogger.com/profile/12018589324568930732)
said...

Bugs like this are to be expected from a decoder library, it is no coincidence that most critical Android and iOS/iTunes bugs are about media codecs as well.

As you describes, the whole design without an isolated converter process for each image is the problem here. In addition, the "convert" process could be further restricted with some AppArmor rules to prevent any serious damage from a potential remote-code execution.

[May 23, 2017 at 3:52â€¯AM](https://scarybeastsecurity.blogspot.com/2017/05/bleed-continues-18-byte-file-14k-bounty.html?showComment=1495536721418#c127420414496164040 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3024470480937744884&postID=127420414496164040 "Delete Comment")

[Post a Comment](https://www.blogger.com/comment/fullpage/post/3024470480937744884/644508072740850512)

[Newer Post](https://scarybeastsecurity.blogspot.com/2017/05/bleed-more-powerful-dumping-yahoo.html "Newer Post")

[Older Post](https://scarybeastsecurity.blogspot.com/2017/05/further-hardening-glibc-malloc-against.html "Older Post")

[Home](https://scarybeastsecurity.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://scarybeastsecurity.blogspot.com/feeds/644508072740850512/comments/default)

Subscribe to my Twitter feed: [@scarybeasts](https://twitter.com/scarybeasts).

## Subscribe To ScarybeastSecurity

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://scarybeastsecurity.blogspot.com/feeds/posts/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2F644508072740850512%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fscarybeastsecurity.blogspot.com%2Ffeeds%2F644508072740850512%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://scarybeastsecurity.blogspot.com/feeds/644508072740850512/comments/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

## Blog Archive

* â–º
  [2021](https://scarybeastsecurity.blogspot.com/2021/)
  (1)
  + â–º
    [May](https://scarybeastsecurity.blogspot.com/2021/05/)
    (1)

* â–º
  [2020](https://scarybeastsecurity.blogspot.com/2020/)
  (7)
  + â–º
    [December](https://scarybeastsecurity.blogspot.com/2020/12/)
    (1)
  + â–º
    [November](https://scarybeastsecurity.blogspot.com/2020/11/)
    (1)
  + â–º
    [July](https://scarybeastsecurity.blogspot.com/2020/07/)
    (1)
  + â–º
    [June](https://scarybeastsecurity.blogspot.com/2020/06/)
    (3)
  + â–º
    [April](https://scarybeastsecurity.blogspot.com/2020/04/)
    (1)

* â–¼
  [2017](https://scarybeastsecurity.blogspot.com/2017/)
  (10)
  + â–º
    [September](https://scarybeastsecurity.blogspot.com/2017/09/)
    (1)
  + â–º
    [June](https://scarybeastsecurity.blogspot.com/2017/06/)
    (1)
  + â–¼
    [May](https://scarybeastsecurity.blogspot.com/2017/05/)
    (7)
    - [\*bleed, more powerful: dumping Yahoo! authenticati...](https://scarybeastsecurity.blogspot.com/2017/05/bleed-more-powerful-dumping-yahoo.html)
    - [\*bleed continues: 18 byte file, $14k bounty, for l...](https://scarybeastsecurity.blogspot.com/2017/05/bleed-continues-18-byte-file-14k-bounty.html)
    - [Further hardening glibc malloc() against single by...](https://scarybeastsecurity.blogspot.com/2017/05/further-hardening-glibc-malloc-against.html)
    - [Are we doing memory corruption mitigations wrong?](https://scarybeastsecurity.blogspot.com/2017/05/are-we-doing-memory-corruption.html)
    - [[0day] Proving Box.com fixed ASLR via ImageMagick ...](https://scarybeastsecurity.blogspot.com/2017/05/0day-proving-boxcom-fixed-aslr-via.html)
    - [Proving missing ASLR on dropbox.com and box.com ov...](https://scarybeastsecurity.blogspot.com/2017/05/proving-missing-aslr-on-dropboxcom-and.html)
    - [Ode to the use-after-free: one vulnerable function...](https://scarybeastsecurity.blogspot.com/2017/05/ode-to-use-after-free-one-vulnerable.html)
  + â–º
    [March](https://scarybeastsecurity.blogspot.com/2017/03/)
    (1)

* â–º
  [2016](https://scarybeastsecurity.blogspot.com/2016/)
  (7)
  + â–º
    [December](https://scarybeastsecurity.blogspot.com/2016/12/)
    (3)
  + â–º
    [November](https://scarybeastsecurity.blogspot.com/2016/11/)
    (4)

* â–º
  [2015](https://scarybeastsecurity.blogspot.com/2015/)
  (1)
  + â–º
    [July](https://scarybeastsecurity.blogspot.com/2015/07/)
    (1)

* â–º
  [2014](https://scarybeastsecurity.blogspot.com/2014/)
  (5)
  + â–º
    [September](https://scarybeastsecurity.blogspot.com/2014/09/)
    (2)
  + â–º
    [June](https://scarybeastsecurity.blogspot.com/2014/06/)
    (1)
  + â–º
    [March](https://scarybeastsecurity.blogspot.com/2014/03/)
    (1)
  + â–º
    [February](https://scarybeastsecurity.blogspot.com/2014/02/)
    (1)

* â–º
  [2013](https://scarybeastsecurity.blogspot.com/2013/)
  (2)
  + â–º
    [December](https://scarybeastsecurity.blogspot.com/2013/12/)
    (1)
  + â–º
    [February](https://scarybeastsecurity.blogspot.com/2013/02/)
    (1)

* â–º
  [2012](https://scarybeastsecurity.blogspot.com/2012/)
  (9)
  + â–º
    [September](https://scarybeastsecurity.blogspot.com/2012/09/)
    (1)
  + â–º
    [July](https://scarybeastsecurity.blogspot.com/2012/07/)
    (1)
  + â–º
    [April](https://scarybeastsecurity.blogspot.com/2012/04/)
    (2)
  + â–º
    [March](https://scarybeastsecurity.blogspot.com/2012/03/)
    (3)
  + â–º
    [February](https://scarybeastsecurity.blogspot.com/2012/02/)
    (1)
  + â–º
    [January](https://scarybeastsecurity.blogspot.com/2012/01/)
    (1)

* â–º
  [2011](https://scarybeastsecurity.blogspot.com/2011/)
  (10)
  + â–º
    [July](https://scarybeastsecurity.blogspot.com/2011/07/)
    (1)
  + â–º
    [May](https://scarybeastsecurity.blogspot.com/2011/05/)
    (2)
  + â–º
    [April](https://scarybeastsecurity.blogspot.com/2011/04/)
    (1)
  + â–º
    [March](https://scarybeastsecurity.blogspot.com/2011/03/)
    (3)
  + â–º
    [February](https://scarybeastsecurity.blogspot.com/2011/02/)
    (2)
  + â–º
    [January](https://scarybeastsecurity.blogspot.com/2011/01/)
    (1)

* â–º
  [2010](https://scarybeastsecurity.blogspot.com/2010/)
  (11)
  + â–º
    [October](https://scarybeastsecurity.blogspot.com/2010/10/)
    (1)
  + â–º
    [September](https://scarybeastsecurity.blogspot.com/2010/09/)
    (1)
  + â–º
    [August](https://scarybeastsecurity.blogspot.com/2010/08/)
    (1)
  + â–º
    [July](https://scarybeastsecurity.blogspot.com/2010/07/)
    (3)
  + â–º
    [June](https://scarybeastsecurity.blogspot.com/2010/06/)
    (1)
  + â–º
    [March](https://scarybeastsecurity.blogspot.com/2010/03/)
    (1)
  + â–º
    [January](https://scarybeastsecurity.blogspot.com/2010/01/)
    (3)

* â–º
  [2009](https://scarybeastsecurity.blogspot.com/2009/)
  (29)
  + â–º
    [December](https://scarybeastsecurity.blogspot.com/2009/12/)
    (3)
  + â–º
    [November](https://scarybeastsecurity.blogspot.com/2009/11/)
    (2)
  + â–º
    [October](https://scarybeastsecurity.blogspot.com/2009/10/)
    (3)
  + â–º
    [September](https://scarybeastsecurity.blogspot.com/2009/09/)
    (1)
  + â–º
    [August](https://scarybeastsecurity.blogspot.com/2009/08/)
    (2)
  + â–º
    [July](https://scarybeastsecurity.blogspot.com/2009/07/)
    (3)
  + â–º
    [June](https://scarybeastsecurity.blogspot.com/2009/06/)
    (4)
  + â–º
    [May](https://scarybeastsecurity.blogspot.com/2009/05/)
    (3)
  + â–º
    [March](https://scarybeastsecurity.blogspot.com/2009/03/)
    (3)
  + â–º
    [February](https://scarybeastsecurity.blogspot.com/2009/02/)
    (4)
  + â–º
    [January](https://scarybeastsecurity.blogspot.com/2009/01/)
    (1)

* â–º
  [2008](https://scarybeastsecurity.blogspot.com/2008/)
  (20)
  + â–º
    [December](https://scarybeastsecurity.blogspot.com/2008/12/)
    (2)
  + â–º
    [November](https://scarybeastsecurity.blogspot.com/2008/11/)
    (5)
  + â–º
    [October](https://scarybeastsecurity.blogspot.com/2008/10/)
    (1)
  + â–º
    [August](https://scarybeastsecurity.blogspot.com/2008/08/)
    (3)
  + â–º
    [July](https://scarybeastsecurity.blogspot.com/2008/07/)
    (5)
  + â–º
    [March](https://scarybeastsecurity.blogspot.com/2008/03/)
    (1)
  + â–º
    [February](https://scarybeastsecurity.blogspot.com/2008/02/)
    (3)

## My other stuff

* [My security advisories](http://scary.beasts.org/)
* [vsftpd home page](http://vsftpd.beasts.org/)
* [Tavis' security advisories](http://taviso.decsystem.org/research.html)

|  |  |
| --- | --- |

Simple theme. Theme images by [gaffera](https://www.istockphoto.com/googleimages.php?id=4072573&platform=blogger&langregion=en). Powered by [Blogger](https://www.blogger.com).



=== Content from lists.debian.org_cdcf173e_20250125_200245.html ===


---

[[Date Prev](msg00001.html)][[Date Next](msg00003.html)]
[[Thread Prev](msg00001.html)][[Thread Next](msg00003.html)]
[[Date Index](maillist.html#00002)]
[[Thread Index](threads.html#00002)]

# [SECURITY] [DLA 1456-1] graphicsmagick security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1456-1] graphicsmagick security update
* *From*: Roberto C. SÃ¡nchez <roberto@debian.org>
* *Date*: Thu, 2 Aug 2018 21:07:24 -0400
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20180803010724.s77jbrtt77mz7gie%40connexer.com)Â [20180803010724.s77jbrtt77mz7gie@connexer.com](msg00002.html)>
* *Mail-followup-to*: Roberto C. SÃ¡nchez <roberto@debian.org>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : graphicsmagick
Version        : 1.3.20-3+deb8u4
CVE ID         : CVE-2016-5239 CVE-2017-6335 CVE-2017-9098 CVE-2017-11102
                 CVE-2017-11140 CVE-2017-11403 CVE-2017-11637 CVE-2017-11638
                 CVE-2017-11641 CVE-2017-11642 CVE-2017-12935 CVE-2017-12936
                 CVE-2017-13737 CVE-2017-13775 CVE-2017-13776 CVE-2017-13777
                 CVE-2017-14504 CVE-2017-14994 CVE-2017-14997 CVE-2017-15277
                 CVE-2017-15930 CVE-2017-16352 CVE-2017-16545 CVE-2017-16547
                 CVE-2017-18219 CVE-2017-18220 CVE-2017-18229 CVE-2017-18230
                 CVE-2017-18231 CVE-2018-5685 CVE-2018-6799 CVE-2018-9018
Debian Bug     : 867746 870153 870154 870156 870155 872576 872575 878511
                 878578 862967 879999

Various vulnerabilities were discovered in graphicsmagick, a collection
of image processing tools and associated libraries, resulting in denial
of service, information disclosure, and a variety of buffer overflows
and overreads.

For Debian 8 "Jessie", these problems have been fixed in version
1.3.20-3+deb8u4.

We recommend that you upgrade your graphicsmagick packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpjfRSsBCqS7.pgp)**

*Description:* PGP signature

---



=== Content from hg.code.sf.net_692772f4_20250125_200242.html ===

[Mercurial](https://www.mercurial-scm.org/ "Mercurial")
[Mercurial](/) > [p](/p) > [graphicsmagick](/p/graphicsmagick) > [code](/p/graphicsmagick/code) / diff

[summary](/p/graphicsmagick/code/summary) |
[shortlog](/p/graphicsmagick/code/shortlog) |
[changelog](/p/graphicsmagick/code/log) |
[graph](/p/graphicsmagick/code/graph) |
[tags](/p/graphicsmagick/code/tags) |
[bookmarks](/p/graphicsmagick/code/bookmarks) |
[branches](/p/graphicsmagick/code/branches) |
[files](/p/graphicsmagick/code/file/0a5b75e019b6) |
[changeset](/p/graphicsmagick/code/rev/0a5b75e019b6) |
[file](/p/graphicsmagick/code/file/0a5b75e019b6/coders/rle.c) |
[latest](/p/graphicsmagick/code/file/tip/coders/rle.c) |
[revisions](/p/graphicsmagick/code/log/0a5b75e019b6/coders/rle.c) |
[annotate](/p/graphicsmagick/code/annotate/0a5b75e019b6/coders/rle.c) |
diff |
[comparison](/p/graphicsmagick/code/comparison/0a5b75e019b6/coders/rle.c) |
[raw](/p/graphicsmagick/code/raw-diff/0a5b75e019b6/coders/rle.c) |
[help](/p/graphicsmagick/code/help)

Find changesets by keywords (author, files, the commit message), revision
number or hash, or [revset expression](/p/graphicsmagick/code/help/revsets).

coders/rle.c

| changeset 14750 | [0a5b75e019b6](/p/graphicsmagick/code/rev/0a5b75e019b6) |
| --- | --- |
| parent 14729 | [c6a6ea253a35](/p/graphicsmagick/code/diff/c6a6ea253a35/coders/rle.c) |
| child 14856 | [8711e07cdebe](/p/graphicsmagick/code/diff/8711e07cdebe/coders/rle.c) |
| child 14895 | [30043afadb10](/p/graphicsmagick/code/diff/30043afadb10/coders/rle.c) |

```

--- a/coders/rle.c	Fri Mar 25 18:25:51 2016 -0500
+++ b/coders/rle.c	Sat Mar 26 14:39:41 2016 -0500
@@ -1,5 +1,5 @@
 /*
-% Copyright (C) 2003-2015 GraphicsMagick Group
+% Copyright (C) 2003-2016 GraphicsMagick Group
 % Copyright (C) 2002 ImageMagick Studio
 % Copyright 1991-1999 E. I. du Pont de Nemours and Company
 %
@@ -308,8 +308,9 @@
     image->matte=rle_header.Flags & 0x04;
     number_planes=rle_header.Ncolors;
     number_colormaps=rle_header.Ncmap;
-    map_length=(1 << rle_header.Cmaplen);
+    map_length=(1U << rle_header.Cmaplen);

+    (void) memset(background_color,0,sizeof(background_color));
     if (rle_header.Flags & 0x02)
       {
         /*
@@ -339,17 +340,18 @@
     if (number_colormaps != 0)
       {
         /*
-          Read image colormaps.
+          Read image colormaps.  Color map values are stored as 16 bit
+          quantities, left justified in the word.
         */
         colormap=MagickAllocateArray(unsigned char *,number_colormaps,
                                      map_length);
         if (colormap == (unsigned char *) NULL)
           ThrowRLEReaderException(ResourceLimitError,MemoryAllocationFailed,
             image);
-        p=colormap;
+        p=colormap; /* unsigned char * */
         for (i=0; i < number_colormaps; i++)
           for (x=0; x < map_length; x++)
-            *p++=ScaleShortToQuantum(ReadBlobLSBShort(image));
+            *p++=(ReadBlobLSBShort(image) >> 8);
         colormap_entries=number_colormaps*map_length;
       }
     if (rle_header.Flags & 0x08)
@@ -399,7 +401,8 @@
                                    Max(number_planes,4));
     if (rle_pixels == (unsigned char *) NULL)
       ThrowRLEReaderException(ResourceLimitError,MemoryAllocationFailed,image);
-    rle_bytes=number_pixels*Max(number_planes,4);
+    rle_bytes=MagickArraySize(number_pixels,Max(number_planes,4));
+    (void) memset(rle_pixels,0,rle_bytes);
     if ((rle_header.Flags & 0x01) && !(rle_header.Flags & 0x02))
       {
         int
@@ -630,7 +633,10 @@
             {
               image->colormap[i].red=ScaleCharToQuantum(*p);
               image->colormap[i].green=ScaleCharToQuantum(*(p+map_length));
-              image->colormap[i].blue=ScaleCharToQuantum(*(p+map_length*2));
+              if (number_colormaps > 2)
+                image->colormap[i].blue=ScaleCharToQuantum(*(p+map_length*2));
+              else
+                image->colormap[i].blue=0U;
               p++;
             }
         p=rle_pixels;
```

Mercurial Repository: p/graphicsmagick/code
[RSS](/p/graphicsmagick/code/rss-log)
[Atom](/p/graphicsmagick/code/atom-log)



=== Content from www.debian.org_76e2fd9d_20250125_200244.html ===


---

[[Date Prev](msg00122.html)][[Date Next](msg00124.html)]
[[Thread Prev](msg00122.html)][[Thread Next](msg00124.html)]
[[Date Index](maillist.html#00123)]
[[Thread Index](threads.html#00123)]

# [SECURITY] [DSA 3863-1] imagemagick security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3863-1] imagemagick security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 25 May 2017 23:32:26 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20170525213226.o2ygdrxjrb6hz6rh%40pisco.westfalen.local)Â [20170525213226.o2ygdrxjrb6hz6rh@pisco.westfalen.local](msg00123.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3863-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
May 25, 2017                          <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : imagemagick
CVE ID         : CVE-2017-7606 CVE-2017-7619 CVE-2017-7941 CVE-2017-7943
                 CVE-2017-8343 CVE-2017-8344 CVE-2017-8345 CVE-2017-8346
                 CVE-2017-8347 CVE-2017-8348 CVE-2017-8349 CVE-2017-8350
                 CVE-2017-8351 CVE-2017-8352 CVE-2017-8353 CVE-2017-8354
                 CVE-2017-8355 CVE-2017-8356 CVE-2017-8357 CVE-2017-8765
                 CVE-2017-8830 CVE-2017-9098 CVE-2017-9141 CVE-2017-9142
                 CVE-2017-9143 CVE-2017-9144
Debian Bug     : 860736 862577 859771 859769 860734 862572 862574 862573
                 862575 862590 862589 862587 862632 862633 862634 862635
		 862636 862578 860735 862653 862637 863126 863125 863124
		 863123 862967

This update fixes several vulnerabilities in imagemagick: Various memory
handling problems and cases of missing or incomplete input sanitising
may result in denial of service, memory disclosure or the execution of
arbitrary code if malformed RLE, ART, JNG, DDS, BMP, ICO, EPT, SUN, MTV,
PICT, XWD, PCD, SFW, MAT, EXR, DCM, MNG, PCX or SVG files are processed.

For the stable distribution (jessie), these problems have been fixed in
version 8:6.8.9.9-5+deb8u9.

For the upcoming stable distribution (stretch), these problems have been
fixed in version 8:6.9.7.4+dfsg-8.

For the unstable distribution (sid), these problems have been fixed in
version 8:6.9.7.4+dfsg-8.

We recommend that you upgrade your imagemagick packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlknTOwACgkQEMKTtsN8
TjY8fA//eEHR27fgX5IZX9J/DLvuHGEis3RsA+8UGZkfIAtk+LqPm4eyX+Vor/uT
LRiIcWW96bE2LmxB91MmvVEPIQIFeNdONTTN8NeUclDcgr3xkpLVEb1FDqvD4VMf
7/O3B9muzarv2pow3GB+KDCFEl+LrXKDwEX8HMPrIT+QOX3Xb4+YuGj3wKaAJydT
/Yo/L80coFkD+Q15phNqJLFSy1zqoPEDUVV+cH10AI3by4jXSE4g0mKBFu6Nc/C2
vhfgNyjb3p8FtGUqO9tGF4Anf697UnIH7FoLxaHiPzpE/sfw9UZrpFqXq+cVOsGP
r2dcA+apUG2gptJA0CG6rFmQDeRkqrUH5CZtUz8U7I9c7K8P+mWU0dLbKLT3c0wV
aAd/jfcSpP/p8vZxmydoSWVjFmBSKJJTGRo9ElvJEeEGXEVVl2aY+ktBmxm1GY6n
1EJNYJpctKuDfhBSbvQW7NUhIYcjbGRc0GGo/WJNKHAGiTvYAMVL+NFGi2Uf0YIH
6QrUrziJeC8dTZnQouhkYf/epnvvqwVl32tuUIALtWtFP9L3x44fGsK/S8Tm5Ogg
1c09lDGb294yfJOQuNxsyjIfJ2OU1n35Hl+yCS0OnsNR5GbHsJ5FU2rJCVY2nwSr
KjTksUSVx1KkzhGgfWAQwHYvtbz90eOxP58SCc04T6IxinND+Sc=
=jiTH
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_cad5aac1_20250125_200245.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fcommit%2F1c358ffe0049f768dd49a8a889c1cbf99ac9849b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fcommit%2F1c358ffe0049f768dd49a8a889c1cbf99ac9849b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ImageMagick%2FImageMagick)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ImageMagick](/ImageMagick)
/
**[ImageMagick](/ImageMagick/ImageMagick)**
Public

* [Notifications](/login?return_to=%2FImageMagick%2FImageMagick) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FImageMagick%2FImageMagick)
* [Star
   12.7k](/login?return_to=%2FImageMagick%2FImageMagick)

* [Code](/ImageMagick/ImageMagick)
* [Issues
  123](/ImageMagick/ImageMagick/issues)
* [Pull requests
  4](/ImageMagick/ImageMagick/pulls)
* [Discussions](/ImageMagick/ImageMagick/discussions)
* [Actions](/ImageMagick/ImageMagick/actions)
* [Security](/ImageMagick/ImageMagick/security)
* [Insights](/ImageMagick/ImageMagick/pulse)

Additional navigation options

* [Code](/ImageMagick/ImageMagick)
* [Issues](/ImageMagick/ImageMagick/issues)
* [Pull requests](/ImageMagick/ImageMagick/pulls)
* [Discussions](/ImageMagick/ImageMagick/discussions)
* [Actions](/ImageMagick/ImageMagick/actions)
* [Security](/ImageMagick/ImageMagick/security)
* [Insights](/ImageMagick/ImageMagick/pulse)

## Commit

[Permalink](/ImageMagick/ImageMagick/commit/1c358ffe0049f768dd49a8a889c1cbf99ac9849b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Reset memory for RLE decoder (patch provided by scarybeasts)

[Browse files](/ImageMagick/ImageMagick/tree/1c358ffe0049f768dd49a8a889c1cbf99ac9849b)
Browse the repository at this point in the history

* Loading branch information

Cristy
committed
Mar 9, 2017

1 parent
[0375c73](/ImageMagick/ImageMagick/commit/0375c7318734648d93c3002e4e49954adc634f2b)

commit 1c358ff

Showing
**1 changed file**
with
**1 addition**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[coders/rle.c](#diff-395299918ba7896ec735e4fbe84356f7b7393715e4bfd07109bfd7959c4ae270 "coders/rle.c")

Show comments

[View file](/ImageMagick/ImageMagick/blob/1c358ffe0049f768dd49a8a889c1cbf99ac9849b/coders/rle.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -328,6 +328,7 @@ static Image \*ReadRLEImage(const ImageInfo \*image\_info,ExceptionInfo \*exception) |
|  |  | pixel\_info\_length=image->columns\*image->rows\* |
|  |  | MagickMax(number\_planes\_filled,4); |
|  |  | pixels=(unsigned char \*) GetVirtualMemoryBlob(pixel\_info); |
|  |  | (void) ResetMagickMemory(pixels,0,pixel\_info\_length); |
|  |  | if ((flags & 0x01) && !(flags & 0x02)) |
|  |  | { |
|  |  | ssize\_t |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1c358ff`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fcommit%2F1c358ffe0049f768dd49a8a889c1cbf99ac9849b) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


