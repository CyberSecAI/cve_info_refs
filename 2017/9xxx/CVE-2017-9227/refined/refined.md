```
{
  "vulnerability_details": {
    "root_cause": "A heap out-of-bounds write occurs in `bitset_set_range()` during regular expression compilation due to an uninitialized variable from an incorrect state transition in `parse_char_class()`. This causes a critical local variable to remain uninitialized until it's used as an index, resulting in an out-of-bounds write memory corruption.",
    "weaknesses": [
      "Out-of-bounds heap write",
      "Use of uninitialized variable",
      "Incorrect state transition during parsing"
    ],
    "impact": "Heap out-of-bounds write leading to potential memory corruption. The attacker has limited control, potentially setting up to 8 bits in a range determined by uninitialized (stack) data.",
    "attack_vectors": "Crafted regular expressions can trigger the vulnerable code path in `parse_char_class()` and `bitset_set_range()` during compilation.",
    "required_capabilities": "An attacker needs to provide a specific regular expression pattern that causes the parser to transition to an incorrect state and leave a critical variable uninitialized."
  },
  "affected_products": [
    "Oniguruma 6.2.0",
      "Oniguruma-mod in Ruby through 2.4.1",
      "mbstring in PHP through 7.1.5"
  ],
  "references": [
    "https://github.com/kkos/oniguruma/issues/60",
     "https://github.com/kkos/oniguruma/commit/3b63d12038c8d8fc278e81c942fa9bec7c704c8b",
     "https://github.com/kkos/oniguruma/commit/ddbf55698b5f7ffdfa737b0b8e0079af1fdd7cb1"
  ]
}
```