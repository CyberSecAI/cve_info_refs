=== Content from github.com_735ddf68_20250124_131750.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F07678eca2cf9c9a18584e546c2b2a0d0c9a3150c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F07678eca2cf9c9a18584e546c2b2a0d0c9a3150c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=torvalds%2Flinux)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[torvalds](/torvalds)
/
**[linux](/torvalds/linux)**
Public

* [Notifications](/login?return_to=%2Ftorvalds%2Flinux) You must be signed in to change notification settings
* [Fork
  54.9k](/login?return_to=%2Ftorvalds%2Flinux)
* [Star
   186k](/login?return_to=%2Ftorvalds%2Flinux)

* [Code](/torvalds/linux)
* [Pull requests
  437](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects
  0](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

Additional navigation options

* [Code](/torvalds/linux)
* [Pull requests](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

## Commit

[Permalink](/torvalds/linux/commit/07678eca2cf9c9a18584e546c2b2a0d0c9a3150c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

drm/vmwgfx: Make sure backup\_handle is always valid

[Browse files](/torvalds/linux/tree/07678eca2cf9c9a18584e546c2b2a0d0c9a3150c)
Browse the repository at this point in the history

```
When vmw_gb_surface_define_ioctl() is called with an existing buffer,
we end up returning an uninitialized variable in the backup_handle.

The fix is to first initialize backup_handle to 0 just to be sure, and
second, when a user-provided buffer is found, we will use the
req->buffer_handle as the backup_handle.

Cc: <stable@vger.kernel.org>
Reported-by: Murray McAllister <murray.mcallister@insomniasec.com>
Signed-off-by: Sinclair Yeh <syeh@vmware.com>
Reviewed-by: Deepak Rawat <drawat@vmware.com>
```

* Loading branch information

[![@thomashvmw](https://avatars.githubusercontent.com/u/17000746?s=40&v=4)](/thomashvmw)

Sinclair Yeh
authored and
[thomashvmw](/torvalds/linux/commits?author=thomashvmw "View all commits by thomashvmw")
committed
Jun 7, 2017

1 parent
[f0c62e9](/torvalds/linux/commit/f0c62e9878024300319ba2438adc7b06c6b9c448)

commit 07678ec

Showing
**1 changed file**
with
**11 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

18 changes: 11 additions & 7 deletions

18
[drivers/gpu/drm/vmwgfx/vmwgfx\_surface.c](#diff-c7c02f5e1ce198585178d221820691370a61e0bec6273cb5bc1e809e3acaf9f6 "drivers/gpu/drm/vmwgfx/vmwgfx_surface.c")

Show comments

[View file](/torvalds/linux/blob/07678eca2cf9c9a18584e546c2b2a0d0c9a3150c/drivers/gpu/drm/vmwgfx/vmwgfx_surface.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1274,7 +1274,7 @@ int vmw\_gb\_surface\_define\_ioctl(struct drm\_device \*dev, void \*data, |
|  |  | struct ttm\_object\_file \*tfile = vmw\_fpriv(file\_priv)->tfile; |
|  |  | int ret; |
|  |  | uint32\_t size; |
|  |  | uint32\_t backup\_handle; |
|  |  | uint32\_t backup\_handle = 0; |
|  |  |  |
|  |  | if (req->multisample\_count != 0) |
|  |  | return -EINVAL; |
| Expand Down  Expand Up | | @@ -1317,12 +1317,16 @@ int vmw\_gb\_surface\_define\_ioctl(struct drm\_device \*dev, void \*data, |
|  |  | ret = vmw\_user\_dmabuf\_lookup(tfile, req->buffer\_handle, |
|  |  | &res->backup, |
|  |  | &user\_srf->backup\_base); |
|  |  | if (ret == 0 && res->backup->base.num\_pages \* PAGE\_SIZE < |
|  |  | res->backup\_size) { |
|  |  | DRM\_ERROR("Surface backup buffer is too small.\n"); |
|  |  | vmw\_dmabuf\_unreference(&res->backup); |
|  |  | ret = -EINVAL; |
|  |  | goto out\_unlock; |
|  |  | if (ret == 0) { |
|  |  | if (res->backup->base.num\_pages \* PAGE\_SIZE < |
|  |  | res->backup\_size) { |
|  |  | DRM\_ERROR("Surface backup buffer is too small.\n"); |
|  |  | vmw\_dmabuf\_unreference(&res->backup); |
|  |  | ret = -EINVAL; |
|  |  | goto out\_unlock; |
|  |  | } else { |
|  |  | backup\_handle = req->buffer\_handle; |
|  |  | } |
|  |  | } |
|  |  | } else if (req->drm\_surface\_flags & drm\_vmw\_surface\_flag\_create\_buffer) |
|  |  | ret = vmw\_user\_dmabuf\_alloc(dev\_priv, tfile, |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `07678ec`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F07678eca2cf9c9a18584e546c2b2a0d0c9a3150c) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from www.debian.org_8df7d79c_20250124_131749.html ===


---

[[Date Prev](msg00206.html)][[Date Next](msg00208.html)]
[[Thread Prev](msg00206.html)][[Thread Next](msg00208.html)]
[[Date Index](maillist.html#00207)]
[[Thread Index](threads.html#00207)]

# [SECURITY] [DSA 3945-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3945-1] linux security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Thu, 17 Aug 2017 18:40:05 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1diPi9-0005PI-4M%40master.debian.org)Â [E1diPi9-0005PI-4M@master.debian.org](msg00207.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3945-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
August 17, 2017                       <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2014-9940 CVE-2017-7346 CVE-2017-7482 CVE-2017-7533
                 CVE-2017-7541 CVE-2017-7542 CVE-2017-7889 CVE-2017-9605
                 CVE-2017-10911 CVE-2017-11176 CVE-2017-1000363
                 CVE-2017-1000365

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2014-9940

    A use-after-free flaw in the voltage and current regulator driver
    could allow a local user to cause a denial of service or potentially
    escalate privileges.

CVE-2017-7346

    Li Qiang discovered that the DRM driver for VMware virtual GPUs does
    not properly check user-controlled values in the
    vmw_surface_define_ioctl() functions for upper limits. A local user
    can take advantage of this flaw to cause a denial of service.

CVE-2017-7482

    Shi Lei discovered that RxRPC Kerberos 5 ticket handling code does
    not properly verify metadata, leading to information disclosure,
    denial of service or potentially execution of arbitrary code.

CVE-2017-7533

    Fan Wu and Shixiong Zhao discovered a race condition between inotify
    events and VFS rename operations allowing an unprivileged local
    attacker to cause a denial of service or escalate privileges.

CVE-2017-7541

    A buffer overflow flaw in the Broadcom IEEE802.11n PCIe SoftMAC WLAN
    driver could allow a local user to cause kernel memory corruption,
    leading to a denial of service or potentially privilege escalation.

CVE-2017-7542

    An integer overflow vulnerability in the ip6_find_1stfragopt()
    function was found allowing a local attacker with privileges to open
    raw sockets to cause a denial of service.

CVE-2017-7889

    Tommi Rantala and Brad Spengler reported that the mm subsystem does
    not properly enforce the CONFIG_STRICT_DEVMEM protection mechanism,
    allowing a local attacker with access to /dev/mem to obtain
    sensitive information or potentially execute arbitrary code.

CVE-2017-9605

    Murray McAllister discovered that the DRM driver for VMware virtual
    GPUs does not properly initialize memory, potentially allowing a
    local attacker to obtain sensitive information from uninitialized
    kernel memory via a crafted ioctl call.

CVE-2017-10911 / XSA-216

    Anthony Perard of Citrix discovered an information leak flaw in Xen
    blkif response handling, allowing a malicious unprivileged guest to
    obtain sensitive information from the host or other guests.

CVE-2017-11176

    It was discovered that the mq_notify() function does not set the
    sock pointer to NULL upon entry into the retry logic. An attacker
    can take advantage of this flaw during a userspace close of a
    Netlink socket to cause a denial of service or potentially cause
    other impact.

CVE-2017-1000363

    Roee Hay reported that the lp driver does not properly bounds-check
    passed arguments, allowing a local attacker with write access to the
    kernel command line arguments to execute arbitrary code.

CVE-2017-1000365

    It was discovered that argument and environment pointers are not
    taken properly into account to the imposed size restrictions on
    arguments and environmental strings passed through
    RLIMIT_STACK/RLIMIT_INFINITY. A local attacker can take advantage of
    this flaw in conjunction with other flaws to execute arbitrary code.

For the oldstable distribution (jessie), these problems have been fixed
in version 3.16.43-2+deb8u3.

We recommend that you upgrade your linux packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAlmV4s9fFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0SZMhAAhBfaeydc3sP6ce4m24nh4FJRrkZudj04Z1Kloq5+diW3zc1ZzQV6+75x
QZTCmQKqFL7ueLb+jB3whCfg4BHbeTygu3+6eIAYyWFDpmfFRIAjVtLE6HAwC5cr
MM1DyA0AhxtcquoBiCvsmIxKRq5akVn0vSBL4qg3+DXTmjrV1ZGNmECLa5SUO7MF
idIUyvEMOX1TmMAEZBaQqslg4o4lgXXiL9GgB2rbFnPDzHQENZ1li/jkP5iFhSGH
s4mFj0pkwlVYoIa6xdC69kQI49USbpUv5okdthsuDKmm2oj/TuozOIAdcsNFTfts
wYLRic8OrhSYD1ZeXdy6FVzMb5s1alm2zcmDu7xQwSKy5TtVJII+DPWn9EonQaK9
OfazCvQBJ4Tip6CEBl0NFACIO9Y6+ExF2Ens/jJwAWDYOWkGGLTjsWf6TlxAGshl
c8TLvDfZW7hFcs8fPc9YFQQA1OyUA1GCPlLhXltGV2kwIN+iaR3vk/DrJ0kEaaZz
/rklgqvhfYmtx0Hp3pmwJkHCj/S3zIfK8AvZ+SU2hYw9TUxm02JHig/GSbF3eiwL
DvP1PVbXwT9n6ePw0yMkkfaEZBCGFWFnvT2kTBQhSYBfUVLo1KVOJ5gmPdxHda0b
lgtZszmHa+bj5C6DN/OMGBZC/7wgbt7jEyZht3Ke+20z2n+z/yE=
=Dibe
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_2ca54075_20250124_131749.html ===


---

[[Date Prev](msg00188.html)][[Date Next](msg00190.html)]
[[Thread Prev](msg00188.html)][[Thread Next](msg00190.html)]
[[Date Index](maillist.html#00189)]
[[Thread Index](threads.html#00189)]

# [SECURITY] [DSA 3927-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3927-1] linux security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Mon, 07 Aug 2017 05:18:53 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1deaRJ-0005eV-LB%40master.debian.org)Â [E1deaRJ-0005eV-LB@master.debian.org](msg00189.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3927-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
August 07, 2017                       <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2017-7346 CVE-2017-7482 CVE-2017-7533 CVE-2017-7541
                 CVE-2017-7542 CVE-2017-9605 CVE-2017-10810 CVE-2017-10911
                 CVE-2017-11176 CVE-2017-1000365

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2017-7346

    Li Qiang discovered that the DRM driver for VMware virtual GPUs does
    not properly check user-controlled values in the
    vmw_surface_define_ioctl() functions for upper limits. A local user
    can take advantage of this flaw to cause a denial of service.

CVE-2017-7482

    Shi Lei discovered that RxRPC Kerberos 5 ticket handling code does
    not properly verify metadata, leading to information disclosure,
    denial of service or potentially execution of arbitrary code.

CVE-2017-7533

    Fan Wu and Shixiong Zhao discovered a race condition between inotify
    events and VFS rename operations allowing an unprivileged local
    attacker to cause a denial of service or escalate privileges.

CVE-2017-7541

    A buffer overflow flaw in the Broadcom IEEE802.11n PCIe SoftMAC WLAN
    driver could allow a local user to cause kernel memory corruption,
    leading to a denial of service or potentially privilege escalation.

CVE-2017-7542

    An integer overflow vulnerability in the ip6_find_1stfragopt()
    function was found allowing a local attacker with privileges to open
    raw sockets to cause a denial of service.

CVE-2017-9605

    Murray McAllister discovered that the DRM driver for VMware virtual
    GPUs does not properly initialize memory, potentially allowing a
    local attacker to obtain sensitive information from uninitialized
    kernel memory via a crafted ioctl call.

CVE-2017-10810

    Li Qiang discovered a memory leak flaw within the VirtIO GPU driver
    resulting in denial of service (memory consumption).

CVE-2017-10911 / XSA-216

    Anthony Perard of Citrix discovered an information leak flaw in Xen
    blkif response handling, allowing a malicious unprivileged guest to
    obtain sensitive information from the host or other guests.

CVE-2017-11176

    It was discovered that the mq_notify() function does not set the
    sock pointer to NULL upon entry into the retry logic. An attacker
    can take advantage of this flaw during a user-space close of a
    Netlink socket to cause a denial of service or potentially cause
    other impact.

CVE-2017-1000365

    It was discovered that argument and environment pointers are not
    taken properly into account to the imposed size restrictions on
    arguments and environmental strings passed through
    RLIMIT_STACK/RLIMIT_INFINITY. A local attacker can take advantage of
    this flaw in conjunction with other flaws to execute arbitrary code.

For the oldstable distribution (jessie), these problems will be fixed in
a subsequent DSA.

For the stable distribution (stretch), these problems have been fixed in
version 4.9.30-2+deb9u3.

We recommend that you upgrade your linux packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAlmH92RfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0Q3wg//Trx3JpxUkvUY1x33AnhJqGg/9GShz6U1MGnBjKkNwpUH8FICXDHbzYzP
n7GULdxgvtVQypfJni9+Gsvk6EcILcNUTUb9e9gknfLFumHl5KUhAJIOh9Fdb/u2
VYvGwFT5OaO/JqXARhxa3a+SHCSybslUSuyp3hxvjTT0jcl8wBTgkeQYKdlqJp8v
ArklOQoAHVXs+Xq1PFSFDdoN9aOryIXcqGytnx/y1KqH3U4FpQn8AcIIAB53YN5X
NF+GmOewvgZn/7xkVGrqbvh8bhst/Yv5A3CTl1EvY8biApuWYGIKpQiThUtgQs8U
eD/0xoP3rN+NxWoMWyACZqrKH5VaSkcwkkBTGa4BlklHaElFHhlIFXdnP4lMdCZ4
tSBd8UGPFwtF3cyq/nH+9tVmnAqH95sclLf8yvkxxv+vtbZsixJJRlnRdf/nszuT
OOVFsRp/7l7MuqiLErHJkPKHoQ7rZ847GF5flCev6rz7OLQKA2IKPj4RdQKcQ+Ze
Vv6/ZtTcKspD7EoQJyrTC8MBJYvY0g7kswzQDUxKqJA2hIkVY3FEhh94ONZAUady
x6+Nb/a/oAlcZ0wjev1p8ayxtfAAaiuuqxoGbd7rdZkyB1C0eb13XdiOI7yDkdVp
4G8iVjOUdYdKRXlxW9FX+rZhS+yEX8ZbWNZGqThEc/oX0uj6XVo=
=82mY
-----END PGP SIGNATURE-----

```

---



=== Content from git.kernel.org_592dba74_20250124_131749.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=07678eca2cf9c9a18584e546c2b2a0d0c9a3150c)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=07678eca2cf9c9a18584e546c2b2a0d0c9a3150c)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=07678eca2cf9c9a18584e546c2b2a0d0c9a3150c)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=07678eca2cf9c9a18584e546c2b2a0d0c9a3150c)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sinclair Yeh <syeh@vmware.com> | 2017-06-02 07:50:57 +0200 |
| --- | --- | --- |
| committer | Thomas Hellstrom <thellstrom@vmware.com> | 2017-06-07 12:07:35 +0200 |
| commit | [07678eca2cf9c9a18584e546c2b2a0d0c9a3150c](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=07678eca2cf9c9a18584e546c2b2a0d0c9a3150c) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=07678eca2cf9c9a18584e546c2b2a0d0c9a3150c)) | |
| tree | [672fc9dfc28889f99da13104524ec09b7a7fb6ff](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=07678eca2cf9c9a18584e546c2b2a0d0c9a3150c) | |
| parent | [f0c62e9878024300319ba2438adc7b06c6b9c448](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f0c62e9878024300319ba2438adc7b06c6b9c448) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=07678eca2cf9c9a18584e546c2b2a0d0c9a3150c&id2=f0c62e9878024300319ba2438adc7b06c6b9c448)) | |
| download | [linux-07678eca2cf9c9a18584e546c2b2a0d0c9a3150c.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-07678eca2cf9c9a18584e546c2b2a0d0c9a3150c.tar.gz) | |

drm/vmwgfx: Make sure backup\_handle is always validWhen vmw\_gb\_surface\_define\_ioctl() is called with an existing buffer,
we end up returning an uninitialized variable in the backup\_handle.
The fix is to first initialize backup\_handle to 0 just to be sure, and
second, when a user-provided buffer is found, we will use the
req->buffer\_handle as the backup\_handle.
Cc: <stable@vger.kernel.org>
Reported-by: Murray McAllister <murray.mcallister@insomniasec.com>
Signed-off-by: Sinclair Yeh <syeh@vmware.com>
Reviewed-by: Deepak Rawat <drawat@vmware.com>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=07678eca2cf9c9a18584e546c2b2a0d0c9a3150c)

| -rw-r--r-- | [drivers/gpu/drm/vmwgfx/vmwgfx\_surface.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/gpu/drm/vmwgfx/vmwgfx_surface.c?id=07678eca2cf9c9a18584e546c2b2a0d0c9a3150c) | 18 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 11 insertions, 7 deletions

| diff --git a/drivers/gpu/drm/vmwgfx/vmwgfx\_surface.c b/drivers/gpu/drm/vmwgfx/vmwgfx\_surface.cindex baf03d4d86d294..834bb10973a2eb 100644--- a/[drivers/gpu/drm/vmwgfx/vmwgfx\_surface.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/gpu/drm/vmwgfx/vmwgfx_surface.c?id=f0c62e9878024300319ba2438adc7b06c6b9c448)+++ b/[drivers/gpu/drm/vmwgfx/vmwgfx\_surface.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/gpu/drm/vmwgfx/vmwgfx_surface.c?id=07678eca2cf9c9a18584e546c2b2a0d0c9a3150c)@@ -1274,7 +1274,7 @@ int vmw\_gb\_surface\_define\_ioctl(struct drm\_device \*dev, void \*data, struct ttm\_object\_file \*tfile = vmw\_fpriv(file\_priv)->tfile; int ret; uint32\_t size;- uint32\_t backup\_handle;+ uint32\_t backup\_handle = 0;  if (req->multisample\_count != 0) return -EINVAL;@@ -1317,12 +1317,16 @@ int vmw\_gb\_surface\_define\_ioctl(struct drm\_device \*dev, void \*data, ret = vmw\_user\_dmabuf\_lookup(tfile, req->buffer\_handle, &res->backup, &user\_srf->backup\_base);- if (ret == 0 && res->backup->base.num\_pages \* PAGE\_SIZE <- res->backup\_size) {- DRM\_ERROR("Surface backup buffer is too small.\n");- vmw\_dmabuf\_unreference(&res->backup);- ret = -EINVAL;- goto out\_unlock;+ if (ret == 0) {+ if (res->backup->base.num\_pages \* PAGE\_SIZE <+ res->backup\_size) {+ DRM\_ERROR("Surface backup buffer is too small.\n");+ vmw\_dmabuf\_unreference(&res->backup);+ ret = -EINVAL;+ goto out\_unlock;+ } else {+ backup\_handle = req->buffer\_handle;+ } } } else if (req->drm\_surface\_flags & drm\_vmw\_surface\_flag\_create\_buffer) ret = vmw\_user\_dmabuf\_alloc(dev\_priv, tfile, |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-24 13:16:26 +0000


