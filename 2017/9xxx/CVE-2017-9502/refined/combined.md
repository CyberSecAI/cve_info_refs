=== Content from openwall.com_175a89e9_20250125_102050.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2017/06/13/11) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <alpine.DEB.2.20.1706140819140.16652@tvnag.unkk.fr>
Date: Wed, 14 Jun 2017 08:20:27 +0200 (CEST)
From: Daniel Stenberg <daniel@...x.se>
To: curl security announcements -- curl users <curl-users@...l.haxx.se>,
        curl-announce@...l.haxx.se,
        libcurl hacking <curl-library@...l.haxx.se>,
        oss-security@...ts.openwall.com
Subject: [SECURITY ADVISORY] curl: URL file scheme drive letter buffer
 overflow

URL file scheme drive letter buffer overflow
============================================

Project curl Security Advisory, June 14th 2017 -
[Permalink](<https://curl.haxx.se/docs/adv_20170614.html>)

VULNERABILITY
-------------

When libcurl is given either

  1. a file: URL that doesn't use two slashes following the colon, or
  2. is told that file is the default scheme to use for URLs without scheme

... and the given path starts with a drive letter and libcurl is built for
Windows or DOS, then libcurl would copy the path with a wrong offset, so that
the end of the given path would write beyond the malloc buffer. Up to seven
bytes too much.

We are not aware of any exploit of this flaw.

INFO
----

This flaw also affects the curl command line tool. It was introduced in commit
[1d4202ade602](<https://github.com/curl/curl/commit/1d4202ade602>), discussed in
[issue #1124](<https://github.com/curl/curl/pull/1124>).

HTTP redirects to file: URLs are not affected.

For version 7.54.1, the function that cleans up the file: URLs is fixed to not
copy things out of the buffer!

The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2017-9502 to this issue.

AFFECTED VERSIONS
-----------------

This bug is present on libcurl builds that accept drive letters in file names,
which is limited to Windows and DOS builds, including cygwin.

- Affected versions: libcurl 7.53.0 to and including 7.54.0
- Not affected versions: libcurl < 7.53.0 and >= 7.54.1

libcurl is used by many applications, but not always advertised as such!

THE SOLUTION
------------

The function now takes better care to allocate memory enough to store what's
copied and to copy the strings to the correct output offsets.

A [patch for CVE-2017-9502](<https://curl.haxx.se/CVE-2017-9502.patch>) is
available.

RECOMMENDATIONS
---------------

We suggest you take one of the following actions immediately, in order of
preference:

  A - Upgrade curl and libcurl to version 7.54.1

  B - Apply the patch to your version and rebuild

  C - Do not use file URLs on Windows

TIME LINE
---------

It was reported to the curl project on June 4, 2017.  We contacted MITRE on
June 7.

libcurl 7.54.1 was released on June 14 2017, coordinated with the publication
of this advisory.

CREDITS
-------

Reported by Marcel Raad. Patch by Daniel Stenberg.

Thanks a lot!

--

  / daniel.haxx.se

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


