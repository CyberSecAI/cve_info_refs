- **Root cause of vulnerability**: The `$display_name` variable in `/account/details.php` is not properly sanitized before being written to the database, allowing an attacker to bypass `escapeString` and inject malicious code.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS)
- **Impact of exploitation**: Successful exploitation of this vulnerability would allow an attacker to execute arbitrary JavaScript code in the context of a user's browser, potentially leading to account hijacking, data theft, or other malicious activities.
- **Attack vectors**: The attack vector is through the `/account/preferences.php` page by crafting a POST request with malicious JavaScript code within the `display_name` parameter.
- **Required attacker capabilities/position**: The attacker needs to be able to send a crafted POST request to the `/account/preferences.php` page.