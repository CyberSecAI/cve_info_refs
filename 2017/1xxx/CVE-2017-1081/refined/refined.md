- **Root cause of vulnerability**: A use-after-free vulnerability exists in the `ipfilter(4)` module's handling of fragmented packets. When a new fragment matches an existing entry in the hash table, the code incorrectly frees the existing entry before processing the new fragment.
- **Weaknesses/vulnerabilities present**: Use-after-free vulnerability, which leads to a memory leak briefly before the panic occurs due to freeing the wrong entry.
- **Impact of exploitation**: Exploiting this vulnerability causes a kernel panic leading to a denial-of-service (DoS) condition. The system will enter a reboot loop.
- **Attack vectors**: A remote attacker can exploit this vulnerability by sending carefully crafted fragmented packets that are allowed to pass through the `ipfilter(4)` firewall.
- **Required attacker capabilities/position**: The attacker needs to be able to send network packets to the target system that are allowed by the ipfilter rules. The attacker needs to craft specific fragmented packets to trigger the vulnerability.