- **Root cause of vulnerability:** When a version check fails during a Db2 upgrade to v11.x, the connection string, including the password, is written in clear text within an error message to the `db2diag.log` file.
- **Weaknesses/vulnerabilities present:** Sensitive information exposure. The vulnerability lies in logging connection string including the password in clear text to a log file.
- **Impact of exploitation:** An attacker who has access to the `db2diag.log` file could potentially obtain the database password, potentially leading to unauthorized access and data compromise.
- **Attack vectors:** An attacker would need to gain access to the server's file system where the `db2diag.log` file is stored.
- **Required attacker capabilities/position:** The attacker would need filesystem access to the server and knowledge of where the `db2diag.log` file is located. They would also need to wait for a failed upgrade attempt to trigger the logging of the credentials.