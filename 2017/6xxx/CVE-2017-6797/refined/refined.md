Based on the provided content, here's a breakdown of the vulnerability described in CVE-2017-6797:

**Root Cause:**
The vulnerability lies in the `bug_change_status_page.php` file of MantisBT. Specifically, the value of the `action_type` parameter was not properly encoded before being used in a hidden HTML input field.

**Weaknesses/Vulnerabilities:**
- **Cross-Site Scripting (XSS):** The lack of proper encoding allows an attacker to inject arbitrary JavaScript code into the page. This is a reflected XSS vulnerability.

**Impact of Exploitation:**
- **Arbitrary JavaScript Execution:** By injecting malicious JavaScript, an attacker can perform various actions, including:
    - Stealing user session cookies.
    - Redirecting users to malicious websites.
    - Modifying the content of the page.
    - Performing actions on behalf of the user.

**Attack Vectors:**
- **HTTP GET/POST Parameter:** The `action_type` parameter is vulnerable when supplied via GET or POST requests. An attacker can craft a malicious URL or form submission that includes the malicious JavaScript payload.

**Required Attacker Capabilities/Position:**
- **Remote Attacker:** The attacker does not need any special privileges or access to the MantisBT server.
- **User Interaction:** The attacker needs to induce a user to visit the malicious link or submit the malicious form data.

**Technical Details:**
- The vulnerability is in the way the `action_type` parameter is handled in `bug_change_status_page.php`.
- The fix involves using the `string_attribute()` function to properly encode the `action_type` value before including it in the HTML.

**Affected Versions:**
- 1.3.0-beta.3 through 2.2.0

**Fixed Versions:**
- 1.3.7, 2.2.1

The provided content also includes links to the commits that fix the issue:
- 1.3:  https://github.com/mantisbt/mantisbt/commit/a2d90ecabf3bcf3aa22ed9dbbecfd3d37902956f
- 2.x: https://github.com/mantisbt/mantisbt/commit/c272c3f65da9677e505ff692b1f1e476b3afa56e
- 2.1: https://github.com/mantisbt/mantisbt/commit/55b5b4f3ae5b62584f80b0dbdd866669eddffca1

The vulnerability was reported by Etienne Landais and fixed by Damien Regad.