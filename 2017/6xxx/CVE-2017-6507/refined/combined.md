=== Content from launchpad.net_6df17578_20250126_090634.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[apparmor package](https://launchpad.net/ubuntu/%2Bsource/apparmor)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/apparmor)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/apparmor)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/apparmor)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/apparmor)

# CVE-2017-6507: apparmor service restarts and package upgrades unload privately managed profiles

Bug #1668892 reported by
[Stéphane Graber](https://launchpad.net/~stgraber)
on 2017-03-01

[268](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [AppArmor](https://bugs.launchpad.net/apparmor) | Fix Released | Critical | [juan serven](https://launchpad.net/~juanserven) | [AppArmor 2.12](https://launchpad.net/apparmor/%2Bmilestone/2.12) |
|  | [2.10](https://bugs.launchpad.net/apparmor/2.10) | Fix Released | Undecided | Unassigned | [AppArmor 2.10.3](https://launchpad.net/apparmor/%2Bmilestone/2.10.3) |
|  | [2.11](https://bugs.launchpad.net/apparmor/2.11) | Fix Released | Undecided | Unassigned | [AppArmor 2.11.1](https://launchpad.net/apparmor/%2Bmilestone/2.11.1) |
|  | [2.9](https://bugs.launchpad.net/apparmor/2.9) | Fix Released | Undecided | Unassigned | [AppArmor 2.9.5](https://launchpad.net/apparmor/%2Bmilestone/2.9.5) |
|  | [apparmor (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor "Latest release: 4.1.0~beta1-0ubuntu4, uploaded to main on 2024-11-13 09:07:17.105612+00:00 by Matthias Klose (doko), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Critical | [Tyler Hicks](https://launchpad.net/~tyhicks) |  |

### Bug Description

Restarting the apparmor init script, upstart job, or systemd service has historically removed all loaded profiles unknown to the well-known profile locations. In upstream AppArmor terms, this is /etc/apparmor.d/ but Ubuntu also adds additional locations.

This behavior has previously caused a problem where libvirt-managed profiles would be unloaded upon "restarting AppArmor":

<https://launchpad.net/bugs/702774>

Stéphane Graber created this bug report after he noticed that the same behavior was causing similar problems with lxd-manager profiles.

In addition, AppArmor distro packaging may trigger an "AppArmor restart" when installing a new version of AppArmor, resulting in the same profile removal problem. This is true for the Debian/Ubuntu packaging.

The upstream AppArmor team has decided to remove this functionality from the AppArmor restart logic to prevent a similar issue happening with the next external project that needs to privately manage their own set of AppArmor profiles.

=== Original Bug Report ===

Apparmor package upgrades unloads all LXD apparmor profiles, making all LXD containers unconfined.

Example:

# Create an unprivileged and a privileged container

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ lxc launch ubuntu:16.04 c1

Creating c1

Starting c1

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ lxc launch ubuntu:16.04 c2 -c security.privileged=true

Creating c2

Starting c2

# Look at their apparmor profiles (expected values)

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ cat /proc/$(lxc info c1 | grep Pid | sed "s/Pid: //g")/attr/current

lxd-c1\_</var/lib/lxd>//&:lxd-c1\_<var-lib-lxd>://unconfined (enforce)

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ cat /proc/$(lxc info c2 | grep Pid | sed "s/Pid: //g")/attr/current

lxd-c2\_</var/lib/lxd>//&:lxd-c2\_<var-lib-lxd>://unconfined (enforce)

# Apply an apparmor upgrade

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ sudo apt upgrade

Reading package lists... Done

Building dependency tree

Reading state information... Done

Calculating upgrade... Done

The following packages will be upgraded:

  apparmor

1 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.

Need to get 493 kB of archives.

After this operation, 8,192 B of additional disk space will be used.

Do you want to continue? [Y/n]

Get:1 <http://us.archive.ubuntu.com/ubuntu> zesty/main amd64 apparmor amd64 2.11.0-2ubuntu1 [493 kB]

Fetched 493 kB in 0s (34.9 MB/s)

Preconfiguring packages ...

(Reading database ... 221457 files and directories currently installed.)

Preparing to unpack .../apparmor\_2.11.0-2ubuntu1\_amd64.deb ...

Unpacking apparmor (2.11.0-2ubuntu1) over (2.10.95-4ubuntu5.1) ...

Processing triggers for ureadahead (0.100.0-19) ...

Setting up apparmor (2.11.0-2ubuntu1) ...

Installing new version of config file /etc/apparmor.d/abstractions/X ...

Installing new version of config file /etc/apparmor.d/abstractions/authentication ...

Installing new version of config file /etc/apparmor.d/abstractions/base ...

Installing new version of config file /etc/apparmor.d/abstractions/dbus-session-strict ...

Installing new version of config file /etc/apparmor.d/abstractions/gnome ...

Installing new version of config file /etc/apparmor.d/abstractions/nameservice ...

Installing new version of config file /etc/apparmor.d/abstractions/php5 ...

Installing new version of config file /etc/apparmor.d/abstractions/samba ...

Installing new version of config file /etc/apparmor.d/abstractions/ssl\_certs ...

Installing new version of config file /etc/apparmor.d/abstractions/ssl\_keys ...

Installing new version of config file /etc/apparmor.d/abstractions/ubuntu-browsers ...

Installing new version of config file /etc/apparmor.d/abstractions/ubuntu-helpers ...

Installing new version of config file /etc/apparmor.d/abstractions/user-mail ...

update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults

Skipping profile in /etc/apparmor.d/disable: usr.sbin.rsyslogd

Skipping profile in /etc/apparmor.d/disable: usr.sbin.sssd

Processing triggers for systemd (232-18ubuntu1) ...

Processing triggers for man-db (2.7.6.1-1) ...

# And look at the now unconfined containers

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ cat /proc/$(lxc info c1 | grep Pid | sed "s/Pid: //g")/attr/current

unconfined//&:lxd-c1\_<var-lib-lxd>://unconfined

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ cat /proc/$(lxc info c2 | grep Pid | sed "s/Pid: //g")/attr/current

unconfined//&:lxd-c2\_<var-lib-lxd>://unconfined

# The LXD profiles are also entirely gone

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ ls /sys/kernel/security/apparmor/policy/profiles/ | grep lxd

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$

# And to confirm that apparmor is in fact gone

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ lxc exec c2 bash

root@c2:~# mount -t proc proc /mnt

root@c2:~# echo "|/usr/bin/touch /pwned" > /mnt/sys/kernel/core\_pattern

root@c2:~# sleep 30&

[1] 468

root@c2:~# kill -SIGSEGV $!

root@c2:~#

[1]+ Segmentation fault (core dumped) sleep 30

root@c2:~# exit

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ ls -lh /pwned

-rw-rw-rw- 1 root root 0 Mar 1 03:37 /pwned

This was originally reported (though not as a security issue) here: <https://github.com/lxc/lxd/issues/2981>

See [original description](comments/0)

Tags:

[patch](/ubuntu/%2Bsource/apparmor/%2Bbugs?field.tag=patch)

## Related branches

[lp:apparmor/2.12](https://code.launchpad.net/~apparmor-dev/apparmor/master)

[lp:~apparmor-dev/apparmor/apparmor-ubuntu-citrain](https://code.launchpad.net/~apparmor-dev/apparmor/apparmor-ubuntu-citrain)

[lp:apparmor/2.10](https://code.launchpad.net/~apparmor-dev/apparmor/2.10)

[lp:apparmor/2.9](https://code.launchpad.net/~apparmor-dev/apparmor/2.9)

## CVE References

* [2017-6507](/bugs/cve/2017-6507 "An issue was discovered in AppArmor b...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Stéphane Graber (stgraber)](https://launchpad.net/~stgraber) wrote on 2017-03-01: |  |  | [#1](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/1) |
| --- | --- | --- | --- |

Subscribed the LXC security team, mostly for awareness if we get more such reports from users.

Subscribed the LXC security team, mostly for awareness if we get more such reports from users.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Stéphane Graber (stgraber)](https://launchpad.net/~stgraber) wrote on 2017-03-01: |  |  | [#2](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/2) |
| --- | --- | --- | --- |

The LXD profiles are still available on disk in /var/lib/lxd/security/apparmor but I'm not sure we'll be able to easily fix all those processes that now got relabeled...

It may be simpler for the advisory to recommend all LXD users restart all their containers which will get LXD to regenerate and load the apparmor profile.

Something like "sudo lxd shutdown && sudo lxd activateifneeded" should do the trick, though note that having a maintainer script do so isn't a good idea as it'd be equivalent to having a maintainer script issuing random "reboot" commands to remote hosts.

The LXD profiles are still available on disk in /var/lib/lxd/security/apparmor but I'm not sure we'll be able to easily fix all those processes that now got relabeled...
It may be simpler for the advisory to recommend all LXD users restart all their containers which will get LXD to regenerate and load the apparmor profile.
Something like "sudo lxd shutdown && sudo lxd activateifneeded" should do the trick, though note that having a maintainer script do so isn't a good idea as it'd be equivalent to having a maintainer script issuing random "reboot" commands to remote hosts.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-03: |  |  | [#3](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/3) |
| --- | --- | --- | --- |

The way that I plan to address this is by removing the calls to unload\_obsolete\_profiles() in the apparmor postinst and init script/upstart job/systemd unit.

I've prepared untested security updates for all releases and will test them early next week.

The way that I plan to address this is by removing the calls to unload\_obsolete\_profiles() in the apparmor postinst and init script/upstart job/systemd unit.
I've prepared untested security updates for all releases and will test them early next week.

| Changed in apparmor (Ubuntu): | |
| --- | --- |
| **status**: | New → In Progress |
| **assignee**: | nobody → Tyler Hicks (tyhicks) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-08: |  |  | [#4](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/4) |
| --- | --- | --- | --- |

This is CVE-2017-6507

This is CVE-2017-6507

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-11: |  |  | [#5](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/5) |
| --- | --- | --- | --- |

* [0001-parser-Preserve-unknown-profiles-when-restarting-app.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Battachment/4835672/%2Bfiles/0001-parser-Preserve-unknown-profiles-when-restarting-app.patch)
  [Edit](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Battachment/4835672)
  (2.3 KiB,
  text/plain)

This patch is the actual CVE fix. It simply removes the functionality. A followup patch will be posted that adds a small utility that contains the old functionality for administrators that depend on it.

This patch is the actual CVE fix. It simply removes the functionality. A followup patch will be posted that adds a small utility that contains the old functionality for administrators that depend on it.

| Changed in apparmor: | |
| --- | --- |
| **status**: | New → In Progress |
| **importance**: | Undecided → Critical |
| **assignee**: | nobody → Tyler Hicks (tyhicks) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-11: |  |  | [#6](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/6) |
| --- | --- | --- | --- |

* [0002-utils-Add-aa-remove-unknown-utility-to-unload-unknow.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Battachment/4835673/%2Bfiles/0002-utils-Add-aa-remove-unknown-utility-to-unload-unknow.patch)
  [Edit](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Battachment/4835673)
  (6.4 KiB,
  text/plain)

This patch adds the helper utility.

This patch adds the helper utility.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Boltz (cboltz)](https://launchpad.net/~cboltz) wrote on 2017-03-12: |  |  | [#7](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/7) |
| --- | --- | --- | --- |

aa-remove-unknown:

...

+ else

+ echo "Removing '${profile}'"

+ echo -n "$profile" > "${REMOVE}"

+ fi

+ done

+

+# will not catch all errors, but still better than nothing

+exit $?

I slightly disagree with the "better than nothing" part ;-)

If I didn't miss something, the only thing that could go wrong is

+ echo -n "$profile" > "${REMOVE}"

It would be much better to use something like

+ echo -n "$profile" > "${REMOVE}" || failure=1

...

exit $failure

(obviously, also initialize failure=0 before the loop)

aa-remove-unknown:
...
+ else
+ echo "Removing '${profile}'"
+ echo -n "$profile" > "${REMOVE}"
+ fi
+ done
+
+# will not catch all errors, but still better than nothing
+exit $?
I slightly disagree with the "better than nothing" part ;-)
If I didn't miss something, the only thing that could go wrong is
+ echo -n "$profile" > "${REMOVE}"
It would be much better to use something like
+ echo -n "$profile" > "${REMOVE}" || failure=1
...
exit $failure
(obviously, also initialize failure=0 before the loop)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-13:  [**Re: [Bug 1668892] Re: apparmor package upgrades unload all LXD profiles**](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/8) |  |  | [#8](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/8) |
| --- | --- | --- | --- |

On 03/12/2017 09:22 AM, Christian Boltz wrote:

> aa-remove-unknown:

> ...

> + else

> + echo "Removing '${profile}'"

> + echo -n "$profile" > "${REMOVE}"

> + fi

> + done

> +

> +# will not catch all errors, but still better than nothing

> +exit $?

>

> I slightly disagree with the "better than nothing" part ;-)

>

> If I didn't miss something, the only thing that could go wrong is

> + echo -n "$profile" > "${REMOVE}"

There's much more that could go wrong. To name a few:

1) Things could go wrong in the profiles\_names\_list() function

2) Things could go wrong while executing the awk and/or sort binaries

3) Things could go wrong in the awk script itself

Since all of that goop is piped together, none of those errors would be

caught. IMO, It is some pretty bad code that needs to be improved

outside of this security bug.

The reason I don't feel like it needs to be fixed at the same time as

this security bug is because it should fail safely. In other words,

failing would mean that processes are left confined rather than unconfined.

> It would be much better to use something like

> + echo -n "$profile" > "${REMOVE}" || failure=1

> ...

> exit $failure

>

> (obviously, also initialize failure=0 before the loop)

I agree that it would be better. I'll include an updated patch. Thanks

for the review!

On 03/12/2017 09:22 AM, Christian Boltz wrote:
> aa-remove-unknown:
> ...
> + else
> + echo "Removing '${profile}'"
> + echo -n "$profile" > "${REMOVE}"
> + fi
> + done
> +
> +# will not catch all errors, but still better than nothing
> +exit $?
>
> I slightly disagree with the "better than nothing" part ;-)
>
> If I didn't miss something, the only thing that could go wrong is
> + echo -n "$profile" > "${REMOVE}"
There's much more that could go wrong. To name a few:
1) Things could go wrong in the profiles\_names\_list() function
2) Things could go wrong while executing the awk and/or sort binaries
3) Things could go wrong in the awk script itself
Since all of that goop is piped together, none of those errors would be
caught. IMO, It is some pretty bad code that needs to be improved
outside of this security bug.
The reason I don't feel like it needs to be fixed at the same time as
this security bug is because it should fail safely. In other words,
failing would mean that processes are left confined rather than unconfined.
> It would be much better to use something like
> + echo -n "$profile" > "${REMOVE}" || failure=1
> ...
> exit $failure
>
> (obviously, also initialize failure=0 before the loop)
I agree that it would be better. I'll include an updated patch. Thanks
for the review!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Boltz (cboltz)](https://launchpad.net/~cboltz) wrote on 2017-03-14:  [**Re: apparmor package upgrades unload all LXD profiles**](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/9) |  |  | [#9](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/9) |
| --- | --- | --- | --- |

> Since all of that goop is piped together,

... you should "set -o pipefail" ;-)

> Since all of that goop is piped together,
... you should "set -o pipefail" ;-)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-14:  [**Re: [Bug 1668892] Re: apparmor package upgrades unload all LXD profiles**](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/10) |  |  | [#10](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/10) |
| --- | --- | --- | --- |

On 03/14/2017 01:14 PM, Christian Boltz wrote:

>> Since all of that goop is piped together,

>

> ... you should "set -o pipefail" ;-)

Not possible with POSIX shell. We can save all of these enhancements for

after these CVE fixes land and before the next upstream release.

On 03/14/2017 01:14 PM, Christian Boltz wrote:
>> Since all of that goop is piped together,
>
> ... you should "set -o pipefail" ;-)
Not possible with POSIX shell. We can save all of these enhancements for
after these CVE fixes land and before the next upstream release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Boltz (cboltz)](https://launchpad.net/~cboltz) wrote on 2017-03-15:  [**Re: apparmor package upgrades unload all LXD profiles**](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/11) |  |  | [#11](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/11) |
| --- | --- | --- | --- |

I'd argue that requiring /bin/bash shouldn't be a real problem, but I'm aware that you try to use /bin/sh whenever possible.

Completely different question: does this bug only affect Ubuntu, or is a similar fix needed in rc.apparmor.functions? (\_\_apparmor\_restart() has code to unload unknown profiles)

I'd argue that requiring /bin/bash shouldn't be a real problem, but I'm aware that you try to use /bin/sh whenever possible.
Completely different question: does this bug only affect Ubuntu, or is a similar fix needed in rc.apparmor.functions? (\_\_apparmor\_restart() has code to unload unknown profiles)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-15:  [**Re: [Bug 1668892] Re: apparmor package upgrades unload all LXD profiles**](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/12) |  |  | [#12](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/12) |
| --- | --- | --- | --- |

On 03/15/2017 01:26 PM, Christian Boltz wrote:

> I'd argue that requiring /bin/bash shouldn't be a real problem, but I'm

> aware that you try to use /bin/sh whenever possible.

It shouldn't but I don't feel comfortable switching between the two

shells when this is supposed to be a minimal change.

> Completely different question: does this bug only affect Ubuntu, or is a

> similar fix needed in rc.apparmor.functions? (\_\_apparmor\_restart() has

> code to unload unknown profiles)

Upstream is affected. The only patches that I've attached so far are for

the upstream project.

The Ubuntu/Debian-specific init code is also affected and I'm working on

patches for that now.

Can you tell me if openSUSE is affected by this bug? A quick test is to do

$ echo "profile test {}" | sudo apparmor\_parser -qr

$ sudo grep "test (enforce)" /sys/kernel/security/apparmor/profiles

test (enforce)

$ # do whateveris required to restart the apparmor init script/upstart

$ # job/systemd unit that your distro uses

$ sudo grep "test (enforce)" /sys/kernel/security/apparmor/profiles

test (enforce)

If the test profile is still loaded, you're not affected. If it was

unloaded, you're affected.

On 03/15/2017 01:26 PM, Christian Boltz wrote:
> I'd argue that requiring /bin/bash shouldn't be a real problem, but I'm
> aware that you try to use /bin/sh whenever possible.
It shouldn't but I don't feel comfortable switching between the two
shells when this is supposed to be a minimal change.
> Completely different question: does this bug only affect Ubuntu, or is a
> similar fix needed in rc.apparmor.functions? (\_\_apparmor\_restart() has
> code to unload unknown profiles)
Upstream is affected. The only patches that I've attached so far are for
the upstream project.
The Ubuntu/Debian-specific init code is also affected and I'm working on
patches for that now.
Can you tell me if openSUSE is affected by this bug? A quick test is to do
$ echo "profile test {}" | sudo apparmor\_parser -qr
$ sudo grep "test (enforce)" /sys/kernel/security/apparmor/profiles
test (enforce)
$ # do whateveris required to restart the apparmor init script/upstart
$ # job/systemd unit that your distro uses
$ sudo grep "test (enforce)" /sys/kernel/security/apparmor/profiles
test (enforce)
If the test profile is still loaded, you're not affected. If it was
unloaded, you're affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Boltz (cboltz)](https://launchpad.net/~cboltz) wrote on 2017-03-16:  [**Re: apparmor package upgrades unload all LXD profiles**](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/13) |  |  | [#13](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/13) |
| --- | --- | --- | --- |

Testing confirmed what I expected from reading rc.apparmor.functions \_\_apparmor\_restart() - the test profile gets unloaded on "rcapparmor reload".

Testing confirmed what I expected from reading rc.apparmor.functions \_\_apparmor\_restart() - the test profile gets unloaded on "rcapparmor reload".

[Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks)
on 2017-03-23

| **summary**: | - apparmor package upgrades unload all LXD profiles+ apparmor package upgrades unload privately managed profiles |
| --- | --- |
| **summary**: | - apparmor package upgrades unload privately managed profiles+ CVE-2017-6507: apparmor package upgrades unload privately managed+ profiles |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-23:  [**Re: CVE-2017-6507: apparmor package upgrades unload privately managed profiles**](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/14) |  |  | [#14](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/14) |
| --- | --- | --- | --- |

I'm making this bug public since this behavior is not attacker-controlled. It is controlled by the system administrator and the distro package maintainer(s) for AppArmor.

I'm making this bug public since this behavior is not attacker-controlled. It is controlled by the system administrator and the distro package maintainer(s) for AppArmor.

| **description**: | updated |
| --- | --- |
| **information type**: | Private Security → Public Security |

[Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks)
on 2017-03-23

| **summary**: | - CVE-2017-6507: apparmor package upgrades unload privately managed- profiles+ CVE-2017-6507: apparmor service restarts and package upgrades unload+ privately managed profiles |
| --- | --- |

[Ubuntu Foundations Team Bug Bot (crichton)](https://launchpad.net/~crichton)
on 2017-03-24

| **tags**: | added: patch |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-24: |  |  | [#15](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/15) |
| --- | --- | --- | --- |

The fixes have been committed to the master branch:

<http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3647>

<http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3648>

The fixes have been committed to the master branch:
http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3647
http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3648

| Changed in apparmor: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |
| **milestone**: | none → 2.12 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2017-03-24: |  |  | [#16](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/comments/16) |
| --- | --- | --- | --- |

This bug was fixed in the package apparmor - 2.11.0-2ubuntu3

---------------

apparmor (2.11.0-2ubuntu3) zesty; urgency=medium

\* SECURITY UPDATE: Don't unload unknown profiles during package

    configuration or when restarting the apparmor init script, upstart job, or

    systemd unit as this could leave processes unconfined (LP: [#1668892](/bugs/1668892))

    - debian/apparmor.postinst, debian/apparmor.init, debian/apparmor.upstart:

      Remove calls to unload\_obsolete\_profiles()

    - debian/patches/utils-add-aa-remove-unknown.patch,

      debian/apparmor.install debian/apparmor.manpages: Include a new utility,

      aa-remove-unknown, which can be used to unload unknown profiles. Based

      on an upstream patch but adjusted to source the /lib/apparmor/functions

      shipped in Debian/Ubuntu.

    - CVE-2017-6507

  \* debian/patches/r3645-profiles-update-nvidia-abstraction.patch: Update

    nvidia abstraction for newer nvidia drivers (LP: [#1590561](/bugs/1590561))

-- Tyler Hicks <email address hidden> Fri, 24 Mar 2017 05:26:28 +0000

This bug was fixed in the package apparmor - 2.11.0-2ubuntu3
---------------
apparmor (2.11.0-2ubuntu3) zesty; urgency=medium
\* SECURITY UPDATE: Don't unload unknown profiles during package
configuration or when restarting the apparmor init script, upstart job, or
systemd unit as this could leave processes unconfined (LP: #1668892)
- debian/apparmor.postinst, debian/apparmor.init, debian/apparmor.upstart:
Remove calls to unload\_obsolete\_profiles()
- debian/patches/utils-add-aa-remove-unknown.patch,
debian/apparmor.install debian/apparmor.manpages: Include a new utility,
aa-remove-unknown, which can be used to unload unknown profiles. Based
on an upstream patch but adjusted to source the /lib/apparmor/functions
shipped in Debian/Ubuntu.
- CVE-2017-6507
\* debian/patches/r3645-profiles-update-nvidia-abstraction.patch: Update
nvidia abstraction for newer nvidia drivers (LP: #1590561)
-- Tyler Hicks <tyhicks@canonical.com> Fri, 24 Mar 2017 05:26:28 +0000

| Changed in apparmor (Ubuntu): | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[John Johansen (jjohansen)](https://launchpad.net/~jjohansen)
on 2017-10-19

| Changed in apparmor: | |
| --- | --- |
| **status**: | Fix Committed → Won't Fix |
| **status**: | Won't Fix → Fix Committed |

[Christian Boltz (cboltz)](https://launchpad.net/~cboltz)
on 2018-04-22

| Changed in apparmor: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

[juan serven (juanserven)](https://launchpad.net/~juanserven)
on 2019-11-08

| Changed in apparmor: | |
| --- | --- |
| **assignee**: | Tyler Hicks (tyhicks) → juan serven (juanserven) |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/apparmor/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0001-parser-Preserve-unknown-profiles-when-restarting-app.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Battachment/4835672/%2Bfiles/0001-parser-Preserve-unknown-profiles-when-restarting-app.patch)
  [Edit](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Battachment/4835672 "Change patch details")
* [0002-utils-Add-aa-remove-unknown-utility-to-unload-unknow.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Battachment/4835673/%2Bfiles/0002-utils-Add-aa-remove-unknown-utility-to-unload-unknow.patch)
  [Edit](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Battachment/4835673 "Change patch details")

* [Add patch](/ubuntu/%2Bsource/apparmor/%2Bbug/1668892/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from security-tracker.debian.org_2871b43e_20250126_090654.html ===

# CVE-2017-6507

| **Name** | CVE-2017-6507 |
| --- | --- |
| **Description** | An issue was discovered in AppArmor before 2.12. Incorrect handling of unknown AppArmor profiles in AppArmor init scripts, upstart jobs, and/or systemd unit files allows an attacker to possibly have increased attack surfaces of processes that were intended to be confined by AppArmor. This is due to the common logic to handle 'restart' operations removing AppArmor profiles that aren't found in the typical filesystem locations, such as /etc/apparmor.d/. Userspace projects that manage their own AppArmor profiles in atypical directories, such as what's done by LXD and Docker, are affected by this flaw in the AppArmor init script logic. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2017-6507) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2017-6507); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2017-6507), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2017-6507), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2017-6507), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2017-6507), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-6507), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2017-6507), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2017-6507), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2017-6507)/[CVE](https://www.suse.com/security/cve/CVE-2017-6507/), GitHub [advisories](https://github.com/advisories?query=CVE-2017-6507)/[code](https://github.com/search?type=Code&q=%22CVE-2017-6507%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2017-6507%22), [web search](https://duckduckgo.com/html?q=%22CVE-2017-6507%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [858768](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=858768) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [apparmor](/tracker/source-package/apparmor) ([PTS](https://tracker.debian.org/pkg/apparmor)) | bullseye | 2.13.6-10 | fixed |
|  | bookworm | 3.0.8-3 | fixed |
|  | sid, trixie | 3.1.7-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [apparmor](/tracker/source-package/apparmor) | source | (unstable) | 2.11.0-3 |  |  | [858768](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=858768) |

## Notes

```
[jessie] - apparmor <no-dsa> (Minor issue)
[wheezy] - apparmor <no-dsa> (Experimental/unsupported feature)
<http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3647>
<http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3648>
[https://bugs.launchpad.net/apparmor/+bug/1668892](https://bugs.launchpad.net/apparmor/%2Bbug/1668892)
affects only third-party rules, e.g. from Docker or LXC
LXC in wheezy doesn't support proper isolation

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from translations.launchpad.net_77545c03_20250126_090642.html ===

[Log in / Register](https://translations.launchpad.net/apparmor/%2Blogin)

[![](https://launchpadlibrarian.net/378258639/apparmor-64x64.png)](https://launchpad.net/apparmor)

## [AppArmor](https://launchpad.net/apparmor)

* [Overview](https://launchpad.net/apparmor)
* [Code](https://code.launchpad.net/apparmor)
* [Bugs](https://bugs.launchpad.net/apparmor)
* [Blueprints](https://blueprints.launchpad.net/apparmor)
* Translations
* [Answers](https://answers.launchpad.net/apparmor)

# Translation overview

[Help for translations](https://help.launchpad.net/Translations)

### Translation details

Launchpad currently recommends translating
[AppArmor master series](/apparmor/master).

To see all the translation files that are waiting to be
imported, please look at
[AppArmor import queue](/apparmor/%2Bimports).

### Permissions

[AppArmor](https://launchpad.net/apparmor) is translated
by
[Launchpad Translators](/%2Bgroups/launchpad-translators)
with [Open](/%2Bhelp-translations/permissions-policies.html)
permissions.

### All translatable series

* [AppArmor master series](/apparmor/master/%2Btranslations)

### All translatable distribution packages

* [apparmor source package in Plucky](/ubuntu/plucky/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Oracular](/ubuntu/oracular/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Noble](/ubuntu/noble/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Mantic](/ubuntu/mantic/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Lunar](/ubuntu/lunar/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Kinetic](/ubuntu/kinetic/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Jammy](/ubuntu/jammy/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Impish](/ubuntu/impish/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Hirsute](/ubuntu/hirsute/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Groovy](/ubuntu/groovy/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Focal](/ubuntu/focal/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Eoan](/ubuntu/eoan/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Disco](/ubuntu/disco/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Cosmic](/ubuntu/cosmic/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Bionic](/ubuntu/bionic/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Artful](/ubuntu/artful/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Zesty](/ubuntu/zesty/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Yakkety](/ubuntu/yakkety/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Xenial](/ubuntu/xenial/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Wily](/ubuntu/wily/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Vivid](/ubuntu/vivid/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Utopic](/ubuntu/utopic/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in 14.09](/ubuntu-rtm/14.09/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Trusty](/ubuntu/trusty/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Saucy](/ubuntu/saucy/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Raring](/ubuntu/raring/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Quantal](/ubuntu/quantal/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Precise](/ubuntu/precise/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Oneiric](/ubuntu/oneiric/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Natty](/ubuntu/natty/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Maverick](/ubuntu/maverick/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Lucid](/ubuntu/lucid/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Karmic](/ubuntu/karmic/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Jaunty](/ubuntu/jaunty/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Intrepid](/ubuntu/intrepid/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Hardy](/ubuntu/hardy/%2Bsources/apparmor/%2Btranslations)
* [apparmor source package in Gutsy](/ubuntu/gutsy/%2Bsources/apparmor/%2Btranslations)

## Translation for master

| Language | Status | Untranslated | Needs review | Last Changed |
| --- | --- | --- | --- | --- |
| [Afrikaans](/apparmor/master/%2Blang/af) | 372 000.00  100.0% translated | 0 0 | 0 0 | 2023-01-29 16:16:41 2023-01-29 |
| [Albanian](/apparmor/master/%2Blang/sq) | 3 099.19  0.8064516129032258% translated  99.19354838709677% untranslated | 369 369 | 0 0 | 2013-11-14 23:20:27 2013-11-14 |
| [Arabic](/apparmor/master/%2Blang/ar) | 81 078.23  21.774193548387096% translated  78.2258064516129% untranslated | 291 291 | 0 0 | 2013-11-15 01:29:50 2013-11-15 |
| [Belarusian](/apparmor/master/%2Blang/be) | 0 100.00  100.0% untranslated | 372 372 | 6 6 | 2020-05-05 21:55:12 2020-05-05 |
| [Bengali](/apparmor/master/%2Blang/bn) | 36 090.32  9.67741935483871% translated  90.32258064516128% untranslated | 336 336 | 0 0 | 2013-11-15 01:37:45 2013-11-15 |
| [Bosnian](/apparmor/master/%2Blang/bs) | 31 091.67  8.333333333333332% translated  91.66666666666666% untranslated | 341 341 | 333 333 | 2014-05-01 19:36:57 2014-05-01 |
| [Brazilian Portuguese](/apparmor/master/%2Blang/pt_BR) | 372 000.00  100.0% translated | 0 0 | 0 0 | 2022-11-15 21:22:08 2022-11-15 |
| [Bulgarian](/apparmor/master/%2Blang/bg) | 0 100.00  100.0% untranslated | 372 372 | 0 0 | 2013-11-14 22:10:30 2013-11-14 |
| [Burmese](/apparmor/master/%2Blang/my) | 9 097.58  2.4193548387096775% translated  97.58064516129032% untranslated | 363 363 | 0 0 | 2022-06-26 11:50:09 2022-06-26 |
| [Catalan](/apparmor/master/%2Blang/ca) | 372 000.00  100.0% translated | 0 0 | 0 0 | 2024-09-15 05:07:06 2024-09-15 |
| [Chechen](/apparmor/master/%2Blang/ce) | 0 100.00  100.0% untranslated | 372 372 | 0 0 | 2014-08-13 08:08:58 2014-08-13 |
| [Chinese (Simplified)](/apparmor/master/%2Blang/zh_CN) | 329 011.56  88.44086021505376% translated  11.559139784946236% untranslated | 43 43 | 0 0 | 2022-08-25 04:53:11 2022-08-25 |
| [Chinese (Traditional)](/apparmor/master/%2Blang/zh_TW) | 81 078.23  21.774193548387096% translated  78.2258064516129% untranslated | 291 291 | 1 1 | 2013-11-15 02:42:58 2013-11-15 |
| [Croatian](/apparmor/master/%2Blang/hr) | 87 076.61  23.387096774193548% translated  76.61290322580645% untranslated | 285 285 | 2 2 | 2021-10-03 10:20:58 2021-10-03 |
| [Czech](/apparmor/master/%2Blang/cs) | 255 031.45  68.54838709677419% translated  31.451612903225808% untranslated | 117 117 | 0 0 | 2022-11-19 14:00:53 2022-11-19 |
| [Danish](/apparmor/master/%2Blang/da) | 81 078.23  21.774193548387096% translated  78.2258064516129% untranslated | 291 291 | 0 0 | 2013-11-15 02:33:26 2013-11-15 |
| [Dutch](/apparmor/master/%2Blang/nl) | 81 078.23  21.774193548387096% translated  78.2258064516129% untranslated | 291 291 | 0 0 | 2013-11-15 03:24:29 2013-11-15 |
| [English (Australia)](/apparmor/master/%2Blang/en_AU) | 0 100.00  100.0% untranslated | 372 372 | 151 151 | 2020-11-28 04:45:35 2020-11-28 |
| [English (Canada)](/apparmor/master/%2Blang/en_CA) | 9 097.58  2.4193548387096775% translated  97.58064516129032% untranslated | 363 363 | 3 3 | 2021-10-01 04:55:34 2021-10-01 |
| [English (United Kingdom)](/apparmor/master/%2Blang/en_GB) | 372 000.00  100.0% translated | 0 0 | 0 0 | 2017-02-26 19:25:31 2017-02-26 |
| [Estonian](/apparmor/master/%2Blang/et) | 36 090.32  9.67741935483871% translated  90.32258064516128% untranslated | 336 336 | 0 0 | 2023-07-04 08:52:58 2023-07-04 |
| [Finnish](/apparmor/master/%2Blang/fi) | 89 076.08  23.9247311827957% translated  76.0752688172043% untranslated | 283 283 | 1 1 | 2021-04-11 15:29:35 2021-04-11 |
| [French](/apparmor/master/%2Blang/fr) | 120 067.74  32.25806451612903% translated  67.74193548387096% untranslated | 252 252 | 58 58 | 2016-04-28 10:19:58 2016-04-28 |
| [Galician](/apparmor/master/%2Blang/gl) | 0 100.00  100.0% untranslated | 372 372 | 20 20 | 2020-04-21 14:59:30 2020-04-21 |
| [Georgian](/apparmor/master/%2Blang/ka) | 209 043.82  56.18279569892473% translated  43.81720430107527% untranslated | 163 163 | 0 0 | 2023-06-26 15:06:16 2023-06-26 |
| [German](/apparmor/master/%2Blang/de) | 372 000.00  100.0% translated | 0 0 | 0 0 | 2023-10-08 14:41:11 2023-10-08 |
| [Greek](/apparmor/master/%2Blang/el) | 56 084.95  15.053763440860216% translated  84.94623655913979% untranslated | 316 316 | 3 3 | 2013-11-15 01:42:48 2013-11-15 |
| [Gujarati](/apparmor/master/%2Blang/gu) | 36 090.32  9.67741935483871% translated  90.32258064516128% untranslated | 336 336 | 0 0 | 2013-11-15 02:03:50 2013-11-15 |
| [Hebrew](/apparmor/master/%2Blang/he) | 9 097.58  2.4193548387096775% translated  97.58064516129032% untranslated | 363 363 | 0 0 | 2023-10-05 05:12:31 2023-10-05 |
| [Hindi](/apparmor/master/%2Blang/hi) | 56 084.95  15.053763440860216% translated  84.94623655913979% untranslated | 316 316 | 5 5 | 2023-01-09 07:39:06 2023-01-09 |
| [Hungarian](/apparmor/master/%2Blang/hu) | 82 077.96  22.043010752688172% translated  77.95698924731182% untranslated | 290 290 | 0 0 | 2015-04-03 18:34:24 2015-04-03 |
| [Indonesian](/apparmor/master/%2Blang/id) | 369 000.81  99.19354838709677% translated  0.8064516129032258% untranslated | 3 3 | 3 3 | 2023-01-31 01:30:55 2023-01-31 |
| [Italian](/apparmor/master/%2Blang/it) | 330 011.29  88.70967741935483% translated  11.29032258064516% untranslated | 42 42 | 7 7 | 2023-01-29 16:22:14 2023-01-29 |
| [Japanese](/apparmor/master/%2Blang/ja) | 81 078.23  21.774193548387096% translated  78.2258064516129% untranslated | 291 291 | 0 0 | 2013-11-15 02:52:57 2013-11-15 |
| [Kabyle](/apparmor/master/%2Blang/kab) | 0 100.00  100.0% untranslated | 372 372 | 8 8 | 2020-04-29 14:31:17 2020-04-29 |
| [Khmer](/apparmor/master/%2Blang/km) | 81 078.23  21.774193548387096% translated  78.2258064516129% untranslated | 291 291 | 1 1 | 2013-11-15 02:34:53 2013-11-15 |
| [Korean](/apparmor/master/%2Blang/ko) | 82 077.96  22.043010752688172% translated  77.95698924731182% untranslated | 290 290 | 3 3 | 2013-11-20 22:28:52 2013-11-20 |
| [Lao](/apparmor/master/%2Blang/lo) | 0 100.00  100.0% untranslated | 372 372 | 0 0 | 2013-11-14 22:25:36 2013-11-14 |
| [Lithuanian](/apparmor/master/%2Blang/lt) | 23 093.82  6.182795698924731% translated  93.81720430107528% untranslated | 349 349 | 0 0 | 2013-11-15 03:03:08 2013-11-15 |
| [Macedonian](/apparmor/master/%2Blang/mk) | 0 100.00  100.0% untranslated | 372 372 | 0 0 | 2013-11-14 22:27:13 2013-11-14 |
| [Malay](/apparmor/master/%2Blang/ms) | 142 061.83  38.17204301075269% translated  61.82795698924731% untranslated | 230 230 | 0 0 | 2014-09-21 05:21:51 2014-09-21 |
| [Marathi](/apparmor/master/%2Blang/mr) | 36 090.32  9.67741935483871% translated  90.32258064516128% untranslated | 336 336 | 0 0 | 2013-11-15 02:17:21 2013-11-15 |
| [Norwegian Bokmal](/apparmor/master/%2Blang/nb) | 81 078.23  21.774193548387096% translated  78.2258064516129% untranslated | 291 291 | 0 0 | 2013-11-15 03:17:12 2013-11-15 |
| [Occitan (post 1500)](/apparmor/master/%2Blang/oc) | 17 095.43  4.56989247311828% translated  95.43010752688173% untranslated | 355 355 | 17 17 | 2021-01-30 17:50:28 2021-01-30 |
| [Persian](/apparmor/master/%2Blang/fa) | 48 087.10  12.903225806451612% translated  87.09677419354838% untranslated | 324 324 | 2 2 | 2023-12-31 16:22:42 2023-12-31 |
| [Polish](/apparmor/master/%2Blang/pl) | 103 072.31  27.688172043010752% translated  72.31182795698925% untranslated | 269 269 | 17 17 | 2021-07-22 20:10:54 2021-07-22 |
| [Portuguese](/apparmor/master/%2Blang/pt) | 171 054.03  45.96774193548387% translated  54.03225806451613% untranslated | 201 201 | 0 0 | 2022-11-23 23:42:35 2022-11-23 |
| [Punjabi](/apparmor/master/%2Blang/pa) | 41 088.98  11.021505376344086% translated  88.97849462365592% untranslated | 331 331 | 0 0 | 2013-11-15 03:31:27 2013-11-15 |
| [Romanian](/apparmor/master/%2Blang/ro) | 372 000.00  100.0% translated | 0 0 | 0 0 | 2024-09-23 23:32:52 2024-09-23 |
| [Russian](/apparmor/master/%2Blang/ru) | 277 025.54  74.46236559139786% translated  25.537634408602152% untranslated | 95 95 | 4 4 | 2024-12-03 12:04:42 2024-12-03 |
| [Serbian](/apparmor/master/%2Blang/sr) | 0 100.00  100.0% untranslated | 372 372 | 9 9 | 2020-11-23 18:06:01 2020-11-23 |
| [Sinhalese](/apparmor/master/%2Blang/si) | 0 100.00  100.0% untranslated | 372 372 | 0 0 | 2013-11-14 22:30:50 2013-11-14 |
| [Slovak](/apparmor/master/%2Blang/sk) | 0 100.00  100.0% untranslated | 372 372 | 0 0 | 2013-11-14 22:30:59 2013-11-14 |
| [Slovenian](/apparmor/master/%2Blang/sl) | 0 100.00  100.0% untranslated | 372 372 | 24 24 | 2013-11-14 22:00:25 2013-11-14 |
| [Spanish](/apparmor/master/%2Blang/es) | 292 021.51  78.49462365591397% translated  21.50537634408602% untranslated | 80 80 | 0 0 | 2024-10-09 22:44:10 2024-10-09 |
| [Swahili](/apparmor/master/%2Blang/sw) | 9 097.58  2.4193548387096775% translated  97.58064516129032% untranslated | 363 363 | 0 0 | 2019-11-14 12:33:09 2019-11-14 |
| [Swedish](/apparmor/master/%2Blang/sv) | 319 014.25  85.75268817204301% translated  14.24731182795699% untranslated | 53 53 | 3 3 | 2023-02-01 01:54:56 2023-02-01 |
| [Tamil](/apparmor/master/%2Blang/ta) | 36 090.32  9.67741935483871% translated  90.32258064516128% untranslated | 336 336 | 0 0 | 2013-11-15 03:28:46 2013-11-15 |
| [Thai](/apparmor/master/%2Blang/th) | 0 100.00  100.0% untranslated | 372 372 | 0 0 | 2013-11-14 22:31:52 2013-11-14 |
| [Tibetan](/apparmor/master/%2Blang/bo) | 0 100.00  100.0% untranslated | 372 372 | 0 0 | 2019-12-12 02:59:53 2019-12-12 |
| [Turkish](/apparmor/master/%2Blang/tr) | 70 081.18  18.817204301075268% translated  81.18279569892472% untranslated | 302 302 | 0 0 | 2022-04-25 20:47:30 2022-04-25 |
| [Ukrainian](/apparmor/master/%2Blang/uk) | 212 043.01  56.98924731182796% translated  43.01075268817204% untranslated | 160 160 | 160 160 | 2024-03-07 18:30:18 2024-03-07 |
| [Uyghur](/apparmor/master/%2Blang/ug) | 0 100.00  100.0% untranslated | 372 372 | 51 51 | 2015-11-28 12:40:57 2015-11-28 |
| [Vietnamese](/apparmor/master/%2Blang/vi) | 0 100.00  100.0% untranslated | 372 372 | 0 0 | 2013-11-14 22:32:21 2013-11-14 |
| [Walloon](/apparmor/master/%2Blang/wa) | 0 100.00  100.0% untranslated | 372 372 | 0 0 | 2013-11-14 22:32:29 2013-11-14 |
| [Welsh](/apparmor/master/%2Blang/cy) | 0 100.00  100.0% untranslated | 372 372 | 0 0 | 2013-11-14 22:14:18 2013-11-14 |
| [Xhosa](/apparmor/master/%2Blang/xh) | 36 090.32  9.67741935483871% translated  90.32258064516128% untranslated | 336 336 | 0 0 | 2013-11-15 04:04:43 2013-11-15 |
| [Zulu](/apparmor/master/%2Blang/zu) | 36 090.32  9.67741935483871% translated  90.32258064516128% untranslated | 336 336 | 0 0 | 2013-11-15 04:18:16 2013-11-15 |

[ [Change your preferred languages...](/%2Beditmylanguages)
—
View all languages
]

![Key to this table: “Unchanged” means](/@@/green-bar)
Translated

![and “untranslated” means just that,](/@@/red-bar)
Untranslated

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bazaar.launchpad.net_8ce30c42_20250125_134508.html ===


[← Back to branch summary](https://code.launchpad.net/~apparmor-dev/apparmor/master)
# ~apparmor-dev/apparmor/master

* [Changes](/~apparmor-dev/apparmor/master/changes "Changes")
* [Files](/~apparmor-dev/apparmor/master/files "Files")

[~apparmor-dev/apparmor/master](https://code.launchpad.net/~apparmor-dev/apparmor/master)
» Revision
3648

# Viewing all changes in revision 3648.

* [browse files at revision 3648](/~apparmor-dev/apparmor/master/files/3648 "browse files at revision 3648")
* [compare with another revision](/~apparmor-dev/apparmor/master/revision/3648?remember=3648 "compare with another revision")
* [download diff](/~apparmor-dev/apparmor/master/diff/3648)
* [download tarball](/~apparmor-dev/apparmor/master/tarball/3648)
* [view history from revision 3648](/~apparmor-dev/apparmor/master/changes/3648 "view history from revision 3648")

* **Committer:**
  Tyler Hicks
* **Date:**
  2017-03-24 05:08:01 UTC
* **Revision ID:**
  tyhicks@canonical.com-20170324050801-6p7c40m8d44ase9c

<https://launchpad.net/bugs/1668892>

utils:Â AddÂ aa-remove-unknownÂ utilityÂ toÂ unloadÂ unknownÂ profiles

https://launchpad.net/bugs/1668892

ThisÂ patchÂ createsÂ aÂ newÂ utility,Â withÂ theÂ codeÂ previouslyÂ usedÂ inÂ the
initÂ scriptÂ 'restart'Â action,Â thatÂ removesÂ unknownÂ profilesÂ whichÂ are
notÂ foundÂ inÂ /etc/apparmor.d/.Â TheÂ functionalityÂ wasÂ removedÂ fromÂ the
commonÂ initÂ scriptÂ codeÂ inÂ theÂ fixÂ forÂ CVE-2017-6507.

TheÂ newÂ utilityÂ printsÂ aÂ messageÂ containingÂ theÂ nameÂ ofÂ eachÂ unknown
profileÂ beforeÂ theÂ profilesÂ areÂ removed.Â ItÂ alsoÂ supportsÂ aÂ dryÂ runÂ mode
soÂ thatÂ anÂ administratorÂ canÂ checkÂ whichÂ profilesÂ willÂ beÂ removedÂ before
unloadingÂ anyÂ unknownÂ profiles.

IfÂ youÂ backportÂ thisÂ utilityÂ withÂ theÂ fixÂ forÂ CVE-2017-6507Â toÂ an
apparmorÂ 2.10Â releaseÂ andÂ yourÂ backportedÂ aa-remove-unknownÂ utilityÂ is
sourcingÂ theÂ upstreamÂ rc.apparmor.functionsÂ file,Â you'llÂ wantÂ toÂ include
theÂ followingÂ bugÂ fixÂ toÂ preventÂ theÂ aa-remove-unknownÂ utilityÂ from
removingÂ childÂ profilesÂ thatÂ itÂ shouldn'tÂ remove:

Â Â r3440Â -Â Fix:Â parser:Â incorrectÂ outputÂ ofÂ childÂ profileÂ names

Signed-off-by:Â TylerÂ HicksÂ <tyhicks@canonical.com>
Acked-by:Â SethÂ ArnoldÂ <seth.arnold@canonical.com>
Acked-by:Â JohnÂ JohansenÂ <john.johansen@canonical.com>

+ files added:
+ [utils/aa-remove-unknown](/~apparmor-dev/apparmor/master/revision/3648/utils/aa-remove-unknown#utils/aa-remove-unknown "View changes to utils/aa-remove-unknown in revision 3648")

+ [utils/aa-remove-unknown.pod](/~apparmor-dev/apparmor/master/revision/3648/utils/aa-remove-unknown.pod#utils/aa-remove-unknown.pod "View changes to utils/aa-remove-unknown.pod in revision 3648")

+ files modified:
+ [utils/Makefile](/~apparmor-dev/apparmor/master/revision/3648/utils/Makefile#utils/Makefile "View changes to utils/Makefile in revision 3648")

![expand all](/static/images/treeCollapsed.png) expand all

![collapse all](/static/images/treeExpanded.png) collapse all

Show diffs side-by-side

![added](/static/images/newCode.gif) added

![removed](/static/images/deleteCode.gif) removed

Lines of Context:

[![](/static/images/treeCollapsed.png)
utils/Makefile](/~apparmor-dev/apparmor/master/revision/3648/utils/Makefile "View changes to utils/Makefile only")

![](/static/images/spinner.gif)

[![](/static/images/treeCollapsed.png)
utils/aa-remove-unknown](/~apparmor-dev/apparmor/master/revision/3648/utils/aa-remove-unknown "View changes to utils/aa-remove-unknown only")

![](/static/images/spinner.gif)

[![](/static/images/treeCollapsed.png)
utils/aa-remove-unknown.pod](/~apparmor-dev/apparmor/master/revision/3648/utils/aa-remove-unknown.pod "View changes to utils/aa-remove-unknown.pod only")

![](/static/images/spinner.gif)

* [Older »](/~apparmor-dev/apparmor/master/revision/3730?start_revid=3731)

Loggerhead is a web-based interface for [Breezy](https://www.breezy-vcs.org/)

Version: 2.0.1



=== Content from bazaar.launchpad.net_9557c9aa_20250125_134507.html ===


[← Back to branch summary](https://code.launchpad.net/~apparmor-dev/apparmor/master)
# ~apparmor-dev/apparmor/master

* [Changes](/~apparmor-dev/apparmor/master/changes "Changes")
* [Files](/~apparmor-dev/apparmor/master/files "Files")

[~apparmor-dev/apparmor/master](https://code.launchpad.net/~apparmor-dev/apparmor/master)
» Revision
3647

# Viewing all changes in revision 3647.

* [browse files at revision 3647](/~apparmor-dev/apparmor/master/files/3647 "browse files at revision 3647")
* [compare with another revision](/~apparmor-dev/apparmor/master/revision/3647?remember=3647 "compare with another revision")
* [download diff](/~apparmor-dev/apparmor/master/diff/3647)
* [download tarball](/~apparmor-dev/apparmor/master/tarball/3647)
* [view history from revision 3647](/~apparmor-dev/apparmor/master/changes/3647 "view history from revision 3647")

* **Committer:**
  Tyler Hicks
* **Date:**
  2017-03-24 05:06:07 UTC
* **Revision ID:**
  tyhicks@canonical.com-20170324050607-wkix3sicygr1goe8

<https://launchpad.net/bugs/1668892>

parser:Â PreserveÂ unknownÂ profilesÂ whenÂ restartingÂ apparmorÂ init/job/unit

CVE-2017-6507

https://launchpad.net/bugs/1668892

TheÂ commonÂ AppArmorÂ 'restart'Â codeÂ usedÂ byÂ someÂ initÂ scripts,Â upstart
jobs,Â and/orÂ systemdÂ unitsÂ containedÂ functionalityÂ thatÂ isÂ noÂ longer
appropriateÂ toÂ retain.Â AnyÂ profilesÂ notÂ foundÂ /etc/apparmor.d/Â were
assumedÂ toÂ beÂ obsoleteÂ andÂ wereÂ unloaded.Â ThatÂ behaviorÂ became
problematicÂ nowÂ thatÂ there'sÂ aÂ growingÂ numberÂ ofÂ projectsÂ thatÂ maintain
theirÂ ownÂ internalÂ setÂ ofÂ AppArmorÂ profilesÂ outsideÂ ofÂ /etc/apparmor.d/.
ItÂ resultedÂ inÂ theÂ AppArmorÂ 'restart'Â codeÂ leavingÂ someÂ important
processesÂ runningÂ unconfined.Â AÂ coupleÂ examplesÂ areÂ profilesÂ managedÂ by
LXDÂ andÂ Docker.

Signed-off-by:Â TylerÂ HicksÂ <tyhicks@canonical.com>
Acked-by:Â SethÂ ArnoldÂ <seth.arnold@canonical.com>
Acked-by:Â JohnÂ JohansenÂ <john.johansen@canonical.com>

+ files modified:
+ [parser/rc.apparmor.functions](/~apparmor-dev/apparmor/master/revision/3647/parser/rc.apparmor.functions#parser/rc.apparmor.functions "View changes to parser/rc.apparmor.functions in revision 3647")

![expand all](/static/images/treeCollapsed.png) expand all

![collapse all](/static/images/treeExpanded.png) collapse all

Show diffs side-by-side

![added](/static/images/newCode.gif) added

![removed](/static/images/deleteCode.gif) removed

Lines of Context:

[![](/static/images/treeCollapsed.png)
parser/rc.apparmor.functions](/~apparmor-dev/apparmor/master/revision/3647/parser/rc.apparmor.functions "View changes to parser/rc.apparmor.functions only")

![](/static/images/spinner.gif)

* [Older »](/~apparmor-dev/apparmor/master/revision/3730?start_revid=3731)

Loggerhead is a web-based interface for [Breezy](https://www.breezy-vcs.org/)

Version: 2.0.1



=== Content from usn.ubuntu.com_9f73827e_20250126_090656.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3247-1: AppArmor vulnerability

28 March 2017

AppArmor could remove the confinement from some programs.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 16.10](/security/notices?release=yakkety)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [apparmor](/security/cves?package=apparmor) - Linux security system

## Details

Stéphane Graber discovered that AppArmor incorrectly unloaded some profiles

when restarted or upgraded, contrary to expected behavior.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 16.10

* [apparmor](https://launchpad.net/ubuntu/%2Bsource/apparmor)
  -
  [2.10.95-4ubuntu5.3](https://launchpad.net/ubuntu/%2Bsource/apparmor/2.10.95-4ubuntu5.3)

##### Ubuntu 16.04

* [apparmor](https://launchpad.net/ubuntu/%2Bsource/apparmor)
  -
  [2.10.95-0ubuntu2.6](https://launchpad.net/ubuntu/%2Bsource/apparmor/2.10.95-0ubuntu2.6)

##### Ubuntu 14.04

* [apparmor](https://launchpad.net/ubuntu/%2Bsource/apparmor)
  -
  [2.10.95-0ubuntu2.6~14.04.1](https://launchpad.net/ubuntu/%2Bsource/apparmor/2.10.95-0ubuntu2.6~14.04.1)

##### Ubuntu 12.04

* [apparmor](https://launchpad.net/ubuntu/%2Bsource/apparmor)
  -
  [2.7.102-0ubuntu3.11](https://launchpad.net/ubuntu/%2Bsource/apparmor/2.7.102-0ubuntu3.11)

After a standard system update you need to reboot your computer to make

all the necessary changes.

A new utility, called aa-remove-unknown, was added to assist with profiles that

would have been previously unloaded when AppArmor was restarted or upgraded.

## References

* [CVE-2017-6507](/security/CVE-2017-6507)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from launchpad.net_25015e6a_20250126_090639.html ===

[Log in / Register](https://launchpad.net/~stgraber/%2Blogin)

[![](https://launchpadlibrarian.net/7713533/hackergotchi.mini.png)](https://launchpad.net/~stgraber)

## [Stéphane Graber](https://launchpad.net/~stgraber)

* Overview
* [Code](https://code.launchpad.net/~stgraber)
* [Bugs](https://bugs.launchpad.net/~stgraber)
* [Blueprints](https://blueprints.launchpad.net/~stgraber)
* [Translations](https://translations.launchpad.net/~stgraber)
* [Answers](https://answers.launchpad.net/~stgraber)

Project leader for Linux Containers, Ubuntu Core developer and long time Ubuntu contributor.

Website: <http://www.stgraber.org>

* [Related packages](https://launchpad.net/~stgraber/%2Brelated-packages)
* [Related projects](https://launchpad.net/~stgraber/%2Brelated-projects)

## User information

Launchpad Id:
stgraber

Email:
[Log in](%2Blogin) for email information.

Member since:
2005-09-26

[![Icon of Bluetooth](https://launchpadlibrarian.net/4683649/stock_bluetooth.png "Member of Bluetooth")](/~bluetooth)
[![Icon of Edubuntu Developers](https://launchpadlibrarian.net/71879383/edubuntu-logo-only_14.png "Member of Edubuntu Developers")](/~edubuntu-dev)
[![Icon of Edubuntu Members](https://launchpadlibrarian.net/57014966/favicon.ico "Member of Edubuntu Members")](/~edubuntu-members)
[![Icon of GNOME3 Team](https://launchpadlibrarian.net/235731434/roundel14.png "Member of GNOME3 Team")](/~gnome3-team)
[![Icon of Indicator Applet Developers](https://launchpadlibrarian.net/22816053/add-notification-applet.14.png "Member of Indicator Applet Developers")](/~indicator-applet-developers)
[![Icon of Kubuntu Ninjas - Yellow belts](https://launchpadlibrarian.net/192173133/belt2-yellow3.png "Member of Kubuntu Ninjas - Yellow belts")](/~kubuntu-ninjas-yellow-belts)
[![Icon of Kubuntu Ninjas](https://launchpadlibrarian.net/31496145/icon.png "Member of Kubuntu Ninjas")](/~kubuntu-ninjas)
[![Icon of Kubuntu Package Archives](https://launchpadlibrarian.net/44411915/deb-small.png "Member of Kubuntu Package Archives")](/~kubuntu-ppa)
[![Icon of Launchpad Beta Testers](https://launchpadlibrarian.net/600856498/Canonical_Launchpad_icon_14px.png "Member of Launchpad Beta Testers")](/~launchpad-beta-testers)
[![Icon of Launchpad Users](https://launchpadlibrarian.net/600856618/Canonical_Launchpad_icon_14px.png "Member of Launchpad Users")](/~launchpad-users)
[![Icon of Lubuntu Code](https://launchpadlibrarian.net/704307155/lennyborg_14.png "Member of Lubuntu Code")](/~lubuntu-code)
[![Icon of Lubuntu Continuous Integration](https://launchpadlibrarian.net/704307325/lennyborg_14.png "Member of Lubuntu Continuous Integration")](/~lubuntu-ci)
[![Icon of Lubuntu Developers](https://launchpadlibrarian.net/704306355/lennyborg_14.png "Member of Lubuntu Developers")](/~lubuntu-dev)
[![Icon of Lubuntu Packages Team](https://launchpadlibrarian.net/704305879/lenny_bug_14.png "Member of Lubuntu Packages Team")](/~lubuntu-packaging)
[![Icon of Lubuntu](https://launchpadlibrarian.net/357050187/14.png "Member of Lubuntu")](/~lubuntu-desktop)
[![Icon of MOTU](https://launchpadlibrarian.net/1516491/motu-image-2.png "Member of MOTU")](/~motu)
[![Icon of Network-manager](https://launchpadlibrarian.net/11610188/nm-team.png "Member of Network-manager")](/~network-manager)
[![Icon of Not Canonical](https://launchpadlibrarian.net/71133712/not-canonical_aubergine_14.png "Member of Not Canonical")](/~not-canonical)
[![Icon of Pastebinit Developers](https://launchpadlibrarian.net/7079270/logo-tiny.png "Member of Pastebinit Developers")](/~pastebinit-developers)
[![Icon of Super Friends](https://launchpadlibrarian.net/134634591/superman14.png "Member of Super Friends")](/~super-friends)
[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)
[![Icon of Ubuntu Contributing Developers](https://launchpadlibrarian.net/17290192/wrench_emblem-trans.png "Member of Ubuntu Contributing Developers")](/~ubuntu-developer-members)
[![Icon of Ubuntu Core Development Team](https://launchpadlibrarian.net/1072365/main.png "Member of Ubuntu Core Development Team")](/~ubuntu-core-dev)
[![Icon of Ubuntu Development Team](https://launchpadlibrarian.net/1072363/motu.png "Member of Ubuntu Development Team")](/~ubuntu-dev)
[![Icon of Ubuntu Documentation Project Team](https://launchpadlibrarian.net/162165522/ubuntu-doc.png "Member of Ubuntu Documentation Project Team")](/~ubuntu-doc)
[![Icon of Ubuntu GNOME Developers](https://launchpadlibrarian.net/254356645/roundel14.png "Member of Ubuntu GNOME Developers")](/~ubuntu-gnome-dev)
[![Icon of Ubuntu GNOME](https://launchpadlibrarian.net/258611022/ubuntu-gnome_14.png "Member of Ubuntu GNOME")](/~ubuntu-gnome)
[![Icon of Ubuntu IRC Team](https://launchpadlibrarian.net/1741440/xchat.png "Member of Ubuntu IRC Team")](/~ubuntu-irc)
[![Icon of Ubuntu Kylin Members](https://launchpadlibrarian.net/444398797/623185830.jpg "Member of Ubuntu Kylin Members")](/~ubuntukylin-members)
[![Icon of Ubuntu LXC Security team](https://launchpadlibrarian.net/673452720/14.png "Member of Ubuntu LXC Security team")](/~ubuntu-lxc-security)
[![Icon of Ubuntu LXC team](https://launchpadlibrarian.net/202329400/14.png "Member of Ubuntu LXC team")](/~ubuntu-lxc)
[![Icon of Ubuntu MATE Developers](https://launchpadlibrarian.net/212349832/icon.png "Member of Ubuntu MATE Developers")](/~ubuntu-mate-dev)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu QA Website Developers](https://launchpadlibrarian.net/9926903/qat.14.png "Member of Ubuntu QA Website Developers")](/~ubuntu-qa-website-devel)
[![Icon of Ubuntu Sponsors](https://launchpadlibrarian.net/40794090/minitools.png "Member of Ubuntu Sponsors")](/~ubuntu-sponsors)
[![Icon of Ubuntu Studio Development](https://launchpadlibrarian.net/479050820/14.png "Member of Ubuntu Studio Development")](/~ubuntustudio-dev)
[![Icon of Xubuntu Artwork](https://launchpadlibrarian.net/341831649/icon_optimized_14.png "Member of Xubuntu Artwork")](/~xubuntu-art)
[![Icon of Xubuntu Developers](https://launchpadlibrarian.net/139019912/x-dev.png "Member of Xubuntu Developers")](/~xubuntu-dev)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English, French

OpenPGP keys:

602F567663E593BCBD14F338C638974D64792D67

SSH keys:

[cardno:000611576019](%2Bsshkeys)

Time zone:

America/Montreal
(UTC-0500)

Karma:
[256](https://launchpad.net/~stgraber/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**stgraber**
 on
**libera.chat**

![IRC](/@@/social-irc "IRC")
**stgraber**
 on
**oftc.net**

## [All bugs in progress](https://launchpad.net/~stgraber/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1959993 [SRU of LXC 4.0.12 to focal (upstream bugfix release)](https://bugs.launchpad.net/ubuntu/%2Bsource/lxc/%2Bbug/1959993) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

| --- | --- | --- | --- | --- | --- |

## [All assigned blueprints](/~stgraber/%2Bspecs?role=assignee) Assigned blueprints

| **[Networking improvements for Quantal (IPv6, DNS, Network Manager)](https://blueprints.launchpad.net/ubuntu/%2Bspec/foundations-q-networking "foundations-q-networking")** for **Ubuntu**  Catch all session (should be scheduled in a big slot if possible) for networking in Quantal. Discussing with Mathieu Trudel, we don't think there's enough to discuss this time around to warrant the usual 2-3 networking related sessions. If we're wrong, then we'll schedule another one. | |
| --- | --- |
| **[Generate a preseed file during Ubuntu installation](https://blueprints.launchpad.net/ubuntu/%2Bspec/foundations-q-autocreate-preseed "foundations-q-autocreate-preseed")** for **Ubuntu**  Customers are trying to place Ubuntu in their PXE environments for hands free automated installation, but they may not want to integrate MaaS in their current server dev (non-cloud) environment. To ease Ubuntu integration we should generate the preseed file during the manual install process so the user has the abil... | |
| **[Improvements to the ISO tracker and some build related scripts](https://blueprints.launchpad.net/ubuntu/%2Bspec/foundations-q-iso-tracker "foundations-q-iso-tracker")** for **Ubuntu**  Discussion of changes that would help: - release team with managing and publishing images, understanding the quality/shipability - qa teams (ubuntu and flavors) for understanding quality of images and issues for developers - testers ease of using system, logging results, automated logging, knowing bugs | |
| **[Future of Arkose and application sandboxing for Precise](https://blueprints.launchpad.net/ubuntu/%2Bspec/foundations-p-arkose "foundations-p-arkose")** for **Ubuntu**  Arkose has been entirely rewritten over the past 6 months and a lot of new features have been implemented. During this session, I'd like to talk about the next set of improvements for Arkose and where it can and should be integrated with the distro. Amongst changes I think are worth discussing in this session are: ... | |
| **[ISO/QA testing tracker improvements for Precise](https://blueprints.launchpad.net/ubuntu/%2Bspec/foundations-p-iso-tracker "foundations-p-iso-tracker")** for **Ubuntu**  The QA tracker at http://iso.qa.ubuntu.com has been around for quite a while now. It's in desperate need of some small changes to better work with the amount of testing Ubuntu requires nowadays. This session is meant to discuss what are the most important changes we need to make the tracker work better for the LTS.... | |

## Personal package archives

| [Stéphane Graber - build area](/~stgraber/%2Barchive/ubuntu/experimental) |
| --- |
| [Stéphane Graber - build area (devirtualized)](/~stgraber/%2Barchive/ubuntu/experimental-devirt) |
| [Stéphane Graber - OVN stable](/~stgraber/%2Barchive/ubuntu/ovn-stable) |
| [Stéphane Graber - stgraber.net](/~stgraber/%2Barchive/ubuntu/stgraber.net) |
| [Stéphane Graber - build area (backports enabled)](/~stgraber/%2Barchive/ubuntu/with-backports) |

## [All memberships](https://launchpad.net/~stgraber/%2Bparticipation) Latest memberships

| [cowsql](/~cowsql)  Joined on 2023-08-15 | |
| --- | --- |
| [Not Canonical](/~not-canonical)  Joined on 2023-07-09 | |
| [Ubuntu LXC Security team](/~ubuntu-lxc-security)  Joined on 2016-05-26 | |
| [Ubuntu LXC team](/~ubuntu-lxc)  Joined on 2011-07-22 | |

## [Recent activities](https://launchpad.net/~stgraber/%2Bkarma) Most active in

| [Ubuntu](/ubuntu) |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from blueprints.launchpad.net_1eb824cc_20250126_090637.html ===

[Log in / Register](https://blueprints.launchpad.net/apparmor/%2Blogin)

[![](https://launchpadlibrarian.net/378258639/apparmor-64x64.png)](https://launchpad.net/apparmor)

## [AppArmor](https://launchpad.net/apparmor)

* [Overview](https://launchpad.net/apparmor)
* [Code](https://code.launchpad.net/apparmor)
* [Bugs](https://bugs.launchpad.net/apparmor)
* Blueprints
* [Translations](https://translations.launchpad.net/apparmor)
* [Answers](https://answers.launchpad.net/apparmor)

# Blueprints for AppArmor

Show only blueprints containing:

| **1** → **1** of 1 result | First • Previous • **Next** • Last |
| --- | --- |

| Priority | Blueprint | Design | Delivery | Assignee | Series |
| --- | --- | --- | --- | --- | --- |
| 1 Undefined | [filenamepolicykit](/apparmor/%2Bspec/filenamepolicykit "Filename Policy Kit") | 5 New | 0 Unknown |  |  |

| **1** → **1** of 1 result | First • Previous • **Next** • Last |
| --- | --- |

* [Register a blueprint](https://blueprints.launchpad.net/apparmor/%2Baddspec)

* [List all blueprints](https://blueprints.launchpad.net/apparmor/%2Bspecs?show=all)
* [List documentation](https://blueprints.launchpad.net/apparmor/%2Bdocumentation)
* [Assignments](https://blueprints.launchpad.net/apparmor/%2Bassignments)
* [Register a blueprint](https://blueprints.launchpad.net/apparmor/%2Baddspec)
* [Register a meeting](https://blueprints.launchpad.net/sprints/%2Bnew "Register a developer sprint, summit, or gathering")

## [All blueprints](/apparmor) Latest blueprints

* [Filename Policy Kit](/apparmor/%2Bspec/filenamepolicykit)

  Registered
  on 2012-06-24

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from assets.ubuntu.com_9a4aab3c_20250126_090706.html ===
!8 @6meM�� 9Z�-?Qu)�t{���-(�D�-�ۢ�r����v� Ԥq�W���K��u3��Vm{<��[!�v{:(Y�9�
���ay�n8��p5��x6�n�E�d�w��u�Mw�ˏ�I��M���Ƕ ���"��(��r��m�
�3�����i����I ��^�j����u�/�B?3�sX�I��Wx4�Z�f�X�+��X��Q�B$��M{� ��G&!������$�Z�MȀ-�E�I0�j�B�
-���X�)S�G�!DY��\*U-!���AƜ"1:<:z&����݂�&AU����\*�]%))F�}BW+TE�l��(�aa�ťY�EI���j����Û�U�=oz

=== Content from answers.launchpad.net_483f477d_20250126_090637.html ===

[Log in / Register](https://answers.launchpad.net/apparmor/%2Blogin)

[![](https://launchpadlibrarian.net/378258639/apparmor-64x64.png)](https://launchpad.net/apparmor)

## [AppArmor](https://launchpad.net/apparmor)

* [Overview](https://launchpad.net/apparmor)
* [Code](https://code.launchpad.net/apparmor)
* [Bugs](https://bugs.launchpad.net/apparmor)
* [Blueprints](https://blueprints.launchpad.net/apparmor)
* [Translations](https://translations.launchpad.net/apparmor)
* Answers

# Questions for AppArmor

**Launchpad does not know where
AppArmor
tracks support requests.**

AppArmor questions are
tracked in:
[apparmor in Ubuntu](/ubuntu/%2Bsource/apparmor).

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_7869e038_20250125_134509.html ===

[Log in / Register](https://bugs.launchpad.net/apparmor/%2Bbug/1668892/%2Blogin)

[![](https://launchpadlibrarian.net/378258639/apparmor-64x64.png)](https://launchpad.net/apparmor)

## [AppArmor](https://launchpad.net/apparmor)

* [Overview](https://launchpad.net/apparmor)
* [Code](https://code.launchpad.net/apparmor)
* [Bugs](https://bugs.launchpad.net/apparmor)
* [Blueprints](https://blueprints.launchpad.net/apparmor)
* [Translations](https://translations.launchpad.net/apparmor)
* [Answers](https://answers.launchpad.net/apparmor)

# CVE-2017-6507: apparmor service restarts and package upgrades unload privately managed profiles

Bug #1668892 reported by
[Stéphane Graber](https://launchpad.net/~stgraber)
on 2017-03-01

[268](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [AppArmor](https://bugs.launchpad.net/apparmor) | Fix Released | Critical | [juan serven](https://launchpad.net/~juanserven) | [AppArmor 2.12](https://launchpad.net/apparmor/%2Bmilestone/2.12) |
|  | [2.10](https://bugs.launchpad.net/apparmor/2.10) | Fix Released | Undecided | Unassigned | [AppArmor 2.10.3](https://launchpad.net/apparmor/%2Bmilestone/2.10.3) |
|  | [2.11](https://bugs.launchpad.net/apparmor/2.11) | Fix Released | Undecided | Unassigned | [AppArmor 2.11.1](https://launchpad.net/apparmor/%2Bmilestone/2.11.1) |
|  | [2.9](https://bugs.launchpad.net/apparmor/2.9) | Fix Released | Undecided | Unassigned | [AppArmor 2.9.5](https://launchpad.net/apparmor/%2Bmilestone/2.9.5) |
|  | [apparmor (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor "Latest release: 4.1.0~beta1-0ubuntu4, uploaded to main on 2024-11-13 09:07:17.105612+00:00 by Matthias Klose (doko), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Critical | [Tyler Hicks](https://launchpad.net/~tyhicks) |  |

### Bug Description

Restarting the apparmor init script, upstart job, or systemd service has historically removed all loaded profiles unknown to the well-known profile locations. In upstream AppArmor terms, this is /etc/apparmor.d/ but Ubuntu also adds additional locations.

This behavior has previously caused a problem where libvirt-managed profiles would be unloaded upon "restarting AppArmor":

<https://launchpad.net/bugs/702774>

Stéphane Graber created this bug report after he noticed that the same behavior was causing similar problems with lxd-manager profiles.

In addition, AppArmor distro packaging may trigger an "AppArmor restart" when installing a new version of AppArmor, resulting in the same profile removal problem. This is true for the Debian/Ubuntu packaging.

The upstream AppArmor team has decided to remove this functionality from the AppArmor restart logic to prevent a similar issue happening with the next external project that needs to privately manage their own set of AppArmor profiles.

=== Original Bug Report ===

Apparmor package upgrades unloads all LXD apparmor profiles, making all LXD containers unconfined.

Example:

# Create an unprivileged and a privileged container

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ lxc launch ubuntu:16.04 c1

Creating c1

Starting c1

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ lxc launch ubuntu:16.04 c2 -c security.privileged=true

Creating c2

Starting c2

# Look at their apparmor profiles (expected values)

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ cat /proc/$(lxc info c1 | grep Pid | sed "s/Pid: //g")/attr/current

lxd-c1\_</var/lib/lxd>//&:lxd-c1\_<var-lib-lxd>://unconfined (enforce)

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ cat /proc/$(lxc info c2 | grep Pid | sed "s/Pid: //g")/attr/current

lxd-c2\_</var/lib/lxd>//&:lxd-c2\_<var-lib-lxd>://unconfined (enforce)

# Apply an apparmor upgrade

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ sudo apt upgrade

Reading package lists... Done

Building dependency tree

Reading state information... Done

Calculating upgrade... Done

The following packages will be upgraded:

  apparmor

1 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.

Need to get 493 kB of archives.

After this operation, 8,192 B of additional disk space will be used.

Do you want to continue? [Y/n]

Get:1 <http://us.archive.ubuntu.com/ubuntu> zesty/main amd64 apparmor amd64 2.11.0-2ubuntu1 [493 kB]

Fetched 493 kB in 0s (34.9 MB/s)

Preconfiguring packages ...

(Reading database ... 221457 files and directories currently installed.)

Preparing to unpack .../apparmor\_2.11.0-2ubuntu1\_amd64.deb ...

Unpacking apparmor (2.11.0-2ubuntu1) over (2.10.95-4ubuntu5.1) ...

Processing triggers for ureadahead (0.100.0-19) ...

Setting up apparmor (2.11.0-2ubuntu1) ...

Installing new version of config file /etc/apparmor.d/abstractions/X ...

Installing new version of config file /etc/apparmor.d/abstractions/authentication ...

Installing new version of config file /etc/apparmor.d/abstractions/base ...

Installing new version of config file /etc/apparmor.d/abstractions/dbus-session-strict ...

Installing new version of config file /etc/apparmor.d/abstractions/gnome ...

Installing new version of config file /etc/apparmor.d/abstractions/nameservice ...

Installing new version of config file /etc/apparmor.d/abstractions/php5 ...

Installing new version of config file /etc/apparmor.d/abstractions/samba ...

Installing new version of config file /etc/apparmor.d/abstractions/ssl\_certs ...

Installing new version of config file /etc/apparmor.d/abstractions/ssl\_keys ...

Installing new version of config file /etc/apparmor.d/abstractions/ubuntu-browsers ...

Installing new version of config file /etc/apparmor.d/abstractions/ubuntu-helpers ...

Installing new version of config file /etc/apparmor.d/abstractions/user-mail ...

update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults

Skipping profile in /etc/apparmor.d/disable: usr.sbin.rsyslogd

Skipping profile in /etc/apparmor.d/disable: usr.sbin.sssd

Processing triggers for systemd (232-18ubuntu1) ...

Processing triggers for man-db (2.7.6.1-1) ...

# And look at the now unconfined containers

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ cat /proc/$(lxc info c1 | grep Pid | sed "s/Pid: //g")/attr/current

unconfined//&:lxd-c1\_<var-lib-lxd>://unconfined

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ cat /proc/$(lxc info c2 | grep Pid | sed "s/Pid: //g")/attr/current

unconfined//&:lxd-c2\_<var-lib-lxd>://unconfined

# The LXD profiles are also entirely gone

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ ls /sys/kernel/security/apparmor/policy/profiles/ | grep lxd

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$

# And to confirm that apparmor is in fact gone

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ lxc exec c2 bash

root@c2:~# mount -t proc proc /mnt

root@c2:~# echo "|/usr/bin/touch /pwned" > /mnt/sys/kernel/core\_pattern

root@c2:~# sleep 30&

[1] 468

root@c2:~# kill -SIGSEGV $!

root@c2:~#

[1]+ Segmentation fault (core dumped) sleep 30

root@c2:~# exit

stgraber@dakara:~/data/code/lxc/lxd (stgraber/master)$ ls -lh /pwned

-rw-rw-rw- 1 root root 0 Mar 1 03:37 /pwned

This was originally reported (though not as a security issue) here: <https://github.com/lxc/lxd/issues/2981>

See [original description](comments/0)

Tags:

[patch](/apparmor/%2Bbugs?field.tag=patch)

## Related branches

[lp:apparmor/2.12](https://code.launchpad.net/~apparmor-dev/apparmor/master)

[lp:~apparmor-dev/apparmor/apparmor-ubuntu-citrain](https://code.launchpad.net/~apparmor-dev/apparmor/apparmor-ubuntu-citrain)

[lp:apparmor/2.10](https://code.launchpad.net/~apparmor-dev/apparmor/2.10)

[lp:apparmor/2.9](https://code.launchpad.net/~apparmor-dev/apparmor/2.9)

## CVE References

* [2017-6507](/bugs/cve/2017-6507 "An issue was discovered in AppArmor b...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Stéphane Graber (stgraber)](https://launchpad.net/~stgraber) wrote on 2017-03-01: |  |  | [#1](/apparmor/%2Bbug/1668892/comments/1) |
| --- | --- | --- | --- |

Subscribed the LXC security team, mostly for awareness if we get more such reports from users.

Subscribed the LXC security team, mostly for awareness if we get more such reports from users.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Stéphane Graber (stgraber)](https://launchpad.net/~stgraber) wrote on 2017-03-01: |  |  | [#2](/apparmor/%2Bbug/1668892/comments/2) |
| --- | --- | --- | --- |

The LXD profiles are still available on disk in /var/lib/lxd/security/apparmor but I'm not sure we'll be able to easily fix all those processes that now got relabeled...

It may be simpler for the advisory to recommend all LXD users restart all their containers which will get LXD to regenerate and load the apparmor profile.

Something like "sudo lxd shutdown && sudo lxd activateifneeded" should do the trick, though note that having a maintainer script do so isn't a good idea as it'd be equivalent to having a maintainer script issuing random "reboot" commands to remote hosts.

The LXD profiles are still available on disk in /var/lib/lxd/security/apparmor but I'm not sure we'll be able to easily fix all those processes that now got relabeled...
It may be simpler for the advisory to recommend all LXD users restart all their containers which will get LXD to regenerate and load the apparmor profile.
Something like "sudo lxd shutdown && sudo lxd activateifneeded" should do the trick, though note that having a maintainer script do so isn't a good idea as it'd be equivalent to having a maintainer script issuing random "reboot" commands to remote hosts.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-03: |  |  | [#3](/apparmor/%2Bbug/1668892/comments/3) |
| --- | --- | --- | --- |

The way that I plan to address this is by removing the calls to unload\_obsolete\_profiles() in the apparmor postinst and init script/upstart job/systemd unit.

I've prepared untested security updates for all releases and will test them early next week.

The way that I plan to address this is by removing the calls to unload\_obsolete\_profiles() in the apparmor postinst and init script/upstart job/systemd unit.
I've prepared untested security updates for all releases and will test them early next week.

| Changed in apparmor (Ubuntu): | |
| --- | --- |
| **status**: | New → In Progress |
| **assignee**: | nobody → Tyler Hicks (tyhicks) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-08: |  |  | [#4](/apparmor/%2Bbug/1668892/comments/4) |
| --- | --- | --- | --- |

This is CVE-2017-6507

This is CVE-2017-6507

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-11: |  |  | [#5](/apparmor/%2Bbug/1668892/comments/5) |
| --- | --- | --- | --- |

* [0001-parser-Preserve-unknown-profiles-when-restarting-app.patch](https://bugs.launchpad.net/apparmor/%2Bbug/1668892/%2Battachment/4835672/%2Bfiles/0001-parser-Preserve-unknown-profiles-when-restarting-app.patch)
  [Edit](/apparmor/%2Bbug/1668892/%2Battachment/4835672)
  (2.3 KiB,
  text/plain)

This patch is the actual CVE fix. It simply removes the functionality. A followup patch will be posted that adds a small utility that contains the old functionality for administrators that depend on it.

This patch is the actual CVE fix. It simply removes the functionality. A followup patch will be posted that adds a small utility that contains the old functionality for administrators that depend on it.

| Changed in apparmor: | |
| --- | --- |
| **status**: | New → In Progress |
| **importance**: | Undecided → Critical |
| **assignee**: | nobody → Tyler Hicks (tyhicks) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-11: |  |  | [#6](/apparmor/%2Bbug/1668892/comments/6) |
| --- | --- | --- | --- |

* [0002-utils-Add-aa-remove-unknown-utility-to-unload-unknow.patch](https://bugs.launchpad.net/apparmor/%2Bbug/1668892/%2Battachment/4835673/%2Bfiles/0002-utils-Add-aa-remove-unknown-utility-to-unload-unknow.patch)
  [Edit](/apparmor/%2Bbug/1668892/%2Battachment/4835673)
  (6.4 KiB,
  text/plain)

This patch adds the helper utility.

This patch adds the helper utility.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Boltz (cboltz)](https://launchpad.net/~cboltz) wrote on 2017-03-12: |  |  | [#7](/apparmor/%2Bbug/1668892/comments/7) |
| --- | --- | --- | --- |

aa-remove-unknown:

...

+ else

+ echo "Removing '${profile}'"

+ echo -n "$profile" > "${REMOVE}"

+ fi

+ done

+

+# will not catch all errors, but still better than nothing

+exit $?

I slightly disagree with the "better than nothing" part ;-)

If I didn't miss something, the only thing that could go wrong is

+ echo -n "$profile" > "${REMOVE}"

It would be much better to use something like

+ echo -n "$profile" > "${REMOVE}" || failure=1

...

exit $failure

(obviously, also initialize failure=0 before the loop)

aa-remove-unknown:
...
+ else
+ echo "Removing '${profile}'"
+ echo -n "$profile" > "${REMOVE}"
+ fi
+ done
+
+# will not catch all errors, but still better than nothing
+exit $?
I slightly disagree with the "better than nothing" part ;-)
If I didn't miss something, the only thing that could go wrong is
+ echo -n "$profile" > "${REMOVE}"
It would be much better to use something like
+ echo -n "$profile" > "${REMOVE}" || failure=1
...
exit $failure
(obviously, also initialize failure=0 before the loop)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-13:  [**Re: [Bug 1668892] Re: apparmor package upgrades unload all LXD profiles**](/apparmor/%2Bbug/1668892/comments/8) |  |  | [#8](/apparmor/%2Bbug/1668892/comments/8) |
| --- | --- | --- | --- |

On 03/12/2017 09:22 AM, Christian Boltz wrote:

> aa-remove-unknown:

> ...

> + else

> + echo "Removing '${profile}'"

> + echo -n "$profile" > "${REMOVE}"

> + fi

> + done

> +

> +# will not catch all errors, but still better than nothing

> +exit $?

>

> I slightly disagree with the "better than nothing" part ;-)

>

> If I didn't miss something, the only thing that could go wrong is

> + echo -n "$profile" > "${REMOVE}"

There's much more that could go wrong. To name a few:

1) Things could go wrong in the profiles\_names\_list() function

2) Things could go wrong while executing the awk and/or sort binaries

3) Things could go wrong in the awk script itself

Since all of that goop is piped together, none of those errors would be

caught. IMO, It is some pretty bad code that needs to be improved

outside of this security bug.

The reason I don't feel like it needs to be fixed at the same time as

this security bug is because it should fail safely. In other words,

failing would mean that processes are left confined rather than unconfined.

> It would be much better to use something like

> + echo -n "$profile" > "${REMOVE}" || failure=1

> ...

> exit $failure

>

> (obviously, also initialize failure=0 before the loop)

I agree that it would be better. I'll include an updated patch. Thanks

for the review!

On 03/12/2017 09:22 AM, Christian Boltz wrote:
> aa-remove-unknown:
> ...
> + else
> + echo "Removing '${profile}'"
> + echo -n "$profile" > "${REMOVE}"
> + fi
> + done
> +
> +# will not catch all errors, but still better than nothing
> +exit $?
>
> I slightly disagree with the "better than nothing" part ;-)
>
> If I didn't miss something, the only thing that could go wrong is
> + echo -n "$profile" > "${REMOVE}"
There's much more that could go wrong. To name a few:
1) Things could go wrong in the profiles\_names\_list() function
2) Things could go wrong while executing the awk and/or sort binaries
3) Things could go wrong in the awk script itself
Since all of that goop is piped together, none of those errors would be
caught. IMO, It is some pretty bad code that needs to be improved
outside of this security bug.
The reason I don't feel like it needs to be fixed at the same time as
this security bug is because it should fail safely. In other words,
failing would mean that processes are left confined rather than unconfined.
> It would be much better to use something like
> + echo -n "$profile" > "${REMOVE}" || failure=1
> ...
> exit $failure
>
> (obviously, also initialize failure=0 before the loop)
I agree that it would be better. I'll include an updated patch. Thanks
for the review!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Boltz (cboltz)](https://launchpad.net/~cboltz) wrote on 2017-03-14:  [**Re: apparmor package upgrades unload all LXD profiles**](/apparmor/%2Bbug/1668892/comments/9) |  |  | [#9](/apparmor/%2Bbug/1668892/comments/9) |
| --- | --- | --- | --- |

> Since all of that goop is piped together,

... you should "set -o pipefail" ;-)

> Since all of that goop is piped together,
... you should "set -o pipefail" ;-)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-14:  [**Re: [Bug 1668892] Re: apparmor package upgrades unload all LXD profiles**](/apparmor/%2Bbug/1668892/comments/10) |  |  | [#10](/apparmor/%2Bbug/1668892/comments/10) |
| --- | --- | --- | --- |

On 03/14/2017 01:14 PM, Christian Boltz wrote:

>> Since all of that goop is piped together,

>

> ... you should "set -o pipefail" ;-)

Not possible with POSIX shell. We can save all of these enhancements for

after these CVE fixes land and before the next upstream release.

On 03/14/2017 01:14 PM, Christian Boltz wrote:
>> Since all of that goop is piped together,
>
> ... you should "set -o pipefail" ;-)
Not possible with POSIX shell. We can save all of these enhancements for
after these CVE fixes land and before the next upstream release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Boltz (cboltz)](https://launchpad.net/~cboltz) wrote on 2017-03-15:  [**Re: apparmor package upgrades unload all LXD profiles**](/apparmor/%2Bbug/1668892/comments/11) |  |  | [#11](/apparmor/%2Bbug/1668892/comments/11) |
| --- | --- | --- | --- |

I'd argue that requiring /bin/bash shouldn't be a real problem, but I'm aware that you try to use /bin/sh whenever possible.

Completely different question: does this bug only affect Ubuntu, or is a similar fix needed in rc.apparmor.functions? (\_\_apparmor\_restart() has code to unload unknown profiles)

I'd argue that requiring /bin/bash shouldn't be a real problem, but I'm aware that you try to use /bin/sh whenever possible.
Completely different question: does this bug only affect Ubuntu, or is a similar fix needed in rc.apparmor.functions? (\_\_apparmor\_restart() has code to unload unknown profiles)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-15:  [**Re: [Bug 1668892] Re: apparmor package upgrades unload all LXD profiles**](/apparmor/%2Bbug/1668892/comments/12) |  |  | [#12](/apparmor/%2Bbug/1668892/comments/12) |
| --- | --- | --- | --- |

On 03/15/2017 01:26 PM, Christian Boltz wrote:

> I'd argue that requiring /bin/bash shouldn't be a real problem, but I'm

> aware that you try to use /bin/sh whenever possible.

It shouldn't but I don't feel comfortable switching between the two

shells when this is supposed to be a minimal change.

> Completely different question: does this bug only affect Ubuntu, or is a

> similar fix needed in rc.apparmor.functions? (\_\_apparmor\_restart() has

> code to unload unknown profiles)

Upstream is affected. The only patches that I've attached so far are for

the upstream project.

The Ubuntu/Debian-specific init code is also affected and I'm working on

patches for that now.

Can you tell me if openSUSE is affected by this bug? A quick test is to do

$ echo "profile test {}" | sudo apparmor\_parser -qr

$ sudo grep "test (enforce)" /sys/kernel/security/apparmor/profiles

test (enforce)

$ # do whateveris required to restart the apparmor init script/upstart

$ # job/systemd unit that your distro uses

$ sudo grep "test (enforce)" /sys/kernel/security/apparmor/profiles

test (enforce)

If the test profile is still loaded, you're not affected. If it was

unloaded, you're affected.

On 03/15/2017 01:26 PM, Christian Boltz wrote:
> I'd argue that requiring /bin/bash shouldn't be a real problem, but I'm
> aware that you try to use /bin/sh whenever possible.
It shouldn't but I don't feel comfortable switching between the two
shells when this is supposed to be a minimal change.
> Completely different question: does this bug only affect Ubuntu, or is a
> similar fix needed in rc.apparmor.functions? (\_\_apparmor\_restart() has
> code to unload unknown profiles)
Upstream is affected. The only patches that I've attached so far are for
the upstream project.
The Ubuntu/Debian-specific init code is also affected and I'm working on
patches for that now.
Can you tell me if openSUSE is affected by this bug? A quick test is to do
$ echo "profile test {}" | sudo apparmor\_parser -qr
$ sudo grep "test (enforce)" /sys/kernel/security/apparmor/profiles
test (enforce)
$ # do whateveris required to restart the apparmor init script/upstart
$ # job/systemd unit that your distro uses
$ sudo grep "test (enforce)" /sys/kernel/security/apparmor/profiles
test (enforce)
If the test profile is still loaded, you're not affected. If it was
unloaded, you're affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Boltz (cboltz)](https://launchpad.net/~cboltz) wrote on 2017-03-16:  [**Re: apparmor package upgrades unload all LXD profiles**](/apparmor/%2Bbug/1668892/comments/13) |  |  | [#13](/apparmor/%2Bbug/1668892/comments/13) |
| --- | --- | --- | --- |

Testing confirmed what I expected from reading rc.apparmor.functions \_\_apparmor\_restart() - the test profile gets unloaded on "rcapparmor reload".

Testing confirmed what I expected from reading rc.apparmor.functions \_\_apparmor\_restart() - the test profile gets unloaded on "rcapparmor reload".

[Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks)
on 2017-03-23

| **summary**: | - apparmor package upgrades unload all LXD profiles+ apparmor package upgrades unload privately managed profiles |
| --- | --- |
| **summary**: | - apparmor package upgrades unload privately managed profiles+ CVE-2017-6507: apparmor package upgrades unload privately managed+ profiles |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-23:  [**Re: CVE-2017-6507: apparmor package upgrades unload privately managed profiles**](/apparmor/%2Bbug/1668892/comments/14) |  |  | [#14](/apparmor/%2Bbug/1668892/comments/14) |
| --- | --- | --- | --- |

I'm making this bug public since this behavior is not attacker-controlled. It is controlled by the system administrator and the distro package maintainer(s) for AppArmor.

I'm making this bug public since this behavior is not attacker-controlled. It is controlled by the system administrator and the distro package maintainer(s) for AppArmor.

| **description**: | updated |
| --- | --- |
| **information type**: | Private Security → Public Security |

[Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks)
on 2017-03-23

| **summary**: | - CVE-2017-6507: apparmor package upgrades unload privately managed- profiles+ CVE-2017-6507: apparmor service restarts and package upgrades unload+ privately managed profiles |
| --- | --- |

[Ubuntu Foundations Team Bug Bot (crichton)](https://launchpad.net/~crichton)
on 2017-03-24

| **tags**: | added: patch |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-03-24: |  |  | [#15](/apparmor/%2Bbug/1668892/comments/15) |
| --- | --- | --- | --- |

The fixes have been committed to the master branch:

<http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3647>

<http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3648>

The fixes have been committed to the master branch:
http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3647
http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3648

| Changed in apparmor: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |
| **milestone**: | none → 2.12 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2017-03-24: |  |  | [#16](/apparmor/%2Bbug/1668892/comments/16) |
| --- | --- | --- | --- |

This bug was fixed in the package apparmor - 2.11.0-2ubuntu3

---------------

apparmor (2.11.0-2ubuntu3) zesty; urgency=medium

\* SECURITY UPDATE: Don't unload unknown profiles during package

    configuration or when restarting the apparmor init script, upstart job, or

    systemd unit as this could leave processes unconfined (LP: [#1668892](/bugs/1668892))

    - debian/apparmor.postinst, debian/apparmor.init, debian/apparmor.upstart:

      Remove calls to unload\_obsolete\_profiles()

    - debian/patches/utils-add-aa-remove-unknown.patch,

      debian/apparmor.install debian/apparmor.manpages: Include a new utility,

      aa-remove-unknown, which can be used to unload unknown profiles. Based

      on an upstream patch but adjusted to source the /lib/apparmor/functions

      shipped in Debian/Ubuntu.

    - CVE-2017-6507

  \* debian/patches/r3645-profiles-update-nvidia-abstraction.patch: Update

    nvidia abstraction for newer nvidia drivers (LP: [#1590561](/bugs/1590561))

-- Tyler Hicks <email address hidden> Fri, 24 Mar 2017 05:26:28 +0000

This bug was fixed in the package apparmor - 2.11.0-2ubuntu3
---------------
apparmor (2.11.0-2ubuntu3) zesty; urgency=medium
\* SECURITY UPDATE: Don't unload unknown profiles during package
configuration or when restarting the apparmor init script, upstart job, or
systemd unit as this could leave processes unconfined (LP: #1668892)
- debian/apparmor.postinst, debian/apparmor.init, debian/apparmor.upstart:
Remove calls to unload\_obsolete\_profiles()
- debian/patches/utils-add-aa-remove-unknown.patch,
debian/apparmor.install debian/apparmor.manpages: Include a new utility,
aa-remove-unknown, which can be used to unload unknown profiles. Based
on an upstream patch but adjusted to source the /lib/apparmor/functions
shipped in Debian/Ubuntu.
- CVE-2017-6507
\* debian/patches/r3645-profiles-update-nvidia-abstraction.patch: Update
nvidia abstraction for newer nvidia drivers (LP: #1590561)
-- Tyler Hicks <tyhicks@canonical.com> Fri, 24 Mar 2017 05:26:28 +0000

| Changed in apparmor (Ubuntu): | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[John Johansen (jjohansen)](https://launchpad.net/~jjohansen)
on 2017-10-19

| Changed in apparmor: | |
| --- | --- |
| **status**: | Fix Committed → Won't Fix |
| **status**: | Won't Fix → Fix Committed |

[Christian Boltz (cboltz)](https://launchpad.net/~cboltz)
on 2018-04-22

| Changed in apparmor: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

[juan serven (juanserven)](https://launchpad.net/~juanserven)
on 2019-11-08

| Changed in apparmor: | |
| --- | --- |
| **assignee**: | Tyler Hicks (tyhicks) → juan serven (juanserven) |

[See full activity log](https://bugs.launchpad.net/apparmor/%2Bbug/1668892/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/apparmor/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/apparmor/%2Bbug/1668892/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/apparmor/%2Bbug/1668892/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/apparmor/%2Bbug/1668892/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0001-parser-Preserve-unknown-profiles-when-restarting-app.patch](https://bugs.launchpad.net/apparmor/%2Bbug/1668892/%2Battachment/4835672/%2Bfiles/0001-parser-Preserve-unknown-profiles-when-restarting-app.patch)
  [Edit](/apparmor/%2Bbug/1668892/%2Battachment/4835672 "Change patch details")
* [0002-utils-Add-aa-remove-unknown-utility-to-unload-unknow.patch](https://bugs.launchpad.net/apparmor/%2Bbug/1668892/%2Battachment/4835673/%2Bfiles/0002-utils-Add-aa-remove-unknown-utility-to-unload-unknow.patch)
  [Edit](/apparmor/%2Bbug/1668892/%2Battachment/4835673 "Change patch details")

* [Add patch](/apparmor/%2Bbug/1668892/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_176c806f_20250126_090636.html ===

[Log in / Register](https://launchpad.net/~tyhicks/%2Blogin)

[![](https://launchpadlibrarian.net/83129119/tyhicks-small.png)](https://launchpad.net/~tyhicks)

## [Tyler Hicks](https://launchpad.net/~tyhicks)

* Overview
* [Code](https://code.launchpad.net/~tyhicks)
* [Bugs](https://bugs.launchpad.net/~tyhicks)
* [Blueprints](https://blueprints.launchpad.net/~tyhicks)
* [Translations](https://translations.launchpad.net/~tyhicks)
* [Answers](https://answers.launchpad.net/~tyhicks)

* [Related packages](https://launchpad.net/~tyhicks/%2Brelated-packages)
* [Related projects](https://launchpad.net/~tyhicks/%2Brelated-projects)

## User information

Launchpad Id:
tyhicks

Email:
[Log in](%2Blogin) for email information.

Member since:
2008-10-03

[![Icon of AppArmor Developers](https://launchpadlibrarian.net/65472736/toxie-14.png "Member of AppArmor Developers")](/~apparmor-dev)
[![Icon of Bluetooth](https://launchpadlibrarian.net/4683649/stock_bluetooth.png "Member of Bluetooth")](/~bluetooth)
[![Icon of eCryptfs](https://launchpadlibrarian.net/88108046/ecryptfs_14.png "Member of eCryptfs")](/~ecryptfs)
[![Icon of Edubuntu Developers](https://launchpadlibrarian.net/71879383/edubuntu-logo-only_14.png "Member of Edubuntu Developers")](/~edubuntu-dev)
[![Icon of GNOME3 Team](https://launchpadlibrarian.net/235731434/roundel14.png "Member of GNOME3 Team")](/~gnome3-team)
[![Icon of Indicator Applet Developers](https://launchpadlibrarian.net/22816053/add-notification-applet.14.png "Member of Indicator Applet Developers")](/~indicator-applet-developers)
[![Icon of Kubuntu Ninjas - Yellow belts](https://launchpadlibrarian.net/192173133/belt2-yellow3.png "Member of Kubuntu Ninjas - Yellow belts")](/~kubuntu-ninjas-yellow-belts)
[![Icon of Kubuntu Ninjas](https://launchpadlibrarian.net/31496145/icon.png "Member of Kubuntu Ninjas")](/~kubuntu-ninjas)
[![Icon of Kubuntu Package Archives](https://launchpadlibrarian.net/44411915/deb-small.png "Member of Kubuntu Package Archives")](/~kubuntu-ppa)
[![Icon of Lubuntu Code](https://launchpadlibrarian.net/704307155/lennyborg_14.png "Member of Lubuntu Code")](/~lubuntu-code)
[![Icon of Lubuntu Continuous Integration](https://launchpadlibrarian.net/704307325/lennyborg_14.png "Member of Lubuntu Continuous Integration")](/~lubuntu-ci)
[![Icon of Lubuntu Developers](https://launchpadlibrarian.net/704306355/lennyborg_14.png "Member of Lubuntu Developers")](/~lubuntu-dev)
[![Icon of Lubuntu Packages Team](https://launchpadlibrarian.net/704305879/lenny_bug_14.png "Member of Lubuntu Packages Team")](/~lubuntu-packaging)
[![Icon of Lubuntu](https://launchpadlibrarian.net/357050187/14.png "Member of Lubuntu")](/~lubuntu-desktop)
[![Icon of MOTU](https://launchpadlibrarian.net/1516491/motu-image-2.png "Member of MOTU")](/~motu)
[![Icon of Network-manager](https://launchpadlibrarian.net/11610188/nm-team.png "Member of Network-manager")](/~network-manager)
[![Icon of Super Friends](https://launchpadlibrarian.net/134634591/superman14.png "Member of Super Friends")](/~super-friends)
[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)
[![Icon of Ubuntu Contributing Developers](https://launchpadlibrarian.net/17290192/wrench_emblem-trans.png "Member of Ubuntu Contributing Developers")](/~ubuntu-developer-members)
[![Icon of Ubuntu Core Development Team](https://launchpadlibrarian.net/1072365/main.png "Member of Ubuntu Core Development Team")](/~ubuntu-core-dev)
[![Icon of Ubuntu Development Team](https://launchpadlibrarian.net/1072363/motu.png "Member of Ubuntu Development Team")](/~ubuntu-dev)
[![Icon of Ubuntu Documentation Project Team](https://launchpadlibrarian.net/162165522/ubuntu-doc.png "Member of Ubuntu Documentation Project Team")](/~ubuntu-doc)
[![Icon of Ubuntu GNOME Developers](https://launchpadlibrarian.net/254356645/roundel14.png "Member of Ubuntu GNOME Developers")](/~ubuntu-gnome-dev)
[![Icon of Ubuntu GNOME](https://launchpadlibrarian.net/258611022/ubuntu-gnome_14.png "Member of Ubuntu GNOME")](/~ubuntu-gnome)
[![Icon of Ubuntu Kylin Members](https://launchpadlibrarian.net/444398797/623185830.jpg "Member of Ubuntu Kylin Members")](/~ubuntukylin-members)
[![Icon of Ubuntu MATE Developers](https://launchpadlibrarian.net/212349832/icon.png "Member of Ubuntu MATE Developers")](/~ubuntu-mate-dev)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Studio Development](https://launchpadlibrarian.net/479050820/14.png "Member of Ubuntu Studio Development")](/~ubuntustudio-dev)
[![Icon of Xubuntu Artwork](https://launchpadlibrarian.net/341831649/icon_optimized_14.png "Member of Xubuntu Artwork")](/~xubuntu-art)
[![Icon of Xubuntu Developers](https://launchpadlibrarian.net/139019912/x-dev.png "Member of Xubuntu Developers")](/~xubuntu-dev)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

CE1D6FE48F85F246C77C3516AD3F818B34FA35B7

SSH keys:

[tyhicks@elm - Canonical](%2Bsshkeys)

[tyhicks@sec - Canonical](%2Bsshkeys)

[tyhicks@boyd - Canonical](%2Bsshkeys)

Time zone:

America/Chicago
(UTC-0600)

Karma:
[0](https://launchpad.net/~tyhicks/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**tyhicks**
 on
**irc.oftc.net**

![IRC](/@@/social-irc "IRC")
**tyhicks**
 on
**irc.libera.chat**

## [All bugs in progress](https://launchpad.net/~tyhicks/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1379536 [Coarse-grained kernel keyring mediation](https://bugs.launchpad.net/apparmor/%2Bbug/1379536) |  |
| --- | --- | --- |
| in [AppArmor](/apparmor), [Ubuntu](/ubuntu) | | |

| --- | --- | --- | --- | --- | --- |
||  | #842647 [[git] file blocks duplicated at the end of the file](https://bugs.launchpad.net/ecryptfs/%2Bbug/842647) |  |
| --- | --- | --- |
| in [eCryptfs](/ecryptfs), [Ubuntu](/ubuntu) | | |

||  | #1501913 [Apparmor Abstraction Prevents Firefox From Opening Torrents in Deluge-Gtk](https://bugs.launchpad.net/apparmor/%2Bbug/1501913) |  |
| --- | --- | --- |
| in [AppArmor](/apparmor), [Ubuntu](/ubuntu) | | |

||  | #1439849 [BUG: unable to handle kernel NULL pointer dereference at 0000000000000010](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1439849) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

## [All assigned blueprints](/~tyhicks/%2Bspecs?role=assignee) Assigned blueprints

| **[User data encryption requirements and work for 14.04](https://blueprints.launchpad.net/ubuntu/%2Bspec/client-1311-user-data-encryption "client-1311-user-data-encryption")** for **Ubuntu**  Ubuntu Desktop currently offer both encrypted disk and encrypted home as part of the install. Ubuntu Touch should also offer a user data encryption option for its users. | |
| --- | --- |
| **[Application Confinement (Online Accounts)](https://blueprints.launchpad.net/ubuntu/%2Bspec/security-r-app-online-accounts "security-r-app-online-accounts")** for **Ubuntu**  Acceptance criteria for July: Goal: Developers can integrate AppArmor into online accounts Acceptance criteria for August: Goal: Users receive a contextual runtime prompt when an app uses online accounts | |
| **[eCryptfs status and future](https://blueprints.launchpad.net/ubuntu/%2Bspec/security-p-ecryptfs "security-p-ecryptfs")** for **Ubuntu**  This session is about discussing the current status and issues with eCryptfs, and making a decision what needs to be done in order for it to be an appropriate install-time option in the LTS release. | |

## Personal package archives

| [AppArmor-mediated DBus prototype](/~tyhicks/%2Barchive/ubuntu/aadbus) |
| --- |
| [PPA named ecryptfs-utils-daily for Tyler Hicks](/~tyhicks/%2Barchive/ubuntu/ecryptfs-utils-daily) |
| [Testing PPA](/~tyhicks/%2Barchive/ubuntu/testing) |

* [View snap packages](https://launchpad.net/~tyhicks/%2Bsnaps)

## [All memberships](https://launchpad.net/~tyhicks/%2Bparticipation) Latest memberships

| [Ubuntu cloaked people on Libera](/~ubuntu-irc-cloaks)  Joined on 2021-05-24 | |
| --- | --- |
| [Ubuntu SSO 2-factor testers](/~sso-2f-testers)  Joined on 2020-02-20 | |
| [Ubuntu Core Development Team](/~ubuntu-core-dev)  Joined on 2016-02-29 | |
| [AppArmor Developers](/~apparmor-dev)  Joined on 2012-11-07 | |
| [eCryptfs](/~ecryptfs)  Joined on 2008-11-11 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_366e7983_20250126_090655.html ===

[Log in / Register](https://launchpad.net/bugs/cve/CVE-2017-6507/%2Blogin)

![](/@@/launchpad-logo)

## Launchpad.net

* [Launchpad Home](https://launchpad.net/)
* [Code](https://code.launchpad.net/)
* [Bugs](https://bugs.launchpad.net/)
* [Blueprints](https://blueprints.launchpad.net/)
* [Translations](https://translations.launchpad.net/)
* [Answers](https://answers.launchpad.net/)

[Launchpad CVE tracker](/bugs/cve)
# CVE 2017-6507

An issue was discovered in AppArmor before 2.12. Incorrect handling of unknown AppArmor profiles in AppArmor init scripts, upstart jobs, and/or systemd unit files allows an attacker to possibly have increased attack surfaces of processes that were intended to be confined by AppArmor. This is due to the common logic to handle 'restart' operations removing AppArmor profiles that aren't found in the typical filesystem locations, such as /etc/apparmor.d/. Userspace projects that manage their own AppArmor profiles in atypical directories, such as what's done by LXD and Docker, are affected by this flaw in the AppArmor init script logic.

## Related bugs and status

CVE-2017-6507 (Candidate)
is related to these bugs:

**[Bug #1590561: webbrowser-app crashes on startup on fresh zesty Unity8: No suitable EGL configs found](https://bugs.launchpad.net/bugs/1590561)**

| Summary | | | | In | Importance | Status |
| --- | --- | --- | --- | --- | --- | --- |
|  | 1590561 | [webbrowser-app crashes on startup on fresh zesty Unity8: No suitable EGL configs found](https://bugs.launchpad.net/ubuntu/%2Bsource/webbrowser-app/%2Bbug/1590561) |  | webbrowser-app (Ubuntu) | Critical | Fix Released |
|  | 1590561 | [webbrowser-app crashes on startup on fresh zesty Unity8: No suitable EGL configs found](https://bugs.launchpad.net/canonical-devices-system-image/%2Bbug/1590561) |  | Canonical System Image | Critical | Fix Released |
|  | 1590561 | [webbrowser-app crashes on startup on fresh zesty Unity8: No suitable EGL configs found](https://bugs.launchpad.net/oxide/%2Bbug/1590561) |  | Oxide | Critical | Invalid |
|  | 1590561 | [webbrowser-app crashes on startup on fresh zesty Unity8: No suitable EGL configs found](https://bugs.launchpad.net/ubuntu/%2Bsource/unity8/%2Bbug/1590561) |  | unity8 (Ubuntu) | Critical | Invalid |
|  | 1590561 | [webbrowser-app crashes on startup on fresh zesty Unity8: No suitable EGL configs found](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor/%2Bbug/1590561) |  | apparmor (Ubuntu) | Critical | Fix Released |
|  | 1590561 | [webbrowser-app crashes on startup on fresh zesty Unity8: No suitable EGL configs found](https://bugs.launchpad.net/apparmor/%2Bbug/1590561) |  | AppArmor | High | Fix Released |

**[Bug #1661406: apparmor failing to be purged when /var/lib/apparmor/profiles or /var/lib/apparmor doesn't exist](https://bugs.launchpad.net/bugs/1661406)**

| Summary | | | | In | Importance | Status |
| --- | --- | --- | --- | --- | --- | --- |
|  | 1661406 | [apparmor failing to be purged when /var/lib/apparmor/profiles or /var/lib/apparmor doesn't exist](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor/%2Bbug/1661406) |  | apparmor (Ubuntu) | Medium | Fix Released |
|  | 1661406 | [apparmor failing to be purged when /var/lib/apparmor/profiles or /var/lib/apparmor doesn't exist](https://bugs.launchpad.net/ubuntu/trusty/%2Bsource/apparmor/%2Bbug/1661406) |  | apparmor (Ubuntu Trusty) | Medium | Fix Released |

**[Bug #1668892: CVE-2017-6507: apparmor service restarts and package upgrades unload privately managed profiles](https://bugs.launchpad.net/bugs/1668892)**

| Summary | | | | In | Importance | Status |
| --- | --- | --- | --- | --- | --- | --- |
|  | 1668892 | [CVE-2017-6507: apparmor service restarts and package upgrades unload privately managed profiles](https://bugs.launchpad.net/ubuntu/%2Bsource/apparmor/%2Bbug/1668892) |  | apparmor (Ubuntu) | Critical | Fix Released |
|  | 1668892 | [CVE-2017-6507: apparmor service restarts and package upgrades unload privately managed profiles](https://bugs.launchpad.net/apparmor/%2Bbug/1668892) |  | AppArmor | Critical | Fix Released |
|  | 1668892 | [CVE-2017-6507: apparmor service restarts and package upgrades unload privately managed profiles](https://bugs.launchpad.net/apparmor/2.10/%2Bbug/1668892) |  | AppArmor 2.10 | Undecided | Fix Released |
|  | 1668892 | [CVE-2017-6507: apparmor service restarts and package upgrades unload privately managed profiles](https://bugs.launchpad.net/apparmor/2.11/%2Bbug/1668892) |  | AppArmor 2.11 | Undecided | Fix Released |
|  | 1668892 | [CVE-2017-6507: apparmor service restarts and package upgrades unload privately managed profiles](https://bugs.launchpad.net/apparmor/2.9/%2Bbug/1668892) |  | AppArmor 2.9 | Undecided | Fix Released |

See the ![](/@@/link)
[CVE page on Mitre.org](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2017-6507)
for more details.

## Related bugs

* [#1590561:
  webbrowser-app crashes on startup on fresh zesty Unity8: No suitable EGL configs found](https://bugs.launchpad.net/bugs/1590561)
* [#1661406:
  apparmor failing to be purged when /var/lib/apparmor/profiles or /var/lib/apparmor doesn't exist](https://bugs.launchpad.net/bugs/1661406)
* [#1668892:
  CVE-2017-6507: apparmor service restarts and package upgrades unload privately managed profiles](https://bugs.launchpad.net/bugs/1668892)

* [Link to bug](%2Blinkbug)
* [Remove bug link](%2Bunlinkbug)

## References

* CONFIRM:
  [http://bazaar.launchpa...](http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3647)
* CONFIRM:
  [http://bazaar.launchpa...](http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3648)
* CONFIRM:
  [https://bugs.launchpad...](https://bugs.launchpad.net/apparmor/%2Bbug/1668892)
* CONFIRM:
  [https://people.canonic...](https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-6507.html)
* BID:
  [97223](http://www.securityfocus.com/bid/97223)

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_9f645890_20250126_090635.html ===

[Log in / Register](https://launchpad.net/~crichton/%2Blogin)

[![](https://launchpadlibrarian.net/61632396/crichton-small.jpg)](https://launchpad.net/~crichton)

## [Ubuntu Foundations Team Bug Bot](https://launchpad.net/~crichton)

* Overview
* [Code](https://code.launchpad.net/~crichton)
* [Bugs](https://bugs.launchpad.net/~crichton)
* [Blueprints](https://blueprints.launchpad.net/~crichton)
* [Translations](https://translations.launchpad.net/~crichton)
* [Answers](https://answers.launchpad.net/~crichton)

here

* [Related packages](https://launchpad.net/~crichton/%2Brelated-packages)
* [Related projects](https://launchpad.net/~crichton/%2Brelated-projects)

## User information

Launchpad Id:
crichton

Email:
[Log in](%2Blogin) for email information.

Member since:
2008-08-12

[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)

Languages:

English

Time zone:

UTC
(UTC+0000)

Karma:
[27](https://launchpad.net/~crichton/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## [All memberships](https://launchpad.net/~crichton/%2Bparticipation) Latest memberships

| [Ubuntu Bug Control](/~ubuntu-bugcontrol)  Joined on 2008-08-12 | |
| --- | --- |

## [Recent activities](https://launchpad.net/~crichton/%2Bkarma) Most active in

| [Ubuntu](/ubuntu) |  |  |
| --- | --- | --- |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from people.canonical.com_2b278e99_20250125_134509.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# CVE-2017-6507

Publication date 24 March 2017

Last updated 24 July 2024

---

Ubuntu priority

![](https://assets.ubuntu.com/v1/8010f9e0-CVE-Priority-icon-Medium.svg)

**Medium**

[Why this priority?](/security/cves/about#priority )

## Cvss 3 Severity Score

![](https://assets.ubuntu.com/v1/8010f9e0-CVE-Priority-icon-Medium.svg)

**5.9 · Medium**

[Score breakdown](#impact-score)

Toggle side navigation

Toggle table of contents

* [Description](#description)
* [Status](#status)
* [Severity score breakdown](#impact-score)
* [References](#references)

An issue was discovered in AppArmor before 2.12. Incorrect handling of
unknown AppArmor profiles in AppArmor init scripts, upstart jobs, and/or
systemd unit files allows an attacker to possibly have increased attack
surfaces of processes that were intended to be confined by AppArmor. This
is due to the common logic to handle 'restart' operations removing AppArmor
profiles that aren't found in the typical filesystem locations, such as
/etc/apparmor.d/. Userspace projects that manage their own AppArmor
profiles in atypical directories, such as what's done by LXD and Docker,
are affected by this flaw in the AppArmor init script logic.

## Status

Show unmaintained releases

| Package | Ubuntu Release | Status |
| --- | --- | --- |
| apparmor | 17.04 zesty | Fixed 2.11.0-2ubuntu3 |
| 16.10 yakkety | Fixed 2.10.95-4ubuntu5.3 |
| 16.04 LTS xenial | Fixed 2.10.95-0ubuntu2.6 |
| 14.04 LTS trusty | Fixed 2.10.95-0ubuntu2.6~14.04.1 |
| 12.04 LTS precise | Fixed 2.7.102-0ubuntu3.11 |

---

* [How can I get the fixes?](/security/cves/about#security)
* [What do statuses mean?](/security/cves/about#statuses)
* [Patch details](#patch-details)

### Patch details

For informational purposes only. We recommend not to cherry-pick updates. [How can I get the fixes?](/security/cves/about#security)

| Package | Patch details |
| --- | --- |
| apparmor | * Upstream:   <http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3647> * Upstream:   <http://bazaar.launchpad.net/~apparmor-dev/apparmor/master/revision/3648> |

## Severity score breakdown

| Parameter | Value |
| --- | --- |
| Base score | 5.9 · Medium |
| Attack vector | Network |
| Attack complexity | High |
| Privileges required | None |
| User interaction | None |
| Scope | Unchanged |
| Confidentiality | None |
| Integrity impact | High |
| Availability impact | None |
| Vector | CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N |

## References

* [MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6507)
* [NVD](https://nvd.nist.gov/vuln/detail/CVE-2017-6507)
* [Launchpad](https://launchpad.net/bugs/cve/CVE-2017-6507)
* [Debian](https://security-tracker.debian.org/tracker/CVE-2017-6507)

### Related Ubuntu Security Notices (USN)

+ [USN-3247-1](https://usn.ubuntu.com/USN-3247-1)
+ AppArmor vulnerability
+ 28 March 2017

### Other references

* <https://www.cve.org/CVERecord?id=CVE-2017-6507>

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


