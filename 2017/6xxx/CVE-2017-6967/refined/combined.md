=== Content from launchpad.net_1e0d2161_20250126_104957.html ===

[Log in / Register](https://launchpad.net/~klaus-steinberger/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~klaus-steinberger)

## [Klaus Steinberger](https://launchpad.net/~klaus-steinberger)

* Overview
* [Code](https://code.launchpad.net/~klaus-steinberger)
* [Bugs](https://bugs.launchpad.net/~klaus-steinberger)
* [Blueprints](https://blueprints.launchpad.net/~klaus-steinberger)
* [Translations](https://translations.launchpad.net/~klaus-steinberger)
* [Answers](https://answers.launchpad.net/~klaus-steinberger)

* [Related packages](https://launchpad.net/~klaus-steinberger/%2Brelated-packages)
* [Related projects](https://launchpad.net/~klaus-steinberger/%2Brelated-projects)

## User information

Launchpad Id:
klaus-steinberger

Email:
[Log in](%2Blogin) for email information.

Member since:
2009-10-25

Languages:

English

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~klaus-steinberger/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## Latest memberships

Klaus Steinberger is not an
active member of any Launchpad teams.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from github.com_1783aa78_20250125_180340.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fneutrinolabs%2Fxrdp%2Fpull%2F694)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fneutrinolabs%2Fxrdp%2Fpull%2F694)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=neutrinolabs%2Fxrdp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[neutrinolabs](/neutrinolabs)
/
**[xrdp](/neutrinolabs/xrdp)**
Public

* [Notifications](/login?return_to=%2Fneutrinolabs%2Fxrdp) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fneutrinolabs%2Fxrdp)
* [Star
   5.9k](/login?return_to=%2Fneutrinolabs%2Fxrdp)

* [Code](/neutrinolabs/xrdp)
* [Issues
  234](/neutrinolabs/xrdp/issues)
* [Pull requests
  35](/neutrinolabs/xrdp/pulls)
* [Discussions](/neutrinolabs/xrdp/discussions)
* [Actions](/neutrinolabs/xrdp/actions)
* [Projects
  0](/neutrinolabs/xrdp/projects)
* [Wiki](/neutrinolabs/xrdp/wiki)
* [Security](/neutrinolabs/xrdp/security)
* [Insights](/neutrinolabs/xrdp/pulse)

Additional navigation options

* [Code](/neutrinolabs/xrdp)
* [Issues](/neutrinolabs/xrdp/issues)
* [Pull requests](/neutrinolabs/xrdp/pulls)
* [Discussions](/neutrinolabs/xrdp/discussions)
* [Actions](/neutrinolabs/xrdp/actions)
* [Projects](/neutrinolabs/xrdp/projects)
* [Wiki](/neutrinolabs/xrdp/wiki)
* [Security](/neutrinolabs/xrdp/security)
* [Insights](/neutrinolabs/xrdp/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fneutrinolabs%2Fxrdp%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fneutrinolabs%2Fxrdp%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# sesman: auth session before fork #694

 Closed

[jsorg71](/jsorg71)
wants to merge
1
commit into
[neutrinolabs:devel](/neutrinolabs/xrdp/tree/devel "neutrinolabs/xrdp:devel")
from
[jsorg71:homedir1](/jsorg71/xrdp/tree/homedir1 "jsorg71/xrdp:homedir1")

 Closed

# [sesman: auth session before fork](#top) #694

[jsorg71](/jsorg71)
wants to merge
1
commit into
[neutrinolabs:devel](/neutrinolabs/xrdp/tree/devel "neutrinolabs/xrdp:devel")
from
[jsorg71:homedir1](/jsorg71/xrdp/tree/homedir1 "jsorg71/xrdp:homedir1")

+1

−1

[Conversation
16](/neutrinolabs/xrdp/pull/694)
[Commits
1](/neutrinolabs/xrdp/pull/694/commits)
[Checks
0](/neutrinolabs/xrdp/pull/694/checks)
[Files changed
1](/neutrinolabs/xrdp/pull/694/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![jsorg71](https://avatars.githubusercontent.com/u/666160?s=60&v=4)](/jsorg71)

Copy link

Contributor

### @jsorg71 **[jsorg71](/jsorg71)** commented [Mar 14, 2017](#issue-214138189)

So, the home directory can be created by "pam\_mkhomedir".

Sorry, something went wrong.

All reactions

[![@jsorg71](https://avatars.githubusercontent.com/u/666160?s=40&v=4)](/jsorg71)

`[sesman: auth session before fork](/neutrinolabs/xrdp/pull/694/commits/9d9c842b7861ef7a419c78d69b72202f7a7dbfc8 "sesman: auth session before fork")`

`[9d9c842](/neutrinolabs/xrdp/pull/694/commits/9d9c842b7861ef7a419c78d69b72202f7a7dbfc8)`

[![@jsorg71](https://avatars.githubusercontent.com/u/666160?s=40&v=4)](/jsorg71)
[jsorg71](/jsorg71)
mentioned this pull request
[Mar 14, 2017](#ref-issue-142950235)

[Homedir gets not correctly created at first login
#350](/neutrinolabs/xrdp/issues/350)

Closed

[![@proski](https://avatars.githubusercontent.com/u/1317472?s=80&u=c1916c907063b85dbb0dcd6baa6215088182057c&v=4)](/proski)

Copy link

Contributor

### **[proski](/proski)** commented [Mar 14, 2017](#issuecomment-286567537)

| +1 |
| --- |

All reactions

Sorry, something went wrong.

[![@metalefty](https://avatars.githubusercontent.com/u/941609?s=80&u=d6817252dc134201ef30d7fffdee53d50ae8dc7a&v=4)](/metalefty)

Copy link

Member

### **[metalefty](/metalefty)** commented [Mar 15, 2017](#issuecomment-286605365)

| The change looks good. But I want you to include "why" in commit message for future source code reading. "Why" is always more important than "What". In this change, to create home directory, right? It's OK to do force push in unmerged PRs. |
| --- |

All reactions

Sorry, something went wrong.

[![@ksteinb](https://avatars.githubusercontent.com/u/8264704?s=80&v=4)](/ksteinb)

Copy link

### **[ksteinb](/ksteinb)** commented [Mar 15, 2017](#issuecomment-286658404)

| Correct session management is necessary for more things than just to create homedirectory. Here some reasons:  -> Create Homedirectory on demand -> Correctly setup umask (pam\_umask) -> Correct setup of selinux contexrt -> Handling of limits (pam\_limits)  and so on ..... |
| --- |

All reactions

Sorry, something went wrong.

[![@proski](https://avatars.githubusercontent.com/u/1317472?s=80&u=c1916c907063b85dbb0dcd6baa6215088182057c&v=4)](/proski)

Copy link

Contributor

### **[proski](/proski)** commented [Mar 15, 2017](#issuecomment-286660243)

| I'm a big fan of good comments in the code, however...  The reader of the code would not see that `auth_start_session` was called elsewhere. So a comment in the code would not be very useful. We cannot annotate every line of code with an explanation why it's there and not elsewhere.  Those who want to dig deeper should be able to find the commit and it's comment. That would provide information about the change and the reason behind it.  Of course, if somebody can come with a useful comment about the `auth_start_session` that is not duplicating the code, I'll be glad to see it. But the lack of a comment should not be a blocker. |
| --- |

All reactions

Sorry, something went wrong.

[![@metalefty](https://avatars.githubusercontent.com/u/941609?s=80&u=d6817252dc134201ef30d7fffdee53d50ae8dc7a&v=4)](/metalefty)

Copy link

Member

### **[metalefty](/metalefty)** commented [Mar 15, 2017](#issuecomment-286680958)

| I think most of correct session management procedures can be done in PAM. For example, suggested in [#688](https://github.com/neutrinolabs/xrdp/pull/688). This fixes things done in PAM wasn't working.  Of course I don't intend to block merging this PR. We can add comments whenever later. |
| --- |

All reactions

Sorry, something went wrong.

[![@ksteinb](https://avatars.githubusercontent.com/u/8264704?s=80&v=4)](/ksteinb)

Copy link

### **[ksteinb](/ksteinb)** commented [Mar 15, 2017](#issuecomment-286710808)

| [#688](https://github.com/neutrinolabs/xrdp/pull/688) describes the correct setup of the pam configuration, but that doesn't help as long as auth\_start\_session is called in the wrong place.  So just write as comment something like:  "Calling auth\_start\_session in the correct place, otherwise pam session management fails" |
| --- |

All reactions

Sorry, something went wrong.

[![@jsorg71](https://avatars.githubusercontent.com/u/666160?s=80&v=4)](/jsorg71)

Copy link

Contributor

Author

### **[jsorg71](/jsorg71)** commented [Mar 15, 2017](#issuecomment-286848986)

| Does it also fix the issue if auth\_start\_session is moved above wait\_for\_xserver? I'd rather do that. There is not matching auth\_start\_session / auth\_stop\_session now. |
| --- |

All reactions

Sorry, something went wrong.

[![@jsorg71](https://avatars.githubusercontent.com/u/666160?s=80&v=4)](/jsorg71)

Copy link

Contributor

Author

### **[jsorg71](/jsorg71)** commented [Mar 15, 2017](#issuecomment-286879008)

| After looking closer, I think it's right now. auth\_start\_session and auth\_stop\_session are called in same process now.  Before this PR  ``` session_start_fork() g_fork()     child - g_fork()         child auth_start_session(), g_fork()             child - g_exec(window manager)         parent - g_waitpid(), auth_stop_session(), g_exit()     parent - g_fork()         child - g_exec(X11 backend)     parent - sesman svc(wait for window manager to exit, then kill X11 backend) parent - exit session_start_fork()  ```  After this PR  ``` session_start_fork() g_fork()     child - auth_start_session(), g_fork()         child g_fork()             child - g_exec(window manager)         parent - g_waitpid(), auth_stop_session(), g_exit()     parent - g_fork()         child - g_exec(X11 backend)     parent - sesman svc(wait for window manager to exit, then kill X11 backend) parent - exit session_start_fork()  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@rolnas](https://avatars.githubusercontent.com/u/26460813?s=80&v=4)](/rolnas)

Copy link

### **[rolnas](/rolnas)** commented [Mar 16, 2017](#issuecomment-287053187)

| This patch don't work with pam\_krb5 on Debian 8. I moved auth\_start\_session higher to the same process as auth\_userpass. That works, but some auth\_end closes session too early (but retain\_after\_close=true on pam\_krb5 solves temporary). I'm attaching patch and log files from successful session (pam\_krb5 with debug=true). [auth\_start\_session2.txt](https://github.com/neutrinolabs/xrdp/files/847741/auth_start_session2.txt) [auth\_start\_session2\_log.txt](https://github.com/neutrinolabs/xrdp/files/847763/auth_start_session2_log.txt) |
| --- |

All reactions

Sorry, something went wrong.

[![@moobyfr](https://avatars.githubusercontent.com/u/628573?s=80&v=4)](/moobyfr)

Copy link

Contributor

### **[moobyfr](/moobyfr)** commented [Mar 16, 2017](#issuecomment-287132299)

| [@rolnas](https://github.com/rolnas) can you add your pam.d/common-\* files to understand the problem ? I'm using pam\_krb5 or pam\_ldap with xrdp since several years without problem. |
| --- |

All reactions

Sorry, something went wrong.

[![@ksteinb](https://avatars.githubusercontent.com/u/8264704?s=80&v=4)](/ksteinb)

Copy link

### **[ksteinb](/ksteinb)** commented [Mar 16, 2017](#issuecomment-287136995) via email

| Am 16.03.2017 um 18:29 schrieb Blindauer Emmanuel:  [@rolnas](https://github.com/rolnas) <<https://github.com/rolnas>> can you add your pam.d/common-\* files to understand the problem ? I'm using pam\_krb5 or pam\_ldap with xrdp since several years without problem.  the problem is \_not\_ authorization as you need for pam\_ldap or pam\_krb5. It is session management. For example pam\_limits was not working (pam\_limits has \_only\_ the session module). Sincerly, Klaus … -- Rechnerbetriebsgruppe / IT, Fakultät für Physik Klaus Steinberger FAX: +49 89 28914280 Tel: +49 89 28914287 |
| --- |

All reactions

Sorry, something went wrong.

[![@jsorg71](https://avatars.githubusercontent.com/u/666160?s=80&v=4)](/jsorg71)

Copy link

Contributor

Author

### **[jsorg71](/jsorg71)** commented [Mar 17, 2017](#issuecomment-287261253)

| I create [#696](https://github.com/neutrinolabs/xrdp/pull/696) that can replace this PR. Hopefully it works for everyone. |
| --- |

All reactions

Sorry, something went wrong.

[![@setharnold](https://avatars.githubusercontent.com/u/5447148?s=80&v=4)](/setharnold)

Copy link

### **[setharnold](/setharnold)** commented [Mar 17, 2017](#issuecomment-287460092)

| Use [CVE-2017-6967](https://github.com/advisories/GHSA-3fgq-wvwm-xq86 "CVE-2017-6967"). Thanks |
| --- |

All reactions

Sorry, something went wrong.

[![@jsorg71](https://avatars.githubusercontent.com/u/666160?s=40&v=4)](/jsorg71)
[jsorg71](/jsorg71)
added
the
[invalid](/neutrinolabs/xrdp/labels/invalid)
label
[Mar 18, 2017](#event-1005405464)

[![@jsorg71](https://avatars.githubusercontent.com/u/666160?s=40&v=4)](/jsorg71)
[jsorg71](/jsorg71)
closed this
[Mar 22, 2017](#event-1009827924)

[![@mrkz](https://avatars.githubusercontent.com/u/978752?s=80&u=80ed0b996ddad26d973d11394852554709bea36b&v=4)](/mrkz)

Copy link

### **[mrkz](/mrkz)** commented [Mar 24, 2017](#issuecomment-289097470)

| Hello, I would like to confirm if PR [#704](https://github.com/neutrinolabs/xrdp/pull/704) and [#697](https://github.com/neutrinolabs/xrdp/pull/697) are the fix to this CVE issue? Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@jsorg71](https://avatars.githubusercontent.com/u/666160?s=80&v=4)](/jsorg71)

Copy link

Contributor

Author

### **[jsorg71](/jsorg71)** commented [Mar 24, 2017](#issuecomment-289098983)

| It's just [#704](https://github.com/neutrinolabs/xrdp/pull/704) for the fix. Can someone else confirm it;s fixed? |
| --- |

All reactions

Sorry, something went wrong.

[![@moobyfr](https://avatars.githubusercontent.com/u/628573?s=80&v=4)](/moobyfr)

Copy link

Contributor

### **[moobyfr](/moobyfr)** commented [Mar 26, 2017](#issuecomment-289262531) • edited Loading

| I confirm it. I thing the pam process is now ok: before, if pam\_krb5 was used, the environement variable set by the module was't available in the user session an the file created by the module was owned by root. Now the variable is set and file owned by user. |
| --- |

All reactions

Sorry, something went wrong.

[![@tfischer77](https://avatars.githubusercontent.com/u/24829596?s=40&v=4)](/tfischer77)
[tfischer77](/tfischer77)
mentioned this pull request
[Jun 19, 2017](#ref-pullrequest-236982544)

[Fix systemd sessions
#779](/neutrinolabs/xrdp/pull/779)
 Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fneutrinolabs%2Fxrdp%2Fpull%2F694)

Reviewers

No reviews

Assignees

No one assigned

Labels

[invalid](/neutrinolabs/xrdp/labels/invalid)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

8 participants

[![@jsorg71](https://avatars.githubusercontent.com/u/666160?s=52&v=4)](/jsorg71) [![@proski](https://avatars.githubusercontent.com/u/1317472?s=52&v=4)](/proski) [![@metalefty](https://avatars.githubusercontent.com/u/941609?s=52&v=4)](/metalefty) [![@ksteinb](https://avatars.githubusercontent.com/u/8264704?s=52&v=4)](/ksteinb) [![@rolnas](https://avatars.githubusercontent.com/u/26460813?s=52&v=4)](/rolnas) [![@moobyfr](https://avatars.githubusercontent.com/u/628573?s=52&v=4)](/moobyfr) [![@setharnold](https://avatars.githubusercontent.com/u/5447148?s=52&v=4)](/setharnold) [![@mrkz](https://avatars.githubusercontent.com/u/978752?s=52&v=4)](/mrkz)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.launchpad.net_3ea4f4d7_20250125_180337.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[xrdp package](https://launchpad.net/ubuntu/%2Bsource/xrdp)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/xrdp)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/xrdp)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/xrdp)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/xrdp)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/xrdp)

# pam session does not work in xrdp

Bug #1672742 reported by
[Klaus Steinberger](https://launchpad.net/~klaus-steinberger)
on 2017-03-14

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [xrdp (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/xrdp "Latest release: 0.10.1-3, uploaded to main on 2024-08-30 10:39:54.866367+00:00 by Debian Remote Maintainers (debian-remote), maintained by Debian Remote Maintainers (debian-remote)") | Expired | Undecided | Unassigned |  |

### Bug Description

pam session management does not work in xrdp, because auth\_start\_session is called \_after\_ the Xserver.

This is already reported here (but not fixed):

<https://github.com/neutrinolabs/xrdp/issues/350>

As we discovered, it is also an (slight) security Issue, as the pam\_limits.so will not work as intended:

Mar 14 14:59:56 gar-ws-rbg06 xrdp-sesman: pam\_krb5(xrdp-sesman:auth): user Guinea.Pig authenticated as <email address hidden>

Mar 14 14:59:56 gar-ws-rbg06 xrdp-sesman: pam\_unix(xrdp-sesman:session): session opened for user Guinea.Pig by (uid=0)

Mar 14 14:59:56 gar-ws-rbg06 systemd-logind[916]: New session c87 of user Guinea.Pig.

Mar 14 14:59:56 gar-ws-rbg06 xrdp-sesman: pam\_limits(xrdp-sesman:session): conversation failed

So the user Session is created even if the user is not authorized to open sessions on the system.

The cure would be to move the call to auth\_start\_session before the forks.

Description: Ubuntu 16.04.2 LTS

Release: 16.04

root@gar-ws-rbg06:/etc/pam.d# apt-cache policy xrdp

xrdp:

  Installed: 0.6.1-2

  Candidate: 0.6.1-2

  Version table:

 \*\*\* 0.6.1-2 500

        500 <http://z-sv-debmirror.server.physik.uni-muenchen.de/ubuntu> xenial/universe amd64 Packages

        500 <http://archive.ubuntu.com/ubuntu> xenial/universe amd64 Packages

        100 /var/lib/dpkg/status

root@gar-ws-rbg06:/etc/pam.d#

## CVE References

* [2017-6967](/bugs/cve/2017-6967 "xrdp 0.9.1 calls the PAM function aut...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2017-03-14: |  |  | [#1](/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/comments/1) |
| --- | --- | --- | --- |

Hello Klaus, is this a usability issue or does this also allow someone to improperly elevate their privileges?

Thanks

Hello Klaus, is this a usability issue or does this also allow someone to improperly elevate their privileges?
Thanks

| **affects**: | ubuntu → xrdp (Ubuntu) |
| --- | --- |
| **information type**: | Private Security → Public Security |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Klaus Steinberger (klaus-steinberger)](https://launchpad.net/~klaus-steinberger) wrote on 2017-03-15:  [**Re: [Bug 1672742] Re: pam session does not work in xrdp**](/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/comments/2) |  |  | [#2](/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/comments/2) |
| --- | --- | --- | --- |

Hi Seth,

> Hello Klaus, is this a usability issue or does this also allow someone

> to improperly elevate their privileges?

it does allow someone to login to machines which she/he has no right to access.

E.g. machines reserved for a group, or machines with special hardware which

should not be publicly available.

Sincerly,

Klaus

--

Rechnerbetriebsgruppe / IT, Fakultät für Physik

Klaus Steinberger

FAX: +49 89 28914280

Tel: +49 89 28914287

Hi Seth,
> Hello Klaus, is this a usability issue or does this also allow someone
> to improperly elevate their privileges?
it does allow someone to login to machines which she/he has no right to access.
E.g. machines reserved for a group, or machines with special hardware which
should not be publicly available.
Sincerly,
Klaus
--
Rechnerbetriebsgruppe / IT, Fakultät für Physik
Klaus Steinberger
FAX: +49 89 28914280
Tel: +49 89 28914287

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Klaus Steinberger (klaus-steinberger)](https://launchpad.net/~klaus-steinberger) wrote on 2017-03-15: |  |  | [#3](/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/comments/3) |
| --- | --- | --- | --- |

Am 15.03.2017 um 00:44 schrieb Seth Arnold:

> Hello Klaus, is this a usability issue or does this also allow someone

> to improperly elevate their privileges?

One more point: Correct setting of umask (which is definitly a security thing)

is also dependent on a working session management -> see pam\_umask

Sincerly,

Klaus

--

Rechnerbetriebsgruppe / IT, Fakultät für Physik

Klaus Steinberger

FAX: +49 89 28914280

Tel: +49 89 28914287

Am 15.03.2017 um 00:44 schrieb Seth Arnold:
> Hello Klaus, is this a usability issue or does this also allow someone
> to improperly elevate their privileges?
One more point: Correct setting of umask (which is definitly a security thing)
is also dependent on a working session management -> see pam\_umask
Sincerly,
Klaus
--
Rechnerbetriebsgruppe / IT, Fakultät für Physik
Klaus Steinberger
FAX: +49 89 28914280
Tel: +49 89 28914287

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Klaus Steinberger (klaus-steinberger)](https://launchpad.net/~klaus-steinberger) wrote on 2017-03-15: |  |  | [#4](/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/comments/4) |
| --- | --- | --- | --- |

Am 15.03.2017 um 08:02 schrieb Klaus Steinberger:

> Am 15.03.2017 um 00:44 schrieb Seth Arnold:

>> Hello Klaus, is this a usability issue or does this also allow someone

>> to improperly elevate their privileges?

>

> One more point: Correct setting of umask (which is definitly a security thing)

> is also dependent on a working session management -> see pam\_umask

And what I found out by looking through other pam files: It is necessary for a

correct selinux context setup (for example look into the pam config for sddm)

Sincerly,

Klaus

--

Rechnerbetriebsgruppe / IT, Fakultät für Physik

Klaus Steinberger

FAX: +49 89 28914280

Tel: +49 89 28914287

Am 15.03.2017 um 08:02 schrieb Klaus Steinberger:
> Am 15.03.2017 um 00:44 schrieb Seth Arnold:
>> Hello Klaus, is this a usability issue or does this also allow someone
>> to improperly elevate their privileges?
>
> One more point: Correct setting of umask (which is definitly a security thing)
> is also dependent on a working session management -> see pam\_umask
And what I found out by looking through other pam files: It is necessary for a
correct selinux context setup (for example look into the pam config for sddm)
Sincerly,
Klaus
--
Rechnerbetriebsgruppe / IT, Fakultät für Physik
Klaus Steinberger
FAX: +49 89 28914280
Tel: +49 89 28914287

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Klaus Steinberger (klaus-steinberger)](https://launchpad.net/~klaus-steinberger) wrote on 2017-03-15: |  |  | [#5](/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/comments/5) |
| --- | --- | --- | --- |

Upstream pull request #694 fixes the problem:

<https://github.com/neutrinolabs/xrdp/pull/694>

Upstream pull request #694 fixes the problem:
https://github.com/neutrinolabs/xrdp/pull/694

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2017-03-17: |  |  | [#6](/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/comments/6) |
| --- | --- | --- | --- |

Use CVE-2017-6967.

Thanks

Use CVE-2017-6967.
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Klaus Steinberger (klaus-steinberger)](https://launchpad.net/~klaus-steinberger) wrote on 2017-04-27: |  |  | [#7](/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/comments/7) |
| --- | --- | --- | --- |

When will the patch hit the world? Upstream has fixed and Fedora is already fixing it. ubuntu sounds a little bit slow in fixing?

When will the patch hit the world? Upstream has fixed and Fedora is already fixing it. ubuntu sounds a little bit slow in fixing?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2017-05-05: |  |  | [#8](/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/comments/8) |
| --- | --- | --- | --- |

Thanks for taking the time to report this bug and helping to make Ubuntu better. Since the package referred to in this bug is in universe or multiverse, it is community maintained. If you are able, I suggest coordinating with upstream and posting a debdiff for this issue. When a debdiff is available, members of the security team will review it and publish the package. See the following link for more information: <https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures>

Thanks for taking the time to report this bug and helping to make Ubuntu better. Since the package referred to in this bug is in universe or multiverse, it is community maintained. If you are able, I suggest coordinating with upstream and posting a debdiff for this issue. When a debdiff is available, members of the security team will review it and publish the package. See the following link for more information: https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures

| Changed in xrdp (Ubuntu): | |
| --- | --- |
| **status**: | New → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2017-07-05: |  |  | [#9](/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/comments/9) |
| --- | --- | --- | --- |

[Expired for xrdp (Ubuntu) because there has been no activity for 60 days.]

[Expired for xrdp (Ubuntu) because there has been no activity for 60 days.]

| Changed in xrdp (Ubuntu): | |
| --- | --- |
| **status**: | Incomplete → Expired |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/xrdp/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/xrdp/%2Bbug/1672742/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from avatars.githubusercontent.com_60ad7c4c_20250126_104954.html ===
�PNG

   
IHDR  �  �   �.�b  �IDATx���щ�@ E�lP+�I��U���Ĕ���B����}�i@]f�1�/�O�{� �;�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$��������=��u�=ᑜ�����H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A쀄e� ^�~��'�S|�1fo�U|d�u�=���$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�������:o��m�u�=��я�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� ���m����g�\_b�?�u�=ᑔ�o��@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@��c���s��H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���  ��l#�a�bp    IEND�B`�

=== Content from launchpad.net_c56b497c_20250126_105000.html ===

[Log in / Register](https://launchpad.net/~seth-arnold/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~seth-arnold)

## [Seth Arnold](https://launchpad.net/~seth-arnold)

* Overview
* [Code](https://code.launchpad.net/~seth-arnold)
* [Bugs](https://bugs.launchpad.net/~seth-arnold)
* [Blueprints](https://blueprints.launchpad.net/~seth-arnold)
* [Translations](https://translations.launchpad.net/~seth-arnold)
* [Answers](https://answers.launchpad.net/~seth-arnold)

* [Related packages](https://launchpad.net/~seth-arnold/%2Brelated-packages)
* [Related projects](https://launchpad.net/~seth-arnold/%2Brelated-projects)

## User information

Launchpad Id:
seth-arnold

Email:
[Log in](%2Blogin) for email information.

Member since:
2006-05-22

[![Icon of AppArmor Developers](https://launchpadlibrarian.net/65472736/toxie-14.png "Member of AppArmor Developers")](/~apparmor-dev)
[![Icon of Canonical Partner Developers](https://launchpadlibrarian.net/74993564/14.png "Member of Canonical Partner Developers")](/~canonical-partner-dev)
[![Icon of OEM Archive Admins](https://launchpadlibrarian.net/31251458/oem-admin-logo_14x14.png "Member of OEM Archive Admins")](/~oem-archive)
[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)
[![Icon of Ubuntu IRC Team](https://launchpadlibrarian.net/1741440/xchat.png "Member of Ubuntu IRC Team")](/~ubuntu-irc)
[![Icon of Ubuntu LXC Security team](https://launchpadlibrarian.net/673452720/14.png "Member of Ubuntu LXC Security team")](/~ubuntu-lxc-security)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Security Team](https://launchpadlibrarian.net/1575441/Lock.png "Member of Ubuntu Security Team")](/~ubuntu-security)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English, German

OpenPGP keys:

415010F1BA23C8C720DFB1F5F32172599D8D2E97

SSH keys:

[sarnold@haig](%2Bsshkeys)

Time zone:

America/Los\_Angeles
(UTC-0800)

Karma:
[1754](https://launchpad.net/~seth-arnold/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**irc.oftc.net**

![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**irc.libera.chat**

![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**chat.canonical.com**

![Matrix](/@@/social-matrix "Matrix") [**@seth-arnold:ubuntu.com**](https://matrix.to//#/@seth-arnold:ubuntu.com)

## Personal package archives

| [doghouse](/~seth-arnold/%2Barchive/ubuntu/doghouse) |
| --- |
| [testing](/~seth-arnold/%2Barchive/ubuntu/testing) |

## [All memberships](https://launchpad.net/~seth-arnold/%2Bparticipation) Latest memberships

| [Ubuntu Matrix Operators](/~matrix-operators)  Joined on 2024-03-31 | |
| --- | --- |
| [#ubuntu-devel IRC Operators](/~irc-ubuntu-devel-ops)  Joined on 2022-11-01 | |
| [Ubuntu IRC Council](/~ubuntu-irc-council)  Joined on 2021-05-25 | |
| [Ubuntu cloaked people on Libera](/~ubuntu-irc-cloaks)  Joined on 2021-05-10 | |

## [Recent activities](https://launchpad.net/~seth-arnold/%2Bkarma) Most active in

| [Ubuntu CVE Tracker](/ubuntu-cve-tracker) |  |  |  |
| --- | --- | --- | --- |
| [ubuntu-security-tools](/ubuntu-security-tools) |  |  |  |
| [QA Regression Testing](/qa-regression-testing) |  |  |  |
| [Ubuntu](/ubuntu) |  |  |  |
| [Launchpad itself](/launchpad) |  |  |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from github.com_d6580ddc_20250126_104956.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-3fgq-wvwm-xq86)

**CVE-2017-6967**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-3fgq-wvwm-xq86)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2017-6967](/advisories/GHSA-3fgq-wvwm-xq86)

## xrdp 0.9.1 calls the PAM function auth\_start\_session() in...

High severity

Unreviewed

Published
May 13, 2022
to the GitHub Advisory Database
•
Updated Feb 1, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-3fgq-wvwm-xq86/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

xrdp 0.9.1 calls the PAM function auth\_start\_session() in an incorrect location, leading to PAM session modules not being properly initialized, with a potential consequence of incorrect configurations or elevation of privileges, aka a pam\_limits.so bypass.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2017-6967>
* [neutrinolabs/xrdp#350](https://github.com/neutrinolabs/xrdp/issues/350)
* [neutrinolabs/xrdp#694](https://github.com/neutrinolabs/xrdp/pull/694)
* [https://bugs.launchpad.net/ubuntu/+source/xrdp/+bug/1672742](https://bugs.launchpad.net/ubuntu/%2Bsource/xrdp/%2Bbug/1672742)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2017-6967)
Mar 17, 2017

Published to the GitHub Advisory Database
May 13, 2022

Last updated
Feb 1, 2023

### Severity

High

7.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

### EPSS score

0.189%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (57th percentile)

### Weaknesses

[CWE-287](/advisories?query=cwe%3A287)

### CVE ID

CVE-2017-6967

### GHSA ID

GHSA-3fgq-wvwm-xq86

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-3fgq-wvwm-xq86/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from launchpad.net_adc118ee_20250126_104959.html ===

[Log in / Register](https://launchpad.net/~k/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~k)

## [-](https://launchpad.net/~k)

* Overview
* [Code](https://code.launchpad.net/~k)
* [Bugs](https://bugs.launchpad.net/~k)
* [Blueprints](https://blueprints.launchpad.net/~k)
* [Translations](https://translations.launchpad.net/~k)
* [Answers](https://answers.launchpad.net/~k)

* [Related packages](https://launchpad.net/~k/%2Brelated-packages)
* [Related projects](https://launchpad.net/~k/%2Brelated-projects)

## User information

Launchpad Id:
k

Email:
[Log in](%2Blogin) for email information.

Member since:
2006-07-02

Languages:

English

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~k/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## Latest memberships

- is not an
active member of any Launchpad teams.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from avatars.githubusercontent.com_75ec3706_20250126_104953.html ===
�PNG

   
IHDR  �  �   �.�b  �IDATx���A��0 Eљ)�`�R�a!H����yr�,�}��v�f A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A쀄e�I�y
;k�c[gO��=z̟� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$��������5{���:{�0.v�9�9��1�X A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���HX����װ��9�u�Zܣ��Ŏ��n��g,� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$,��"�y͞�yǶΞ�+���o~�=z�3H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���a'��5�a�m�=���1v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� ���������H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���  ���,&�\_jg�    IEND�B`�

=== Content from avatars.githubusercontent.com_e15b4419_20250126_104951.html ===
�PNG

   
IHDR  �  �   �.�b  �IDATx���щ�@ E�lP+�I��U���Ĕ���B����}�i@]f�1�/�O�{� �;�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$��������=��u�=ᑜ�����H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A쀄e� ^�~��'�S|�1fo�U|d�u�=���$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�������:o��m�u�=��я�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� ���m����g�\_b�?�u�=ᑔ�o��@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@��c���s��H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���  ��l#�a�bp    IEND�B`�

=== Content from github.com_d4c9394f_20250125_180338.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fneutrinolabs%2Fxrdp%2Fissues%2F350)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fneutrinolabs%2Fxrdp%2Fissues%2F350)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=neutrinolabs%2Fxrdp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[neutrinolabs](/neutrinolabs)
/
**[xrdp](/neutrinolabs/xrdp)**
Public

* [Notifications](/login?return_to=%2Fneutrinolabs%2Fxrdp) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fneutrinolabs%2Fxrdp)
* [Star
   5.9k](/login?return_to=%2Fneutrinolabs%2Fxrdp)

* [Code](/neutrinolabs/xrdp)
* [Issues
  234](/neutrinolabs/xrdp/issues)
* [Pull requests
  35](/neutrinolabs/xrdp/pulls)
* [Discussions](/neutrinolabs/xrdp/discussions)
* [Actions](/neutrinolabs/xrdp/actions)
* [Projects
  0](/neutrinolabs/xrdp/projects)
* [Wiki](/neutrinolabs/xrdp/wiki)
* [Security](/neutrinolabs/xrdp/security)
* [Insights](/neutrinolabs/xrdp/pulse)

Additional navigation options

* [Code](/neutrinolabs/xrdp)
* [Issues](/neutrinolabs/xrdp/issues)
* [Pull requests](/neutrinolabs/xrdp/pulls)
* [Discussions](/neutrinolabs/xrdp/discussions)
* [Actions](/neutrinolabs/xrdp/actions)
* [Projects](/neutrinolabs/xrdp/projects)
* [Wiki](/neutrinolabs/xrdp/wiki)
* [Security](/neutrinolabs/xrdp/security)
* [Insights](/neutrinolabs/xrdp/pulse)

# Homedir gets not correctly created at first login #350

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosed[#2644](https://github.com/neutrinolabs/xrdp/pull/2644)Closed[Homedir gets not correctly created at first login](#top)#350[#2644](https://github.com/neutrinolabs/xrdp/pull/2644)Copy link[![@mvdberge](https://avatars.githubusercontent.com/u/8587894?v=4&size=80)](/mvdberge)
## Description

[![@mvdberge](https://avatars.githubusercontent.com/u/8587894?v=4&size=48)](/mvdberge)[mvdberge](https://github.com/mvdberge)opened [on Mar 23, 2016](https://github.com/neutrinolabs/xrdp/issues/350#issue-142950235)

I'm opening this as a new issue, although my problems have already been started to be discussed at [#325](https://github.com/neutrinolabs/xrdp/issues/325) which has been marked as "closed" before finding a solution for my specific problem.

Short summary here:

I built xrdp upstream version and have a problem when connecting to the server for the very first time with a user. The server should then create a homedir (via pam\_mkhomedir). The server is a member of an active directory, PAM is configured to authenticate via samba/winbind and create home directories for users on their first login. This works perfectly for e.g. ssh or other services but not for xrdp.

I had a look at bugs [#182](https://github.com/neutrinolabs/xrdp/issues/182) and [#196](https://github.com/neutrinolabs/xrdp/issues/196) which seem similar but have a different background. The problem of these referenced bugs is that VNC needs some time to start up before connecting to it - so a timeout (loop) has been implemented. This is not the case here.

In this bug, VNC starts but there seems to be a problem with the order a full PAM based authentification. xrdp is supposed to first do the PAM authentication (which would initially creating a users' home directory) and then start VNC. This seems not to work as expected somehow... In general, the home directory gets created somewhen, but obviously too late in the process so that VNC spits out the error lines

```
[20160229-15:51:49] [ERROR] env_set_user: error creating .vnc dir
[20160229-15:51:49] [WARN ] can't write vnc password hash file - /home/DOMAIN/username/.vnc/sesman_username_passwd

```

If I kill the Xvnc process (or completely restart xrdp) and try it again (after the homedir got created while the first login try), it works. If I create the user's home directory manually it also works.

I wasn't able to let PAM create the homedir before VNC starts, I tried almost every possible order of "session" entries (especially those with pam\_mkhomedir.so at the beginning).

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


