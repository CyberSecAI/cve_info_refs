```
{
  "CVE-2017-6967": {
    "related": true,
    "summary": "xrdp 0.9.1 calls the PAM function auth_start_session() in an incorrect location, leading to PAM session modules not being properly initialized.",
    "details": {
      "root_cause": "The vulnerability stems from xrdp calling the PAM function `auth_start_session()` after the X server is started, instead of before forking the process. This incorrect sequence prevents PAM session modules from being properly initialized.",
      "weaknesses": [
        "Incorrect PAM session management",
        "Improper initialization of PAM modules"
      ],
      "impact": "The improper initialization of PAM session modules can lead to several security issues, including:\n\n*   **Bypass of pam_limits.so:** User session limits defined in PAM are not correctly applied.\n*   **Incorrect umask settings:** The user's umask may not be set correctly, leading to files being created with insecure permissions.\n*   **Incorrect SELinux context:** The SELinux context may not be correctly set up, leading to privilege escalation.\n*   **Ability to login to restricted machines**: User may gain access to machines they are not authorized to access.",
      "attack_vectors": "The attack vector is network-based, as the vulnerability is exploited through the xrdp service, which is typically accessible over a network.",
      "required_capabilities": "An attacker needs to be able to connect to the xrdp service. No specific privileges are required."
    },
     "affected_versions": "xrdp 0.9.1 and potentially earlier versions",
    "references": [
        "https://nvd.nist.gov/vuln/detail/CVE-2017-6967",
        "https://github.com/neutrinolabs/xrdp/issues/350",
        "https://github.com/neutrinolabs/xrdp/pull/694",
        "https://bugs.launchpad.net/ubuntu/+source/xrdp/+bug/1672742"
    ]
  }
}
```