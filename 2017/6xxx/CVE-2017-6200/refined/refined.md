Based on the provided information, here's an analysis of CVE-2017-6200:

**Description:** CVE-2017-6200 is an Insecure Direct Object Reference vulnerability in Sandstorm. Specifically, it relates to insufficient path validation when building ZIP backups of Sandstorm grains (application containers).

**Root Cause:** The vulnerability stems from two primary issues:
1.  **Incomplete blacklist:** The Sandstorm backup process aimed to hide sensitive directories like `/var`, `/proc`, and `/etc` from the `zip` utility during backup creation. However, it failed to also blacklist `/etc.host` and `/run.host`, which are aliases for the host system's `/etc` and `/run` directories, respectively.
2.  **Insufficient newline validation:** The list of files to be included in the ZIP archive was passed to the `zip` utility via standard input, with filenames delimited by newlines. While Sandstorm attempted to check for newline characters within filenames, the check was not performed in all code paths, specifically when an empty directory existed within the grain.

**Attack Vector:** A malicious user could create a Sandstorm grain containing a specially crafted directory name with an embedded newline character and a path to a sensitive file outside the intended sandbox (e.g., `/var/blah\n/etc.host/passwd`). When a backup of this grain was created, the `zip` utility would include the contents of the targeted sensitive file (e.g., `/etc/passwd`) in the resulting ZIP archive.

**Impact:** Successful exploitation of this vulnerability could lead to a minor data leak. An attacker with permission to create grains could potentially read files located in the server's `/etc` and `/run` directories that are world-readable or readable by the Sandstorm service account. This could expose sensitive information, although files containing critical secrets would typically be protected from unauthorized access.

**Severity:** Low to Moderate. The severity is considered low because only a limited set of files were exposed, and files containing critical secrets would usually be protected.

**Fix:** The vulnerability was addressed by:
1.  Correcting the filename validation to ensure that newline characters are never permitted in filenames.
2.  Switching the zip sandbox to use a whitelist of allowed top-level directories instead of a blacklist of disallowed directories.  This prevents inadvertently missing sensitive directories.

**Attacker Capabilities:**
*   Attacker needs to be a "full user" of the Sandstorm server, meaning they have permission to create grains (install apps).
*   Attacker needs the ability to create files and directories within a Sandstorm grain.

**Affected Code:** `src/sandstorm/backup.c++`

**Commits fixing the issue:**
*   [4ea8df7](https://github.com/sandstorm-io/sandstorm/commit/4ea8df7403381d9b657b121b3c98d8081b27414d)
*   [6e8572e](https://github.com/sandstorm-io/sandstorm/commit/6e8572ea8bb56d0216bb1b410e5040edc051b120)