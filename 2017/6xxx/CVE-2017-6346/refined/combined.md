=== Content from source.android.com_dfb8c0dc_20250125_185448.html ===


[![Android Open Source Project](https://www.gstatic.com/devrel-devsite/prod/v2c0608cfe9941cacf4435921a2ece588be3719df069d9fba67130a84e4743128/androidsource/images/lockup.svg)](/)

`/`

* English
* Deutsch
* Español
* Español – América Latina
* Français
* Indonesia
* Italiano
* Polski
* Português
* Português – Brasil
* Tiếng Việt
* Türkçe
* Русский
* עברית
* العربيّة
* فارسی
* हिंदी
* বাংলা
* ภาษาไทย
* 中文 – 简体
* 中文 – 繁體
* 日本語
* 한국어

[Android Code Search](https://cs.android.com/android/platform/superproject/main)
Sign in

* [Documentation](https://source.android.com/docs)

[What's New?](https://source.android.com/docs/whatsnew)

[Getting Started](https://source.android.com/docs/setup)

[Security](https://source.android.com/docs/security)

[Core Topics](https://source.android.com/docs/core)

[Compatibility](https://source.android.com/docs/compatibility)

[Android Devices](https://source.android.com/docs/devices)

[Automotive](https://source.android.com/docs/automotive)

[Reference](https://source.android.com/reference)

[![Android Open Source Project](https://www.gstatic.com/devrel-devsite/prod/v2c0608cfe9941cacf4435921a2ece588be3719df069d9fba67130a84e4743128/androidsource/images/lockup.svg)](/)

* [Docs](/docs)
  + More
  + [What's New?](/docs/whatsnew)
  + [Getting Started](/docs/setup)
  + [Security](/docs/security)
  + [Core Topics](/docs/core)
  + [Compatibility](/docs/compatibility)
  + [Android Devices](/docs/devices)
  + [Automotive](/docs/automotive)
  + [Reference](/reference)
* [Android Code Search](https://cs.android.com/android/platform/superproject/main)

* [Overview](/docs/security)
* Security overview
  + [Secure an Android device](/docs/security/overview)
  + [Kernel security](/docs/security/overview/kernel-security)
  + [App security](/docs/security/overview/app-security)
  + [Implement security](/docs/security/overview/implement)
  + [Updates and resources](/docs/security/overview/updates-resources)
  + [ASPIRE](/docs/security/overview/aspire)
  + [Reports](/docs/security/overview/reports)
  + [Enhancements](/docs/security/enhancements)
  + [Acknowledgements](/docs/security/overview/acknowledgements)
* Android Security Bulletins
  + [Bulletins home](/docs/security/bulletin)
  + [Overview](/docs/security/bulletin/asb-overview)
  + 2025 bulletins
    - [January](/docs/security/bulletin/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/2024-12-01)
    - [November](/docs/security/bulletin/2024-11-01)
    - [October](/docs/security/bulletin/2024-10-01)
    - [September](/docs/security/bulletin/2024-09-01)
    - [August](/docs/security/bulletin/2024-08-01)
    - [July](/docs/security/bulletin/2024-07-01)
    - [June](/docs/security/bulletin/2024-06-01)
    - [May](/docs/security/bulletin/2024-05-01)
    - [April](/docs/security/bulletin/2024-04-01)
    - [March](/docs/security/bulletin/2024-03-01)
    - [February](/docs/security/bulletin/2024-02-01)
    - [January](/docs/security/bulletin/2024-01-01)
    - [Android 15](/docs/security/bulletin/android-15)
  + 2023 bulletins
    - [December](/docs/security/bulletin/2023-12-01)
    - [November](/docs/security/bulletin/2023-11-01)
    - [October](/docs/security/bulletin/2023-10-01)
    - [September](/docs/security/bulletin/2023-09-01)
    - [August](/docs/security/bulletin/2023-08-01)
    - [July](/docs/security/bulletin/2023-07-01)
    - [June](/docs/security/bulletin/2023-06-01)
    - [May](/docs/security/bulletin/2023-05-01)
    - [April](/docs/security/bulletin/2023-04-01)
    - [March](/docs/security/bulletin/2023-03-01)
    - [February](/docs/security/bulletin/2023-02-01)
    - [January](/docs/security/bulletin/2023-01-01)
    - [Android 14](/docs/security/bulletin/android-14)
  + 2022 bulletins
    - [December](/docs/security/bulletin/2022-12-01)
    - [November](/docs/security/bulletin/2022-11-01)
    - [October](/docs/security/bulletin/2022-10-01)
    - [September](/docs/security/bulletin/2022-09-01)
    - [August](/docs/security/bulletin/2022-08-01)
    - [July](/docs/security/bulletin/2022-07-01)
    - [June](/docs/security/bulletin/2022-06-01)
    - [May](/docs/security/bulletin/2022-05-01)
    - [April](/docs/security/bulletin/2022-04-01)
    - [March](/docs/security/bulletin/2022-03-01)
    - [Android 12L](/docs/security/bulletin/android-12l)
    - [February](/docs/security/bulletin/2022-02-01)
    - [January](/docs/security/bulletin/2022-01-01)
    - [Android 13](/docs/security/bulletin/android-13)
    - [Index](/docs/security/bulletin/2022)
  + 2021 bulletins
    - [December](/docs/security/bulletin/2021-12-01)
    - [November](/docs/security/bulletin/2021-11-01)
    - [October](/docs/security/bulletin/2021-10-01)
    - [September](/docs/security/bulletin/2021-09-01)
    - [August](/docs/security/bulletin/2021-08-01)
    - [July](/docs/security/bulletin/2021-07-01)
    - [June](/docs/security/bulletin/2021-06-01)
    - [May](/docs/security/bulletin/2021-05-01)
    - [April](/docs/security/bulletin/2021-04-01)
    - [March](/docs/security/bulletin/2021-03-01)
    - [February](/docs/security/bulletin/2021-02-01)
    - [January](/docs/security/bulletin/2021-01-01)
    - [Android 12](/docs/security/bulletin/android-12)
    - [Index](/docs/security/bulletin/2021)
  + 2020 bulletins
    - [December](/docs/security/bulletin/2020-12-01)
    - [November](/docs/security/bulletin/2020-11-01)
    - [October](/docs/security/bulletin/2020-10-01)
    - [September](/docs/security/bulletin/2020-09-01)
    - [August](/docs/security/bulletin/2020-08-01)
    - [July](/docs/security/bulletin/2020-07-01)
    - [June](/docs/security/bulletin/2020-06-01)
    - [May](/docs/security/bulletin/2020-05-01)
    - [April](/docs/security/bulletin/2020-04-01)
    - [March](/docs/security/bulletin/2020-03-01)
    - [February](/docs/security/bulletin/2020-02-01)
    - [January](/docs/security/bulletin/2020-01-01)
    - [Android 11](/docs/security/bulletin/android-11)
    - [Index](/docs/security/bulletin/2020)
  + 2019 bulletins
    - [December](/docs/security/bulletin/2019-12-01)
    - [November](/docs/security/bulletin/2019-11-01)
    - [October](/docs/security/bulletin/2019-10-01)
    - [September](/docs/security/bulletin/2019-09-01)
    - [August](/docs/security/bulletin/2019-08-01)
    - [July](/docs/security/bulletin/2019-07-01)
    - [June](/docs/security/bulletin/2019-06-01)
    - [May](/docs/security/bulletin/2019-05-01)
    - [April](/docs/security/bulletin/2019-04-01)
    - [March](/docs/security/bulletin/2019-03-01)
    - [February](/docs/security/bulletin/2019-02-01)
    - [January](/docs/security/bulletin/2019-01-01)
    - [Android 10](/docs/security/bulletin/android-10)
    - [Index](/docs/security/bulletin/2019)
  + 2018 bulletins
    - [December](/docs/security/bulletin/2018-12-01)
    - [November](/docs/security/bulletin/2018-11-01)
    - [October](/docs/security/bulletin/2018-10-01)
    - [September](/docs/security/bulletin/2018-09-01)
    - [August](/docs/security/bulletin/2018-08-01)
    - [July](/docs/security/bulletin/2018-07-01)
    - [June](/docs/security/bulletin/2018-06-01)
    - [May](/docs/security/bulletin/2018-05-01)
    - [April](/docs/security/bulletin/2018-04-01)
    - [March](/docs/security/bulletin/2018-03-01)
    - [February](/docs/security/bulletin/2018-02-01)
    - [January](/docs/security/bulletin/2018-01-01)
    - [Index](/docs/security/bulletin/2018)
  + 2017 bulletins
    - [December](/docs/security/bulletin/2017-12-01)
    - [November](/docs/security/bulletin/2017-11-01)
    - [October](/docs/security/bulletin/2017-10-01)
    - [September](/docs/security/bulletin/2017-09-01)
    - [August](/docs/security/bulletin/2017-08-01)
    - [July](/docs/security/bulletin/2017-07-01)
    - [June](/docs/security/bulletin/2017-06-01)
    - [May](/docs/security/bulletin/2017-05-01)
    - [April](/docs/security/bulletin/2017-04-01)
    - [March](/docs/security/bulletin/2017-03-01)
    - [February](/docs/security/bulletin/2017-02-01)
    - [January](/docs/security/bulletin/2017-01-01)
    - [Index](/docs/security/bulletin/2017)
  + 2016 bulletins
    - [December](/docs/security/bulletin/2016-12-01)
    - [November](/docs/security/bulletin/2016-11-01)
    - [October](/docs/security/bulletin/2016-10-01)
    - [September](/docs/security/bulletin/2016-09-01)
    - [August](/docs/security/bulletin/2016-08-01)
    - [July](/docs/security/bulletin/2016-07-01)
    - [June](/docs/security/bulletin/2016-06-01)
    - [May](/docs/security/bulletin/2016-05-01)
    - [April](/docs/security/bulletin/2016-04-02)
    - [March](/docs/security/bulletin/2016-03-01)
    - [February](/docs/security/bulletin/2016-02-01)
    - [January](/docs/security/bulletin/2016-01-01)
    - [Index](/docs/security/bulletin/2016)
  + 2015 bulletins
    - [December](/docs/security/bulletin/2015-12-01)
    - [November](/docs/security/bulletin/2015-11-01)
    - [October](/docs/security/bulletin/2015-10-01)
    - [September](/docs/security/bulletin/2015-09-01)
    - [August](/docs/security/bulletin/2015-08-01)
    - [Index](/docs/security/bulletin/2015)
  + Pixel/Nexus bulletins
  + [Overview](/docs/security/bulletin/pixel)
  + 2025 bulletins
    - [January](/docs/security/bulletin/pixel/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/pixel/2024-12-01)
    - [November](/docs/security/bulletin/pixel/2024-11-01)
    - [October](/docs/security/bulletin/pixel/2024-10-01)
    - [September](/docs/security/bulletin/pixel/2024-09-01)
    - [August](/docs/security/bulletin/pixel/2024-08-01)
    - [July](/docs/security/bulletin/pixel/2024-07-01)
    - [June](/docs/security/bulletin/pixel/2024-06-01)
    - [May](/docs/security/bulletin/pixel/2024-05-01)
    - [April](/docs/security/bulletin/pixel/2024-04-01)
    - [March](/docs/security/bulletin/pixel/2024-03-01)
    - [February](/docs/security/bulletin/pixel/2024-02-01)
    - [January](/docs/security/bulletin/pixel/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/pixel/2023-12-01)
    - [November](/docs/security/bulletin/pixel/2023-11-01)
    - [October](/docs/security/bulletin/pixel/2023-10-01)
    - [September](/docs/security/bulletin/pixel/2023-09-01)
    - [August](/docs/security/bulletin/pixel/2023-08-01)
    - [July](/docs/security/bulletin/pixel/2023-07-01)
    - [June](/docs/security/bulletin/pixel/2023-06-01)
    - [May](/docs/security/bulletin/pixel/2023-05-01)
    - [April](/docs/security/bulletin/pixel/2023-04-01)
    - [March](/docs/security/bulletin/pixel/2023-03-01)
    - [February](/docs/security/bulletin/pixel/2023-02-01)
    - [January](/docs/security/bulletin/pixel/2023-01-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/pixel/2022-12-01)
    - [November](/docs/security/bulletin/pixel/2022-11-01)
    - [October](/docs/security/bulletin/pixel/2022-10-01)
    - [September](/docs/security/bulletin/pixel/2022-09-01)
    - [August](/docs/security/bulletin/pixel/2022-08-01)
    - [July](/docs/security/bulletin/pixel/2022-07-01)
    - [June](/docs/security/bulletin/pixel/2022-06-01)
    - [May](/docs/security/bulletin/pixel/2022-05-01)
    - [April](/docs/security/bulletin/pixel/2022-04-01)
    - [March](/docs/security/bulletin/pixel/2022-03-01)
    - [February](/docs/security/bulletin/pixel/2022-02-01)
    - [January](/docs/security/bulletin/pixel/2022-01-01)
  + 2021 bulletins
    - [December](/docs/security/bulletin/pixel/2021-12-01)
    - [November](/docs/security/bulletin/pixel/2021-11-01)
    - [October](/docs/security/bulletin/pixel/2021-10-01)
    - [September](/docs/security/bulletin/pixel/2021-09-01)
    - [August](/docs/security/bulletin/pixel/2021-08-01)
    - [July](/docs/security/bulletin/pixel/2021-07-01)
    - [June](/docs/security/bulletin/pixel/2021-06-01)
    - [May](/docs/security/bulletin/pixel/2021-05-01)
    - [April](/docs/security/bulletin/pixel/2021-04-01)
    - [March](/docs/security/bulletin/pixel/2021-03-01)
    - [February](/docs/security/bulletin/pixel/2021-02-01)
    - [January](/docs/security/bulletin/pixel/2021-01-01)
    - [Index](/docs/security/bulletin/pixel/2021)
  + 2020 bulletins
    - [December](/docs/security/bulletin/pixel/2020-12-01)
    - [November](/docs/security/bulletin/pixel/2020-11-01)
    - [October](/docs/security/bulletin/pixel/2020-10-01)
    - [September](/docs/security/bulletin/pixel/2020-09-01)
    - [August](/docs/security/bulletin/pixel/2020-08-01)
    - [July](/docs/security/bulletin/pixel/2020-07-01)
    - [June](/docs/security/bulletin/pixel/2020-06-01)
    - [May](/docs/security/bulletin/pixel/2020-05-01)
    - [April](/docs/security/bulletin/pixel/2020-04-01)
    - [March](/docs/security/bulletin/pixel/2020-03-01)
    - [February](/docs/security/bulletin/pixel/2020-02-01)
    - [January](/docs/security/bulletin/pixel/2020-01-01)
    - [Index](/docs/security/bulletin/pixel/2020)
  + 2019 bulletins
    - [December](/docs/security/bulletin/pixel/2019-12-01)
    - [November](/docs/security/bulletin/pixel/2019-11-01)
    - [October](/docs/security/bulletin/pixel/2019-10-01)
    - [September](/docs/security/bulletin/pixel/2019-09-01)
    - [August](/docs/security/bulletin/pixel/2019-08-01)
    - [July](/docs/security/bulletin/pixel/2019-07-01)
    - [June](/docs/security/bulletin/pixel/2019-06-01)
    - [May](/docs/security/bulletin/pixel/2019-05-01)
    - [April](/docs/security/bulletin/pixel/2019-04-01)
    - [March](/docs/security/bulletin/pixel/2019-03-01)
    - [February](/docs/security/bulletin/pixel/2019-02-01)
    - [January](/docs/security/bulletin/pixel/2019-01-01)
    - [Index](/docs/security/bulletin/pixel/2019)
  + 2018 bulletins
    - [December](/docs/security/bulletin/pixel/2018-12-01)
    - [November](/docs/security/bulletin/pixel/2018-11-01)
    - [October](/docs/security/bulletin/pixel/2018-10-01)
    - [September](/docs/security/bulletin/pixel/2018-09-01)
    - [August](/docs/security/bulletin/pixel/2018-08-01)
    - [July](/docs/security/bulletin/pixel/2018-07-01)
    - [June](/docs/security/bulletin/pixel/2018-06-01)
    - [May](/docs/security/bulletin/pixel/2018-05-01)
    - [April](/docs/security/bulletin/pixel/2018-04-01)
    - [March](/docs/security/bulletin/pixel/2018-03-01)
    - [February](/docs/security/bulletin/pixel/2018-02-01)
    - [January](/docs/security/bulletin/pixel/2018-01-01)
    - [Index](/docs/security/bulletin/pixel/2018)
  + 2017 bulletins
    - [December](/docs/security/bulletin/pixel/2017-12-01)
    - [November](/docs/security/bulletin/pixel/2017-11-01)
    - [October](/docs/security/bulletin/pixel/2017-10-01)
    - [Index](/docs/security/bulletin/pixel/2017)
  + Android Automotive
  + [Overview](/docs/security/bulletin/aaos)
  + 2025 bulletins
    - [January](/docs/security/bulletin/aaos/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/aaos/2024-12-01)
    - [November](/docs/security/bulletin/aaos/2024-11-01)
    - [October](/docs/security/bulletin/aaos/2024-10-01)
    - [September](/docs/security/bulletin/aaos/2024-09-01)
    - [August](/docs/security/bulletin/aaos/2024-08-01)
    - [July](/docs/security/bulletin/aaos/2024-07-01)
    - [June](/docs/security/bulletin/aaos/2024-06-01)
    - [May](/docs/security/bulletin/aaos/2024-05-01)
    - [April](/docs/security/bulletin/aaos/2024-04-01)
    - [March](/docs/security/bulletin/aaos/2024-03-01)
    - [February](/docs/security/bulletin/aaos/2024-02-01)
    - [January](/docs/security/bulletin/aaos/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/aaos/2023-12-01)
    - [November](/docs/security/bulletin/aaos/2023-11-01)
    - [October](/docs/security/bulletin/aaos/2023-10-01)
    - [September](/docs/security/bulletin/aaos/2023-09-01)
    - [August](/docs/security/bulletin/aaos/2023-08-01)
    - [July](/docs/security/bulletin/aaos/2023-07-01)
    - [June](/docs/security/bulletin/aaos/2023-06-01)
    - [May](/docs/security/bulletin/aaos/2023-05-01)
    - [April](/docs/security/bulletin/aaos/2023-04-01)
    - [March](/docs/security/bulletin/aaos/2023-03-01)
    - [February](/docs/security/bulletin/aaos/2023-02-01)
    - [January](/docs/security/bulletin/aaos/2023-01-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/aaos/2022-12-01)
    - [November](/docs/security/bulletin/aaos/2022-11-01)
    - [October](/docs/security/bulletin/aaos/2022-10-01)
    - [September](/docs/security/bulletin/aaos/2022-09-01)
    - [August](/docs/security/bulletin/aaos/2022-08-01)
    - [July](/docs/security/bulletin/aaos/2022-07-01)
    - [June](/docs/security/bulletin/aaos/2022-06-01)
    - [May](/docs/security/bulletin/aaos/2022-05-01)
    - [April](/docs/security/bulletin/aaos/2022-04-01)
    - [March](/docs/security/bulletin/aaos/2022-03-01)
    - [February](/docs/security/bulletin/aaos/2022-02-01)
    - [January](/docs/security/bulletin/aaos/2022-01-01)
  + 2021 bulletins
    - [December](/docs/security/bulletin/aaos/2021-12-01)
    - [November](/docs/security/bulletin/aaos/2021-11-01)
    - [October](/docs/security/bulletin/aaos/2021-10-01)
    - [September](/docs/security/bulletin/aaos/2021-09-01)
    - [August](/docs/security/bulletin/aaos/2021-08-01)
    - [July](/docs/security/bulletin/aaos/2021-07-01)
    - [June](/docs/security/bulletin/aaos/2021-06-01)
    - [May](/docs/security/bulletin/aaos/2021-05-01)
    - [April](/docs/security/bulletin/aaos/2021-04-01)
    - [March](/docs/security/bulletin/aaos/2021-03-01)
    - [February](/docs/security/bulletin/aaos/2021-02-01)
    - [January](/docs/security/bulletin/aaos/2021-01-01)
  + Chromecast
  + [Overview](/docs/security/bulletin/chromecast)
  + 2024 bulletins
    - [December](/docs/security/bulletin/chromecast/2024-12-01)
    - [September](/docs/security/bulletin/chromecast/2024-09-01)
    - [July](/docs/security/bulletin/chromecast/2024-07-01)
    - [March](/docs/security/bulletin/chromecast/2024-03-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/chromecast/2023-12-01)
    - [September](/docs/security/bulletin/chromecast/2023-07-01)
    - [June](/docs/security/bulletin/chromecast/2023-06-01)
    - [April](/docs/security/bulletin/chromecast/2023-04-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/chromecast/2022-12-01)
    - [October](/docs/security/bulletin/chromecast/2022-10-01)
    - [July](/docs/security/bulletin/chromecast/2022-07-01)
  + Wear
  + [Overview](/docs/security/bulletin/wear)
  + 2025 bulletins
    - [January](/docs/security/bulletin/wear/2025/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/wear/2024/2024-12-01)
    - [November](/docs/security/bulletin/wear/2024/2024-11-01)
    - [October](/docs/security/bulletin/wear/2024/2024-10-01)
    - [September](/docs/security/bulletin/wear/2024/2024-09-01)
    - [August](/docs/security/bulletin/wear/2024/2024-08-01)
    - [July](/docs/security/bulletin/wear/2024/2024-07-01)
    - [June](/docs/security/bulletin/wear/2024/2024-06-01)
    - [May](/docs/security/bulletin/wear/2024/2024-05-01)
    - [April](/docs/security/bulletin/wear/2024/2024-04-01)
    - [March](/docs/security/bulletin/wear/2024/2024-03-01)
    - [February](/docs/security/bulletin/wear/2024/2024-02-01)
    - [January](/docs/security/bulletin/wear/2024/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/wear/2023/2023-12-01)
    - [November](/docs/security/bulletin/wear/2023/2023-11-01)
    - [October](/docs/security/bulletin/wear/2023/2023-10-01)
    - [September](/docs/security/bulletin/wear/2023/2023-09-01)
    - [August](/docs/security/bulletin/wear/2023/2023-08-01)
  + Pixel Watch
  + [Overview](/docs/security/bulletin/pixel-watch)
  + 2024 bulletins
    - [December](/docs/security/bulletin/pixel-watch/2024-12-01)
    - [August](/docs/security/bulletin/pixel-watch/2024-08-01)
    - [July](/docs/security/bulletin/pixel-watch/2024-07-01)
    - [June](/docs/security/bulletin/pixel-watch/2024-06-01)
    - [May](/docs/security/bulletin/pixel-watch/2024-05-01)
    - [April](/docs/security/bulletin/pixel-watch/2024-04-01)
    - [March](/docs/security/bulletin/pixel-watch/2024-03-01)
    - [February](/docs/security/bulletin/pixel-watch/2024-02-01)
    - [January](/docs/security/bulletin/pixel-watch/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/pixel-watch/2023/2023-12-01)
    - [September](/docs/security/bulletin/pixel-watch/2023/2023-09-01)
    - [June](/docs/security/bulletin/pixel-watch/2023/2023-06-01)
  + Advisories
  + [Overview](/docs/security/bulletin/advisory)
  + [March 2016](/docs/security/bulletin/advisory/2016-03-18)
* Features
  + [Overview](/docs/security/features)
  + [Application Sandbox](/docs/security/app-sandbox)
  + [OMAPI vendor stable interface](/docs/security/features/open-mobile-api)
  + App signing
    - [Overview](/docs/security/features/apksigning)
    - [APK signature scheme v2](/docs/security/features/apksigning/v2)
    - [APK signature scheme v3](/docs/security/features/apksigning/v3)
    - [APK signature scheme v3.1](/docs/security/features/apksigning/v3-1)
    - [APK signature scheme v4](/docs/security/features/apksigning/v4)
  + Authentication
    - [Overview](/docs/security/features/authentication)
    - [Gatekeeper](/docs/security/features/authentication/gatekeeper)
    - Biometrics
      * [Overview](/docs/security/features/biometric)
      * [Measure biometric security](/docs/security/features/biometric/measure)
      * [Fingerprint HIDL](/docs/security/features/authentication/fingerprint-hal)
      * [Face authentication HIDL](/docs/security/features/biometric/face-authentication)
    - Protected confirmation
      * [Overview](/docs/security/features/protected-confirmation)
      * [Implementation](/docs/security/features/protected-confirmation/implementation)
      * [Design guidelines](/docs/security/features/protected-confirmation/design)
      * [Accessibility](/docs/security/features/protected-confirmation/accessibility)
  + DICE
    - [Overview](/docs/security/features/dice)
    - [Applications of DICE](/docs/security/features/dice/applications-of-dice)
  + Encryption
    - [Overview](/docs/security/features/encryption)
    - [File-based encryption](/docs/security/features/encryption/file-based)
    - [Full-disk encryption](/docs/security/features/encryption/full-disk)
    - [Metadata encryption](/docs/security/features/encryption/metadata)
    - [Enable Adiantum](/docs/security/features/encryption/adiantum)
    - [Hardware-wrapped keys](/docs/security/features/encryption/hw-wrapped-keys)
  + Keystore
    - [Overview](/docs/security/features/keystore)
    - [Features](/docs/security/features/keystore/features)
    - [Key and ID attestation](/docs/security/features/keystore/attestation)
    - [Version binding](/docs/security/features/keystore/version-binding)
    - [Authorization tags](/docs/security/features/keystore/tags)
    - [Functions](/docs/security/features/keystore/implementer-ref)
  + Identity credential
    - [Overview](/docs/security/features/identity-credentials)
  + SELinux
    - [Overview](/docs/security/features/selinux)
    - [Concepts](/docs/security/features/selinux/concepts)
    - [Implementation](/docs/security/features/selinux/implement)
    - [Customization](/docs/security/features/selinux/customize)
    - [Build sepolicy](/docs/security/features/selinux/build)
    - [Compatibility](/docs/security/features/selinux/compatibility)
    - [Validation](/docs/security/features/selinux/validate)
    - [Write policy](/docs/security/features/selinux/device-policy)
    - [Vendor init](/docs/security/features/selinux/vendor-init)
  + Trusty TEE
    - [Overview](/docs/security/features/trusty)
    - [Download and build](/docs/security/features/trusty/download-and-build)
    - [Trusty API reference](/docs/security/features/trusty/trusty-ref)
  + Verified Boot
    - [Overview](/docs/security/features/verifiedboot)
    - [Device state](/docs/security/features/verifiedboot/device-state)
    - [Verify Boot](/docs/security/features/verifiedboot/verified-boot)
    - [Boot flow](/docs/security/features/verifiedboot/boot-flow)
    - [Implement dm-verity](/docs/security/features/verifiedboot/dm-verity)
    - [Verify system\_other partition](/docs/security/features/verifiedboot/verify-system-other-partition)
    - [Reference implementation](/docs/security/features/verifiedboot/avb)
  + Safety Center
    - [Overview](/docs/security/safety-center/overview)
    - [Customize Safety Center](/docs/security/safety-center/customize)
    - [Customize Safety Center UI](/docs/security/safety-center/customize-ui)
    - [Interact with Safety Center](/docs/security/safety-center/interact)
    - [Testing and validation](/docs/security/safety-center/test-requirements)
  + Cellular security
    - [Overview](/docs/security/features/cellular-security/overview)
    - [Disable 2G](/docs/security/features/cellular-security/disable-2g)
  + [Private space](/docs/security/features/private-space)
* Testing
  + [Overview](/docs/security/test/fuzz-sanitize)
  + [Memory safety](/docs/security/test/memory-safety)
  + Arm Memory Tagging Extension
  + [Overview](/docs/security/test/memory-safety/arm-mte)
  + [Bootloader support](/docs/security/test/memory-safety/bootloader-support)
  + [Understand MTE reports](/docs/security/test/memory-safety/mte-reports)
  + [MTE configuration](/docs/security/test/memory-safety/mte-configuration)
  + Sanitizers
  + [Overview](/docs/security/test/sanitizers)
  + [AddressSanitizer](/docs/security/test/asan)
  + [Kernel AddressSanitizer](/docs/security/test/kasan)
  + [Hardware-assisted AddressSanitizer](/docs/security/test/hwasan)
  + [Understand HWASan reports](/docs/security/test/memory-safety/hwasan-reports)
  + [UndefinedBehaviorSanitizer](/docs/security/test/ubsan)
  + Other topics
  + [Control flow integrity](/docs/security/test/cfi)
  + [Kernel control flow integrity](/docs/security/test/kcfi)
  + [Execute-only memory](/docs/security/test/execute-only-memory)
  + [Fuzz with libFuzzer](/docs/security/test/libfuzzer)
  + [GWP-ASan and KFENCE](/docs/security/test/memory-safety/gwp-asan-kfence)
  + [Security Test Suite development kit](/docs/security/test/sts-sdk)
  + [Scudo](/docs/security/test/scudo)
  + [ShadowCallStack](/docs/security/test/shadow-call-stack)
  + [Tagged pointers](/docs/security/test/tagged-pointers)
  + [Zero initialized memory](/docs/security/test/memory-safety/zero-initialized-memory)
* Best practices
  + [Overview](/docs/security/best-practices)
  + [Operational security](/docs/security/best-practices/ops)
  + [System security](/docs/security/best-practices/system)
  + [App security](/docs/security/best-practices/app)
  + [Network security](/docs/security/best-practices/network)
  + [Hardware security](/docs/security/best-practices/hardware)
  + [Privacy security](/docs/security/best-practices/privacy)

* What's new?
* [Release notes](/docs/whatsnew/release-notes)
* [Latest security bulletins](/docs/whatsnew/latest-security-bulletins)
* [Latest Compatibility Definition Document (CDD)](/docs/whatsnew/latest-cdd)
* [Site updates](/docs/whatsnew/site-updates)
* Getting Started
* [About](/docs/setup/about)
* [Start](/docs/setup/start)
* [Download](/docs/setup/download)
* [Build](/docs/setup/build)
* [Test](/docs/setup/test)
* [Create](/docs/setup/create/coding-tasks)
* [Contribute](/docs/setup/contribute)
* [Community](/docs/setup/community/cofc)
* [Tools, build, and related reference](/docs/setup/reference)
* Security
* [Overview](/docs/security/overview)
* [Bulletins](/docs/security/bulletin)
* [Features](/docs/security/features)
* [Testing](/docs/security/test/fuzz-sanitize)
* [Best Practices](/docs/security/best-practices)
* Core Topics
* [Architecture](/docs/core/architecture)
* [Audio](/docs/core/audio)
* [Camera](/docs/core/camera)
* [Connectivity](/docs/core/connect)
* [Data](/docs/core/data)
* [Display](/docs/core/display)
* [Fonts](/docs/core/fonts/custom-font-fallback)
* [Graphics](/docs/core/graphics)
* [Interaction](/docs/core/interaction)
* [Media](/docs/core/media)
* [Performance](/docs/core/perf)
* [Permissions](/docs/core/permissions)
* [Power](/docs/core/power)
* [Runtime](/docs/core/runtime)
* [Settings](/docs/core/settings)
* [Storage](/docs/core/storage)
* [Tests](/docs/core/tests)
* [Updates](/docs/core/ota)
* [Virtualization](/docs/core/virtualization)
* Compatibility
* [Compatibility Definition Document (CDD)](/docs/compatibility/cdd)
* [Compatibility Test Suite (CTS)](/docs/compatibility/cts)
* Android Devices
* [Cuttlefish](/docs/devices/cuttlefish)
* [Enterprise](/docs/devices/admin)
* [TV](/docs/devices/tv)
* Automotive
* [Get Started](/docs/automotive/start/what_automotive)
* [Guidelines for Development](/docs/automotive/guidelines)
* [Development Tools](/docs/automotive/dev-tools)
* [Testing Tools and Infrastructure](/docs/automotive/tools)
* [Release Details](/docs/automotive/start/releases)
* Reference
* [HIDL](/reference/hidl)
* [HAL](/reference/hal)
* [Trade Federation](/reference/tradefed/classes)
* [Security Test Suite](/reference/sts/classes)

* [AOSP](https://source.android.com/)
* [Security](https://source.android.com/docs/security)

# Android Security Bulletin—September 2017

Stay organized with collections

Save and categorize content based on your preferences.

*Published September 5, 2017 | Updated October 5, 2017*

The Android Security Bulletin contains details of security vulnerabilities
affecting Android devices. Security patch levels of September 05, 2017 or later
address all of these issues. Refer to the [Pixel
and Nexus update schedule](https://support.google.com/pixelphone/answer/4457705#pixel_phones&nexus_devices) to learn how to check a device's security patch
level.

Partners were notified of the issues described in the bulletin at least a month
ago. Source code patches for these issues have been released to the Android Open
Source Project (AOSP) repository and linked from this bulletin. This bulletin
also includes links to patches outside of AOSP.

The most severe of these issues is a critical severity vulnerability in media
framework that could enable a remote attacker using a specially crafted file to
execute arbitrary code within the context of a privileged process. The
[severity
assessment](/docs/security/overview/updates-resources#severity) is based on the effect that exploiting the vulnerability would
possibly have on an affected device, assuming the platform and service
mitigations are turned off for development purposes or if successfully bypassed.

We have had no reports of active customer exploitation or abuse of these newly
reported issues. Refer to the
[Android and Google Play Protect mitigations](#mitigations) section
for details on the [Android
security platform protections](/docs/security/enhancements) and Google Play Protect, which improve the
security of the Android platform.

We encourage all customers to accept these updates to their devices.

**Note:** Information on the latest over-the-air update (OTA) and
firmware images for Google devices is available in the
[Google device updates](#google-device-updates) section.

## Announcements

* This bulletin has two security patch level strings to provide Android
  partners with the flexibility to more quickly fix a subset of vulnerabilities
  that are similar across all Android devices. See
  [Common questions and answers](#questions) for additional information:
  + **2017-09-01**: Partial security patch level string. This
    security patch level string indicates that all issues associated with 2017-09-01
    (and all previous security patch level strings) are addressed.
  + **2017-09-05**: Complete security patch level string. This
    security patch level string indicates that all issues associated with 2017-09-01
    and 2017-09-05 (and all previous security patch level strings) are
    addressed.

## Android and Google service mitigations

This is a summary of the mitigations provided by the
[Android security platform](/docs/security/enhancements)
and service protections such as
[Google Play Protect](https://www.android.com/play-protect). These
capabilities reduce the likelihood that security vulnerabilities could be
successfully exploited on Android.

* Exploitation for many issues on Android is made more difficult by
  enhancements in newer versions of the Android platform. We encourage all users
  to update to the latest version of Android where possible.
* The Android security team actively monitors for abuse through [Google Play Protect](https://www.android.com/play-protect) and warns
  users about [Potentially Harmful Applications](https://developers.google.com/android/play-protect/potentially-harmful-applications). Google Play Protect is enabled by default on devices
  with [Google Mobile Services](http://www.android.com/gms), and is
  especially important for users who install apps from outside of Google
  Play.

## 2017-09-01 security patch level—Vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities that apply to the 2017-09-01 patch level. Vulnerabilities are
grouped under the component that they affect. There is a description of the
issue and a table with the CVE, associated references,
[type of vulnerability](#type),
[severity](/docs/security/overview/updates-resources#severity),
and updated AOSP versions (where applicable). When available, we link the public
change that addressed the issue to the bug ID, like the AOSP change list. When
multiple changes relate to a single bug, additional references are linked to
numbers following the bug ID.

### Framework

The most severe vulnerability in this section could enable a local malicious
application to bypass user interaction requirements in order to gain access to
additional permissions.

| CVE | References | Type | Severity | Updated AOSP versions |
| CVE-2017-0752 | [A-62196835](https://android.googlesource.com/platform/frameworks/base/%2B/6ca2eccdbbd4f11698bd5312812b4d171ff3c8ce) [[2](https://android.googlesource.com/platform/packages/apps/Settings/%2B/fc65be941a4dbebfdbe53cd0bd6cc5cc1142a908)] | EoP | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |

### Libraries

The most severe vulnerability in this section could enable a remote attacker
using a specially crafted file to execute arbitrary code within the context of
an unprivileged process.

| CVE | References | Type | Severity | Updated AOSP versions |
| CVE-2017-0753 | [A-62218744](https://android.googlesource.com/platform/manifest/%2B/c0218b536c4243993bb666910d888cf16191dfd1) | RCE | High | 7.1.1, 7.1.2, 8.0 |
| CVE-2017-6983 | [A-63852675](https://android.googlesource.com/platform/external/sqlite/%2B/a1b4a910e8bf11e03479d91004652fc5919f475b) | RCE | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0755 | [A-32178311](https://android.googlesource.com/platform/frameworks/minikin/%2B/0dfb3527ba1ebbe97ad927e1f773427201aab501) | EoP | High | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |

### Media Framework

The most severe vulnerability in this section could enable a remote attacker
using a specially crafted file to execute arbitrary code within the context of
a privileged process.

| CVE | References | Type | Severity | Updated AOSP versions |
| CVE-2017-0756 | [A-34621073](https://android.googlesource.com/platform/frameworks/av/%2B/9aa026d0b867b270149dd7323ce36f4f9bfea980) | RCE | Critical | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0757 | [A-36006815](https://android.googlesource.com/platform/external/libavc/%2B/bb88d4430189b66270c66ff9167fc5bcf4356cf2) | RCE | Critical | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0758 | [A-36492741](https://android.googlesource.com/platform/external/libhevc/%2B/4a534a34b14944f3513b7c101fc74ab0ec9eac0d) | RCE | Critical | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0759 | [A-36715268](https://android.googlesource.com/platform/frameworks/av/%2B/6c91acf543ea20281f7e3d83414fab3cc64f1938) | RCE | Critical | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0760 | [A-37237396](https://android.googlesource.com/platform/frameworks/av/%2B/9cb10d49b1319ea1207cc2f445089aa9266ffc71) | RCE | Critical | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0761 | [A-38448381](https://android.googlesource.com/platform/external/libavc/%2B/ce512058186120a0de2916f6e22be58455df1a49) | RCE | Critical | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0762 | [A-62214264](https://android.googlesource.com/platform/external/libhevc/%2B/50acbc692998474c598834c9453ca9675b8fb95b) | RCE | Critical | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0763 | [A-62534693](https://android.googlesource.com/platform/external/libhevc/%2B/0b57e70715c17e038b2fec0f808c1cd2172f4775) | RCE | Critical | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0764 | [A-62872015](https://android.googlesource.com/platform/external/tremolo/%2B/dbf3d0fa7b89aa09ec7bf69699f6233c59070dbc) | RCE | Critical | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0765 | [A-62872863](https://android.googlesource.com/platform/frameworks/av/%2B/7c4c7fa208e31dc6f355a4488f267122015730a3) | RCE | Critical | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0766 | [A-37776688](https://android.googlesource.com/platform/manifest/%2B/c0218b536c4243993bb666910d888cf16191dfd1) | RCE | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0767 | [A-37536407](https://android.googlesource.com/platform/frameworks/av/%2B/2410a6fa4286efc8c5b5a5f33f6eeb023bfb6abb) [[2](https://android.googlesource.com/platform/hardware/qcom/audio/%2B/045e30499e3c73fb05b0a97da2420fd27bb263a3)] | EoP | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0768 | [A-62019992](https://android.googlesource.com/platform/frameworks/av/%2B/d8cc1fe9294accf05c6afcbe7821a485b9939af7) | EoP | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0769 | [A-37662122](https://android.googlesource.com/platform/frameworks/av/%2B/0be8a2541594feec746195d6dbbc0db6c602175e) | EoP | High | 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0770 | [A-38234812](https://android.googlesource.com/platform/frameworks/av/%2B/292d85545c6dec3c4386ec1fc2877597ea0ac5cc) | EoP | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0771 | [A-37624243](https://android.googlesource.com/platform/external/skia/%2B/f593adeec75fe65771dfe67deca33fa4434b4e8a) | DoS | High | 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0772 | [A-38115076](https://android.googlesource.com/platform/external/libavc/%2B/1e0b52c25b20685ff9d6a14603b6a30f698824a7) | DoS | High | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0773 | [A-37615911](https://android.googlesource.com/platform/external/libhevc/%2B/9a03f9511559f82d034603e1df1425a4e0650f92) | DoS | High | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0774 | [A-62673844](https://android.googlesource.com/platform/frameworks/av/%2B/d4af2450c500c7d153fd66771b613f6e6882bf08) [[2](https://android.googlesource.com/platform/frameworks/av/%2B/5f56ec847a7f6250abd36a2f8a7b7baf4f966d11)] | DoS | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0775 | [A-62673179](https://android.googlesource.com/platform/frameworks/av/%2B/a1d5b40aaaa050af40c0f95d8b2d3e1ae8cfebbf) | DoS | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0776 | [A-38496660](https://android.googlesource.com/platform/external/libavc/%2B/5863b2e39357d82d53b3163afd38ad3bb0a07042) | ID | Moderate | 7.0, 7.1.1, 7.1.2, 8.0 |
| DoS | High | 6.0.1 |
| CVE-2017-0777 | [A-38342499](https://android.googlesource.com/platform/external/sonivox/%2B/112d9533b13134edbf4b7ee17db735b4b1468297) | ID | Moderate | 7.0, 7.1.1, 7.1.2 |
| DoS | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 |
| CVE-2017-0778 | [A-62133227](https://android.googlesource.com/platform/frameworks/av/%2B/d7a044350bc151c7f7c04e04aaf136488630d655) | ID | Moderate | 7.0, 7.1.1, 7.1.2 |
| DoS | High | 5.0.2, 5.1.1, 6.0, 6.0.1 |
| CVE-2017-0779 | [A-38340117](https://android.googlesource.com/platform/frameworks/av/%2B/ff4c8310ab7976ea9930b1dc4e3383720d5b5a8d) [[2](https://android.googlesource.com/platform/frameworks/av/%2B/b58464fa783c75ba9d304f670a4392df6fa98ed8)] | ID | Moderate | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |

### Runtime

The most severe vulnerability in this section could enable a remote attacker
using a specially crafted file to cause an application to hang.

| CVE | References | Type | Severity | Updated AOSP versions |
| CVE-2017-0780 | [A-37742976](https://android.googlesource.com/platform/packages/apps/Messaging/%2B/06cbd7f26ba58399f296d85fd155442c7f2ac837) | DoS | High | 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |

### System

The most severe vulnerability in this section could enable a proximate
attacker to execute arbitrary code within the context of a privileged
process.

| CVE | References | Type | Severity | Updated AOSP versions |
| CVE-2017-0781 | [A-63146105](https://android.googlesource.com/platform/system/bt/%2B/c513a8ff5cfdcc62cc14da354beb1dd22e56be0e) [[2](https://android.googlesource.com/platform/system/bt/%2B/1e0bb31f6a809b49014483dc118b9d9ad31ade68)] | RCE | Critical | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0782 | [A-63146237](https://android.googlesource.com/platform/system/bt/%2B/4e47f3db62bab524946c46efe04ed6a2b896b150) [[2](https://android.googlesource.com/platform/system/bt/%2B/1b08775917413f1674882130a948add1ae44cc91)] [[3](https://android.googlesource.com/platform/system/bt/%2B/c568fa9088ded964e0ac99db236e612de5d82177)] | RCE | Critical | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0783 | [A-63145701](https://android.googlesource.com/platform/system/bt/%2B/1e77fefc8b9c832239e1b32c6a6880376065e24e) | ID | High | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |
| CVE-2017-0784 | [A-37287958](https://android.googlesource.com/platform/packages/apps/Nfc/%2B/e216bc208bc0f0f685d8271ef8a0b5da8fae1088) | EoP | Moderate | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 |
| CVE-2017-0785 | [A-63146698](https://android.googlesource.com/platform/system/bt/%2B/226ea26684d4cd609a5b456d3d2cc762453c2d75) | ID | Moderate | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0, 7.1.1, 7.1.2, 8.0 |

## 2017-09-05 security patch level—Vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities that apply to the 2017-09-05 patch level. Vulnerabilities are
grouped under the component that they affect and include details such as the
CVE, associated references, [type of vulnerability](#type),
[severity](/docs/security/overview/updates-resources#severity),
component (where applicable), and updated AOSP versions (where applicable). When
available, we link the public change that addressed the issue to the bug ID,
like the AOSP change list. When multiple changes relate to a single bug,
additional references are linked to numbers following the bug ID.

### Broadcom components

The most severe vulnerability in this section could enable a proximate
attacker using a specially crafted file to execute arbitrary code within the
context of a privileged process.

| CVE | References | Type | Severity | Component |
| CVE-2017-11120 | A-62575409[\*](#asterisk) B-V2017061204 | RCE | Critical | Wi-Fi driver |
| CVE-2017-11121 | A-62576413[\*](#asterisk) B-V2017061205 | RCE | Critical | Wi-Fi driver |
| CVE-2017-7065 | A-62575138[\*](#asterisk) B-V2017061202 | RCE | Critical | Wi-Fi driver |
| CVE-2017-0786 | A-37351060[\*](#asterisk) B-V2017060101 | EoP | High | Wi-Fi driver |
| CVE-2017-0787 | A-37722970[\*](#asterisk) B-V2017053104 | EoP | Moderate | Wi-Fi driver |
| CVE-2017-0788 | A-37722328[\*](#asterisk) B-V2017053103 | EoP | Moderate | Wi-Fi driver |
| CVE-2017-0789 | A-37685267[\*](#asterisk) B-V2017053102 | EoP | Moderate | Wi-Fi driver |
| CVE-2017-0790 | A-37357704[\*](#asterisk) B-V2017053101 | EoP | Moderate | Wi-Fi driver |
| CVE-2017-0791 | A-37306719[\*](#asterisk) B-V2017052302 | EoP | Moderate | Wi-Fi driver |
| CVE-2017-0792 | A-37305578[\*](#asterisk) B-V2017052301 | ID | Moderate | Wi-Fi driver |

### Imgtk components

The most severe vulnerability in this section could enable a local malicious
application to access data outside of its permission levels.

| CVE | References | Type | Severity | Component |
| CVE-2017-0793 | A-35764946[\*](#asterisk) | ID | High | Memory subsystem |

### Kernel components

The most severe vulnerability in this section could enable a remote attacker
using a specially crafted file to execute arbitrary code within the context of
a privileged process.

| CVE | References | Type | Severity | Component |
| CVE-2017-8890 | A-38413975 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=657831ffc38e30092a2d5f03d385d710eb88b09a) | RCE | Critical | Networking subsystem |
| CVE-2017-9076 | A-62299478 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=83eaddab4378db256d00d295bda6ca997cd13a52) | EoP | High | Networking subsystem |
| CVE-2017-9150 | A-62199770 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=0d0e57697f162da4aa218b5feafe614fb666db07) | ID | High | Linux kernel |
| CVE-2017-7487 | A-62070688 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=ee0d8d8482345ff97a75a7d747efc309f13b0d80) | EoP | High | IPX protocol driver |
| CVE-2017-6214 | A-37901268 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=ccf7abb93af09ad0868ae9033d1ca8108bdaec82) | DoS | High | Networking subsystem |
| CVE-2017-6346 | A-37897645 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=d199fab63c11998a602205f7ee7ff7c05c97164b) | EoP | High | Linux kernel |
| CVE-2017-5897 | A-37871211 [Upstream kernel](https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/?id=7892032cfe67f4bde6fc2ee967e45a8fbaf33756) | ID | High | Networking subsystem |
| CVE-2017-7495 | A-62198330 [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=06bd3c36a733ac27962fea7d6f47168841376824) | ID | High | File system |
| CVE-2017-7616 | A-37751399 [Upstream kernel](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=cf01fb9985e8deb25ccf0ea54d916b8871ae0e62) | ID | Moderate | Linux kernel |
| CVE-2017-12146 | A-35676417 [Upstream kernel](https://git.kernel.org/pub/scm/linux/kernel/git/gregkh/driver-core.git/commit/?h=driver-core-next&id=6265539776a0810b7ce6398c27866ddb9c6bd154) | EoP | Moderate | Linux kernel |
| CVE-2017-0794 | A-35644812[\*](#asterisk) | EoP | Moderate | SCSI driver |

### MediaTek components

The most severe vulnerability in this section could enable a local malicious
application to execute arbitrary code within the context of a privileged
process.

| CVE | References | Type | Severity | Component |
| CVE-2017-0795 | A-36198473[\*](#asterisk) M-ALPS03361480 | EoP | High | Accessory detector driver |
| CVE-2017-0796 | A-62458865[\*](#asterisk) M-ALPS03353884 M-ALPS03353886 M-ALPS03353887 | EoP | High | AUXADC driver |
| CVE-2017-0797 | A-62459766[\*](#asterisk) M-ALPS03353854 | EoP | High | Accessory detector driver |
| CVE-2017-0798 | A-36100671[\*](#asterisk) M-ALPS03365532 | EoP | High | Kernel |
| CVE-2017-0799 | A-36731602[\*](#asterisk) M-ALPS03342072 | EoP | High | Lastbus |
| CVE-2017-0800 | A-37683975[\*](#asterisk) M-ALPS03302988 | EoP | High | TEEI |
| CVE-2017-0801 | A-38447970[\*](#asterisk) M-ALPS03337980 | EoP | High | LibMtkOmxVdec |
| CVE-2017-0802 | A-36232120[\*](#asterisk) M-ALPS03384818 | EoP | Moderate | Kernel |
| CVE-2017-0803 | A-36136137[\*](#asterisk) M-ALPS03361477 | EoP | Moderate | Accessory detector driver |
| CVE-2017-0804 | A-36274676[\*](#asterisk) M-ALPS03361487 | EoP | Moderate | MMC driver |

### Qualcomm components

The most severe vulnerability in this section could enable a remote attacker
using a specially crafted file to execute arbitrary code within the context of
a privileged process.

| CVE | References | Type | Severity | Component |
| CVE-2017-11041 | A-36130225[\*](#asterisk) QC-CR#2053101 | RCE | Critical | LibOmxVenc |
| CVE-2017-10996 | A-38198574 [QC-CR#901529](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=9f261e5dfe101bbe35043822a89bffa78e080b3b) | ID | High | Linux kernel |
| CVE-2017-9725 | A-38195738 [QC-CR#896659](https://source.codeaurora.org/quic/la/kernel/msm-4.4/commit/?h=aosp/android-4.4&id=1f8f9b566e8446c13b954220c226c58d22076f88) | EoP | High | Memory subsystem |
| CVE-2017-9724 | A-38196929 [QC-CR#863303](https://source.codeaurora.org/quic/la/kernel/msm-3.10/commit/?id=5328a92fa26eabe2ba259b1d813f9de488efc9ec) | EoP | High | Linux kernel |
| CVE-2017-8278 | A-62379474 [QC-CR#2013236](https://source.codeaurora.org/quic/la/platform/hardware/qcom/audio/commit/?id=16caa80d6bd59fc645afda37dec4104d451e2f66) | EoP | High | Audio driver |
| CVE-2017-10999 | A-36490777[\*](#asterisk) QC-CR#2010713 | EoP | Moderate | IPA driver |
| CVE-2017-11001 | A-36815555[\*](#asterisk) QC-CR#2051433 | ID | Moderate | Wi-Fi driver |
| CVE-2017-11002 | A-37712167[\*](#asterisk) QC-CR#2058452 QC-CR#2054690 QC-CR#2058455 | ID | Moderate | Wi-Fi driver |
| CVE-2017-8250 | A-62379051 [QC-CR#2003924](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=9be5b16de622c2426408425e3df29e945cd21d37) | EoP | Moderate | GPU driver |
| CVE-2017-9677 | A-62379475 [QC-CR#2022953](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=dc333eb1c31b5bdd2b6375d7cb890086d8f27d8b) | EoP | Moderate | Audio driver |
| CVE-2017-10998 | A-38195131 [QC-CR#108461](https://source.codeaurora.org/quic/la//kernel/msm-3.18/commit/?id=208e72e59c8411e75d4118b48648a5b7d42b1682) | EoP | Moderate | Audio driver |
| CVE-2017-9676 | A-62378596 [QC-CR#2016517](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=c1f749639030305a3b02185c180240a8195fb715) | ID | Moderate | File system |
| CVE-2017-8280 | A-62377236 [QC-CR#2015858](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=49b9a02eaaeb0b70608c6fbcadff7d83833b9614) | EoP | Moderate | WLAN driver |
| CVE-2017-8251 | A-62379525 [QC-CR#2006015](https://source.codeaurora.org/quic/la/kernel/msm-4.4/commit/?id=771254edea3486535453dbb76d090cd6bcf92af9) | EoP | Moderate | Camera driver |
| CVE-2017-10997 | A-33039685[\*](#asterisk) QC-CR#1103077 | EoP | Moderate | PCI driver |
| CVE-2017-11000 | A-36136563[\*](#asterisk) QC-CR#2031677 | EoP | Moderate | Camera driver |
| CVE-2017-8247 | A-62378684 [QC-CR#2023513](https://source.codeaurora.org/quic/la/kernel/msm-4.4/commit/?id=84f8c42e5d848b1d04f49d253f98296e8c2280b9) | EoP | Moderate | Camera driver |
| CVE-2017-9720 | A-36264696[\*](#asterisk) QC-CR#2041066 | EoP | Moderate | Camera driver |
| CVE-2017-8277 | A-62378788 [QC-CR#2009047](https://source.codeaurora.org/quic/la//kernel/msm-4.4/commit/?id=c9a6f09f1030cec591df837622cb54bbb2d24ddc) | EoP | Moderate | Video driver |
| CVE-2017-8281 | A-62378232 [QC-CR#2015892](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id%3D9be5b16de622c2426408425e3df29e945cd21d37&sa=D&usg=AFQjCNHuM63XOo5Y0C7bMJQIIedBHSDKjw) | ID | Moderate | Automotive multimedia |
| CVE-2017-11040 | A-37567102[\*](#asterisk) QC-CR#2038166 | ID | Moderate | Video driver |

## Google device updates

This table contains the security patch level in the latest over-the-air update
(OTA) and firmware images for Google devices. The Google device OTAs may also
contain additional updates. The Google device firmware images are available on
the [Google
Developer site](https://developers.google.com/android/nexus/images).

Pixel, Pixel XL, Pixel C, Nexus Player, Nexus 5X, and Nexus 6P
devices will be receiving the September security patches as part of the
upgrade to Android Oreo.

| Google device | Security patch level |
| --- | --- |
| Pixel / Pixel XL | 2017-09-05 |
| Nexus 5X | 2017-09-05 |
| Nexus 6 | 2017-09-05 |
| Nexus 6P | 2017-09-05 |
| Nexus 9 | 2017-09-05 |
| Nexus Player | 2017-09-05 |
| Pixel C | 2017-09-05 |

## Acknowledgements

We would like to thank these researchers for their contributions:

| CVEs | Researchers |
| CVE-2017-11000 | Baozeng Ding ([@sploving](https://twitter.com/sploving1)), Chengming Yang, and Yang Song of Alibaba Mobile Security Group |
| CVE-2017-0781, CVE-2017-0782, CVE-2017-0783, CVE-2017-0785 | Ben Seri and Gregory Vishnepolsky of Armis, Inc. (<https://armis.com>) |
| CVE-2017-0800, CVE-2017-0798 | Chengming Yang, Baozeng Ding, and Yang Song of Alibaba Mobile Security Group |
| CVE-2017-0765 | Chi Zhang, Mingjian Zhou ([@Mingjian\_Zhou](https://twitter.com/Mingjian_Zhou)), and Xuxian Jiang of [C0RE Team](http://c0reteam.org) |
| CVE-2017-0758 | [Chong Wang](http://weibo.com/csddl) and 金哲 (Zhe Jin) of Chengdu Security Response Center, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0752 | Cong Zheng ([@shellcong](https://twitter.com/shellcong)), Wenjun Hu, Xiao Zhang, and Zhi Xu of Palo Alto Networks |
| CVE-2017-0801 | Dacheng Shao, Mingjian Zhou ([@Mingjian\_Zhou](https://twitter.com/Mingjian_Zhou)), and Xuxian Jiang of [C0RE Team](http://c0reteam.org) |
| CVE-2017-0755 | Dawei Peng of Alibaba Mobile Security Team ([weibo: Vinc3nt4H](http://weibo.com/u/5622360291)) |
| CVE-2017-0775, CVE-2017-0774, CVE-2017-0771 | Elphet and Gong Guang of Alpha Team, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0784 | En He ([@heeeeen4x](https://twitter.com/heeeeen4x)) and Bo Liu of [MS509Team](http://www.ms509.com) |
| CVE-2017-10997 | Gengjia Chen ([@chengjia4574](https://twitter.com/chengjia4574)) and [pjf](http://weibo.com/jfpan) of IceSword Lab, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0786, CVE-2017-0792, CVE-2017-0791, CVE-2017-0790, CVE-2017-0789, CVE-2017-0788, CVE-2017-0787 | Hao Chen and Guang Gong of Alpha Team, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0802 | Jake Corina ([@JakeCorina](https://twitter.com/JakeCorina)) of Shellphish Grill Team |
| CVE-2017-0780 | Jason Gu and Seven Shen of Trend Micro |
| CVE-2017-0769 | Mingjian Zhou ([@Mingjian\_Zhou](https://twitter.com/Mingjian_Zhou)), Dacheng Shao, and Xuxian Jiang of [C0RE Team](http://c0reteam.org) |
| CVE-2017-0794, CVE-2017-9720, CVE-2017-11001, CVE-2017-10999, CVE-2017-0766 | Pengfei Ding (丁鹏飞), Chenfu Bao (包沉浮), Lenx Wei (韦韬) of Baidu X-Lab (百度安全实验室) |
| CVE-2017-0772 | Seven Shen of Trend Micro |
| CVE-2017-0757 | Vasily Vasiliev |
| CVE-2017-0768, CVE-2017-0779 | Wenke Dou, Mingjian Zhou ([@Mingjian\_Zhou](https://twitter.com/Mingjian_Zhou)), and Xuxian Jiang of [C0RE Team](http://c0reteam.org) |
| CVE-2017-0759 | [Weichao Sun](https://twitter.com/sunblate) of Alibaba Inc. |
| CVE-2017-0796 | Xiangqian Zhang, Chengming Yang, Baozeng Ding, and Yang Song of Alibaba Mobile Security Group |
| CVE-2017-0753 | Yangkang ([@dnpushme](https://twitter.com/dnpushme)) and hujianfei of Qihoo360 Qex Team |
| CVE-2017-12146 | Yonggang Guo ([@guoygang](https://twitter.com/guoygang)) of IceSword Lab, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0767 | Yongke Wang and Yuebin Sun of [Tencent's Xuanwu Lab](http://xlab.tencent.com) |
| CVE-2017-0804, CVE-2017-0803, CVE-2017-0799, CVE-2017-0795 | [Yu Pan](http://weibo.com/panyu6325) and Yang Dai of Vulpecker Team, Qihoo 360 Technology Co. Ltd |
| CVE-2017-0760 | [Zinuo Han](http://weibo.com/ele7enxxh) and 金哲 (Zhe Jin) of Chengdu Security Response Center, Qihoo 360 Technology Co. Ltd. |
| CVE-2017-0764, CVE-2017-0761, CVE-2017-0776, CVE-2017-0777, CVE-2017-0778 | [Zinuo Han](http://weibo.com/ele7enxxh) of Chengdu Security Response Center, Qihoo 360 Technology Co. Ltd. |

## Common questions and answers

This section answers common questions that may occur after reading this
bulletin.

**1. How do I determine if my device is updated to address these issues?**

To learn how to check a device's security patch level, read the instructions on
the [Pixel
and Nexus update schedule](https://support.google.com/pixelphone/answer/4457705#pixel_phones&nexus_devices).

* Security patch levels of 2017-09-01 or later address all issues associated
  with the 2017-09-01 security patch level.
* Security patch levels of 2017-09-05 or later address all issues associated
  with the 2017-09-05 security patch level and all previous patch levels.

Device manufacturers that include these updates should set the patch string
level to:

* [ro.build.version.security\_patch]:[2017-09-01]
* [ro.build.version.security\_patch]:[2017-09-05]

**2. Why does this bulletin have two security patch levels?**

This bulletin has two security patch levels so that Android partners have the
flexibility to fix a subset of vulnerabilities that are similar across all
Android devices more quickly. Android partners are encouraged to fix all issues
in this bulletin and use the latest security patch level.

* Devices that use the 2017-09-01 security patch level must include all issues
  associated with that security patch level, as well as fixes for all issues
  reported in previous security bulletins.
* Devices that use the security patch level of 2017-09-05 or newer must
  include all applicable patches in this (and previous) security
  bulletins.

Partners are encouraged to bundle the fixes for all issues they are addressing
in a single update.

**3. What do the entries in the *Type* column mean?**

Entries in the *Type* column of the vulnerability details table reference
the classification of the security vulnerability.

| Abbreviation | Definition |
| RCE | Remote code execution |
| EoP | Elevation of privilege |
| ID | Information disclosure |
| DoS | Denial of service |
| N/A | Classification not available |

**4. What do the entries in the *References* column mean?**

Entries under the *References* column of the vulnerability details table
may contain a prefix identifying the organization to which the reference value
belongs.

| Prefix | Reference |
| A- | Android bug ID |
| QC- | Qualcomm reference number |
| M- | MediaTek reference number |
| N- | NVIDIA reference number |
| B- | Broadcom reference number |

**5. What does a \* next to the Android bug ID in the *References*
column mean?**

Issues that are not publicly available have a \* next to the Android bug ID in
the *References* column. The update for that issue is generally contained
in the latest binary drivers for Nexus devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

## Versions

| Version | Date | Notes |
| 1.0 | September 5, 2017 | Bulletin published. |
| 1.1 | September 12, 2017 | Added details for CVE-2017-0781, CVE-2017-0782, CVE-2017-0783, and CVE-2017-0785 as part of industry-coordinated disclosure. |
| 1.2 | September 13, 2017 | Bulletin revised to include AOSP links. |
| 1.3 | September 25, 2017 | Added details for CVE-2017-11120 and CVE-2017-11121 as part of industry-coordinated disclosure. |
| 1.4 | September 28, 2017 | Update vendor reference for CVE-2017-11001. |

Content and code samples on this page are subject to the licenses described in the [Content License](/license). Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.

Last updated 2024-08-26 UTC.

[[["Easy to understand","easyToUnderstand","thumb-up"],["Solved my problem","solvedMyProblem","thumb-up"],["Other","otherUp","thumb-up"]],[["Missing the information I need","missingTheInformationINeed","thumb-down"],["Too complicated / too many steps","tooComplicatedTooManySteps","thumb-down"],["Out of date","outOfDate","thumb-down"],["Samples / code issue","samplesCodeIssue","thumb-down"],["Other","otherDown","thumb-down"]],["Last updated 2024-08-26 UTC."],[],[]]

* ### Build

  + [Android repository](//android.googlesource.com)
  + [Requirements](/source/requirements)
  + [Downloading](/source/downloading)
  + [Preview binaries](//developers.google.com/android/blobs-preview/)
  + [Factory images](//developers.google.com/android/images/)
  + [Driver binaries](//developers.google.com/android/drivers/)
* ### Connect

  + [@Android on Twitter](//twitter.com/Android/)
  + [@AndroidDev on Twitter](//twitter.com/AndroidDev/)
  + [Android Blog](//blog.google/products/android/)
  + [Google Security Blog](//security.googleblog.com)
  + [Platform on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-platform/)
  + [Building on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-building/)
  + [Porting on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-porting/)
* ### Get help

  + [Android Help Center](//support.google.com/android/)
  + [Pixel Help Center](//support.google.com/pixelphone/)
  + [www.android.com](//www.android.com)
  + [Google Mobile Services](//www.android.com/gms/)
  + [Stack Overflow](//stackoverflow.com/questions/tagged/android-source/)
  + [Issue Tracker](//issuetracker.google.com/issues?q=status:open%20componentid:190923)

* [About Android](/source/)
* [Community](/source/community)
* [Legal](/legal)
* [License](/license)
* [Privacy](//policies.google.com/privacy)
* [Site feedback](//issuetracker.google.com/issues/new?component=191476)
* Manage cookies

* English
* Deutsch
* Español
* Español – América Latina
* Français
* Indonesia
* Italiano
* Polski
* Português
* Português – Brasil
* Tiếng Việt
* Türkçe
* Русский
* עברית
* العربيّة
* فارسی
* हिंदी
* বাংলা
* ภาษาไทย
* 中文 – 简体
* 中文 – 繁體
* 日本語
* 한국어



=== Content from www.openwall.com_f533e96a_20250125_185446.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20170228162524.47jesr3zopycriir@eldamar.local>
Date: Tue, 28 Feb 2017 17:25:24 +0100
From: Salvatore Bonaccorso <carnil@...ian.org>
To: OSS Security Mailinglist <oss-security@...ts.openwall.com>
Subject: Linux: packet: fix races in fanout_add() (CVE-2017-6346)

Hi

CVE-2017-6346 was assigned by MITRE to the following (via
<https://cveform.mitre.org/>):

<https://git.kernel.org/linus/d199fab63c11998a602205f7ee7ff7c05c97164b>

> packet: fix races in fanout_add()
>
> Multiple threads can call fanout_add() at the same time.
>
> We need to grab fanout_mutex earlier to avoid races that could
> lead to one thread freeing po->rollover that was set by another thread.
>
> Do the same in fanout_release(), for peace of mind, and to help us
> finding lockdep issues earlier.

Since 4.2 the races can lead to a use-after-free.

The fix was backported to 4.9.13 as well.

Regards,
Salvatore

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_31cbf18b_20250125_185447.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Fd199fab63c11998a602205f7ee7ff7c05c97164b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Fd199fab63c11998a602205f7ee7ff7c05c97164b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=torvalds%2Flinux)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[torvalds](/torvalds)
/
**[linux](/torvalds/linux)**
Public

* [Notifications](/login?return_to=%2Ftorvalds%2Flinux) You must be signed in to change notification settings
* [Fork
  54.9k](/login?return_to=%2Ftorvalds%2Flinux)
* [Star
   186k](/login?return_to=%2Ftorvalds%2Flinux)

* [Code](/torvalds/linux)
* [Pull requests
  437](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects
  0](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

Additional navigation options

* [Code](/torvalds/linux)
* [Pull requests](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

## Commit

[Permalink](/torvalds/linux/commit/d199fab63c11998a602205f7ee7ff7c05c97164b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

packet: fix races in fanout\_add()

[Browse files](/torvalds/linux/tree/d199fab63c11998a602205f7ee7ff7c05c97164b)
Browse the repository at this point in the history

```
Multiple threads can call fanout_add() at the same time.

We need to grab fanout_mutex earlier to avoid races that could
lead to one thread freeing po->rollover that was set by another thread.

Do the same in fanout_release(), for peace of mind, and to help us
finding lockdep issues earlier.

Fixes: [dc99f60](https://github.com/torvalds/linux/commit/dc99f600698dcac69b8f56dda9a8a00d645c5ffc) ("packet: Add fanout support.")
Fixes: [0648ab7](https://github.com/torvalds/linux/commit/0648ab70afe6c3bf2369a6d779b44a85121c063d) ("packet: rollover prepare: per-socket state")
Signed-off-by: Eric Dumazet <edumazet@google.com>
Cc: Willem de Bruijn <willemb@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
```

* Loading branch information

[![@davem330](https://avatars.githubusercontent.com/u/1053866?s=40&v=4)](/davem330)

Eric Dumazet
authored and
[davem330](/torvalds/linux/commits?author=davem330 "View all commits by davem330")
committed
Feb 14, 2017

1 parent
[f39f0d1](/torvalds/linux/commit/f39f0d1e1e93145a0e91d9a7a639c42fd037ecc3)

commit d199fab

Showing
**1 changed file**
with
**30 additions**
and
**25 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

55 changes: 30 additions & 25 deletions

55
[net/packet/af\_packet.c](#diff-78e6d4b734122307e4a75c9125eb650258d64ca0b7a8f2ac0d53607a9af55b2f "net/packet/af_packet.c")

Show comments

[View file](/torvalds/linux/blob/d199fab63c11998a602205f7ee7ff7c05c97164b/net/packet/af_packet.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1619,6 +1619,7 @@ static void fanout\_release\_data(struct packet\_fanout \*f) |
|  |  |  |
|  |  | static int fanout\_add(struct sock \*sk, u16 id, u16 type\_flags) |
|  |  | { |
|  |  | struct packet\_rollover \*rollover = NULL; |
|  |  | struct packet\_sock \*po = pkt\_sk(sk); |
|  |  | struct packet\_fanout \*f, \*match; |
|  |  | u8 type = type\_flags & 0xff; |
| Expand All | | @@ -1641,23 +1642,28 @@ static int fanout\_add(struct sock \*sk, u16 id, u16 type\_flags) |
|  |  | return -EINVAL; |
|  |  | } |
|  |  |  |
|  |  | mutex\_lock(&fanout\_mutex); |
|  |  |  |
|  |  | err = -EINVAL; |
|  |  | if (!po->running) |
|  |  | return -EINVAL; |
|  |  | goto out; |
|  |  |  |
|  |  | err = -EALREADY; |
|  |  | if (po->fanout) |
|  |  | return -EALREADY; |
|  |  | goto out; |
|  |  |  |
|  |  | if (type == PACKET\_FANOUT\_ROLLOVER || |
|  |  | (type\_flags & PACKET\_FANOUT\_FLAG\_ROLLOVER)) { |
|  |  | po->rollover = kzalloc(sizeof(\*po->rollover), GFP\_KERNEL); |
|  |  | if (!po->rollover) |
|  |  | return -ENOMEM; |
|  |  | atomic\_long\_set(&po->rollover->num, 0); |
|  |  | atomic\_long\_set(&po->rollover->num\_huge, 0); |
|  |  | atomic\_long\_set(&po->rollover->num\_failed, 0); |
|  |  | err = -ENOMEM; |
|  |  | rollover = kzalloc(sizeof(\*rollover), GFP\_KERNEL); |
|  |  | if (!rollover) |
|  |  | goto out; |
|  |  | atomic\_long\_set(&rollover->num, 0); |
|  |  | atomic\_long\_set(&rollover->num\_huge, 0); |
|  |  | atomic\_long\_set(&rollover->num\_failed, 0); |
|  |  | po->rollover = rollover; |
|  |  | } |
|  |  |  |
|  |  | mutex\_lock(&fanout\_mutex); |
|  |  | match = NULL; |
|  |  | list\_for\_each\_entry(f, &fanout\_list, list) { |
|  |  | if (f->id == id && |
| Expand Down  Expand Up | | @@ -1704,11 +1710,11 @@ static int fanout\_add(struct sock \*sk, u16 id, u16 type\_flags) |
|  |  | } |
|  |  | } |
|  |  | out: |
|  |  | mutex\_unlock(&fanout\_mutex); |
|  |  | if (err) { |
|  |  | kfree(po->rollover); |
|  |  | if (err && rollover) { |
|  |  | kfree(rollover); |
|  |  | po->rollover = NULL; |
|  |  | } |
|  |  | mutex\_unlock(&fanout\_mutex); |
|  |  | return err; |
|  |  | } |
|  |  |  |
| Expand All | | @@ -1717,23 +1723,22 @@ static void fanout\_release(struct sock \*sk) |
|  |  | struct packet\_sock \*po = pkt\_sk(sk); |
|  |  | struct packet\_fanout \*f; |
|  |  |  |
|  |  | f = po->fanout; |
|  |  | if (!f) |
|  |  | return; |
|  |  |  |
|  |  | mutex\_lock(&fanout\_mutex); |
|  |  | po->fanout = NULL; |
|  |  | f = po->fanout; |
|  |  | if (f) { |
|  |  | po->fanout = NULL; |
|  |  |  |
|  |  | if (atomic\_dec\_and\_test(&f->sk\_ref)) { |
|  |  | list\_del(&f->list); |
|  |  | dev\_remove\_pack(&f->prot\_hook); |
|  |  | fanout\_release\_data(f); |
|  |  | kfree(f); |
|  |  | } |
|  |  |  |
|  |  | if (atomic\_dec\_and\_test(&f->sk\_ref)) { |
|  |  | list\_del(&f->list); |
|  |  | dev\_remove\_pack(&f->prot\_hook); |
|  |  | fanout\_release\_data(f); |
|  |  | kfree(f); |
|  |  | if (po->rollover) |
|  |  | kfree\_rcu(po->rollover, rcu); |
|  |  | } |
|  |  | mutex\_unlock(&fanout\_mutex); |
|  |  |  |
|  |  | if (po->rollover) |
|  |  | kfree\_rcu(po->rollover, rcu); |
|  |  | } |
|  |  |  |
|  |  | static bool packet\_extra\_vlan\_len\_allowed(const struct net\_device \*dev, |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d199fab`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Fd199fab63c11998a602205f7ee7ff7c05c97164b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.kernel.org_37a4f630_20250125_185446.html ===
commit 3737a5f7223464efed3b0a9da2b045dae28d3a53
Author: Greg Kroah-Hartman
Date: Sun Feb 26 11:11:18 2017 +0100
Linux 4.9.13
commit d004006055974a976841c4f95e8c25ca7b5b38d5
Author: Brian Foster
Date: Thu Feb 16 17:19:12 2017 -0800
xfs: clear delalloc and cache on buffered write failure
commit fa7f138ac4c70dc00519c124cf7cd4862a0a5b0e upstream.
The buffered write failure handling code in
xfs\_file\_iomap\_end\_delalloc() has a couple minor problems. First, if
written == 0, start\_fsb is not rounded down and it fails to kill off a
delalloc block if the start offset is block unaligned. This results in a
lingering delalloc block and broken delalloc block accounting detected
at unmount time. Fix this by rounding down start\_fsb in the unlikely
event that written == 0.
Second, it is possible for a failed overwrite of a delalloc extent to
leave dirty pagecache around over a hole in the file. This is because is
possible to hit ->iomap\_end() on write failure before the iomap code has
attempted to allocate pagecache, and thus has no need to clean it up. If
the targeted delalloc extent was successfully written by a previous
write, however, then it does still have dirty pages when ->iomap\_end()
punches out the underlying blocks. This ultimately results in writeback
over a hole. To fix this problem, unconditionally punch out the
pagecache from XFS before the associated delalloc range.
Signed-off-by: Brian Foster
Reviewed-by: Christoph Hellwig
Reviewed-by: Darrick J. Wong
Signed-off-by: Darrick J. Wong
Signed-off-by: Greg Kroah-Hartman
commit 57d759622aa76591958f46707edebe20c284b7d2
Author: Michael Schenk
Date: Thu Jan 26 11:25:04 2017 -0600
rtlwifi: rtl\_usb: Fix for URB leaking when doing ifconfig up/down
commit 575ddce0507789bf9830d089557d2199d2f91865 upstream.
In the function rtl\_usb\_start we pre-allocate a certain number of urbs
for RX path but they will not be freed when calling rtl\_usb\_stop. This
results in leaking urbs when doing ifconfig up and down. Eventually,
the system has no available urbs.
Signed-off-by: Michael Schenk
Signed-off-by: Larry Finger
Signed-off-by: Kalle Valo
Signed-off-by: Greg Kroah-Hartman
commit 1cb3de83ab740c17dafe9148c2a5b5ac41a736cf
Author: Tejun Heo
Date: Wed Feb 8 15:19:07 2017 -0500
block: fix double-free in the failure path of cgwb\_bdi\_init()
commit 5f478e4ea5c5560b4e40eb136991a09f9389f331 upstream.
When !CONFIG\_CGROUP\_WRITEBACK, bdi has single bdi\_writeback\_congested
at bdi->wb\_congested. cgwb\_bdi\_init() allocates it with kzalloc() and
doesn't do further initialization. This usually works fine as the
reference count gets bumped to 1 by wb\_init() and the put from
wb\_exit() releases it.
However, when wb\_init() fails, it puts the wb base ref automatically
freeing the wb and the explicit kfree() in cgwb\_bdi\_init() error path
ends up trying to free the same pointer the second time causing a
double-free.
Fix it by explicitly initilizing the refcnt to 1 and putting the base
ref from cgwb\_bdi\_destroy().
Signed-off-by: Tejun Heo
Reported-by: Dmitry Vyukov
Fixes: a13f35e87140 ("writeback: don't embed root bdi\_writeback\_congested in bdi\_writeback")
Signed-off-by: Jens Axboe
Signed-off-by: Greg Kroah-Hartman
commit 62c153f346fe5ef8946103050548707ff294961f
Author: Lv Zheng
Date: Wed Feb 8 11:00:01 2017 +0800
ACPICA: Linuxize: Restore and fix Intel compiler build
commit ffab9188e444854882dbc291500d576d6bad7b7b upstream.
ACPICA commit b59347d0b8b676cb555fe8da5cad08fcd4eeb0d3
The following commit cleans up compiler specific inclusions:
Commit: 9fa1cebdbfff3db8953cebca8ee327d75edefc40
Subject: ACPICA: OSL: Cleanup the inclusion order of the compiler-specific headers
But breaks one thing due to the following old issue:
Buidling Linux kernel with Intel compiler originally depends on acgcc.h
not acintel.h.
So after making Intel compiler build working in ACPICA upstream by
correctly using acintel.h, it becomes unable to build Linux kernel using
Intel compiler as there is no acintel.h in the kernel source tree.
This patch releases acintel.h to Linux kernel and fixes its inclusion in
acenv.h.
Fixes: 9fa1cebdbfff (ACPICA: OSL: Cleanup the inclusion order of the compiler-specific headers)
Link: https://github.com/acpica/acpica/commit/b59347d0
Tested-by: Stepan M Mishura
Signed-off-by: Lv Zheng
Signed-off-by: Rafael J. Wysocki
Signed-off-by: Greg Kroah-Hartman
commit 8f9872be6db939a75a075cd893a47ce5742cee00
Author: Jiri Kosina
Date: Wed Feb 1 21:01:54 2017 +0100
netfilter: nf\_ct\_helper: warn when not applying default helper assignment
commit dfe75ff8ca74f54b0fa5a326a1aa9afa485ed802 upstream.
Commit 3bb398d925 ("netfilter: nf\_ct\_helper: disable automatic helper
assignment") is causing behavior regressions in firewalls, as traffic
handled by conntrack helpers is now by default not passed through even
though it was before due to missing CT targets (which were not necessary
before this commit).
The default had to be switched off due to security reasons [1] [2] and
therefore should stay the way it is, but let's be friendly to firewall
admins and issue a warning the first time we're in situation where packet
would be likely passed through with the old default but we're likely going
to drop it on the floor now.
Rewrite the code a little bit as suggested by Linus, so that we avoid
spaghettiing the code even more -- namely the whole decision making
process regarding helper selection (either automatic or not) is being
separated, so that the whole logic can be simplified and code (condition)
duplication reduced.
[1] https://cansecwest.com/csw12/conntrack-attack.pdf
[2] https://home.regit.org/netfilter-en/secure-use-of-helpers/
Signed-off-by: Jiri Kosina
Signed-off-by: Pablo Neira Ayuso
Signed-off-by: Greg Kroah-Hartman
commit e6bdd8d2fffc0875eb16ec5e08e8230771539073
Author: Thomas Gleixner
Date: Wed Feb 15 11:11:51 2017 +0100
goldfish: Sanitize the broken interrupt handler
commit 6cf18e6927c0b224f972e3042fb85770d63cb9f8 upstream.
This interrupt handler is broken in several ways:
- It loops forever when the op code is not decodeable
- It never returns IRQ\_HANDLED because the only way to exit the loop
returns IRQ\_NONE unconditionally.
The whole concept of this is broken. Creating devices in an interrupt
handler is beyond any point of sanity.
Make it at least behave halfways sane so accidental users do not have to
deal with a hard to debug lockup.
Fixes: e809c22b8fb028 ("goldfish: add the goldfish virtual bus")
Reported-by: Gabriel C
Signed-off-by: Thomas Gleixner
Acked-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit 2709c2a1b0165e7b4084077148697175ecd9d2c7
Author: Thomas Gleixner
Date: Wed Feb 15 11:11:50 2017 +0100
x86/platform/goldfish: Prevent unconditional loading
commit 47512cfd0d7a8bd6ab71d01cd89fca19eb2093eb upstream.
The goldfish platform code registers the platform device unconditionally
which causes havoc in several ways if the goldfish\_pdev\_bus driver is
enabled:
- Access to the hardcoded physical memory region, which is either not
available or contains stuff which is completely unrelated.
- Prevents that the interrupt of the serial port can be requested
- In case of a spurious interrupt it goes into a infinite loop in the
interrupt handler of the pdev\_bus driver (which needs to be fixed
seperately).
Add a 'goldfish' command line option to make the registration opt-in when
the platform is compiled in.
I'm seriously grumpy about this engineering trainwreck, which has seven
SOBs from Intel developers for 50 lines of code. And none of them figured
out that this is broken. Impressive fail!
Fixes: ddd70cf93d78 ("goldfish: platform device for x86")
Reported-by: Gabriel C
Signed-off-by: Thomas Gleixner
Acked-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit fef3fdf2d83cd0ca3bc0052ab58baab010929434
Author: Johan Hovold
Date: Wed Feb 8 18:53:08 2017 +0100
USB: serial: console: fix uninitialised spinlock
commit 14816b16fa0adac24f82492f18fa62c55acabbbe upstream.
Since commit 4a510969374a ("tty: Make tty\_files\_lock per-tty") a new
tty\_struct spin lock is taken in the tty release path, but the
USB-serial-console hack was never updated hence leaving the lock of its
"fake" tty uninitialised. This was eventually detected by lockdep.
Make sure to initialise the new lock also for the fake tty to address
this regression.
Yes, this code is a mess, but cleaning it up is left for another day.
Fixes: 4a510969374a ("tty: Make tty\_files\_lock per-tty")
Reviewed-by: Greg Kroah-Hartman
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit 960a38eae80a9e5ba9688c0eb92114f6de028904
Author: Johan Hovold
Date: Thu Jan 12 14:56:09 2017 +0100
USB: serial: ark3116: fix register-accessor error handling
commit 9fef37d7cf170522fb354d6d0ea6de09b9b16678 upstream.
The current implementation failed to detect short transfers, something
which could lead to bits of the uninitialised heap transfer buffer
leaking to user space.
Fixes: 149fc791a452 ("USB: ark3116: Setup some basic infrastructure for new ark3116 driver.")
Fixes: f4c1e8d597d1 ("USB: ark3116: Make existing functions 16450-aware and add close and release functions.")
Reviewed-by: Greg Kroah-Hartman
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit a2ce74e35d5fd1afb5304b645c3b459c922a2c4a
Author: Johan Hovold
Date: Fri Jan 13 13:21:08 2017 +0100
USB: serial: opticon: fix CTS retrieval at open
commit 2eee05020a0e7ee7c04422cbacdb07859e45dce6 upstream.
The opticon driver used a control request at open to trigger a CTS
status notification to be sent over the bulk-in pipe. When the driver
was converted to using the generic read implementation, an inverted test
prevented this request from being sent, something which could lead to
TIOCMGET reporting an incorrect CTS state.
Reported-by: Dan Carpenter
Fixes: 7a6ee2b02751 ("USB: opticon: switch to generic read implementation")
Reviewed-by: Greg Kroah-Hartman
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit a1fc6fb5f31edc1b6fb8de092f6ab6fbe967aaa7
Author: Johan Hovold
Date: Thu Jan 12 14:56:21 2017 +0100
USB: serial: spcp8x5: fix modem-status handling
commit 5ed8d41023751bdd3546f2fe4118304357efe8d2 upstream.
Make sure to detect short control transfers and return zero on success
when retrieving the modem status.
This fixes the TIOCMGET implementation which since e1ed212d8593 ("USB:
spcp8x5: add proper modem-status support") has returned TIOCM\_LE on
successful retrieval, and avoids leaking bits from the stack on short
transfers.
This also fixes the carrier-detect implementation which since the above
mentioned commit unconditionally has returned true.
Fixes: e1ed212d8593 ("USB: spcp8x5: add proper modem-status support")
Reviewed-by: Greg Kroah-Hartman
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit 26805681a45d071ac8df99933d842c1380b7e279
Author: Johan Hovold
Date: Thu Feb 2 17:38:35 2017 +0100
USB: serial: ftdi\_sio: fix line-status over-reporting
commit a6bb1e17a39818b01b55d8e6238b4b5f06d55038 upstream.
FTDI devices use a receive latency timer to periodically empty the
receive buffer and report modem and line status (also when the buffer is
empty).
When a break or error condition is detected the corresponding status
flags will be set on a packet with nonzero data payload and the flags
are not updated until the break is over or further characters are
received.
In order to avoid over-reporting break and error conditions, these flags
must therefore only be processed for packets with payload.
This specifically fixes the case where after an overrun, the error
condition is continuously reported and NULL-characters inserted until
further data is received.
Reported-by: Michael Walle
Fixes: 72fda3ca6fc1 ("USB: serial: ftd\_sio: implement sysrq handling on
break")
Fixes: 166ceb690750 ("USB: ftdi\_sio: clean up line-status handling")
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit a1510a8c0ded157158be688a54c107aac4291f77
Author: Johan Hovold
Date: Wed Jan 25 15:35:20 2017 +0100
USB: serial: ftdi\_sio: fix extreme low-latency setting
commit c6dce2626606ef16434802989466636bc28c1419 upstream.
Since commit 557aaa7ffab6 ("ft232: support the ASYNC\_LOW\_LATENCY
flag") the FTDI driver has been using a receive latency-timer value of
1 ms instead of the device default of 16 ms.
The latency timer is used to periodically empty a non-full receive
buffer, but a status header is always sent when the timer expires
including when the buffer is empty. This means that a two-byte bulk
message is received every millisecond also for an otherwise idle port as
long as it is open.
Let's restore the pre-2009 behaviour which reduces the rate of the
status messages to 1/16th (e.g. interrupt frequency drops from 1 kHz to
62.5 Hz) by not setting ASYNC\_LOW\_LATENCY by default.
Anyone willing to pay the price for the minimum-latency behaviour should
set the flag explicitly instead using the TIOCSSERIAL ioctl or a tool
such as setserial (e.g. setserial /dev/ttyUSB0 low\_latency).
Note that since commit 0cbd81a9f6ba ("USB: ftdi\_sio: remove
tty->low\_latency") the ASYNC\_LOW\_LATENCY flag has no other effects but
to set a minimal latency timer.
Reported-by: Antoine Aubert
Fixes: 557aaa7ffab6 ("ft232: support the ASYNC\_LOW\_LATENCY flag")
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit f3d56f7a586e6fdddb9cfae46787492c94add38d
Author: Johan Hovold
Date: Thu Jan 12 14:56:11 2017 +0100
USB: serial: ftdi\_sio: fix modem-status error handling
commit 427c3a95e3e29e65f59d99aaf320d7506f3eed57 upstream.
Make sure to detect short responses when fetching the modem status in
order to avoid parsing uninitialised buffer data and having bits of it
leak to user space.
Note that we still allow for short 1-byte responses.
Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")
Reviewed-by: Greg Kroah-Hartman
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit 4420e0f8fddfade44c399d346dc388dd925eb100
Author: Ken Lin
Date: Sat Feb 4 04:00:24 2017 +0800
USB: serial: cp210x: add new IDs for GE Bx50v3 boards
commit 9a593656def0dc2f6c227851e8e602077267a5f1 upstream.
Add new USB IDs for cp2104/5 devices on Bx50v3 boards due to the design
change.
Signed-off-by: Ken Lin
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit 308a96c857ccba6aaebfdc4c63045cb2970de0fb
Author: Johan Hovold
Date: Thu Feb 9 12:11:41 2017 +0100
USB: serial: mos7840: fix another NULL-deref at open
commit 5182c2cf2a9bfb7f066ef0bdd2bb6330b94dd74e upstream.
Fix another NULL-pointer dereference at open should a malicious device
lack an interrupt-in endpoint.
Note that the driver has a broken check for an interrupt-in endpoint
which means that an interrupt URB has never even been submitted.
Fixes: 3f5429746d91 ("USB: Moschip 7840 USB-Serial Driver")
Reviewed-by: Greg Kroah-Hartman
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit 9ab870e7425c224328ec5807ed916d417810b2eb
Author: Javier Martinez Canillas
Date: Mon Jan 2 11:57:20 2017 -0300
tty: serial: msm: Fix module autoload
commit abe81f3b8ed2996e1712d26d38ff6b73f582c616 upstream.
If the driver is built as a module, autoload won't work because the module
alias information is not filled. So user-space can't match the registered
device with the corresponding module.
Export the module alias information using the MODULE\_DEVICE\_TABLE() macro.
Before this patch:
$ modinfo drivers/tty/serial/msm\_serial.ko | grep alias
$
After this patch:
$ modinfo drivers/tty/serial/msm\_serial.ko | grep alias
alias: of:N\*T\*Cqcom,msm-uartdmC\*
alias: of:N\*T\*Cqcom,msm-uartdm
alias: of:N\*T\*Cqcom,msm-uartC\*
alias: of:N\*T\*Cqcom,msm-uart
Signed-off-by: Javier Martinez Canillas
Acked-by: Bjorn Andersson
Cc: stable
Signed-off-by: Greg Kroah-Hartman
Signed-off-by: Greg Kroah-Hartman
commit 1a0e2594ef76fabe28049922c20d19c12aad4881
Author: Maxime Jayat
Date: Tue Feb 21 18:35:51 2017 +0100
net: socket: fix recvmmsg not returning error from sock\_error
[ Upstream commit e623a9e9dec29ae811d11f83d0074ba254aba374 ]
Commit 34b88a68f26a ("net: Fix use after free in the recvmmsg exit path"),
changed the exit path of recvmmsg to always return the datagrams
variable and modified the error paths to set the variable to the error
code returned by recvmsg if necessary.
However in the case sock\_error returned an error, the error code was
then ignored, and recvmmsg returned 0.
Change the error path of recvmmsg to correctly return the error code
of sock\_error.
The bug was triggered by using recvmmsg on a CAN interface which was
not up. Linux 4.6 and later return 0 in this case while earlier
releases returned -ENETDOWN.
Fixes: 34b88a68f26a ("net: Fix use after free in the recvmmsg exit path")
Signed-off-by: Maxime Jayat
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 481aedf869fbf2d4503ca0005dbd68b78422955a
Author: Paolo Abeni
Date: Tue Feb 21 09:33:18 2017 +0100
ip: fix IP\_CHECKSUM handling
[ Upstream commit ca4ef4574f1ee5252e2cd365f8f5d5bafd048f32 ]
The skbs processed by ip\_cmsg\_recv() are not guaranteed to
be linear e.g. when sending UDP packets over loopback with
MSGMORE.
Using csum\_partial() on [potentially] the whole skb len
is dangerous; instead be on the safe side and use skb\_checksum().
Thanks to syzkaller team to detect the issue and provide the
reproducer.
v1 -> v2:
- move the variable declaration in a tighter scope
Fixes: ad6f939ab193 ("ip: Add offset parameter to ip\_cmsg\_recv")
Reported-by: Andrey Konovalov
Signed-off-by: Paolo Abeni
Acked-by: Eric Dumazet
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 7c56012e92b51030b13c4652a9494d422562d5d5
Author: Michael S. Tsirkin
Date: Sun Feb 19 07:17:17 2017 +0200
ptr\_ring: fix race conditions when resizing
[ Upstream commit e71695307114335be1ed912f4a347396c2ed0e69 ]
Resizing currently drops consumer lock. This can cause entries to be
reordered, which isn't good in itself. More importantly, consumer can
detect a false ring empty condition and block forever.
Further, nesting of consumer within producer lock is problematic for
tun, since it produces entries in a BH, which causes a lock order
reversal:
CPU0 CPU1
---- ----
consume:
lock(&(&r->consumer\_lock)->rlock);
resize:
local\_irq\_disable();
lock(&(&r->producer\_lock)->rlock);
lock(&(&r->consumer\_lock)->rlock);
produce:
lock(&(&r->producer\_lock)->rlock);
To fix, nest producer lock within consumer lock during resize,
and keep consumer lock during the whole swap operation.
Reported-by: Dmitry Vyukov
Cc: stable@vger.kernel.org
Cc: "David S. Miller"
Acked-by: Jason Wang
Signed-off-by: Michael S. Tsirkin
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit c2219da51664451149350e47321aa0fcf72a8b8f
Author: David S. Miller
Date: Fri Feb 17 16:19:39 2017 -0500
irda: Fix lockdep annotations in hashbin\_delete().
[ Upstream commit 4c03b862b12f980456f9de92db6d508a4999b788 ]
A nested lock depth was added to the hasbin\_delete() code but it
doesn't actually work some well and results in tons of lockdep splats.
Fix the code instead to properly drop the lock around the operation
and just keep peeking the head of the hashbin queue.
Reported-by: Dmitry Vyukov
Tested-by: Dmitry Vyukov
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit f23fd87e154f2c0fbac2e33c999e388f9baf2714
Author: Paolo Abeni
Date: Fri Feb 17 19:14:27 2017 +0100
vxlan: fix oops in dev\_fill\_metadata\_dst
[ Upstream commit 22f0708a718daea5e79de2d29b4829de016a4ff4 ]
Since the commit 0c1d70af924b ("net: use dst\_cache for vxlan device")
vxlan\_fill\_metadata\_dst() calls vxlan\_get\_route() passing a NULL
dst\_cache pointer, so the latter should explicitly check for
valid dst\_cache ptr. Unfortunately the commit d71785ffc7e7 ("net: add
dst\_cache to ovs vxlan lwtunnel") removed said check.
As a result is possible to trigger a null pointer access calling
vxlan\_fill\_metadata\_dst(), e.g. with:
ovs-vsctl add-br ovs-br0
ovs-vsctl add-port ovs-br0 vxlan0 -- set interface vxlan0 \
type=vxlan options:remote\_ip=192.168.1.1 \
options:key=1234 options:dst\_port=4789 ofport\_request=10
ip address add dev ovs-br0 172.16.1.2/24
ovs-vsctl set Bridge ovs-br0 ipfix=@i -- --id=@i create IPFIX \
targets=\"172.16.1.1:1234\" sampling=1
iperf -c 172.16.1.1 -u -l 1000 -b 10M -t 1 -p 1234
This commit addresses the issue passing to vxlan\_get\_route() the
dst\_cache already available into the lwt info processed by
vxlan\_fill\_metadata\_dst().
Fixes: d71785ffc7e7 ("net: add dst\_cache to ovs vxlan lwtunnel")
Signed-off-by: Paolo Abeni
Acked-by: Jiri Benc
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 171d92a9d915d238e05285ca67faf30f554d7df7
Author: Andrey Konovalov
Date: Thu Feb 16 17:22:46 2017 +0100
dccp: fix freeing skb too early for IPV6\_RECVPKTINFO
[ Upstream commit 5edabca9d4cff7f1f2b68f0bac55ef99d9798ba4 ]
In the current DCCP implementation an skb for a DCCP\_PKT\_REQUEST packet
is forcibly freed via \_\_kfree\_skb in dccp\_rcv\_state\_process if
dccp\_v6\_conn\_request successfully returns.
However, if IPV6\_RECVPKTINFO is set on a socket, the address of the skb
is saved to ireq->pktopts and the ref count for skb is incremented in
dccp\_v6\_conn\_request, so skb is still in use. Nevertheless, it gets freed
in dccp\_rcv\_state\_process.
Fix by calling consume\_skb instead of doing goto discard and therefore
calling \_\_kfree\_skb.
Similar fixes for TCP:
fb7e2399ec17f1004c0e0ccfd17439f8759ede01 [TCP]: skb is unexpectedly freed.
0aea76d35c9651d55bbaf746e7914e5f9ae5a25d tcp: SYN packets are now
simply consumed
Signed-off-by: Andrey Konovalov
Acked-by: Eric Dumazet
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 6c854afc5399dd74cf5eba04ee7ba9ffb9ad5158
Author: Marcus Huewe
Date: Wed Feb 15 01:00:36 2017 +0100
net: neigh: Fix netevent NETEVENT\_DELAY\_PROBE\_TIME\_UPDATE notification
[ Upstream commit 7627ae6030f56a9a91a5b3867b21f35d79c16e64 ]
When setting a neigh related sysctl parameter, we always send a
NETEVENT\_DELAY\_PROBE\_TIME\_UPDATE netevent. For instance, when
executing
sysctl net.ipv6.neigh.wlp3s0.retrans\_time\_ms=2000
a NETEVENT\_DELAY\_PROBE\_TIME\_UPDATE netevent is generated.
This is caused by commit 2a4501ae18b5 ("neigh: Send a
notification when DELAY\_PROBE\_TIME changes"). According to the
commit's description, it was intended to generate such an event
when setting the "delay\_first\_probe\_time" sysctl parameter.
In order to fix this, only generate this event when actually
setting the "delay\_first\_probe\_time" sysctl parameter. This fix
should not have any unintended side-effects, because all but one
registered netevent callbacks check for other netevent event
types (the registered callbacks were obtained by grepping for
"register\_netevent\_notifier"). The only callback that uses the
NETEVENT\_DELAY\_PROBE\_TIME\_UPDATE event is
mlxsw\_sp\_router\_netevent\_event() (in
drivers/net/ethernet/mellanox/mlxsw/spectrum\_router.c): in case
of this event, it only accesses the DELAY\_PROBE\_TIME of the
passed neigh\_parms.
Fixes: 2a4501ae18b5 ("neigh: Send a notification when DELAY\_PROBE\_TIME changes")
Signed-off-by: Marcus Huewe
Reviewed-by: Ido Schimmel
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 9206efc8a1f74e558e3165218fab136b51be848a
Author: Anoob Soman
Date: Wed Feb 15 20:25:39 2017 +0000
packet: Do not call fanout\_release from atomic contexts
[ Upstream commit 2bd624b4611ffee36422782d16e1c944d1351e98 ]
Commit 6664498280cf ("packet: call fanout\_release, while UNREGISTERING a
netdev"), unfortunately, introduced the following issues.
1. calling mutex\_lock(&fanout\_mutex) (fanout\_release()) from inside
rcu\_read-side critical section. rcu\_read\_lock disables preemption, most often,
which prohibits calling sleeping functions.
[ ] include/linux/rcupdate.h:560 Illegal context switch in RCU read-side critical section!
[ ]
[ ] rcu\_scheduler\_active = 1, debug\_locks = 0
[ ] 4 locks held by ovs-vswitchd/1969:
[ ] #0: (cb\_lock){++++++}, at: [] genl\_rcv+0x19/0x40
[ ] #1: (ovs\_mutex){+.+.+.}, at: [] ovs\_vport\_cmd\_del+0x4a/0x100 [openvswitch]
[ ] #2: (rtnl\_mutex){+.+.+.}, at: [] rtnl\_lock+0x17/0x20
[ ] #3: (rcu\_read\_lock){......}, at: [] packet\_notifier+0x5/0x3f0
[ ]
[ ] Call Trace:
[ ] [] dump\_stack+0x85/0xc4
[ ] [] lockdep\_rcu\_suspicious+0x107/0x110
[ ] [] \_\_\_might\_sleep+0x57/0x210
[ ] [] \_\_might\_sleep+0x70/0x90
[ ] [] mutex\_lock\_nested+0x3c/0x3a0
[ ] [] ? vprintk\_default+0x1f/0x30
[ ] [] ? printk+0x4d/0x4f
[ ] [] fanout\_release+0x1d/0xe0
[ ] [] packet\_notifier+0x2f9/0x3f0
2. calling mutex\_lock(&fanout\_mutex) inside spin\_lock(&po->bind\_lock).
"sleeping function called from invalid context"
[ ] BUG: sleeping function called from invalid context at kernel/locking/mutex.c:620
[ ] in\_atomic(): 1, irqs\_disabled(): 0, pid: 1969, name: ovs-vswitchd
[ ] INFO: lockdep is turned off.
[ ] Call Trace:
[ ] [] dump\_stack+0x85/0xc4
[ ] [] \_\_\_might\_sleep+0x202/0x210
[ ] [] \_\_might\_sleep+0x70/0x90
[ ] [] mutex\_lock\_nested+0x3c/0x3a0
[ ] [] fanout\_release+0x1d/0xe0
[ ] [] packet\_notifier+0x2f9/0x3f0
3. calling dev\_remove\_pack(&fanout->prot\_hook), from inside
spin\_lock(&po->bind\_lock) or rcu\_read-side critical-section. dev\_remove\_pack()
-> synchronize\_net(), which might sleep.
[ ] BUG: scheduling while atomic: ovs-vswitchd/1969/0x00000002
[ ] INFO: lockdep is turned off.
[ ] Call Trace:
[ ] [] dump\_stack+0x85/0xc4
[ ] [] \_\_schedule\_bug+0x64/0x73
[ ] [] \_\_schedule+0x6b/0xd10
[ ] [] schedule+0x6b/0x80
[ ] [] schedule\_timeout+0x38d/0x410
[ ] [] synchronize\_sched\_expedited+0x53d/0x810
[ ] [] synchronize\_rcu\_expedited+0xe/0x10
[ ] [] synchronize\_net+0x35/0x50
[ ] [] dev\_remove\_pack+0x13/0x20
[ ] [] fanout\_release+0xbe/0xe0
[ ] [] packet\_notifier+0x2f9/0x3f0
4. fanout\_release() races with calls from different CPU.
To fix the above problems, remove the call to fanout\_release() under
rcu\_read\_lock(). Instead, call \_\_dev\_remove\_pack(&fanout->prot\_hook) and
netdev\_run\_todo will be happy that &dev->ptype\_specific list is empty. In order
to achieve this, I moved dev\_{add,remove}\_pack() out of fanout\_{add,release} to
\_\_fanout\_{link,unlink}. So, call to {,\_\_}unregister\_prot\_hook() will make sure
fanout->prot\_hook is removed as well.
Fixes: 6664498280cf ("packet: call fanout\_release, while UNREGISTERING a netdev")
Reported-by: Eric Dumazet
Signed-off-by: Anoob Soman
Acked-by: Eric Dumazet
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 722737f27774b14be5a1d2d3b9281dcded7c48b2
Author: Eric Dumazet
Date: Tue Feb 14 09:03:51 2017 -0800
packet: fix races in fanout\_add()
[ Upstream commit d199fab63c11998a602205f7ee7ff7c05c97164b ]
Multiple threads can call fanout\_add() at the same time.
We need to grab fanout\_mutex earlier to avoid races that could
lead to one thread freeing po->rollover that was set by another thread.
Do the same in fanout\_release(), for peace of mind, and to help us
finding lockdep issues earlier.
Fixes: dc99f600698d ("packet: Add fanout support.")
Fixes: 0648ab70afe6 ("packet: rollover prepare: per-socket state")
Signed-off-by: Eric Dumazet
Cc: Willem de Bruijn
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit e0cb28247882a90f60b219f335c00d8d578cbe66
Author: Ivan Khoronzhuk
Date: Tue Feb 14 14:42:15 2017 +0200
net: ethernet: ti: cpsw: fix cpsw assignment in resume
[ Upstream commit a60ced990e309666915d21445e95347d12406694 ]
There is a copy-paste error, which hides breaking of resume
for CPSW driver: there was replaced netdev\_priv() to ndev\_to\_cpsw(ndev)
in suspend, but left it unchanged in resume.
Fixes: 606f39939595a4d4540406bfc11f265b2036af6d
(ti: cpsw: move platform data and slaves info to cpsw\_common)
Reported-by: Alexey Starikovskiy
Signed-off-by: Ivan Khoronzhuk
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 42b52783a59cc706c71cdc7096edce4a6f086fd3
Author: Eric Dumazet
Date: Sun Feb 12 14:03:52 2017 -0800
net/llc: avoid BUG\_ON() in skb\_orphan()
[ Upstream commit 8b74d439e1697110c5e5c600643e823eb1dd0762 ]
It seems nobody used LLC since linux-3.12.
Fortunately fuzzers like syzkaller still know how to run this code,
otherwise it would be no fun.
Setting skb->sk without skb->destructor leads to all kinds of
bugs, we now prefer to be very strict about it.
Ideally here we would use skb\_set\_owner() but this helper does not exist yet,
only CAN seems to have a private helper for that.
Fixes: 376c7311bdb6 ("net: add a temporary sanity check in skb\_orphan()")
Signed-off-by: Eric Dumazet
Reported-by: Andrey Konovalov
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 859900c24bff90768e1789bd93e1b51fa726a659
Author: Or Gerlitz
Date: Sun Feb 12 11:21:31 2017 +0200
net/mlx5e: Disable preemption when doing TC statistics upcall
[ Upstream commit fed06ee89b78d3af32e235e0e89ad0d946fcb95d ]
When called by HW offloading drivers, the TC action (e.g
net/sched/act\_mirred.c) code uses this\_cpu logic, e.g
\_bstats\_cpu\_update(this\_cpu\_ptr(a->cpu\_bstats), bytes, packets)
per the kernel documention, preemption should be disabled, add that.
Before the fix, when running with CONFIG\_PREEMPT set, we get a
BUG: using smp\_processor\_id() in preemptible [00000000] code: tc/3793
asserion from the TC action (mirred) stats\_update callback.
Fixes: aad7e08d39bd ('net/mlx5e: Hardware offloaded flower filter statistics support')
Signed-off-by: Or Gerlitz
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 90aa7993d5c7fdc476009189a9b2a65d97fe9350
Author: WANG Cong
Date: Mon Feb 13 11:13:16 2017 -0800
kcm: fix a null pointer dereference in kcm\_sendmsg()
[ Upstream commit cd27b96bc13841ee7af25837a6ae86fee87273d6 ]
In commit 98e3862ca2b1 ("kcm: fix 0-length case for kcm\_sendmsg()")
I tried to avoid skb allocation for 0-length case, but missed
a check for NULL pointer in the non EOR case.
Fixes: 98e3862ca2b1 ("kcm: fix 0-length case for kcm\_sendmsg()")
Reported-by: Dmitry Vyukov
Cc: Tom Herbert
Signed-off-by: Cong Wang
Acked-by: Tom Herbert
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 1409935400aa1faffd9fe1830adb8ea08ea424d2
Author: WANG Cong
Date: Tue Feb 7 12:59:47 2017 -0800
kcm: fix 0-length case for kcm\_sendmsg()
[ Upstream commit 98e3862ca2b1ae595a13805dcab4c3a6d7718f4d ]
Dmitry reported a kernel warning:
WARNING: CPU: 3 PID: 2936 at net/kcm/kcmsock.c:627
kcm\_write\_msgs+0x12e3/0x1b90 net/kcm/kcmsock.c:627
CPU: 3 PID: 2936 Comm: a.out Not tainted 4.10.0-rc6+ #209
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011
Call Trace:
\_\_dump\_stack lib/dump\_stack.c:15 [inline]
dump\_stack+0x2ee/0x3ef lib/dump\_stack.c:51
panic+0x1fb/0x412 kernel/panic.c:179
\_\_warn+0x1c4/0x1e0 kernel/panic.c:539
warn\_slowpath\_null+0x2c/0x40 kernel/panic.c:582
kcm\_write\_msgs+0x12e3/0x1b90 net/kcm/kcmsock.c:627
kcm\_sendmsg+0x163a/0x2200 net/kcm/kcmsock.c:1029
sock\_sendmsg\_nosec net/socket.c:635 [inline]
sock\_sendmsg+0xca/0x110 net/socket.c:645
sock\_write\_iter+0x326/0x600 net/socket.c:848
new\_sync\_write fs/read\_write.c:499 [inline]
\_\_vfs\_write+0x483/0x740 fs/read\_write.c:512
vfs\_write+0x187/0x530 fs/read\_write.c:560
SYSC\_write fs/read\_write.c:607 [inline]
SyS\_write+0xfb/0x230 fs/read\_write.c:599
entry\_SYSCALL\_64\_fastpath+0x1f/0xc2
when calling syscall(\_\_NR\_write, sock2, 0x208aaf27ul, 0x0ul) on a KCM
seqpacket socket. It appears that kcm\_sendmsg() does not handle len==0
case correctly, which causes an empty skb is allocated and queued.
Fix this by skipping the skb allocation for len==0 case.
Reported-by: Dmitry Vyukov
Cc: Tom Herbert
Signed-off-by: Cong Wang
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman


=== Content from cveform.mitre.org_c3616b63_20250126_111220.html ===


[![CVE logo](Content/cveLogoR.svg)](https://cve.org/)

[CVE Records
![CVE Record search](Content/search_icon.png)](https://cve.mitre.org/cve/search_cve_list.html)

[Search CVE Records](https://cve.mitre.org/cve/search_cve_list.html)

## Submit a CVE Request

\* Required

![errors](Content/exclamation.jpg)

\* Select a request type

- Please choose an action -
Report Vulnerability/Request CVE ID
Notify CVE about a publication
Request an update to an existing CVE Entry
Request information on the CVE Numbering Authority (CNA) Program
Other

![errors](Content/exclamation.jpg)

\* Enter your e-mail address

![alert](Content/info.jpg)

IMPORTANT: Please add cve-request@mitre.org and cve@mitre.org as
safe senders in your email client before completing this form.

Enter a PGP Key (to encrypt)

Processing....

#### Legal

* [Terms of Use](https://cve.org/Legal/TermsOfUse)
* [Privacy Policy](https://cve.org/Legal/PrivacyPolicy)

#### Media

* [News](https://cve.org/Media/News)
* [Events](https://cve.org/Media/Events)
* [Sign up for e-newsletter](https://cve.mitre.org/news/newsletter.html)

##### Social Media

[github

![](Content/github.png)](https://github.com/CVEProject)
[linkedin

![](Content/linkedin.png)](https://www.linkedin.com/showcase/cve-cwe-capec)
[youtube

![](Content/youtube.png)](https://www.youtube.com/channel/UCUHd2XFDsKH8kjMZQaSKpDQ/)
[twitter for CVE New

![](Content/twitter.png)
New CVE Records](https://twitter.com/CVEnew/)
[twitter for CVE announce

![](Content/twitter.png)
 CVE Announce](https://twitter.com/CVEannounce/)

#### Contact

* [CVE Program Support](https://cveform.mitre.org)
* [CNA](https://cve.org/PartnerInformation/ListofPartners)
* [CVE Website Support](https://cveform.mitre.org)

Use of the CVE® List and the associated references from this website are subject to the
[terms of use](https://cve.org/Legal/TermsOfUse). CVE is sponsored by the
[U.S. Department of Homeland Security (DHS)](https://www.dhs.gov/)
 [Cybersecurity and Infrastructure Security Agency (CISA)](https://www.dhs.gov/cisa/cybersecurity-division/). Copyright © 1999-2023,
[The MITRE Corporation](https://www.mitre.org/). CVE and the CVE logo are registered trademarks of The MITRE Corporation.

×
#### Vulnerability Information

Vulnerability Type

CWE-ID

Definition

Buffer Overflow

[CWE-119](http://cwe.mitre.org/data/definitions/119.html)

The software performs operations on a memory buffer, but it can read from or write to a memory location that is outside of the intended boundary of the buffer.

Cross Site Scripting (XSS)

[CWE-79](http://cwe.mitre.org/data/definitions/79.html)

The software does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.

SQL Injection

[CWE-89](http://cwe.mitre.org/data/definitions/89.html)

The software constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component.

Directory Traversal

[CWE-22](http://cwe.mitre.org/data/definitions/22.html)

The software uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the software does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.

XML External Entity (XXE)

[CWE-611](http://cwe.mitre.org/data/definitions/611.html)

The software processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.

Insecure Permissions

[CWE-276](http://cwe.mitre.org/data/definitions/276.html)

The software, upon installation, sets incorrect permissions for an object that exposes it to an unintended actor.

Incorrect Access Control

[CWE-284](http://cwe.mitre.org/data/definitions/284.html)

The software does not restrict or incorrectly restricts access to a resource from an unauthorized actor.

Integer Overflow

[CWE-190](http://cwe.mitre.org/data/definitions/190.html)

The software performs a calculation that can produce an integer overflow or wraparound, when the logic assumes that the resulting value will always be larger than the original value. This can introduce other weaknesses when the calculation is used for resource management or execution control.

Cross Site Request Forgery (CSRF)

[CWE-352](http://cwe.mitre.org/data/definitions/352.html)

The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.

Missing SSL certification verification

[CWE-599](http://cwe.mitre.org/data/definitions/599.html)

The software uses OpenSSL and trusts or uses a certificate without using the SSL\_get\_verify\_result() function to ensure that the certificate satisfies all necessary security requirements.

Other or Unknown

N/A

The software contains a mistake other than above which can be directly used by a hacker to gain access to a system or network.

×
#### Other Vulnerability Information

You can find more information at [cwe.mitre.org](http://cwe.mitre.org)

* Algorithm complexity
* Array index error
* Auth bypass using cookie
* Buffer Overflow
* Cross-Site Request Forgery (CSRF)
* Cross-Site Scripting (XSS)
* Directory Traversal
* Double free
* Eval injection
* File Upload
* Format String
* HTTP Response Splitting

* HTTP Request Splitting
* Incomplete blacklist
* Integer Overflow
* Integer Signedness
* Memory Leak
* Shell Metacharacter Injectoin
* Open Redirect
* Redirect without Exit
* Path Disclosure
* Insecure Permissions
* PHP remote file inclusion
* Session Fixation

* SQL Injection
* Symbolic Link Following
* Untrusted Search Path
* Unquoted Windows search path
* Use after free
* Default user/password
* Large or infinite loop
* Exposed insecure/unsafe method in ActiveX control
* Generation of insufficiently random numbers
* XML Extneral Entity (XXE)
* Incorrect Access Control
* Missing SSL certificate validation

×
#### Vulnerability Information

Attack Type

Definition

Remote

The vulnerability can be exploited through a network. The attacker may be either on the adjacent or remote network.

Local

To exploit the vulnerability, the attacker needs to be logged into the operating system on a local machine or a guest operating system.

Physical

The attacker needs to be located near the victim or have physical access to the vulnerable system to exploit the vulnerability. Examples include touching a workstation keyboard or USB device, "shoulder surfing" to see a workstation's display, and touching the screen of a mobile device.

Context-dependent

The type of access needed to exploit the vulnerability is dependent on how the vulnerable product is used. This is most often used for libraries.

×
#### Vulnerability Information

Update Type

Definition

Duplicate

More than one CVE ID has been assigned to a single vulnerability.

Rejection

Vendor rejects the assignment of a particular CVE ID.

Split/Merge

A single CVE Entry should be split into two or more CVE Entries OR Two or more existing CVE Entries should be merged into a single CVE Entry.

Update Description

Update the description in an existing CVE Entry.

Update References

Add, remove, or change a reference for an existing CVE Entry.

Other

Any request related to an existing CVE Entry that does not fall within one of the other categories.



=== Content from www.debian.org_a4b392c9_20250125_185445.html ===


---

[[Date Prev](msg00058.html)][[Date Next](msg00060.html)]
[[Thread Prev](msg00058.html)][[Thread Next](msg00060.html)]
[[Date Index](maillist.html#00059)]
[[Thread Index](threads.html#00059)]

# [SECURITY] [DSA 3804-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3804-1] linux security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Wed, 08 Mar 2017 16:59:59 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1clewR-0006ii-Mp%40master.debian.org) [E1clewR-0006ii-Mp@master.debian.org](msg00059.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3804-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
March 08, 2017                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2016-9588 CVE-2017-2636 CVE-2017-5669 CVE-2017-5986
                 CVE-2017-6214 CVE-2017-6345 CVE-2017-6346 CVE-2017-6348
                 CVE-2017-6353

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or have other
impacts.

CVE-2016-9588

    Jim Mattson discovered that the KVM implementation for Intel x86
    processors does not properly handle #BP and #OF exceptions in an
    L2 (nested) virtual machine. A local attacker in an L2 guest VM
    can take advantage of this flaw to cause a denial of service for
    the L1 guest VM.

CVE-2017-2636

    Alexander Popov discovered a race condition flaw in the n_hdlc
    line discipline that can lead to a double free. A local
    unprivileged user can take advantage of this flaw for privilege
    escalation. On systems that do not already have the n_hdlc module
    loaded, this can be mitigated by disabling it:
    echo >> /etc/modprobe.d/disable-n_hdlc.conf install n_hdlc false

CVE-2017-5669

    Gareth Evans reported that privileged users can map memory at
    address 0 through the shmat() system call. This could make it
    easier to exploit other kernel security vulnerabilities via a
    set-UID program.

CVE-2017-5986

    Alexander Popov reported a race condition in the SCTP
    implementation that can be used by local users to cause a
    denial-of-service (crash). The initial fix for this was incorrect
    and introduced further security issues (CVE-2017-6353). This
    update includes a later fix that avoids those. On systems that do
    not already have the sctp module loaded, this can be mitigated by
    disabling it:
    echo >> /etc/modprobe.d/disable-sctp.conf install sctp false

CVE-2017-6214

    Dmitry Vyukov reported a bug in the TCP implementation's handling
    of urgent data in the splice() system call. This can be used by a
    remote attacker for denial-of-service (hang) against applications
    that read from TCP sockets with splice().

CVE-2017-6345

    Andrey Konovalov reported that the LLC type 2 implementation
    incorrectly assigns socket buffer ownership. This can be used
    by a local user to cause a denial-of-service (crash). On systems
    that do not already have the llc2 module loaded, this can be
    mitigated by disabling it:
    echo >> /etc/modprobe.d/disable-llc2.conf install llc2 false

CVE-2017-6346

    Dmitry Vyukov reported a race condition in the raw packet (af_packet)
    fanout feature. Local users with the CAP_NET_RAW capability (in any
    user namespace) can use this for denial-of-service and possibly for
    privilege escalation.

CVE-2017-6348

    Dmitry Vyukov reported that the general queue implementation in
    the IrDA subsystem does not properly manage multiple locks,
    possibly allowing local users to cause a denial-of-service
    (deadlock) via crafted operations on IrDA devices.

For the stable distribution (jessie), these problems have been fixed in
version 3.16.39-1+deb8u2.

We recommend that you upgrade your linux packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAljAOE9fFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0Q3Rg/7BAWcn97hmyotDGbm1LQLrRBiyjW66+aT51IHzbKbY8y+dVUodFDOeVpt
EWoisRwmeLj8A79v5GTV9Fdhu86vKt+E7N93KVeNQY8ELLxNEM+v4R0QGFbfzFpz
8CQn3kpZgQP9grMKBiY2quJNgXm18eWBDBdpQwvkOzr5AtKGNnX9nqEx6xWezA79
okdBJM88jETOWWI91njTCJIVYFhJOw1hBV+dYJVZIibR5pvjRLHRkGXhVDvE5erZ
m5VehpBlmdJAuK9JoovzKenEWJmAL775nwWKIyau4P+FsQxkPzuk1sk4MrqC9ZML
KShQP9FX/YbqhBDtIN/8pTK/r0zqn/L0FZc89woqdTCotzrgoRjiSjgTU37WhU66
YxfDNYzJ7EeAWH68UjiMNcABz4tlEr5U8B+eQLJYzgGeF5s37j3l0UqmWJ/6j8fB
gaza8eLvw0/97Cx9Wzp7blbjaQ722z0tfKJ7NiLgGTUJU655R4XtMAcPDc8Dr8mP
ocncMDy76L+B9JdTh3+KK0DsMv0YLnOK/d6LzHkGJtap/UubQZTNHIeAd472Sygm
iBj/R2ZZhZRoMoWjqlmBf4ZjyVgOpofOYSWPJ/AEdgF8zkCMA1ZBmB/WXqLyvOkh
WFR8Cq23dNS+GYtyqqi7jbAhEzqv36fzJ7pymr1/RrikrRwRW3E=
=WOjC
-----END PGP SIGNATURE-----

```

---



=== Content from git.kernel.org_5bb97578_20250126_111219.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2017-02-14 09:03:51 -0800 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2017-02-14 15:05:12 -0500 |
| commit | [d199fab63c11998a602205f7ee7ff7c05c97164b](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d199fab63c11998a602205f7ee7ff7c05c97164b) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)) | |
| tree | [9977e38c6afb849d7f823820b73d160092415e60](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=d199fab63c11998a602205f7ee7ff7c05c97164b) | |
| parent | [f39f0d1e1e93145a0e91d9a7a639c42fd037ecc3](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f39f0d1e1e93145a0e91d9a7a639c42fd037ecc3) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=d199fab63c11998a602205f7ee7ff7c05c97164b&id2=f39f0d1e1e93145a0e91d9a7a639c42fd037ecc3)) | |
| download | [linux-d199fab63c11998a602205f7ee7ff7c05c97164b.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-d199fab63c11998a602205f7ee7ff7c05c97164b.tar.gz) | |

packet: fix races in fanout\_add()Multiple threads can call fanout\_add() at the same time.
We need to grab fanout\_mutex earlier to avoid races that could
lead to one thread freeing po->rollover that was set by another thread.
Do the same in fanout\_release(), for peace of mind, and to help us
finding lockdep issues earlier.
Fixes: dc99f600698d ("packet: Add fanout support.")
Fixes: 0648ab70afe6 ("packet: rollover prepare: per-socket state")
Signed-off-by: Eric Dumazet <edumazet@google.com>
Cc: Willem de Bruijn <willemb@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)

| -rw-r--r-- | [net/packet/af\_packet.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/net/packet/af_packet.c?id=d199fab63c11998a602205f7ee7ff7c05c97164b) | 55 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 30 insertions, 25 deletions

| diff --git a/net/packet/af\_packet.c b/net/packet/af\_packet.cindex d56ee46b11fc95..0f03f6a53b4ddb 100644--- a/[net/packet/af\_packet.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/packet/af_packet.c?id=f39f0d1e1e93145a0e91d9a7a639c42fd037ecc3)+++ b/[net/packet/af\_packet.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/packet/af_packet.c?id=d199fab63c11998a602205f7ee7ff7c05c97164b)@@ -1619,6 +1619,7 @@ static void fanout\_release\_data(struct packet\_fanout \*f)  static int fanout\_add(struct sock \*sk, u16 id, u16 type\_flags) {+ struct packet\_rollover \*rollover = NULL; struct packet\_sock \*po = pkt\_sk(sk); struct packet\_fanout \*f, \*match; u8 type = type\_flags & 0xff;@@ -1641,23 +1642,28 @@ static int fanout\_add(struct sock \*sk, u16 id, u16 type\_flags) return -EINVAL; } + mutex\_lock(&fanout\_mutex);++ err = -EINVAL; if (!po->running)- return -EINVAL;+ goto out; + err = -EALREADY; if (po->fanout)- return -EALREADY;+ goto out;  if (type == PACKET\_FANOUT\_ROLLOVER || (type\_flags & PACKET\_FANOUT\_FLAG\_ROLLOVER)) {- po->rollover = kzalloc(sizeof(\*po->rollover), GFP\_KERNEL);- if (!po->rollover)- return -ENOMEM;- atomic\_long\_set(&po->rollover->num, 0);- atomic\_long\_set(&po->rollover->num\_huge, 0);- atomic\_long\_set(&po->rollover->num\_failed, 0);+ err = -ENOMEM;+ rollover = kzalloc(sizeof(\*rollover), GFP\_KERNEL);+ if (!rollover)+ goto out;+ atomic\_long\_set(&rollover->num, 0);+ atomic\_long\_set(&rollover->num\_huge, 0);+ atomic\_long\_set(&rollover->num\_failed, 0);+ po->rollover = rollover; } - mutex\_lock(&fanout\_mutex); match = NULL; list\_for\_each\_entry(f, &fanout\_list, list) { if (f->id == id &&@@ -1704,11 +1710,11 @@ static int fanout\_add(struct sock \*sk, u16 id, u16 type\_flags) } } out:- mutex\_unlock(&fanout\_mutex);- if (err) {- kfree(po->rollover);+ if (err && rollover) {+ kfree(rollover); po->rollover = NULL; }+ mutex\_unlock(&fanout\_mutex); return err; } @@ -1717,23 +1723,22 @@ static void fanout\_release(struct sock \*sk) struct packet\_sock \*po = pkt\_sk(sk); struct packet\_fanout \*f; - f = po->fanout;- if (!f)- return;- mutex\_lock(&fanout\_mutex);- po->fanout = NULL;+ f = po->fanout;+ if (f) {+ po->fanout = NULL;++ if (atomic\_dec\_and\_test(&f->sk\_ref)) {+ list\_del(&f->list);+ dev\_remove\_pack(&f->prot\_hook);+ fanout\_release\_data(f);+ kfree(f);+ } - if (atomic\_dec\_and\_test(&f->sk\_ref)) {- list\_del(&f->list);- dev\_remove\_pack(&f->prot\_hook);- fanout\_release\_data(f);- kfree(f);+ if (po->rollover)+ kfree\_rcu(po->rollover, rcu); } mutex\_unlock(&fanout\_mutex);-- if (po->rollover)- kfree\_rcu(po->rollover, rcu); }  static bool packet\_extra\_vlan\_len\_allowed(const struct net\_device \*dev, |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-26 11:10:56 +0000



=== Content from git.kernel.org_ef8efd8e_20250125_185443.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2017-02-14 09:03:51 -0800 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2017-02-14 15:05:12 -0500 |
| commit | [d199fab63c11998a602205f7ee7ff7c05c97164b](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d199fab63c11998a602205f7ee7ff7c05c97164b) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)) | |
| tree | [9977e38c6afb849d7f823820b73d160092415e60](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=d199fab63c11998a602205f7ee7ff7c05c97164b) | |
| parent | [f39f0d1e1e93145a0e91d9a7a639c42fd037ecc3](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f39f0d1e1e93145a0e91d9a7a639c42fd037ecc3) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=d199fab63c11998a602205f7ee7ff7c05c97164b&id2=f39f0d1e1e93145a0e91d9a7a639c42fd037ecc3)) | |
| download | [linux-d199fab63c11998a602205f7ee7ff7c05c97164b.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-d199fab63c11998a602205f7ee7ff7c05c97164b.tar.gz) | |

packet: fix races in fanout\_add()Multiple threads can call fanout\_add() at the same time.
We need to grab fanout\_mutex earlier to avoid races that could
lead to one thread freeing po->rollover that was set by another thread.
Do the same in fanout\_release(), for peace of mind, and to help us
finding lockdep issues earlier.
Fixes: dc99f600698d ("packet: Add fanout support.")
Fixes: 0648ab70afe6 ("packet: rollover prepare: per-socket state")
Signed-off-by: Eric Dumazet <edumazet@google.com>
Cc: Willem de Bruijn <willemb@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=d199fab63c11998a602205f7ee7ff7c05c97164b)

| -rw-r--r-- | [net/packet/af\_packet.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/net/packet/af_packet.c?id=d199fab63c11998a602205f7ee7ff7c05c97164b) | 55 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 30 insertions, 25 deletions

| diff --git a/net/packet/af\_packet.c b/net/packet/af\_packet.cindex d56ee46b11fc95..0f03f6a53b4ddb 100644--- a/[net/packet/af\_packet.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/packet/af_packet.c?id=f39f0d1e1e93145a0e91d9a7a639c42fd037ecc3)+++ b/[net/packet/af\_packet.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/packet/af_packet.c?id=d199fab63c11998a602205f7ee7ff7c05c97164b)@@ -1619,6 +1619,7 @@ static void fanout\_release\_data(struct packet\_fanout \*f)  static int fanout\_add(struct sock \*sk, u16 id, u16 type\_flags) {+ struct packet\_rollover \*rollover = NULL; struct packet\_sock \*po = pkt\_sk(sk); struct packet\_fanout \*f, \*match; u8 type = type\_flags & 0xff;@@ -1641,23 +1642,28 @@ static int fanout\_add(struct sock \*sk, u16 id, u16 type\_flags) return -EINVAL; } + mutex\_lock(&fanout\_mutex);++ err = -EINVAL; if (!po->running)- return -EINVAL;+ goto out; + err = -EALREADY; if (po->fanout)- return -EALREADY;+ goto out;  if (type == PACKET\_FANOUT\_ROLLOVER || (type\_flags & PACKET\_FANOUT\_FLAG\_ROLLOVER)) {- po->rollover = kzalloc(sizeof(\*po->rollover), GFP\_KERNEL);- if (!po->rollover)- return -ENOMEM;- atomic\_long\_set(&po->rollover->num, 0);- atomic\_long\_set(&po->rollover->num\_huge, 0);- atomic\_long\_set(&po->rollover->num\_failed, 0);+ err = -ENOMEM;+ rollover = kzalloc(sizeof(\*rollover), GFP\_KERNEL);+ if (!rollover)+ goto out;+ atomic\_long\_set(&rollover->num, 0);+ atomic\_long\_set(&rollover->num\_huge, 0);+ atomic\_long\_set(&rollover->num\_failed, 0);+ po->rollover = rollover; } - mutex\_lock(&fanout\_mutex); match = NULL; list\_for\_each\_entry(f, &fanout\_list, list) { if (f->id == id &&@@ -1704,11 +1710,11 @@ static int fanout\_add(struct sock \*sk, u16 id, u16 type\_flags) } } out:- mutex\_unlock(&fanout\_mutex);- if (err) {- kfree(po->rollover);+ if (err && rollover) {+ kfree(rollover); po->rollover = NULL; }+ mutex\_unlock(&fanout\_mutex); return err; } @@ -1717,23 +1723,22 @@ static void fanout\_release(struct sock \*sk) struct packet\_sock \*po = pkt\_sk(sk); struct packet\_fanout \*f; - f = po->fanout;- if (!f)- return;- mutex\_lock(&fanout\_mutex);- po->fanout = NULL;+ f = po->fanout;+ if (f) {+ po->fanout = NULL;++ if (atomic\_dec\_and\_test(&f->sk\_ref)) {+ list\_del(&f->list);+ dev\_remove\_pack(&f->prot\_hook);+ fanout\_release\_data(f);+ kfree(f);+ } - if (atomic\_dec\_and\_test(&f->sk\_ref)) {- list\_del(&f->list);- dev\_remove\_pack(&f->prot\_hook);- fanout\_release\_data(f);- kfree(f);+ if (po->rollover)+ kfree\_rcu(po->rollover, rcu); } mutex\_unlock(&fanout\_mutex);-- if (po->rollover)- kfree\_rcu(po->rollover, rcu); }  static bool packet\_extra\_vlan\_len\_allowed(const struct net\_device \*dev, |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-25 18:53:21 +0000


