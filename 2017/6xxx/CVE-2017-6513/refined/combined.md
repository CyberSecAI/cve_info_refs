=== Content from gist.github.com_f16d81d9_20250124_164359.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fsedrubal%2Fa83fa22f1091025a5c1a14aabd711ad7)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fsedrubal%2Fa83fa22f1091025a5c1a14aabd711ad7&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fsedrubal%2Fa83fa22f1091025a5c1a14aabd711ad7) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fsedrubal%2Fa83fa22f1091025a5c1a14aabd711ad7&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@sedrubal](https://avatars.githubusercontent.com/u/5571650?s=64&v=4)](/sedrubal)

# [sedrubal](/sedrubal)/**[CVE-2017-6513.md](/sedrubal/a83fa22f1091025a5c1a14aabd711ad7)**

Last active
April 19, 2017 06:37

Show Gist options

* [Download ZIP](/sedrubal/a83fa22f1091025a5c1a14aabd711ad7/archive/1c3551f975dd7e8a61e3a23cc0cd0fa6eed9e2f4.zip)

* [Star
  1
  (1)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fsedrubal%2Fa83fa22f1091025a5c1a14aabd711ad7)You must be signed in to star a gist
* [Fork
  0
  (0)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fsedrubal%2Fa83fa22f1091025a5c1a14aabd711ad7)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/sedrubal/a83fa22f1091025a5c1a14aabd711ad7.js&quot;&gt;&lt;/script&gt;
* Save sedrubal/a83fa22f1091025a5c1a14aabd711ad7 to your computer and use it in GitHub Desktop.

[Code](/sedrubal/a83fa22f1091025a5c1a14aabd711ad7)
[Revisions
14](/sedrubal/a83fa22f1091025a5c1a14aabd711ad7/revisions)
[Stars
1](/sedrubal/a83fa22f1091025a5c1a14aabd711ad7/stargazers)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/sedrubal/a83fa22f1091025a5c1a14aabd711ad7.js&quot;&gt;&lt;/script&gt;

Save sedrubal/a83fa22f1091025a5c1a14aabd711ad7 to your computer and use it in GitHub Desktop.

[Download ZIP](/sedrubal/a83fa22f1091025a5c1a14aabd711ad7/archive/1c3551f975dd7e8a61e3a23cc0cd0fa6eed9e2f4.zip)

WHMCS Reseller Module V2 for Softaculous Virtualizor Privilege Escalation

 [Raw](/sedrubal/a83fa22f1091025a5c1a14aabd711ad7/raw/1c3551f975dd7e8a61e3a23cc0cd0fa6eed9e2f4/CVE-2017-6513.md)

[**CVE-2017-6513.md**](#file-cve-2017-6513-md)

# Security Advisory for [CVE-2017-6513](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6513)

CVE ID: CVE-2017-6513: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6513>

## Dates

* 2017-03-06 01:00 CET: Sebastian discovered the vulnerability while using the software provided by IP Interactive UG. He tried to estimate the consequences of this issue.
* 2017-03-06 02:00 CET: Sebastian contacted IP Interactive UG, because he thought it's an issue in their specific installation.
* 2017-03-06 before 14:15 CET: IP Interactive UG contacted Softaculous and received a patch for this issue. He reported this to Sebastian and the issue could not be reproduced anymore.
* 2017-03-06 14:20 CET: During a discussion with Julian we found out that this issue needs a CVE-ID and a public announcement. Sebastian tried to gather information. He asked IP Interactive UG and tried to install the software locally.
* 2017-03-06 17:00 CET: First contact with Softaculous
* 2017-03-06 18:45 CET: Sebastian requested an CVE-ID. He received the CVE-ID CVE-2017-6513 at 20:30.
* 2017-03-08 12:00 CET: First response from Softaculous. They confirmed the issue.
  + Sebastian is polling for more information the next days.
  + They confirmed publishing a CVE but asked for waiting until the cause of the issue get fixed.
  + They helped filling out the CVE by requesting changes to the draft.
* 2017-03-10 16:30 CET: Softaculous granted a bounty of $100.
* 2017-03-10: Softaculous release an updated version of WHMCS Module for Resellers V2.
* 2017-04-11: Sebastian published the CVE and the security advisory.

## Description

The WHMCS Reseller Module V2 2.0.2 for Softaculous Virtualizor does not verify the API calls correctly, which allows remote authenticated allows users to gain access of other users VPS who are under the same reseller by accessing a modified URL.

## Vulnerability Type

Incorrect Access Control

## Vendor of Product

[Softaculous](https://softaculous.com/)

## Prerequisites

* [WHMCS Module for Resellers V2 `<=2.0.2`](http://www.virtualizor.com/wiki/WHMCS_Module_for_Resellers_V2)
* [Virtualizor](http://virtualizor.com)

> (Note: This is only possible in WHMCS Reseller Module, not the normal WHMCS Module)

## Proof of Concept

### Description by the developer:

> When the [WHMCS v2 Reseller] module loads the enduser panel in WHMCS after VPS is provisioned, at that time we [Virtualizor] load it using API calls.
> For example we load the panel in an iframe using following URL :
> `src = clientsservices.php?vapi_mode=1&userid=USERID&id=ORDERID&give=index.html#act=vpsmanage`

> The above URL is responsible to get the enduser panel for that VPS for that user logged in. So user are allowed to access only vpsmanage wizard.

> Now when you try to access the above URL in new tab as follows :
> `WHMCS_URL/admin/clientsservices.php?vapi_mode=1&userid=USERID&id=ORDERID&give=index.html`

> It was showing the listvs page, which was causing the issue. So that users were able to access the VPS of other users as well and perform actions to their VPS.

### Additional information by the discoverer:

[![View to manager your VPS](https://camo.githubusercontent.com/8d79ca94cf1d72b5eda820942a2d99792f8034e792b6c55777aea10cf29028f7/68747470733a2f2f692e696d6775722e636f6d2f6871666d41784c2e706e67)](https://camo.githubusercontent.com/8d79ca94cf1d72b5eda820942a2d99792f8034e792b6c55777aea10cf29028f7/68747470733a2f2f692e696d6775722e636f6d2f6871666d41784c2e706e67)

*The management interface for users includes the iframe*

[![View to list all VPSes even from other users](https://camo.githubusercontent.com/d0ac097401c2ac284213a9ccce2c96089488e4d32d2290f4b114a62da77e46a6/68747470733a2f2f692e696d6775722e636f6d2f47556d4d4469322e706e67)](https://camo.githubusercontent.com/d0ac097401c2ac284213a9ccce2c96089488e4d32d2290f4b114a62da77e46a6/68747470733a2f2f692e696d6775722e636f6d2f47556d4d4469322e706e67)

*The list of all VPS Instances of a reseller*

You can now edit (e.g. root password) or delete other VPS instances of the same reseller.

## Solution

Update to the latest version of WHMCS Module for Resellers V2: <http://virtualizor.com/wiki/WHMCS_Module_for_Resellers_V2#Download>

There also was a temporary patch for `enduser.php` in Virtualizor to avoid this issue. But you should upgrade the WHMCS Module for Resellers V2 anyway, because this temporary quick fix will be removed.

### Developers told me:

> This was not the bug in Virtualizor but to prevent this we released the quick fix so that who have not updated the module should not face the issue.

> User who have set the preference as auto update for stable, new version will be updated automatically. They will get an email notification for the new version available. We also post on our blog and forum to let users know about the new version released.
> Blog : <http://www.virtualizor.com/blog>

## Attack Type

Remote

## Impact Escalation of Privileges

true

## Reference

* <http://www.virtualizor.com/>
* <http://www.virtualizor.com/wiki/WHMCS_Module_for_Resellers_V2>
* <http://www.virtualizor.com/blog/?p=1551>

## CVSS Base Score

8.7

[AV:N/AC:L/Au:S/C:P/I:C/A:C](https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?vector=(AV:N/AC:L/Au:S/C:P/I:C/A:C/E:POC/RL:OF/RC:C/CDP:MH/TD:M/CR:H/IR:H/AR:H))

## Discoverer

* [Sebastian Endres / sedrubal](https://sedrubal.de/)

## Credits

* Oliver Dzombic ([IP Interactive UG](http://cloud-interactive.de/)): He helped to find the cause of the issue and directed me to Softaculous
* Julian Neureuther: He supported me during the CVE process

Thanks to mitre, osvdb, RedHat, Debian, nvd and many more for providing documentation and infrastructure to fill out such security advisories.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fsedrubal%2Fa83fa22f1091025a5c1a14aabd711ad7)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.virtualizor.com_8985c4f2_20250124_164358.html ===


[![virtualizor_logo](https://www.virtualizor.com/sitepad-data/uploads/2022/01/virtualizor_logo.png "virtualizor_logo")
Virtualizor](https://www.virtualizor.com)

* [Home](https://www.virtualizor.com/)
* [Features](https://www.virtualizor.com/features/)
* [Pricing](https://www.virtualizor.com/pricing/)
* [Templates](https://www.virtualizor.com/ostemplates/)
* [Docs](https://www.virtualizor.com/docs/)
* [NOC](https://www.virtualizor.com/noc/)
* [Partners](https://www.virtualizor.com/noc-partners/)
* [Contact](https://www.virtualizor.com/contact/)
* [Blog](https://www.virtualizor.com/blog/)

[Get Virtualizor](https://www.softaculous.com/clients?ca=virtbuy)

Updated WHMCS Modules

[![](https://www.virtualizor.com/site-data/assets/images/avatar.png?s=96&d=mm&r=g)
Chirag](https://www.virtualizor.com/blog/author/editor/)

[March 10, 2017](https://www.virtualizor.com/blog/2017/03/10/)

  [Uncategorized](https://www.virtualizor.com/blog/category/uncategorized/)

Hi,
We have updated the WHMCS module and the new module have the following changes and bugfixes :
1) [Bug-Fix] In WHMCS panel when NoVNC was accessed from panel, it was overwriting the 'token' and hence WHMCS was giving 'Invalid CSRF Token' error. This is fixed in the latest version of WHMCS module.
Here is the link for it :
[virtualizor.com/wiki/WHMCS\_Module](http://virtualizor.com/wiki/WHMCS_Module)
2) [Bug-Fix] In WHMCS Reseller Module V2 if the URL is modified and opened in new tab, enduser were able to access VMs of other users. This was possible in WHMCS Reseller module V2 only. This is fixed.
[http://virtualizor.com/wiki/WHMCS\_Module\_for\_Resellers\_V2 (v2.0.3)](http://virtualizor.com/wiki/WHMCS_Module_for_Resellers_V2)
**If you have Resellers who are using WHMCS module for Resellers, please let them know to update their reseller module.**
Virtualizor supports OpenVZ, Xen, XenServer, LXC and Linux-KVM on CentOS and Ubuntu and they all can be managed from the Master. We are adding more features and if you have any suggestions, do let us know. We hope you enjoy this version of Virtualizor.
Regards,
The Virtualizor Team

[Share on Facebook](https://www.facebook.com/sharer/sharer.php?u=www.virtualizor.com/blog/updated-whmcs-modules/ "fab fa-facebook-square")
[Share on Twitter](https://twitter.com/intent/tweet?url=www.virtualizor.com/blog/updated-whmcs-modules/ "fab fa-twitter-square")

[PreviousVirtualizor 2.9.0.6 Launched (Patch 6) (Stable Branch)](https://www.virtualizor.com/blog/virtualizor-2-9-0-6-launched-patch-6-stable-branch/)

[NextVirtualizor 2.9.1.2 Launched (Stable Branch)](https://www.virtualizor.com/blog/virtualizor-2-9-1-2-launched-stable-branch/)

## Experience the magic of deploying Virtual Machines within seconds.

[get started for free](https://www.virtualizor.com/trial/)

![exp](https://www.virtualizor.com/sitepad-data/uploads/2022/01/exp.png "exp")

## Subscribe to our Newsletter

Subscribe

Note :- If a Virtualizor account does not exist it will be created

[![logo2x-white](https://www.virtualizor.com/sitepad-data/uploads/2022/01/logo2x-white.png "logo2x-white")
Virtualizor](https://www.virtualizor.com)

Use the free trial and experience the magic of Virtualizor.

You can follow us on:

Join us on Discord: [Virtualizor](https://discord.gg/dUtEPq58XB)

###### VIRTUALIZOR LINKS

* [Documentation](https://www.virtualizor.com/docs/)

* [Forum](https://www.softaculous.com/board/#cid6)

* [Admin Demo](http://demo.virtualizor.com:4084/)

* [Enduser Demo](http://demo.virtualizor.com/)

* [Submit Testimonial](https://www.virtualizor.com/submit-testimonial/)

* [Premium vs Professional](https://www.virtualizor.com/premium-vs-pro/)

###### Guides

* [Install Virtualizor](https://www.virtualizor.com/docs/install/)

* [Install KVM](http://www.virtualizor.com/docs/install/install-kvm/)

* [Install XenServer](http://www.virtualizor.com/docs/install/install-xenserver/)

* [Install OpenVZ](http://www.virtualizor.com/docs/install/install-openvz-7/)

* [Install Virtuozzo](http://www.virtualizor.com/docs/install/install-virtuozzo/)

* [Install Proxmox](http://www.virtualizor.com/docs/install/install-proxmox/)

* [Hourly Billing](http://www.virtualizor.com/blog/docs/billing/virtualizor-cloud-billing-system/)

* [SolusVM Import Guide](http://www.virtualizor.com/docs/install/solusvm-import-guide/)

###### GET IN TOUCH

* [Contact Us](https://www.virtualizor.com/contact/)

* Sales Department

* [Support Forums](https://www.softaculous.com/board/#cid6)

* Support Department

* [Open a Support Ticket](https://softaculous.com/support/open.php)

###### Other Products

* [Softaculous](https://softaculous.com)

* [SitePad](https://sitepad.com)

* [Webuzo](https://webuzo.com)

* [wpCentral](https://wpcentral.co)

* [PopularFX](https://popularfx.com)

* [AMPPS](https://ampps.com)

* [Repositery](https://repositery.com)

* [Deskuss](https://deskuss.com)

###### INFORMATION

* [Blog](https://virtualizor.com/blog/)

* [OS Templates](https://www.virtualizor.com/ostemplates/)

* [License Agreement](https://www.virtualizor.com/license/)

* [Virtualizor EULA](https://www.virtualizor.com/eula/)

* [About Us](https://www.softaculous.com/about)

###### Blogs

* [Virtualizor Blog](https://virtualizor.com/blog/)

* [Softaculous Blog](https://softaculous.com/blog)

* [Webuzo Blog](https://webuzo.com/blog)

* [Softaculous News](https://softaculous.com/news)

* [AMPPS Blog](https://ampps.com/blog)

* [wpCentral Blog](https://wpcentral.co/blog/)

* [PopularFX Blog](https://popularfx.com)

* [Repositery Blog](https://repositery.com/blog/)

[© 2025 Virtualizor](https://www.virtualizor.com)

[Privacy Policy](https://www.softaculous.com/privacy)
[Terms of Use](https://www.virtualizor.com/license/)

Open Modal Box

Newsletter Subscription
Subscribing you to the mailing list



=== Content from avatars.githubusercontent.com_1e27562e_20250126_022018.html ===
�PNG

   
IHDR   @   @   %�  �IDATx��{L��ǟC��&mAE��E���LeB�t�i�˦��1&�8���nQ����q�q��,s�
�\*�L���b�@)ro)mY^^x�����m�K��q8���|��s��m��l��k~�6� \_�\_���/����k������|mL7�&\�~�4cڔIx������j5�o>T\*j�����0&$h���������ڎn���'%��H�J��f9�S�Ԓ�[pIQk۔7Y��U�s�~�����w�BG\_Z���i'� 03J��啽+���mL٢����uލBe��l�'��:�����+n�S5�
QpЌI��+[6g6# [��Y ߜ>���� �kt�z�\_�{CN1d���]?V���J����7{i\*^0Wd�WT�L���P���eSc���+������F� @iIF����wyrL �aȦ�[�;�h +`�t\*����9y���CeYm]򎏓&�ܨ��>дB�ȮR�x�Ӆy�˳��H�'�y�v�񲯿�D�4s�v��L&x���}�`Z�2rLo��à��J�/{������i>�Ӓ)�㥶��v4������~�;
-���+2�-�O����Kv��DL괔�m��VU�u&�q���G�m�������0z\�����%�@�x����a!3"Ÿ�ח,ސ�z������37�j�[\�����x�\_p.�T"��=�a͂iSm��U��(/���D��;bJKL�g�����o�km3��Pw�V�Ѣk��(�Z2׮ե~�sf|����eٔ"�O�����쓧s
���jE�-ibt��h���k�ɞ�:-�t��d�iH���ܝ�Ƚ�P�f�\* >�e�ͯvG�ۋ�י�!�',�2�a T
`4 ��I�6�-|m�B˜�]���h��i�r-���w��;.�z��rD�e����NS3�3ʝ� fLH&@kӠ�P�P�(���v&���o�/
��R�qo/\_r�|��Z��ݨ�P^Ea�:��4^dl6H�����hj����9v�h߱2��Bt��'%� �H�����Bu��=!,t�8ܚ�
�>�'��,��0?�h0�n���Q�!64�
����ܘ,E ���;`4ZCZӌ�@��s\_%L����į�4���< d��]5.�aDK�ȦHD�/�ͭu�6+�("� 
z�@ �2WmY�\��yUb��n�q�f�G��E�iF�J��{`ݬ�� `�P���e
�~����QU�����r��D�W&�o�'#>X�ޯ?x�
��������l"��Zs�Z�r��p����?���z��` �,:B᤿Bռz�!��`��f�)ə)�N9q��
�4u�OH�������ڗ�ݝ��h2� /N���M��L�����S ��z����$a�3H�c�$�A\G�h��|�X|��|Y�]U���僶�=�����9^��+Tdv9�dnp{�c/k���O�@�D�<!�n�BAh8��O���(B<���id�A�x+
����
�A�Cz�7�3
AC s��'���Fq
<�O�i{���]��1���{ !l��{�Ef��X�{����p�9cF�Q��4x��;������=�/s.5��0`�{��ޗ9�B,��I�5x��/�{��� �l/��  ��/l�0�`�    IEND�B`�
