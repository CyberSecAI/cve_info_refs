=== Content from www.debian.org_3a390980_20250125_003141.html ===


---

[[Date Prev](msg00104.html)][[Date Next](msg00106.html)]
[[Thread Prev](msg00104.html)][[Thread Next](msg00106.html)]
[[Date Index](maillist.html#00105)]
[[Thread Index](threads.html#00105)]

# [SECURITY] [DSA 3846-1] libytnef security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3846-1] libytnef security update
* *From*: Sebastien Delafond <seb@debian.org>
* *Date*: Tue, 09 May 2017 09:38:22 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1d81b4-0002M4-IL%40seger.debian.org) [E1d81b4-0002M4-IL@seger.debian.org](msg00105.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3846-1                   security@debian.org
<https://www.debian.org/security/>                       Sebastien Delafond
May 09, 2017                          <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : libytnef
CVE ID         : CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301
                 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305
                 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802
Debian Bug     :

Several issues were discovered in libytnef, a library used to decode
application/ms-tnef e-mail attachments. Multiple heap overflows,
out-of-bound writes and reads, NULL pointer dereferences and infinite
loops could be exploited by tricking a user into opening a maliciously
crafted winmail.dat file.

For the stable distribution (jessie), these problems have been fixed in
version 1.5-6+deb8u1.

For the upcoming stable (stretch) and unstable (sid) distributions,
these problems have been fixed in version 1.9.2-1.

We recommend that you upgrade your libytnef packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCgAdFiEEAqSkbVtrXP4xJMh3EL6Jg/PVnWQFAlkRizwACgkQEL6Jg/PV
nWSPBwf9H4Ztk9ZbE/MK/JKkwlett/yMn+LeeO62nge3QjT+JNf2polUZf2wJB1C
f5mXtsW4MTtwuVcbc8ex64xnmffyGS06MpkB+G1+lVbYniGpGM8jPzE0zTOMGdos
LnVM3fQe2meHbV9Sc4KO9IvFeIQppnwxvviIuPmTGvsqdnPI1j/yqPXlHgxUuxeB
QR3+4wuGbB25/lms7sZF+0vOrZYeWEecIGglMZ05gMBtsFFizfAUy2M7K3IU9qkL
sgn5o9h5980GwGrRmGznqpOvhPwfZHPg754XyRTi6kxUwPWejjYTg0yLKDDNQJJ5
0hwvZP2gESynf4nUdCZLXVpKVKyVEw==
=TGgR
-----END PGP SIGNATURE-----

```

---



=== Content from www.x41-dsec.de_fe4d89ef_20250125_003146.html ===

[![X41 D-Sec logotype](/assets/images/svg/logo.svg)](/)
![X41 D-Sec logotype](/assets/images/svg/hamburger.svg)

* [Company](/company/)
  + [Mission](/company/#company)
  + [Locations](/company/#locations)
* [News](/news/)
  + [ResearchBlog](/news/)
  + [Lab](/news/lab/)
* [PetâHMR](/pethmr/)
* [Services](/services/)
  + [Code Audit](/services/code-audit/)
  + [Red Teaming](/services/red-teaming/)
  + [Security Research](/services/security-research/)
  + [Penetration Testing](/services/penetration-testing/)
  + [Fuzzing](/services/fuzzing/)
  + [AppSec](/services/appsec/)
* [References](/references/)
* [Contact](/contact/)
* [Jobs](/jobs/)
* [FAQ](/faq/)

# NEWS

X41 D-Sec GmbH Security Advisory: X41-2017-002

# Multiple Vulnerabilities in ytnef

## Overview

**Severity Rating:** High

**Confirmed Affected Versions:** 1.9 and earlier

**Confirmed Patched Versions:** 1.9.1

**Vendor:** Yerase

**Vendor URL:** https://github.com/Yeraze/ytnef

**Vector:** Via file

**Credit:** X41 D-Sec GmbH, Eric Sesterhenn

**Status:** public

**CVE:** not yet assigned

**CVSS Score:** 7.4

**CVSS Vector:** CVSS:3.0/AV:L/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N

**Advisory-URL:** https://www.x41-dsec.de/lab/advisories/x41-2017-002-ytnef/

## Summary and Impact

Multiple Heap Overflows, out of bound writes and reads, NULL pointer dereferences and infinite loops have been discovered in ytnef 1.9 an earlier. These could be exploited by tricking a user into opening a malicious winmail.dat file.

## Product Description

ytnef offers a library and utilities to extract the files from winmail.dat files. winmail.dat files are send by Microsoft Outlook when forwarding files via e-mail. Vendor was very responsive in providing a patched version.

## Analysis

Due to the big amount of issues found no detailed analysis is given here. Almost all allocations were unchecked and out of bounds checks rarely perfomed in the code.

In total 9 patches were generated for the following issues:

1. Null Pointer Deref / calloc return value not checked
2. Infinite Loop / DoS
3. Buffer Overflow in version field
4. Out of Bound Reads
5. Integer Overflow
6. Invalid Write and Integer Overflow
7. Out of Bounds read
8. Out of Bounds read and write
9. Directory Traversal using the filename

To detail some of the findings, here are excerpts from the quickly written patch, which was send to the vendor:

Missing out of bounds checks:

```
diff --git a/lib/ytnef.c b/lib/ytnef.c
index ad92f15..5dd07a7 100644
--- a/lib/ytnef.c
+++ b/lib/ytnef.c
@@ -55,6 +55,7 @@
 #define MIN(x,y) (((x)<(y))?(x):(y))

```

#define ALLOCCHECK(x) { if(!x) { printf(âOut of Memory\nâ); exit(-1); } }

```
+#define SIZECHECK(x) { if ((((char *)d - (char *)data) + x) >= size) {  printf("Corrupted file\n"); exit(-1); } }

 void TNEFFillMapi(TNEFStruct *TNEF, BYTE *data, DWORD size, MAPIProps *p);
 	void SetFlip(void);
@@ -427,9 +428,11 @@ void TNEFFillMapi(TNEFStruct *TNEF, BYTE *data, DWORD size, MAPIProps *p) {
       length = -1;
       if (PROP_ID(mp->id) >= 0x8000) {
         // Read the GUID
+        SIZECHECK(16);
         memcpy(&(mp->guid[0]), d, 16);
         d += 16;

+        SIZECHECK(4);
         length = SwapDWord((BYTE*)d, 4);

```

Infinite Loop:

```
diff --git a/lib/ytnef.c b/lib/ytnef.c
index 328e605..43b0e56 100644
--- a/lib/ytnef.c
+++ b/lib/ytnef.c
@@ -546,6 +546,9 @@ void TNEFFillMapi(TNEFStruct *TNEF, BYTE *data, DWORD size, MAPIProps *p) {
         memcpy(vl->data, d, vl->size);
         d+=16;
         break;
+      default:
+        printf("Bad file\n");
+        exit(-1);
     }

     switch (PROP_ID(mp->id)) {

```

Buffer Overflow:

```
diff --git a/lib/tnef-types.h b/lib/tnef-types.h
index 7b6ad01..2a9709a 100644
--- a/lib/tnef-types.h
+++ b/lib/tnef-types.h
@@ -103,7 +103,7 @@ typedef struct {
 	} TNEFMemInfo;

 typedef struct {
-  char version[10];
+  char version[16];
   variableLength from;
   variableLength subject;
   dtr dateSent;

```
## Workarounds

Update to version 1.9.1 as released on https://github.com/yeraze/ytnef

## About X41 D-Sec GmbH

X41 D-Sec is a provider of application security services. We focus on application code reviews, design review and security testing. X41 D-Sec GmbH was founded in 2015 by Markus Vervier. We support customers in various industries such as finance, software development and public institutions.

## Timeline

* 2017-02-10 Issues found
* 2017-02-12 Vendor contacted
* 2017-02-12 Vendor replied
* 2017-02-12 CVE ID requested
* 2017-02-13 Pull request for patch send as per vendor request
* 2017-02-13 Issue 9 / Directory Traversal reported
* 2017-02-14 Issues fixed, 1.9.1 released
* 2017-02-15 Advisory release

Author:
Eric Sesterhenn

Date: February 15, 2017

«
[Wire Cryptography Audit (with Kudelski Security)](/security/research/news/report/2017/02/09/projects-x41-wire/)

[Advisory X41-2017-04: Multiple Vulnerabilities in tnef](/lab/advisories/x41-2017-004-tnef/)
»

CONTACT
X41 D-Sec GmbH
Soerser Weg 20
52070 Aachen

+49 (0) 241 9809418-0
+49 (0) 241 9809418-9
info@x41-dsec.de

[PGP Key](/static/pgp/0x6746CF4698A7AB6Epub.asc.txt)

Connect
[Github
![X41 Github](/assets/images/svg/github.svg)](https://github.com/x41sec "X41 Github")
[Mastodon
![X41 Mastodon](/assets/images/svg/mastodon.svg)](https://infosec.exchange/%40x41sec "X41 Mastodon")
[Twitter
![X41 Twitter](/assets/images/svg/twitter.svg)](https://twitter.com/X41Sec "X41 Twitter")
[LinkedIn
![X41 LinkedIn](/assets/images/svg/linkedin.svg)](https://de.linkedin.com/company/x41 "X41 LinkedIn")

[FAQ](/faq/)
[Partners](/references/)
[Terms of Use](/terms/)
[Privacy](/privacy/)
[Imprint](/imprint/)



=== Content from lists.fedoraproject.org_7584a360_20250125_003146.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/LFJWMUEUC4ILH2HEOCYVVLQT654ZMCGQ/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/LFJWMUEUC4ILH2HEOCYVVLQT654ZMCGQ/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/LFJWMUEUC4ILH2HEOCYVVLQT654ZMCGQ/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/LFJWMUEUC4ILH2HEOCYVVLQT654ZMCGQ/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-LFJWMUEUC4ILH2HEOCYVVLQT654ZMCGQ.mbox.gz?message=LFJWMUEUC4ILH2HEOCYVVLQT654ZMCGQ "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/LFJWMUEUC4ILH2HEOCYVVLQT654ZMCGQ/#LFJWMUEUC4ILH2HEOCYVVLQT654ZMCGQ)

# [SECURITY] Fedora 30 Update: ytnef-1.9.3-1.fc30

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

17 May
2019

17 May
'19

6:02 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2019-7d7083b8be
2019-05-18 01:01:14.943059
--------------------------------------------------------------------------------

Name : ytnef
Product : Fedora 30
Version : 1.9.3
Release : 1.fc30
URL : <https://github.com/Yeraze/ytnef>
Summary : Yerase's TNEF Stream Reader
Description :
Yerase's TNEF Stream Reader. Can take a TNEF Stream (winmail.dat) sent from
Microsoft Outlook (or similar products) and extract the attachments, including
construction of Contact Cards & Calendar entries.

--------------------------------------------------------------------------------
Update Information:

ytnef 1.9.3 release, fixing a number of security issues: - CVE-2017-9470 -
CVE-2017-9471 - CVE-2017-9474 - CVE-2017-9058 - CVE-2017-12142 -
CVE-2017-12141 - CVE-2017-12144
--------------------------------------------------------------------------------
ChangeLog:

\* Thu May 9 2019 Kalev Lember klember@redhat.com - 1:1.9.3-1
- Update to 1.9.3 (#1683489)
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #1431730 - CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 CVE-2017-9058 CVE-2017-9146 ytnef: Multiple vulnerabilities fixed in 1.9.2 version
<https://bugzilla.redhat.com/show_bug.cgi?id=1431730>
[ 2 ] Bug #1422813 - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 ytnef: Multiple vulnerabilities fixed in 1.9.1 version
<https://bugzilla.redhat.com/show_bug.cgi?id=1422813>
[ 3 ] Bug #1459452 - CVE-2017-9470 CVE-2017-9471 CVE-2017-9472 CVE-2017-9473 CVE-2017-9474 ytnef: Multiple vulnerabilities in 1.9.2 version
<https://bugzilla.redhat.com/show_bug.cgi?id=1459452>
[ 4 ] Bug #1477558 - CVE-2017-12144 ytnef: allocation failure in TNEFFillMapi function
<https://bugzilla.redhat.com/show_bug.cgi?id=1477558>
[ 5 ] Bug #1477556 - CVE-2017-12142 ytnef: invalid memory read in SwapDWord function
<https://bugzilla.redhat.com/show_bug.cgi?id=1477556>
[ 6 ] Bug #1477549 - CVE-2017-12141 ytnef: heap-based buffer overflow in TNEFFillMapi function
<https://bugzilla.redhat.com/show_bug.cgi?id=1477549>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2019-7d7083b8be' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/LFJWMUEUC4ILH2HEOCYVVLQT654ZMCGQ/#LFJWMUEUC4ILH2HEOCYVVLQT654ZMCGQ)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from www.openwall.com_93603493_20250125_003141.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <05917198-0341-0542-858e-e475797c9636@x41-dsec.de>
Date: Wed, 15 Feb 2017 11:26:32 +0100
From: X41 D-Sec GmbH Advisories <advisories@...-dsec.de>
To: oss-security@...ts.openwall.com, fulldisclosure@...lists.org,
 bugtraq@...urityfocus.com, distros@...openwall.org
Subject: Advisory X41-2017-002: Multiple Vulnerabilities in ytnef

X41 D-Sec GmbH Security Advisory: X41-2017-002

Multiple Vulnerabilities in ytnef
=================================

Overview
--------
Severity Rating: High
Confirmed Affected Versions: 1.9 and earlier
Confirmed Patched Versions: 1.9.1
Vendor: Yerase
Vendor URL: <https://github.com/Yeraze/ytnef>
Vector: Via file
Credit: X41 D-Sec GmbH, Eric Sesterhenn
Status: public
CVE: not yet assigned
CVSS Score: 7.4
CVSS Vector: CVSS:3.0/AV:L/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N
Advisory-URL: <https://www.x41-dsec.de/lab/advisories/x41-2017-002-ytnef/>

Summary and Impact
------------------
Multiple Heap Overflows, out of bound writes and reads, NULL pointer
dereferences and infinite loops have been discovered in ytnef 1.9 an
earlier.
These could be exploited by tricking a user into opening a malicious
winmail.dat file.

Product Description
-------------------
ytnef offers a library and utilities to extract the files from winmail.dat
files. winmail.dat files are send by Microsoft Outlook when forwarding files
via e-mail. The vendor was very responsive in providing a patched version.

Analysis
--------
Due to the big amount of issues found no detailed analysis is given here.
Almost all allocations were unchecked and out of bounds checks rarely
performed in the code.

In total 9 patches were generated for the following issues:

1. Null Pointer Deref / calloc return value not checked
2. Infinite Loop / DoS
3. Buffer Overflow in version field
4. Out of Bound Reads
5. Integer Overflow
6. Invalid Write and Integer Overflow
7. Out of Bounds read
8. Out of Bounds read and write
9. Directory Traversal using the filename

To detail some of the findings, here are excerpts from the quickly written
patch, which was send to the vendor:

Missing out of bounds checks:

	diff --git a/lib/ytnef.c b/lib/ytnef.c
	index ad92f15..5dd07a7 100644
	--- a/lib/ytnef.c
	+++ b/lib/ytnef.c
	@@ -55,6 +55,7 @@
	 #define MIN(x,y) (((x)<(y))?(x):(y))

 	#define ALLOCCHECK(x) { if(!x) { printf("Out of Memory\n"); exit(-1); } }

	+#define SIZECHECK(x) { if ((((char *)d - (char *)data) + x) >= size) {
 printf("Corrupted file\n"); exit(-1); } }

	 void TNEFFillMapi(TNEFStruct *TNEF, BYTE *data, DWORD size, MAPIProps *p);
 	void SetFlip(void);
	@@ -427,9 +428,11 @@ void TNEFFillMapi(TNEFStruct *TNEF, BYTE *data,
DWORD size, MAPIProps *p) {
	       length = -1;
	       if (PROP_ID(mp->id) >= 0x8000) {
	         // Read the GUID
	+        SIZECHECK(16);
	         memcpy(&(mp->guid[0]), d, 16);
	         d += 16;

	+        SIZECHECK(4);
	         length = SwapDWord((BYTE*)d, 4);

Infinite Loop:

	diff --git a/lib/ytnef.c b/lib/ytnef.c
	index 328e605..43b0e56 100644
	--- a/lib/ytnef.c
	+++ b/lib/ytnef.c
	@@ -546,6 +546,9 @@ void TNEFFillMapi(TNEFStruct *TNEF, BYTE *data,
DWORD size, MAPIProps *p) {
	         memcpy(vl->data, d, vl->size);
	         d+=16;
	         break;
	+      default:
	+        printf("Bad file\n");
	+        exit(-1);
	     }

	     switch (PROP_ID(mp->id)) {

Buffer Overflow:

	diff --git a/lib/tnef-types.h b/lib/tnef-types.h
	index 7b6ad01..2a9709a 100644
	--- a/lib/tnef-types.h
	+++ b/lib/tnef-types.h
	@@ -103,7 +103,7 @@ typedef struct {
 	} TNEFMemInfo;

	 typedef struct {
	-  char version[10];
	+  char version[16];
	   variableLength from;
	   variableLength subject;
	   dtr dateSent;

Workarounds
-----------

Update to version 1.9.1 as released on <https://github.com/yeraze/ytnef>

About X41 D-Sec GmbH
--------------------
X41 D-Sec is a provider of application security services. We focus
on application code reviews, design review and security testing. X41 D-Sec
GmbH was founded in 2015 by Markus Vervier.
We support customers in various industries such as finance, software
development and public institutions.

Timeline
--------
2017-02-10	Issues found
2016-02-12	Vendor contacted
2016-02-12	Vendor replied
2016-02-12	CVE ID requested
2016-02-13	Pull request for patch send as per vendor request
2016-02-13	Issue 9 / Directory Traversal reported
2016-02-14	Issues fixed, 1.9.1 released
2016-02-15	Advisory release

--
X41 D-SEC GmbH, Dennewartstr. 25-27, D-52068 Aachen
T: +49 241 9809418-0, Fax: -9
Unternehmenssitz: Aachen, Amtsgericht Aachen: HRB19989
Geschäftsführer: Markus Vervier

Download attachment "[signature.asc](4/1)" of type "application/pgp-signature" (834 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_7c52e3e6_20250125_003144.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FYeraze%2Fytnef%2Fpull%2F27)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FYeraze%2Fytnef%2Fpull%2F27)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=Yeraze%2Fytnef)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Yeraze](/Yeraze)
/
**[ytnef](/Yeraze/ytnef)**
Public

* [Notifications](/login?return_to=%2FYeraze%2Fytnef) You must be signed in to change notification settings
* [Fork
  22](/login?return_to=%2FYeraze%2Fytnef)
* [Star
   32](/login?return_to=%2FYeraze%2Fytnef)

* [Code](/Yeraze/ytnef)
* [Issues
  7](/Yeraze/ytnef/issues)
* [Pull requests
  0](/Yeraze/ytnef/pulls)
* [Discussions](/Yeraze/ytnef/discussions)
* [Actions](/Yeraze/ytnef/actions)
* [Projects
  0](/Yeraze/ytnef/projects)
* [Wiki](/Yeraze/ytnef/wiki)
* [Security](/Yeraze/ytnef/security)
* [Insights](/Yeraze/ytnef/pulse)

Additional navigation options

* [Code](/Yeraze/ytnef)
* [Issues](/Yeraze/ytnef/issues)
* [Pull requests](/Yeraze/ytnef/pulls)
* [Discussions](/Yeraze/ytnef/discussions)
* [Actions](/Yeraze/ytnef/actions)
* [Projects](/Yeraze/ytnef/projects)
* [Wiki](/Yeraze/ytnef/wiki)
* [Security](/Yeraze/ytnef/security)
* [Insights](/Yeraze/ytnef/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FYeraze%2Fytnef%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FYeraze%2Fytnef%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Security/eric sesterhenn x41 #27

 Merged

[Yeraze](/Yeraze)
merged 13 commits into
[master](/Yeraze/ytnef/tree/master "Yeraze/ytnef:master")
from
[security/EricSesterhennX41](/Yeraze/ytnef/tree/security/EricSesterhennX41 "Yeraze/ytnef:security/EricSesterhennX41")

Feb 14, 2017

 Merged

# [Security/eric sesterhenn x41](#top) #27

[Yeraze](/Yeraze)
merged 13 commits into
[master](/Yeraze/ytnef/tree/master "Yeraze/ytnef:master")
from
[security/EricSesterhennX41](/Yeraze/ytnef/tree/security/EricSesterhennX41 "Yeraze/ytnef:security/EricSesterhennX41")

Feb 14, 2017

[Conversation
0](/Yeraze/ytnef/pull/27)
[Commits
13](/Yeraze/ytnef/pull/27/commits)
[Checks
0](/Yeraze/ytnef/pull/27/checks)
[Files changed](/Yeraze/ytnef/pull/27/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![Yeraze](https://avatars.githubusercontent.com/u/5789309?s=60&v=4)](/Yeraze)

Copy link

Owner

### @Yeraze **[Yeraze](/Yeraze)** commented [Feb 14, 2017](#issue-207486643) • edited Loading

(Extension of [#26](https://github.com/Yeraze/ytnef/pull/26) from [@EricSesterhennX41](https://github.com/EricSesterhennX41))

These are a bunch of security fixed. They could be handled more gracefully, but I guess this is a first good start.

Sorry, something went wrong.

All reactions

 [EricSesterhennX41](/EricSesterhennX41)
and others
added 13 commits
[February 13, 2017 08:40](#commits-pushed-f816ba5)

[![@EricSesterhennX41](https://avatars.githubusercontent.com/u/25737023?s=40&v=4)](/EricSesterhennX41)

`[Do a quickfix to check for bad allocations](/Yeraze/ytnef/pull/27/commits/f816ba5df468294f569c5f72e51c9167c59ec251 "Do a quickfix to check for bad allocations")`

`[f816ba5](/Yeraze/ytnef/pull/27/commits/f816ba5df468294f569c5f72e51c9167c59ec251)`

[![@EricSesterhennX41](https://avatars.githubusercontent.com/u/25737023?s=40&v=4)](/EricSesterhennX41)

`[avoid infinite loop for malicious input files](/Yeraze/ytnef/pull/27/commits/4f4598d39da2c5222ad92e2d79273fdc5d183a10 "avoid infinite loop for malicious input files")`

`[4f4598d](/Yeraze/ytnef/pull/27/commits/4f4598d39da2c5222ad92e2d79273fdc5d183a10)`

[![@EricSesterhennX41](https://avatars.githubusercontent.com/u/25737023?s=40&v=4)](/EricSesterhennX41)

`[increase version field, otherwise TNEFVersion might generate a buffer…](/Yeraze/ytnef/pull/27/commits/cc6a49e03f5a7c7ffcb2f48477621203856bcd32 "increase version field, otherwise TNEFVersion might generate a buffer overflow and use snprintf to avoid this in the future")`
 …

`[cc6a49e](/Yeraze/ytnef/pull/27/commits/cc6a49e03f5a7c7ffcb2f48477621203856bcd32)`

```
… overflow and use snprintf to avoid this in the future
```

[![@EricSesterhennX41](https://avatars.githubusercontent.com/u/25737023?s=40&v=4)](/EricSesterhennX41)

`[prevent out of bound reads](/Yeraze/ytnef/pull/27/commits/dac032076edba38beec9b6773293efab9f99f796 "prevent out of bound reads")`

`[dac0320](/Yeraze/ytnef/pull/27/commits/dac032076edba38beec9b6773293efab9f99f796)`

[![@EricSesterhennX41](https://avatars.githubusercontent.com/u/25737023?s=40&v=4)](/EricSesterhennX41)

`[prevent 32 bit system int overflow](/Yeraze/ytnef/pull/27/commits/e2d39bdb06133168d2f52de5ef763f081bc48aa4 "prevent 32 bit system int overflow")`

`[e2d39bd](/Yeraze/ytnef/pull/27/commits/e2d39bdb06133168d2f52de5ef763f081bc48aa4)`

[![@EricSesterhennX41](https://avatars.githubusercontent.com/u/25737023?s=40&v=4)](/EricSesterhennX41)

`[fix another invalid write and huge allocation](/Yeraze/ytnef/pull/27/commits/12326ac894c34bb5fd3ec365c29b87328cd72d49 "fix another invalid write and huge allocation")`

`[12326ac](/Yeraze/ytnef/pull/27/commits/12326ac894c34bb5fd3ec365c29b87328cd72d49)`

[![@EricSesterhennX41](https://avatars.githubusercontent.com/u/25737023?s=40&v=4)](/EricSesterhennX41)

`[fix another invalid read](/Yeraze/ytnef/pull/27/commits/e9c819010c8edebd3a4d58af1472398b8413e0a2 "fix another invalid read")`

`[e9c8190](/Yeraze/ytnef/pull/27/commits/e9c819010c8edebd3a4d58af1472398b8413e0a2)`

[![@EricSesterhennX41](https://avatars.githubusercontent.com/u/25737023?s=40&v=4)](/EricSesterhennX41)

`[Fix another out of bounds read and write](/Yeraze/ytnef/pull/27/commits/036e5cde6a5301c4420df0ca1bf3213a654288ad "Fix another out of bounds read and write")`

`[036e5cd](/Yeraze/ytnef/pull/27/commits/036e5cde6a5301c4420df0ca1bf3213a654288ad)`

[![@Yeraze](https://avatars.githubusercontent.com/u/5789309?s=40&v=4)](/Yeraze)

`[Comparison change in SIZECHECK macro](/Yeraze/ytnef/pull/27/commits/eb6d969b6096b5f4f32ba4a4cfc7079a6905a446 "Comparison change in SIZECHECK macro")`

`[eb6d969](/Yeraze/ytnef/pull/27/commits/eb6d969b6096b5f4f32ba4a4cfc7079a6905a446)`

[![@Yeraze](https://avatars.githubusercontent.com/u/5789309?s=40&v=4)](/Yeraze)

`[Cleanup error output](/Yeraze/ytnef/pull/27/commits/34f13ea755a6cf6e1675f6eef6a378ad102e09cc "Cleanup error output")`

`[34f13ea](/Yeraze/ytnef/pull/27/commits/34f13ea755a6cf6e1675f6eef6a378ad102e09cc)`

[![@Yeraze](https://avatars.githubusercontent.com/u/5789309?s=40&v=4)](/Yeraze)

`[Add '\' as another prohibited file path character](/Yeraze/ytnef/pull/27/commits/36c1305df13e558967a797f89c277a2e47064a60 "Add '\' as another prohibited file path character")`

`[36c1305](/Yeraze/ytnef/pull/27/commits/36c1305df13e558967a797f89c277a2e47064a60)`

[![@Yeraze](https://avatars.githubusercontent.com/u/5789309?s=40&v=4)](/Yeraze)

`[Remove lots of system exits, replace them with error codes](/Yeraze/ytnef/pull/27/commits/b6d2914637151e3b51807b04dca38c42d9783668 "Remove lots of system exits, replace them with error codes

Should be a lot more library-friendly now, not insta-aborting at
the first sign of trouble.")`
 …

`[b6d2914](/Yeraze/ytnef/pull/27/commits/b6d2914637151e3b51807b04dca38c42d9783668)`

```
Should be a lot more library-friendly now, not insta-aborting at
the first sign of trouble.
```

[![@Yeraze](https://avatars.githubusercontent.com/u/5789309?s=40&v=4)](/Yeraze)

`[Add '/' as a prohibited path character as well.](/Yeraze/ytnef/pull/27/commits/330691750a1119fb3e75658876ccbf52d4db42e1 "Add '/' as a prohibited path character as well.

I'll never learn: Don't commit before coffee.")`
 …

`[3306917](/Yeraze/ytnef/pull/27/commits/330691750a1119fb3e75658876ccbf52d4db42e1)`

```
I'll never learn: Don't commit before coffee.
```

[![@Yeraze](https://avatars.githubusercontent.com/u/5789309?s=40&v=4)](/Yeraze)
[Yeraze](/Yeraze)
merged commit [`b36d6b2`](/Yeraze/ytnef/commit/b36d6b25b7a546fc28d6c3812124e487987a4910)
into
master

[Feb 14, 2017](https://github.com/Yeraze/ytnef/pull/27#event-961423108)

[![@jmallach](https://avatars.githubusercontent.com/u/929712?s=40&v=4)](/jmallach)
[jmallach](/jmallach)
mentioned this pull request
[Feb 21, 2017](#ref-issue-209105781)

[ChangeLog update for 1.9.1
#30](/Yeraze/ytnef/issues/30)

Closed

 [![@Yeraze](https://avatars.githubusercontent.com/u/5789309?s=40&v=4)](/Yeraze)
[Yeraze](/Yeraze)
deleted the
security/EricSesterhennX41

branch
[August 1, 2018 13:31](#event-1765227484)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FYeraze%2Fytnef%2Fpull%2F27)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@Yeraze](https://avatars.githubusercontent.com/u/5789309?s=52&v=4)](/Yeraze) [![@EricSesterhennX41](https://avatars.githubusercontent.com/u/25737023?s=52&v=4)](/EricSesterhennX41)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.redhat.com_4502f658_20250126_044805.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1422813)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1422813)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1422813)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1422813

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1422813**](show_bug.cgi?id=1422813)
(CVE-2017-6298, CVE-2017-6299, CVE-2017-6300, CVE-2017-6301, CVE-2017-6302, CVE-2017-6303, CVE-2017-6304, CVE-2017-6305, CVE-2017-6306)
- [CVE-2017-6298](https://access.redhat.com/security/cve/CVE-2017-6298) [CVE-2017-6299](https://access.redhat.com/security/cve/CVE-2017-6299) [CVE-2017-6300](https://access.redhat.com/security/cve/CVE-2017-6300) [CVE-2017-6301](https://access.redhat.com/security/cve/CVE-2017-6301) [CVE-2017-6302](https://access.redhat.com/security/cve/CVE-2017-6302) [CVE-2017-6303](https://access.redhat.com/security/cve/CVE-2017-6303) [CVE-2017-6304](https://access.redhat.com/security/cve/CVE-2017-6304) [CVE-2017-6305](https://access.redhat.com/security/cve/CVE-2017-6305) [CVE-2017-6306](https://access.redhat.com/security/cve/CVE-2017-6306) ytnef: Multiple vulnerabilities fixed in 1.9.1 version

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-201...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED UPSTREAM | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2017-6298, CVE-2017-6299, CVE-2017-6300, CVE-2017-6301, CVE-2017-6302, CVE-2017-6303, CVE-2017-6304, CVE-2017-6305, CVE-2017-6306 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1422814](show_bug.cgi?id=1422814 "CLOSED EOL - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 libytnef: various flaws [epel-all]") [1422815](show_bug.cgi?id=1422815 "CLOSED ERRATA - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 ytnef: various flaws [fedora-all]") [1422816](show_bug.cgi?id=1422816 "CLOSED CURRENTRELEASE - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 ytnef: various flaws [epel-all]") [1422817](show_bug.cgi?id=1422817 "CLOSED EOL - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 libytnef: various flaws [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1422813&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1422813&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2017-02-16 10:32 UTC by Andrej Nemec | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 14:07 UTC ([History](show_activity.cgi?id=1422813)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  andreas.bierfert itamar ppisar sheltren | | Fixed In Version: | ytnef 1.9.1 | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-08 03:07:44 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1422813#c0)  Andrej Nemec    2017-02-16 10:32:52 UTC  ```  Ytnef upstream released a security advisory for their latest release.  <http://openwall.com/lists/oss-security/2017/02/15/4>  It fixes multiple security vulnerabilities.   ```  [Comment 1](show_bug.cgi?id=1422813#c1)  Andrej Nemec    2017-02-16 10:35:17 UTC  ``` Created libytnef tracking bugs for this issue:  Affects: epel-all [[bug 1422814](show_bug.cgi?id=1422814 "CLOSED EOL - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 libytnef: various flaws [epel-all]")] Affects: fedora-all [[bug 1422817](show_bug.cgi?id=1422817 "CLOSED EOL - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 libytnef: various flaws [fedora-all]")]   Created ytnef tracking bugs for this issue:  Affects: epel-all [[bug 1422816](show_bug.cgi?id=1422816 "CLOSED CURRENTRELEASE - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 ytnef: various flaws [epel-all]")] Affects: fedora-all [[bug 1422815](show_bug.cgi?id=1422815 "CLOSED ERRATA - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 ytnef: various flaws [fedora-all]")]   ```  [Comment 2](show_bug.cgi?id=1422813#c2)  Andrej Nemec    2017-02-28 08:52:28 UTC  ``` Mitre assigned CVEs for these patches:  Null Pointer Deref / calloc return value not checked - [CVE-2017-6298](https://access.redhat.com/security/cve/CVE-2017-6298) Infinite Loop / DoS - [CVE-2017-6299](https://access.redhat.com/security/cve/CVE-2017-6299) Buffer Overflow in version field - [CVE-2017-6300](https://access.redhat.com/security/cve/CVE-2017-6300) Out of Bound Reads - [CVE-2017-6301](https://access.redhat.com/security/cve/CVE-2017-6301) Integer Overflow - [CVE-2017-6302](https://access.redhat.com/security/cve/CVE-2017-6302) Invalid Write and Integer Overflow [CVE-2017-6303](https://access.redhat.com/security/cve/CVE-2017-6303) Out of Bounds read - [CVE-2017-6304](https://access.redhat.com/security/cve/CVE-2017-6304) Out of Bounds read and write - [CVE-2017-6305](https://access.redhat.com/security/cve/CVE-2017-6305) Directory Traversal using the filename - [CVE-2017-6306](https://access.redhat.com/security/cve/CVE-2017-6306)   ```  [Comment 3](show_bug.cgi?id=1422813#c3)  Product Security DevOps Team    2019-06-08 03:07:44 UTC  ``` This CVE Bugzilla entry is for community support informational purposes only as it does not affect a package in a commercially supported Red Hat product. Refer to the dependent bugs for status of those individual community products.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1422813&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_ca34351e_20250126_044804.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1431730)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1431730)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1431730)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1431730

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1431730**](show_bug.cgi?id=1431730)
(CVE-2017-6800, CVE-2017-6801, CVE-2017-6802, CVE-2017-9058, CVE-2017-9146)
- [CVE-2017-6800](https://access.redhat.com/security/cve/CVE-2017-6800) [CVE-2017-6801](https://access.redhat.com/security/cve/CVE-2017-6801) [CVE-2017-6802](https://access.redhat.com/security/cve/CVE-2017-6802) [CVE-2017-9058](https://access.redhat.com/security/cve/CVE-2017-9058) [CVE-2017-9146](https://access.redhat.com/security/cve/CVE-2017-9146) ytnef: Multiple vulnerabilities fixed in 1.9.2 version

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 CVE-2017-9058 CVE-2017-9146 ytnef: ...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED UPSTREAM | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2017-6800, CVE-2017-6801, CVE-2017-6802, CVE-2017-9058, CVE-2017-9146 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1422814](show_bug.cgi?id=1422814 "CLOSED EOL - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 libytnef: various flaws [epel-all]") [1422815](show_bug.cgi?id=1422815 "CLOSED ERRATA - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 ytnef: various flaws [fedora-all]") [1422816](show_bug.cgi?id=1422816 "CLOSED CURRENTRELEASE - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 ytnef: various flaws [epel-all]") [1422817](show_bug.cgi?id=1422817 "CLOSED EOL - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 libytnef: various flaws [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1431730&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1431730&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2017-03-13 16:27 UTC by Andrej Nemec | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2020-04-02 02:29 UTC ([History](show_activity.cgi?id=1431730)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  andreas.bierfert itamar ppisar sheltren | | Fixed In Version: | ytnef 1.9.2 | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-08 03:08:58 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**spec patch**](attachment.cgi?id=1264378 "View the content of the attachment") (4.80 KB, patch)  [2017-03-18 13:47 UTC](#attach_1264378 "Go to the comment associated with the attachment"), Andreas Bierfert | *no flags* | [Details](attachment.cgi?id=1264378&action=edit) | [Diff](attachment.cgi?id=1264378&action=diff) | | [View All](attachment.cgi?bugid=1431730&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1431730#c0)  Andrej Nemec    2017-03-13 16:27:05 UTC  ```  [CVE-2017-6802](https://access.redhat.com/security/cve/CVE-2017-6802) - An issue was discovered in ytnef before 1.9.2. There is a potential heap-based buffer over-read on incoming Compressed RTF Streams, related to DecompressRTF() in libytnef.  Upstream bug:  <https://github.com/Yeraze/ytnef/issues/34>  [CVE-2017-6801](https://access.redhat.com/security/cve/CVE-2017-6801) - An issue was discovered in ytnef before 1.9.2. There is a potential out-of-bounds access with fields of Size 0 in TNEFParse() in libytnef.  Upstream patch:  <https://github.com/Yeraze/ytnef/commit/3cb0f914d6427073f262e1b2b5fd973e3043cdf7>  [CVE-2017-6800](https://access.redhat.com/security/cve/CVE-2017-6800) - An issue was discovered in ytnef before 1.9.2. An invalid memory access (heap-based buffer over-read) can occur during handling of LONG data types, related to MAPIPrint() in libytnef.  Upstream bug:  <https://github.com/Yeraze/ytnef/issues/28>   ```  [Comment 1](show_bug.cgi?id=1431730#c1)  Andrej Nemec    2017-03-13 16:28:33 UTC  ```  Created libytnef tracking bugs for this issue:  Affects: fedora-all [[bug 1422817](show_bug.cgi?id=1422817 "CLOSED EOL - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 libytnef: various flaws [fedora-all]")] Affects: epel-all [[bug 1422814](show_bug.cgi?id=1422814 "CLOSED EOL - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 libytnef: various flaws [epel-all]")]   ```  [Comment 2](show_bug.cgi?id=1431730#c2)  Andrej Nemec    2017-03-13 16:28:39 UTC  ```  Created ytnef tracking bugs for this issue:  Affects: fedora-all [[bug 1422815](show_bug.cgi?id=1422815 "CLOSED ERRATA - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 ytnef: various flaws [fedora-all]")] Affects: epel-all [[bug 1422816](show_bug.cgi?id=1422816 "CLOSED CURRENTRELEASE - CVE-2017-6298 CVE-2017-6299 CVE-2017-6300 CVE-2017-6301 CVE-2017-6302 CVE-2017-6303 CVE-2017-6304 CVE-2017-6305 CVE-2017-6306 CVE-2017-6800 CVE-2017-6801 CVE-2017-6802 ytnef: various flaws [epel-all]")]   ```  [Comment 3](show_bug.cgi?id=1431730#c3)  Andreas Bierfert    2017-03-18 13:44:56 UTC  ``` The correct fix will be to merge ytnef and libytnef into one package (as done upstream with version 1.9. I have prepared a scratch build here. Itamar if you don't mind I will push this to rawhide and deprecate the separate libytnef there and then go to the releases once this got a bit more testing.  <https://koji.fedoraproject.org/koji/taskinfo?taskID=18454905>   ```  [Comment 4](show_bug.cgi?id=1431730#c4)  Andreas Bierfert    2017-03-18 13:47:13 UTC  ``` Created [attachment 1264378](attachment.cgi?id=1264378&action=diff "spec patch") [[details]](attachment.cgi?id=1264378&action=edit "spec patch") spec patch   ```  [Comment 5](show_bug.cgi?id=1431730#c5)  Andrej Nemec    2017-05-18 13:33:47 UTC  ``` Another CVE was reported in libytnef.  [CVE-2017-9058](https://access.redhat.com/security/cve/CVE-2017-9058) - In libytnef in ytnef through 1.9.2, there is a heap-based buffer over-read due to incorrect boundary checking in the SIZECHECK macro in lib/ytnef.c.   <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=862556>   ```  [Comment 6](show_bug.cgi?id=1431730#c6)  Andrej Nemec    2017-05-23 07:42:45 UTC  ``` Another CVE was reported in libytnef.  [CVE-2017-9146](https://access.redhat.com/security/cve/CVE-2017-9146) - The TNEFFillMapi function in lib/ytnef.c in libytnef in ytnef through 1.9.2 does not ensure a nonzero count value before a certain memory allocation, which allows remote attackers to cause a denial of service (heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted tnef file.   <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=862707>   ```  [Comment 7](show_bug.cgi?id=1431730#c7)  Product Security DevOps Team    2019-06-08 03:08:58 UTC  ``` This CVE Bugzilla entry is for community support informational purposes only as it does not affect a package in a commercially supported Red Hat product. Refer to the dependent bugs for status of those individual community products.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1431730&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


