```
{
  "CVE-2017-6903": {
    "description": "In ioquake3 before 2017-03-14, the auto-downloading feature has insufficient content restrictions. This also affects Quake III Arena, OpenArena, OpenJK, iortcw, and other id Tech 3 (aka Quake 3 engine) forks. A malicious auto-downloaded file can trigger loading of crafted auto-downloaded files as native code DLLs. A malicious auto-downloaded file can contain configuration defaults that override the user's. Executable bytecode in a malicious auto-downloaded file can set configuration variables to values that will result in unwanted native code DLLs being loaded, resulting in sandbox escape.",
    "fixes": [
      {
        "commit": "376267d534476a875d8b9228149c4ee18b74a4fd",
        "description": "Don't load .pk3s as .dlls, and don't load user config files from .pk3s.",
        "files_changed": [
          {
            "file_path": "code/client/cl_main.c",
            "changes": "Modified to add CVAR_PROTECTED flag to cl_renderer and cl_cURLLib. This prevents game code from changing these variables.\n"
          },
          {
            "file_path": "code/qcommon/files.c",
             "changes":"Modified to prevent loading of autoexec.cfg and q3config.cfg from within pk3 files."
          },
          {
             "file_path":"code/sys/sys_main.c",
             "changes":"Modified to prevent loading of dlls with .pk3 extension."
          }
        ]
      },
      {
        "commit":"b248763e4878ef12d5835ece6600be8334f67da1",
        "description":"All: Don't open .pk3 files as OpenAL drivers",
         "files_changed":[
            {
              "file_path":"MP/code/client/snd_openal.c",
              "changes": "Modified to prevent loading of .pk3 files as OpenAL drivers."
           },
           {
              "file_path":"SP/code/client/snd_openal.c",
              "changes":"Modified to prevent loading of .pk3 files as OpenAL drivers."
           }
        ]
     },
     {
      "commit":"11a83410153756ae350a82ed41b08d128ff7f998",
      "description":"All: Merge some file writing extension checks",
       "files_changed":[
          {
           "file_path":"MP/code/client/cl_console.c",
           "changes":"Modified to check if file extension is .txt before writing to it."
          },
         {
           "file_path":"MP/code/qcommon/common.c",
           "changes":"Modified to check if file extension is .cfg before writing to it."
         },
         {
           "file_path":"SP/code/client/cl_console.c",
           "changes":"Modified to check if file extension is .txt before writing to it."
        },
        {
            "file_path":"SP/code/qcommon/common.c",
             "changes":"Modified to check if file extension is .cfg before writing to it."
        }
       ]
     },
     {
        "commit":"8956a35e7b91c4a0dd1fa6db1d28c7f0efbab2d7",
        "description":"Shared: Merge [ioquake/ioq3@376267d](https://github.com/ioquake/ioq3/commit/376267d534476a875d8b9228149c4ee18b74a4fd)",
        "files_changed":[
          {
             "file_path":"code/client/cl_main.cpp",
             "changes":"Modified to add CVAR_PROTECTED flag to cl_renderer."
          },
          {
              "file_path":"code/qcommon/files.cpp",
              "changes":"Modified to prevent loading of autoexec_sp.cfg and openjk_sp.cfg from within pk3 files."
           },
           {
             "file_path":"codemp/client/cl_main.cpp",
             "changes":"Modified to add CVAR_PROTECTED flag to cl_renderer"
          },
          {
            "file_path":"codemp/qcommon/files.cpp",
            "changes":"Modified to prevent loading of autoexec.cfg and openjk.cfg from within pk3 files."
          },
          {
            "file_path":"shared/sys/sys_main.cpp",
             "changes":"Modified to prevent loading of dlls with .pk3 extension."
          }
        ]
      },
      {
         "commit":"b173ac05993f634a42be3d3535e1b158de0c3372",
         "description":"Merge some file writing extension checks from OpenJK.",
         "files_changed":[
           {
             "file_path":"code/client/cl_console.c",
             "changes":"Modified to check if file extension is .txt before writing to it."
            },
            {
             "file_path":"code/qcommon/common.c",
             "changes":"Modified to check if file extension is .cfg before writing to it."
           }
        ]
      },
      {
        "commit":"f61fe5f6a0419ef4a88d46a128052f2e8352e85d",
        "description":"Don't open .pk3 files as OpenAL drivers.",
        "files_changed":[
           {
              "file_path":"code/client/snd_openal.c",
              "changes":"Modified to prevent loading of .pk3 files as OpenAL drivers."
           }
        ]
      }
    ],
    "vulnerability_details": {
      "root_cause": "Insufficient content restrictions on auto-downloaded files.",
      "weaknesses": [
        "Improper Restriction of Rendered UI Layers or Frames",
        "Code Injection",
        "Configuration Injection"
      ],
      "impact": "A malicious server can execute arbitrary code on clients or modify their configuration, leading to privilege escalation and sandbox escape.",
      "attack_vectors": "Connecting to a malicious game server or being subject to a man-in-the-middle attack while connecting to a non-malicious server.",
      "attacker_capabilities": "An attacker needs to be able to host a game server or perform a man-in-the-middle attack."
    }
  }
}
```