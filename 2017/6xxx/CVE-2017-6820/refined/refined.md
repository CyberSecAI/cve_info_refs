Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2017-6820:

**Root Cause of Vulnerability:**
The vulnerability stems from improper handling of CSS style tags embedded within SVG elements. Specifically, the `rcube_utils.php` file in Roundcube did not adequately sanitize or neutralize these style tags, leading to the possibility of injecting malicious CSS.

**Weaknesses/Vulnerabilities Present:**
- **Cross-Site Scripting (XSS):** The primary weakness is a stored XSS vulnerability. An attacker could inject malicious CSS code within an SVG element, which would then be executed when a user views an email containing that crafted SVG element.
- **Insufficient Input Sanitization:** The `xss_entity_decode` function in `rcube_utils.php` was not properly stripping or escaping potentially malicious CSS within SVG tags.

**Impact of Exploitation:**
- **Arbitrary Code Execution:** By injecting malicious CSS, an attacker could potentially execute arbitrary code within the context of the user's browser session. This could lead to various malicious activities, including:
    - Data theft (e.g., session hijacking, stealing cookies).
    - Defacement of the webmail interface.
    - Redirection to malicious websites.
    - Other client-side attacks.
- **Compromise of User Accounts:** Successful exploitation could allow attackers to compromise user accounts by stealing credentials or session cookies.

**Attack Vectors:**
- **Email Injection:** The primary attack vector involves sending a specially crafted email that contains a malicious SVG element with an embedded style tag.
- **User Interaction:** The user needs to open/preview the malicious email for the attack to be triggered.

**Required Attacker Capabilities/Position:**
- **Email Sending Capabilities:** The attacker must be able to send emails to a target user of the vulnerable Roundcube instance.
- **No Account Privileges Required:** The attacker does not need any special account privileges on the Roundcube server.
- **Knowledge of CSS:** The attacker needs knowledge of how to craft malicious CSS to achieve the desired exploit.

**Additional Details:**

- The vulnerability was fixed in Roundcube versions 1.1.8 and 1.2.4.
- The fix involved modifying the `xss_entity_decode` function in `rcube_utils.php` to properly sanitize or remove potentially harmful style tags within SVG elements.
- The vulnerability was addressed in commit `fa2824fdcd44af3f970b2797feb47652482c8305` and `cbd35626f7db7855f3b5e2db00d28ecc1554e9f4` .

The provided content contains more details than the original CVE description by showing the vulnerable code and the fix that was applied.