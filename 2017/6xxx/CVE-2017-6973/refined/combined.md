=== Content from mantisbt.org_7b46b536_20250126_095257.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview_user_page.php%3Fid%3D17784)
[Signup for a new account](/bugs/signup_page.php)

#### User Information

| Username | dregad |
| --- | --- |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1607 seconds



=== Content from openwall.com_bf1e1e15_20250125_152719.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](../../../2017/03/31/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <obk3lm$s92$1@blaine.gmane.org>
Date: Fri, 31 Mar 2017 01:17:16 +0200
From: Damien Regad <dregad@...tisbt.org>
To: oss-security@...ts.openwall.com
Subject: Advisory: XSS issues in MantisBT (CVE-2017-6973, CVE-2017-7241,
 CVE-2017-7309)

Please take note of the following 3 cross-site scripting issues in MantisBT

Best regards
Damien Regad
MantisBT developer

1. CVE-2017-6973: XSS in adm_config_report.php

A cross-site scripting (XSS) vulnerability in the MantisBT
Configuration Report page (adm_config_report.php) allows remote
attackers to inject arbitrary code through a crafted 'action'
parameter.

Affected versions: 1.3.0-rc.2 through 2.2.1
Fixed in versions: 1.3.8, 2.1.2, 2.2.2 (released 2017-03-22), 2.3.0 (not
yet released*)

Patch:
- 1.3:
<http://github.com/mantisbt/mantisbt/commit/034cd07b47af37366fc7b726cb4a4f971d3d3fb9>
- 2.x:
<http://github.com/mantisbt/mantisbt/commit/da74c5aa02bcf21cfaab1180f892c22415e5fea6>

Credits:
- Reported by Yelin and Zhangdongsheng from VenusTech
<http://www.venustech.com.cn/>
- Fixed by Damien Regad (MantisBT Developer)

References:
- MantisBT issue tracker <https://mantisbt.org/bugs/view.php?id=22537>

2. CVE-2017-7309: XSS in adm_config_report.php

A cross-site scripting (XSS) vulnerability in the MantisBT
Configuration Report page (adm_config_report.php) allows remote
attackers to inject arbitrary code (if CSP settings permit it) through
a crafted 'config_option' parameter.

This is related to CVE-2017-6973 (see above) introduced by the same
change, affects same component, and same root cause of not escaping
parameter before output.

Affected versions: 1.3.0-rc.2 through 2.2.2
Fixed in versions: 1.3.9, 2.1.3, 2.2.3, 2.3.0 (not yet released*)

Patch:
- 1.3:
<http://github.com/mantisbt/mantisbt/commit/c9e5b1d0404503022605459552faeaf610bf15ae>
- 2.x:
<http://github.com/mantisbt/mantisbt/commit/e881dd79df422033bbea88914fc0a717fae40358>

Credits:
- Reported by Yelin and Zhangdongsheng from VenusTech
<http://www.venustech.com.cn/>
- Fixed by Damien Regad (MantisBT Developer)

References:
- MantisBT issue tracker <http://www.mantisbt.org/bugs/view.php?id=22579>

3. CVE-2017-7241: XSS in move_attachments_page.php

A cross-site scripting (XSS) vulnerability in the MantisBT Move
Attachements page (move_attachments_page.php, part of admin tools)
allows remote attackers to inject arbitrary code through a crafted
'type' parameter, if Content Security Protection (CSP) settings allows
it.

Note that this vulnerability is not exploitable if the admin tools
directory is removed, as recommended in the Admin Guide [1]. A
reminder to do so is also displayed on the login page.

Affected versions: 1.2.16 and later
Fixed in versions: 1.3.9, 2.1.3, 2.2.3, 2.3.0 (not yet released*)
Note that 1.2 branch is no longer supported, so no patch is provided for
that; please upgrade to a later version.

Patch:
- 1.3:
<http://github.com/mantisbt/mantisbt/commit/d31841c806a3c8379fcf6c9d9559451270b0f1cb>
- 2.x:
<http://github.com/mantisbt/mantisbt/commit/ecef0e9b523a460709e8feedfce72f05bb30b992>

Credits:
- Reported by Yelin and Zhangdongsheng from VenusTech
<http://www.venustech.com.cn/>
- Fixed by Damien Regad (MantisBT Developer)

References:
- MantisBT issue tracker <http://www.mantisbt.org/bugs/view.php?id=22568>
- [1]
<http://mantisbt.org/docs/master/en-US/Admin_Guide/html-desktop/#admin.install.postcommon>

* Releases 1.3.9, 2.1.3, 2.2.3 and 2.3.0 are scheduled for release on
coming week-end

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.mantisbt.org_c4497aaf_20250125_152723.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D22537)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=22537)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0022537 | mantisbt | security | public | 2017-03-17 04:50 | 2017-03-31 04:01 |
|  | | | | | |
|
| Reporter | [YelinAndZhangdongsheng](https://mantisbt.org/bugs/view_user_page.php?id=42345) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | normal | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Product Version | 1.3.0-rc.2 |  | | | |
| Target Version | 1.3.8 | Fixed in Version | 1.3.8 |  | |
|  | | | | | |
|
| Summary | 0022537: CVE-2017-6973: XSS in adm\_config\_report.php | | | | |
| Description | Cross-Site Scripting Vulnerability in 'adm\_config\_report.php' page.  The /adm\_config\_report.php page 'action' parameter in MantisBT is vulnerable to a cross-site scripting vulnerability when Javascript is supplied via GET or POST request.  The exploitation example below uses the "alert()" JavaScript function to display "XSS" word. | | | | |
| Steps To Reproduce | Steps: Install the latest Mantisbt with all default settings. Log in as administrator/root Navigate to the URL: <http://mantisServerIP/adm_config_report.php?action>="><script>alert("XSSvenusTech")</script>  Unexpected result: There is a popup wizard saying 'XSSvenusTech' | | | | |
| Additional Information | You are highly appreciated to confirm and log a CVE for this issue, Similar to CVE-2017-6797 and CVE-2017-6799,  Fix suggestion: modify the adm\_config\_report.php replace: <input type="hidden" name="action" value="<?php echo $t\_edit\_action; ?>" /> with <input type="hidden" name="action" value="<?php echo string\_attribute($t\_edit\_action); ?>" />  Reportor: Yelin and Zhangdongsheng from VenusTech | | | | |
| Tags | No tags attached. | | | | |
| Attached Files |  | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=22537&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=22537&graph=dependency)

| related to | [0020058](view.php?id=20058) | closed | [cproensa](https://mantisbt.org/bugs/view_user_page.php?id=18303) | Updating config items in configuration report adds new ones |
| --- | --- | --- | --- | --- |
| parent of | [0022562](view.php?id=22562) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2017-6973: XSS in adm\_config\_report.php |
| parent of | [0022565](view.php?id=22565) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2017-6973: XSS in adm\_config\_report.php |
| related to | [0022579](view.php?id=22579) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2017-7309: XSS in adm\_config\_report.php |

#### Activities

| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-03-17 07:55  developer    [~0056101](view.php?id=22537#c56101 "Direct link to note") | Regression introduced in 1.3.0-rc.2, see [0020058](/bugs/view.php?id=20058 "[closed] Updating config items in configuration report adds new ones") |
| --- | --- |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-03-17 11:12  developer    [~0056105](view.php?id=22537#c56105 "Direct link to note")  Last edited: 2017-03-17 11:13 | [@YelinAndZhangdongsheng](https://mantisbt.org/bugs/view_user_page.php?id=42345) kindly review the attached patch (against master branch - I will backport it to 1.3.x as well) and confirm it resolves the issue.  I will take care of requesting the CVE.   [0001-Fix-XSS-in-adm\_config\_report.php-s-action-parameter.patch](file_download.php?file_id=7254&type=bug) (4,270 bytes)    ``` From 39e66bf05a807865f8f73d09596391d3e4d70be7 Mon Sep 17 00:00:00 2001 From: Damien Regad <dregad@mantisbt.org> Date: Fri, 17 Mar 2017 15:09:09 +0100 Subject: [PATCH] Fix XSS in adm_config_report.php's action parameter  Yelin and Zhangdongsheng from VenusTech http://www.venustech.com.cn/ reported a vulnerability in the Configuration Report page, allowing an attacker to inject arbitrary code through a crafted 'action' parameter.  Define a new set of constants (MANAGE_CONFIG_ACTION_*) replacing the hardcoded strings used in adm_config_report.php and adm_config_set.php.  Sanitize the 'action' parameter to ensure it is only set to one of the allowed values  Fixes #22537 ---  adm_config_report.php | 20 +++++++++++++++-----  adm_config_set.php    |  2 +-  core/constant_inc.php |  4 ++++  3 files changed, 20 insertions(+), 6 deletions(-)  diff --git a/adm_config_report.php b/adm_config_report.php index 8c0f017..37e8189 100644 --- a/adm_config_report.php +++ b/adm_config_report.php @@ -218,7 +218,17 @@ $t_edit_project_id      = gpc_get_int( 'project_id', $t_filter_project_value ==  $t_edit_option          = gpc_get_string( 'config_option', $t_filter_config_value == META_FILTER_NONE ? '' : $t_filter_config_value );  $t_edit_type            = gpc_get_string( 'type', CONFIG_TYPE_DEFAULT );  $t_edit_value           = gpc_get_string( 'value', '' ); -$t_edit_action          = gpc_get_string( 'action', 'action_create' ); + +$f_edit_action          = gpc_get_string( 'action', MANAGE_CONFIG_ACTION_CREATE ); +# Ensure we exclusively use one of the defined, valid actions (XSS protection) +$t_valid_actions = array( +	MANAGE_CONFIG_ACTION_CREATE, +	MANAGE_CONFIG_ACTION_CLONE, +	MANAGE_CONFIG_ACTION_EDIT +); +$t_edit_action = in_array( $f_edit_action, $t_valid_actions ) +	? $f_edit_action +	: MANAGE_CONFIG_ACTION_CREATE;    # Apply filters   @@ -443,7 +453,7 @@ while( $t_row = db_fetch_array( $t_result ) ) {  					'config_option' => $v_config_id,  					'type'          => $v_type,  					'value'         => $v_value, -					'action'        => 'action_edit', +					'action'        => MANAGE_CONFIG_ACTION_EDIT,  				),  				OFF );  			echo '</div>'; @@ -459,7 +469,7 @@ while( $t_row = db_fetch_array( $t_result ) ) {  					'config_option' => $v_config_id,  					'type'          => $v_type,  					'value'         => $v_value, -					'action'        => 'action_clone', +					'action'        => MANAGE_CONFIG_ACTION_CLONE,  				),  				OFF );  			echo '</div>'; @@ -514,7 +524,7 @@ if( $t_read_write_access ) {  		<div class="widget-header widget-header-small">  		<h4 class="widget-title lighter">  			<i class="ace-icon fa fa-sliders"></i> -			<?php echo lang_get( 'set_configuration_option_' . $t_edit_action ) ?> +			<?php echo lang_get( 'set_configuration_option_action_' . $t_edit_action ) ?>  			</h4>  		</div>   @@ -605,7 +615,7 @@ if( $t_read_write_access ) {  		<div class="widget-toolbox padding-4 clearfix">  			<input type="hidden" name="action" value="<?php echo $t_edit_action; ?>" />  			<input type="submit" name="config_set" class="btn btn-primary btn-white btn-round" -				value="<?php echo lang_get( 'set_configuration_option_' . $t_edit_action ) ?>"/> +				value="<?php echo lang_get( 'set_configuration_option_action_' . $t_edit_action ) ?>"/>  		</div>  	</div>  	</div> diff --git a/adm_config_set.php b/adm_config_set.php index 23c8947..c9e41e9 100644 --- a/adm_config_set.php +++ b/adm_config_set.php @@ -134,7 +134,7 @@ if( $t_type != CONFIG_TYPE_STRING ) {  	}  }   -if( 'action_edit' === $f_edit_action ){ +if( MANAGE_CONFIG_ACTION_EDIT === $f_edit_action ){  	# EDIT action doesn't keep original if key values are different.  	if ( $f_original_config_option !== $f_config_option  			|| $f_original_user_id !== $f_user_id diff --git a/core/constant_inc.php b/core/constant_inc.php index ffd3665..fd3f26c 100644 --- a/core/constant_inc.php +++ b/core/constant_inc.php @@ -655,3 +655,7 @@ define( 'EXPORT_BLOCK_SIZE', 500 );  # types, 2^31 is a safe limit to be used for all.  define( 'DB_MAX_INT', 2147483647 );   +# Configuration management actions (adm_config_report.php) +define( 'MANAGE_CONFIG_ACTION_CREATE', 'create' ); +define( 'MANAGE_CONFIG_ACTION_CLONE', 'clone' ); +define( 'MANAGE_CONFIG_ACTION_EDIT', 'edit' ); --  1.9.1   ```   [0001-Fix-XSS-in-adm\_config\_report.php-s-action-parameter.patch](file_download.php?file_id=7254&type=bug) (4,270 bytes) |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-03-17 11:49  developer    [~0056106](view.php?id=22537#c56106 "Direct link to note") | CVE Request 307635 |
|  | |
| [YelinAndZhangdongsheng](https://mantisbt.org/bugs/view_user_page.php?id=42345)   [YelinAndZhangdongsheng](https://mantisbt.org/bugs/view_user_page.php?id=42345)  2017-03-17 19:25  reporter    [~0056108](view.php?id=22537#c56108 "Direct link to note") | Good job Damien. We confirmed that the taint 'action' parameter is sanitized by the patch's White list validation. We keep on pivoting Mantis security issues. When we insights, we will share. Bests, Yelin and Zhangdongsheng |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-03-18 05:30  developer    [~0056109](view.php?id=22537#c56109 "Direct link to note") | Many thanks for the feedback and your contribution in improving security in MantisBT, it is greatly appreciated. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-03-31 04:01  developer    [~0056296](view.php?id=22537#c56296 "Direct link to note") | OSS-security mailing list announcement <http://www.openwall.com/lists/oss-security/2017/03/30/4> |
|  | |

#### Related Changesets

| MantisBT: master-1.3.x 034cd07b  2017-03-17 05:20  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23054) [Diff](https://github.com/mantisbt/mantisbt/commit/034cd07b47af37366fc7b726cb4a4f971d3d3fb9) | Fix XSS in adm\_config\_report.php's action parameter | | Affected Issues[0022537](/bugs/view.php?id=22537 "[closed] CVE-2017-6973: XSS in adm_config_report.php") |
| --- | --- | --- | --- |
| mod - adm\_config\_report.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/034cd07b47af37366fc7b726cb4a4f971d3d3fb9) [File](https://github.com/mantisbt/mantisbt/blob/034cd07b47af37366fc7b726cb4a4f971d3d3fb9/adm_config_report.php) |
| mod - adm\_config\_set.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/034cd07b47af37366fc7b726cb4a4f971d3d3fb9) [File](https://github.com/mantisbt/mantisbt/blob/034cd07b47af37366fc7b726cb4a4f971d3d3fb9/adm_config_set.php) |
| mod - core/constant\_inc.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/034cd07b47af37366fc7b726cb4a4f971d3d3fb9) [File](https://github.com/mantisbt/mantisbt/blob/034cd07b47af37366fc7b726cb4a4f971d3d3fb9/core/constant_inc.php) |
| MantisBT: master-2.2 da74c5aa  2017-03-17 06:09  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23050) [Diff](https://github.com/mantisbt/mantisbt/commit/da74c5aa02bcf21cfaab1180f892c22415e5fea6) | Fix XSS in adm\_config\_report.php's action parameter | | Affected Issues[0022537](/bugs/view.php?id=22537 "[closed] CVE-2017-6973: XSS in adm_config_report.php") |
| mod - adm\_config\_report.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/da74c5aa02bcf21cfaab1180f892c22415e5fea6) [File](https://github.com/mantisbt/mantisbt/blob/da74c5aa02bcf21cfaab1180f892c22415e5fea6/adm_config_report.php) |
| mod - adm\_config\_set.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/da74c5aa02bcf21cfaab1180f892c22415e5fea6) [File](https://github.com/mantisbt/mantisbt/blob/da74c5aa02bcf21cfaab1180f892c22415e5fea6/adm_config_set.php) |
| mod - core/constant\_inc.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/da74c5aa02bcf21cfaab1180f892c22415e5fea6) [File](https://github.com/mantisbt/mantisbt/blob/da74c5aa02bcf21cfaab1180f892c22415e5fea6/core/constant_inc.php) |
| MantisBT: master-2.1 15e52e84  2017-03-17 06:09  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23057) [Diff](https://github.com/mantisbt/mantisbt/commit/15e52e84c389afe8b03ed3cdb59b6549257ed197) | Fix XSS in adm\_config\_report.php's action parameter | | Affected Issues[0022537](/bugs/view.php?id=22537 "[closed] CVE-2017-6973: XSS in adm_config_report.php") |
| mod - adm\_config\_report.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/15e52e84c389afe8b03ed3cdb59b6549257ed197) [File](https://github.com/mantisbt/mantisbt/blob/15e52e84c389afe8b03ed3cdb59b6549257ed197/adm_config_report.php) |
| mod - adm\_config\_set.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/15e52e84c389afe8b03ed3cdb59b6549257ed197) [File](https://github.com/mantisbt/mantisbt/blob/15e52e84c389afe8b03ed3cdb59b6549257ed197/adm_config_set.php) |
| mod - core/constant\_inc.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/15e52e84c389afe8b03ed3cdb59b6549257ed197) [File](https://github.com/mantisbt/mantisbt/blob/15e52e84c389afe8b03ed3cdb59b6549257ed197/core/constant_inc.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1932 seconds



=== Content from github.com_3cb721e2_20250126_095256.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fda74c5aa02bcf21cfaab1180f892c22415e5fea6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fda74c5aa02bcf21cfaab1180f892c22415e5fea6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/da74c5aa02bcf21cfaab1180f892c22415e5fea6)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix XSS in adm\_config\_report.php's action parameter

[Browse files](/mantisbt/mantisbt/tree/da74c5aa02bcf21cfaab1180f892c22415e5fea6)
Browse the repository at this point in the history

```
Yelin and Zhangdongsheng from VenusTech <http://www.venustech.com.cn/>
reported a vulnerability in the Configuration Report page, allowing an
attacker to inject arbitrary code through a crafted 'action' parameter.

Define a new set of constants (MANAGE_CONFIG_ACTION_*) replacing the
hardcoded strings used in adm_config_report.php and adm_config_set.php.

Sanitize the 'action' parameter to ensure it is only set to one of the
allowed values

Fixes #22537
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Mar 20, 2017

1 parent
[1abcbc1](/mantisbt/mantisbt/commit/1abcbc10ea82aa36c2f2c2f38f43343d013749c4)

commit da74c5a

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**20 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* adm\_config\_report.php
  [adm\_config\_report.php](#diff-a082c02f12d371ba9e73f8877163c7fde1bc242ad77186494ae8da79eea92912)
* adm\_config\_set.php
  [adm\_config\_set.php](#diff-6b45f949c82da5d13c5e82263317b2b86183393f9952196e121ab3896485f58a)
* core

  + core/constant\_inc.php
    [constant\_inc.php](#diff-fc2b960b6c8c64008f47741705299a8d108a1eb0e8bfde031a07d39171843fac)

## There are no files selected for viewing

20 changes: 15 additions & 5 deletions

20
[adm\_config\_report.php](#diff-a082c02f12d371ba9e73f8877163c7fde1bc242ad77186494ae8da79eea92912 "adm_config_report.php")

Show comments

[View file](/mantisbt/mantisbt/blob/da74c5aa02bcf21cfaab1180f892c22415e5fea6/adm_config_report.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -218,7 +218,17 @@ function check\_config\_value( $p\_config ) { |
|  |  | $t\_edit\_option = gpc\_get\_string( 'config\_option', $t\_filter\_config\_value == META\_FILTER\_NONE ? '' : $t\_filter\_config\_value ); |
|  |  | $t\_edit\_type = gpc\_get\_string( 'type', CONFIG\_TYPE\_DEFAULT ); |
|  |  | $t\_edit\_value = gpc\_get\_string( 'value', '' ); |
|  |  | $t\_edit\_action = gpc\_get\_string( 'action', 'action\_create' ); |
|  |  |  |
|  |  | $f\_edit\_action = gpc\_get\_string( 'action', MANAGE\_CONFIG\_ACTION\_CREATE ); |
|  |  | # Ensure we exclusively use one of the defined, valid actions (XSS protection) |
|  |  | $t\_valid\_actions = array( |
|  |  | MANAGE\_CONFIG\_ACTION\_CREATE, |
|  |  | MANAGE\_CONFIG\_ACTION\_CLONE, |
|  |  | MANAGE\_CONFIG\_ACTION\_EDIT |
|  |  | ); |
|  |  | $t\_edit\_action = in\_array( $f\_edit\_action, $t\_valid\_actions ) |
|  |  | ? $f\_edit\_action |
|  |  | : MANAGE\_CONFIG\_ACTION\_CREATE; |
|  |  |  |
|  |  | # Apply filters |
|  |  |  |
| Expand Down  Expand Up | | @@ -443,7 +453,7 @@ function check\_config\_value( $p\_config ) { |
|  |  | 'config\_option' => $v\_config\_id, |
|  |  | 'type' => $v\_type, |
|  |  | 'value' => $v\_value, |
|  |  | 'action' => 'action\_edit', |
|  |  | 'action' => MANAGE\_CONFIG\_ACTION\_EDIT, |
|  |  | ), |
|  |  | OFF ); |
|  |  | echo '</div>'; |
| Expand All | | @@ -459,7 +469,7 @@ function check\_config\_value( $p\_config ) { |
|  |  | 'config\_option' => $v\_config\_id, |
|  |  | 'type' => $v\_type, |
|  |  | 'value' => $v\_value, |
|  |  | 'action' => 'action\_clone', |
|  |  | 'action' => MANAGE\_CONFIG\_ACTION\_CLONE, |
|  |  | ), |
|  |  | OFF ); |
|  |  | echo '</div>'; |
| Expand Down  Expand Up | | @@ -514,7 +524,7 @@ function check\_config\_value( $p\_config ) { |
|  |  | <div class="widget-header widget-header-small"> |
|  |  | <h4 class="widget-title lighter"> |
|  |  | <i class="ace-icon fa fa-sliders"></i> |
|  |  | <?php echo lang\_get( 'set\_configuration\_option\_' . $t\_edit\_action ) ?> |
|  |  | <?php echo lang\_get( 'set\_configuration\_option\_action\_' . $t\_edit\_action ) ?> |
|  |  | </h4> |
|  |  | </div> |
|  |  |  |
| Expand Down  Expand Up | | @@ -605,7 +615,7 @@ function check\_config\_value( $p\_config ) { |
|  |  | <div class="widget-toolbox padding-4 clearfix"> |
|  |  | <input type="hidden" name="action" value="<?php echo $t\_edit\_action; ?>" /> |
|  |  | <input type="submit" name="config\_set" class="btn btn-primary btn-white btn-round" |
|  |  | value="<?php echo lang\_get( 'set\_configuration\_option\_' . $t\_edit\_action ) ?>"/> |
|  |  | value="<?php echo lang\_get( 'set\_configuration\_option\_action\_' . $t\_edit\_action ) ?>"/> |
|  |  | </div> |
|  |  | </div> |
|  |  | </div> |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[adm\_config\_set.php](#diff-6b45f949c82da5d13c5e82263317b2b86183393f9952196e121ab3896485f58a "adm_config_set.php")

Show comments

[View file](/mantisbt/mantisbt/blob/da74c5aa02bcf21cfaab1180f892c22415e5fea6/adm_config_set.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -134,7 +134,7 @@ |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if( 'action\_edit' === $f\_edit\_action ){ |
|  |  | if( MANAGE\_CONFIG\_ACTION\_EDIT === $f\_edit\_action ){ |
|  |  | # EDIT action doesn't keep original if key values are different. |
|  |  | if ( $f\_original\_config\_option !== $f\_config\_option |
|  |  | || $f\_original\_user\_id !== $f\_user\_id |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[core/constant\_inc.php](#diff-fc2b960b6c8c64008f47741705299a8d108a1eb0e8bfde031a07d39171843fac "core/constant_inc.php")

Show comments

[View file](/mantisbt/mantisbt/blob/da74c5aa02bcf21cfaab1180f892c22415e5fea6/core/constant_inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -655,3 +655,7 @@ |
|  |  | # types, 2^31 is a safe limit to be used for all. |
|  |  | define( 'DB\_MAX\_INT', 2147483647 ); |
|  |  |  |
|  |  | # Configuration management actions (adm\_config\_report.php) |
|  |  | define( 'MANAGE\_CONFIG\_ACTION\_CREATE', 'create' ); |
|  |  | define( 'MANAGE\_CONFIG\_ACTION\_CLONE', 'clone' ); |
|  |  | define( 'MANAGE\_CONFIG\_ACTION\_EDIT', 'edit' ); |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `da74c5a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fda74c5aa02bcf21cfaab1180f892c22415e5fea6) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_29d974af_20250126_095258.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F15e52e84c389afe8b03ed3cdb59b6549257ed197)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F15e52e84c389afe8b03ed3cdb59b6549257ed197)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/15e52e84c389afe8b03ed3cdb59b6549257ed197)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix XSS in adm\_config\_report.php's action parameter

[Browse files](/mantisbt/mantisbt/tree/15e52e84c389afe8b03ed3cdb59b6549257ed197)
Browse the repository at this point in the history

```
Yelin and Zhangdongsheng from VenusTech <http://www.venustech.com.cn/>
reported a vulnerability in the Configuration Report page, allowing an
attacker to inject arbitrary code through a crafted 'action' parameter.

Define a new set of constants (MANAGE_CONFIG_ACTION_*) replacing the
hardcoded strings used in adm_config_report.php and adm_config_set.php.

Sanitize the 'action' parameter to ensure it is only set to one of the
allowed values

Fixes #22537
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Mar 20, 2017

1 parent
[5efd115](/mantisbt/mantisbt/commit/5efd115ed217996e4a154244b3d4d06c3ad3d1b8)

commit 15e52e8

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**20 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* adm\_config\_report.php
  [adm\_config\_report.php](#diff-a082c02f12d371ba9e73f8877163c7fde1bc242ad77186494ae8da79eea92912)
* adm\_config\_set.php
  [adm\_config\_set.php](#diff-6b45f949c82da5d13c5e82263317b2b86183393f9952196e121ab3896485f58a)
* core

  + core/constant\_inc.php
    [constant\_inc.php](#diff-fc2b960b6c8c64008f47741705299a8d108a1eb0e8bfde031a07d39171843fac)

## There are no files selected for viewing

20 changes: 15 additions & 5 deletions

20
[adm\_config\_report.php](#diff-a082c02f12d371ba9e73f8877163c7fde1bc242ad77186494ae8da79eea92912 "adm_config_report.php")

Show comments

[View file](/mantisbt/mantisbt/blob/15e52e84c389afe8b03ed3cdb59b6549257ed197/adm_config_report.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -218,7 +218,17 @@ function check\_config\_value( $p\_config ) { |
|  |  | $t\_edit\_option = gpc\_get\_string( 'config\_option', $t\_filter\_config\_value == META\_FILTER\_NONE ? '' : $t\_filter\_config\_value ); |
|  |  | $t\_edit\_type = gpc\_get\_string( 'type', CONFIG\_TYPE\_DEFAULT ); |
|  |  | $t\_edit\_value = gpc\_get\_string( 'value', '' ); |
|  |  | $t\_edit\_action = gpc\_get\_string( 'action', 'action\_create' ); |
|  |  |  |
|  |  | $f\_edit\_action = gpc\_get\_string( 'action', MANAGE\_CONFIG\_ACTION\_CREATE ); |
|  |  | # Ensure we exclusively use one of the defined, valid actions (XSS protection) |
|  |  | $t\_valid\_actions = array( |
|  |  | MANAGE\_CONFIG\_ACTION\_CREATE, |
|  |  | MANAGE\_CONFIG\_ACTION\_CLONE, |
|  |  | MANAGE\_CONFIG\_ACTION\_EDIT |
|  |  | ); |
|  |  | $t\_edit\_action = in\_array( $f\_edit\_action, $t\_valid\_actions ) |
|  |  | ? $f\_edit\_action |
|  |  | : MANAGE\_CONFIG\_ACTION\_CREATE; |
|  |  |  |
|  |  | # Apply filters |
|  |  |  |
| Expand Down  Expand Up | | @@ -443,7 +453,7 @@ function check\_config\_value( $p\_config ) { |
|  |  | 'config\_option' => $v\_config\_id, |
|  |  | 'type' => $v\_type, |
|  |  | 'value' => $v\_value, |
|  |  | 'action' => 'action\_edit', |
|  |  | 'action' => MANAGE\_CONFIG\_ACTION\_EDIT, |
|  |  | ), |
|  |  | OFF ); |
|  |  | echo '</div>'; |
| Expand All | | @@ -459,7 +469,7 @@ function check\_config\_value( $p\_config ) { |
|  |  | 'config\_option' => $v\_config\_id, |
|  |  | 'type' => $v\_type, |
|  |  | 'value' => $v\_value, |
|  |  | 'action' => 'action\_clone', |
|  |  | 'action' => MANAGE\_CONFIG\_ACTION\_CLONE, |
|  |  | ), |
|  |  | OFF ); |
|  |  | echo '</div>'; |
| Expand Down  Expand Up | | @@ -514,7 +524,7 @@ function check\_config\_value( $p\_config ) { |
|  |  | <div class="widget-header widget-header-small"> |
|  |  | <h4 class="widget-title lighter"> |
|  |  | <i class="ace-icon fa fa-sliders"></i> |
|  |  | <?php echo lang\_get( 'set\_configuration\_option\_' . $t\_edit\_action ) ?> |
|  |  | <?php echo lang\_get( 'set\_configuration\_option\_action\_' . $t\_edit\_action ) ?> |
|  |  | </h4> |
|  |  | </div> |
|  |  |  |
| Expand Down  Expand Up | | @@ -605,7 +615,7 @@ function check\_config\_value( $p\_config ) { |
|  |  | <div class="widget-toolbox padding-4 clearfix"> |
|  |  | <input type="hidden" name="action" value="<?php echo $t\_edit\_action; ?>" /> |
|  |  | <input type="submit" name="config\_set" class="btn btn-primary btn-white btn-round" |
|  |  | value="<?php echo lang\_get( 'set\_configuration\_option\_' . $t\_edit\_action ) ?>"/> |
|  |  | value="<?php echo lang\_get( 'set\_configuration\_option\_action\_' . $t\_edit\_action ) ?>"/> |
|  |  | </div> |
|  |  | </div> |
|  |  | </div> |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[adm\_config\_set.php](#diff-6b45f949c82da5d13c5e82263317b2b86183393f9952196e121ab3896485f58a "adm_config_set.php")

Show comments

[View file](/mantisbt/mantisbt/blob/15e52e84c389afe8b03ed3cdb59b6549257ed197/adm_config_set.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -134,7 +134,7 @@ |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if( 'action\_edit' === $f\_edit\_action ){ |
|  |  | if( MANAGE\_CONFIG\_ACTION\_EDIT === $f\_edit\_action ){ |
|  |  | # EDIT action doesn't keep original if key values are different. |
|  |  | if ( $f\_original\_config\_option !== $f\_config\_option |
|  |  | || $f\_original\_user\_id !== $f\_user\_id |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[core/constant\_inc.php](#diff-fc2b960b6c8c64008f47741705299a8d108a1eb0e8bfde031a07d39171843fac "core/constant_inc.php")

Show comments

[View file](/mantisbt/mantisbt/blob/15e52e84c389afe8b03ed3cdb59b6549257ed197/core/constant_inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -646,3 +646,7 @@ |
|  |  | # types, 2^31 is a safe limit to be used for all. |
|  |  | define( 'DB\_MAX\_INT', 2147483647 ); |
|  |  |  |
|  |  | # Configuration management actions (adm\_config\_report.php) |
|  |  | define( 'MANAGE\_CONFIG\_ACTION\_CREATE', 'create' ); |
|  |  | define( 'MANAGE\_CONFIG\_ACTION\_CLONE', 'clone' ); |
|  |  | define( 'MANAGE\_CONFIG\_ACTION\_EDIT', 'edit' ); |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `15e52e8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F15e52e84c389afe8b03ed3cdb59b6549257ed197) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_592f7367_20250126_095259.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F034cd07b47af37366fc7b726cb4a4f971d3d3fb9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F034cd07b47af37366fc7b726cb4a4f971d3d3fb9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/034cd07b47af37366fc7b726cb4a4f971d3d3fb9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix XSS in adm\_config\_report.php's action parameter

[Browse files](/mantisbt/mantisbt/tree/034cd07b47af37366fc7b726cb4a4f971d3d3fb9)
Browse the repository at this point in the history

```
Yelin and Zhangdongsheng from VenusTech <http://www.venustech.com.cn/>
reported a vulnerability in the Configuration Report page, allowing an
attacker to inject arbitrary code through a crafted 'action' parameter.

Define a new set of constants (MANAGE_CONFIG_ACTION_*) replacing the
hardcoded strings used in adm_config_report.php and adm_config_set.php.

Sanitize the 'action' parameter to ensure it is only set to one of the
allowed values

Fixes #22537
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Mar 17, 2017

1 parent
[c1d3abb](/mantisbt/mantisbt/commit/c1d3abba777aa8d208b4119ff52de040ed59f578)

commit 034cd07

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**22 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* adm\_config\_report.php
  [adm\_config\_report.php](#diff-a082c02f12d371ba9e73f8877163c7fde1bc242ad77186494ae8da79eea92912)
* adm\_config\_set.php
  [adm\_config\_set.php](#diff-6b45f949c82da5d13c5e82263317b2b86183393f9952196e121ab3896485f58a)
* core

  + core/constant\_inc.php
    [constant\_inc.php](#diff-fc2b960b6c8c64008f47741705299a8d108a1eb0e8bfde031a07d39171843fac)

## There are no files selected for viewing

20 changes: 15 additions & 5 deletions

20
[adm\_config\_report.php](#diff-a082c02f12d371ba9e73f8877163c7fde1bc242ad77186494ae8da79eea92912 "adm_config_report.php")

Show comments

[View file](/mantisbt/mantisbt/blob/034cd07b47af37366fc7b726cb4a4f971d3d3fb9/adm_config_report.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -217,7 +217,17 @@ function check\_config\_value( $p\_config ) { |
|  |  | $t\_edit\_option = gpc\_get\_string( 'config\_option', $t\_filter\_config\_value == META\_FILTER\_NONE ? '' : $t\_filter\_config\_value ); |
|  |  | $t\_edit\_type = gpc\_get\_string( 'type', CONFIG\_TYPE\_DEFAULT ); |
|  |  | $t\_edit\_value = gpc\_get\_string( 'value', '' ); |
|  |  | $t\_edit\_action = gpc\_get\_string( 'action', 'action\_create' ); |
|  |  |  |
|  |  | $f\_edit\_action = gpc\_get\_string( 'action', MANAGE\_CONFIG\_ACTION\_CREATE ); |
|  |  | # Ensure we exclusively use one of the defined, valid actions (XSS protection) |
|  |  | $t\_valid\_actions = array( |
|  |  | MANAGE\_CONFIG\_ACTION\_CREATE, |
|  |  | MANAGE\_CONFIG\_ACTION\_CLONE, |
|  |  | MANAGE\_CONFIG\_ACTION\_EDIT |
|  |  | ); |
|  |  | $t\_edit\_action = in\_array( $f\_edit\_action, $t\_valid\_actions ) |
|  |  | ? $f\_edit\_action |
|  |  | : MANAGE\_CONFIG\_ACTION\_CREATE; |
|  |  |  |
|  |  | # Apply filters |
|  |  |  |
| Expand Down  Expand Up | | @@ -413,7 +423,7 @@ function check\_config\_value( $p\_config ) { |
|  |  | 'config\_option' => $v\_config\_id, |
|  |  | 'type' => $v\_type, |
|  |  | 'value' => $v\_value, |
|  |  | 'action' => 'action\_edit', |
|  |  | 'action' => MANAGE\_CONFIG\_ACTION\_EDIT, |
|  |  | ), |
|  |  | OFF ); |
|  |  |  |
| Expand All | | @@ -427,7 +437,7 @@ function check\_config\_value( $p\_config ) { |
|  |  | 'config\_option' => $v\_config\_id, |
|  |  | 'type' => $v\_type, |
|  |  | 'value' => $v\_value, |
|  |  | 'action' => 'action\_clone', |
|  |  | 'action' => MANAGE\_CONFIG\_ACTION\_CLONE, |
|  |  | ), |
|  |  | OFF ); |
|  |  |  |
| Expand Down  Expand Up | | @@ -473,7 +483,7 @@ function check\_config\_value( $p\_config ) { |
|  |  |  |
|  |  | <!-- Title --> |
|  |  | <legend><span> |
|  |  | <?php echo lang\_get( 'set\_configuration\_option\_' . $t\_edit\_action ) ?> |
|  |  | <?php echo lang\_get( 'set\_configuration\_option\_action\_' . $t\_edit\_action ) ?> |
|  |  | </span></legend> |
|  |  |  |
|  |  | <!-- Username --> |
| Expand Down  Expand Up | | @@ -545,7 +555,7 @@ function check\_config\_value( $p\_config ) { |
|  |  | <!-- Submit button --> |
|  |  | <span class="submit-button"> |
|  |  | <input type="hidden" name="action" value="<?php echo $t\_edit\_action; ?>" /> |
|  |  | <input type="submit" name="config\_set" class="button" value="<?php echo lang\_get( 'set\_configuration\_option\_' . $t\_edit\_action ) ?>" /> |
|  |  | <input type="submit" name="config\_set" class="button" value="<?php echo lang\_get( 'set\_configuration\_option\_action\_' . $t\_edit\_action ) ?>" /> |
|  |  | </span> |
|  |  | </fieldset> |
|  |  | </form> |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[adm\_config\_set.php](#diff-6b45f949c82da5d13c5e82263317b2b86183393f9952196e121ab3896485f58a "adm_config_set.php")

Show comments

[View file](/mantisbt/mantisbt/blob/034cd07b47af37366fc7b726cb4a4f971d3d3fb9/adm_config_set.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -134,7 +134,7 @@ |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if( 'action\_edit' === $f\_edit\_action ){ |
|  |  | if( MANAGE\_CONFIG\_ACTION\_EDIT === $f\_edit\_action ){ |
|  |  | # EDIT action doesn't keep original if key values are different. |
|  |  | if ( $f\_original\_config\_option !== $f\_config\_option |
|  |  | || $f\_original\_user\_id !== $f\_user\_id |
| Expand Down | |  |

7 changes: 6 additions & 1 deletion

7
[core/constant\_inc.php](#diff-fc2b960b6c8c64008f47741705299a8d108a1eb0e8bfde031a07d39171843fac "core/constant_inc.php")

Show comments

[View file](/mantisbt/mantisbt/blob/034cd07b47af37366fc7b726cb4a4f971d3d3fb9/core/constant_inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -621,4 +621,9 @@ |
|  |  | # Note: mantis ids are defined in schema as "I UNSIGNED", which Adodb maps to |
|  |  | # the closest integer (4 bytes) type available. As some DBs dont support unsigned |
|  |  | # types, 2^31 is a safe limit to be used for all. |
|  |  | define( 'DB\_MAX\_INT', 2147483647 ); |
|  |  | define( 'DB\_MAX\_INT', 2147483647 ); |
|  |  |  |
|  |  | # Configuration management actions (adm\_config\_report.php) |
|  |  | define( 'MANAGE\_CONFIG\_ACTION\_CREATE', 'create' ); |
|  |  | define( 'MANAGE\_CONFIG\_ACTION\_CLONE', 'clone' ); |
|  |  | define( 'MANAGE\_CONFIG\_ACTION\_EDIT', 'edit' ); |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `034cd07`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F034cd07b47af37366fc7b726cb4a4f971d3d3fb9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


