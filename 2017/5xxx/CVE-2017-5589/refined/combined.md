=== Content from github.com_d242eac7_20250124_120158.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fge0rg%2Fyaxim%2Fcommit%2F65a38dc77545d9568732189e86089390f0ceaf9f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fge0rg%2Fyaxim%2Fcommit%2F65a38dc77545d9568732189e86089390f0ceaf9f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ge0rg%2Fyaxim)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ge0rg](/ge0rg)
/
**[yaxim](/ge0rg/yaxim)**
Public

forked from [yaxim-org/yaxim](/yaxim-org/yaxim)

* [Notifications](/login?return_to=%2Fge0rg%2Fyaxim) You must be signed in to change notification settings
* [Fork
  38](/login?return_to=%2Fge0rg%2Fyaxim)
* [Star
   92](/login?return_to=%2Fge0rg%2Fyaxim)

* [Code](/ge0rg/yaxim)
* [Pull requests
  1](/ge0rg/yaxim/pulls)
* [Actions](/ge0rg/yaxim/actions)
* [Projects
  0](/ge0rg/yaxim/projects)
* [Security](/ge0rg/yaxim/security)
* [Insights](/ge0rg/yaxim/pulse)

Additional navigation options

* [Code](/ge0rg/yaxim)
* [Pull requests](/ge0rg/yaxim/pulls)
* [Actions](/ge0rg/yaxim/actions)
* [Projects](/ge0rg/yaxim/projects)
* [Security](/ge0rg/yaxim/security)
* [Insights](/ge0rg/yaxim/pulse)

## Commit

[Permalink](/ge0rg/yaxim/commit/65a38dc77545d9568732189e86089390f0ceaf9f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Smackable: improved carbon checks

[Browse files](/ge0rg/yaxim/tree/65a38dc77545d9568732189e86089390f0ceaf9f)
Browse the repository at this point in the history

* Loading branch information

[![@ge0rg](https://avatars.githubusercontent.com/u/165635?s=40&v=4)](/ge0rg)

[ge0rg](/ge0rg/yaxim/commits?author=ge0rg "View all commits by ge0rg")
committed
Jan 30, 2017

1 parent
[b829050](/ge0rg/yaxim/commit/b829050cd1d27b86739c3b694732c558787c18c0)

commit 65a38dc

Showing
**1 changed file**
with
**4 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[src/org/yaxim/androidclient/service/SmackableImp.java](#diff-d4b286ec3029364ab118ab500d4f9a08c0163bdc1b64b2e141dbe86d3197045b "src/org/yaxim/androidclient/service/SmackableImp.java")

Show comments

[View file](/ge0rg/yaxim/blob/65a38dc77545d9568732189e86089390f0ceaf9f/src/org/yaxim/androidclient/service/SmackableImp.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1242,6 +1242,10 @@ public void processPacket(Packet packet) { |
|  |  |  |
|  |  | int direction = ChatConstants.INCOMING; |
|  |  | Carbon cc = CarbonManager.getCarbon(msg); |
|  |  | if (cc != null && !msg.getFrom().equalsIgnoreCase(mConfig.jabberID)) { |
|  |  | Log.w(TAG, "Received illegal carbon from " + msg.getFrom() + ": " + cc.toXML()); |
|  |  | cc = null; |
|  |  | } |
|  |  |  |
|  |  | // extract timestamp |
|  |  | long ts; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `65a38dc`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fge0rg%2Fyaxim%2Fcommit%2F65a38dc77545d9568732189e86089390f0ceaf9f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.thijsalkema.de_8d66d158_20250126_005904.html ===

### [xnyhps’ blog](https://blog.thijsalkema.de/)

Toggle navigation

* [Home](https://blog.thijsalkema.de/)
* [Archives](https://blog.thijsalkema.de/blog/archives/)
* [About](https://blog.thijsalkema.de/about/)

* [RSS](https://blog.thijsalkema.de/atom.xml)

January 26, 2016
[# The Wrong Number Attack](./blog/2016/01/26/the-wrong-number-attack/)

---

XMPP is federated, similar to email, which means different domains can connect to each other. Back in the early days, when a server initiated a connection to a server, the initiating server could be reasonably sure it connected to the right place as it resolved the DNS records (remember, it’s 1999). But the receiving server has no guarantee on whether the incoming connection was actually from the domain it claimed.

[Read more](./blog/2016/01/26/the-wrong-number-attack/)

---

December 28, 2015
[# Common DH groups](./blog/2015/12/28/common-dh-groups/)

---

To deal with the [logjam attack](https://weakdh.org/), I was looking for a set of all “common” Diffie-Hellman parameters to update [xmpp.net](https://xmpp.net), yet I wasn’t able to find those easily. Even just searching for the hexadecimal representation of commonly encounted primes often didn’t lead to the document they were specified. Here I’m documenting those that I found and where they are from.

[Read more](./blog/2015/12/28/common-dh-groups/)

---

December 18, 2015
[# Out with octopress, in with Hakyll](./blog/2015/12/18/out-with-octopress-in-with-hakyll/)

---

As you can see, the layout of this blog has changed. I was updating this blog so little, every time I did Ruby had broken everything (or so it felt like). I don’t like the idea of having to learn Ruby or gem to blog, so I’ve decided to switch to something else.

[Read more](./blog/2015/12/18/out-with-octopress-in-with-hakyll/)

---

April 17, 2015
[# Validate the encoding before passing strings to libcurl or glibc](./blog/2015/04/17/validate-the-encoding-before-passing-strings-to-libcurl-or-glibc/)

---

Lets start with a simple example in php:

```
setlocale(LC_ALL, "nl_NL.UTF-8");

$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, $_GET["url"]);

curl_exec($ch);
```

This code is broken, can you tell how?

[Read more](./blog/2015/04/17/validate-the-encoding-before-passing-strings-to-libcurl-or-glibc/)

---

January 23, 2015
[# Multi-end to multi-end encryption](./blog/2015/01/23/multi-end-to-multi-end-encryption/)

---

It’s a week until the XMPP Summit in Brussels, which I won’t be able to attend. How­ever, I do have some thoughts about two of the subjects that are on the agenda that I wanted to share.

[Carbons](http://xmpp.org/extensions/xep-0280.html)/[MAM](http://xmpp.org/extensions/xep-0313.html) and e2e-encryption seem to be moving in two completely opposite directions: MAM wants to store messages server-side, while e2e protocols like OTR want to ensure those stored messages are useless. But I don’t think they’d have to be mutually exclusive. I think it would be possible to find a solution that unifies the two concepts.

[Read more](./blog/2015/01/23/multi-end-to-multi-end-encryption/)

---

* [← Older](https://blog.thijsalkema.de/blog/page/2/)
* [Archives](./blog/archives/)
* Newer →

### Recent posts

* [The Wrong Number Attack](./blog/2016/01/26/the-wrong-number-attack/)
* [Common DH groups](./blog/2015/12/28/common-dh-groups/)
* [Out with octopress, in with Hakyll](./blog/2015/12/18/out-with-octopress-in-with-hakyll/)
* [Validate the encoding before passing strings to libcurl or glibc](./blog/2015/04/17/validate-the-encoding-before-passing-strings-to-libcurl-or-glibc/)
* [Multi-end to multi-end encryption](./blog/2015/01/23/multi-end-to-multi-end-encryption/)

Copyright © 2024 - [Thijs Alkemade](https://infosec.exchange/%40xnyhps)

Site proudly generated by [Hakyll](https://jaspervdj.be/hakyll/).



=== Content from openwall.com_cb313c0e_20250124_120158.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](28) [[next>]](30) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <AM5PR0401MB2449A3DB7B25A878F97A1ECFF4450@AM5PR0401MB2449.eurprd04.prod.outlook.com>
Date: Thu, 9 Feb 2017 17:06:16 +0000
From: Georg Lukas <lukas@...solutions.de>
To: "'bugtraq@...urityfocus.com'" <bugtraq@...urityfocus.com>,
	"oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
CC: "jdev@...ber.org" <jdev@...ber.org>
Subject: CVE-2017-5589+ Multiple XMPP Clients User Impersonation Vulnerability

Summary
-------

An incorrect implementation of XEP-0280: Message Carbons[0] in multiple
XMPP clients allows a remote attacker to impersonate any user, including
contacts, in the vulnerable application's display. This allows for
various kinds of social engineering attacks.

Classification
--------------

  - CWE-304: Missing Critical Step in Authentication
  - CWE-940: Improper Verification of Source of a Communication Channel
  - CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N (score 7.1)

Affected Applications
---------------------

  - CVE-2017-5589: yaxim and Bruno (0.8.6 - 0.8.8; Android)
  - CVE-2017-5590: ChatSecure (3.2.0 - 4.0.0; only iOS) and Zom (all
versions up to 1.0.11; only iOS)
  - CVE-2017-5591: poezio (0.8 - 0.10)
  - CVE-2017-5592: profanity (0.4.7 - 0.5.0)
  - CVE-2017-5593: Psi+ (0.16.563.580 - 0.16.571.627)
  - CVE-2017-5602: jappix (1.0.0 to 1.1.6)
  - CVE-2017-5603: Jitsi (2.5.5061 - 2.9.5544)
  - CVE-2017-5604: mcabber (1.0.0 - 1.0.4)
  - CVE-2017-5605: Movim (0.8 - 0.10)
  - CVE-2017-5606: Xabber (only if manually enabled: 1.0.30, 1.0.30 VIP,
beta 1.0.3 - 1.0.74; Android)
  - CVE-2017-5858: Converse.js (0.8.0 - 1.0.6, 2.0.0 - 2.0.4)

Affected Libraries
------------------

  - CVE-2017-5591: SleekXMPP unknown up to 1.3.1
  - CVE-2017-5591: Slixmpp all versions up to 1.2.3

Details
-------

The XMPP protocol extension "XEP-0280: Message Carbons"[0] allows
a user to run multiple clients on their XMPP account by sending "carbon
copies" of outgoing and incoming messages to the user's other devices
(besides the one that directly sent or received the original message).

This feature must be supported by the user's server and must be
explicitly enabled by the client. Carbon copies are always generated by
the user's server and originate from the user's bare JID (their account
address).

For example, the following is message "Hi!", sent by Alice
(`alice@...p.example`) to Bob's client 1 (`bob@...p.example/client1`):

	<message from="alice@...p.example" to="bob@...p.example/client1">
	    <body>Hi!</body>
	</message>

Bob is also logged in with carbons-enabled client 2, which receives the
following carbon-copy of the message:

	<message from="bob@...p.example" to="bob@...p.example/client2">
	    <received xmlns='urn:xmpp:carbons:2'><forwarded
xmlns='urn:xmpp:forward:0'>
		<message from="alice@...p.example"
to="bob@...p.example/client1">
		    <body>Hi!</body>
		</message>
	    </forwarded></received>
	</message>

Now, client 2 can extract the original message from the carbon copy and
display it accordingly. The "Security Considerations" section of
XEP-0280 explicitly states that:

| Any forwarded copies received by a Carbons-enabled client MUST be from
| that user's bare JID; any copies that do not meet this requirement
| MUST be ignored.

The Carbons implementation in the affected clients was lacking this
test. It simply checked all incoming messages for presence of a Carbon
element (`<received/>` or `<sent/>`), extracted and parsed it like a
regular message.

Therefore, it was possible for Mallory to send the following specially
crafted message to Bob:

	<message from="mallory@...l.example" to="b@...p.example">
	    <received xmlns='urn:xmpp:carbons:2'><forwarded
xmlns='urn:xmpp:forward:0'>
		<message from="alice@...p.example"
to="bob@...p.example/client1">
		    <body>Please come to Creepy Valley tonight,
alone!</body>
		</message>
	    </forwarded></received>
	</message>

This would appear as an authentic message from Alice, including Alice'
proper screen name, allowing Mallory to perform social engineering
attacks on Bob.

Mitigation
----------

While the attacker can send messages in the name of somebody else, they
can not see your responses. Therefore, if you receive a phony message
while using an affected client, reinsure with the message sender by
either challenging them with a question that can not be guessed by the
attacker, or by using out-of-band means.

Xabber: disable the experimental Carbons feature in the app settings.

yaxim: Disabling Message Carbons under "Settings" / "Edit account" /
"Message Carbons (XEP-0280)" will not solve the problem, as the
malicious messages still will be interpreted.

Timeline
--------

  - 2017-01-20 Discovery of vulnerability
  - 2017-01-23 - 26 Notification of developers
  - 2017-01-25 Release of ChatSecure 4.0.1
    fix commit:
<https://github.com/ChatSecure/ChatSecure-iOS/commit/a340b4bb519227d89f85f271>
6a10a197a65d4856
  - 2017-01-26 Release of jappix 1.1.7
    fix commit:
<https://github.com/jappix/jappix/commit/ea6de7c65b80880bdf85df47c1a8a5d3d684>
91af
  - 2017-01-28 Release of Psi+ 0.16.571.630
    fix commit:
<https://github.com/psi-im/iris/pull/47/commits/02e976d4426a1319a7af7d26d7aba>
9d8c6077570
  - 2017-01-29 Release of profanity 0.5.1
    fix commit:
<https://github.com/boothj5/profanity/commit/8e75437a7e43d4c55e861691f74892e6>
66e29b0b
  - 2017-01-29 Release of mcabber 1.0.5
    fix commit: <https://mcabber.com/hg/rev/2a9569fd7644>
  - 2017-01-30 Release of poezio 0.11 with slixmpp 1.2.4
    slixmpp fix commit:
<https://github.com/poezio/slixmpp/commit/22664ee7b86c8e010f312b66d12590fb471>
60ad8
  - 2017-01-31 Release of yaxim and Bruno 0.9.0
    fix commit:
<https://github.com/ge0rg/yaxim/commit/65a38dc77545d9568732189e86089390f0ceaf>
9f
  - 2017-01-31 Release of Movim 0.11alpha1
    fix commit:
<https://github.com/movim/moxl/commit/838b0a42efc3b67cc17d63e25ae1d0ea849cd89>
b
  - 2017-01-31 Notification of Debian Security Team
  - 2017-02-01 Release of profanity 0.4.7.patch1 and 0.5.0.patch1 (backports
of the fix)
  - 2017-02-01 Release of Converse.js 1.07 and 2.05
    fix commit:
<https://github.com/jcbrand/converse.js/commit/42f249cabbbf5c026398e6d3b350f6>
f9536ea572
  - 2017-02-05 Release of Jitsi 2.10
    fix commit:
<https://github.com/jitsi/jitsi/commit/7d66da61b316c9480b63000f831b6de723b873>
15
  - 2017-02-08 Release of Zom 1.0.12
    fix commit:
<https://github.com/zom/Zom-iOS/commit/880051eaa8ba32d1b257c87a7d8798a93561bf>
d3
  - 2017-02-09 Publication of this advisory

Acknowledgements
----------------

  - Daniel Gultsch for CVE-2015-8688: Gajim Roster Push Attack / Message
    Interception[1]
  - Sam Whited for CVE-2016-9928 (same as above in mcabber)[2]
  - Thijs Alkemade for being an awesome XMPP security researcher (and
    for proof-reading this)[3]

Links
-----

[0] <https://xmpp.org/extensions/xep-0280.html>
[1] <https://gultsch.de/gajim_roster_push_and_message_interception.html>
[2] <http://www.openwall.com/lists/oss-security/2016/12/09/5>
[3] <https://blog.thijsalkema.de/>

HTML version of advisory:
<https://rt-solutions.de/en/2017/02/CVE-2017-5589_xmpp_carbons/>
PDF version of advisory:
<https://rt-solutions.de/wp-content/uploads/2017/02/CVE-2017-5589_xmpp_carbon>
s.pdf

--
Dr.-Ing. Georg Lukas
rt-solutions.de GmbH
Oberländer Ufer 190a
D-50968 Köln

Tel. : (+49)221 93724 16
Fax : (+49)221 93724 50
Mobil: (+49)179 4176591
Web : www.rt-solutions.de
rt-solutions.de
experts you can trust.

Sitz der Gesellschaft: Köln
Eingetragen beim Amtsgericht Köln: HRB 52645
Geschäftsführer: Prof. Dr. Ralf Schumann, Dr. Stefan Schemmer

Download attachment "[smime.p7s](29/1)" of type "application/pkcs7-signature" (4809 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


