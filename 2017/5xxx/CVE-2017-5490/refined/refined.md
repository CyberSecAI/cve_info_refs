```
{
  "CVE-2017-5490": {
    "related_content": [
      {
        "source": "github.com_7d7d6d40_20250126_024739.html",
        "vulnerability": "The commit diff shows a change in `wp-includes/class-wp-theme.php` where the theme name is being sanitized. Specifically, it adds `esc_html()` to the theme name when it's empty which is likely a fix for an XSS vulnerability. It fixes the markup for theme name fallbacks. The original code didn't properly sanitize the theme name when falling back to the stylesheet name resulting in XSS.\n\nSpecifically:\n- Original code:\n```php\nif ( empty( $value ) )\n    $value = $this->get_stylesheet();\nif ( empty( $value ) ) {\n   $value = $this->get_stylesheet();\n}\n```\n- Fixed Code:\n```php\nif ( empty( $value ) )\n    $value = $this->get_stylesheet();\nif ( empty( $value ) ) {\n   $value = esc_html( $this->get_stylesheet() );\n}\n```",
        "root_cause": "The theme name was not being properly sanitized when falling back to the stylesheet name, allowing for XSS injection.",
        "weaknesses": [
          "Cross-site Scripting (XSS)"
        ],
        "impact": "An attacker could inject malicious JavaScript code through the theme name, which would execute when a user views the theme details or any part of the application that renders the unsanitized theme name.",
        "attack_vectors": "By crafting a theme with malicious javascript code in its name, the attacker can upload it to the WordPress instance. When the theme name is displayed, the XSS payload is executed.",
        "attacker_capabilities": "The attacker needs the ability to upload themes to the WordPress instance. This likely requires administrative privileges or another vulnerability which grants the ability to upload themes."
      },
       {
        "source": "www.debian.org_2c992b25_20250126_024737.html",
         "vulnerability": "This content is part of a FAQ regarding security in Debian. It does not contain specific details of CVE-2017-5490.",
        "root_cause": "NOINFO",
        "weaknesses": [],
        "impact": "NOINFO",
        "attack_vectors": [],
        "attacker_capabilities": []
      },
      {
        "source": "codex.wordpress.org_de3c9bf2_20250124_182914.html",
        "vulnerability": "This document describes WordPress 4.7.1, which includes a fix for CVE-2017-5490, which is described as \"Cross-site scripting (XSS) via theme name fallback.\" It notes that this was reported by Mehmet Ince.",
         "root_cause": "NOINFO",
        "weaknesses": [
          "Cross-site Scripting (XSS)"
        ],
         "impact": "An attacker can perform cross-site scripting (XSS) via the theme name fallback.",
        "attack_vectors": "NOINFO",
        "attacker_capabilities": "NOINFO"
      },
      {
        "source": "www.debian.org_f9dd7ab9_20250124_182912.html",
          "vulnerability": "This is a Debian Security Advisory (DSA) that mentions CVE-2017-5490 as one of several vulnerabilities fixed in a wordpress security update. It generally describes the impact of the vulnerability but doesn't contain specific details of the vulnerability itself",
         "root_cause": "NOINFO",
        "weaknesses": [
          "Cross-site Scripting (XSS)"
        ],
        "impact": "It would allow remote attackers to hijack victims' credentials, access sensitive information, execute arbitrary commands, bypass read and post restrictions, or mount denial-of-service attacks.",
        "attack_vectors": [],
         "attacker_capabilities": []
      },
      {
        "source": "github.com_8422b941_20250126_024738.html",
         "vulnerability": "This commit disables wp-mail.php when the mailserver_url is set to mail.example.com. This is related to CVE-2017-5491 and not this CVE.",
        "root_cause": "UNRELATED",
        "weaknesses": [],
        "impact": "UNRELATED",
        "attack_vectors": [],
        "attacker_capabilities": []
      },
      {
        "source": "wordpress.org_74e9798f_20250124_182916.html",
        "vulnerability": "This is the WordPress 4.7.1 release announcement. It mentions that WordPress versions 4.7 and earlier are affected by a Cross-site scripting (XSS) via theme name fallback. It notes that this was reported by Mehmet Ince.",
         "root_cause": "NOINFO",
        "weaknesses": [
          "Cross-site Scripting (XSS)"
        ],
         "impact": "An attacker can perform cross-site scripting (XSS) via the theme name fallback.",
        "attack_vectors": "NOINFO",
        "attacker_capabilities": "NOINFO"
      },
       {
        "source": "www.mehmetince.net_6d3f8417_20250126_024738.html",
         "vulnerability": "This is the original report from Mehmet Ince detailing the XSS vulnerability. The vulnerable code was in `/wp-admin/includes/class-theme-installer-skin.php`, specifically, the theme `Name` parameter was not sanitized when displayed, leading to XSS. The attack vector involves uploading a theme where the `Theme Name` field contains a malicious script. The attacker needs to be logged in as admin to upload the theme. The XSS payload is then executed when the theme details are viewed. The report mentions it's a stored XSS, and the attacker needs to upload the malicious theme file via zip. The limitations are that the XSS payload as a folder name only works on Linux.",
         "root_cause": "The `$name` parameter in the theme installer skin class is not sanitized before being used within HTML content.",
        "weaknesses": [
          "Cross-site Scripting (XSS)"
        ],
        "impact": "An attacker can execute arbitrary Javascript code in the context of a logged-in admin user by uploading a specially crafted theme.",
        "attack_vectors": "The attacker uploads a ZIP file containing a theme with a malicious script within the Theme Name field inside `style.css`.",
        "attacker_capabilities": "The attacker needs to be an authenticated WordPress administrator in order to upload themes via the theme installer. The target system must also be on Linux because Windows disallows the use of certain characters (like `<>` ) in folder names."
      },
      {
        "source": "www.openwall.com_5fbb30f3_20250124_182912.html",
          "vulnerability": "This is an email from the CVE assignment team assigning CVE-2017-5490 to the XSS via theme name fallback vulnerability reported by Mehmet Ince.",
        "root_cause": "NOINFO",
        "weaknesses": [
          "Cross-site Scripting (XSS)"
        ],
        "impact": "NOINFO",
        "attack_vectors": [],
        "attacker_capabilities": []
      }
    ]
  }
}
```