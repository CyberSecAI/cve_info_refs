```
{
  "CVE-2017-5717": {
    "related": true,
    "summary": "The Intel Content Protection HECI Service exposes a DCOM object to all users and most sandboxes. It has a type confusion vulnerability which can be used to elevate to SYSTEM privileges.",
    "root_cause": "The `StartIo` function of the Intel Content Protection HECI Service uses a variant as a SAFEARRAY without checking if the variant actually contains a SAFEARRAY. This type confusion allows an attacker to pass an integer which is interpreted as a pointer to a SAFEARRAY structure.",
    "vulnerabilities": [
      "Type Confusion",
       "Unvalidated input leading to arbitrary memory read",
      "Arbitrary code execution"
    ],
    "impact": "Elevation of privileges to SYSTEM.",
    "attack_vectors": [
      "Local access",
       "DCOM interface exposed to all users and sandboxes"
    ],
   "attacker_capabilities": "An attacker needs to be able to call the exposed DCOM service with a crafted input. This can be done from a local user or from sandboxed environments like Edge LPAC or Chrome GPU.",
    "additional_details": "The vulnerability lies within the `CopyFrom` function of the `CComSafeArray` class. The function copies the data from a SAFEARRAY using a pointer provided through the variant. The code does verify the type of the variant as `VT_UI1` (byte array) but this can be bypassed by setting feature flags such as `FADF_UNKNOWN` to force calls to `IUnknown::AddRef` on the array elements. BSTR type variants with arbitrary data can be used to pass a fake SAFEARRAY where the length field of the BSTR lines up with the variant type of SAFEARRAY and the content of the BSTR is interpreted as a SAFEARRAY structure"
  }
}
```