Based on the provided content, here's an analysis of CVE-2017-5857:

**Root Cause of Vulnerability:**
The vulnerability is due to a missing cleanup operation when a guest sends a `VIRTIO_GPU_CMD_RESOURCE_UNREF` command without detaching the backing storage beforehand using `VIRTIO_GPU_CMD_RESOURCE_DETACH_BACKING`.

**Weaknesses/Vulnerabilities Present:**
- Host memory leak. When a guest sends `VIRTIO_GPU_CMD_RESOURCE_UNREF` without a prior `VIRTIO_GPU_CMD_RESOURCE_DETACH_BACKING` command, memory allocated on the host is not released.

**Impact of Exploitation:**
- Denial of Service (DoS). A malicious guest user can repeatedly trigger this flaw, leading to host memory exhaustion and causing a DoS.

**Attack Vectors:**
- A guest user/process can send a crafted sequence of virtio-gpu commands to the QEMU process, specifically the `VIRTIO_GPU_CMD_RESOURCE_UNREF` command without calling `VIRTIO_GPU_CMD_RESOURCE_DETACH_BACKING` first.

**Required Attacker Capabilities/Position:**
- The attacker needs to have control over a guest system running within the vulnerable QEMU instance. They must be able to execute code that can send virtio-gpu commands.

**Additional details from the provided content:**
- The vulnerability is specific to the 3D mode of the Virtio GPU device emulator in QEMU.
- A patch was created to address the issue by ensuring that the memory cleanup function is called even if the backing storage is not detached before the `VIRTIO_GPU_CMD_RESOURCE_UNREF` command.
- The fix was implemented in `hw/display/virtio-gpu-3d.c`.
- The vulnerability was reported by Li Qiang of 360.cn Inc.
- Gentoo Security Advisory GLSA 201702-28 indicates that `app-emulation/qemu` versions prior to 2.8.0-r1 are vulnerable.