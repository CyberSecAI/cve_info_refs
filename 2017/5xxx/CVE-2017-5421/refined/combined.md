=== Content from www.mozilla.org_22c9f265_20250124_222946.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2017-09

## Security vulnerabilities fixed in - Thunderbird 52

Announced
April 5, 2017
Impact
critical
Products
Thunderbird
Fixed in

* Thunderbird 52

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2017-5400: asm.js JIT-spray bypass of ASLR and DEP](#CVE-2017-5400)

Reporter
Rh0
Impact
critical
##### Description

JIT-spray targeting asm.js combined with a heap spray allows for a bypass of ASLR and DEP protections leading to potential memory corruption attacks.

##### References

* [Bug 1334933](https://bugzilla.mozilla.org/show_bug.cgi?id=1334933)

#### [#CVE-2017-5401: Memory Corruption when handling ErrorResult](#CVE-2017-5401)

Reporter
Anton Eliasson
Impact
critical
##### Description

A crash triggerable by web content in which an `ErrorResult` references unassigned memory due to a logic error. The resulting crash may be exploitable.

##### References

* [Bug 1328861](https://bugzilla.mozilla.org/show_bug.cgi?id=1328861)

#### [#CVE-2017-5402: Use-after-free working with events in FontFace objects](#CVE-2017-5402)

Reporter
Nils
Impact
critical
##### Description

A use-after-free can occur when events are fired for a `FontFace` object after the object has been already been destroyed while working with fonts. This results in a potentially exploitable crash.

##### References

* [Bug 1334876](https://bugzilla.mozilla.org/show_bug.cgi?id=1334876)

#### [#CVE-2017-5403: Use-after-free using addRange to add range to an incorrect root object](#CVE-2017-5403)

Reporter
Nils
Impact
critical
##### Description

When adding a range to an object in the DOM, it is possible to use `addRange` to add the range to an incorrect root object. This triggers a use-after-free, resulting in a potentially exploitable crash.

##### References

* [Bug 1340186](https://bugzilla.mozilla.org/show_bug.cgi?id=1340186)

#### [#CVE-2017-5404: Use-after-free working with ranges in selections](#CVE-2017-5404)

Reporter
Ivan Fratric of Google Project Zero
Impact
critical
##### Description

A use-after-free error can occur when manipulating ranges in selections with one node inside a native anonymous tree and one node outside of it. This results in a potentially exploitable crash.

##### References

* [Bug 1340138](https://bugzilla.mozilla.org/show_bug.cgi?id=1340138)

#### [#CVE-2017-5406: Segmentation fault in Skia with canvas operations](#CVE-2017-5406)

Reporter
Atte Kettunen
Impact
high
##### Description

A segmentation fault can occur in the Skia graphics library during some canvas operations due to issues with mask/clip intersection and empty masks.

##### References

* [Bug 1306890](https://bugzilla.mozilla.org/show_bug.cgi?id=1306890)

#### [#CVE-2017-5407: Pixel and history stealing via floating-point timing side channel with SVG filters](#CVE-2017-5407)

Reporter
David Kohlbrenner
Impact
high
##### Description

Using SVG filters that don't use the fixed point math implementation on a target iframe, a malicious page can extract pixel values from a targeted user. This can be used to extract history information and read text values across domains. This violates same-origin policy and leads to information disclosure.

##### References

* [Bug 1336622](https://bugzilla.mozilla.org/show_bug.cgi?id=1336622)

#### [#CVE-2017-5410: Memory corruption during JavaScript garbage collection incremental sweeping](#CVE-2017-5410)

Reporter
Jerri Rice
Impact
high
##### Description

Memory corruption resulting in a potentially exploitable crash during garbage collection of JavaScript due errors in how incremental sweeping is managed for memory cleanup.

##### References

* [Bug 1330687](https://bugzilla.mozilla.org/show_bug.cgi?id=1330687)

#### [#CVE-2017-5411: Use-after-free in Buffer Storage in libGLES](#CVE-2017-5411)

Reporter
Looben Yang
Impact
high
##### Description

A use-after-free can occur during buffer storage operations within the ANGLE graphics library, used for WebGL content. The buffer storage can be freed while still in use in some circumstances, leading to a potentially exploitable crash.
*Note: This issue is in `libGLES`, which is only in use on Windows. Other operating systems are not affected.*

##### References

* [Bug 1325511](https://bugzilla.mozilla.org/show_bug.cgi?id=1325511)

#### [#CVE-2017-5408: Cross-origin reading of video captions in violation of CORS](#CVE-2017-5408)

Reporter
Eric Lawrence of Chrome Security
Impact
moderate
##### Description

Video files loaded video captions cross-origin without checking for the presence of CORS headers permitting such cross-origin use, leading to potential information disclosure for video captions.

##### References

* [Bug 1313711](https://bugzilla.mozilla.org/show_bug.cgi?id=1313711)

#### [#CVE-2017-5412: Buffer overflow read in SVG filters](#CVE-2017-5412)

Reporter
Atte Kettunen
Impact
moderate
##### Description

A buffer overflow read during SVG filter color value operations, resulting in data exposure.

##### References

* [Bug 1328323](https://bugzilla.mozilla.org/show_bug.cgi?id=1328323)

#### [#CVE-2017-5413: Segmentation fault during bidirectional operations](#CVE-2017-5413)

Reporter
Atte Kettunen
Impact
moderate
##### Description

A segmentation fault can occur during some bidirectional layout operations.

##### References

* [Bug 1337504](https://bugzilla.mozilla.org/show_bug.cgi?id=1337504)

#### [#CVE-2017-5414: File picker can choose incorrect default directory](#CVE-2017-5414)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

The file picker dialog can choose and display the wrong local default directory when instantiated. On some operating systems, this can lead to information disclosure, such as the operating system or the local account name.

##### References

* [Bug 1319370](https://bugzilla.mozilla.org/show_bug.cgi?id=1319370)

#### [#CVE-2017-5416: Null dereference crash in HttpChannel](#CVE-2017-5416)

Reporter
Radek 'sysKin' Czyz
Impact
moderate
##### Description

In certain circumstances a networking event listener can be prematurely released. This appears to result in a null dereference in practice.

##### References

* [Bug 1328121](https://bugzilla.mozilla.org/show_bug.cgi?id=1328121)

#### [#CVE-2017-5425: Overly permissive Gecko Media Plugin sandbox regular expression access](#CVE-2017-5425)

Reporter
Haik Aftandilian
Impact
moderate
##### Description

The Gecko Media Plugin sandbox allows access to local files that match specific regular expressions. On OS OX, this matching allows access to some data in subdirectories of `/private/var` that could expose personal or temporary data. This has been updated to not allow access to `/private/var` and its subdirectories.
*Note: this issue only affects OS X. Other operating systems are not affected.*

##### References

* [Bug 1322716](https://bugzilla.mozilla.org/show_bug.cgi?id=1322716)

#### [#CVE-2017-5426: Gecko Media Plugin sandbox is not started if seccomp-bpf filter is running](#CVE-2017-5426)

Reporter
Jed Davis
Impact
moderate
##### Description

On Linux, if the secure computing mode BPF (seccomp-bpf) filter is running when the Gecko Media Plugin sandbox is started, the sandbox fails to be applied and items that would run within the sandbox are run protected only by the running filter which is typically weak compared to the sandbox.
*Note: this issue only affects Linux. Other operating systems are not affected.*

##### References

* [Bug 1257361](https://bugzilla.mozilla.org/show_bug.cgi?id=1257361)

#### [#CVE-2017-5418: Out of bounds read when parsing HTTP digest authorization responses](#CVE-2017-5418)

Reporter
Anonymous
Impact
low
##### Description

An out of bounds read error occurs when parsing some HTTP digest authorization responses, resulting in information leakage through the reading of random memory containing matches to specifically set patterns.

##### References

* [Bug 1338876](https://bugzilla.mozilla.org/show_bug.cgi?id=1338876)

#### [#CVE-2017-5419: Repeated authentication prompts lead to DOS attack](#CVE-2017-5419)

Reporter
Chris Hamono
Impact
low
##### Description

If a malicious site repeatedly triggers a modal authentication prompt, eventually the browser UI will become non-responsive, requiring shutdown through the operating system. This is a denial of service (DOS) attack.

##### References

* [Bug 1312243](https://bugzilla.mozilla.org/show_bug.cgi?id=1312243)

#### [#CVE-2017-5405: FTP response codes can cause use of uninitialized values for ports](#CVE-2017-5405)

Reporter
Anonymous
Impact
low
##### Description

Certain response codes in FTP connections can result in the use of uninitialized values for ports in FTP operations.

##### References

* [Bug 1336699](https://bugzilla.mozilla.org/show_bug.cgi?id=1336699)

#### [#CVE-2017-5421: Print preview spoofing](#CVE-2017-5421)

Reporter
Abdulrahman Alqabandi
Impact
low
##### Description

A malicious site could spoof the contents of the print preview window if popup windows are enabled, resulting in user confusion of what site is currently loaded.

##### References

* [Bug 1301876](https://bugzilla.mozilla.org/show_bug.cgi?id=1301876)

#### [#CVE-2017-5422: DOS attack by using view-source: protocol repeatedly in one hyperlink](#CVE-2017-5422)

Reporter
Alex Bolton
Impact
low
##### Description

If a malicious site uses the `view-source:` protocol in a series within a single hyperlink, it can trigger a non-exploitable browser crash when the hyperlink is selected. This was fixed by no longer making `view-source:` linkable.

##### References

* [Bug 1295002](https://bugzilla.mozilla.org/show_bug.cgi?id=1295002)

#### [#CVE-2017-5399: Memory safety bugs fixed in Thunderbird 52](#CVE-2017-5399)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Carsten Book, Calixte Denizet, Christian Holler, Andrew McCreight, David Bolter, David Keeler, Jon Coppeard, Tyson Smith, Ronald Crane, Tooru Fujisawa, Ben Kelly, Bob Owen, Jed Davis, Julian Seward, Julian Hector, Philipp, Markus Stange, and André Bargull reported memory safety bugs present in Firefox 51. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 52](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1332569%2C1315248%2C1261335%2C1321038%2C1331771%2C1339566%2C1339591%2C1240893%2C1341905%2C1323241%2C1336467%2C1270288%2C1295299%2C1296024%2C1304201%2C1306142%2C1307557%2C1308036%2C1334246%2C1334290%2C1317085%2C1339116%2C1324000%2C1323150%2C1332501%2C1320894%2C1333752%2C1303713%2C1321566%2C1264053%2C1343513)

#### [#CVE-2017-5398: Memory safety bugs fixed in Thunderbird 52 and Thunderbird 45.8](#CVE-2017-5398)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Boris Zbarsky, Christian Holler, Honza Bambas, Jon Coppeard, Randell Jesup, André Bargull, Kan-Ru Chen, and Nathan Froyd reported memory safety bugs present in Firefox 51 and Firefox ESR 45.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 52 and Thunderbird ESR 45.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1332550%2C1332597%2C1338383%2C1321612%2C1322971%2C1333568%2C1333887%2C1335450%2C1325052%2C1324379%2C1336510)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_3659d679_20250126_040659.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_6daa1d31_20250126_040658.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1336699)
* [XML](/show_bug.cgi?ctype=xml&id=1336699)

Closed
[Bug 1336699](/show_bug.cgi?id=1336699)
(CVE-2017-5405)

Opened 8 years ago
Closed 8 years ago

# Uninitialized value in nsFtpState::R\_pasv

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Uninitialized value in nsFtpState::R\_pasv

## Categories

### (Core Graveyard :: Networking: FTP, defect)

[Product:](/describecomponents.cgi?product=Core%20Graveyard)

Core Graveyard
▾

Core Graveyard
Old, retired Core components
[See Open Bugs in This Product](/buglist.cgi?product=Core%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Core%20Graveyard&component=Networking%3A%20FTP#Networking%3A%20FTP)

Networking: FTP
▾

Core Graveyard :: Networking: FTP
For bugs in Mozilla's FTP code. This component deals with FTP specific issues like downloading, directory formats, problems with FTP login, or resuming partial downloads, etc.

Examples of appropriate bugs- Problems with multiple occurrences of files in directory listings, corruption in downloading certain files via FTP, etc.

[See Open Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Networking%3A%20FTP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Networking%3A%20FTP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core%20Graveyard&component=Networking%3A%20FTP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

51 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (firefox-esr4552+ fixed, firefox51 wontfix, firefox52+ fixed, firefox-esr5252+ fixed, firefox53+ fixed, firefox54+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla54

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 | [52+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=52%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) |
| firefox51 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=wontfix) |
| firefox52 | [+](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed) |
| firefox-esr52 | [52+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=52%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed) |
| firefox53 | [+](/buglist.cgi?f1=cf_tracking_firefox53&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=fixed) |
| firefox54 | [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 | 52+ | fixed |
| firefox51 |  | wontfix |
| firefox52 | + | fixed |
| firefox-esr52 | 52+ | fixed |
| firefox53 | + | fixed |
| firefox54 | + | fixed |

## People

### (Reporter: chamal.desilva, Assigned: mcmanus)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2b0de973c803f192309b00777c594202?d=mm&size=40)  [mcmanus](/user_profile?user_id=32546)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/045351dbdb09c499196f603aec95e066?d=mm&size=40)  [chamal.desilva](/user_profile?user_id=389972)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/380d527ca6afdc48f587c6e5b8c56143?d=mm&size=40)  [edgul](/user_profile?user_id=701256)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uninitialized, sec-low, Whiteboard: [post-critsmash-triage][necko-active][adv-main52+][adv-esr45.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2017-5405

[Keywords:](/describekeywords.cgi)

[csectype-uninitialized](/buglist.cgi?keywords=csectype-uninitialized&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][necko-active][adv-main52+][adv-esr45.8+]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [kjozwiak](/user_profile?user_id=455785) | [qe-verify](#a1776240_455785 "8 years ago") | + |
| --- | --- | --- |
| [kjozwiak](/user_profile?user_id=455785) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Server.cpp](/attachment.cgi?id=8833601)  [8 years ago](#c0)  [Chamal De Silva](/user_profile?user_id=389972)   2.64 KB, text/plain |  | [Details](/attachment.cgi?id=8833601&action=edit) |
| --- | --- | --- |
| [scanf has signed return value](/attachment.cgi?id=8835023)  [8 years ago](#c4)  [Patrick McManus [:mcmanus]](/user_profile?user_id=32546)   1.16 KB, patch | dragana : [review+](#a389797_508195 "8 years ago")  jcristau : [approval-mozilla-aurora+](#c11 "8 years ago")  jcristau : [approval-mozilla-beta+](#c11 "8 years ago")  gchang : [approval-mozilla-esr45+](#c13 "8 years ago")  abillings : [sec-approval+](#a408294_280903 "8 years ago") | [Details](/attachment.cgi?id=8835023&action=edit) | [Diff](/attachment.cgi?id=8835023&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1336699&attachment=8835023) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Chamal De Silva](/user_profile?user_id=389972)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1336699#c0)• 8 years ago |
|  | |

Attached file
[Server.cpp](attachment.cgi?id=8833601)
— [Details](attachment.cgi?id=8833601&action=edit)

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36
Steps to reproduce:
1. Build Firefox with valgrind.
I built with options and instructions mentioned in
<https://developer.mozilla.org/en-US/docs/Mozilla/Testing/Valgrind>
2. Start firefox
export VALGRIND\_OPTIONS="--smc-check=all-non-file --vex-iropt-register-updates=allregs-at-mem-access --show-mismatched-frees=no --read-inline-info=yes"
./mach run --debugger="valgrind" --debugger-args="$VALGRIND\_OPTIONS"
3. Download and compile Server.cpp on a Linux machine.
g++ -w -o Server Server.cpp
4. Start the server on port 21.
sudo ./Server
5. Visit ftp://127.0.0.1
Actual results:
Valgrind will display.
==28235== Conditional jump or move depends on uninitialised value(s)
==28235== at 0xFECEB36: mozilla::net::nsSocketTransportService::CreateRoutedTransport(char const\*\*, unsigned int, nsACString\_internal const&, int, nsACString\_internal const&, int, nsIProxyInfo\*, nsISocketTransport\*\*) (nsSocketTransportService2.cpp:741)
==28235== by 0xFECEC85: mozilla::net::nsSocketTransportService::CreateTransport(char const\*\*, unsigned int, nsACString\_internal const&, int, nsIProxyInfo\*, nsISocketTransport\*\*) (nsSocketTransportService2.cpp:713)
==28235== by 0x101455F7: nsFtpState::R\_pasv() [clone .part.108] [clone .constprop.145] (nsFtpConnectionThread.cpp:1501)
==28235== by 0x1014EDC7: R\_pasv (nsFtpConnectionThread.cpp:526)
==28235== by 0x1014EDC7: nsFtpState::Process() (nsFtpConnectionThread.cpp:632)
==28235== by 0x1014F422: nsFtpState::OnControlDataAvailable(char const\*, unsigned int) (nsFtpConnectionThread.cpp:221)
==28235== by 0x10142E17: nsFtpControlConnection::OnInputStreamReady(nsIAsyncInputStream\*) (nsFtpControlConnection.cpp:61)
==28235== by 0xFDF2333: nsInputStreamReadyEvent::Run() (nsStreamUtils.cpp:96)
...
Expected results:
Uninitialized value should not be used.

|  | [Chamal De Silva](/user_profile?user_id=389972)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1336699#c1)• 8 years ago |
|  | |

Cause of Bug
------------
Bug is present in R\_pasv method of netwerk\protocol\ftp\nsFtpConnectionThread.cpp file.
FTP response of "200 (\r\n" to R\_pasv method causes unitialized value in "int32\_t p0".
"p0" variable is later used to calculate "int32\_t port".
Below mentioned line in R\_pasv method is the cause of this bug.
fields = PR\_sscanf(ptr,"%ld,%ld,%ld,%ld,%ld,%ld",
&h0, &h1, &h2, &h3, &p0, &p1);
fields is uint32\_t type variable. PR\_sscanf method returns -1 on error conditions.
So fields variable become 4294967295 when PR\_sscanf method return -1.
This causes below mentioned if condition in R\_pasv method to fail.
if (fields < 6)
return FTP\_ERROR;

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1336699#c2)• 8 years ago |
|  | |

Flagging :mcmanus for triage / prioritization. :-)Group: firefox-core-security → core-securityComponent: Untriaged → Networking: FTPFlags: needinfo?(mcmanus)Product: Firefox → Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a218131_1689)• 8 years ago |

Group: core-security → network-core-security

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1336699#c3)• 8 years ago |
|  | |

this is a great bug report chamal - thank you.Flags: needinfo?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a385382_32546)• 8 years ago |

Keywords: [csectype-uninitialized](/buglist.cgi?keywords=csectype-uninitialized&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1336699#c4)• 8 years ago |
|  | |

Attached patch

[scanf has signed return value](attachment.cgi?id=8835023&action=diff)
— [Details](attachment.cgi?id=8835023&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1336699&attachment=8835023)

[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: review?(dd.mozilla)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a385730_32546)• 8 years ago |

Assignee: nobody → mcmanusStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a389797_508195)• 8 years ago |

[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: review?(dd.mozilla) → review+

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1336699#c5)• 8 years ago |
|  | |

Comment on [attachment 8835023](/attachment.cgi?id=8835023 "scanf has signed return value") [[details]](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") [[diff]](/attachment.cgi?id=8835023&action=diff "scanf has signed return value") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1336699&attachment=8835023)
scanf has signed return value
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
easily.. though its not clear how serious of an exploit you could manage. it looks you can trigger a connection to some host defined by unitialized contents of the stack
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
its pretty clear
Which older supported branches are affected by this flaw?
all
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
they will be the same - this is static code effectively
How likely is this patch to cause regressions; how much testing does it need?
insignificant regression risk
[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1336699#c6)• 8 years ago |
|  | |

sec-approval+ for trunk.
We should get branch patches nominated for Aurora, Beta, and ESR45 as well.
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=wontfix)
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected)
[status-firefox53](/buglist.cgi?f1=cf_status_firefox53&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=affected)
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox52](/buglist.cgi?f1=cf_tracking_firefox52&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%2B)
[tracking-firefox53](/buglist.cgi?f1=cf_tracking_firefox53&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox53&o1=equals&v1=%2B)
[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- → [52+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=52%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a408294_280903)• 8 years ago |

[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: sec-approval? → sec-approval+

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a453335_508195)• 8 years ago |

Whiteboard: [necko-active]

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1336699#c7)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/d6f4704c8718ba919b794d3ebc84165839836f03>
[Bug 1336699](/show_bug.cgi?id=1336699 "RESOLVED FIXED - Uninitialized value in nsFtpState::R_pasv") - scanf has signed return value r=dragana

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1336699#c8)• 8 years ago |
|  | |

Comment on [attachment 8835023](/attachment.cgi?id=8835023 "scanf has signed return value") [[details]](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") [[diff]](/attachment.cgi?id=8835023&action=diff "scanf has signed return value") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1336699&attachment=8835023)
scanf has signed return value
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
na
User impact if declined: exploit would be to open a new connection via PASV to some location unintialized from stack (so stack leak, and stray connection).
Fix Landed on Version: 54
Risk to taking this patch (and alternatives if risky): very low risk located to ftp client code
String or UUID changes made by this patch: none
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
Approval Request Comment
[Feature/Bug causing the regression]: latent forever bug
[User impact if declined]: see above
[Is this code covered by automated tests?]: no
[Has the fix been verified in Nightly?]: hand tested
[Needs manual test from QE? If yes, steps to reproduce]: no
[List of other uplifts needed for the feature/fix]: none
[Is the change risky?]: no
[Why is the change risky/not risky?]: one line with local scope
[String changes made/needed]: none
[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: approval-mozilla-esr45?
[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: approval-mozilla-beta?
[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: approval-mozilla-aurora?

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1336699#c9)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/d6f4704c8718>Status: ASSIGNED → RESOLVEDClosed: 8 years ago
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla54

|  | [Chamal De Silva](/user_profile?user_id=389972)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1336699#c10)• 8 years ago |
|  | |

Hi Patrick, I think it is not possible to trigger a connection to another host.
Integer variables h0, h1, h2 and h3 in below line are not used later.
fields = PR\_sscanf(ptr,"%ld,%ld,%ld,%ld,%ld,%ld",&h0, &h1, &h2, &h3, &p0, &p1);
Only p0 and p1 integers are later used to calculate port.

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1336699#c11)• 8 years ago |
|  | |

Comment on [attachment 8835023](/attachment.cgi?id=8835023 "scanf has signed return value") [[details]](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") [[diff]](/attachment.cgi?id=8835023&action=diff "scanf has signed return value") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1336699&attachment=8835023)
scanf has signed return value
signed vs unsigned confusion in ftp pasv response parsing, for aurora53 and beta52
[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: approval-mozilla-beta?
[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: approval-mozilla-beta+
[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: approval-mozilla-aurora?
[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: approval-mozilla-aurora+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1336699#c12)• 8 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/f33a97693508>
<https://hg.mozilla.org/releases/mozilla-beta/rev/ae84530a2103>
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed)
[status-firefox53](/buglist.cgi?f1=cf_status_firefox53&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=fixed)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a575353_1689)• 8 years ago |

Group: network-core-security → core-security-release

|  | [Gerry Chang [:gchang]](/user_profile?user_id=506302) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1336699#c13)• 8 years ago |
|  | |

Comment on [attachment 8835023](/attachment.cgi?id=8835023 "scanf has signed return value") [[details]](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") [[diff]](/attachment.cgi?id=8835023&action=diff "scanf has signed return value") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1336699&attachment=8835023)
scanf has signed return value
Fix a sec-high. ESR45+.
[Attachment #8835023](/attachment.cgi?id=8835023&action=edit "scanf has signed return value") -
Flags: approval-mozilla-esr45? → approval-mozilla-esr45+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1336699#c14)• 8 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr45/rev/381552c888b4>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1336699#c15)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr52/rev/ae84530a2103>
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a1776240_455785)• 8 years ago |

Flags: qe-verify+Whiteboard: [necko-active] → [post-critsmash-triage][necko-active]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a2031287_280903)• 8 years ago |

[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F) → [52+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=52%2B)Whiteboard: [post-critsmash-triage][necko-active] → [post-critsmash-triage][necko-active][adv-main52+][adv-esr48.8+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a2136262_280903)• 8 years ago |

Whiteboard: [post-critsmash-triage][necko-active][adv-main52+][adv-esr48.8+] → [post-critsmash-triage][necko-active][adv-main52+][adv-esr45.8+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a2204853_280903)• 8 years ago |

Alias: CVE-2017-5405

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1336699#c16)• 8 years ago |
|  | |

(In reply to Chamal from [comment #10](/show_bug.cgi?id=1336699#c10 "RESOLVED FIXED - Uninitialized value in nsFtpState::R_pasv"))
> Hi Patrick, I think it is not possible to trigger a connection to another
> host.
> Integer variables h0, h1, h2 and h3 in below line are not used later.
>
> fields = PR\_sscanf(ptr,"%ld,%ld,%ld,%ld,%ld,%ld",&h0, &h1, &h2, &h3, &p0,
> &p1);
>
> Only p0 and p1 integers are later used to calculate port.
Patrick, is this correct or is it possible to trigger a connection? I need to know for the advisory.Flags: needinfo?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1336699#c17)• 8 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #16](/show_bug.cgi?id=1336699#c16 "RESOLVED FIXED - Uninitialized value in nsFtpState::R_pasv"))
> (In reply to Chamal from [comment #10](/show_bug.cgi?id=1336699#c10 "RESOLVED FIXED - Uninitialized value in nsFtpState::R_pasv"))
> > Hi Patrick, I think it is not possible to trigger a connection to another
> > host.
> > Integer variables h0, h1, h2 and h3 in below line are not used later.
> >
> > fields = PR\_sscanf(ptr,"%ld,%ld,%ld,%ld,%ld,%ld",&h0, &h1, &h2, &h3, &p0,
> > &p1);
> >
> > Only p0 and p1 integers are later used to calculate port.
>
> Patrick, is this correct or is it possible to trigger a connection? I need
> to know for the advisory.
reporter is correct - its just the port number.Flags: needinfo?(mcmanus)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a2297471_1689)• 8 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a22875045_1689)• 7 years ago |

Group: core-security-release

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1336699#a221256738_546015)• 1 year ago |

Product: Core → Core Graveyard
You need to [log in](/show_bug.cgi?id=1336699&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Chamal De Silva](/user_profile?user_id=389972)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_087ffa14_20250124_222946.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2017-05

## Security vulnerabilities fixed in Firefox 52

Announced
March 7, 2017
Impact
critical
Products
Firefox
Fixed in

* Firefox 52

#### [#CVE-2017-5400: asm.js JIT-spray bypass of ASLR and DEP](#CVE-2017-5400)

Reporter
Rh0
Impact
critical
##### Description

JIT-spray targeting asm.js combined with a heap spray allows for a bypass of ASLR and DEP protections leading to potential memory corruption attacks.

##### References

* [Bug 1334933](https://bugzilla.mozilla.org/show_bug.cgi?id=1334933)

#### [#CVE-2017-5401: Memory Corruption when handling ErrorResult](#CVE-2017-5401)

Reporter
Anton Eliasson
Impact
critical
##### Description

A crash triggerable by web content in which an `ErrorResult` references unassigned memory due to a logic error. The resulting crash may be exploitable.

##### References

* [Bug 1328861](https://bugzilla.mozilla.org/show_bug.cgi?id=1328861)

#### [#CVE-2017-5402: Use-after-free working with events in FontFace objects](#CVE-2017-5402)

Reporter
Nils
Impact
critical
##### Description

A use-after-free can occur when events are fired for a `FontFace` object after the object has been already been destroyed while working with fonts. This results in a potentially exploitable crash.

##### References

* [Bug 1334876](https://bugzilla.mozilla.org/show_bug.cgi?id=1334876)

#### [#CVE-2017-5403: Use-after-free using addRange to add range to an incorrect root object](#CVE-2017-5403)

Reporter
Nils
Impact
critical
##### Description

When adding a range to an object in the DOM, it is possible to use `addRange` to add the range to an incorrect root object. This triggers a use-after-free, resulting in a potentially exploitable crash.

##### References

* [Bug 1340186](https://bugzilla.mozilla.org/show_bug.cgi?id=1340186)

#### [#CVE-2017-5404: Use-after-free working with ranges in selections](#CVE-2017-5404)

Reporter
Ivan Fratric of Google Project Zero
Impact
critical
##### Description

A use-after-free error can occur when manipulating ranges in selections with one node inside a native anonymous tree and one node outside of it. This results in a potentially exploitable crash.

##### References

* [Bug 1340138](https://bugzilla.mozilla.org/show_bug.cgi?id=1340138)

#### [#CVE-2017-5406: Segmentation fault in Skia with canvas operations](#CVE-2017-5406)

Reporter
Atte Kettunen
Impact
high
##### Description

A segmentation fault can occur in the Skia graphics library during some canvas operations due to issues with mask/clip intersection and empty masks.

##### References

* [Bug 1306890](https://bugzilla.mozilla.org/show_bug.cgi?id=1306890)

#### [#CVE-2017-5407: Pixel and history stealing via floating-point timing side channel with SVG filters](#CVE-2017-5407)

Reporter
David Kohlbrenner
Impact
high
##### Description

Using SVG filters that don't use the fixed point math implementation on a target iframe, a malicious page can extract pixel values from a targeted user. This can be used to extract history information and read text values across domains. This violates same-origin policy and leads to information disclosure.

##### References

* [Bug 1336622](https://bugzilla.mozilla.org/show_bug.cgi?id=1336622)

#### [#CVE-2017-5410: Memory corruption during JavaScript garbage collection incremental sweeping](#CVE-2017-5410)

Reporter
Jerri Rice
Impact
high
##### Description

Memory corruption resulting in a potentially exploitable crash during garbage collection of JavaScript due errors in how incremental sweeping is managed for memory cleanup.

##### References

* [Bug 1330687](https://bugzilla.mozilla.org/show_bug.cgi?id=1330687)

#### [#CVE-2017-5411: Use-after-free in Buffer Storage in libGLES](#CVE-2017-5411)

Reporter
Looben Yang
Impact
high
##### Description

A use-after-free can occur during buffer storage operations within the ANGLE graphics library, used for WebGL content. The buffer storage can be freed while still in use in some circumstances, leading to a potentially exploitable crash.
*Note: This issue is in `libGLES`, which is only in use on Windows. Other operating systems are not affected.*

##### References

* [Bug 1325511](https://bugzilla.mozilla.org/show_bug.cgi?id=1325511)

#### [#CVE-2017-5409: File deletion via callback parameter in Mozilla Windows Updater and Maintenance Service](#CVE-2017-5409)

Reporter
Holger Fuhrmannek
Impact
moderate
##### Description

The Mozilla Windows updater can be called by a non-privileged user to delete an arbitrary local file by passing a special path to the callback parameter through the Mozilla Maintenance Service, which has privileged access.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1321814](https://bugzilla.mozilla.org/show_bug.cgi?id=1321814)

#### [#CVE-2017-5408: Cross-origin reading of video captions in violation of CORS](#CVE-2017-5408)

Reporter
Eric Lawrence of Chrome Security
Impact
moderate
##### Description

Video files loaded video captions cross-origin without checking for the presence of CORS headers permitting such cross-origin use, leading to potential information disclosure for video captions.

##### References

* [Bug 1313711](https://bugzilla.mozilla.org/show_bug.cgi?id=1313711)

#### [#CVE-2017-5412: Buffer overflow read in SVG filters](#CVE-2017-5412)

Reporter
Atte Kettunen
Impact
moderate
##### Description

A buffer overflow read during SVG filter color value operations, resulting in data exposure.

##### References

* [Bug 1328323](https://bugzilla.mozilla.org/show_bug.cgi?id=1328323)

#### [#CVE-2017-5413: Segmentation fault during bidirectional operations](#CVE-2017-5413)

Reporter
Atte Kettunen
Impact
moderate
##### Description

A segmentation fault can occur during some bidirectional layout operations.

##### References

* [Bug 1337504](https://bugzilla.mozilla.org/show_bug.cgi?id=1337504)

#### [#CVE-2017-5414: File picker can choose incorrect default directory](#CVE-2017-5414)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

The file picker dialog can choose and display the wrong local default directory when instantiated. On some operating systems, this can lead to information disclosure, such as the operating system or the local account name.

##### References

* [Bug 1319370](https://bugzilla.mozilla.org/show_bug.cgi?id=1319370)

#### [#CVE-2017-5415: Addressbar spoofing through blob URL](#CVE-2017-5415)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

An attack can use a blob URL and script to spoof an arbitrary addressbar URL prefaced by `blob:` as the protocol, leading to user confusion and further spoofing attacks.

##### References

* [Bug 1321719](https://bugzilla.mozilla.org/show_bug.cgi?id=1321719)

#### [#CVE-2017-5416: Null dereference crash in HttpChannel](#CVE-2017-5416)

Reporter
Radek 'sysKin' Czyz
Impact
moderate
##### Description

In certain circumstances a networking event listener can be prematurely released. This appears to result in a null dereference in practice.

##### References

* [Bug 1328121](https://bugzilla.mozilla.org/show_bug.cgi?id=1328121)

#### [#CVE-2017-5417: Addressbar spoofing by draging and dropping URLs](#CVE-2017-5417)

Reporter
Michal Zalewski
Impact
moderate
##### Description

When dragging content from the primary browser pane to the addressbar on a malicious site, it is possible to change the addressbar so that the displayed location following navigation does not match the URL of the newly loaded page. This allows for spoofing attacks.

##### References

* [Bug 791597](https://bugzilla.mozilla.org/show_bug.cgi?id=791597)

#### [#CVE-2017-5425: Overly permissive Gecko Media Plugin sandbox regular expression access](#CVE-2017-5425)

Reporter
Haik Aftandilian
Impact
moderate
##### Description

The Gecko Media Plugin sandbox allows access to local files that match specific regular expressions. On OS OX, this matching allows access to some data in subdirectories of `/private/var` that could expose personal or temporary data. This has been updated to not allow access to `/private/var` and its subdirectories.
*Note: this issue only affects OS X. Other operating systems are not affected.*

##### References

* [Bug 1322716](https://bugzilla.mozilla.org/show_bug.cgi?id=1322716)

#### [#CVE-2017-5426: Gecko Media Plugin sandbox is not started if seccomp-bpf filter is running](#CVE-2017-5426)

Reporter
Jed Davis
Impact
moderate
##### Description

On Linux, if the secure computing mode BPF (seccomp-bpf) filter is running when the Gecko Media Plugin sandbox is started, the sandbox fails to be applied and items that would run within the sandbox are run protected only by the running filter which is typically weak compared to the sandbox.
*Note: this issue only affects Linux. Other operating systems are not affected.*

##### References

* [Bug 1257361](https://bugzilla.mozilla.org/show_bug.cgi?id=1257361)

#### [#CVE-2017-5427: Non-existent chrome.manifest file loaded during startup](#CVE-2017-5427)

Reporter
Mike Kaply
Impact
moderate
##### Description

A non-existent chrome.manifest file will attempt to be loaded during startup from the primary installation directory. If a malicious user with local access puts chrome.manifest and other referenced files in this directory, they will be loaded and activated during startup. This could result in malicious software being added without consent or modification of referenced installed files.

##### References

* [Bug 1295542](https://bugzilla.mozilla.org/show_bug.cgi?id=1295542)

#### [#CVE-2017-5418: Out of bounds read when parsing HTTP digest authorization responses](#CVE-2017-5418)

Reporter
Anonymous
Impact
low
##### Description

An out of bounds read error occurs when parsing some HTTP digest authorization responses, resulting in information leakage through the reading of random memory containing matches to specifically set patterns.

##### References

* [Bug 1338876](https://bugzilla.mozilla.org/show_bug.cgi?id=1338876)

#### [#CVE-2017-5419: Repeated authentication prompts lead to DOS attack](#CVE-2017-5419)

Reporter
Chris Hamono
Impact
low
##### Description

If a malicious site repeatedly triggers a modal authentication prompt, eventually the browser UI will become non-responsive, requiring shutdown through the operating system. This is a denial of service (DOS) attack.

##### References

* [Bug 1312243](https://bugzilla.mozilla.org/show_bug.cgi?id=1312243)

#### [#CVE-2017-5420: Javascript: URLs can obfuscate addressbar location](#CVE-2017-5420)

Reporter
Abdulrahman Alqabandi
Impact
low
##### Description

A `javascript:` url loaded by a malicious page can obfuscate its location by blanking the URL displayed in the addressbar, allowing for an attacker to spoof an existing page without the malicious page's address being displayed correctly.

##### References

* [Bug 1284395](https://bugzilla.mozilla.org/show_bug.cgi?id=1284395)

#### [#CVE-2017-5405: FTP response codes can cause use of uninitialized values for ports](#CVE-2017-5405)

Reporter
Anonymous
Impact
low
##### Description

Certain response codes in FTP connections can result in the use of uninitialized values for ports in FTP operations.

##### References

* [Bug 1336699](https://bugzilla.mozilla.org/show_bug.cgi?id=1336699)

#### [#CVE-2017-5421: Print preview spoofing](#CVE-2017-5421)

Reporter
Abdulrahman Alqabandi
Impact
low
##### Description

A malicious site could spoof the contents of the print preview window if popup windows are enabled, resulting in user confusion of what site is currently loaded.

##### References

* [Bug 1301876](https://bugzilla.mozilla.org/show_bug.cgi?id=1301876)

#### [#CVE-2017-5422: DOS attack by using view-source: protocol repeatedly in one hyperlink](#CVE-2017-5422)

Reporter
Alex Bolton
Impact
low
##### Description

If a malicious site uses the `view-source:` protocol in a series within a single hyperlink, it can trigger a non-exploitable browser crash when the hyperlink is selected. This was fixed by no longer making `view-source:` linkable.

##### References

* [Bug 1295002](https://bugzilla.mozilla.org/show_bug.cgi?id=1295002)

#### [#CVE-2017-5399: Memory safety bugs fixed in Firefox 52](#CVE-2017-5399)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Carsten Book, Calixte Denizet, Christian Holler, Andrew McCreight, David Bolter, David Keeler, Jon Coppeard, Tyson Smith, Ronald Crane, Tooru Fujisawa, Ben Kelly, Bob Owen, Jed Davis, Julian Seward, Julian Hector, Philipp, Markus Stange, and André Bargull reported memory safety bugs present in Firefox 51. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 52](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1332569%2C1315248%2C1261335%2C1321038%2C1331771%2C1339566%2C1339591%2C1240893%2C1341905%2C1323241%2C1336467%2C1270288%2C1295299%2C1296024%2C1304201%2C1306142%2C1307557%2C1308036%2C1334246%2C1334290%2C1317085%2C1339116%2C1324000%2C1323150%2C1332501%2C1320894%2C1333752%2C1303713%2C1321566%2C1264053%2C1343513)

#### [#CVE-2017-5398: Memory safety bugs fixed in Firefox 52 and Firefox ESR 45.8](#CVE-2017-5398)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Boris Zbarsky, Christian Holler, Honza Bambas, Jon Coppeard, Randell Jesup, André Bargull, Kan-Ru Chen, and Nathan Froyd reported memory safety bugs present in Firefox 51 and Firefox ESR 45.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 52 and Firefox ESR 45.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1332550%2C1332597%2C1338383%2C1321612%2C1322971%2C1333568%2C1333887%2C1335450%2C1325052%2C1324379%2C1336510)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_73f8d6fa_20250126_040659.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_c4199852_20250124_222943.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1301876)
* [XML](/show_bug.cgi?ctype=xml&id=1301876)

Closed
[Bug 1301876](/show_bug.cgi?id=1301876)
(CVE-2017-5421)

Opened 8 years ago
Closed 8 years ago

# Print preview hijacking leads to potential spoof

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Print preview hijacking leads to potential spoof

## Categories

### (Core :: Print Preview, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Print%20Preview#Print%20Preview)

Print Preview
▾

Core :: Print Preview

Issues with layout and rendering a document in Print Preview mode. For problems in printed or PDF output that do not appear in Print Preview, see the Printing: Output component.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Print%20Preview&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Print%20Preview&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Print%20Preview)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

51 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla52

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox52 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox52 |  | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: qab, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=40)  [qab](/user_profile?user_id=550582)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jwatt](/user_profile?user_id=32767)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1306266](/show_bug.cgi?id=1306266 "RESOLVED FIXED - Write automated test for tab-switching using window.open (or external links?) while print preview opens up (bug 1301876)")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1301876&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1301876)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-spoof, sec-low, Whiteboard: [post-critsmash-triage][adv-main52+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2017-5421

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main52+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [kjozwiak](/user_profile?user_id=455785) | [qe-verify](#a14468160_455785 "8 years ago") | + |
| --- | --- | --- |
| [kjozwiak](/user_profile?user_id=455785) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 1 obsolete file)

| [PoC-print.html](/attachment.cgi?id=8790024)  [8 years ago](#c0)  [Abdulrahman Alqabandi](/user_profile?user_id=550582)   283 bytes, text/html |  | [Details](/attachment.cgi?id=8790024&action=edit) |
| --- | --- | --- |
| [Screenshot of the result](/attachment.cgi?id=8790025)  [8 years ago](#c1)  [Abdulrahman Alqabandi](/user_profile?user_id=550582)   27.25 KB, image/png |  | [Details](/attachment.cgi?id=8790025&action=edit) |
| [PoCImg2.png](/attachment.cgi?id=8790026)  [8 years ago](#c2)  [Abdulrahman Alqabandi](/user_profile?user_id=550582)   15.48 KB, image/png |  | [Details](/attachment.cgi?id=8790026&action=edit) |
| [Patch v0.1](/attachment.cgi?id=8790652)  [8 years ago](#c5)  [:Gijs (he/him)](/user_profile?user_id=159069)   3.50 KB, patch | mconley : [feedback+](#c15 "8 years ago") | [Details](/attachment.cgi?id=8790652&action=edit) | [Diff](/attachment.cgi?id=8790652&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8790652) |
| [Capture of Tweet](/attachment.cgi?id=8793530)  [8 years ago](#c17)  [Mike Conley (:mconley) (:⚙️)](/user_profile?user_id=403756)   155.99 KB, image/png |  | [Details](/attachment.cgi?id=8793530&action=edit) |
| [Patch v0.2](/attachment.cgi?id=8795764)  [8 years ago](#c21)  [:Gijs (he/him)](/user_profile?user_id=159069)   1.83 KB, patch | mconley : [review+](#c22 "8 years ago") | [Details](/attachment.cgi?id=8795764&action=edit) | [Diff](/attachment.cgi?id=8795764&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8795764) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1301876#c0)• 8 years ago |
|  | |

Attached file
[PoC-print.html](attachment.cgi?id=8790024)
— [Details](attachment.cgi?id=8790024&action=edit)

User Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.101 Safari/537.36
Firefox for Android
Steps to reproduce:
This requires popups to be allowed. If we open a url within onbeforeprint event, we can trick a victim into thinking theyre in a trusted website.
Open attached PoC and follow instructions.
Actual results:
We are able to hijack the print preview window with any HTML and javascript we like.
Expected results:
New content should have been blocked, as usually print preview has no javascript in it. But having these active contents might be a problem.

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1301876#a64_550582)• 8 years ago |

Group: firefox-core-security

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1301876#c1)• 8 years ago |
|  | |

Attached image
[Screenshot of the result](attachment.cgi?id=8790025)
— [Details](attachment.cgi?id=8790025&action=edit)

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1301876#c2)• 8 years ago |
|  | |

Attached image
[PoCImg2.png](attachment.cgi?id=8790026)
— [Details](attachment.cgi?id=8790026&action=edit)

In this screenshot, I used an image of a real google websites addressbar, which sells it even more.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1301876#c3)• 8 years ago |
|  | |

Olli, seeing as you recently looked at this stuff in [bug 1214805](/show_bug.cgi?id=1214805 "REOPENED - Navigation not working while printing (onafterprint)"), I'm guessing you might be the best person to look at what's going on here? I \*think\* navigation should be blocked here, not sure why it isn't.Group: firefox-core-security → core-securityComponent: Untriaged → Document NavigationFlags: needinfo?(bugs)Product: Firefox → Core

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1301876#c4)• 8 years ago |
|  | |

But the navigation doesn't happen on the window where beforeprint is dispatched.
And if any background tab opens a new window, it leads to this weird case.
FF UI shouldn't let other tabs to become the foreground tabs while showing pp.Component: Document Navigation → Print Preview

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1301876#c5)• 8 years ago |
|  | |

Attached patch

[Patch v0.1](attachment.cgi?id=8790652&action=diff) (obsolete)
— [Details](attachment.cgi?id=8790652&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8790652)

Jared, are you up for reviewing this? I'd ask Mike but he's not taking more reviews right now.Assignee: nobody → gijskruitbosch+bugsStatus: UNCONFIRMED → ASSIGNEDEver confirmed: trueFlags: needinfo?(bugs)
[Attachment #8790652](/attachment.cgi?id=8790652&action=edit "Patch v0.1") -
Flags: review?(jaws)

|  | [Jared Wein [:jaws] (please needinfo? me)](/user_profile?user_id=409754) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1301876#c6)• 8 years ago |
|  | |

Comment on [attachment 8790652](/attachment.cgi?id=8790652 "Patch v0.1") [[details]](/attachment.cgi?id=8790652&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8790652&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8790652)
Patch v0.1
Review of [attachment 8790652](/attachment.cgi?id=8790652 "Patch v0.1") [[details]](/attachment.cgi?id=8790652&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8790652&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8790652):
-----------------------------------------------------------------
::: browser/base/content/browser.js
@@ +3261,5 @@
> relatedBrowser: browser });
> gBrowser.selectedTab = this.\_printPreviewTab;
> + // NB: we do this here rather than in onEnter because when onEnter happens
> + // we could already have switched tabs (via either user or website actions).
> + gBrowser.tabSwitchingEnabled = false;
This is a bit scary how the comment describes this as being so racy. And what happens if entering print preview fails, does that mean tabbrowser is effectively broken as it won't allow any tab changes until Firefox is restarted?
::: browser/base/content/tabbrowser.xml
@@ +2978,5 @@
> <![CDATA[
> // Update the tab
> + if (this.tabSwitchingEnabled) {
> + this.mTabBox.selectedTab = val;
> + }
Is this right?
let a = b = 5;
Should `a` == 5 if we are unable to set `b` to 5? Or should `a` be set to the original value of `b`, thus `undefined` in this case.
Testing this in the JS Console, I did:
var d;
var c = d = (function() { throw 1; })();
and afterwards c == undefined as well as d == undefined.
Therefore, if we are unable to set `this.mTabBox.selectedTab` to val, then we should return `this.mTabBox.selectedTab` instead of val.
[Attachment #8790652](/attachment.cgi?id=8790652&action=edit "Patch v0.1") -
Flags: review?(jaws) → review-

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1301876#c7)• 8 years ago |
|  | |

(In reply to Jared Wein [:jaws] (please needinfo? me) from [comment #6](/show_bug.cgi?id=1301876#c6 "RESOLVED FIXED - Print preview hijacking leads to potential spoof"))
> Comment on [attachment 8790652](/attachment.cgi?id=8790652 "Patch v0.1") [[details]](/attachment.cgi?id=8790652&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8790652&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8790652)
> Patch v0.1
>
> Review of [attachment 8790652](/attachment.cgi?id=8790652 "Patch v0.1") [[details]](/attachment.cgi?id=8790652&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8790652&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8790652):
> -----------------------------------------------------------------
>
> ::: browser/base/content/browser.js
> @@ +3261,5 @@
> > relatedBrowser: browser });
> > gBrowser.selectedTab = this.\_printPreviewTab;
> > + // NB: we do this here rather than in onEnter because when onEnter happens
> > + // we could already have switched tabs (via either user or website actions).
> > + gBrowser.tabSwitchingEnabled = false;
>
> This is a bit scary how the comment describes this as being so racy.
Well, the current thing isn't racy, adding it in onEnter (which was the first thing I tried) would be racy.
> And
> what happens if entering print preview fails, does that mean tabbrowser is
> effectively broken as it won't allow any tab changes until Firefox is
> restarted?
AIUI onExit will always be called if this code runs, so I don't think that can happen. Mike would probably know for sure?
And I agree that's scary, but equally I don't see how else we're going to do this. We do want to actually block the navigations while in PP.
> ::: browser/base/content/tabbrowser.xml
> @@ +2978,5 @@
> > <![CDATA[
> > // Update the tab
> > + if (this.tabSwitchingEnabled) {
> > + this.mTabBox.selectedTab = val;
> > + }
>
> Is this right?
>
> let a = b = 5;
>
> Should `a` == 5 if we are unable to set `b` to 5? Or should `a` be set to
> the original value of `b`, thus `undefined` in this case.
>
> Testing this in the JS Console, I did:
> var d;
> var c = d = (function() { throw 1; })();
> and afterwards c == undefined as well as d == undefined.
>
> Therefore, if we are unable to set `this.mTabBox.selectedTab` to val, then
> we should return `this.mTabBox.selectedTab` instead of val.
TBH, I expect more code to fail if we do that than what the patch does. If code does:
let myTab = gBrowser.selectedTab = gBrowser.addTab(...);
do we really want myTab to now be the wrong reference?
(this pattern is pretty common in tests, see <http://searchfox.org/mozilla-central/search?q=%3D%20gBrowser.selectedTab%20%3D> , which makes me think add-ons might use it, too)Flags: needinfo?(jaws)

|  | [Jared Wein [:jaws] (please needinfo? me)](/user_profile?user_id=409754) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1301876#c8)• 8 years ago |
|  | |

(In reply to :Gijs Kruitbosch from [comment #7](/show_bug.cgi?id=1301876#c7 "RESOLVED FIXED - Print preview hijacking leads to potential spoof"))
> TBH, I expect more code to fail if we do that than what the patch does. If
> code does:
>
> let myTab = gBrowser.selectedTab = gBrowser.addTab(...);
>
> do we really want myTab to now be the wrong reference?
>
> (this pattern is pretty common in tests, see
> <http://searchfox.org/mozilla-central/search?q=%3D%20gBrowser>.
> selectedTab%20%3D , which makes me think add-ons might use it, too)
Right, which is why I thought it important to call out. I would prefer that we follow the standard way that assignment is implemented here. It's much easier to reason about than if we were to use some other behavior that isn't the norm.
I would like to think a little more about the onExit part first. I'll leave needinfo flag on the bug so I don't forget.

|  | [Jared Wein [:jaws] (please needinfo? me)](/user_profile?user_id=409754) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1301876#c9)• 8 years ago |
|  | |

I looked a little bit more in to this. I would like it if we could wrap the enter/exit with a try/finally and clear `tabSwitchingEnabled` in the finally, but we don't have a simple code path here. The code is mainly event based and looks to have entrances from multiple paths.
Mike, what do you think?Flags: needinfo?(jaws) → needinfo?(mconley)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1301876#c10)• 8 years ago |
|  | |

One other thing we could do, which I didn't realize until long after I wrote this patch, is somehow try to force the print preview browser to stay on top. AIUI we create a separate browser for the print preview. It's not clear to me why that browser gets moved out of view for the newly-focused tab. If the new browser was "always on top" as it were, we wouldn't have to mess with tab switching in the browser (though of course the user could then still end up on a different tab than where they started from, when closing print preview).

|  | [Mike Conley (:mconley) (:⚙️)](/user_profile?user_id=403756) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1301876#c11)• 8 years ago |
|  | |

I dunno - fixing this in the front-end feels like an end-of-pipe solution. Why would we even support calling window.open from within onbeforeprint? Can we check to see if we're in one of these event handlers and NS\_ERROR\_FAILURE our way out of window.open in that case instead?Flags: needinfo?(mconley) → needinfo?(bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1301876#c12)• 8 years ago |
|  | |

(In reply to Mike Conley (:mconley) - (needinfo me!) from [comment #11](/show_bug.cgi?id=1301876#c11 "RESOLVED FIXED - Print preview hijacking leads to potential spoof"))
> I dunno - fixing this in the front-end feels like an end-of-pipe solution.
> Why would we even support calling window.open from within onbeforeprint? Can
> we check to see if we're in one of these event handlers and NS\_ERROR\_FAILURE
> our way out of window.open in that case instead?
As Olli pointed out in [comment #4](/show_bug.cgi?id=1301876#c4 "RESOLVED FIXED - Print preview hijacking leads to potential spoof"), the same thing would happen if you had other background windows that did this. That's already confusing for users if it happens "by accident". If a malicious actor wanted to abuse this problem, they could easily do so via named windows and call window.open from somewhere else. The navigation doesn't happen in the window that's in print preview (and/or the one that fires beforeprint).

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1301876#c13)• 8 years ago |
|  | |

This is definitely a front-end issue. The issue isn't, in general, the page which gets before/afterprint but all the tabs user has open.Flags: needinfo?(bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1301876#c14)• 8 years ago |
|  | |

Comment on [attachment 8790652](/attachment.cgi?id=8790652 "Patch v0.1") [[details]](/attachment.cgi?id=8790652&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8790652&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8790652)
Patch v0.1
(In reply to :Gijs Kruitbosch from [comment #10](/show_bug.cgi?id=1301876#c10 "RESOLVED FIXED - Print preview hijacking leads to potential spoof"))
> One other thing we could do, which I didn't realize until long after I wrote
> this patch, is somehow try to force the print preview browser to stay on
> top. AIUI we create a separate browser for the print preview. It's not clear
> to me why that browser gets moved out of view for the newly-focused tab. If
> the new browser was "always on top" as it were, we wouldn't have to mess
> with tab switching in the browser (though of course the user could then
> still end up on a different tab than where they started from, when closing
> print preview).
So it turns out the print preview browser is just another tabbed browser, so this isn't really any different from the existing patch.
Effectively, I think [comment #9](/show_bug.cgi?id=1301876#c9 "RESOLVED FIXED - Print preview hijacking leads to potential spoof") devolves to r?mconley, so I'm going to set that.
One thing that may or may not make this more palatable from a "don't mess up the tabbrowser" perspective, but potentially more jarring for the user, is if we only disable the tabswitching in Enter(), but then also re-force the print preview tab to become the selected tab (and remove the tabswitch-disabling in Exit() as is done now).
[Attachment #8790652](/attachment.cgi?id=8790652&action=edit "Patch v0.1") -
Flags: review- → review?(mconley)

|  | [Mike Conley (:mconley) (:⚙️)](/user_profile?user_id=403756) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1301876#c15)• 8 years ago |
|  | |

Comment on [attachment 8790652](/attachment.cgi?id=8790652 "Patch v0.1") [[details]](/attachment.cgi?id=8790652&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8790652&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8790652)
Patch v0.1
Review of [attachment 8790652](/attachment.cgi?id=8790652 "Patch v0.1") [[details]](/attachment.cgi?id=8790652&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8790652&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8790652):
-----------------------------------------------------------------
I have a safety suggestion - see below.
::: browser/base/content/browser.js
@@ +3261,5 @@
> relatedBrowser: browser });
> gBrowser.selectedTab = this.\_printPreviewTab;
> + // NB: we do this here rather than in onEnter because when onEnter happens
> + // we could already have switched tabs (via either user or website actions).
> + gBrowser.tabSwitchingEnabled = false;
I, like jaws, am worried about unforeseen conditions that might result in our user being unable to switch tabs in this window - for example, something going awfully wrong in the teardown of print preview.
Ideally, that'd be as impossible a condition as possible. Could we perhaps have some kind of safeguard, where if the user mouseenters the tabbrowser-tabs (which is normally hidden in print preview), we ensure that tabSwitchingEnabled is true? How do you feel about that - overkill? I'm just antsy about unknown unknowns here, since we're effectively adding a switch to a critical function of the browser.
[Attachment #8790652](/attachment.cgi?id=8790652&action=edit "Patch v0.1") -
Flags: review?(mconley) → feedback+

|  | [Mike Conley (:mconley) (:⚙️)](/user_profile?user_id=403756) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1301876#c16)• 8 years ago |
|  | |

This bug just went public:
<https://twitter.com/Qab/status/778022079350378496>

|  | [Mike Conley (:mconley) (:⚙️)](/user_profile?user_id=403756) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1301876#c17)• 8 years ago |
|  | |

Attached image
[Capture of Tweet](attachment.cgi?id=8793530)
— [Details](attachment.cgi?id=8793530&action=edit)

:/

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1301876#c18)• 8 years ago |
|  | |

(In reply to Mike Conley (:mconley) - (needinfo me!) from [comment #17](/show_bug.cgi?id=1301876#c17 "RESOLVED FIXED - Print preview hijacking leads to potential spoof"))
> Created [attachment 8793530](/attachment.cgi?id=8793530 "Capture of Tweet") [[details]](/attachment.cgi?id=8793530&action=edit "Capture of Tweet")
> Capture of Tweet
>
> :/
I didn't add any PoC, is the screenshot alone considered public disclosure?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1301876#c19)• 8 years ago |
|  | |

(In reply to Abdulrahman Alqabandi[test] from [comment #18](/show_bug.cgi?id=1301876#c18 "RESOLVED FIXED - Print preview hijacking leads to potential spoof"))
> (In reply to Mike Conley (:mconley) - (needinfo me!) from [comment #17](/show_bug.cgi?id=1301876#c17 "RESOLVED FIXED - Print preview hijacking leads to potential spoof"))
> > Created [attachment 8793530](/attachment.cgi?id=8793530 "Capture of Tweet") [[details]](/attachment.cgi?id=8793530&action=edit "Capture of Tweet")
> > Capture of Tweet
> >
> > :/
>
> I didn't add any PoC, is the screenshot alone considered public disclosure?
Not necessarily, but in this particular case, I think the screenshot is pretty suggestive of how you'd exploit.
In any case, this bug is going to need a sec-rating and I need to update the patch, which I hope to do later today.Flags: needinfo?(dveditz)Flags: needinfo?(abillings)

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1301876#c20)• 8 years ago |
|  | |

I guess people could guess how its done, tweet deleted.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1301876#a1494529_1689)• 8 years ago |

Group: core-security → core-security-release

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1301876#c21)• 8 years ago |
|  | |

Attached patch

[Patch v0.2](attachment.cgi?id=8795764&action=diff)
— [Details](attachment.cgi?id=8795764&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8795764)

I think this also works, and will be automatically unbroken when the navtoolbox is no longer collapsed, which seems like it would be enough to avoid permanently bricking stuff. There's a little flicker in the testcase for me, but that seems pretty OK given that this won't actually happen in "normal" usecases (only if the webpage tries to spoof you like the PoC).
I can look at doing a testcase for this but without a sec-rating I don't know if it'll even land when we fix this, so I'll leave that for now.
[Attachment #8790652](/attachment.cgi?id=8790652&action=edit "Patch v0.1") -
Attachment is obsolete: true
[Attachment #8795764](/attachment.cgi?id=8795764&action=edit "Patch v0.2") -
Flags: review?(mconley)

|  | [Mike Conley (:mconley) (:⚙️)](/user_profile?user_id=403756) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1301876#c22)• 8 years ago |
|  | |

Comment on [attachment 8795764](/attachment.cgi?id=8795764 "Patch v0.2") [[details]](/attachment.cgi?id=8795764&action=edit "Patch v0.2") [[diff]](/attachment.cgi?id=8795764&action=diff "Patch v0.2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8795764)
Patch v0.2
Review of [attachment 8795764](/attachment.cgi?id=8795764 "Patch v0.2") [[details]](/attachment.cgi?id=8795764&action=edit "Patch v0.2") [[diff]](/attachment.cgi?id=8795764&action=diff "Patch v0.2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1301876&attachment=8795764):
-----------------------------------------------------------------
Yeah, this is so much simpler. Thanks Gijs!
[Attachment #8795764](/attachment.cgi?id=8795764&action=edit "Patch v0.2") -
Flags: review?(mconley) → review+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1301876#c23)• 8 years ago |
|  | |

Calling this spoof sec-low (as are most spoofs).
\* only affects the tiny minority who disable the pop-up blocker
\* you have to convince a user to print preview your page (not a common action)
\* You're printing a page from foo.com and suddenly it turns into mybank.com?
that's suspicious, why would the user believe that?
\* it's a print preview, not an interactive page. What can you get out of it?Flags: needinfo?(dveditz)Flags: needinfo?(abillings)Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1301876#c24)• 8 years ago |
|  | |

remote: <https://hg.mozilla.org/integration/mozilla-inbound/rev/b6f62be719ae>

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1301876#c25)• 8 years ago |
|  | |

Huh, when filing a bug for having an automated test, noticed [bug 148892](/show_bug.cgi?id=148892 "NEW - Clicking on link in mail loaded page in print preview") and [bug 244705](/show_bug.cgi?id=244705 "RESOLVED WORKSFORME - Link to browser window in Print Preview mode results in \"The document cannot change while Printing or in Print Preview.\" error") and [bug 601248](/show_bug.cgi?id=601248 "RESOLVED WORKSFORME - If I click another tab while Print Preview loads, that other tab is shown in the print-preview pane"). Once this hits Nightly I'll see if those bugs can be resolved. AIUI we can open up sec-low spoofing bugs so I might just dupe the open ones here and make this public.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1301876#a1635645_159069)• 8 years ago |

Depends on: [1306266](/show_bug.cgi?id=1306266 "RESOLVED FIXED - Write automated test for tab-switching using window.open (or external links?) while print preview opens up (bug 1301876)")

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1301876#c26)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/b6f62be719ae>Status: ASSIGNED → RESOLVEDClosed: 8 years ago
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla52

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1301876#a14468160_455785)• 8 years ago |

Flags: qe-verify+Whiteboard: [post-critsmash-triage]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1301876#a14812511_280903)• 8 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main52+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1301876#a14884749_280903)• 8 years ago |

Alias: CVE-2017-5421

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1301876#a35554332_1689)• 7 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1301876&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Abdulrahman Alqabandi](/user_profile?user_id=550582)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


