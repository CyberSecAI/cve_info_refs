=== Content from www.openwall.com_1a8d232c_20250125_195500.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[<thread-prev]](../../../2017/01/30/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <5a83fed905374f2fa03babb6c7c1da61@imshyb01.MITRE.ORG>
Date: Tue, 31 Jan 2017 10:22:47 -0500
From: <cve-assign@...re.org>
To: <dx@...one.com.ar>
CC: <cve-assign@...re.org>, <oss-security@...ts.openwall.com>
Subject: Re: CVE Request - Remote DoS vulnerabilities in BitlBee

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> I've just released BitlBee 3.5.1 which includes fixes for these issues:
>
> a) bitlbee-libpurple: Use after free when expiring file transfer requests.
> b) Null pointer dereference with file transfer request from unknown contacts.
> c) Incomplete fix for issue (b), which left bitlbee-libpurple affected.
>
> I have already requested three CVEs to the distros mailing list when
> the issue was not public, but did not receive any reply at the time of
> this writing. If it is appropriate, I'd like to request them in this
> list instead.
>
> The first two were already public (fixed in 3.5, released 2017-01-08) but were
> not considered security issues before. The third issue is what 3.5.1
> fixes.

> <https://bugs.bitlbee.org/ticket/1281>
>
> # bitlbee-libpurple: Use after free when expiring file transfer requests
>
> Pending file transfer requests expire after 120 seconds, which may
> result in use after free if the corresponding account is disconnected.
> A malicious remote server could force this disconnection.
>
> This results in denial of service (remote crash of the BitlBee
> instance), or remote code execution (theoretically).
>
> * Authentication: None
>
> ## Unaffected versions
>
> bitlbee (non-libpurple builds), any version
>
> bitlbee-libpurple 3.5
>
> This affects any libpurple protocol when used through BitlBee. It does
> not affect other libpurple-based clients such as pidgin.
>
> This is a very visible issue - all file transfer request attempts and
> all disconnections will be logged in the control channel and visible
> by the targeted user. File transfer requests look like this:
>
>     <@root> [account] - File transfer request from [username] for [filename] (0 kb).
>     <@root> Accept the file transfer if you'd like the file. If you don't, issue the 'transfer reject' command.
>
> Cancelling the file transfer request using the "transfer reject"
> command before the disconnection happens can prevent this. However,
> using that command after the account is disconnected will result in an
> immediate crash.

> [] Original bugfix commit:
>
> <https://github.com/bitlbee/bitlbee/commit/ea902752503fc5b356d6513911081ec932d804f2>

Use CVE-2016-10188.

> <https://bugs.bitlbee.org/ticket/1282>
>
> # Null pointer dereference with file transfer request from unknown contacts
>
> Receiving a file transfer request from a contact not in the contact
> list results in a null pointer dereference, leading to remote DoS by
> malicious remote clients.
>
> * Authentication: None
>
> ## Unaffected versions
>
> bitlbee-libpurple 3.5.1 or newer
>
> bitlbee (non-libpurple builds) 3.5 or newer
>
> The issue from 3.4.2 and older only affects the jabber protocol, which
> is the only non-purple protocol which implements file transfers.
>
> The issue that is still present in 3.5 affects any libpurple protocol
> that implements file transfers when used through BitlBee. It does not
> affect other libpurple-based clients such as pidgin.
>
> There's no visible effect of the issue other than the crash.

> [] Incomplete fix commit included in 3.5:
>
> <https://github.com/bitlbee/bitlbee/commit/701ab8129ba9ea64f569daedca9a8603abad740f>

Use CVE-2016-10189 for the issue with Jabber file transfers that was
fixed by this commit.

> [] Libpurple specific bugfix commit included in 3.5.1:
>
> <https://github.com/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441>

Use CVE-2017-5668.

CVE-2017-5668 exists because of an incomplete fix for CVE-2016-10189.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJYkKkNAAoJEHb/MwWLVhi2n7sP/iWiXN3EZmIeerbEEWv9chVf
JZD3ly+EoNbnY0YsVl1HE0XJ0L6FQ3ZLQYqP2dcuqh6dn0mI/oosMOS8lC/Hs+GW
fhDpu0TbLNMyu187/NZNfFg638voaEjvqkjM7xgb5xPlyk7ZfmqjIRvGBe/F4XfE
O/0+B/1llLgs5nWxUhhk3KfhQpRc27oH+qa2eKnmRn69GkeV1wMl04Od4D8y5IYY
OvUdv1WsFsgzw6Ls+QBJrw1nFeaT4nf7pST7pv+ufZmI0eyDG55Bi7e74qsEaowm
2Xv8erIPGKTB2keQFCptaX0IjxU8XrdwZPkQ2pCycFQirCbfCzsUNTwchDbz5RKG
h3nOwI0wexQaaphZE1oeCqBqla7GScTCimSPhfv7JY4nm8zAeGu5bQwaxWOOtEm9
YcDVRWFkIYJlOIrAxywR4bw/t28wfI9EMiUMec3XpkuJdJ+VuGkMuTYjWS9Iuwpm
tSgThfWipSAyiaR6vzIomHo7nX8+PE/N5sA5IfGVFsoav1ebtCzUNiukh2fCkSAW
k09zwGWVwqZlvtoEKMqWdxhSjMKCzo7RkoUDxILL9QODEbCH+pvzSkv4/rf/FTfI
V1jrlx+UqwfLO2mFySEUpNFC+lofz+mz+/RqyQe0H4cUwxY/3stH18ce5pCOj1/Z
9uHI/HHKLDmYKe5N+7jD
=oUx2
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_0f878967_20250126_113245.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitlbee%2Fbitlbee%2Fcommit%2F30d598ce7cd3f136ee9d7097f39fa9818a272441)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitlbee%2Fbitlbee%2Fcommit%2F30d598ce7cd3f136ee9d7097f39fa9818a272441)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=bitlbee%2Fbitlbee)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bitlbee](/bitlbee)
/
**[bitlbee](/bitlbee/bitlbee)**
Public

* [Notifications](/login?return_to=%2Fbitlbee%2Fbitlbee) You must be signed in to change notification settings
* [Fork
  119](/login?return_to=%2Fbitlbee%2Fbitlbee)
* [Star
   606](/login?return_to=%2Fbitlbee%2Fbitlbee)

* [Code](/bitlbee/bitlbee)
* [Pull requests
  6](/bitlbee/bitlbee/pulls)
* [Actions](/bitlbee/bitlbee/actions)
* [Security](/bitlbee/bitlbee/security)
* [Insights](/bitlbee/bitlbee/pulse)

Additional navigation options

* [Code](/bitlbee/bitlbee)
* [Pull requests](/bitlbee/bitlbee/pulls)
* [Actions](/bitlbee/bitlbee/actions)
* [Security](/bitlbee/bitlbee/security)
* [Insights](/bitlbee/bitlbee/pulse)

## Commit

[Permalink](/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

purple: Fix crash on ft requests from unknown contacts

[Browse files](/bitlbee/bitlbee/tree/30d598ce7cd3f136ee9d7097f39fa9818a272441)
Browse the repository at this point in the history

```
Followup to [701ab81](https://github.com/bitlbee/bitlbee/commit/701ab8129ba9ea64f569daedca9a8603abad740f) (included in 3.5) which was a partial fix which only
improved things for non-libpurple file transfers (that is, just jabber)
```

* Loading branch information

[![@dequis](https://avatars.githubusercontent.com/u/94108?s=40&v=4)](/dequis)

[dequis](/bitlbee/bitlbee/commits?author=dequis "View all commits by dequis")
committed
Jan 29, 2017

1 parent
[53cb4ae](/bitlbee/bitlbee/commit/53cb4ae80e54b89efebc7d19f739d17fc3286383)

commit 30d598c

Showing
**1 changed file**
with
**4 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[protocols/purple/ft.c](#diff-ffcf5777ff555a16c366bdf7257b8c778a6da0fdb77c09ad87b5a252ebda02ad "protocols/purple/ft.c")

Show comments

[View file](/bitlbee/bitlbee/blob/30d598ce7cd3f136ee9d7097f39fa9818a272441/protocols/purple/ft.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -145,6 +145,10 @@ static gboolean prplcb\_xfer\_new\_send\_cb(gpointer data, gint fd, b\_input\_conditio |
|  |  | /\* TODO(wilmer): After spreading some more const goodness in BitlBee, |
|  |  | remove the evil cast below. \*/ |
|  |  | px->ft = imcb\_file\_send\_start(ic, (char \*) who, xfer->filename, xfer->size); |
|  |  |  |
|  |  | if (!px->ft) { |
|  |  | return FALSE; |
|  |  | } |
|  |  | px->ft->data = px; |
|  |  |  |
|  |  | px->ft->accept = prpl\_xfer\_accept; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 2 comments on commit `30d598c`

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&v=4)](/carnil)

Copy link

### @carnil **[carnil](/carnil)** commented on `[30d598c](/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441)` [Jan 31, 2017](#commitcomment-20675332)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

CVE Request: <http://www.openwall.com/lists/oss-security/2017/01/30/4>

Sorry, something went wrong.

All reactions

[![@dequis](https://avatars.githubusercontent.com/u/94108?s=80&v=4)](/dequis)

Copy link

Member

Author

### @dequis **[dequis](/dequis)** commented on `[30d598c](/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441)` [Jan 31, 2017](#commitcomment-20681284)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[CVE-2017-5668](https://github.com/advisories/GHSA-x9m7-9m6q-c6hr "CVE-2017-5668") has been assigned for this

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitlbee%2Fbitlbee%2Fcommit%2F30d598ce7cd3f136ee9d7097f39fa9818a272441) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_53896e5f_20250125_195500.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](../../../2017/01/31/1) [[thread-next>]](../../../2017/01/31/11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CABAA10T31CKTgskyX78JBp_kmw9TyVOAa8XzS=ba2t3YC=TVMw@mail.gmail.com>
Date: Mon, 30 Jan 2017 15:36:37 -0300
From: dequis <dx@...one.com.ar>
To: oss-security@...ts.openwall.com
Subject: CVE Request - Remote DoS vulnerabilities in BitlBee

Hi oss-security,

I've just released BitlBee 3.5.1 which includes fixes for these issues:

a) bitlbee-libpurple: Use after free when expiring file transfer requests.
b) Null pointer dereference with file transfer request from unknown contacts.
c) Incomplete fix for issue (b), which left bitlbee-libpurple affected.

I have already requested three CVEs to the distros mailing list when
the issue was not public, but did not receive any reply at the time of
this writing. If it is appropriate, I'd like to request them in this
list instead.

The first two were already public (fixed in 3.5, released 2017-01-08) but were
not considered security issues before. The third issue is what 3.5.1
fixes.

Distros that do not ship the bitlbee-libpurple variant can ignore
3.5.1 if they already have 3.5.

The full advisories (without attachments) follow, with links to the
full version in the tracker:

----------------------------------------------------------------------

<https://bugs.bitlbee.org/ticket/1281>

# bitlbee-libpurple: Use after free when expiring file transfer requests

## Description

Pending file transfer requests expire after 120 seconds, which may
result in use after free if the corresponding account is disconnected.
A malicious remote server could force this disconnection.

## Impact

This results in denial of service (remote crash of the BitlBee
instance), or remote code execution (theoretically).

For BitlBee servers configured in ForkDaemon mode (default) or inetd
mode, the crash is limited to one user connection, who may just
reconnect.

* Access Vector: Network
* Access Complexity: High
* Authentication: None
* Confidentiality Impact: None
* Integrity Impact: None
* Availability Impact: Partial
* Exploitability: Functional Exploit Exists
* Remediation Level: Official Fix
* Report Confidence: Confirmed
* Target Distribution: Medium
* CVSS v2 score: 1.6

## Affected versions

bitlbee-libpurple 3.4.2 or older

## Unaffected versions

bitlbee (non-libpurple builds), any version

bitlbee-libpurple 3.5

## Resolution

* Upgrade to 3.5 (released 2017-01-08)

* For 3.4.2 see the attached
0001-purple-fix-file-transfer-memory-management-3.4.2.patch [not
included in this email]

* For 3.4.1 and 3.4 see the attached
0001-purple-fix-file-transfer-memory-management-3.4-3.4.1.patch [not
included in this email]

* For earlier versions upgrading is strongly recommended because of
the amount of accumulated bugfixes, but the following line may be
removed from `protocols/purple/purple.c` to prevent any processing of
incoming file transfers:

    purple_xfers_set_ui_ops(&bee_xfer_uiops);

## Discussion

This affects any libpurple protocol when used through BitlBee. It does
not affect other libpurple-based clients such as pidgin.

This is a very visible issue - all file transfer request attempts and
all disconnections will be logged in the control channel and visible
by the targeted user. File transfer requests look like this:

    <@root> [account] - File transfer request from [username] for
[filename] (0 kb).
    <@root> Accept the file transfer if you'd like the file. If you
don't, issue the 'transfer reject' command.

Cancelling the file transfer request using the "transfer reject"
command before the disconnection happens can prevent this. However,
using that command after the account is disconnected will result in an
immediate crash.

## References

Original bugfix commit:

<https://github.com/bitlbee/bitlbee/commit/ea902752503fc5b356d6513911081ec932d804f2>

----------------------------------------------------------------------

<https://bugs.bitlbee.org/ticket/1282>

# Null pointer dereference with file transfer request from unknown contacts

## Description

Receiving a file transfer request from a contact not in the contact
list results in a null pointer dereference, leading to remote DoS by
malicious remote clients.

Additionally, due to an incomplete fix of the issue above in BitlBee
3.5, the bitlbee-libpurple variant is still affected in 3.5.

## Impact

This results in denial of service (remote crash of the BitlBee
instance). Remote code execution does not seem to be possible (fixed
offset)

For BitlBee servers configured in ForkDaemon mode (default) or inetd
mode, the crash is limited to one user connection, who may just
reconnect.

CVSS for bitlbee 3.4.2 and lower:

* Access Vector: Network
* Access Complexity: Low
* Authentication: None
* Confidentiality Impact: None
* Integrity Impact: None
* Availability Impact: Partial
* Exploitability: Functional Exploit Exists
* Remediation Level: Official Fix
* Report Confidence: Confirmed
* Target Distribution: High
* CVSS v2 score: 4.1

CVSS for bitlbee-libpurple 3.5:

* Target Distribution: Medium
* CVSS v2 score: 3.1

## Affected versions

bitlbee-libpurple 3.5 or older

bitlbee (non-libpurple builds) 3.4.2 or older

## Unaffected versions

bitlbee-libpurple 3.5.1 or newer

bitlbee (non-libpurple builds) 3.5 or newer

## Resolution

* Upgrade to 3.5.1 (released 2017-01-30)

* For 3.5 see the attached
0001-Fix-null-pointer-dereference-on-ft-attempts-3.5.patch [not
included in this email]

* For 3.4.2, 3.4.1 and 3.4 see the attached
0001-Fix-null-pointer-dereference-on-ft-attempts-3.4.x.patch [not
included in this email]

* For 3.2.x and 3.2.x see the attached
0001-Fix-null-pointer-dereference-on-ft-attempts-3.0.x-3.2.x.patch
[not included in this email]

## Discussion

The issue from 3.4.2 and older only affects the jabber protocol, which
is the only non-purple protocol which implements file transfers.

The issue that is still present in 3.5 affects any libpurple protocol
that implements file transfers when used through BitlBee. It does not
affect other libpurple-based clients such as pidgin.

There's no visible effect of the issue other than the crash.

## References

Incomplete fix commit included in 3.5:

<https://github.com/bitlbee/bitlbee/commit/701ab8129ba9ea64f569daedca9a8603abad740f>

Libpurple specific bugfix commit included in 3.5.1:

<https://github.com/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from docs.github.com_332f0a88_20250126_113241.html ===
[Skip to main content](#main-content)[GitHub Docs](/en)Version: Free, Pro, & TeamSearch GitHub DocsSearchSelect language: current language is EnglishOpen Search BarClose Search BarOpen MenuOpen Sidebar

* [Building communities](/en/communities "Building communities")/
* [Moderation](/en/communities/moderating-comments-and-conversations "Moderation")/
* [Manage comments](/en/communities/moderating-comments-and-conversations/managing-disruptive-comments "Manage comments")
[Home](/en)[Building communities](/en/communities)

* Healthy contributions
  + [Management & moderation](/en/communities/setting-up-your-project-for-healthy-contributions/about-community-management-and-moderation)
  + [Community profiles](/en/communities/setting-up-your-project-for-healthy-contributions/about-community-profiles-for-public-repositories)
  + [Access community profiles](/en/communities/setting-up-your-project-for-healthy-contributions/accessing-a-projects-community-profile)
  + [Add a code of conduct](/en/communities/setting-up-your-project-for-healthy-contributions/adding-a-code-of-conduct-to-your-project)
  + [Contributor guidelines](/en/communities/setting-up-your-project-for-healthy-contributions/setting-guidelines-for-repository-contributors)
  + [Add a license to a repo](/en/communities/setting-up-your-project-for-healthy-contributions/adding-a-license-to-a-repository)
  + [Add support resources](/en/communities/setting-up-your-project-for-healthy-contributions/adding-support-resources-to-your-project)
  + [Community health file](/en/communities/setting-up-your-project-for-healthy-contributions/creating-a-default-community-health-file)
  + [Encourage contributions](/en/communities/setting-up-your-project-for-healthy-contributions/encouraging-helpful-contributions-to-your-project-with-labels)
* Issue & PR templates
  + [About templates](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/about-issue-and-pull-request-templates)
  + [Configure](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/configuring-issue-templates-for-your-repository)
  + [Syntax for issue forms](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-issue-forms)
  + [Syntax for GitHub's form schema](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-githubs-form-schema)
  + [Create a PR template](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/creating-a-pull-request-template-for-your-repository)
  + [Create an issue template](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/manually-creating-a-single-issue-template-for-your-repository)
  + [Common validation errors when creating issue forms](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/common-validation-errors-when-creating-issue-forms)
* Moderation
  + [Manage comments](/en/communities/moderating-comments-and-conversations/managing-disruptive-comments)
  + [Locking conversations](/en/communities/moderating-comments-and-conversations/locking-conversations)
  + [Limit interactions in repo](/en/communities/moderating-comments-and-conversations/limiting-interactions-in-your-repository)
  + [Limit interactions in account](/en/communities/moderating-comments-and-conversations/limiting-interactions-for-your-personal-account)
  + [Limit interactions in org](/en/communities/moderating-comments-and-conversations/limiting-interactions-in-your-organization)
  + [Track comment changes](/en/communities/moderating-comments-and-conversations/tracking-changes-in-a-comment)
  + [Manage abuse in your org](/en/communities/moderating-comments-and-conversations/managing-how-contributors-report-abuse-in-your-organizations-repository)
  + [Manage reported content](/en/communities/moderating-comments-and-conversations/managing-reported-content-in-your-organizations-repository)
* Maintaining safety
  + [Block from your account](/en/communities/maintaining-your-safety-on-github/blocking-a-user-from-your-personal-account)
  + [View blocked users in account](/en/communities/maintaining-your-safety-on-github/viewing-users-youve-blocked-from-your-personal-account)
  + [Unblock from your account](/en/communities/maintaining-your-safety-on-github/unblocking-a-user-from-your-personal-account)
  + [Block from your org](/en/communities/maintaining-your-safety-on-github/blocking-a-user-from-your-organization)
  + [View blocked users in org](/en/communities/maintaining-your-safety-on-github/viewing-users-who-are-blocked-from-your-organization)
  + [Unblock from your org](/en/communities/maintaining-your-safety-on-github/unblocking-a-user-from-your-organization)
  + [Reporting abuse or spam](/en/communities/maintaining-your-safety-on-github/reporting-abuse-or-spam)
* Using wikis
  + [About wikis](/en/communities/documenting-your-project-with-wikis/about-wikis)
  + [Manage wiki pages](/en/communities/documenting-your-project-with-wikis/adding-or-editing-wiki-pages)
  + [Create footer or sidebar](/en/communities/documenting-your-project-with-wikis/creating-a-footer-or-sidebar-for-your-wiki)
  + [Editing wiki content](/en/communities/documenting-your-project-with-wikis/editing-wiki-content)
  + [View a history of changes](/en/communities/documenting-your-project-with-wikis/viewing-a-wikis-history-of-changes)
  + [Change access permissions](/en/communities/documenting-your-project-with-wikis/changing-access-permissions-for-wikis)
  + [Disabling wikis](/en/communities/documenting-your-project-with-wikis/disabling-wikis)

* [Building communities](/en/communities "Building communities")/
* [Moderation](/en/communities/moderating-comments-and-conversations "Moderation")/
* [Manage comments](/en/communities/moderating-comments-and-conversations/managing-disruptive-comments "Manage comments")
# Managing disruptive comments

You can hide, edit, or delete comments on issues, pull requests, and commits.

## In this article

* [Hiding a comment](#hiding-a-comment)
* [Unhiding a comment](#unhiding-a-comment)
* [Editing a comment](#editing-a-comment)
* [Redacting sensitive information](#redacting-sensitive-information)
* [Deleting a comment](#deleting-a-comment)
* [Further reading](#further-reading)
## [Hiding a comment](#hiding-a-comment)

Organization moderators, and anyone with write access to a repository, can hide comments on issues, pull requests, and commits.

If a comment is off-topic, outdated, or resolved, you may want to hide a comment to keep a discussion focused or make a pull request easier to navigate and review. Hidden comments are minimized but people with read access to the repository can expand them.

![Screenshot of a hidden comment. The only visible content is "This comment has been minimized", with a button to show the comment.](/assets/cb-13766/images/help/repository/hidden-comment.png)

1. Navigate to the comment you'd like to hide.
2. In the upper-right corner of the comment, click , then click **Hide**.

   ![Screenshot of a pull request comment by octo-user. Below an icon of three dots, a dropdown menu is expanded, and "Hide" is outlined in orange.](/assets/cb-42438/images/help/repository/comment-menu-hide.png)
3. Using the "Choose a reason" dropdown menu, choose a reason to hide the comment. Then select **Hide comment**.

   ![Screenshot of a comment showing a menu to select a reason to hide the comment: Spam, Abuse, Off Topic, Outdated, Duplicate, or Resolved.](/assets/cb-67538/images/help/repository/choose-reason-for-hiding-comment.png)

## [Unhiding a comment](#unhiding-a-comment)

Organization moderators, and anyone with write access to a repository, can unhide comments on issues, pull requests, and commits.

1. Navigate to the comment you'd like to unhide.
2. On the right side of the comment, click  **Show comment**.
3. On the right side of the expanded comment, select the  dropdown menu, then click **Unhide**.

   ![Screenshot of a pull request comment marked as spam. Below an icon of three dots, a dropdown menu is expanded, and "Unhide" is outlined in orange.](/assets/cb-50118/images/help/repository/comment-menu-hidden.png)

## [Editing a comment](#editing-a-comment)

Anyone with write access to a repository can edit comments on issues, pull requests, and commits.

It's appropriate to edit a comment and remove content that doesn't contribute to the conversation and violates your community's code of conduct or GitHub's [Community Guidelines](/en/site-policy/github-terms/github-community-guidelines).

Sometimes it may make sense to clearly indicate edits and their justification.

That said, anyone with read access to a repository can view a comment's edit history. The **edited** dropdown at the top of the comment contains a history of edits showing the user and timestamp for each edit.

![Screenshot of a comment by octo-user, which is partially redacted. In the header, next to "edited by octocat", a dropdown icon is outlined in orange.](/assets/cb-42069/images/help/repository/content-redacted-comment.png)

## [Redacting sensitive information](#redacting-sensitive-information)

Comment authors and anyone with write access to a repository can also delete sensitive information from a comment's edit history. For more information, see [Tracking changes in a comment](/en/communities/moderating-comments-and-conversations/tracking-changes-in-a-comment).

1. Navigate to the comment you'd like to edit.
2. In the upper-right corner of the comment, click , then click **Edit**.

   ![Screenshot of a pull request comment by octo-user. Below an icon of three dots, a dropdown menu is expanded, and "Edit" is outlined in orange.](/assets/cb-42473/images/help/repository/comment-menu-edit.png)
3. In the comment window, delete the content you'd like to remove, then type `[REDACTED]` to replace it.
4. At the bottom of the comment, type a note indicating that you have edited the comment, and optionally, why you edited the comment.
5. Click **Update comment**.

## [Deleting a comment](#deleting-a-comment)

Anyone with write access to a repository can delete comments on issues, pull requests, and commits. Organization owners, team maintainers, and the comment author can also delete a comment on a team page.

If a comment contains some constructive content that adds to the conversation in the issue or pull request, you can edit the comment instead.

Deleting a comment is your last resort as a moderator. It's appropriate to delete a comment if the entire comment adds no constructive content to a conversation and violates your community's code of conduct or GitHub's [Community Guidelines](/en/site-policy/github-terms/github-community-guidelines).

Deleting a comment creates a timeline event that is visible to anyone with read access to the repository. However, the username of the person who deleted the comment is only visible to people with write access to the repository. For anyone without write access, the timeline event is anonymized.

![Screenshot of a timeline event, which says "octo-org deleted a comment from hubot 6 minutes ago."](/assets/cb-10760/images/help/issues/anonymized-timeline-entry-for-deleted-comment.png)

Note

The initial comment (or body) of an issue or pull request can't be deleted. Instead, you can edit issue and pull request bodies to remove unwanted content.

### [Steps to delete a comment](#steps-to-delete-a-comment)

1. Navigate to the comment you'd like to delete.
2. In the upper-right corner of the comment, click , then click **Delete**.
   ![Screenshot of a pull request comment by octo-user. Below an icon of three dots, a dropdown menu is expanded, and "Delete" is outlined in orange.](/assets/cb-42453/images/help/repository/comment-menu-delete.png)
3. Optionally, write a comment noting that you deleted a comment and why.

## [Further reading](#further-reading)

* [Managing moderators in your organization](/en/organizations/managing-peoples-access-to-your-organization-with-roles/managing-moderators-in-your-organization)
## Help and support

### Did you find what you needed?

 Yes No[Privacy policy](/en/site-policy/privacy-policies/github-privacy-statement)
### Help us make these docs great!

All GitHub docs are open source. See something that's wrong or unclear? Submit a pull request.

[Make a contribution](https://github.com/github/docs/blob/main/content/communities/moderating-comments-and-conversations/managing-disruptive-comments.md)

[Learn how to contribute](/contributing)

### Still need help?

[Ask the GitHub community](https://github.com/orgs/community/discussions)[Contact support](https://support.github.com)
## Legal

* © 2025 GitHub, Inc.
* [Terms](/en/site-policy/github-terms/github-terms-of-service)
* [Privacy](/en/site-policy/privacy-policies/github-privacy-statement)
* [Status](https://www.githubstatus.com/)
* [Pricing](https://github.com/pricing)
* [Expert services](https://services.github.com)
* [Blog](https://github.blog)


=== Content from bugs.bitlbee.org_5955777e_20250125_195502.html ===

[![Bugs.BitlBee.Org](/chrome/site/BitlBee_gheghe.png)](http://bugs.bitlbee.org/)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Help/Guide](/wiki/TracGuide)
* [About Trac](/about)

* [Wiki](https://wiki.bitlbee.org/)
* [Timeline](/timeline)
* [Roadmap](/roadmap)
* [Browse Source](/browser)
* [View Tickets](/query)
* [New Ticket](/newticket)
* [Search](/search)

## Context Navigation

* ← [Previous Ticket](/ticket/1281 "Ticket #1281")
* [Next Ticket](/ticket/1283 "Ticket #1283") →

---

[Modify](#modify "Go to the ticket editor") ↓

Opened [at 2017-01-29T23:31:24Z](/timeline?from=2017-01-29T23%3A31%3A24Z&precision=second "See timeline 8 years ago")

Closed [at 2017-01-30T18:08:02Z](/timeline?from=2017-01-30T18%3A08%3A02Z&precision=second "See timeline 8 years ago")

Last modified [at 2017-01-31T15:48:16Z](/timeline?from=2017-01-31T15%3A48%3A16Z&precision=second "See timeline 8 years ago")

## [#1282](/ticket/1282) [closed](/query?status=closed) [defect](/query?status=!closed&type=defect) ([fixed](/query?status=closed&resolution=fixed))

# Null pointer dereference with file transfer request from unknown contacts

| Reported by: | [dx](/query?status=!closed&reporter=dx) | Owned by: |  |
| --- | --- | --- | --- |
| Priority: | [normal](/query?status=!closed&priority=normal) | Milestone: |  |
| Component: | [Unspecified / other](/query?status=!closed&component=Unspecified+%2F+other) | Version: | [Unspecified](/query?status=!closed&version=Unspecified) |
| Keywords: |  | Cc: |  |
| IRC client+version: | Client-independent | Operating System: | [Other](/query?status=!closed&os=Other) |
| OS version/distro: |  |  |  |

### Description [(last modified by dx)](/ticket/1282?action=diff&version=3 "2017-01-31 15:48:16.426445+00:00")

## Description

Receiving a file transfer request from a contact not in the contact
list results in a null pointer dereference, leading to remote DoS by
malicious remote clients.

CVE-2016-10189 has been assigned for this first issue.

Additionally, due to an incomplete fix of the issue above in BitlBee
3.5, the bitlbee-libpurple variant is still affected in 3.5.

CVE-2017-5668 has been assigned for this second issue.

## Impact

This results in denial of service (remote crash of the BitlBee
instance). Remote code execution does not seem to be possible (fixed
offset)

For BitlBee servers configured in ForkDaemon mode (default) or inetd
mode, the crash is limited to one user connection, who may just
reconnect.

CVSS for bitlbee 3.4.2 and lower:

* Access Vector: Network
* Access Complexity: Low
* Authentication: None
* Confidentiality Impact: None
* Integrity Impact: None
* Availability Impact: Partial
* Exploitability: Functional Exploit Exists
* Remediation Level: Official Fix
* Report Confidence: Confirmed
* Target Distribution: High
* CVSS v2 score: 4.1

CVSS for bitlbee-libpurple 3.5:

* Target Distribution: Medium
* CVSS v2 score: 3.1

## Affected versions

bitlbee-libpurple 3.5 or older

bitlbee (non-libpurple builds) 3.4.2 or older

## Unaffected versions

bitlbee-libpurple 3.5.1 or newer

bitlbee (non-libpurple builds) 3.5 or newer

## Resolution

* Upgrade to 3.5.1 (released 2017-01-30)

* For 3.5 see the attached

[​0001-Fix-null-pointer-dereference-on-ft-attempts-3.5.patch](https://bugs.bitlbee.org/raw-attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.5.patch)

* For 3.4.2, 3.4.1 and 3.4 see the attached

[​0001-Fix-null-pointer-dereference-on-ft-attempts-3.4.x.patch](https://bugs.bitlbee.org/raw-attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.4.x.patch)

* For 3.2.x and 3.2.x see the attached

[​0001-Fix-null-pointer-dereference-on-ft-attempts-3.0.x-3.2.x.patch](https://bugs.bitlbee.org/raw-attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.0.x-3.2.x.patch)

## Discussion

The issue from 3.4.2 and older only affects the jabber protocol, which
is the only non-purple protocol which implements file transfers.

The issue that is still present in 3.5 affects any libpurple protocol
that implements file transfers when used through BitlBee. It does not
affect other libpurple-based clients such as pidgin.

There's no visible effect of the issue other than the crash.

## References

CVE-2016-10189: Incomplete fix commit included in 3.5:

[​https://github.com/bitlbee/bitlbee/commit/701ab8129ba9ea64f569daedca9a8603abad740f](https://github.com/bitlbee/bitlbee/commit/701ab8129ba9ea64f569daedca9a8603abad740f)

CVE-2017-5668: Libpurple specific bugfix commit included in 3.5.1:

[​https://github.com/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441](https://github.com/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441)

### Attachments (3)

[0001-Fix-null-pointer-dereference-on-ft-attempts-3.4.x.patch](/attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.4.x.patch "View attachment")[​](/raw-attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.4.x.patch "Download") (1.4 KB) - added by dx [at 2017-01-30T18:15:34Z](/timeline?from=2017-01-30T18%3A15%3A34Z&precision=second "See timeline 8 years ago").

[0001-Fix-null-pointer-dereference-on-ft-attempts-3.0.x-3.2.x.patch](/attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.0.x-3.2.x.patch "View attachment")[​](/raw-attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.0.x-3.2.x.patch "Download") (1.4 KB) - added by dx [at 2017-01-30T18:15:47Z](/timeline?from=2017-01-30T18%3A15%3A47Z&precision=second "See timeline 8 years ago").

[0001-Fix-null-pointer-dereference-on-ft-attempts-3.5.patch](/attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.5.patch "View attachment")[​](/raw-attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.5.patch "Download") (977 bytes) - added by dx [at 2017-01-30T18:20:44Z](/timeline?from=2017-01-30T18%3A20%3A44Z&precision=second "See timeline 8 years ago").

Download all attachments as: [.zip](/zip-attachment/ticket/1282/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (6)

### [comment:1](#comment:1) Changed [at 2017-01-30T18:08:02Z](/timeline?from=2017-01-30T18%3A08%3A02Z&precision=second "See timeline 8 years ago") by dx

| Description: | modified ([diff](/ticket/1282?action=diff&version=1)) |
| --- | --- |
| Resolution: | → fixed |
| Status: | new → closed |
| Summary: | [reserved] → Null pointer dereference with file transfer request from unknown contacts |

Made public

### Changed [at 2017-01-30T18:15:34Z](/timeline?from=2017-01-30T18%3A15%3A34Z&precision=second "See timeline 8 years ago") by dx

| Attachment: | [*0001-Fix-null-pointer-dereference-on-ft-attempts-3.4.x.patch*](/attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.4.x.patch)[​](/raw-attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.4.x.patch "Download") added |
| --- | --- |

### Changed [at 2017-01-30T18:15:47Z](/timeline?from=2017-01-30T18%3A15%3A47Z&precision=second "See timeline 8 years ago") by dx

| Attachment: | [*0001-Fix-null-pointer-dereference-on-ft-attempts-3.0.x-3.2.x.patch*](/attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.0.x-3.2.x.patch)[​](/raw-attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.0.x-3.2.x.patch "Download") added |
| --- | --- |

### Changed [at 2017-01-30T18:20:44Z](/timeline?from=2017-01-30T18%3A20%3A44Z&precision=second "See timeline 8 years ago") by dx

| Attachment: | [*0001-Fix-null-pointer-dereference-on-ft-attempts-3.5.patch*](/attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.5.patch)[​](/raw-attachment/ticket/1282/0001-Fix-null-pointer-dereference-on-ft-attempts-3.5.patch "Download") added |
| --- | --- |

### [comment:2](#comment:2) Changed [at 2017-01-30T18:22:06Z](/timeline?from=2017-01-30T18%3A22%3A06Z&precision=second "See timeline 8 years ago") by dx

| Description: | modified ([diff](/ticket/1282?action=diff&version=2)) |
| --- | --- |

Attachment links

### [comment:3](#comment:3) Changed [at 2017-01-31T15:48:16Z](/timeline?from=2017-01-31T15%3A48%3A16Z&precision=second "See timeline 8 years ago") by dx

| Description: | modified ([diff](/ticket/1282?action=diff&version=3)) |
| --- | --- |

CVE-2016-10189 and CVE-2017-5668 have been assigned for the first issue and its incomplete fix respectively.

### Modify Ticket

Action

leave
as closed
The ticket will remain with no owner.

reopen
The resolution will be deleted.

### Add Comment

This ticket has been modified since you started editing. You should review the
*other modifications* which have been appended above,
and any *conflicts* shown in the preview below.
You can nevertheless proceed and submit your changes if you wish so.

| Your email or username: |  |
| --- | --- |

E-mail address and name can be saved in the [Preferences](/prefs).

You may use [WikiFormatting](/wiki/WikiFormatting) here.

[Attachments](#attachments "Go to the list of attachments") ↑
[Description](#content "View the ticket description") ↑

### Changed by anonymous

**Note:** See
[TracTickets](/wiki/TracTickets) for help on using
tickets.

### Download in other formats:

* [Comma-delimited Text](/ticket/1282?format=csv)
* [Tab-delimited Text](/ticket/1282?format=tab)
* [RSS Feed](/ticket/1282?format=rss)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](http://trac.edgewall.org/)

Powered by [**Trac 1.2.3**](/about)

By [Edgewall Software](http://www.edgewall.org/).

BitlBee: An IRC to other chat networks gateway



=== Content from github.com_c256ce29_20250126_113242.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-x9m7-9m6q-c6hr)

**CVE-2017-5668**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-x9m7-9m6q-c6hr)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2017-5668](/advisories/GHSA-x9m7-9m6q-c6hr)

## bitlbee-libpurple before 3.5.1 allows remote attackers to...

Critical severity

Unreviewed

Published
May 17, 2022
to the GitHub Advisory Database
•
Updated Jan 27, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-x9m7-9m6q-c6hr/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

bitlbee-libpurple before 3.5.1 allows remote attackers to cause a denial of service (NULL pointer dereference and crash) and possibly execute arbitrary code via a file transfer request for a contact that is not in the contact list. NOTE: this vulnerability exists because of an incomplete fix for [CVE-2016-10189](https://github.com/advisories/GHSA-f3fv-7pqw-59cx "CVE-2016-10189").

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2017-5668>
* [bitlbee/bitlbee@30d598c](https://github.com/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441)
* <https://bugs.bitlbee.org/ticket/1282>
* <http://www.openwall.com/lists/oss-security/2017/01/30/4>
* <http://www.openwall.com/lists/oss-security/2017/01/31/11>
* <http://www.securityfocus.com/bid/95932>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2017-5668)
Mar 14, 2017

Published to the GitHub Advisory Database
May 17, 2022

Last updated
Jan 27, 2023

### Severity

Critical

9.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

### EPSS score

2.227%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (89th percentile)

### Weaknesses

[CWE-476](/advisories?query=cwe%3A476)

### CVE ID

CVE-2017-5668

### GHSA ID

GHSA-x9m7-9m6q-c6hr

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-x9m7-9m6q-c6hr/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0117a316_20250126_113243.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitlbee%2Fbitlbee%2Fcommit%2F701ab8129ba9ea64f569daedca9a8603abad740f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitlbee%2Fbitlbee%2Fcommit%2F701ab8129ba9ea64f569daedca9a8603abad740f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=bitlbee%2Fbitlbee)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bitlbee](/bitlbee)
/
**[bitlbee](/bitlbee/bitlbee)**
Public

* [Notifications](/login?return_to=%2Fbitlbee%2Fbitlbee) You must be signed in to change notification settings
* [Fork
  119](/login?return_to=%2Fbitlbee%2Fbitlbee)
* [Star
   606](/login?return_to=%2Fbitlbee%2Fbitlbee)

* [Code](/bitlbee/bitlbee)
* [Pull requests
  6](/bitlbee/bitlbee/pulls)
* [Actions](/bitlbee/bitlbee/actions)
* [Security](/bitlbee/bitlbee/security)
* [Insights](/bitlbee/bitlbee/pulse)

Additional navigation options

* [Code](/bitlbee/bitlbee)
* [Pull requests](/bitlbee/bitlbee/pulls)
* [Actions](/bitlbee/bitlbee/actions)
* [Security](/bitlbee/bitlbee/security)
* [Insights](/bitlbee/bitlbee/pulse)

## Commit

[Permalink](/bitlbee/bitlbee/commit/701ab8129ba9ea64f569daedca9a8603abad740f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

imcb\_file\_send\_start: handle ft attempts from non-existing users

[Browse files](/bitlbee/bitlbee/tree/701ab8129ba9ea64f569daedca9a8603abad740f)
Browse the repository at this point in the history

* Loading branch information

[![@dequis](https://avatars.githubusercontent.com/u/94108?s=40&v=4)](/dequis)

[dequis](/bitlbee/bitlbee/commits?author=dequis "View all commits by dequis")
committed
Nov 13, 2016

1 parent
[fca4683](/bitlbee/bitlbee/commit/fca468311f1fd9880ed2ae4991b2ecc261fd34d5)

commit 701ab81

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[protocols/bee\_ft.c](#diff-584cae08fa42e2250be1d1a6be2965bf74f8b38bb205c87eda787a68ae10c698 "protocols/bee_ft.c")

Show comments

[View file](/bitlbee/bitlbee/blob/701ab8129ba9ea64f569daedca9a8603abad740f/protocols/bee_ft.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,7 +30,7 @@ file\_transfer\_t \*imcb\_file\_send\_start(struct im\_connection \*ic, char \*handle, ch |
|  |  | bee\_t \*bee = ic->bee; |
|  |  | bee\_user\_t \*bu = bee\_user\_by\_handle(bee, ic, handle); |
|  |  |  |
|  |  | if (bee->ui->ft\_in\_start) { |
|  |  | if (bee->ui->ft\_in\_start && bu) { |
|  |  | return bee->ui->ft\_in\_start(bee, bu, file\_name, file\_size); |
|  |  | } else { |
|  |  | return NULL; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 2 comments on commit `701ab81`

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&v=4)](/carnil)

Copy link

### @carnil **[carnil](/carnil)** commented on `[701ab81](/bitlbee/bitlbee/commit/701ab8129ba9ea64f569daedca9a8603abad740f)` [Jan 31, 2017](#commitcomment-20675335)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

CVE Request: <http://www.openwall.com/lists/oss-security/2017/01/30/4>

Sorry, something went wrong.

All reactions

[![@dequis](https://avatars.githubusercontent.com/u/94108?s=80&v=4)](/dequis)

Copy link

Member

Author

### @dequis **[dequis](/dequis)** commented on `[701ab81](/bitlbee/bitlbee/commit/701ab8129ba9ea64f569daedca9a8603abad740f)` [Jan 31, 2017](#commitcomment-20681281)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[CVE-2016-10189](https://github.com/advisories/GHSA-f3fv-7pqw-59cx "CVE-2016-10189") has been assigned for this

(see also [30d598c](https://github.com/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441) for a followup fix)

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitlbee%2Fbitlbee%2Fcommit%2F701ab8129ba9ea64f569daedca9a8603abad740f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_979157d3_20250126_113245.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitlbee%2Fbitlbee%2Fcommit%2F30d598ce7cd3f136e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitlbee%2Fbitlbee%2Fcommit%2F30d598ce7cd3f136e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=bitlbee%2Fbitlbee)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bitlbee](/bitlbee)
/
**[bitlbee](/bitlbee/bitlbee)**
Public

* [Notifications](/login?return_to=%2Fbitlbee%2Fbitlbee) You must be signed in to change notification settings
* [Fork
  119](/login?return_to=%2Fbitlbee%2Fbitlbee)
* [Star
   606](/login?return_to=%2Fbitlbee%2Fbitlbee)

* [Code](/bitlbee/bitlbee)
* [Pull requests
  6](/bitlbee/bitlbee/pulls)
* [Actions](/bitlbee/bitlbee/actions)
* [Security](/bitlbee/bitlbee/security)
* [Insights](/bitlbee/bitlbee/pulse)

Additional navigation options

* [Code](/bitlbee/bitlbee)
* [Pull requests](/bitlbee/bitlbee/pulls)
* [Actions](/bitlbee/bitlbee/actions)
* [Security](/bitlbee/bitlbee/security)
* [Insights](/bitlbee/bitlbee/pulse)

## Commit

[Permalink](/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

purple: Fix crash on ft requests from unknown contacts

[Browse files](/bitlbee/bitlbee/tree/30d598ce7cd3f136ee9d7097f39fa9818a272441)
Browse the repository at this point in the history

```
Followup to [701ab81](https://github.com/bitlbee/bitlbee/commit/701ab8129ba9ea64f569daedca9a8603abad740f) (included in 3.5) which was a partial fix which only
improved things for non-libpurple file transfers (that is, just jabber)
```

* Loading branch information

[![@dequis](https://avatars.githubusercontent.com/u/94108?s=40&v=4)](/dequis)

[dequis](/bitlbee/bitlbee/commits?author=dequis "View all commits by dequis")
committed
Jan 29, 2017

1 parent
[53cb4ae](/bitlbee/bitlbee/commit/53cb4ae80e54b89efebc7d19f739d17fc3286383)

commit 30d598c

Showing
**1 changed file**
with
**4 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[protocols/purple/ft.c](#diff-ffcf5777ff555a16c366bdf7257b8c778a6da0fdb77c09ad87b5a252ebda02ad "protocols/purple/ft.c")

Show comments

[View file](/bitlbee/bitlbee/blob/30d598ce7cd3f136ee9d7097f39fa9818a272441/protocols/purple/ft.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -145,6 +145,10 @@ static gboolean prplcb\_xfer\_new\_send\_cb(gpointer data, gint fd, b\_input\_conditio |
|  |  | /\* TODO(wilmer): After spreading some more const goodness in BitlBee, |
|  |  | remove the evil cast below. \*/ |
|  |  | px->ft = imcb\_file\_send\_start(ic, (char \*) who, xfer->filename, xfer->size); |
|  |  |  |
|  |  | if (!px->ft) { |
|  |  | return FALSE; |
|  |  | } |
|  |  | px->ft->data = px; |
|  |  |  |
|  |  | px->ft->accept = prpl\_xfer\_accept; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 2 comments on commit `30d598c`

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&v=4)](/carnil)

Copy link

### @carnil **[carnil](/carnil)** commented on `[30d598c](/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441)` [Jan 31, 2017](#commitcomment-20675332)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

CVE Request: <http://www.openwall.com/lists/oss-security/2017/01/30/4>

Sorry, something went wrong.

All reactions

[![@dequis](https://avatars.githubusercontent.com/u/94108?s=80&v=4)](/dequis)

Copy link

Member

Author

### @dequis **[dequis](/dequis)** commented on `[30d598c](/bitlbee/bitlbee/commit/30d598ce7cd3f136ee9d7097f39fa9818a272441)` [Jan 31, 2017](#commitcomment-20681284)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[CVE-2017-5668](https://github.com/advisories/GHSA-x9m7-9m6q-c6hr "CVE-2017-5668") has been assigned for this

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitlbee%2Fbitlbee%2Fcommit%2F30d598ce7cd3f136e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


