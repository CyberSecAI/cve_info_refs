=== Content from alephsecurity.com_e2ce5ca9_20250124_203449.html ===

[<-- א](/)

# OnePlus 3/3T OxygenOS Charger Boot Mode ADB Access

Aleph Research Advisory

## Identifier

[CVE-2017-5622](/vulns/aleph-2017004)
## Severity

Critical
## Products

1. OnePlus 3T
2. OnePlus 3
## Vulnerable Version

OxygenOS 4.0.2 and below.

## Mitigation

Upgrade to OxygenOS 4.0.3 or later.

## Technical Details

When a charger is connected to a powered off OnePlus 3/3T device, the platform starts `adbd` with [ADB authorization](https://android.googlesource.com/platform/system/core/%2B/master/adb/protocol.txt) disabled. Therefore, a malicious charger or a physical attacker can open up, without authorization, an ADB session with the device, in order to further exploit other vulnerabilities and/or exfiltrate information from the device. For example, the malicious charger can reboot the device into the bootloader mode (`fastboot`) in order to exploit `fastboot` related vulnerabilities, as detailed in the [blog post](/2017/03/26/oneplus3t-adb-charger/).

The following video presents how a ‘charger’ can exploit [CVE-2017-5622](/vulns/aleph-2017004) & [CVE-2017-5626](/vulns/aleph-2017003) for gaining a **root shell, putting SELinux in `permissive` mode, and even executing kernel code**:

The following video shows how a ‘charger’ exploits [CVE-2017-5622](/vulns/aleph-2017004), [CVE-2017-5624](/vulns/aleph-2017002) & [CVE-2017-5626](/vulns/aleph-2017003) for replacing the `system` partition in order to **install a privileged app**. Please note that once the replacement is complete, the victim has no indication that the device has been tampered with:

## Timeline

* 26-Mar-17: Public disclosure.
* 01-Mar-17: Added as [ALEPH-2017004](/vulns/aleph-2017004).
* 29-Jan-17: [CVE-2017-5622](/vulns/aleph-2017004) assigned.
* 25-Jan-17: CVE ID requested.
## Posts

* [Owning OnePlus 3/3T with a Malicious Charger: The Last Piece of the Puzzle](/2017/03/26/oneplus3t-adb-charger/)  By [Roee Hay](/authors/roeeh), 26-Mar 2017
## Credit

* [Roee Hay](/authors/roeeh) ([@roeehay](https://twitter.com/roeehay)) of Aleph Research, HCL Technologies


