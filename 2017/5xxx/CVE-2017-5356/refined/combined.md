=== Content from www.openwall.com_4b1d196d_20250125_044303.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2017/01/12/8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <234ac7fe83fb46f8b571574565bd4e36@imshyb02.MITRE.ORG>
Date: Thu, 12 Jan 2017 21:47:13 -0500
From: <cve-assign@...re.org>
To: <ailin.nemui@...il.com>
CC: <cve-assign@...re.org>, <oss-security@...ts.openwall.com>
Subject: Re: CVE Request: Irssi out of bounds read in format string

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> - Printing the value %[ leads to oob read
> <https://blog.fuzzing-project.org/55-Fuzzing-Irssi-with-Perl-Scripts.html>

Use CVE-2017-5356.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJYeD88AAoJEHb/MwWLVhi2li0P/2G3s2BZ1aKfD6AE6RL9S1nz
DGFt6rX1OpYLBLsq0+C/6a4w8WN1Rih6LmlADwzDb6E93TY8eyfaF2jCPg5VUL1I
ZMLsAFL7WkrfJKiMItoYPDr6eKzXH1SCsuukaNFmuVCpxJS+cWuaQJKI0/Y+wrEo
zFRLTLWkx02EvicjwgdJ5+oWtp9PEpgjiAFD5fYkMG/PHWUyQIt1CYo4vTh3uvY3
m/z1ur0Eh35WSPFpxHMbUmMIi1fzVohcJTGvbXmR+EWwfRmudENrVPSFdUgCZAmh
0uQa+5it6eYPaorz67Hv9zUtEcNUzcibk/cepfNpY/rWWqJb7M2Wtg88J0YBysSS
C39Dnd6v06/2RkyZGWga8N9TF5UIty2Oljhyjrmfkw9p/ko7DJoS+F8SmDR32qtO
fB1YrhVXoXvZRj108vdtipl46w2xWL5+yP8fHTqZjRnEMRUrI308MrfjWW4UGyMi
ebLCN0uWtTXMC0TQCbXIhVNnDFhQlBRTpcxlWtuc6GDjvVCCBIWjFVB8jHUUIVBO
B+L+CQtcVoFmxz1470iodzHVjWIR7lagJp6KxaaSKQcMU+5Q2djHLw6nVuxsHC6y
o1t8u8SHXiLQSqyGImTuy/Ntvj4+yXABy5jzT2Y7XlS7dXhoSG9hu7PPsxGxIA6w
qNa+XrGe0DuQj87/bXYO
=ARuT
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.debian.org_e647c703_20250125_044305.html ===


---

[[Date Prev](msg00021.html)][[Date Next](msg00023.html)]
[[Thread Prev](msg00021.html)][[Thread Next](msg00023.html)]
[[Date Index](maillist.html#00022)]
[[Thread Index](threads.html#00022)]

# [SECURITY] [DLA 1217-1] irssi security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1217-1] irssi security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Sat, 23 Dec 2017 14:17:03 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/aa4f939b-9165-0f4f-aeee-c75127a663c9%40debian.org)Â [aa4f939b-9165-0f4f-aeee-c75127a663c9@debian.org](msg00022.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Package        : irssi
Version        : 0.8.15-5+deb7u4
CVE ID         : CVE-2017-5193 CVE-2017-5194 CVE-2017-5356 CVE-2017-15227
                 CVE-2017-15228 CVE-2017-15721 CVE-2017-15722
Debian Bug     : 879521

Multiple vulnerabilities have been discovered in Irssi, a terminal based
IRC client, which may lead to denial of service or other unspecified
impact.

For Debian 7 "Wheezy", these problems have been fixed in version
0.8.15-5+deb7u4.

We recommend that you upgrade your irssi packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAlo+V0IACgkQnUbEiOQ2
gwLLexAAjc4jjf0Ip6Gw4eEza+6VAhjcSkeef/7TC2Kp0aWszpjn3Se8QlHu+JsL
FntCL3o2qlvoor4YVsN+J/YHaLPmIRx6n1ch5bVSVdsRQC3QQ55fYeRtaXhgSJxd
fsdTbhFc5qmtUraCf91e8HZnotC7sWejHwR9VaGBRYmQeTv1T95BY1asKIRsx2go
csIXK/BkxLerRf/0kZNSQy1D7pO1z3Tl116Re1giz1EF60DF7Ty3c/QnxSjHqMne
ebbIHuj19pYcwihsgyvlvAGJuTCO/QfgSF6+omZI2CvC2AyE2q6kEF0iA24Q+kpv
xwrVeiPFdAKr7iW7jXr8bCxM4l0r97fDt21PbXm+7B1LWNPq/TwQ3o8hRHzzZREa
khDdtVpQcRuhlcYAcmaebpYYAsQi8L3r4KAHyTOfuZhHTv1jDY7Ive8ToDj40a53
2anVhqMcpbf1p6s0pLwN7+J8BEh/zOpCgMVDLsNQUAwDnfjrXcPe8F0btEi/PpN8
8ERHHsKQI9r+wO5YoyB9qH6mWE9JgvcqYvGk9rJHe4H6Qak5vsQPwJXNBp+byJXE
cz4LyMjeKSXm4uGK9Hyhl2J89tt62sA8YmAL2YXdZu0p01Grr5Uiin5mu+G45t07
lvGMYlOQeOwr4H8Hly00nD2Ody7+wQwtjBjtjcpZp+FPN9Zrjss=
=+spK
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_d0e20699_20250125_044303.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[thread-next>]](../../../2017/01/13/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1484223894.26049.11.camel@gmail.com>
Date: Thu, 12 Jan 2017 13:24:54 +0100
From: Ailin Nemui <ailin.nemui@...il.com>
To: oss-security@...ts.openwall.com
Subject: CVE Request: Irssi out of bounds read in format string

Hi,

can you please check whether the following Irssi issue needs a CVE

- Printing the value %[ leads to oob read

This has been reported to the Irssi project by Hanno BÃ¶ck and is
already fixed as part of the last CVE request, however I failed to
include this issue in the initial report. Hanno has blogged about this
at [1] and linked it to the other issue which we credited him for (but
it is in fact a separate issue).

Thanks,

[1] <https://blog.fuzzing-project.org/55-Fuzzing-Irssi-with-Perl-Scripts.html>

On Thu, 2017-01-05 at 15:45 +0100, Ailin Nemui wrote:
> Dear oss-security List,
>
> Please provide some CVEs for the following issues.
>
> Thanks,
>
>
> Multiple vulnerabilities in Irssi [1]
> =====================================
>
>
> Description
> -----------
>
> Four vulnerabilities have been located in Irssi.
>
> (a) A NULL pointer dereference in the nickcmp function found by Joseph
>     Bisch. (CWE-690)
>
> (b) Use after free when receiving invalid nick message (Issue #466, CWE-146)
>
> (c) Out of bounds read in certain incomplete control codes found by
>     Joseph Bisch. (CWE-126)
>
> (d) Out of bounds read in certain incomplete character sequences found
>     by Hanno BÃ¶ck and independently by J. Bisch. (CWE-126)
>
>
> Impact
> ------
>
> These issues may result in denial of service (remote crash).
>
>
> Affected versions
> -----------------
>
> (a) All Irssi versions that we observed
> (b) All Irssi versions that we observed
> (c) Irssi 0.8.17 and later
> (d) Irssi 0.8.18 and later
>
>
> Fixed in
> --------
>
> Irssi 0.8.21, Irssi 1.0.0
>
>
> Recommended action
> ------------------
>
> Upgrade to Irssi 0.8.21. Irssi 0.8.21 is a maintenance release
> without any new features.
>
> After installing the updated packages, one can issue the /upgrade
> command to load the new binary. TLS connections will require
> /reconnect.
>
>
> A Note to Distributors
> ----------------------
>
> First of all, thanks to every maintainer for their awesome job in
> packaging Irssi and backporting security fixes.
>
> When we had to release a security advisory last year with Irssi
> 0.8.20, we noticed there was a huge confusion amongst Ubuntu users
> about whether their Irssi version was safe to use.
>
> Since all our releases 0.8.19, 0.8.20 and 0.8.21 have been bug
> fix only, we think distributions should just ship the release.
>
> But if the security fixes only are backported on top of an old
> version, we would like to urge distributions to consider indicating
> this in a way that is visible inside Irssi. One way to do this would
> be to manually overwrite the PACKAGE_VERSION and marking your package
> as patched. This can be done for example like this:
>
>   ./configure PACKAGE_VERSION=0.8.17-sa201701
>
>
> You can then check the version from inside Irssi with /eval echo $J
>
> As an added benefit over relying on dpkg, this will also correctly
> report whether you had /upgrade done or not. We are looking for a ways
> to make this easier to handle for both packagers and us, so if you
> have a good idea on this matter please speak forth.
>
>
> Mitigating facts
> ----------------
>
> (a) requires control over the ircd
>
> (b), (d) require control over the ircd or otherwise can be triggered /
>     avoided by the user themselves
>
>
> Patch
> -----
>
> <https://github.com/irssi/irssi/commit/6c6c42e3d1b49d90aacc0b67f8540471cae02a1d>
>
>
> References
> ----------
>
> [1] <https://irssi.org/security/irssi_sa_2017_01.txt>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from blog.fuzzing-project.org_656461a3_20250125_044304.html ===

[Skip to content](#content)
[# The Fuzzing Project

Blog and Advisories](https://blog.fuzzing-project.org/)

Quicksearch

## Navigation

* [Back to main page](https://fuzzing-project.org/)
* [Software list](https://fuzzing-project.org/software.html)

## [Fuzzing Irssi with Perl Scripts](/55-Fuzzing-Irssi-with-Perl-Scripts.html)

Posted by [Hanno BÃ¶ck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Friday, January 6. 2017

When using fuzzing tools like afl a common challenge is how you can pass input to the interesting parts of the application you want to fuzz. In easy situations we have a tool that will accept our input as a file or via stdin. However sometimes this is not easily possible.

Let's have a look at Irssi, an irc chat client. The only input you can pass on the command line is a config file. Fuzzing Irssi 0.8.10 easily led to [a segfault caused by a null pointer access](https://github.com/irssi/irssi/issues/550). However while bugs in config file parsers probably still should be fixed, usually they are not very interesting. (There [can be exceptions](https://blog.fuzzing-project.org/8-Why-it-can-make-sense-to-fuzz-config-files-two-out-of-bounds-vulnerabilities-in-curl-TFPA-0042015.html).)

So what else might be interesting? Irssi does some parsing on all output, e.g. due to [color codes](https://irssi.org/documentation/settings/#a_d). However we can't just print text that is passed via the command line as an input file. We have to abuse Irssi's perl scripting capability for that.

We can place a [simple perl script](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-print.pl) that will read a file (`fuzzp.txt`) and print it into Irssi's autorun directory (default location is ~/.Irssi/scripts/autorun/). We can then place some [examples of Irssi color codes](https://gitlab.com/hanno/irssi-fuzzing/blob/master/irssi-example-colorcodes.txt) into the directory "in/". I have installed an afl/asan-instrumented Irssi into my system to `/usr/local/`, because for running perl scripts it needs more than just the executable. So we can run afl like this:

`afl-fuzz -i in -o out -m none -f fuzzp.txt Irssi`

afl will put the fuzzed output into `fuzzp.txt` and our autoload script will read it from there. Doing this lets us learn that the sequence "%[" causes Irssi to read an invalid memory byte. For reasons unclear to me this only happens if a script outputs this sequence, not if a user types it in. (This issue got [CVE-2017-5196](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5196) assigned.)

We can go further and do a [similar script that executes input as a command](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-command.pl). Commands are things like "/QUIT" that control the application and the channel behavior. I named the input file `fuzzc.txt`, so we can place some [simple Irssi commands](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-command.pl) into `in/` and run:

`afl-fuzz -i in -o out -m none -f fuzzc.txt Irssi`

Thus we will now fuzz Irssi's command processing.

As we have seen, scripting functionality can be used to fuzz an application. So if you want to fuzz something and don't know how to pass input: See if there's a scripting functionality.

*Irssi has issued a [security advisory for several security vulnerabilities](https://irssi.org/security/irssi_sa_2017_01.txt), including the out of bounds read mentioned above. All vulnerabilities and the config file parser segfault are fixed in 0.8.21 and 1.0.0.*

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/55-Fuzzing-Irssi-with-Perl-Scripts.html#comments "0 Comments, 0 Trackbacks")

### Trackbacks

[Trackback specific URI for this entry](https://blog.fuzzing-project.org/comment.php?type=trackback&entry_id=55 "This link is not meant to be clicked. It contains the trackback URI for this entry. You can use this URI to send ping- & trackbacks from your own blog to this entry. To copy the link, right click and select \"Copy Shortcut\" in Internet Explorer or \"Copy Link Location\" in Mozilla.")

No Trackbacks

### Comments

Display comments as
[Linear](/index.php?url=55-Fuzzing-Irssi-with-Perl-Scripts.html&serendipity%5Bcview%5D=linear#comments) | Threaded

No comments

### Add Comment

Name

Email

Homepage

Comment

In reply to
[ Top level ]

Phone\*

What is five plus five?

Enclosing asterisks marks text as bold (\*word\*), underscore are made via \_word\_.Standard emoticons like :-) and ;-) are converted to images.E-Mail addresses will not be displayed and will only be used for E-Mail notifications.

To prevent automated Bots from commentspamming, please enter the string you see in the image below in the appropriate input box. Your comment will only be submitted if the strings match. Please ensure that your browser supports and accepts cookies, or your comment cannot be verified correctly.
![CAPTCHA](https://blog.fuzzing-project.org/plugin/captcha_b1d70441dd964904f69dee7fed10639f "Enter the string you see here in the input box!")
Enter the string from the spam-prevention image above:

Form options
Remember Information?

Subscribe to this entry

## Sidebar

### The Fuzzing Project

You may want to go [back to the Fuzzing Project's main page](https://fuzzing-project.org/) or [software list](https://fuzzing-project.org/software/).

### Archives

* [January 2025](/archives/2025/01.html "January 2025")
* [December 2024](/archives/2024/12.html "December 2024")
* [November 2024](/archives/2024/11.html "November 2024")
* [Recent...](/index.php?frontpage)
* [Older...](https://blog.fuzzing-project.org/archive)

### Categories

* [![XML](/templates/2k11/img/xml.gif)](/feeds/categories/1-advisories.rss) [advisories](/categories/1-advisories)

### Syndicate This Blog

* [![XML](/templates/2k11/img/subtome.png)](https://blog.fuzzing-project.org/feeds/index.rss2)
* [![XML](/templates/2k11/img/xml.gif)](https://blog.fuzzing-project.org/feeds/comments.rss2)
  [Comments](https://blog.fuzzing-project.org/feeds/comments.rss2)

Powered by [Serendipity](http://s9y.org) & the *2k11* theme.



=== Content from blog.fuzzing-project.org_656461a3_20250126_060148.html ===

[Skip to content](#content)
[# The Fuzzing Project

Blog and Advisories](https://blog.fuzzing-project.org/)

Quicksearch

## Navigation

* [Back to main page](https://fuzzing-project.org/)
* [Software list](https://fuzzing-project.org/software.html)

## [Fuzzing Irssi with Perl Scripts](/55-Fuzzing-Irssi-with-Perl-Scripts.html)

Posted by [Hanno BÃ¶ck](https://blog.fuzzing-project.org/authors/1-Hanno-Boeck) on Friday, January 6. 2017

When using fuzzing tools like afl a common challenge is how you can pass input to the interesting parts of the application you want to fuzz. In easy situations we have a tool that will accept our input as a file or via stdin. However sometimes this is not easily possible.

Let's have a look at Irssi, an irc chat client. The only input you can pass on the command line is a config file. Fuzzing Irssi 0.8.10 easily led to [a segfault caused by a null pointer access](https://github.com/irssi/irssi/issues/550). However while bugs in config file parsers probably still should be fixed, usually they are not very interesting. (There [can be exceptions](https://blog.fuzzing-project.org/8-Why-it-can-make-sense-to-fuzz-config-files-two-out-of-bounds-vulnerabilities-in-curl-TFPA-0042015.html).)

So what else might be interesting? Irssi does some parsing on all output, e.g. due to [color codes](https://irssi.org/documentation/settings/#a_d). However we can't just print text that is passed via the command line as an input file. We have to abuse Irssi's perl scripting capability for that.

We can place a [simple perl script](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-print.pl) that will read a file (`fuzzp.txt`) and print it into Irssi's autorun directory (default location is ~/.Irssi/scripts/autorun/). We can then place some [examples of Irssi color codes](https://gitlab.com/hanno/irssi-fuzzing/blob/master/irssi-example-colorcodes.txt) into the directory "in/". I have installed an afl/asan-instrumented Irssi into my system to `/usr/local/`, because for running perl scripts it needs more than just the executable. So we can run afl like this:

`afl-fuzz -i in -o out -m none -f fuzzp.txt Irssi`

afl will put the fuzzed output into `fuzzp.txt` and our autoload script will read it from there. Doing this lets us learn that the sequence "%[" causes Irssi to read an invalid memory byte. For reasons unclear to me this only happens if a script outputs this sequence, not if a user types it in. (This issue got [CVE-2017-5196](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5196) assigned.)

We can go further and do a [similar script that executes input as a command](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-command.pl). Commands are things like "/QUIT" that control the application and the channel behavior. I named the input file `fuzzc.txt`, so we can place some [simple Irssi commands](https://gitlab.com/hanno/irssi-fuzzing/blob/master/fuzz-command.pl) into `in/` and run:

`afl-fuzz -i in -o out -m none -f fuzzc.txt Irssi`

Thus we will now fuzz Irssi's command processing.

As we have seen, scripting functionality can be used to fuzz an application. So if you want to fuzz something and don't know how to pass input: See if there's a scripting functionality.

*Irssi has issued a [security advisory for several security vulnerabilities](https://irssi.org/security/irssi_sa_2017_01.txt), including the out of bounds read mentioned above. All vulnerabilities and the config file parser segfault are fixed in 0.8.21 and 1.0.0.*

Categories: [advisories](https://blog.fuzzing-project.org/categories/1-advisories) | [0 Comments](/55-Fuzzing-Irssi-with-Perl-Scripts.html#comments "0 Comments, 0 Trackbacks")

### Trackbacks

[Trackback specific URI for this entry](https://blog.fuzzing-project.org/comment.php?type=trackback&entry_id=55 "This link is not meant to be clicked. It contains the trackback URI for this entry. You can use this URI to send ping- & trackbacks from your own blog to this entry. To copy the link, right click and select \"Copy Shortcut\" in Internet Explorer or \"Copy Link Location\" in Mozilla.")

No Trackbacks

### Comments

Display comments as
[Linear](/index.php?url=55-Fuzzing-Irssi-with-Perl-Scripts.html&serendipity%5Bcview%5D=linear#comments) | Threaded

No comments

### Add Comment

Name

Email

Homepage

Comment

In reply to
[ Top level ]

Phone\*

What is eight minus four?

Enclosing asterisks marks text as bold (\*word\*), underscore are made via \_word\_.Standard emoticons like :-) and ;-) are converted to images.E-Mail addresses will not be displayed and will only be used for E-Mail notifications.

To prevent automated Bots from commentspamming, please enter the string you see in the image below in the appropriate input box. Your comment will only be submitted if the strings match. Please ensure that your browser supports and accepts cookies, or your comment cannot be verified correctly.
![CAPTCHA](https://blog.fuzzing-project.org/plugin/captcha_a832a93db68db554fd1ee75420313dcb "Enter the string you see here in the input box!")
Enter the string from the spam-prevention image above:

Form options
Remember Information?

Subscribe to this entry

## Sidebar

### The Fuzzing Project

You may want to go [back to the Fuzzing Project's main page](https://fuzzing-project.org/) or [software list](https://fuzzing-project.org/software/).

### Archives

* [January 2025](/archives/2025/01.html "January 2025")
* [December 2024](/archives/2024/12.html "December 2024")
* [November 2024](/archives/2024/11.html "November 2024")
* [Recent...](/index.php?frontpage)
* [Older...](https://blog.fuzzing-project.org/archive)

### Categories

* [![XML](/templates/2k11/img/xml.gif)](/feeds/categories/1-advisories.rss) [advisories](/categories/1-advisories)

### Syndicate This Blog

* [![XML](/templates/2k11/img/subtome.png)](https://blog.fuzzing-project.org/feeds/index.rss2)
* [![XML](/templates/2k11/img/xml.gif)](https://blog.fuzzing-project.org/feeds/comments.rss2)
  [Comments](https://blog.fuzzing-project.org/feeds/comments.rss2)

Powered by [Serendipity](http://s9y.org) & the *2k11* theme.



=== Content from irssi.org_4d2694d4_20250125_044304.html ===
IRSSI-SA-2017-01 Irssi Security Advisory [1]
============================================
CVE-2017-5193, CVE-2017-5194, CVE-2017-5356, CVE-2017-5195, CVE-2017-5196
Description
-----------
Multiple vulnerabilities have been located in Irssi.
(a) NULL pointer dereference in the nickcmp function found by Joseph
Bisch. (CWE-690)
CVE-2017-5193 [2] was assigned to this issue.
(b) Use after free when receiving invalid nick message. (CWE-417)
CVE-2017-5194 [3] was assigned to this issue.
(c) Out of bounds read when printing the value %[ found by Hanno BÃ¶ck.
(CWE-126)
CVE-2017-5356 [4] was assigned to this issue.
(d) Out of bounds read in certain incomplete control codes found by
Joseph Bisch. (CWE-126)
CVE-2017-5195 [5] was assigned to this issue.
(e) Out of bounds read in certain incomplete character sequences found
by Hanno BÃ¶ck and independently by Joseph Bisch. (CWE-126)
CVE-2017-5196 [6] was assigned to this issue.
Impact
------
These issues may result in denial of service (remote crash).
Affected versions
-----------------
(a) All Irssi versions that we observed
(b) All Irssi versions that we observed
(c) All Irssi versions that we observed
(d) Irssi 0.8.17 and later
(e) Irssi 0.8.18 and later
Fixed in
--------
Irssi 0.8.21, Irssi 1.0.0
Recommended action
------------------
Upgrade to Irssi 0.8.21. Irssi 0.8.21 is a maintenance release without
any new features.
After installing the updated packages, one can issue the /upgrade
command to load the new binary. TLS connections will require /reconnect.
A Note to Distributors
----------------------
First of all, thanks to every maintainer for their awesome job in
packaging Irssi and backporting security fixes.
When we had to release a security advisory last year with Irssi 0.8.20,
we noticed there was a huge confusion amongst Ubuntu users about whether
their Irssi version was safe to use.
Since all our releases 0.8.18, 0.8.19, 0.8.20 and 0.8.21 have been bug
fix only, we think distributions should just ship the release.
But if the security fixes only are backported on top of an old version,
we would like to urge distributions to consider indicating this in a way
that is visible inside Irssi. One way to do this would be to manually
overwrite the PACKAGE\_VERSION and marking your package as patched. This
can be done for example like this:
./configure PACKAGE\_VERSION=0.8.17-sa201701
You can then check the version from inside Irssi with /eval echo $J
As an added benefit over relying on dpkg, this will also correctly
report whether you had /upgrade done or not. We are looking for a ways
to make this easier to handle for both packagers and us, so if you have
a good idea on this matter please speak forth.
Mitigating facts
----------------
(a) requires control over the ircd
(b) require control over the ircd or otherwise can be triggered /
avoided by the user themselves
(c) can be triggered / avoided by the user themselves
(e) require control over the ircd or otherwise can be triggered /
avoided by the user themselves
Patch
-----
https://github.com/irssi/irssi/commit/6c6c42e3d1b49d90aacc0b67f8540471cae02a1d
Discussion
----------
(a) CVE-2017-5193: A NULL pointer dereference in the nickcmp function
found by Joseph Bisch.
The irc\_query\_find function will call nick\_comp\_func in order to
retrieve an associated existing query.
However, the precondition whether nick was not NULL was not
verified, leading to incorrect API usage of the nick\_comp\_func and
ultimately NULL pointer dereference resulting in a crash whenever
the server produced such a message without nick.
(b) CVE-2017-5194: Use after free when receiving invalid nick message.
Irssi is programmed to cancel the connection when the server
indicates an invalid nick during the registration phase (in the
event\_nick\_invalid function), because Irssi cannot recover from
this.
A complex (and still not properly fixed) chain of signal
dependencies emitted by the server\_disconnect function, combined
with the lack of reference counting, leads to multiple use after
free issues when the server object has already been destroyed, but
there is currently no way to inform the surrounding code of this
fact.
As a mitigation, the server\_disconnect function is no longer used
in this case and instead the clean-up is pushed to some upper layer.
Fixing this properly will still be a lot of work.
(c) CVE-2017-5356: Out of bounds read when Printing the value %[ Found
by Hanno BÃ¶ck.
The formatting sequence %[...] can be used to execute the timestamp
and "line\_start" commands on each printed line.
The scanner in format\_expand\_styles will expect it to read unto the
closing ], but in case the end of string has already been reached
while searching for the closing bracket, calling code is not
prepared to deal with this and may advance the char\* beyond end of
string.
(d) CVE-2017-5195: Out of bounds read in certain incomplete control
codes found by Joseph Bisch.
While parsing the ANSI x8 colour codes, Irssi in many cases failed
to check whether the end of string had already been reached,
resulting in this vulnerability.
(e) CVE-2017-5196: Out of bounds read in certain incomplete character
sequences found by Hanno BÃ¶ck and independently by J. Bisch.
When copying characters to the terminal screen in the term\_addstr
function, the g\_utf8\_get\_char function was used unconditionally
without verifying that the input string is proper utf8. As the
behaviour of that function is undefined for invalid input, it would
result in this invalid memory access. The correction is to use the
g\_utf8\_get\_char\_validated function instead.
References
----------
[1] https://irssi.org/security/irssi\_sa\_2017\_01.txt
[2] https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5193
[3] https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5194
[4] https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5356
[5] https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5195
[6] https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5196

