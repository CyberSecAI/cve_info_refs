Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability stems from a concurrency issue when using virtual attributes in NetIQ Access Manager (NAM) Identity Server. Specifically, it occurs when NAM acts as a SAML 2.0 Identity Server and populates the NameIdentifier value in SAML assertions with a virtual attribute.

**Weaknesses/Vulnerabilities:**
- **Concurrency Issue:** The core weakness is a concurrency problem related to how virtual attributes are handled within the NAM Identity Server. This leads to inconsistent data being used in SAML assertions.
- **Stale Profile:**  The vulnerability manifests as users receiving stale profiles after being redirected to the NAM Identity Server for login. This indicates that the SAML assertion generated by the Identity Server contains outdated or incorrect data for the user.
- **Information Leakage:** While the document doesn't explicitly detail the specific information leaked, the description of a "stale profile" implies that potentially sensitive user information may be exposed or improperly used due to incorrect/outdated attributes being included in the assertion.

**Impact of Exploitation:**
- **Stale User Data:** Users accessing applications through SAML Single Sign-On (SSO) may receive a stale profile. This can lead to inconsistent application behavior, access issues, or the application displaying incorrect data.
- **Potential Unauthorized Access/Privilege Escalation**: Depending on how the application uses the attributes in the assertion, a stale profile or incorrect data could lead to unauthorized access or privilege escalation.

**Attack Vectors:**
- **SAML SSO Redirection:** The attack vector is triggered during the normal SAML SSO process. When a user is redirected to the NAM Identity Server for authentication and then redirected back to the Service Provider (SP), the vulnerability manifests.

**Required Attacker Capabilities/Position:**
- **Valid User Credentials:** The attacker must be a valid user with access to the application via the SAML SP.
- **Normal Access:** No special attacker position is needed, this vulnerability is triggered during normal usage of the SAML SSO flow.
- **Exploitation triggered by concurrency issue:** The exploitation is due to the concurrency issue in the NAM server, therefore, no specific malicious action is required other than using the SSO.

**Additional details:**
- The issue only occurs when using virtual attributes to populate the NameIdentifier.
- The problem is not consistently reproducible but occurs at an "indeterminate frequency".

**Remediation:**
- The recommended resolution is to apply specific hotfix patches provided by Micro Focus: "NAM 4.2 SP3 Hot Fix 1" for NAM 4.2 builds and "NAM 4.3 SP1 Hot Fix 1" for NAM 4.3 builds.
- A workaround is also provided which involves writing virtual attribute values to the LDAP user store and then retrieving that attribute to inject into the assertion, effectively bypassing the problematic virtual attribute retrieval mechanism.