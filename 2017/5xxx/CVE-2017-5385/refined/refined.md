```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability lies in how Firefox handles `Referrer-Policy` headers when processing HTML documents delivered via `multipart/x-mixed-replace` MIME type. The browser fails to properly apply the `Referrer-Policy` specified in the response header for these documents.",
    "weaknesses": [
      "Improper handling of `Referrer-Policy` header with `multipart/x-mixed-replace`",
      "Information disclosure due to leakage of referrer information"
    ],
    "impact": "A malicious server can cause the browser to send referrer information that it normally wouldn't send based on the referrer policy, potentially exposing sensitive data about the previous page visited by a user. For example, if a user navigates from a page containing authentication tokens in the URL to a multipart/x-mixed-replace page, that authentication token could be disclosed.",
    "attack_vectors": [
      "A malicious server hosting a `multipart/x-mixed-replace` resource",
     "A legitimate server configured with `multipart/x-mixed-replace` incorrectly",
     "A man-in-the-middle attack modifying the server response to use `multipart/x-mixed-replace`"
    ],
    "required_attacker_capabilities": [
      "Ability to host or modify server responses for a client",
       "Knowledge of the vulnerability"
    ],
      "additional_information": "The vulnerability occurs because the browser's parsing logic for referrer policy doesn't properly handle `multipart/x-mixed-replace` responses. While the primary vulnerability is a disclosure of the referrer, the vulnerability also applies to  other headers such as `X-Frame-Options` when specified in each fragment part of HTTP response body (2), while not ignored when specified in HTTP headers (1). The fix involves ensuring that the `Referrer-Policy` is extracted and applied correctly."
  }
}
```