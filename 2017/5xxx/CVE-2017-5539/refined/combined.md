=== Content from github.com_80b2ab95_20250124_213957.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fb2evolution%2Fb2evolution%2Fissues%2F36)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fb2evolution%2Fb2evolution%2Fissues%2F36)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=b2evolution%2Fb2evolution)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[b2evolution](/b2evolution)
/
**[b2evolution](/b2evolution/b2evolution)**
Public

* [Notifications](/login?return_to=%2Fb2evolution%2Fb2evolution) You must be signed in to change notification settings
* [Fork
  88](/login?return_to=%2Fb2evolution%2Fb2evolution)
* [Star
   178](/login?return_to=%2Fb2evolution%2Fb2evolution)

* [Code](/b2evolution/b2evolution)
* [Issues
  3](/b2evolution/b2evolution/issues)
* [Pull requests
  4](/b2evolution/b2evolution/pulls)
* [Discussions](/b2evolution/b2evolution/discussions)
* [Actions](/b2evolution/b2evolution/actions)
* [Projects
  0](/b2evolution/b2evolution/projects)
* [Security](/b2evolution/b2evolution/security)
* [Insights](/b2evolution/b2evolution/pulse)

Additional navigation options

* [Code](/b2evolution/b2evolution)
* [Issues](/b2evolution/b2evolution/issues)
* [Pull requests](/b2evolution/b2evolution/pulls)
* [Discussions](/b2evolution/b2evolution/discussions)
* [Actions](/b2evolution/b2evolution/actions)
* [Projects](/b2evolution/b2evolution/projects)
* [Security](/b2evolution/b2evolution/security)
* [Insights](/b2evolution/b2evolution/pulse)

# traversal directory #36

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[traversal directory](#top)#36Copy link[![@blackwolfsec](https://avatars.githubusercontent.com/u/18306740?u=55bd379126819011c2681faee03dae24c47fccae&v=4&size=80)](/blackwolfsec)
## Description

[![@blackwolfsec](https://avatars.githubusercontent.com/u/18306740?u=55bd379126819011c2681faee03dae24c47fccae&v=4&size=48)](/blackwolfsec)[blackwolfsec](https://github.com/blackwolfsec)opened [on Jan 17, 2017](https://github.com/b2evolution/b2evolution/issues/36#issue-201160772)

hi:

I'm sorry to find that this patch of traversal directory is flawed in version 6.8.4-stable，an attacker can alse exploit this vulnerability to delete or read any files on the server,it can also be used to determine whether a file exists. I will send you an email for the details.

My email is blackwolf5240@gmail.com

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_3264e75e_20250124_213956.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fb2evolution%2Fb2evolution%2Fcommit%2Fe35f7c195d8c1103d2d981a48cda5ab45ecac48a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fb2evolution%2Fb2evolution%2Fcommit%2Fe35f7c195d8c1103d2d981a48cda5ab45ecac48a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=b2evolution%2Fb2evolution)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[b2evolution](/b2evolution)
/
**[b2evolution](/b2evolution/b2evolution)**
Public

* [Notifications](/login?return_to=%2Fb2evolution%2Fb2evolution) You must be signed in to change notification settings
* [Fork
  88](/login?return_to=%2Fb2evolution%2Fb2evolution)
* [Star
   178](/login?return_to=%2Fb2evolution%2Fb2evolution)

* [Code](/b2evolution/b2evolution)
* [Issues
  3](/b2evolution/b2evolution/issues)
* [Pull requests
  4](/b2evolution/b2evolution/pulls)
* [Discussions](/b2evolution/b2evolution/discussions)
* [Actions](/b2evolution/b2evolution/actions)
* [Projects
  0](/b2evolution/b2evolution/projects)
* [Security](/b2evolution/b2evolution/security)
* [Insights](/b2evolution/b2evolution/pulse)

Additional navigation options

* [Code](/b2evolution/b2evolution)
* [Issues](/b2evolution/b2evolution/issues)
* [Pull requests](/b2evolution/b2evolution/pulls)
* [Discussions](/b2evolution/b2evolution/discussions)
* [Actions](/b2evolution/b2evolution/actions)
* [Projects](/b2evolution/b2evolution/projects)
* [Security](/b2evolution/b2evolution/security)
* [Insights](/b2evolution/b2evolution/pulse)

## Commit

[Permalink](/b2evolution/b2evolution/commit/e35f7c195d8c1103d2d981a48cda5ab45ecac48a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge branch 'develop'

[Browse files](/b2evolution/b2evolution/tree/e35f7c195d8c1103d2d981a48cda5ab45ecac48a)
Browse the repository at this point in the history

* Loading branch information

[![@fplanque](https://avatars.githubusercontent.com/u/1156771?s=40&v=4)](/fplanque)

[fplanque](/b2evolution/b2evolution/commits?author=fplanque "View all commits by fplanque")
committed
Jan 19, 2017

2 parents
[551702a](/b2evolution/b2evolution/commit/551702a31751ac1f98ea89e1ef62794294f6f3a2)
+
[255e4d1](/b2evolution/b2evolution/commit/255e4d1512a208d310c7ea3c583032e8db0c6a43)

commit e35f7c1

 Show file tree

 Hide file tree

Showing
**97 changed files**
with
**4,503 additions**
and
**608 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Gruntfile.js
  [Gruntfile.js](#diff-8e7e5f941c67b0cf481a9d650295119d4922b96117e7adc069ba30a81a78c65f)
* conf

  + conf/\_advanced.php
    [\_advanced.php](#diff-27567b914bc416c62a8b094ca8a1fc562b9791da033d92e2c27e1cadc0cbf2d4)
  + conf/\_application.php
    [\_application.php](#diff-37e07dbbf719c6a024127cc10df411e5d6f28ecfbaa53069e9194081f6591176)
* htsrv

  + htsrv/anon\_async.php
    [anon\_async.php](#diff-7b09f753a6e1c2163c711db0d330d2e574d9edf4e28c539019136b7407e19d24)
  + htsrv/async.php
    [async.php](#diff-a003e8cd18fb57ccb3c845434d700007d2aae7b1bfb1f9de58b4ae2e1cd3b3ea)
  + htsrv/getfile.php
    [getfile.php](#diff-a0feaf6c6dfcde696650ae6a95b96c50df4bddfbec713856bfa76bbd43ebca3f)
  + htsrv/quick\_unsubscribe.php
    [quick\_unsubscribe.php](#diff-ebd1fd831a016641567124ccf01bd5f86426c68c244f646f7e652ff8b2a86613)
  + htsrv/quick\_upload.php
    [quick\_upload.php](#diff-e020583c399c424db5473fb7791a15d8dc5e4aedc16349229ff2ec2660cfcdd1)
  + htsrv/viewfile.php
    [viewfile.php](#diff-0d791bc0b916698cd3ed71fb06eee22cd97f2e22712e907d07581fbdb71b980b)
* inc

  + \_core

    - inc/\_core/\_misc.funcs.php
      [\_misc.funcs.php](#diff-9f735d225e5092d6e022a15d842fde12c85773aab660685530d7473f101b612e)
    - inc/\_core/\_param.funcs.php
      [\_param.funcs.php](#diff-991cbdd6781deffe26254a295e196992786185ade30e106499579c9c9f8ebc89)
    - ui/forms

      * inc/\_core/ui/forms/\_form.class.php
        [\_form.class.php](#diff-c60745706d365d94b3926dac0dd9a8c493afebe334e95ccbccdb8ac16ebaa4ce)
      * inc/\_core/ui/forms/\_form.funcs.php
        [\_form.funcs.php](#diff-bd0917e4950649fbb1cec595fd43ae058c4e54cec8aadb5996cb990adf71f491)
  + \_ext/phpwhois

    - inc/\_ext/phpwhois/whois.client.php
      [whois.client.php](#diff-10fa3e5b2381514c3a51f16178e196e73ae42b6a65319f0a3cce1da9060821ad)
    - inc/\_ext/phpwhois/whois.ip.php
      [whois.ip.php](#diff-e382730b803e0138fa54db8c0672bf4cd3387dfbbf88a2d91cddf4a9d537239c)
  + chapters

    - model

      * inc/chapters/model/\_chapter.class.php
        [\_chapter.class.php](#diff-01c365f9037afd42d812f1f65ce34fcd56e36fc08046cff70cf7dd733e5a5442)
      * inc/chapters/model/\_chaptercache.class.php
        [\_chaptercache.class.php](#diff-def43bd34aef1d94661ad8c58b132d211e99912159cf95d841b6beb50e9fd228)
    - views

      * inc/chapters/views/\_chapter.form.php
        [\_chapter.form.php](#diff-831eafc915a6b4d2ed1b3e4620b4332123a1839ab35b71b5a276f7039012b6e0)
      * inc/chapters/views/\_chapter\_list.view.php
        [\_chapter\_list.view.php](#diff-469f104bcb4aafe653c95d7a700b1ccc2082bf0e8cfaa48651bcfb5c1ab540cb)
  + collections

    - inc/collections/\_collections.init.php
      [\_collections.init.php](#diff-211f2c4f60222183b15c8f0290d6d306fc7653761b2c61ca2442c9218bbdcdb7)
    - inc/collections/collections.ctrl.php
      [collections.ctrl.php](#diff-1ccde66da01d8622109549f00efe9a2310d761ebf630c77413c913c9148672a5)
    - model

      * inc/collections/model/\_blog.class.php
        [\_blog.class.php](#diff-7117608a56c1e114633836efbd22b4ca0eb297030f31c09ee7a69f948f1984db)
      * inc/collections/model/\_collections.install.php
        [\_collections.install.php](#diff-aa05453183480e0c54a1abae5bfabd532829eb0d6655aec063c29e2530c7067b)
    - views

      * inc/collections/views/\_coll\_features.form.php
        [\_coll\_features.form.php](#diff-8ccc982284ec786c93f0a0f2762453e7a05cd21fab0de4533510a0afc36648a9)
      * inc/collections/views/\_coll\_settings\_site.form.php
        [\_coll\_settings\_site.form.php](#diff-030d7d94d115af37e12972612ba1efc368d9cfb7aebef0247f4b99aad81e4dc4)
  + comments/views

    - inc/comments/views/\_comment.form.php
      [\_comment.form.php](#diff-bec4fcff1658c278982b8dfa304f558a72b5e7720e20494a128748438171cddd)
  + cron/jobs

    - inc/cron/jobs/\_monthly\_alert\_old\_contents.job.php
      [\_monthly\_alert\_old\_contents.job.php](#diff-2f65c4786489680b254394ba824b6e50d28c1ed2e0cedc27e0cbbc0ba2c0510d)
    - inc/cron/jobs/\_post\_moderation\_reminder.job.php
      [\_post\_moderation\_reminder.job.php](#diff-8ad70e2614c1fa52860f76dc219e8ad64adb50f7dc208443bae8c76b2ba78163)
  + dashboard/model

    - inc/dashboard/model/\_dashboard.funcs.php
      [\_dashboard.funcs.php](#diff-bf09c2e30d1d19e7407ff8bb0ffc4405278a6b2ea5b4ba2bfc9bfd8684f79e11)
  + email\_campaigns/views

    - inc/email\_campaigns/views/\_campaigns\_compose.form.php
      [\_campaigns\_compose.form.php](#diff-84faacb583530e31fa2a97845476a2a63b69b78ddc608d8fb48a3245031f671f)
  + files

    - inc/files/files.ctrl.php
      [files.ctrl.php](#diff-965a153dfc965a0e2c701ccc4e0dfd9fbb5b350cc70038377d5a0b78a3cea0d3)
    - model

      * inc/files/model/\_file.funcs.php
        [\_file.funcs.php](#diff-1122402d49bf006635e8f838a195f91bf7832b2936e31d03c34070c747fb5bcd)
      * inc/files/model/\_filelist.class.php
        [\_filelist.class.php](#diff-9d781bf5308bbf898a34d2dd211689450ab84ffe235ab98c9242973314c3ba7e)
      * inc/files/model/\_fileroot.class.php
        [\_fileroot.class.php](#diff-822aab15cf4e8d55b8222a4ce8a98c27d6d45d9a367472afe6bed7454249f154)
    - inc/files/upload.ctrl.php
      [upload.ctrl.php](#diff-acb1e20c775ec09931a6dec2c0134e3be6b218af975b5664199cc50dff0e1358)
    - views

      * inc/files/views/\_file\_list.inc.php
        [\_file\_list.inc.php](#diff-fe7d060823c313dc85aabb2a39c00610c707bab64f22f4a5acd9a6afdfeca6c7)
  + items

    - inc/items/items.ctrl.php
      [items.ctrl.php](#diff-de3579fb43e70f2482b1beca203600bd56f4c72a7dba338a17565c7ac2220d55)
    - model

      * inc/items/model/\_item.class.php
        [\_item.class.php](#diff-5593029ab3dca3cc74fc62414f82a9a48d02c8898fbeec94be014a78e2abe82f)
      * inc/items/model/\_item.funcs.php
        [\_item.funcs.php](#diff-c3cee9dc3456f35aeff3d9de49977aaa419567bac3c81bc22f5777f1bda098e5)
    - views

      * inc/items/views/\_item\_expert.form.php
        [\_item\_expert.form.php](#diff-b4a7e443598a6978c692ee7c13bbc33bd466828e6a8445e9e75fe14e846388ad)
  + links

    - model

      * inc/links/model/\_link.funcs.php
        [\_link.funcs.php](#diff-19e97b362f0e3c810ba442d0377b9520538be9b4f7a819e62f86932973b68461)
      * inc/links/model/\_linkitem.class.php
        [\_linkitem.class.php](#diff-a13fcd85b937a1f32861989ee5764d81ca462b9d440f96f9d441cf0fdce7d204)
      * inc/links/model/\_linkmessage.class.php
        [\_linkmessage.class.php](#diff-14e7f002b80690c810d75b0ea9a8fa5cf02571d9b13744311a096b720ec9f9ec)
      * inc/links/model/\_linkowner.class.php
        [\_linkowner.class.php](#diff-53628df94cdaca872f45bedf353df49215c847c1a5c09b453528377d2646ee2b)
      * inc/links/model/\_temporaryid.class.php
        [\_temporaryid.class.php](#diff-2722267a1e21bf214f5ddcd0e9fb9f6762e0684a99eeb7d5ec3718586d209dcf)
    - views

      * inc/links/views/\_link\_list.view.php
        [\_link\_list.view.php](#diff-c7acf097593401a64ec32b61bb21cd68c534e90783c1a306712391b1329a7703)
  + messaging

    - inc/messaging/messages.ctrl.php
      [messages.ctrl.php](#diff-2eda9fa37a1ae901e39694560e9c3c2923540e796acb31aabef957c8a281e9fd)
    - model

      * inc/messaging/model/\_message.class.php
        [\_message.class.php](#diff-0d134a68adb3aa11e35ca3e6f6c6fe67050cfe7fd9529d1d3cbdff3a7fdcece1)
    - views

      * inc/messaging/views/\_message\_list.view.php
        [\_message\_list.view.php](#diff-e9be9e180957817ef77c343c857eea934d622833214c9db8f40aa32110412508)
      * inc/messaging/views/\_thread.form.php
        [\_thread.form.php](#diff-5afb20d9bd0d0e64225b28621e09d704aa921ce845ca93ba2fedbbe45913f8ed)
  + plugins

    - inc/plugins/\_plugin.class.php
      [\_plugin.class.php](#diff-8909e658794c8105ae6204045e802ef50dbdcce26e99af8bce5bff0677f93d9e)
    - inc/plugins/\_plugin.funcs.php
      [\_plugin.funcs.php](#diff-0fb0614e5ca9c3b7528471c0884dc74a959d7235f5cd298f20ba0f00adc8de29)
  + rest

    - inc/rest/\_restapi.class.php
      [\_restapi.class.php](#diff-552a5603bcd9781f12f7748d07f1d65cce4f249db75646b169e2c9ffe3e45465)
  + skins/model

    - inc/skins/model/\_skin.class.php
      [\_skin.class.php](#diff-78d922e71e811d97c63319b3e35d0f2178547d0a7ab53cbda8f328163cf28beb)
  + tools

    - inc/tools/email.ctrl.php
      [email.ctrl.php](#diff-a9009ee2ebec1818c21d95387b49984a2aacf6ae2bebb2cfa73de26657cf23a8)
    - inc/tools/system.ctrl.php
      [system.ctrl.php](#diff-75f5fa1a8f520a66c9339ec7663ff218e145064ea4419a9a461d5e14b2f32222)
    - views

      * inc/tools/views/\_email\_settings.form.php
        [\_email\_settings.form.php](#diff-e21411f199bdc7cd43afc6ca634a4482338a9c6c3308e75beba4c7901831ff49)
  + users

    - model

      * inc/users/model/\_group.class.php
        [\_group.class.php](#diff-47325b96430ad003d912e3db08608965dd3f140e65997cc28eaf63726cbdfdb2)
      * inc/users/model/\_user.class.php
        [\_user.class.php](#diff-d6df47e1145bd7c74292fffa681caa179a9e24f234311ca28699b711d4551259)
      * inc/users/model/\_usersettings.class.php
        [\_usersettings.class.php](#diff-78c075d59d3d1b342cbb2c7dc6905df848b0558b12dd3be8a4381ef28a37802a)
    - views

      * inc/users/views/\_user\_admin.form.php
        [\_user\_admin.form.php](#diff-c5bb29af5a8ba17de5226908d6e5df89b1503876d6224cdfdb6b85d9a4612c97)
      * inc/users/views/\_user\_subscriptions.form.php
        [\_user\_subscriptions.form.php](#diff-514037d36730daa3c6c1a13d032efc9432f8752a8fb0adc26f9a32183d2fd5f1)
  + widgets/widgets

    - inc/widgets/widgets/\_coll\_item\_list.widget.php
      [\_coll\_item\_list.widget.php](#diff-975087219c9a899ed1b3756e62a932b2d3fac5c4b73696307663c926def28b53)
    - inc/widgets/widgets/\_coll\_logo.widget.php
      [\_coll\_logo.widget.php](#diff-5c79280909ad46d44020b8ce6c52892d4666823b459b5d22f016e466933cf60e)
    - inc/widgets/widgets/\_image.widget.php
      [\_image.widget.php](#diff-307e75c41f1e677b9aed9fe783d23184e77d52a66ca0d464b7f7491d348e6766)
* install

  + install/\_functions\_create.php
    [\_functions\_create.php](#diff-b07f4b6d9249d526cf66181b5d9f40d9e1964a4342cc9f02048f98fd8572496e)
  + install/\_functions\_evoupgrade.php
    [\_functions\_evoupgrade.php](#diff-154cd43f2a0b6a5b3ac7617f4e09fca782934b000aa13c09ff7bcfafa40f4aca)
* plugins

  + plugins/\_smilies.plugin.php
    [\_smilies.plugin.php](#diff-6ff5083a0913d004d305b3e3be120704d29f7a64e0e8fff1bd1661eb15e86232)
  + markdown\_plugin

    - plugins/markdown\_plugin/\_parsedown.inc.php
      [\_parsedown.inc.php](#diff-8ec283911f07016a53ab98d86ed6e9fe8508a7fdd24e2291546955b93ab44988)
* rsc

  + build

    - rsc/build/b2evo\_base.bmin.css
      [b2evo\_base.bmin.css](#diff-f1eadfee19f3eb48287b27021df5a2263873d162c1bd887c4b72692ee548cbeb)
    - rsc/build/b2evo\_base.bundle.css
      [b2evo\_base.bundle.css](#diff-7daa938e0c208a83710d0dee596aed264487e520615db4e21789dd52c867580e)
    - rsc/build/bootstrap-b2evo\_base.bmin.css
      [bootstrap-b2evo\_base.bmin.css](#diff-4580db77df25bd40e1925fc60a84271b7eca94e9b27669377033a1d1d3754d42)
    - rsc/build/bootstrap-b2evo\_base.bundle.css
      [bootstrap-b2evo\_base.bundle.css](#diff-2b0a4901b83581aca7a8c26d0eac6e314b698340cedfd0a3885031e4f5beb910)
    - rsc/build/bootstrap-backoffice-b2evo\_base.bmin.css
      [bootstrap-backoffice-b2evo\_base.bmin.css](#diff-47c62cf6a6c30d6717949cb34e862d3f50137ffb2d2496855b66e6222dd26095)
    - rsc/build/bootstrap-backoffice-b2evo\_base.bundle.css
      [bootstrap-backoffice-b2evo\_base.bundle.css](#diff-847853801f02c2fa2ffeedd300deafbe76349120c8ff214d515bd49c653adf38)
  + css

    - rsc/css/basic.css
      [basic.css](#diff-7a3d055d00846576f20276a8ba83bd780f173af34de43d2412be91c37d2280ae)
    - rsc/css/bootstrap-blog\_base.css
      [bootstrap-blog\_base.css](#diff-50c0031e6d1320eadd831c709472c521344a6f83037c576001b727d354ebe3c1)
  + js

    - rsc/js/bozo\_validator.js
      [bozo\_validator.js](#diff-244752397035ece118577e35e13da49df499976d99a14d2056a2da5623dcd434)
    - build

      * rsc/js/build/bootstrap-evo\_backoffice.bmin.js
        [bootstrap-evo\_backoffice.bmin.js](#diff-9f2e8bb12504cf913b4fbb366b46698d4e341b697932138c5ed8b2b2b4ddc741)
      * rsc/js/build/bootstrap-evo\_frontoffice.bmin.js
        [bootstrap-evo\_frontoffice.bmin.js](#diff-074fe6fddb147fe525fd418cc259f07f05b6d6c59c12b93a3fca0d430c548102)
      * rsc/js/build/evo\_backoffice.bmin.js
        [evo\_backoffice.bmin.js](#diff-85893d882fb68e8a0ddb5f20771d46d2db1554f690ffe66fd87de94206211392)
      * rsc/js/build/evo\_frontoffice.bmin.js
        [evo\_frontoffice.bmin.js](#diff-b1d17a72c54077b5cddb8c286356c22e0de85f1f458b6e499645d7247812c548)
    - src

      * rsc/js/src/evo\_links.js
        [evo\_links.js](#diff-6facb76faa061ced0d8b207d602dd10039c329a61d16ddc1e0b3ef246f32abb6)
  + less

    - rsc/less/basic.less
      [basic.less](#diff-24e71f7dba2ead5699f21c506953adbf46d43f4f4c0e094238387edc4a27ffea)
    - rsc/less/bootstrap-basic.less
      [bootstrap-basic.less](#diff-e8e91461bab52558f71a6b453ef70d3d17c4cc73d7d36b00699023e7d095f7e2)
    - rsc/less/bootstrap-blog\_base.less
      [bootstrap-blog\_base.less](#diff-406c38d8cf08b240942b0a09da256c03913c9623e6ca85deb42abc09fe460ac0)
* skins/pureforums

  + skins/pureforums/pureforums.bmin.css
    [pureforums.bmin.css](#diff-40c968fb3ed82edfce4bad5ef92a3b51288cbfcc8037dbb35a7f728aa1d1db72)
  + skins/pureforums/pureforums.bundle.css
    [pureforums.bundle.css](#diff-3c975cbc5da299eae3e824db1c0abbb6997c54cfb025b057423ad4950d96ecdd)
  + skins/pureforums/pureforums\_header.css
    [pureforums\_header.css](#diff-0fad0918be262e23e0ec7ef5e2e9aabb527c496d77a2de4115e246a036e6af29)
  + skins/pureforums/pureforums\_main.css
    [pureforums\_main.css](#diff-33da0329f219e96f9a68e2e471eb8b77828c12be3bddaa96f5aef769820bb4e7)
* skins\_adm/bootstrap

  + skins\_adm/bootstrap/\_adminUI.class.php
    [\_adminUI.class.php](#diff-2bf83bbbfdfb8f3a5cbf3f7072df5cd8eaf05b7ab4ba7b7b3d03d477d9985b69)
* skins\_email

  + skins\_email/\_email\_footer.inc.txt.php
    [\_email\_footer.inc.txt.php](#diff-143deadac64d7a06f58cd3cc953dded9a8f34bcb7394200c22f338b0503ba537)
  + skins\_email/\_email\_header.inc.html.php
    [\_email\_header.inc.html.php](#diff-bb264b554bd37cb242ab12b93f2a61afe016cadd30755ccbd0276afbeed4dc5c)
  + skins\_email/posts\_stale\_alert.html.php
    [posts\_stale\_alert.html.php](#diff-e516906c90b5cc6460b72948ad16a2df8cec8a932a064df2eb4dab1094ffa947)
  + skins\_email/posts\_stale\_alert.txt.php
    [posts\_stale\_alert.txt.php](#diff-664235be7402ead7b52a3e1cea62109b82d3c2c9eaf029216e185f2e74d7ca23)
* skins\_fallback\_v6

  + skins\_fallback\_v6/\_edit.disp.php
    [\_edit.disp.php](#diff-9ec0328cff28a54d918833097b287fd7ef2fae8036d031e92e7e8c50564af70e)
* skins\_site

  + skins\_site/\_site\_body\_header.inc.php
    [\_site\_body\_header.inc.php](#diff-2e18b09457e372129c98916405b64dcb2cac0197d06660b02b13461becc0e98f)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[Gruntfile.js](#diff-8e7e5f941c67b0cf481a9d650295119d4922b96117e7adc069ba30a81a78c65f "Gruntfile.js")

Show comments

[View file](/b2evolution/b2evolution/blob/e35f7c195d8c1103d2d981a48cda5ab45ecac48a/Gruntfile.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -229,6 +229,7 @@ module.exports = function(grunt) { |
|  |  | 'rsc/js/src/evo\_user\_contact\_groups.js', |
|  |  | 'rsc/js/src/evo\_rest\_api.js', |
|  |  | 'rsc/js/src/evo\_item\_flag.js', |
|  |  | 'rsc/js/src/evo\_links.js', |
|  |  | 'rsc/js/ajax.js'], |
|  |  | dest: 'rsc/js/build/evo\_frontoffice.bmin.js' |
|  |  | }, |
| Expand All | | @@ -245,6 +246,7 @@ module.exports = function(grunt) { |
|  |  | 'rsc/js/src/evo\_user\_contact\_groups.js', |
|  |  | 'rsc/js/src/evo\_rest\_api.js', |
|  |  | 'rsc/js/src/evo\_item\_flag.js', |
|  |  | 'rsc/js/src/evo\_links.js', |
|  |  | 'rsc/js/ajax.js'], |
|  |  | dest: 'rsc/js/build/bootstrap-evo\_frontoffice.bmin.js' |
|  |  | }, |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[conf/\_advanced.php](#diff-27567b914bc416c62a8b094ca8a1fc562b9791da033d92e2c27e1cadc0cbf2d4 "conf/_advanced.php")

Show comments

[View file](/b2evolution/b2evolution/blob/e35f7c195d8c1103d2d981a48cda5ab45ecac48a/conf/_advanced.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -667,6 +667,13 @@ |
|  |  | $dirpath\_max\_length = ( ( ( strtoupper( substr( PHP\_OS, 0, 3 ) ) ) === 'WIN' ) ? ( 247 - 35 /\* the maximum additional path length because of the \_evocache folder \*/ ) : 767 ) - $filename\_max\_length; |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Allow double dots in file names |
|  |  | \* Use TRUE if you want to allow ".." in file and directory names like "..filename" or "dir..name" |
|  |  | \*/ |
|  |  | $filemanager\_allow\_dotdot\_in\_filenames = false; |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* XMLRPC logging. Set this to 1 to log XMLRPC calls received by this server (into /xmlsrv/xmlrpc.log). |
|  |  | \* |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[conf/\_application.php](#diff-37e07dbbf719c6a024127cc10df411e5d6f28ecfbaa53069e9194081f6591176 "conf/_application.php")

Show comments

[View file](/b2evolution/b2evolution/blob/e35f7c195d8c1103d2d981a48cda5ab45ecac48a/conf/_application.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,13 +15,13 @@ |
|  |  | \* Note: This has to be compatible with {@link http://us2.php.net/en/version-compare}. |
|  |  | \* @global string |
|  |  | \*/ |
|  |  | $app\_version = '6.8.4-stable'; |
|  |  | $app\_version = '6.8.5-stable'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Release date (ISO) |
|  |  | \* @global string |
|  |  | \*/ |
|  |  | $app\_date = '2017-01-16'; |
|  |  | $app\_date = '2017-01-19'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Long version string for checking differences |
| Expand All | | @@ -36,7 +36,7 @@ |
|  |  | \* |
|  |  | \* {@internal Before changing this in CVS, it should be discussed! }} |
|  |  | \*/ |
|  |  | $new\_db\_version = 12140; |
|  |  | $new\_db\_version = 12150; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Minimum PHP version required for b2evolution to function properly. It will contain each module own minimum PHP version as well. |
| Expand Down | |  |

140 changes: 140 additions & 0 deletions

140
[htsrv/anon\_async.php](#diff-7b09f753a6e1c2163c711db0d330d2e574d9edf4e28c539019136b7407e19d24 "htsrv/anon_async.php")

Show comments

[View file](/b2evolution/b2evolution/blob/e35f7c195d8c1103d2d981a48cda5ab45ecac48a/htsrv/anon_async.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1354,11 +1354,151 @@ |
|  |  | require $inc\_path.'users/views/\_user\_groups.form.php'; |
|  |  | break; |
|  |  |  |
|  |  | case 'set\_object\_link\_position': |
|  |  | // Change a position of a link on the edit item screen (fieldset "Images & Attachments") |
|  |  |  |
|  |  | // Check that this action request is not a CSRF hacked request: |
|  |  | $Session->assert\_received\_crumb( 'link' ); |
|  |  |  |
|  |  | // Check item/comment edit permission below after we have the $LinkOwner object ( we call LinkOwner->check\_perm ... ) |
|  |  |  |
|  |  | param('link\_ID', 'integer', true); |
|  |  | param('link\_position', 'string', true); |
|  |  |  |
|  |  | // Don't display the inline position reminder again until the user logs out or loses the session cookie |
|  |  | if( $link\_position == 'inline' ) |
|  |  | { |
|  |  | $Session->set( 'display\_inline\_reminder', 'false' ); |
|  |  | } |
|  |  |  |
|  |  | $LinkCache = & get\_LinkCache(); |
|  |  | if( ( $Link = & $LinkCache->get\_by\_ID( $link\_ID ) ) === false ) |
|  |  | { // Bad request with incorrect link ID |
|  |  | echo ''; |
|  |  | exit(0); |
|  |  | } |
|  |  | $LinkOwner = & $Link->get\_LinkOwner(); |
|  |  |  |
|  |  | // Check permission: |
|  |  | $LinkOwner->check\_perm( 'edit', true ); |
|  |  |  |
|  |  | if( $Link->set( 'position', $link\_position ) && $Link->dbupdate() ) |
|  |  | { // update was successful |
|  |  | echo 'OK'; |
|  |  |  |
|  |  | // Update last touched date of Owners |
|  |  | $LinkOwner->update\_last\_touched\_date(); |
|  |  |  |
|  |  | if( $link\_position == 'cover' && $LinkOwner->type == 'item' ) |
|  |  | { // Position "Cover" can be used only by one link |
|  |  | // Replace previous position with "Inline" |
|  |  | $DB->query( 'UPDATE T\_links |
|  |  | SET link\_position = "aftermore" |
|  |  | WHERE link\_ID != '.$DB->quote( $link\_ID ).' |
|  |  | AND link\_itm\_ID = '.$DB->quote( $LinkOwner->Item->ID ).' |
|  |  | AND link\_position = "cover"' ); |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { // return the current value on failure |
|  |  | echo $Link->get( 'position' ); |
|  |  | } |
|  |  | break; |
|  |  |  |
|  |  | case 'update\_links\_order': |
|  |  | // Update the order of all links at one time: |
|  |  |  |
|  |  | // Check that this action request is not a CSRF hacked request: |
|  |  | $Session->assert\_received\_crumb( 'link' ); |
|  |  |  |
|  |  | $link\_IDs = param( 'links', 'string' ); |
|  |  |  |
|  |  | if( empty( $link\_IDs ) ) |
|  |  | { // No links to update, wrong request, exit here: |
|  |  | break; |
|  |  | } |
|  |  |  |
|  |  | $link\_IDs = explode( ',', $link\_IDs ); |
|  |  |  |
|  |  | // Check permission by first link: |
|  |  | $LinkCache = & get\_LinkCache(); |
|  |  | if( ( $Link = & $LinkCache->get\_by\_ID( $link\_IDs[0] ) ) === false ) |
|  |  | { // Bad request with incorrect link ID |
|  |  | exit(0); |
|  |  | } |
|  |  | $LinkOwner = & $Link->get\_LinkOwner(); |
|  |  | // Check permission: |
|  |  | $LinkOwner->check\_perm( 'edit', true ); |
|  |  |  |
|  |  | $DB->begin( 'SERIALIZABLE' ); |
|  |  |  |
|  |  | // Get max order value of the links: |
|  |  | $max\_link\_order = intval( $DB->get\_var( 'SELECT MAX( link\_order ) |
|  |  | FROM T\_links |
|  |  | WHERE link\_ID IN ( '.$DB->quote( $link\_IDs ).' )' ) ); |
|  |  |  |
|  |  | // Initialize parts of sql queries to update the links order: |
|  |  | $fake\_sql\_update\_strings = ''; |
|  |  | $real\_sql\_update\_strings = ''; |
|  |  | $real\_link\_order = 0; |
|  |  | foreach( $link\_IDs as $link\_ID ) |
|  |  | { |
|  |  | $max\_link\_order++; |
|  |  | $fake\_sql\_update\_strings .= ' WHEN link\_ID = '.$DB->quote( $link\_ID ).' THEN '.$max\_link\_order; |
|  |  | $real\_link\_order++; |
|  |  | $real\_sql\_update\_strings .= ' WHEN link\_ID = '.$DB->quote( $link\_ID ).' THEN '.$real\_link\_order; |
|  |  | } |
|  |  |  |
|  |  | // Do firstly fake ordering start with max order, to avoid duplicate entry error: |
|  |  | $DB->query( 'UPDATE T\_links |
|  |  | SET link\_order = CASE '.$fake\_sql\_update\_strings.' ELSE link\_order END |
|  |  | WHERE link\_ID IN ( '.$DB->quote( $link\_IDs ).' )' ); |
|  |  | // Do real ordering start with number 1: |
|  |  | $DB->query( 'UPDATE T\_links |
|  |  | SET link\_order = CASE '.$real\_sql\_update\_strings.' ELSE link\_order END |
|  |  | WHERE link\_ID IN ( '.$DB->quote( $link\_IDs ).' )' ); |
|  |  |  |
|  |  | $DB->commit(); |
|  |  | break; |
|  |  |  |
|  |  | case 'test\_api': |
|  |  | // Spec action to test API from ctrl=system: |
|  |  | echo 'ok'; |
|  |  | break; |
|  |  |  |
|  |  | case 'get\_file\_select\_item': |
|  |  | $field\_params = param( 'params', 'array', true ); |
|  |  | $field\_name = param( 'field\_name', 'string', true ); |
|  |  | $root = param( 'root', 'string', true ); |
|  |  | $file\_path = param( 'path', 'string', true ); |
|  |  |  |
|  |  | $FileCache = & get\_FileCache(); |
|  |  | list( $root\_type, $root\_in\_type\_ID ) = explode( '\_', $root, 2 ); |
|  |  | if( ! ( $current\_File = $FileCache->get\_by\_root\_and\_path( $root\_type, $root\_in\_type\_ID, $file\_path ) ) ) |
|  |  | { // No file: |
|  |  | debug\_die( 'No such file' ); |
|  |  | // Exit here. |
|  |  | } |
|  |  |  |
|  |  | if( ! $current\_File->is\_image() ) |
|  |  | { |
|  |  | debug\_die( 'Incorrect file type for '.$field\_name ); |
|  |  | } |
|  |  |  |
|  |  | // decode params with HTML tags |
|  |  | $field\_params['field\_item\_start'] = base64\_decode( $field\_params['field\_item\_start'] ); |
|  |  | $field\_params['field\_item\_end'] = base64\_decode( $field\_params['field\_item\_end'] ); |
|  |  |  |
|  |  | $current\_File->load\_meta( true ); // erhsatingin > can we force create file meta in DB here or should this whole thing require login? |
|  |  | $r = file\_select\_item( $current\_File->ID, $field\_params ); |
|  |  |  |
|  |  | echo json\_encode( array( |
|  |  | 'fieldName' => $field\_name, |
|  |  | 'fieldValue' => $current\_File->ID, |
|  |  | 'item' => base64\_encode( $r ) |
|  |  | ) ); |
|  |  | break; |
|  |  |  |
|  |  | default: |
|  |  | $Ajaxlog->add( T\_('Incorrect action!'), 'error' ); |
|  |  | break; |
| Expand Down | |  |

147 changes: 35 additions & 112 deletions

147
[htsrv/async.php](#diff-a003e8cd18fb57ccb3c845434d700007d2aae7b1bfb1f9de58b4ae2e1cd3b3ea "htsrv/async.php")

Show comments

[View file](/b2evolution/b2evolution/blob/e35f7c195d8c1103d2d981a48cda5ab45ecac48a/htsrv/async.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -107,7 +107,7 @@ |
|  |  | // Highlight lines starting with orgname: or org-name: (case insensitive) |
|  |  | for( $i = 0; $i < count( $result['rawdata'] ); $i++ ) |
|  |  | { |
|  |  | if( preg\_match( '/^(orgname:|org-name:)/i', $result['rawdata'][$i] ) ) |
|  |  | if( preg\_match( '/^(orgname:|org-name:|descr:)/i', $result['rawdata'][$i] ) ) |
|  |  | { |
|  |  | $result['rawdata'][$i] = '<span style="font-weight: bold; background-color: yellow;">'.$result['rawdata'][$i].'</span>'; |
|  |  | } |
| Expand Down  Expand Up | | @@ -163,113 +163,6 @@ |
|  |  | autoform\_display\_field( $set\_path, $r['set\_meta'], $Form, $set\_type, $Plugin, NULL, $r['set\_node'] ); |
|  |  | break; |
|  |  |  |
|  |  | case 'set\_object\_link\_position': |
|  |  | // Change a position of a link on the edit item screen (fieldset "Images & Attachments") |
|  |  |  |
|  |  | // Check that this action request is not a CSRF hacked request: |
|  |  | $Session->assert\_received\_crumb( 'link' ); |
|  |  |  |
|  |  | // Check item/comment edit permission below after we have the $LinkOwner object ( we call LinkOwner->check\_perm ... ) |
|  |  |  |
|  |  | param('link\_ID', 'integer', true); |
|  |  | param('link\_position', 'string', true); |
|  |  |  |
|  |  | // Don't display the inline position reminder again until the user logs out or loses the session cookie |
|  |  | if( $link\_position == 'inline' ) |
|  |  | { |
|  |  | $Session->set( 'display\_inline\_reminder', 'false' ); |
|  |  | } |
|  |  |  |
|  |  | $LinkCache = & get\_LinkCache(); |
|  |  | if( ( $Link = & $LinkCache->get\_by\_ID( $link\_ID ) ) === false ) |
|  |  | { // Bad request with incorrect link ID |
|  |  | echo ''; |
|  |  | exit(0); |
|  |  | } |
|  |  | $LinkOwner = & $Link->get\_LinkOwner(); |
|  |  |  |
|  |  | // Check permission: |
|  |  | $LinkOwner->check\_perm( 'edit', true ); |
|  |  |  |
|  |  | if( $Link->set( 'position', $link\_position ) && $Link->dbupdate() ) |
|  |  | { // update was successful |
|  |  | echo 'OK'; |
|  |  |  |
|  |  | // Update last touched date of Owners |
|  |  | $LinkOwner->update\_last\_touched\_date(); |
|  |  |  |
|  |  | if( $link\_position == 'cover' && $LinkOwner->type == 'item' ) |
|  |  | { // Position "Cover" can be used only by one link |
|  |  | // Replace previous position with "Inline" |
|  |  | $DB->query( 'UPDATE T\_links |
|  |  | SET link\_position = "aftermore" |
|  |  | WHERE link\_ID != '.$DB->quote( $link\_ID ).' |
|  |  | AND link\_itm\_ID = '.$DB->quote( $LinkOwner->Item->ID ).' |
|  |  | AND link\_position = "cover"' ); |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { // return the current value on failure |
|  |  | echo $Link->get( 'position' ); |
|  |  | } |
|  |  | break; |
|  |  |  |
|  |  | case 'update\_links\_order': |
|  |  | // Update the order of all links at one time: |
|  |  |  |
|  |  | // Check that this action request is not a CSRF hacked request: |
|  |  | $Session->assert\_received\_crumb( 'link' ); |
|  |  |  |
|  |  | $link\_IDs = param( 'links', 'string' ); |
|  |  |  |
|  |  | if( empty( $link\_IDs ) ) |
|  |  | { // No links to update, wrong request, exit here: |
|  |  | break; |
|  |  | } |
|  |  |  |
|  |  | $link\_IDs = explode( ',', $link\_IDs ); |
|  |  |  |
|  |  | // Check permission by first link: |
|  |  | $LinkCache = & get\_LinkCache(); |
|  |  | if( ( $Link = & $LinkCache->get\_by\_ID( $link\_IDs[0] ) ) === false ) |
|  |  | { // Bad request with incorrect link ID |
|  |  | exit(0); |
|  |  | } |
|  |  | $LinkOwner = & $Link->get\_LinkOwner(); |
|  |  | // Check permission: |
|  |  | $LinkOwner->check\_perm( 'edit', true ); |
|  |  |  |
|  |  | $DB->begin( 'SERIALIZABLE' ); |
|  |  |  |
|  |  | // Get max order value of the links: |
|  |  | $max\_link\_order = intval( $DB->get\_var( 'SELECT MAX( link\_order ) |
|  |  | FROM T\_links |
|  |  | WHERE link\_ID IN ( '.$DB->quote( $link\_IDs ).' )' ) ); |
|  |  |  |
|  |  | // Initialize parts of sql queries to update the links order: |
|  |  | $fake\_sql\_update\_strings = ''; |
|  |  | $real\_sql\_update\_strings = ''; |
|  |  | $real\_link\_order = 0; |
|  |  | foreach( $link\_IDs as $link\_ID ) |
|  |  | { |
|  |  | $max\_link\_order++; |
|  |  | $fake\_sql\_update\_strings .= ' WHEN link\_ID = '.$DB->quote( $link\_ID ).' THEN '.$max\_link\_order; |
|  |  | $real\_link\_order++; |
|  |  | $real\_sql\_update\_strings .= ' WHEN link\_ID = '.$DB->quote( $link\_ID ).' THEN '.$real\_link\_order; |
|  |  | } |
|  |  |  |
|  |  | // Do firstly fake ordering start with max order, to avoid duplicate entry error: |
|  |  | $DB->query( 'UPDATE T\_links |
|  |  | SET link\_order = CASE '.$fake\_sql\_update\_strings.' ELSE link\_order END |
|  |  | WHERE link\_ID IN ( '.$DB->quote( $link\_IDs ).' )' ); |
|  |  | // Do real ordering start with number 1: |
|  |  | $DB->query( 'UPDATE T\_links |
|  |  | SET link\_order = CASE '.$real\_sql\_update\_strings.' ELSE link\_order END |
|  |  | WHERE link\_ID IN ( '.$DB->quote( $link\_IDs ).' )' ); |
|  |  |  |
|  |  | $DB->commit(); |
|  |  | break; |
|  |  |  |
|  |  | case 'edit\_comment': |
|  |  | // Used to edit a comment from back-office (Note: Only for meta comments now!) |
|  |  |  |
| Expand Down  Expand Up | | @@ -816,9 +709,9 @@ |
|  |  | // Check permission: |
|  |  | $current\_User->check\_perm( 'files', 'add', true, $fileroot\_ID ); |
|  |  |  |
|  |  | param( 'path', 'string' ); |
|  |  | param( 'oldfile', 'string' ); |
|  |  | param( 'newfile', 'string' ); |
|  |  | param( 'path', 'filepath' ); |
|  |  | param( 'oldfile', 'filepath' ); |
|  |  | param( 'newfile', 'filepath' ); |
|  |  | param( 'format', 'string' ); |
|  |  |  |
|  |  | $fileroot = explode( '\_', $fileroot\_ID ); |
| Expand Down  Expand Up | | @@ -863,7 +756,7 @@ |
|  |  | param( 'link\_owner\_ID', 'integer', true ); |
|  |  | // Additional params, Used to highlight file/folder |
|  |  | param( 'root', 'string', '' ); |
|  |  | param( 'path', 'string', '' ); |
|  |  | param( 'path', 'filepath', '' ); |
|  |  | param( 'fm\_highlight', 'string', '' ); |
|  |  |  |
|  |  | $additional\_params = empty( $root ) ? '' : '&amp;root='.$root; |
| Expand All | | @@ -879,6 +772,36 @@ |
|  |  |  |
|  |  | break; |
|  |  |  |
|  |  | case 'file\_attachment': |
|  |  | // The content for popup window to link the files to the items/comments |
|  |  |  |
|  |  | // Check that this action request is not a CSRF hacked request: |
|  |  | $Session->assert\_received\_crumb( 'file' ); |
|  |  |  |
|  |  | // Check permission: |
|  |  | $current\_User->check\_perm( 'files', 'view' ); |
|  |  |  |
|  |  | param( 'iframe\_name', 'string', '' ); |
|  |  | param( 'field\_name', 'string', '' ); |
|  |  | // Additional params, Used to highlight file/folder |
|  |  | param( 'root', 'string', '' ); |
|  |  | param( 'path', 'string', '' ); |
|  |  | param( 'fm\_highlight', 'string', '' ); |
|  |  |  |
|  |  | $additional\_params = empty( $root ) ? '' : '&amp;root='.$root; |
|  |  | $additional\_params .= empty( $path ) ? '' : '&amp;path='.$path; |
|  |  | $additional\_params .= empty( $fm\_highlight ) ? '' : '&amp;fm\_highlight='.$fm\_highlight; |
|  |  | //$additional\_params .= empty( $field\_name ) ? '' : '&amp;field\_name='.$field\_name; |
|  |  |  |
|  |  | echo '<div style="background:#FFF;height:90%">' |
|  |  | .'<span id="link\_attachment\_loader" class="loader\_img absolute\_center" title="'.T\_('Loading...').'"></span>' |
|  |  | .'<iframe src="'.$admin\_url.'?ctrl=files&amp;mode=upload&amp;field\_name='.$field\_name.'&amp;ajax\_request=1&amp;iframe\_name='.$iframe\_name.'&amp;fm\_mode=file\_select'.$additional\_params.'"' |
|  |  | .' width="100%" height="100%" marginwidth="0" marginheight="0" align="top" scrolling="auto" frameborder="0"' |
|  |  | .' onload="document.getElementById(\'link\_attachment\_loader\').style.display=\'none\'">loading</iframe>' |
|  |  | .'</div>'; |
|  |  |  |
|  |  | break; |
|  |  |  |
|  |  | case 'import\_files': |
|  |  | // The content for popup window to import the files for XML importer |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[htsrv/getfile.php](#diff-a0feaf6c6dfcde696650ae6a95b96c50df4bddfbec713856bfa76bbd43ebca3f "htsrv/getfile.php")

Show comments

[View file](/b2evolution/b2evolution/blob/e35f7c195d8c1103d2d981a48cda5ab45ecac48a/htsrv/getfile.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -69,7 +69,7 @@ |
|  |  | } |
|  |  |  |
|  |  | // Load the other params: |
|  |  | param( 'path', 'string', true ); |
|  |  | param( 'path', 'filepath', true ); |
|  |  | param( 'size', 'string', NULL ); // Can be used for images. |
|  |  | param( 'size\_x', 'integer', 1 ); // Ratio size, can be 1, 2 and etc. |
|  |  | param( 'mtime', 'integer', 0 ); // used for unique URLs (that never expire). |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e35f7c1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fb2evolution%2Fb2evolution%2Fcommit%2Fe35f7c195d8c1103d2d981a48cda5ab45ecac48a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from b2evolution.net_45925571_20250124_213953.html ===


Toggle navigation

# [b2evolution b2evolution](https://b2evolution.net/ "b2evolution: Home")

* [Sign in](https://b2evolution.net/?disp=login&redirect_to=%2Fdownloads%2F6-8-5&return_to=%2Fdownloads%2F6-8-5&source=menu%20link)
* [Sign up](https://b2evolution.net/?disp=register&source=menu%20link&redirect_to=%2Fdownloads%2F6-8-5&return_to=%2Fdownloads%2F6-8-5)

* [About](https://b2evolution.net/about/)
* [Downloads](https://b2evolution.net/downloads/)
* [Hosting](https://b2evolution.net/web-hosting/cheap-plans/)
* [Docs](https://b2evolution.net/man/)
* [Support](https://forums.b2evolution.net/)
* [Sign in](https://b2evolution.net/?disp=login&redirect_to=%2Fdownloads%2F6-8-5&return_to=%2Fdownloads%2F6-8-5&source=menu%20link)
* [Sign up](https://b2evolution.net/?disp=register&source=menu%20link&redirect_to=%2Fdownloads%2F6-8-5&return_to=%2Fdownloads%2F6-8-5)

* [Releases](https://b2evolution.net/downloads/)
* [Skins](https://skins.b2evolution.net/)
* [Plugins](https://plugins.b2evolution.net/)
* [Locales](https://locales.b2evolution.net/)

* [« 6.8.6-stable](https://b2evolution.net/downloads/6-8-6)
* [6.8.4-stable »](https://b2evolution.net/downloads/6-8-4)
# 6.8.5-stable

 Categories: [6.x Series](https://b2evolution.net/downloads/6-x-series/ "Browse category")

Released on January 19th, 2016.

This is a stable version of b2evolution 6.8.x, recommended for all users.

**This release contains important security fixes.**

 [**Download Now!**
b2evolution-6.8.5-stable-2017-01-19.zip (14 MB)](https://b2evolution.net/downloads/6-8-5?download=6743)

Also [available on GitHub](https://github.com/b2evolution/b2evolution).

### Installation

Our easy **[Installation Guide](https://b2evolution.net/man/installation-guide)** will provide step by step instructions to get you started with b2evolution.

### Upgrade

All the upgrade options are outlined here: [Upgrading an existing installation](https://b2evolution.net/man/generic-vocabulary/).

### Changes

In addition to features of [6.8.4-stable](https://b2evolution.net/downloads/6-8-4):

* Ability to attach files to new posts in the front office (useful for forums) and in the back-office without saving post first
* Ability to attach an image to each category and to use it as a fall-back for posts without an image in the Universal Item List Widget
* Ability to attach an image to image and logo widgets instead of providing a relative filepath
* Ability to easily attach a logo for the site through file manager selection
* Ability to receive notifications on stale posts (posts that have not been edited for a long time)
* Performance improvements
* UI improvements
* Security fixes -- Thanks to [backwolfsec](http://blackwolfsec.cc) and [phantom0301](http://phantom0301.cc) for their help.
* Bug fixes

### No feedback yet

#### Download & Install

* [Installation guide](/man/installation-upgrade/new-install/installation-guide)
* [Upgrade instructions](/man/installation-upgrade/upgrading/)
* [Migration & Data Import](/man/installation-upgrade/importing-content/)
* [System requirements](/man/installation-upgrade/system_requirements)
#### Filtering Options

* [By Status](https://b2evolution.net/downloads/download-status/)
  + [Advanced Releases](https://b2evolution.net/downloads/advanced-releases/)
  + [Use for evaluation](https://b2evolution.net/downloads/evaluation-grade/)
  + [Use for production](https://b2evolution.net/downloads/production-grade/)
  + [Deprecated](https://b2evolution.net/downloads/deprecated/)
  + [Obsolete](https://b2evolution.net/downloads/obsolete/)
* [by Version](https://b2evolution.net/downloads/download-version/)
  + [7.x Series](https://b2evolution.net/downloads/7-x-series/)
  + [6.x Series](https://b2evolution.net/downloads/6-x-series/)
  + [5.x Series](https://b2evolution.net/downloads/5-x-series/)
  + [4.x Series](https://b2evolution.net/downloads/4-x-series/)
  + [3.x Series](https://b2evolution.net/downloads/3-x-series/)
  + [2.x Series](https://b2evolution.net/downloads/2-x-series/)
    - [2.0 "Chicago" series](https://b2evolution.net/downloads/2-0-chicago-series/)
    - [2.x "Nevada" series](https://b2evolution.net/downloads/2-x-nevada-series/)
  + [1.x Series](https://b2evolution.net/downloads/1-x-series/)
    - [1.6 "Phoenix" series](https://b2evolution.net/downloads/1-6-phoenix-series/)
    - [1.8 series](https://b2evolution.net/downloads/1-8-series/)
    - [1.9 series](https://b2evolution.net/downloads/1-9-series/)
    - [1.10 "Florida" series](https://b2evolution.net/downloads/1-10-florida-series/)
  + [0.x Series](https://b2evolution.net/downloads/0-x-series/)
    - [0.8 series](https://b2evolution.net/downloads/0-8-series/)
    - [0.9 series](https://b2evolution.net/downloads/0-9-series/)

Retain only results that match:

Any selected category (OR)

None of the selected categories (NOR)

All of the selected categories (AND)

#### Search (Full Text)

#### XML Feeds

* RSS 2.0: [Posts](https://b2evolution.net/downloads/?tempskin=_rss2)
* Atom: [Posts](https://b2evolution.net/downloads/?tempskin=_atom)

[What is RSS?](http://webreference.fr/2006/08/30/rss_atom_xml)

### About b2evolution

* [What is it?](http://b2evolution.net/about/what-is-b2evolution)
* [Features](http://b2evolution.net/about/features)
* [Getting Started](http://b2evolution.net/man/installation-upgrade/installation-guide)
* [Screenshots](http://b2evolution.net/about/screenshots/)
* [Online demo](http://demo.b2evolution.net/)
* [Testimonials](http://b2evolution.net/about/testimonials)
* [Design philosophy](http://b2evolution.net/about/design-philosophy)
* [Free & open source](http://b2evolution.net/about/gnu-gpl-license)
* [Terms of service](http://b2evolution.net/about/terms-of-service)

### Downloads

* [Latest releases](http://b2evolution.net/downloads/)
* [Skins](http://skins.b2evolution.net/)
* [Plugins](http://plugins.b2evolution.net/)
* [Language packs](http://locales.b2evolution.net/)

### About us

* [About us](http://b2evolution.net/about/about-us)
* [Contact](http://b2evolution.net/about/contact/)

### Webhosting Guide

* [Web hosting blog](http://b2evolution.net/web-hosting/blog/)
* [Best web hosting](http://b2evolution.net/web-hosting/top-quality-best-webhosting.php)
* [Cheap web hosting](http://b2evolution.net/web-hosting/budget-web-hosting-low-cost-lamp.php)
* [Green web hosting](http://b2evolution.net/web-hosting/green-hosting-renewable-energy-power.php)
* [Hosting with SSH](http://b2evolution.net/web-hosting/ssh-hosting-secure-shell-access.php)
* [VPS hosting](http://b2evolution.net/web-hosting/vps-hosting-virtual-private-servers.php)
* [Dedicated servers](http://b2evolution.net/web-hosting/dedicated-servers.php)
* [Reseller hosting](http://b2evolution.net/web-hosting/reseller-hosting.php)
* Int'l: [UK](http://b2evolution.net/uk/web-hosting/best-web-hosts-uk.php)
  / [France](http://b2evolution.net/fr/hebergement/hebergeurs-web-france.php)

### Docs & Support

* [Online manual](http://b2evolution.net/man/)
* [Forums](http://forums.b2evolution.net/)
* [Hire a pro *!*](http://b2evolution.net/about/b2evolution-professionals)

### Other

* [Adsense](http://b2evolution.net/about/monetize-blog-money.php)
* [Press room](http://b2evolution.net/about/press-room)
* [Privacy policy](http://b2evolution.net/about/privacy-policy)

### Stay in touch

* [GitHub](https://github.com/b2evolution/b2evolution)
* [Twitter](http://twitter.com/b2evolution)
* [Facebook](http://www.facebook.com/b2evolution)
* [LinkedIn](http://www.linkedin.com/company/b2evolution-net)
* [News blog](http://b2evolution.net/news/)
* [RSS feed](http://b2evolution.net/news/?tempskin=_rss2)
* [Atom feed](http://b2evolution.net/news/?tempskin=_atom)

Founded & Maintained by [François](http://fplanque.net/) [Planque](http://fplanque.com/)


