=== Content from wiki.mozilla.org_73f8d6fa_20250126_010515.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")â€Ž | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_f9bc164d_20250124_121942.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1312243)
* [XML](/show_bug.cgi?ctype=xml&id=1312243)

Closed
[Bug 1312243](/show_bug.cgi?id=1312243)
(CVE-2017-5419)

Opened 8 years ago
Closed 8 years ago

# Trap site uses repeated http auth prompts to keep the user on the page

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Trap site uses repeated http auth prompts to keep the user on the page

## Categories

### (Core :: Networking: HTTP, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking%3A%20HTTP#Networking%3A%20HTTP)

Networking: HTTP
â–¾

Core :: Networking: HTTP
For bugs in Mozilla's HTTP networking code. This component deals with HTTP specific issues like pipelining, keep-alive, HTTP proxies, 1.1 issues, redirects, authentication (basic), etc.

Examples of appropriate bugs: Problems with proxy authentication; HTTP redirects looping indefinitely, etc.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking%3A%20HTTP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

49 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

major

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla53

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox52 | [-](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=-) | [fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed) |
| firefox53 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox52 | - | fixed |
| firefox53 |  | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: firefox-bugzilla, Assigned: mayhemer, NeedInfo)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [mayhemer](/user_profile?user_id=269762)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d71f2b093dd79806a524868ff4c9c79d?d=mm&size=40)  [firefox-bugzilla](/user_profile?user_id=202670)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

NeedInfo From:

 [firefox-bugzilla](/user_profile?user_id=202670)

[8 years ago](#c0)

[NeedInfo:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#needinfo)

Update

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

20 people

## References

### (Depends on 1 open bug, Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1577174](/show_bug.cgi?id=1577174 "RESOLVED INCOMPLETE - authentication_dialog_abuse_limit can cause the browser to freeze/crash")

[1426656](/show_bug.cgi?id=1426656 "NEW - Add \"disable HTTP authentication prompts\" for this site to auth prompt dialog")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1323973](/show_bug.cgi?id=1323973 "RESOLVED FIXED - Write tests for patch from bug 1312243 (auth dialog abuse blocker)")

[eviltraps](/show_bug.cgi?id=432687 "NEW - [meta] Protect users from websites that trap them or destroy their experience")

Dependency [tree](/showdependencytree.cgi?id=1312243&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1312243)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1312836](/show_bug.cgi?id=1312836 "RESOLVED DUPLICATE - browser takeover/denial of service via data URI and HTTP authentication dialog"), [1321785](/show_bug.cgi?id=1321785 "RESOLVED DUPLICATE - A site can reissue infinite background requests leading to HTTP authentication requests, causing infinite \"Authentication Required\" popups that block the entire browser and make it impossible to close the tab"), [1324226](/show_bug.cgi?id=1324226 "RESOLVED DUPLICATE - Browser Hijack using data URI and lots of http auth prompts")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[613785](/show_bug.cgi?id=613785 "RESOLVED FIXED - Switch to using tab-modal prompt dialogs for HTTP authentication"), [647010](/show_bug.cgi?id=647010 "NEW - Only present HTTP authentication dialogs if it is the top-level document initiating the auth"), [1418644](/show_bug.cgi?id=1418644 "RESOLVED WORKSFORME - Username/password prompt can be used to hijack the browser"), [377496](/show_bug.cgi?id=377496 "VERIFIED FIXED - 'Authentication Required' dialogue being application modal produces a vector for attack")

## Details

### (Keywords: csectype-dos, sec-low, Whiteboard: [necko-active][adv-main52+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2017-5419

[Keywords:](/describekeywords.cgi)

[csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-active][adv-main52+]

QA Whiteboard:

[qa-triaged]

Has STR:

no

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [jcristau](/user_profile?user_id=580382) | [qe-verify](#c59 "8 years ago") | + |
| --- | --- | --- |
| [jcristau](/user_profile?user_id=580382) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 5 obsolete files)

| [browserhijacking.png](/attachment.cgi?id=8803672)  [8 years ago](#c0)  [Chris](/user_profile?user_id=202670)   226.47 KB, image/png |  | [Details](/attachment.cgi?id=8803672&action=edit) |
| --- | --- | --- |
| [v1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)](/attachment.cgi?id=8807268)  [8 years ago](#c18)  [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)   19.82 KB, patch |  | [Details](/attachment.cgi?id=8807268&action=edit) | [Diff](/attachment.cgi?id=8807268&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8807268) |
| [v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)](/attachment.cgi?id=8807535)  [8 years ago](#c22)  [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)   20.12 KB, patch | Dolske : [review-](#c25 "8 years ago") | [Details](/attachment.cgi?id=8807535&action=edit) | [Diff](/attachment.cgi?id=8807535&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8807535) |
| [v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)](/attachment.cgi?id=8809862)  [8 years ago](#c28)  [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)   21.05 KB, patch | mcmanus : [review+](#c34 "8 years ago") | [Details](/attachment.cgi?id=8809862&action=edit) | [Diff](/attachment.cgi?id=8809862&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8809862) |
| [v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)](/attachment.cgi?id=8811336)  [8 years ago](#c39)  [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)   20.10 KB, patch | Gijs : [feedback+](#c42 "8 years ago") | [Details](/attachment.cgi?id=8811336&action=edit) | [Diff](/attachment.cgi?id=8811336&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8811336) |
| [v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)](/attachment.cgi?id=8814466)  [8 years ago](#c44)  [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)   20.38 KB, patch | MattN : [review+](#c46 "8 years ago") | [Details](/attachment.cgi?id=8814466&action=edit) | [Diff](/attachment.cgi?id=8814466&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8814466) |
| [v2.4 (r addressed, no test)](/attachment.cgi?id=8819273)  [8 years ago](#c48)  [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)   20.46 KB, patch | mayhemer : [review+](#c48 "8 years ago")  jcristau : [approval-mozilla-aurora+](#c58 "8 years ago") | [Details](/attachment.cgi?id=8819273&action=edit) | [Diff](/attachment.cgi?id=8819273&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8819273) |
| [v2.4 for m-a](/attachment.cgi?id=8820302)  [8 years ago](#c61)  [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)   20.21 KB, patch |  | [Details](/attachment.cgi?id=8820302&action=edit) | [Diff](/attachment.cgi?id=8820302&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8820302) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Chris](/user_profile?user_id=202670)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1312243#c0)â€¢ 8 years ago |
|  | |

Attached image
[browserhijacking.png](attachment.cgi?id=8803672)
â€” [Details](attachment.cgi?id=8803672&action=edit)

User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0
Build ID: 20161019084923
Steps to reproduce:
went to a website
Actual results:
browser was redirected multiple times. eventually stopping on a "data" url that pretended to be microsoft and claiming my computer was compromised. What was different to other hijacks was this loaded a 403 password modal dialogue and could not be cleared. The only way to close the rogue site was to shut down the browser from task manager.
Expected results:
data urls should not be able to render pages and should not be able to trigger dialogues especially modal dialogue boxes that prevent navigating away from the site

|  | [Chris](/user_profile?user_id=202670)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a57_202670)â€¢ 8 years ago |

Severity: normal â†’ major

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1312243#c1)â€¢ 8 years ago |
|  | |

This isn't related to the data: URL (you could cause multiple http auth prompts from a 'normal' webpage too), and we would likely not be able to break data: URLs altogether anyway. The problem is the repeated prompts making it impossible to close the site.
Patrick, is there a way we could limit these prompts if making them tab-modal isn't feasible in the near future?Blocks: [eviltraps](/show_bug.cgi?id=432687 "NEW - [meta] Protect users from websites that trap them or destroy their experience")Group: firefox-core-securityComponent: Untriaged â†’ Networking: HTTPFlags: needinfo?(mcmanus)Keywords: [csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)Product: Firefox â†’ CoreSee Also: â†’ [613785](/show_bug.cgi?id=613785 "RESOLVED FIXED - Switch to using tab-modal prompt dialogs for HTTP authentication")Summary: Browser hijacked using data url â†’ Trap site uses repeated http auth prompts to keep the user on the page

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1312243#c2)â€¢ 8 years ago |
|  | |

Is [bug 1312836](/show_bug.cgi?id=1312836 "RESOLVED DUPLICATE - browser takeover/denial of service via data URI and HTTP authentication dialog") related?See Also: â†’ [1312836](/show_bug.cgi?id=1312836 "RESOLVED DUPLICATE - browser takeover/denial of service via data URI and HTTP authentication dialog")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1312243#c3)â€¢ 8 years ago |
|  | |

(In reply to Honza Bambas (:mayhemer) from [comment #2](/show_bug.cgi?id=1312243#c2 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> Is [bug 1312836](/show_bug.cgi?id=1312836 "RESOLVED DUPLICATE - browser takeover/denial of service via data URI and HTTP authentication dialog") related?
Yeah, that looks like it's the same. I'll dupe. The URL and attached data URIs from [bug 1312836](/show_bug.cgi?id=1312836 "RESOLVED DUPLICATE - browser takeover/denial of service via data URI and HTTP authentication dialog") look quite useful though.Status: UNCONFIRMED â†’ NEWEver confirmed: true

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a303504_32546)â€¢ 8 years ago |

Flags: needinfo?(mcmanus)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1312243#c5)â€¢ 8 years ago |
|  | |

Apparently [bug 647010](/show_bug.cgi?id=647010 "NEW - Only present HTTP authentication dialogs if it is the top-level document initiating the auth") covers disabling these prompts for non-toplevel loads, which would also help.
Honza, can you think of anything else that would (help)?Flags: needinfo?(honzab.moz)See Also: [1312836](/show_bug.cgi?id=1312836 "RESOLVED DUPLICATE - browser takeover/denial of service via data URI and HTTP authentication dialog") â†’ [647010](/show_bug.cgi?id=647010 "NEW - Only present HTTP authentication dialogs if it is the top-level document initiating the auth")

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1312243#c6)â€¢ 8 years ago |
|  | |

(In reply to :Gijs Kruitbosch from [comment #5](/show_bug.cgi?id=1312243#c5 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> Apparently [bug 647010](/show_bug.cgi?id=647010 "NEW - Only present HTTP authentication dialogs if it is the top-level document initiating the auth") covers disabling these prompts for non-toplevel loads,
> which would also help.
Not sure what the state of that bug is. Dragana? Just quickly - what is status of that bug?
>
> Honza, can you think of anything else that would (help)?
The first idea that popped to my mind was to queue the prompts, but recently I touched that code and thought we were already was doing that. Double checking if that is broken or not would be good (LoginManagerPrompter.js).
Bad thing is that just queuing will not get rid of all the modal dialogs flood. Something like "don't ask me for auth from this page" check box, similar what we have for MsgBox would do (a UI change). Only refresh of the page by the user would allow it again then.
I'll try to find time to think of something simpler tho.Flags: needinfo?(honzab.moz) â†’ needinfo?(dd.mozilla)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a310835_269762)â€¢ 8 years ago |

Flags: needinfo?(honzab.moz)

|  | [Vladimir Vukicevic [:vlad] [:vladv] (needinfo me, slow to respond)](/user_profile?user_id=24534) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1312243#c7)â€¢ 8 years ago |
|  | |

(In reply to Honza Bambas (:mayhemer) from [comment #6](/show_bug.cgi?id=1312243#c6 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> I'll try to find time to think of something simpler tho.
Queue the prompts, and have a longer and longer time in between subsequent prompts, ramping up quickly? After some number of queued prompts, just auto-fail auth requests for that page for a while. It's a bit opaque, but maybe we can mitigate it with a doorhanger popup that says "This page has created too many auth prompts in a short period of time, we're going to disable it until you reload"? (i18n impact, but still)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1312243#c8)â€¢ 8 years ago |
|  | |

Could we block prompts for domain X immediately if the user clicks cancel (or OK with no username/password) ? Or do these pages use different domains?

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1312243#c9)â€¢ 8 years ago |
|  | |

(In reply to Honza Bambas (:mayhemer) from [comment #6](/show_bug.cgi?id=1312243#c6 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> (In reply to :Gijs Kruitbosch from [comment #5](/show_bug.cgi?id=1312243#c5 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> > Apparently [bug 647010](/show_bug.cgi?id=647010 "NEW - Only present HTTP authentication dialogs if it is the top-level document initiating the auth") covers disabling these prompts for non-toplevel loads,
> > which would also help.
>
> Not sure what the state of that bug is. Dragana? Just quickly - what is
> status of that bug?
>
[Bug 647010](/show_bug.cgi?id=647010 "NEW - Only present HTTP authentication dialogs if it is the top-level document initiating the auth") introduced a pref to disable a cross-origin authentication but usage of such is to high to disable it:
<https://telemetry.mozilla.org/new-pipeline/dist.html#!cumulative=0&end_date=2016-10-26&keys=__none__!__none__!__none__&max_channel_version=nightly%252F52&measure=HTTP_AUTH_DIALOG_STATS&min_channel_version=null&product=Firefox&sanitize=1&sort_keys=submissions&start_date=2016-09-19&table=0&trim=1&use_submission_date=0>Flags: needinfo?(dd.mozilla)

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1312243#c10)â€¢ 8 years ago |
|  | |

(In reply to :Gijs Kruitbosch from [comment #8](/show_bug.cgi?id=1312243#c8 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> Could we block prompts for domain X immediately if the user clicks cancel
> (or OK with no username/password) ? Or do these pages use different domains?
or block it after second or third cancel. In case user make a mistake canceling.

|  | [u408661](/user_profile?user_id=408661) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a390544_408661)â€¢ 8 years ago |

Whiteboard: [necko-next]

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1312243#c11)â€¢ 8 years ago |
|  | |

(In reply to Dragana Damjanovic [:dragana] from [comment #10](/show_bug.cgi?id=1312243#c10 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> (In reply to :Gijs Kruitbosch from [comment #8](/show_bug.cgi?id=1312243#c8 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> > Could we block prompts for domain X immediately if the user clicks cancel
> > (or OK with no username/password) ? Or do these pages use different domains?
>
> or block it after second or third cancel. In case user make a mistake
> canceling.
In a 'normal' case where a website needs resources, cancel (or not providing correct credentials) will break that resource, likely necessitating a reload anyway. I don't think we need to wait for the second/third cancel - if the user makes a mistake, they'll want to reload the page anyway.

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1312243#c12)â€¢ 8 years ago |
|  | |

Boris, I'd like to ask for a little help here.
I want to track the number of authentication prompts a page invokes (via a subresource or iframe) and user cancels them as mitigation to the bloat this bug deals with.
In nsLoginManagerPrompter.js (note this is js, so no access to nsPI\* interfaces) I only have access to the outer window (nsDocShell->mScriptGlobal->AsOuter(), which is nsGlobalWindow AFAIK). I'm trying to implement a counter nsLoginManagerPrompter could access and which simply resets when top level navigation happens. Sounds like the point of reset is nsGlobalWindow::SetNewDocument. But here I may need a new property exposed to chrome on global window, not sure it's the way to go.
Other option is this: I can reach the browser's chrome document element and set attributes on it (keep the counter there). But I don't know how to reset this attribute easily on navigation/reload. Apparently, browser doc element is not the one that resets in nsGlobalWindow::SetNewDocument (mDoc).
So, the question is, do you know about something that is reachable in chrome js from the outer window, capable of storing arbitrary data (the counter) and is reset on navigation/reload? :)
Thanks.Assignee: nobody â†’ honzab.mozFlags: needinfo?(honzab.moz) â†’ needinfo?(bzbarsky)Whiteboard: [necko-next] â†’ [necko-active]

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1312243#c13)â€¢ 8 years ago |
|  | |

> So, the question is, do you know about something that is reachable in chrome js from the outer window
Is your chrome js running in the content process or the chrome process?
Because window.document seems like a totally reasonable place to store this information. You can ether use an expando (over Xrays) with a suitably chosen symbol name or string name of some sort, or a weakmap with the document as the key. But obviously that's only a good idea in the content process. Of course poking at the docshell in the chrome process is bad too, so I really hope you're in the content process.Flags: needinfo?(bzbarsky)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1312243#c14)â€¢ 8 years ago |
|  | |

(In reply to Boris Zbarsky [:bz] (still a bit busy) from [comment #13](/show_bug.cgi?id=1312243#c13 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> > So, the question is, do you know about something that is reachable in chrome js from the outer window
>
> Is your chrome js running in the content process or the chrome process?
The login manager solely runs in chrome. To be more precise, it's queried at TabParent::GetAuthPrompt <https://dxr.mozilla.org/mozilla-central/rev/3e73fd638e687a4d7f46613586e5156b8e2af846/dom/ipc/TabParent.cpp#2424>
>
> Because window.document seems like a totally reasonable place to store this
> information. You can ether use an expando (over Xrays) with a suitably
> chosen symbol name or string name of some sort, or a weakmap with the
> document as the key. But obviously that's only a good idea in the content
> process. Of course poking at the docshell in the chrome process is bad too,
> so I really hope you're in the content process.
No, I'm not on the content process :( I can access the tab's window.document, tho. Only problem is that it doesn't reset (drop) my added custom attribute when reload/navigation happens in the tab.
Note that the counter must not be accessible to content.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1312243#c15)â€¢ 8 years ago |
|  | |

> I can access the tab's window.document, tho
Ok, but then that's a CPOW if the window is the content window, so we don't want to be doing that.
But if you're in TabParent::GetAuthPrompt then none of that is relevant: the "window" variable there is the browser window, not the webpage window, and I expect that's what gets passed to nsLoginManagerPrompter.js. You can double-check what its .document.URL is, but I expect it's chrome://whatever/browser.xul.
So we need to either implement this counter down lower where we still know which exact content window (or I guess toplevel content window is the part we really care about) is doing the prompting or we need to propagate the information about the toplevel content window that's doing the prompting up to nsLoginManagerPrompter.js.

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1312243#c16)â€¢ 8 years ago |
|  | |

Thanks Boris, you are right, it's browser.xul. Hence, I don't think this is going to be that easy.
I could store the counter there but I didn't find a spot where I could reset it on reload/navigation. My knowledge of remote browser is thin.Whiteboard: [necko-active] â†’ [necko-next]

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1312243#c17)â€¢ 8 years ago |
|  | |

The right answer is to either propagate the inner window id of the toplevel window along with requests (so you can key things off it), or to maintain the counter and its checks in the content process, before you ever get into that code...

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a1007338_269762)â€¢ 8 years ago |

Status: NEW â†’ ASSIGNEDWhiteboard: [necko-next] â†’ [necko-active]

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a1010058_269762)â€¢ 8 years ago |

Depends on: [1315070](/show_bug.cgi?id=1315070 "RESOLVED INVALID - Assertion failure: mConcurrentCacheAccess, at netwerk/protocol/http/nsHttpChannel.cpp:1230")

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1312243#c18)â€¢ 8 years ago |
|  | |

Attached patch

[v1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)](attachment.cgi?id=8807268&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=8807268&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8807268)

two parts
http:
- carry top-document inner window id to http channel parent
- it has to be done manually, since for document loads the id is not present on load info (weird or expected?) and when I qi/gi it from the child tab's document (yes, it works!) I don't want to modify the existing load info
- in non-e10s we do this lazily in http channel base
pwd manager:
- pwd manager then tracks the number of auth dialogs canceled in a row withing a single page and when there are 3 auth dialogs canceled by the user, it will block any auth dialog within coming from context of the page (iframes/xhr/resources)
- the counter is stored on the parent browser document (broswer.xul) as an attribute
- the limit is preferable and can be turned off
- works in e10s and non-e10s
Justin, please check the pwd manager parts, Patrick, please check the http/ipc changes.
Boris, thanks for guidance!
<https://treeherder.mozilla.org/#/jobs?repo=try&revision=b088124ee4e813500b7022659be33953a063cddb>
[Attachment #8807268](/attachment.cgi?id=8807268&action=edit "v1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(mcmanus)
[Attachment #8807268](/attachment.cgi?id=8807268&action=edit "v1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(dolske)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1312243#c19)â€¢ 8 years ago |
|  | |

> the id is not present on load info
That's odd in general, but can probably happen in some cases.
> and when I qi/gi it from the child tab's document
That is ok, but that's not what happens in the non-e10s case in your patch, right? That case won't do the right thing, because it will get different ids for a page and its subframes. So a page can just create multiple iframes to bypass this.
I think you want to get the nsILoadContext, then get its topWindow (this gives you an outer window), then get the current inner's ID from it, or something along those lines.
Also, this bit:
>+ if (document) {
>+ nsPIDOMWindowOuter\* outer = document->GetWindow();
>+ nsCOMPtr<nsIInterfaceRequestor> windowIR = do\_QueryInterface(outer);
>+ if (windowIR) {
>+ nsCOMPtr<nsIDOMWindowUtils> windowUtils = do\_GetInterface(windowIR);
>+ if (windowUtils) {
>+ windowUtils->GetCurrentInnerWindowID(&contentWindowId);
>+ }
>+ }
should instead be:
if (document) {
contentWindowId = document->InnerWindowID();
}

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1312243#c20)â€¢ 8 years ago |
|  | |

(In reply to Boris Zbarsky [:bz] (still a bit busy) from [comment #19](/show_bug.cgi?id=1312243#c19 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> > the id is not present on load info
>
> That's odd in general, but can probably happen in some cases.
>
> > and when I qi/gi it from the child tab's document
>
> That is ok, but that's not what happens in the non-e10s case in your patch,
> right?
I copied the code from somewhere else when looking around how to get the inner window id when having an outer window in hands.
I will update the patch tomorrow according your suggestions, thanks!

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1312243#c21)â€¢ 8 years ago |
|  | |

> when looking around how to get the inner window id when having an outer window in hands
Sure, but the point is you want the "top" outer window, not the one the channel is in.

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a1071627_269762)â€¢ 8 years ago |

No longer depends on: [1315070](/show_bug.cgi?id=1315070 "RESOLVED INVALID - Assertion failure: mConcurrentCacheAccess, at netwerk/protocol/http/nsHttpChannel.cpp:1230")

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1312243#c22)â€¢ 8 years ago |
|  | |

Attached patch

[v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)](attachment.cgi?id=8807535&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=8807535&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8807535)

Updated according Boris' comments (hopefully correctly) + few more fixes. Thanks again, Boris :)
[Attachment #8807268](/attachment.cgi?id=8807268&action=edit "v1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Attachment is obsolete: true
[Attachment #8807268](/attachment.cgi?id=8807268&action=edit "v1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(mcmanus)
[Attachment #8807268](/attachment.cgi?id=8807268&action=edit "v1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(dolske)
[Attachment #8807535](/attachment.cgi?id=8807535&action=edit "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(mcmanus)
[Attachment #8807535](/attachment.cgi?id=8807535&action=edit "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(dolske)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1312243#c23)â€¢ 8 years ago |
|  | |

Comment on [attachment 8807535](/attachment.cgi?id=8807535 "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[details]](/attachment.cgi?id=8807535&action=edit "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[diff]](/attachment.cgi?id=8807535&action=diff "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8807535)
v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)
<https://treeherder.mozilla.org/#/jobs?repo=try&revision=a4c6e3c5f356c4d8a8bc7b0d89974db59d303aea>

|  | [Justin Dolske [:Dolske]](/user_profile?user_id=27780) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1312243#c24)â€¢ 8 years ago |
|  | |

(In reply to :Gijs Kruitbosch from [comment #5](/show_bug.cgi?id=1312243#c5 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> Honza, can you think of anything else that would (help)?
Just FTR -- although I don't think it will help greatly -- but [bug 1230462](/show_bug.cgi?id=1230462 "RESOLVED FIXED - Clarify actual origin in prompt for cross-origin subresource HTTP authentication") made cross-origin auth prompts no longer show the Realm info ("The site says: xxx" stuff in [attachment 8803672](/attachment.cgi?id=8803672 "browserhijacking.png") [[details]](/attachment.cgi?id=8803672&action=edit "browserhijacking.png")). Assuming that sticks, it would be interesting to see if we can just remove it from all HTTP auth prompts. This doesn't help directly with trapping, but makes it less useful when the site can't put any text in the dialog. (We removed the site-specified text from onbeforeunload prompts too, for the same reason.)

|  | [Justin Dolske [:Dolske]](/user_profile?user_id=27780) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1312243#c25)â€¢ 8 years ago |
|  | |

Comment on [attachment 8807535](/attachment.cgi?id=8807535 "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[details]](/attachment.cgi?id=8807535&action=edit "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[diff]](/attachment.cgi?id=8807535&action=diff "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8807535)
v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)
Review of [attachment 8807535](/attachment.cgi?id=8807535 "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[details]](/attachment.cgi?id=8807535&action=edit "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[diff]](/attachment.cgi?id=8807535&action=diff "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8807535):
-----------------------------------------------------------------
r- but on the right track. :)
::: modules/libpref/init/all.js
@@ +5522,5 @@
> +// When a user cancels this number of authentication dialogs coming from
> +// a sigle web page in a row, all following authentication dialogs will
> +// be blocked (automatically canceled) for that page. The counter resets
> +// when the page is reloaded. To turn this feature off, just set the limit to 0.
> +pref("general.authentication-dialog-bloat-limit", 3);
At risk of bikeshedding a little:
1) How about just making this a simple boolean? I think it's pretty unlike that this is something people would ever need to tune. Just give it a reasonable internal default (3), and let people disable it via pref if needed. (I think that's unlikely too, although it's still good to have so we can hotfix disable it if needed.)
2) prompts.block\_abusive\_http\_auth\_requests? ...meh, I don't have a substantially better suggestion.
::: toolkit/components/passwordmgr/nsLoginManagerPrompter.js
@@ +89,5 @@
> +
> + // Allow only limited number of authentication dialogs when they are all
> + // canceled by the user.
> + var cancelationCounter = { count: 0, id: 0 };
> + var chromeDoc = prompter.\_chromeWindow.document.documentElement;
You won't always have a \_chromeWindow available, unfortunately.
But other than needing to deal with this being undefined, I don't think that's a problem... AFAIK this can only happen with extension related code (the comment in init() suggests a JSM or Sandbox), so that's probably ok to not worry about traps occurring in such cases?
MattN, that sound reasonable?
@@ +106,5 @@
> + }
> +
> + var cancelDialogLimit = 0;
> + try {
> + cancelDialogLimit = Services.prefs.getIntPref("general.authentication-dialog-bloat-limit");
This doesn't need to be in a try-catch, since the pref will always exist (since it's in all.js).
@@ +111,5 @@
> + } catch (ex) { }
> +
> + this.log("cancelationCounter = " + JSON.stringify(cancelationCounter));
> + if (cancelDialogLimit && cancelationCounter.count >= cancelDialogLimit) {
> + this.log("Blocking on limit");
"Blocking auth dialog, due to exceeding dialog bloat limit" (or whatever, just want to make this a little more descriptive since it's the first log message about what might be happening.)
@@ +135,5 @@
> + }
> +
> + Services.tm.mainThread.dispatch(cancel, Ci.nsIThread.DISPATCH\_NORMAL);
> + return;
> + }
Instead of duplicating all this code from the existing runnable (a few lines down), I think it would simpler to just set a "shouldLimit" flag when the cancel limit is exceeded, and tweak the existing runnable code to skip showing an actual prompt when that flag was set.
For the master password uiBusy stuff on line 149, you could also add a check for shouldSkip so we don't try to bypass the prompt (since we know we'd just skip it anyway)... Although things would work just fine without doing this, so you don't actually need to do this.
@@ +178,5 @@
>
> + if (ok) {
> + cancelationCounter.count = 0;
> + } else {
> + ++cancelationCounter.count;
Nit: A post-increment is more common style, and slightly clearer.
@@ +180,5 @@
> + cancelationCounter.count = 0;
> + } else {
> + ++cancelationCounter.count;
> + }
> + chromeDoc.setAttribute("canceled-authentication-prompt-counter", JSON.stringify(cancelationCounter));
See above about \_chromeWin.
[Attachment #8807535](/attachment.cgi?id=8807535&action=edit "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(dolske) â†’ review-

|  | [Justin Dolske [:Dolske]](/user_profile?user_id=27780) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1312243#c26)â€¢ 8 years ago |
|  | |

MattN: question for in last comment (search for MattN :).Flags: needinfo?(MattN+bmo)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1312243#c27)â€¢ 8 years ago |
|  | |

(In reply to Justin Dolske [:Dolske] from [comment #25](/show_bug.cgi?id=1312243#c25 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> Comment on [attachment 8807535](/attachment.cgi?id=8807535 "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[details]](/attachment.cgi?id=8807535&action=edit "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[diff]](/attachment.cgi?id=8807535&action=diff "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8807535)
> v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)
>
> Review of [attachment 8807535](/attachment.cgi?id=8807535 "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[details]](/attachment.cgi?id=8807535&action=edit "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[diff]](/attachment.cgi?id=8807535&action=diff "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8807535):
> -----------------------------------------------------------------
>
> r- but on the right track. :)
Thanks :)
>
> ::: modules/libpref/init/all.js
> @@ +5522,5 @@
> > +// When a user cancels this number of authentication dialogs coming from
> > +// a sigle web page in a row, all following authentication dialogs will
> > +// be blocked (automatically canceled) for that page. The counter resets
> > +// when the page is reloaded. To turn this feature off, just set the limit to 0.
> > +pref("general.authentication-dialog-bloat-limit", 3);
>
> At risk of bikeshedding a little:
>
> 1) How about just making this a simple boolean? I think it's pretty unlike
> that this is something people would ever need to tune. Just give it a
> reasonable internal default (3), and let people disable it via pref if
> needed. (I think that's unlikely too, although it's still good to have so we
> can hotfix disable it if needed.)
>
> 2) prompts.block\_abusive\_http\_auth\_requests? ...meh, I don't have a
> substantially better suggestion.
I suspect we will hit users that may want to cancel 3 dialogs and expect the fourth to give it it's credentials. There are weird server configuration in the wild, also think of multiple auth challenges etc.. Hence, I'd rather keep the counter pref. We can turn it off easily with setting it to 0.
I'll gladly rename it to be closer to your suggestion.

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1312243#c28)â€¢ 8 years ago |
|  | |

Attached patch

[v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)](attachment.cgi?id=8809862&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=8809862&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8809862)

- nits in the prompter fixed
- preference renamed, but left as a counter
- http parts unchanged
[Attachment #8807535](/attachment.cgi?id=8807535&action=edit "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Attachment is obsolete: true
[Attachment #8807535](/attachment.cgi?id=8807535&action=edit "v2 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(mcmanus)
[Attachment #8809862](/attachment.cgi?id=8809862&action=edit "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(mcmanus)
[Attachment #8809862](/attachment.cgi?id=8809862&action=edit "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(dolske)

|  | [Matthew N. [:MattN]](/user_profile?user_id=305228) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1312243#c29)â€¢ 8 years ago |
|  | |

(In reply to Justin Dolske [:Dolske] from [comment #25](/show_bug.cgi?id=1312243#c25 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> ::: toolkit/components/passwordmgr/nsLoginManagerPrompter.js
> @@ +89,5 @@
> > +
> > + // Allow only limited number of authentication dialogs when they are all
> > + // canceled by the user.
> > + var cancelationCounter = { count: 0, id: 0 };
> > + var chromeDoc = prompter.\_chromeWindow.document.documentElement;
>
> You won't always have a \_chromeWindow available, unfortunately.
>
> But other than needing to deal with this being undefined, I don't think
> that's a problem... AFAIK this can only happen with extension related code
> (the comment in init() suggests a JSM or Sandbox), so that's probably ok to
> not worry about traps occurring in such cases?
>
> MattN, that sound reasonable?
Right, I think it's fine to not block repeated requests if there is no chromeWindow.
From a quick skim of the bug I'm not sure why the counter is on `prompter.\_chromeWindow.documentâ€¦` since that is referring to browser.xul. I would have expected that the counter would be on something specific to the tab/contentDocument/contentWindow. Apologies if I'm missing context.Flags: needinfo?(MattN+bmo)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1312243#c30)â€¢ 8 years ago |
|  | |

(In reply to Matthew N. [:MattN] (away Nov. 3â€“7) from [comment #29](/show_bug.cgi?id=1312243#c29 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> From a quick skim of the bug I'm not sure why the counter is on
> `prompter.\_chromeWindow.documentâ€¦` since that is referring to browser.xul. I
> would have expected that the counter would be on something specific to the
> tab/contentDocument/contentWindow. Apologies if I'm missing context.
the code is running on parent. don't want to use CPOWs to get to the content. and this is a perfect place. there is just a single attribute per tab (exactly what I want). content window is id'ed only (all the other IPC stuff in the patch)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1312243#c31)â€¢ 8 years ago |
|  | |

(In reply to Honza Bambas (:mayhemer) from [comment #30](/show_bug.cgi?id=1312243#c30 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> (In reply to Matthew N. [:MattN] (away Nov. 3â€“7) from [comment #29](/show_bug.cgi?id=1312243#c29 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> > From a quick skim of the bug I'm not sure why the counter is on
> > `prompter.\_chromeWindow.documentâ€¦` since that is referring to browser.xul. I
> > would have expected that the counter would be on something specific to the
> > tab/contentDocument/contentWindow. Apologies if I'm missing context.
>
> the code is running on parent. don't want to use CPOWs to get to the
> content. and this is a perfect place. there is just a single attribute per
> tab (exactly what I want). content window is id'ed only (all the other IPC
> stuff in the patch)
\_chromeWindow, as Matt already said, is browser.xul. I'm pretty sure that in your code there isn't "a single attribute per tab" - there is one attribute for all the tabs in the window, because (unless Matt and I are both mistaken...) you're setting it on the chrome XUL <window> element. If multiple tabs are navigating they would clobber the value you're storing (because the inner window IDs of the different tabs are different, of course).
At a guess, you may want to store this on the <browser> elements, or you may want to use a Map() from inner window IDs to counts, (which would of course "leak" that data until the chrome window goes away, which may or may not be something we care about).
Either way, I'm not sure why you're using an attribute and JSON serialization - you can just store an expando on the DOM element or the \_chromeWindow (effectively a global var in the chrome window), which makes using a single structure to cover all the tabs in the window more palatable.

|  | [Matthew N. [:MattN]](/user_profile?user_id=305228) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1312243#c32)â€¢ 8 years ago |
|  | |

(In reply to Honza Bambas (:mayhemer) from [comment #30](/show_bug.cgi?id=1312243#c30 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> (In reply to Matthew N. [:MattN] (away Nov. 3â€“7) from [comment #29](/show_bug.cgi?id=1312243#c29 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> > From a quick skim of the bug I'm not sure why the counter is on
> > `prompter.\_chromeWindow.documentâ€¦` since that is referring to browser.xul. I
> > would have expected that the counter would be on something specific to the
> > tab/contentDocument/contentWindow. Apologies if I'm missing context.
>
> the code is running on parent. don't want to use CPOWs to get to the
> content. and this is a perfect place. there is just a single attribute per
> tab (exactly what I want). content window is id'ed only (all the other IPC
> stuff in the patch)
You don't need a CPOW to store per-browser state as you can store it on the <browser> like Gijs said.
Your response isn't convincing me that you're handling multiple tabs properly. There is one browser.xul per visible window. I agree with everything Gijs says.

|  | [Matthew N. [:MattN]](/user_profile?user_id=305228) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1312243#c33)â€¢ 8 years ago |
|  | |

Side note: In code related to content which deals with ChromeWindow's I always like the variable names to be explicit about content vs. chrome and my insistence on renaming this variable lately (IIRC) is why I easily caught this bug.

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1312243#c34)â€¢ 8 years ago |
|  | |

Comment on [attachment 8809862](/attachment.cgi?id=8809862 "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[details]](/attachment.cgi?id=8809862&action=edit "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[diff]](/attachment.cgi?id=8809862&action=diff "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8809862)
v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)
Review of [attachment 8809862](/attachment.cgi?id=8809862 "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[details]](/attachment.cgi?id=8809862&action=edit "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[diff]](/attachment.cgi?id=8809862&action=diff "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8809862):
-----------------------------------------------------------------
I'm ok with the changes to the necko data structures, but I'm not really the right reviewer for the correct use of those windowID calls. But when dolske has r+'d it that would seem right.
[Attachment #8809862](/attachment.cgi?id=8809862&action=edit "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(mcmanus) â†’ review+

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1312243#c35)â€¢ 8 years ago |
|  | |

Matt, Gijs, you are right.
I did a simple test: a top level page (no authentication) referring an iframe which requires auth. The top level page refreshes the iframe (location.reload()) every 4 seconds. If I open just one tab, the patch works. If I open two tabs, the attribute apparently refers to the \_windows\_ browser.xul\_ and not to the tab's entity (if there is such), since the id is apparently always different.
(In reply to :Gijs Kruitbosch (PTO Nov. 17-20 inclusive) from [comment #31](/show_bug.cgi?id=1312243#c31 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> At a guess, you may want to store this on the <browser> elements,
How do I reach it? I never worked with this before, sorry.
And expando is better, right. I somehow was convinced only acceptable value to setAttribute was a string.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1312243#c36)â€¢ 8 years ago |
|  | |

(In reply to Honza Bambas (:mayhemer) from [comment #35](/show_bug.cgi?id=1312243#c35 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> (In reply to :Gijs Kruitbosch (PTO Nov. 17-20 inclusive) from [comment #31](/show_bug.cgi?id=1312243#c31 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> > At a guess, you may want to store this on the <browser> elements,
>
> How do I reach it? I never worked with this before, sorry.
From a quick look at the code, I think prompter.\_browser refers to the correct browser element, though it does look like that might be relying on CPOWs... Matt would be able to confirm whether this works correctly.
> And expando is better, right. I somehow was convinced only acceptable value
> to setAttribute was a string.
setAttribute \*does\* only take strings, so you're right about that. What I meant is just setting
\_browser.\_someProp = someObject
which should work.

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1312243#c37)â€¢ 8 years ago |
|  | |

(In reply to :Gijs Kruitbosch (PTO Nov. 17-20 inclusive) from [comment #36](/show_bug.cgi?id=1312243#c36 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> From a quick look at the code, I think prompter.\_browser refers to the
Yes, it works. I can't confirm if it is or is not CPOWs, tho.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1312243#c38)â€¢ 8 years ago |
|  | |

> I can't confirm if it is or is not CPOWs, tho.
It's not.

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1312243#c39)â€¢ 8 years ago |
|  | |

Attached patch

[v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)](attachment.cgi?id=8811336&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=8811336&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8811336)

- using prompter.\_browser.canceledAuthenticationPromptCounter expando
- otherwise the same except some small cleanup
<https://treeherder.mozilla.org/#/jobs?repo=try&revision=a0025e49664d8414ab713915cde8a7c3394fbc70>
[Attachment #8811336](/attachment.cgi?id=8811336&action=edit "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") -
Flags: review?(dolske)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1312243#c40)â€¢ 8 years ago |
|  | |

Comment on [attachment 8809862](/attachment.cgi?id=8809862 "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[details]](/attachment.cgi?id=8809862&action=edit "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[diff]](/attachment.cgi?id=8809862&action=diff "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8809862)
v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)
Sorry, forgot to obsolete this.
[Attachment #8809862](/attachment.cgi?id=8809862&action=edit "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Attachment is obsolete: true
[Attachment #8809862](/attachment.cgi?id=8809862&action=edit "v2.1 (carry inner window id to httpchannelparent, limit cancled auth dialogs)") -
Flags: review?(dolske)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1312243#c41)â€¢ 8 years ago |
|  | |

Comment on [attachment 8811336](/attachment.cgi?id=8811336 "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[details]](/attachment.cgi?id=8811336&action=edit "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[diff]](/attachment.cgi?id=8811336&action=diff "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8811336)
v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)
No response from Justin for 10 days. Gijs, can you take a look please? Feel free to bounce or suggest someone else. I wanted to get this to 52 ASAP (esr). Thanks.
[Attachment #8811336](/attachment.cgi?id=8811336&action=edit "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") -
Flags: review?(dolske) â†’ review?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1312243#c42)â€¢ 8 years ago |
|  | |

Comment on [attachment 8811336](/attachment.cgi?id=8811336 "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[details]](/attachment.cgi?id=8811336&action=edit "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[diff]](/attachment.cgi?id=8811336&action=diff "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8811336)
v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)
Review of [attachment 8811336](/attachment.cgi?id=8811336 "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[details]](/attachment.cgi?id=8811336&action=edit "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[diff]](/attachment.cgi?id=8811336&action=diff "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8811336):
-----------------------------------------------------------------
I don't have a lot of time right now. I might have more time on Monday, but I would suggest that Matt would be a better reviewer than me, if dolske is too busy. I've offered a few suggestions below, though...
::: toolkit/components/passwordmgr/nsLoginManagerPrompter.js
@@ +96,5 @@
> this.log("\_doAsyncPrompt:run bypassed, master password UI busy");
> return;
> }
>
> + // Allow only limited number of authentication dialogs when they are all
Nit: Allow only \*a\* limited number of ...
@@ +103,5 @@
> + if (prompt.channel) {
> + var httpchannel = prompt.channel.QueryInterface(Ci.nsIHttpChannel);
> + if (httpchannel) {
> + var windowId = httpchannel.contentWindowId;
> + if (windowId != cancelationCounter.id) {
From a quick look, I was confused by this. Can we make sure that the property on the http channel is explicitly called \*toplevel\* content window ID? Because AIUI that's what it reflects, not the content window ID of the individual frame that might be causing the auth prompt.
@@ +104,5 @@
> + var httpchannel = prompt.channel.QueryInterface(Ci.nsIHttpChannel);
> + if (httpchannel) {
> + var windowId = httpchannel.contentWindowId;
> + if (windowId != cancelationCounter.id) {
> + // window content have been reloaded or navigated, reset the counter
nit: window has been reloaded or navigated, reset the counter
@@ +172,5 @@
> + if (cancelDialogLimit && cancelationCounter.count >= cancelDialogLimit) {
> + this.log("Blocking auth dialog, due to exceeding dialog bloat limit");
> + delete this.\_asyncPrompts[hashKey];
> + prompt.inProgress = false;
> + this.\_asyncPromptInProgress = false;
Do we actually need to set these to false? How would they have been set to true before now?
@@ +181,5 @@
> + return;
> + }
> +
> + this.\_asyncPromptInProgress = true;
> + prompt.inProgress = true;
Feels like it'd be a little simpler (and keep the .log) to put this in an else, and kill the early return, letting us fall through rather than duplicating the runnable dispatch.
[Attachment #8811336](/attachment.cgi?id=8811336&action=edit "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") -
Flags: review?(gijskruitbosch+bugs) â†’ feedback+

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1312243#c43)â€¢ 8 years ago |
|  | |

Thanks for such a quick feedback! I'll update and ask Matt.

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1312243#c44)â€¢ 8 years ago |
|  | |

Attached patch

[v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)](attachment.cgi?id=8814466&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=8814466&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8814466)

Updated according [comment 42](/show_bug.cgi?id=1312243#c42 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page").
BTW, there is still one way to perform the attack. When a page has an iframe asking for auth and the top level page reloads itself constantly, we are in the same situation again.
[Attachment #8811336](/attachment.cgi?id=8811336&action=edit "v2.2 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") -
Attachment is obsolete: true
[Attachment #8814466](/attachment.cgi?id=8814466&action=edit "v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") -
Flags: review?(MattN+bmo)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1312243#c45)â€¢ 8 years ago |
|  | |

Matt, ping on review.

|  | [Matthew N. [:MattN]](/user_profile?user_id=305228) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1312243#c46)â€¢ 8 years ago |
|  | |

Comment on [attachment 8814466](/attachment.cgi?id=8814466 "v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[details]](/attachment.cgi?id=8814466&action=edit "v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[diff]](/attachment.cgi?id=8814466&action=diff "v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8814466)
v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)
Review of [attachment 8814466](/attachment.cgi?id=8814466 "v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[details]](/attachment.cgi?id=8814466&action=edit "v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[diff]](/attachment.cgi?id=8814466&action=diff "v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8814466):
-----------------------------------------------------------------
r=me but this (like any security/abuse prevention bug) really deserves a test (especially when we have existing ones to base it on). See toolkit/components/passwordmgr/test/mochitest/test\_prompt\_http.html for one example. I think the `handlePrompt` test helper should make this not very painful.
::: modules/libpref/init/all.js
@@ +5534,5 @@
> pref("dom.storageManager.enabled", false);
> #endif
>
> +// When a user cancels this number of authentication dialogs coming from
> +// a sigle web page in a row, all following authentication dialogs will
Nit: "sigle"
@@ +5537,5 @@
> +// When a user cancels this number of authentication dialogs coming from
> +// a sigle web page in a row, all following authentication dialogs will
> +// be blocked (automatically canceled) for that page. The counter resets
> +// when the page is reloaded. To turn this feature off, just set the limit to 0.
> +pref("prompt.authentication\_dialog\_abuse\_limit", 3);
Nit: We have another pref that starts with "prompts." (plural) so it would be good to make this plural too.
::: toolkit/components/passwordmgr/nsLoginManagerPrompter.js
@@ +101,5 @@
> + // canceled by the user.
> + var cancelationCounter = (prompter.\_browser && prompter.\_browser.canceledAuthenticationPromptCounter) || { count: 0, id: 0 };
> + if (prompt.channel) {
> + var httpchannel = prompt.channel.QueryInterface(Ci.nsIHttpChannel);
> + if (httpchannel) {
Nit: Use camelCase e.g. `httpChannel`
@@ +167,5 @@
> };
>
> + var cancelDialogLimit = Services.prefs.getIntPref("prompt.authentication\_dialog\_abuse\_limit");
> +
> + this.log("cancelationCounter = " + JSON.stringify(cancelationCounter));
Nit: You should't need the JSON.stringify if you pass the object as the 2nd argument IIRC. Without it you will get an inspectable object in the DevTools and a different color-coding (which helps it stand out).
`this.log("cancelationCounter =", cancelationCounter);`
[Attachment #8814466](/attachment.cgi?id=8814466&action=edit "v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") -
Flags: review?(MattN+bmo) â†’ review+

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1312243#c48)â€¢ 8 years ago |
|  | |

Attached patch

[v2.4 (r addressed, no test)](attachment.cgi?id=8819273&action=diff)
â€” [Details](attachment.cgi?id=8819273&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8819273)

I'm going to land this now w/o a test and ask for a+ on m-a as I want this be in 52 (ESR). I'll write the test later in a different bug and ask a+ to m-a for it too. Sorry, I'm in a time press now and the test is not that easy to write as you may think.
[Attachment #8814466](/attachment.cgi?id=8814466&action=edit "v2.3 (carry inner window id to httpchannelparent, limit cancled auth dialogs in pwdmngr)") -
Attachment is obsolete: true
[Attachment #8819273](/attachment.cgi?id=8819273&action=edit "v2.4 (r addressed, no test)") -
Flags: review+

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a4696852_269762)â€¢ 8 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a4699245_269762)â€¢ 8 years ago |

Blocks: [1323973](/show_bug.cgi?id=1323973 "RESOLVED FIXED - Write tests for patch from bug 1312243 (auth dialog abuse blocker)")

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1312243#c49)â€¢ 8 years ago |
|  | |

Pushed by cbook@mozilla.com:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/e077cda0a979>
Block authentication dialog pop-ups by cancling 3 of them in a row, r=Dolske+mcmanusKeywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Matthew N. [:MattN]](/user_profile?user_id=305228) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1312243#c50)â€¢ 8 years ago |
|  | |

(In reply to Pulsebot from [comment #49](/show_bug.cgi?id=1312243#c49 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> r=Dolske+mcmanus
The reviewer list was stale

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1312243#c51)â€¢ 8 years ago |
|  | |

(In reply to Matthew N. [:MattN] (PM me if requests are blocking you) from [comment #50](/show_bug.cgi?id=1312243#c50 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> (In reply to Pulsebot from [comment #49](/show_bug.cgi?id=1312243#c49 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> > r=Dolske+mcmanus
>
> The reviewer list was stale
Sorry, thanks!

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1312243#c52)â€¢ 8 years ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/e077cda0a979>Status: ASSIGNED â†’ RESOLVEDClosed: 8 years ago
[status-firefox53](/buglist.cgi?f1=cf_status_firefox53&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ mozilla53

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1312243#c54)â€¢ 8 years ago |
|  | |

[Tracking Requested - why for this release]:
This affects our users in the wild. While it's probably too late in the game for 51, we should try to take this for 52 if we can.
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected)
[tracking-firefox52](/buglist.cgi?f1=cf_tracking_firefox52&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%3F)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1312243#c55)â€¢ 8 years ago |
|  | |

Comment on [attachment 8819273](/attachment.cgi?id=8819273 "v2.4 (r addressed, no test)") [[details]](/attachment.cgi?id=8819273&action=edit "v2.4 (r addressed, no test)") [[diff]](/attachment.cgi?id=8819273&action=diff "v2.4 (r addressed, no test)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8819273)
v2.4 (r addressed, no test)
Approval Request Comment
[Feature/Bug causing the regression]: since ever
[User impact if declined]: complete blockade of UI through a number of modal auth dialogs
[Is this code covered by automated tests?]: somewhat, we have tests for these parts of code, but not for this particular issue (filed a followup [bug 1323973](/show_bug.cgi?id=1323973 "RESOLVED FIXED - Write tests for patch from bug 1312243 (auth dialog abuse blocker)"))
[Has the fix been verified in Nightly?]: locally, yes
[Needs manual test from QE? If yes, steps to reproduce]: before [bug 1323973](/show_bug.cgi?id=1323973 "RESOLVED FIXED - Write tests for patch from bug 1312243 (auth dialog abuse blocker)") lands (not sooner than Jan 2017), maybe
[List of other uplifts needed for the feature/fix]: none
[Is the change risky?]: I think not
[Why is the change risky/not risky?]: reload of a page discards any auth dialog limits this patch introduces, it can also be turned off by a preference
[String changes made/needed]: none
[Attachment #8819273](/attachment.cgi?id=8819273&action=edit "v2.4 (r addressed, no test)") -
Flags: approval-mozilla-aurora?

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1312243#c56)â€¢ 8 years ago |
|  | |

Is there a test URL that QE could use for verification?Flags: needinfo?(honzab.moz)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1312243#c57)â€¢ 8 years ago |
|  | |

(In reply to Julien Cristau [:jcristau] from [comment #56](/show_bug.cgi?id=1312243#c56 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> Is there a test URL that QE could use for verification?
I think here are some URLs to test with: [https://bugzilla.mozilla.org/show\_bug.cgi?id=1324226#c1](/show_bug.cgi?id=1324226#c1 "RESOLVED DUPLICATE - Browser Hijack using data URI and lots of http auth prompts")Flags: needinfo?(honzab.moz)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1312243#c58)â€¢ 8 years ago |
|  | |

Comment on [attachment 8819273](/attachment.cgi?id=8819273 "v2.4 (r addressed, no test)") [[details]](/attachment.cgi?id=8819273&action=edit "v2.4 (r addressed, no test)") [[diff]](/attachment.cgi?id=8819273&action=diff "v2.4 (r addressed, no test)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8819273)
v2.4 (r addressed, no test)
limit the number of auth pop-ups shown for a page to block abuse, take in aurora52
[Attachment #8819273](/attachment.cgi?id=8819273&action=edit "v2.4 (r addressed, no test)") -
Flags: approval-mozilla-aurora? â†’ approval-mozilla-aurora+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1312243#c59)â€¢ 8 years ago |
|  | |

Hopefully [comment 57](/show_bug.cgi?id=1312243#c57 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page") can help with verification, though it looks like the URLs mentioned there no longer exist.Flags: qe-verify+

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=1312243#c60)â€¢ 8 years ago |
|  | |

need rebasingFlags: needinfo?(honzab.moz)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1312243#c61)â€¢ 8 years ago |
|  | |

Attached patch

[v2.4 for m-a](attachment.cgi?id=8820302&action=diff)
â€” [Details](attachment.cgi?id=8820302&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1312243&attachment=8820302)

Here it is (build checked locally, debug only)Flags: needinfo?(honzab.moz)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a5123168_580382)â€¢ 8 years ago |

[tracking-firefox52](/buglist.cgi?f1=cf_tracking_firefox52&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%3F) â†’ [-](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=-)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=1312243#c62)â€¢ 8 years ago |
| bugherder uplift | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/fec44289a5e2>
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=1312243#c63)â€¢ 8 years ago |
|  | |

The links from [comment 57](/show_bug.cgi?id=1312243#c57 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page") does not work anymore so I had a look at the duplicate bugs here but was unable to find some link or a testcase in order to reproduce/verify this bug.
I used the data URI attached in [bug 1312836 comment 1](/show_bug.cgi?id=1312836#c1 "RESOLVED DUPLICATE - browser takeover/denial of service via data URI and HTTP authentication dialog") but under Windows 7 and macOS 10.12.3 I see the same behavior on Fx 49.0 (which should be not fixed) as on Fx 52 beta 8 (which should be fixed), with every click on that webpage Fx will open window after window.
Chris, I know it's been a long time but could you reliable reproduce this? If yes can you make public the website you used?
If anyone else knows how I can reproduce (in order to verify) this please let me know, it will be much appreciated.Flags: needinfo?(firefox-bugzilla)

|  | [Chris](/user_profile?user_id=202670)  Reporter |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=1312243#c64)â€¢ 8 years ago |
|  | |

Sorry The site appears to be assist.support-care-uk.in (from the image I posted) but it no longer exists.
Because of the nature of the exploit I was not able to copy the data URL.
I have searched through my history and have a gap around the time of the incident. Which would be because I had to kill the browser so its recent history was not flushed to disk.
The only places in my history I visited around that time and date were netflix and google. I do not recall what the original site was but I was pulled into a rapid circle jerk which finished at the data URL. I could not reproduce it if I tried.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a11050766_280903)â€¢ 8 years ago |

Whiteboard: [necko-active] â†’ [necko-active][adv-main52+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a11208252_280903)â€¢ 8 years ago |

Alias: CVE-2017-5419

|  | [Iulia Cristescu, QA [:JuliaC] (away, please needinfo? cornel.ionce@softvision.ro)](/user_profile?user_id=565219) |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=1312243#c65)â€¢ 8 years ago |
|  | |

As the links from [comment 57](/show_bug.cgi?id=1312243#c57 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page") and from the duplicate bugs don't work anymore, I tried to find another valid links that can trigger this issue, but with no luck.
With <https://bug1312836.bmoattachments.org/attachment.cgi?id=8804398>, I noticed the same behavior on Windows 10 x64, using 52.0a1 (2016-10-22), 53.0b1 build1 (20170307064827) and 52.0 build2 (20170302120751) (like Bogdan did - see [comment 63](/show_bug.cgi?id=1312243#c63 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page")) - with every click on that webpage, Firefox will open window after window (about:blank).
Chris, Honza, any thoughts about this behavior? Also, any chance to find a valid link for reproducing / verifying this issue?Flags: needinfo?(honzab.moz)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=1312243#c66)â€¢ 8 years ago |
|  | |

Note that this fixes only a case when a page contains an iframe that 1) asks for auth 2) is reloaded by the top level page on and on. If such the page would reload itself (not just the iframe), the patch would not help.
On Nightly and Beta I \_can't\_ repro with <https://bug1312836.bmoattachments.org/attachment.cgi?id=8804398>Flags: needinfo?(honzab.moz)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=1312243#c67)â€¢ 8 years ago |
|  | |

And another note that this only protects against abuse auth prompts, nothing else.

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a34174134_269762)â€¢ 7 years ago |

See Also: â†’ [1418644](/show_bug.cgi?id=1418644 "RESOLVED WORKSFORME - Username/password prompt can be used to hijack the browser")

|  | [ga48](/user_profile?user_id=586223) |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=1312243#c68)â€¢ 7 years ago |
|  | |

(In reply to Iulia Cristescu, QA [:JuliaC] from [comment #65](/show_bug.cgi?id=1312243#c65 "RESOLVED FIXED - Trap site uses repeated http auth prompts to keep the user on the page"))
> Also, any chance to find a valid link for reproducing / verifying this issue?
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1439157](/show_bug.cgi?id=1439157 "RESOLVED DUPLICATE - Web site login feature permits un-closeable pop-up windows [spam exploit]")

|  | [Matthew N. [:MattN]](/user_profile?user_id=305228) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a50510560_305228)â€¢ 7 years ago |

Depends on: [1426656](/show_bug.cgi?id=1426656 "NEW - Add \"disable HTTP authentication prompts\" for this site to auth prompt dialog")

|  | [Johann Hofmann [:johannh]](/user_profile?user_id=522029) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a71618201_522029)â€¢ 6 years ago |

See Also: â†’ [377496](/show_bug.cgi?id=377496 "VERIFIED FIXED - 'Authentication Required' dialogue being application modal produces a vector for attack")

|  | [ovidiu boca[:Ovidiu]](/user_profile?user_id=551038) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a73284970_551038)â€¢ 6 years ago |

Whiteboard: [necko-active][adv-main52+] â†’ [necko-active][adv-main52+][qa-triaged]

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a74510807_488993)â€¢ 6 years ago |

QA Whiteboard: [qa-triaged]Whiteboard: [necko-active][adv-main52+][qa-triaged] â†’ [necko-active][adv-main52+]

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=1312243#c69)â€¢ 6 years ago |
|  | |

Some steps to reproduce are still required in order to correctly verify this bug. Honza, Do you think this can still be verified at this point or should we ignore it in the future?

Has STR: --- â†’ noFlags: needinfo?(honzab.moz)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=1312243#c70)â€¢ 6 years ago |
|  | |

Is your request to me to provide the STR? This is hard to test in an automated fashion, yes, so a static web page for testing would be good to have, right?

Flags: needinfo?(honzab.moz) â†’ needinfo?(daniel.bodea)

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=1312243#c71)â€¢ 6 years ago |
|  | |

Yes, please. That would be very helpful. Thank you.

Flags: needinfo?(daniel.bodea) â†’ needinfo?(honzab.moz)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=1312243#c72)â€¢ 6 years ago |
|  | |

Deadline?

Flags: needinfo?(daniel.bodea)

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=1312243#c73)â€¢ 6 years ago |
|  | |

Considering the fact that this "qe-verify+" tag was set about 3 years ago, I don't think there's any hurry to it... :)

Flags: needinfo?(daniel.bodea)

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=1312243#c74)â€¢ 6 years ago |
|  | |

Just a reminder for Honza :)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=1312243#c75)â€¢ 5 years ago |
|  | |

Is the test in [bug 377496](/show_bug.cgi?id=377496 "VERIFIED FIXED - 'Authentication Required' dialogue being application modal produces a vector for attack") enough?

Flags: needinfo?(honzab.moz) â†’ needinfo?(daniel.bodea)

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=1312243#c76)â€¢ 5 years ago |
|  | |

In [bug 377496](/show_bug.cgi?id=377496 "VERIFIED FIXED - 'Authentication Required' dialogue being application modal produces a vector for attack"), there are 2 test cases:

1. A test case in the description: opening a page (<http://gobase.org/studying/articles/mioch/7/index.html>) and the authentification prompt would appear by default. The authentification prompt does not appear anymore.
2. Another test case in the comment section (<https://bugzilla.mozilla.org/show_bug.cgi?id=377496#c36>): which has a test page (<http://www.httpwatch.com/httpgallery/authentication/#showExample10>). Clickin the "DISPLAY IMAGE" button will trigger an authentification prompt. In this case, the prompt is displayed, and the page is still somewhat unusable (only scrolling it is possible while the prompt is not dismissed).

* Clicking the prompt's OK button two times in a row will dismiss the prompt and the page becomes usable.
* Clicking the prompt's "Cancel" or "X" buttons will instantly dismiss the authentification prompt and leave the page usable.

I don't know what this bug fixed/what are the previous expected results and the newly expected results. How exactly is this supposed to work?

Flags: needinfo?(daniel.bodea) â†’ needinfo?(honzab.moz)

|  | [Matthew N. [:MattN]](/user_profile?user_id=305228) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1312243#a109868931_305228)â€¢ 5 years ago |

Depends on: [1577174](/show_bug.cgi?id=1577174 "RESOLVED INCOMPLETE - authentication_dialog_abuse_limit can cause the browser to freeze/crash")

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762)  Assignee |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=1312243#c77)â€¢ 5 years ago |
|  | |

As there is some work happening in [bug 613785](/show_bug.cgi?id=613785 "RESOLVED FIXED - Switch to using tab-modal prompt dialogs for HTTP authentication"), this is no longer serious enough to spend time verifying. [Bug 613785](/show_bug.cgi?id=613785 "RESOLVED FIXED - Switch to using tab-modal prompt dialogs for HTTP authentication") will actually nullify this issue completely.

Flags: needinfo?(honzab.moz)
You need to [log in](/show_bug.cgi?id=1312243&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Chris](/user_profile?user_id=202670)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_22c9f265_20250124_121948.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2017-09

## Security vulnerabilities fixed in - Thunderbird 52

Announced
April 5, 2017
Impact
critical
Products
Thunderbird
Fixed in

* Thunderbird 52

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2017-5400: asm.js JIT-spray bypass of ASLR and DEP](#CVE-2017-5400)

Reporter
Rh0
Impact
critical
##### Description

JIT-spray targeting asm.js combined with a heap spray allows for a bypass of ASLR and DEP protections leading to potential memory corruption attacks.

##### References

* [Bug 1334933](https://bugzilla.mozilla.org/show_bug.cgi?id=1334933)

#### [#CVE-2017-5401: Memory Corruption when handling ErrorResult](#CVE-2017-5401)

Reporter
Anton Eliasson
Impact
critical
##### Description

A crash triggerable by web content in which an `ErrorResult` references unassigned memory due to a logic error. The resulting crash may be exploitable.

##### References

* [Bug 1328861](https://bugzilla.mozilla.org/show_bug.cgi?id=1328861)

#### [#CVE-2017-5402: Use-after-free working with events in FontFace objects](#CVE-2017-5402)

Reporter
Nils
Impact
critical
##### Description

A use-after-free can occur when events are fired for a `FontFace` object after the object has been already been destroyed while working with fonts. This results in a potentially exploitable crash.

##### References

* [Bug 1334876](https://bugzilla.mozilla.org/show_bug.cgi?id=1334876)

#### [#CVE-2017-5403: Use-after-free using addRange to add range to an incorrect root object](#CVE-2017-5403)

Reporter
Nils
Impact
critical
##### Description

When adding a range to an object in the DOM, it is possible to use `addRange` to add the range to an incorrect root object. This triggers a use-after-free, resulting in a potentially exploitable crash.

##### References

* [Bug 1340186](https://bugzilla.mozilla.org/show_bug.cgi?id=1340186)

#### [#CVE-2017-5404: Use-after-free working with ranges in selections](#CVE-2017-5404)

Reporter
Ivan Fratric of Google Project Zero
Impact
critical
##### Description

A use-after-free error can occur when manipulating ranges in selections with one node inside a native anonymous tree and one node outside of it. This results in a potentially exploitable crash.

##### References

* [Bug 1340138](https://bugzilla.mozilla.org/show_bug.cgi?id=1340138)

#### [#CVE-2017-5406: Segmentation fault in Skia with canvas operations](#CVE-2017-5406)

Reporter
Atte Kettunen
Impact
high
##### Description

A segmentation fault can occur in the Skia graphics library during some canvas operations due to issues with mask/clip intersection and empty masks.

##### References

* [Bug 1306890](https://bugzilla.mozilla.org/show_bug.cgi?id=1306890)

#### [#CVE-2017-5407: Pixel and history stealing via floating-point timing side channel with SVG filters](#CVE-2017-5407)

Reporter
David Kohlbrenner
Impact
high
##### Description

Using SVG filters that don't use the fixed point math implementation on a target iframe, a malicious page can extract pixel values from a targeted user. This can be used to extract history information and read text values across domains. This violates same-origin policy and leads to information disclosure.

##### References

* [Bug 1336622](https://bugzilla.mozilla.org/show_bug.cgi?id=1336622)

#### [#CVE-2017-5410: Memory corruption during JavaScript garbage collection incremental sweeping](#CVE-2017-5410)

Reporter
Jerri Rice
Impact
high
##### Description

Memory corruption resulting in a potentially exploitable crash during garbage collection of JavaScript due errors in how incremental sweeping is managed for memory cleanup.

##### References

* [Bug 1330687](https://bugzilla.mozilla.org/show_bug.cgi?id=1330687)

#### [#CVE-2017-5411: Use-after-free in Buffer Storage in libGLES](#CVE-2017-5411)

Reporter
Looben Yang
Impact
high
##### Description

A use-after-free can occur during buffer storage operations within the ANGLE graphics library, used for WebGL content. The buffer storage can be freed while still in use in some circumstances, leading to a potentially exploitable crash.
*Note: This issue is in `libGLES`, which is only in use on Windows. Other operating systems are not affected.*

##### References

* [Bug 1325511](https://bugzilla.mozilla.org/show_bug.cgi?id=1325511)

#### [#CVE-2017-5408: Cross-origin reading of video captions in violation of CORS](#CVE-2017-5408)

Reporter
Eric Lawrence of Chrome Security
Impact
moderate
##### Description

Video files loaded video captions cross-origin without checking for the presence of CORS headers permitting such cross-origin use, leading to potential information disclosure for video captions.

##### References

* [Bug 1313711](https://bugzilla.mozilla.org/show_bug.cgi?id=1313711)

#### [#CVE-2017-5412: Buffer overflow read in SVG filters](#CVE-2017-5412)

Reporter
Atte Kettunen
Impact
moderate
##### Description

A buffer overflow read during SVG filter color value operations, resulting in data exposure.

##### References

* [Bug 1328323](https://bugzilla.mozilla.org/show_bug.cgi?id=1328323)

#### [#CVE-2017-5413: Segmentation fault during bidirectional operations](#CVE-2017-5413)

Reporter
Atte Kettunen
Impact
moderate
##### Description

A segmentation fault can occur during some bidirectional layout operations.

##### References

* [Bug 1337504](https://bugzilla.mozilla.org/show_bug.cgi?id=1337504)

#### [#CVE-2017-5414: File picker can choose incorrect default directory](#CVE-2017-5414)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

The file picker dialog can choose and display the wrong local default directory when instantiated. On some operating systems, this can lead to information disclosure, such as the operating system or the local account name.

##### References

* [Bug 1319370](https://bugzilla.mozilla.org/show_bug.cgi?id=1319370)

#### [#CVE-2017-5416: Null dereference crash in HttpChannel](#CVE-2017-5416)

Reporter
Radek 'sysKin' Czyz
Impact
moderate
##### Description

In certain circumstances a networking event listener can be prematurely released. This appears to result in a null dereference in practice.

##### References

* [Bug 1328121](https://bugzilla.mozilla.org/show_bug.cgi?id=1328121)

#### [#CVE-2017-5425: Overly permissive Gecko Media Plugin sandbox regular expression access](#CVE-2017-5425)

Reporter
Haik Aftandilian
Impact
moderate
##### Description

The Gecko Media Plugin sandbox allows access to local files that match specific regular expressions. On OS OX, this matching allows access to some data in subdirectories of `/private/var` that could expose personal or temporary data. This has been updated to not allow access to `/private/var` and its subdirectories.
*Note: this issue only affects OS X. Other operating systems are not affected.*

##### References

* [Bug 1322716](https://bugzilla.mozilla.org/show_bug.cgi?id=1322716)

#### [#CVE-2017-5426: Gecko Media Plugin sandbox is not started if seccomp-bpf filter is running](#CVE-2017-5426)

Reporter
Jed Davis
Impact
moderate
##### Description

On Linux, if the secure computing mode BPF (seccomp-bpf) filter is running when the Gecko Media Plugin sandbox is started, the sandbox fails to be applied and items that would run within the sandbox are run protected only by the running filter which is typically weak compared to the sandbox.
*Note: this issue only affects Linux. Other operating systems are not affected.*

##### References

* [Bug 1257361](https://bugzilla.mozilla.org/show_bug.cgi?id=1257361)

#### [#CVE-2017-5418: Out of bounds read when parsing HTTP digest authorization responses](#CVE-2017-5418)

Reporter
Anonymous
Impact
low
##### Description

An out of bounds read error occurs when parsing some HTTP digest authorization responses, resulting in information leakage through the reading of random memory containing matches to specifically set patterns.

##### References

* [Bug 1338876](https://bugzilla.mozilla.org/show_bug.cgi?id=1338876)

#### [#CVE-2017-5419: Repeated authentication prompts lead to DOS attack](#CVE-2017-5419)

Reporter
Chris Hamono
Impact
low
##### Description

If a malicious site repeatedly triggers a modal authentication prompt, eventually the browser UI will become non-responsive, requiring shutdown through the operating system. This is a denial of service (DOS) attack.

##### References

* [Bug 1312243](https://bugzilla.mozilla.org/show_bug.cgi?id=1312243)

#### [#CVE-2017-5405: FTP response codes can cause use of uninitialized values for ports](#CVE-2017-5405)

Reporter
Anonymous
Impact
low
##### Description

Certain response codes in FTP connections can result in the use of uninitialized values for ports in FTP operations.

##### References

* [Bug 1336699](https://bugzilla.mozilla.org/show_bug.cgi?id=1336699)

#### [#CVE-2017-5421: Print preview spoofing](#CVE-2017-5421)

Reporter
Abdulrahman Alqabandi
Impact
low
##### Description

A malicious site could spoof the contents of the print preview window if popup windows are enabled, resulting in user confusion of what site is currently loaded.

##### References

* [Bug 1301876](https://bugzilla.mozilla.org/show_bug.cgi?id=1301876)

#### [#CVE-2017-5422: DOS attack by using view-source: protocol repeatedly in one hyperlink](#CVE-2017-5422)

Reporter
Alex Bolton
Impact
low
##### Description

If a malicious site uses the `view-source:` protocol in a series within a single hyperlink, it can trigger a non-exploitable browser crash when the hyperlink is selected. This was fixed by no longer making `view-source:` linkable.

##### References

* [Bug 1295002](https://bugzilla.mozilla.org/show_bug.cgi?id=1295002)

#### [#CVE-2017-5399: Memory safety bugs fixed in Thunderbird 52](#CVE-2017-5399)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Carsten Book, Calixte Denizet, Christian Holler, Andrew McCreight, David Bolter, David Keeler, Jon Coppeard, Tyson Smith, Ronald Crane, Tooru Fujisawa, Ben Kelly, Bob Owen, Jed Davis, Julian Seward, Julian Hector, Philipp, Markus Stange, and AndrÃ© Bargull reported memory safety bugs present in Firefox 51. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 52](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1332569%2C1315248%2C1261335%2C1321038%2C1331771%2C1339566%2C1339591%2C1240893%2C1341905%2C1323241%2C1336467%2C1270288%2C1295299%2C1296024%2C1304201%2C1306142%2C1307557%2C1308036%2C1334246%2C1334290%2C1317085%2C1339116%2C1324000%2C1323150%2C1332501%2C1320894%2C1333752%2C1303713%2C1321566%2C1264053%2C1343513)

#### [#CVE-2017-5398: Memory safety bugs fixed in Thunderbird 52 and Thunderbird 45.8](#CVE-2017-5398)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Boris Zbarsky, Christian Holler, Honza Bambas, Jon Coppeard, Randell Jesup, AndrÃ© Bargull, Kan-Ru Chen, and Nathan Froyd reported memory safety bugs present in Firefox 51 and Firefox ESR 45.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 52 and Thunderbird ESR 45.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1332550%2C1332597%2C1338383%2C1321612%2C1322971%2C1333568%2C1333887%2C1335450%2C1325052%2C1324379%2C1336510)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_0bbf66fc_20250126_010515.html ===


# Main Page

From MozillaWiki

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Release information

![Final-50slice.png](/images/1/1e/Final-50slice.png)
FirefoxÂ 134.0.2
Based on GeckoÂ 134

Released on 2025-01-20

![Thunderbird-50slice.png](/images/c/c2/Thunderbird-50slice.png)
ThunderbirdÂ 128.4.3esr
Based on GeckoÂ 128.4.3esr

Released on 2024-11-12

[All Releases](/Releases "Releases")

## Firefox Release Management pointers

* [Release calendar](/Release_Management/Calendar "Release Management/Calendar")
* [Release process overview](/Release_Management/Release_Process "Release Management/Release Process")
* [Release owners](/Release_Management/Release_owners "Release Management/Release owners")
* [More about release managementâ€¦](/Release_Management "Release Management")

## Support for users

[![Sumo-banner.png](/images/f/ff/Sumo-banner.png)](https://support.mozilla.org/)

## Support for developers

[![Mdn logo-wordmark-full color.png](/images/thumb/a/ad/Mdn_logo-wordmark-full_color.png/240px-Mdn_logo-wordmark-full_color.png)](https://developer.mozilla.org/)

[Firefox Docs](https://firefox-source-docs.mozilla.org/)

## Contributing to Mozilla

* [Mozilla project-wide status meetings](/WeeklyUpdates "WeeklyUpdates") (every Monday)
* [Other project calls](/Community_Calendar "Community Calendar")
* [Mozilla projects](/Projects "Projects") (Firefox, Platform, Add-ons, etc.)
* [Student Ambassadors](/StudentAmbassadors "StudentAmbassadors")
* [Why contribute to Mozilla?](/Contribute/Why_Contribute "Contribute/Why Contribute")
* [Discover new ways to contribute](/Contribute "Contribute")

## How to use this wiki

* [Mozilla Community Participation Guidelines (CPG)](https://www.mozilla.org/en-US/about/governance/policies/participation/)
* [About MozillaWiki](/MozillaWiki%3AAbout "MozillaWiki:About")
* [Tips and tricks for MozillaWiki](/Help%3ATips_and_Tricks "Help:Tips and Tricks")

[Looking for the old Main Page?](/Main_Page/Legacy "Main Page/Legacy")

Retrieved from "<https://wiki.mozilla.org/index.php?title=Main_Page&oldid=1253045>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=Main+Page "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Main Page](/Main_Page "View the content page [c]")
* [Discussion](/Talk%3AMain_Page "Discussion about the content page [t]")

English

### Views

* [Read](/Main_Page)
* [View source](/index.php?title=Main_Page&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=Main_Page&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/Main_Page "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/Main_Page "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=Main_Page&oldid=1253045 "Permanent link to this revision of this page")
* [Page information](/index.php?title=Main_Page&action=info "More information about this page")

* This page was last edited on 25 December 2024, at 09:13.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=Main_Page&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from wiki.mozilla.org_3659d679_20250126_010514.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")â€Ž | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_8fb9408f_20250126_010519.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1338876)
* [XML](/show_bug.cgi?ctype=xml&id=1338876)

Closed
[Bug 1338876](/show_bug.cgi?id=1338876)
(CVE-2017-5418)

Opened 8 years ago
Closed 8 years ago

# Out of bound access in nsHttpDigestAuth::ParseChallenge

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Out of bound access in nsHttpDigestAuth::ParseChallenge

## Categories

### (Core :: Networking, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking#Networking)

Networking
â–¾

Core :: Networking
For bugs in Mozilla's modular networking library (aka "Netlib" or "Necko".) The networking library supplies the software interface that Mozilla uses to access physical transports (e.g. the Internet and local drives), perform URL resolutions, and handle a variety of networking protocols.

Examples of appropriate bugs: URLs with backslash not fetched; URLs starting with a single slash turn into http:///; Cannot access authenticated FTP site.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

51 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla54

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=wontfix) |
| firefox51 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=wontfix) |
| firefox52 | [+](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed) |
| firefox-esr52 | [52+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=52%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed) |
| firefox53 | [+](/buglist.cgi?f1=cf_tracking_firefox53&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=fixed) |
| firefox54 | [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 |  | wontfix |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox51 |  | wontfix |
| firefox52 | + | fixed |
| firefox-esr52 | 52+ | fixed |
| firefox53 | + | fixed |
| firefox-esr115 | --- | --- |
| firefox54 | + | fixed |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: chamal.desilva, Assigned: dragana)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/91b350e2ab5eb2590adffaa3d0c9293a?d=mm&size=40)  [dragana](/user_profile?user_id=508195)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/045351dbdb09c499196f603aec95e066?d=mm&size=40)  [chamal.desilva](/user_profile?user_id=389972)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-bounds, sec-low, Whiteboard: [post-critsmash-triage][necko-active][adv-main52+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2017-5418

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][necko-active][adv-main52+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c19 "8 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
| [kjozwiak](/user_profile?user_id=455785) | [qe-verify](#a1076141_455785 "8 years ago") | + |
| --- | --- | --- |
| [kjozwiak](/user_profile?user_id=455785) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [auth.php](/attachment.cgi?id=8836446)  [8 years ago](#c0)  [Chamal De Silva](/user_profile?user_id=389972)   132 bytes, text/plain |  | [Details](/attachment.cgi?id=8836446&action=edit) |
| --- | --- | --- |
| [bug\_1338876.patch](/attachment.cgi?id=8837221)  [8 years ago](#c3)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   1.01 KB, patch | mcmanus : [review+](#a200652_32546 "8 years ago")  jcristau : [approval-mozilla-aurora+](#c12 "8 years ago")  jcristau : [approval-mozilla-beta+](#c12 "8 years ago") | [Details](/attachment.cgi?id=8837221&action=edit) | [Diff](/attachment.cgi?id=8837221&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1338876&attachment=8837221) |
| [bug\_1338876\_test.patch](/attachment.cgi?id=8838575)  [8 years ago](#c16)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   5.13 KB, patch | mcmanus : [review+](#c17 "8 years ago") | [Details](/attachment.cgi?id=8838575&action=edit) | [Diff](/attachment.cgi?id=8838575&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1338876&attachment=8838575) |

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Chamal De Silva](/user_profile?user_id=389972)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1338876#c0)â€¢ 8 years ago |
|  | |

Attached file
[auth.php](attachment.cgi?id=8836446)
â€” [Details](attachment.cgi?id=8836446&action=edit)

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36
Steps to reproduce:
1. Build firefox with valgrind using instructions mentioned in
<https://developer.mozilla.org/en-US/docs/Mozilla/Testing/Valgrind>
2. Download and copy auth.php to local web server.
3. Start firefox
export VALGRIND\_OPTIONS="--smc-check=all-non-file --vex-iropt-register-updates=allregs-at-mem-access --show-mismatched-frees=no --read-inline-info=yes"
./mach run --debugger="valgrind" --debugger-args="$VALGRIND\_OPTIONS"
4. Visit <http://127.0.0.1/auth.php>
Actual results:
Valgrind reports this error.
==3063== Conditional jump or move depends on uninitialised value(s)
==3063== at 0x101B8F28: mozilla::net::nsHttpDigestAuth::ParseChallenge(char const\*, nsACString\_internal&, nsACString\_internal&, nsACString\_internal&, nsACString\_internal&, bool\*, unsigned short\*, unsigned short\*) [clone .part.144] (nsHttpDigestAuth.cpp:577)
==3063== by 0x101B958E: ParseChallenge (nsHttpDigestAuth.cpp:163)
==3063== by 0x101B958E: mozilla::net::nsHttpDigestAuth::ChallengeReceived(nsIHttpAuthenticableChannel\*, char const\*, bool, nsISupports\*\*, nsISupports\*\*, bool\*) (nsHttpDigestAuth.cpp:152)
==3063== by 0x1016B6B9: mozilla::net::nsHttpChannelAuthProvider::GetCredentialsForChallenge(char const\*, char const\*, bool, nsIHttpAuthenticator\*, nsCString&) (nsHttpChannelAuthProvider.cpp:790)
==3063== by 0x1016C3DE: mozilla::net::nsHttpChannelAuthProvider::GetCredentials(char const\*, bool, nsCString&) (nsHttpChannelAuthProvider.cpp:618)
==3063== by 0x1016C72F: mozilla::net::nsHttpChannelAuthProvider::ProcessAuthentication(unsigned int, bool) (nsHttpChannelAuthProvider.cpp:198)
==3063== by 0x101F01C5: mozilla::net::nsHttpChannel::ContinueProcessResponse2(nsresult) [clone .part.419] [clone .constprop.487] (nsHttpChannel.cpp:2209)
==3063== by 0x101F091F: ContinueProcessResponse2 (nsCOMPtr.h:294)
==3063== by 0x101F091F: mozilla::net::nsHttpChannel::ContinueProcessResponse1() (nsHttpChannel.cpp:2089)
==3063== by 0x101F0B6E: mozilla::net::nsHttpChannel::ProcessResponse() (nsHttpChannel.cpp:2009)
==3063== by 0x101F13A5: mozilla::net::nsHttpChannel::OnStartRequest(nsIRequest\*, nsISupports\*) (nsHttpChannel.cpp:6523)
==3063== by 0xFEA068D: nsInputStreamPump::OnStateStart() (nsInputStreamPump.cpp:524)
==3063== by 0xFEA118F: nsInputStreamPump::OnInputStreamReady(nsIAsyncInputStream\*) (nsInputStreamPump.cpp:426)
==3063== by 0xFDFB013: nsInputStreamReadyEvent::Run() (nsStreamUtils.cpp:96)
==3063==
Expected results:
Should not have read out of bound value.

|  | [Chamal De Silva](/user_profile?user_id=389972)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1338876#c1)â€¢ 8 years ago |
|  | |

Cause of bug
------------
Bug is in below mentioned line of nsHttpDigestAuth::ParseChallenge method in netwerk\protocol\http\nsHttpDigestAuth.cpp file.
const char \*p = challenge + 7;
This method assumes it will received a value that starts with "Digest " for challenge variable, which has at least 7 characters.
But that assumption fails when server sends below header.
header ('WWW-Authenticate:Digest'); //Note no space after "Digest".
So adding 7 to challenge variable overflows.

|  | [Chamal De Silva](/user_profile?user_id=389972)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a9727_389972)â€¢ 8 years ago |

OS: Unspecified â†’ AllHardware: Unspecified â†’ All

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a103781_159069)â€¢ 8 years ago |

[Attachment #8836446](/attachment.cgi?id=8836446&action=edit "auth.php") -
Attachment mime type: application/x-php â†’ text/plain

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1338876#c2)â€¢ 8 years ago |
|  | |

Chamal: thanks for the clear testcase and report.
Dragana, can you or someone else on the networking team look at this? Thanks!Group: firefox-core-security â†’ core-securityComponent: Untriaged â†’ NetworkingFlags: needinfo?(dd.mozilla)Product: Firefox â†’ Core

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a106240_508195)â€¢ 8 years ago |

Assignee: nobody â†’ dd.mozillaStatus: UNCONFIRMED â†’ ASSIGNEDEver confirmed: trueFlags: needinfo?(dd.mozilla)Whiteboard: [necko-active]

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1338876#c3)â€¢ 8 years ago |
|  | |

Attached patch

[bug\_1338876.patch](attachment.cgi?id=8837221&action=diff)
â€” [Details](attachment.cgi?id=8837221&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1338876&attachment=8837221)

[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: review?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a200652_32546)â€¢ 8 years ago |

[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: review?(mcmanus) â†’ review+

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a200926_508195)â€¢ 8 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1338876#c4)â€¢ 8 years ago |
|  | |

Given that this goes back basically forever, this needs a security rating (or sec-approval if applicable) before it can land.
<https://wiki.mozilla.org/Security/Bug_Approval_Process>
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=wontfix)
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected)
[status-firefox53](/buglist.cgi?f1=cf_status_firefox53&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=affected)
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)
[tracking-firefox51](/buglist.cgi?f1=cf_tracking_firefox51&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%3F)
[tracking-firefox52](/buglist.cgi?f1=cf_tracking_firefox52&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%3F)
[tracking-firefox53](/buglist.cgi?f1=cf_tracking_firefox53&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox53&o1=equals&v1=%3F)
[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%3F)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F)Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a215545_406194)â€¢ 8 years ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1338876#c5)â€¢ 8 years ago |
|  | |

I'm not sure what the rating on this should be. It looks like maybe the code ends up skipping a null terminator and ends up reading a lot of random junk? So then the main danger is information leakage.

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1338876#c6)â€¢ 8 years ago |
|  | |

Comment on [attachment 8837221](/attachment.cgi?id=8837221 "bug_1338876.patch") [[details]](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") [[diff]](/attachment.cgi?id=8837221&action=diff "bug_1338876.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1338876&attachment=8837221)
bug\_1338876.patch
Asking for uplift, for release too.
Approval Request Comment
[Feature/Bug causing the regression]: this code is really old.
[User impact if declined]:security impact, information leakage as explained above.
[Is this code covered by automated tests?]:yes and no. The code path is but this special case not.
[Has the fix been verified in Nightly?]:
[Needs manual test from QE? If yes, steps to reproduce]: There are steps to reproduce in the bug.
[List of other uplifts needed for the feature/fix]: none
[Is the change risky?]:no
[Why is the change risky/not risky?]:The change is really small. This code path will be call only if the challenge starts with 'digest' so setting pointer to challenge + 6 should always be correct. The following code removes white spaces if any present. So the behaviour is the same as before the patch.
[String changes made/needed]:none
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
The patch shows what the problem is.
We move a pointer after a null terminator and the following code will read anything that is after that position.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Yes, the patch it self does it.
Which older supported branches are affected by this flaw?
all
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
No risk, the code is really old, so it will apply to older branches without problems.
How likely is this patch to cause regressions; how much testing does it need?
unlikely, it will not cause regression, also i tested it manually.
[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: sec-approval?
[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: approval-mozilla-release?
[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: approval-mozilla-beta?
[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: approval-mozilla-aurora?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1338876#c7)â€¢ 8 years ago |
|  | |

Dan, what do you think the rating on this should be? AFAICT the function is going to be searching through memory past the end of the array, but it only looks for specific substrings like "realm", and then copies stuff trailing that, so you can't really extract arbitrary information, as far as I can tell. I'm not sure if this information is passed directly back to content in any way.Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1338876#c8)â€¢ 8 years ago |
|  | |

The routine will bail out if the things it finds don't match all the expected keywords. If they do it looks like it will create a response and may send the values back to the server. It might match if you have an old challenge string in memory and get lucky enough to find it, but challenge strings don't contain private information since anyone can load the server and get prompted for auth (unless maybe the server itself is inaccessible to the attacker, such as on an intranet).Group: core-security â†’ network-core-securityFlags: needinfo?(dveditz)Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1338876#c9)â€¢ 8 years ago |
|  | |

Comment on [attachment 8837221](/attachment.cgi?id=8837221 "bug_1338876.patch") [[details]](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") [[diff]](/attachment.cgi?id=8837221&action=diff "bug_1338876.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1338876&attachment=8837221)
bug\_1338876.patch
As a sec-low, this doesn't need sec-approval to be checked into trunk. Clearing.
[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1338876#c10)â€¢ 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/36663347138d>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=wontfix)
[tracking-firefox51](/buglist.cgi?f1=cf_tracking_firefox51&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%3F) â†’ ---

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a314968_75935)â€¢ 8 years ago |

[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: approval-mozilla-release?

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1338876#c11)â€¢ 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/36663347138d>Status: ASSIGNED â†’ RESOLVEDClosed: 8 years ago
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ mozilla54

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a364314_580382)â€¢ 8 years ago |

[tracking-firefox52](/buglist.cgi?f1=cf_tracking_firefox52&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%2B)
[tracking-firefox53](/buglist.cgi?f1=cf_tracking_firefox53&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox53&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox53&o1=equals&v1=%2B)
[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F) â†’ ---
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F) â†’ ---

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1338876#c12)â€¢ 8 years ago |
|  | |

Comment on [attachment 8837221](/attachment.cgi?id=8837221 "bug_1338876.patch") [[details]](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") [[diff]](/attachment.cgi?id=8837221&action=diff "bug_1338876.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1338876&attachment=8837221)
bug\_1338876.patch
fix info leak in digest auth, aurora53+, beta52+
[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: approval-mozilla-beta?
[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: approval-mozilla-beta+
[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: approval-mozilla-aurora?
[Attachment #8837221](/attachment.cgi?id=8837221&action=edit "bug_1338876.patch") -
Flags: approval-mozilla-aurora+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1338876#c13)â€¢ 8 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/197dde7656f8>
<https://hg.mozilla.org/releases/mozilla-beta/rev/1c01e2aa7bf0>
Can we land an automated test for this too?
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed)
[status-firefox53](/buglist.cgi?f1=cf_status_firefox53&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=fixed)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F)Flags: needinfo?(dd.mozilla)Flags: in-testsuite?

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a429049_580382)â€¢ 8 years ago |

[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F) â†’ [52+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=52%2B)

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1338876#c14)â€¢ 8 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #13](/show_bug.cgi?id=1338876#c13 "RESOLVED FIXED - Out of bound access in nsHttpDigestAuth::ParseChallenge"))
> <https://hg.mozilla.org/releases/mozilla-aurora/rev/197dde7656f8>
> <https://hg.mozilla.org/releases/mozilla-beta/rev/1c01e2aa7bf0>
>
> Can we land an automated test for this too?
I will add one today.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1338876#c15)â€¢ 8 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr52/rev/1c01e2aa7bf0>
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed)

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1338876#c16)â€¢ 8 years ago |
|  | |

Attached patch

[bug\_1338876\_test.patch](attachment.cgi?id=8838575&action=diff)
â€” [Details](attachment.cgi?id=8838575&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1338876&attachment=8838575)

Flags: needinfo?(dd.mozilla)
[Attachment #8838575](/attachment.cgi?id=8838575&action=edit "bug_1338876_test.patch") -
Flags: review?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1338876#c17)â€¢ 8 years ago |
|  | |

Comment on [attachment 8838575](/attachment.cgi?id=8838575 "bug_1338876_test.patch") [[details]](/attachment.cgi?id=8838575&action=edit "bug_1338876_test.patch") [[diff]](/attachment.cgi?id=8838575&action=diff "bug_1338876_test.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1338876&attachment=8838575)
bug\_1338876\_test.patch
Review of [attachment 8838575](/attachment.cgi?id=8838575 "bug_1338876_test.patch") [[details]](/attachment.cgi?id=8838575&action=edit "bug_1338876_test.patch") [[diff]](/attachment.cgi?id=8838575&action=diff "bug_1338876_test.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1338876&attachment=8838575):
-----------------------------------------------------------------
thanks
[Attachment #8838575](/attachment.cgi?id=8838575&action=edit "bug_1338876_test.patch") -
Flags: review?(mcmanus) â†’ review+

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1338876#c18)â€¢ 8 years ago |
|  | |

Check in needed for the test: bug\_1338876\_test.patchKeywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1338876#c19)â€¢ 8 years ago |
|  | |

Thanks!
<https://hg.mozilla.org/integration/mozilla-inbound/rev/40a559d547319034db251ca2a98dc0a8004ad592>Flags: in-testsuite? â†’ in-testsuite+Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1338876#c20)â€¢ 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/40a559d54731>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a938521_1689)â€¢ 8 years ago |

Group: network-core-security â†’ core-security-release

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a1076141_455785)â€¢ 8 years ago |

Flags: qe-verify+Whiteboard: [necko-active] â†’ [post-critsmash-triage][necko-active]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a1332898_280903)â€¢ 8 years ago |

Whiteboard: [post-critsmash-triage][necko-active] â†’ [post-critsmash-triage][necko-active][adv-main52+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a1506000_280903)â€¢ 8 years ago |

Alias: CVE-2017-5418

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1338876#a22175756_1689)â€¢ 7 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1338876&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Chamal De Silva](/user_profile?user_id=389972)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_087ffa14_20250124_121942.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2017-05

## Security vulnerabilities fixed in Firefox 52

Announced
March 7, 2017
Impact
critical
Products
Firefox
Fixed in

* Firefox 52

#### [#CVE-2017-5400: asm.js JIT-spray bypass of ASLR and DEP](#CVE-2017-5400)

Reporter
Rh0
Impact
critical
##### Description

JIT-spray targeting asm.js combined with a heap spray allows for a bypass of ASLR and DEP protections leading to potential memory corruption attacks.

##### References

* [Bug 1334933](https://bugzilla.mozilla.org/show_bug.cgi?id=1334933)

#### [#CVE-2017-5401: Memory Corruption when handling ErrorResult](#CVE-2017-5401)

Reporter
Anton Eliasson
Impact
critical
##### Description

A crash triggerable by web content in which an `ErrorResult` references unassigned memory due to a logic error. The resulting crash may be exploitable.

##### References

* [Bug 1328861](https://bugzilla.mozilla.org/show_bug.cgi?id=1328861)

#### [#CVE-2017-5402: Use-after-free working with events in FontFace objects](#CVE-2017-5402)

Reporter
Nils
Impact
critical
##### Description

A use-after-free can occur when events are fired for a `FontFace` object after the object has been already been destroyed while working with fonts. This results in a potentially exploitable crash.

##### References

* [Bug 1334876](https://bugzilla.mozilla.org/show_bug.cgi?id=1334876)

#### [#CVE-2017-5403: Use-after-free using addRange to add range to an incorrect root object](#CVE-2017-5403)

Reporter
Nils
Impact
critical
##### Description

When adding a range to an object in the DOM, it is possible to use `addRange` to add the range to an incorrect root object. This triggers a use-after-free, resulting in a potentially exploitable crash.

##### References

* [Bug 1340186](https://bugzilla.mozilla.org/show_bug.cgi?id=1340186)

#### [#CVE-2017-5404: Use-after-free working with ranges in selections](#CVE-2017-5404)

Reporter
Ivan Fratric of Google Project Zero
Impact
critical
##### Description

A use-after-free error can occur when manipulating ranges in selections with one node inside a native anonymous tree and one node outside of it. This results in a potentially exploitable crash.

##### References

* [Bug 1340138](https://bugzilla.mozilla.org/show_bug.cgi?id=1340138)

#### [#CVE-2017-5406: Segmentation fault in Skia with canvas operations](#CVE-2017-5406)

Reporter
Atte Kettunen
Impact
high
##### Description

A segmentation fault can occur in the Skia graphics library during some canvas operations due to issues with mask/clip intersection and empty masks.

##### References

* [Bug 1306890](https://bugzilla.mozilla.org/show_bug.cgi?id=1306890)

#### [#CVE-2017-5407: Pixel and history stealing via floating-point timing side channel with SVG filters](#CVE-2017-5407)

Reporter
David Kohlbrenner
Impact
high
##### Description

Using SVG filters that don't use the fixed point math implementation on a target iframe, a malicious page can extract pixel values from a targeted user. This can be used to extract history information and read text values across domains. This violates same-origin policy and leads to information disclosure.

##### References

* [Bug 1336622](https://bugzilla.mozilla.org/show_bug.cgi?id=1336622)

#### [#CVE-2017-5410: Memory corruption during JavaScript garbage collection incremental sweeping](#CVE-2017-5410)

Reporter
Jerri Rice
Impact
high
##### Description

Memory corruption resulting in a potentially exploitable crash during garbage collection of JavaScript due errors in how incremental sweeping is managed for memory cleanup.

##### References

* [Bug 1330687](https://bugzilla.mozilla.org/show_bug.cgi?id=1330687)

#### [#CVE-2017-5411: Use-after-free in Buffer Storage in libGLES](#CVE-2017-5411)

Reporter
Looben Yang
Impact
high
##### Description

A use-after-free can occur during buffer storage operations within the ANGLE graphics library, used for WebGL content. The buffer storage can be freed while still in use in some circumstances, leading to a potentially exploitable crash.
*Note: This issue is in `libGLES`, which is only in use on Windows. Other operating systems are not affected.*

##### References

* [Bug 1325511](https://bugzilla.mozilla.org/show_bug.cgi?id=1325511)

#### [#CVE-2017-5409: File deletion via callback parameter in Mozilla Windows Updater and Maintenance Service](#CVE-2017-5409)

Reporter
Holger Fuhrmannek
Impact
moderate
##### Description

The Mozilla Windows updater can be called by a non-privileged user to delete an arbitrary local file by passing a special path to the callback parameter through the Mozilla Maintenance Service, which has privileged access.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1321814](https://bugzilla.mozilla.org/show_bug.cgi?id=1321814)

#### [#CVE-2017-5408: Cross-origin reading of video captions in violation of CORS](#CVE-2017-5408)

Reporter
Eric Lawrence of Chrome Security
Impact
moderate
##### Description

Video files loaded video captions cross-origin without checking for the presence of CORS headers permitting such cross-origin use, leading to potential information disclosure for video captions.

##### References

* [Bug 1313711](https://bugzilla.mozilla.org/show_bug.cgi?id=1313711)

#### [#CVE-2017-5412: Buffer overflow read in SVG filters](#CVE-2017-5412)

Reporter
Atte Kettunen
Impact
moderate
##### Description

A buffer overflow read during SVG filter color value operations, resulting in data exposure.

##### References

* [Bug 1328323](https://bugzilla.mozilla.org/show_bug.cgi?id=1328323)

#### [#CVE-2017-5413: Segmentation fault during bidirectional operations](#CVE-2017-5413)

Reporter
Atte Kettunen
Impact
moderate
##### Description

A segmentation fault can occur during some bidirectional layout operations.

##### References

* [Bug 1337504](https://bugzilla.mozilla.org/show_bug.cgi?id=1337504)

#### [#CVE-2017-5414: File picker can choose incorrect default directory](#CVE-2017-5414)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

The file picker dialog can choose and display the wrong local default directory when instantiated. On some operating systems, this can lead to information disclosure, such as the operating system or the local account name.

##### References

* [Bug 1319370](https://bugzilla.mozilla.org/show_bug.cgi?id=1319370)

#### [#CVE-2017-5415: Addressbar spoofing through blob URL](#CVE-2017-5415)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

An attack can use a blob URL and script to spoof an arbitrary addressbar URL prefaced by `blob:` as the protocol, leading to user confusion and further spoofing attacks.

##### References

* [Bug 1321719](https://bugzilla.mozilla.org/show_bug.cgi?id=1321719)

#### [#CVE-2017-5416: Null dereference crash in HttpChannel](#CVE-2017-5416)

Reporter
Radek 'sysKin' Czyz
Impact
moderate
##### Description

In certain circumstances a networking event listener can be prematurely released. This appears to result in a null dereference in practice.

##### References

* [Bug 1328121](https://bugzilla.mozilla.org/show_bug.cgi?id=1328121)

#### [#CVE-2017-5417: Addressbar spoofing by draging and dropping URLs](#CVE-2017-5417)

Reporter
Michal Zalewski
Impact
moderate
##### Description

When dragging content from the primary browser pane to the addressbar on a malicious site, it is possible to change the addressbar so that the displayed location following navigation does not match the URL of the newly loaded page. This allows for spoofing attacks.

##### References

* [Bug 791597](https://bugzilla.mozilla.org/show_bug.cgi?id=791597)

#### [#CVE-2017-5425: Overly permissive Gecko Media Plugin sandbox regular expression access](#CVE-2017-5425)

Reporter
Haik Aftandilian
Impact
moderate
##### Description

The Gecko Media Plugin sandbox allows access to local files that match specific regular expressions. On OS OX, this matching allows access to some data in subdirectories of `/private/var` that could expose personal or temporary data. This has been updated to not allow access to `/private/var` and its subdirectories.
*Note: this issue only affects OS X. Other operating systems are not affected.*

##### References

* [Bug 1322716](https://bugzilla.mozilla.org/show_bug.cgi?id=1322716)

#### [#CVE-2017-5426: Gecko Media Plugin sandbox is not started if seccomp-bpf filter is running](#CVE-2017-5426)

Reporter
Jed Davis
Impact
moderate
##### Description

On Linux, if the secure computing mode BPF (seccomp-bpf) filter is running when the Gecko Media Plugin sandbox is started, the sandbox fails to be applied and items that would run within the sandbox are run protected only by the running filter which is typically weak compared to the sandbox.
*Note: this issue only affects Linux. Other operating systems are not affected.*

##### References

* [Bug 1257361](https://bugzilla.mozilla.org/show_bug.cgi?id=1257361)

#### [#CVE-2017-5427: Non-existent chrome.manifest file loaded during startup](#CVE-2017-5427)

Reporter
Mike Kaply
Impact
moderate
##### Description

A non-existent chrome.manifest file will attempt to be loaded during startup from the primary installation directory. If a malicious user with local access puts chrome.manifest and other referenced files in this directory, they will be loaded and activated during startup. This could result in malicious software being added without consent or modification of referenced installed files.

##### References

* [Bug 1295542](https://bugzilla.mozilla.org/show_bug.cgi?id=1295542)

#### [#CVE-2017-5418: Out of bounds read when parsing HTTP digest authorization responses](#CVE-2017-5418)

Reporter
Anonymous
Impact
low
##### Description

An out of bounds read error occurs when parsing some HTTP digest authorization responses, resulting in information leakage through the reading of random memory containing matches to specifically set patterns.

##### References

* [Bug 1338876](https://bugzilla.mozilla.org/show_bug.cgi?id=1338876)

#### [#CVE-2017-5419: Repeated authentication prompts lead to DOS attack](#CVE-2017-5419)

Reporter
Chris Hamono
Impact
low
##### Description

If a malicious site repeatedly triggers a modal authentication prompt, eventually the browser UI will become non-responsive, requiring shutdown through the operating system. This is a denial of service (DOS) attack.

##### References

* [Bug 1312243](https://bugzilla.mozilla.org/show_bug.cgi?id=1312243)

#### [#CVE-2017-5420: Javascript: URLs can obfuscate addressbar location](#CVE-2017-5420)

Reporter
Abdulrahman Alqabandi
Impact
low
##### Description

A `javascript:` url loaded by a malicious page can obfuscate its location by blanking the URL displayed in the addressbar, allowing for an attacker to spoof an existing page without the malicious page's address being displayed correctly.

##### References

* [Bug 1284395](https://bugzilla.mozilla.org/show_bug.cgi?id=1284395)

#### [#CVE-2017-5405: FTP response codes can cause use of uninitialized values for ports](#CVE-2017-5405)

Reporter
Anonymous
Impact
low
##### Description

Certain response codes in FTP connections can result in the use of uninitialized values for ports in FTP operations.

##### References

* [Bug 1336699](https://bugzilla.mozilla.org/show_bug.cgi?id=1336699)

#### [#CVE-2017-5421: Print preview spoofing](#CVE-2017-5421)

Reporter
Abdulrahman Alqabandi
Impact
low
##### Description

A malicious site could spoof the contents of the print preview window if popup windows are enabled, resulting in user confusion of what site is currently loaded.

##### References

* [Bug 1301876](https://bugzilla.mozilla.org/show_bug.cgi?id=1301876)

#### [#CVE-2017-5422: DOS attack by using view-source: protocol repeatedly in one hyperlink](#CVE-2017-5422)

Reporter
Alex Bolton
Impact
low
##### Description

If a malicious site uses the `view-source:` protocol in a series within a single hyperlink, it can trigger a non-exploitable browser crash when the hyperlink is selected. This was fixed by no longer making `view-source:` linkable.

##### References

* [Bug 1295002](https://bugzilla.mozilla.org/show_bug.cgi?id=1295002)

#### [#CVE-2017-5399: Memory safety bugs fixed in Firefox 52](#CVE-2017-5399)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Carsten Book, Calixte Denizet, Christian Holler, Andrew McCreight, David Bolter, David Keeler, Jon Coppeard, Tyson Smith, Ronald Crane, Tooru Fujisawa, Ben Kelly, Bob Owen, Jed Davis, Julian Seward, Julian Hector, Philipp, Markus Stange, and AndrÃ© Bargull reported memory safety bugs present in Firefox 51. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 52](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1332569%2C1315248%2C1261335%2C1321038%2C1331771%2C1339566%2C1339591%2C1240893%2C1341905%2C1323241%2C1336467%2C1270288%2C1295299%2C1296024%2C1304201%2C1306142%2C1307557%2C1308036%2C1334246%2C1334290%2C1317085%2C1339116%2C1324000%2C1323150%2C1332501%2C1320894%2C1333752%2C1303713%2C1321566%2C1264053%2C1343513)

#### [#CVE-2017-5398: Memory safety bugs fixed in Firefox 52 and Firefox ESR 45.8](#CVE-2017-5398)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Boris Zbarsky, Christian Holler, Honza Bambas, Jon Coppeard, Randell Jesup, AndrÃ© Bargull, Kan-Ru Chen, and Nathan Froyd reported memory safety bugs present in Firefox 51 and Firefox ESR 45.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 52 and Firefox ESR 45.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1332550%2C1332597%2C1338383%2C1321612%2C1322971%2C1333568%2C1333887%2C1335450%2C1325052%2C1324379%2C1336510)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


