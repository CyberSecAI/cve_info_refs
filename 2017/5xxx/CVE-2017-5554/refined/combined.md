=== Content from securityresear.ch_952f295e_20250124_204440.html ===

[securityresear.ch](/)

# fastboot oem selinux permissive

Jan 11, 2017 • Roee Hay

**UPDATE #2 (01/23/2017):** [`CVE-2017-5554`](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5554) has been assigned to this issue.

**UPDATE #1 (01/18/2017):** Vulnerability is fixed in OxygenOS 4.0.2.

I have just [disclosed](https://exchange.xforce.ibmcloud.com/collection/OnePlus-3-fastboot-oem-selinux-permissive-Vulnerability-38e7db09736c14198da23163cb9aa112 "disclosed") a new vulnerability affecting One Plus 3 (and ~~maybe~~ 3T!) running the latest version of OxygenOS (4.0.1 at the time of writing).
Similarly to our other recently disclosed vulnerabilities, One Plus 3’s bootloader has an unsafe `fastboot oem` command which is available even if the bootloader is locked.

The attacker can reboot the device into the `fastboot` mode, which could be done without any authentication – A physical attacker can press the ‘Volume Up’ button during device boot, where an attacker with ADB access can issue the `adb reboot bootloader` command.

Then, the attacker can put the platform’s SELinux in permissive mode, which severely weakens it, by simply issuing:

```
fastboot oem selinux permissive
```

And indeed, SELinux is then set to permissive mode:

```
OnePlus3:/ $ getenforce
Permissive
OnePlus3:/ $
```



=== Content from www.xda-developers.com_8693dab6_20250124_204441.html ===


# XDA

Menu

[![XDA logo](/public/build/images/xda-logo-full-colored-light.svg?v=3.0 "XDA")](/)

Sign in now

Close

* + [News & Deals](/news/)

    Submenu
    - [News](/category/computing-news/)
    - [Deals](/deals/)
  + [Reviews](/reviews/)

    Submenu
    - [Laptops](/category/computing-reviews/)
    - [CPUs](/cpu-reviews/)
    - [Graphics cards](/graphics-card-reviews/)
    - [SSDs](https://www.xda-developers.com/ssd-reviews/)
    - [Product Awards](/awards/)
  + [Best Guides](/buying-guides/)

    Submenu
    - [Best Laptops](/best-laptops/)
    - [Best Chromebooks](/best-chromebooks/)
    - [Best CPUs](/best-cpus/)
    - [Best graphics cards](/best-graphics-cards/)
  + [Tutorials](/tutorials/)

    Submenu
    - [Windows](/windows-tutorials/)
    - [macOS](/macos-tutorials/)
    - [Linux](/linux-tutorials/)
    - [ChromeOS](/chromeos-tutorials/)
* [Threads](/latest-threads/)
* + Topics
    Submenu
    - [Acer](/tag/acer/)
    - [Apple](/apple-mac/)
    - [Dell](/tag/dell/)
    - [HP](/tag/hp/)
    - [Lenovo](/tag/lenovo/)
    - [Microsoft](/tag/microsoft/)
    - [Razer](/tag/razer/)

* Sign in
* [Newsletter](/page/newsletter/)

[Copilot+](https://www.xda-developers.com/microsoft-copilot-plus/)

[Snapdragon X Series](https://www.xda-developers.com/snapdragon-x-series/)

[Windows 11 2024 Update](https://www.xda-developers.com/windows-11-24h2/)

[On this day](https://www.xda-developers.com/on-this-day/)

[Forums](https://xdaforums.com/)

Close

# OnePlus 3/3T Bootloader Vulnerability Allows Changing of SELinux to Permissive Mode in Fastboot

![4](https://static1.xdaimages.com/wordpress%2Fwp-content%2Fauthors%2F635155ef04f9f-IMG_20220820_114606_resized.jpg?fit=crop&w=90&h=90)

By
[Aamir Siddiqui](/author/aamirsiddiqui-xda/)

Published Jan 11, 2017

Follow

Followed

Like

Link copied to clipboard

### Related

[![razer blade 14 2024 next to razer xbox controller](https://static1.xdaimages.com/wordpress/wp-content/uploads/wm/2024/09/razer-blade-14-2024-next-to-controller.jpg)](/egpu-might-be-the-best-upgrade-for-your-gaming-laptop/)
##### [If you're serious about gaming, here's why an eGPU might be the best upgrade for your laptop](/egpu-might-be-the-best-upgrade-for-your-gaming-laptop/ "If you're serious about gaming, here's why an eGPU might be the best upgrade for your laptop")

[![Must-have apps on Windows 11](https://static1.xdaimages.com/wordpress/wp-content/uploads/2024/07/must-have-apps-on-windows-11-169.jpg)](/microsoft-sign-in-what-you-need-to-know/)
##### [Microsoft is changing how sign-in works, and you need to be extra careful](/microsoft-sign-in-what-you-need-to-know/ "Microsoft is changing how sign-in works, and you need to be extra careful")

[![razer blade 14 2024 model on a table](https://static1.xdaimages.com/wordpress/wp-content/uploads/wm/2024/09/razer-blade-14-2024-alone.jpg)](/i-cant-go-back-to-mac-after-using-windows-11/)
##### [5 reasons I can't go back to Mac after using Windows 11](/i-cant-go-back-to-mac-after-using-windows-11/ "5 reasons I can't go back to Mac after using Windows 11")

Sign in to your XDA account

![](https://static1.xdaimages.com/wordpress/wp-content/uploads/2017/01/oneplus-3-vulnerability.png)

The [OnePlus 3](http://forum.xda-developers.com/oneplus-3) and the [OnePlus 3T](http://forum.xda-developers.com/oneplus-3t) are among the best phones you can purchase right now. While the upcoming flagships of 2017 are yet to be revealed to consumers, in their absence the [OnePlus 3/3T dominate real world performance](https://www.xda-developers.com/dissecting-speed-how-oneplus-leveraged-excellent-real-world-performance/) at an affordable price.

**But, if we are to be fair in assessing the device,** we need to acknowledge that despite OnePlus's best efforts, the OnePlus 3/3T are not without their faults. For example, we've previously reported on security issues such as [OnePlus leaking IMEI details](https://www.xda-developers.com/be-warned-oneplus-is-still-leaking-your-imei-when-you-check-for-updates/) over the network when you check for updates on your phone. And now, we have another security issue to add to the list, this one with potentially more dangerous ramifications.

A vulnerability in the bootloader of the OnePlus 3/3T opens up doors to malicious attacks. As found by Roee Hay of the IBM X-Force Application Security Research Team and [revealed on the IBM X-Force Exchange platform](https://exchange.xforce.ibmcloud.com/collection/OnePlus-3-fastboot-oem-selinux-permissive-Vulnerability-d38d8557f1a01570539151c782d52aaf), this vulnerability allows an attacker to manipulate the SELinux state on the devices, thereby toggling it to permissive mode. All the attacker needs is **either physical access** to the device, or **remote access to an ADB connection** to the device.

[SELinux](https://en.wikipedia.org/wiki/Security-Enhanced_Linux), or Security-Enhanced Linux, is a Linux kernel security module which allows for access and management of security policies. SELinux was introduced to Android starting with Android 4.3 and was set to *Enforcing* mode as default since Android 4.4. This mandatory access control system helps enforce the existing access control rights and attempts to prevent privilege escalation attacks. This acts as a hurdle for unauthorized control over your device, such as an app or vulnerability aiming to gain root access maliciously. Setting SELinux to *Enforcing* by default on Android serves as the first step to protect normal users from such attacks.

The vulnerability is rather straightforward to exploit - in fact, it appears to be a huge oversight on OnePlus's part rather than what you would imagine your typical exploit to look like. First, an attacker reboots the OnePlus 3/3T into 'fastboot' mode - if you have physical access, simply press the Volume-Up button during boot, but if you don't you can issue the ADB command `adb reboot bootloader` to the device. The fastboot mode on the device exposes a USB interface, which should not allow any security sensitive command to complete on locked devices. But on the OnePlus 3/3T, simply issuing the `fastboot oem selinux permissive` command through the fastboot interface toggles the SELinux mode from *Enforcing* to ***Permissive***.

```

        fastboot oem selinux permissive
...
OKAY [  0.045s]
finished. total time: 0.047s

....

OnePlus3:/ $ getenforce
Permissive
OnePlus3:/ $

```

To further complicate the problem, the OnePlus 3 and 3T do not possess any entry in the 'About Screen' to mention the current SELinux state of the device. A victim will continue to remain oblivious to the compromised state of their device if they did not witness the exploit being actively used. The lack of an SELinux state entry in the 'About Screen' is missing from both the Android 6.0 based Open Beta releases as well as Android 7.0 official ROMs.

Close

Several apps exist to toggle SELinux state to Permissive such as the [SELinuxModeChanger](https://www.xda-developers.com/easily-change-your-android-selinux-mode/) application. Toggling SELinux through this method does not allow the state to persist through a reboot. Though, you can [utilize scripts](https://forum.xda-developers.com/g2-mini/general/guide-how-to-set-selinux-to-permissive-t3329439) to maintain the *Permissive* SELinux state across hard reboots. Both of these methods require root access, which implies that the user already has knowledge of the risks they are exposed to. But the major difference with changing the SELinux mode to *Permissive* using the above vulnerability is that it not only **persists across hard reboots**, it does so **without needing root access**.

No remedies exist against the vulnerability as of today.

---

**UPDATE:**

We reached out to [Sultanxda](http://forum.xda-developers.com/member.php?u=4800121), one of the most recognized custom ROM developers for OnePlus devices, to see if he could help us learn more about this issue. He promptly dug into the code to find the root source, this is what he found:

*The way that the "fastboot oem selinux <state>" command works is that it adds an extra argument onto the kernel command line when booting Linux. The extra argument comes in the form of "androidboot.selinux=<state>", where <state> can be "permissive". There's where things get funny: "androidboot.<something>" arguments on the kernel command line are parsed by Android's init. In a normal Android production build (a "user" build), the "androidboot.selinux" argument is totally ignored and selinux is always forced to enforcing. So this bug is composed of two issues:*

1. *Users can make the bootloader pass a flag that would normally make selinux permissive on an engineering/debugging ROM build*
2. *OnePlus modified Android's init in order to honor the "androidboot.selinux" flag even for production ROM builds*

*Here's where Android's init is configured to ignored the "androidboot.selinux" flag for production builds: [https://android.googlesource.com/platform/system/core/+/android-6.0.0\_r41/init/Android.mk#7](https://android.googlesource.com/platform/system/core/%2B/android-6.0.0_r41/init/Android.mk#7)*

*The ALLOW\_DISABLE\_SELINUX flag in the source code is only set to 1 for userdebug and engineering builds*

*(My ROM is not affected by this because I build my ROM in production (user) mode)*

*So "androidboot.selinux" is simply ignored in my ROM, the "fastboot oem selinux <state>" command also seems to be something that OnePlus created, as no such command exists in CAF's public bootloader sources. Off the top of my head, I can think of 4 ways to fix this for users with unlocked bootloaders:*

1. *Hex-edit the bootloader to change all instances of the string "selinux" to something different (like "sclinux") so that the flag won't be recognized by Android's init*
2. *Hex-edit the Android init binary in OxygenOS to replace all instances of "androidboot.selinux" to something different (like "androidboot.sclinux") so that Android init won't recognize the androidboot.selinux flag*
3. *Add a hack to the kernel command line driver similar to my SafetyNet bypass in order to hide the "androidboot.selinux" flag from Android's init*

We'd like to thank Sultanxda for his time and effort in helping us figure out what's going on behind the scenes. We've also reached out to OnePlus, who's aware of the situation and is looking into the matter.

---

**We hope OnePlus publicly acknowledges the serious issue and is transparent in their plans towards fixing it.**

* [bootloader](/tag/bootloader/ "bootloader")
* [OnePlus 3](/tag/oneplus-3/ "OnePlus 3")
* [vulnerability](/tag/vulnerability/ "vulnerability")

Follow

Followed

Like

Share
[Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.xda-developers.com%2Foneplus-33t-bootloader-vulnerability-allows-changing-of-selinux-to-permissive-mode-in-fastboot%2F%2F&src=sdkpreparse)
[X](https://twitter.com/intent/tweet?text=OnePlus%203%2F3T%20Bootloader%20Vulnerability%20Allows%20Changing%20of%20SELinux%20to%20Permissive%20Mode%20in%20Fastboot&url=https%3A%2F%2Fwww.xda-developers.com%2Foneplus-33t-bootloader-vulnerability-allows-changing-of-selinux-to-permissive-mode-in-fastboot%2F)
[LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.xda-developers.com%2Foneplus-33t-bootloader-vulnerability-allows-changing-of-selinux-to-permissive-mode-in-fastboot%2F&title=OnePlus%203%2F3T%20Bootloader%20Vulnerability%20Allows%20Changing%20of%20SELinux%20to%20Permissive%20Mode%20in%20Fastboot&source=www.xda-developers.com&summary=A%20serious%20vulnerability%20in%20the%20OnePlus%203%2F3T%20bootloader%20allows%20attackers%20to%20toggle%20SELinux%20state%20from%20Enforcing%20to%20Permissive%21%20Read%20on%20to%20know%20more%21)
[Reddit](https://www.reddit.com/submit?url=https%3A%2F%2Fwww.xda-developers.com%2Foneplus-33t-bootloader-vulnerability-allows-changing-of-selinux-to-permissive-mode-in-fastboot%2F)
[Flipboard](http://share.flipboard.com/bookmarklet/popout?v=2&title=OnePlus%203%2F3T%20Bootloader%20Vulnerability%20Allows%20Changing%20of%20SELinux%20to%20Permissive%20Mode%20in%20Fastboot&url=https%3A%2F%2Fwww.xda-developers.com%2Foneplus-33t-bootloader-vulnerability-allows-changing-of-selinux-to-permissive-mode-in-fastboot%2F&utm_campaign=tools&utm_medium=article-share&utm_source=www.xda-developers.com)
Copy link
Email

Readers like you help support XDA. When you make a purchase using links on our site, we may earn an affiliate commission. [Read More](https://www.valnetinc.com/en/terms-of-use).

Close

Recommended
[![A Windows 11 laptop running Directory Opud](https://static1.xdaimages.com/wordpress/wp-content/uploads/wm/2025/01/directory-opus-featured.jpg)](/reasons-should-use-directory-opus/)
##### [6 reasons you should be using Directory Opus to manage your files on Windows](/reasons-should-use-directory-opus/ "6 reasons you should be using Directory Opus to manage your files on Windows")

[Software and Services](/software-and-services/ "Software and Services")

Supercharge your file management

Posts
[15](/reasons-should-use-directory-opus/#threads "Total Posts")

2 days ago

[![A Windows 11 laptop using EaseUS PCTrans to copy data from a second laptop in the background](https://static1.xdaimages.com/wordpress/wp-content/uploads/wm/2025/01/migrate-data-to-new-pc.jpg)](/free-tools-migrate-data-new-pc-laptop/)
##### [7 free tools to help you migrate data to a new PC or laptop](/free-tools-migrate-data-new-pc-laptop/ "7 free tools to help you migrate data to a new PC or laptop")

[backup](/tag/backup/ "backup")

It doesn't have to be that bad

Posts
[1](/free-tools-migrate-data-new-pc-laptop/#threads "Total Posts")

3 days ago

[![NZXT N7 B650E RAM installed](https://static1.xdaimages.com/wordpress/wp-content/uploads/wm/2024/08/nzxt-n7-b650e-ram-installed-angle.jpg)](/how-to-use-your-ram-as-incredibly-fast-storage-for-video-and-image-editing/)
##### [How to use your RAM as incredibly fast storage for video and image editing](/how-to-use-your-ram-as-incredibly-fast-storage-for-video-and-image-editing/ "How to use your RAM as incredibly fast storage for video and image editing")

[RAM](/tag/ram/ "RAM")

Upgrade your storage with RAM for quick access to important data.

Posts
[3](/how-to-use-your-ram-as-incredibly-fast-storage-for-video-and-image-editing/#threads "Total Posts")

2 days ago

[![screenshot showing open-source-antivirus programs running on Windows](https://static1.xdaimages.com/wordpress/wp-content/uploads/wm/2025/01/open-source-antivirus-protection-windows.png)](/free-open-source-alternatives-anti-virus-software/)
##### [5 free and open-source alternatives to paid anti-virus software](/free-open-source-alternatives-anti-virus-software/ "5 free and open-source alternatives to paid anti-virus software")

[Security](/tag/security/ "Security")

Here are some free and open-source alternatives to commercial antivirus software available for Windows, Mac, and Linux.

Posts

10 hours ago

[![A person holding a Raspberry Pi 5](https://static1.xdaimages.com/wordpress/wp-content/uploads/wm/2024/10/raspberry-pi-5-2-1.jpg)](/ways-secure-your-raspberry-pi/)
##### [5 ways to secure your Raspberry Pi](/ways-secure-your-raspberry-pi/ "5 ways to secure your Raspberry Pi")

[Raspberry Pi](/tag/raspberry-pi/ "Raspberry Pi")

Secure your Raspberry Pi to avoid unauthorized access and potential vulnerabilities using the strategies highlighted below.

Posts

1 day ago

[![11 projects the Raspberry Pi CM5 is perfectly suited for](https://static1.xdaimages.com/wordpress/wp-content/uploads/2025/01/11-projects-the-raspberry-pi-cm5-is-perfectly-suited-for.jpg)](/useful-iot-projects-you-can-build-raspberry-pi-zero-w/)
##### [4 useful IoT projects you can build with the Raspberry Pi zero W](/useful-iot-projects-you-can-build-raspberry-pi-zero-w/ "4 useful IoT projects you can build with the Raspberry Pi zero W")

[Raspberry Pi Zero W](/tag/raspberry-pi-zero-w/ "Raspberry Pi Zero W")

If your looking for an SBC like the raspberry Pi for compact IoT projects, look no further than the Raspberry Pi Zero W

Posts
[2](/useful-iot-projects-you-can-build-raspberry-pi-zero-w/#threads "Total Posts")

3 days ago

* ### Today's best deals

[![MSI Stealth 18 AI](https://static1.xdaimages.com/wordpress/wp-content/uploads/2025/01/169-14.png)](/msi-stealth-18-ai-2800-deal/)
##### [Take $500 off this impressive top-end gaming laptop that packs an Intel Core Ultra 9 and RTX 4080](/msi-stealth-18-ai-2800-deal/ "Take $500 off this impressive top-end gaming laptop that packs an Intel Core Ultra 9 and RTX 4080")

19 hours ago

[![samsung 990 evo plus ssd with two plants](https://static1.xdaimages.com/wordpress/wp-content/uploads/wm/2024/10/samsung-990-evo-plus-ssd-plants.jpg)](/samsung-990-evo-plus-4tb-ssd-250-deal/)
##### [Score a major upgrade for less as this Samsung 4TB M.2 SSD drops to one of its lowest prices yet](/samsung-990-evo-plus-4tb-ssd-250-deal/ "Score a major upgrade for less as this Samsung 4TB M.2 SSD drops to one of its lowest prices yet")

22 hours ago

[![person playing game and looking at Samsung 55](https://static1.xdaimages.com/wordpress/wp-content/uploads/2023/10/xda-36.png)](/samsung-odyssey-ark-55-inch-gaming-monitor-1799-deal/)
##### [Rare discount slashes $1,200 off Samsung's Odyssey Ark 55-inch gaming monitor](/samsung-odyssey-ark-55-inch-gaming-monitor-1799-deal/ "Rare discount slashes $1,200 off Samsung's Odyssey Ark 55-inch gaming monitor")

2 days ago

 [See More](/deals/)

### Trending Now

[![screenshot showing a person using a laptop](https://static1.xdaimages.com/wordpress/wp-content/uploads/2024/11/windows-11-apps-a-sharper-look.jpg)](/open-source-alternatives-windows-essentials/)
##### [7 open-source alternatives to Windows essentials you'll actually want to use](/open-source-alternatives-windows-essentials/ "7 open-source alternatives to Windows essentials you'll actually want to use")

[![Close-up of the Microsoft 365 Copilot listing on the Microsoft Store](https://static1.xdaimages.com/wordpress/wp-content/uploads/wm/2025/01/microsoft-365-copilot.jpg)](/microsofts-worst-rebrands-ever/)
##### [11 of Microsoft's worst rebrands ever, including the one that's just happened](/microsofts-worst-rebrands-ever/ "11 of Microsoft's worst rebrands ever, including the one that's just happened")

[![shows microsoft edge running on windows 11](https://static1.xdaimages.com/wordpress/wp-content/uploads/wm/2025/01/microsoft-edge-running-on-windows-11.png)](/security-settings-set-up-microsoft-edge/)
##### [5 security settings to set up in Microsoft Edge right now](/security-settings-set-up-microsoft-edge/ "5 security settings to set up in Microsoft Edge right now")

[![XDA logo](/public/build/images/xda-logo-symbol-white.svg?v=2.4 "XDA")](/)

* [Join Our Team](/work-with-us/)
* [Our Audience](/page/advertise/)
* [About Us](/page/about/)
* [Press & Events](/page/press-events/)
* [Contact Us](/contact/)

* Follow Us

[![Valnet Logo](/public/build/images/valnet-logo-icon-white.svg?v=2.4 "Valnet")](https://www.valnetinc.com/en/)

* [Advertising](https://www.valnetinc.com/en/advertising)
* [Careers](https://www.valnetinc.com/en/careers)
* [Terms](https://www.valnetinc.com/en/terms-of-use)
* [Privacy](https://www.valnetinc.com/en/privacy-policy)
* [Policies](https://www.valnetinc.com/en/editorial-integrity)

[XDA](/) is part of the
[Valnet Publishing Group](https://www.valnetinc.com/en/)

Copyright © 2025 Valnet Inc.


