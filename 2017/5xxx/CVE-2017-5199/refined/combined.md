=== Content from blog.0xlabs.com_be57f7d4_20250124_144015.html ===


[![0xlabs | Blog](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjD9bbOEmcZWSAN6h1_a5fTz5BiO2EMVjo68AaN5pudEDqNIgsRnPxhPSFIdZqxfr2i3gHxv7kcwssyylb-L9IPGJkoPxac0Tvc1sG-nMv2Kct-gl0Ar76Thihi79SyXhtn2fazZMzCyI8/s1600/Sin-t%25C3%25ADtulo-3.png)](https://blog.0xlabs.com/)

## 2017/03/23

### SolarWinds LEM: SSH Jailbreak and Privilege Escalation

**BACKGROUND**
SolarWinds LEM (or SIEM) is a log management software for security, compliance, and troubleshooting. Log & Event Manager includes rules and reports for standards like HIPAA, PCI-DSS, SOX, GLBA, NCUA, NERC-CIP, DISA-STIG, and more.

**DESCRIPTION**

SolarWinds LEM <= 6.3 is affected by two vulnerabilities that allow remote authenticated users to escape from sandbox and elevate privileges to root. The vulnerable interface exposes some internal tools that could be used to escape from jail and execute arbitrary commands on the system. A second flaw related with improper permissions allows users to execute commands as root.

**PROOF OF CONCEPT**

The affected resource is the custom SSH interface. It is a limited shell which only allows specific management actions, like modify network interfaces or view the server status. Due to weak isolation, it is possible to escape from this interface and launch a system shell without restrictions.

**1. CVE-2017-5199 - SolarWinds SIEM authenticated custom shell Jailbreak and command execution**

- Login through SSH (port 32022 by deafult)

- Acess "appliance" section.

- Enter "editbanner" command. A "nano" editor will be shown.

- Press "F5" key and then <CTRL+T>. This combination will open a file explorer.

- Navigate to "/usr/local/contego/scripts/" and open "mgrconfig.pl". This is the logon shell script and is writable, but can't save to the right file jet.

- Press <ALT+F>, then <CTRL+R>. It will enable multibuffer and ask for a file to insert into. Put "/usr/local/contego/scripts/mgrconfig.pl".

- When loaded, search for "sub do\_main" with <CTRL+W>.

- Insert 'system("/bin/bash");' line, just after 'print "cmc>";'.

- Finally, save the file with <CTRL+O> and ENTER.

- Exit SSH and login again.

- When logged in, a bash shell will be shown.

**2. CVE-2017-5198 - SolarWinds SIEM incorrect permissions on management scripts allows privilege escalation**

- Once logged into bash shell, check available "sudo" commands: sudo -l

- Due to incorrect permissions, it is possible to edit the content of several scripts which are allowed to run as sudo.

- I've choosen "/usr/local/contego/scripts/hostname.sh". Open it with nano, delete the content and just put "/bin/bash -i". Save it with <CTRL+O>.

- Execute "sudo /usr/local/contego/scripts/hostname.sh" to get a root shell.

**BUSINESS IMPACT**

An attacker can execute arbitrary commands as root, which leads in a total machine compromise.

**LIMITATIONS**

The last published version (6.3.1) is affected by the sandbox escape vulnerability, but the privilege escalation was patched by setting correct permissions on the affected files. Anyway, it was verified that is still possible to escalate privileges due to outdated system kernel.

**SOLUTION**

Improve the isolation on the custom SSH interface and set correct permissions on all sensitive files to prevent unwanted access or modification.

It is also recommended to upgrade the system kernel to prevent privilege escalation issues. The SolarWinds team has confirmed that they are working on it.

**TIMELINE**

January 6, 2017: CVE assigned CVE-2017-5198 and CVE-2017-5199

January 6, 2017: Contact with SolarWinds Team

January 10, 2017: SolarWinds confirms the vulnerability. They said that are working in a fix.

January 14, 2017: SolarWinds confirms the patch and public release date (February 15, 2017).

March 23, 2017: Advisory published.

**DISCOVERED BY**

Jose Antonio Pérez Piedra

en

[3/23/2017](https://blog.0xlabs.com/2017/03/solarwinds-lem-ssh-jailbreak-and.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=905596332323260686&postID=636165028795153054&from=pencil "Editar entrada")

[Enviar por correo electrónico](https://www.blogger.com/share-post.g?blogID=905596332323260686&postID=636165028795153054&target=email "Enviar por correo electrónico")[Escribe un blog](https://www.blogger.com/share-post.g?blogID=905596332323260686&postID=636165028795153054&target=blog "Escribe un blog")[Compartir en X](https://www.blogger.com/share-post.g?blogID=905596332323260686&postID=636165028795153054&target=twitter "Compartir en X")[Compartir con Facebook](https://www.blogger.com/share-post.g?blogID=905596332323260686&postID=636165028795153054&target=facebook "Compartir con Facebook")[Compartir en Pinterest](https://www.blogger.com/share-post.g?blogID=905596332323260686&postID=636165028795153054&target=pinterest "Compartir en Pinterest")

#### No hay comentarios:

[Publicar un comentario](https://www.blogger.com/comment/fullpage/post/905596332323260686/636165028795153054)

[Entrada más reciente](https://blog.0xlabs.com/2018/03/openvpn-remote-information-disclosure.html "Entrada más reciente")

[Entrada antigua](https://blog.0xlabs.com/2014/03/zpanel-10.1.x-remote-root.html "Entrada antigua")

[Inicio](https://blog.0xlabs.com/)

Suscribirse a:
[Enviar comentarios (Atom)](https://blog.0xlabs.com/feeds/636165028795153054/comments/default)

[![siguenos en Twitter](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqkJSwVUaQnrQQ3VT-lyaOyJp7EzxJ5L1vwaLWFdBpVDYs4psQpZkvBw0YArpstEKqLG9_1YHTXl-4Ht22kitm3l9YBvEnBjFKMsCDJZG31hJJEY49IShwHub3em5q49HNxI0pz76z1nKL/s1600/Twitter+NEW.png "siguenos en Twitter")](https://twitter.com/0xlabs)
[![Canal de youtube](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgo2F-zc7yzDhWB0VbY2zTksJI8UZHo1HH7nIl0gFYNp3PedB-MbRO_6wODiSzcDgE4zvGTqCHScrfIsTyB3HS6EpM4MT4P7uPvsgK4mH0zsynVZEbQPjxDUJwDjvj5mwOqZfeOxOh6mhbT/s1600/YouTube+alt+1.png "Canal de youtube")](https://www.youtube.com/channel/UCzoc7uM6DqveUeLU6iVvaJQ)
[![Rss feed](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgOkf49FGFJxNx-uysJtqdZjryR07AbQzZJsmrEUhcHzckjEXap8zIyjsptrRCuu2xjGYec2-2gcg97kLguTzsSlbUoHfv1DhABRiX5s1mZFcsObT1Axh4NQ6GP__gU1Lt1P8ZYqz9SSoXy/s1600/RSS+Feed.png "Rss feed")](http://blog.0xlabs.com/feeds/posts/default)
[![sígueme por Correo](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi6cAs7RSL9YolKIfUsi1gF-UyEbIe_XuptW_Be2mYl-SLwIrYG3ieD4aPsgrovxjNLnyvLMQ7j_EYIsuM79rzJ61bDJjTY9HEEDom4FnmiXYBUJT4AxDDbAYIa2CFwkB0h5yuUcSdCeO3S/s1600/Mail.png "sígueme por Correo")](https://www.0xlabs.com/contact)

## Sitios

* [Home](http://www.0xlabs.com/)
* [FileMask](http://filemask.0xlabs.com/)
* [HashMask](http://hashmask.0xlabs.com/)
* [Twitter](http://www.twitter.com/0xlabs)

## Archivo

* [febrero 2021](https://blog.0xlabs.com/2021/02/) (1)
* [marzo 2020](https://blog.0xlabs.com/2020/03/) (1)
* [marzo 2018](https://blog.0xlabs.com/2018/03/) (1)
* [marzo 2017](https://blog.0xlabs.com/2017/03/) (1)
* [marzo 2014](https://blog.0xlabs.com/2014/03/) (1)
* [mayo 2013](https://blog.0xlabs.com/2013/05/) (1)

## Etiquetas

[buffer overflow](https://blog.0xlabs.com/search/label/buffer%20overflow)

[bugtrack](https://blog.0xlabs.com/search/label/bugtrack)

[cross site](https://blog.0xlabs.com/search/label/cross%20site)

[cross site scripting](https://blog.0xlabs.com/search/label/cross%20site%20scripting)

[CVE-2020-13117](https://blog.0xlabs.com/search/label/CVE-2020-13117)

[exploit](https://blog.0xlabs.com/search/label/exploit)

[fulldisclosure](https://blog.0xlabs.com/search/label/fulldisclosure)

[information disclosure](https://blog.0xlabs.com/search/label/information%20disclosure)

[mysql](https://blog.0xlabs.com/search/label/mysql)

[paypal](https://blog.0xlabs.com/search/label/paypal)

[pchart](https://blog.0xlabs.com/search/label/pchart)

[phishing](https://blog.0xlabs.com/search/label/phishing)

[rce](https://blog.0xlabs.com/search/label/rce)

[remote root](https://blog.0xlabs.com/search/label/remote%20root)

[ssh](https://blog.0xlabs.com/search/label/ssh)

[vulnerability](https://blog.0xlabs.com/search/label/vulnerability)

[wavlink](https://blog.0xlabs.com/search/label/wavlink)

[WN575A4](https://blog.0xlabs.com/search/label/WN575A4)

[WN579X3](https://blog.0xlabs.com/search/label/WN579X3)

[xss](https://blog.0xlabs.com/search/label/xss)

[zpanel](https://blog.0xlabs.com/search/label/zpanel)

[zsudo](https://blog.0xlabs.com/search/label/zsudo)


