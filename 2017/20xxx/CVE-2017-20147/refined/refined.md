Based on the provided content, here's the breakdown of the vulnerability related to CVE-2017-20147:

**Root cause of vulnerability:**
- The vulnerability stems from the way Smokeping handles its PID file. The init script for Smokeping gives ownership of the PID file directory (`/run/smokeping`) to the `smokeping` user.
- When the service is stopped, the root process sends a SIGTERM signal to the process ID (PID) listed in the PID file. Since the `smokeping` user controls the PID file, a malicious `smokeping` user can write a different PID, causing root to send a signal to an unintended process, potentially leading to privilege escalation.
- Smokeping itself cannot drop privileges, making it inherently unsafe to use the PID file it creates in the manner it was being used.

**Weaknesses/vulnerabilities present:**
- Insecure file permissions: Giving ownership of the PID file directory to the `smokeping` user allows manipulation of the PID file by that user.
- Improper signal handling during service shutdown: Root sends signals to a PID read from a file controlled by a lower-privileged user.

**Impact of exploitation:**
- A local attacker with access to the `smokeping` user can gain root privileges by manipulating the PID file to cause root to send a signal to a process they control. This could lead to arbitrary code execution with root privileges.

**Attack vectors:**
- Local access to the system with the privileges of the `smokeping` user.

**Required attacker capabilities/position:**
- The attacker must have local access to the system with the privileges of the `smokeping` user.
- The attacker needs to be able to write to the smokeping PID file.

**Additional details:**
- The provided content indicates that the vulnerability was addressed by modifying the init script to pass `--nodaemon` to smokeping and having OpenRC handle backgrounding and PID file management, making the PID file created by Smokeping at `/var/lib/smokeping` unused by the service.
- The init script line  `checkpath -d -m 0755 -o smokeping:smokeping /var/cache/smokeping` was dropped because the directory was not being used.
- The affected version is `net-analyzer/smokeping` version `2.7.3-r1` and earlier.
- Gentoo has discontinued support for Smokeping and recommends that users remove it.