The provided content relates to a fix for a SQL injection vulnerability, and it contains details about the vulnerability and how it was patched.

**Root cause of vulnerability:**
The vulnerability was located in the `get_song_relations` function within the `app/api/songs.py` file. The function used a query parameter `top` from the request without proper sanitization, leading to a SQL injection vulnerability.

**Weaknesses/vulnerabilities present:**
- SQL Injection: The code was vulnerable to SQL injection through the `top` query parameter. Although there was a check to see if the value was a digit, it did not prevent SQL injection, as demonstrated in the test case where `top` could be set to `10; select * from users`.

**Impact of exploitation:**
- An attacker could potentially execute arbitrary SQL queries against the database by manipulating the `top` query parameter, leading to unauthorized data access, modification, or deletion.

**Attack vectors:**
- The attack vector is the HTTP GET request to the `/songs/<int:id>/related` endpoint, with the vulnerable `top` query parameter being exploited.

**Required attacker capabilities/position:**
- The attacker would need to be able to send HTTP requests to the affected endpoint and manipulate the query parameters.
- The attacker does not require any special privileges or position within the application beyond being able to access the endpoint.

**Additional details:**
- The fix for this vulnerability is included in the commit `90bb4fb667d9253d497b619b9adaac83bf0ce0f8`.
- The test file `test/api/test_song_relations.py` includes test cases that show how the vulnerability can be triggered by using the `top` parameter in the request URL.
- The fix involves adding a check for the `top` parameter to ensure it is an integer greater than zero. This check prevents SQL injection but will respond with a 400 error if the check fails.