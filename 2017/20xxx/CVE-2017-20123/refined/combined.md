=== Content from seclists.org_81f824f3_20250124_201250.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](0)
[By Date](date.html#1)
[![Next](/images/right-icon-16x16.png)](2)

[![Previous](/images/left-icon-16x16.png)](0)
[By Thread](index.html#1)
[![Next](/images/right-icon-16x16.png)](2)

![](/shared/images/nst-icons.svg#search)

# Viscosity for Windows 1.6.7 Privilege Escalation

---

*From*: Kacper Szurek <kacperszurek () gmail com>

*Date*: Tue, 31 Jan 2017 14:22:15 +0100

---

```
# Exploit Title: Viscosity for Windows 1.6.7 Privilege Escalation
# Date: 31.01.2017
# Software Link: <https://www.sparklabs.com/>
# Exploit Author: Kacper Szurek
# Contact: <https://twitter.com/KacperSzurek>
# Website: <https://security.szurek.pl/>
# Category: local

1. Description

It is possible to execute openvpn with custom dll as SYSTEM using
ViscosityService because path is not correctly validated.

<https://security.szurek.pl/viscosity-for-windows-167-privilege-escalation.html>

2. Proof of Concept

<https://github.com/kacperszurek/exploits/tree/master/Viscosity>

3. Solution

Update to version 1.6.8

<https://www.sparklabs.com/blog/viscosity-for-mac-windows-version-1-6-8/>

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](0)
[By Date](date.html#1)
[![Next](/images/right-icon-16x16.png)](2)

[![Previous](/images/left-icon-16x16.png)](0)
[By Thread](index.html#1)
[![Next](/images/right-icon-16x16.png)](2)

### Current thread:

* **Viscosity for Windows 1.6.7 Privilege Escalation** *Kacper Szurek (Feb 01)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.sparklabs.com_da1ddab9_20250124_201251.html ===

Toggle navigation

[SparkLabs](/)

* Products
  + [Viscosity](/viscosity/)
* [Blog](/blog/)
* [Company](/company/)
* [Support](/support/)

# SparkLabs Blog.

# The latest news and releases.

updates

[### Viscosity For Mac & Windows: Version 1.6.8](/blog/viscosity-for-mac-windows-version-1-6-8/)

Version 1.6.8 of Viscosity has been released for both Mac and Windows! This release includes a number of improvements and bug fixes, an update to OpenVPN 2.3.14, and an important security fix for the Windows version (more information below).

Version 1.6.8 Mac Release Notes:

improved
PKCS#11 users will now be prompted to insert their token when needed

improved
The connection name is now displayed in challenge and password prompts

improved
Improved support for OpenVPN-AS connection scripts

improved
Unsafe command detection updated to allow commands using safe parameters

updated
OpenVPN updated to version 2.3.14

fixed
Resolves issue where an IPv6 Reachability Check may fail under macOS 10.12

fixed
Resolves potential crash when using the main menu while an alert is visible under macOS 10.12

fixed
Reset network interfaces on disconnect option now behaves correctly for multiple active connections

fixed
Various bug fixes and enhancements

Version 1.6.8 Windows Release Notes:

improved
PKCS#11 users will now be prompted to insert their token when needed

improved
Unsafe command detection updated to allow commands using safe parameters

updated
OpenVPN updated to version 2.3.14

fixed
Security: Fixes a potential privilege escalation attack against Viscosity's service

fixed
Various bug fixes and enhancements

This version includes more fine-grained detection of unsafe commands by now also taking the command's parameters into account. Where previously Viscosity may block a command as unsafe, the command could now be considered safe when certain parameter combinations are used. This should allow for less instances where the "Allow unsafe OpenVPN commands to be used" option needs to be enabled without compromising security.

This version also resolves a security issue that been identified in the Windows version of Viscosity that could potentially allow a local user to gain elevated privileges. Local machine access is required, it cannot be exploited remotely, and it does not affect the security of VPN connections. We encourage all Windows users update to version 1.6.8 as soon as possible, particularly those in multi-user or enterprise environments. Thanks to [Kacper Szurek](https://security.szurek.pl/) for the discovery and notification.

The 1.6.8 update can be automatically installed from inside Viscosity, or [downloaded](/viscosity/download/) and manually installed. For support with this version please visit our [support section](/support/).

---

[Return to Blog](/blog/)

![](/static/img/bsky-logo.svg)

Follow us on Bluesky [@sparklabs.com](https://bsky.app/profile/sparklabs.com)  —  Viscosity 1.11.4 has been released for Windows! It includes significant improvements to the DNS engine, an updated version of OpenSSL, and several bug fixes and small enhancements.
www.sparklabs.com/blog/viscosi...

()

##### Apps

* [Viscosity](/viscosity/)

##### Company

* [About](/company/)
* [Blog](/blog/)
* [Support](/support/)
* [Store](/store/)

##### Support

* [Support Home](/support/)
* [Knowledge Base](/support/kb/)
* [Forum](/forum/)
* [Contact Us](/support/#contact)

##### Stay Updated

* Keep up with the latest important SparkLabs news and updates with our (very) occasional newsletter.
* Subscribe

---

© SparkLabs Pty Ltd. SparkLabs & Viscosity are registered trademarks of SparkLabs Pty Ltd. [Privacy Policy](/company/legal/#privacy)

#### SparkLabs Newsletter

Thank you for being interested in keeping up with the latest news from us! Please double-check your email address below and then click the Subscribe button.

Subscribe



=== Content from github.com_619ff714_20250124_201250.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkacperszurek%2Fexploits%2Ftree%2Fmaster%2FViscosity)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkacperszurek%2Fexploits%2Ftree%2Fmaster%2FViscosity)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=kacperszurek%2Fexploits)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kacperszurek](/kacperszurek)
/
**[exploits](/kacperszurek/exploits)**
Public

* [Notifications](/login?return_to=%2Fkacperszurek%2Fexploits) You must be signed in to change notification settings
* [Fork
  46](/login?return_to=%2Fkacperszurek%2Fexploits)
* [Star
   260](/login?return_to=%2Fkacperszurek%2Fexploits)

* [Code](/kacperszurek/exploits)
* [Issues
  3](/kacperszurek/exploits/issues)
* [Pull requests
  0](/kacperszurek/exploits/pulls)
* [Actions](/kacperszurek/exploits/actions)
* [Projects
  0](/kacperszurek/exploits/projects)
* [Security](/kacperszurek/exploits/security)
* [Insights](/kacperszurek/exploits/pulse)

Additional navigation options

* [Code](/kacperszurek/exploits)
* [Issues](/kacperszurek/exploits/issues)
* [Pull requests](/kacperszurek/exploits/pulls)
* [Actions](/kacperszurek/exploits/actions)
* [Projects](/kacperszurek/exploits/projects)
* [Security](/kacperszurek/exploits/security)
* [Insights](/kacperszurek/exploits/pulse)

## Files

 master
## Breadcrumbs

1. [exploits](/kacperszurek/exploits/tree/master)
/
# Viscosity

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/kacperszurek/exploits/commits/master/Viscosity) master
## Breadcrumbs

1. [exploits](/kacperszurek/exploits/tree/master)
/
# Viscosity

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/kacperszurek/exploits/tree/master) | | |
| [Dll](/kacperszurek/exploits/tree/master/Viscosity/Dll "Dll") | | [Dll](/kacperszurek/exploits/tree/master/Viscosity/Dll "Dll") |  |  |
| [Injector](/kacperszurek/exploits/tree/master/Viscosity/Injector "Injector") | | [Injector](/kacperszurek/exploits/tree/master/Viscosity/Injector "Injector") |  |  |
| [Lzo](/kacperszurek/exploits/tree/master/Viscosity/Lzo "Lzo") | | [Lzo](/kacperszurek/exploits/tree/master/Viscosity/Lzo "Lzo") |  |  |
| [ViscosityPrivEscExploit.sln](/kacperszurek/exploits/blob/master/Viscosity/ViscosityPrivEscExploit.sln "ViscosityPrivEscExploit.sln") | | [ViscosityPrivEscExploit.sln](/kacperszurek/exploits/blob/master/Viscosity/ViscosityPrivEscExploit.sln "ViscosityPrivEscExploit.sln") |  |  |
| View all files | | |

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


