=== Content from security.gentoo.org_ff6b1d70_20250124_225342.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Logcheck: Root privilege escalation — GLSA **202209-10**

A vulnerability has been discovered in Logcheck's ebuilds which could allow for root privilege escalation.

### Affected packages

| Package | **app-admin/logcheck** on all architectures |
| --- | --- |
| Affected versions | <= **1.3.23** |
| Unaffected versions |  |

### Background

Logcheck mails anomalies in the system logfiles to the administrator.

### Description

The pkg\_postinst phase of the Logcheck ebuilds recursively chown the /etc/logcheck and /var/lib/logcheck directories. If the logcheck adds hardlinks to other files in these directories, the chown call will follow the link and transfer ownership of any file to the logcheck user.

### Impact

A local attacker with access to the logcheck user could escalate to root privileges.

### Workaround

There is no known workaround at this time.

### Resolution

Gentoo has discontinued support for Logcheck. We recommend that users remove it:

```
 # emerge --ask --depclean "app-admin/logcheck"

```
### References

* [CVE-2017-20148](https://nvd.nist.gov/vuln/detail/CVE-2017-20148)

**Release date**

September 25, 2022

**Latest revision**

September 25, 2022: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [630752](https://bugs.gentoo.org/show_bug.cgi?id=630752)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.gentoo.org_0768ec8f_20250124_225342.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 630752
app-admin/logcheck: root privilege escalation via "chown -R" in pkg\_postinst
Last modified: 2023-07-21 21:33:31 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=630752&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=630752&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 630752**](show_bug.cgi?id=630752)
(CVE-2017-20148)
- app-admin/logcheck: root privilege escalation via "chown -R" in pkg\_postinst

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
app-admin/logcheck: root privilege escalation via "chown -R" in pkg\_postinst

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2017-20148 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Auditing ([show other bugs](buglist.cgi?component=Auditing&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B1 [glsa+] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-09-11 22:45 UTC by Michael Orlitzky | | --- | --- | | Modified: | 2023-07-21 21:33 UTC ([History](show_activity.cgi?id=630752)) | | CC List: | 7 users (show)  2kmm foti.giuseppe gentoo gentoo\_bugs\_2\_peep gentoo\_eshoes mrueg security-audit | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * [724516](show_bug.cgi?id=724516 "RESOLVED FIXED - app-admin/logcheck-1.3.20: version bump") | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Fix privilege escalation**](attachment.cgi?id=801076 "View the content of the attachment") (logcheck.patch,1.33 KB, patch)  [2022-08-26 06:03 UTC](#attach_801076 "Go to the comment associated with the attachment"), Manuel Mommertz | [Details](attachment.cgi?id=801076&action=edit) | [Diff](attachment.cgi?id=801076&action=diff) | | [View All](attachment.cgi?bugid=630752&action=viewall)  [Add an attachment](attachment.cgi?bugid=630752&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=630752&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Michael Orlitzky   gentoo-dev  2017-09-11 22:45:48 UTC  ``` The logcheck ebuilds all call "chown -R" on the root filesystem during pkg_postinst:    pkg_postinst() {       chown -R logcheck:logcheck /etc/logcheck /var/lib/logcheck || die  This is exploitable in the same way that the init scripts were: the first install is safe, but then the logcheck user can place a hard link in either of those directories pointing to e.g. /root/.bashrc. The next time logcheck is installed, the ebuild will call chown on the hardlink, and give ownership of /root/.bashrc to the "logcheck" user.  I'm marking this private, but the package is maintainer-needed, so it's up to @security who to CC. If someone wants to take a shot at it, my first attempt would be to use "fowners root:logcheck ..." and to do it on $D in src_install. Another call to fperms could then make those directories group-rwx. Neither call should operate recursively. ```  [Comment 1](#c1)  Kristian Fiskerstrand (RETIRED)   gentoo-dev  2017-09-12 08:58:55 UTC  ``` @mrueg: Hi Manuel, I see you're the last dev to touch this package with a version bump earlier this year. Maybe you want to take a crack at fixing this issue and taking over maintainership of the package? ```  [Comment 2](#c2)  Manuel Rüger (RETIRED)   gentoo-dev  2017-09-12 12:41:59 UTC  ``` I'm not interested in maintaining it.   the cronjob is probably similarly vulnerable in /etc/cron.hourly/logcheck.cron > chown -R logcheck:logcheck /var/lock/logcheck ```  [Comment 3](#c3)  Robin Johnson   archtester Gentoo Infrastructure gentoo-dev Security  2020-04-03 23:16:18 UTC  ``` Unrestricting and reassigning to security@ per [bug #705894](show_bug.cgi?id=705894 "RESOLVED FIXED - bugzilla: de-embargo old security bugs") ```  [Comment 4](#c4)  Robin Johnson   archtester Gentoo Infrastructure gentoo-dev Security  2020-04-03 23:18:29 UTC  ``` unrestricting per [bug 705894](show_bug.cgi?id=705894 "RESOLVED FIXED - bugzilla: de-embargo old security bugs") ```  [Comment 5](#c5)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-08-11 03:55:26 UTC  ``` (In reply to Larry the Git Cow from [comment #18](show_bug.cgi?id=630752#c18)) > The bug has been referenced in the following commit(s): >  > <https://gitweb.gentoo.org/repo/gentoo.git/commit/> > ?id=2aa8d23c8600f65ddf12a27696c2b4b99babbd79 >  > commit 2aa8d23c8600f65ddf12a27696c2b4b99babbd79 > Author:     John Helmert III <ajak@gentoo.org> > AuthorDate: 2022-08-11 03:50:22 +0000 > Commit:     John Helmert III <ajak@gentoo.org> > CommitDate: 2022-08-11 03:50:22 +0000 >  >     profiles: last rite app-admin/logcheck >      >     Bug: <https://bugs.gentoo.org/730752> >     Signed-off-by: John Helmert III <ajak@gentoo.org> >  >  profiles/package.mask | 5 +++++ >  1 file changed, 5 insertions(+) ```  [Comment 6](#c6)  Manuel Mommertz    2022-08-26 06:03:12 UTC  ``` Created [attachment 801076](attachment.cgi?id=801076 "Fix privilege escalation") [[details](attachment.cgi?id=801076&action=edit "Fix privilege escalation"), [diff](attachment.cgi?id=801076&action=diff "Fix privilege escalation")] Fix privilege escalation  If it is just the privilege escalation, this is easily fixable (see patch).  Regarding a maintainer I cannot help, sorry. :) ```  [Comment 7](#c7)  Philippe Chaintreuil    2022-08-26 11:18:18 UTC  ``` I'd be willing to proxy maintainer logcheck to keep it in the tree. ```  [Comment 8](#c8)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2022-08-26 11:27:36 UTC  ``` (In reply to Philippe Chaintreuil from [comment #7](show_bug.cgi?id=630752#c7)) > I'd be willing to proxy maintainer logcheck to keep it in the tree.  That'd be great, thank you. ```  [Comment 9](#c9)  Jared B.    2022-08-29 19:20:30 UTC  ``` Also, there was a comment about logcheck being "unmaintained since the git transition" in the last rights, but I can't figure out what that's referring to.  It seems like this is the current git repo:  <https://salsa.debian.org/debian/logcheck>  And that had a commit 2 weeks ago, plus several commits and a new release (1.3.24) in July.  So this doesn't seem to be unmaintained, though admittedly this is an outsider's view and there may be stuff behind the scenes that I don't see. ```  [Comment 10](#c10)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-08-29 19:27:45 UTC  ``` (In reply to Jared B. from [comment #9](show_bug.cgi?id=630752#c9)) > Also, there was a comment about logcheck being "unmaintained since the git > transition" in the last rights, but I can't figure out what that's referring > to.  It seems like this is the current git repo: >  > <https://salsa.debian.org/debian/logcheck> >  > And that had a commit 2 weeks ago, plus several commits and a new release > (1.3.24) in July.  So this doesn't seem to be unmaintained, though > admittedly this is an outsider's view and there may be stuff behind the > scenes that I don't see.  The last maintainer in Gentoo dropped the package in 2017:  commit 4228e93b4a73fd3f462d34eb0ce9949b066a7873 Author: Pawel Hajdan, Jr <phajdan.jr@gentoo.org> Date:   Tue May 2 12:27:19 2017 +0200      app-admin/logcheck: remove phajdan.jr from maintainers -> maintainer-needed      Package-Manager: Portage-2.3.3, Repoman-2.3.1  diff --git a/app-admin/logcheck/metadata.xml b/app-admin/logcheck/metadata.xml index cc8cd37515a7..7a38bb900964 100644 --- a/app-admin/logcheck/metadata.xml +++ b/app-admin/logcheck/metadata.xml @@ -1,8 +1,5 @@  <?xml version="1.0" encoding="UTF-8"?>  <!DOCTYPE pkgmetadata SYSTEM "<http://www.gentoo.org/dtd/metadata.dtd>">  <pkgmetadata> -       <maintainer type="person"> -               <email>phajdan.jr@gentoo.org</email> -               <name>Pawel Hajdan jr</name> -       </maintainer> +       <!-- maintainer-needed -->  </pkgmetadata>   Before that, phajdan hadn't even touched the package since the ::gentoo git transition in 2015: <https://github.com/gentoo/gentoo/commits/master/app-admin/logcheck> ```  [Comment 11](#c11)  Jared B.    2022-08-31 13:08:50 UTC  ``` (In reply to John Helmert III from [comment #10](show_bug.cgi?id=630752#c10)) > The last maintainer in Gentoo dropped the package in 2017:  Gotcha.  I had read that as unmaintained upstream.  Thanks for clarifying. ```  [Comment 12](#c12)  Philippe Chaintreuil    2022-09-16 00:13:35 UTC  ``` (In reply to Sam James from [comment #8](show_bug.cgi?id=630752#c8)) > (In reply to Philippe Chaintreuil from [comment #7](show_bug.cgi?id=630752#c7)) > > I'd be willing to proxy maintainer logcheck to keep it in the tree. >  > That'd be great, thank you.  Actually, I'm going to have to retract this.  Turns out I'm still using logsentry, not logcheck.  (I was confused since logsentry's script is called logcheck.)  Sorry for the fake-out.  :-( ```  [Comment 13](#c13)  Larry the Git Cow   gentoo-dev  2022-09-18 21:23:41 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=c1517666b3bb5e08ad6a85aceada2e9ddfc25f10>  commit c1517666b3bb5e08ad6a85aceada2e9ddfc25f10 Author:     John Helmert III <ajak@gentoo.org> AuthorDate: 2022-09-18 21:20:38 +0000 Commit:     John Helmert III <ajak@gentoo.org> CommitDate: 2022-09-18 21:20:38 +0000      app-admin/logcheck: treeclean          Bug: <https://bugs.gentoo.org/630752>     Signed-off-by: John Helmert III <ajak@gentoo.org>   app-admin/logcheck/Manifest               |  1 -  app-admin/logcheck/files/logcheck.cron    | 10 -----  app-admin/logcheck/logcheck-1.3.23.ebuild | 65 -------------------------------  app-admin/logcheck/metadata.xml           |  5 ---  profiles/package.mask                     |  5 ---  5 files changed, 86 deletions(-)  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=31c1a39700a70382a13f65f6bef70698c174d8b4>  commit 31c1a39700a70382a13f65f6bef70698c174d8b4 Author:     John Helmert III <ajak@gentoo.org> AuthorDate: 2022-09-18 21:19:57 +0000 Commit:     John Helmert III <ajak@gentoo.org> CommitDate: 2022-09-18 21:19:57 +0000      net-analyzer/sguil-sensor: treeclean          Bug: <https://bugs.gentoo.org/630752>     Signed-off-by: John Helmert III <ajak@gentoo.org>   net-analyzer/sguil-sensor/Manifest                 |  1 -  net-analyzer/sguil-sensor/files/log_packets.confd  | 18 -----  net-analyzer/sguil-sensor/files/log_packets.initd  | 91 ----------------------  net-analyzer/sguil-sensor/files/sensor_agent.initd | 29 -------  net-analyzer/sguil-sensor/metadata.xml             | 12 ---  .../sguil-sensor/sguil-sensor-1.0.0-r3.ebuild      | 81 -------------------  profiles/package.mask                              |  5 --  7 files changed, 237 deletions(-) ```  [Comment 14](#c14)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-09-19 18:47:38 UTC  ``` GLSA request filed, CVE pending ```  [Comment 15](#c15)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-09-25 13:43:53 UTC  ``` GLSA released, all done! ```  [Comment 16](#c16)  Larry the Git Cow   gentoo-dev  2022-09-25 13:57:00 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/data/glsa.git/commit/?id=c119633f474d495980aaa3db92f8d90254200747>  commit c119633f474d495980aaa3db92f8d90254200747 Author:     GLSAMaker <glsamaker@gentoo.org> AuthorDate: 2022-09-25 13:34:57 +0000 Commit:     John Helmert III <ajak@gentoo.org> CommitDate: 2022-09-25 13:42:21 +0000      [ GLSA 202209-10 ] Logcheck: Root privilege escalation          Bug: <https://bugs.gentoo.org/630752>     Signed-off-by: GLSAMaker <glsamaker@gentoo.org>     Signed-off-by: John Helmert III <ajak@gentoo.org>   glsa-202209-10.xml | 40 ++++++++++++++++++++++++++++++++++++++++  1 file changed, 40 insertions(+) ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=630752)
* - [XML](show_bug.cgi?ctype=xml&id=630752)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=630752)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=630752&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=630752&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=630752&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


