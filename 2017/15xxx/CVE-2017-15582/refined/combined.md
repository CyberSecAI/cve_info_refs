=== Content from 1337sec.blogspot.com_292d1db7_20250126_072707.html ===

[Skip to main content](#main)

### Search This Blog

# [1337 Security](https://1337sec.blogspot.com/)

### Auditing WriteDiary.com (CVE-2017-15581 & CVE-2017-15582)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[October 27, 2017](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html "permanent link")

*General note: The developer and owner of both the webapp and android app has been contacted multiple times to develop a quick fix for the issues addressed in this blog post and a vulnerability concerning the webapp which isn't described here. However, no response has been received.*

WriteDiary consists of a webapp ([WriteDiary.com](http://writediary.com/)) and an [android app](https://play.google.com/store/apps/details?id=com.adpog.diary) (version 4.72). For the audit, the android app was the primary target.
### **CVE-2017-15581**: Lack of HTTPS-usage, lack of user data encryption when transmitting

In the "Diary with lock" (aka WriteDiary) application 4.72 for Android, neither HTTPS (check *strings.xml* for *api\_url\_prod*: *http://diary.adpog.com/api2)*nor other encryption is used for transmitting data, despite the [documentation](http://writediary.com/) that the product is intended for "a personal journal of secrets and feelings," which allows remote attackers to obtain sensitive information by sniffing the network during LoginActivity or NoteActivity execution.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhifJa_dgKZjxsj8BHzF7jMXgQXJdxlBXXTNki7w174xonwIA3xlUhK1Z-6q-YDdCYO-E4Ef_yyoDTty58jW1_WwxhhBXNnkv3MAndHRDUMP8ZDNtFdQKfjN_6eJbv95f1bthDn6ENQDYkP/s1600/cleartext_pw.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhifJa_dgKZjxsj8BHzF7jMXgQXJdxlBXXTNki7w174xonwIA3xlUhK1Z-6q-YDdCYO-E4Ef_yyoDTty58jW1_WwxhhBXNnkv3MAndHRDUMP8ZDNtFdQKfjN_6eJbv95f1bthDn6ENQDYkP/s1600/cleartext_pw.png)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8KLC7FxmbXc9SXjwQ4p1FDDJPaSLdg506kqu_FiNh8aU_dJx28zRbl9nfbDpvR5YLoYUn2Ov8EtXzXKH563sBo0WEsSeJ2sag6R_bQce154MnzuRTAnKCwOBNf_UY-updqSU3-6BU4Kkj/s1600/cleartext_body.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8KLC7FxmbXc9SXjwQ4p1FDDJPaSLdg506kqu_FiNh8aU_dJx28zRbl9nfbDpvR5YLoYUn2Ov8EtXzXKH563sBo0WEsSeJ2sag6R_bQce154MnzuRTAnKCwOBNf_UY-updqSU3-6BU4Kkj/s1600/cleartext_body.png)

Vulnerability type: Plaintext data transport

Affected Product Code Base: WriteDiary - 4.72

Affected Component: LoginActivity, NoteActivity\*

Impact: Information Disclosure of sensitive data (diary entries, login data)

### CVE-2017-15582: Usage of static AES parameters

In *net.MCrypt* in the "Diary with lock" (aka WriteDiary) application 4.72 for Android, hardcoded *SecretKey* and *iv* variables are used for the AES parameters, which makes it easier for attackers to obtain the cleartext of stored diary entries:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjgk7y1QlCNElb7UK73HJrI2EGsVJgMipVeWK8ZZuIP58SrKff187K6l0C8MVwUi_G-WNTv7tPM9JEhyBn5aDC6-H1yIpkXpRYNREZl4nT-q4oqFVF4jfXTm3_kPdAbOmC9z-8ct46Gmfi-/s1600/staticAES.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjgk7y1QlCNElb7UK73HJrI2EGsVJgMipVeWK8ZZuIP58SrKff187K6l0C8MVwUi_G-WNTv7tPM9JEhyBn5aDC6-H1yIpkXpRYNREZl4nT-q4oqFVF4jfXTm3_kPdAbOmC9z-8ct46Gmfi-/s1600/staticAES.png)

As you can see, the specific values are:

*secret key = "f8djD2kfdU31wuRu"*
*iv = "aBcNvn71dkdjf8hf"*

Vulnerability type: Hard coded AES parameters

Affected Product Code Base: WriteDiary - 4.72

Affected Component: net.MCrypt

Impact: Information Disclosure of sensitive data (diary entries)

### Additional note (not relevant for the reported CVEs)

Further analysis showed that the data stored on the webapplication server is **not encrypted**. This means, that the whole concept isn't as private as it claims it is. On top of that, there's a built-in backdoor which lets the administrator access the confidential diary entries of every user.

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Popular posts from this blog

### [Auditing NQ Contacts Backup & Restore 1.1](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html)

[October 29, 2017](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiFP3Vt95Odc28i0JCZumQ2CaChZAdn83nZjXU0Diolx3lWR3tNRW6ozgneZ64hbq4HJQgWTlDQpqjDKxKdXGkfFHHOKRRDR4kilaUhMMkISw022_-_pKp2ykq8WjQ_-0fC9re49tVC7O6O/s1600/xml.png)](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html)

NQ Contacts Backup & Restore is an android app that allows users to backup and restore contact data (as vcard) to/from the remote NQ server. For the audit, the android app was the primary target.  Note: The app shares its code base with NQ Mobile Security & Anti Virus  - hence the odd class names for a simple contact backup app. Lack of HTTPS usage  When logging in or transmitting data, the app communicates with the remote server via HTTP. This can be exploited in various ways. One of these is sniffing the request when a user logs in:   As you can see, the username is being transmitted in cleartext.  The password is hashed with SHA-1. An attacker can now crack the SHA-1 hash (because that's pretty easy nowadays): Additionally, an attacker could use the sniffed hash to download the stored contacts from the server directly. As described later, the attacker can also access transmitted contact data. Vulnerability type: Plaintext data tran...

[Read more](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html "Auditing NQ Contacts Backup & Restore 1.1")

### [Auditing the Oral-B App (v5.0.0)](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html)

[January 08, 2018](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiJqORraqY6YwfmeNNNuWwnlymIF1_F0kd4RQNVLDbkisIjETDQ7jw5byRpNRsdNOZPTpypeDPigncT54GwDtMdMiYgiz9N0DCi8PTk7MSWWV86uQ0_XzZMRTS5sOnj7-u3yF5dy0CBnCw6/s1600/keys.png)](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html)

Upon quickly assessing the Oral-B app (com.pg.oralb.oralbapp), the following findings have been made: Hardcoded AES parameters (CVE-2018-5298) and twitter keys These parameters are stored in the class OralBApplication and also get used there: Using the twitter secrets, it's possible to create bearer tokens impersonating the Oral-B twitter application. The secrets stored in the app are application tokens only - in my tests it was not possible to authenticate in user context. The stored AES parameters are used to encrypt and decrypt the locally stored shared preferences in the class called Preferences : Because of the static key, an attacker can gain access to user data more easily by leveraging access to the preferences XML file. Tracking Upon running the app, the user automatically gets tracked. There is no opt-in required, it's enabled by default. As you can see, third party advertising providers are allowed to gain access to the us...

[Read more](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html "Auditing the Oral-B App (v5.0.0)")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Terraxplorer](http://www.istockphoto.com/file_closeup.php?id=4502756&platform=blogger)

[Banana Joe](https://www.blogger.com/profile/07123599309238725850)

[Visit profile](https://www.blogger.com/profile/07123599309238725850)

### Archive

* [January 20181](https://1337sec.blogspot.com/2018/01/)
* [October 20172](https://1337sec.blogspot.com/2017/10/)

### [Report Abuse](https://www.blogger.com/go/report-abuse)



=== Content from 1337sec.blogspot.com_bd3382c5_20250126_072707.html ===

[Skip to main content](#main)

### Search This Blog

# 1337 Security

* [Startseite](https://1337sec.blogspot.com/)

More…

## Posts

### [Auditing the Oral-B App (v5.0.0)](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[January 08, 2018](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html "permanent link")

![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiJqORraqY6YwfmeNNNuWwnlymIF1_F0kd4RQNVLDbkisIjETDQ7jw5byRpNRsdNOZPTpypeDPigncT54GwDtMdMiYgiz9N0DCi8PTk7MSWWV86uQ0_XzZMRTS5sOnj7-u3yF5dy0CBnCw6/s1600/keys.png)

Upon quickly assessing the Oral-B app (com.pg.oralb.oralbapp), the following findings have been made: Hardcoded AES parameters (CVE-2018-5298) and twitter keys These parameters are stored in the class OralBApplication and also get used there: Using the twitter secrets, it's possible to create bearer tokens impersonating the Oral-B twitter application. The secrets stored in the app are application tokens only - in my tests it was not possible to authenticate in user context. The stored AES parameters are used to encrypt and decrypt the locally stored shared preferences in the class called Preferences : Because of the static key, an attacker can gain access to user data more easily by leveraging access to the preferences XML file. Tracking Upon running the app, the user automatically gets tracked. There is no opt-in required, it's enabled by default. As you can see, third party advertising providers are allowed to gain access to the us...

[Read more](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html "Auditing the Oral-B App (v5.0.0)")

### [Auditing NQ Contacts Backup & Restore 1.1](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[October 29, 2017](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html "permanent link")

![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiFP3Vt95Odc28i0JCZumQ2CaChZAdn83nZjXU0Diolx3lWR3tNRW6ozgneZ64hbq4HJQgWTlDQpqjDKxKdXGkfFHHOKRRDR4kilaUhMMkISw022_-_pKp2ykq8WjQ_-0fC9re49tVC7O6O/s1600/xml.png)

NQ Contacts Backup & Restore is an android app that allows users to backup and restore contact data (as vcard) to/from the remote NQ server. For the audit, the android app was the primary target.  Note: The app shares its code base with NQ Mobile Security & Anti Virus  - hence the odd class names for a simple contact backup app. Lack of HTTPS usage  When logging in or transmitting data, the app communicates with the remote server via HTTP. This can be exploited in various ways. One of these is sniffing the request when a user logs in:   As you can see, the username is being transmitted in cleartext.  The password is hashed with SHA-1. An attacker can now crack the SHA-1 hash (because that's pretty easy nowadays): Additionally, an attacker could use the sniffed hash to download the stored contacts from the server directly. As described later, the attacker can also access transmitted contact data. Vulnerability type: Plaintext data tran...

[Read more](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html "Auditing NQ Contacts Backup & Restore 1.1")

### [Auditing WriteDiary.com (CVE-2017-15581 & CVE-2017-15582)](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[October 27, 2017](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html "permanent link")

![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhifJa_dgKZjxsj8BHzF7jMXgQXJdxlBXXTNki7w174xonwIA3xlUhK1Z-6q-YDdCYO-E4Ef_yyoDTty58jW1_WwxhhBXNnkv3MAndHRDUMP8ZDNtFdQKfjN_6eJbv95f1bthDn6ENQDYkP/s1600/cleartext_pw.png)

General note: The developer and owner of both the webapp and android app has been contacted multiple times to develop a quick fix for the issues addressed in this blog post and a vulnerability concerning the webapp which isn't described here. However, no response has been received. WriteDiary consists of a webapp ( WriteDiary.com ) and an android app  (version 4.72). For the audit, the android app was the primary target. CVE-2017-15581 : Lack of HTTPS-usage, lack of user data encryption when transmitting In the "Diary with lock" (aka WriteDiary) application 4.72 for Android, neither HTTPS (check strings.xml for api\_url\_prod :  http ://diary.adpog.com/api2)  nor other encryption is used for transmitting data, despite the documentation that the product is intended for "a personal journal of secrets and feelings," which allows remote attackers to obtain sensitive information by sniffing the network during LoginActivity or NoteActivity execution. ...

[Read more](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html "Auditing WriteDiary.com (CVE-2017-15581 & CVE-2017-15582)")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Terraxplorer](http://www.istockphoto.com/file_closeup.php?id=4502756&platform=blogger)

[Banana Joe](https://www.blogger.com/profile/07123599309238725850)

[Visit profile](https://www.blogger.com/profile/07123599309238725850)

### Archive

* [January 20181](https://1337sec.blogspot.com/2018/01/)
* [October 20172](https://1337sec.blogspot.com/2017/10/)

### [Report Abuse](https://www.blogger.com/go/report-abuse)



=== Content from gist.github.com_0e4cd6e5_20250125_080628.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fanonymous%2F603b89f864a71426042b167cab557efa)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fanonymous%2F603b89f864a71426042b167cab557efa&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fanonymous%2F603b89f864a71426042b167cab557efa) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fanonymous%2F603b89f864a71426042b167cab557efa&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

# /**[gist:603b89f864a71426042b167cab557efa](/anonymous/603b89f864a71426042b167cab557efa)**

Created
October 27, 2017 19:23

Show Gist options

* [Download ZIP](/anonymous/603b89f864a71426042b167cab557efa/archive/4c3a42f954887eb1df4dc95844abe9dab6f3bffb.zip)

* [Star
  0
  (0)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fanonymous%2F603b89f864a71426042b167cab557efa)You must be signed in to star a gist
* [Fork
  0
  (0)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fanonymous%2F603b89f864a71426042b167cab557efa)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/anonymous/603b89f864a71426042b167cab557efa.js&quot;&gt;&lt;/script&gt;
* Save anonymous/603b89f864a71426042b167cab557efa to your computer and use it in GitHub Desktop.

[Code](/anonymous/603b89f864a71426042b167cab557efa)
[Revisions
1](/anonymous/603b89f864a71426042b167cab557efa/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/anonymous/603b89f864a71426042b167cab557efa.js&quot;&gt;&lt;/script&gt;

Save anonymous/603b89f864a71426042b167cab557efa to your computer and use it in GitHub Desktop.

[Download ZIP](/anonymous/603b89f864a71426042b167cab557efa/archive/4c3a42f954887eb1df4dc95844abe9dab6f3bffb.zip)

Auditing WriteDiary.com (CVE-2017-15581 & CVE-2017-15582)

 [Raw](/anonymous/603b89f864a71426042b167cab557efa/raw/4c3a42f954887eb1df4dc95844abe9dab6f3bffb/gistfile1.txt)

[**gistfile1.txt**](#file-gistfile1-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | General note: The developer and owner of both the webapp and android app has been contacted multiple times to develop a quick fix for the issues addressed in this blog post and a vulnerability concerning the webapp which isn't described here. However, no response has been received. |
| --- | --- |
|  |  |
|  | WriteDiary consists of a webapp (WriteDiary.com) and an android app (version 4.72). For the audit, the android app was the primary target. |
|  |  |
|  | CVE-2017-15581: Lack of HTTPS-usage, lack of user data encryption when transmitting: |
|  | ==================================================================================== |
|  |  |
|  | In the "Diary with lock" (aka WriteDiary) application 4.72 for Android, neither HTTPS (check strings.xml for api\_url\_prod: http://diary.adpog.com/api2) nor other encryption is used for transmitting data, despite the documentation that the product is intended for "a personal journal of secrets and feelings," which allows remote attackers to obtain sensitive information by sniffing the network during LoginActivity or NoteActivity execution. |
|  |  |
|  | Vulnerability type: Plaintext data transport |
|  | Affected Product Code Base: WriteDiary - 4.72 |
|  | Affected Component: LoginActivity, NoteActivity\* |
|  | Impact: Information Disclosure of sensitive data (diary entries, login data) |
|  |  |
|  | ----------------------------------------------------------------------------- |
|  |  |
|  | CVE-2017-15582: Usage of static AES parameters: |
|  | =============================================== |
|  |  |
|  | In net.MCrypt in the "Diary with lock" (aka WriteDiary) application 4.72 for Android, hardcoded SecretKey and iv variables are used for the AES parameters, which makes it easier for attackers to obtain the cleartext of stored diary entries. The specific values are: |
|  | secret key = "f8djD2kfdU31wuRu" |
|  | iv = "aBcNvn71dkdjf8hf" |
|  |  |
|  | Vulnerability type: Hard coded AES parameters |
|  | Affected Product Code Base: WriteDiary - 4.72 |
|  | Affected Component: net.MCrypt |
|  | Impact: Information Disclosure of sensitive data (diary entries) |
|  |  |
|  | ----------------------------------------------------------------------------- |
|  |  |
|  | Additional note (not relevant for the reported CVEs): |
|  | ===================================================== |
|  |  |
|  | Further analysis showed that the data stored on the webapplication server is not encrypted. This means, that the whole concept isn't as private as it claims it is. On top of that, there's a built-in backdoor which lets the administrator access the confidential diary entries of every user. |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fanonymous%2F603b89f864a71426042b167cab557efa)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from 1337sec.blogspot.de_c3528a3e_20250125_080627.html ===

[Skip to main content](#main)

### Search This Blog

# [1337 Security](https://1337sec.blogspot.com/)

### Auditing WriteDiary.com (CVE-2017-15581 & CVE-2017-15582)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[October 27, 2017](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html "permanent link")

*General note: The developer and owner of both the webapp and android app has been contacted multiple times to develop a quick fix for the issues addressed in this blog post and a vulnerability concerning the webapp which isn't described here. However, no response has been received.*

WriteDiary consists of a webapp ([WriteDiary.com](http://writediary.com/)) and an [android app](https://play.google.com/store/apps/details?id=com.adpog.diary) (version 4.72). For the audit, the android app was the primary target.
### **CVE-2017-15581**: Lack of HTTPS-usage, lack of user data encryption when transmitting

In the "Diary with lock" (aka WriteDiary) application 4.72 for Android, neither HTTPS (check *strings.xml* for *api\_url\_prod*: *http://diary.adpog.com/api2)*nor other encryption is used for transmitting data, despite the [documentation](http://writediary.com/) that the product is intended for "a personal journal of secrets and feelings," which allows remote attackers to obtain sensitive information by sniffing the network during LoginActivity or NoteActivity execution.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhifJa_dgKZjxsj8BHzF7jMXgQXJdxlBXXTNki7w174xonwIA3xlUhK1Z-6q-YDdCYO-E4Ef_yyoDTty58jW1_WwxhhBXNnkv3MAndHRDUMP8ZDNtFdQKfjN_6eJbv95f1bthDn6ENQDYkP/s1600/cleartext_pw.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhifJa_dgKZjxsj8BHzF7jMXgQXJdxlBXXTNki7w174xonwIA3xlUhK1Z-6q-YDdCYO-E4Ef_yyoDTty58jW1_WwxhhBXNnkv3MAndHRDUMP8ZDNtFdQKfjN_6eJbv95f1bthDn6ENQDYkP/s1600/cleartext_pw.png)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8KLC7FxmbXc9SXjwQ4p1FDDJPaSLdg506kqu_FiNh8aU_dJx28zRbl9nfbDpvR5YLoYUn2Ov8EtXzXKH563sBo0WEsSeJ2sag6R_bQce154MnzuRTAnKCwOBNf_UY-updqSU3-6BU4Kkj/s1600/cleartext_body.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8KLC7FxmbXc9SXjwQ4p1FDDJPaSLdg506kqu_FiNh8aU_dJx28zRbl9nfbDpvR5YLoYUn2Ov8EtXzXKH563sBo0WEsSeJ2sag6R_bQce154MnzuRTAnKCwOBNf_UY-updqSU3-6BU4Kkj/s1600/cleartext_body.png)

Vulnerability type: Plaintext data transport

Affected Product Code Base: WriteDiary - 4.72

Affected Component: LoginActivity, NoteActivity\*

Impact: Information Disclosure of sensitive data (diary entries, login data)

### CVE-2017-15582: Usage of static AES parameters

In *net.MCrypt* in the "Diary with lock" (aka WriteDiary) application 4.72 for Android, hardcoded *SecretKey* and *iv* variables are used for the AES parameters, which makes it easier for attackers to obtain the cleartext of stored diary entries:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjgk7y1QlCNElb7UK73HJrI2EGsVJgMipVeWK8ZZuIP58SrKff187K6l0C8MVwUi_G-WNTv7tPM9JEhyBn5aDC6-H1yIpkXpRYNREZl4nT-q4oqFVF4jfXTm3_kPdAbOmC9z-8ct46Gmfi-/s1600/staticAES.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjgk7y1QlCNElb7UK73HJrI2EGsVJgMipVeWK8ZZuIP58SrKff187K6l0C8MVwUi_G-WNTv7tPM9JEhyBn5aDC6-H1yIpkXpRYNREZl4nT-q4oqFVF4jfXTm3_kPdAbOmC9z-8ct46Gmfi-/s1600/staticAES.png)

As you can see, the specific values are:

*secret key = "f8djD2kfdU31wuRu"*
*iv = "aBcNvn71dkdjf8hf"*

Vulnerability type: Hard coded AES parameters

Affected Product Code Base: WriteDiary - 4.72

Affected Component: net.MCrypt

Impact: Information Disclosure of sensitive data (diary entries)

### Additional note (not relevant for the reported CVEs)

Further analysis showed that the data stored on the webapplication server is **not encrypted**. This means, that the whole concept isn't as private as it claims it is. On top of that, there's a built-in backdoor which lets the administrator access the confidential diary entries of every user.

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Popular posts from this blog

### [Auditing NQ Contacts Backup & Restore 1.1](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html)

[October 29, 2017](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiFP3Vt95Odc28i0JCZumQ2CaChZAdn83nZjXU0Diolx3lWR3tNRW6ozgneZ64hbq4HJQgWTlDQpqjDKxKdXGkfFHHOKRRDR4kilaUhMMkISw022_-_pKp2ykq8WjQ_-0fC9re49tVC7O6O/s1600/xml.png)](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html)

NQ Contacts Backup & Restore is an android app that allows users to backup and restore contact data (as vcard) to/from the remote NQ server. For the audit, the android app was the primary target.  Note: The app shares its code base with NQ Mobile Security & Anti Virus  - hence the odd class names for a simple contact backup app. Lack of HTTPS usage  When logging in or transmitting data, the app communicates with the remote server via HTTP. This can be exploited in various ways. One of these is sniffing the request when a user logs in:   As you can see, the username is being transmitted in cleartext.  The password is hashed with SHA-1. An attacker can now crack the SHA-1 hash (because that's pretty easy nowadays): Additionally, an attacker could use the sniffed hash to download the stored contacts from the server directly. As described later, the attacker can also access transmitted contact data. Vulnerability type: Plaintext data tran...

[Read more](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html "Auditing NQ Contacts Backup & Restore 1.1")

### [Auditing the Oral-B App (v5.0.0)](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html)

[January 08, 2018](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiJqORraqY6YwfmeNNNuWwnlymIF1_F0kd4RQNVLDbkisIjETDQ7jw5byRpNRsdNOZPTpypeDPigncT54GwDtMdMiYgiz9N0DCi8PTk7MSWWV86uQ0_XzZMRTS5sOnj7-u3yF5dy0CBnCw6/s1600/keys.png)](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html)

Upon quickly assessing the Oral-B app (com.pg.oralb.oralbapp), the following findings have been made: Hardcoded AES parameters (CVE-2018-5298) and twitter keys These parameters are stored in the class OralBApplication and also get used there: Using the twitter secrets, it's possible to create bearer tokens impersonating the Oral-B twitter application. The secrets stored in the app are application tokens only - in my tests it was not possible to authenticate in user context. The stored AES parameters are used to encrypt and decrypt the locally stored shared preferences in the class called Preferences : Because of the static key, an attacker can gain access to user data more easily by leveraging access to the preferences XML file. Tracking Upon running the app, the user automatically gets tracked. There is no opt-in required, it's enabled by default. As you can see, third party advertising providers are allowed to gain access to the us...

[Read more](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html "Auditing the Oral-B App (v5.0.0)")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Terraxplorer](http://www.istockphoto.com/file_closeup.php?id=4502756&platform=blogger)

[Banana Joe](https://www.blogger.com/profile/07123599309238725850)

[Visit profile](https://www.blogger.com/profile/07123599309238725850)

### Archive

* [January 20181](https://1337sec.blogspot.com/2018/01/)
* [October 20172](https://1337sec.blogspot.com/2017/10/)

### [Report Abuse](https://www.blogger.com/go/report-abuse)


