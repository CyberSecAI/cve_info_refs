```
{
  "Root cause": "Race condition in the Charles Proxy Settings suid binary.",
  "Weaknesses/vulnerabilities": [
    "The Charles Proxy Settings binary uses a simple API call to get its path at invocation time, and doesn't validate this path before re-setting its root+suid permissions using the --self-repair option. This creates a race condition.",
        "The binary uses a simple API call to get its path at the time it was invoked and does not validate it before setting the root+suid permissions."
  ],
  "Impact of exploitation": "Local privilege escalation to root.",
  "Attack vectors": "Local exploitation by replacing the original Charles Proxy Settings binary with a malicious payload.",
  "Required attacker capabilities/position": "Local user access on macOS system where Charles Proxy is installed. Ability to execute commands as the local user."
}
```