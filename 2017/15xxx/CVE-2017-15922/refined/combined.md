=== Content from lists.gnu.org_78a8979c_20250125_004716.html ===


| | **bug-libextractor** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-libextractor)

---

[[Date Prev](msg00007.html)][[Date Next](msg00009.html)][[Thread Prev](msg00006.html)][[Thread Next](msg00009.html)][[Date Index](index.html#00008)][[Thread Index](threads.html#00008)]

## [bug-libextractor] An Out-of-bounds Read vulnerability in dvi\_extractor.

---

| **From**: | Leon Zhao |
| --- | --- |

| **Subject**: | [bug-libextractor] An Out-of-bounds Read vulnerability in dvi\_extractor.c |
| **Date**: | Tue, 17 Oct 2017 10:11:25 +0800 |

---

**Tested Version:**v1.4
**Details:**In EXTRACTOR\_dvi\_extract\_method function, it read pos from file, so a crafted file can set pos to an invalid value, and it trigger a crash in the codeÃ‚Â 213Ã‚Â  Ã‚Â if (data[pos] != 248)
**Vulnerability Code:**208Ã‚Â  Ã‚Â opos = pos;209Ã‚Â  Ã‚Â pos = getIntAt (&data[opos + 1]);210Ã‚Â  Ã‚Â if (pos + 25 > size)211Ã‚Â  Ã‚Â  Ã‚Â goto CLEANUP;212Ã‚Â  Ã‚Â /\* assert pos at 'post' command \*/213Ã‚Â  Ã‚Â if (data[pos] != 248)214Ã‚Â  Ã‚Â  Ã‚Â goto CLEANUP;
**Crash Information:**gdb and backtrace(gdb) run -i extract-dvi\_extract\_method-dvi\_extractor-213.crashStarting program: /opt/asan/bin/extract -i extract-dvi\_extract\_method-dvi\_extractor-213.crash[Thread debugging using libthread\_db enabled]Using host libthread\_db library "/lib/x86\_64-linux-gnu/libthread\_db.so.1".Keywords for file extract-dvi\_extract\_method-dvi\_extractor-213.crash:
Breakpoint 1, EXTRACTOR\_dvi\_extract\_method (ec=0x7fffffffa050) at dvi\_extractor.c:208208Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â opos = pos;(gdb) n209Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â pos = getIntAt (&data[opos + 1]);(gdb) sgetIntAt (data="" at dvi\_extractor.c:131131Ã‚Â  Ã‚Â  Ã‚Â {(gdb) n134Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â memcpy (&p, data, 4);Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  /\* ensure alignment! \*/(gdb) n135Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â return ntohl (p);(gdb) p (int)p$1 = -1(gdb) n131Ã‚Â  Ã‚Â  Ã‚Â {(gdb)Ã‚Â 136Ã‚Â  Ã‚Â  Ã‚Â }(gdb)Ã‚Â EXTRACTOR\_dvi\_extract\_method (ec=0x7fffffffa050) at dvi\_extractor.c:210210Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â if (pos + 25 > size)(gdb)Ã‚Â 213Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â if (data[pos] != 248)(gdb) p pos$2 = 4294967295(gdb)Ã‚
Program received signal SIGSEGV, Segmentation fault.0x00007ffff243acdf in EXTRACTOR\_dvi\_extract\_method (ec=0x7fffffffa050) at dvi\_extractor.c:213213Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â if (data[pos] != 248)(gdb)Ã‚
**CREDIT**Zhao Liang, Huawei Weiran Labs
Attachment is POC file

**[![Attachment:](/icons/binary.png)](binhB13qfkFaf.bin)
[extract-dvi\_extract\_method-dvi\_extractor-213.crash](binhB13qfkFaf.bin)**

*Description:* Binary data

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [[Next in Thread](msg00009.html)] |
| --- | --- | --- |

* **[bug-libextractor] An Out-of-bounds Read vulnerability in dvi\_extractor.c**,
  *Leon Zhao*Â **<=**
  + **[Re: [bug-libextractor] An Out-of-bounds Read vulnerability in dvi\_extractor.c](msg00009.html)**, *Christian Grothoff*, 2017/10/19

---

* Prev by Date:
  **[Re: [bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_nsf\_extract\_method](msg00007.html)**
* Next by Date:
  **[Re: [bug-libextractor] An Out-of-bounds Read vulnerability in dvi\_extractor.c](msg00009.html)**
* Previous by thread:
  **[[bug-libextractor] A heap-buffer-overflow vulneribility in png\_extractor.c](msg00006.html)**
* Next by thread:
  **[Re: [bug-libextractor] An Out-of-bounds Read vulnerability in dvi\_extractor.c](msg00009.html)**
* Index(es):
  + [**Date**](index.html#00008)
  + [**Thread**](threads.html#00008)



=== Content from lists.debian.org_4cac3901_20250125_004716.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DLA 1198-1] libextractor security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1198-1] libextractor security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Mon, 4 Dec 2017 22:04:57 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/5540790f-28bb-bf14-7515-d9752d71f89f%40debian.org)Â [5540790f-28bb-bf14-7515-d9752d71f89f@debian.org](msg00000.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : libextractor
Version        : 1:0.6.3-5+deb7u1
CVE ID         : CVE-2017-15266 CVE-2017-15267 CVE-2017-15600
                 CVE-2017-15601 CVE-2017-15602 CVE-2017-15922
Debian Bug     : 878314 880016

Leon Zhao discovered several security vulnerabilities in libextractor,
a universal library and command-line tool to obtain meta-data about
files. NULL Pointer Dereferences, heap-based buffer overflows, integer
signedness errors and out-of-bounds read may lead to a denial-of-service
(application crash) or have other unspecified impact.

For Debian 7 "Wheezy", these problems have been fixed in version
1:0.6.3-5+deb7u1.

We recommend that you upgrade your libextractor packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEErPPQiO8y7e9qGoNf2a0UuVE7UeQFAloluHlfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEFD
RjNEMDg4RUYzMkVERUY2QTFBODM1RkQ5QUQxNEI5NTEzQjUxRTQACgkQ2a0UuVE7
UeQ4dBAAmeb7pnWQuvp9PWpcaQAGPJeSucEAg+ukXTLVptzUh6/2LQ3H09Hnbk3j
+ZY8JDK6mxB6ouZdi95Fn7yT5mr8K2dcZv1AkBk1FyAe72vX0WIyNra9r4xDBo9q
Cv6YtCvap6bXo2abRobzNQRzMqFiNZMecCEKnNP99LMOokcUV38pj43w+EekZ7v7
x28IgkE9DBol7eDJJinCXzkvm1lbeSzunSJ9kP0wLFznPDDM4aJ3hsKd7Va3s1Cx
LBsethyFv1NnBDGo/h9L/hYuNfwTdUiGk9IDru/878yjpwIrCF9p1JmIDfc2ckkd
l9Zrd7XvR/lCkGzGcoCt8U7Knv0buvfFMW5AVxIeETE7Gb37pnmHYYd5uYyRhbZi
MJsVqM/2halY6MiCoVs8M2QOUls0y/+0uo188WhqNaXBpgTPrvuJtXqlAew4r6Uj
VsbWmUHSI8wh/XP1Wmkw3pQKjdkD/pmxozHtwkd66XdtsaTUL0Q8eIBFtLOjuqXM
8yomOzezbKS7J6fTHMYhbMFMyd4Oqkwpyzk8aQ83NJWOumI3lRF47InidWWg7zQY
SOo764tBoH7tABWooctV19ofDUCos7JUjkSpCRtqnurOjJS3qHDpR3rQRit5t23x
DdgrP74HjpW/jpYsXEtisbpTPbJLl9PowOndU/O8QrArFm6dFl8=
=EVir
-----END PGP SIGNATURE-----

```

---


