=== Content from lists.gnu.org_063d75ec_20250125_163909.html ===


| | **bug-libextractor** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-libextractor)

---

[[Date Prev](msg00004.html)][[Date Next](msg00006.html)][[Thread Prev](msg00004.html)][[Thread Next](msg00006.html)][[Date Index](index.html#00005)][[Thread Index](threads.html#00005)]

## [bug-libextractor] An infinite loop in nsfe\_extractor.c caused by negati

---

| **From**: | Leon Zhao |
| --- | --- |

| **Subject**: | [bug-libextractor] An infinite loop in nsfe\_extractor.c caused by negative chunksize |
| **Date**: | Fri, 13 Oct 2017 14:46:49 +0800 |

---

**Tested Version:**v1.4
**Details:**In EXTRACTOR\_nsfe\_extract\_method function, it read chunksize from file, so a crafted file can set chunksize to -8, this make the code falls into an infinite loop.

**Vulnerability Code:**365Ã‚Â  Ã‚Â while (0 == ret)366Ã‚Â  Ã‚Â  Ã‚Â {367Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â if (off != ec->seek (ec->cls,368Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  off,369Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  SEEK\_SET))370Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â break;371Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â if (8 >372Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â ec->read (ec->cls,373Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â &data,374Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â 8))375Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â break;376Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â chunksize = nsfeuint (data);377Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â off += 8 + chunksize;378Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â if (0 == memcmp (data + 4, "INFO", 4))379Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â ret = info\_extract (ec, chunksize);380Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â else if (0 == memcmp (data + 4, "auth", 4))381Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â ret = auth\_extract (ec, chunksize);382Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â else if (0 == memcmp (data + 4, "tlbl", 4))383Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â ret = tlbl\_extract (ec, chunksize);384Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â /\* Ignored chunks: DATA, NEND, plst, time, fade, BANK \*/385Ã‚Â  Ã‚Â  Ã‚Â }
**Crash Information:**gdb and backtrace(gdb) run -i extract-nsfe\_extract\_method-nsfe\_extractor-376.loopÃ‚Â Starting program: /opt/asan/bin/extract -i extract-nsfe\_extract\_method-nsfe\_extractor-376.loop[Thread debugging using libthread\_db enabled]Using host libthread\_db library "/lib/x86\_64-linux-gnu/libthread\_db.so.1".Keywords for file extract-nsfe\_extract\_method-nsfe\_extractor-376.loop:mimetype - audio/x-nsfebroadcast television system - PALsong count - 2starting song - 0^CProgram received signal SIGINT, Interrupt.EXTRACTOR\_nsfe\_extract\_method (ec=0x7fffffffa050) at nsfe\_extractor.c:367367Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â if (off != ec->seek (ec->cls,(gdb) b nsfe\_extractor.c:376Breakpoint 1 at 0x7ffff181db5e: file nsfe\_extractor.c, line 376.(gdb) cContinuing.Breakpoint 1, EXTRACTOR\_nsfe\_extract\_method (ec=0x7fffffffa050) at nsfe\_extractor.c:376376Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â chunksize = nsfeuint (data);(gdb) x/d data0x7fffffffa0d0: -8(gdb) p (int)chunksize$4 = -8(gdb) p off$5 = 22(gdb) n377Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â off += 8 + chunksize;(gdb) p off$6 = 22(gdb)Ã‚
**CREDIT**Zhao Liang, Huawei Weiran Labs
Attachment is POC file

**[![Attachment:](/icons/binary.png)](bin_6iRW3tXve.bin)
[extract-nsfe\_extract\_method-nsfe\_extractor-376.loop](bin_6iRW3tXve.bin)**

*Description:* Binary data

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[bug-libextractor] An infinite loop in nsfe\_extractor.c caused by negative chunksize**,
  *Leon Zhao*Â **<=**

---

* Prev by Date:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_nsf\_extract\_method](msg00004.html)**
* Next by Date:
  **[[bug-libextractor] A heap-buffer-overflow vulneribility in png\_extractor.c](msg00006.html)**
* Previous by thread:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_nsf\_extract\_method](msg00004.html)**
* Next by thread:
  **[[bug-libextractor] A heap-buffer-overflow vulneribility in png\_extractor.c](msg00006.html)**
* Index(es):
  + [**Date**](index.html#00005)
  + [**Thread**](threads.html#00005)



=== Content from lists.debian.org_4cac3901_20250125_163923.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DLA 1198-1] libextractor security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1198-1] libextractor security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Mon, 4 Dec 2017 22:04:57 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/5540790f-28bb-bf14-7515-d9752d71f89f%40debian.org)Â [5540790f-28bb-bf14-7515-d9752d71f89f@debian.org](msg00000.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : libextractor
Version        : 1:0.6.3-5+deb7u1
CVE ID         : CVE-2017-15266 CVE-2017-15267 CVE-2017-15600
                 CVE-2017-15601 CVE-2017-15602 CVE-2017-15922
Debian Bug     : 878314 880016

Leon Zhao discovered several security vulnerabilities in libextractor,
a universal library and command-line tool to obtain meta-data about
files. NULL Pointer Dereferences, heap-based buffer overflows, integer
signedness errors and out-of-bounds read may lead to a denial-of-service
(application crash) or have other unspecified impact.

For Debian 7 "Wheezy", these problems have been fixed in version
1:0.6.3-5+deb7u1.

We recommend that you upgrade your libextractor packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEErPPQiO8y7e9qGoNf2a0UuVE7UeQFAloluHlfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEFD
RjNEMDg4RUYzMkVERUY2QTFBODM1RkQ5QUQxNEI5NTEzQjUxRTQACgkQ2a0UuVE7
UeQ4dBAAmeb7pnWQuvp9PWpcaQAGPJeSucEAg+ukXTLVptzUh6/2LQ3H09Hnbk3j
+ZY8JDK6mxB6ouZdi95Fn7yT5mr8K2dcZv1AkBk1FyAe72vX0WIyNra9r4xDBo9q
Cv6YtCvap6bXo2abRobzNQRzMqFiNZMecCEKnNP99LMOokcUV38pj43w+EekZ7v7
x28IgkE9DBol7eDJJinCXzkvm1lbeSzunSJ9kP0wLFznPDDM4aJ3hsKd7Va3s1Cx
LBsethyFv1NnBDGo/h9L/hYuNfwTdUiGk9IDru/878yjpwIrCF9p1JmIDfc2ckkd
l9Zrd7XvR/lCkGzGcoCt8U7Knv0buvfFMW5AVxIeETE7Gb37pnmHYYd5uYyRhbZi
MJsVqM/2halY6MiCoVs8M2QOUls0y/+0uo188WhqNaXBpgTPrvuJtXqlAew4r6Uj
VsbWmUHSI8wh/XP1Wmkw3pQKjdkD/pmxozHtwkd66XdtsaTUL0Q8eIBFtLOjuqXM
8yomOzezbKS7J6fTHMYhbMFMyd4Oqkwpyzk8aQ83NJWOumI3lRF47InidWWg7zQY
SOo764tBoH7tABWooctV19ofDUCos7JUjkSpCRtqnurOjJS3qHDpR3rQRit5t23x
DdgrP74HjpW/jpYsXEtisbpTPbJLl9PowOndU/O8QrArFm6dFl8=
=EVir
-----END PGP SIGNATURE-----

```

---


