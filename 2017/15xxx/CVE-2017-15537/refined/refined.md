```
{
  "CVE_data_meta": {
    "ID": "CVE-2017-15537",
    "ASSIGNER": "cve@mitre.org"
  },
  "affects": {
    "vendor": {
      "vendor_data": []
    }
  },
  "problemtype": {
    "problemtype_data": [
      {
        "description": [
          {
            "lang": "en",
            "value": "CWE-20"
          }
        ]
      }
    ]
  },
  "references": {
    "reference_data": [
      {
        "url": "https://android.googlesource.com/platform/frameworks/base/+/93d77b07c34077b6c403c459b7bb75933446a502",
        "name": "https://android.googlesource.com/platform/frameworks/base/+/93d77b07c34077b6c403c459b7bb75933446a502",
        "refsource": "MISC",
         "tags": []
      },
      {
        "url":"https://android.googlesource.com/platform/frameworks/base/+/395e162a0bf21c7e67923b9ae5fc9aded2d128a7",
        "name":"https://android.googlesource.com/platform/frameworks/base/+/395e162a0bf21c7e67923b9ae5fc9aded2d128a7",
        "refsource":"MISC",
         "tags": []
      },
      {
        "url":"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=814fb7bb7db5433757d76f4c4502c96fc53b0b5e",
        "name":"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=814fb7bb7db5433757d76f4c4502c96fc53b0b5e",
        "refsource":"MISC",
         "tags": []
      },
       {
         "url":"https://github.com/torvalds/linux/commit/814fb7bb7db5433757d76f4c4502c96fc53b0b5e",
         "name":"https://github.com/torvalds/linux/commit/814fb7bb7db5433757d76f4c4502c96fc53b0b5e",
         "refsource":"MISC",
          "tags": []
       },
      {
        "url": "https://source.android.com/security/bulletin/pixel/2018-01-01",
        "name": "https://source.android.com/security/bulletin/pixel/2018-01-01",
        "refsource": "MISC",
         "tags": []
      },
         {
        "url":"https://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.13.5",
        "name":"https://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.13.5",
        "refsource":"MISC",
        "tags":[]
      }
    ]
  },
  "description": {
    "description_data": [
      {
        "lang": "en",
        "value": "In the Linux kernel, when using the uncompacted xstate format, it was possible for userspace to set the xcomp_bv field in the xstate_header to an arbitrary value. However, all bits in that field are reserved in the uncompacted case, so when switching to a task with nonzero xcomp_bv, the XRSTOR instruction failed with a #GP fault. This caused the WARN_ON_FPU(err) in copy_kernel_to_xregs() to be hit. In addition, since the error is otherwise ignored, the FPU registers from the task previously executing on the CPU were leaked. Fix the bug by checking that the user-supplied value of xcomp_bv is 0 in the uncompacted case, and returning an error otherwise."
      }
    ]
  },
   "impact": {
    "cvss": {
        "vectorString": "AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
        "attackComplexity": "LOW",
        "baseScore": 3.3,
        "baseSeverity": "LOW",
        "attackVector": "LOCAL",
        "availabilityImpact": "NONE",
        "confidentialityImpact": "LOW",
        "integrityImpact": "NONE",
        "privilegesRequired": "LOW",
        "scope": "UNCHANGED",
        "userInteraction": "NONE",
        "version": "3.1"
      }
  },
  "exploit": {
    "attack_vector": "local",
    "attacker_capabilities": "low",
    "position": "user space"
  },
  "vulnerability": {
    "root_cause": "The kernel does not properly validate the xcomp_bv field in the xstate_header when using the uncompacted xstate format, allowing userspace to set arbitrary values.",
    "weaknesses": [
      "The kernel trusts user-provided data without proper validation.",
       "The kernel does not return an error when the validation fails, leading to information leak."
    ],
    "impact": "The FPU registers from the previously executed task on the CPU are leaked.",
  "patches": [
      "The kernel is modified to check that the user-supplied value of xcomp_bv is 0 in the uncompacted case and return an error otherwise."
        ]
  }
}
```