=== Content from 1337sec.blogspot.de_195eb8d2_20250125_234222.html ===

[Skip to main content](#main)

### Search This Blog

# [1337 Security](https://1337sec.blogspot.com/)

### Auditing NQ Contacts Backup & Restore 1.1

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[October 29, 2017](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html "permanent link")

[NQ Contacts Backup & Restore](https://play.google.com/store/apps/details?id=com.netqin.contactbackup) is an android app that allows users to backup and restore contact data (as vcard) to/from the remote NQ server. For the audit, the android app was the primary target.

 Note: The app shares its code base with [NQ Mobile Security & Anti Virus](https://play.google.com/store/apps/details?id=com.nqmobile.antivirus20) - hence the odd class names for a simple contact backup app.
## Lack of HTTPS usage

When logging in or transmitting data, the app communicates with the remote server via HTTP. This can be exploited in various ways. One of these is sniffing the request when a user logs in:

 [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiFP3Vt95Odc28i0JCZumQ2CaChZAdn83nZjXU0Diolx3lWR3tNRW6ozgneZ64hbq4HJQgWTlDQpqjDKxKdXGkfFHHOKRRDR4kilaUhMMkISw022_-_pKp2ykq8WjQ_-0fC9re49tVC7O6O/s1600/xml.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiFP3Vt95Odc28i0JCZumQ2CaChZAdn83nZjXU0Diolx3lWR3tNRW6ozgneZ64hbq4HJQgWTlDQpqjDKxKdXGkfFHHOKRRDR4kilaUhMMkISw022_-_pKp2ykq8WjQ_-0fC9re49tVC7O6O/s1600/xml.png)

As you can see, the username is being transmitted in cleartext.  The password is hashed with SHA-1.

An attacker can now crack the SHA-1 hash (because that's pretty easy nowadays):

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgSHvh6SM4yoid83onaRQWFJhHEs53alGv2xVF5FI996LfQ38vHwG1uMKbNs4JTjjNVlsAQ_wJWIjszSefqoi8v0yP6P4UcJSdAhvSWbBUYfJVQibLUlxH-HElgwwRPfnoNCxR6ySpHxVc_/s1600/cracked.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgSHvh6SM4yoid83onaRQWFJhHEs53alGv2xVF5FI996LfQ38vHwG1uMKbNs4JTjjNVlsAQ_wJWIjszSefqoi8v0yP6P4UcJSdAhvSWbBUYfJVQibLUlxH-HElgwwRPfnoNCxR6ySpHxVc_/s1600/cracked.png)

Additionally, an attacker could use the sniffed hash to download the stored contacts from the server directly. As described later, the attacker can also access transmitted contact data.

Vulnerability type: Plaintext data transport

Affected Product Code Base: NQ Contacts Backup & Restore - 1.1

Affected Component: Basically every component executing network action. For the login process: *ContactAccountLogin* and *ContactAccountSwitch*

Impact: Information Disclosure of sensitive data (login data)
## RC4 encryption with static key

The app uses the RC4 stream cipher to encrypt/decrypt password stored in the android shared preferences. The file looks like this:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEghQokVtzO94QEoYfee-_S92Y2MKOYYBdgiGW2pC13KR6WivmiOxrHZJgGlY1uS_HDMjtgrwZ3KPo0eE9uE0qnDIQPt9XZWSTptFpglEkaWA4TVvyotLTRUsZ_GPyVAojNuO0LcDfMuzCnr/s320/sharedPref.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEghQokVtzO94QEoYfee-_S92Y2MKOYYBdgiGW2pC13KR6WivmiOxrHZJgGlY1uS_HDMjtgrwZ3KPo0eE9uE0qnDIQPt9XZWSTptFpglEkaWA4TVvyotLTRUsZ_GPyVAojNuO0LcDfMuzCnr/s1600/sharedPref.png)

The decryption routine, which can be found in *DataUtils*, look as follows:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEign-C58IYk0nI9JxR1PizAIHdeRNX0J2trp7rJIeK-Cl7youR_nJbEYq5-qCWH9_yXDR8vwzqM3DIoWZ2rSsUOQ0JKWYij2tcFeCIFSHrxX-rbWd7lcXmdaPbSOi4YOk-j09PQS1IzqaXL/s1600/decryption.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEign-C58IYk0nI9JxR1PizAIHdeRNX0J2trp7rJIeK-Cl7youR_nJbEYq5-qCWH9_yXDR8vwzqM3DIoWZ2rSsUOQ0JKWYij2tcFeCIFSHrxX-rbWd7lcXmdaPbSOi4YOk-j09PQS1IzqaXL/s1600/decryption.png)

The stored value is base64-decoded and passed to the RC4 algorithm. The first parameter of *decryptForXml* is a static key, as you can see here:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0vI4-xtsfmURR1YCG4zfrd8E9ItWIjzkqhgDDPQSjjE9s8aRCnsRkc_PDOKCnRxMUESDV6TxH20cOtw_FJlQiGBvOXG9UU3FTgwWo0nEvwv5O6xf2JFnLxhVbLwZm7EmluefZLmuD_RkL/s1600/keyusage.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0vI4-xtsfmURR1YCG4zfrd8E9ItWIjzkqhgDDPQSjjE9s8aRCnsRkc_PDOKCnRxMUESDV6TxH20cOtw_FJlQiGBvOXG9UU3FTgwWo0nEvwv5O6xf2JFnLxhVbLwZm7EmluefZLmuD_RkL/s1600/keyusage.png)

Using this knowledge, it's easy to decrypt the stored password value from the shared preferences XML file:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyZYZVp5W2-zoWTfkiKH00Xlitsva7oyjaDO48DCzZ1HrXpNNpOdclxMS2OIr_dodD9Prt2CP_UajmaMG0XxgJcuVXCPz1IqqgWSR8Yijy2C5qh-aWeRNSQ83xf2LKr6YnP24sZSj1MhsQ/s1600/sharedprefs-decrypt.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyZYZVp5W2-zoWTfkiKH00Xlitsva7oyjaDO48DCzZ1HrXpNNpOdclxMS2OIr_dodD9Prt2CP_UajmaMG0XxgJcuVXCPz1IqqgWSR8Yijy2C5qh-aWeRNSQ83xf2LKr6YnP24sZSj1MhsQ/s1600/sharedprefs-decrypt.png)

 This makes it easier for an attacker to decrypt login data of users.

Vulnerability type: Usage of a static encryption key

Affected Product Code Base: NQ Contacts Backup & Restore - 1.1

Affected Component: *NetQinSharedPreferences*

Impact: Information Disclosure of login data
## DES encryption with static key

When syncing user data (e.g. contacts as vcards), the app uses DES encrypted zip files, as you can see in the class *ServerBackupDoing$7* :

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiqFW2ikFsBo3Q1bmqXabJXlj2aW_kcBi8u3CT9_Ee9ITLYV9e6DqWQaofvIaF5X84gWHvt4LMI9fSJdgFBQY7CMy5NhVM9lHQB5Y8jrZJXGp3bKqLLj10t2wyXI85lrqf8gxXQe0rd8UL0/s1600/encryptAndSync.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiqFW2ikFsBo3Q1bmqXabJXlj2aW_kcBi8u3CT9_Ee9ITLYV9e6DqWQaofvIaF5X84gWHvt4LMI9fSJdgFBQY7CMy5NhVM9lHQB5Y8jrZJXGp3bKqLLj10t2wyXI85lrqf8gxXQe0rd8UL0/s1600/encryptAndSync.png)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjhQi0CdjdYfior1D1rAFX7a8knr0VF0elv4QW9gnkvXYR_2LcNDONkeX5uBitEhE39bJdqx3J3LlA7pl5O3Czsnc8G6VXIPt3L33RxhawuWnMyBabdt8wdAS0NoEVtFTFNT36LSKSXw53j/s1600/DESusage-only-paths-as-parameter.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjhQi0CdjdYfior1D1rAFX7a8knr0VF0elv4QW9gnkvXYR_2LcNDONkeX5uBitEhE39bJdqx3J3LlA7pl5O3Czsnc8G6VXIPt3L33RxhawuWnMyBabdt8wdAS0NoEVtFTFNT36LSKSXw53j/s1600/DESusage-only-paths-as-parameter.png)

 In the class *DesCript*, there are two static keys:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgC6BZWLdnbgoDJefUwDvMyame2M04Xbqsv5kRyPod4oWq71egicm9J35zoHpfs66pPnIyaW802PACGYZpURTvtCV3hVKb_L1eesuNciP4OJC1d-qYXh67NiHX1sqMNmFVG6mWdbM6ZJ0_3/s1600/DESkeyspec-creation.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgC6BZWLdnbgoDJefUwDvMyame2M04Xbqsv5kRyPod4oWq71egicm9J35zoHpfs66pPnIyaW802PACGYZpURTvtCV3hVKb_L1eesuNciP4OJC1d-qYXh67NiHX1sqMNmFVG6mWdbM6ZJ0_3/s1600/DESkeyspec-creation.png)

The key named *keyByte* is used to create a KeySpec, which represents the key being used to encrypt/decrypt data.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgfiZS1ZgHbuX5uY0xocf86oCuVmhcIP3rP67CUbJKjNCQzQxpvBdQ2PKVlAzEyJi4d7r9kcevdhaJERTo6mXtfZQBiiqHZA57nUGRrSG8nj6ZSXE4DzVVhBGBXDaYEpTpbhdEtO1vIlShm/s1600/DESkeyspec.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgfiZS1ZgHbuX5uY0xocf86oCuVmhcIP3rP67CUbJKjNCQzQxpvBdQ2PKVlAzEyJi4d7r9kcevdhaJERTo6mXtfZQBiiqHZA57nUGRrSG8nj6ZSXE4DzVVhBGBXDaYEpTpbhdEtO1vIlShm/s1600/DESkeyspec.png)

As there is no HTTPS in place, it's therefore possible for an attacker to gain access to sensitive contact data.

Vulnerability type: Usage of a static encryption key

Affected Product Code Base: NQ Contacts Backup & Restore - 1.1

Affected Component: *ServerBackupDoing, DesCript*

Impact: Information Disclosure of user data (contact data)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Popular posts from this blog

### [Auditing WriteDiary.com (CVE-2017-15581 & CVE-2017-15582)](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html)

[October 27, 2017](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhifJa_dgKZjxsj8BHzF7jMXgQXJdxlBXXTNki7w174xonwIA3xlUhK1Z-6q-YDdCYO-E4Ef_yyoDTty58jW1_WwxhhBXNnkv3MAndHRDUMP8ZDNtFdQKfjN_6eJbv95f1bthDn6ENQDYkP/s1600/cleartext_pw.png)](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html)

General note: The developer and owner of both the webapp and android app has been contacted multiple times to develop a quick fix for the issues addressed in this blog post and a vulnerability concerning the webapp which isn't described here. However, no response has been received. WriteDiary consists of a webapp ( WriteDiary.com ) and an android app  (version 4.72). For the audit, the android app was the primary target. CVE-2017-15581 : Lack of HTTPS-usage, lack of user data encryption when transmitting In the "Diary with lock" (aka WriteDiary) application 4.72 for Android, neither HTTPS (check strings.xml for api\_url\_prod :  http ://diary.adpog.com/api2)  nor other encryption is used for transmitting data, despite the documentation that the product is intended for "a personal journal of secrets and feelings," which allows remote attackers to obtain sensitive information by sniffing the network during LoginActivity or NoteActivity execution. ...

[Read more](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html "Auditing WriteDiary.com (CVE-2017-15581 & CVE-2017-15582)")

### [Auditing the Oral-B App (v5.0.0)](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html)

[January 08, 2018](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiJqORraqY6YwfmeNNNuWwnlymIF1_F0kd4RQNVLDbkisIjETDQ7jw5byRpNRsdNOZPTpypeDPigncT54GwDtMdMiYgiz9N0DCi8PTk7MSWWV86uQ0_XzZMRTS5sOnj7-u3yF5dy0CBnCw6/s1600/keys.png)](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html)

Upon quickly assessing the Oral-B app (com.pg.oralb.oralbapp), the following findings have been made: Hardcoded AES parameters (CVE-2018-5298) and twitter keys These parameters are stored in the class OralBApplication and also get used there: Using the twitter secrets, it's possible to create bearer tokens impersonating the Oral-B twitter application. The secrets stored in the app are application tokens only - in my tests it was not possible to authenticate in user context. The stored AES parameters are used to encrypt and decrypt the locally stored shared preferences in the class called Preferences : Because of the static key, an attacker can gain access to user data more easily by leveraging access to the preferences XML file. Tracking Upon running the app, the user automatically gets tracked. There is no opt-in required, it's enabled by default. As you can see, third party advertising providers are allowed to gain access to the us...

[Read more](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html "Auditing the Oral-B App (v5.0.0)")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Terraxplorer](http://www.istockphoto.com/file_closeup.php?id=4502756&platform=blogger)

[Banana Joe](https://www.blogger.com/profile/07123599309238725850)

[Visit profile](https://www.blogger.com/profile/07123599309238725850)

### Archive

* [January 20181](https://1337sec.blogspot.com/2018/01/)
* [October 20172](https://1337sec.blogspot.com/2017/10/)

### [Report Abuse](https://www.blogger.com/go/report-abuse)


