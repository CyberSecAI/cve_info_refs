=== Content from security.gentoo.org_99e432e7_20250125_232154.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# SPICE VDAgent: Arbitrary command injection — GLSA **201804-09**

A vulnerability in SPICE VDAgent could allow local attackers to
execute arbitrary commands.

### Affected packages

| Package | **app-emulation/spice-vdagent** on all architectures |
| --- | --- |
| Affected versions | < **0.17.0\_p20180319** |
| Unaffected versions | >= **0.17.0\_p20180319** |

### Background

Provides a complete open source solution for remote access to virtual
machines in a seamless way so you can play videos, record audio, share
USB devices and share folders without complications.

### Description

SPICE VDAgent does not properly escape save directory before passing to
shell.

### Impact

A local attacker could execute arbitrary commands.

### Workaround

There is no known workaround at this time.

### Resolution

All SPICE VDAgent users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/spice-vdagent-0.17.0_p20180319"

```
### References

* [CVE-2017-15108](https://nvd.nist.gov/vuln/detail/CVE-2017-15108)

**Release date**

April 08, 2018

**Latest revision**

April 08, 2018: 1

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [650020](https://bugs.gentoo.org/show_bug.cgi?id=650020)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from cgit.freedesktop.org_997c8b60_20250125_232152.html ===


| [cgit logo](/) | [index](/) : [spice/linux/vd\_agent](/spice/linux/vd_agent/) | master |
| --- | --- | --- |
| spice agent for linux (mirrored from https://gitlab.freedesktop.org/spice/linux/vd\_agent) | root |

| [summary](/spice/linux/vd_agent/)[refs](/spice/linux/vd_agent/refs/?id=8ba174816d245757e743e636df357910e1d5eb61)[log](/spice/linux/vd_agent/log/)[tree](/spice/linux/vd_agent/tree/?id=8ba174816d245757e743e636df357910e1d5eb61)[commit](/spice/linux/vd_agent/commit/?id=8ba174816d245757e743e636df357910e1d5eb61)[diff](/spice/linux/vd_agent/diff/?id=8ba174816d245757e743e636df357910e1d5eb61) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jonathon Jongsma <jjongsma@redhat.com> | 2017-10-25 10:33:11 -0500 |
| --- | --- | --- |
| committer | Jonathon Jongsma <jjongsma@redhat.com> | 2017-11-16 11:14:41 -0600 |
| commit | [8ba174816d245757e743e636df357910e1d5eb61](/spice/linux/vd_agent/commit/?id=8ba174816d245757e743e636df357910e1d5eb61) ([patch](/spice/linux/vd_agent/patch/?id=8ba174816d245757e743e636df357910e1d5eb61)) | |
| tree | [03f447728dcebf298d07ec499bcb79c198b1b1cb](/spice/linux/vd_agent/tree/?id=8ba174816d245757e743e636df357910e1d5eb61) | |
| parent | [e5bfb1be15fce334a38268daa8d5f7765b680209](/spice/linux/vd_agent/commit/?id=e5bfb1be15fce334a38268daa8d5f7765b680209) ([diff](/spice/linux/vd_agent/diff/?id=8ba174816d245757e743e636df357910e1d5eb61&id2=e5bfb1be15fce334a38268daa8d5f7765b680209)) | |

Quote the save directory before passing to shellThanks to a report from Seth Arnold <seth.arnold@canonial.com>:
- vdagent\_file\_xfers\_data() does not escape xfers->save\_dir before giving
it to the shell
- vdagent\_file\_xfers\_data() does not check snprintf() return code; a
too-long xfers->save\_dir could cause the & or ' or any number of other
characters to go missing.
To fix these issues, we use g\_spawn\_async(). This avoids the need to
quote the filename and also avoids the snprintf issue.
In the case that the spawn fails, we also print a warning to the syslog
now.
Signed-off-by: Jonathon Jongsma <jjongsma@redhat.com>
Acked-by: Frediano Ziglio <fziglio@redhat.com>
[Diffstat](/spice/linux/vd_agent/diff/?id=8ba174816d245757e743e636df357910e1d5eb61)

| -rw-r--r-- | [src/vdagent/file-xfers.c](/spice/linux/vd_agent/diff/src/vdagent/file-xfers.c?id=8ba174816d245757e743e636df357910e1d5eb61) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 10 insertions, 3 deletions

| diff --git a/src/vdagent/file-xfers.c b/src/vdagent/file-xfers.cindex 4d76003..6461d05 100644--- a/[src/vdagent/file-xfers.c](/spice/linux/vd_agent/tree/src/vdagent/file-xfers.c?id=e5bfb1be15fce334a38268daa8d5f7765b680209)+++ b/[src/vdagent/file-xfers.c](/spice/linux/vd_agent/tree/src/vdagent/file-xfers.c?id=8ba174816d245757e743e636df357910e1d5eb61)@@ -336,9 +336,16 @@ void vdagent\_file\_xfers\_data(struct vdagent\_file\_xfers \*xfers, if (xfers->open\_save\_dir && task->file\_xfer\_nr == task->file\_xfer\_total && g\_hash\_table\_size(xfers->xfers) == 1) {- char buf[PATH\_MAX];- snprintf(buf, PATH\_MAX, "xdg-open '%s'&", xfers->save\_dir);- status = system(buf);+ GError \*error = NULL;+ gchar \*argv[] = { "xdg-open", xfers->save\_dir, NULL };+ if (!g\_spawn\_async(NULL, argv, NULL,+ G\_SPAWN\_SEARCH\_PATH,+ NULL, NULL, NULL, &error)) {+ syslog(LOG\_WARNING,+ "file-xfer: failed to open save directory: %s",+ error->message);+ g\_error\_free(error);+ } } status = VD\_AGENT\_FILE\_XFER\_STATUS\_SUCCESS; } else { |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.39.1](https://git-scm.com/)) at 2025-01-25 23:21:51 +0000



=== Content from wiki.debian.org_8d48714b_20250126_124443.html ===

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")

[Wiki](/FrontPage "Debian Wiki Homepage")

[Login](/LTS?action=login)

* [FrontPage](/FrontPage)
* [RecentChanges](/RecentChanges)
* [FindPage](/FindPage)
* [HelpContents](/HelpContents)
* [LTS](/LTS)

Search:

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")
[Wiki](/FrontPage "Debian Wiki Homepage")/

* [Login](/LTS?action=login)
* Comments
* [Info](/LTS?action=info)
* [Attachments](/LTS?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  ------------------------
  Load
  Save
  SlideShow

# * [LTS](/LTS)

[Translation(s)](/DebianWiki/EditorGuide#translation): [English](/LTS) - [Deutsch](/de/LTS) - [Español](/es/LTS) - [Français](/fr/LTS) - [Italiano](/it/LTS) - [한국어](/ko/LTS) - [Português](/pt/LTS) - [Português (Brasil)](/pt_BR/LTS) - [Русский](/ru/LTS)

# Debian Long Term Support

Debian Long Term Support (LTS) is a project to extend the lifetime of all Debian stable releases to (at least) 5 years. Debian LTS is not handled by the Debian Security and Release teams, but by a separate group of volunteers and companies interested in making it a success.

Thus the Debian LTS team takes over security maintenance of the various releases once the Debian Security team stops its work.

![/!\](/htdocs/debwiki/img/alert.png "/!\")

LTS ([last modified 2024-08-15 02:46:47](/LTS?action=info))

* Debian [privacy policy](https://www.debian.org/legal/privacy), Wiki [team](/Teams/DebianWiki), [bugs](https://bugs.debian.org/wiki.debian.org) and [config](https://salsa.debian.org/debian/wiki.debian.org).
* Powered by [MoinMoin](https://moinmo.in/ "This site uses the MoinMoin Wiki software.") and [Python](https://moinmo.in/Python "MoinMoin is written in Python."), with hosting provided by [Metropolitan Area Network Darmstadt](https://www.man-da.de/).



=== Content from bugs.gentoo.org_5b80fb2a_20250126_124442.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 6500
ddd can't be started: Segfault's immediately
Last modified: 2003-02-04 19:42:18 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=6500&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=6500&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 6500**](show_bug.cgi?id=6500)
- ddd can't be started: Segfault's immediately

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
ddd can't be started: Segfault's immediately

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Linux | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Linux "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | [OLD] Development ([show other bugs](buglist.cgi?component=%5BOLD%5D%20Development&product=Gentoo%20Linux&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86 Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Linux bug wranglers | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2002-08-15 03:36 UTC by Klaus Kusche | | --- | --- | | Modified: | 2003-02-04 19:42 UTC ([History](show_activity.cgi?id=6500)) | | CC List: | 1 user (show)  mholzer | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=6500&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=6500&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Klaus Kusche    2002-08-15 03:36:57 UTC  ``` When startig ddd, it immediately reports two Segmentation faults and terminates (no matter whether started with "ddd program" or just "ddd").  .ddd/log just contains the header with all the versions, the calling command line, and two lines "!  Segmentation fault", nothing else. No core produced.  This is on an up-to-date gentoo system (gcc-3.1 only). ```  [Comment 1](#c1)  Seemant Kulleen (RETIRED)   gentoo-dev  2002-08-16 04:35:04 UTC  ``` can you enclose an strace? ```  [Comment 2](#c2)  Klaus Kusche    2002-08-16 05:35:29 UTC  ``` Works today. Must have been some kind of Shared Lib mess:  When the bug occurred, I had both gcc 3.1 and gcc 3.1.1 (and their lib's) on my system. Yesterday evening, I did an "emerge clean world" plus ldconfig, and since then, the problem seems to be gone. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=6500)
* - [XML](show_bug.cgi?ctype=xml&id=6500)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=6500)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=6500&product=Gentoo%20Linux)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=6500&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=6500&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from lists.debian.org_7d61cb91_20250125_232153.html ===


---

[[Date Prev](msg00011.html)][[Date Next](msg00013.html)]
[[Thread Prev](msg00011.html)][[Thread Next](msg00013.html)]
[[Date Index](maillist.html#00012)]
[[Thread Index](threads.html#00012)]

# [SECURITY] [DLA 2524-1] spice-vdagent security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2524-1] spice-vdagent security update
* *From*: Abhijith PA <abhijith@debian.org>
* *Date*: Wed, 13 Jan 2021 13:42:57 +0530
* *Message-id*: <X/6riemICR0GMxdh@Adebian>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2524-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Abhijith PA
January 13, 2021                              <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : spice-vdagent
Version        : 0.17.0-1+deb9u1
CVE ID         : CVE-2017-15108 CVE-2020-25650 CVE-2020-25651 CVE-2020-25652
                 CVE-2020-25653
Debian Bug     : 883238 973769

Several vulnerabilities were discovered in spice-vdagent, a spice
guest agent for enchancing SPICE integeration and experience.

CVE-2017-15108

    spice-vdagent does not properly escape save directory before
    passing to shell, allowing local attacker with access to the
    session the agent runs in to inject arbitrary commands to be
    executed.

CVE-2020-25650

    A flaw was found in the way the spice-vdagentd daemon handled file
    transfers from the host system to the virtual machine. Any
    unprivileged local guest user with access to the UNIX domain
    socket path `/run/spice-vdagentd/spice-vdagent-sock` could use
    this flaw to perform a memory denial of service for spice-vdagentd
    or even other processes in the VM system. The highest threat from
    this vulnerability is to system availability. This flaw affects
    spice-vdagent versions 0.20 and previous versions.

CVE-2020-25651

    A flaw was found in the SPICE file transfer protocol. File data
    from the host system can end up in full or in parts in the client
    connection of an illegitimate local user in the VM system. Active
    file transfers from other users could also be interrupted,
    resulting in a denial of service. The highest threat from this
    vulnerability is to data confidentiality as well as system
    availability.

CVE-2020-25652

    A flaw was found in the spice-vdagentd daemon, where it did not
    properly handle client connections that can be established via the
    UNIX domain socket in `/run/spice-vdagentd/spice-vdagent-sock`.
    Any unprivileged local guest user could use this flaw to prevent
    legitimate agents from connecting to the spice-vdagentd daemon,
    resulting in a denial of service. The highest threat from this
    vulnerability is to system availability.

CVE-2020-25653

    A race condition vulnerability was found in the way the
    spice-vdagentd daemon handled new client connections. This flaw
    may allow an unprivileged local guest user to become the active
    agent for spice-vdagentd, possibly resulting in a denial of
    service or information leakage from the host. The highest threat
    from this vulnerability is to data confidentiality as well as
    system availability.

For Debian 9 stretch, these problems have been fixed in version
0.17.0-1+deb9u1.

We recommend that you upgrade your spice-vdagent packages.

For the detailed security status of spice-vdagent please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/spice-vdagent>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpqcDRSTHKWo.pgp)**

*Description:* PGP signature

---


