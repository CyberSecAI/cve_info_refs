=== Content from security.gentoo.org_d19a24fe_20250125_184641.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple vulnerabilities — GLSA **201801-14**

Multiple vulnerabilities have been found in Xen, the worst of which
could allow for privilege escalation.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.9.1-r1** |
| Unaffected versions | >= **4.9.1-r1** |

| Package | **app-emulation/xen-tools** on all architectures |
| --- | --- |
| Affected versions | < **4.9.1-r1** |
| Unaffected versions | >= **4.9.1-r1** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the
referenced CVE identifiers for details.

### Impact

A local attacker could potentially execute arbitrary code with the
privileges of the Xen (QEMU) process on the host, gain privileges on the
host system, or cause a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.9.1-r1"

```

All Xen tools users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/xen-tools-4.9.1-r1"

```
### References

* [CVE-2017-12134](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-12134)
* [CVE-2017-12135](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-12135)
* [CVE-2017-12136](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-12136)
* [CVE-2017-12137](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-12137)
* [CVE-2017-15588](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-15588)
* [CVE-2017-15589](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-15589)
* [CVE-2017-15590](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-15590)
* [CVE-2017-15591](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-15591)
* [CVE-2017-15592](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-15592)
* [CVE-2017-15593](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-15593)
* [CVE-2017-15594](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-15594)
* [CVE-2017-15595](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-15595)
* [CVE-2017-17044](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-17044)
* [CVE-2017-17045](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-17045)
* [CVE-2017-17046](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-17046)
* [CVE-2017-17563](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-17563)
* [CVE-2017-17564](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-17564)
* [CVE-2017-17565](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-17565)
* [CVE-2017-17566](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-17566)

**Release date**

January 14, 2018

**Latest revision**

January 14, 2018: 1

**Severity**

high

**Exploitable**

local

**Bugzilla entries**

* [627962](https://bugs.gentoo.org/show_bug.cgi?id=627962)
* [634668](https://bugs.gentoo.org/show_bug.cgi?id=634668)
* [637540](https://bugs.gentoo.org/show_bug.cgi?id=637540)
* [637542](https://bugs.gentoo.org/show_bug.cgi?id=637542)
* [639688](https://bugs.gentoo.org/show_bug.cgi?id=639688)
* [641566](https://bugs.gentoo.org/show_bug.cgi?id=641566)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from xenbits.xen.org_9427ba33_20250125_184641.html ===

# Information

| Advisory | [XSA-238](advisory-238.html) |
| --- | --- |
| Public release | 2017-10-12 12:00 |
| Updated | 2017-12-06 10:59 |
| Version | 3 |
| CVE(s) | [CVE-2017-15591](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15591) |
| Title | DMOP map/unmap missing argument checks |

# Files

<advisory-238.txt> (signed advisory file)

<xsa238.meta>

<xsa238.patch>

<xsa238-4.5.patch>

<xsa238-4.6.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2017-15591 / XSA-238
                              version 3

                DMOP map/unmap missing argument checks

UPDATES IN VERSION 3
====================

CVE assigned.

ISSUE DESCRIPTION
=================

DMOPs (which were a subgroup of HVMOPs in older releases) allow guests
to control and drive other guests.  The I/O request server page mapping
interface uses range sets to represent I/O resources the emulation of
which is provided by a given I/O request server.  The internals of the
range set implementation require that ranges have a starting value no
lower than the ending one.  Checks for this fact were missing.

IMPACT
======

Malicious or buggy stub domain kernels or tool stacks otherwise living
outside of Domain0 can mount a denial of service attack which, if
successful, can affect the whole system.

Only domains controlling HVM guests can exploit this vulnerability.
(This includes domains providing hardware emulation services to HVM
guests.)

VULNERABLE SYSTEMS
==================

Xen versions 4.5 and later are vulnerable.  Xen versions 4.4 and
earlier are not vulnerable.

Only x86 systems are affected.  ARM systems are not affected.

This vulnerability is only applicable to Xen systems using stub domains
or other forms of disaggregation of control domains for HVM guests.

MITIGATION
==========

Running only PV guests will avoid this issue.

(The security of a Xen system using stub domains is still better than
with a qemu-dm running as an unrestricted dom0 process.  Therefore
users with these configurations should not switch to an unrestricted
dom0 qemu-dm.)

CREDITS
=======

This issue was discovered by Vitaly Kuznetsov of RedHat.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa238.patch           xen-unstable, Xen 4.9.x, Xen 4.8.x, Xen 4.7.x
xsa238-4.6.patch       Xen 4.6.x
xsa238-4.5.patch       Xen 4.5.x

$ sha256sum xsa238*
[93cc1da4a0ab27f857f2ad39c38f112ef101a01bc5d386807d27371f83526831  xsa238.meta](xsa238.meta)
[85d3f9713bef1bc86c682857dbd7388a1d1f20089363ddfc4cb9ecbd88eaffec  xsa238.patch](xsa238.patch)
[034e91c234f6831dbaa1aaf29f4f90de2e822f99301424f7f3527f9da883ff68  xsa238-4.5.patch](xsa238-4.5.patch)
[29255a81729b24866e594426167de5fbef70de21ef62a95ba95de191d2a7fd54  xsa238-4.6.patch](xsa238-4.6.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJaJ82OAAoJEIP+FMlX6CvZcU0IAMkUqTbbTWIWAruO03YSxFvn
bqmfyzgyUVHUMLzhjrukaqVxZYcxV5FbY/IMWEZY/oET9wHv8iBsMay+cVlsv45i
GMHZaxGBM9P1xU6AS4GP/oRMb9LA4fU7rjCKcK54zaDV+mdW/2rA+Ac0IVbmn3tF
gcnkfbHk3cF8x91rD4+2ZC7ihE6CIX70PQxdXNbgR8RpoxGdE1q9IPF8ik3gLyO/
OtoDfqrbau+YllhTBI3XxmU+MJgpRf+VRnOgFpYjzp10dfVBM459Lmdzfa6gXhxz
ysm+Js8Y4jpVEIGY3qXAV8/V2ZSL8nNmFiNFPOJZcNu4wkAFZKUlyWBbFlJcvvk=
=keh/
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team

