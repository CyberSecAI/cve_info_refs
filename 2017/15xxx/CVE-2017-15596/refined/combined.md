=== Content from www.debian.org_19a5c40d_20250124_201126.html ===


---

[[Date Prev](msg00230.html)][[Date Next](msg00232.html)]
[[Thread Prev](msg00230.html)][[Thread Next](msg00232.html)]
[[Date Index](maillist.html#00231)]
[[Thread Index](threads.html#00231)]

# [SECURITY] [DSA 3969-1] xen security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3969-1] xen security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Tue, 12 Sep 2017 23:05:56 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20170912210556.nesfevi5v45szrat%40pisco.westfalen.local)Â [20170912210556.nesfevi5v45szrat@pisco.westfalen.local](msg00231.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3969-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
September 12, 2017                    <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : xen
CVE ID         : CVE-2017-10912 CVE-2017-10913 CVE-2017-10914
                 CVE-2017-10915 CVE-2017-10916 CVE-2017-10917
		 CVE-2017-10918 CVE-2017-10919 CVE-2017-10920
		 CVE-2017-10921 CVE-2017-10922 CVE-2017-12135
                 CVE-2017-12136 CVE-2017-12137 CVE-2017-12855

Multiple vulnerabilities have been discovered in the Xen hypervisor:

CVE-2017-10912

    Jann Horn discovered that incorrectly handling of page transfers might
    result in privilege escalation.

CVE-2017-10913 / CVE-2017-10914

    Jann Horn discovered that race conditions in grant handling might
    result in information leaks or privilege escalation.

CVE-2017-10915

    Andrew Cooper discovered that incorrect reference counting with
    shadow paging might result in privilege escalation.

CVE-2017-10916

    Andrew Cooper discovered an information leak in the handling
    of the the Memory Protection Extensions (MPX) and Protection
    Key (PKU) CPU features. This only affects Debian stretch.

CVE-2017-10917

    Ankur Arora discovered a NULL pointer dereference in event
    polling, resulting in denial of service.

CVE-2017-10918

    Julien Grall discovered that incorrect error handling in
    physical-to-machine memory mappings may result in privilege
    escalation, denial of service or an information leak.

CVE-2017-10919

    Julien Grall discovered that that incorrect handling of
    virtual interrupt injection on ARM systems may result in
    denial of service.

CVE-2017-10920 / CVE-2017-10921 / CVE-2017-10922

    Jan Beulich discovered multiple places where reference
    counting on grant table operations was incorrect, resulting
    in potential privilege escalation

CVE-2017-12135

    Jan Beulich found multiple problems in the handling of
    transitive grants which could result in denial of service
    and potentially privilege escalation.

CVE-2017-12136

    Ian Jackson discovered that race conditions in the allocator
    for grant mappings may result in denial of service or privilege
    escalation. This only affects Debian stretch.

CVE-2017-12137

    Andrew Cooper discovered that incorrect validation of
    grants may result in privilege escalation.

CVE-2017-12855

    Jan Beulich discovered that incorrect grant status handling, thus
    incorrectly informing the guest that the grant is no longer in use.

XSA-235 (no CVE yet)

    Wei Liu discovered that incorrect locking of add-to-physmap
    operations on ARM may result in denial of service.

For the oldstable distribution (jessie), these problems have been fixed
in version 4.4.1-9+deb8u10.

For the stable distribution (stretch), these problems have been fixed in
version 4.8.1-1+deb9u3.

We recommend that you upgrade your xen packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlm4TAgACgkQEMKTtsN8
TjY0fg/+M9abYbzVprbp5JfvELlm0tgfOcgqqbLAzh4j5Fk+KpuOjqCPoGTP9wux
fiuQgej7Vr3REScjSZWZL0kfAIBN/Em79GcNhBEhsXefbEeDbGR4XNkk6RAhie4W
JVkzsq2J0xV1gSiug71G6ujRiiAnuHO6EV5NHqa1Oi9mVQY8BrXl0Vyx4ZLcOI/X
HIajFwrIY5cCm+vyAng1YER31ApHTPUxJ+6oDyCwyCs7pm3Ep2GmyYJQ6mkYZ5JU
remFj8x59/Pt6FDX+Kk4KDb6LPJc5f0hchrYNyrL+Jv/hT0gVdSlqxF40CuAtXUv
qlzI18cdtCSNEJV2K82eDd9iF0UA/L5+SRnxg5zpbaa5pGLGneQQPGfrDqOLXTnM
T0BmVY2QvTp68858dUy7F8uZRt6gRLiZ2heGplt1xYfAeSKhrXhkBAyCBuuryCiT
rjwyHcRKjLd1RPIyeRMYjA8JTrPmwbkhYCTta+WyVA9CdAKBXOeISyKn4bix0jJg
KWYyJhUpmG5fCjKeTEruTmYlnrAX+/BqJPKUt1SFoCDJJ0SYQqCIFudcgcznkRgW
2yfgo3n1lS8gyP4J8Q5aSF5AkpjIoUTe4lYUER9UK9+nKyfT55+HliNkeZy2GIOi
vUSfPoRSFL2hge863SUxZ/fu6or9SttRVIlGqK5Q/BgoGXzNbQg=
=iDjs
-----END PGP SIGNATURE-----

```

---



=== Content from xenbits.xen.org_806b0097_20250124_201126.html ===

# Information

| Advisory | [XSA-235](advisory-235.html) |
| --- | --- |
| Public release | 2017-08-23 15:16 |
| Updated | 2017-10-18 12:08 |
| Version | 2 |
| CVE(s) | [CVE-2017-15596](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15596) |
| Title | add-to-physmap error paths fail to release lock on ARM |

# Files

<advisory-235.txt> (signed advisory file)

<xsa235.meta>

<xsa235.patch>

<xsa235-4.5.patch>

<xsa235-4.6.patch>

<xsa235-4.7.patch>

<xsa235-4.9.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2017-15596 / XSA-235
                              version 2

        add-to-physmap error paths fail to release lock on ARM

UPDATES IN VERSION 2
====================

CVE assigned.

ISSUE DESCRIPTION
=================

When dealing with the grant map space of add-to-physmap operations,
ARM specific code recognizes a number of error conditions, but fails
to release a lock being held on the respective exit paths.

IMPACT
======

A malicious guest administrator can cause a denial of service.
Specifically, prevent use of a physical CPU for an indefinite period
of time.

VULNERABLE SYSTEMS
==================

Xen versions 4.4 and later are vulnerable.  Xen versions 4.3 and
earlier are not vulnerable.

Only ARM systems are affected.  X86 systems are not affected.

MITIGATION
==========

On systems where the guest kernel is controlled by the host rather than
guest administrator, running only kernels which only issue sane
hypercalls will prevent untrusted guest users from exploiting this
issue.  However untrusted guest administrators can still trigger it
unless further steps are taken to prevent them from loading code into
the kernel (e.g by disabling loadable modules etc) or from using other
mechanisms which allow them to run code at kernel privilege.

CREDITS
=======

This issue was discovered by Wei Liu of Citrix.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa235.patch           xen-unstable
xsa235-4.9.patch       Xen 4.9.x, Xen 4.8.x
xsa235-4.7.patch       Xen 4.7.x
xsa235-4.6.patch       Xen 4.6.x
xsa235-4.5.patch       Xen 4.5.x

$ sha256sum xsa235*
[6ec8bf9462de65fee3896246f52c00941b2d83c759b3f7b28a440eb977fcbc37  xsa235.meta](xsa235.meta)
[c81f534e96fe38b9f77794bb143d104d66ce2d7177bda43f872642616e23df65  xsa235.patch](xsa235.patch)
[3c21cb1a53f5979b069568c6cd6df3aad00c19e0e459e37625d6a3c0f4f360cc  xsa235-4.5.patch](xsa235-4.5.patch)
[47cda4f32b65f3543af368c324a2e5b308b698a1c7d8bc84fc274eb2cdb45c0e  xsa235-4.6.patch](xsa235-4.6.patch)
[f30848eee71e66687b421b87be1d8e3f454c0eb395422546c62a689153d1e31c  xsa235-4.7.patch](xsa235-4.7.patch)
[d8f012734fbf6019c1ff864744e308c41dfb9c7804ca3be2771c2c972cdf4bd5  xsa235-4.9.patch](xsa235-4.9.patch)
$

NOTE REGARDING LACK OF EMBARGO
==============================

The issue was discussed publicly before being recognized as a security
issue.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJZ50QUAAoJEIP+FMlX6CvZR0QH/RdlZ9q8CcqWVVF+De8dlKwk
HtgYWWGK/gYgfiwhnYT1fJlW3XZOvbf/fZDUTnuFYL6izJtpcEPuEb3tWM5Nzcs/
u85wyYQmzmDPRCJVuONamWFc0vnSBvb1NqKVqwQEBo3WVbPS5YwIaFgA/z8lZaT9
NV90FLOBjjRyh9ktxqtGQQvt1JcxVxNWLbV974PwFuURMC5kTt2eNvU2vOmgWV5V
gmlBcJyMEzAaZKCmotkt1Tla82ydXG1F+obaLhSVRWp0JFugvVJX9I3cqZk4rovv
HKqLm1bmzloWPo2wvjSnRJIVu9us3MD4VqjxWOwQQq1nrTdDdlMcC6sfn93PaVo=
=R0BH
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team

