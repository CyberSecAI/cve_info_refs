=== Content from lists.debian.org_4cac3901_20250124_180302.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DLA 1198-1] libextractor security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1198-1] libextractor security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Mon, 4 Dec 2017 22:04:57 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/5540790f-28bb-bf14-7515-d9752d71f89f%40debian.org)Â [5540790f-28bb-bf14-7515-d9752d71f89f@debian.org](msg00000.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : libextractor
Version        : 1:0.6.3-5+deb7u1
CVE ID         : CVE-2017-15266 CVE-2017-15267 CVE-2017-15600
                 CVE-2017-15601 CVE-2017-15602 CVE-2017-15922
Debian Bug     : 878314 880016

Leon Zhao discovered several security vulnerabilities in libextractor,
a universal library and command-line tool to obtain meta-data about
files. NULL Pointer Dereferences, heap-based buffer overflows, integer
signedness errors and out-of-bounds read may lead to a denial-of-service
(application crash) or have other unspecified impact.

For Debian 7 "Wheezy", these problems have been fixed in version
1:0.6.3-5+deb7u1.

We recommend that you upgrade your libextractor packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEErPPQiO8y7e9qGoNf2a0UuVE7UeQFAloluHlfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEFD
RjNEMDg4RUYzMkVERUY2QTFBODM1RkQ5QUQxNEI5NTEzQjUxRTQACgkQ2a0UuVE7
UeQ4dBAAmeb7pnWQuvp9PWpcaQAGPJeSucEAg+ukXTLVptzUh6/2LQ3H09Hnbk3j
+ZY8JDK6mxB6ouZdi95Fn7yT5mr8K2dcZv1AkBk1FyAe72vX0WIyNra9r4xDBo9q
Cv6YtCvap6bXo2abRobzNQRzMqFiNZMecCEKnNP99LMOokcUV38pj43w+EekZ7v7
x28IgkE9DBol7eDJJinCXzkvm1lbeSzunSJ9kP0wLFznPDDM4aJ3hsKd7Va3s1Cx
LBsethyFv1NnBDGo/h9L/hYuNfwTdUiGk9IDru/878yjpwIrCF9p1JmIDfc2ckkd
l9Zrd7XvR/lCkGzGcoCt8U7Knv0buvfFMW5AVxIeETE7Gb37pnmHYYd5uYyRhbZi
MJsVqM/2halY6MiCoVs8M2QOUls0y/+0uo188WhqNaXBpgTPrvuJtXqlAew4r6Uj
VsbWmUHSI8wh/XP1Wmkw3pQKjdkD/pmxozHtwkd66XdtsaTUL0Q8eIBFtLOjuqXM
8yomOzezbKS7J6fTHMYhbMFMyd4Oqkwpyzk8aQ83NJWOumI3lRF47InidWWg7zQY
SOo764tBoH7tABWooctV19ofDUCos7JUjkSpCRtqnurOjJS3qHDpR3rQRit5t23x
DdgrP74HjpW/jpYsXEtisbpTPbJLl9PowOndU/O8QrArFm6dFl8=
=EVir
-----END PGP SIGNATURE-----

```

---



=== Content from lists.gnu.org_00968910_20250124_180250.html ===


| | **bug-libextractor** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-libextractor)

---

[[Date Prev](msg00005.html)][[Date Next](msg00007.html)][[Thread Prev](msg00005.html)][[Thread Next](msg00008.html)][[Date Index](index.html#00006)][[Thread Index](threads.html#00006)]

## [bug-libextractor] A heap-buffer-overflow vulneribility in png\_extractor

---

| **From**: | Leon Zhao |
| --- | --- |

| **Subject**: | [bug-libextractor] A heap-buffer-overflow vulneribility in png\_extractor.c |
| **Date**: | Fri, 13 Oct 2017 15:11:48 +0800 |

---

**Tested Version:**libextractor v1.4
**Details:**In function stndup at png\_extractor.cÃ‚Â Ã‚Â 44 static char \*Ã‚Â 45 stndup (const char \*str,Ã‚Â 46Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â size\_t n)Ã‚Â 47 {Ã‚Â 48Ã‚Â  Ã‚Â char \*tmp;Ã‚Â 49Ã‚Â Ã‚Â 50Ã‚Â  Ã‚Â if (NULL == (tmp = malloc (n + 1)))Ã‚Â 51Ã‚Â  Ã‚Â  Ã‚Â return NULL;Ã‚Â 52Ã‚Â  Ã‚Â tmp[n] = '\0';Ã‚Â 53Ã‚Â  Ã‚Â memcpy (tmp, str, n);Ã‚Â 54Ã‚Â  Ã‚Â return tmp;Ã‚Â 55 }
**Crash Information:**The output with address sanitizer enabled./extract -i extract-stndup-png\_extractor-50.crashÃ‚Â Keywords for file extract-stndup-png\_extractor-50.crash:mimetype - image/pngimage dimensions - 1996488748x44===================================================================15728==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200000cf2f at pc 0x7fc6a2b34662 bp 0x7ffe53360770 sp 0x7ffe53360760WRITE of size 1 at 0x60200000cf2f thread T0Ã‚Â  Ã‚Â  #0 0x7fc6a2b34661 in stndup /root/libextractor-1.4/src/plugins/png\_extractor.c:52Ã‚Â  Ã‚Â  #1 0x7fc6a2b35078 in processiTXt /root/libextractor-1.4/src/plugins/png\_extractor.c:226Ã‚Â  Ã‚Â  #2 0x7fc6a2b36ba3 in EXTRACTOR\_png\_extract\_method /root/libextractor-1.4/src/plugins/png\_extractor.c:479Ã‚Â  Ã‚Â  #3 0x7fc6a74d4792 in do\_extract /root/libextractor-1.4/src/main/extractor.c:577Ã‚Â  Ã‚Â  #4 0x7fc6a74d4b98 in EXTRACTOR\_extract /root/libextractor-1.4/src/main/extractor.c:655Ã‚Â  Ã‚Â  #5 0x4044c9 in main /root/libextractor-1.4/src/main/extract.c:977Ã‚Â  Ã‚Â  #6 0x7fc6a710f82f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2082f)Ã‚Â  Ã‚Â  #7 0x4017c8 in \_start (/opt/asan/bin/extract+0x4017c8)
0x60200000cf2f is located 1 bytes to the left of 1-byte region [0x60200000cf30,0x60200000cf31)allocated by thread T0 here:Ã‚Â  Ã‚Â  #0 0x7fc6a77cd602 in malloc (/usr/lib/x86\_64-linux-gnu/libasan.so.2+0x98602)Ã‚Â  Ã‚Â  #1 0x7fc6a2b3460f in stndup /root/libextractor-1.4/src/plugins/png\_extractor.c:50Ã‚Â  Ã‚Â  #2 0x7fc6a2b35078 in processiTXt /root/libextractor-1.4/src/plugins/png\_extractor.c:226Ã‚Â  Ã‚Â  #3 0x7fc6a2b36ba3 in EXTRACTOR\_png\_extract\_method /root/libextractor-1.4/src/plugins/png\_extractor.c:479Ã‚Â  Ã‚Â  #4 0x7fc6a74d4792 in do\_extract /root/libextractor-1.4/src/main/extractor.c:577Ã‚Â  Ã‚Â  #5 0x7fc6a74d4b98 in EXTRACTOR\_extract /root/libextractor-1.4/src/main/extractor.c:655Ã‚Â  Ã‚Â  #6 0x4044c9 in main /root/libextractor-1.4/src/main/extract.c:977Ã‚Â  Ã‚Â  #7 0x7fc6a710f82f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2082f)
SUMMARY: AddressSanitizer: heap-buffer-overflow /root/libextractor-1.4/src/plugins/png\_extractor.c:52 stndupShadow bytes around the buggy address:Ã‚Â  0x0c047fff9990: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa faÃ‚Â  0x0c047fff99a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa faÃ‚Â  0x0c047fff99b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa faÃ‚Â  0x0c047fff99c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa faÃ‚Â  0x0c047fff99d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa=>0x0c047fff99e0: fa fa fa fa fa[fa]01 fa fa fa fd fa fa fa fd fdÃ‚Â  0x0c047fff99f0: fa fa 00 00 fa fa fd fd fa fa fd fa fa fa fd faÃ‚Â  0x0c047fff9a00: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd faÃ‚Â  0x0c047fff9a10: fa fa fd fa fa fa 04 fa fa fa fd fa fa fa fd faÃ‚Â  0x0c047fff9a20: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd faÃ‚Â  0x0c047fff9a30: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd faShadow byte legend (one shadow byte represents 8 application bytes):Ã‚Â  Addressable:Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â 00Ã‚Â  Partially addressable: 01 02 03 04 05 06 07Ã‚Â Ã‚Â  Heap left redzone:Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â faÃ‚Â  Heap right redzone:Ã‚Â  Ã‚Â  Ã‚Â  fbÃ‚Â  Freed heap region:Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â fdÃ‚Â  Stack left redzone:Ã‚Â  Ã‚Â  Ã‚Â  f1Ã‚Â  Stack mid redzone:Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â f2Ã‚Â  Stack right redzone:Ã‚Â  Ã‚Â  Ã‚Â f3Ã‚Â  Stack partial redzone:Ã‚Â  Ã‚Â f4Ã‚Â  Stack after return:Ã‚Â  Ã‚Â  Ã‚Â  f5Ã‚Â  Stack use after scope:Ã‚Â  Ã‚Â f8Ã‚Â  Global redzone:Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  f9Ã‚Â  Global init order:Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â f6Ã‚Â  Poisoned by user:Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  f7Ã‚Â  Container overflow:Ã‚Â  Ã‚Â  Ã‚Â  fcÃ‚Â  Array cookie:Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  acÃ‚Â  Intra object redzone:Ã‚Â  Ã‚Â  bbÃ‚Â  ASan internal:Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â fe==15728==ABORTING
**CREDIT**Zhao Liang, Huawei Weiran Labs
Attachment is POC file

**[![Attachment:](/icons/binary.png)](bin7mwo6dpb6m.bin)
[extract-stndup-png\_extractor-50.crash](bin7mwo6dpb6m.bin)**

*Description:* Binary data

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[bug-libextractor] A heap-buffer-overflow vulneribility in png\_extractor.c**,
  *Leon Zhao*Â **<=**

---

* Prev by Date:
  **[[bug-libextractor] An infinite loop in nsfe\_extractor.c caused by negative chunksize](msg00005.html)**
* Next by Date:
  **[Re: [bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_nsf\_extract\_method](msg00007.html)**
* Previous by thread:
  **[[bug-libextractor] An infinite loop in nsfe\_extractor.c caused by negative chunksize](msg00005.html)**
* Next by thread:
  **[[bug-libextractor] An Out-of-bounds Read vulnerability in dvi\_extractor.c](msg00008.html)**
* Index(es):
  + [**Date**](index.html#00006)
  + [**Thread**](threads.html#00006)


