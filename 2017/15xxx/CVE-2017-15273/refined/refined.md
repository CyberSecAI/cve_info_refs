```
{
  "vulnerability": {
    "root_cause": "The application fails to properly sanitize user-supplied input before displaying it to the user. Specifically, the titles of journal entries and user display names are not being escaped when displayed in various contexts.",
    "weaknesses": [
      "Cross-site Scripting (XSS)"
    ],
    "impact": "An attacker can inject malicious JavaScript code into the application, which can then be executed in the context of other users' browsers. This can lead to various attacks, such as session hijacking, defacement, or stealing sensitive information.",
    "attack_vectors": [
      "By setting a malicious title for a journal entry. When the journal is viewed, the JavaScript code in the title will execute.",
      "By setting a malicious name (first name, last name, display name) in user profile. The malicious name will be displayed in mail composer autocomplete suggestions, when fetching user information via webservices (test client) and in elasticsearch templates, leading to XSS.",
       "When a malicious user name is used in the mail composer's autocomplete, the malicious javascript is executed on the recipient's browser during reply"
    ],
    "required_attacker_capabilities": "An attacker needs to be a registered user of the application and have the ability to create journal entries and/or edit their user profile."
  },
  "affected_versions": [
     "Mahara 15.04 before 15.04.15",
     "Mahara 16.04 before 16.04.9",
     "Mahara 16.10 before 16.10.6",
     "Mahara 17.04 before 17.04.4"
  ]
}
```