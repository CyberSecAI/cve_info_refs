### CVE-2017-15105

**Root cause of vulnerability:**
The vulnerability stems from how Unbound processes wildcard synthesized NSEC records. While synthesis is allowed by RFC4592, the synthesized owner names shouldn't be used during NSEC processing. However, Unbound versions 1.6.7 and earlier incorrectly used these synthesized names.

**Weaknesses/vulnerabilities present:**
- Improper handling of wildcard synthesized NSEC records.
- Use of synthesized owner name of NSEC records instead of the original wildcard name for non-existence proofs.
- Validation of NSEC records using label count, but using the possibly-modified NSEC owner for proofs.

**Impact of exploitation:**
- **NXDOMAIN spoofing:** An attacker can manipulate the owner of a wildcard NSEC record to prove the non-existence of an actual existing wildcard record, leading to an incorrect NXDOMAIN answer.
- **NODATA spoofing:** An attacker can modify the owner name of the NSEC wildcard record to match the queried name when the queried type is not in the NSEC's type bitmap, causing Unbound to incorrectly accept a NODATA proof.

**Attack vectors:**
- Manipulating DNS responses to include crafted wildcard NSEC records.
- Exploitation requires a zone to have a wildcard record using NSEC records for non-existence proofs (NSEC3 records are not vulnerable).

**Required attacker capabilities/position:**
- The attacker needs to be able to inject crafted DNS responses to a vulnerable Unbound resolver.
- The attacker must have control of a domain with a wildcard record using NSEC for non-existence proofs.

**Additional Details:**
- The vulnerability does not allow for tricking Unbound into accepting an insecure delegation proof (proof of no DS) because the NS bit must be set in the NSEC type bitmap, which is not the case for wildcard records.
- Patches and updated versions of Unbound (1.6.8 and later) were released to address this vulnerability.