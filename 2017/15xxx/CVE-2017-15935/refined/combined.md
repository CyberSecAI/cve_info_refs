=== Content from medium.com_09136001_20250124_120255.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbe630059a72d&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fstolabs%2Fsecurity-issue-on-pandora-fms-enterprise-be630059a72d&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fstolabs%2Fsecurity-issue-on-pandora-fms-enterprise-be630059a72d&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Security Issue on Pandora FMS Enterprise

## Version 7.0

[![Ricardo Fajin](https://miro.medium.com/v2/resize:fill:88:88/1*KInrZ0LzcHo5Z5wZoWhwGg.png)](/%40Rfajin?source=post_page---byline--be630059a72d--------------------------------)[![stolabs](https://miro.medium.com/v2/resize:fill:48:48/1*gTF5Rzr9-H4_L_Z4k1yjHg.png)](https://medium.com/stolabs?source=post_page---byline--be630059a72d--------------------------------)

[Ricardo Fajin](/%40Rfajin?source=post_page---byline--be630059a72d--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fef0221f76e98&operation=register&redirect=https%3A%2F%2Fmedium.com%2Fstolabs%2Fsecurity-issue-on-pandora-fms-enterprise-be630059a72d&user=Ricardo+Fajin&userId=ef0221f76e98&source=post_page-ef0221f76e98--byline--be630059a72d---------------------post_header-----------)

Published in[stolabs](https://medium.com/stolabs?source=post_page---byline--be630059a72d--------------------------------)·3 min read·Oct 26, 2017

--

Listen

Share

Researching the platform, me and my coworker, Edward Amaral, security researcher from Stone Payments found some security issues on the network manager from Pandora.

Lets get all the security issues Explained:

- Agent form, Stored XSS

- Map editing, Stored XSS

- Information Leak

- RFI With RCE

First, Lets talk a bit about the application itself, we first got a license where we could test the application, we were very well supported by their team, which helped a lot to make the reports and test the application.

The first issue was a Stored XSS, which was kinda difficult to pull out. We tried different payloads, and it was all being remediated by the server. But we found that the application had some issues to remediate some types of payloads.

![]()

The Payload used to pull off that beautifull Pop-up with those Session IDs was: <script ~~~>alert(document.cookie)</script ~~~>

That’s a Relatively simple XSS script, which uses an exotic bypassing technique, with the “~” to deceive the server into thinking that’s not a HTML Tag.

The Cross-Site Scripting is the third most critical web application vulnerability according to OWASP which is the Open Web Application Security Project, an online community that produces a ton of free infosec quality content.

The second flaw was Another XSS, but this time, was creating a map. While creating a map, with a little test we found in a parameter, that it was vulnerable to the same payload used in the first issue.

So, Again, the payload used was <script ~~~>alert(document.cookie)</script ~~~>

![]()

For that one to Pop up on a real attack scenario, the victim need to click twice on the XSS poisoned map.

The Third Issue is a information Leak that can leak that the OS running the Server is UNIX based, and where the Web server is located in the machine.

This info is aquired in the main page of the application, when a graph is loading it sends the requisition containing the information, that can be intercepted using Burpsuite.

This information is passed via GET parameter, as we can see in the URL Below

URL:

[http://%3cip%3e/pandora\_console/include/graphs/fgraph.php?homeurl=../../&graph\_type=progressbar&width=120&homedir=**/var/www/html/pandora\_console**&height=10&progress=100&mode=0&out\_of\_lim\_str=Fora%20dos%20limites&title=&font=**/var/www/html/pandora\_console/**include/fonts/smallfont.ttf&value\_text=100%&colorRGB]http://<IP>/pandora\_console/include/graphs/fgraph.php?homeurl=../../&graph\_type=progressbar&width=120&homedir=**/var/www/html/pandora\_console**&height=10&progress=100&mode=0&out\_of\_lim\_str=Fora%20dos%20limites&title=&font=/var/www/html/pandora\_console/include/fonts/smallfont.ttf&value\_text=100%&colorRGB=

The Fourth Issue is a RFI

Remote File Inclusion is the process of including remote files through the exploiting of vulnerable inclusion procedures implemented in the application. This can lead to something as outputting the contents of the file, but depending on the severity, it can also lead to:

· Code execution on the web server

· Code execution on the client-side such as JavaScript which can lead to other attacks such as cross site scripting (XSS)

· Denial of Service (DoS)

· Sensitive Information Leakage

In our case, we upload a file to the server through the manager files function. This function is only for administrator’s users. We sent a simple php file that use a command to execute system commands. We used the code as quoted in the example below:

<?php. system($\_GET[‘cmd’]); ?>

After that, we call a remote connection to a specific IP, with a reverse shell interaction using netcat, which resulted in a reverse shell on the server. That reverse Shellcode was created with MSFVenom.

![]()

List of CVEs Related to this article.

CVE-2017–15934. — <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15934>

CVE-2017–15935. — [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15935](https://cve.mitre.org/cgi-bin/cvename.cgi?=CVE-2017-15935)

CVE-2017–15936. —<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15936>

CVE-2017–15937. — [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017–15937](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15937)

## Authors:

[Ricardo Fajin](/%40rfajin)

[Edward Amaral](/%40etoledano)

[Security](/tag/security?source=post_page-----be630059a72d--------------------------------)[Pandorafms](/tag/pandorafms?source=post_page-----be630059a72d--------------------------------)[Xss Attack](/tag/xss-attack?source=post_page-----be630059a72d--------------------------------)[Remote Code Execution](/tag/remote-code-execution?source=post_page-----be630059a72d--------------------------------)[Rfi](/tag/rfi?source=post_page-----be630059a72d--------------------------------)

--

--

[![stolabs](https://miro.medium.com/v2/resize:fill:96:96/1*gTF5Rzr9-H4_L_Z4k1yjHg.png)](https://medium.com/stolabs?source=post_page---post_publication_info--be630059a72d--------------------------------)[![stolabs](https://miro.medium.com/v2/resize:fill:128:128/1*gTF5Rzr9-H4_L_Z4k1yjHg.png)](https://medium.com/stolabs?source=post_page---post_publication_info--be630059a72d--------------------------------)[## Published in stolabs](https://medium.com/stolabs?source=post_page---post_publication_info--be630059a72d--------------------------------)[135 Followers](/stolabs/followers?source=post_page---post_publication_info--be630059a72d--------------------------------)·[Last published Jan 6, 2023](/stolabs/how-saml-works-and-some-attacks-on-it-2f62db0ef1d9?source=post_page---post_publication_info--be630059a72d--------------------------------)

STO Labs

[![Ricardo Fajin](https://miro.medium.com/v2/resize:fill:96:96/1*KInrZ0LzcHo5Z5wZoWhwGg.png)](/%40Rfajin?source=post_page---post_author_info--be630059a72d--------------------------------)[![Ricardo Fajin](https://miro.medium.com/v2/resize:fill:128:128/1*KInrZ0LzcHo5Z5wZoWhwGg.png)](/%40Rfajin?source=post_page---post_author_info--be630059a72d--------------------------------)Follow[## Written by Ricardo Fajin](/%40Rfajin?source=post_page---post_author_info--be630059a72d--------------------------------)[12 Followers](/%40Rfajin/followers?source=post_page---post_author_info--be630059a72d--------------------------------)·[7 Following](/%40Rfajin/following?source=post_page---post_author_info--be630059a72d--------------------------------)

Security researcher at STOlabs

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----be630059a72d--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----be630059a72d--------------------------------)[About](/about?autoplay=1&source=post_page-----be630059a72d--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----be630059a72d--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----be630059a72d--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----be630059a72d--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----be630059a72d--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----be630059a72d--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----be630059a72d--------------------------------)[Teams](/business?source=post_page-----be630059a72d--------------------------------)


