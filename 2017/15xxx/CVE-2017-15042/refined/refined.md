```
{
  "CVE-2017-15042": {
    "description": "The `smtp.PlainAuth` function in Go's `net/smtp` package was found to be susceptible to a man-in-the-middle (MITM) attack. This vulnerability exists because the implementation would send the username and password to an MITM SMTP server that does not advertise `STARTTLS` but does advertise that `PLAIN` auth is okay. This could allow an attacker to sniff SMTP credentials sent by a Go application.",
    "root_cause": "The `smtp.PlainAuth` function was changed in Go 1.1 to allow sending credentials on non-TLS connections when the remote server advertises that `PLAIN` authentication is supported, which was intended for localhost connections. However, this change inadvertently allowed MITM attacks by blindly trusting server advertisements.",
    "weaknesses": [
      "Improper verification of TLS requirement in `smtp.PlainAuth` function",
      "Blind trust of server advertisement of `PLAIN` authentication"
    ],
    "impact": "A remote man-in-the-middle attacker could sniff SMTP credentials sent by a Go application using the vulnerable `smtp.PlainAuth` implementation.",
    "attack_vectors": [
      "Man-in-the-middle attack between a Go application and an SMTP server"
    ],
    "required_capabilities": "The attacker needs to be positioned as a man-in-the-middle between the vulnerable client and the SMTP server. The malicious SMTP server has to not advertise STARTTLS but advertise PLAIN auth is OK.",
      "additional_details": "The vulnerability was fixed in Go 1.8.4 and 1.9.1 by restoring the original TLS requirement, with an exception for connections made to localhost. The fix ensures that `PlainAuth` requires either TLS or a localhost connection before sending credentials, regardless of what the remote server claims."
  }
}
```