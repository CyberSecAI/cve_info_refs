```
{
  "Root cause of vulnerability": "A race condition exists in the key management subsystem when updating and accessing keys, particularly negative keys (keys that failed to instantiate). The instantiation state was spread across multiple objects, leading to non-atomic reads/writes and potential inconsistencies.",
  "Weaknesses/vulnerabilities present": "Non-atomic access to key state (instantiated, negative, rejection error) and data. The state of a key could change between checks, leading to the use of inconsistent data or a NULL pointer dereference when updating a key that is not fully instantiated.",
  "Impact of exploitation": "A race condition can lead to NULL pointer dereference or other memory corruption issues, resulting in a kernel crash. The payload of the key may change depending on the state of the key, which could result in reading incorrect data (e.g. an error code when the key is positively instantiated).",
  "Attack vectors": "An attacker could trigger the race condition by creating, updating, and accessing keys in a concurrent manner. Specifically, the vulnerability could be triggered by repeatedly adding and requesting encrypted keys.",
  "Required attacker capabilities/position": "The attacker needs to be able to create and manipulate keys, which usually requires having user-level access to the system. Specifically the attacker needs to be able to call the `add_key` and `request_key` system calls to trigger the vulnerability."
}
```