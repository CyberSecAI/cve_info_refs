```
{
  "cve_id": "CVE-2017-15088",
  "vulnerability": {
    "root_cause": "The vulnerability is caused by a fixed-size buffer used in the `X509_NAME_oneline_ex` function and its call sites when processing Distinguished Name (DN) fields in X.509 certificates during PKINIT pre-authentication.",
    "weaknesses": [
      "A stack-based buffer overflow exists in the `get_matching_data()` function when reading the principal's certificate during PKINIT preauthentication.",
       "The `X509_NAME_oneline_ex` function did not use dynamic memory allocation, leading to the fixed-size buffer limitation"
    ],
    "impact": "An attacker with the ability to have a specially crafted certificate signed by a trusted CA, can cause a buffer overflow which could crash the authentication process, such as `kinit`, and potentially lead to arbitrary code execution. This is particularly relevant when the CA's subject line is very long.",
    "attack_vectors": [
      "The attack vector is through the PKINIT pre-authentication mechanism, where a specially crafted certificate with an overly long subject name is presented.",
       "Specifically, the `get_matching_data()` function is vulnerable when processing the subject and issuer DNs from the certificates."
    ],
    "required_capabilities": "The attacker needs a validated certificate with a long subject and issuer, and a \"pkinit_cert_match\" string attribute on some principal in the database. The attacker might need to control the contents of the issuer field in the validated certificate for remote code execution."
  },
  "fix": "The vulnerability was fixed by rewriting `X509_NAME_oneline_ex()` and its call sites to use dynamic memory allocation and to perform proper error checking. This eliminates the fixed-size buffer, thus preventing the overflow. The patch was introduced in commit `fbb687db1088ddd894d975996e5f6a4252b9a2b4` and addressed in krb5 version 1.15.2-2.",
  "additional_notes": "This issue is only present when using `get_matching_data` in KDC certauth plugin code specific to Red Hat. In the upstream krb5 and Debian, it's only used in the kinit(1) client."
}
```