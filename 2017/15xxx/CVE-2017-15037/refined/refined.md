The provided content describes CVE-2017-15037.

**Root cause of vulnerability:**
The vulnerability lies within the `smb_strdupin()` function in FreeBSD's `netsmb` module. This function attempts to copy a string from user space to kernel space. It first tries to determine the length of the string by incrementally reading until a null terminator is found. Then, it allocates a buffer and copies the string using `copyin()`.

**Weaknesses/vulnerabilities present:**
- **Race condition:** The vulnerability is due to a race condition. A malicious user program can modify the user-space string while `smb_strdupin()` is determining the length and performing the copy. Specifically, the user could remove the null terminator from the user space string after the initial length check, but before the copy operation finishes.
- **Non-null-terminated string:** If the user manipulates the string, the copied string in kernel space might not be null-terminated.
- **Use of potentially invalid string**: Subsequent code relies on null-termination, and calling `strlen()` on a non-null-terminated string can lead to out-of-bounds reads and other undefined behavior.

**Impact of exploitation:**
- **Local Denial of Service (DoS):** The primary impact is a potential local Denial of Service (DoS). The lack of a null terminator can lead to invalid memory access when `strlen()` is called, causing the kernel to crash.

**Attack vectors:**
- A malicious local user can exploit this vulnerability by manipulating the user-space string that is passed to the `smb_strdupin()` function, creating the race condition.

**Required attacker capabilities/position:**
- The attacker needs to be a local user who can call the vulnerable `smb_strdupin()` function indirectly through `smb_usr_t2request` and control the content of the string copied.

**Additional details:**
- The vulnerability was reported by Meng Xu.
- The fix involved replacing the buggy length calculation and `copyin()` with `copyinstr()`, which correctly handles null-terminated strings.
- The vulnerability was present in the `CURRENT` version of FreeBSD and was later backported to stable branches.