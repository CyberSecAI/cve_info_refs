```
{
  "CVE-2017-0220": {
    "related": true,
    "information": [
      {
        "root cause": "Two related bugs in Windows kernel code (afd!AfdBind and tcpip!TcpBindEndpoint) responsible for implementing the bind() socket function. These bugs are due to insufficient validation of user-supplied input, specifically the size and type of the structure passed to the bind function, leading to out-of-bounds reads.",
        "weaknesses": [
          "Double fetch vulnerability in afd!AfdBind: The first word of the input structure is fetched twice from user-mode, once during memmove() and again when passing its value to SOCKADDR_SIZE. This can cause the size check to be bypassed.",
          "Insufficient input sanitization in afd!AfdBind and tcpip!TcpBindEndpoint: The sockaddr_size array used for input validation has many 0x00 entries. If an invalid dwStructType is provided, the sanitization becomes ineffective, allowing for arbitrary buffer sizes.",
           "Out-of-bounds read in tcpip!TcpBindEndpoint: If the dwStructType is not equal to 2, the code assumes it to be 0x17 and copies 0x1C bytes, even if the buffer is smaller."
        ],
        "impact": "The vulnerabilities can lead to:\n\t- Kernel memory disclosure: User-mode applications can potentially read kernel-mode secrets.\n\t- Denial of Service (DoS): A blue screen of death can be triggered, causing a system crash.",
        "attack vectors": "A user-mode application can exploit the vulnerabilities by sending specially crafted input to the AFD_BIND IOCTL through the bind() socket function.",
        "required attacker capabilities": "An attacker needs the ability to execute code in user mode to interact with the Windows kernel. No special privileges are required, as the bind() function is accessible to all users. The attacker also needs to understand the structure of the input expected by the affected functions to construct a malicious payload. Specific timing and multithreading might also be required to take advantage of the double-fetch vulnerability."
      }
    ]
  }
}
```