```
{
  "cveId": "CVE-2017-0165",
  "description": "The IEETWCollector service deletes its files and directories as LocalSystem, allowing a user to delete arbitrary files or directories on the system. When the IEETWCollection session is closed, the service calls CIEEtwSessionData::DeleteSessionFiles which deletes the ETW log file and the directory in which it was stored. The directory is specified by the user during the CIEEtwCollector::CreateCollectionSession call to set up the session. While creating the log directory is done under impersonation, the cleanup is not. Therefore, a user can use symbolic link attacks to redirect the ETL and directory to arbitrary files or directories. When cleanup occurs, those files/directories will be deleted as LocalSystem.",
  "vulnerabilityDetails": {
    "rootCause": "Improper cleanup of ETW session files/directories by the IEETWCollector service.",
    "weaknesses": [
      "The service does not properly impersonate the user during cleanup operations.",
      "The service deletes files/directories as LocalSystem."
    ],
    "impact": "An unprivileged user can delete arbitrary files and directories on the system, potentially leading to privilege escalation or denial of service.",
    "attackVectors": [
      "Symbolic link attacks can redirect the cleanup process to arbitrary locations."
    ],
        "requiredCapabilities": "The attacker needs to be a normal user on the system with the ability to create symbolic links."
  }
}
```