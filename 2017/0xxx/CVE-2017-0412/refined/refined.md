```
{
  "CVE-2017-0412": {
    "Root cause": "The `MemoryIntArray` class in Android uses the size of the underlying ashmem region to map the data into memory, perform bounds checks and unmap. However, the size of the ashmem region can be changed, leading to a mismatch between the mapped memory and the underlying ashmem region.",
    "Weaknesses": [
      "Race condition in `MemoryIntArray` when mapping shared memory.",
      "Improper bounds checking using potentially outdated ashmem region size.",
      "Use of the potentially modified ashmem size for unmapping memory."
    ],
    "Impact": "An attacker can trigger out-of-bounds memory accesses and trigger a crash, potentially leading to arbitrary memory being freed. In successful cases, this can cause system_server to crash.",
    "Attack vectors": [
      "Local malicious application can pass a `MemoryIntArray` instance to a privileged process.",
      "The attacker can use `ASHMEM_SET_SIZE` to change the underlying ashmem region size after the initial size is fetched but before memory mapping, during bounds checks, or before unmapping."
    ],
     "Required attacker capabilities": "An attacker requires the ability to call `ASHMEM_SET_SIZE` on the shared ashmem descriptor and pass a crafted `MemoryIntArray` instance to a privileged process."
  }
}
```