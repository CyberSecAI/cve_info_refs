Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2017-0365:

**Root Cause:**

*   The vulnerability lies within the `SearchHighlighter::highlightText()` function of MediaWiki. This function uses a regular expression (`/<\/?[^>]+>/`) within `SearchHighlighter::removeWiki()` to remove HTML tags from search snippets. The regex assumes that HTML is well-formed, which isn't always the case.

**Weaknesses/Vulnerabilities Present:**

*   **Cross-Site Scripting (XSS):** The incorrect assumption of well-formed HTML allows for injection of malicious HTML into search results, leading to XSS.

**Impact of Exploitation:**

*   An attacker can inject arbitrary JavaScript code into the search results page.
*   This could lead to various malicious actions, such as:
    *   Redirecting users to phishing sites
    *   Stealing session cookies
    *   Defacing the website
    *   Performing actions on behalf of the logged-in user

**Attack Vectors:**

*   An attacker must be able to create a page on the MediaWiki instance with malicious HTML content.
*   Then, they need to get a user to search for a term that will include that malicious HTML in the search result snippet.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to create or modify content on the target MediaWiki instance.
*   The attacker does not need to be logged into the MediaWiki instance.
*   The target user must perform a search using the MediaWiki instance.
*   The vulnerable configuration `$wgAdvancedSearchHighlighting` needs to be enabled on the MediaWiki instance, this is not a default setting.

**Additional Details:**

*   The vulnerability exists in MediaWiki versions prior to 1.28.1, 1.27.2, and 1.23.16.
*   The issue was addressed by modifying the sanitization logic in `SearchHighlighter::removeWiki()`.
*   The vulnerability is not triggered by default configurations of MediaWiki, it needs the non-default `$wgAdvancedSearchHighlighting` setting to be enabled.

This information is more detailed than the CVE description which states "Mediawiki before 1.28.1 / 1.27.2 / 1.23.16 contains a XSS vulnerability in SearchHighlighter::highlightText() with non-default configurations."