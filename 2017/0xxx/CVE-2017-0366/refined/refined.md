```
{
  "cve_id": "CVE-2017-0366",
  "description": "Mediawiki before 1.28.1 / 1.27.2 / 1.23.16 contains a flaw allowing to evade SVG filter using default attribute values in DTD declaration.",
  "vulnerabilities": [
    {
      "root_cause": "The vulnerability is due to the way MediaWiki handles SVG files, specifically, it fails to properly sanitize SVG filters when default attribute values are declared in the Document Type Definition (DTD).",
      "weaknesses": [
        "Improper input validation of SVG files.",
        "Insufficient sanitization of SVG filters.",
        "Failure to handle default attribute values in DTD declarations securely."
      ],
      "impact": "An attacker can inject malicious code into SVG files, leading to Cross-Site Scripting (XSS) when the SVG is viewed within the MediaWiki platform. This allows an attacker to potentially execute arbitrary JavaScript in the context of a user's session, leading to potential session hijacking, data theft, or defacement.",
      "attack_vectors": [
        "Upload a malicious SVG file via the MediaWiki upload feature.",
        "Trigger the vulnerability by having a user view the malicious SVG file within the application."
      ],
       "required_capabilities": "Attacker needs to be able to upload a crafted SVG file to the MediaWiki instance. The attacker also needs a user to view the SVG file to trigger the XSS."
    }
  ],
  "affected_products": [
        "MediaWiki versions before 1.28.1",
        "MediaWiki versions before 1.27.2",
        "MediaWiki versions before 1.23.16"
   ],
  "fixes": [
    "The vulnerability is fixed in MediaWiki 1.28.1, 1.27.2, and 1.23.16 by whitelisting DTD declarations in SVG files."
  ],
    "cvss_score": "5.4 (Medium)",
    "cvss_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N"
}
```