Based on the provided content, here's an analysis of CVE-2017-0387:

**CVE Description:**

The provided text describes an elevation of privilege vulnerability in Mediaserver.

**Root cause of vulnerability:**

The vulnerability is caused by a lack of mutex lock when accessing `mSidebandStream`. Specifically, if one thread calls `getSidebandStream` while another thread frequently calls `setSidebandStream`, a Use-After-Free (UAF) condition can be triggered.

**Weaknesses/vulnerabilities present:**

*   **Race condition:** Multiple threads accessing and modifying shared data (`mSidebandStream`) without proper synchronization.
*   **Use-After-Free (UAF):**  A pointer to the memory location of `mSidebandStream` is accessed after the memory has been freed.

**Impact of exploitation:**

*   A local malicious application can execute arbitrary code within the context of the privileged `Mediaserver` process.
*   This could lead to a compromise of the device by gaining elevated privileges.

**Attack vectors:**

*   A local malicious application is needed to trigger the vulnerability.
*   The application needs to invoke specific APIs in Mediaserver to set and get `mSidebandStream` concurrently.

**Required attacker capabilities/position:**

*   The attacker needs to have the ability to install and run a malicious application on the target device.
*   The attacker needs to be able to manipulate the application to make calls to the Mediaserver to set and get the `mSidebandStream` in a way that triggers the race condition and UAF.

**Additional Details:**

*   The provided commit message clarifies that the fix addresses the lack of a mutex lock around access to `mSidebandStream`.
*   The vulnerability is considered a High severity issue due to the potential for local privilege escalation.
*   The vulnerability affects multiple versions of Android, from 5.0.2 to 7.1.1