Based on the provided content, here's an analysis of the vulnerability related to CVE-2017-11737:

**Root cause of vulnerability:**

The Rspamd web UI was not properly sanitizing user-supplied input when displaying email history, specifically in the subject field. This lack of sanitization allowed JavaScript code embedded within an email's subject to be executed in the context of the web browser of the user viewing the email history.

**Weaknesses/vulnerabilities present:**

*   **Cross-Site Scripting (XSS):** The primary vulnerability is a reflected XSS. The web UI directly renders the subject of an email without escaping or sanitizing it, leading to the execution of arbitrary JavaScript code.

**Impact of exploitation:**

*   **Arbitrary JavaScript Execution:** An attacker can inject malicious JavaScript code into an email's subject. When a user views the email history through the vulnerable Rspamd web UI, the injected script will be executed. This allows the attacker to:
    *   Steal cookies and session tokens
    *   Perform actions on behalf of the user
    *   Redirect the user to malicious sites
    *   Potentially achieve full access to the application if the attacker finds other vulnerabilities.

**Attack vectors:**

*   **Email Injection:** The attack vector is through a specially crafted email. The attacker sends an email with malicious JavaScript embedded in the subject field.

**Required attacker capabilities/position:**

*   **Ability to Send Email:** The attacker needs to be able to send emails to a user whose email is being scanned by the vulnerable rspamd instance.
*   **Target User Uses Vulnerable Web UI:** The attack requires the target user to view the email using the vulnerable Rspamd web UI.

**Additional details:**

* The issue was reported in rspamd issue #1738.
* The vulnerability was fixed in Rspamd version 1.6.3, specifically addressing the lack of escaping strings inside HTML in the history view of the web UI. This fix is explicitly mentioned in the release notes for version 1.6.3: `[WebUI] Escape strings inside HTML in history`.
* The vulnerability was found in version 1.6.2 and was fixed in version 1.6.3.