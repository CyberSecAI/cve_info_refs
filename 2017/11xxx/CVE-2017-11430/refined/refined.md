Based on the provided content, here's a breakdown of the vulnerability related to CVE-2017-11430:

**Root Cause:**

The vulnerability stems from inconsistent handling of comments within XML nodes by different XML parsing libraries and SAML processing libraries when parsing SAML responses. Specifically, some libraries, when extracting text from an XML element, may only return the substring of the text before the first comment, and ignore any subsequent text within that same node. This behavior, combined with the way XML canonicalization is often done for signature verification, allows an attacker to modify SAML assertions without invalidating the signature.

**Weaknesses/Vulnerabilities:**

1.  **Inconsistent XML Parsing:** XML libraries like `lxml` and `REXML` return only the text content of a node before the first comment. In contrast, other libraries, like `xml.etree.ElementTree`, will return the complete text content of the node including text after comments.
2.  **XML Canonicalization:** XML canonicalization, which is a process to standardize XML documents before signing, typically removes comments. This means that adding comments to a SAML response will not invalidate the signature.
3.  **Faulty Text Extraction:** Some SAML libraries may perform manual text extraction by simply extracting the inner text of a nodeâ€™s first child, leading to the same substring extraction issue.

**Impact of Exploitation:**

An attacker with an existing account can modify their SAML assertion to impersonate another user by adding a comment in the `NameID` field. Since the signature is verified against the canonicalized (comment-removed) XML document, the added comment and following malicious string aren't covered by the signature, and the vulnerable service provider will only use the part of the `NameID` before the comment, thus granting the attacker access to the victim user's account.

**Attack Vectors:**

The attack vector is a modified SAML response from an attacker controlled IdP. The attacker would need an account on the Identity Provider (IdP) and the ability to craft a malicious SAML response.

**Required Attacker Capabilities/Position:**

1.  **Authenticated User:** The attacker must have a valid account on the targeted IdP.
2.  **SAML Response Manipulation:** The attacker must have control over the SAML response, which is typically from an IdP they control.
3.  **Vulnerable SP:** The Service Provider (SP) must use a vulnerable SAML library, vulnerable XML library or flawed parsing logic.

**Additional Notes:**

*   The vulnerability was found to affect multiple SAML libraries and implementations, including OmniAuth-SAML (CVE-2017-11430).
*   The blog post from Duo Security provides a detailed explanation of the vulnerability and its implications.
*   The CERT/CC vulnerability note VU#475445 provides a comprehensive list of affected and not affected vendors.
*   The vulnerability is related to other similar CVEs, such as CVE-2017-11427, CVE-2017-11428, CVE-2017-11429, CVE-2018-0489, and CVE-2018-5387, which all share the same root cause.
*   Remediation involves updating SAML libraries, using a canonicalization algorithm that does not omit comments (`http://www.w3.org/2001/10/xml-exc-c14n#WithComments`), and ensuring that full text of XML nodes is extracted even if comments are present.
*   The vulnerability bypasses primary authentication but might not bypass second-factor authentication if the second factor is handled by the Service Provider and not the IdP.