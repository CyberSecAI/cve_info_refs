=== Content from seclists.org_46075e54_20250125_234422.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](89)
[By Date](date.html#90)
[![Next](/images/right-icon-16x16.png)](91)

[![Previous](/images/left-icon-16x16.png)](88)
[By Thread](index.html#90)
[![Next](/images/right-icon-16x16.png)](91)

![](/shared/images/nst-icons.svg#search)

# CIPH-2017-1: Advisory for StashCat

---

*From*: Karsten König <kk () ciphron de>

*Date*: Mon, 31 Jul 2017 15:12:13 +0200

---

```

1. Introduction
===============

* CIPHRON-ID: CIPH-2017-1
* Product: heinekingmedia StashCat
* Status: Patch available
* Affected versions:
    * Android: <= 1.7.5
    * Web: <= 0.0.80w
    * Desktop <= 0.0.86
* Vendor-URL: <https://www.stashcat.com/>
* CVE: CVE-2017-11129 bis CVE-2017-11136

```
During an independent investigation researchers of CIPHRON found
vulnerabilities in cryptographic and security functions of the instant
menssenger StashCat of heinekingmedia GmbH.
```

```
CIPHRON follows the principle of responsible disclosure and has informed
heinekingmedia beforehand. heinekindmedia has reacted to the disclosure
and has developed patches. These patches are available and will be
distributed in successive.
```

CIPHRON follows an own disclosure policy. This is available at

<https://ciphron.de/vulnerability-disclosure-policy>

2. Description of software
==========================

```
StashCat is developed by heinekingmedia GmbH and has the aim to give
customers an instant messenger which encrypts the communication between
clients End-to-End like it is known, for example, from WhatsApp or
Telegram. It is worth mentioning that the messenger provides a web and a
desktop client in addition to the Android and iOS app.
```

```
According to heinekingmedia the messenger aims especially at the use by
the police and authorities.
```

More information are available at

<https://www.stashcat.com/>

According to the web client website at

<https://app.stashcat.com>

we investigated version v0.0.80w

The investigated Android versions were the versions 1.5.18 and 1.7.5.

```
According to the installation file we investigated the version 0.0.86 of
the desktop client.
```

3. Description of vulnerabilities
=================================

```
The vulnerabilities were found during a half-day code review of the web
client. This was possible because the client is written in angular and
the client-side JavaScript code is directly available on
```

<https://app.stashcat.com>

```
The desktop client is build with Electron and is based on the web client
code for the base functionality.
```

```
We found vulnerabilities in the Android app via reverse engineering,
too. The finding from the code review of the web client were verified
through the reverse engineering if the protocol is affected.
```

```
The vulnerabilities have assigned CVEs. These are CVE-2017-11129 to
CVE-2017-11136.
```

```
CIPHRON has asked an independent third party, the Niedersachsen-CERT
(N-CERT), to verify the findings, what they did.
```

We gave heinekingmedia the change to comment the findings.

3.1 Communication decryptable through vendor
--------------------------------------------

CVE-2017-11136

```
One can see that the private key of the RSA-key pair, which is created
on the clients and is used to exchange passwords for symmetric
encryption of the communication channel, is transmitted to the
StashCat-server.
```

```
The password which is used to encrypt the private key are the first 32
bytes of the SHA512 hash of the user passsword. But this is transmitted
to the vendor server, too, as it is the login password.
```

```
This allows to decrypt the private key of StashCat users and therefore
the formaly encrypted communication channel for everyone which has
access to the vendor server because the password for the symmetric
encryption can be eavesdropped.
```

__Comment of heinekingmedia__

```
Passwords to secure the private key are now independent of the used
account password.
```

RSA keys are now 4096 bit in addition.

3.2 No key derivation function used
-----------------------------------

CVE-2017-11131

```
Instead of using a key deriviation function to create the password for
authentication, the user password is hashed directly with SHA512.
Moreover, only the first 32 bytes are used. State-of-the-art is to use a
key derivation function like PBKDF2 to generate from a source of low
entropy a password with high entropy.
```

Moreover, rainbow table attacks are mitigated through this

__Comment of heinekingmedia__

RSA-keys are encrypted according to PKCS#8. PBKDF2 is used internally.

3.3 Passwords generated with math.random()
------------------------------------------

CVE-2017-11133

```
The communication ist encrypted with AES in CBC-mode. The passwords to
encrypt the communication channel and the IV which are exchanged by the
communicating parties with RSA-key pairs are generated with math.random.
```

```
Newer versions are using CryptoJS.lib.WordArray.random() which uses
math.random() internal as well. This method ist not secure in a
cryptographic sense. Instead such generated passwords have to be treated
as deterministic what could lead to a compromise of the communication
channel.
```

__Comment of heinekingmedia__

```
Channel and conversation secrets are are no longer generated by
CryptoJS.
```

3.4 Integrity and authenticity not ensured
------------------------------------------

CVE-2017-11130

```
The integrity and authenticity of encrypted messages is not ensured.
This allows, for example, replay attacks in man-in-the-middle scenarios.
```

__Comment of heinekingmedia__

```
Responses created by the server are signed and can be verified by the
public key of the server.
```

3.5 Logout without authorisation
--------------------------------

CVE-2017-11135

```
Logouts of users can be done without authorisation because only the
device ID is needed.
```

__Comment of heinekingmedia__

```
The logout needs only the device\_id. This is intentional and leads to
the deletion of of data on the logouted device.
```

This is by no means a vulnerability.

__Remark of CIPHRON__

```
From our point of view this can lead to a problem if an attacker could
enumerate all device IDs. This could be used for a denial of service
attack.
```

3.6 Android-keystore uses hard coded password
---------------------------------------------

CVE-2017-11129

```
The Android-keystore uses a hard coded password. This allows to read out
contained passwords through third parties which gained access to the
keystore.
```

__Comment of heinekingmedia__

A hard coded password is not used from now on.

```
The previously hard coded password for the Android-keystore is now
replaced by a randomly generated password. The password is created by a
random string of 32 characters which is generated by a secure random
method. The random string is stored in the shared preferences of Android
and is deleted with every logout. The stored random string is XORed with
the manufacture and model code of the device. The result is used as the
encryption key. From this the keystore password is derived in
conjuncture with the device ID.
```

3.7 No certificate pinning
--------------------------

CVE-2017-11132

```
The Android-app uses no certificate pinning. Instead, only the signature
of the Certificate Authority is checked. This eases man-in-the-middle
attacks.
```

```
Remark: This finding was fixed independently of the disclosure process
in Android-versions after 1.5.18.
```

__Comment of heinekingmedia__

```
All apps use certificate pinning or HPKP to complicate man-in-the-middle
attacks.
```

3.8 Login data in the logs
--------------------------

CVE-2017-11134

```
The Android-app saves login data in the logs what could help attackers
to gain access to this data.
```

__Comment of heinekingmedia__

```
In the case of exceptions the request was saved to the log on the
device.
```

The log entries are now cleared beforehand.

4. Solution
===========

```
heinekingmedia has accepted the findings and will distribute patches
successively which are already available.
```

5. Credits
==========

```
The code review and the reverse engineering was done by Karsten König of
CIPHRON. Sebastian Horzela and Lennart Henke supported.
```

```
The Niedersachen-CERT verified the findings of CIPHRON as an independent
party.
```

6. Greets
=========

```
Greets to the team of CIPHRON, especially Martin, Jan and Frithjof for
the good discussions and the good atmosphere in the office.
```

7. Timeline
===========

10.03.2017 Vendor contacted

15.03.2017 Second contact attempt because no response received

15.03.2017 Phone call with heinekingmedia

15.03.2017 Findings communicated

06.06.2017 Note that findings are solved

28.06.2017 Communication of the prepared advisory for coordination

```
11.07.2017 Advisory communicated to N-CERT because CIPHRON received no
response
```

17.07.2017 Coordination with heinekingmedia about further procedure

```
18.07.2017 Commentary of the vendor about the findings received by
heinekingmedia
```

19.07.2017 Remarks about the commentary communication to heinekingmedia

```
19.07.2017 Communication of the updated advisory draft including the
commentary
```

19.07.2017 Coordindation of the advisory publication

```
19.07.2017 Note that the findings will be fixed until the end of next
week
```

28.07.2017 Note that patches of the findings are ready

28.07.2017 Discussion of the patches

31.07.2017 Publication of the advisory

8. About CIPHRON
================

```
The CIPHRON GmbH was founded in 2003 and is a consultancy for
information security with its central office in Hannover, Germany. As a
consultancy for information security, CIPHRON does penetration tests,
code reviews and individual research about security topics.
```

More information are available at

<http://ciphron.de>

--
Karsten-Kai König, IT Security Consultant
CIPHRON GmbH

Tel.: +49 (5 11) 51 51 33 - 0   Fax:       +49 (5 11) 51 51 33 - 29
Web: <http://www.ciphron.de/>     Support:   +49 (5 11) 51 51 33 - 11

Ust.Id.: DE263362886            Geschäftsführer:  Sebastian Horzela
                                Amtsgericht Hannover, HRB 203590Dear

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](89)
[By Date](date.html#90)
[![Next](/images/right-icon-16x16.png)](91)

[![Previous](/images/left-icon-16x16.png)](88)
[By Thread](index.html#90)
[![Next](/images/right-icon-16x16.png)](91)

### Current thread:

* **CIPH-2017-1: Advisory for StashCat** *Karsten König (Jul 31)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.stashcat.com_2244343d_20250126_125206.html ===
       [![stashcat](/fileadmin/user_upload/secunet_stashcat_Logo_by-secunet_RGB_SchwarzRot_80mm.svg)](https://stashcat.com/)    [Login](https://app.stashcat.com/web/app#/start/login "Login")Menü       Souveräne KommunikationVerschlüsselter Messenger für Behörden und Unternehmen – Individuell anpassbar und interoperabel.![](data:image/png;base64...) stashcat mit integriertem Marketplacestashcat mit integriertem Marketplace![](data:image/png;base64...)Die verschlüsselte Plattform, die Zusammenarbeit fördert, Datenaustausch ermöglicht und bei der Organisation interner Arbeitsabläufe hilft.[Jetzt beraten lassen](/beratung)![](data:image/png;base64...)
## Finden Sie heraus, wie stashcat Ihren Arbeitsalltag erleichtert

 [Kommunikation](/funktionen)

Profitieren Sie von vielfältigen Möglichkeiten für internen Austausch mit unserer Chat- und Videoanruf-Funktion, Broadcast-Listen und vielem mehr.

![](data:image/png;base64...)[Mehr erfahren](/funktionen) [Kollaboration](/funktionen)

Behalten Sie die Übersicht über Ihre Kontakte, Gruppen, Umfragen, Termine und weitere Inhalte mit unseren praktischen und interaktiven Funktionen.

![](data:image/png;base64...)[Mehr erfahren](/funktionen) [Datenspeicherung](/funktionen)

Greifen Sie von überall auf Ihre Daten zu und behalten Sie mit unseren Organisationstools den Überblick über Ihre hinterlegten Inhalte.

![](data:image/png;base64...)[Mehr erfahren](/funktionen)

Flexibel und vielseitig – Über 1.3 Millionen Nutzer\*innen weltweit

Jede Organisation hat eigene Anforderungen und Prozesse. stashcat bietet dank des innovativen Marketplaces flexible Lösungen. Die Vielseitigkeit zeigt sich im erfolgreichen Einsatz in zahlreichen Branchen, wie z. B.:

* **Verteidigung & Behörden**
* **Logistik & Produktion**
* **Versicherungen & Finanzen**
* **Gesundheitswesen**
* **Medien**
* **Einzelhandel**
![](data:image/jpeg;base64...)  [Mehr darüber](/branchen)
## Ein Messenger, flexible Optionen

 Föderation

Mit stashcat grenzübergreifend kommunizieren: Verbinden Sie sich mit anderen Messengerdiensten und erweitern Sie Ihre föderative Strategie

 Marketplace

stashcat offen für externe Anwendungen: Optimieren Sie Ihren Workflow und nutzen Sie Ihre branchenspezifischen Anwendungen

 Hosting

Ob "On Premise" oder als Cloud-Lösung: Die Hosting-Möglichkeiten richten sich nach Ihren Ansprüchen

 Branding

Nahtlos integriert: stashcat lässt sich in seinem Design individuell an Ihre CI angleichen

 [Mehr über das Produkt](/produkt)
## Für über 8.000 Unternehmen gleichzeitig arbeiten?

 Entdecke jetzt spannende Karrierechancen als Teil des stashcat-Teams und arbeite an einem Tool, von dem Millionen Menschen profitieren. ![](data:image/png;base64...)[Finde deinen Traumjob](/karriere)![](data:image/png;base64...)  Kontaktanfrage

Sie möchten sich unverbindlich beraten lassen?

Wir helfen Ihnen gerne weiter.

Sie haben eine Support-Frage? Nutzen Sie für Fragen zum Produkt und zur Benutzung bitte unser [**Support-Center**.](https://support.stashcat.com/servicedesk/customer/portal/33/user/login?destination=portal%2F33)

 Kontaktdaten Anrede \*FrauHerr Vorname und Nachname \* Unternehmen  Position  E-Mail \* Telefon  Ich möchte:  Angebot erhalten  Persönlich beraten lassen   Anzahl Mitarbeitende \* Nachricht   Sicherheitsabfrage \*  Datenschutz \* Ich erteile der stashcat GmbH meine Einwilligung zur Nutzung und Verarbeitung der von mir angegebenen personenbezogenen Daten zum Zweck der Bearbeitung meiner Anfrage. Mir ist bekannt, dass ich das Recht habe, der Verarbeitung meiner Daten jederzeit mit Wirkung für die Zukunft zu widersprechen. Weitere Informationen zur Verarbeitung von Ihren personenbezogenen Daten finden Sie unter: [Datenschutzerklärung](/datenschutz) SubmitAbschicken Bitte dieses Feld NICHT ausfüllen!        [Zurück zum Anfang](#top)            [![Logo](/fileadmin/user_upload/secunet_stashcat_Logo_by-secunet_white-2.svg)](https://stashcat.com/)             [AGB](/agb "AGB") [Datenschutz](/datenschutz "Datenschutz") [App-Datenschutz](/app-datenschutz "App-Datenschutz") [Hinweisgebersystem](https://www.secunet.com/ueber-uns/hinweisgebersystem "Hinweisgebersystem") [Impressum](/impressum "Impressum")    © 2025 stashcat GmbH            [EN](/en/ "EN")   Schließen

* [Produkt](/produkt "Produkt")    [Produkt](/produkt "Produkt")
* [Funktionen](/funktionen "Funktionen")    [Funktionen](/funktionen "Funktionen")
* [Download + Support](/download-support "Download + Support")    [Download + Support](/download-support "Download + Support")
* [Beratung](/beratung "Beratung")    [Beratung](/beratung "Beratung")
* [Blog](/blog "Blog")    [Blog](/blog "Blog")
* [Karriere](/karriere "Karriere")    [Karriere](/karriere "Karriere")
* [secunet.com](https://www.secunet.com/)    [secunet.com](https://www.secunet.com/)


