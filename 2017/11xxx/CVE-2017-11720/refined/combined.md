=== Content from blogs.gentoo.org_d9898568_20250125_040629.html ===


[agostino's blog](https://blogs.gentoo.org/ago/ "agostino's blog")

my fuzzer always find something more than your…
![](https://blogs.gentoo.org/ago/files/2015/06/cropped-modificato2.png)

[Skip to content](#content "Skip to content")

* [About me](https://blogs.gentoo.org/ago/agostino_sarubbo/)
* [Contact](https://blogs.gentoo.org/ago/contact/)
* [Advisories](https://blogs.gentoo.org/ago/advisories/)

[← ytnef: heap-based buffer overflow in DecompressRTF (ytnef.c)](https://blogs.gentoo.org/ago/2017/05/24/ytnef-heap-based-buffer-overflow-in-decompressrtf-ytnef-c/)
[lame: global-buffer-overflow in II\_step\_one (layer2.c) →](https://blogs.gentoo.org/ago/2017/06/17/lame-global-buffer-overflow-in-ii_step_one-layer2-c/)

# lame: divide-by-zero in parse\_wave\_header (get\_audio.c)

Posted on [June 17, 2017](https://blogs.gentoo.org/ago/2017/06/17/lame-divide-by-zero-in-parse_wave_header-get_audio-c/ "4:51 pm") by [ago](https://blogs.gentoo.org/ago/author/ago/ "View all posts by ago")

**Description**:

[lame](http://lame.sourceforge.net/) is a high quality MPEG Audio Layer III (MP3) encoder licensed under the LGPL.

Few notes before the details of this bug. Time ago a fuzz was done by Brian Carpenter and Jakub Wilk which posted the results on the debian bugtracker. In cases like this, when upstream is not active and people do not post on the upstream bugzilla is easy discover duplicates, so I downloaded all available testcases, and noone of the bug you will see on my blog is a duplicate of an existing issue. Upstream seems a bit dead, latest release was into 2011, so this blog post will probably forwarded on the upstream bugtracker just for the record.

**EDIT:**

This bug was already discovered by Brian Carpenter. There wasn’t mentioned because it is in the frontend, but I guess that many webapplications which offer audio conversion, may run the lame command-line tool directly.

The complete ASan output of the issue:

```
# lame -f -V 9 $FILE out.wav
==26565==ERROR: AddressSanitizer: FPE on unknown address 0x000000519c13 (pc 0x000000519c13 bp 0x7ffd4d07a0d0 sp 0x7ffd4d079e20 T0)
    #0 0x519c12 in parse_wave_header /var/tmp/portage/media-sound/lame-3.99.5-r1/work/lame-3.99.5/frontend/get_audio.c:1454:54
    #1 0x519c12 in parse_file_header /var/tmp/portage/media-sound/lame-3.99.5-r1/work/lame-3.99.5/frontend/get_audio.c:1683
    #2 0x519c12 in open_wave_file /var/tmp/portage/media-sound/lame-3.99.5-r1/work/lame-3.99.5/frontend/get_audio.c:1754
    #3 0x519c12 in init_infile /var/tmp/portage/media-sound/lame-3.99.5-r1/work/lame-3.99.5/frontend/get_audio.c:620
    #4 0x50f273 in init_files /var/tmp/portage/media-sound/lame-3.99.5-r1/work/lame-3.99.5/frontend/lame_main.c:151:9
    #5 0x50befc in lame_main /var/tmp/portage/media-sound/lame-3.99.5-r1/work/lame-3.99.5/frontend/lame_main.c:674:16
    #6 0x510793 in c_main /var/tmp/portage/media-sound/lame-3.99.5-r1/work/lame-3.99.5/frontend/main.c:470:15
    #7 0x510793 in main /var/tmp/portage/media-sound/lame-3.99.5-r1/work/lame-3.99.5/frontend/main.c:438
    #8 0x7f14a792b680 in __libc_start_main /tmp/portage/sys-libs/glibc-2.23-r3/work/glibc-2.23/csu/../csu/libc-start.c:289
    #9 0x41c998 in _init (/usr/bin/lame+0x41c998)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: FPE /var/tmp/portage/media-sound/lame-3.99.5-r1/work/lame-3.99.5/frontend/get_audio.c:1454:54 in parse_wave_header
==26565==ABORTING

```

**Affected version:**

3.99.5

**Fixed version:**

N/A

**Commit fix:**

N/A

**Credit:**

This bug was initially discovered by Brian Carpenter.

**CVE:**

N/A

**Reproducer:**

<https://github.com/asarubbo/poc/blob/master/00289-lame-fpe-get_audio.c.wav>

**Timeline:**

2017-06-01: bug discovered

2017-06-17: blog post about the issue

**Note:**

This bug was found with [American Fuzzy Lop](http://lcamtuf.coredump.cx/afl).

**Permalink:**

> [lame: divide-by-zero in parse\_wave\_header (get\_audio.c)](http://blogs.gentoo.org/ago/2017/06/17/lame-divide-by-zero-in-parse_wave_header-get_audio-c/)

This entry was posted in [advisories](https://blogs.gentoo.org/ago/category/advisories/), [security](https://blogs.gentoo.org/ago/category/security/). Bookmark the [permalink](https://blogs.gentoo.org/ago/2017/06/17/lame-divide-by-zero-in-parse_wave_header-get_audio-c/ "Permalink to lame: divide-by-zero in parse_wave_header (get_audio.c)").

[← ytnef: heap-based buffer overflow in DecompressRTF (ytnef.c)](https://blogs.gentoo.org/ago/2017/05/24/ytnef-heap-based-buffer-overflow-in-decompressrtf-ytnef-c/)
[lame: global-buffer-overflow in II\_step\_one (layer2.c) →](https://blogs.gentoo.org/ago/2017/06/17/lame-global-buffer-overflow-in-ii_step_one-layer2-c/)

### Leave a Reply [Cancel reply](/ago/2017/06/17/lame-divide-by-zero-in-parse_wave_header-get_audio-c/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Authenticate this comment using OpenID.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

* Search for:
* ### Recent Posts

  + [gentoo tinderbox](https://blogs.gentoo.org/ago/2020/07/04/gentoo-tinderbox/)
  + [re2c: heap overflow in Scanner::fill (scanner.cc)](https://blogs.gentoo.org/ago/2020/04/19/re2c-heap-overflow-in-scannerfill-scanner-cc/)
  + [Why I stopped fuzzing research](https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/)
  + [Install Gentoo in less than one minute](https://blogs.gentoo.org/ago/2019/03/20/install-gentoo-in-less-than-one-minute/)
  + [binutils: invalid memory read in find\_abstract\_instance\_name (dwarf2.c)](https://blogs.gentoo.org/ago/2017/10/24/binutils-invalid-memory-read-in-find_abstract_instance_name-dwarf2-c/)
* ### Recent Comments

  + strongcourage on [Why I stopped fuzzing research](https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181437)
  + [Bob Friesenhahn](http://www.graphicsmagick.org/) on [Why I stopped fuzzing research](https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181419)
  + [#gentoo dev: Why I stopped fuzzing research https://blogs.gentoo.or… | Dr. Roy Schestowitz (罗伊)](https://placeholderapi.wordpress.com/2020/04/18/gentoo-dev-why-i-stopped-fuzzing-research-https-blogs-gentoo-or/) on [Why I stopped fuzzing research](https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181400)
  + Ulya on [Why I stopped fuzzing research](https://blogs.gentoo.org/ago/2020/04/16/why-i-stopped-fuzzing-research/#comment-181396)
  + ago on [Install Gentoo in less than one minute](https://blogs.gentoo.org/ago/2019/03/20/install-gentoo-in-less-than-one-minute/#comment-178429)
* ### Archives

  + [July 2020](https://blogs.gentoo.org/ago/2020/07/)
  + [April 2020](https://blogs.gentoo.org/ago/2020/04/)
  + [March 2019](https://blogs.gentoo.org/ago/2019/03/)
  + [October 2017](https://blogs.gentoo.org/ago/2017/10/)
  + [September 2017](https://blogs.gentoo.org/ago/2017/09/)
  + [August 2017](https://blogs.gentoo.org/ago/2017/08/)
  + [July 2017](https://blogs.gentoo.org/ago/2017/07/)
  + [June 2017](https://blogs.gentoo.org/ago/2017/06/)
  + [May 2017](https://blogs.gentoo.org/ago/2017/05/)
  + [April 2017](https://blogs.gentoo.org/ago/2017/04/)
  + [March 2017](https://blogs.gentoo.org/ago/2017/03/)
  + [February 2017](https://blogs.gentoo.org/ago/2017/02/)
  + [January 2017](https://blogs.gentoo.org/ago/2017/01/)
  + [December 2016](https://blogs.gentoo.org/ago/2016/12/)
  + [November 2016](https://blogs.gentoo.org/ago/2016/11/)
  + [October 2016](https://blogs.gentoo.org/ago/2016/10/)
  + [September 2016](https://blogs.gentoo.org/ago/2016/09/)
  + [August 2016](https://blogs.gentoo.org/ago/2016/08/)
  + [July 2016](https://blogs.gentoo.org/ago/2016/07/)
  + [February 2016](https://blogs.gentoo.org/ago/2016/02/)
  + [July 2015](https://blogs.gentoo.org/ago/2015/07/)
  + [August 2013](https://blogs.gentoo.org/ago/2013/08/)
  + [June 2013](https://blogs.gentoo.org/ago/2013/06/)
  + [May 2013](https://blogs.gentoo.org/ago/2013/05/)
  + [January 2013](https://blogs.gentoo.org/ago/2013/01/)
  + [December 2012](https://blogs.gentoo.org/ago/2012/12/)
  + [November 2012](https://blogs.gentoo.org/ago/2012/11/)
  + [October 2012](https://blogs.gentoo.org/ago/2012/10/)
  + [August 2012](https://blogs.gentoo.org/ago/2012/08/)
  + [July 2012](https://blogs.gentoo.org/ago/2012/07/)
  + [June 2012](https://blogs.gentoo.org/ago/2012/06/)
* ### Categories

  + [advisories](https://blogs.gentoo.org/ago/category/advisories/)
  + [arch testing](https://blogs.gentoo.org/ago/category/arch-testing/)
  + [gentoo](https://blogs.gentoo.org/ago/category/gentoo/)
  + [security](https://blogs.gentoo.org/ago/category/security/)
* ### Meta

  + [Log in](https://blogs.gentoo.org/ago/wp-login.php)
  + [Entries feed](https://blogs.gentoo.org/ago/feed/)
  + [Comments feed](https://blogs.gentoo.org/ago/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[agostino's blog](https://blogs.gentoo.org/ago/ "agostino's blog")
Original theme twentyten, modified by csslayer. Better experience in firefox and webkit.

[Proudly powered by WordPress.](http://wordpress.org/ "Semantic Personal Publishing Platform")



=== Content from bugs.debian.org_42253ebd_20250125_040631.html ===

# Debian Bug report logs - #777159 malformed wav causes floating point exception (integer divide by zero)

[![version graph](version.cgi?package=lame;width=2;absolute=0;collapse=1;found=3.99.5;fixed=lame%2F3.99.5%2Brepack1-6;fixed=lame%2F3.99.5%2Brepack1-3%2Bdeb7u1;height=2)](version.cgi?package=lame;info=1;fixed=lame%2F3.99.5%2Brepack1-6;fixed=lame%2F3.99.5%2Brepack1-3%2Bdeb7u1;collapse=1;found=3.99.5;absolute=0)

Package:
[lame](pkgreport.cgi?package=lame);
Maintainer for [lame](pkgreport.cgi?package=lame) is [Debian Multimedia Maintainers <debian-multimedia@lists.debian.org>](pkgreport.cgi?maint=debian-multimedia%40lists.debian.org); Source for [lame](pkgreport.cgi?package=lame) is [src:lame](pkgreport.cgi?src=lame) ([PTS](https://tracker.debian.org/pkg/lame), [buildd](https://buildd.debian.org/lame), [popcon](https://qa.debian.org/popcon.php?package=lame)).

Reported by: [Brian Carpenter <brian.carpenter@gmail.com>](pkgreport.cgi?submitter=brian.carpenter%40gmail.com)

Date: Thu, 5 Feb 2015 18:15:01 UTC

Severity: normal

Found in version 3.99.5

Fixed in versions lame/3.99.5+repack1-6, lame/3.99.5+repack1-3+deb7u1

**Done:** Fabian Greffrath <fabian+debian@greffrath.com>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=777159;mbox=yes), [status mbox](bugreport.cgi?bug=777159;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=777159;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Multimedia Maintainers <pkg-multimedia-maintainers@lists.alioth.debian.org>`:

`Bug#777159`; Package `lame`.
(Thu, 05 Feb 2015 18:15:06 GMT) ([full text](bugreport.cgi?bug=777159;msg=2), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Brian Carpenter <brian.carpenter@gmail.com>`:

New Bug report received and forwarded. Copy sent to `Debian Multimedia Maintainers <pkg-multimedia-maintainers@lists.alioth.debian.org>`.
(Thu, 05 Feb 2015 18:15:06 GMT) ([full text](bugreport.cgi?bug=777159;msg=4), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=777159;msg=5), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=brian.carpenter%40gmail.com)
From: Brian Carpenter <brian.carpenter@gmail.com>
To: submit@bugs.debian.org
Subject: malformed wav causes floating point exception (integer divide by zero)
Date: Thu, 5 Feb 2015 12:12:11 -0600
```
[[Message part 1](bugreport.cgi?att=0;bug=777159;msg=5) (text/plain, inline)]
```
```
Package: lame
Version: 3.99.5

This bug was found with american fuzzy lop (<http://lcamtuf.coredump.cx/afl/>).
I compiled lame as follows:
CC=/path/to/afl-gcc ./configure
AFL_HARDEN=1 make

GDB output:
Program received signal SIGFPE, Arithmetic exception.
[----------------------------------registers-----------------------------------]
RAX: 0x1a68
RBX: 0x816720 --> 0xfbad2498
RCX: 0x1a68
RDX: 0x0
RSI: 0x2b11
RDI: 0x7fd240 --> 0xfff88e3b
RBP: 0x7fd240 --> 0xfff88e3b
RSP: 0x7ffffff31310 --> 0x0
RIP: 0x41df9f (<init_infile+13399>: idiv   r15)
R8 : 0x7ffffff31450 --> 0x7fff00001a68
R9 : 0x7ffff7fde700 (0x00007ffff7fde700)
R10: 0x64000000 ('')
R11: 0x68 ('h')
R12: 0x1a68
R13: 0x2
R14: 0x0
R15: 0x0
EFLAGS: 0x10246 (carry PARITY adjust ZERO sign trap INTERRUPT direction
overflow)
[-------------------------------------code-------------------------------------]
   0x41df8c <init_infile+13380>: mov    DWORD PTR [rip+0x3af156],0x1
 # 0x7cd0ec <global+12>
   0x41df96 <init_infile+13390>: mov    r13d,0x2
   0x41df9c <init_infile+13396>: movsxd r15,r14d
=> 0x41df9f <init_infile+13399>: idiv   r15
   0x41dfa2 <init_infile+13402>: mov    rsi,rax
   0x41dfa5 <init_infile+13405>: call   0x501b90 <lame_set_num_samples>
   0x41dfaa <init_infile+13410>: mov    DWORD PTR [rip+0x3af12c],0x1
 # 0x7cd0e0 <global>
   0x41dfb4 <init_infile+13420>: jmp    0x41ba8b <init_infile+3907>
[------------------------------------stack-------------------------------------]
0000| 0x7ffffff31310 --> 0x0
0008| 0x7ffffff31318 --> 0xffffffffffffffff
0016| 0x7ffffff31320 --> 0x7ffffff313b0 --> 0x7ffff7393af8 -->
0xc001a00000cbb
0024| 0x7ffffff31328 ("id:00000")
0032| 0x7ffffff31330 --> 0x100000000
0040| 0x7ffffff31338 --> 0x1e
0048| 0x7ffffff31340 --> 0x100000000
0056| 0x7ffffff31348 --> 0x3d2ef35793c76730
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGFPE
0x000000000041df9f in parse_wave_header (sf=0x816720, gfp=0x7fd240) at
get_audio.c:1454
1454        (void) lame_set_num_samples(gfp, data_length / (channels *
((bits_per_sample + 7) / 8)));

Valgrind output:
==15646==
==15646== Process terminating with default action of signal 8 (SIGFPE):
dumping core
==15646==  Integer divide by zero at address 0x40342D82D
==15646==    at 0x41DF8C: init_infile (get_audio.c:1452)
==15646==    by 0x406B0A: lame_main (lame_main.c:151)
==15646==    by 0x402604: main (main.c:470)
Floating point exception

I've attached the test case which causes this crash.

Debian 7, kernel v3.2.63-2+deb7u2 x86_64, libc6 v2.13-38+deb7u7

```
```
[[Message part 2](bugreport.cgi?att=1;bug=777159;msg=5) (text/html, inline)]
```
```
[[test00.wav](bugreport.cgi?att=2;bug=777159;filename=test00.wav;msg=5) (audio/x-wav, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Multimedia Maintainers <pkg-multimedia-maintainers@lists.alioth.debian.org>`:

`Bug#777159`; Package `lame`.
(Fri, 06 Feb 2015 08:57:09 GMT) ([full text](bugreport.cgi?bug=777159;msg=7), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Fabian Greffrath <fabian@greffrath.com>`:

Extra info received and forwarded to list. Copy sent to `Debian Multimedia Maintainers <pkg-multimedia-maintainers@lists.alioth.debian.org>`.
(Fri, 06 Feb 2015 08:57:09 GMT) ([full text](bugreport.cgi?bug=777159;msg=9), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 777159@bugs.debian.org ([full text](bugreport.cgi?bug=777159;msg=10), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=fabian%40greffrath.com)
From: Fabian Greffrath <fabian@greffrath.com>
To: Brian Carpenter <brian.carpenter@gmail.com>, 777159@bugs.debian.org
Subject: Re: Bug#777159: malformed wav causes floating point exception
(integer divide by zero)
Date: Fri, 06 Feb 2015 09:52:43 +0100
```
Hi all,

fortunately, this is all in the frontend code in
frontend/get_audio.c:parse_wave_header() and not in the library. The
bits_per_sample value is read from the corrupted file and is 0 in the
case at hand. It is then used without further sanity checking in the
following call

lame_set_num_samples(gfp, data_length / (channels * ((bits_per_sample +
7) / 8)));

in which "bits_per_sample + 7" is 7, divided by 8 is 0, times "channels"
remains 0. Unfortunately, this is the denominator of the division. Maybe
we should "return -1" early if (bits_per_sample < 1).

- Fabian

```

---

**Reply sent**
to `Fabian Greffrath <fabian+debian@greffrath.com>`:

You have taken responsibility.
(Mon, 09 Feb 2015 09:24:21 GMT) ([full text](bugreport.cgi?bug=777159;msg=12), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=12), [link](#11)).

---

**Notification sent**
to `Brian Carpenter <brian.carpenter@gmail.com>`:

Bug acknowledged by developer.
(Mon, 09 Feb 2015 09:24:21 GMT) ([full text](bugreport.cgi?bug=777159;msg=14), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 777159-close@bugs.debian.org ([full text](bugreport.cgi?bug=777159;msg=15), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=fabian%2Bdebian%40greffrath.com)
From: Fabian Greffrath <fabian+debian@greffrath.com>
To: 777159-close@bugs.debian.org
Subject: Bug#777159: fixed in lame 3.99.5+repack1-6
Date: Mon, 09 Feb 2015 09:20:54 +0000
```
Source: lame
Source-Version: 3.99.5+repack1-6

We believe that the bug you reported is fixed in the latest version of
lame, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 777159@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Fabian Greffrath <fabian+debian@greffrath.com> (supplier of updated lame package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Mon, 09 Feb 2015 07:11:42 +0100
Source: lame
Binary: lame lame-doc libmp3lame0 libmp3lame-dev
Architecture: source amd64 all
Version: 3.99.5+repack1-6
Distribution: unstable
Urgency: high
Maintainer: Debian Multimedia Maintainers <pkg-multimedia-maintainers@lists.alioth.debian.org>
Changed-By: Fabian Greffrath <fabian+debian@greffrath.com>
Description:
 lame       - MP3 encoding library (frontend)
 lame-doc   - MP3 encoding library (documentation)
 libmp3lame-dev - MP3 encoding library (development)
 libmp3lame0 - MP3 encoding library
Closes: [775955](bugreport.cgi?bug=775955) [775959](bugreport.cgi?bug=775959) [777159](bugreport.cgi?bug=777159) [777160](bugreport.cgi?bug=777160) [777161](bugreport.cgi?bug=777161)
Changes:
 lame (3.99.5+repack1-6) unstable; urgency=high
 .
   * Do not mangle CFLAGS in debian/rules anymore, leave this to
     dpkg-buildflags (Closes: #[775955](bugreport.cgi?bug=775955)). Thanks, Jakub Wilk.
   * Add check for invalid input sample rate, thanks Maks Naumov
     (Closes: #[775959](bugreport.cgi?bug=775959), #[777160](bugreport.cgi?bug=777160), #[777161](bugreport.cgi?bug=777161)). Thanks Jakub Wilk and
     Brian Carpenter for the bug reports and test cases.
   * Remove chunks modifying */Makefile.in from parallel-builds-fix.patch,
     we are running autoreconf anyway.
   * Remove unbreak-ftbfs-gcc4.4.patch, does not apply anymore.
   * Avoid malformed wav causing floating point exception in the frontend
     (Closes: #[777159](bugreport.cgi?bug=777159)).
Checksums-Sha1:
 bef2b697b4be1890467eba7c9a8315db2bd81ad0 2222 lame_3.99.5+repack1-6.dsc
 424b365d6f174de57b0bbd1b15b832bc6f3d5f05 13756 lame_3.99.5+repack1-6.debian.tar.xz
 3e91584967131a8a2d7901d21c28aff1db9f997e 270752 lame_3.99.5+repack1-6_amd64.deb
 5c0e8326ef94c8a330537a492e221618287eea28 286370 lame-doc_3.99.5+repack1-6_all.deb
 6c5a03b0e73eceb6f53260e6831bccd1b06fa6ff 352150 libmp3lame0_3.99.5+repack1-6_amd64.deb
 4c964fa181a42b9bd9d4189b30f4446a5915c13f 368810 libmp3lame-dev_3.99.5+repack1-6_amd64.deb
Checksums-Sha256:
 187aabe22c1860a5264cd2ebc9fbfc11fc9171561c952ce6b99f0e38134edb3e 2222 lame_3.99.5+repack1-6.dsc
 6f51abef5c629218e0a028d92974593894a8294eb668c7a33b5d8befb1865ae9 13756 lame_3.99.5+repack1-6.debian.tar.xz
 b9e0b5b7caaef37242930caf2acc3c14aee7425de09fa77822cee72ebb86d812 270752 lame_3.99.5+repack1-6_amd64.deb
 3e3ee597d1a6163e4810421aecfbbf36f8b44ec2b8afba29ac8f9f337faeec00 286370 lame-doc_3.99.5+repack1-6_all.deb
 7fe1373c3fae7677e70f9fe70cfc5587aabef158d22ab85cc7a66c77c8151862 352150 libmp3lame0_3.99.5+repack1-6_amd64.deb
 50589c4728f34ffbca96a65c06ee4ac177f7ff38282b6c9bcca27ab18cf9bd74 368810 libmp3lame-dev_3.99.5+repack1-6_amd64.deb
Files:
 4451cfd20f74dd929db14ad5cabedef9 2222 sound optional lame_3.99.5+repack1-6.dsc
 2f6ee33e9b7e77e9cd6350054f03ef99 13756 sound optional lame_3.99.5+repack1-6.debian.tar.xz
 434f779fd42d8f1e6d09f69b5acc1b4e 270752 sound optional lame_3.99.5+repack1-6_amd64.deb
 642bd60a76ac15750930383c96c52f84 286370 doc optional lame-doc_3.99.5+repack1-6_all.deb
 8ba894225629716a115f534773ee54ef 352150 libs optional libmp3lame0_3.99.5+repack1-6_amd64.deb
 3504d6ff3b73fa8b73377c82d8bd7379 368810 libdevel optional libmp3lame-dev_3.99.5+repack1-6_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJU2GaYAAoJEMvqjpcMzVnfbHoQAKN7YuxuP1iNsxUxwG6RUMFz
58F9JK9+bHKSFeiL5KG1oat8H2d2I+NyF0HKRgaOFQY1leejAxZ+yqNLTB/Qfc0D
dwliboMcu4E2nN8XjiMcBHKpBFL/Rzbl3Uo1BRZPwlaaBawzUyTiQgCQSqrJCe+k
6ySta6uQzXMkhgwtMZdUIQppHIYmQv0MpsJGFelWkGvWa7v7qvITdRf4IieDQuwS
a3nEW+lFmJoBuHjiMHDBcvaws2sDeISfBsObgDlqiljCoXoL0tB4qF72a+pRE23q
OziSDfMm1f1+nbg0rVanIFfhNURS45h9bEj62LdCy2Ol2qZEHATUMAePK74vG1CP
fcTU6vjjSUgKtnSpqO/havoHi9XA7Y+wpG/ORIpMaC41+lEGSFd9uR8vZ3AjM3HB
wz4yUshHVQkrS4UjY8i4QgZtOLbpOcs6ZhyxLl/COJqPPiP3xxtL0lkJegZBoRdQ
XLTb5grJefea67o8BFKfdpWqYr/7aUgoDqcD+/fHeF3ZdRvfk6uxADlv0PpTUrHa
TsvGoHnhT2a9fI8jHegt7lbHQ0elJKm6Q+90xdrCCsvDQfDz2yh5LOAJ2jK7o6J7
qv9RnCrVIZ8KKHhnYSopiQx+x/QWeQgQA3pqNuWW6QrXtAp0Vo9K3fq5VXtbaRcA
71Nnbcvzdkqpm1k+DV2R
=X2Lb
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Multimedia Maintainers <pkg-multimedia-maintainers@lists.alioth.debian.org>`:

`Bug#777159`; Package `lame`.
(Thu, 26 Feb 2015 04:45:11 GMT) ([full text](bugreport.cgi?bug=777159;msg=17), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Brian Carpenter <brian.carpenter@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Debian Multimedia Maintainers <pkg-multimedia-maintainers@lists.alioth.debian.org>`.
(Thu, 26 Feb 2015 04:45:11 GMT) ([full text](bugreport.cgi?bug=777159;msg=19), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 777159@bugs.debian.org ([full text](bugreport.cgi?bug=777159;msg=20), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=brian.carpenter%40gmail.com)
From: Brian Carpenter <brian.carpenter@gmail.com>
To: 777159@bugs.debian.org
Date: Wed, 25 Feb 2015 22:40:22 -0600
```
[[Message part 1](bugreport.cgi?att=0;bug=777159;msg=20) (text/plain, inline)]
```
```
Are we sure this is fixed? I just cloned the cvs repo for lame on
sourceforge and compiled it (LAME 64bits version 3.100 (alpha 2, Feb 26
2015 04:31:03) (<http://lame.sf.net)>) and ran it against AFL and I'm still
seeing an FPE:

==30731== Process terminating with default action of signal 8 (SIGFPE):
dumping core
==30731==  Integer divide by zero at address 0x8040BE4D7
==30731==    at 0x41CB4E: parse_wave_header (get_audio.c:1462)
==30731==    by 0x41CB4E: parse_file_header (get_audio.c:1697)
==30731==    by 0x41CB4E: open_wave_file (get_audio.c:1809)
==30731==    by 0x41CB4E: init_infile (get_audio.c:622)
==30731==    by 0x4055FE: init_files (lame_main.c:116)
==30731==    by 0x4055FE: lame_main (lame_main.c:636)
==30731==    by 0x402410: c_main (main.c:470)
==30731==    by 0x402410: main (main.c:438)
Floating point exception

gdb-peda$ file ~/lame/frontend/lame
gdb-peda$ set args -V2 --preset insane test00 /dev/null
gdb-peda$ r
warning: Could not load shared library symbols for linux-vdso.so.1.
Do you need "set solib-search-path" or "set sysroot"?

Program received signal SIGFPE, Arithmetic exception.
[----------------------------------registers-----------------------------------]
RAX: 0x10
RBX: 0x7ff2d0 --> 0xfbad2488
RCX: 0x0
RDX: 0x0
RSI: 0x0
RDI: 0x7e52b0 --> 0xfff88e3b
RBP: 0x7e52b0 --> 0xfff88e3b
RSP: 0x7ffffff31f90 --> 0x0
RIP: 0x41cb72 (<init_infile+13970>:     div    r15)
R8 : 0x0
R9 : 0x10
R10: 0x0
R11: 0x0
R12: 0x7fffffffba50 --> 0x303074736574 ('test00')
R13: 0xe
R14: 0x0
R15: 0x0
EFLAGS: 0x10206 (carry PARITY adjust zero sign trap INTERRUPT direction
overflow)
[-------------------------------------code-------------------------------------]
   0x41cb67 <init_infile+13959>:        sar    r8d,0x3
   0x41cb6b <init_infile+13963>:        imul   r8d,r15d
   0x41cb6f <init_infile+13967>:        movsxd r15,r8d
=> 0x41cb72 <init_infile+13970>:        div    r15
   0x41cb75 <init_infile+13973>:        mov    rsi,rax
   0x41cb78 <init_infile+13976>:        call   0x4e6360
<lame_set_num_samples>
   0x41cb7d <init_infile+13981>:        mov    rdi,rbp
   0x41cb80 <init_infile+13984>:        call   0x4e64e0
<lame_get_num_samples>
[------------------------------------stack-------------------------------------]
0000| 0x7ffffff31f90 --> 0x0
0008| 0x7ffffff31f98 --> 0x7361622f00000000 ('')
0016| 0x7ffffff31fa0 --> 0x5622 ('"V')
0024| 0x7ffffff31fa8 --> 0x7e5210 --> 0x0
0032| 0x7ffffff31fb0 --> 0x0
0040| 0x7ffffff31fb8 --> 0xff00
0048| 0x7ffffff31fc0 --> 0x7ffffff31ff0 --> 0x7ffff72f3058 -->
0xc001a00000ce0
0056| 0x7ffffff31fc8 --> 0x3ff0000000000000
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGFPE
0x000000000041cb72 in init_infile ()

Hexdump of the offending test case:
0000000 4952 4646 0032 0000 4157 4556 6d66 2074
0000010 0010 0000 0001 0001 5622 0000 ac44 0000
0000020 0002 0000 6164 6174 0010 0000 0000 0000
0000030 0000 0000 0000 0000 0000
000003a

```
```
[[Message part 2](bugreport.cgi?att=1;bug=777159;msg=20) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Multimedia Maintainers <pkg-multimedia-maintainers@lists.alioth.debian.org>`:

`Bug#777159`; Package `lame`.
(Thu, 26 Feb 2015 07:00:04 GMT) ([full text](bugreport.cgi?bug=777159;msg=22), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent**
to `Fabian Greffrath <fabian@greffrath.com>`:

Extra info received and forwarded to list. Copy sent to `Debian Multimedia Maintainers <pkg-multimedia-maintainers@lists.alioth.debian.org>`.
(Thu, 26 Feb 2015 07:00:04 GMT) ([full text](bugreport.cgi?bug=777159;msg=24), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 777159@bugs.debian.org ([full text](bugreport.cgi?bug=777159;msg=25), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=fabian%40greffrath.com)
From: Fabian Greffrath <fabian@greffrath.com>
To: Brian Carpenter <brian.carpenter@gmail.com>, 777159@bugs.debian.org
Subject: Re: Bug#777159:
Date: Thu, 26 Feb 2015 07:57:15 +0100
```
Am Mittwoch, den 25.02.2015, 22:40 -0600 schrieb Brian Carpenter:
> Are we sure this is fixed? I just cloned the cvs repo for lame on
> sourceforge and compiled it (LAME 64bits version 3.100 (alpha 2, Feb
> 26 2015 04:31:03) (<http://lame.sf.net)>) and ran it against AFL and I'm
> still seeing an FPE:

I have never claimed it is already fixed upstream. I have merely patched
the Debian package to not crash for this sample anymore. Please try your
tests with the -7 package currently in Debian unstable.

However, upstream is informed about our patches and of course they are
free to apply them if they find appropriate.

Cheers,

Fabian

```

---

**Reply sent**
to `Fabian Greffrath <fabian+debian@greffrath.com>`:

You have taken responsibility.
(Sat, 28 Feb 2015 18:06:26 GMT) ([full text](bugreport.cgi?bug=777159;msg=27), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=27), [link](#26)).

---

**Notification sent**
to `Brian Carpenter <brian.carpenter@gmail.com>`:

Bug acknowledged by developer.
(Sat, 28 Feb 2015 18:06:26 GMT) ([full text](bugreport.cgi?bug=777159;msg=29), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 777159-close@bugs.debian.org ([full text](bugreport.cgi?bug=777159;msg=30), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=fabian%2Bdebian%40greffrath.com)
From: Fabian Greffrath <fabian+debian@greffrath.com>
To: 777159-close@bugs.debian.org
Subject: Bug#777159: fixed in lame 3.99.5+repack1-3+deb7u1
Date: Sat, 28 Feb 2015 18:03:36 +0000
```
Source: lame
Source-Version: 3.99.5+repack1-3+deb7u1

We believe that the bug you reported is fixed in the latest version of
lame, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 777159@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Fabian Greffrath <fabian+debian@greffrath.com> (supplier of updated lame package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Tue, 24 Feb 2015 09:46:48 +0100
Source: lame
Binary: lame lame-doc libmp3lame0 libmp3lame-dev
Architecture: source amd64 all
Version: 3.99.5+repack1-3+deb7u1
Distribution: wheezy
Urgency: medium
Maintainer: Debian multimedia packages maintainers <pkg-multimedia-maintainers@lists.alioth.debian.org>
Changed-By: Fabian Greffrath <fabian+debian@greffrath.com>
Description:
 lame       - MP3 encoding library (frontend)
 lame-doc   - MP3 encoding library (documentation)
 libmp3lame-dev - MP3 encoding library (development)
 libmp3lame0 - MP3 encoding library
Closes: [775959](bugreport.cgi?bug=775959) [777159](bugreport.cgi?bug=777159) [777160](bugreport.cgi?bug=777160) [777161](bugreport.cgi?bug=777161) [778529](bugreport.cgi?bug=778529) [778703](bugreport.cgi?bug=778703)
Changes:
 lame (3.99.5+repack1-3+deb7u1) wheezy; urgency=medium
 .
   * Add check for invalid input sample rate, thanks Maks Naumov
     (Closes: #[775959](bugreport.cgi?bug=775959), #[777160](bugreport.cgi?bug=777160), #[777161](bugreport.cgi?bug=777161)). Thanks Jakub Wilk and
     Brian Carpenter for the bug reports and test cases.
   * Extend Maks Naumov's patch to also include a sanity check for
     a valid amount of input channels (Closes: #[778703](bugreport.cgi?bug=778703)).
   * Avoid malformed wav causing floating point exception in the
     frontend (Closes: #[777159](bugreport.cgi?bug=777159)).
   * Fix decision if sample rate ratio is an integer value or not
     (Closes: #[778529](bugreport.cgi?bug=778529)). Thanks to Henri Salo for the bug reports
     and the fuzzed samples!
Checksums-Sha1:
 38832155db1ae5789a4fa66f0403b6e177f5cb5c 2250 lame_3.99.5+repack1-3+deb7u1.dsc
 92ab7a4eb5ba00b2dfae3852c41e26ac7b9ef636 13987 lame_3.99.5+repack1-3+deb7u1.debian.tar.gz
 ae693c1c10d88ea7b1929d551f10dd802a78ec18 279810 lame_3.99.5+repack1-3+deb7u1_amd64.deb
 f3c4c40dfc09d3737cd827631e8f94289d44feb9 296004 lame-doc_3.99.5+repack1-3+deb7u1_all.deb
 8e4a90f838a5ffe5220657087dc71e21b137f064 413878 libmp3lame0_3.99.5+repack1-3+deb7u1_amd64.deb
 b1b565c32557a7335e0f82be0d946f7353829af4 451362 libmp3lame-dev_3.99.5+repack1-3+deb7u1_amd64.deb
Checksums-Sha256:
 40311ff26ede470a373225e7c69a3a69c4e48a25cf63c2f14e0c53c06cb4516b 2250 lame_3.99.5+repack1-3+deb7u1.dsc
 a4e3819241382ef96e16a36cfa39041f22772b7aa2b8358ec33c3b823cfb6482 13987 lame_3.99.5+repack1-3+deb7u1.debian.tar.gz
 4cd29d1c91b6f16e11956c74b6d94f41f357eeecc2f775f3ffdcf39e4427949d 279810 lame_3.99.5+repack1-3+deb7u1_amd64.deb
 d07ac2f8f08bc2fdf3fce72cc583467d3f7fe784f9b932b84047cd152ba21604 296004 lame-doc_3.99.5+repack1-3+deb7u1_all.deb
 20f4e1d1b5e3cb2cf689d9d68291fa0276add303d988386f518faae36fc238ef 413878 libmp3lame0_3.99.5+repack1-3+deb7u1_amd64.deb
 d675730777c481ffa66e30bf97d2c400275b32f1af36a839f91bb1f6f183fe55 451362 libmp3lame-dev_3.99.5+repack1-3+deb7u1_amd64.deb
Files:
 240dc9f80c9016c7f1b99ae1f18ad644 2250 sound optional lame_3.99.5+repack1-3+deb7u1.dsc
 cae33c8d915ab4a7d84edc3cce64f2e8 13987 sound optional lame_3.99.5+repack1-3+deb7u1.debian.tar.gz
 e45e70276d154ac20b872ee1ed95bc7a 279810 sound optional lame_3.99.5+repack1-3+deb7u1_amd64.deb
 568fee660f20860b930aa39987ee5a24 296004 doc optional lame-doc_3.99.5+repack1-3+deb7u1_all.deb
 4ed9ed9c722c69eb112ccb782df3ad2d 413878 libs optional libmp3lame0_3.99.5+repack1-3+deb7u1_amd64.deb
 50a815012cf846f78edafa116d70c950 451362 libdevel optional libmp3lame-dev_3.99.5+repack1-3+deb7u1_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJU7IYrAAoJEMvqjpcMzVnfm2oQALwxODTxUC+ah2wUV3VUo4U2
MdqzJRtrZJyRO+CjGhgLnb3rYbphVKzX9OdU6hHgOsezYktvNl95fbKUNrNONbUR
2gmjdBI8sCgEsr7x+3q04j2uaIa4HTzcsI9kxIJAriCjxLz4HxcCp5NcV3w/Qa6c
0xVsqUINwkiQgTJbTuJg7XzIuaB5Wf4/AeGhOuKwgaynrqBDItzj0ORr2Ah0TDNt
SkznoRjlpio6+sJGvMFBGT9FmSoezay9h6X3jPOb9pFcay3sMebQSAV8DPSM09rq
NM4rCUbPusiTUZK9lD+ydV2ACqprVZ2FIGSMZ2NqTN63MhdsBwIcY1j1flNzy1o2
+lvJMi5r1EMMfhF0hs4xIk+FBu5y06Bxa/SYzeS4t4ZEWuhX3jEZbzTlCPy8+loW
MLX1/V7kwaVfV1xAhmFlebkP892imDDPpSRwT+bHs6clNdRdyAd/NpPt3eEAsBxB
1p04byqa+5PKQOokvYJbdnzBQI2v2Je2+ZF0+ocU619DxQv+vAOG8h8gKrUgI6Up
bBK7q5kZ1+FePwr0qkcUUY4ZTnpmQs+GquBlzIqajw8Jnh9f8vlpMhSTi/iTWBdc
VAULVSCJxdI+JhpOyltX7bnNRgYQ/f/vx7NKQfJ4Z9vmkPOt4TRHinoUM9LYg7LO
C5Nx/m0HLh8o5Xxr/87D
=MKWs
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 29 Mar 2015 07:28:23 GMT) ([full text](bugreport.cgi?bug=777159;msg=32), [mbox](bugreport.cgi?bug=777159;mbox=yes;msg=32), [link](#31)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=777159).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 04:06:30 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


