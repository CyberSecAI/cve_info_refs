- **Root cause of vulnerability:** Improper sanitization of system commands within the restricted shell interface. The `less` command, while allowed in the restricted shell, permits the execution of shell commands via the `!sh` sequence.
- **Weaknesses/vulnerabilities present:** Command injection vulnerability (CWE-78) due to insufficient input sanitization in the restricted shell, and specifically in the usage of the `less` command.
- **Impact of exploitation:** An attacker can gain unrestricted shell access as the `admin` user on the affected appliance. This would allow for full system control, including data exfiltration, system manipulation, and further network attacks.
- **Attack vectors:**
  - Network access via SSH (port 22) or ShellInTheBox (port 222).
  - Exploitation occurs after authenticating with the default admin credentials (admin/bhu85tgb).
- **Required attacker capabilities/position:**
  - Network access to the affected appliance on port 22 or 222.
  - Knowledge of the default administrator credentials (admin/bhu85tgb).
  - Ability to authenticate with the device using SSH or ShellInTheBox