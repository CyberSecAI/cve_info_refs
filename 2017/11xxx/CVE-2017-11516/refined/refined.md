The content relates to CVE-2017-11516.

**Root cause of vulnerability:**
The error handler in debug mode was not properly escaping error information, specifically the `errorInfo` from `yii\db\Exception`, before displaying it. The `print_r` function was used to format the error information, but its result was not being escaped before being output to the HTML page.

**Weaknesses/vulnerabilities present:**
- Improper output escaping. The `errorInfo` from `yii\db\Exception` can contain arbitrary data, including HTML markup. Without proper escaping, this data is directly rendered in the browser which can lead to Cross-Site Scripting (XSS) vulnerabilities.

**Impact of exploitation:**
- Cross-Site Scripting (XSS). An attacker could potentially inject malicious scripts via database error messages if the application is in debug mode. This could lead to various attacks including session hijacking, cookie theft, and phishing.

**Attack vectors:**
- Injecting malicious HTML or Javascript into database error messages that are then displayed by the error handler in debug mode.

**Required attacker capabilities/position:**
- The attacker needs to be able to trigger a database error and control the content of that error message, specifically within the `errorInfo` attribute. The attacker does not need direct access to the server since they can trigger the database error through normal means like inputting malformed data. The application needs to be in debug mode for the exploit to work.