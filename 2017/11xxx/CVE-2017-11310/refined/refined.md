The provided content relates to CVE-2017-11310.

**Root cause of vulnerability:**
The vulnerability stems from a memory leak in the `read_user_chunk_callback` function within `png.c`. This occurs when processing malformed PNG files with specific user-defined chunks.

**Weaknesses/vulnerabilities present:**
The vulnerability is a memory leak. The `read_user_chunk_callback` function in `png.c` allocates memory for processing user-defined chunks, but fails to free the allocated memory under certain conditions, specifically when a chunk is malformed.

**Impact of exploitation:**
Successful exploitation leads to a denial-of-service (DoS) by causing a memory leak. Repeated processing of malicious PNG files will exhaust available memory, potentially crashing the application or system.

**Attack vectors:**
The attack vector is through processing a crafted PNG image file containing a specific type of malformed user-defined chunk that triggers the memory leak within the `read_user_chunk_callback` function.

**Required attacker capabilities/position:**
An attacker needs to be able to provide a crafted PNG file to an application or system that uses ImageMagick to process the image.

**Additional details:**

- The vulnerability is located in the `read_user_chunk_callback` function in `coders/png.c` of ImageMagick.
- The issue was reported in ImageMagick version 7.0.6-1 Q16 x86_64 2017-06-21.
- The fix for this issue was implemented by adding a call to `DestroyStringInfo` to free the allocated memory. This commit is identified as `8ca35831e91c3db8c6d281d09b605001003bec08`.
- The provided test case `read_user_chunk_callback.png` shows the crafted file format. The chunk ID is `ffff` and contains malformed data, triggering the memory leak.