```
{
  "CVE-2017-11103": {
    "Description": "Heimdal before 7.4 allows remote attackers to impersonate services with Orpheus' Lyre attacks because it obtains service-principal names in a way that violates the Kerberos 5 protocol specification. In \\_krb5\\_extract\\_ticket() the KDC-REP service name must be obtained from the encrypted version stored in 'enc\\_part' instead of the unencrypted version stored in 'ticket'. Use of the unencrypted version provides an opportunity for successful server impersonation and other attacks. NOTE: this CVE is only for Heimdal and other products that embed Heimdal code; it does not apply to other instances in which this part of the Kerberos 5 protocol specification is violated.",
    "Root cause of vulnerability": "The Heimdal implementation used an unauthenticated, plain-text version of the KDC-REP service name found in a ticket, instead of the authenticated and encrypted KDC response. This occurs because the KDC-REP service name is obtained from the unencrypted 'ticket' rather than the encrypted 'enc_part'.",
    "Weaknesses/vulnerabilities present": "Improper validation of the KDC-REP service name. Specifically, using the unencrypted service name from the ticket instead of the encrypted one from 'enc_part'",
    "Impact of exploitation": "An attacker with a privileged network position can impersonate services to the client, allowing a man-in-the-middle (MITM) attack that circumvents mutual authentication. This can lead to remote credential theft and privilege escalation.",
    "Attack vectors": "Man-in-the-middle attack on the network between a client and a service or KDC.",
    "Required attacker capabilities/position": "The attacker needs to be on-path (logically, at least) between the victim client and the service or KDC."
  }
}
```