```
{
  "Root cause of vulnerability": "The vulnerability is due to a bypass in the Windows Lockdown Policy (WLDP) check for COM class instantiation within MSHTML hosts.  Instead of using the allowed CLSIDs directly, an attacker can use a TreatAs registry key to redirect a limited allowed CLSID to an arbitrary class.",
  "Weaknesses/vulnerabilities present": "The vulnerability lies in the way MSHTML parses the classid attribute in an OBJECT tag. It checks the initial CLSID against the WLDP but proceeds to create a potentially different object due to the TreatAs key during the CoCreateInstance call.",
  "Impact of exploitation": "Successful exploitation allows for arbitrary code execution on systems with User Mode Code Integrity (UMCI) enabled, such as systems with Device Guard.",
  "Attack vectors": "The attack uses a specially crafted HTML file with an OBJECT tag. A registry modification via a REGINI formatted file is also necessary to set up the TreatAs key.",
  "Required attacker capabilities/position": "The attacker needs to modify the registry, which can be done with regini.exe even on systems where reg.exe is blocked. The attacker also needs to be able to get a user to execute the malicious HTML file, which can be done via local HTML help or Internet Explorer. The HTML file should not have a Mark-of-the-Web (MOTW) flag."
}
```