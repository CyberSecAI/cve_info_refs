=== Content from git.kernel.org_c5c9ec5e_20250126_053429.html ===


| [cgit logo](/) | [index](/) : [kernel/git/gregkh/char-misc.git](/pub/scm/linux/kernel/git/gregkh/char-misc.git/) | char-misc-linus char-misc-next char-misc-testing main master |
| --- | --- | --- |
| Char/Misc drivers development tree | Greg Kroah-Hartman |

| [about](/pub/scm/linux/kernel/git/gregkh/char-misc.git/about/)[summary](/pub/scm/linux/kernel/git/gregkh/char-misc.git/)[refs](/pub/scm/linux/kernel/git/gregkh/char-misc.git/refs/?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)[log](/pub/scm/linux/kernel/git/gregkh/char-misc.git/log/)[tree](/pub/scm/linux/kernel/git/gregkh/char-misc.git/tree/?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)[commit](/pub/scm/linux/kernel/git/gregkh/char-misc.git/commit/?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)[diff](/pub/scm/linux/kernel/git/gregkh/char-misc.git/diff/?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)[stats](/pub/scm/linux/kernel/git/gregkh/char-misc.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Willy Tarreau <w@1wt.eu> | 2017-05-16 19:18:55 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2017-05-16 23:05:20 +0200 |
| commit | [3e21f4af170bebf47c187c1ff8bf155583c9f3b1](/pub/scm/linux/kernel/git/gregkh/char-misc.git/commit/?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1) ([patch](/pub/scm/linux/kernel/git/gregkh/char-misc.git/patch/?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)) | |
| tree | [276f65a380b1f288c65b17a7a11819fcd971e493](/pub/scm/linux/kernel/git/gregkh/char-misc.git/tree/?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1) | |
| parent | [2ea659a9ef488125eb46da6eb571de5eae5c43f6](/pub/scm/linux/kernel/git/gregkh/char-misc.git/commit/?id=2ea659a9ef488125eb46da6eb571de5eae5c43f6) ([diff](/pub/scm/linux/kernel/git/gregkh/char-misc.git/diff/?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1&id2=2ea659a9ef488125eb46da6eb571de5eae5c43f6)) | |
| download | [char-misc-3e21f4af170bebf47c187c1ff8bf155583c9f3b1.tar.gz](/pub/scm/linux/kernel/git/gregkh/char-misc.git/snapshot/char-misc-3e21f4af170bebf47c187c1ff8bf155583c9f3b1.tar.gz) | |

char: lp: fix possible integer overflow in lp\_setup()The lp\_setup() code doesn't apply any bounds checking when passing
"lp=none", and only in this case, resulting in an overflow of the
parport\_nr[] array. All versions in Git history are affected.
Reported-By: Roee Hay <roee.hay@hcl.com>
Cc: Ben Hutchings <ben@decadent.org.uk>
Cc: stable@vger.kernel.org
Signed-off-by: Willy Tarreau <w@1wt.eu>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/gregkh/char-misc.git/diff/?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)

| -rw-r--r-- | [drivers/char/lp.c](/pub/scm/linux/kernel/git/gregkh/char-misc.git/diff/drivers/char/lp.c?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/drivers/char/lp.c b/drivers/char/lp.cindex 565e4cf04a0215..8249762192d55e 100644--- a/[drivers/char/lp.c](/pub/scm/linux/kernel/git/gregkh/char-misc.git/tree/drivers/char/lp.c?id=2ea659a9ef488125eb46da6eb571de5eae5c43f6)+++ b/[drivers/char/lp.c](/pub/scm/linux/kernel/git/gregkh/char-misc.git/tree/drivers/char/lp.c?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)@@ -859,7 +859,11 @@ static int \_\_init lp\_setup (char \*str) } else if (!strcmp(str, "auto")) { parport\_nr[0] = LP\_PARPORT\_AUTO; } else if (!strcmp(str, "none")) {- parport\_nr[parport\_ptr++] = LP\_PARPORT\_NONE;+ if (parport\_ptr < LP\_NO)+ parport\_nr[parport\_ptr++] = LP\_PARPORT\_NONE;+ else+ printk(KERN\_INFO "lp: too many ports, %s ignored.\n",+ str); } else if (!strcmp(str, "reset")) { reset = 1; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-26 05:33:06 +0000



=== Content from alephsecurity.com_dc8decb0_20250125_025351.html ===

[<-- ×](/)

# Linux lp.c Out-of-Bounds Write via Kernel Command-line

Aleph Research Advisory

## Identifier

[CVE-2017-1000363](/vulns/aleph-2017023)
## Severity

Moderate
## Products

1. Linux
## Vulnerable Versions

1. Linux 4.12-rc1 and below
2. Linux 3.x
3. Linux 2.6.x
4. Linux 2.4.x
5. Linux 2.2.x
## Mitigation

Patch has been committed to the mainline tree, available in the 4.12-rc2 release. 3.18 / 4.4 / 4.9 / 4.11 stable releases with the patch are also available (see timeline).

## Technical Details

Due to a missing bounds check, and the fact that `parport_ptr` integer is static, a kernel command-line adversary (can happen due to bootloader vulnerabilities in Secure Boot environments, e.g. [CVE-2016-10277](/vulns/aleph-2017011)) can overflow the `parport_nr` array in the following code, by appending many (`>LP_NO`) `lp=none` arguments to the command line.

```
static int parport_nr[LP_NO] = { [0 ... LP_NO-1] = LP_PARPORT_UNSPEC };
static char *parport[LP_NO];
[...]
#ifndef MODULE
static int __init lp_setup (char *str)
{
static int parport_ptr;
[...]
} else if (!strncmp(str, "parport", 7)) {
    int n = simple_strtoul(str+7, NULL, 10);
    if (parport_ptr < LP_NO)
        parport_nr[parport_ptr++] = n;
    else
        printk(KERN_INFO "lp: too many ports, %s ignored.\n",
               str);
} else if (!strcmp(str, "auto")) {
    parport_nr[0] = LP_PARPORT_AUTO;
} else if (!strcmp(str, "none")) {
    parport_nr[parport_ptr++] = LP_PARPORT_NONE;
[...]
#endif
[...]
__setup("lp=", lp_setup);

```
## Patch

As per our report, Willy Tarreau commited the following patch:

```
diff --git a/drivers/char/lp.c b/drivers/char/lp.c
index 565e4cf..8249762 100644
--- a/drivers/char/lp.c
+++ b/drivers/char/lp.c
@@ -859,7 +859,11 @@ static int __init lp_setup (char *str)
 	} else if (!strcmp(str, "auto")) {
 		parport_nr[0] = LP_PARPORT_AUTO;
 	} else if (!strcmp(str, "none")) {
-		parport_nr[parport_ptr++] = LP_PARPORT_NONE;
+		if (parport_ptr < LP_NO)
+			parport_nr[parport_ptr++] = LP_PARPORT_NONE;
+		else
+			printk(KERN_INFO "lp: too many ports, %s ignored.\n",
+			       str);
 	} else if (!strcmp(str, "reset")) {
 		reset = 1;
 	}

```

## Timeline

* 30-May-17: Deadline.
* 25-May-17: [Patch available](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?h=v4.9.30&id=5d263d94a870a774a24acb2a2cc1e79ef39c2416) (Linux 4.9.30).
* 25-May-17: [Patch available](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?h=v4.11.3&id=28c7411cdbc41396dceff7e1b37dbb659f7bdfb2) (Linux 4.11.3).
* 25-May-17: [Patch available](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?h=v4.4.70&id=cda5c7e625cefed46311cb0b37816fb2ff42a8ee) (Linux 4.4.70).
* 25-May-17: [Patch available](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git/commit/?h=v3.18.55&id=f4615841767ff7908599e643f587078670a390c9) (Linux 3.18.55).
* 23-May-17: Public disclosure.
* 22-May-17: [Patch available](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?h=v4.12-rc2&id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1) (Linux mainline 4.12-rc2).
* 17-May-17: [CVE-2017-1000363](/vulns/aleph-2017023) assigned.
* 16-May-17: [Patch available](https://git.kernel.org/pub/scm/linux/kernel/git/gregkh/char-misc.git/commit/?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1) (Linux Char/Misc drivers development tree).
* 16-May-17: Reported.
* 16-May-17: Added as [ALEPH-2017023](/vulns/aleph-2017023).
## Posts

* [initroot: Bypassing Nexus 6 Secure Boot through Kernel Command-line Injection](/2017/05/23/nexus6-initroot/)  By [Roee Hay](/authors/roeeh), 23-May 2017
## Credit

* [Roee Hay](/authors/roeeh) ([@roeehay](https://twitter.com/roeehay)) of Aleph Research, HCL Technologies



=== Content from git.kernel.org_d1b043bf_20250126_053428.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [summary](/pub/scm/linux/kernel/git/torvalds/linux.git/?h=v4.12-rc2)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?h=v4.12-rc2&id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/?h=v4.12-rc2)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?h=v4.12-rc2&id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?h=v4.12-rc2&id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?h=v4.12-rc2&id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/?h=v4.12-rc2) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Willy Tarreau <w@1wt.eu> | 2017-05-16 19:18:55 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2017-05-16 23:05:20 +0200 |
| commit | [3e21f4af170bebf47c187c1ff8bf155583c9f3b1](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?h=v4.12-rc2&id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)) | |
| tree | [276f65a380b1f288c65b17a7a11819fcd971e493](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?h=v4.12-rc2&id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1) | |
| parent | [2ea659a9ef488125eb46da6eb571de5eae5c43f6](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?h=v4.12-rc2&id=2ea659a9ef488125eb46da6eb571de5eae5c43f6) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?h=v4.12-rc2&id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1&id2=2ea659a9ef488125eb46da6eb571de5eae5c43f6)) | |
| download | [linux-3e21f4af170bebf47c187c1ff8bf155583c9f3b1.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-3e21f4af170bebf47c187c1ff8bf155583c9f3b1.tar.gz) | |

char: lp: fix possible integer overflow in lp\_setup()The lp\_setup() code doesn't apply any bounds checking when passing
"lp=none", and only in this case, resulting in an overflow of the
parport\_nr[] array. All versions in Git history are affected.
Reported-By: Roee Hay <roee.hay@hcl.com>
Cc: Ben Hutchings <ben@decadent.org.uk>
Cc: stable@vger.kernel.org
Signed-off-by: Willy Tarreau <w@1wt.eu>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?h=v4.12-rc2&id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)

| -rw-r--r-- | [drivers/char/lp.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/char/lp.c?h=v4.12-rc2&id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/drivers/char/lp.c b/drivers/char/lp.cindex 565e4cf04a0215..8249762192d55e 100644--- a/[drivers/char/lp.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/char/lp.c?h=v4.12-rc2&id=2ea659a9ef488125eb46da6eb571de5eae5c43f6)+++ b/[drivers/char/lp.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/char/lp.c?h=v4.12-rc2&id=3e21f4af170bebf47c187c1ff8bf155583c9f3b1)@@ -859,7 +859,11 @@ static int \_\_init lp\_setup (char \*str) } else if (!strcmp(str, "auto")) { parport\_nr[0] = LP\_PARPORT\_AUTO; } else if (!strcmp(str, "none")) {- parport\_nr[parport\_ptr++] = LP\_PARPORT\_NONE;+ if (parport\_ptr < LP\_NO)+ parport\_nr[parport\_ptr++] = LP\_PARPORT\_NONE;+ else+ printk(KERN\_INFO "lp: too many ports, %s ignored.\n",+ str); } else if (!strcmp(str, "reset")) { reset = 1; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-26 05:33:05 +0000



=== Content from www.debian.org_8df7d79c_20250125_025350.html ===


---

[[Date Prev](msg00206.html)][[Date Next](msg00208.html)]
[[Thread Prev](msg00206.html)][[Thread Next](msg00208.html)]
[[Date Index](maillist.html#00207)]
[[Thread Index](threads.html#00207)]

# [SECURITY] [DSA 3945-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3945-1] linux security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Thu, 17 Aug 2017 18:40:05 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1diPi9-0005PI-4M%40master.debian.org)Â [E1diPi9-0005PI-4M@master.debian.org](msg00207.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3945-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
August 17, 2017                       <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2014-9940 CVE-2017-7346 CVE-2017-7482 CVE-2017-7533
                 CVE-2017-7541 CVE-2017-7542 CVE-2017-7889 CVE-2017-9605
                 CVE-2017-10911 CVE-2017-11176 CVE-2017-1000363
                 CVE-2017-1000365

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2014-9940

    A use-after-free flaw in the voltage and current regulator driver
    could allow a local user to cause a denial of service or potentially
    escalate privileges.

CVE-2017-7346

    Li Qiang discovered that the DRM driver for VMware virtual GPUs does
    not properly check user-controlled values in the
    vmw_surface_define_ioctl() functions for upper limits. A local user
    can take advantage of this flaw to cause a denial of service.

CVE-2017-7482

    Shi Lei discovered that RxRPC Kerberos 5 ticket handling code does
    not properly verify metadata, leading to information disclosure,
    denial of service or potentially execution of arbitrary code.

CVE-2017-7533

    Fan Wu and Shixiong Zhao discovered a race condition between inotify
    events and VFS rename operations allowing an unprivileged local
    attacker to cause a denial of service or escalate privileges.

CVE-2017-7541

    A buffer overflow flaw in the Broadcom IEEE802.11n PCIe SoftMAC WLAN
    driver could allow a local user to cause kernel memory corruption,
    leading to a denial of service or potentially privilege escalation.

CVE-2017-7542

    An integer overflow vulnerability in the ip6_find_1stfragopt()
    function was found allowing a local attacker with privileges to open
    raw sockets to cause a denial of service.

CVE-2017-7889

    Tommi Rantala and Brad Spengler reported that the mm subsystem does
    not properly enforce the CONFIG_STRICT_DEVMEM protection mechanism,
    allowing a local attacker with access to /dev/mem to obtain
    sensitive information or potentially execute arbitrary code.

CVE-2017-9605

    Murray McAllister discovered that the DRM driver for VMware virtual
    GPUs does not properly initialize memory, potentially allowing a
    local attacker to obtain sensitive information from uninitialized
    kernel memory via a crafted ioctl call.

CVE-2017-10911 / XSA-216

    Anthony Perard of Citrix discovered an information leak flaw in Xen
    blkif response handling, allowing a malicious unprivileged guest to
    obtain sensitive information from the host or other guests.

CVE-2017-11176

    It was discovered that the mq_notify() function does not set the
    sock pointer to NULL upon entry into the retry logic. An attacker
    can take advantage of this flaw during a userspace close of a
    Netlink socket to cause a denial of service or potentially cause
    other impact.

CVE-2017-1000363

    Roee Hay reported that the lp driver does not properly bounds-check
    passed arguments, allowing a local attacker with write access to the
    kernel command line arguments to execute arbitrary code.

CVE-2017-1000365

    It was discovered that argument and environment pointers are not
    taken properly into account to the imposed size restrictions on
    arguments and environmental strings passed through
    RLIMIT_STACK/RLIMIT_INFINITY. A local attacker can take advantage of
    this flaw in conjunction with other flaws to execute arbitrary code.

For the oldstable distribution (jessie), these problems have been fixed
in version 3.16.43-2+deb8u3.

We recommend that you upgrade your linux packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAlmV4s9fFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0SZMhAAhBfaeydc3sP6ce4m24nh4FJRrkZudj04Z1Kloq5+diW3zc1ZzQV6+75x
QZTCmQKqFL7ueLb+jB3whCfg4BHbeTygu3+6eIAYyWFDpmfFRIAjVtLE6HAwC5cr
MM1DyA0AhxtcquoBiCvsmIxKRq5akVn0vSBL4qg3+DXTmjrV1ZGNmECLa5SUO7MF
idIUyvEMOX1TmMAEZBaQqslg4o4lgXXiL9GgB2rbFnPDzHQENZ1li/jkP5iFhSGH
s4mFj0pkwlVYoIa6xdC69kQI49USbpUv5okdthsuDKmm2oj/TuozOIAdcsNFTfts
wYLRic8OrhSYD1ZeXdy6FVzMb5s1alm2zcmDu7xQwSKy5TtVJII+DPWn9EonQaK9
OfazCvQBJ4Tip6CEBl0NFACIO9Y6+ExF2Ens/jJwAWDYOWkGGLTjsWf6TlxAGshl
c8TLvDfZW7hFcs8fPc9YFQQA1OyUA1GCPlLhXltGV2kwIN+iaR3vk/DrJ0kEaaZz
/rklgqvhfYmtx0Hp3pmwJkHCj/S3zIfK8AvZ+SU2hYw9TUxm02JHig/GSbF3eiwL
DvP1PVbXwT9n6ePw0yMkkfaEZBCGFWFnvT2kTBQhSYBfUVLo1KVOJ5gmPdxHda0b
lgtZszmHa+bj5C6DN/OMGBZC/7wgbt7jEyZht3Ke+20z2n+z/yE=
=Dibe
-----END PGP SIGNATURE-----

```

---


