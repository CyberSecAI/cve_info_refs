```text
RELATED: CVE-2017-1000144

Vulnerability: Stored XSS

Root cause: Institution names were not being escaped properly in the accesslist.

Attack vector:
1. As admin, create a new institution, and a new user with admin rights in that institution.
2. Log in as new institution admin, change the name of the institution to include a malicious script, such as "<script>alert(1);</script>".
3. Add new users to the institution, which results in their profile pages being automatically shared with the institution.
4. If a full admin runs a user report on that new user and views the access list, the XSS will be triggered.
5. The XSS can also be triggered if a user or group shares a page with the malicious institution and then views "Shared by me."

Impact:
- Privilege escalation to full admin is possible in walled garden setups with multiple institution admins who are not full admins.
- A malicious institution admin could inject malicious JavaScript code that would be executed when a full admin views the access list report of a user or when a user views "Shared by me" after sharing a page with the malicious institution.

Affected versions:
- Mahara 1.9 before 1.9.6
- Mahara 1.10 before 1.10.4
- Mahara 15.04 before 15.04.1

Mitigation:
The vulnerability was fixed by properly escaping institution names in the accesslist and clearing the compiled cache for the templates where the problem occurred.
```