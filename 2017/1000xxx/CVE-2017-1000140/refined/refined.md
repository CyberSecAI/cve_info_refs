Based on the provided content, here's a breakdown of the vulnerability:

*   **Root Cause:** The vulnerability stems from the application's failure to properly sanitize or filter malicious code within uploaded XML files. The application was displaying the content of the XML file inline in the browser, without proper sanitization or a `Content-Disposition: attachment` header.

*   **Weaknesses/Vulnerabilities Present:**
    *   **Stored Cross-Site Scripting (XSS):** The primary vulnerability is stored XSS. Malicious XML files containing JavaScript can be uploaded and, when viewed, the JavaScript code is executed in the context of the user's browser.
    *  **Inadequate Output Handling**: The application did not sanitize the XML content, instead displaying it as HTML in the user's browser.
    *   **Improper Content-Disposition Header:** The application served XML files without a `Content-Disposition: attachment` header, causing the browser to attempt to render the XML as HTML, which in turn executes any embedded JavaScript.

*   **Impact of Exploitation:**
    *   An attacker can inject malicious JavaScript into XML files, which can then be uploaded to the application.
    *   When other users view or download these infected files, the malicious JavaScript is executed in their browser.
    *   This can lead to various malicious activities, such as:
        *   Redirecting users to malicious websites (as demonstrated in the proof of concept).
        *   Stealing user session cookies or other sensitive information.
        *   Performing actions on behalf of the victim user (if logged in).
        *   Defacing or manipulating the content displayed to the user.

*   **Attack Vectors:**
    *   **File Upload:** The attacker uploads a crafted XML file containing malicious JavaScript.
    *   **File Sharing:** The attacker shares the infected XML file through the application's sharing mechanisms, or relies on other users downloading the malicious XML file from the application.
    *   **File View/Download:** When a user views or downloads the XML file, the embedded malicious code is executed by the browser.

*   **Required Attacker Capabilities/Position:**
    *   The attacker needs an account in the application that allows file uploads and sharing.
    *   The attacker needs to be able to share the malicious file with the intended victim.
    *   The attacker does not need direct access to the victim's account, simply the ability to share the malicious file.

**Additional Notes:**
* The vulnerability was resolved by sanitizing the content of the XML file before displaying it and changing the `Content-Disposition` header to `attachment` for XML files.
* The fix was applied to versions 1.8.7, 1.9.5, 1.10.3, and 15.04.0 of Mahara.