=== Content from jenkins.io_1fb35682_20250124_141527.html ===


# Jenkins Security Advisory 2017-04-26

This advisory announces multiple vulnerabilities in Jenkins.

## Description

### CSRF: Multiple vulnerabilities

**SECURITY-412 through SECURITY-420 / CVE-2017-1000356**

Multiple [Cross-Site Request Forgery](https://en.wikipedia.org/wiki/Cross-site_request_forgery) vulnerabilities in Jenkins allowed malicious users to perform several administrative actions by tricking a victim into opening a web page.
The most notable ones:

* SECURITY-412: Restart Jenkins immediately, after all builds are finished, or after all plugin installations and builds are finished
* SECURITY-412: Schedule a downgrade of Jenkins to a previously installed version if Jenkins previously upgraded itself
* SECURITY-413: Install and (optionally) dynamically load any plugin present on a configured update site
* SECURITY-414: Remove any update site from the Jenkins configuration
* SECURITY-415: Change a user’s API token
* SECURITY-416: Submit system configuration
* SECURITY-417: Submit global security configuration
* SECURITY-418, SECURITY-420: For Jenkins user database authentication realm: create an account if signup is enabled; or create an account if the victim is an administrator, possibly deleting the existing default "admin" user in the process
* SECURITY-419: Create a new agent, possibly executing arbitrary shell commands on the Jenkins controller by choosing the appropriate launch method
* SECURITY-420: Cancel a scheduled restart
* SECURITY-420: Configure the global logging levels
* SECURITY-420: Create a copy of an existing agent
* SECURITY-420: Create copies of views in users' "My Views" or as children of the experimental "Tree View" feature
* SECURITY-420: Enter "quiet down" mode in which no new builds are started
* SECURITY-420: On Windows, after successful installation as a service, restart
* SECURITY-420: On Windows, try to install Jenkins as a service
* SECURITY-420: Set the descriptions of items (jobs), builds, and users
* SECURITY-420: Submit global tools configuration (Jenkins 2.0 and up)
* SECURITY-420: Toggle keeping a build forever (i.e. exclude or include it in log rotation)
* SECURITY-420: Try to connect all disconnected agents simultaneously
* SECURITY-420: Update the node monitor data on all agents

The above, as well as several other more minor issues, have all been fixed and these actions now require POST requests, and, if configured, a CSRF crumb, to work.

### CLI: Unauthenticated remote code execution

**SECURITY-429 / CVE-2017-1000353**

An unauthenticated remote code execution vulnerability allowed attackers to transfer a serialized Java `SignedObject` object to the remoting-based Jenkins CLI, that would be deserialized using a new `ObjectInputStream`, bypassing the existing blocklist-based protection mechanism.

`SignedObject` has been added to the remoting blocklist.

In Jenkins 2.54, the remoting-based CLI protocol was deprecated and a new, HTTP based protocol introduced as the new default, in addition to the existing SSH-based CLI.
This feature has been backported to Jenkins 2.46.2.
It is strongly recommended that users upgrading Jenkins disable the remoting-based CLI, and use the one of the other modes (HTTP or SSH) instead.

### CLI: Login command allowed impersonating any Jenkins user

**SECURITY-466 / CVE-2017-1000354**

The `login` command available in the remoting-based CLI stored the encrypted user name of the successfully authenticated user in a cache file used to authenticate further commands.
Users with sufficient permission to create secrets in Jenkins, and download their encrypted values (e.g. with Job/Configure permission), were able to impersonate any other Jenkins user on the same instance.

This has been fixed by storing the cached authentication as a hash-based MAC with a key specific to the Jenkins instance and the CLI authentication cache.

Previously cached authentications are invalidated when upgrading Jenkins to a version containing a fix for this.

### XStream: Java crash when trying to instantiate void/Void

**SECURITY-503 / CVE-2017-1000355**

Jenkins uses the XStream library to serialize and deserialize XML.
Its maintainer [recently published a security vulnerability](https://www.openwall.com/lists/oss-security/2017/04/03/4) that allows anyone able to provide XML to Jenkins for processing using XStream to crash the Java process.
In Jenkins this typically applies to users with permission to create or configure items (jobs), views, or agents.

Jenkins now prohibits the attempted deserialization of `void` / `Void` that results in a crash.

## Severity

* SECURITY-412 through SECURITY-420: [high](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)
* SECURITY-429: [critical](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
* SECURITY-466: [high](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
* SECURITY-503: [medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H)

## Affected versions

* All Jenkins main line releases up to and including 2.56
* All Jenkins LTS releases up to and including 2.46.1

## Fix

* Jenkins main line users should update to 2.57
* Jenkins LTS users should update to 2.46.2

These versions include fixes to all the vulnerabilities described above.
All prior versions are affected by these vulnerabilities unless otherwise indicated.

## Credit

The Jenkins project would like to thank the reporters for discovering and [reporting](/security/#reporting-vulnerabilities) these vulnerabilities:

* **An independent security researcher who reported this vulnerability to Beyond Securityâs SecuriTeam Secure Disclosure program** for SECURITY-429
* **Jesse Glick, CloudBees, Inc.** for SECURITY-466
* **Steve Marlowe <smarlowe@cisco.com> of Cisco ASIG** for SECURITY-412, SECURITY-413, SECURITY-414, SECURITY-415, SECURITY-416, SECURITY-417, SECURITY-418, and SECURITY-419

## Other Resources

* [Announcement blog post](/blog/2017/04/26/security-advisory/)



=== Content from www.openwall.com_d0181cb4_20250126_013024.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](../../../2017/04/04/1) [[thread-next>]](../../../2017/04/13/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <obtd6v$pv3$1@blaine.gmane.org>
Date: Mon, 03 Apr 2017 13:55:17 +0200
From: Jörg Schaible <joerg.schaible@....de>
To: oss-security@...ts.openwall.com
Subject: CVE Request - XStream: DoS when unmarshalling void

Hello,

XStream is a Java library basically to marshal Java objects into XML and
back.

Huawei engineers reported a reproducible crash of the Java VM (DoS) feeding
XStream with a specially crafted XML (note, that Stream also supports JSON,
that one can be used equally).

Issue Description
=================

The processed stream at unmarshalling type contains type information to
recreate the formerly written objects. XStream creates therefore new
instances based on these type information. The crash occurrs if this
information advices XStream to create an instance of the primitive type
'void'. This situation can only happen if an attacker was able to manipulate
the incoming data, since such an instance does not exist.

Steps to Reproduce:
===================

The simplest way to demonstrate the problem is with this snippet:

XStream xstream = new XStream();
xstream.fromXML("<void/>");

If XStream is configured to read JSON, the equivalent line is:

xstream.fromXML("{'void':null}");

However, the problematic type information can be injected at any position in
the provided stream, in XML just by adding a class attribute:

xstream.fromXML("<string class='void'>Hello, world!</string>");

Impact:
=======
The vulnerability may allow a remote attacker to cause a crash on the target
system resulting in a denial of service only by manipulating the processed
input stream.

Affected Versions:
==================
Currently all versions until and including version 1.4.9 are affected, but
workarounds exist.

Workarounds:
============
XStream contains since version 1.4.7 a security framework to prevent an
attack described in CVE-2013-7285. This framework can also be used to
suppress the current vulnerability by setting:

xstream.denyTypes(void.class, Void.class);

Users of older XStream releases can register an own converter for the 'void'
type, that also protects against this attack:

xstream.registerConverter(new Converter() {
  public boolean canConvert(Class type) {
    return Void.class == type || void.class == type;
  }
  public Object unmarshal(HierarchicalStreamReader reader,
UnmarshallingContext context) {
    throw new ConversionException("Type void cannot have an instance");
  }
  public void marshal(Object source, HierarchicalStreamWriter writer,
MarshallingContext context) {
    throw new ConversionException("Type void cannot have an instance");
  }
}, XStream.PRIORITY_VERY_HIGH);

Regards,
Jörg Schaible

Maintainer of XStream.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


