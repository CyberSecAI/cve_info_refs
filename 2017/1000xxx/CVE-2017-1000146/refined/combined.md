=== Content from bugs.launchpad.net_87b39fee_20250124_225114.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1472439/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# XSS in "add to watchlist" link on artefact detail screen

Bug #1472439 reported by
[Aaron Wells](https://launchpad.net/~u-aaronw)
on 2015-07-08

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Aaron Wells](https://launchpad.net/~u-aaronw) | [Mahara 15.10.0](https://launchpad.net/mahara/%2Bmilestone/15.10.0) |
|  | [1.10](https://bugs.launchpad.net/mahara/1.10) | Fix Released | High | [Aaron Wells](https://launchpad.net/~u-aaronw) | [Mahara 1.10.5](https://launchpad.net/mahara/%2Bmilestone/1.10.5) |
|  | [1.8](https://bugs.launchpad.net/mahara/1.8) | Won't Fix | High | [Aaron Wells](https://launchpad.net/~u-aaronw) |  |
|  | [1.9](https://bugs.launchpad.net/mahara/1.9) | Fix Released | High | [Aaron Wells](https://launchpad.net/~u-aaronw) | [Mahara 1.9.7](https://launchpad.net/mahara/%2Bmilestone/1.9.7) |
|  | [15.04](https://bugs.launchpad.net/mahara/15.04) | Fix Released | High | [Aaron Wells](https://launchpad.net/~u-aaronw) | [Mahara 15.04.2](https://launchpad.net/mahara/%2Bmilestone/15.04.2) |
|  | [15.10](https://bugs.launchpad.net/mahara/15.10) | Fix Released | High | [Aaron Wells](https://launchpad.net/~u-aaronw) | [Mahara 15.10.0](https://launchpad.net/mahara/%2Bmilestone/15.10.0) |

### Bug Description

Issue reported by Yuji Tounai through <email address hidden>

On artefact detail screens, when we you click on the "add to watchlist" link, we use AJAX to update the link to read "remove from watchlist". But, we are not properly escaping the page title in that AJAX, which makes it possible to execute Javascript that has been placed in the page title.

To replicate:

1. Create a portfolio Page

2. Give the page this title:

"><img src=0 onerror=alert(location)>

3. Put an image block in the page.

4. View the page in display mode.

5. Click on the link to view the artefact detail screen for the image

6. At the bottom of the artefact detail screen, click on the link that reads "Add page ""><img src=0 onerror=alert(location)>" to watchlist" or "Remove page ""><img src=0 onerror=alert(location)>" to watchlist"

Expected result: The page should be added or removed from your watchlist, and the link title should show the HTML-escaped version of the page title.

Actual result: The page is added or removed from your watchlist, but the link title is not HTML-escaped and Javascript "alert(location)" executes.

See [original description](comments/0)

Tags:

[regression](/mahara/%2Bbugs?field.tag=regression)
[watchlist](/mahara/%2Bbugs?field.tag=watchlist)

## CVE References

* [2017-1000146](/bugs/cve/2017-1000146 "Mahara 1.9 before 1.9.7 and 1.10 befo...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2015-07-08: |  |  | [#1](/mahara/%2Bbug/1472439/comments/1) |
| --- | --- | --- | --- |

This bug was introduced in Mahara 1.8, when we changed the "Add page to watchlist" link on artefact detail pages to include the page title.

This bug was introduced in Mahara 1.8, when we changed the "Add page to watchlist" link on artefact detail pages to include the page title.

| **information type**: | Public → Private Security |
| --- | --- |
| Changed in mahara: | |
| **status**: | New → In Progress |
| **tags**: | added: regression watchlist |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2015-07-08: |  |  | [#2](/mahara/%2Bbug/1472439/comments/2) |
| --- | --- | --- | --- |

Caused by this patch: <https://reviews.mahara.org/#/c/2730/3>

Caused by this patch: https://reviews.mahara.org/#/c/2730/3

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2015-07-08: |  |  | [#3](/mahara/%2Bbug/1472439/comments/3) |
| --- | --- | --- | --- |

Here's the fix patch for 1.9\_STABLE: <https://reviews.mahara.org/#/c/4927>

Here's the fix patch for 1.9\_STABLE: https://reviews.mahara.org/#/c/4927

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2015-07-08: |  |  | [#4](/mahara/%2Bbug/1472439/comments/4) |
| --- | --- | --- | --- |

1.10\_STABLE: <https://reviews.mahara.org/#/c/4929/>

15.04\_STABLE: <https://reviews.mahara.org/#/c/4930/>

master: <https://reviews.mahara.org/#/c/4931/>

1.10\_STABLE: https://reviews.mahara.org/#/c/4929/
15.04\_STABLE: https://reviews.mahara.org/#/c/4930/
master: https://reviews.mahara.org/#/c/4931/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2015-07-09: |  |  | [#5](/mahara/%2Bbug/1472439/comments/5) |
| --- | --- | --- | --- |

On further reflection I'm downgrading this one from "Critical" to "High", because there are a couple of mitigating factors:

1. The attacker has to have an account (i.e., be able to create or edit a page title)

2. The victim must be logged in (to have access to the watchlist link)

On further reflection I'm downgrading this one from "Critical" to "High", because there are a couple of mitigating factors:
1. The attacker has to have an account (i.e., be able to create or edit a page title)
2. The victim must be logged in (to have access to the watchlist link)

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2015-07-10

| **information type**: | Private Security → Public Security |
| --- | --- |

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2015-07-10

| **description**: | updated |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1472439/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1472439/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1472439/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1472439/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


