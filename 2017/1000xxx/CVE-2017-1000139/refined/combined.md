=== Content from bugs.launchpad.net_633db13c_20250124_141932.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1397736/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Use SafeCURL in external RSS block

Bug #1397736 reported by
[Aaron Wells](https://launchpad.net/~u-aaronw)
on 2014-11-30

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Won't Fix | High | [Aaron Wells](https://launchpad.net/~u-aaronw) |  |
|  | [1.10](https://bugs.launchpad.net/mahara/1.10) | Won't Fix | High | [Aaron Wells](https://launchpad.net/~u-aaronw) |  |
|  | [15.04](https://bugs.launchpad.net/mahara/15.04) | Won't Fix | High | [Aaron Wells](https://launchpad.net/~u-aaronw) |  |
|  | [15.10](https://bugs.launchpad.net/mahara/15.10) | Won't Fix | High | Unassigned |  |
|  | [16.04](https://bugs.launchpad.net/mahara/16.04) | Won't Fix | High | Unassigned |  |
|  | [16.10](https://bugs.launchpad.net/mahara/16.10) | Won't Fix | High | Unassigned |  |

### Bug Description

For better security in the external RSS feed block, we should be using a library like SafeCURL to help guard against attacks.: <https://github.com/fin1te/safecurl>

See also [bug 1394820](/bugs/1394820)

Tags:

[externalfeed](/mahara/%2Bbugs?field.tag=externalfeed)
[no-behat-needed](/mahara/%2Bbugs?field.tag=no-behat-needed)

## CVE References

* [2017-1000139](/bugs/cve/2017-1000139 "Mahara 1.8 before 1.8.7 and 1.9 befor...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2014-11-30: |  |  | [#1](/mahara/%2Bbug/1397736/comments/1) |
| --- | --- | --- | --- |

Patches:

<https://reviews.mahara.org/4030>

<https://reviews.mahara.org/4031>

Patches:
https://reviews.mahara.org/4030
https://reviews.mahara.org/4031

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2014-11-30: |  |  | [#2](/mahara/%2Bbug/1397736/comments/2) |
| --- | --- | --- | --- |

Hugh tells me that he's found some bugs in SafeCurl and has submitted patches for those, so we may want to hold off on this one until those bugs are patched.

Hugh tells me that he's found some bugs in SafeCurl and has submitted patches for those, so we may want to hold off on this one until those bugs are patched.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2014-12-14: |  |  | [#3](/mahara/%2Bbug/1397736/comments/3) |
| --- | --- | --- | --- |

Here are the issues that Hugh found with SafeCurl:

<https://github.com/fin1te/safecurl/issues/14>

<https://github.com/fin1te/safecurl/issues/15>

<https://github.com/fin1te/safecurl/issues/16>

<https://github.com/fin1te/safecurl/issues/18>

<https://github.com/fin1te/safecurl/issues/19>

Here are the issues that Hugh found with SafeCurl:
https://github.com/fin1te/safecurl/issues/14
https://github.com/fin1te/safecurl/issues/15
https://github.com/fin1te/safecurl/issues/16
https://github.com/fin1te/safecurl/issues/18
https://github.com/fin1te/safecurl/issues/19

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2015-01-12

| **information type**: | Public → Public Security |
| --- | --- |
| **tags**: | added: externalfeed |

[Jinelle Foley-Barnes (jinelleb)](https://launchpad.net/~jinelleb)
on 2015-04-20

| **tags**: | added: no-behat-needed |
| --- | --- |

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2015-10-27

| **no longer affects**: | mahara/1.8 |
| --- | --- |

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2015-11-18

| **no longer affects**: | mahara/1.9 |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2016-06-13: |  |  | [#4](/mahara/%2Bbug/1397736/comments/4) |
| --- | --- | --- | --- |

Hm, well, we haven't seen any updates from the SafeCurl project since Hugh posted those initial bug reports. On the other hand, it would still improve our security versus what we've currently got. It just has potentially a few unpatched holes.

So I think it's probably worth going ahead with this one, unless we can find a better equivalent library. If a better alternative arises in the future, it should be fairly simple to swap this one out with that one, since this one is designed as a "drop-in replacement" for the PHP curl\_exec function.

Hm, well, we haven't seen any updates from the SafeCurl project since Hugh posted those initial bug reports. On the other hand, it would still improve our security versus what we've currently got. It just has potentially a few unpatched holes.
So I think it's probably worth going ahead with this one, unless we can find a better equivalent library. If a better alternative arises in the future, it should be fairly simple to swap this one out with that one, since this one is designed as a "drop-in replacement" for the PHP curl\_exec function.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2016-06-13: |  |  | [#5](/mahara/%2Bbug/1397736/comments/5) |
| --- | --- | --- | --- |

Oh, I guess one thing we should check is whether SafeCURL will work with PHP7, since it was written before PHP7 was released...

Oh, I guess one thing we should check is whether SafeCURL will work with PHP7, since it was written before PHP7 was released...

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2016-06-14: |  |  | [#6](/mahara/%2Bbug/1397736/comments/6) |
| --- | --- | --- | --- |

Abandoning this one. SafeCURL doesn't work with IPv6, which means we'd either have to arbitrarily require only RSS feeds at IPv4-addressed sites, or allow all IPv6 addresses, in which case we're not adding any security.

So with that downside, it's not worth the extra risk and upkeep of adding it.

Abandoning this one. SafeCURL doesn't work with IPv6, which means we'd either have to arbitrarily require only RSS feeds at IPv4-addressed sites, or allow all IPv6 addresses, in which case we're not adding any security.
So with that downside, it's not worth the extra risk and upkeep of adding it.

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2016-07-05

| Changed in mahara: | |
| --- | --- |
| **status**: | In Progress → Won't Fix |
| **status**: | Won't Fix → In Progress |
| **status**: | In Progress → Won't Fix |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2016-07-05: |  |  | [#7](/mahara/%2Bbug/1397736/comments/7) |
| --- | --- | --- | --- |

I was re-reading my previous remark and I wondered, "Why don't we just disallow raw IP addresses as URLs?"

But to clarify, that's not the issue. Even if a user enters a non-IP URL, SafeCURL extracts the domain name from the URL, resolves it to an IP address, and does some checking against that IP address.

So, if a Mahara user entered an RSS feed for a URL, and that URL was at a domain name whose only DNS records were IPv6 (as an increasing number will be in the days to come), SafeCURL would not be able to perform any validation on it. So we'd either have to give an IPv6-based site a free pass (in which case we're not really gaining any security) or we'd have to reject all IPv6-based sites (which would be a horrible user experience, because a user doesn't generally know the IP address of the sites they visit).

I was re-reading my previous remark and I wondered, "Why don't we just disallow raw IP addresses as URLs?"
But to clarify, that's not the issue. Even if a user enters a non-IP URL, SafeCURL extracts the domain name from the URL, resolves it to an IP address, and does some checking against that IP address.
So, if a Mahara user entered an RSS feed for a URL, and that URL was at a domain name whose only DNS records were IPv6 (as an increasing number will be in the days to come), SafeCURL would not be able to perform any validation on it. So we'd either have to give an IPv6-based site a free pass (in which case we're not really gaining any security) or we'd have to reject all IPv6-based sites (which would be a horrible user experience, because a user doesn't generally know the IP address of the sites they visit).

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2016-07-10

| Changed in mahara: | |
| --- | --- |
| **milestone**: | 16.04.1 → none |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1397736/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1397736/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1397736/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1397736/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


