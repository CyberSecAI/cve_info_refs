=== Content from www.wizlynxgroup.com_50ef8f95_20250125_203824.html ===


[![wizlynx group | IT Security Services](/content/images/logo-nav.png)](/ch/de/)

[Contact Us](../../contact)

# Security Research & Advisories

### Multiple Vulnerabilities in OpenEMR

| Vendor |  |
| --- | --- |
| Product | OpenEMR |
| Affected Version(s) | 5.0.0 and probably prior |
| Tested Version(s) | 5.0.0 and 5.0.1-dev |
| Vulnerability Discovery | May 21, 2017 |
| Vendor Notification | May 23, 2017 |
| Advisory Publication | May 23, 2017 [without technical details] |
| Vendor Acknowledgment | May 25, 2017 |
| Vendor Fix | Not fixed as of OpenEMR 5.0.0 patch 7 |
| Public Disclosure | March 12, 2018 |
| Latest Modification | March 12, 2018 |
| CVE Identifier(s) | [CVE-2017-1000240](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000240) |
| Product Description | OpenEMR is a Free and Open Source electronic health records and medical practice management application. It is ONC Certified and it features fully integrated electronic health records, practice management, scheduling, electronic billing, internationalization, free support, a vibrant community, and a whole lot more. |
| Credits | Yann ChalenÃ§on, Security Researcher & Penetration Tester @wizlynx group |

## **Vulnerability Details**

| **Multiple Reflected & Stored Cross-Site Scripting (XSS) Vulnerabilities** | | | |
| --- | --- | --- | --- |
| **Severity**: **Medium** | **CVSS Score**: 5.4 | **CWE-ID**: [**CWE-79**](https://cwe.mitre.org/data/definitions/79) | **Status**: Not Fixed |
| **Vulnerability Description** | | | |
| The application OpenEMR is affected by multiple reflected & stored Cross-Site Scripting (XSS) vulnerabilities affecting version 5.0.0 and prior versions. These vulnerabilities could allow remote authenticated attackers to inject arbitrary web script or HTML. | | | |
| **CVSS Base Score** | | | |
| **Attack Vector** | Network | **Scope** | Changed |
| **Attack Complexity** | Low | **Confidentiality Impact** | Low |
| **Privileges Required** | Low | **Integrity Impact** | Low |
| **User Interaction** | Required | **Availability Impact** | None |

## **Description**

The OpenEMR has multiple Cross-Site Scripting vulnerabilities due to the lack of input validation and output encoding.

### **Example #1**

The value of the document\_id request parameter is copied into the value of an HTML tag attribute which is encapsulated in double quotation marks. The payload ***wizlynx"></script><script>alert("wizlynx says XSS!")</script>***group was submitted in the document\_id parameter. This input was echoed unmodified and non-encoded in the application's response resulting in a XSS vulnerability.

/openemr/controller.php?document=&update=&patient\_id=3&document\_id=wizlynx%22%3E%3Cscript%3Ealert%28%22wizlynx%20says%20XSS!%22%29%3C/script%3Egroup&process=true&docname=test.php&docdate=2017-05-20&issue\_id=0

The following screenshot shows the JavaScript being executed on the client side:

[![](../../content/images/vuln/openEMR_1.png)](../../content/images/vuln/openEMR_1.png)

The original request used the POST method, however it was possible to convert the request to use the GET method, to enable easier demonstration and delivery of the attack.

### **Example #2**

When adding a note to an existing attachment, it is possible to abuse the ânoteâ parameter to inject a malicious JavaScript. This is possible because of the lack of input validation and output encoding, and results in a stored XSS vulnerability. The following screenshot shows the request and response:

[![](../../content/images/vuln/openEMR_2.png)](../../content/images/vuln/openEMR_2.png)

The following screenshot shows the serverâs response displayed in the browser

[![](../../content/images/vuln/openEMR_3.png)](../../content/images/vuln/openEMR_3.png)

#### Other affected pages & parameters:

**/openemr/controller.php #patient\_id**

/openemr/controller.php?document=&view&patient\_id=wizlynx%22%3E%3Cscript%3Ealert%2825%29%3C/script%3Egroup&doc\_id=2&

**/openemr/interface/patient\_file/summary/pnotes\_full.php #offset**

/openemr/interface/patient\_file/summary/pnotes\_full.php?docid=0&orderid=0&mode=new&trigger=add&offset=0ei5hz"><script>alert(1)<%2fscript> spz31peeulo&form\_active=1&form\_inactive=1&noteid=&form\_doc\_only=1&form\_note\_type=Insurance&assigned\_to=Yann&note=sdfawefa

**Note:** all Cross-Site Scripting vulnerabilities have not been fixed as of OpenEMR 5.0.0 patch 7.

[Top](#0)

![wizlynx group | IT Security Services](/content/images/WhiteWithRed.png)

wizlynx has not only built a solid foundation of information security, quality and project management know-how, but our associates are known for their ability to apply the right soft skills at the right time to best serve our customers. We make it a point to understand the infrastructure, needs and challenges of our customers, which enables us to deliver fast, effective and high quality results. It is our belief that this level of understanding can only be obtained with the most capable and experienced resources. Reach out to our associates at any time through our interactive competence centers to draw upon our knowledge of processes, procedures, guidelines and tools. Youâll be able to see, firsthand, the value our team will add to your organization.

---

---

©2024 wizlynx group - All Rights Reserved

* [Terms of Use](/terms-of-use)
* [Privacy](/privacy)

![](https://www.facebook.com/tr?id=191481035794506&ev=PageView&noscript=1)
