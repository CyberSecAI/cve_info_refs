```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from the OpenDaylight AAA module's handling of password changes via the Karaf CLI. When a user updates their password through the Karaf CLI, the claimCache is not flushed, resulting in both the old and new passwords being valid.",
    "weaknesses": [
      "Inadequate cache invalidation: The claimCache within the AAA IDM is not cleared upon password changes via the Karaf CLI.",
       "Inconsistent API handling: The REST API correctly flushes the claimCache on user updates, while the Karaf CLI does not."
    ],
    "impact": "An attacker could potentially use an old password to log in even after the password has been changed. This could provide unauthorized access to resources or services, bypassing the intended security mechanism of password updates.",
    "attack_vectors": [
      "Exploitation would require access to a user account and the ability to change the password through the Karaf CLI.",
      "The attacker must have an old valid password for the account."
    ],
    "required_capabilities": "The attacker requires existing credentials and the ability to interact with the Karaf CLI to change the password."
  },
    "additional_notes": "The issue is not present when using the AAA IDM REST API, as the handlers already invoke the clearing of the IdmLightProxy claimCache upon user update. The fix involves patching the Karaf CLI to call the IdmLightProxy claimCache and perform a flush every time a user changes a password. A workaround is to reboot Karaf, which clears the cache"
}
```