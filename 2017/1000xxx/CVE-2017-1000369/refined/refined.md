```
{
  "cveId": "CVE-2017-1000369",
  "relatedContent": [
    {
      "source": "github.com_067efa51_20250125_232846.html",
      "vulnerabilityDetails": "The commit addresses a memory leak vulnerability in Exim. The `-oMr` option, which sets the received protocol, was being repeatedly used without proper cleanup, leading to memory leaks. The fix ensures that the `received_protocol` variable is only set once, preventing repeated allocations and memory exhaustion."
    },
    {
      "source": "www.debian.org_9f1dd860_20250125_232844.html",
      "vulnerabilityDetails": "Debian Security Advisory DSA-3888-1 indicates a memory leak in Exim mail transport agent discovered by Qualys Research Labs. While not a security vulnerability in Exim itself, it can be exploited to trigger vulnerabilities in stack handling. The fix was included in version 4.84.2-2+deb8u4 for oldstable (jessie), 4.89-2+deb9u1 for stable (stretch), and will soon be fixed for unstable (sid)."
    },
    {
      "source": "www.qualys.com_d2de76d5_20250125_232847.html",
      "vulnerabilityDetails": "The advisory describes a stack clash vulnerability. It explains that the user-space stack expands automatically, but this mechanism is fragile because it relies on page-fault exceptions. When a memory region is mapped directly below the stack, the stack-pointer can move into the region without raising a fault. A stack guard-page protects against this, but if the stack-pointer \"jumps\" over the guard-page, the stack extends into the other memory region, potentially leading to exploitation. \n\nThe advisory describes how Exim is affected. By using the '-p' command-line option multiple times, memory is leaked, causing the heap to grow towards the stack. The combination of heap growth and a malformed -d command line argument will cause a jump over the stack guard-page.  The `string_sprintf` function is used to allocate a buffer on the stack.  This buffer is not fully written and the copy is malloc'd to heap (smashing chunk). The return address of the `memcpy` call is overwritten with the address of the libc system() function." ,
      "weaknesses": [
        "Fragile stack expansion mechanism",
        "Insufficient stack guard-page",
        "Memory leak via multiple -p arguments",
        "Stack-based buffer overflow in string_sprintf",
	"Use of a non-position-independent executable with reliance on shared library base address",
      ],
      "impact": "Local Privilege Escalation, arbitrary code execution, root shell",
      "attackVectors": [
        "Memory exhaustion by multiple -p command line arguments",
	"Malicious -d argument crafted to jump over stack guard-page and smash stack"
      ],
      "attackerCapabilities": "Local attacker with the ability to execute the Exim binary and control command-line arguments"
    },
    {
      "source": "security.gentoo.org_ffec77ab_20250125_232846.html",
      "vulnerabilityDetails": "Gentoo Security Advisory GLSA 201709-19 describes a local privilege escalation vulnerability in Exim due to a memory leak from using the `-p` command line argument. This leak can cause a stack clash, allowing the attacker to manipulate the stack, jump over stack guard pages, and possibly gain root privileges. The affected versions are mail-mta/exim versions earlier than 4.89-r1. The resolution is to update to at least 4.89-r1"
    }
  ]
}
```