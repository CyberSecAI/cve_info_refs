- **Root cause of vulnerability:** User passwords were being saved in the `event_log` table as plain text due to full logging being enabled. The `handle_event('createuser', $user)` function was saving the entire user object, including the password, to the log.
- **Weaknesses/vulnerabilities present:**  Storing passwords in plain text in a database log is a significant security vulnerability. It violates the principle of least privilege and exposes sensitive user data.
- **Impact of exploitation:** An attacker who gains access to the database could retrieve user passwords in plain text, leading to account compromise.
- **Attack vectors:** An attacker would need access to the database where the `event_log` table resides. This could be through a SQL injection vulnerability, compromised credentials, or other forms of unauthorized access.
- **Required attacker capabilities/position:** The attacker requires access to the database in order to read the event log table and extract plain text passwords.