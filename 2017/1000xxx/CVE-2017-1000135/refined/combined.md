=== Content from bugs.launchpad.net_1b9bb462_20250125_195802.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1348024/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# users can stay logged into suspended institution

Bug #1348024 reported by
[Robert Lyon](https://launchpad.net/~robertl-9)
on 2014-07-24

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | Medium | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 15.04.0](https://launchpad.net/mahara/%2Bmilestone/15.04.0) |
|  | [1.10](https://bugs.launchpad.net/mahara/1.10) | Fix Released | Medium | Unassigned | [Mahara 1.10.3](https://launchpad.net/mahara/%2Bmilestone/1.10.3) |
|  | [1.8](https://bugs.launchpad.net/mahara/1.8) | Fix Released | Medium | Unassigned | [Mahara 1.8.7](https://launchpad.net/mahara/%2Bmilestone/1.8.7) |
|  | [1.9](https://bugs.launchpad.net/mahara/1.9) | Fix Released | Medium | Unassigned | [Mahara 1.9.5](https://launchpad.net/mahara/%2Bmilestone/1.9.5) |
|  | [15.04](https://bugs.launchpad.net/mahara/15.04) | Fix Released | Medium | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 15.04.0](https://launchpad.net/mahara/%2Bmilestone/15.04.0) |
|  | [15.10](https://bugs.launchpad.net/mahara/15.10) | Fix Released | Medium | Unassigned | [Mahara 15.10.0](https://launchpad.net/mahara/%2Bmilestone/15.10.0) |

### Bug Description

If a user does not use their own institution's auth method then user only belonging to a suspended institution can still log in.

Scenario:

- Create an institution called 'testone' with the auth method internal mahara

- Add a user to it (so that the user is only in this institution and no others)

- Update the user auth method to be another internal one

- suspend the institution

- log out and then in as user - can get in because the auth method is paired to 'mahara' institution

Another problem:

Same as above but have the user using the institutions auth method

- this time one gets a warning about the institution being suspended, which is good

but also gets the top menu and is actually logged in/can navigate about.

What needs to be done:

1) when an institution is suspended make sure all users that only belong to this institution have a valid usr.authinstance value and if they don't give them one.

2) when they are trying to log in to their suspended institution actually deny them properly.

Tags:

[behat](/mahara/%2Bbugs?field.tag=behat)
[needs-behat](/mahara/%2Bbugs?field.tag=needs-behat)

## CVE References

* [2017-1000135](/bugs/cve/2017-1000135 "Mahara 1.8 before 1.8.7 and 1.9 befor...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2014-07-24: |  |  | [#1](/mahara/%2Bbug/1348024/comments/1) |
| --- | --- | --- | --- |

<https://reviews.mahara.org/#/c/3508/>

https://reviews.mahara.org/#/c/3508/

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2014-07-28

| Changed in mahara: | |
| --- | --- |
| **status**: | Confirmed → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2014-11-23: |  |  | [#2](/mahara/%2Bbug/1348024/comments/2) |
| --- | --- | --- | --- |

Ignore earlier comments - the only problem here is when an institution is suspended it doesn't log out the logged in users.

I've updated the patch to make sure that any users that are using an auth method for the institution being suspended are logged out automatically - and if they try to login again they are greeted by a ' your institution is suspended' message.

Ignore earlier comments - the only problem here is when an institution is suspended it doesn't log out the logged in users.
I've updated the patch to make sure that any users that are using an auth method for the institution being suspended are logged out automatically - and if they try to login again they are greeted by a ' your institution is suspended' message.

| **summary**: | - users can log into suspended institution+ users can stay logged into suspended institution |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2015-01-12: |  |  | [#3](/mahara/%2Bbug/1348024/comments/3) |
| --- | --- | --- | --- |

Since the issue is only that a user can \*stay\* logged in to a suspended institution, I'm dropping the priority from High to Medium.

Since the issue is only that a user can \*stay\* logged in to a suspended institution, I'm dropping the priority from High to Medium.

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2015-04-16:  [**A change has been merged**](/mahara/%2Bbug/1348024/comments/4) |  |  | [#4](/mahara/%2Bbug/1348024/comments/4) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/3508>

Committed: <http://gitorious.org/mahara/mahara/commit/de21ad32e9dc795caed654f27e1bc9a92e37cc3b>

Submitter: Aaron Wells (<email address hidden>)

Branch: master

commit de21ad32e9dc795caed654f27e1bc9a92e37cc3b

Author: Robert Lyon <email address hidden>

Date: Fri Jul 25 10:21:48 2014 +1200

Getting suspended institutions to keep their user out. ([Bug 1348024](/bugs/1348024))

Users who are logged in on the suspended institution's auth method

are logged out.

Change-Id: I10e1dec465a4363a076e92f4d90ec663ff8a822e

Signed-off-by: Robert Lyon <email address hidden>

Reviewed: https://reviews.mahara.org/3508
Committed: http://gitorious.org/mahara/mahara/commit/de21ad32e9dc795caed654f27e1bc9a92e37cc3b
Submitter: Aaron Wells (aaronw@catalyst.net.nz)
Branch: master
commit de21ad32e9dc795caed654f27e1bc9a92e37cc3b
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Fri Jul 25 10:21:48 2014 +1200
Getting suspended institutions to keep their user out. (Bug 1348024)
Users who are logged in on the suspended institution's auth method
are logged out.
Change-Id: I10e1dec465a4363a076e92f4d90ec663ff8a822e
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2015-04-16:  [**A patch has been submitted for review**](/mahara/%2Bbug/1348024/comments/5) |  |  | [#5](/mahara/%2Bbug/1348024/comments/5) |
| --- | --- | --- | --- |

Patch for "15.04\_STABLE" branch: <https://reviews.mahara.org/4643>

Patch for "15.04\_STABLE" branch: https://reviews.mahara.org/4643

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2015-04-16: |  |  | [#6](/mahara/%2Bbug/1348024/comments/6) |
| --- | --- | --- | --- |

Patch for "1.10\_STABLE" branch: <https://reviews.mahara.org/4644>

Patch for "1.10\_STABLE" branch: https://reviews.mahara.org/4644

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2015-04-16: |  |  | [#7](/mahara/%2Bbug/1348024/comments/7) |
| --- | --- | --- | --- |

Patch for "1.9\_STABLE" branch: <https://reviews.mahara.org/4645>

Patch for "1.9\_STABLE" branch: https://reviews.mahara.org/4645

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2015-04-16: |  |  | [#8](/mahara/%2Bbug/1348024/comments/8) |
| --- | --- | --- | --- |

Patch for "1.8\_STABLE" branch: <https://reviews.mahara.org/4646>

Patch for "1.8\_STABLE" branch: https://reviews.mahara.org/4646

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2015-04-16:  [**A change has been merged**](/mahara/%2Bbug/1348024/comments/9) |  |  | [#9](/mahara/%2Bbug/1348024/comments/9) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/4644>

Committed: <http://gitorious.org/mahara/mahara/commit/ed686cadbbb6eb574bf788732008e7f21be2d669>

Submitter: Aaron Wells (<email address hidden>)

Branch: 1.10\_STABLE

commit ed686cadbbb6eb574bf788732008e7f21be2d669

Author: Robert Lyon <email address hidden>

Date: Fri Jul 25 10:21:48 2014 +1200

Getting suspended institutions to keep their user out. ([Bug 1348024](/bugs/1348024))

Users who are logged in on the suspended institution's auth method

are logged out.

Change-Id: I10e1dec465a4363a076e92f4d90ec663ff8a822e

Signed-off-by: Robert Lyon <email address hidden>

Reviewed: https://reviews.mahara.org/4644
Committed: http://gitorious.org/mahara/mahara/commit/ed686cadbbb6eb574bf788732008e7f21be2d669
Submitter: Aaron Wells (aaronw@catalyst.net.nz)
Branch: 1.10\_STABLE
commit ed686cadbbb6eb574bf788732008e7f21be2d669
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Fri Jul 25 10:21:48 2014 +1200
Getting suspended institutions to keep their user out. (Bug 1348024)
Users who are logged in on the suspended institution's auth method
are logged out.
Change-Id: I10e1dec465a4363a076e92f4d90ec663ff8a822e
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2015-04-16: |  |  | [#10](/mahara/%2Bbug/1348024/comments/10) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/4645>

Committed: <http://gitorious.org/mahara/mahara/commit/847f49ef9a33e7200b4f2b0408c773c700b08f91>

Submitter: Aaron Wells (<email address hidden>)

Branch: 1.9\_STABLE

commit 847f49ef9a33e7200b4f2b0408c773c700b08f91

Author: Robert Lyon <email address hidden>

Date: Fri Jul 25 10:21:48 2014 +1200

Getting suspended institutions to keep their user out. ([Bug 1348024](/bugs/1348024))

Users who are logged in on the suspended institution's auth method

are logged out.

Change-Id: I10e1dec465a4363a076e92f4d90ec663ff8a822e

Signed-off-by: Robert Lyon <email address hidden>

Reviewed: https://reviews.mahara.org/4645
Committed: http://gitorious.org/mahara/mahara/commit/847f49ef9a33e7200b4f2b0408c773c700b08f91
Submitter: Aaron Wells (aaronw@catalyst.net.nz)
Branch: 1.9\_STABLE
commit 847f49ef9a33e7200b4f2b0408c773c700b08f91
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Fri Jul 25 10:21:48 2014 +1200
Getting suspended institutions to keep their user out. (Bug 1348024)
Users who are logged in on the suspended institution's auth method
are logged out.
Change-Id: I10e1dec465a4363a076e92f4d90ec663ff8a822e
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2015-04-16: |  |  | [#11](/mahara/%2Bbug/1348024/comments/11) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/4646>

Committed: <http://gitorious.org/mahara/mahara/commit/a8ec085adca536f4af54a2061866cb8a00ac510f>

Submitter: Aaron Wells (<email address hidden>)

Branch: 1.8\_STABLE

commit a8ec085adca536f4af54a2061866cb8a00ac510f

Author: Robert Lyon <email address hidden>

Date: Fri Jul 25 10:21:48 2014 +1200

Getting suspended institutions to keep their user out. ([Bug 1348024](/bugs/1348024))

Users who are logged in on the suspended institution's auth method

are logged out.

Change-Id: I10e1dec465a4363a076e92f4d90ec663ff8a822e

Signed-off-by: Robert Lyon <email address hidden>

Reviewed: https://reviews.mahara.org/4646
Committed: http://gitorious.org/mahara/mahara/commit/a8ec085adca536f4af54a2061866cb8a00ac510f
Submitter: Aaron Wells (aaronw@catalyst.net.nz)
Branch: 1.8\_STABLE
commit a8ec085adca536f4af54a2061866cb8a00ac510f
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Fri Jul 25 10:21:48 2014 +1200
Getting suspended institutions to keep their user out. (Bug 1348024)
Users who are logged in on the suspended institution's auth method
are logged out.
Change-Id: I10e1dec465a4363a076e92f4d90ec663ff8a822e
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2015-04-16: |  |  | [#12](/mahara/%2Bbug/1348024/comments/12) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/4643>

Committed: <http://gitorious.org/mahara/mahara/commit/5f435f01fce1e31316c1e36c6a283f58de278e5f>

Submitter: Aaron Wells (<email address hidden>)

Branch: 15.04\_STABLE

commit 5f435f01fce1e31316c1e36c6a283f58de278e5f

Author: Robert Lyon <email address hidden>

Date: Fri Jul 25 10:21:48 2014 +1200

Getting suspended institutions to keep their user out. ([Bug 1348024](/bugs/1348024))

Users who are logged in on the suspended institution's auth method

are logged out.

Change-Id: I10e1dec465a4363a076e92f4d90ec663ff8a822e

Signed-off-by: Robert Lyon <email address hidden>

Reviewed: https://reviews.mahara.org/4643
Committed: http://gitorious.org/mahara/mahara/commit/5f435f01fce1e31316c1e36c6a283f58de278e5f
Submitter: Aaron Wells (aaronw@catalyst.net.nz)
Branch: 15.04\_STABLE
commit 5f435f01fce1e31316c1e36c6a283f58de278e5f
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Fri Jul 25 10:21:48 2014 +1200
Getting suspended institutions to keep their user out. (Bug 1348024)
Users who are logged in on the suspended institution's auth method
are logged out.
Change-Id: I10e1dec465a4363a076e92f4d90ec663ff8a822e
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2015-04-17

| Changed in mahara: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

[Jinelle Foley-Barnes (jinelleb)](https://launchpad.net/~jinelleb)
on 2015-04-20

| **tags**: | added: behat needs-behat |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1348024/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1348024/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1348024/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1348024/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


