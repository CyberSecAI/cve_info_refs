Based on the provided information, here's an analysis of CVE-2017-1000386:

**Root cause of vulnerability:**
The Active Choices plugin allowed users with Job/Configure permission to inject arbitrary HTML, including JavaScript, into the "Build With Parameters" page through the "Active Choices Reactive Reference Parameter" type. This was due to insufficient sanitization of user-provided HTML.

**Weaknesses/vulnerabilities present:**
- **Persisted Cross-Site Scripting (XSS):** The vulnerability allowed malicious HTML/JavaScript to be stored and executed within the context of the Jenkins application when a user views the "Build With Parameters" page.

**Impact of exploitation:**
- An attacker could execute arbitrary JavaScript in the victim's browser when they access the vulnerable page.
- This could lead to actions such as session hijacking, sensitive information disclosure, or further attacks against Jenkins users.
- The attacker could potentially gain control over the victim's Jenkins account or the Jenkins instance itself.

**Attack vectors:**
- An attacker would need to have "Job/Configure" permission to modify the job configuration.
- The attacker would inject the malicious HTML/JavaScript via the "Active Choices Reactive Reference Parameter" configuration option.
- The victim would be the Jenkins user who views the "Build With Parameters" page.

**Required attacker capabilities/position:**
- The attacker requires valid credentials with at least the "Job/Configure" permission for a Jenkins job.

**Additional details:**
- The vulnerability is mitigated by sanitizing the HTML inserted on the "Build With Parameters" page when a script is executed in a sandbox.
- For Groovy scripts emitting HTML, they need to be configured to run outside the script security sandbox, possibly requiring administrator approval.