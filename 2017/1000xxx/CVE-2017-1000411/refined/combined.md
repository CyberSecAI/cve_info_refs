=== Content from seclists.org_d86e4f27_20250125_232914.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](51)
[By Date](date.html#52)
[![Next](/images/right-icon-16x16.png)](53)

[![Previous](/images/left-icon-16x16.png)](54)
[By Thread](index.html#52)
[![Next](/images/right-icon-16x16.png)](56)

![](/shared/images/nst-icons.svg#search)

# opendaylight-advisory: Multiple "expired" flows consume the memory resource of CONFIG DS

---

*From*: Luke Hinds <lhinds () redhat com>

*Date*: Tue, 16 Jan 2018 15:12:37 +0000

---

```
Issue

Multiple "expired" flows consume memory resources of CONFIG DS which
leads to Controller shutdown.

The following issue was discovered and reported by Vaibhav Hemant Dixit.

Summary

Multiple "expired" flows take up the memory resource of CONFIG DATASTORE
which leads to CONTROLLER shutdown.

Affected Services / Software

OpenFlow Plugin and OpenDayLight Controller.

Versions: Nitrogen, Carbon, Boron   Robert Varga, Anil Vishnoi -< please
verify versions affected (back to depreciated releases).

Discussion

If multiple different flows with "idle-timeout" and "hard-timeout" are
sent to the Openflow Plugin REST API, the expired flows will eventually
crash the controller once its resource allocations set with the JVM size
are exceeded.

Although the installed flows(with timeout set) are removed from network
(an thus also from controller's operations DS), the expired entries are
still present in CONFIG DS.

The attack can originate both from NORTH or SOUTH. The above description
is for a north bound attack. A south bound attack can originate when an
attacker attempts a flow flooding attack and since flows come with
timeouts, the attack is not successful. However, the attacker will now
be successful in CONTROLLER overflow attack (resource consumption).

Although, the network(actual flow tables) and operational DS are only
(~)1% occupied, the controller requests for resource consumption. This
happens because the installed flows get removed from the network upon
timeout.

Proposed patch

No patches have been made available, as this issue is mitigated by means
of a secure architecture (See Recommended Actions below).

Recommended Actions

Management APIâ€™s within OpenDayLight should only ever be deployed within
a segregated private network and never exposed to public networks, this
includes the OpenFlowPlugin. Further protections can be implemented by
deploying a rate limiting proxy (such as OpenRepose, HAProxy, nginx,
mod_ratelimit etc) or web application firewall.

CVE: CVE-2017-1000411

Regards,

Luke Hinds (OpenDayLight Security Manager)

```

**Attachment:
[signature.asc](att-52/signature_asc.bin)**

*Description:* OpenPGP digital signature

---

[![Previous](/images/left-icon-16x16.png)](51)
[By Date](date.html#52)
[![Next](/images/right-icon-16x16.png)](53)

[![Previous](/images/left-icon-16x16.png)](54)
[By Thread](index.html#52)
[![Next](/images/right-icon-16x16.png)](56)

### Current thread:

* **opendaylight-advisory: Multiple "expired" flows consume the memory resource of CONFIG DS** *Luke Hinds (Jan 16)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


