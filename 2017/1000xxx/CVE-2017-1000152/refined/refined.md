Based on the provided content, here's the breakdown of the vulnerability:

**Root Cause of Vulnerability:**
The root cause lies in the way Mahara's `remove_duplicate_cookies()` function handled session headers in PHP 5.3. The function was not properly removing duplicate session cookies due to differences in how PHP 5.3 handled session headers compared to later versions. Specifically:

1.  `header_remove('Set-Cookie')` did not remove session headers in PHP 5.3.
2.  In PHP 5.3, session headers were visible in `headers_list()`. When the session ID was changed (due to `session_destroy()` and `session_regenerate_id()`), the use of `array_unique()` in the function would preserve both old and new session IDs, sending both back to the browser.

**Weaknesses/Vulnerabilities Present:**

*   **Inadequate Session Header Removal:** The `remove_duplicate_cookies()` function failed to properly remove old session headers, leading to potential issues with session management.
*   **Duplicate Session IDs:** The function's use of `array_unique()` in PHP 5.3 resulted in sending multiple session IDs to the browser, which could potentially lead to unexpected behavior.
*   **Incorrect usage of `set_cookie()`:** A typo was made by using `set_cookie()` instead of `setcookie()`. This could cause the cookie to break if the `$cfg->cookieprefix` setting was used.

**Impact of Exploitation:**
The content does not specify the precise impact of exploitation, but the identified weaknesses could potentially lead to:
* Unpredictable session behavior.
* Potential session corruption or hijacking due to multiple session IDs being sent to the client.
* Broken cookies if `cookieprefix` was used.

**Attack Vectors:**
The vulnerability is triggered by a user interacting with the application, specifically when the session ID changes due to actions like session destruction and regeneration. The attack vector isn't directly external but rather an internal issue related to the logic of how Mahara handles sessions in PHP 5.3.

**Required Attacker Capabilities/Position:**
No specific attacker position or capabilities are mentioned. The issue is triggered by normal application usage, specifically when the session is destroyed and regenerated. An attacker would potentially benefit from any exploitable state due to these issues.

**Additional notes:**
- The issue was a regression introduced in Mahara 15.04 and was not present in 1.10.
- The fix involved multiple changes: loading the session earlier, using `header_remove()` without parameters to remove all cookies, and making `remove_duplicate_cookies()` aware of the current session ID.
- Typo in cookie issuing code was fixed, where `set_cookie()` was used instead of `setcookie()`.