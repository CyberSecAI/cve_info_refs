- **Root cause of vulnerability**: The vulnerability lies in the lack of sanitization of user-provided input when adding new devices or hosts via the REST interface. Specifically, if javascript code is included in parameters like `serial`, `swVersion`, `hwVersion`, or `manufacturer`, it's stored and later executed when a user interacts with the device in the GUI.
- **Weaknesses/vulnerabilities present**: Cross-site scripting (XSS) vulnerability. The system fails to properly sanitize user-provided input when adding devices or hosts via the REST interface, allowing for the injection of malicious javascript code.
- **Impact of exploitation**: Successful exploitation allows an attacker to execute arbitrary javascript code in the context of a user's session when they visit the topology in the GUI and interact with a malicious device entry. This could lead to a variety of malicious actions, such as session hijacking, data theft, or further compromise of the system.
- **Attack vectors**: An attacker can exploit this vulnerability by crafting a malicious REST request to add a new device or host, embedding malicious javascript code into the device parameters (`serial`, `swVersion`, `hwVersion`, or `manufacturer`).
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the REST API and also to understand the REST API structure/required parameters. The attacker doesn't need to be authenticated to add new devices/hosts via the REST API.