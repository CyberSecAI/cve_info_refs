=== Content from bugs.launchpad.net_a58100ba_20250124_120004.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1508684/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Unserialize untrusted data when importing skins

Bug #1508684 reported by
[Son Nguyen](https://launchpad.net/~ngson2000)
on 2015-10-21

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | Critical | Unassigned | [Mahara 16.10.0](https://launchpad.net/mahara/%2Bmilestone/16.10.0) |
|  | [15.04](https://bugs.launchpad.net/mahara/15.04) | Fix Released | Critical | Unassigned | [Mahara 15.04.8](https://launchpad.net/mahara/%2Bmilestone/15.04.8) |
|  | [15.10](https://bugs.launchpad.net/mahara/15.10) | Fix Released | Critical | [Son Nguyen](https://launchpad.net/~ngson2000) | [Mahara 15.10.4](https://launchpad.net/mahara/%2Bmilestone/15.10.4) |
|  | [16.04](https://bugs.launchpad.net/mahara/16.04) | Fix Released | Critical | Unassigned | [Mahara 16.04.2](https://launchpad.net/mahara/%2Bmilestone/16.04.2) |

### Bug Description

Version: 1.10, 15.04. 15.10, master

Platform: any

There is a unserialize vulnerability in skin import function

see line 200 in htdocs/skin/import.php

When importing the attached skin, you will see the error:

[WAR] ce (lib/web.php:3684) Object of class \_\_PHP\_Incomplete\_Class could not be converted to string

Call stack (most recent first):

log\_message("Object of class \_\_PHP\_Incomplete\_Class could not b...", 8, true, true, "/var/www/mahara/master/htdocs/lib/web.php", 3684) at /var/www/mahara/master/htdocs/lib/errors.php:441

error(4096, "Object of class \_\_PHP\_Incomplete\_Class could not b...", "/var/www/mahara/master/htdocs/lib/web.php", 3684, array(size 5)) at /var/www/mahara/master/htdocs/lib/web.php:3684

clean\_css(object(\_\_PHP\_Incomplete\_Class), true) at /var/www/mahara/master/htdocs/skin/import.php:200

importskinform\_submit(object(Pieform), array(size 4)) at Unknown:0

call\_user\_func\_array("importskinform\_submit", array(size 2)) at /var/www/mahara/master/htdocs/lib/pieforms/pieform.php:537

Pieform->\_\_construct(array(size 4)) at /var/www/mahara/master/htdocs/lib/pieforms/pieform.php:164

Pieform::process(array(size 4)) at /var/www/mahara/master/htdocs/lib/pieforms/pieform.php:71

pieform(array(size 4)) at /var/www/mahara/master/htdocs/skin/import.php:64

## CVE References

* [2017-1000148](/bugs/cve/2017-1000148 "Mahara 15.04 before 15.04.8 and 15.10...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Son Nguyen (ngson2000)](https://launchpad.net/~ngson2000) wrote on 2015-10-21: |  |  | [#1](/mahara/%2Bbug/1508684/comments/1) |
| --- | --- | --- | --- |

* [myskin.xml](https://bugs.launchpad.net/mahara/%2Bbug/1508684/%2Battachment/4502005/%2Bfiles/myskin.xml)
  [Edit](/mahara/%2Bbug/1508684/%2Battachment/4502005)
  (2.4 KiB,
  application/xml)

| **information type**: | Public → Private Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2015-11-26: |  |  | [#2](/mahara/%2Bbug/1508684/comments/2) |
| --- | --- | --- | --- |

<https://reviews.mahara.org/#/c/5579/>

https://reviews.mahara.org/#/c/5579/

[Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner)
on 2016-05-19

| **no longer affects**: | mahara/1.9 |
| --- | --- |
| **no longer affects**: | mahara/1.10 |
| Changed in mahara: | |
| **milestone**: | 16.04.1 → 16.10.0 |

[Son Nguyen (ngson2000)](https://launchpad.net/~ngson2000)
on 2016-06-19

| Changed in mahara: | |
| --- | --- |
| **status**: | Confirmed → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2016-07-11:  [**A change has been merged**](/mahara/%2Bbug/1508684/comments/3) |  |  | [#3](/mahara/%2Bbug/1508684/comments/3) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/6677>

Committed: <https://git.mahara.org/mahara/mahara/commit/1f299954f3ffbc26c69e27f000daf8f0e97de457>

Submitter: Robert Lyon (<email address hidden>)

Branch: 16.04\_STABLE

commit 1f299954f3ffbc26c69e27f000daf8f0e97de457

Author: Son Nguyen <email address hidden>

Date: Thu Oct 22 10:55:40 2015 +1300

Make sure imported custom skin xml entries are clean. [Bug 1508684](/bugs/1508684)

behatnotneeded

Change-Id: I2e597d5931391e731baefa46d5f9d9ca2059ee10

Reviewed: https://reviews.mahara.org/6677
Committed: https://git.mahara.org/mahara/mahara/commit/1f299954f3ffbc26c69e27f000daf8f0e97de457
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 16.04\_STABLE
commit 1f299954f3ffbc26c69e27f000daf8f0e97de457
Author: Son Nguyen <son.nguyen@catalyst.net.nz>
Date: Thu Oct 22 10:55:40 2015 +1300
Make sure imported custom skin xml entries are clean. Bug 1508684
behatnotneeded
Change-Id: I2e597d5931391e731baefa46d5f9d9ca2059ee10

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2016-07-11: |  |  | [#4](/mahara/%2Bbug/1508684/comments/4) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/6679>

Committed: <https://git.mahara.org/mahara/mahara/commit/9d7701e80b24bdbaccb77ae7730ae9c504d1143b>

Submitter: Robert Lyon (<email address hidden>)

Branch: 15.04\_STABLE

commit 9d7701e80b24bdbaccb77ae7730ae9c504d1143b

Author: Son Nguyen <email address hidden>

Date: Thu Oct 22 10:55:40 2015 +1300

Make sure imported custom skin xml entries are clean. [Bug 1508684](/bugs/1508684)

behatnotneeded

Change-Id: I2e597d5931391e731baefa46d5f9d9ca2059ee10

Reviewed: https://reviews.mahara.org/6679
Committed: https://git.mahara.org/mahara/mahara/commit/9d7701e80b24bdbaccb77ae7730ae9c504d1143b
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 15.04\_STABLE
commit 9d7701e80b24bdbaccb77ae7730ae9c504d1143b
Author: Son Nguyen <son.nguyen@catalyst.net.nz>
Date: Thu Oct 22 10:55:40 2015 +1300
Make sure imported custom skin xml entries are clean. Bug 1508684
behatnotneeded
Change-Id: I2e597d5931391e731baefa46d5f9d9ca2059ee10

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2016-07-11: |  |  | [#5](/mahara/%2Bbug/1508684/comments/5) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/6678>

Committed: <https://git.mahara.org/mahara/mahara/commit/3f9514bdaa9b70457a404cd1b9aa502c261aeef2>

Submitter: Robert Lyon (<email address hidden>)

Branch: 15.10\_STABLE

commit 3f9514bdaa9b70457a404cd1b9aa502c261aeef2

Author: Son Nguyen <email address hidden>

Date: Thu Oct 22 10:55:40 2015 +1300

Make sure imported custom skin xml entries are clean. [Bug 1508684](/bugs/1508684)

behatnotneeded

Change-Id: I2e597d5931391e731baefa46d5f9d9ca2059ee10

Reviewed: https://reviews.mahara.org/6678
Committed: https://git.mahara.org/mahara/mahara/commit/3f9514bdaa9b70457a404cd1b9aa502c261aeef2
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 15.10\_STABLE
commit 3f9514bdaa9b70457a404cd1b9aa502c261aeef2
Author: Son Nguyen <son.nguyen@catalyst.net.nz>
Date: Thu Oct 22 10:55:40 2015 +1300
Make sure imported custom skin xml entries are clean. Bug 1508684
behatnotneeded
Change-Id: I2e597d5931391e731baefa46d5f9d9ca2059ee10

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2016-07-11

| **information type**: | Private Security → Public Security |
| --- | --- |

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2016-10-21

| Changed in mahara: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

[sa (bbbrrr800)](https://launchpad.net/~bbbrrr800)
on 2018-09-14

| Changed in mahara: | |
| --- | --- |
| **assignee**: | Son Nguyen (ngson2000) → sa (bbbrrr800) |

[Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner)
on 2018-09-16

| Changed in mahara: | |
| --- | --- |
| **assignee**: | sa (bbbrrr800) → nobody |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1508684/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1508684/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1508684/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1508684/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [myskin.xml](https://bugs.launchpad.net/mahara/%2Bbug/1508684/%2Battachment/4502005/%2Bfiles/myskin.xml)
  [Edit](/mahara/%2Bbug/1508684/%2Battachment/4502005 "Change attachment details")

* [Add attachment](/mahara/%2Bbug/1508684/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
50c26bf
([Get the code!](https://dev.launchpad.net/))


