=== Content from github.com_71bfa220_20250124_150643.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fweechat%2Fweechat%2Fcommit%2Ff105c6f0b56fb5687b2d2aedf37cb1d1b434d556)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fweechat%2Fweechat%2Fcommit%2Ff105c6f0b56fb5687b2d2aedf37cb1d1b434d556)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=weechat%2Fweechat)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[weechat](/weechat)
/
**[weechat](/weechat/weechat)**
Public

* [Notifications](/login?return_to=%2Fweechat%2Fweechat) You must be signed in to change notification settings
* [Fork
  332](/login?return_to=%2Fweechat%2Fweechat)
* [Star
   3k](/login?return_to=%2Fweechat%2Fweechat)

* [Code](/weechat/weechat)
* [Issues
  383](/weechat/weechat/issues)
* [Pull requests
  47](/weechat/weechat/pulls)
* [Actions](/weechat/weechat/actions)
* [Projects
  0](/weechat/weechat/projects)
* [Wiki](/weechat/weechat/wiki)
* [Security](/weechat/weechat/security)
* [Insights](/weechat/weechat/pulse)

Additional navigation options

* [Code](/weechat/weechat)
* [Issues](/weechat/weechat/issues)
* [Pull requests](/weechat/weechat/pulls)
* [Actions](/weechat/weechat/actions)
* [Projects](/weechat/weechat/projects)
* [Wiki](/weechat/weechat/wiki)
* [Security](/weechat/weechat/security)
* [Insights](/weechat/weechat/pulse)

## Commit

[Permalink](/weechat/weechat/commit/f105c6f0b56fb5687b2d2aedf37cb1d1b434d556)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

logger: call strftime before replacing buffer local variables

[Browse files](/weechat/weechat/tree/f105c6f0b56fb5687b2d2aedf37cb1d1b434d556)
Browse the repository at this point in the history

* Loading branch information

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

[flashcode](/weechat/weechat/commits?author=flashcode "View all commits by flashcode")
committed
Sep 23, 2017

1 parent
[1206a7b](/weechat/weechat/commit/1206a7bbe46fec0683ceca59d541e6993af07a8f)

commit f105c6f

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**51 additions**
and
**44 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* ChangeLog.adoc
  [ChangeLog.adoc](#diff-6dfceaabeb5e8d3002f186c22261214a9aa9d96b80d0e8e49205de613774ab11)
* src/plugins/logger

  + src/plugins/logger/logger.c
    [logger.c](#diff-c8326e0e19056f6388999ef2809aa1ef0b53104e735faed843c8533d26a8f9cc)

## There are no files selected for viewing

7 changes: 7 additions & 0 deletions

7
[ChangeLog.adoc](#diff-6dfceaabeb5e8d3002f186c22261214a9aa9d96b80d0e8e49205de613774ab11 "ChangeLog.adoc")

Show comments

[View file](/weechat/weechat/blob/f105c6f0b56fb5687b2d2aedf37cb1d1b434d556/ChangeLog.adoc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -15,6 +15,13 @@ https://weechat.org/files/releasenotes/ReleaseNotes-devel.html[release notes] |
|  |  | (file \_ReleaseNotes.adoc\_ in sources). |
|  |  |  |
|  |  |  |
|  |  | [[v1.9.1]] |
|  |  | == Version 1.9.1 (under dev) |
|  |  |  |
|  |  | Bug fixes:: |
|  |  |  |
|  |  | \* logger: call strftime before replacing buffer local variables |
|  |  |  |
|  |  | [[v1.9]] |
|  |  | == Version 1.9 (2017-06-25) |
|  |  |  |
| Expand Down | |  |

88 changes: 44 additions & 44 deletions

88
[src/plugins/logger/logger.c](#diff-c8326e0e19056f6388999ef2809aa1ef0b53104e735faed843c8533d26a8f9cc "src/plugins/logger/logger.c")

Show comments

[View file](/weechat/weechat/blob/f105c6f0b56fb5687b2d2aedf37cb1d1b434d556/src/plugins/logger/logger.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -295,71 +295,71 @@ logger\_get\_mask\_for\_buffer (struct t\_gui\_buffer \*buffer) |
|  |  | char \* |
|  |  | logger\_get\_mask\_expanded (struct t\_gui\_buffer \*buffer, const char \*mask) |
|  |  | { |
|  |  | char \*mask2, \*mask\_decoded, \*mask\_decoded2, \*mask\_decoded3, \*mask\_decoded4; |
|  |  | char \*mask\_decoded5; |
|  |  | char \*mask2, \*mask3, \*mask4, \*mask5, \*mask6, \*mask7; |
|  |  | const char \*dir\_separator; |
|  |  | int length; |
|  |  | time\_t seconds; |
|  |  | struct tm \*date\_tmp; |
|  |  |  |
|  |  | mask2 = NULL; |
|  |  | mask\_decoded = NULL; |
|  |  | mask\_decoded2 = NULL; |
|  |  | mask\_decoded3 = NULL; |
|  |  | mask\_decoded4 = NULL; |
|  |  | mask\_decoded5 = NULL; |
|  |  | mask3 = NULL; |
|  |  | mask4 = NULL; |
|  |  | mask5 = NULL; |
|  |  | mask6 = NULL; |
|  |  | mask7 = NULL; |
|  |  |  |
|  |  | dir\_separator = weechat\_info\_get ("dir\_separator", ""); |
|  |  | if (!dir\_separator) |
|  |  | return NULL; |
|  |  |  |
|  |  | /\* replace date/time specifiers in mask \*/ |
|  |  | length = strlen (mask) + 256 + 1; |
|  |  | mask2 = malloc (length); |
|  |  | if (!mask2) |
|  |  | goto end; |
|  |  | seconds = time (NULL); |
|  |  | date\_tmp = localtime (&seconds); |
|  |  | mask2[0] = '\0'; |
|  |  | if (strftime (mask2, length - 1, mask, date\_tmp) == 0) |
|  |  | mask2[0] = '\0'; |
|  |  |  |
|  |  | /\* |
|  |  | \* we first replace directory separator (commonly '/') by \01 because |
|  |  | \* buffer mask can contain this char, and will be replaced by replacement |
|  |  | \* char ('\_' by default) |
|  |  | \*/ |
|  |  | mask2 = weechat\_string\_replace (mask, dir\_separator, "\01"); |
|  |  | if (!mask2) |
|  |  | mask3 = weechat\_string\_replace (mask2, dir\_separator, "\01"); |
|  |  | if (!mask3) |
|  |  | goto end; |
|  |  |  |
|  |  | mask\_decoded = weechat\_buffer\_string\_replace\_local\_var (buffer, mask2); |
|  |  | if (!mask\_decoded) |
|  |  | mask4 = weechat\_buffer\_string\_replace\_local\_var (buffer, mask3); |
|  |  | if (!mask4) |
|  |  | goto end; |
|  |  |  |
|  |  | mask\_decoded2 = weechat\_string\_replace (mask\_decoded, |
|  |  | dir\_separator, |
|  |  | weechat\_config\_string (logger\_config\_file\_replacement\_char)); |
|  |  | if (!mask\_decoded2) |
|  |  | mask5 = weechat\_string\_replace (mask4, |
|  |  | dir\_separator, |
|  |  | weechat\_config\_string (logger\_config\_file\_replacement\_char)); |
|  |  | if (!mask5) |
|  |  | goto end; |
|  |  |  |
|  |  | #ifdef \_\_CYGWIN\_\_ |
|  |  | mask\_decoded3 = weechat\_string\_replace (mask\_decoded2, "\\", |
|  |  | weechat\_config\_string (logger\_config\_file\_replacement\_char)); |
|  |  | mask6 = weechat\_string\_replace (mask5, "\\", |
|  |  | weechat\_config\_string (logger\_config\_file\_replacement\_char)); |
|  |  | #else |
|  |  | mask\_decoded3 = strdup (mask\_decoded2); |
|  |  | mask6 = strdup (mask5); |
|  |  | #endif /\* \_\_CYGWIN\_\_ \*/ |
|  |  | if (!mask\_decoded3) |
|  |  | if (!mask6) |
|  |  | goto end; |
|  |  |  |
|  |  | /\* restore directory separator \*/ |
|  |  | mask\_decoded4 = weechat\_string\_replace (mask\_decoded3, |
|  |  | "\01", dir\_separator); |
|  |  | if (!mask\_decoded4) |
|  |  | goto end; |
|  |  |  |
|  |  | /\* replace date/time specifiers in mask \*/ |
|  |  | length = strlen (mask\_decoded4) + 256 + 1; |
|  |  | mask\_decoded5 = malloc (length); |
|  |  | if (!mask\_decoded5) |
|  |  | mask7 = weechat\_string\_replace (mask6, |
|  |  | "\01", dir\_separator); |
|  |  | if (!mask7) |
|  |  | goto end; |
|  |  | seconds = time (NULL); |
|  |  | date\_tmp = localtime (&seconds); |
|  |  | mask\_decoded5[0] = '\0'; |
|  |  | strftime (mask\_decoded5, length - 1, mask\_decoded4, date\_tmp); |
|  |  |  |
|  |  | /\* convert to lower case? \*/ |
|  |  | if (weechat\_config\_boolean (logger\_config\_file\_name\_lower\_case)) |
|  |  | weechat\_string\_tolower (mask\_decoded5); |
|  |  | weechat\_string\_tolower (mask7); |
|  |  |  |
|  |  | if (weechat\_logger\_plugin->debug) |
|  |  | { |
| Expand All | | @@ -368,22 +368,22 @@ logger\_get\_mask\_expanded (struct t\_gui\_buffer \*buffer, const char \*mask) |
|  |  | "decoded mask = \"%s\"", |
|  |  | LOGGER\_PLUGIN\_NAME, |
|  |  | weechat\_buffer\_get\_string (buffer, "name"), |
|  |  | mask, mask\_decoded5); |
|  |  | mask, mask7); |
|  |  | } |
|  |  |  |
|  |  | end: |
|  |  | if (mask2) |
|  |  | free (mask2); |
|  |  | if (mask\_decoded) |
|  |  | free (mask\_decoded); |
|  |  | if (mask\_decoded2) |
|  |  | free (mask\_decoded2); |
|  |  | if (mask\_decoded3) |
|  |  | free (mask\_decoded3); |
|  |  | if (mask\_decoded4) |
|  |  | free (mask\_decoded4); |
|  |  |  |
|  |  | return mask\_decoded5; |
|  |  | if (mask3) |
|  |  | free (mask3); |
|  |  | if (mask4) |
|  |  | free (mask4); |
|  |  | if (mask5) |
|  |  | free (mask5); |
|  |  | if (mask6) |
|  |  | free (mask6); |
|  |  |  |
|  |  | return mask7; |
|  |  | } |
|  |  |  |
|  |  | /\* |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f105c6f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fweechat%2Fweechat%2Fcommit%2Ff105c6f0b56fb5687b2d2aedf37cb1d1b434d556) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from weechat.org_a15fd934_20250124_150643.html ===

[![WeeChat](/media/images/weechat_logo_small.png)](/)

[Home](/)
[About](/about/)
[Documentation](/doc/)
[Download](/download/)
[Scripts](/scripts/)
[Development](/dev/)

[Donate](/donate/ "Donate")

English
Français
Deutsch
Italiano
Polski
Portugues (Brasil)
日本語

#### [Version 1.9.1 (security release)](/news/98/20170923-Version-1.9.1-security-release/) (Sep 23, 2017)

Version 1.9.1 is available, it fixes a security problem: a crash can happen in logger plugin when converting date/time specifiers in file mask. Two other bugs are fixed as well in buflist and relay plugins.
Upgrade is recommended for all users.

More information on the [page with security issues](/doc/security/).

[Back to news](/news/)
[Back to home](/)

* [Home](/)
* [Latest news](/news/)
* [Upcoming events](/events/)
* [Make a donation](/donate/)

* [About](/about/)
* [Features](/about/features/)
* [Interfaces](/about/interfaces/)
* [Screenshots](/about/screenshots/)
* [History](/about/history/)
* [Support](/about/support/)
* [WeeChat.org](/about/weechat.org/)

* [Documentation](/doc/)
* [WeeChat](/doc/weechat/stable/)
* [WeeChat Relay](/doc/weechat-relay/stable/)
* [QWeeChat](/doc/qweechat/stable/)

* [Download](/download/)
* [WeeChat](/download/weechat/stable/)
* [WeeChat Relay](/download/weechat-relay/stable/)
* [QWeeChat](/download/qweechat/stable/)
* [Debian/Ubuntu repositories](/download/debian/)

* [Scripts](/scripts/)
* [Browse scripts](/scripts/)
* [Unofficial scripts](/files/scripts/unofficial/)
* [Python 3](/scripts/python3/)

* [Development](/dev/)
* [Roadmap](/dev/roadmap/)
* [Statistics](/dev/stats/)
* [Info](/dev/info/)
* [Development blog](https://blog.weechat.org/)

[GitHub](https://github.com/weechat "GitHub")
[Mastodon](https://hostux.social/%40weechat "Mastodon")
[Diaspora](https://diasp.eu/u/weechat "Diaspora")
[X](https://x.com/WeeChatClient "X")

Copyright © 2003-2025 Sébastien Helleu
—
[About WeeChat.org](/about/weechat.org/)
— Theme: **dark**
([light](?theme=light))



=== Content from weechat.org_a19510d1_20250124_150643.html ===

[![WeeChat](/media/images/weechat_logo_small.png)](/)

[Home](/)
[About](/about/)
[Documentation](/doc/)
[Download](/download/)
[Scripts](/scripts/)
[Development](/dev/)

[Donate](/donate/ "Donate")

English
Français
Deutsch
Italiano
Polski
Portugues (Brasil)
日本語

* [WeeChat](/doc/weechat/stable/)
* [WeeChat Relay](/doc/weechat-relay/stable/)
* [QWeeChat](/doc/qweechat/stable/)

* [Stable](/doc/weechat/stable/)
* [Development](/doc/weechat/devel/)
* [Security](/doc/weechat/security/)

* [All vulnerabilities](/doc/weechat/security/)
* [Vulnerabilities by version](/doc/weechat/security/version/)

### Security vulnerabilities

This page lists all known and fixed security vulnerabilities in stable releases.

The security vulnerabilities introduced during development of a version and fixed before a stable release are not mentioned.

WeeChat Security Advisories (WSA) are sent to this mailing list, as soon as they are made public:
[weechat-security](https://lists.nongnu.org/mailman/listinfo/weechat-security)

To report a security issue, please **DO NOT** file an issue on GitHub, but send an email to security@weechat.org instead.

#### Overview: 17 vulnerabilities

| WSA | CVE | Score | Severity | Issue | Vulnerability type | Scope | Versions | Fix Release date | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [WSA-2024-1](#WSA-2024-1) | CVE-2024-46613 | 3.8 |  | Integer overflow in loops on lists. | Integer Overflow or Wraparound | Core, Plugins | 0.1.6 → 4.4.1 | 4.4.2 | Sep 8, 2024 |
| [WSA-2022-1](#WSA-2022-1) | CVE-2022-28352 | 4.3 |  | Possible man-in-the-middle attack in TLS connection to servers. | Improper certificate validation | IRC, Plugins | 3.2 → 3.4 | 3.4.1 | Mar 13, 2022 |
| [WSA-2021-1](#WSA-2021-1) | CVE-2021-40516 | 7.5 |  | Crash on malformed websocket frame in relay plugin. | Out-of-bounds read | Relay | 0.4.1 → 3.2 | 3.2.1 | Sep 4, 2021 |
| [WSA-2020-3](#WSA-2020-3) | CVE-2020-9760 | 7.5 |  | Buffer overflow on new IRC message 005 with nick prefixes. | Out-of-bounds write | IRC | 0.3.4 → 2.7 | 2.7.1 | Feb 20, 2020 |
| [WSA-2020-2](#WSA-2020-2) | CVE-2020-9759 | 7.5 |  | Crash on malformed IRC message 352 (WHO). | Out-of-bounds read | IRC | 0.4.0 → 2.7 | 2.7.1 | Feb 20, 2020 |
| [WSA-2020-1](#WSA-2020-1) | CVE-2020-8955 | 7.5 |  | Buffer overflow on malformed IRC message 324 (channel mode). | Out-of-bounds write | IRC | 0.3.8 → 2.7 | 2.7.1 | Feb 20, 2020 |
| [WSA-2017-2](#WSA-2017-2) | CVE-2017-14727 | 7.5 |  | Use of invalid pointer in build of log filename. | Access of uninitialized pointer | Logger | 0.3.2 → 1.9 | 1.9.1 | Sep 23, 2017 |
| [WSA-2017-1](#WSA-2017-1) | CVE-2017-8073 | 7.5 |  | Buffer overflow when receiving a DCC file. | Out-of-bounds write | IRC | 0.3.3 → 1.7 | 1.7.1 | Apr 22, 2017 |
| [WSA-2013-3](#WSA-2013-3) | - | 7.5 |  | Crash on IRC commands sent via Relay. | Access of uninitialized pointer | Relay | 0.3.8 → 0.4.0 | 0.4.1 | May 20, 2013 |
| [WSA-2013-2](#WSA-2013-2) | - | 5.5 |  | Crash on send of unknown commands to IRC server. | Access of uninitialized pointer | IRC | 0.3.0 → 0.4.0 | 0.4.1 | May 20, 2013 |
| [WSA-2013-1](#WSA-2013-1) | - | 5.5 |  | Crash on nicks monitored with /notify. | Access of uninitialized pointer | IRC | 0.3.6 → 0.4.0 | 0.4.1 | May 20, 2013 |
| [WSA-2012-2](#WSA-2012-2) | CVE-2012-5534 | 10.0 |  | Remote execution of commands via scripts. | Improper input validation | API | 0.3.0 → 0.3.9.1 | 0.3.9.2 | Nov 18, 2012 |
| [WSA-2012-1](#WSA-2012-1) | CVE-2012-5854 | 7.5 |  | Crash when decoding IRC colors. | Out-of-bounds write | IRC | 0.3.6 → 0.3.9 | 0.3.9.1 | Nov 9, 2012 |
| [WSA-2011-1](#WSA-2011-1) | CVE-2011-1428 | 5.3 |  | Possible man-in-the-middle attack in TLS connection to IRC server. | Improper certificate validation | IRC | 0.1.3 → 0.3.4 | 0.3.5 | May 15, 2011 |
| [WSA-2009-1](#WSA-2009-1) | CVE-2009-0661 | 7.5 |  | Crash when receiving WeeChat color codes in IRC messages. | Out-of-bounds read | IRC | 0.2.6 | 0.2.6.1 | Mar 14, 2009 |
| [WSA-2006-1](#WSA-2006-1) | - | 6.2 |  | Crash in API function infobar\_printf. | Access of uninitialized pointer | API | 0.0.5 → 0.1.6 | 0.1.7 | Jan 14, 2006 |
| [WSA-2004-1](#WSA-2004-1) | - | 6.2 |  | Buffer overflows in build of strings. | Out-of-bounds write | Core, IRC | 0.0.1 → 0.0.4 | 0.0.5 | Feb 7, 2004 |

#### [WSA-2024-1](/doc/weechat/security/WSA-2024-1/): [Core, Plugins] Integer overflow in loops on lists.

##### Vulnerability

CVE

CVE-2024-46613
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-46613) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2024-46613)
]

CVSS vector

AV:P/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L/E:X/RL:O/RC:C
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:P/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L/E:X/RL:O/RC:C&version=3.1))

CVSS score

3.8
 / 10

Severity

low

Vulnerability type

Integer Overflow or Wraparound

Scope

Core, Plugins

Affected versions

0.1.6 → 4.4.1

Fixed version

4.4.2

(Sep 8, 2024)
-
[ChangeLog](https://github.com/weechat/weechat/releases/tag/v4.4.2)

Tracker

[issue #2178](https://github.com/weechat/weechat/issues/2178)

Commits

[Commit](https://github.com/weechat/weechat/commit/315f769ab25643cf501a4bf8deb8025d92654303) [Commit](https://github.com/weechat/weechat/commit/5564baf424d847144f13ee50f0988e4f3407e638) [Commit](https://github.com/weechat/weechat/commit/62d0347d4bdee63694354184611b0b6af5028ff2) [Commit](https://github.com/weechat/weechat/commit/970f20af31cbcce02a99368eb633e8c4082dfe64) [Commit](https://github.com/weechat/weechat/commit/9aa0a94156c7cc367d52c31e60d8b03239d4dbd4)

##### Description

An integer overflow can happen when looping over items in a list.

This can only happen in rare conditions on 32 and 64-bit systems, as the list must contain more than 2,147,483,647 elements.

On 16-bit systems, this happens with a list that contains more than 32,767 elements.
##### Mitigation

There is no known mitigation.

The upgrade to the latest stable version is highly recommended.
##### Credit

The issue was discovered by Yiheng Cao.

---

#### [WSA-2022-1](/doc/weechat/security/WSA-2022-1/): [IRC, Plugins] Possible man-in-the-middle attack in TLS connection to servers.

##### Vulnerability

CVE

CVE-2022-28352
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28352) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2022-28352)
]

CVSS vector

AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N&version=3.1))

CVSS score

4.3
 / 10

Severity

medium

Vulnerability type

Improper certificate validation
([detail](https://cwe.mitre.org/data/definitions/295.html))

Scope

IRC, Plugins

Affected versions

3.2 → 3.4

Fixed version

3.4.1

(Mar 13, 2022)
-
[ChangeLog](/files/doc/weechat/ChangeLog-3.4.1.html)

Tracker

[issue #1763](https://github.com/weechat/weechat/issues/1763)

Commits

[Commit](https://github.com/weechat/weechat/commit/710247891cdfd4e66ee6d1715e93626def6871f1)

##### Description

After changing the options `weechat.network.gnutls_ca_system` or `weechat.network.gnutls_ca_user`, the TLS verification function is lost.

Consequently, any connection to a server with TLS is made without verifying the certificate, which could lead to a man-in-the-middle attack.

Connection to IRC servers with TLS is affected, as well as any connection a server made by a plugin or a script using the function hook\_connect.
##### Mitigation

After changing options `weechat.network.gnutls_ca_system` or `weechat.network.gnutls_ca_user`, you must restart WeeChat.

---

#### [WSA-2021-1](/doc/weechat/security/WSA-2021-1/): [Relay] Crash on malformed websocket frame in relay plugin.

##### Vulnerability

CVE

CVE-2021-40516
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40516) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2021-40516)
]

CVSS vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

7.5
 / 10

Severity

high

Vulnerability type

Out-of-bounds read
([detail](https://cwe.mitre.org/data/definitions/125.html))

Scope

Relay

Affected versions

0.4.1 → 3.2

Fixed version

3.2.1

(Sep 4, 2021)
-
[ChangeLog](/files/doc/weechat/ChangeLog-3.2.1.html)

Tracker

Not available

Commits

[Commit](https://github.com/weechat/weechat/commit/8b1331f98de1714bae15a9ca2e2b393ba49d735b)

##### Description

A crash happens when decoding a malformed websocket frame in relay plugin.

This happens even if a password is set in relay plugin, the malformed websocket frame can be received before the authentication of the client.
##### Mitigation

There are multiple ways to mitigate this issue:

* Rremove all relays, see: `/help relay`
* Unload relay plugin with command: `/plugin unload relay` and see: `/help weechat.plugin.autoload`
* Secure relay to allow only some trusted IP addresses, see: `/help relay.network.allowed_ips`

##### Credit

The issue was discovered by Stuart Nevans Locke.

---

#### [WSA-2020-3](/doc/weechat/security/WSA-2020-3/): [IRC] Buffer overflow on new IRC message 005 with nick prefixes.

##### Vulnerability

CVE

CVE-2020-9760
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9760) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2020-9760)
]

CVSS vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

7.5
 / 10

Severity

high

Vulnerability type

Out-of-bounds write
([detail](https://cwe.mitre.org/data/definitions/787.html))

Scope

IRC

Affected versions

0.3.4 → 2.7

Fixed version

2.7.1

(Feb 20, 2020)
-
[ChangeLog](/files/doc/weechat/ChangeLog-2.7.1.html)

Tracker

Not available

Commits

[Commit](https://github.com/weechat/weechat/commit/694b5c9f874d7337cd2e03761e0de435275dd64d)

##### Description

A buffer overflow happens when a new IRC message 005 is received with longer nick prefixes.

Note: a "normal" IRC server should not send again a message 005 with new nick prefixes, so the problem should be limited to malicious IRC servers.
##### Mitigation

There is no known mitigation.

The upgrade to the latest stable version is highly recommended.
##### Credit

The issue was discovered by Stuart Nevans Locke.

---

#### [WSA-2020-2](/doc/weechat/security/WSA-2020-2/): [IRC] Crash on malformed IRC message 352 (WHO).

##### Vulnerability

CVE

CVE-2020-9759
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9759) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2020-9759)
]

CVSS vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

7.5
 / 10

Severity

high

Vulnerability type

Out-of-bounds read
([detail](https://cwe.mitre.org/data/definitions/125.html))

Scope

IRC

Affected versions

0.4.0 → 2.7

Fixed version

2.7.1

(Feb 20, 2020)
-
[ChangeLog](/files/doc/weechat/ChangeLog-2.7.1.html)

Tracker

Not available

Commits

[Commit](https://github.com/weechat/weechat/commit/c827d6fa864e2c0b79cea640c45272e83703081e)

##### Description

Crash when receiving a malformed IRC message 352 (WHO).
##### Mitigation

With WeeChat ≥ 1.1, you can create a trigger:

```
/trigger add fix_irc_352 modifier "irc_in_352" "${arguments} =~ .* \*$" "/.*//"
```

With any older version, there is no simple mitigation, you must upgrade WeeChat.
##### Credit

The issue was discovered by Stuart Nevans Locke.

---

#### [WSA-2020-1](/doc/weechat/security/WSA-2020-1/): [IRC] Buffer overflow on malformed IRC message 324 (channel mode).

##### Vulnerability

CVE

CVE-2020-8955
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8955) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2020-8955)
]

CVSS vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

7.5
 / 10

Severity

high

Vulnerability type

Out-of-bounds write
([detail](https://cwe.mitre.org/data/definitions/787.html))

Scope

IRC

Affected versions

0.3.8 → 2.7

Fixed version

2.7.1

(Feb 20, 2020)
-
[ChangeLog](/files/doc/weechat/ChangeLog-2.7.1.html)

Tracker

Not available

Commits

[Commit](https://github.com/weechat/weechat/commit/51a739df615f8ec66fbe1e9682ec3c3218254ad7)

##### Description

Buffer overflow when receiving a malformed IRC message 324 (channel mode).
##### Mitigation

There is no known mitigation.

The upgrade to the latest stable version is highly recommended.
##### Credit

The issue was discovered by Stuart Nevans Locke.

---

#### [WSA-2017-2](/doc/weechat/security/WSA-2017-2/): [Logger] Use of invalid pointer in build of log filename.

##### Vulnerability

CVE

CVE-2017-14727
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14727) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2017-14727)
]

CVSS vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

7.5
 / 10

Severity

high

Vulnerability type

Access of uninitialized pointer
([detail](https://cwe.mitre.org/data/definitions/824.html))

Scope

Logger

Affected versions

0.3.2 → 1.9

Fixed version

1.9.1

(Sep 23, 2017)
-
[ChangeLog](/files/doc/weechat/ChangeLog-1.9.1.html)

Tracker

Not available

Commits

[Commit](https://github.com/weechat/weechat/commit/f105c6f0b56fb5687b2d2aedf37cb1d1b434d556)

##### Description

Date/time conversion specifiers are expanded after replacing buffer local variables in name of log files. In some cases, this can lead to an error in function strftime and a crash caused by the use of an uninitialized buffer.
##### Mitigation

You can unload the logger plugin, thus stopping recording of all buffers: `/plugin unload logger`.
##### Credit

The issue was discovered by Joseph Bisch.

---

#### [WSA-2017-1](/doc/weechat/security/WSA-2017-1/): [IRC] Buffer overflow when receiving a DCC file.

##### Vulnerability

CVE

CVE-2017-8073
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8073) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2017-8073)
]

CVSS vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

7.5
 / 10

Severity

high

Vulnerability type

Out-of-bounds write
([detail](https://cwe.mitre.org/data/definitions/787.html))

Scope

IRC

Affected versions

0.3.3 → 1.7

Fixed version

1.7.1

(Apr 22, 2017)
-
[ChangeLog](/files/doc/weechat/ChangeLog-1.7.1.html)

Tracker

Not available

Commits

[Commit](https://github.com/weechat/weechat/commit/2fb346f25f79e412cf0ed314fdf791763c19b70b)

##### Description

Buffer overflow when removing quotes in DCC filename.
##### Mitigation

With WeeChat ≥ 1.1, you can create a trigger:

```
/trigger add irc_dcc_quotes modifier "irc_in_privmsg" "${arguments} =~ ^[^ ]+ :${\x01}DCC SEND ${\x22} " "/.*//"
```

With any older version, there is no simple mitigation, you must upgrade WeeChat.
##### Credit

The issue was discovered by Tobias Stoeckmann.

---

#### [WSA-2013-3](/doc/weechat/security/WSA-2013-3/): [Relay] Crash on IRC commands sent via Relay.

##### Vulnerability

CVE

Not available

CVSS vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

7.5
 / 10

Severity

high

Vulnerability type

Access of uninitialized pointer
([detail](https://cwe.mitre.org/data/definitions/824.html))

Scope

Relay

Affected versions

0.3.8 → 0.4.0

Fixed version

0.4.1

(May 20, 2013)
-
[ChangeLog](/files/doc/weechat/ChangeLog-0.4.1.html)

Tracker

Not available

Commits

[Commit](https://github.com/weechat/weechat/commit/e459939ead60a8dbad3519574bfe850798d5738a)

##### Description

Strings are built with uncontrolled format when IRC commands are redirected by relay plugin. If the output or redirected command contains formatting chars like "%", this can lead to a crash of WeeChat.
##### Mitigation

You can remove all relays of type "irc", see `/help relay`.

---

#### [WSA-2013-2](/doc/weechat/security/WSA-2013-2/): [IRC] Crash on send of unknown commands to IRC server.

##### Vulnerability

CVE

Not available

CVSS vector

CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

5.5
 / 10

Severity

medium

Vulnerability type

Access of uninitialized pointer
([detail](https://cwe.mitre.org/data/definitions/824.html))

Scope

IRC

Affected versions

0.3.0 → 0.4.0

Fixed version

0.4.1

(May 20, 2013)
-
[ChangeLog](/files/doc/weechat/ChangeLog-0.4.1.html)

Tracker

Not available

Commits

[Commit](https://github.com/weechat/weechat/commit/e0281a40f0f93ae9f3a69595f7dff74fe15ae8e7)

##### Description

Strings are built with uncontrolled format when unknown IRC commands are sent to server, if option `irc.network.send_unknown_commands` is enabled.
##### Mitigation

There are multiple ways to mitigate this issue:

* Turn off option to send unknown commands: `/set irc.network.send_unknown_commands off`
* Do not use formatting chars like "%" when sending unknown commands to server.

---

#### [WSA-2013-1](/doc/weechat/security/WSA-2013-1/): [IRC] Crash on nicks monitored with /notify.

##### Vulnerability

CVE

Not available

CVSS vector

CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

5.5
 / 10

Severity

medium

Vulnerability type

Access of uninitialized pointer
([detail](https://cwe.mitre.org/data/definitions/824.html))

Scope

IRC

Affected versions

0.3.6 → 0.4.0

Fixed version

0.4.1

(May 20, 2013)
-
[ChangeLog](/files/doc/weechat/ChangeLog-0.4.1.html)

Tracker

Not available

Commits

[Commit](https://github.com/weechat/weechat/commit/5877a458ea70b53d3dbb99dc25df586e702a8c7b)

##### Description

Strings are built with uncontrolled format when nicks containing "%" are monitored with command `/notify`.
##### Mitigation

Do not use command `/notify` with nicks containing formatting chars like "%".

---

#### [WSA-2012-2](/doc/weechat/security/WSA-2012-2/): [API] Remote execution of commands via scripts.

##### Vulnerability

CVE

CVE-2012-5534
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5534) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2012-5534)
]

CVSS vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H&version=3.1))

CVSS score

10.0
 / 10

Severity

critical

Vulnerability type

Improper input validation
([detail](https://cwe.mitre.org/data/definitions/20.html))

Scope

API

Affected versions

0.3.0 → 0.3.9.1

Fixed version

0.3.9.2

(Nov 18, 2012)
-
[ChangeLog](/files/doc/weechat/ChangeLog-0.3.9.2.html)

Tracker

[bug #37764](https://savannah.nongnu.org/bugs/?37764)

Commits

[Commit](https://github.com/weechat/weechat/commit/efb795c74fe954b9544074aafcebb1be4452b03a)

##### Description

Untrusted command for function hook\_process could lead to execution of commands, because of shell expansions (so the problem is only caused by some scripts, not by WeeChat itself).
##### Mitigation

Remove/unload all scripts calling the API function hook\_process.

---

#### [WSA-2012-1](/doc/weechat/security/WSA-2012-1/): [IRC] Crash when decoding IRC colors.

##### Vulnerability

CVE

CVE-2012-5854
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5854) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2012-5854)
]

CVSS vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

7.5
 / 10

Severity

high

Vulnerability type

Out-of-bounds write
([detail](https://cwe.mitre.org/data/definitions/787.html))

Scope

IRC

Affected versions

0.3.6 → 0.3.9

Fixed version

0.3.9.1

(Nov 9, 2012)
-
[ChangeLog](/files/doc/weechat/ChangeLog-0.3.9.1.html)

Tracker

[bug #37704](https://savannah.nongnu.org/bugs/?37704)

Commits

[Commit](https://github.com/weechat/weechat/commit/9453e81baa7935db82a0b765a47cba772aba730d)

##### Description

A buffer overflow happens when decoding some IRC colors in strings.
##### Mitigation

Turn of handling of colors in incoming IRC messages:

```
/set irc.network.colors_receive off
```

---

#### [WSA-2011-1](/doc/weechat/security/WSA-2011-1/): [IRC] Possible man-in-the-middle attack in TLS connection to IRC server.

##### Vulnerability

CVE

CVE-2011-1428
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1428) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2011-1428)
]

CVSS vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N&version=3.1))

CVSS score

5.3
 / 10

Severity

medium

Vulnerability type

Improper certificate validation
([detail](https://cwe.mitre.org/data/definitions/295.html))

Scope

IRC

Affected versions

0.1.3 → 0.3.4

Fixed version

0.3.5

(May 15, 2011)
-
[ChangeLog](/files/doc/weechat/ChangeLog-0.3.5.html)

Tracker

[patch #7459](https://savannah.nongnu.org/patch/?7459)

Commits

[Commit](https://github.com/weechat/weechat/commit/c265cad1c95b84abfd4e8d861f25926ef13b5d91)

##### Description

Due to insufficient check of TLS certificate in IRC plugin, man-in-the-middle attackers can spoof a server via an arbitrary certificate.
##### Mitigation

There is no known mitigation.

The upgrade to the latest stable version is highly recommended.

---

#### [WSA-2009-1](/doc/weechat/security/WSA-2009-1/): [IRC] Crash when receiving WeeChat color codes in IRC messages.

##### Vulnerability

CVE

CVE-2009-0661
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0661) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2009-0661)
]

CVSS vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

7.5
 / 10

Severity

high

Vulnerability type

Out-of-bounds read
([detail](https://cwe.mitre.org/data/definitions/125.html))

Scope

IRC

Affected versions

0.2.6

Fixed version

0.2.6.1

(Mar 14, 2009)
-
[ChangeLog](/files/doc/weechat/ChangeLog-0.2.6.1.html)

Tracker

[bug #25862](https://savannah.nongnu.org/bugs/?25862)

Commits

[Commit](https://github.com/weechat/weechat/commit/d44762aa4304690f3784a6b6362274d57a5c4f61)

##### Description

A crash happens when receiving some WeeChat internal color codes in IRC messages.
##### Mitigation

There is no known mitigation.

The upgrade to the latest stable version is highly recommended.

---

#### [WSA-2006-1](/doc/weechat/security/WSA-2006-1/): [API] Crash in API function infobar\_printf.

##### Vulnerability

CVE

Not available

CVSS vector

CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

6.2
 / 10

Severity

medium

Vulnerability type

Access of uninitialized pointer
([detail](https://cwe.mitre.org/data/definitions/824.html))

Scope

API

Affected versions

0.0.5 → 0.1.6

Fixed version

0.1.7

(Jan 14, 2006)
-
[ChangeLog](/files/doc/weechat/ChangeLog-0.1.7.html)

Tracker

Not available

Commits

[Commit](https://github.com/weechat/weechat/commit/05456cc54e80e813b15850ee4ba7e5aa277f44fd) [Commit](https://github.com/weechat/weechat/commit/dd39ac243273052609e5f3ee6a5217f07e06402d)

##### Description

Strings are built with uncontrolled format in API function infobar\_printf.
##### Mitigation

Remove/unload all scripts calling the API function infobar\_printf.

---

#### [WSA-2004-1](/doc/weechat/security/WSA-2004-1/): [Core, IRC] Buffer overflows in build of strings.

##### Vulnerability

CVE

Not available

CVSS vector

CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1))

CVSS score

6.2
 / 10

Severity

medium

Vulnerability type

Out-of-bounds write
([detail](https://cwe.mitre.org/data/definitions/787.html))

Scope

Core, IRC

Affected versions

0.0.1 → 0.0.4

Fixed version

0.0.5

(Feb 7, 2004)
-
[ChangeLog](/files/doc/weechat/ChangeLog-0.0.5.html)

Tracker

Not available

Commits

[Commit](https://github.com/weechat/weechat/commit/8bcbc3dcae92eaff85bb07476561a3361c2109cd)

##### Description

A buffer overflows happens in build of strings in different places.
##### Mitigation

There is no known mitigation.

The upgrade to the latest stable version is highly recommended.

* [Home](/)
* [Latest news](/news/)
* [Upcoming events](/events/)
* [Make a donation](/donate/)

* [About](/about/)
* [Features](/about/features/)
* [Interfaces](/about/interfaces/)
* [Screenshots](/about/screenshots/)
* [History](/about/history/)
* [Support](/about/support/)
* [WeeChat.org](/about/weechat.org/)

* [Documentation](/doc/)
* [WeeChat](/doc/weechat/stable/)
* [WeeChat Relay](/doc/weechat-relay/stable/)
* [QWeeChat](/doc/qweechat/stable/)

* [Download](/download/)
* [WeeChat](/download/weechat/stable/)
* [WeeChat Relay](/download/weechat-relay/stable/)
* [QWeeChat](/download/qweechat/stable/)
* [Debian/Ubuntu repositories](/download/debian/)

* [Scripts](/scripts/)
* [Browse scripts](/scripts/)
* [Unofficial scripts](/files/scripts/unofficial/)
* [Python 3](/scripts/python3/)

* [Development](/dev/)
* [Roadmap](/dev/roadmap/)
* [Statistics](/dev/stats/)
* [Info](/dev/info/)
* [Development blog](https://blog.weechat.org/)

[GitHub](https://github.com/weechat "GitHub")
[Mastodon](https://hostux.social/%40weechat "Mastodon")
[Diaspora](https://diasp.eu/u/weechat "Diaspora")
[X](https://x.com/WeeChatClient "X")

Copyright © 2003-2025 Sébastien Helleu
—
[About WeeChat.org](/about/weechat.org/)
— Theme: **dark**
([light](?theme=light))


