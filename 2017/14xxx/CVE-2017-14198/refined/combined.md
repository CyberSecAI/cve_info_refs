=== Content from devalias.net_a477bf58_20250126_001507.html ===

### Menu

Close

* [Home](/)
* [Now](/now)
* [About](/about)
* [Speaker](/speaker)
* [Security](/sec)
* [Development](/dev)
* [Writing](/writing)
* [Coaching](/coaching)
* [Personal](/personal)
* [Go Deeper...](/go-deeper)

 [Subscribe](/feed.xml)

[![Blog Logo](/assets/images/devalias-prompt.png)](/)
Menu

# Squiz Matrix: Multiple vulnerabilities

![Author image](/assets/images/authors/devalias.png)
[Glenn 'devalias' Grant](/author/devalias)
|
07 Sep 2017
|
2 minutes
to read

|
[#security](/tag/security),
[#cve](/tag/cve),
[#squiz](/tag/squiz),
[#matrix](/tag/matrix),
[#bug-bounty](/tag/bug-bounty),
[#bugcrowd](/tag/bugcrowd),
[#xss](/tag/xss),
[#rce](/tag/rce)

Earlier this year I had an opportunity to spend some time looking at [Squiz Matrix](https://www.squiz.net/technology/cms), a Content Management System (CMS) used across a number of sectors including higher eduction, media and publishing, goverment, finance, health, and utilities. With a huge number of features, a massive PHP codebase, and a numbr of high profile sectors as clients, I set out to see if I could find any interesting little bugs hidden away.

While I won't get into the nitty gritty of most of the assessment process, I did find some things, and 3 CVE's were assigned (detailed below). One was interesting enough that I will probably write up the process in more detail at some point.

Given the rich functionality and plugins in the Matrix product, it could be interesting to dedicate more research time to explore the areas I didn't get to cover this time around. Who knows, perhaps Squiz would even be open to setting up a Bug Bounty program through someone like [Bugcrowd](https://www.bugcrowd.com/) in the future too. That would be cool!

If you want to try it out, or play around yourself, there is a [downloadable demo VM](https://matrix.squiz.net/releases/vm) available on the Squiz website.

## The CVE's

* **[CVE-2017-14196](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14196)**: An information disclosure caused by a Path Traversal issue in the 'File Bridge' plugin allowed the existence of files outside of the bridged path to be confirmed.
* **[CVE-2017-14197](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14197)**: Multiple reflected Cross-Site Scripting (XSS) issues in Matrix 'WYSIWYG' plugins.
* **[CVE-2017-14198](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14198)**: Authenticated users with permissions to edit design assets can cause Remote Code Execution (RCE) via a maliciously crafted `time_format` tag.

## Remediation

These issues were fixed in version `5.4.1.3`. Update to this version or newer to be protected. See the CVE advisory details for more information.

## CVE-2017-14198: A Walkthrough

TODO: Write up how this was identified, and the core issue that lead to it.

## Acknowledgements

These issues were identified by [myself](http://devalias.net) and the team at [TSS](https://dtss.com.au):

* Glenn 'devalias' Grant (<http://devalias.net>) of TSS (<https://dtss.com.au>)

Special thanks to Micky at Squiz for being an amazing resource throughout the disclosure process, and keeping us informed as patching and rollout progressed.

## Conclusion

It seems the core issues here were a few bugs popping up in legacy code, and passing user-controlled values into sensitive areas without proper checks/sanitisation. Easy mistakes to make when managing such a large codebase that has evolved over the years.

Have you had a similar experience? Manage a large codebase and legacy code? Got good tips for how best to identify and avoid these sorts of issues? Would love to hear your ideas in the comments!

[devalias's Picture](/author/devalias)

#### [Glenn 'devalias' Grant](/author/devalias)

Glenn is a full-stack, polyglot developer with an acute interest in the offensive side of security; as well as technology, efficiency, biohacking, health, personal growth and a whole lot more.

Australia

[devalias.net](http://www.devalias.net/)

#### Share this post

Please enable JavaScript to view the [comments powered by Disqus.](https://disqus.com/?ref_noscript)
[blog comments powered by Disqus](https://disqus.com)

[## Presenting all the things! (BSides Wellington, CSides Canberra, SecTalks Canberra)

Recently I had the opportunity to present at a few local security meetups, and one international security conference. At the start of 2017, I set...](/devalias/2017/11/19/presenting-all-the-things-bsides-wellington-csides-sectalks/)

[## Biohacked Box #4 (Autumn, September 2017)

Time for another Bulletproof Biohacked.com quarterly box.](/devalias/2017/09/05/biohacked-box-4-autumn/)

[![Creative Commons License](https://i.creativecommons.org/l/by-sa/4.0/80x15.png)](http://creativecommons.org/licenses/by-sa/4.0/)
devalias.net by [Glenn 'devalias' Grant](http://www.devalias.net/) is licensed under a [Creative Commons Attribution-ShareAlike 4.0 International License](http://creativecommons.org/licenses/by-sa/4.0/).

**Build:** 4662a2d56
[Edit on GitHub](https://github.com/0xdevalias/devalias.net/tree/master/_posts/2017-09-07-squiz-matrix-multiple-vulnerabilities.md)

Proudly published with
[Jekyll](https://jekyllrb.com/)
using
[Jasper](https://github.com/biomadeira/jasper)
to
[GitHub](https://github.com/)


