=== Content from www.talosintelligence.com_bb0360d2_20250125_173148.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2017-0498

## Simple DirectMedia Layer SDL2\_image do\_layer\_surface Double-Free Vulnerability

##### March 1, 2018

##### CVE Number

CVE-2017-14449

### Summary

A double-Free vulnerability exists in the XCF image rendering functionality of SDL2\_image-2.0.2. A specially crafted XCF image can cause a Double-Free situation to occur. An attacker can display a specially crafted image to trigger this vulnerability.

### Tested Versions

Simple DirectMedia Layer SDL2\_image 2.0.2

### Product URLs

<https://www.libsdl.org/projects/SDL_image/>

### CVSSv3 Score

7.5 - CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H

### CWE

CWE-415: Double Free

### Details

LibSDL is a multi-platform library for easy access to low level hardware and graphics, providing support for a large amount of games, software, and emulators. The last known count of software using LibSDL (from 2012) listed the number at upwards of 120. The LibSDL2\_Image library is an optional component that deals specifically with parsing and displaying a variety of image file formats, creating a single and uniform API for image processing, regardless of the type.

When reading in an XCF file, the file type used natively by GIMP, LibSDL2 must read in all the layers of the image before rendering them on top of each other, and then blitting them directly to the SDL surface. A portion of the code is given below:

```
// IMG_xcf.c
 	 // Blit layers backwards, because Gimp saves them highest first
  	for (i = offsets; i > 0; i--) {
		SDL_Rect rs, rd;
		SDL_RWseek (src, head->layer_file_offsets [i-1], RW_SEEK_SET); // [1]
		layer = read_xcf_layer (src);
		do_layer_surface (lays, src, head, layer, load_tile); //[2]

```

Given offsets from the file, the program seeks to that spot and reads an XCF Layer, which is then parsed, resulting in the memory therefore being allocated and written, inside of [2]. Further more, a hierarchy object is created from the ‘hierarchy\_file\_offset’ inside of the layer object. The definitions for both of these structures are given below:

```
<(^_^)> print *layer
$3 = {
  width = 0x200,
  height = 0x200,
  layer_type = 0x0,
  name = 0xbccc60 "Background",
  properties = 0x20,
  hierarchy_file_offset = 0x10e,
  layer_mask_offset = 0x0,
  offset_x = 0x0,
  offset_y = 0x0,
  visible = 0x1
}
<(^_^)> print *hierarchy
$4 = {
  width = 0x200,
  height = 0x200,
 	  bpp = 0x2,   //[1]
  level_file_offsets = 0xc6ca60
}

```

Of most interest is the ‘bpp’ field inside of the hierarchy struct at [1]. When this is set to 0x2, assuming that the rest of the layer parses correctly, the code ends up at a peculiar switch statement.

```
switch (hierarchy->bpp) {
[...]
            case 2:
                /* Indexed / Greyscale + Alpha */
                switch (head->image_type) { //[1]
	[...]

                	default:
                    	fprintf(stderr, "Unknown Gimp image type (%d)\n", head->image_type);
                   		if (hierarchy) {
                        		if (hierarchy->level_file_offsets)
                            			SDL_free(hierarchy->level_file_offsets); //[2]
                        	free_xcf_hierarchy(hierarchy); //[3]
                    	}
[...]

```

The image controls the head->image\_type field at [1], so the path taken is up to the image. If the head->image\_type is not IMAGE\_INDEXED or IMAGE\_GREEYSCALE, then the code frees hierarchy->level\_file\_offsets at [2], and then calls free\_xcf\_hierarchy at [3]. The source for free\_xcf\_hierarchy is given below:

```
static void free_xcf_hierarchy (xcf_hierarchy * h) {
	SDL_free (h->level_file_offsets); //[1]
	SDL_free (h);
	}

```

And as given at [1], the code ends up freeing the same level\_file\_offsets hierarchy as before, resulting in a double free vulnerability. It is questionable whether or not this code path has ever been hit or reviewed before, given the relative lack of distance between the two frees.

It should be noted that most modern implementations of malloc in system libraries will catch a double free error and throw an assertion error immediately, however, this is dependent on the memory allocator that developers may use when linking with this library.

### Crash Information

```
Unknown Gimp image type (0)
*** Error in `/root/work_work/triages/libsdl/crashes/img_read_plain': double free or corruption (!prev): 0x0000000000c6ca60 ***

Program received signal SIGABRT, Aborted.
0x00007ffff74af067 in __GI_raise (sig=sig@entry=0x6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56
56      ../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.
---------------[ registers ]----
$rax   : 0x0000000000000000
$rbx   : 0x0000000000000080
$rcx   : 0xffffffffffffffff
$rdx   : 0x0000000000000006
$rsp   : 0x00007fffffffda38 -> 0x00007ffff74b0448 -> <abort+328> mov rdx, QWORD PTR fs:0x10
$rbp   : 0x00007fffffffddd0 -> 0x00007fffffffdde0 -> "0000000000c6ca60"
$rsi   : 0x000000000000294c
$rdi   : 0x000000000000294c
$rip   : 0x00007ffff74af067 -> <raise+55> cmp rax, 0xfffffffffffff000
$r8    : 0x3036616336633030 ("00c6ca60"?)
$r9    : 0x6f6974707572726f ("orruptio"?)
$r10   : 0x0000000000000008
$r11   : 0x0000000000000202
$r12   : 0x00007fffffffdbe0 -> 0x0000000000000001
$r13   : 0x0000000000000007
$r14   : 0x0000000000000080
$r15   : 0x0000000000000007
$eflags: [carry parity adjust zero sign trap INTERRUPT direction overflow resume virtualx86 identification]
-------------------[ stack ]----
0x00007fffffffda38|+0x00: 0x00007ffff74b0448 -> <abort+328> mov rdx, QWORD PTR fs:0x10  <-$rsp
0x00007fffffffda40|+0x08: 0x0000000000000020
0x00007fffffffda48|+0x10: 0x0000000000000000
0x00007fffffffda50|+0x18: 0x0000000000000000
0x00007fffffffda58|+0x20: 0x0000000000000000
0x00007fffffffda60|+0x28: 0x0000000000000000
0x00007fffffffda68|+0x30: 0x0000000000000000
0x00007fffffffda70|+0x38: 0x0000000000000000
--------[ code:i386:x86-64 ]----
0x7ffff74af054 <raise+36>       add    BYTE PTR [rcx-0x289cb73a], cl
0x7ffff74af05a <raise+42>       movsxd rsi, esi
0x7ffff74af05d <raise+45>       movsxd rdi, ecx
0x7ffff74af060 <raise+48>       mov    eax, 0xea
0x7ffff74af065 <raise+53>       syscall
->0x7ffff74af067 <raise+55>       cmp    rax, 0xfffffffffffff000
0x7ffff74af06d <raise+61>       ja     0x7ffff74af08d <__GI_raise+93>
0x7ffff74af06f <raise+63>       repz   ret
0x7ffff74af071 <raise+65>       nop    DWORD PTR [rax+0x0]
0x7ffff74af078 <raise+72>       test   ecx, ecx
0x7ffff74af07a <raise+74>       jg     0x7ffff74af057 <__GI_raise+39>
-----------------[ threads ]----
[#0] Id 5, Name: "img_read_plain", stopped, reason: SIGABRT
[#1] Id 4, Name: "img_read_plain", stopped, reason: SIGABRT
[#2] Id 3, Name: "img_read_plain", stopped, reason: SIGABRT
[#3] Id 2, Name: "img_read_plain", stopped, reason: SIGABRT
[#4] Id 1, Name: "img_read_plain", stopped, reason: SIGABRT
-------------------[ trace ]----
[#0] 0x7ffff74af067->Name: __GI_raise(sig=0x6)
[#1] 0x7ffff74b0448->Name: __GI_abort()
[#2] 0x7ffff74ed1b4->Name: __libc_message(do_abort=0x1, fmt=0x7ffff75e2210 "*** Error in `%s': %s: 0x%s ***\n")
[#3] 0x7ffff74f298e->Name: malloc_printerr(action=0x1, str=0x7ffff75e2318 "double free or corruption (!prev)", ptr=<optimized out>)
[#4] 0x7ffff74f3696->Name: _int_free(av=<optimized out>, p=<optimized out>, have_lock=0x0)
[#5] 0x7ffff7afcd0e->Name: SDL_free_REAL(ptr=0xc6ca60)
[#6] 0x7ffff7aa0aec->Name: SDL_free(a=0xc6ca60)
[#7] 0x7ffff7849e28->Name: free_xcf_hierarchy(h=0x887ae0)
[#8] 0x7ffff784a902->Name: do_layer_surface(surface=0xc503b0, src=0xc6b6c0, head=0xc6aa00, layer=0xc39b70, load_tile=0x7ffff784a07f
<load_xcf_tile_rle>)
[#9] 0x7ffff784ae24->Name: IMG_LoadXCF_RW(src=0xc6b6c0)

```
### Timeline

2017-11-28 - Vendor Disclosure

2018-03-01 - Public Release

##### Credit

Discovered by Lilith (<\_<) of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2017-0499](/vulnerability_reports/TALOS-2017-0499) [Previous Report

TALOS-2017-0497](/vulnerability_reports/TALOS-2017-0497)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from security.gentoo.org_9a542572_20250125_173146.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# SDL2\_Image: Multiple vulnerabilities — GLSA **201903-17**

Multiple vulnerabilities have been found in the image loading
library
for Simple DirectMedia Layer, the worst of which could result in the remote
execution of arbitrary code.

### Affected packages

| Package | **media-libs/sdl2-image** on all architectures |
| --- | --- |
| Affected versions | < **2.0.4** |
| Unaffected versions | >= **2.0.4** |

### Background

SDL\_image is an image file library that loads images as SDL surfaces,
and supports various formats like BMP, GIF, JPEG, LBM, PCX, PNG, PNM,
TGA, TIFF, XCF, XPM, and XV.

### Description

Multiple vulnerabilities have been discovered in SDL2\_Image. Please
review the CVE identifiers referenced below for details.

### Impact

A remote attacker, by enticing a user to process a specially crafted
image file, could execute arbitrary code, cause a Denial of Service
condition, or obtain sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All SDL2\_Image users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-libs/sdl2-image-2.0.4"

```
### References

* [CVE-2017-12122](https://nvd.nist.gov/vuln/detail/CVE-2017-12122)
* [CVE-2017-14440](https://nvd.nist.gov/vuln/detail/CVE-2017-14440)
* [CVE-2017-14441](https://nvd.nist.gov/vuln/detail/CVE-2017-14441)
* [CVE-2017-14442](https://nvd.nist.gov/vuln/detail/CVE-2017-14442)
* [CVE-2017-14448](https://nvd.nist.gov/vuln/detail/CVE-2017-14448)
* [CVE-2017-14449](https://nvd.nist.gov/vuln/detail/CVE-2017-14449)
* [CVE-2017-14450](https://nvd.nist.gov/vuln/detail/CVE-2017-14450)
* [CVE-2018-3837](https://nvd.nist.gov/vuln/detail/CVE-2018-3837)
* [CVE-2018-3838](https://nvd.nist.gov/vuln/detail/CVE-2018-3838)
* [CVE-2018-3839](https://nvd.nist.gov/vuln/detail/CVE-2018-3839)
* [CVE-2018-3977](https://nvd.nist.gov/vuln/detail/CVE-2018-3977)

**Release date**

March 28, 2019

**Latest revision**

March 28, 2019: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [655226](https://bugs.gentoo.org/show_bug.cgi?id=655226)
* [674132](https://bugs.gentoo.org/show_bug.cgi?id=674132)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.debian.org_e2909116_20250125_173147.html ===


---

[[Date Prev](msg00103.html)][[Date Next](msg00105.html)]
[[Thread Prev](msg00103.html)][[Thread Next](msg00105.html)]
[[Date Index](maillist.html#00104)]
[[Thread Index](threads.html#00104)]

# [SECURITY] [DSA 4177-1] libsdl2-image security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4177-1] libsdl2-image security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Fri, 20 Apr 2018 22:16:50 +0200
* *Message-id*: <[[🔎]](/msgid-search/20180420201650.GA7380%40pisco.westfalen.local) [20180420201650.GA7380@pisco.westfalen.local](msg00104.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4177-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
April 20, 2018                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : libsdl2-image
CVE ID         : CVE-2017-2887  CVE-2017-12122 CVE-2017-14440 CVE-2017-14441
                 CVE-2017-14442 CVE-2017-14448 CVE-2017-14449 CVE-2017-14450
                 CVE-2018-3837  CVE-2018-3838  CVE-2018-3839

Multiple vulnerabilities have been discovered in the image loading
library for Simple DirectMedia Layer 2, which could result in denial of
service or the execution of arbitrary code if malformed image files are
opened.

For the oldstable distribution (jessie), these problems have been fixed
in version 2.0.0+dfsg-3+deb8u1.

For the stable distribution (stretch), these problems have been fixed in
version 2.0.1+dfsg-2+deb9u1.

We recommend that you upgrade your libsdl2-image packages.

For the detailed security status of libsdl2-image please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/libsdl2-image>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlraSnYACgkQEMKTtsN8
Tjbd7RAAi1WGlcur3NflOdj1yy+VTnrurmB33trBRd6vWgRZndysRQz8ifqEqfbq
8h2FybTcVZ7cHjIoHgKDLYJt21Er+gaDUYF6EQsjvs7BYnseLcRHTe5NmBSaDLkp
ahjyNat3KBU7riNKLv7p3aHlae/XZECB9/GCcURQ4cJ7RFsVGIRvHQixaUNsD3f2
Y/4Kndn4MEN/27v9eKstWiJdskwHn6I1rEGFEaeU7gdLLTr02yLycoApinjavJzn
ryzetzu/K78OA3QC+IUiOHSILxvn/p1aH/EYbkbbHN5oUkQUTYjtYDKWgzP+BN/C
bhxe5w5O8l/ysEL9UW7Yiq2fwkTGKNMT7E/Ru+s0oCykiVemaYvGsFj0WP27vGV7
08oQ6z1Ry+DZUd4AnywGvYF0xdcRB5n/O1fF+HQSz+RqaoArkwzD868khTDwzZuY
DiDsXknPV8rlN8XC3ubUI42xqEK31j2dgP3BTyBXdqaa7+36FsHTraLRbd9KVtWg
RRoyqPAlt0pJgC5G4gMmlaibEgE0euT1bLnxf/0dsqrzdLTgaUxHLWnEJ3Ntm1H5
9adyp8ObVmPzsGI5BzSWTsgo8YjaC+f36zPJH6Sq5/pqPs7kZ7PXq8Al+FKLUiuL
rPTeHpvBAgZe0NTdeqIBwJ//0s7mIDRIKl+WwUFbEhFIUo6xmnw=
=7zfP
-----END PGP SIGNATURE-----

```

---


