```
{
  "Root cause of vulnerability": "The `MMM::Agent::Helpers::Network::add_ip()` function in the `configure_ip` helper command uses the `/sbin/ip addr add $ip/32 dev $if` command on Linux, `/usr/sbin/ifconfig $if addif $ip` on Solaris, and `/sbin/ifconfig $if inet $ip netmask 255.255.255.255 alias` on FreeBSD, to add IP addresses. It does not sanitize the `$ip` variable, which is derived from user-controlled input. As a result, a malicious IP address value can be used to inject arbitrary commands via shell metacharacters.",
  "Weaknesses/vulnerabilities present": [
    "Command injection",
    "Insufficient input sanitization"
  ],
  "Impact of exploitation": "Arbitrary command execution with the privileges of the `mmm_agentd` process, typically root.",
  "Attack vectors": "Sending a specially crafted `SET_STATUS` MMM protocol message with a malicious IP address value within the role definition to the vulnerable mmm_agentd service which typically listens on a network port without requiring authentication.",
  "Required attacker capabilities/position": "The attacker must be able to establish a TCP connection with the vulnerable mmm_agentd service."
}
```