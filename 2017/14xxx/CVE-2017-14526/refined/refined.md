```
Title: OpenText Documentum Administrator and Webtop - XML External Entity Injection
Author: Jakub Palaczynski, Pawel Gocyla
Date: 24. September 2017
CVE (Administrator): CVE-2017-14526
CVE (Webtop): CVE-2017-14527

Affected software:
==================
Documentum Administrator
Documentum Webtop

Exploit was tested on:
======================
Documentum Administrator version 7.2.0180.0055
Documentum Webtop version 6.8.0160.0073
Other versions may also be vulnerable.

XML External Entity Injection - 4 instances:
============================================

This vulnerability allows for:
- listing directories and retrieving content of files from the filesystem
- stealing hashes of user that runs Documentum (if installed on Windows)
- DoS

1. Instance 1 and 2:
Authenticated users can exploit XXE vulnerability by browsing "Tools >
Preferences". It generates request to
/xda/com/documentum/ucf/server/transport/impl/GAIRConnector which
contains two XML structures. Both accept DTD and parse it which allows
exploitation.

2. Instance 3:
Authenticated users can exploit XXE vulnerability by using "File >
Import". Users can import XML files and use "MediaProfile" to open
file which triggers vulnerability.

3. Instance 4:
Authenticated users can exploit XXE vulnerability by using "File >
Check In". Users can use XML check in file and use "MediaProfile" to
open it which triggers vulnerability.

```

- **Root cause of vulnerability:** The application parses XML data, including DTDs, without proper sanitization, leading to XML External Entity (XXE) injection.
- **Weaknesses/vulnerabilities present:** XML External Entity (XXE) injection vulnerability.
- **Impact of exploitation:**
    - Listing directories and retrieving content of files from the filesystem.
    - Stealing hashes of the user running Documentum (if installed on Windows).
    - Denial of Service (DoS).
- **Attack vectors:**
    - Browsing "Tools > Preferences" which generates a request to `/xda/com/documentum/ucf/server/transport/impl/GAIRConnector` with XML structures.
    - Using "File > Import" to import XML files.
    - Using "File > Check In" with XML check-in files.
- **Required attacker capabilities/position:** Requires an authenticated user.