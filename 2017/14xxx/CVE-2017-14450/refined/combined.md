=== Content from security.gentoo.org_9a542572_20250124_212516.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# SDL2\_Image: Multiple vulnerabilities â€” GLSA **201903-17**

Multiple vulnerabilities have been found in the image loading
library
for Simple DirectMedia Layer, the worst of which could result in the remote
execution of arbitrary code.

### Affected packages

| Package | **media-libs/sdl2-image** on all architectures |
| --- | --- |
| Affected versions | < **2.0.4** |
| Unaffected versions | >= **2.0.4** |

### Background

SDL\_image is an image file library that loads images as SDL surfaces,
and supports various formats like BMP, GIF, JPEG, LBM, PCX, PNG, PNM,
TGA, TIFF, XCF, XPM, and XV.

### Description

Multiple vulnerabilities have been discovered in SDL2\_Image. Please
review the CVE identifiers referenced below for details.

### Impact

A remote attacker, by enticing a user to process a specially crafted
image file, could execute arbitrary code, cause a Denial of Service
condition, or obtain sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All SDL2\_Image users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-libs/sdl2-image-2.0.4"

```
### References

* [CVE-2017-12122](https://nvd.nist.gov/vuln/detail/CVE-2017-12122)
* [CVE-2017-14440](https://nvd.nist.gov/vuln/detail/CVE-2017-14440)
* [CVE-2017-14441](https://nvd.nist.gov/vuln/detail/CVE-2017-14441)
* [CVE-2017-14442](https://nvd.nist.gov/vuln/detail/CVE-2017-14442)
* [CVE-2017-14448](https://nvd.nist.gov/vuln/detail/CVE-2017-14448)
* [CVE-2017-14449](https://nvd.nist.gov/vuln/detail/CVE-2017-14449)
* [CVE-2017-14450](https://nvd.nist.gov/vuln/detail/CVE-2017-14450)
* [CVE-2018-3837](https://nvd.nist.gov/vuln/detail/CVE-2018-3837)
* [CVE-2018-3838](https://nvd.nist.gov/vuln/detail/CVE-2018-3838)
* [CVE-2018-3839](https://nvd.nist.gov/vuln/detail/CVE-2018-3839)
* [CVE-2018-3977](https://nvd.nist.gov/vuln/detail/CVE-2018-3977)

**Release date**

March 28, 2019

**Latest revision**

March 28, 2019: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [655226](https://bugs.gentoo.org/show_bug.cgi?id=655226)
* [674132](https://bugs.gentoo.org/show_bug.cgi?id=674132)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from lists.debian.org_e3679e61_20250124_212516.html ===


---

[[Date Prev](msg00004.html)][[Date Next](msg00006.html)]
[[Thread Prev](msg00004.html)][[Thread Next](msg00006.html)]
[[Date Index](maillist.html#00005)]
[[Thread Index](threads.html#00005)]

# [SECURITY] [DLA 1341-1] sdl-image1.2 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1341-1] sdl-image1.2 security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Sat, 7 Apr 2018 00:29:20 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/fdcfc69e-0f6e-433a-7792-83d69e0e5d6f%40debian.org)Â [fdcfc69e-0f6e-433a-7792-83d69e0e5d6f@debian.org](msg00005.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : sdl-image1.2
Version        : 1.2.12-2+deb7u2
CVE ID         : CVE-2017-12122 CVE-2017-14440 CVE-2017-14441
                 CVE-2017-14442 CVE-2017-14448 CVE-2017-14450

Lilith of Cisco Talos discovered several buffer overflow
vulnerabilities in the SDL Image library which can be leveraged by
attackers to execute arbitrary code via specially crafted image files.

For Debian 7 "Wheezy", these problems have been fixed in version
1.2.12-2+deb7u2.

We recommend that you upgrade your sdl-image1.2 packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEErPPQiO8y7e9qGoNf2a0UuVE7UeQFAlrH9L9fFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEFD
RjNEMDg4RUYzMkVERUY2QTFBODM1RkQ5QUQxNEI5NTEzQjUxRTQACgkQ2a0UuVE7
UeR6lBAAm3kSIISjjNe0DAx3Ln8LIsxOA86sQk3Fg8uxDD2ljA4YC6KFuTnHT5ui
Jt53qId68su1HFRoceueefx5zPN6AANALo9VE4Pn8sj1xOv2xsy/w5phEda8vn3F
gNjDTzqGNl084tdLGCwvIveHivcopiyGoSrWrI6tad9KtGZFIGHS54gAuOod8zkZ
nUEflYY6mTV9489uyVMLuKl2rni2yspo4ZJJXED7nibfq0f0NbPvZZ0FwdmLGToD
RIZopinEGZA1TOpl2BT7QhLKwZdhp8dZS1DoW0oBRiGgv2FurAgER1Ozn88A3rKl
Pmg3TSQa+aYhhJ3kG8I63Ga8f5BIUX7XbIYzK0Cw7ywEzYq7ukLnhYJCEKvDi1Be
AIh114fCuyX9W1S3sPxXrg7GcWPxeYPf7/+6+ilobn7WAWcJHHdq/DcANXfco252
ZUw8/Becpbdz9iGiDW6YUEEC2+V5eN3CWPjyCvZES7cet3djdTulaLn4ZygKaeKm
sx+BiBR4ms0UrYD58uhbXSz1mV5AUdTYf15XndKP48gDyJy5dgdYqMwnBHncEK/1
vHBP1TgdMvYIBHfSp/tcMILgApJyxjF9B4LxUORn7HfieN020mxglegmcXcYW3FQ
rxpS7ofcmZWlEidTlxFz1poDg6ZYeqn9jVkBd7SdJm3cYygJ19A=
=7gFw
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_412891d8_20250124_212517.html ===


---

[[Date Prev](msg00110.html)][[Date Next](msg00112.html)]
[[Thread Prev](msg00110.html)][[Thread Next](msg00112.html)]
[[Date Index](maillist.html#00111)]
[[Thread Index](threads.html#00111)]

# [SECURITY] [DSA 4184-1] sdl-image1.2 security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4184-1] sdl-image1.2 security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Sat, 28 Apr 2018 19:28:02 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1fCVVq-0007tZ-2S%40seger.debian.org)Â [E1fCVVq-0007tZ-2S@seger.debian.org](msg00111.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4184-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
April 28, 2018                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : sdl-image1.2
CVE ID         : CVE-2017-2887 CVE-2017-12122 CVE-2017-14440 CVE-2017-14441
                 CVE-2017-14442 CVE-2017-14448 CVE-2017-14450 CVE-2018-3837
                 CVE-2018-3838 CVE-2018-3839
Debian Bug     : 878267

Multiple vulnerabilities have been discovered in the image loading
library for Simple DirectMedia Layer 1.2, which could result in denial
of service or the execution of arbitrary code if malformed image files
are opened.

For the oldstable distribution (jessie), these problems have been fixed
in version 1.2.12-5+deb8u1.

For the stable distribution (stretch), these problems have been fixed in
version 1.2.12-5+deb9u1.

We recommend that you upgrade your sdl-image1.2 packages.

For the detailed security status of sdl-image1.2 please refer to its
security tracker page at:
<https://security-tracker.debian.org/tracker/sdl-image1.2>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAlrkyb1fFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0TZog//ayJ8Vts0SVEvs7XESknn5WiaV5vVQrXolV/TtAgE/P44dIsSWc69KF9H
Ekow/khSG+IAWmDsvTPNQhuzaukmdANGwSmr5zBU0mrnAI8k+yGzsGEGcN6WntUx
O2hVSxN1VwpuPwFKll0Xcl4gESFwGE9b/67frQVj7ESoAzJ+Ox7Z6Y7I24DOvSbr
86Sxw6cD3X6gm33qKsvwq2cQX/ra1VLQGNiMvxgt0m5c0Nfru4kjwLIOu2dJtaJG
WBqag5uwJxYxQJg9tll3Fb5oSqcTRAeLjkK3ucNbiMqmOotGekMY139wKkUJikrD
ZQNAdm1pmRwBJUy37eKIU9ZdF0pYAiOVDozrlGHVdxuijwLpMOAgE7AAmnFw86pS
TOIBekAZghasNIt+fUhgV5clg2FE+g4sz34QYu8d4tavnQstcTJB2mn/LqVKvB7T
asX+WbxjtNTZ7tqhGYYNlfGFC6LfVzULowK0ESDttuuKajUqLWqvWh/16E5LpP8L
GIQYqq21jDTtKNiCjiqpgYOD4oQKxpvxG9htbIzEznjZwvpnuUlcf+MQiXirYTzM
fXBRGAmo1Bsh9fQDZJqiuG7SZ7cMpvgXdiV1cAHqgFrskqJJd85FsCgyVqbDa1fv
amJNEe+EkEsKitITbzKsty2CxeseEauTJtui0TGqtOL9Uhj8xFo=
=oVng
-----END PGP SIGNATURE-----

```

---



=== Content from www.talosintelligence.com_66221954_20250124_212518.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

Ã—

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2017-0499

## Simple DirectMedia Layer SDL2\_Image LWZ Decompression Buffer Overflow Vulnerability

##### March 1, 2018

##### CVE Number

CVE-2017-14450

### Summary

A buffer overflow vulnerability exists in the GIF image parsing functionality of SDL2\_image-2.0.2. A specially crafted GIF image can lead to a buffer overflow on a global section. An attacker can display an image to trigger this vulnerability.

### Tested Versions

Simple DirectMedia Layer SDL2\_image 2.0.2

### Product URLs

<https://www.libsdl.org/projects/SDL_image/>

### CVSSv3 Score

7.1 - CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:H

### CWE

CWE-121: Stack-based Buffer Overflow

### Details

LibSDL is a multi-platform library for easy access to low level hardware and graphics, providing support for a large amount of games, software, and emulators. The last known count of software using LibSDL (from 2012) listed the number at upwards of 120. The LibSDL2\_Image library is an optional component that deals specifically with parsing and displaying a variety of image file formats, creating a single and uniform API for image processing, regardless of the type.

When reading in a GIF image, LibSDL2\_Image allocates a buffer of appropriate size and then proceeds to populate the buffer with the appropriate pixel data, as expected. When dealing with GIF images, the color data is LZW compressed, and decompression must naturally occur before the image data buffer can be populated. For an in-depth overview of LZW, please refer to <http://giflib.sourceforge.net/whatsinagif/lzw_image_data.html>.

Needless to say, the code for this is a little complex, so it will hopefully broken down into easier pieces below. The code starts here:

```
// IMG_gif.c:541
static Image * ReadImage(SDL_RWops * src, int len, int height, int cmapSize,
 	 unsigned char cmap[3][MAXCOLORMAPSIZE],
  	int gray, int interlace, int ignore)
{
		Image *image;
		unsigned char c;
		int i, v;
		int xpos = 0, ypos = 0, pass = 0;

```
/\*
\*\* Initialize the compression routines
\*/
```
		if (!ReadOK(src, &c, 1)) {
   		 	RWSetMsg("EOF / read error on image data");
   			 return NULL;
		}
		if (LWZReadByte(src, TRUE, c) < 0) { 		//[1]
			RWSetMsg("error reading image");
			return NULL;
	[...]
		image = ImageNewCmap(len, height, cmapSize);

		for (i = 0; i < cmapSize; i++)
			ImageSetCmap(image, i, cmap[CM_RED][i],

	cmap[CM_GREEN][i], cmap[CM_BLUE][i]);

		while ((v = LWZReadByte(src, FALSE, c)) >= 0) {   //[2]
			#ifdef USED_BY_SDL
    			((Uint8 *)image->pixels)[xpos + ypos * image->pitch] = v;
			#else
    			image->data[xpos + ypos * len] = v;
	[...]

```

The ReadImage function decompresses the GIF image via the LWZReadBytes function called at [1] and [2]. At [1], the first call is just used to initialize the state of the LWZReadBytes function, and all of the static variables inside, this is what the â€˜TRUEâ€™ bool is used for. After this, LWZReadBytes is called inside of a loop at [2], to actually grab the data from the file and begin to populate the pixel data, whose code we will ignore, as the bug path leads into the LWZReadByte funtion:

```
	static int LWZReadByte(SDL_RWops *src, int flag, int input_code_size)
{
		static int fresh = FALSE;
   		int code, incode;  					     //[1]
		static int code_size, set_code_size;  			     //[2]
		static int max_code, max_code_size;
		static int firstcode, oldcode;
		static int clear_code, end_code;
   		static int table[2][(1 << MAX_LWZ_BITS)]; 	     //[4]
		static int stack[(1 << (MAX_LWZ_BITS)) * 2], *sp;   //[5]
		register int i;

		/* Fixed buffer overflow found by Michael Skladnikiewicz */
		if (input_code_size > MAX_LWZ_BITS)
   		 return -1;

		if (flag) { //Flag => initialization
	[â€¦]

```
if (sp > stack)
```
    			return *--sp;

		while ((code = GetCode(src, code_size, FALSE)) >= 0) { //[3]

```

As mentioned, the code is going to get somewhat complex here, so heres a quick overview of the more relevant variables above: At [1], the `code` is given, which describes the current LZW code. This can be a value in the range of (1, 1Â«code\_size), which in this case is (0x1,0x200). This limit is enforced inside of the GetCode(src, code\_size,FALSE) call at [3]. The table variable at [4] is used to store the known LZW code sequences, and is typically known as a LZW code table. The stack variable at [5] is used to store a stack of LZW sequences, with the `*sp` pointer being assigned to the address of â€˜stackâ€™ at initialization. Regardless of of all of this, the bug just mainly involves the following code segment:

```
while ((code = GetCode(src, code_size, FALSE)) >= 0) {
[...]
// not clear code and not end code
    	while (code >= clear_code) { 	// [1]
        	/* Guard against buffer overruns */
       		if (code < 0 || code >= (1 << MAX_LWZ_BITS)) { //[2]
            	RWSetMsg("invalid LWZ data");
            	return -3;
        	}
        	*sp++ = table[1][code];  	//[3]
        	if (code == table[0][code])
            		RWSetMsg("circular table entry BIG ERROR");
        	code = table[0][code];  	//[4]
}

```

Assuming that the LWZ code found is greater than the clear code (0x100) at [1], the decompression algorithm will start to unpack the LWZ codes into the LWZ stack, which is done at [3]. The underlying issue lies in that, even though thereâ€™s a check on buffer overruns at [2], if we insert a value into table[0][code] such that (table[0][code] == code && code >= clear\_code), then the while loop at [1] will never exit, and `*sp` will be continually advanced past the bounds of stack variable, causing an overflow.

It should be noted that there are quite a few restrictions to this OOB write, since the â€˜stackâ€™ variable is a static variable, the OOB write actually occurs in the global variable section in memory for the LibSDL2\_image library, and not the stack itself, such that only other global library variables below â€˜stackâ€™ can be written.

Also, the values written can only be valid LWZ codes, such that the range is restricted to values (1,1Â«(code\_size)), as mentioned before, which is (0x1,0x200). Also of note is that the pointer being incremented is a (int \*) pointer, and not a (char \*) pointer, so the values in memory will look as such (for code 0x77):

```
<(^_^)> x/40gx sp-0x40
0x7ffff7a63f04: 0x0000007700000077      0x0000007700000077
0x7ffff7a63f14: 0x0000007700000077      0x0000007700000077
0x7ffff7a63f24: 0x0000007700000077      0x0000007700000077
0x7ffff7a63f34: 0x0000007700000077      0x0000007700000077

```
### Crash Information

```
Program received signal SIGSEGV, Segmentation fault.
0x00007ffff782b552 in LWZReadByte (src=0xc63e70, flag=0x0, input_code_size=0x8) at IMG_gif.c:499
499             /* Guard against buffer overruns */
---------------[ registers ]----
$rax   : 0x00007ffff7a64000 -> 0x00010102464c457f
$rbx   : 0x0000000000000000
$rcx   : 0x00000000000044f4
$rdx   : 0x0000000000000077
$rsp   : 0x00007fffffffdb40 -> 0x0000000000000008
$rbp   : 0x00007fffffffdc70 -> 0x00007fffffffdcc0 -> 0x00007fffffffe050 -> 0x00007fffffffe090 -> 0x00007fffffffe0c0 -> 0x00007fffffffe100 ->
0x0000000000000000
$rsi   : 0x00007fffffffd880 -> "circular table entry BIG ERROR"
$rdi   : 0x0000000000000001
$rip   : 0x00007ffff782b552 -> <LWZReadByte+1002> mov DWORD PTR [rax], edx
$r8    : 0x000000000000ffff
$r9    : 0x65875f9a7a257d5e
$r10   : 0x691bd05d945a5a55
$r11   : 0x0000000000000206
$r12   : 0x0000000000400a10 -> <_start+0> xor ebp, ebp
$r13   : 0x00007fffffffe1e0 -> 0x0000000000000002
$r14   : 0x0000000000000000
$r15   : 0x0000000000000000
$eflags: [carry parity adjust zero sign trap INTERRUPT direction overflow RESUME virtualx86 identification]
-------------------[ stack ]----
0x00007fffffffdb40|+0x00: 0x0000000000000008    <-$rsp
0x00007fffffffdb48|+0x08: 0x0000000000c63e70 -> 0x00007ffff7aace48 -> <stdio_size+0> push rbp
0x00007fffffffdb50|+0x10: 0x0000000000000080
0x00007fffffffdb58|+0x18: 0x0000000000000001
0x00007fffffffdb60|+0x20: 0x00007fffffffdb90 -> 0x00007fffffffdbe0 -> 0x00007fffffffdc20 -> 0x00007fffffffdc60 -> 0x00007fffffffdcc0 ->
0x00007fffffffe050 -> 0x00007fffffffe090
0x00007fffffffdb68|+0x28: 0x0000000000c28960 -> 0x0000000000000000
0x00007fffffffdb70|+0x30: 0x00007fffffffdb90 -> 0x00007fffffffdbe0 -> 0x00007fffffffdc20 -> 0x00007fffffffdc60 -> 0x00007fffffffdcc0 ->
0x00007fffffffe050 -> 0x00007fffffffe090
0x00007fffffffdb78|+0x38: 0x00007ffff7b59d50 -> <SDL_AllocBlitMap+23> mov QWORD PTR [rbp-0x8], rax
--------[ code:i386:x86-64 ]----    0x7ffff782b536 <LWZReadByte+974> movsxd rdx, edx    0x7ffff782b539 <LWZReadByte+977> add    rdx, 0x1000    0x7ffff782b540 <LWZReadByte+984> lea    rcx, [rdx*4+0x0]    0x7ffff782b548 <LWZReadByte+992> lea    rdx, [rip+0x2282f1]        # 0x7ffff7a53840 <table.9973>    0x7ffff782b54f <LWZReadByte+999> mov    edx, DWORD PTR [rcx+rdx*1]    ->0x7ffff782b552 <LWZReadByte+1002> mov    DWORD PTR [rax], edx    0x7ffff782b554 <LWZReadByte+1004> mov    eax, DWORD PTR [rbp-0x14]    0x7ffff782b557 <LWZReadByte+1007> cdqe       0x7ffff782b559 <LWZReadByte+1009> lea    rdx, [rax*4+0x0]    0x7ffff782b561 <LWZReadByte+1017> lea    rax, [rip+0x2282d8]        # 0x7ffff7a53840 <table.9973>    0x7ffff782b568 <LWZReadByte+1024> mov    eax, DWORD PTR [rdx+rax*1]
----[ source:IMG_gif.c+499 ]----
495          *sp++ = firstcode;
496          code = oldcode;
497      }
498      while (code >= clear_code) {
-> 499           /* Guard against buffer overruns */
500          if (code < 0 || code >= (1 << MAX_LWZ_BITS)) {
501              RWSetMsg("invalid LWZ data");
502              return -3;
503          }
-----------------[ threads ]----
[#0] Id 5, Name: "img_read_plain", stopped, reason: SIGSEGV
[#1] Id 4, Name: "img_read_plain", stopped, reason: SIGSEGV
[#2] Id 3, Name: "img_read_plain", stopped, reason: SIGSEGV
[#3] Id 2, Name: "img_read_plain", stopped, reason: SIGSEGV
[#4] Id 1, Name: "img_read_plain", stopped, reason: SIGSEGV
-------------------[ trace ]----
[#0] 0x7ffff782b552->Name: LWZReadByte(src=0xc63e70, flag=0x0, input_code_size=0x8)
[#1] 0x7ffff782b9a2->Name: ReadImage(src=0xc63e70, len=0x200, height=0x200, cmapSize=0x100, cmap=0x7ffff7a53288 <GifScreen+8>,
gray=0x0, interlace=0x0, ignore=0x0)
[#2] 0x7ffff782ac66->Name: IMG_LoadGIF_RW(src=0xc63e70)
[#3] 0x7ffff78287ef->Name: IMG_LoadTyped_RW(src=0xc63e70, freesrc=0x1, type=0x0)
[#4] 0x7ffff78285e0->Name: IMG_Load(file=0x7fffffffe4e0 "gif_crashes/0345ae792a4ed85e785571105a430417")
[#5] 0x400b85->Name: main(argc=0x2, argv=0x7fffffffe1e8)
------------------------------------------------------------------------------------------------------------------------

```
### Timeline

2017-11-27 - Vendor Disclosure

2018-03-01 - Public Release

##### Credit

Discovered by Lilith <(x\_x)> of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2017-0510](/vulnerability_reports/TALOS-2017-0510) [Previous Report

TALOS-2017-0498](/vulnerability_reports/TALOS-2017-0498)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

Â©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from www.debian.org_e2909116_20250124_212517.html ===


---

[[Date Prev](msg00103.html)][[Date Next](msg00105.html)]
[[Thread Prev](msg00103.html)][[Thread Next](msg00105.html)]
[[Date Index](maillist.html#00104)]
[[Thread Index](threads.html#00104)]

# [SECURITY] [DSA 4177-1] libsdl2-image security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4177-1] libsdl2-image security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Fri, 20 Apr 2018 22:16:50 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20180420201650.GA7380%40pisco.westfalen.local)Â [20180420201650.GA7380@pisco.westfalen.local](msg00104.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4177-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
April 20, 2018                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : libsdl2-image
CVE ID         : CVE-2017-2887  CVE-2017-12122 CVE-2017-14440 CVE-2017-14441
                 CVE-2017-14442 CVE-2017-14448 CVE-2017-14449 CVE-2017-14450
                 CVE-2018-3837  CVE-2018-3838  CVE-2018-3839

Multiple vulnerabilities have been discovered in the image loading
library for Simple DirectMedia Layer 2, which could result in denial of
service or the execution of arbitrary code if malformed image files are
opened.

For the oldstable distribution (jessie), these problems have been fixed
in version 2.0.0+dfsg-3+deb8u1.

For the stable distribution (stretch), these problems have been fixed in
version 2.0.1+dfsg-2+deb9u1.

We recommend that you upgrade your libsdl2-image packages.

For the detailed security status of libsdl2-image please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/libsdl2-image>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlraSnYACgkQEMKTtsN8
Tjbd7RAAi1WGlcur3NflOdj1yy+VTnrurmB33trBRd6vWgRZndysRQz8ifqEqfbq
8h2FybTcVZ7cHjIoHgKDLYJt21Er+gaDUYF6EQsjvs7BYnseLcRHTe5NmBSaDLkp
ahjyNat3KBU7riNKLv7p3aHlae/XZECB9/GCcURQ4cJ7RFsVGIRvHQixaUNsD3f2
Y/4Kndn4MEN/27v9eKstWiJdskwHn6I1rEGFEaeU7gdLLTr02yLycoApinjavJzn
ryzetzu/K78OA3QC+IUiOHSILxvn/p1aH/EYbkbbHN5oUkQUTYjtYDKWgzP+BN/C
bhxe5w5O8l/ysEL9UW7Yiq2fwkTGKNMT7E/Ru+s0oCykiVemaYvGsFj0WP27vGV7
08oQ6z1Ry+DZUd4AnywGvYF0xdcRB5n/O1fF+HQSz+RqaoArkwzD868khTDwzZuY
DiDsXknPV8rlN8XC3ubUI42xqEK31j2dgP3BTyBXdqaa7+36FsHTraLRbd9KVtWg
RRoyqPAlt0pJgC5G4gMmlaibEgE0euT1bLnxf/0dsqrzdLTgaUxHLWnEJ3Ntm1H5
9adyp8ObVmPzsGI5BzSWTsgo8YjaC+f36zPJH6Sq5/pqPs7kZ7PXq8Al+FKLUiuL
rPTeHpvBAgZe0NTdeqIBwJ//0s7mIDRIKl+WwUFbEhFIUo6xmnw=
=7zfP
-----END PGP SIGNATURE-----

```

---


