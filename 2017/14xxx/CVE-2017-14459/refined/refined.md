- **Root cause of vulnerability:** The vulnerability stems from the insecure use of the `sprintf` function to create a log of failed authentication attempts. User-supplied input from the username field is directly incorporated into a command that is then executed by `system()`.
- **Weaknesses/vulnerabilities present:** OS Command Injection vulnerability (CWE-78) due to improper sanitization and handling of user input. The device is vulnerable because the username provided during login is used in a system call without any sanitization.
- **Impact of exploitation:** Successful exploitation allows for remote, unauthenticated root-level operating system command execution on the affected device. Attackers can execute arbitrary commands, leading to full compromise, denial of service, or other malicious activities.
- **Attack vectors:** The vulnerability can be exploited via Telnet, SSH, and the local console port. It is also suspected that the web application is vulnerable because it uses the same `loginutils` library.
- **Required attacker capabilities/position:** An attacker only needs network access to the device on the vulnerable ports (Telnet, SSH) or physical access to the console port. No authentication is required for the command injection to occur.