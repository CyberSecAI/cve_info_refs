```
[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/CVE-2017-14087-TRENDMICRO-OFFICESCAN-XG-HOST-HEADER-INJECTION.txt
[+] ISR: ApparitionSec

Vendor:
==================
www.trendmicro.com

Product:
========
OfficeScan
v11.0 and XG (12.0)\*

OfficeScan protects enterprise networks from malware, network viruses, web-based threats, spyware, and mixed threat attacks.
An integrated solution, OfficeScan consists of the OfficeScan agent program that resides at the endpoint and a server program that
manages all agents. The OfficeScan agent guards the endpoint and reports its security status to the server. The server, through the
web-based management console, makes it easy to set coordinated security policies and deploy updates to every agent.

Vulnerability Type:
===================
Host Header Injection

CVE Reference:
==============
CVE-2017-14087

Security Issue:
================
Host header injection issue as "db\_controller.php" relies on $\_SERVER['HTTP\_HOST'] which can be spoofed by client, instead of $\_SERVER['SERVER\_NAME'].
In environments where caching is in place by making HTTP GET request with a poisoned HOST header webpages can potentially render arbitrary
links that point to a malicious website.

Exploit/POC:
=============
c:\> CURL http://x.x.x.x -H "Host: ATTACKER-IP"

Network Access:
===============
Remote

Severity:
=========
Medium

Disclosure Timeline:
==================================
Vendor Notification: June 2, 2017
Vendor releases fixes / advisory : September 27, 2017
September 28, 2017 : Public Disclosure
```

- **Root cause of vulnerability**: The "db_controller.php" script uses the `$_SERVER['HTTP_HOST']` variable, which is populated by the client-supplied Host header, instead of `$_SERVER['SERVER_NAME']`.
- **Weaknesses/vulnerabilities present**: Host Header Injection. The application trusts the HTTP Host header provided by the client.
- **Impact of exploitation**: An attacker can inject a malicious hostname via the Host header. If caching is in place, this could lead to users being redirected to attacker-controlled websites through arbitrary links in the cached response.
- **Attack vectors**: Sending an HTTP GET request with a crafted "Host" header.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the vulnerable server, which is a remote network access scenario.