The provided content relates to CVE-2017-14163.

**Root cause of vulnerability:**
The vulnerability stems from the way Mahara handles session cookies. When a user logs into Mahara, a 'mahara' cookie containing a unique session string is set. This string is also stored in the `usr_session` table. If a user closes their browser without logging out, the session remains in the `usr_session` table. An attacker could exploit this by setting their browser's 'mahara' cookie to an old, valid value and gaining unauthorized access to the user's account.

**Weaknesses/vulnerabilities present:**
- Inadequate session management: The application does not invalidate sessions upon browser closure, leaving them vulnerable to replay attacks.
- Lack of user-agent verification: The application does not verify if the user agent associated with a session changes, potentially allowing attackers to use stolen cookies from different devices or browsers.
- Lack of email verification during email change/addition: Initially the application didn't verify changes to email addresses using a password, making it easier for an attacker to takeover an account.

**Impact of exploitation:**
- Unauthorized access to user accounts: By reusing a valid session cookie, an attacker can bypass authentication and gain complete access to a user's account.
- Account takeover: Initially, a malicious actor, with access to a user's session could have modified account emails and taken over the account.

**Attack vectors:**
- Replay attacks: An attacker can obtain a user's session cookie (e.g., through network sniffing or malware) and reuse it to impersonate the user.
- Man-in-the-middle attacks: An attacker can intercept network traffic and steal a user's session cookie, especially on non-HTTPS sites.

**Required attacker capabilities/position:**
- Ability to intercept or obtain session cookies: This could be achieved through network access (e.g., being on the same network as the user), malware on the user's machine, or other means of cookie theft.
- Ability to modify browser cookies: An attacker needs to be able to set or alter the 'mahara' cookie value in their own browser.