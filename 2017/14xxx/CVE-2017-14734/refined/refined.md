- **Root cause of vulnerability:** A heap-buffer-overflow vulnerability exists in the `build_msps` function of libbpg due to insufficient bounds checking when copying data into a buffer. Specifically, the while loop logic for adding escape codes to the `buf` buffer can write beyond the allocated size.
- **Weaknesses/vulnerabilities present:** Heap-based buffer overflow, improper bounds checking.
- **Impact of exploitation:** Denial of service or arbitrary code execution could occur due to the out-of-bounds write.
- **Attack vectors:** A crafted BPG image can be used to trigger the overflow in `build_msps` during the processing of the image data.
- **Required attacker capabilities/position:** The attacker needs to be able to provide a crafted BPG file to a vulnerable application using libbpg.