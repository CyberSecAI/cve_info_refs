=== Content from github.com_912431f9_20250126_005206.html ===
# Vulnerabilities in D-Link routers (CVE-2017-14948)
In this little write-up we will see some bugs I found on D-Link products. D-Link offers a wide range of products, including many different router models, mounting different firmware versions. In this document I will address the following firmware versions: DIR-880L, DIR-868L, DIR-890L, DIR-885L and DIR-895L.
Without any further ado, let's begin.
## Firmware analysis
As I didn't own any of the D-Link routers, and they provide free access to their firmware, I decided to find bugs by only relying on static analysis. Note that, in this section I will refer to the firmware DIR-880L, the other firmware have similar structures.
### DIR-880L
After downloading and unpacking the DIR-880L firmware, I found that its firmware contain a whole squashFS file-system, containing about 2160 files. AS I didn't want to consider each one of them independently, I started looking for the one handling user-inputs.
After analyzing the configuration files and looking for HTTP known headers, I finally restrict my focus on three binaries, and finally on one: fileaccess.cgi.
Here's the disassembly of the vulnerable function:
```c
signed int \_\_fastcall content\_type(char \*a1)
{
char \*dest; // [sp+4h] [bp-10h]@1
const char \*haystack; // [sp+Ch] [bp-8h]@1
char \*haystacka; // [sp+Ch] [bp-8h]@3
dest = a1;
haystack = getenv("CONTENT\_TYPE");
if ( !haystack )
return -22;
haystacka = strstr(haystack, "boundary=");
if ( !haystacka )
return -22;
strcpy(dest, haystacka + 9);
return 0;
}
```
In the above code the content of the variable 'CONTENT\_TYPE' (pointed by the variable haystack) is controlled by a user (through the HTTP request's header). Its content, after the keyword 'boundary', is then copied into a buffer dest, without checking haystacka's length. If one takes a look at the caller function (address 0x1CE6C), one can infer that the size of dest is 256 bytes. As an attacker can control the content of CONTENT\_TYPE, she could send the string 'boundary=' followed by as least as 257 characters to trigger a buffer overflow.
Other two similar bugs were found in the same firmware sample, involving the HTTP cookie.
One of them is shown below:
```c
v10 = getenv("HTTP\_COOKIE");
if ( v10 )
{
strcpy((char \*)&v5, &v10[v11]);
v17 = strlen((const char \*)&v5);
}
```
Here, the ariable v10 points to the user cookie, which can be at most 4k bytes (according the RFC2109). However, the variable v5 is as big as 1024 bytes (as we can infer from the function's stack frame). This can trigger a buffer overflow.
These bugs were reported and confirmed by D-Link.
### DIR-868L, DIR-890L, DIR-885L and DIR-895L
These firmware samples present a similar structure as DIR-880L and have the same bugs related to the same HTTP fields.


=== Content from github.com_5f0e7299_20250124_113533.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbadnack%2Fd_link_880_bug%2Fblob%2Fmaster%2FREADME.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbadnack%2Fd_link_880_bug%2Fblob%2Fmaster%2FREADME.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=badnack%2Fd_link_880_bug)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[badnack](/badnack)
/
**[d\_link\_880\_bug](/badnack/d_link_880_bug)**
Public

* [Notifications](/login?return_to=%2Fbadnack%2Fd_link_880_bug) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fbadnack%2Fd_link_880_bug)
* [Star
   3](/login?return_to=%2Fbadnack%2Fd_link_880_bug)

* [Code](/badnack/d_link_880_bug)
* [Issues
  0](/badnack/d_link_880_bug/issues)
* [Pull requests
  0](/badnack/d_link_880_bug/pulls)
* [Actions](/badnack/d_link_880_bug/actions)
* [Projects
  0](/badnack/d_link_880_bug/projects)
* [Security](/badnack/d_link_880_bug/security)
* [Insights](/badnack/d_link_880_bug/pulse)

Additional navigation options

* [Code](/badnack/d_link_880_bug)
* [Issues](/badnack/d_link_880_bug/issues)
* [Pull requests](/badnack/d_link_880_bug/pulls)
* [Actions](/badnack/d_link_880_bug/actions)
* [Projects](/badnack/d_link_880_bug/projects)
* [Security](/badnack/d_link_880_bug/security)
* [Insights](/badnack/d_link_880_bug/pulse)

## Files

 master
## Breadcrumbs

1. [d\_link\_880\_bug](/badnack/d_link_880_bug/tree/master)
/
# README.md

Copy path Blame  Blame
## Latest commit

## History

[History](/badnack/d_link_880_bug/commits/master/README.md)51 lines (41 loc) · 2.75 KB master
## Breadcrumbs

1. [d\_link\_880\_bug](/badnack/d_link_880_bug/tree/master)
/
# README.md

Top
## File metadata and controls

* Preview
* Code
* Blame

51 lines (41 loc) · 2.75 KB[Raw](https://github.com/badnack/d_link_880_bug/raw/refs/heads/master/README.md)
# Vulnerabilities in D-Link routers (CVE-2017-14948)

In this little write-up we will see some bugs I found on D-Link products. D-Link offers a wide range of products, including many different router models, mounting different firmware versions. In this document I will address the following firmware versions: DIR-880L, DIR-868L, DIR-890L, DIR-885L and DIR-895L.
Without any further ado, let's begin.

## Firmware analysis

As I didn't own any of the D-Link routers, and they provide free access to their firmware, I decided to find bugs by only relying on static analysis. Note that, in this section I will refer to the firmware DIR-880L, the other firmware have similar structures.

### DIR-880L

After downloading and unpacking the DIR-880L firmware, I found that its firmware contain a whole squashFS file-system, containing about 2160 files. AS I didn't want to consider each one of them independently, I started looking for the one handling user-inputs.

After analyzing the configuration files and looking for HTTP known headers, I finally restrict my focus on three binaries, and finally on one: fileaccess.cgi.

Here's the disassembly of the vulnerable function:

```
signed int __fastcall content_type(char *a1)
{
  char *dest; // [sp+4h] [bp-10h]@1
  const char *haystack; // [sp+Ch] [bp-8h]@1
  char *haystacka; // [sp+Ch] [bp-8h]@3

  dest = a1;
  haystack = getenv("CONTENT_TYPE");
  if ( !haystack )
    return -22;
  haystacka = strstr(haystack, "boundary=");
  if ( !haystacka )
    return -22;
  strcpy(dest, haystacka + 9);
  return 0;
}
```

In the above code the content of the variable 'CONTENT\_TYPE' (pointed by the variable haystack) is controlled by a user (through the HTTP request's header). Its content, after the keyword 'boundary', is then copied into a buffer dest, without checking haystacka's length. If one takes a look at the caller function (address 0x1CE6C), one can infer that the size of dest is 256 bytes. As an attacker can control the content of CONTENT\_TYPE, she could send the string 'boundary=' followed by as least as 257 characters to trigger a buffer overflow.

Other two similar bugs were found in the same firmware sample, involving the HTTP cookie.
One of them is shown below:

```
v10 = getenv("HTTP_COOKIE");
  if ( v10 )
  {
    strcpy((char *)&v5, &v10[v11]);
    v17 = strlen((const char *)&v5);
  }
```

Here, the ariable v10 points to the user cookie, which can be at most 4k bytes (according the RFC2109). However, the variable v5 is as big as 1024 bytes (as we can infer from the function's stack frame). This can trigger a buffer overflow.

These bugs were reported and confirmed by D-Link.

### DIR-868L, DIR-890L, DIR-885L and DIR-895L

These firmware samples present a similar structure as DIR-880L and have the same bugs related to the same HTTP fields.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


