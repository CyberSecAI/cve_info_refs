- **Root cause of vulnerability**: The vulnerability stems from a directory traversal flaw in the `snapPicHandler` function of the `CGIProxy.fcgi` service. The service fails to properly sanitize user-supplied input when constructing a file path, allowing an attacker to specify a file outside of the intended directory. Specifically, the code extracts a filename from a string and then uses `sprintf` to build a path relative to `/tmp/www/snapPic/` without stripping characters that could lead to directory traversal (e.g. `../`).
- **Weaknesses/vulnerabilities present**:
    - **CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')**: The application does not properly validate or sanitize the file path provided by the user in the `callbackJson` parameter, which leads to directory traversal.
- **Impact of exploitation**: An attacker can read arbitrary files from the file system of the vulnerable device, potentially gaining access to sensitive information such as configuration files, user data or system files.
- **Attack vectors**: The vulnerability is triggered via a crafted HTTP request sent to the device. The attacker must send a request containing the `usrBeatHeart` command, as well as the `callbackJson` parameter, which includes the file path using directory traversal sequences (`../`).
- **Required attacker capabilities/position**: An attacker needs network access to the Foscam camera's web management interface, and does not require authentication in order to exploit the vulnerability by abusing the `usrBeatHeart` command, which calls the vulnerable path in `snapPicHandler`.