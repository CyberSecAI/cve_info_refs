- **Root cause of vulnerability**: The Foscam C1 camera firmware recovery process lacks proper security checks. Specifically, the firmware image is not signed, and the integrity checks are insufficient, allowing a custom image to be flashed.
- **Weaknesses/vulnerabilities present**:
  - Improper authentication: The recovery process does not properly authenticate the source of the firmware image.
  - Insufficient integrity checks: The MD5 checksum verification is not sufficient to prevent the flashing of a malicious image.
  - Unsigned firmware: The lack of a signature check allows any crafted image to pass the checks.
- **Impact of exploitation**: An attacker can fully compromise the device by flashing a malicious firmware image. This allows for complete control over the camera, potentially leading to data theft, surveillance manipulation, or use of the device in a botnet.
- **Attack vectors**:
  - TFTP: An attacker on the same subnet can set up a TFTP server to serve a malicious recovery image when the device is rebooted.
  - SD Card: An attacker with administrative access via the web interface can upload a malicious image to the SD card and trigger recovery via reboot.
- **Required attacker capabilities/position**:
  - For TFTP attack: The attacker needs to be on the same subnetwork as the Foscam camera. No specific privileges or access to the device are required, other than knowing the device will attempt a TFTP recovery on boot.
  - For SD card attack: The attacker needs administrative access to the camera's web interface to upload the malicious firmware image to the SD card via FTP.