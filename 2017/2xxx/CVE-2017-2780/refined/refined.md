- **Root Cause of Vulnerability:** A heap buffer overflow occurs in the `parsePolicyMappings` function of `x509.c` while parsing the x509 SubjectDomainPolicy PolicyMappings extension. The vulnerability is due to an incorrect size calculation when allocating memory for OIDs. The allocated buffer size is determined by the length of the ASN.1 encoded sequence, but the actual number of OIDs parsed can be greater, leading to an overflow when writing the OIDs into the allocated memory.
- **Weaknesses/Vulnerabilities:** Heap-based buffer overflow (CWE-122)
- **Impact of Exploitation:** Remote code execution. A successful exploit allows an attacker to execute arbitrary code on the vulnerable system.
- **Attack Vectors:** A specially crafted x509 certificate with a manipulated PolicyMappings extension, presented to the vulnerable client or server when initiating secure connection.
- **Required Attacker Capabilities/Position:** The attacker must be able to present a malicious x509 certificate to a vulnerable client or server application during the initiation of a secure connection. No prior authentication or special privileges are needed. The attacker must be in a position to act as a MITM or present the crafted certificate to a server under their control.