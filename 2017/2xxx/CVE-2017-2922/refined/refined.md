- **Root cause of vulnerability:** The vulnerability lies in the `mg_deliver_websocket_data` function of the Cesanta Mongoose library, which handles WebSocket frame reassembly. Specifically, when a fragmented WebSocket frame is received, the code reallocates the receive buffer using `realloc`, potentially changing the memory location. However, several pointers based on the old buffer location are not updated or invalidated, leading to a use-after-free condition.

- **Weaknesses/vulnerabilities present:**
    - Use-after-free: Stale pointers are used after a buffer reallocation, which can cause memory corruption.
    - Lack of proper pointer management: The code fails to invalidate or update pointers to the receive buffer after resizing.

- **Impact of exploitation:**
    - Remote code execution: By exploiting the use-after-free vulnerability, an attacker can achieve arbitrary code execution on the target system.
    - Denial of service: Exploitation can also lead to a denial-of-service condition due to memory corruption.

- **Attack vectors:**
    - Network: The vulnerability is triggered by sending a specially crafted WebSocket packet over the network.
    - Specifically, the crafted packet needs to be a fragmented websocket frame.

- **Required attacker capabilities/position:**
    - The attacker must be able to send network traffic to the vulnerable server. No authentication is required.
    - An attacker would need to have knowledge of the specific structure of the websocket packets to properly trigger the bug.