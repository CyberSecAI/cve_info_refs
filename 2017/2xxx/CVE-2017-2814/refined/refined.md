- **Root cause of vulnerability:** The vulnerability is caused by a heap overflow in the image rendering functionality of Poppler, specifically within the `DCTStream::readScan()` method. The issue stems from the fact that the width and height variables used to allocate the buffer for image processing are read from the JPEG headers. A specially crafted PDF can initially allocate a buffer based on the headers, and then resize the height and width after the allocation in another header. This leads to out-of-bounds write during DCT transforms in `readScan()`.
- **Weaknesses/vulnerabilities present:** Heap-based buffer overflow (CWE-122). The vulnerability is triggered when the image data is processed in the `readScan()` function. The allocated buffer is smaller than what `readScan()` expects due to the modified width/height values, which leads to an out-of-bounds write to the heap.
- **Impact of exploitation:** Successful exploitation of this vulnerability can lead to arbitrary code execution due to heap corruption. An attacker can craft a malicious PDF that can overwrite data in the heap and potentially gain control of the system.
- **Attack vectors:** The attack vector is a maliciously crafted PDF file containing manipulated JPEG headers.
- **Required attacker capabilities/position:** An attacker needs the ability to provide a crafted PDF to a user. The user then needs to open this PDF using a vulnerable version of Poppler.