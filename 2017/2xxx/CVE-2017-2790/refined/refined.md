- **Root cause of vulnerability:** An integer underflow vulnerability occurs when processing a record of type `0x3c` within a Workbook stream in a Microsoft Excel `.xls` file. The application reads a size value from the file, subtracts one from it, and uses the result as the size for a memcpy operation. When this size is zero, the subtraction results in an underflow, leading to a very large size value being used in the memcpy.
- **Weaknesses/vulnerabilities present:** Heap-based buffer overflow due to the unchecked integer underflow and a subsequent memcpy operation using the underflowed value.
- **Impact of exploitation:** Arbitrary code execution under the context of the application by overflowing the heap-based buffer.
- **Attack vectors:** A specially crafted `.xls` file containing a record of type `0x3c` with a size value of zero in the Workbook stream, triggers the vulnerability when opened with the vulnerable application.
- **Required attacker capabilities/position:** The attacker needs to create a malicious `.xls` file and entice a user to open it using the vulnerable Ichitaro application.