- **Root cause of vulnerability:** The vulnerability is due to a command injection flaw in the handling of the `dns2` parameter within the `setIpInfo` command of the Foscam C1 Indoor HD Camera's web management interface. The value for the `dns2` parameter is not sanitized before being used in a `sprintf` call to construct a command that is then passed to `execlp`, leading to command injection.
- **Weaknesses/vulnerabilities present:**
    - OS Command Injection (CWE-78): The lack of sanitization on the `dns2` parameter allows an attacker to inject arbitrary shell commands.
- **Impact of exploitation:** Successful exploitation allows an attacker to execute arbitrary OS commands on the affected device. This could lead to complete compromise of the camera, including data theft, denial of service, or the camera becoming part of a botnet.
- **Attack vectors:** The attack vector is through a specially crafted HTTP request to the `/cgi-bin/CGIProxy.fcgi` endpoint, targeting the `setIpInfo` command.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the device and possess valid administrator credentials to access the vulnerable `setIpInfo` command.