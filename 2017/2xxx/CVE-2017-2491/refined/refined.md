```
{
  "cve": "CVE-2017-2491",
  "description": "This vulnerability allows remote attackers to execute arbitrary code on vulnerable installations of Apple Safari. User interaction is required to exploit this vulnerability in that the target must visit a malicious page or open a malicious file.  The specific flaw exists within the handling of the String.replace method. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to execute code under the context of the current process.",
  "vulnerability_details": {
    "root_cause": "The vulnerability is a use-after-free (UAF) that occurs in the `String.prototype.replace` method when called with a RegExp object and a function as arguments. When the `g` flag is set in the regular expression, the JavascriptCore (JSC) engine creates a `CachedCall` instance to handle the callback function. The arguments passed to the callback, created by `jsSubstring`, are stored in a `WTF::Vector`. If a garbage collection (GC) cycle occurs during allocation of a new argument string, the previous `JSString` instances will be collected and freed. Later when the callback is invoked the freed `JSString` object is used, leading to a UAF condition.",
    "weaknesses": [
      "Use-after-free",
       "Lack of object existence validation before performing operations on it"
    ],
    "impact": "Remote attackers can execute arbitrary code on vulnerable installations of Apple Safari within the context of the current process.",
    "attack_vectors": "An attacker can exploit this vulnerability by crafting a malicious web page that triggers the vulnerable `String.replace` method.",
    "required_capabilities": "The attacker needs the ability to host a malicious website. The victim must be enticed to visit this site using a vulnerable version of Safari. User interaction is required to exploit the vulnerability. "
  },
  "references": [
    {
      "url": "https://www.zerodayinitiative.com/advisories/ZDI-17-321/",
      "source": "Zero Day Initiative Advisory",
      "description": "Detailed advisory from ZDI"
    },
    {
      "url": "https://phoenhex.re/2017-05-04/pwn2own17-cachedcall-uaf",
      "source": "phoenhex.re",
      "description": "In depth write up on the vulnerability and exploit"
    },
    {
      "url": "https://github.com/phoenhex/files/blob/master/exploits/cachedcall-uaf.html",
       "source": "GitHub",
       "description": "Exploit code example"
    },
    {
      "url": "https://support.apple.com/en-us/HT207600",
      "source": "Apple Support",
       "description": "Apple security update page mentioning the fix for the CVE"
     },
    {
      "url": "https://www.exploit-db.com/exploits/41964",
       "source":"Exploit DB",
       "description": "Exploit code and details"
    }
  ]
}
```