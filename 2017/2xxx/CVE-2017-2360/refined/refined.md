Based on the provided information, here's an analysis of CVE-2017-2360:

**Root Cause:**
- A use-after-free vulnerability exists in the kernel. This is due to the `host_self_trap` mach trap accessing the `task->itk_host` port without acquiring the necessary lock, `itk_lock_data`.

**Vulnerabilities Present:**
- **Use-After-Free (UAF):** The core weakness is a use-after-free condition, where the `itk_host` port of a task is accessed after it has been freed.
- **Race Condition:** The vulnerability is triggered by a race condition between two threads. Thread A reads the `itk_host` port, while thread B might simultaneously replace this port and release the old one, leading to Thread A using the freed port.

**Impact of Exploitation:**
- **Arbitrary Code Execution with Kernel Privileges:** Successful exploitation allows an attacker to execute arbitrary code within the kernel, leading to a complete compromise of the system.
- **Denial of Service (DoS):** The exploit can also cause a system crash, resulting in a denial of service, as observed in the provided exploit code.

**Attack Vectors:**
- **Local Application:** The exploit requires a local application capable of making mach calls like `host_self_trap` and `task_set_special_port`.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to execute code locally on the affected system. This can be achieved by exploiting other vulnerabilities that may allow arbitrary code execution, or by running a malicious application.
- The attacker also needs the ability to manipulate the `host` port of the current task via `task_set_special_port`.

**Technical Details:**
- The `host_self_trap` mach trap accesses `task->itk_host` directly without proper locking.
- `task_set_special_port` can change the `itk_host` port and release the old one.
- The race occurs when `host_self_trap` reads `itk_host`, and while trying to copy it, `task_set_special_port` replaces and frees the port.
- The exploit involves repeatedly setting the `TASK_HOST_PORT` and then setting it to `MACH_PORT_NULL`. This combined with the `mach_host_self()` call in another thread triggers the vulnerability.

**Affected Systems:**

- The vulnerability affects macOS, iOS, watchOS and tvOS. Specifically, it was found in macOS 10.12.1 but was patched in macOS Sierra 10.12.3, iOS 10.2.1, tvOS 10.1.1 and watchOS 3.1.3.

**Summary:**
CVE-2017-2360 is a serious use-after-free vulnerability in the kernel. It arises from a race condition due to improper locking when accessing the `task->itk_host` port, which can result in arbitrary code execution within the kernel and could also cause denial of service. The attacker requires local access to the system.