```
{
  "cve": "CVE-2017-2673",
  "description": "An authorization-check flaw was discovered in federation configurations of the OpenStack Identity service (keystone). An authenticated federated user could request permissions to a project and unintentionally be granted all related roles including administrative roles.",
  "affected_versions": [
    ">=10.0.0 <=10.0.1",
    "==11.0.0"
  ],
  "root_cause": "The vulnerability is caused by the method that fetches all role assignments for a project or domain, regardless of whether the assignment is for a user or a group. This leads to a situation where a federated user without groups can obtain a token with other users' roles when there are rules in which group-based assignments are not used.",
  "vulnerabilities": [
    "Incorrect role assignment with federated Keystone",
    "Authenticated federated user could request permissions to a project and unintentionally be granted all related roles including administrative roles."
  ],
  "impact": "An authenticated federated user may receive all the roles assigned to a user's project, including administrative roles, regardless of the federation mapping. This allows the user to perform actions they are not authorized to do, including gaining full administrative privileges.",
  "attack_vectors": [
    "Requesting admin user to get a role in their project",
        "When there are rules in which group-based assignments are not used."
  ],
  "attacker_capabilities": [
    "Authenticated federated user",
        "Ability to request an admin user to get a role in their project."
  ],
  "patches": [
    {
      "version": "Newton",
      "link": "https://review.openstack.org/459713"
    },
    {
      "version": "Ocata",
      "link": "https://review.openstack.org/459732"
    },
      {
      "version": "Pike",
      "link": "https://review.openstack.org/459705"
    }
  ],
  "workaround": "The workaround for the issue is to remove the role from the admin user in the vulnerable project, which immediately revokes the unauthorized privileges of the federated user"
}
```