- **Root cause of vulnerability**: A heap-based buffer overflow occurs when processing a Figure stream in a .jtd file. The application calculates two sizes and chooses the smaller value for a memory copy operation, but fails to check if this smaller value is larger than the allocated buffer.
- **Weaknesses/vulnerabilities present**: Heap-based buffer overflow due to insufficient size validation when copying data into a buffer. This is caused by using an attacker controlled size for the copy operation.
- **Impact of exploitation**: Arbitrary code execution under the context of the application due to a corrupted heap offset used in pointer arithmetic during data writing.
- **Attack vectors**: By crafting a malicious .jtd file with a specially crafted Figure stream.
- **Required attacker capabilities/position**: An attacker needs to create a malicious .jtd file and have the victim open it with the vulnerable version of Ichitaro.