```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2017-2478",
      "exploit_db_id": "41794",
      "vulnerability": "Bad Locking in necp_open Use-After-Free",
      "affected_products": [
        "macOS 10.12.3 (16D32)",
         "iOS 10.3",
        "tvOS 10.2",
        "watchOS 3.2"
      ],
      "root_cause": "The vulnerability exists because the file descriptor data (`fd_data`) is owned by the file pointer (`fp`). After the process file descriptor table is unlocked, another thread can close the file descriptor which frees `fd_data` before it is enqueued into `necp_fd_list`.",
      "weaknesses": [
        "Use-After-Free",
        "Race Condition"
      ],
      "impact": "An attacker can cause a denial of service or potentially execute arbitrary code with kernel privileges due to the use-after-free condition. The race condition enables the attacker to free memory prematurely leading to memory corruption.",
      "attack_vector": "The vulnerability can be triggered by creating a new `necp` file descriptor via the `necp_open` syscall and then closing it on another thread.",
       "required_capabilities": "The attacker needs the ability to create and close file descriptors via syscalls, which is available to user-level applications, and the ability to create multiple threads."
    }
  ]
}
```