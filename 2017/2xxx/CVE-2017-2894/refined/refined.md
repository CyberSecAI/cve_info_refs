- **Root cause of vulnerability**: A stack buffer overflow occurs due to missing bounds check when handling MQTT SUBSCRIBE packets with multiple topic subscriptions. Specifically, the `qoss` array, allocated on the stack with a size of 512 bytes, is overflowed if the number of topic subscriptions exceeds 512.
- **Weaknesses/vulnerabilities present**: Stack-based buffer overflow (CWE-121)
- **Impact of exploitation**: Remote code execution. By overflowing the stack buffer, an attacker can overwrite adjacent variables or the return address, leading to arbitrary code execution.
- **Attack vectors**: Sending a specially crafted MQTT SUBSCRIBE packet with more than 512 topic subscriptions over the network.
- **Required attacker capabilities/position**: The attacker needs to be able to send network packets to the vulnerable server. No authentication is required, and the attacker can be remote.