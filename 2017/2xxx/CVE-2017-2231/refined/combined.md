=== Content from www.mlit.go.jp_1be8b304_20250124_134315.html ===
電子成果品作成支援・検査システムにおける任意のDLL読み込みに
関する脆弱性の注意喚起

公開日 2017年6月20日

■概要

電子成果品作成支援・検査システムの自己解凍書庫及びインストーラーに、任意のDLL読

み込みに関する脆弱性が存在することが判明しました。

この脆弱性を悪用された場合、悪意ある第三者の攻撃により、意図しないDLLを実行して

しまう恐れがあります。

■脆弱性の説明

電子成果品作成支援・検査システムは、ファイルの自己解凍のためにLhaplusの機能を搭
載しています。自己解凍時、任意のDLLの読み込みにより、カレントディレクトリを含む複
数のフォルダを検索してDLLを読み込みますが、カレントディレクトリを優先して検索する
ため、悪意ある第三者の攻撃により、意図しないDLLを実行してしまう恐れがあります。

■脆弱性がもたらす脅威

管理者権限で任意のコードを実行される可能性があります。

■対策方法

平成29年6月9日以前にダウンロードした本システムファイルを確実に削除してくださ

い。

■回避策

この脆弱性は、次に示す手順で影響を緩和できる場合があります。
・自己解凍書庫の実行を新規に作成したフォルダ内で行う。
・本システムのインストーラーの起動を新規に作成したフォルダ内で行う。

■関連情報
JVNDB-2010-000037：Lhaplus における DLL 読み込みに関する脆弱性

■謝辞

橘総合研究所の英利雅美氏よりこの問題をご報告いただきました。



=== Content from jvn.jp_493c9065_20250124_134314.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2017/07/03  Last Updated:2017/07/11
# JVN#06337557 Installer and self-extracting archive containing the installer of MLIT DenshiSeikabutsuSakuseiShienKensa system may insecurely load Dynamic Link Libraries

## Overview

The installer and the self-extracting archive containing the installer of MLIT DenshiSeikabutsuSakuseiShienKensa system may insecurely load Dynamic Link Libraries.

## Products Affected

* The installer of MLIT DenshiSeikabutsuSakuseiShienKensa system Ver3.0.2 and earlier, distributed till June 20, 2017.
* The self-extracting archive including the installer of MLIT DenshiSeikabutsuSakuseiShienKensa system Ver3.0.2 and earlier, distributed till June 20, 2017.

## Description

The installer and the self-extracting archive including the installer of MLIT DenshiSeikabutsuSakuseiShienKensa system contain an issue with the DLL search path, which may lead to insecurely loading Dynamic Link Libraries ([CWE-427](https://cwe.mitre.org/data/definitions/427.html)).

## Impact

Arbitrary code may be executed with the privilege of the user invoking the installer or the self-extracting archive.

## Solution

**Use the latest self-extracting archive and invoke the installer carefully**

Use the latest self-extracting archive according to the information provided by the developer.

New self-extracting archive has been created with the latest Lhaplus archiver which is not affected by this issue, and it was released on June 20, 2017.

When invoking the installer extracted from the self-extracting archive, make sure that no malicious DLL exists in the same directory.

Re-installation of the application is not necessary, because this issue affects the installer only.

## Vendor Status

| Vendor | Link |
| --- | --- |
| Ministry of Land, Infrastructure, Transport and Tourism, Japan | [Government Buildings Department, MLIT: DenshiSeikabutsuSakuseiShienKensa System ver3.0](http://www.mlit.go.jp/gobuild/gobuild_cals_sysv3.html) |
|  | [Vulnerability Announcement](http://www.mlit.go.jp/common/001189444.pdf) |

## References

1. [Japan Vulnerability Notes JVNTA#91240916](https://jvn.jp/en/ta/JVNTA91240916/)
   Insecure DLL Loading and Command Execution Issues on Many Windows Application Programs

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
Base Score:
7.8

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:M/Au:N/C:P/I:P/A:P
Base Score:
6.8

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Comment

This analysis assumes that the user is tricked into placing a malicious DLL file prepared by an attacker in a specific folder.

## Credit

Eili Masami of Tachibana Lab. reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2017-2231](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2231) |
| JVN iPedia | [JVNDB-2017-000158](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000158) |

## Update History

2017/07/03
Fixed a link under the section [Vendor Status]
2017/07/11
Information under the section [Products Affected] was modified.

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2017 JPCERT/CC and IPA. All rights reserved.


