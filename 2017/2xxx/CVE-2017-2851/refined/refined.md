- **Root cause of vulnerability**: A stack-based buffer overflow exists in the `sub_283A8` function, which is called when handling the "setWifiSetting" command with the "isNewFormat" parameter set. The "psk" parameter, containing the wifi password as comma-separated ASCII values, is copied into a local buffer "src" without proper size checks.
- **Weaknesses/vulnerabilities present**:
    - **CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')**: The `strcpy` function is used to copy the "psk" value into the "src" buffer, which has a fixed size of 0x100 bytes, without any size checks. This allows an attacker to overwrite adjacent stack data by providing a "psk" string larger than the buffer size.
- **Impact of exploitation**: Overwriting stack data can potentially lead to arbitrary code execution. The provided proof-of-concept shows that by providing a "psk" value of 328 "A" characters, it is possible to overwrite the saved register `r4`.
- **Attack vectors**: A remote attacker can exploit this vulnerability by sending a specially crafted HTTP request to the Foscam device, specifically targeting the `CGIProxy.fcgi` interface with the `setWifiSetting` command, a long `psk` value, and a non-null `isNewFormat` value.
- **Required attacker capabilities/position**:
    - The attacker needs to be able to send HTTP requests to the vulnerable device.
    - The attacker requires a valid user account with privilege level 2 to access the `setWifiSetting` command.