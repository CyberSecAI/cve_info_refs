```
{
  "vulnerability_details": {
    "root_cause": "A use-after-free vulnerability exists in the x509 certificate validation functionality, specifically in the parsing of `nameConstraints` x509v3 certificate extension fields.",
    "weaknesses": [
      "Use-after-free vulnerability due to improper memory management in the parsing of x509 certificates.",
      "Improper input validation when parsing name constraints within a certificate's general subtrees."
    ],
    "impact": "Remote code execution. By providing a crafted certificate, an attacker can cause a use-after-free condition, leading to arbitrary code execution.",
     "attack_vectors": [
        "Visiting a malicious HTTPS website serving the crafted certificate.",
         "Connecting to a malicious mail server using Mail.app.",
         "Importing the malicious certificate by double-clicking it in Finder.",
        "Processing a malicious x509 certificate"
    ],
    "required_attacker_capabilities": "An attacker needs the ability to present a crafted x509 certificate to the vulnerable system. This can be achieved by hosting a website, setting up a mail server, or by getting the user to import the certificate locally.",
    "additional_information": "The vulnerability is located in the `parseGeneralSubtrees` function within the `/System/Library/Frameworks/Security.framework/Versions/A/Security` library. The vulnerability occurs when the DER decoding of the sequence fails leading to an incorrect release of memory but leaving a stale pointer that can be re-used and freed, leading to a crash. Further manipulation of memory can lead to arbitrary code execution. A proof-of-concept certificate can be created using openssl. A crashing certificate will render the system unusable."
  }
}
```