=== Content from www.talosintelligence.com_a12d135d_20250125_115215.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

Ã—

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2017-0377

## Gdk-Pixbuf TIFF tiff\_image\_parse Code Execution Vulnerability

##### August 30, 2017

##### CVE Number

CVE-2017-2870

### Summary

An exploitable integer overflow vulnerability exists in the tiff\_image\_parse functionality of Gdk-Pixbuf 2.36.6 when compiled with Clang.
A specially crafted tiff file can cause a heap-overflow resulting in remote code execution. An attacker can send a file or a URL to trigger this vulnerability.

### Tested Versions

Gdk-Pixbuf 2.36.6 commit: aba8d88798dfc2f3856ea0ddda14b06174bbb2bc
compiled with clang -O3 flag
libtiff 4.0.6

### Product URLs

<https://developer.gnome.org/gdk-pixbuf/>

### CVSSv3 Score

8.8 - CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### CWE

CWE-758: Reliance on Undefined, Unspecified, or Implementation-Defined Behavior

### Details

```
Gdk-Pixbuf is a toolkit for image loading and pixel buffer manipulation used in various type of desktop applications: image viewers(GNOME thumbnailer), web browsers (Chromium, Firefox), media players (VLC), etc. The vulnerability exists in the TIFF parser and only manifests itself when the library is compiled with high optimization flags `-O3` (tested with Clang, gcc does not remove the check). Several defined `if statements`  inside the `tiff_image_parse` function  are responsible of integer overflow checks or at least that was their intention. Because the checks are made on signed integers, the condition cannot evaluate to false unless an  integer overflow occurs.  According to the C standard, a signed integer overflow is defined as "Undefined Bahavior", thus behaviour related to it is implementation dependent and in the case of Clang the check is removed. Finally the lack of proper integer overflows check leads to heap overflow and can allow attackers to obtain arbitrary code execution.

```

The code below is removed from compilation process because it would be true if a `signed integer overflow` would occur which is `undefined bahavior`:

```
Line 89         gint width, height, rowstride, bytes;
Line 128        rowstride = width * 4;
Line 129        if (rowstride / 4 != width) { /* overflow */
Line 130                g_set_error_literal (error,
Line 131                                     GDK_PIXBUF_ERROR,
Line 132                                     GDK_PIXBUF_ERROR_CORRUPT_IMAGE,
Line 133                                     _("Dimensions of TIFF image too large"));
Line 134                return NULL;
Line 135        }
Line 136
Line 137        bytes = height * rowstride;
Line 138        if (bytes / rowstride != height) { /* overflow */
Line 139                g_set_error_literal (error,
Line 140                                     GDK_PIXBUF_ERROR,
Line 141                                     GDK_PIXBUF_ERROR_CORRUPT_IMAGE,
Line 142                                     _("Dimensions of TIFF image too large"));
Line 143                return NULL;
Line 144        }

```

in our case the variables have the following values:

```
width  = 0x8020
height = 0xfff7

```

which causes an integer overflow at `line 137`:

```
bytes = height * ( width * 4)

```

Then, based on the overflowed value, a buffer is allocated :

```
Line 160       pixels = g_try_malloc (bytes);

```

Then all three parameters: width,height and the allocated `bytes` buffer are passed as arguments:

```
Line 272		if (!TIFFReadRGBAImageOriented (tiff, width, height, (uint32 *)pixels, ORIENTATION_TOPLEFT, 1)) {

```

Because buffer `bytes` was allocated based on overflowed value, width and height parameters mismatch the size of the buffer which leads to out of bound writes (Line 1362) inside the `put1bitbwtile` function while reading RGB values:

```
libtiff/tif_getimage.c:1326
Line 1351	/*
Line 1352	 * 1-bit bilevel => colormap/RGB
Line 1353	 */
Line 1354	DECLAREContigPutFunc(put1bitbwtile)
Line 1355	{
Line 1356		uint32** BWmap = img->BWmap;
Line 1357
Line 1358		(void) x; (void) y;
Line 1359		fromskew /= 8;
Line 1360		while (h-- > 0) {
Line 1361		uint32* bw;
Line 1362		UNROLL8(w, bw = BWmap[*pp++], *cp++ = *bw++);
Line 1363		cp += toskew;
Line 1364		pp += fromskew;
Line 1365		}
Line 1366	}

```
### Crash Information

```
valgrind ./pixbuf-read crashes/tiff_bug.tiff
==32378== Invalid write of size 4
==32378==    at 0x4B5D71D: put1bitbwtile (tif_getimage.c:1326)
==32378==    by 0x4B5BE5E: gtTileContig (tif_getimage.c:673)
==32378==    by 0x4B5B810: TIFFRGBAImageGet (tif_getimage.c:495)
==32378==    by 0x4B5B8ED: TIFFReadRGBAImageOriented (tif_getimage.c:514)
==32378==    by 0x4067A59: tiff_image_parse (io-tiff.c:272)
==32378==    by 0x406634C: gdk_pixbuf__tiff_image_stop_load (io-tiff.c:477)
==32378==    by 0x4048442: gdk_pixbuf_loader_close (gdk-pixbuf-loader.c:822)
==32378==    by 0x8048903: test_loader (pixbuf-read.c:35)
==32378==    by 0x8048903: main (pixbuf-read.c:75)
==32378==  Address 0x5343ba8 is 0 bytes after a block of size 7,207,808 alloc'd
==32378==    at 0x402D17C: malloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==32378==    by 0x432C3BF: g_try_malloc (in /lib/i386-linux-gnu/libglib-2.0.so.0.4800.2)
==32378==    by 0x4067584: tiff_image_parse (io-tiff.c:160)
==32378==    by 0x406634C: gdk_pixbuf__tiff_image_stop_load (io-tiff.c:477)
==32378==    by 0x4048442: gdk_pixbuf_loader_close (gdk-pixbuf-loader.c:822)
==32378==    by 0x8048903: test_loader (pixbuf-read.c:35)
==32378==    by 0x8048903: main (pixbuf-read.c:75)

```
### Timeline

2017-07-13 - Vendor Disclosure

2017-08-30 - Public Release

##### Credit

Discovered by Marcin 'Icewall' Noga of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2017-0306](/vulnerability_reports/TALOS-2017-0306) [Previous Report

TALOS-2017-0366](/vulnerability_reports/TALOS-2017-0366)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

Â©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from lists.debian.org_261f278f_20250125_115214.html ===


---

[[Date Prev](msg00024.html)][[Date Next](msg00026.html)]
[[Thread Prev](msg00024.html)][[Thread Next](msg00026.html)]
[[Date Index](maillist.html#00025)]
[[Thread Index](threads.html#00025)]

# [SECURITY] [DLA 2043-1] gdk-pixbuf security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2043-1] gdk-pixbuf security update
* *From*: Thorsten Alteholz <debian@alteholz.de>
* *Date*: Thu, 19 Dec 2019 19:37:46 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/alpine.DEB.2.20.1912191936050.13526%40jupiter.server.alteholz.net)Â [alpine.DEB.2.20.1912191936050.13526@jupiter.server.alteholz.net](msg00025.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : gdk-pixbuf
Version        : 2.31.1-2+deb8u8
CVE ID         : CVE-2016-6352 CVE-2017-2870 CVE-2017-6312 CVE-2017-6313
                 CVE-2017-6314

Several issues in gdk-pixbuf, a library to handle pixbuf, have been found.

CVE-2016-6352
     fix for denial of service (out-of-bounds write and crash) via
     crafted dimensions in an ICO file

CVE-2017-2870
     Fix for an exploitable integer overflow vulnerability in the
     tiff_image_parse functionality. When software is compiled with
     clang, A specially crafted tiff file can cause a heap-overflow
     resulting in remote code execution. Debian package is compiled
     with gcc and is not affected, but probably some downstream is.

CVE-2017-6312
     Fix for an integer overflow in io-ico.c that allows attackers
     to cause a denial of service (segmentation fault and application
     crash) via a crafted image

CVE-2017-6313
     Fix for an integer underflow in the load_resources function in
     io-icns.c that allows attackers to cause a denial of service
     (out-of-bounds read and program crash) via a crafted image entry
     size in an ICO file

CVE-2017-6314
     Fix for an infinite loop in the make_available_at_least function
     in io-tiff.c that allows attackers to cause a denial of service
     via a large TIFF file.

For Debian 8 "Jessie", these problems have been fixed in version
2.31.1-2+deb8u8.

We recommend that you upgrade your gdk-pixbuf packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEEYgH7/9u94Hgi6ruWlvysDTh7WEcFAl37w3pfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDYy
MDFGQkZGREJCREUwNzgyMkVBQkI5Njk2RkNBQzBEMzg3QjU4NDcACgkQlvysDTh7
WEdNHA/9E1SoWRPCnx82sOaFyDZFmMhTGkq04Y3h9ETtxI3uC+FKSJxTWdMe4UTA
a3V8PLSWrZX4ixwcFFbnBr8zHVV6Z3LiC44s2QuIIg3267gokyanImA8NSL3Q/qy
Cmx1LTJbQXS5FA3ZJI+zHOzJoaZGNyDlROJ2s0tVXNDghbuu7bQTUGt4HxGn5p47
UvL5uDinM0TXQr1i+OWBJv9gfrSasM/Vr5Pl4T84aRsYsbJ0H6xY07VuHNNkV1VF
p6q/VhoLmIJcGJhKZguo/VYP6QrDnlR9c/ujQxeUEBRODtlYSOYLxbhWEUh030tO
iphLNBB31bTr9T527qxTpN/Iv5/blqcWPayxbcKC8acWkJBF2wvYVmjDXOwZK8mL
czndI+RLGCvBgD674exVsEOGTnrNvHOBv+RO9wl0yR9fGDhJFsMld/OZhanCRxOq
F9cEaXhXfVt+eJYSIyPS2S61AKbHCEPdLWfFwcl5OtYrmGag4T24pKM2sZs4qhkQ
XPklvlTaiRQQMlWYXy+L7XcjTub5ePocbt3l8G9VyQ7uKEcxdcvxiBSDsU8YEaLn
ddm0UwwFaz0QRb3aiC+TW1CoBG5tmrpe/TtompqHwnU5DrVL5PucfQnmGEQJsdGB
AsPHTxKhCpcpD8OqUd10TGFE1yf0AXMuJGBEtXh1Rp5LwFfKs7Q=
=Dlrx
-----END PGP SIGNATURE-----

```

---


