=== Content from jvn.jp_139a3383_20250125_205741.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2017/02/28  Last Updated:2017/02/28
# JVN#73083905 Multiple vulnerabilities in WBCE CMS

## Overview

WBCE CMS contains multiple vulnerabilities.

## Products Affected

* WBCE CMS 1.1.10 and earlier

## Description

WBCE CMS provided by WBCE Team is an open-source Contents Management System (CMS). WBCE CMS contains multiple vulnerabilities listed below.

* **Cross-site scripting ([CWE-79](https://cwe.mitre.org/data/definitions/79.html))** - CVE-2017-2118

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N | **Base Score: 6.1** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:H/Au:N/C:N/I:P/A:N | **Base Score: 2.6** |
* **Directory traversal ([CWE-22](https://cwe.mitre.org/data/definitions/22.html))** - CVE-2017-2119

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N | **Base Score: 5.8** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:N/C:P/I:N/A:N | **Base Score: 5.0** |
* **SQL injection ([CWE-89](https://cwe.mitre.org/data/definitions/89.html))** - CVE-2017-2120

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L | **Base Score: 4.7** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:S/C:P/I:P/A:P | **Base Score: 6.5** |

## Impact

* An arbitrary script may be executed on the user's web browser - CVE-2017-2118
* An arbitrary local file on the server may be accessed by a remote attacker - CVE-2017-2119
* An unexpected SQL command may be executed by a WBCE CMS administrator - CVE-2017-2120

Note that an arbitrary local file outside of WBCE CMS may be deleted by an administrator of WBCE CMS (CVE-2017-2119).

## Solution

**Update the software**

Update to the latest version according to the information provided by the developer.

**Apply the Patch**

The patch for WBCE CMS 1.1.3 to 1.1.10 is available.

Apply the patch according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| WBCE Team | [Announcements >> WBCE 1.1.11 Security/Maintenance Rel.](https://forum.wbce.org/viewtopic.php?id=977) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

## Credit

ASAI Ken reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2017-2118](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2118) |
|  | [CVE-2017-2119](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2119) |
|  | [CVE-2017-2120](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2120) |
| JVN iPedia | [JVNDB-2017-000035](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000035) |
|  | [JVNDB-2017-000036](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000036) |
|  | [JVNDB-2017-000037](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000037) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2017 JPCERT/CC and IPA. All rights reserved.



=== Content from forum.wbce.org_cbe03143_20250125_205742.html ===


| [Home](https://wbce.org/ "WBCE CMS Homepage")
| [Hilfe](https://help.wbce.org "WBCE CMS Anwenderdokumentation (also available in English)")
| [Add-Ons](https://addons.wbce.org/ "Module, Snippets, Droplets")
| [Templates](https://templates.wbce.org/ "WBCE CMS Templates")
| [Spenden](https://www.paypal.com/paypalme/WBCECMS/ "Spenden/Donate via Paypal")

| [Impressum](https://wbce.org/de/kontakt/impressum/)
| [Datenschutz](https://wbce.org/de/kontakt/datenschutz/) |
# [WBCE CMS Forum](index.php)

WBCE CMS – Way Better Content Editing.

* [Index](index.php)
* [Rules](misc.php?action=rules)
* [Search](search.php)
* [Register](register.php)
* [Login](login.php)

You are not logged in.

* Topics: [Active](search.php?action=show_recent "Find topics with recent posts.") | [Unanswered](search.php?action=show_unanswered "Find topics with no replies.")

* [Index](index.php)
* » [Archiv | Archive](index.php#idx10)
* » [Archiv - Ankündigungen | Announcements](viewforum.php?id=73)
* » **[WBCE 1.1.11 Sicherheits-/Wartungsrelease | Security/Maintainance Rel.](viewtopic.php?id=977)**

Pages: **1**

## #1 [12.02.2017 13:02:35](viewtopic.php?pid=9021#p9021)

**florian**
**Administrator**

### WBCE 1.1.11 Sicherheits-/Wartungsrelease | Security/Maintainance Rel.

- English text below -

**WBCE 1.1.11** steht ab sofort als [vollständiges Installationspaket, zum Updaten](http://www.wbce.org/media/WBCE-1.1.11.zip) und als [Patch](http://www.wbce.org/media/wbce-patch-170212.zip) für bestehende Versionen zur Verfügung.

![8ung.png](https://forum.wbce.org/img/8ung.png)
**Mit diesem Release werden einige ernste und potenzielle Sicherheitslücken behoben.
Das Update bzw. der Patch ist daher UMGEHEND einzuspielen.**

##### Neuinstallation

* Bitte nur noch die [Version 1.1.11](http://www.wbce.org/media/WBCE-1.1.11.zip) verwenden.
* Vorgehen wie gewohnt: Lokal entpacken, Inhalt des Verzeichnisses /wbce (aber nicht das Verzeichnis selbst) aus dem Installer auf den Server kopieren, Adresse der Website aufrufen (deinedomain.tld). Das Installationsscript startet automatisch.
* Systemvoraussetzungen PHP >= 5.3.6, PHP 5.6 / 7.0 empfohlen. PHP 7.1 wird noch nicht unterstützt.

##### Update von WBCE < 1.1.3 / WebsiteBaker 2.8.x

* **Wichtig!** Datensicherung (Dateisystem UND Datenbank) des Bestands auf dem Server vornehmen. sicherstellen, dass das Backup vollständig und brauchbar ist.
* Dateien aus dem [Installationspaket](http://www.wbce.org/media/WBCE-1.1.11.zip) lokal entpacken und den Inhalt des Verzeichnisses /wbce (aber nicht das Verzeichnis selbst) außer /install und config.php.new in das Verzeichnis der bestehenden Website auf den Server kopieren. Vorhandene Dateien dabei überschreiben. **Beachte:** Falls dort das admin-Verzeichnis umbenannt wurde, ist dies entsprechend auch im Update-Paket zu tun.
* Adresse der Website + /upgrade-script.php aufrufen (deinedomain.tld/upgrade-script.php). Hinweise zur Kenntnis nehmen und Script ausführen.

**ACHTUNG:** Beim Update werden ggf. selbst vorgenommene Änderungen an Core-Templates und -modulen (z.B. Topics, ckeditor) überschrieben. Bitte im Zweifelsfall Update vorher in Testumgebung ausführen und auf unerwünschte Seiteneffekte/Probleme überprüfen.
Ggf. versehentlich überschriebene Module/Templates aus der zuvor angefertigten Datensicherung zurückspielen.

##### Patch von WBCE 1.1.3 - 1.1.10

* Die Datei [wbce-patch-170212.zip](http://www.wbce.org/media/wbce-patch-170212.zip) herunterladen und lokal entpacken.
* Entpackte Dateien in den Root und die korrespondierenden Verzeichnisse (/admin, /include...) auf dem Server kopieren. Vorhandene Dateien überschreiben.
* Adresse der Website + /update\_db\_settings.php (deinedomain.tld/update\_db\_settings.php) aufrufen.
* Ggf. update\_db\_settings.php vom Server löschen (i.d.R. erfolgt dies aber automatisch).
* **Beachte:** Falls das Admin-Verzeichnis in der Installation umbenannt wurde, muss dies im Patch entsprechend angepasst werden.

Fragen oder Probleme bitte in unserem Forum posten (ggf. neuen Thread eröffnen).

**Bekannte Probleme**

* Modul Topics: Änderung der Überschriften Neuere/Ältere Themen nicht möglich, bitte ggf. auf [Topics 0.9.2](http://addons.wbce.org/pages/addons.php?do=item&item=8) updaten.
* Modul Droplets: Fehlerhafte Droplets führen unter PHP7 zu einem Absturz des Moduls. Als Workaround hilft derzeit nur, Zeile 268 der /modules/droplets/tools.php ( *return @eval('return true;' . $code);* ) auszukommentieren, d.h. dieser Zeile zwei Schrägstriche (//) voranzustellen (die Klammern nicht!).

*UPDATE 13.02.17 - Patch aktualisiert, Name des admin-Verzeichnisses wird in update\_db\_settings.php aus der Konstante ADMIN\_PATH gelesen und ist nicht mehr hart codiert.*

-- English --

**WBCE 1.1.11** is now available as [full installation package, update](http://www.wbce.org/media/WBCE-1.1.11.zip) and [patch](http://www.wbce.org/media/wbce-patch-170212.zip).

![8ung.png](https://forum.wbce.org/img/8ung.png)
**This release closes several severe and potential security issues.
Please update your website(s) IMMEDIATELY.**

##### New installation

* Please use only [version 1.1.11](http://www.wbce.org/media/WBCE-1.1.11.zip) from now on.
* Proceed as usual: unpack zip on your local machine and copy all contents of the folder /wbce (but not the folder itself) onto your server. Point your browser to yourwebsite.tld. The installation script starts automatically.
* System requirements: PHP >= 5.3.6, PHP 5.6 / 7.0 recommended. PHP 7.1 is not yet supported.

##### Update from WBCE < 1.1.3 / WebsiteBaker 2.8.x

* **Imortant!** Backup your server data (file system AND database). Make sure the backup is complete.
* Unzip the files from the [installation package](http://www.wbce.org/media/WBCE-1.1.11.zip) on your local machine. Copy the contents of the directory /wbce (but not the directory itself) except for config.php.new and the directory /install onto your server where the existing website is located. Make sure to overwite existing files. **Note:** If your admin directory is renamed, apply the rename onto the /admin directory in the patch package too.
* Point your browser to yourdomain.tld/upgrade-script.php. Confirm the messages and start upgrade script.

**ATTENTION:** During the upgrade possible changes and updates you made to core modules / templates will be overwritten. So it might be a good idea to test the update on a working copy first.
If changes were overwritten by mistake, copy the corresponding files from your backup back to the server.

##### Patch for WBCE 1.1.3 - 1.1.10

* Download [wbce-patch-170212.zip](http://www.wbce.org/media/wbce-patch-170212.zip) and unzip it to your local machine.
* Copy the contents of the zip into the root and the corresponsing folders (/admin, /include ...) of your existing website. Make sure to overwrite existing files.
* Point your browser to yourdomain.tld/update\_db\_settings.php.
* If necessary, remove update\_db\_settings.php from your server (usually this happens automatically).
* **Note:** In case you renamed your admin directory, you have to rename it in the patch package accordingly before updating the files.

**Known problems**

* Topics module: It is not possible to change the headlines for the see prev/next fields. Please update manually to [version 0.9.2](http://addons.wbce.org/pages/addons.php?do=item&item=8).
* Droplets module: Droplets with syntax error lead to a fatal error when running with PHP7. Workaround: comment out line 268 in the /modules/droplets/tools.php ( *return @eval('return true;' . $code);* ), e.g. place two slashes ( // ) at the beginnig of the line (not the brackets!).

Please post any questions or problems in our forum (don't hesitate to open a new thread).

*UPDATE 17/02/13 - updated update\_db\_settings.php, the name of the admin directory is not hardcoded any longer but taken from the constant ADMIN\_PATH.*

*Last edited by florian (13.02.2017 07:28:46)*

---

Sorgen sind wie Nudeln: man macht sich meist zu viele.

Offline

## #2 [12.02.2017 14:39:19](viewtopic.php?pid=9023#p9023)

**grindbatzn**
**Guest**

### Re: WBCE 1.1.11 Sicherheits-/Wartungsrelease | Security/Maintainance Rel.

Es gibt einen Fehler in update\_db\_settings.php (kommt 2x vor:

if (! (file\_exists('./config.php') and....

require './admin/interface/version.php';

admin muss nicht "*admin*" sein!

Jetzt wirds schwierig ;-)
require ADMIN\_DIRECTORY.'/interface/version.php';
Geht nur, wenn das schon als neuere WBCE Version installiert wurde.

Bei älteren Installationen gibt es define('ADMIN\_PATH', WB\_PATH.'/mein\_admin');

Und Kleinigkeit: Suc**c**essfully

*Last edited by grindbatzn (12.02.2017 14:45:39)*

## #3 [12.02.2017 14:44:09](viewtopic.php?pid=9024#p9024)

**florian**
**Administrator**

### Re: WBCE 1.1.11 Sicherheits-/Wartungsrelease | Security/Maintainance Rel.

Verstehe ich das richtig, der Fehler tritt aber nur auf, wenn /admin umbenannt wurde?

In dem Falle ist es das einfachste, von Hand die update\_db\_settings.php anzupassen, also die beiden Vokomnisse von
require './admin/interface/version.php';
durch
require './MeinGeheimesRedaktionsVerzeichnis/interface/version.php';
zu ersetzen und erst dann das Script auszuführen.

---

Sorgen sind wie Nudeln: man macht sich meist zu viele.

Offline

## #4 [12.02.2017 14:48:28](viewtopic.php?pid=9025#p9025)

**grindbatzn**
**Guest**

### Re: WBCE 1.1.11 Sicherheits-/Wartungsrelease | Security/Maintainance Rel.

Ja. Wenn das Verzeichnis /admin umbenannt wurde.
Also: nach '/admin/' suchen (ist 2x) und umbenennen.

Muss man natürlich auch im Patch das Verzeichnis umbenennen, bevor man hochlädt.

*Last edited by grindbatzn (12.02.2017 14:50:33)*

**Liked by:**

florian

## #5 [12.02.2017 21:14:31](viewtopic.php?pid=9046#p9046)

**cwsoft**
**Member**

### Re: WBCE 1.1.11 Sicherheits-/Wartungsrelease | Security/Maintainance Rel.

Ein [aktualisiertes Skript](https://github.com/WBCE/wbce_tools/blob/master/update_db_settings/update_db_settings.php) steht im wbce\_tools Repository zur Verfügung. Danke an grindbatzn für die Fehlermeldung.

---

Account inactive since 2018/11/17.

Offline

**Liked by:**

florian

Pages: **1**

* [Index](index.php)
* » [Archiv - Ankündigungen | Announcements](viewforum.php?id=73)
* » **[WBCE 1.1.11 Sicherheits-/Wartungsrelease | Security/Maintainance Rel.](viewtopic.php?id=977)**

## Board footer

Jump to

Welcome everybody | Willkommen
Ankündigungen | Announcements
Fragen zum Forum | Questions about this forum in general

Hilfe & Support Core & Backend
Entwicklung WBCE CMS Core+Backend
Core-Fehlerberichte
Outputfilter
WBCE Multilingual / Mehrsprachlichkeit
WBCE CMS Wunschzettel

Hilfe & Support zu Modulen
Modul-Tests und Fehlerberichte
Neue Module / Add-Ons
Modul-Wunschzettel

wbProfiles
MiniForm
News with Images, NWI Anywhere, NWI Blogmenu
CKEditor
Droplets
mpForm
OneForAll
Bakery
Leaflet Maps
DownloadGallery 3 WBCE
ProCalendar
Tiny Newsletter
Cookie Message / Cookie Consent

Fragen/Infos zu Templates
Neue Templates

Dienstleistungsangebote
Projektanfragen gegen Bezahlung

Allgemein zu WBCE CMS
Technische Fragen allgemein
Off-Topic

Core
Modules
News with images, NWI anywhere (Support EN)
Templates
General / Other

Archiv - Ankündigungen | Announcements
Archiv - Sicherheitshinweise | Security Advices
Archiv - Core-Fehlerberichte
Archiv - Hilfe & Support Core & Backend
Archiv - Hilfe & Support zu Modulen
Archiv - Module
Archiv - Itemz + Members
Archiv - Fragen zu Templates
Archiv - Responsive Folder Gallery (RFG)
Archiv - Topics
Archiv - WunderBlock
Archiv - Modul znip\_merkzettel

[RSS topic feed](extern.php?action=feed&tid=977&type=rss)

[![up](https://forum.wbce.org/img/up.png "up")](#top)


