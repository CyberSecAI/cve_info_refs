=== Content from tips.cs-cart.jp_930ebb3a_20250125_013441.html ===


[![](http://tips.cs-cart.jp/images/logos/1/cstips002.png)](http://tips.cs-cart.jp/)

* [TOP](http://tips.cs-cart.jp/)
* [インストール・初期設定](http://tips.cs-cart.jp/install-configuration/)
* [管理画面](http://tips.cs-cart.jp/admin-panel/)
* [ショップ画面](http://tips.cs-cart.jp/shopfront/)
* [デザイン](http://tips.cs-cart.jp/design-tips/)
* [アドオン](http://tips.cs-cart.jp/addons/)
* [セキュリティ](http://tips.cs-cart.jp/security/)
* [バグ修正](http://tips.cs-cart.jp/bugfix/)
* [その他・お知らせ](http://tips.cs-cart.jp/misc/)

[ホーム](http://tips.cs-cart.jp/)[セキュリティ](http://tips.cs-cart.jp/security/)【JVN#87770873】 2017年4月6日に公表されたCSRF脆弱性への対応方法

# 【JVN#87770873】 2017年4月6日に公表されたCSRF脆弱性への対応方法

カテゴリー : [セキュリティ](http://tips.cs-cart.jp/security/)
2017年04月06日 (木)

2017年4月6日、**特定の条件下でユーザーの意図しない注文が実行されるクロスサイトスクリプティングの脆弱性** が公表されました。

---

#### 対象バージョン

* **CS-Cartスタンダード版 v4.3系**
* **CS-Cartマーケットプレイス版 v4.3系**

※ 2017年3月31日16時以降に[CS-Cart.jp](https://cs-cart.jp)からダウンロードしたCS-Cartは対策済みのため対応不要です。

※ CS-Cartのバージョン確認方法は [こちら](http://tips.cs-cart.jp/check-version)

#### 脆弱性の内容と攻撃が成功するための条件

以下の条件を「すべて」充たした場合にユーザーの意図しない注文を実行される可能性があります。

* **CS-Cartにログインした状態で、同じWebブラウザで攻撃用スクリプトが実装されたWebサイトにアクセスする**
* **攻撃者が攻撃対象のCS-Cartで使用している支払方法のIDを事前に入手している**
* **攻撃に使用する支払方法が決済代行サービスを使用していない、またはユーザーのクレジットカード番号などを事前に入手している**

#### 危険度は低いが念のため対策を

前述のとおり、本脆弱性に対する攻撃を成功させるためには複数の条件を充たす必要があり、実際の被害を受ける可能性は極めて低いものと認識しています。

ただし、念のため以下の手順で対策を実施することをお勧めいたします。

#### 関数「fn\_csrf\_validate\_request」の編集

サーバー上の

***app/functions/fn.common.php***

に記述されている関数

***fn\_csrf\_validate\_request***

において

***if ($params['area'] == 'A' || ($params['area'] == 'C' && $params['controller'] == 'profiles')) {***

を

***if ($params['area'] == 'A' || ($params['area'] == 'C' && ($params['controller'] == 'profiles' || $params['controller'] == 'checkout'))) {***

に書き換えてください。

#### 謝辞

本脆弱性をご報告いただいた三井物産セキュアディレクション 廣田一貴様に対し、心より御礼申し上げます。ありがとうございました。

#### 連絡先

本脆弱性に関するお問い合わせは、以下のURLよりお寄せください。

<https://cscart.liveagent.jp/submit_ticket>

---

* [<< 前の記事 : 【JVN#14396697】 権限確認不備により他のユーザーの注文確認書を閲覧できる脆弱性について](http://tips.cs-cart.jp/fix-jvn-14396697.html)
* [次の記事 : 【JVN#25598952】 権限確認不備により他のユーザーの注文の返品申請を実施できる脆弱性について >>](http://tips.cs-cart.jp/fix-jvn-25598952.html)

### このサイトについて

CS-Cart Ver4の使い方や設定方法、カスタマイズ時のポイントなどについて、CS-Cart日本語版開発チームが解説します。

### 重要なお知らせ

[2024年3月15日に公表された脆弱性への対応方法](https://tips.cs-cart.jp/security-patch-03-2024.html)

[2024年1月31日に公表された脆弱性への対応方法](https://tips.cs-cart.jp/security-patch-01-2024.html)

[2023年8月23日に公表された脆弱性への対応方法](https://tips.cs-cart.jp/2023823-security-patch-082023.html)

[2022年9月14日に公表された脆弱性への対応方法](https://tips.cs-cart.jp/2022914-security-fixes-4xx-addon.html)

### 最新エントリー

* [【Paypal チェックアウト】複数出品者の商品を購入する際にエラーとなる問題を修正](http://tips.cs-cart.jp/paypal-checkout-multi-vendors.html)
* [【ペイジェント決済】3Dセキュア2.0一部項目必須化に対応する方法](http://tips.cs-cart.jp/paygent-3d2.0-reqired-field.html)
* [配送方法：ゆうパックにお届け時間帯「19時～21時」を追加する](http://tips.cs-cart.jp/jpost-19-21.html)

### 人気エントリー

* [キャッシュの種類とクリア方法](http://tips.cs-cart.jp/clear-cache.html)
* [トップページのタイトルを変更する方法](http://tips.cs-cart.jp/how-to-change-toppage-title.html)
* [CS-Cartのバージョンを確認する方法](http://tips.cs-cart.jp/check-version.html)

### カテゴリー

* [インストール・初期設定](http://tips.cs-cart.jp/install-configuration/)
* [管理画面](http://tips.cs-cart.jp/admin-panel/)
* [ショップ画面](http://tips.cs-cart.jp/shopfront/)
* [デザイン](http://tips.cs-cart.jp/design-tips/)
* [アドオン](http://tips.cs-cart.jp/addons/)
* [バグ修正](http://tips.cs-cart.jp/bugfix/)
* [その他・お知らせ](http://tips.cs-cart.jp/misc/)
* [セキュリティ](http://tips.cs-cart.jp/security/)

© 2014-2025 CS-Cart.jp.  Powered by [CS-Cart](http://www.cs-cart.jp)



=== Content from jvn.jp_e93aee7c_20250125_013443.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2017/04/10  Last Updated:2017/04/10
# JVN#87770873 CS-Cart Japanese Edition vulnerable to cross-site request forgery

## Overview

CS-Cart Japanese Edition contains a cross-site request forgery vulnerability.

## Products Affected

* CS-Cart Japanese Edition v4.3.10 and earlier (excluding v2 and v3)
* CS-Cart Multivendor Japanese Edition v4.3.10 and earlier (excluding v2 and v3)

## Description

âCS-Cart is a system for creating online shopping websites. CS-Cart Japanese Edition contains a cross-site request forgery ([CWE-352](//cwe.mitre.org/data/definitions/352.html)) vulnerability.

## Impact

If a consumer views a malicious page while logged in, an unintended item may be purchased.

## Solution

**Update the Software**

Update to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| Frogman Office Inc. | [Vulnerable](995892/index.html) | 2017/04/10 | [Frogman Office Inc. website](http://tips.cs-cart.jp/fix-csrf-20170406.html) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
Base Score:
4.3

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:H/Au:N/C:N/I:P/A:N
Base Score:
2.6

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Hirota Kazuki of Mitsui Bussan Secure Directions, Inc. reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2017-2138](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2138) |
| JVN iPedia | [JVNDB-2017-000057](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000057) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2017 JPCERT/CC and IPA. All rights reserved.


