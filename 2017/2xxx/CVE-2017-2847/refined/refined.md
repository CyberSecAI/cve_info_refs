- **Root cause of vulnerability**: The vulnerability is due to a lack of input sanitization in the `setIpInfo` command, specifically within the dns1 parameter, which allows for command injection when setting up the network interface.
- **Weaknesses/vulnerabilities present**: The primary weakness is the use of unsanitized user input (the dns1 parameter) directly in a `sprintf` call, which is then passed to `execlp`. This lack of sanitization allows for command injection.
- **Impact of exploitation**: An attacker can execute arbitrary system commands on the device by injecting malicious code into the dns1 parameter. This can lead to complete compromise of the device, including data theft, denial of service, or further network attacks.
- **Attack vectors**: The attack vector is through the web management interface of the Foscam camera. A malicious HTTP request to the `CGIProxy.fcgi` service with a crafted `setIpInfo` command and a malicious payload in the `dns1` parameter can trigger the vulnerability.
- **Required attacker capabilities/position**: An attacker needs to have network access to the device and a valid user account with administrator privileges to exploit this vulnerability.