Based on the provided documents, here's a breakdown of the vulnerability associated with CVE-2017-2168:

**Root Cause of Vulnerability:**
The vulnerability is a stored Cross-Site Scripting (XSS) issue in the WP Booking System WordPress plugin. This means that malicious scripts can be injected and stored within the plugin's data, which are then executed when a user views the affected content.

**Weaknesses/Vulnerabilities Present:**
- Stored Cross-Site Scripting (XSS): The plugin fails to properly sanitize user-supplied input, allowing an attacker to inject malicious JavaScript code.

**Impact of Exploitation:**
- Arbitrary script execution: A successful exploit allows an attacker to execute arbitrary JavaScript code within the browser of a logged-in administrator.
-  Potential for unauthorized actions:  The executed script can be used to perform actions on behalf of the administrator, such as creating new admin users, modifying data, or redirecting users to malicious sites.
-  Compromised integrity of the WordPress site: By injecting malicious code that is stored and executed within the plugin, attackers gain persistence and ongoing control over site functionality.

**Attack Vectors:**
- Network: The vulnerability is exploitable through the network, meaning an attacker can perform the attack remotely.
- User interaction: The user (administrator) needs to view the malicious content for the injected script to be executed.

**Required Attacker Capabilities/Position:**
- The attacker needs the ability to inject the malicious script within the plugin's data. This could be done through a form, a setting, or any input field where the plugin does not sanitize user-provided data. No user interaction is needed for the script injection.
- The attacker does not need privileges (unauthenticated) for the initial injection, but a user (administrator) needs to view the malicious content for the injected script to execute.

**Affected Products:**
- WP Booking System Free version prior to version 1.4
- WP Booking System Premium version prior to version 3.7

**Additional Information:**
- The vulnerability was reported by Satoshi Takagi of Cryptography Laboratory, Department of Information and Communication Engineering, Tokyo Denki University.
- The vulnerability has been fixed in version 1.4 and higher for the free version and 3.7 and higher for the premium version of the plugin.
- The plugin developers have been responsive in addressing the issue, providing updates and security improvements.