=== Content from jvn.jp_a07855fa_20250124_162502.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2017/02/09  Last Updated:2017/02/09
# JVN#34207650 Multiple cross-site scripting vulnerabilities in Webmin

## Overview

Webmin contains multiple cross-site scripting vulnerabilities.

## Products Affected

* Webmin versions prior to 1.830

## Description

Webmin contains multiple cross-site scripting vulnerabilities ([CWE-79](https://cwe.mitre.org/data/definitions/79.html)) due to issues in outputting error messages into a HTML page and the function to edit the database.

## Impact

An arbitrary script may be executed on the user's web browser.

## Solution

**Update the software**

Update to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| Webmin | [Strip out unsafe HTML from error messages](https://github.com/webmin/webmin/commit/475cc4fbdf51c865b291d252d81a58bad05de0c7) |
|  | [Downloads](http://www.webmin.com/download.html) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
Base Score:
6.1

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:M/Au:N/C:N/I:P/A:N
Base Score:
4.3

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Toshitsugu Yoneyama of Mitsui Bussan Secure Directions, Inc. reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2017-2106](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2106) |
| JVN iPedia | [JVNDB-2017-000022](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000022) |

## Update History

2017/02/09
Fixed link for JVN iPedia under Other Information

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2017 JPCERT/CC and IPA. All rights reserved.



=== Content from github.com_9e0164a2_20250124_162504.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwebmin%2Fwebmin%2Fcommit%2F475cc4fbdf51c865b291d252d81a58bad05de0c7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwebmin%2Fwebmin%2Fcommit%2F475cc4fbdf51c865b291d252d81a58bad05de0c7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=webmin%2Fwebmin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[webmin](/webmin)
/
**[webmin](/webmin/webmin)**
Public

* [Notifications](/login?return_to=%2Fwebmin%2Fwebmin) You must be signed in to change notification settings
* [Fork
  662](/login?return_to=%2Fwebmin%2Fwebmin)
* [Star
   4.6k](/login?return_to=%2Fwebmin%2Fwebmin)

* [Code](/webmin/webmin)
* [Issues
  490](/webmin/webmin/issues)
* [Pull requests
  28](/webmin/webmin/pulls)
* [Discussions](/webmin/webmin/discussions)
* [Actions](/webmin/webmin/actions)
* [Projects
  0](/webmin/webmin/projects)
* [Wiki](/webmin/webmin/wiki)
* [Security](/webmin/webmin/security)
* [Insights](/webmin/webmin/pulse)

Additional navigation options

* [Code](/webmin/webmin)
* [Issues](/webmin/webmin/issues)
* [Pull requests](/webmin/webmin/pulls)
* [Discussions](/webmin/webmin/discussions)
* [Actions](/webmin/webmin/actions)
* [Projects](/webmin/webmin/projects)
* [Wiki](/webmin/webmin/wiki)
* [Security](/webmin/webmin/security)
* [Insights](/webmin/webmin/pulse)

## Commit

[Permalink](/webmin/webmin/commit/475cc4fbdf51c865b291d252d81a58bad05de0c7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Strip out unsafe HTML from error messages

[Browse files](/webmin/webmin/tree/475cc4fbdf51c865b291d252d81a58bad05de0c7)
Browse the repository at this point in the history

* Loading branch information

[![@jcameron](https://avatars.githubusercontent.com/u/102706?s=40&v=4)](/jcameron)

[jcameron](/webmin/webmin/commits?author=jcameron "View all commits by jcameron")
committed
Oct 21, 2016

1 parent
[bb03124](/webmin/webmin/commit/bb0312469eae1eb8afa4c3746078d1ba82082988)

commit 475cc4f

Showing
**1 changed file**
with
**26 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

40 changes: 26 additions & 14 deletions

40
[miniserv.pl](#diff-9b33fd8f5603d4f0d1428689bc36f24af4770608a22c0d92b7a8bcc522450dc6 "miniserv.pl")

Show comments

[View file](/webmin/webmin/blob/475cc4fbdf51c865b291d252d81a58bad05de0c7/miniserv.pl)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1254,15 +1254,16 @@ sub handle\_request |
|  |  | # check address against access list |
|  |  | if (@deny && &ip\_match($acptip, $localip, @deny) || |
|  |  | @allow && !&ip\_match($acptip, $localip, @allow)) { |
|  |  | &http\_error(403, "Access denied for $acptip"); |
|  |  | &http\_error(403, "Access denied for ".&html\_strip($acptip)); |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | if ($use\_libwrap) { |
|  |  | # Check address with TCP-wrappers |
|  |  | if (!hosts\_ctl($config{'pam'}, STRING\_UNKNOWN, |
|  |  | $acptip, STRING\_UNKNOWN)) { |
|  |  | &http\_error(403, "Access denied for $acptip by TCP wrappers"); |
|  |  | &http\_error(403, "Access denied for ".&html\_strip($acptip). |
|  |  | " by TCP wrappers"); |
|  |  | return 0; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1286,7 +1287,7 @@ sub handle\_request |
|  |  | } |
|  |  | else { |
|  |  | &http\_error(400, "Timeout", |
|  |  | "Waited for that $to seconds for start of headers"); |
|  |  | "Waited for $to seconds for start of headers"); |
|  |  | } |
|  |  | } |
|  |  | $checked\_timeout++; |
| Expand Down  Expand Up | | @@ -1413,11 +1414,12 @@ sub handle\_request |
|  |  | $header{$lastheader} .= $headline; |
|  |  | } |
|  |  | else { |
|  |  | &http\_error(400, "Bad Header $headline"); |
|  |  | &http\_error(400, "Bad Header ".&html\_strip($headline)); |
|  |  | } |
|  |  | if (&is\_bad\_header($header{$lastheader}, $lastheader)) { |
|  |  | delete($header{$lastheader}); |
|  |  | &http\_error(400, "Bad Header Contents $lastheader"); |
|  |  | &http\_error(400, "Bad Header Contents ". |
|  |  | &html\_strip($lastheader)); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -1524,7 +1526,7 @@ sub handle\_request |
|  |  |  |
|  |  | # Reject CONNECT request, which isn't supported |
|  |  | if ($method eq "CONNECT" || $method eq "TRACE") { |
|  |  | &http\_error(405, "Method $method is not supported"); |
|  |  | &http\_error(405, "Method ".&html\_strip($method)." is not supported"); |
|  |  | } |
|  |  |  |
|  |  | # work out accepted encodings |
| Expand Down  Expand Up | | @@ -1596,7 +1598,7 @@ sub handle\_request |
|  |  | } |
|  |  | } |
|  |  | if (!$davpath && ($method eq "SEARCH" || $method eq "PUT")) { |
|  |  | &http\_error(400, "Bad Request method $method"); |
|  |  | &http\_error(400, "Bad Request method ".&html\_strip($method)); |
|  |  | } |
|  |  |  |
|  |  | # Check for password if needed |
| Expand Down  Expand Up | | @@ -2016,15 +2018,17 @@ sub handle\_request |
|  |  | ($>, $<) = ($u[2], $u[2]); |
|  |  | } |
|  |  | else { |
|  |  | &http\_error(500, "Unix user $authuser does not exist"); |
|  |  | &http\_error(500, "Unix user ". |
|  |  | &html\_strip($authuser)." does not exist"); |
|  |  | return 0; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | # Check per-user IP access control |
|  |  | if (!&check\_user\_ip($baseauthuser)) { |
|  |  | &http\_error(403, "Access denied for $acptip for $baseauthuser"); |
|  |  | &http\_error(403, "Access denied for $acptip for ". |
|  |  | &html\_strip($baseauthuser)); |
|  |  | return 0; |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -2189,7 +2193,7 @@ sub handle\_request |
|  |  | # check filename against denyfile regexp |
|  |  | local $denyfile = $config{'denyfile'}; |
|  |  | if ($denyfile && $full =~ /$denyfile/) { |
|  |  | &http\_error(403, "Access denied to ".&html\_escape($page)); |
|  |  | &http\_error(403, "Access denied to ".&html\_strip($page)); |
|  |  | return 0; |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -2257,7 +2261,7 @@ sub handle\_request |
|  |  | $len = length($df); $rest = " "x(35-$len); |
|  |  | &write\_data(sprintf |
|  |  | "<a href=\"%s\">%-${len}.${len}s</a>$rest %-20.20s %-10.10s\n", |
|  |  | &urlize($df), &html\_escape($df), $fdate, $stbuf[7]); |
|  |  | &urlize($df), &html\_strip($df), $fdate, $stbuf[7]); |
|  |  | } |
|  |  | closedir(DIR); |
|  |  | &log\_request($loghost, $authuser, $reqline, $ok\_code, &byte\_count()); |
| Expand Down  Expand Up | | @@ -2654,7 +2658,7 @@ sub http\_error |
|  |  | &reset\_byte\_count(); |
|  |  | &write\_data("<h1>Error - $\_[1]</h1>\n"); |
|  |  | if ($\_[2]) { |
|  |  | &write\_data("<pre>$\_[2]</pre>\n"); |
|  |  | &write\_data("<p>$\_[2]</p>\n"); |
|  |  | } |
|  |  | } |
|  |  | &log\_request($loghost, $authuser, $reqline, $\_[0], &byte\_count()) |
| Expand Down  Expand Up | | @@ -2976,7 +2980,7 @@ sub read\_line |
|  |  | while(($idx = index($main::read\_buffer, "\n")) < 0) { |
|  |  | if (length($main::read\_buffer) > 100000 && !$nolimit) { |
|  |  | &http\_error(414, "Request too long", |
|  |  | "Received excessive line <pre>$main::read\_buffer</pre>"); |
|  |  | "Received excessive line <pre>".&html\_strip($main::read\_buffer)."</pre>"); |
|  |  | } |
|  |  |  |
|  |  | # need to read more.. |
| Expand Down  Expand Up | | @@ -5206,7 +5210,8 @@ sub handle\_dav\_request |
|  |  | } |
|  |  | } |
|  |  | else { |
|  |  | &http\_error(500, "Unix user $authuser does not exist"); |
|  |  | &http\_error(500, "Unix user ".&html\_strip($authuser). |
|  |  | " does not exist"); |
|  |  | return 0; |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -6053,6 +6058,13 @@ sub html\_escape |
|  |  | return $tmp; |
|  |  | } |
|  |  |  |
|  |  | sub html\_strip |
|  |  | { |
|  |  | my ($tmp) = @\_; |
|  |  | $tmp =~ s/<[^>]\*>//g; |
|  |  | return $tmp; |
|  |  | } |
|  |  |  |
|  |  | # validate\_twofactor(username, token) |
|  |  | # Checks if a user's two-factor token is valid or not. Returns undef on success |
|  |  | # or the error message on failure. |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `475cc4f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwebmin%2Fwebmin%2Fcommit%2F475cc4fbdf51c865b291d252d81a58bad05de0c7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


