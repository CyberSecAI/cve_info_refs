- **Root cause of vulnerability:** The `appid` parameter, received from a multipart request, is directly passed to the `system` call within the `/api/CONFIG/restore` API handler without any sanitization.
- **Weaknesses/vulnerabilities present:** Command injection vulnerability due to the lack of input sanitization of the `appid` parameter before being used in a `system` call.
- **Impact of exploitation:** An attacker can execute arbitrary OS commands on the device. The provided proof-of-concept demonstrates execution of the "power_down.sh" script, but other commands are also possible, allowing for a full compromise of the device.
- **Attack vectors:** The attacker sends a specially crafted HTTP request to the `/api/CONFIG/restore` endpoint. The request includes a valid token for authentication and a crafted `appid` parameter containing the malicious OS commands.
- **Required attacker capabilities/position:**
    - The attacker needs to be able to send HTTP requests to the vulnerable device.
    - The attacker must have a valid authentication token to access the `/api/CONFIG/restore` endpoint.
    - The attacker needs knowledge of the API to craft the malicious request.