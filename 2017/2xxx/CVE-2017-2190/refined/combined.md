=== Content from jvn.jp_ccdf1731_20250124_175020.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2017/06/01  Last Updated:2017/08/23
# JVN#51274854 Multiple software for Sharp IC Card Reader/Writer Devices may insecurely load Dynamic Link Libraries

## Overview

The tool to verify execution environment and the driver installer for Sharp IC Card Reader/Writer devices may insecurely load Dynamic Link Libraries.

## Products Affected

* RW-4040 driver installer for Windows 7 version 2.27A (RW4040V2.27\_A\_win7V.exe) and earlier - CVE-2017-2189
* RW-5100 driver installer for Windows 7 version 1.0.0.9A (RW5100V1.0.0.9\_A\_win.exe) and earlier - CVE-2017-2191
* RW-5100 driver installer for Windows 8.1 version 1.0.1.0A (RW5100V1.0.1.0\_A\_win8.exe) and earlier - CVE-2017-2191
* RW-4040 tool to verify execution environment for Windows 7 version 1.2.0.0A (RW4040Test\_A\_win7V.exe) and earlier - CVE-2017-2190
* RW-5100 tool to verify execution environment for Windows 7 version 1.1.0.0A (RW5100Test\_A\_win7.exe) and earlier - CVE-2017-2192
* RW-5100 tool to verify execution environment for Windows 8.1 version 1.2.0.0A (RW5100Test\_A\_win8.exe) and earlier - CVE-2017-2192

## Description

The tool to verify execution environment and the driver installer for IC Card Reader/Writer devices provided by Sharp Corporation contain an issue with the DLL search path, which may lead to insecurely load Dynamic Link Libraries ([CWE-427](https://cwe.mitre.org/data/definitions/427.html)).

## Impact

Arbitrary code may be executed with the privilege of the user invoking the tool or the installer.

## Solution

**Use the latest installer**

Use the latest installer according to the information provided by the developer.

The following versions address the issue.

* RW-4040 driver installer for Windows 7 version 2.2.7.1 (RW40Inst.exe)
* RW-5100 driver installer for Windows 7 version 1.2.0.0 (RW51Inst.exe)
* RW-5100 driver installer for Windows 8.1 version 1.2.0.0 (RW51Inst.exe)

Users who already have installed the driver software do not need to re-install the software, because this issue affects the installers only.

**Use the latest version of the tool to verify execution environment**

Use the latest version of the tool according to the information provided by the developer.

The following versions address the issue.

* RW-4040 tool to verify execution environment for Windows 7 version 1.3.0.0 (RW4040Test\_win7.exe)
* RW-5100 tool to verify execution environment for Windows 7 version 1.2.0.0 (RW5100Test\_win7.exe)
* RW-5100 tool to verify execution environment for Windows 8.1 version 1.2.1.0 (RW5100Test\_win8.1.exe)

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| Sharp Corporation | [Vulnerable](433527/index.html) | 2017/06/01 | [Sharp Corporation website](http://www.sharp.co.jp/support/iccrw/index.html) |

## References

1. [Japan Vulnerability Notes JVNTA#91240916](https://jvn.jp/en/ta/JVNTA91240916/)
   Insecure DLL Loading and Command Execution Issues on Many Windows Application Programs

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
Base Score:
7.8

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:M/Au:N/C:P/I:P/A:P
Base Score:
6.8

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Comment

This analysis assumes that the user is tricked into placing a malicious DLL file prepared by an attacker in a specific folder.

## Credit

Yuji Tounai of NTT Communications Corporation and BlackWingCat of PinkFlyingWhale reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2017-2189](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2189) |
|  | [CVE-2017-2190](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2190) |
|  | [CVE-2017-2191](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2191) |
|  | [CVE-2017-2192](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2192) |
| JVN iPedia | [JVNDB-2017-000104](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000104) |
|  | [JVNDB-2017-000105](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000105) |
|  | [JVNDB-2017-000106](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000106) |
|  | [JVNDB-2017-000107](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000107) |

## Update History

2017/06/01
Added CVE IDs to "Products Affected"
2017/08/23
Information under [Products Affected] and [Solution] was modified, and [Credit] was updated

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2017 JPCERT/CC and IPA. All rights reserved.


