=== Content from security.gentoo.org_d5455270_20250125_172800.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# libofx: Multiple vulnerabilities — GLSA **201908-26**

Multiple vulnerabilities have been found in libofx, the worst of
which could result in the arbitrary execution of code.

### Affected packages

| Package | **dev-libs/libofx** on all architectures |
| --- | --- |
| Affected versions | < **0.9.14** |
| Unaffected versions | >= **0.9.14** |

### Background

A library to support the Open Financial eXchange XML format

### Description

Multiple vulnerabilities have been discovered in libofx. Please review
the CVE identifiers referenced below for details.

### Impact

A remote attacker could entice a user to process a specially crafted
file using an application linked against libofx, possibly resulting in
execution of arbitrary code with the privileges of the process or a
Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All libofx users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-libs/libofx-0.9.14"

```
### References

* [CVE-2017-14731](https://nvd.nist.gov/vuln/detail/CVE-2017-14731)
* [CVE-2017-2816](https://nvd.nist.gov/vuln/detail/CVE-2017-2816)
* [CVE-2017-2920](https://nvd.nist.gov/vuln/detail/CVE-2017-2920)

**Release date**

August 31, 2019

**Latest revision**

August 31, 2019: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [631304](https://bugs.gentoo.org/show_bug.cgi?id=631304)
* [636062](https://bugs.gentoo.org/show_bug.cgi?id=636062)
* [662910](https://bugs.gentoo.org/show_bug.cgi?id=662910)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.talosintelligence.com_d0842f93_20250125_172801.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2017-0317

## LibOFX Tag Parsing Code Execution Vulnerability

##### September 13, 2017

##### CVE Number

CVE-2017-2816

### Summary

An exploitable buffer overflow vulnerability exists in the tag parsing functionality of LibOFX 0.9.11. A specially crafted OFX file can cause a write out of bounds resulting in a buffer overflow on the stack. An attacker can construct a malicious OFX file to trigger this vulnerability.

### Tested Versions

LibOFX 0.9.11

### Product URLs

<https://github.com/libofx/libofx>

### CVSSv3 Score

8.8 - CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### CWE

CWE-120 - Buffer Copy without Checking Size of Input (‘Classic Buffer Overflow’)

### Details

OFX is the Open Financial Exchange format used by financial institutions to share financial data with clients. GnuCash is an open source financial-accounting software that has the capability to import OFX records using libOFX, an open source implementation of OFX.

While parsing the tags of the given OFX record, libOFX attempts to strip any present OFX proprietary tags. After checking that the file begins with the correct OFX tag of `<OFX>`, the remaining tag is sent over to be sanitized by `sanitize_proprietary_tags`. In this function, the tag is copied into a local stack variable called `tagname` as long as the parser is still within the opening tag [0].

```
lib/ofx_preproc.cpp:75
const unsigned int READ_BUFFER_SIZE = 1024;

lib/ofx_preproc.cpp:417
string sanitize_proprietary_tags(string input_string)
{
unsigned int i;
size_t input_string_size;
bool strip = false;
bool tag_open = false;
int tag_open_idx = 0; //Are we within < > ?
bool closing_tag_open = false; //Are we within </ > ?
int orig_tag_open_idx = 0;
bool proprietary_tag = false; //Are we within a proprietary element?
bool proprietary_closing_tag = false;
int crop_end_idx = 0;
char buffer[READ_BUFFER_SIZE] = "";
char tagname[READ_BUFFER_SIZE] = "";
int tagname_idx = 0;
char close_tagname[READ_BUFFER_SIZE] = "";

for (i = 0; i < input_string_size; i++)

    if (input_string.c_str()[i] == '<')
    {
    tag_open = true;
    tag_open_idx = i;
    if (proprietary_tag == true && input_string.c_str()[i+1] == '/')
    {
        ...
    }
    else if (proprietary_tag == true)
    {
        //It is the start of a new tag, following a proprietary tag
        crop_end_idx = i - 1;
        strip = true;
    }
    }
    else if (input_string.c_str()[i] == '>')
    {
        ...
    }
    else if (tag_open == true && closing_tag_open == false)
    {
    if (input_string.c_str()[i] == '.')
    {
        if (proprietary_tag != true)
        {
        orig_tag_open_idx = tag_open_idx;
        proprietary_tag = true;
        }
    }
    tagname[tagname_idx] = input_string.c_str()[i]; [0]
    tagname_idx++;

```

Because the loop occurs over the size of the `input_string`, if the `input_string` is larger than `READ_BUFFER_SIZE`, then the stack variable is overflown and can potentially lead to code execution.

### Crash Information

```
==6542==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffffbb4260 at pc 0x7fab9d30ccc1 bp 0x7fffffbb39b0 sp 0x7fffffbb39a8
WRITE of size 1 at 0x7fffffbb4260 thread T0
	#0 0x7fab9d30ccc0  (/home/vagrant/fuzzing/libofx-asan/libofx-0.9.11/lib/.libs/libofx.so.7+0x30cc0)
	#1 0x7fab9d30aba0  (/home/vagrant/fuzzing/libofx-asan/libofx-0.9.11/lib/.libs/libofx.so.7+0x2eba0)
	#2 0x7fab9d3057cb  (/home/vagrant/fuzzing/libofx-asan/libofx-0.9.11/lib/.libs/libofx.so.7+0x297cb)
	#3 0x4f8ba2  (/home/vagrant/fuzzing/libofx-asan/libofx-0.9.11/ofxdump/.libs/lt-ofxdump+0x4f8ba2)
	#4 0x7fab9c06982f  (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
	#5 0x419618  (/home/vagrant/fuzzing/libofx-asan/libofx-0.9.11/ofxdump/.libs/lt-ofxdump+0x419618)

Address 0x7fffffbb4260 is located in stack of thread T0 at offset 2208 in frame
	#0 0x7fab9d30c38f  (/home/vagrant/fuzzing/libofx-asan/libofx-0.9.11/lib/.libs/libofx.so.7+0x3038f)

This frame has 9 object(s):
	[32, 1056) 'buffer'
	[1184, 2208) 'tagname' <== Memory access at offset 2208 overflows this variable
	[2336, 3360) 'close_tagname'
	[3488, 3520) ''
	[3552, 3584) ''
	[3616, 3617) ''
	[3632, 3664) ''
	[3696, 3728) ''
	[3760, 3761) ''
HINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext
	(longjmp and C++ exceptions *are* supported)
SUMMARY: AddressSanitizer: stack-buffer-overflow (/home/vagrant/fuzzing/libofx-asan/libofx-
    0.9.11/lib/.libs/libofx.so.7+0x30cc0)
Shadow bytes around the buggy address:
0x10007ff6e7f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x10007ff6e800: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x10007ff6e810: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x10007ff6e820: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x10007ff6e830: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x10007ff6e840: 00 00 00 00 00 00 00 00 00 00 00 00[f2]f2 f2 f2
0x10007ff6e850: f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 f2 00 00 00 00
0x10007ff6e860: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x10007ff6e870: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x10007ff6e880: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x10007ff6e890: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable:           00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone:       fa
Heap right redzone:      fb
Freed heap region:       fd
Stack left redzone:      f1
Stack mid redzone:       f2
Stack right redzone:     f3
Stack partial redzone:   f4
Stack after return:      f5
Stack use after scope:   f8
Global redzone:          f9
Global init order:       f6
Poisoned by user:        f7
Container overflow:      fc
Array cookie:            ac
Intra object redzone:    bb
ASan internal:           fe
Left alloca redzone:     ca
Right alloca redzone:    cb
==6542==ABORTING

```
### Timeline

2017-04-14 - Vendor Disclosure

2017-09-13 - Public Release

##### Credit

Discovered by Cory Duplantis of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2017-0305](/vulnerability_reports/TALOS-2017-0305) [Previous Report

TALOS-2017-0431](/vulnerability_reports/TALOS-2017-0431)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from lists.debian.org_9d92b990_20250125_172800.html ===


---

[[Date Prev](msg00037.html)][[Date Next](msg00039.html)]
[[Thread Prev](msg00037.html)][[Thread Next](msg00039.html)]
[[Date Index](maillist.html#00038)]
[[Thread Index](threads.html#00038)]

# [SECURITY] [DLA 1192-1] libofx security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1192-1] libofx security update
* *From*: Thorsten Alteholz <debian@alteholz.de>
* *Date*: Sun, 26 Nov 2017 16:58:53 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/alpine.DEB.2.02.1711261657580.30566%40jupiter.server.alteholz.net) [alpine.DEB.2.02.1711261657580.30566@jupiter.server.alteholz.net](msg00038.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : libofx
Version        : 1:0.9.4-2.1+deb7u1
CVE ID         : CVE-2017-2816 CVE-2017-14731

CVE-2017-2816
     An exploitable buffer overflow vulnerability exists in the tag
     parsing functionality of LibOFX 0.9.11. A specially crafted OFX
     file can cause a write out of bounds resulting in a buffer
     overflow on the stack. An attacker can construct a malicious
     OFX file to trigger this vulnerability.

CVE-2017-14731
     ofx_proc_file in ofx_preproc.cpp allows remote attackers to cause
     a denial of service (heap-based buffer over-read and application
     crash) via a crafted file

For Debian 7 "Wheezy", these problems have been fixed in version
1:0.9.4-2.1+deb7u1.

We recommend that you upgrade your libofx packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQJ8BAEBCgBmBQJaGuS9XxSAAAAAAC4AKGlzc3Vlci1mcHJAbm90YXRpb25zLm9w
ZW5wZ3AuZmlmdGhob3JzZW1hbi5uZXQ2MjAxRkJGRkRCQkRFMDc4MjJFQUJCOTY5
NkZDQUMwRDM4N0I1ODQ3AAoJEJb8rA04e1hHECsQAJNPPpAriX7lf7IJMgmzpldA
sLL785ZLv2soC7UTfxhWM7+zoC/3+qXIrDkcBMlJak+cgaLBgtk47H9XhIc2iuRQ
ZlCljZJ6a0kpolDjX9pWcZXyb7n/VefUTuFGVBagK/ixRZOTUXJ5Y4xnuTTXHyEJ
Yvr6BrkvJIlcXThFAuYgtitHhZm2ilTLWhzjbbz7qBVEj91ebxYJHzXiDhuvgRDx
JWM8rPFoK+Vi7+U3MciQgD9tpmpxcVVNZ16cTJ00IrJzG3hQ+IsTQ5rB2NwtOpLq
IUhMdvQbAe5Fokqw7mvAOOks+mutAI67EF/dlampXohMglBqt1CWPmgkxliwI9am
KLYOs6r2aJUdlBj5+XDBEcJnLe/Q/sxPSvU7/8yuvIRufs57NaTo9OhXvCcwWeKl
qaOzH1+i8OxgXUwXtGggiH6YkkWEu1oLGd1StoeApC317VwTWP8ugovmC9jJE3hV
qiTvOvDFhnGgUOqLdPxpln3V2d+6WMuS7lvMs+MFL/GCeQCiY4NBcrTuFai2FaMH
okH3OvQd5oADa22EK+8UgCHhYozpftknoIJ4g3tpSCzQ0q/DLttAr1YpKRGRIfx2
kGElvcVrfyDagXjEv32JnJ93f3syrUjzMjgNvCMumc/8+cYHOSds8ySPb/ZIoDDI
NKvzLaTTD6YkxpFv1EyC
=iWcX
-----END PGP SIGNATURE-----

```

---


