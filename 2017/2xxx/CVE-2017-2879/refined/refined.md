- **Root cause of vulnerability**: A stack-based buffer overflow exists in the UPnP implementation of the Foscam C1 IP camera due to the usage of `sprintf` to construct an HTTP request without proper bounds checking. The control URL is extracted from a UPnP response, tokenized, and then used in the `sprintf` call. The lack of length validation on the input to `sprintf` leads to a buffer overflow when a malicious, overlong control URL is provided.
- **Weaknesses/vulnerabilities present**: Stack-based buffer overflow (CWE-121) due to unbounded `sprintf`.
- **Impact of exploitation**: Arbitrary code execution or denial of service, as demonstrated by the provided proof-of-concept which causes a crash. Overwriting return address to gain control over the program execution flow
- **Attack vectors**: The vulnerability can be triggered by an attacker on the same local subnet, responding to the camera's UPnP discovery message with a crafted response containing an overlong control URL.
- **Required attacker capabilities/position**: The attacker must be on the same subnet as the vulnerable Foscam camera and be able to send UDP packets to port 1900. An attacker must reply to an M-SEARCH discovery message to trigger this vulnerability.