=== Content from jvn.jp_7d36597e_20250124_141044.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2017/06/28  Last Updated:2018/01/09
# JVN#79451345 Installer of Setup file of advance preparation for e-Tax software (WEB version) may insecurely load Dynamic Link Libraries

## Overview

Installer of Setup file of advance preparation for e-Tax software (WEB version) provided by National Tax Agency may insecurely load Dinamic Link Libraries.

## Products Affected

* Setup file of advance preparation for e-Tax software (WEB version) all versions distributed on the NTA website prior to 2018 January 4

ãUpdated on 2017 July 5ã

This advisory was first published on 2017 June 26.  At that point it was stated that the affected product was version 1.17.0, and updating to version 1.17.1 was the solution.  However on 2017 July 3, it was confirmed the fix for this vulnerability incorporated in version 1.17.1 was not complete and the reported vulnerability still exists.

Therefore, the description of  the affected versions was modified to "1.17.1 and earlier".

ãUpdated on 2018 January 9ã

National Tax Agency released the update that contains a fix for this vulnerability on 2018 January 4.  Therefore, the description of the affected versions was modified to "Setup file of advance preparation for e-Tax software (WEB version) all versions distributed on the NTA website prior to 2018 January 4".

## Description

Installer of Setup file of advance preparation for e-Tax software (WEB version) provided by National Tax Agency contains an issue with the DLL search path, which may lead to insecurely loading Dynamic Link Libraries.

## Impact

Arbitrary code may be executed with the privilege of the user invoking the installer.

## Solution

**Use the latest installer for the first-time installation or for updating the application**

Users who have downloaded and obtained "Setup file of advance preparation for e-Tax software (WEB version)" distributed on the NTA website prior to 2018 January 4, be sure to delete it.

When installing or updating "Setup file of advance preparation for e-Tax software (WEB version)", execute the installer by following the instructions below.

* Download the latest "Setup file of advance preparation for e-Tax software (WEB version)" released on 2018 January 4 from the NTA website.
* Check and see if there are no suspicious files in the folder where the installer resides before executing the installer.

Users who already have installed "Setup file of advance preparation for e-Tax software (WEB version)" do not need to re-install the application, because this issue affects the installer only.

## Vendor Status

| Vendor | Link |
| --- | --- |
| National Tax Agency | [How to use Setup file of advance preparation for e-Tax software (WEB version) -- Stepâ£ Setup file of advance preparation for e-Tax software (WEB version)](http://www.e-tax.nta.go.jp/e-taxsoftweb/e-taxsoftweb1.htm#Link4) |
|  | [Steps and cautions when executing the installer](http://www.e-tax.nta.go.jp/manual/install_tejun.pdf) |
|  | [About the release of respective applications installers](http://www.e-tax.nta.go.jp/topics/topics_300104.htm) |

## References

1. [Japan Vulnerability Notes JVNTA#91240916](https://jvn.jp/en/ta/JVNTA91240916/)
   Insecure DLL Loading and Command Execution Issues on Many Windows Application Programs

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
Base Score:
7.8

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:M/Au:N/C:P/I:P/A:P
Base Score:
6.8

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Comment

This analysis assumes that the user is tricked into placing a malicious DLL file prepared by an attacker in a specific folder.

## Credit

BlackWingCat of Pink Flying Whale reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2017-2226](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2226) |
| JVN iPedia | [JVNDB-2017-000145](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000145) |

## Update History

2017/07/05
Information under [Product Affected] and [Solution] was modified.
2018/01/09
Information under [Product Affected] and [Solution] was modified, and a link under [Vendor Information] was added.

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2018 JPCERT/CC and IPA. All rights reserved.


