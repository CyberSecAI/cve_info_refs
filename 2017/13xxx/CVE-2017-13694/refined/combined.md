=== Content from github.com_8b9b3a36_20250126_042351.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-cc4x-9vpx-cphw)

**CVE-2017-13694**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-cc4x-9vpx-cphw)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2017-13694](/advisories/GHSA-cc4x-9vpx-cphw)

## The acpi\_ps\_complete\_final\_op() function in drivers/acpi...

Moderate severity

Unreviewed

Published
May 17, 2022
to the GitHub Advisory Database
â€¢
Updated Feb 3, 2023

## Package

No package listedâ€”
[Suggest a package](/advisories/GHSA-cc4x-9vpx-cphw/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

The acpi\_ps\_complete\_final\_op() function in drivers/acpi/acpica/psobject.c in the Linux kernel through 4.12.9 does not flush the node and node\_ext caches and causes a kernel stack dump, which allows local users to obtain sensitive information from kernel memory and bypass the KASLR protection mechanism (in the kernel through 4.9) via a crafted ACPI table.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2017-13694>
* [acpica/acpica@4a0243e](https://github.com/acpica/acpica/commit/4a0243ecb4c94e2d73510d096c5ea4d0711fc6c0)
* <https://patchwork.kernel.org/patch/9806085/>
* <http://www.securityfocus.com/bid/100500>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2017-13694)
Aug 25, 2017

Published to the GitHub Advisory Database
May 17, 2022

Last updated
Feb 3, 2023

### Severity

Moderate

5.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

### EPSS score

0.042%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (5th percentile)

### Weaknesses

[CWE-200](/advisories?query=cwe%3A200)

### CVE ID

CVE-2017-13694

### GHSA ID

GHSA-cc4x-9vpx-cphw

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-cc4x-9vpx-cphw/improve).

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from avatars.githubusercontent.com_9631c9d9_20250126_042350.html ===
ï¿½ï¿½ï¿½ï¿½ JFIF  ` `  ï¿½ï¿½ ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
ï¿½ï¿½ C 



ï¿½ï¿½ C  

ï¿½ï¿½  P P" ï¿½ï¿½           
ï¿½ï¿½ ï¿½   } !1AQa"q2ï¿½ï¿½ï¿½#Bï¿½ï¿½Rï¿½ï¿½$3brï¿½
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½        
ï¿½ï¿½ ï¿½  w !1AQaq"2ï¿½Bï¿½ï¿½ï¿½ï¿½ #3Rï¿½brï¿½
$4ï¿½%ï¿½&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½   ? ï¿½ï¿½Aï¿½m/#ï¿½ï¿½ï¿½L\ï¿½ï¿½|ï¿½ï¿½ï¿½ï¿½ZÈ¹ï¿½aï¿½Ş›}ï¿½ï¿½Yï¿½ï¿½Õ§ï¿½ï¿½dehï¿½>ï¿½psï¿½psï¿½ï¿½>ï¿½Nï¿½ï¿½ï¿½+Hï¿½ï¿½6ï¿½ï¿½:%ï¿½pï¿½\K=ï¿½ï¿½bï¿½Ì mDï¿½ï¿½ï¿½}ï¿½ï¿½{Kpï¿½ï¿½Xï¿½ï¿½Fï¿½ï¿½ï¿½Aï¿½\*ï¿½Âï¿½ï¿½ï¿½.ï¿½É®4-Oï¿½Sï¿½!ï¿½Ô³ï¿½!ï¿½ï¿½VU\aï¿½gï¿½FM~x~ÏŸï¿½Oï¿½ï¿½5ï¿½ï¿½ï¿½Ô®ï¿½lndX/ï¿½ï¿½Rï¿½ï¿½'ï¿½ï¿½ï¿½ï¿½>ï¿½ï¿½ï¿½ï¿½?ï¿½ï¿½ï¿½5ï¿½ÔšVï¿½mozcï¿½Jï¿½iï¿½yH!Bï¿½ï¿½ï¿½bÄ¨ï¿½r5ï¿½:ï¿½ï¿½ï¿½wï¿½ï¿½ï¿½|gï¿½ï¿½ï¿½ï¿½'ï¿½ï¿½ï¿½ï¿½Gï¿½aï¿½ã´Vï¿½IoZï¿½mdeï¿½t<ï¿½+ï¿½ï¿½/|8ï¿½mï¿½j2É¦\_]xfm>Ù’ï¿½ï¿½Û‰g/ï¿½ï¿½ï¿½pï¿½I9+ï¿½kï¿½gï¿½4ï¿½ï¿½ï¿½ï¿½#I7lï¿½ï¿½`ï¿½ï¿½ï¿½#+}ï¿½Gï¿½Xp'ï¿½ï¿½>ï¿½ï¿½ï¿½nï¿½wâ¥·ï¿½Mï¿½-Y,ï¿½A$ï¿½Gï¿½2ï¿½Ğœï¿½ï¿½qï¿½%ï¿½{
ï¿½=ï¿½ï¿½ï¿½Fï¿½Rï¿½ï¿½}cZï¿½!ï¿½yï¿½Tï¿½ï¿½ï¿½ï¿½s#ï¿½RIï¿½ï¿½rï¿½ï¿½c ï¿½}+ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ÇŠt=?Iï¿½X!kï¿½ï¿½ ï¿½
4ï¿½ï¿½.ï¿½ï¿½\ï¿½Zï¿½
ï¿½ï¿½ï¿½ï¿½)/ï¿½ï¿½$ï¿½-Ì¯5ï¿½Ô‘:`ï¿½c`%ï¿½ï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ ï¿½oxSWÒ­oWG2.ï¿½ï¿½ï¿½ï¿½xï¿½ï¿½;7ï¿½ï¿½,ï¿½ï¿½;ï¿½Biniï¿½hxï¿½ï¿½ ï¿½ï¿½xï¿½ï¿½jQg~ï¿½+ï¿½+ï¿½Ö–p"ï¿½ï¿½ï¿½cï¿½ï¿½\_ï¿½Hï¿½ï¿½ï¿½
-ï¿½4ï¿½` #^ï¿½ï¿½qï¿½jï¿½ï¿½=ï¿½Qu{]Jï¿½6ï¿½ï¿½ï¿½x|ï¿½ï¿½ï¿½ï¿½bo)6ï¿½ï¿½ï¿½8BPKï¿½jxï¿½ï¿½ï¿½ï¿½ï¿½`Ñ˜ï¿½$uï¿½|ï¿½ã„ï¿½ï¿½ï¿½/ï¿½ï¿½-ï¿½ï¿½ï¿½ï¿½flvï¿½ï¿½sï¿½ ï¿½ï¿½ï¿½OQ6ï¿½uï¿½ï¿½on?ï¿½ï¿½ï¿½ï¿½ï¿½akï¿½ï¿½zfï¿½iSO!ï¿½'Üï¿½ï¿½Jï¿½Iï¿½ï¿½1ï¿½)Sï¿½'G^ï¿½ï¿½ï¿½ï¿½lxï¿½Nï¿½yï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½O ï¿½-~$ï¿½ï¿½ï¿½M4 ï¿½iï¿½?ï¿½mï¿½.0ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ ï¿½i'ï¿½ï¿½ï¿½?ï¿½ï¿½ï¿½~ï¿½|ï¿½Í«|7ï¿½Æï¿½Ç§AsgFï¿½ï¿½ï¿½ï¿½\*6ï¿½ fGRzï¿½nh)#ï¿½Û\*ï¿½M]#ï¿½ï¿½!ï¿½ï¿½ï¿½!tï¿½ï¿½î®µï¿½ï¿½Eï¿½Ctï¿½,ï¿½ï¿½ï¿½bï¿½ï¿½/îƒï¿½ï¿½Aï¿½Pï¿½ï¿½ï¿½ iï¿½ï¿½ï¿½Æ©}2ï¿½m[}]ï¿½ï¿½,9ï¿½8ï¿½TAï¿½ï¿½ï¿½ï¿½ï¿½bï¿½3ï¿½\_<7}ï¿½
M~xYgï¿½(ï¿½5ï¿½M+3ï¿½tï¿½ï¿½ï¿½zGï¿½ï¿½ï¿½ï¿½Xï¿½uï¿½jD!ï¿½au$Nï¿½Bï¿½ï¿½ {fï¿½ï¿½ï¿½ï¨XTï¿½qVGGï¿½/!Êï¿½:ï¿½ï¿½ï¿½ï¿½Vï¿½ÊŠï¿½Y%ï¿½Sï¿½BÅ¶ï¿½\ï¿½tï¿½&ï¿½ï¿½%ï¿½
=ï¿½
^ï¿½mï¿½ï¿½ï¿½Xï¿½ï¿½~j+Â¼gï¿½Jï¿½ï¿½'ï¿½ï¿½;9ï¿½ï¿½+ï¿½DSxlï¿½ï¿½m(^.ï¿½Î„ï¿½5sS[ï¿½ï¿½Kï¿½ï¿½@qï¿½4ï¿½` `8ï¿½k\_ï¿½ï¿½ï¿½cï¿½ï¿½cï¿½ï¿½ï¿½ï¿½$ï¿½åß¦ï¿½vï¿½^}sï¿½ï¿½ï¿½@ï¿½;ï¿½/ï¿½Ê„å½¸ï¿½ï¿½<ï¿½ Û—&K+ï¿½]zH#mï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½f\ï¿½nï¿½ï¿½ï¿½ï¿½ï¿½ï¿½k>ï¿½ï¿½ï¿½8ï¿½Pï¿½aï¿½ï¿½ï¿½ï¿½\*ï¿½á”ï¿½ï¿½Lï¿½ï¿½Zï¿½1ï¿½HÑ~ff#ï¿½ï¿½za^oqï¿½Xï¿½Íï¿½}@j@ï¿½)ï¿½Ñ·ï¿½ ï¿½ï¿½ï¿½cï¿½3]Ö‘ï¿½ï¿½jï¿½ï¿½ï¿½ï¿½9&ï¿½ï¿½qiï¿½ï¿½9ï¿½ï¿½ï¿½Zï¿½ï¿½;ï¿½ï¿½;`ï¿½ï¿½ï¿½ï¿½kfï¿½ï¿½ï¿½iaï¿½2p:ï¿½Zï¿½ï¿½ï¿½}ï¿½ï¿½ï¿½î¡†ï¿½(ï¿½<Nï¿½nï¿½21ï¿½Æ»ï¿½3ï¿½V7ZMï¿½ï¿½oï¿½ï¿½i!Vh|ï¿½Rï¿½G+×­}ï¿½<ï¿½ï¿½ï¿½ï¿½pï¿½ï¿½"ï¿½9? xï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½mï¿½Kï¿½549.$Ü¸Oï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ZÇ%ï¿½ï¿½ï¿½ï¿½-?È ï¿½q,ï¿½vï¿½=ï¿½ï¿½ï¿½ï¿½Bï¿½zD\_iï¿½E7c,ï¿½Qï¿½ï¿½8ï¿½ï¿½]Lzï¿½ï¿½ï¿½"xİï¿½+ï¿½ï¿½'sÇ²ï¿½ï¿½ Ñ‰%ï¿½{yï¿½0ï¿½ï¿½qï¿½~
ï¿½ï¿½ï¿½;Dyï¿½ï¿½onYï¿½ZBï¿½ #ï¿½ï¿½ï¿½5ï¿½ï¿½\*pï¿½mï¿½~eï¿½ï¿½Cwï¿½\_[$ï¿½ï¿½Û¤\*ï¿½ï¿½Lï¿½PROï¿½ï¿½ï¿½ï¿½tï¿½vï¿½ï¿½ERï¿½ï¿½ï¿½ï¿½cIï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ ï¿½ï¿½"ï¿½q#ï¿½ ï¿½ï¿½ï¿½q]vï¿½ï¿½Ku(ï¿½Oï¿½"ï¿½I~bï¿½Cd×™ï¿½\_ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½"ï¿½@ï¿½ï¿½ ï¿½ï¿½ï¿½:ï¿½gï¿½ï¿½ï¿½ï¿½)os<+ï¿½rxÏ±ï¿½ï¿½ï¿½4iï¿½rï¿½ï¿½gï¿½ï¿½F>sï¿½ï¿½Mï¿½ï¿½
ï¿½ï¿½4ï¿½×²ï¿½$ï¿½4 ï¿½ï¿½'ï¿½~ï¿½pï¿½ï¿½Fï¿½ï¿½zWï¿½ï¿½jzï¿½ï¿½4Bï¿½ï¿½iï¿½Gcpzï¿½ Ã­{Û»xï¿½@ï¿½9ï¿½ï¿½ÂŒgï¿½bz(ï¿½I=ï¿½|ï¿½ï¿½ï¿½ï¿½ï¿½}
ï¿½Ì®Õ‘ï¿½?ï¿½ï¿½kï¿½9-ï¿½yÅ¬vpï¿½ï¿½ï¿½oï¿½ï¿½cï¿½#ëŠ¹ï¿½ï¿½~ï¿½Eï¿½?ï¿½ï¿½İ½ï¿½ï¿½lï¿½ ï¿½ÏŸï¿½3ï¿½pï¿½ï¿½Okâ¯ˆï¿½ï¿½İ„ï¿½uï¿½L-ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Æ¹+Kï¿½)ï¿½lï¿½ï¿½?ï¿½ï¿½+ï¿½ï¿½Fï¿½ï¿½n|.&Jï¿½YN;Fï¿½vï¿½ï¿½F~#ï¿½1ï¿½IFn"VC!>fÜ!ï¿½ï¿½@}ï¿½ï¿½ï¿½×ï¿½ï¿½|#mï¿½Ceï¿½fï¿½<ï¿½41 ï¿½ï¿½ï¿½\1ï¿½Ñ·ï¿½<ï¿½ï¿½M[ï¿½ßˆ/ï¿½ï¿½ï¿½ï¿½ï¿½l-R9ï¿½ï¿½ï¿½ï¿½Ç‘ï¿½ï¿½Vï¿½?ï¿½5dï¿½ï¿½ï¿½gï¿½İ‚ï¿½×Œï¿½c[K6ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½{ï¿½ï¿½kï¿½[ï¿½ï¿½ï¿½;ï¿½8ï¿½ï¿½ï¿½?ï¿½?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½G2ï¿½[ï¿½ï¿½ï¿½ï¿½SR]ï¿½ï¿½ï¿½>ï¿½ï¿½<sQï¿½=9ï¿½tï¿½ï¿½ï¿½>ï¿½lï¿½|/V7gï¿½ï¿½jï¿½<ï¿½9xï¿½yï¿½Oï¿½|9ï¿½ï¿½/ï¿½ï¿½ï¿½Nï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Jï¿½ï¿½oFï¿½ï¿½ï¿½pï¿½ï¿½Aï¿½ï¿½ï¿½ï¿½ï¿½ï¿½zï¿½Wï¿½Sï¿½Nï¿½ï¿½==kï¿½ï¿½c9W,ï¿½+ï¿½U=ï¿½hï¿½ï¿½ï¿½

=== Content from patchwork.kernel.org_fc5f6c30_20250124_231722.html ===

Toggle navigation

[Patchwork](/)
Linux ACPI

* [Patches](/project/linux-acpi/list/)
* [Bundles](/project/linux-acpi/bundles/)
* [About this project](/project/linux-acpi/)

* [Login](/user/login/)
* [Register](/register/)
* [Mail settings](/mail/)

9806085

[diff](/project/linux-acpi/patch/1498210597-112293-1-git-send-email-kkamagui%40gmail.com/raw/ "Download patch diff")
[mbox](/project/linux-acpi/patch/1498210597-112293-1-git-send-email-kkamagui%40gmail.com/mbox/ "Download patch mbox")
# [V4] acpi: acpica: fix acpi parse and parseext cache leaks

| Message ID | 1498210597-112293-1-git-send-email-kkamagui@gmail.com ([mailing list archive](https://lore.kernel.org/r/1498210597-112293-1-git-send-email-kkamagui%40gmail.com)) |
| --- | --- |
| State | Not Applicable, archived |
| Headers | show ``` Return-Path: <linux-acpi-owner@kernel.org> Received: from mail.wl.linuxfoundation.org (pdx-wl-mail.web.codeaurora.org 	[172.30.200.125]) 	by pdx-korg-patchwork.web.codeaurora.org (Postfix) with ESMTP id 	35A9E6086C for <patchwork-linux-acpi@patchwork.kernel.org>; 	Fri, 23 Jun 2017 09:38:03 +0000 (UTC) Received: from mail.wl.linuxfoundation.org (localhost [127.0.0.1]) 	by mail.wl.linuxfoundation.org (Postfix) with ESMTP id 2643128542 	for <patchwork-linux-acpi@patchwork.kernel.org>; 	Fri, 23 Jun 2017 09:38:03 +0000 (UTC) Received: by mail.wl.linuxfoundation.org (Postfix, from userid 486) 	id 19A3F285D5; Fri, 23 Jun 2017 09:38:03 +0000 (UTC) X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on 	pdx-wl-mail.web.codeaurora.org X-Spam-Level:  X-Spam-Status: No, score=-6.8 required=2.0 tests=BAYES_00, 	DKIM_ADSP_CUSTOM_MED,  	DKIM_SIGNED, FREEMAIL_FROM, RCVD_IN_DNSWL_HI, 	T_DKIM_INVALID autolearn=ham version=3.3.1 Received: from vger.kernel.org (vger.kernel.org [209.132.180.67]) 	by mail.wl.linuxfoundation.org (Postfix) with ESMTP id 6344828542 	for <patchwork-linux-acpi@patchwork.kernel.org>; 	Fri, 23 Jun 2017 09:38:02 +0000 (UTC) Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand 	id S1754583AbdFWJiB (ORCPT 	<rfc822;patchwork-linux-acpi@patchwork.kernel.org>); 	Fri, 23 Jun 2017 05:38:01 -0400 Received: from mail-pf0-f194.google.com ([209.85.192.194]:34602 "EHLO 	mail-pf0-f194.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org 	with ESMTP id S1754457AbdFWJh7 (ORCPT 	<rfc822; linux-acpi@vger.kernel.org>); Fri, 23 Jun 2017 05:37:59 -0400 Received: by mail-pf0-f194.google.com with SMTP id d5so6614951pfe.1; 	Fri, 23 Jun 2017 02:37:59 -0700 (PDT) DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; 	d=gmail.com; s=20161025; 	h=from:to:cc:subject:date:message-id:mime-version 	:content-transfer-encoding; 	bh=hnAPpz2ToOIB94g6y/IPYSCL39qZFy2j7SX/EVwLt2s=; 	b=aEbf3C6sX0q1TwzSpLwks9/Ho6IO9FKc8Q5C/Bg0lRxdRf4RqgpbnHLCb1Who10yNq 	bohG0hkbA+v1JheRuk0nq7D9S3zq9kislKe+yxDHVxWKsoYILLypXIbH+HBixcXiv9H5 	8EKucN24i6Jpy2Lo29aU7oILxDMoPg9CfGNT5Hn6Z1UI3vP4ZkWVBpYnqGC0qe+0RLYP 	jlvXe5W9QWADsAe2a41VkvoIyy/Laz4PAQ687ZJ/577lrVY2roYoYgivJEB7GwSdmeu+ 	7/lfPpPv60foZg0U0mU4LeZYR6soXAkj5emvpj7fYXEuEXlskeBogxZRz8l2ybZZEXsh 	VUjg== X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; 	d=1e100.net; s=20161025; 	h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version 	:content-transfer-encoding; 	bh=hnAPpz2ToOIB94g6y/IPYSCL39qZFy2j7SX/EVwLt2s=; 	b=mUh2OhFwhHrxFHqTWcjNDYBgELMMb+yi6FLKolxjmqq9LFnFnZkPvMxoqhfni9acyk 	bOVWT+UZblyRREpzU0ATjrjRoOzUuPI2uyb4EIiQSwFkNfKMR79gbChqZNabeIPTLXJS 	KTS7XqG2kAIFs6bFufEwhnzd2q0+YCcRQEFow/9WequKeID7Ds3PooFCbyUqCGh9L2XW 	Fzt/zq2SWna0+nSD8jKYMb+VrR6IZbwbdNhCESRCW40Y0owFOnQPUJVei3AC1zgyZZDp 	yC3q3pohF8WSTrPrAHCAknGl43uxmlNPUasTUlVWgfvjzzO3Z/7r5knePld0eU/jk/Wh 	xdPg== X-Gm-Message-State: AKS2vOz7MGhS/XQwXrBV9ZAgekA1LtGbknocfP7UUQch5EWSfLa218I2 	2++2Stcew7QvbwUD0qk= X-Received: by 10.99.166.18 with SMTP id t18mr7067829pge.218.1498210678490;  	Fri, 23 Jun 2017 02:37:58 -0700 (PDT) Received: from localhost.localdomain ([175.203.71.232]) 	by smtp.gmail.com with ESMTPSA id 	b82sm8385632pfd.111.2017.06.23.02.37.55 	(version=TLS1_2 cipher=ECDHE-RSA-AES128-SHA bits=128/128); 	Fri, 23 Jun 2017 02:37:57 -0700 (PDT) From: Seunghun Han <kkamagui@gmail.com> To: lv.zheng@intel.com Cc: robert.moore@intel.com, rafael.j.wysocki@intel.com, 	linux-acpi@vger.kernel.org, devel@acpica.org, 	linux-kernel@vger.kernel.org, Seunghun Han <kkamagui@gmail.com> Subject: [PATCH V4] acpi: acpica: fix acpi parse and parseext cache leaks Date: Fri, 23 Jun 2017 18:36:37 +0900 Message-Id: <1498210597-112293-1-git-send-email-kkamagui@gmail.com> X-Mailer: git-send-email 2.1.4 MIME-Version: 1.0 Content-Type: text/plain; charset=UTF-8 Content-Transfer-Encoding: 8bit Sender: linux-acpi-owner@vger.kernel.org Precedence: bulk List-ID: <linux-acpi.vger.kernel.org> X-Mailing-List: linux-acpi@vger.kernel.org X-Virus-Scanned: ClamAV using ClamSMTP  ``` |

## Commit Message

[Seunghun Han](/project/linux-acpi/list/?submitter=172635)
June 23, 2017, 9:36 a.m. UTC
```

I'm Seunghun Han, and I work for National Security Research Institute of
South Korea.

I have been doing a research on ACPI and found an ACPI cache leak in ACPI
early abort cases.

Boot log of ACPI cache leak is as follows:
[    0.352414] ACPI: Added _OSI(Module Device)
[    0.353182] ACPI: Added _OSI(Processor Device)
[    0.353182] ACPI: Added _OSI(3.0 _SCP Extensions)
[    0.353182] ACPI: Added _OSI(Processor Aggregator Device)
[    0.356028] ACPI: Unable to start the ACPI Interpreter
[    0.356799] ACPI Error: Could not remove SCI handler (20170303/evmisc-281)
[    0.360215] kmem_cache_destroy Acpi-State: Slab cache still has objects
[    0.360648] CPU: 0 PID: 1 Comm: swapper/0 Tainted: G        W
4.12.0-rc4-next-20170608+ #10
[    0.361273] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS
VirtualBox 12/01/2006
[    0.361873] Call Trace:
[    0.362243]  ? dump_stack+0x5c/0x81
[    0.362591]  ? kmem_cache_destroy+0x1aa/0x1c0
[    0.362944]  ? acpi_sleep_proc_init+0x27/0x27
[    0.363296]  ? acpi_os_delete_cache+0xa/0x10
[    0.363646]  ? acpi_ut_delete_caches+0x6d/0x7b
[    0.364000]  ? acpi_terminate+0xa/0x14
[    0.364000]  ? acpi_init+0x2af/0x34f
[    0.364000]  ? __class_create+0x4c/0x80
[    0.364000]  ? video_setup+0x7f/0x7f
[    0.364000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.364000]  ? do_one_initcall+0x4e/0x1a0
[    0.364000]  ? kernel_init_freeable+0x189/0x20a
[    0.364000]  ? rest_init+0xc0/0xc0
[    0.364000]  ? kernel_init+0xa/0x100
[    0.364000]  ? ret_from_fork+0x25/0x30

I analyzed this memory leak in detail. I found that â€œAcpi-Stateâ€ cache and
â€œAcpi-Parseâ€ cache were merged because the size of cache objects was same
slab cache size.

I finally found â€œAcpi-Parseâ€ cache and â€œAcpi-ParseExtâ€ cache were leaked
using SLAB_NEVER_MERGE flag in kmem_cache_create() function.

Real ACPI cache leak point is as follows:
[    0.360101] ACPI: Added _OSI(Module Device)
[    0.360101] ACPI: Added _OSI(Processor Device)
[    0.360101] ACPI: Added _OSI(3.0 _SCP Extensions)
[    0.361043] ACPI: Added _OSI(Processor Aggregator Device)
[    0.364016] ACPI: Unable to start the ACPI Interpreter
[    0.365061] ACPI Error: Could not remove SCI handler (20170303/evmisc-281)
[    0.368174] kmem_cache_destroy Acpi-Parse: Slab cache still has objects
[    0.369332] CPU: 1 PID: 1 Comm: swapper/0 Tainted: G        W
4.12.0-rc4-next-20170608+ #8
[    0.371256] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS
VirtualBox 12/01/2006
[    0.372000] Call Trace:
[    0.372000]  ? dump_stack+0x5c/0x81
[    0.372000]  ? kmem_cache_destroy+0x1aa/0x1c0
[    0.372000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.372000]  ? acpi_os_delete_cache+0xa/0x10
[    0.372000]  ? acpi_ut_delete_caches+0x56/0x7b
[    0.372000]  ? acpi_terminate+0xa/0x14
[    0.372000]  ? acpi_init+0x2af/0x34f
[    0.372000]  ? __class_create+0x4c/0x80
[    0.372000]  ? video_setup+0x7f/0x7f
[    0.372000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.372000]  ? do_one_initcall+0x4e/0x1a0
[    0.372000]  ? kernel_init_freeable+0x189/0x20a
[    0.372000]  ? rest_init+0xc0/0xc0
[    0.372000]  ? kernel_init+0xa/0x100
[    0.372000]  ? ret_from_fork+0x25/0x30
[    0.388039] kmem_cache_destroy Acpi-ParseExt: Slab cache still has objects
[    0.389063] CPU: 1 PID: 1 Comm: swapper/0 Tainted: G        W
4.12.0-rc4-next-20170608+ #8
[    0.390557] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS
VirtualBox 12/01/2006
[    0.392000] Call Trace:
[    0.392000]  ? dump_stack+0x5c/0x81
[    0.392000]  ? kmem_cache_destroy+0x1aa/0x1c0
[    0.392000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.392000]  ? acpi_os_delete_cache+0xa/0x10
[    0.392000]  ? acpi_ut_delete_caches+0x6d/0x7b
[    0.392000]  ? acpi_terminate+0xa/0x14
[    0.392000]  ? acpi_init+0x2af/0x34f
[    0.392000]  ? __class_create+0x4c/0x80
[    0.392000]  ? video_setup+0x7f/0x7f
[    0.392000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.392000]  ? do_one_initcall+0x4e/0x1a0
[    0.392000]  ? kernel_init_freeable+0x189/0x20a
[    0.392000]  ? rest_init+0xc0/0xc0
[    0.392000]  ? kernel_init+0xa/0x100
[    0.392000]  ? ret_from_fork+0x25/0x30

When early abort is occurred due to invalid ACPI information, Linux kernel
terminates ACPI by calling acpi_terminate() function. The function calls
acpi_ut_delete_caches() function to delete local caches (acpi_gbl_namespace_
cache, state_cache, operand_cache, ps_node_cache, ps_node_ext_cache).

But the deletion codes in acpi_ut_delete_caches() function only delete
slab caches using kmem_cache_destroy() function, therefore the cache
objects should be flushed before acpi_ut_delete_caches() function.

â€œAcpi-Parseâ€ cache and â€œAcpi-ParseExtâ€ cache are used in an AML parse
function, acpi_ps_parse_loop(). The function should have flush codes to
handle an error state due to invalid AML codes.

This cache leak has a security threat because an old kernel (<= 4.9) shows
memory locations of kernel functions in stack dump. Some malicious users
could use this information to neutralize kernel ASLR.

To fix ACPI cache leak for enhancing security, I made a patch which has
flush codes in acpi_ps_parse_loop() function.

I hope that this patch improves the security of Linux kernel.

Thank you.
Signed-off-by: Seunghun Han <kkamagui@gmail.com>
---
Changes since v3: change control transfer according to reviewer's comments.
Changes since v2: merge flush code with existing code and change comments.
Changes since v1: move flush code to acpi_ps_complete_final_op() function.

 drivers/acpi/acpica/psobject.c | 53 +++++++++++++-----------------------------
 1 file changed, 16 insertions(+), 37 deletions(-)

```
## Comments

[Andy Shevchenko](/project/linux-acpi/list/?submitter=3211)
June 25, 2017, 4:13 p.m. UTC | [#1](/comment/20626053/)
```

On Fri, Jun 23, 2017 at 12:36 PM, Seunghun Han <kkamagui@gmail.com> wrote:
> I'm Seunghun Han, and I work for National Security Research Institute of
> South Korea.

> -                                       /* Clean up */
> -                                       do {
> -                                               if (op) {
> -                                                       status2 =
> -                                                           acpi_ps_complete_this_op
> -                                                           (walk_state, op);
> -                                                       if (ACPI_FAILURE
> -                                                           (status2)) {
> -                                                               return_ACPI_STATUS
> -                                                                   (status2);
> -                                                       }
> -                                               }
> -
> -                                               acpi_ps_pop_scope(&
> -                                                                 (walk_state->
> -                                                                  parser_state),
> -                                                                 &op,
> -                                                                 &walk_state->
> -                                                                 arg_types,
> -                                                                 &walk_state->
> -                                                                 arg_count);
> -
> -                                       } while (op);

I didn't get, do you send an incremental patch as a new version?!

```

[Seunghun Han](/project/linux-acpi/list/?submitter=172635)
June 26, 2017, 5:26 a.m. UTC | [#2](/comment/20626793/)
```

Hello, Andy.

Thank you for your reply.

Patch V4 is the last patch which is applied all changes from original code.
Due to maintainer's advice, Patch V1, V2, V3 have reverted and I made
the latest patch, Patch V4.
(the review is here, https://github.com/acpica/acpica/pull/278)

Therefore, it seems that incremental patch is not needed.

If you have any request, please let me know.

Best regards.

ps) I am sending email again after removing HTML part.

2017-06-26 7:12 GMT+09:00 Seunghun Han <kkamagui@gmail.com>:
> Hello, Andy.
>
> Thank you for your reply.
>
> Patch V4 is the last patch which is applied all changes from original code.
> Due to reviewer's advice, Patch V1, V2, V3 has reverted and I made the
> latest patch, Patch V4.
> Therefore, it seems that incremental patch is not needed.
>
> If you have any requests, please let me know.
>
> Best regards.
>
>
> 2017ë…„ 6ì›” 26ì¼ (ì›”) ì˜¤ì „ 1:13, Andy Shevchenko <andy.shevchenko@gmail.com>ë‹˜ì´ ì‘ì„±:
>>
>> On Fri, Jun 23, 2017 at 12:36 PM, Seunghun Han <kkamagui@gmail.com> wrote:
>> > I'm Seunghun Han, and I work for National Security Research Institute of
>> > South Korea.
>>
>>
>> > -                                       /* Clean up */
>> > -                                       do {
>> > -                                               if (op) {
>> > -                                                       status2 =
>> > -
>> > acpi_ps_complete_this_op
>> > -                                                           (walk_state,
>> > op);
>> > -                                                       if (ACPI_FAILURE
>> > -                                                           (status2)) {
>> > -
>> > return_ACPI_STATUS
>> > -
>> > (status2);
>> > -                                                       }
>> > -                                               }
>> > -
>> > -                                               acpi_ps_pop_scope(&
>> > -
>> > (walk_state->
>> > -
>> > parser_state),
>> > -                                                                 &op,
>> > -
>> > &walk_state->
>> > -
>> > arg_types,
>> > -
>> > &walk_state->
>> > -
>> > arg_count);
>> > -
>> > -                                       } while (op);
>>
>> I didn't get, do you send an incremental patch as a new version?!
>>
>> --
>> With Best Regards,
>> Andy Shevchenko
--
To unsubscribe from this list: send the line "unsubscribe linux-acpi" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  http://vger.kernel.org/majordomo-info.html

```

9806085

[diff](/project/linux-acpi/patch/1498210597-112293-1-git-send-email-kkamagui%40gmail.com/raw/ "Download patch diff")
[mbox](/project/linux-acpi/patch/1498210597-112293-1-git-send-email-kkamagui%40gmail.com/mbox/ "Download patch mbox")
## Patch

```

diff --git a/drivers/acpi/acpica/psobject.c b/drivers/acpi/acpica/psobject.c
index 5bcb618..4539391 100644
--- a/drivers/acpi/acpica/psobject.c
+++ b/drivers/acpi/acpica/psobject.c
@@ -608,7 +608,8 @@  acpi_status
 acpi_ps_complete_final_op(struct acpi_walk_state *walk_state,
 			  union acpi_parse_object *op, acpi_status status)
 {
-	acpi_status status2;
+	acpi_status return_status = AE_OK;
+	u8 ascending = TRUE;

 	ACPI_FUNCTION_TRACE_PTR(ps_complete_final_op, walk_state);

@@ -622,7 +623,8 @@  acpi_ps_complete_final_op(struct acpi_walk_state *walk_state,
 			  op));
 	do {
 		if (op) {
-			if (walk_state->ascending_callback != NULL) {
+			if (ascending &&
+			    walk_state->ascending_callback != NULL) {
 				walk_state->op = op;
 				walk_state->op_info =
 				    acpi_ps_get_opcode_info(op->common.
@@ -644,49 +646,26 @@  acpi_ps_complete_final_op(struct acpi_walk_state *walk_state,
 				}

 				if (status == AE_CTRL_TERMINATE) {
-					status = AE_OK;
-
-					/* Clean up */
-					do {
-						if (op) {
-							status2 =
-							    acpi_ps_complete_this_op
-							    (walk_state, op);
-							if (ACPI_FAILURE
-							    (status2)) {
-								return_ACPI_STATUS
-								    (status2);
-							}
-						}
-
-						acpi_ps_pop_scope(&
-								  (walk_state->
-								   parser_state),
-								  &op,
-								  &walk_state->
-								  arg_types,
-								  &walk_state->
-								  arg_count);
-
-					} while (op);
-
-					return_ACPI_STATUS(status);
+					ascending = FALSE;
+					return_status = AE_CTRL_TERMINATE;
 				}

 				else if (ACPI_FAILURE(status)) {

 					/* First error is most important */

-					(void)
-					    acpi_ps_complete_this_op(walk_state,
-								     op);
-					return_ACPI_STATUS(status);
+					ascending = FALSE;
+					return_status = status;
 				}
 			}

-			status2 = acpi_ps_complete_this_op(walk_state, op);
-			if (ACPI_FAILURE(status2)) {
-				return_ACPI_STATUS(status2);
+			status = acpi_ps_complete_this_op(walk_state, op);
+			if (ACPI_FAILURE(status)) {
+				ascending = FALSE;
+				if (ACPI_SUCCESS(return_status) ||
+				    return_status == AE_CTRL_TERMINATE) {
+					return_status = status;
+				}
 			}
 		}

@@ -696,5 +675,5 @@  acpi_ps_complete_final_op(struct acpi_walk_state *walk_state,

 	} while (op);

-	return_ACPI_STATUS(status);
+	return_ACPI_STATUS(return_status);
 }

```

[patchwork](http://jk.ozlabs.org/projects/patchwork/)
patch tracking system | version v2.2.6 | [about patchwork](/about/)



=== Content from github.com_46208a5f_20250124_231721.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Facpica%2Facpica%2Fpull%2F278)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Facpica%2Facpica%2Fpull%2F278)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=acpica%2Facpica)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[acpica](/acpica)
/
**[acpica](/acpica/acpica)**
Public

* [Notifications](/login?return_to=%2Facpica%2Facpica) You must be signed in to change notification settings
* [Fork
  374](/login?return_to=%2Facpica%2Facpica)
* [Star
   505](/login?return_to=%2Facpica%2Facpica)

* [Code](/acpica/acpica)
* [Issues
  73](/acpica/acpica/issues)
* [Pull requests
  12](/acpica/acpica/pulls)
* [Discussions](/acpica/acpica/discussions)
* [Actions](/acpica/acpica/actions)
* [Projects
  0](/acpica/acpica/projects)
* [Wiki](/acpica/acpica/wiki)
* [Security](/acpica/acpica/security)
* [Insights](/acpica/acpica/pulse)

Additional navigation options

* [Code](/acpica/acpica)
* [Issues](/acpica/acpica/issues)
* [Pull requests](/acpica/acpica/pulls)
* [Discussions](/acpica/acpica/discussions)
* [Actions](/acpica/acpica/actions)
* [Projects](/acpica/acpica/projects)
* [Wiki](/acpica/acpica/wiki)
* [Security](/acpica/acpica/security)
* [Insights](/acpica/acpica/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Facpica%2Facpica%2Fissues%2Fnew%2Fchoose)

By clicking â€œSign up for GitHubâ€, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). Weâ€™ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Facpica%2Facpica%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# acpi: acpica: fix acpi parse and parseext cache leaks #278

 Merged

[SaketADumbre](/SaketADumbre)
merged 1 commit into
[acpica:master](/acpica/acpica/tree/master "acpica/acpica:master")
from
[kkamagui:fix\_acpi\_parse\_and\_parseext\_leaks\_v2](/kkamagui/acpica/tree/fix_acpi_parse_and_parseext_leaks_v2 "kkamagui/acpica:fix_acpi_parse_and_parseext_leaks_v2")

Dec 12, 2024

 Merged

# [acpi: acpica: fix acpi parse and parseext cache leaks](#top) #278

[SaketADumbre](/SaketADumbre)
merged 1 commit into
[acpica:master](/acpica/acpica/tree/master "acpica/acpica:master")
from
[kkamagui:fix\_acpi\_parse\_and\_parseext\_leaks\_v2](/kkamagui/acpica/tree/fix_acpi_parse_and_parseext_leaks_v2 "kkamagui/acpica:fix_acpi_parse_and_parseext_leaks_v2")

Dec 12, 2024

[Conversation
20](/acpica/acpica/pull/278)
[Commits
1](/acpica/acpica/pull/278/commits)
[Checks
0](/acpica/acpica/pull/278/checks)
[Files changed](/acpica/acpica/pull/278/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![kkamagui](https://avatars.githubusercontent.com/u/1183342?s=60&v=4)](/kkamagui)

Copy link

Contributor

### @kkamagui **[kkamagui](/kkamagui)** commented [Jun 23, 2017](#issue-238044163) â€¢ edited Loading

I'm Seunghun Han, and I work for National Security Research Institute of

South Korea.

I have been doing a research on ACPI and found an ACPI cache leak in ACPI

early abort cases.

Boot log of ACPI cache leak is as follows:

[ 0.352414] ACPI: Added \_OSI(Module Device)

[ 0.353182] ACPI: Added \_OSI(Processor Device)

[ 0.353182] ACPI: Added \_OSI(3.0 \_SCP Extensions)

[ 0.353182] ACPI: Added \_OSI(Processor Aggregator Device)

[ 0.356028] ACPI: Unable to start the ACPI Interpreter

[ 0.356799] ACPI Error: Could not remove SCI handler (20170303/evmisc-281)

[ 0.360215] kmem\_cache\_destroy Acpi-State: Slab cache still has objects

[ 0.360648] CPU: 0 PID: 1 Comm: swapper/0 Tainted: G W

4.12.0-rc4-next-20170608+ [#10](https://github.com/acpica/acpica/pull/10)

[ 0.361273] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS

VirtualBox 12/01/2006

[ 0.361873] Call Trace:

[ 0.362243] ? dump\_stack+0x5c/0x81

[ 0.362591] ? kmem\_cache\_destroy+0x1aa/0x1c0

[ 0.362944] ? acpi\_sleep\_proc\_init+0x27/0x27

[ 0.363296] ? acpi\_os\_delete\_cache+0xa/0x10

[ 0.363646] ? acpi\_ut\_delete\_caches+0x6d/0x7b

[ 0.364000] ? acpi\_terminate+0xa/0x14

[ 0.364000] ? acpi\_init+0x2af/0x34f

[ 0.364000] ? \_\_class\_create+0x4c/0x80

[ 0.364000] ? video\_setup+0x7f/0x7f

[ 0.364000] ? acpi\_sleep\_proc\_init+0x27/0x27

[ 0.364000] ? do\_one\_initcall+0x4e/0x1a0

[ 0.364000] ? kernel\_init\_freeable+0x189/0x20a

[ 0.364000] ? rest\_init+0xc0/0xc0

[ 0.364000] ? kernel\_init+0xa/0x100

[ 0.364000] ? ret\_from\_fork+0x25/0x30

I analyzed this memory leak in detail. I found that â€œAcpi-Stateâ€ cache and

â€œAcpi-Parseâ€ cache were merged because the size of cache objects was same

slab cache size.

I finally found â€œAcpi-Parseâ€ cache and â€œAcpi-ParseExtâ€ cache were leaked

using SLAB\_NEVER\_MERGE flag in kmem\_cache\_create() function.

Real ACPI cache leak point is as follows:

[ 0.360101] ACPI: Added \_OSI(Module Device)

[ 0.360101] ACPI: Added \_OSI(Processor Device)

[ 0.360101] ACPI: Added \_OSI(3.0 \_SCP Extensions)

[ 0.361043] ACPI: Added \_OSI(Processor Aggregator Device)

[ 0.364016] ACPI: Unable to start the ACPI Interpreter

[ 0.365061] ACPI Error: Could not remove SCI handler (20170303/evmisc-281)

[ 0.368174] kmem\_cache\_destroy Acpi-Parse: Slab cache still has objects

[ 0.369332] CPU: 1 PID: 1 Comm: swapper/0 Tainted: G W

4.12.0-rc4-next-20170608+ [#8](https://github.com/acpica/acpica/pull/8)

[ 0.371256] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS

VirtualBox 12/01/2006

[ 0.372000] Call Trace:

[ 0.372000] ? dump\_stack+0x5c/0x81

[ 0.372000] ? kmem\_cache\_destroy+0x1aa/0x1c0

[ 0.372000] ? acpi\_sleep\_proc\_init+0x27/0x27

[ 0.372000] ? acpi\_os\_delete\_cache+0xa/0x10

[ 0.372000] ? acpi\_ut\_delete\_caches+0x56/0x7b

[ 0.372000] ? acpi\_terminate+0xa/0x14

[ 0.372000] ? acpi\_init+0x2af/0x34f

[ 0.372000] ? \_\_class\_create+0x4c/0x80

[ 0.372000] ? video\_setup+0x7f/0x7f

[ 0.372000] ? acpi\_sleep\_proc\_init+0x27/0x27

[ 0.372000] ? do\_one\_initcall+0x4e/0x1a0

[ 0.372000] ? kernel\_init\_freeable+0x189/0x20a

[ 0.372000] ? rest\_init+0xc0/0xc0

[ 0.372000] ? kernel\_init+0xa/0x100

[ 0.372000] ? ret\_from\_fork+0x25/0x30

[ 0.388039] kmem\_cache\_destroy Acpi-ParseExt: Slab cache still has objects

[ 0.389063] CPU: 1 PID: 1 Comm: swapper/0 Tainted: G W

4.12.0-rc4-next-20170608+ [#8](https://github.com/acpica/acpica/pull/8)

[ 0.390557] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS

VirtualBox 12/01/2006

[ 0.392000] Call Trace:

[ 0.392000] ? dump\_stack+0x5c/0x81

[ 0.392000] ? kmem\_cache\_destroy+0x1aa/0x1c0

[ 0.392000] ? acpi\_sleep\_proc\_init+0x27/0x27

[ 0.392000] ? acpi\_os\_delete\_cache+0xa/0x10

[ 0.392000] ? acpi\_ut\_delete\_caches+0x6d/0x7b

[ 0.392000] ? acpi\_terminate+0xa/0x14

[ 0.392000] ? acpi\_init+0x2af/0x34f

[ 0.392000] ? \_\_class\_create+0x4c/0x80

[ 0.392000] ? video\_setup+0x7f/0x7f

[ 0.392000] ? acpi\_sleep\_proc\_init+0x27/0x27

[ 0.392000] ? do\_one\_initcall+0x4e/0x1a0

[ 0.392000] ? kernel\_init\_freeable+0x189/0x20a

[ 0.392000] ? rest\_init+0xc0/0xc0

[ 0.392000] ? kernel\_init+0xa/0x100

[ 0.392000] ? ret\_from\_fork+0x25/0x30

When early abort is occurred due to invalid ACPI information, Linux kernel

terminates ACPI by calling acpi\_terminate() function. The function calls

acpi\_ut\_delete\_caches() function to delete local caches (acpi\_gbl\_namespace\_

cache, state\_cache, operand\_cache, ps\_node\_cache, ps\_node\_ext\_cache).

But the deletion codes in acpi\_ut\_delete\_caches() function only delete

slab caches using kmem\_cache\_destroy() function, therefore the cache

objects should be flushed before acpi\_ut\_delete\_caches() function.

"Acpi-Parse" cache and "Acpi-ParseExt" cache are used in an AML parse

function, acpi\_ps\_parse\_loop(). The function should complete all ops

using acpi\_ps\_complete\_final\_op() when an error occurs due to invalid

AML codes.

However, the current implementation of acpi\_ps\_complete\_final\_op() does not

complete all ops when it meets some errors and this cause cache leak.

This cache leak has a security threat because an old kernel (<= 4.9) shows

memory locations of kernel functions in stack dump. Some malicious users

could use this information to neutralize kernel ASLR.

To fix ACPI cache leak for enhancing security, I made a patch to complete all

ops unconditionally for acpi\_ps\_complete\_final\_op() function.

I hope that this patch improves the security of Linux kernel.

Thank you.

Signed-off-by: Seunghun Han kkamagui@gmail.com

Sorry, something went wrong.

All reactions

[![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=40&u=c7e2122f5494d1f157f5e0dc8291bb42e61f7f8c&v=4)](/kkamagui)
[kkamagui](/kkamagui)
mentioned this pull request
[Jun 23, 2017](#ref-pullrequest-236618840)

[acpi: acpica: fix acpi parse and parseext cache leaks
#275](/acpica/acpica/pull/275)
 Closed

[![@zetalog](https://avatars.githubusercontent.com/u/3615765?s=80&v=4)](/zetalog)

Copy link

Contributor

### **[zetalog](/zetalog)** commented [Jun 23, 2017](#issuecomment-310578814)

| You needn't initiate another pull request. github automatically updates your pull request when you updates your branch that generates the pull request. |
| --- |

All reactions

Sorry, something went wrong.

[![@zetalog](https://avatars.githubusercontent.com/u/3615765?s=80&v=4)](/zetalog)

Copy link

Contributor

### **[zetalog](/zetalog)** commented [Jun 23, 2017](#issuecomment-310579254) â€¢ edited Loading

| What if you fix this in this way:  ``` diff --git a/source/components/parser/psobject.c b/source/components/parser/psobject.c index 5d59492..6f9bf23 100644 --- a/source/components/parser/psobject.c +++ b/source/components/parser/psobject.c @@ -768,7 +768,8 @@ AcpiPsCompleteFinalOp (      ACPI_PARSE_OBJECT       *Op,      ACPI_STATUS             Status)  { -    ACPI_STATUS             Status2; +    ACPI_STATUS             ReturnStatus = AE_OK; +    BOOLEAN                 Ascending = TRUE;          ACPI_FUNCTION_TRACE_PTR (PsCompleteFinalOp, WalkState); @@ -785,7 +786,7 @@ AcpiPsCompleteFinalOp (      {          if (Op)          { -            if (WalkState->AscendingCallback != NULL) +            if (Ascending && WalkState->AscendingCallback != NULL)              {                  WalkState->Op = Op;                  WalkState->OpInfo = AcpiPsGetOpcodeInfo (Op->Common.AmlOpcode); @@ -804,41 +805,28 @@ AcpiPsCompleteFinalOp (                    if (Status == AE_CTRL_TERMINATE)                  { -                    Status = AE_OK; - -                    /* Clean up */ -                    do -                    { -                        if (Op) -                        { -                            Status2 = AcpiPsCompleteThisOp (WalkState, Op); -                            if (ACPI_FAILURE (Status2)) -                            { -                                return_ACPI_STATUS (Status2); -                            } -                        } - -                        AcpiPsPopScope (&(WalkState->ParserState), &Op, -                            &WalkState->ArgTypes, &WalkState->ArgCount); - -                    } while (Op); - -                    return_ACPI_STATUS (Status); +                    Ascending = FALSE; +                    ReturnStatus = AE_CTRL_TERMINATE;                  }                    else if (ACPI_FAILURE (Status))                  {                      /* First error is most important */   -                    (void) AcpiPsCompleteThisOp (WalkState, Op); -                    return_ACPI_STATUS (Status); +                    Ascending = FALSE; +                    ReturnStatus = Status;                  }              }   -            Status2 = AcpiPsCompleteThisOp (WalkState, Op); -            if (ACPI_FAILURE (Status2)) +            Status = AcpiPsCompleteThisOp (WalkState, Op); +            if (ACPI_FAILURE (Status))              { -                return_ACPI_STATUS (Status2); +                Ascending = FALSE; +                if (ACPI_SUCCESS (ReturnStatus) || +                    ReturnStatus == AE_CTRL_TERMINATE) +                { +                    ReturnStatus = Status; +                }              }          }   @@ -847,5 +835,5 @@ AcpiPsCompleteFinalOp (        } while (Op);   -    return_ACPI_STATUS (Status); +    return_ACPI_STATUS (ReturnStatus);  }  ```  Also in your patch description, properly describes this memory leakage with a few words related to the control transfer mechanism in order to provide more comprehensive information to the reviewers. |
| --- |

All reactions

Sorry, something went wrong.

[![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=80&u=c7e2122f5494d1f157f5e0dc8291bb42e61f7f8c&v=4)](/kkamagui)

Copy link

Contributor

Author

### **[kkamagui](/kkamagui)** commented [Jun 23, 2017](#issuecomment-310592188) â€¢ edited Loading

| Hi, your solution is very clear and I agree with you.  By the way, I change some part of your code like this. In "if (Status == AE\_CTRL\_TERMINATE)" case, I change "Status = AE\_OK" to "ReturnStatus = AE\_OK". The original code wants to return AE\_OK code in AE\_CTRL\_TERMINATE case.  ``` diff --git a/source/components/parser/psobject.c b/source/components/parser/psobject.c index 5d59492..b117801 100644 --- a/source/components/parser/psobject.c +++ b/source/components/parser/psobject.c @@ -768,7 +768,8 @@ AcpiPsCompleteFinalOp (      ACPI_PARSE_OBJECT       *Op,      ACPI_STATUS             Status)  { -    ACPI_STATUS             Status2; +    ACPI_STATUS             ReturnStatus = AE_OK; +    BOOLEAN                 Ascending = TRUE;          ACPI_FUNCTION_TRACE_PTR (PsCompleteFinalOp, WalkState); @@ -785,7 +786,7 @@ AcpiPsCompleteFinalOp (      {          if (Op)          { -            if (WalkState->AscendingCallback != NULL) +            if (Ascending && WalkState->AscendingCallback != NULL)              {                  WalkState->Op = Op;                  WalkState->OpInfo = AcpiPsGetOpcodeInfo (Op->Common.AmlOpcode); @@ -804,41 +805,23 @@ AcpiPsCompleteFinalOp (                    if (Status == AE_CTRL_TERMINATE)                  { -                    Status = AE_OK; - -                    /* Clean up */ -                    do -                    { -                        if (Op) -                        { -                            Status2 = AcpiPsCompleteThisOp (WalkState, Op); -                            if (ACPI_FAILURE (Status2)) -                            { -                                return_ACPI_STATUS (Status2); -                            } -                        } - -                        AcpiPsPopScope (&(WalkState->ParserState), &Op, -                            &WalkState->ArgTypes, &WalkState->ArgCount); - -                    } while (Op); - -                    return_ACPI_STATUS (Status); +                    ReturnStatus = AE_OK; +                    Ascending = FALSE;                  }                    else if (ACPI_FAILURE (Status))                  {                      /* First error is most important */   -                    (void) AcpiPsCompleteThisOp (WalkState, Op); -                    return_ACPI_STATUS (Status); +                    ReturnStatus = Status; +                    Ascending = FALSE;                  }              }   -            Status2 = AcpiPsCompleteThisOp (WalkState, Op); -            if (ACPI_FAILURE (Status2)) +            Status = AcpiPsCompleteThisOp (WalkState, Op); +            if (ACPI_FAILURE (Status) && ACPI_SUCCESS (ReturnStatus))              { -                return_ACPI_STATUS (Status2); +                ReturnStatus = Status;              }          }   @@ -847,5 +830,5 @@ AcpiPsCompleteFinalOp (        } while (Op);   -    return_ACPI_STATUS (Status); +    return_ACPI_STATUS (ReturnStatus);  }  ```  I have tested this code work well and update new commit to this pull-request, <https://github.com/acpica/acpica/pull/278/commits>. If you are OK, would you merge this pull-request?  Thank you. |
| --- |

All reactions

Sorry, something went wrong.

[![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=80&u=c7e2122f5494d1f157f5e0dc8291bb42e61f7f8c&v=4)](/kkamagui)

Copy link

Contributor

Author

### **[kkamagui](/kkamagui)** commented [Jun 23, 2017](#issuecomment-310614306) â€¢ edited Loading

| Hi, I found some code changes after I sent a new commit.  I think that you want to return AE\_CTRL\_TERMINATE status instead of AE\_OK. So, I tested it in my machine and made a new commit for it.  Please review commits(v1 to v3) in my pull-requests. <https://github.com/acpica/acpica/pull/278/commits>.  If you have any request, please let me know.  Thank you. |
| --- |

All reactions

Sorry, something went wrong.

[![@zetalog](https://avatars.githubusercontent.com/u/3615765?s=80&v=4)](/zetalog)

Copy link

Contributor

### **[zetalog](/zetalog)** commented [Jun 26, 2017](#issuecomment-310937943) â€¢ edited Loading

| Please rebase the branch, merge the 3 commits into 1 single commit. And use "git push --force" to update the pull request.  If you are OK, would you merge this pull-request?  I'm not sure. I cannot determine anything, I can only help to review it and provide my comments. |
| --- |

All reactions

Sorry, something went wrong.

 [![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=40&u=c7e2122f5494d1f157f5e0dc8291bb42e61f7f8c&v=4)](/kkamagui)
[kkamagui](/kkamagui)
[force-pushed](/acpica/acpica/compare/58690ef296166655d1ddc2de44c46282df68b8a0..4a0243ecb4c94e2d73510d096c5ea4d0711fc6c0)
the
fix\_acpi\_parse\_and\_parseext\_leaks\_v2

branch
from
[`58690ef`](/acpica/acpica/commit/58690ef296166655d1ddc2de44c46282df68b8a0) to
[`4a0243e`](/acpica/acpica/commit/4a0243ecb4c94e2d73510d096c5ea4d0711fc6c0)  [Compare](/acpica/acpica/compare/58690ef296166655d1ddc2de44c46282df68b8a0..4a0243ecb4c94e2d73510d096c5ea4d0711fc6c0)
[June 26, 2017 01:47](#event-1137931783)

[![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=80&u=c7e2122f5494d1f157f5e0dc8291bb42e61f7f8c&v=4)](/kkamagui)

Copy link

Contributor

Author

### **[kkamagui](/kkamagui)** commented [Jun 26, 2017](#issuecomment-310945339) â€¢ edited Loading

| Hi, Thank you for your advice.  I merged the 3 commit into 1 single commit and just pushed it to the pull-request. Please review my commit, <https://github.com/acpica/acpica/pull/278/commits>  If you have any request, please let me know.  Thank you. |
| --- |

All reactions

Sorry, something went wrong.

[![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=80&u=c7e2122f5494d1f157f5e0dc8291bb42e61f7f8c&v=4)](/kkamagui)

Copy link

Contributor

Author

### **[kkamagui](/kkamagui)** commented [Feb 6, 2018](#issuecomment-363458615)

| I am afraid that there is nothing new.  I have been solving a critical security issue in BIOS/UEFI firmware since last December.  It seems that it is worth to be merged and after solving BIOS/UEFI issue, I will keep monitoring it. |
| --- |

All reactions

Sorry, something went wrong.

[![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=80&u=c7e2122f5494d1f157f5e0dc8291bb42e61f7f8c&v=4)](/kkamagui)

Copy link

Contributor

Author

### **[kkamagui](/kkamagui)** commented [Mar 2, 2018](#issuecomment-370045246) â€¢ edited Loading

| Hi.  Finally, I made a tool which can reproduce this memory leak report. Please check my github below and your email. <https://github.com/kkamagui/acpica/tree/linux_kernel_app>  I hope that my tool helps you. If you have any further question, please let me know.  Best regards. |
| --- |

All reactions

Sorry, something went wrong.

[![@SchmErik](https://avatars.githubusercontent.com/u/11355936?s=80&u=6659dcc9a617b838a792b8b13b557b179b844bb5&v=4)](/SchmErik)

Copy link

Contributor

### **[SchmErik](/SchmErik)** commented [Apr 2, 2018](#issuecomment-378070193)

| Can you update the commit message explaining how you altered AcpiPsCompleteFinalOp instead of AcpiPsParseLoop? Thanks |
| --- |

All reactions

Sorry, something went wrong.

[![SchmErik](https://avatars.githubusercontent.com/u/11355936?s=60&v=4)](/SchmErik)

**[SchmErik](/SchmErik)**
reviewed
[Apr 3, 2018](#pullrequestreview-109031592)

 [View reviewed changes](/acpica/acpica/pull/278/files)

[source/components/parser/psobject.c](/acpica/acpica/pull/278/files#diff-b85286c845bc3c09c0140017d4ae177b1be0ff2e9ecd65dbec10d4541215e3ff)
Outdated

|  |  | @@ -768,7 +768,8 @@ AcpiPsCompleteFinalOp ( | |
| --- | --- | --- | --- |
|  |  | ACPI\_PARSE\_OBJECT \*Op, |
|  |  | ACPI\_STATUS Status) |
|  |  | { |
|  |  | ACPI\_STATUS Status2; |
|  |  | ACPI\_STATUS ReturnStatus = AE\_OK; |

Copy link

Contributor

### @SchmErik **[SchmErik](/SchmErik)** [Apr 3, 2018](#discussion_r178892105)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

We should change this to ReturnStatus = Status. This will preserve the old behavior if Op is NULL.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @kkamagui **[kkamagui](/kkamagui)** [Apr 3, 2018](#discussion_r178899432)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

That is a good point. I will change the code and commit message. Thank you for your advice.

Sorry, something went wrong.

All reactions

[![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=40&v=4)](/kkamagui)

`[acpi: acpica: fix acpi parse and parseext cache leaks](/acpica/acpica/pull/278/commits/8829e70e1360c81e7a5a901b5d4f48330e021ea5 "acpi: acpica: fix acpi parse and parseext cache leaks

I'm Seunghun Han, and I work for National Security Research Institute of
South Korea.

I have been doing a research on ACPI and found an ACPI cache leak in ACPI
early abort cases.

Boot log of ACPI cache leak is as follows:
[    0.352414] ACPI: Added _OSI(Module Device)
[    0.353182] ACPI: Added _OSI(Processor Device)
[    0.353182] ACPI: Added _OSI(3.0 _SCP Extensions)
[    0.353182] ACPI: Added _OSI(Processor Aggregator Device)
[    0.356028] ACPI: Unable to start the ACPI Interpreter
[    0.356799] ACPI Error: Could not remove SCI handler (20170303/evmisc-281)
[    0.360215] kmem_cache_destroy Acpi-State: Slab cache still has objects
[    0.360648] CPU: 0 PID: 1 Comm: swapper/0 Tainted: G        W
4.12.0-rc4-next-20170608+ #10
[    0.361273] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS
VirtualBox 12/01/2006
[    0.361873] Call Trace:
[    0.362243]  ? dump_stack+0x5c/0x81
[    0.362591]  ? kmem_cache_destroy+0x1aa/0x1c0
[    0.362944]  ? acpi_sleep_proc_init+0x27/0x27
[    0.363296]  ? acpi_os_delete_cache+0xa/0x10
[    0.363646]  ? acpi_ut_delete_caches+0x6d/0x7b
[    0.364000]  ? acpi_terminate+0xa/0x14
[    0.364000]  ? acpi_init+0x2af/0x34f
[    0.364000]  ? __class_create+0x4c/0x80
[    0.364000]  ? video_setup+0x7f/0x7f
[    0.364000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.364000]  ? do_one_initcall+0x4e/0x1a0
[    0.364000]  ? kernel_init_freeable+0x189/0x20a
[    0.364000]  ? rest_init+0xc0/0xc0
[    0.364000]  ? kernel_init+0xa/0x100
[    0.364000]  ? ret_from_fork+0x25/0x30

I analyzed this memory leak in detail. I found that â€œAcpi-Stateâ€ cache and
â€œAcpi-Parseâ€ cache were merged because the size of cache objects was same
slab cache size.

I finally found â€œAcpi-Parseâ€ cache and â€œAcpi-ParseExtâ€ cache were leaked
using SLAB_NEVER_MERGE flag in kmem_cache_create() function.

Real ACPI cache leak point is as follows:
[    0.360101] ACPI: Added _OSI(Module Device)
[    0.360101] ACPI: Added _OSI(Processor Device)
[    0.360101] ACPI: Added _OSI(3.0 _SCP Extensions)
[    0.361043] ACPI: Added _OSI(Processor Aggregator Device)
[    0.364016] ACPI: Unable to start the ACPI Interpreter
[    0.365061] ACPI Error: Could not remove SCI handler (20170303/evmisc-281)
[    0.368174] kmem_cache_destroy Acpi-Parse: Slab cache still has objects
[    0.369332] CPU: 1 PID: 1 Comm: swapper/0 Tainted: G        W
4.12.0-rc4-next-20170608+ #8
[    0.371256] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS
VirtualBox 12/01/2006
[    0.372000] Call Trace:
[    0.372000]  ? dump_stack+0x5c/0x81
[    0.372000]  ? kmem_cache_destroy+0x1aa/0x1c0
[    0.372000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.372000]  ? acpi_os_delete_cache+0xa/0x10
[    0.372000]  ? acpi_ut_delete_caches+0x56/0x7b
[    0.372000]  ? acpi_terminate+0xa/0x14
[    0.372000]  ? acpi_init+0x2af/0x34f
[    0.372000]  ? __class_create+0x4c/0x80
[    0.372000]  ? video_setup+0x7f/0x7f
[    0.372000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.372000]  ? do_one_initcall+0x4e/0x1a0
[    0.372000]  ? kernel_init_freeable+0x189/0x20a
[    0.372000]  ? rest_init+0xc0/0xc0
[    0.372000]  ? kernel_init+0xa/0x100
[    0.372000]  ? ret_from_fork+0x25/0x30
[    0.388039] kmem_cache_destroy Acpi-ParseExt: Slab cache still has objects
[    0.389063] CPU: 1 PID: 1 Comm: swapper/0 Tainted: G        W
4.12.0-rc4-next-20170608+ #8
[    0.390557] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS
VirtualBox 12/01/2006
[    0.392000] Call Trace:
[    0.392000]  ? dump_stack+0x5c/0x81
[    0.392000]  ? kmem_cache_destroy+0x1aa/0x1c0
[    0.392000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.392000]  ? acpi_os_delete_cache+0xa/0x10
[    0.392000]  ? acpi_ut_delete_caches+0x6d/0x7b
[    0.392000]  ? acpi_terminate+0xa/0x14
[    0.392000]  ? acpi_init+0x2af/0x34f
[    0.392000]  ? __class_create+0x4c/0x80
[    0.392000]  ? video_setup+0x7f/0x7f
[    0.392000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.392000]  ? do_one_initcall+0x4e/0x1a0
[    0.392000]  ? kernel_init_freeable+0x189/0x20a
[    0.392000]  ? rest_init+0xc0/0xc0
[    0.392000]  ? kernel_init+0xa/0x100
[    0.392000]  ? ret_from_fork+0x25/0x30

When early abort is occurred due to invalid ACPI information, Linux kernel
terminates ACPI by calling acpi_terminate() function. The function calls
acpi_ut_delete_caches() function to delete local caches (acpi_gbl_namespace_
cache, state_cache, operand_cache, ps_node_cache, ps_node_ext_cache).

But the deletion codes in acpi_ut_delete_caches() function only delete
slab caches using kmem_cache_destroy() function, therefore the cache
objects should be flushed before acpi_ut_delete_caches() function.

\"Acpi-Parse\" cache and \"Acpi-ParseExt\" cache are used in an AML parse
function, acpi_ps_parse_loop(). The function should complete all ops
using acpi_ps_complete_final_op() when an error occurs due to invalid
AML codes.
However, the current implementation of acpi_ps_complete_final_op() does not
complete all ops when it meets some errors and this cause cache leak.

This cache leak has a security threat because an old kernel (<= 4.9) shows
memory locations of kernel functions in stack dump. Some malicious users
could use this information to neutralize kernel ASLR.

To fix ACPI cache leak for enhancing security, I made a patch to complete all
ops unconditionally for acpi_ps_complete_final_op() function.

I hope that this patch improves the security of Linux kernel.

Thank you.

Signed-off-by: Seunghun Han <kkamagui@gmail.com>")`
 â€¦

`[8829e70](/acpica/acpica/pull/278/commits/8829e70e1360c81e7a5a901b5d4f48330e021ea5)`

```
I'm Seunghun Han, and I work for National Security Research Institute of
South Korea.

I have been doing a research on ACPI and found an ACPI cache leak in ACPI
early abort cases.

Boot log of ACPI cache leak is as follows:
[    0.352414] ACPI: Added _OSI(Module Device)
[    0.353182] ACPI: Added _OSI(Processor Device)
[    0.353182] ACPI: Added _OSI(3.0 _SCP Extensions)
[    0.353182] ACPI: Added _OSI(Processor Aggregator Device)
[    0.356028] ACPI: Unable to start the ACPI Interpreter
[    0.356799] ACPI Error: Could not remove SCI handler (20170303/evmisc-281)
[    0.360215] kmem_cache_destroy Acpi-State: Slab cache still has objects
[    0.360648] CPU: 0 PID: 1 Comm: swapper/0 Tainted: G        W
4.12.0-rc4-next-20170608+ [acpica#10](https://github.com/acpica/acpica/pull/10)
[    0.361273] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS
VirtualBox 12/01/2006
[    0.361873] Call Trace:
[    0.362243]  ? dump_stack+0x5c/0x81
[    0.362591]  ? kmem_cache_destroy+0x1aa/0x1c0
[    0.362944]  ? acpi_sleep_proc_init+0x27/0x27
[    0.363296]  ? acpi_os_delete_cache+0xa/0x10
[    0.363646]  ? acpi_ut_delete_caches+0x6d/0x7b
[    0.364000]  ? acpi_terminate+0xa/0x14
[    0.364000]  ? acpi_init+0x2af/0x34f
[    0.364000]  ? __class_create+0x4c/0x80
[    0.364000]  ? video_setup+0x7f/0x7f
[    0.364000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.364000]  ? do_one_initcall+0x4e/0x1a0
[    0.364000]  ? kernel_init_freeable+0x189/0x20a
[    0.364000]  ? rest_init+0xc0/0xc0
[    0.364000]  ? kernel_init+0xa/0x100
[    0.364000]  ? ret_from_fork+0x25/0x30

I analyzed this memory leak in detail. I found that â€œAcpi-Stateâ€ cache and
â€œAcpi-Parseâ€ cache were merged because the size of cache objects was same
slab cache size.

I finally found â€œAcpi-Parseâ€ cache and â€œAcpi-ParseExtâ€ cache were leaked
using SLAB_NEVER_MERGE flag in kmem_cache_create() function.

Real ACPI cache leak point is as follows:
[    0.360101] ACPI: Added _OSI(Module Device)
[    0.360101] ACPI: Added _OSI(Processor Device)
[    0.360101] ACPI: Added _OSI(3.0 _SCP Extensions)
[    0.361043] ACPI: Added _OSI(Processor Aggregator Device)
[    0.364016] ACPI: Unable to start the ACPI Interpreter
[    0.365061] ACPI Error: Could not remove SCI handler (20170303/evmisc-281)
[    0.368174] kmem_cache_destroy Acpi-Parse: Slab cache still has objects
[    0.369332] CPU: 1 PID: 1 Comm: swapper/0 Tainted: G        W
4.12.0-rc4-next-20170608+ [acpica#8](https://github.com/acpica/acpica/pull/8)
[    0.371256] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS
VirtualBox 12/01/2006
[    0.372000] Call Trace:
[    0.372000]  ? dump_stack+0x5c/0x81
[    0.372000]  ? kmem_cache_destroy+0x1aa/0x1c0
[    0.372000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.372000]  ? acpi_os_delete_cache+0xa/0x10
[    0.372000]  ? acpi_ut_delete_caches+0x56/0x7b
[    0.372000]  ? acpi_terminate+0xa/0x14
[    0.372000]  ? acpi_init+0x2af/0x34f
[    0.372000]  ? __class_create+0x4c/0x80
[    0.372000]  ? video_setup+0x7f/0x7f
[    0.372000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.372000]  ? do_one_initcall+0x4e/0x1a0
[    0.372000]  ? kernel_init_freeable+0x189/0x20a
[    0.372000]  ? rest_init+0xc0/0xc0
[    0.372000]  ? kernel_init+0xa/0x100
[    0.372000]  ? ret_from_fork+0x25/0x30
[    0.388039] kmem_cache_destroy Acpi-ParseExt: Slab cache still has objects
[    0.389063] CPU: 1 PID: 1 Comm: swapper/0 Tainted: G        W
4.12.0-rc4-next-20170608+ [acpica#8](https://github.com/acpica/acpica/pull/8)
[    0.390557] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS
VirtualBox 12/01/2006
[    0.392000] Call Trace:
[    0.392000]  ? dump_stack+0x5c/0x81
[    0.392000]  ? kmem_cache_destroy+0x1aa/0x1c0
[    0.392000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.392000]  ? acpi_os_delete_cache+0xa/0x10
[    0.392000]  ? acpi_ut_delete_caches+0x6d/0x7b
[    0.392000]  ? acpi_terminate+0xa/0x14
[    0.392000]  ? acpi_init+0x2af/0x34f
[    0.392000]  ? __class_create+0x4c/0x80
[    0.392000]  ? video_setup+0x7f/0x7f
[    0.392000]  ? acpi_sleep_proc_init+0x27/0x27
[    0.392000]  ? do_one_initcall+0x4e/0x1a0
[    0.392000]  ? kernel_init_freeable+0x189/0x20a
[    0.392000]  ? rest_init+0xc0/0xc0
[    0.392000]  ? kernel_init+0xa/0x100
[    0.392000]  ? ret_from_fork+0x25/0x30

When early abort is occurred due to invalid ACPI information, Linux kernel
terminates ACPI by calling acpi_terminate() function. The function calls
acpi_ut_delete_caches() function to delete local caches (acpi_gbl_namespace_
cache, state_cache, operand_cache, ps_node_cache, ps_node_ext_cache).

But the deletion codes in acpi_ut_delete_caches() function only delete
slab caches using kmem_cache_destroy() function, therefore the cache
objects should be flushed before acpi_ut_delete_caches() function.

"Acpi-Parse" cache and "Acpi-ParseExt" cache are used in an AML parse
function, acpi_ps_parse_loop(). The function should complete all ops
using acpi_ps_complete_final_op() when an error occurs due to invalid
AML codes.
However, the current implementation of acpi_ps_complete_final_op() does not
complete all ops when it meets some errors and this cause cache leak.

This cache leak has a security threat because an old kernel (<= 4.9) shows
memory locations of kernel functions in stack dump. Some malicious users
could use this information to neutralize kernel ASLR.

To fix ACPI cache leak for enhancing security, I made a patch to complete all
ops unconditionally for acpi_ps_complete_final_op() function.

I hope that this patch improves the security of Linux kernel.

Thank you.

Signed-off-by: Seunghun Han <kkamagui@gmail.com>
```

 [![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=40&u=c7e2122f5494d1f157f5e0dc8291bb42e61f7f8c&v=4)](/kkamagui)
[kkamagui](/kkamagui)
[force-pushed](/acpica/acpica/compare/4a0243ecb4c94e2d73510d096c5ea4d0711fc6c0..8829e70e1360c81e7a5a901b5d4f48330e021ea5)
the
fix\_acpi\_parse\_and\_parseext\_leaks\_v2

branch
from
[`4a0243e`](/acpica/acpica/commit/4a0243ecb4c94e2d73510d096c5ea4d0711fc6c0) to
[`8829e70`](/acpica/acpica/commit/8829e70e1360c81e7a5a901b5d4f48330e021ea5)  [Compare](/acpica/acpica/compare/4a0243ecb4c94e2d73510d096c5ea4d0711fc6c0..8829e70e1360c81e7a5a901b5d4f48330e021ea5)
[April 3, 2018 18:00](#event-1554740017)

[![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=80&u=c7e2122f5494d1f157f5e0dc8291bb42e61f7f8c&v=4)](/kkamagui)

Copy link

Contributor

Author

### **[kkamagui](/kkamagui)** commented [Apr 3, 2018](#issuecomment-378343173)

| I updated my commit message and changed the code according to [@SchmErik](https://github.com/SchmErik) 's review comment. Please check the commit message and the code. Thank you. |
| --- |

All reactions

Sorry, something went wrong.

[![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=80&u=c7e2122f5494d1f157f5e0dc8291bb42e61f7f8c&v=4)](/kkamagui)

Copy link

Contributor

Author

### **[kkamagui](/kkamagui)** commented [Apr 4, 2018](#issuecomment-378441961) via email

| Hi Erik, I changed commit message and the code according to your advice. Please check it. Best regards. Seunghun 2018ë…„ 4ì›” 4ì¼ (ìˆ˜) ì˜¤ì „ 1:54, Erik Schmauss <notifications@github.com>ë‹˜ì´ ì‘ì„±: â€¦  \*\*\*@\*\*\*.\*\*\*\* commented on this pull request. ------------------------------ In source/components/parser/psobject.c <[#278 (comment)](https://github.com/acpica/acpica/pull/278#discussion_r178892105)>: > @@ -768,7 +768,8 @@ AcpiPsCompleteFinalOp ( ACPI\_PARSE\_OBJECT \*Op, ACPI\_STATUS Status) { - ACPI\_STATUS Status2; + ACPI\_STATUS ReturnStatus = AE\_OK; We should change this to ReturnStatus = Status. This will preserve the old behavior if Op is NULL. â€” You are receiving this because you were mentioned. Reply to this email directly, view it on GitHub <[#278 (review)](https://github.com/acpica/acpica/pull/278#pullrequestreview-109031592)>, or mute the thread <<https://github.com/notifications/unsubscribe-auth/ABIObiGJDIkdI8DC8CLo_FPKqH48uhH0ks5tk6lIgaJpZM4ODJir>> . |
| --- |

All reactions

Sorry, something went wrong.

[![@SchmErik](https://avatars.githubusercontent.com/u/11355936?s=80&u=6659dcc9a617b838a792b8b13b557b179b844bb5&v=4)](/SchmErik)

Copy link

Contributor

### **[SchmErik](/SchmErik)** commented [Apr 9, 2018](#issuecomment-379913150) â€¢ edited Loading

| Hi, I decided to basically rebased your linuxkernel app to the latest head of the APCICA and I could not reproduce this. The linuxkernel app branch that you have is based on an ACPICA version that does not have one of the major features that we added, mainly parsing the table as a method. This is found in this commit here: [8faf6fc](https://github.com/acpica/acpica/commit/8faf6fca445eb7219963d80543fb802302a7a8c7) If we parse the tables with the very latest commit in ACPICA, I don't see this memory leak... So it doesn't seem like this commit is useful because the memory leak is fixed. This commit is in Linus' tree so you could test the latest to see if it contains memory leaks.. Maybe we should just back-port these commits to older versions. It would be nice for older kernels to have this commit anyway. What do you think? |
| --- |

All reactions

Sorry, something went wrong.

[![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=80&u=c7e2122f5494d1f157f5e0dc8291bb42e61f7f8c&v=4)](/kkamagui)

Copy link

Contributor

Author

### **[kkamagui](/kkamagui)** commented [Apr 10, 2018](#issuecomment-379986788)

| Hi, Erik. Thank you for your reply.  I also ported my linuxkernel tool to the latest version of ACPICA and I finally found the reason why you could not reproduce the bug.  The major difference is AcpiGbl\_ParseTableAsTermList flag of acpifx.h file in [8faf6fc](https://github.com/acpica/acpica/commit/8faf6fca445eb7219963d80543fb802302a7a8c7) commit.  If the flag is TRUE, AcpiNsParseTable() function executes AcpiNsExecuteTable() instead of AcpiNsOneCompleteParse() function. So I set the flag to FALSE, I could reproduce the memory leak.  It seems that the library user still can set the flag to FALSE (like Linux kernel under v4.16.1) and AcpiPsCompleteFinalOp() function still has the bug. Therefore if we don't fix this bug, someday it will come out another way.  In my opinion, we would better to fix the bug in AcpiPsCompleteFinalOp(). How about you?  Thank you. |
| --- |

All reactions

Sorry, something went wrong.

[![@SchmErik](https://avatars.githubusercontent.com/u/11355936?s=80&u=6659dcc9a617b838a792b8b13b557b179b844bb5&v=4)](/SchmErik)

Copy link

Contributor

### **[SchmErik](/SchmErik)** commented [Apr 10, 2018](#issuecomment-380177948)

| Hi Seunghun,  You make a good point. A user could set ParseTableAsTermList in the current upstream to reproduce this memory leak. Our long term plan is to get rid of ParseTableAsTermList flag after a few release cycles and make the parser behavior call AcpiNsExecuteTable() as the only option. [@acpibob](https://github.com/acpibob) what do you think? |
| --- |

All reactions

Sorry, something went wrong.

[![@SaketADumbre](https://avatars.githubusercontent.com/u/97769119?s=80&v=4)](/SaketADumbre)

Copy link

Collaborator

### **[SaketADumbre](/SaketADumbre)** commented [Dec 9, 2024](#issuecomment-2529386389)

| Is there still any community interest in merging this PR? I have no objections to merging it if there is any interest! |
| --- |

All reactions

Sorry, something went wrong.

[![@SaketADumbre](https://avatars.githubusercontent.com/u/97769119?s=40&v=4)](/SaketADumbre)
[SaketADumbre](/SaketADumbre)
mentioned this pull request
[Dec 11, 2024](#ref-pullrequest-243953682)

[acpi: acpica: fix acpi operand cache leak in dsutils.c
#295](/acpica/acpica/pull/295)
 Merged

[![@joeyli](https://avatars.githubusercontent.com/u/124434?s=80&v=4)](/joeyli)

Copy link

### **[joeyli](/joeyli)** commented [Dec 12, 2024](#issuecomment-2537850523)

| I am simply google and found that [CVE-2017-13694](https://github.com/advisories/GHSA-cc4x-9vpx-cphw "CVE-2017-13694") relates to this patch . Just put a comment here for note. |
| --- |

All reactions

Sorry, something went wrong.

[![@SaketADumbre](https://avatars.githubusercontent.com/u/97769119?s=80&v=4)](/SaketADumbre)

Copy link

Collaborator

### **[SaketADumbre](/SaketADumbre)** commented [Dec 12, 2024](#issuecomment-2539420949)

| Thanks a lot [@joeyli](https://github.com/joeyli) and [@kkamagui](https://github.com/kkamagui) for the contributions! |
| --- |

All reactions

Sorry, something went wrong.

[![@SaketADumbre](https://avatars.githubusercontent.com/u/97769119?s=40&v=4)](/SaketADumbre)
[SaketADumbre](/SaketADumbre)
merged commit [`828a390`](/acpica/acpica/commit/828a3909cb6c7917fd26cd73b517bc05748968d3)
into
acpica:master

[Dec 12, 2024](https://github.com/acpica/acpica/pull/278#event-15637479496)

[![@SaketADumbre](https://avatars.githubusercontent.com/u/97769119?s=40&v=4)](/SaketADumbre)
[SaketADumbre](/SaketADumbre)
mentioned this pull request
[Dec 12, 2024](#ref-pullrequest-2736378937)

[[GHSA-cc4x-9vpx-cphw] The acpi\_ps\_complete\_final\_op() function in drivers/acpi...
github/advisory-database#5082](/github/advisory-database/pull/5082)
 Closed

[![@joeyli](https://avatars.githubusercontent.com/u/124434?s=80&v=4)](/joeyli)

Copy link

### **[joeyli](/joeyli)** commented [Dec 13, 2024](#issuecomment-2540319521)

| Thanks for Saket's help! |
| --- |

 â¤ï¸
1
 SaketADumbre reacted with heart emoji

All reactions

* â¤ï¸
  1 reaction

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Facpica%2Facpica%2Fpull%2F278)

Reviewers

[![@SchmErik](https://avatars.githubusercontent.com/u/11355936?s=40&v=4)](/SchmErik) [SchmErik](/SchmErik)

SchmErik left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

5 participants

[![@kkamagui](https://avatars.githubusercontent.com/u/1183342?s=52&v=4)](/kkamagui) [![@zetalog](https://avatars.githubusercontent.com/u/3615765?s=52&v=4)](/zetalog) [![@SchmErik](https://avatars.githubusercontent.com/u/11355936?s=52&v=4)](/SchmErik) [![@SaketADumbre](https://avatars.githubusercontent.com/u/97769119?s=52&v=4)](/SaketADumbre) [![@joeyli](https://avatars.githubusercontent.com/u/124434?s=52&v=4)](/joeyli)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from avatars.githubusercontent.com_c692da60_20250126_042349.html ===
ï¿½PNG

   
IHDR  ï¿½  ï¿½   ï¿½.ï¿½b  ï¿½IDATxï¿½ï¿½ï¿½Qï¿½ï¿½@Fï¿½ï¿½
&Pï¿½ ï¿½  uï¿½ï¿½ï¿½ï¿½Ğ´Lï¿½{ï¿½ï¿½ï¿½ï¿½Inï¿½eï¿½ï¿½ï¿½ï¿½ï¿½f ï¿½ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ ï¿½m/ï¿½ï¿½qï¿½[ï¿½ï¿½ï¿½}ï¿½ï¿½gï¿½Gï¿½ï¿½=ï¿½e$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½}ï¿½xï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$,ï¿½|ï¿½ï¿½:fOxï¿½mï¿½gOxï¿½ï¿½ï¿½ ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½ï¿½x/ï¿½uÌ /ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½H; Aï¿½ï¿½ï¿½HXfï¿½lÛºÏ@ï¿½yï¿½'|\*ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ï¿½;Æ˜ï¿½ï¿½ï¿½\v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½ï¿½ b$ï¿½ï¿½ v@ï¿½   ï¿½ï¿½Kï¿½ï¿½,    IENDï¿½B`ï¿½
