Based on the provided content, here's an analysis of CVE-2017-13236:

**Root Cause of Vulnerability:**

The vulnerability lies in the way the KeyStore service (`android.security.IKeystoreService`) verifies permissions for binder calls, specifically when generating keys with the `INCLUDE_UNIQUE_ID` tag. The service uses `getpidcon` to retrieve the SELinux context of the calling process, based on the PID of the binder transaction. However, PIDs can be recycled, so if the original process (which initiated the binder call) dies and the PID is reassigned to a new process, the permission check might inadvertently use the SELinux context of the new process.

**Weaknesses/Vulnerabilities Present:**

*   **Race Condition:** The core weakness is a race condition. An attacker can initiate a binder call to generate a key with the `INCLUDE_UNIQUE_ID` tag from an unprivileged process, then kill the process. If the attacker can then quickly spawn a privileged app and have it take over the old PID before the `getpidcon` is called by KeyStore service, the permission check will use the SELinux context of the privileged process, allowing a permission bypass.
*   **Incorrect Permission Verification:** Using the PID for SELinux context retrieval is fundamentally flawed because of the possibility of PID recycling. Access controls should be based on the calling process rather than an ephemeral process ID that can be recycled.

**Impact of Exploitation:**

*   **Elevation of Privilege (EoP):** A local malicious application, not normally permitted to generate keys with unique IDs, can bypass access control checks and generate such keys, potentially leading to security issues in the context of privileged process.
*   **Attestation Key Generation:** By exploiting this vulnerability, a malicious app can generate attestation keys that are only meant to be generated by system processes. This allows for potentially malicious use of device attestation.

**Attack Vectors:**

*   **Local Exploitation:** The attacker needs to have an app installed on the device, which is capable of making Binder calls to the KeyStore service.
*   **PID Manipulation:** The attacker needs to manipulate process creation and termination to trigger the race condition with PID cycling.

**Required Attacker Capabilities/Position:**

*   Ability to install an application on an Android device.
*   Ability to make binder calls to the Keystore service.
*   Ability to spawn and kill processes to trigger the race condition, and to trigger a new "priv_app" process to take the recently released PID.

**Additional Details:**

*   The exploit uses a content provider to launch a privileged app and grab the recently released PID.
*   A patch was made to the KeyStoreService (`platform/system/security`)  that replaces `getpidcon` with a mechanism that properly retrieves the SELinux context from the binder transaction, removing the race condition.
*   The `DEFAULT_PERMS` definition in the KeyStoreService includes  `P_GEN_UNIQUE_ID` as a default permission, which is restricted to "priv_app" SELinux contexts via SELinux enforcement. This is bypassed by the race condition.
*   The vulnerability was fixed by changing the binder permission checking mechanism to use the SELinux context directly from the binder transaction, not from the PID, resolving the race condition.

This vulnerability is rated as "Moderate" severity in the Android Security Bulletin.

The provided information also mentions that the vulnerability is present in Android versions 8.0 and 8.1, and was addressed in the 2018-02-01 security patch level.