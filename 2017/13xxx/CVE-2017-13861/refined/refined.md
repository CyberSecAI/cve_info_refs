Based on the provided information, here's an analysis of CVE-2017-13861:

**Root Cause:**
- A double free vulnerability exists due to the IOSurfaceRootUserClient not respecting MIG ownership rules.

**Weaknesses/Vulnerabilities:**
- **Double Free:**  The `IOSurfaceRootUserClient` external method 17 (`s_set_surface_notify`) incorrectly manages the reference count of the asynchronous wake mach port argument. When a client has previously registered a port with the same callback function, the external method drops a reference on the port and returns an error. Due to incorrect handling of this error, the MIG generated code will then drop a further reference on the port, resulting in a double free.

**Impact of Exploitation:**
- **Denial of Service (DoS):** The double free vulnerability can lead to a system crash.
- **Arbitrary Code Execution:** The exploit can potentially achieve arbitrary code execution with kernel privileges. The exploit description mentions that it can get tfp0 (task for pid 0, a kernel task port, which provides full access to the kernel) on 64-bit devices, along with an initial local kernel debugger.

**Attack Vectors:**
- **Local Application:** The vulnerability is reachable from the iOS app sandbox. This indicates that a malicious application running locally on the device can trigger the vulnerability.

**Required Attacker Capabilities/Position:**
- **Local User Access:** An attacker needs to be able to run a malicious application on the target device, meaning they need local access to the system.

**Additional Technical Details:**
- The vulnerability arises from improper handling of MIG (Mach Interface Generator) semantics related to ownership of mach ports.
- When a MIG method returns `KERN_SUCCESS`, it implies that the method took ownership of all passed arguments. If the method returns an error, it owns none of the arguments.
- The vulnerability occurs in the context of an IOKit userclient external method that takes an async wake mach port argument.
- Specifically, the `s_set_surface_notify` method within `IOSurfaceRootUserClient` is affected.
- The proof of concept (PoC) for this vulnerability includes an exploit (`async_wake exploit`) that can be used for gaining kernel privileges.
- The vulnerability is confirmed to affect iOS 11.0.3 and macOS 10.13

This vulnerability is patched in iOS 11.2, watchOS 4.2 and tvOS 11.2, as reported in the corresponding Apple Security updates.