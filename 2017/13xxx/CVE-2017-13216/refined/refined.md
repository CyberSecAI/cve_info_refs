```
{
  "CVE-2017-13216": {
    "Root cause": "A race condition exists in the ashmem driver when handling the ASHMEM_SET_SIZE ioctl and mmap operations. The ioctl does not acquire the 'ashmem_mutex' to perform the ioctl, allowing it to be processed concurrently with an in-flight mmap operation. This can lead to a size inconsistency where a process retrieves a size, maps the memory and then later unmaps with a different size, leading to an inter-process munmap with an attacker controlled size.",
    "Weaknesses/vulnerabilities": [
      "Race condition",
      "Inter-process munmap",
      "Incorrect size tracking"
    ],
    "Impact of exploitation": "An attacker can trigger an inter-process munmap with an attacker-controlled size. This can be leveraged to free a data structure such as a thread's stack allowing for controlled memory corruption.",
     "Attack vectors": "An attacker sends a `MemoryIntArray` with a crafted ashmem file descriptor in a Bundle to a target process. The target process then instantiates the object, retrieves the size, and maps it. While this is happening, the attacker calls `ASHMEM_SET_SIZE` to change the size of the ashmem region. This causes the target process to later unmap the memory using the new attacker controlled size.",
    "Required attacker capabilities/position": "The attacker needs the ability to issue ashmem syscalls and interact with the ActivityManager service. This can be achieved from the 'isolated_app' SELinux context."
  }
}
```