Based on the provided content, here's an analysis of CVE-2017-7897:

**Root cause of vulnerability:**
The vulnerability stems from the use of the `$_SERVER['PHP_SELF']` variable in the `timeline_inc.php` file to generate URLs. This variable contains the current script's filename, and its value is not sanitized before being used to construct URLs. Attackers can manipulate this value by crafting malicious URLs, thereby injecting arbitrary JavaScript code.

**Weaknesses/vulnerabilities present:**
- **Cross-Site Scripting (XSS):** The core issue is a reflected XSS vulnerability due to the lack of sanitization of `$_SERVER['PHP_SELF']`.
- **Unsanitized Input:** The application fails to properly sanitize user-controlled input (the path in the URL) before using it in the generation of URLs.

**Impact of exploitation:**
- **Arbitrary Code Execution:** Successful exploitation can lead to arbitrary JavaScript execution in the context of a victim's browser. This can allow an attacker to perform actions on behalf of the victim, potentially stealing session cookies, redirecting the user to malicious sites, or performing other unauthorized operations.

**Attack vectors:**
- **Malicious URL:** The primary attack vector is a specially crafted URL that includes malicious JavaScript in the path information, specifically within the `PHP_SELF` portion of the URL. For example, `view_user_page.php/"><script>alert(1)</script><x`.

**Required attacker capabilities/position:**
- **Remote Attacker:** The attacker can be remote, needing only to entice a user to click on a malicious link.
- **No privileges required:** The vulnerability does not require any special privileges to exploit.
- **User interaction required:** The user has to click a malicious link or visit a webpage containing the malicious link.

**Additional Details:**
- **Affected Pages:** The vulnerability affects the `timeline_inc.php` include page, impacting pages like "My View" (`my_view_page.php`) and "User Information" (`view_user_page.php`).
- **Content Security Policy (CSP):** While a CSP policy was in place, it could be disabled, and it did not include the necessary prefixed headers for older browsers like IE 10/11 that used `X-Content-Security-Policy` making them vulnerable.
- **Mitigation:** The fix replaces the usage of `$_SERVER['PHP_SELF']` with `basename($_SERVER['SCRIPT_NAME'])` passed through `string_sanitize_url()` function.
- **Affected Versions**: MantisBT versions 2.3.x before 2.3.2 are vulnerable
- **CVSS Score**: The vulnerability has a CVSS v3 base score of 6.1, with a "Moderate" severity.

The provided content provides more details than the official CVE description.