=== Content from github.com_1cc2ba3b_20250125_233451.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fpull%2F1094)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fpull%2F1094)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmantisbt%2Fmantisbt%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmantisbt%2Fmantisbt%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Multiple XSS Fixes #1094

 Closed

[quantumpacket](/quantumpacket)
wants to merge
1
commit into
[mantisbt:master](/mantisbt/mantisbt/tree/master "mantisbt/mantisbt:master")
from
quantumpacket:patch-2

 Closed

# [Multiple XSS Fixes](#top) #1094

[quantumpacket](/quantumpacket)
wants to merge
1
commit into
[mantisbt:master](/mantisbt/mantisbt/tree/master "mantisbt/mantisbt:master")
from
quantumpacket:patch-2

[Conversation
12](/mantisbt/mantisbt/pull/1094)
[Commits
1](/mantisbt/mantisbt/pull/1094/commits)
[Checks
0](/mantisbt/mantisbt/pull/1094/checks)
[Files changed](/mantisbt/mantisbt/pull/1094/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![quantumpacket](https://avatars.githubusercontent.com/u/8516784?s=60&v=4)](/quantumpacket)

Copy link

### @quantumpacket **[quantumpacket](/quantumpacket)** commented [Apr 17, 2017](#issue-222053575) ‚Ä¢ edited by dregad Loading

`$_SERVER['PHP_SELF']` is not sanitized before being used to generate URLs.

Yes, we have a CSP policy in place, but it can be disabled optionally per application config, and does [not](https://github.com/mantisbt/mantisbt/blob/master/core/http_api.php#L191) include prefixed headers so IE 10/11 would be susceptible as they use `X-Content-Security-Policy` according to CanIUse.

PoC: `/view_user_page.php/"><script>alert(1)</script><x`

<http://www.mantisbt.org/bugs/view.php?id=22742>

Sorry, something went wrong.

All reactions

[![@quantumpacket](https://avatars.githubusercontent.com/u/8516784?s=40&v=4)](/quantumpacket)

`[Multiple XSS Fixes](/mantisbt/mantisbt/pull/1094/commits/64bdee35614cdc56aea5faa17228b618969eb26c "Multiple XSS Fixes

$_SERVER['PHP_SELF'] is not sanitized before being used to generate URLs.")`
 ‚Ä¶

`[64bdee3](/mantisbt/mantisbt/pull/1094/commits/64bdee35614cdc56aea5faa17228b618969eb26c)`

```
$_SERVER['PHP_SELF'] is not sanitized before being used to generate URLs.
```

[![@cproensa](https://avatars.githubusercontent.com/u/14123811?s=80&u=e6a2b722639985c58cbf97245e94da4b57b59154&v=4)](/cproensa)

Copy link

Contributor

### **[cproensa](/cproensa)** commented [Apr 17, 2017](#issuecomment-294484726)

| [@vboctor](https://github.com/vboctor) what about extending `function helper_url_combine()` so that it combines the current functionality, the features of http\_build\_query, and XSS sanitization on the final url? |
| --- |

 üëç
1
 quantumpacket reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@cproensa](https://avatars.githubusercontent.com/u/14123811?s=80&u=e6a2b722639985c58cbf97245e94da4b57b59154&v=4)](/cproensa)

Copy link

Contributor

### **[cproensa](/cproensa)** commented [Apr 17, 2017](#issuecomment-294629194)

| even if we may discuss to do any code clean up, it shouldn't set back integration of this fix |
| --- |

All reactions

Sorry, something went wrong.

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=80&v=4)](/dregad)

Copy link

Member

### **[dregad](/dregad)** commented [Apr 18, 2017](#issuecomment-294704802)

| [@quantumpacket](https://github.com/quantumpacket) thanks for reporting this. In the future, kindly follow our guidelines for security issues reporting to avoid early public disclosure, see [http://www.mantisbt.org/wiki/doku.php/mantisbt:handling\_security\_problems](http://www.mantisbt.org/wiki/doku.php/mantisbt%3Ahandling_security_problems)  IE 10/11 would be susceptible as they use X-Content-Security-Policy according to CanIUse  For the record, we're not using `X-Content-Security-Policy` anymore, because it is deprecated and having it in addition to the new `Content-Security-Policy` header could cause issues, as per <https://content-security-policy.com>. But maybe a differentiated test detecting browser type could be implemented, I'll see what can be done. |
| --- |

All reactions

Sorry, something went wrong.

[![dregad](https://avatars.githubusercontent.com/u/449891?s=60&v=4)](/dregad)

**[dregad](/dregad)**
reviewed
[Apr 18, 2017](#pullrequestreview-33154006)

 [View reviewed changes](/mantisbt/mantisbt/pull/1094/files/64bdee35614cdc56aea5faa17228b618969eb26c)

[core/timeline\_inc.php](/mantisbt/mantisbt/pull/1094/files/64bdee35614cdc56aea5faa17228b618969eb26c#diff-cb97b9aef8315477424782708e149080852472f94454f1f68228c30a266008a2)

|  |  | @@ -79,14 +79,14 @@ | |
| --- | --- | --- | --- |
|  |  |  |
|  |  | echo '<div class="btn-group">'; |
|  |  | $t\_url\_params['days'] = $f\_days + 7; |
|  |  | $t\_href = $t\_url\_page . '?' . http\_build\_query( $t\_url\_params ); |
|  |  | $t\_href = htmlspecialchars( $t\_url\_page, ENT\_QUOTES, 'UTF-8' ) . '?' . http\_build\_query( $t\_url\_params ); |

Copy link

Member

### @dregad **[dregad](/dregad)** [Apr 18, 2017](#discussion_r111882138)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Escaping should be done via *string\_attribute()* API function.

Can you explain the rationale for using ENT\_QUOTES vs the default of ENT\_COMPAT ?

Also, is there a reason to force UTF-8 charset ? (for the record, this is the default since PHP 5.4)

Sorry, something went wrong.

All reactions

Copy link

Author

### @quantumpacket **[quantumpacket](/quantumpacket)** [Apr 18, 2017](#discussion_r111917770)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I personally always use `ENT_QUOTES` when it's not directly being output in the HTML string, but being set as a variable somewhere else, because I don't want to run into a situation where the HTML format is changed and quoting could accidentally end up no longer being escaped. As for the UTF-8, I should have checked the packages minimum supported versions. I don't use MantisBT, so not really familiar with it at all. I'm just reporting this, how you guys go about fixing it is up to you. :)

Sorry, something went wrong.

All reactions

Copy link

Member

### @dregad **[dregad](/dregad)** [Apr 18, 2017](#discussion_r111929319)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for the clarification.

Sorry, something went wrong.

All reactions

[![@atrol](https://avatars.githubusercontent.com/u/319317?s=80&v=4)](/atrol)

Copy link

Member

### **[atrol](/atrol)** commented [Apr 18, 2017](#issuecomment-294707400)

| Isn't it enough to change just at this single place?  ``` $t_url_page = $_SERVER["PHP_SELF"];  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@quantumpacket](https://avatars.githubusercontent.com/u/8516784?s=80&u=08fb9673a76e802fa075b6e8aa3a8effbf850689&v=4)](/quantumpacket)

Copy link

Author

### **[quantumpacket](/quantumpacket)** commented [Apr 18, 2017](#issuecomment-294767297) ‚Ä¢ edited Loading

| Isn't it enough to change just at this single place?  It would be easier to do that, but you really should be doing the sanitizing as close to the output line as possible, so that you can rest assure that the variable being used is safe. `$t_url_page` says nothing about if the value is safe to print or not. Should a developer have to traverse up a file to determine if a variable is safe, or would it not be easier to assume it is not and just escape at the point of output?  [@quantumpacket](https://github.com/quantumpacket) thanks for reporting this. In the future, kindly follow our guidelines for security issues reporting to avoid early public disclosure, see [http://www.mantisbt.org/wiki/doku.php/mantisbt:handling\_security\_problems](http://www.mantisbt.org/wiki/doku.php/mantisbt%3Ahandling_security_problems)  I'd recommend that you link to that in the README. Having it buried in a Wiki on the website is not very likely to be stumbled upon in this repository. I'd have gone that route if it was more obvious that there was a security procedure in place. I've never used MantisBT and this was my first time even visiting this repository. Please accept my apology. :) |
| --- |

All reactions

Sorry, something went wrong.

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=80&v=4)](/dregad)

Copy link

Member

### **[dregad](/dregad)** commented [Apr 18, 2017](#issuecomment-294791768)

| I'd recommend that you link to that in the README. Having it buried in a Wiki on the website is not very likely to be stumbled upon in this repository.  Good suggestion, I'll take care of it.  Please accept my apology. :)  No worries üòÑ |
| --- |

All reactions

Sorry, something went wrong.

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=80&v=4)](/dregad)

Copy link

Member

### **[dregad](/dregad)** commented [Apr 18, 2017](#issuecomment-294886066)

| [@quantumpacket](https://github.com/quantumpacket)   * did you request a CVE for this ? If so, let us know the ID when you get it; if not, I'll take care of it. * How would you like to be credited for the finding ? |
| --- |

All reactions

Sorry, something went wrong.

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)
[dregad](/dregad)
closed this
in
`[a1c7193](/mantisbt/mantisbt/commit/a1c719313d61b07bbe8700005807b8195fdc32f1)`
[Apr 18, 2017](#event-1046980667)

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)
[dregad](/dregad)
added
the
[merged](/mantisbt/mantisbt/labels/merged)
label
[Apr 18, 2017](#event-1046981443)

[![@quantumpacket](https://avatars.githubusercontent.com/u/8516784?s=80&u=08fb9673a76e802fa075b6e8aa3a8effbf850689&v=4)](/quantumpacket)

Copy link

Author

### **[quantumpacket](/quantumpacket)** commented [Apr 18, 2017](#issuecomment-294906711)

| I did not request a CVE, so feel free to get one. For credits, I guess just use my Github account? Thanks, and great work on getting this fixed quickly. üòÉ |
| --- |

All reactions

Sorry, something went wrong.

 [![@quantumpacket](https://avatars.githubusercontent.com/u/8516784?s=40&u=08fb9673a76e802fa075b6e8aa3a8effbf850689&v=4)](/quantumpacket)
[quantumpacket](/quantumpacket)
deleted the
patch-2

branch
[April 18, 2017 16:47](#event-1047034694)

[![@smoorez](https://avatars.githubusercontent.com/u/17484627?s=80&v=4)](/smoorez)

Copy link

### **[smoorez](/smoorez)** commented [Apr 18, 2017](#issuecomment-294924753)

| [CVE-2017-7897](https://github.com/advisories/GHSA-8r2m-qhff-jm2c "CVE-2017-7897") has been assigned. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fpull%2F1094)

Reviewers

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad) [dregad](/dregad)

dregad left review comments

Assignees

No one assigned

Labels

[merged](/mantisbt/mantisbt/labels/merged)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

5 participants

[![@quantumpacket](https://avatars.githubusercontent.com/u/8516784?s=52&v=4)](/quantumpacket) [![@cproensa](https://avatars.githubusercontent.com/u/14123811?s=52&v=4)](/cproensa) [![@dregad](https://avatars.githubusercontent.com/u/449891?s=52&v=4)](/dregad) [![@atrol](https://avatars.githubusercontent.com/u/319317?s=52&v=4)](/atrol) [![@smoorez](https://avatars.githubusercontent.com/u/17484627?s=52&v=4)](/smoorez)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_4d7ccf1a_20250126_124843.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8r2m-qhff-jm2c)

**CVE-2017-7897**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8r2m-qhff-jm2c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2017-7897](/advisories/GHSA-8r2m-qhff-jm2c)

## A cross-site scripting (XSS) vulnerability in the...

Moderate severity

Unreviewed

Published
May 17, 2022
to the GitHub Advisory Database
‚Ä¢
Updated Jan 27, 2023

## Package

No package listed‚Äî
[Suggest a package](/advisories/GHSA-8r2m-qhff-jm2c/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

A cross-site scripting (XSS) vulnerability in the MantisBT (2.3.x before 2.3.2) Timeline include page, used in My View (my\_view\_page.php) and User Information (view\_user\_page.php) pages, allows remote attackers to inject arbitrary code (if CSP settings permit it) through crafted PATH\_INFO in a URL, due to use of unsanitized $\_SERVER['PHP\_SELF'] to generate URLs.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2017-7897>
* [mantisbt/mantisbt#1094](https://github.com/mantisbt/mantisbt/pull/1094)
* [mantisbt/mantisbt@a1c7193](https://github.com/mantisbt/mantisbt/commit/a1c719313d61b07bbe8700005807b8195fdc32f1)
* <http://www.mantisbt.org/bugs/view.php?id=22742>
* <http://www.securitytracker.com/id/1038278>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2017-7897)
Apr 18, 2017

Published to the GitHub Advisory Database
May 17, 2022

Last updated
Jan 27, 2023

### Severity

Moderate

6.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

### EPSS score

0.223%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (61st percentile)

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### CVE ID

CVE-2017-7897

### GHSA ID

GHSA-8r2m-qhff-jm2c

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-8r2m-qhff-jm2c/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from avatars.githubusercontent.com_0398a881_20250126_124844.html ===
ÔøΩPNG

   
IHDR  ÔøΩ  ÔøΩ   ÔøΩ.ÔøΩb  ÔøΩIDATxÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ0 EÔøΩLDÔøΩÔøΩ\_ k
ÔøΩ ÔøΩ.!ÔøΩHÔøΩ&MÔøΩ{N~ÔøΩÔøΩÔøΩÔøΩ? ÔøΩÔøΩÔøΩÔøΩ 3ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩÔøΩÔøΩÔøΩ7r^ÔøΩÔøΩ \_ÔøΩÔøΩ:VOÔøΩ[ÔøΩg$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$lÔøΩN:ÔøΩ}ÔøΩY”º\_ÔøΩÔøΩ ÔøΩÔøΩÔøΩ>ÕüÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩ v@ÔøΩÔøΩ b$ÔøΩÔøΩÔøΩÔøΩpoÁµØÔøΩÔøΩ\_ÔøΩ#~ÔøΩcÔøΩÔøΩpWÔøΩÔøΩÔøΩﬁØcÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ3H; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩi'ÔøΩÔøΩ>ÔøΩ,xÔøΩÔøΩ}JÔøΩÔøΩ1ÔøΩyÔøΩ{ÔøΩ9ÔøΩƒß=ÔÇûWÔøΩi<cÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; a[=ÔøΩÔøΩÔøΩk\_=ÔøΩ'cÔøΩÔøΩÔøΩJÔøΩXÔøΩÔøΩ:VOÔøΩ%ÔøΩX AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; ÔøΩcÔøΩÔøΩzÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩH; AÔøΩÔøΩÔøΩHÔøΩ  ÔøΩÔøΩ]0\*lÔøΩ@    IENDÔøΩB`ÔøΩ

=== Content from www.mantisbt.org_e8522c19_20250125_233449.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D22742)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=22742)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0022742 | mantisbt | security | public | 2017-04-18 10:35 | 2017-04-30 14:48 |
|  | | | | | |
|
| Reporter | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | high | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Product Version | 2.3.0 |  | | | |
| Target Version | 2.3.2 | Fixed in Version | 2.3.2 |  | |
|  | | | | | |
|
| Summary | 0022742: CVE-2017-7897: XSS in timeline\_inc.php (affects my\_view\_page.php and view\_user\_page.php) | | | | |
| Description | `$_SERVER['PHP_SELF']` is not sanitized before being used to generate URLs.  Yes, we have a CSP policy in place, but it can be disabled optionally per application config, and does not include prefixed headers so IE 10/11 would be susceptible as they use X-Content-Security-Policy according to CanIUse. | | | | |
| Steps To Reproduce | Navigate to   * `/view_user_page.php/"><script>alert(1)</script><x` * `/my_view_page.php/"><script>alert(1)</script><x` | | | | |
| Additional Information | Initially reported by user quantumpacket in <https://github.com/mantisbt/mantisbt/pull/1094> | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=22742&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=22742&graph=dependency)

| related to | [0022585](view.php?id=22585) | closed | [cproensa](https://mantisbt.org/bugs/view_user_page.php?id=18303) | Show timeline for specific user |
| --- | --- | --- | --- | --- |

#### Activities

| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-18 10:36  developer ¬†  [~0056608](view.php?id=22742#c56608 "Direct link to note") | Introduced in 2.3.0 - [MantisBT master e2d1de8a](/bugs/plugin.php?page=Source/view&id=23088) |
| --- | --- |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-18 12:44  developer ¬†  [~0056611](view.php?id=22742#c56611 "Direct link to note") | CVE Request 321514 |
|  | |

#### Related Changesets

| MantisBT: master-2.3 a1c71931  2017-04-18 07:49  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23204) [Diff](https://github.com/mantisbt/mantisbt/commit/a1c719313d61b07bbe8700005807b8195fdc32f1) | Fix XSS in timeline\_inc.php | | Affected Issues[0022742](/bugs/view.php?id=22742 "[closed] CVE-2017-7897: XSS in timeline_inc.php (affects my_view_page.php and view_user_page.php)") |
| --- | --- | --- | --- |
| mod - core/timeline\_inc.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/a1c719313d61b07bbe8700005807b8195fdc32f1) [File](https://github.com/mantisbt/mantisbt/blob/a1c719313d61b07bbe8700005807b8195fdc32f1/core/timeline_inc.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright ¬© 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.2186 seconds



=== Content from github.com_dd565924_20250126_124845.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa1c719313d61b07bbe8700005807b8195fdc32f1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa1c719313d61b07bbe8700005807b8195fdc32f1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  79](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/a1c719313d61b07bbe8700005807b8195fdc32f1)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix XSS in timeline\_inc.php

[Browse files](/mantisbt/mantisbt/tree/a1c719313d61b07bbe8700005807b8195fdc32f1)
Browse the repository at this point in the history

```
Use of $_SERVER['PHP_SELF'] and outputting it as-is allows an attacker
to inject arbitrary JavaScript as part of the URL.

Using SCRIPT_NAME and passing it through string_sanitize_url() instead
prevents the attack.

Fixes #22742
Fixes [#1094](https://github.com/mantisbt/mantisbt/pull/1094)
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Apr 18, 2017

1 parent
[27b5b29](/mantisbt/mantisbt/commit/27b5b292c9814a40fdd5715fa499a82e29f6f866)

commit a1c7193

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[core/timeline\_inc.php](#diff-cb97b9aef8315477424782708e149080852472f94454f1f68228c30a266008a2 "core/timeline_inc.php")

Show comments

[View file](/mantisbt/mantisbt/blob/a1c719313d61b07bbe8700005807b8195fdc32f1/core/timeline_inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,7 +46,7 @@ |
|  |  | $t\_block\_css = $t\_collapse\_block ? 'collapsed' : ''; |
|  |  | $t\_block\_icon = $t\_collapse\_block ? 'fa-chevron-down' : 'fa-chevron-up'; |
|  |  |  |
|  |  | $t\_url\_page = $\_SERVER["PHP\_SELF"]; |
|  |  | $t\_url\_page = string\_sanitize\_url( basename( $\_SERVER['SCRIPT\_NAME'] ) ); |
|  |  | $t\_url\_params = $\_GET; |
|  |  | if( isset( $t\_url\_params['all'] ) ) { |
|  |  | unset( $t\_url\_params['all'] ); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a1c7193`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa1c719313d61b07bbe8700005807b8195fdc32f1) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_696c3560_20250126_124846.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa1c71931)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa1c71931)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  79](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/a1c719313d61b07bbe8700005807b8195fdc32f1)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix XSS in timeline\_inc.php

[Browse files](/mantisbt/mantisbt/tree/a1c719313d61b07bbe8700005807b8195fdc32f1)
Browse the repository at this point in the history

```
Use of $_SERVER['PHP_SELF'] and outputting it as-is allows an attacker
to inject arbitrary JavaScript as part of the URL.

Using SCRIPT_NAME and passing it through string_sanitize_url() instead
prevents the attack.

Fixes #22742
Fixes [#1094](https://github.com/mantisbt/mantisbt/pull/1094)
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Apr 18, 2017

1 parent
[27b5b29](/mantisbt/mantisbt/commit/27b5b292c9814a40fdd5715fa499a82e29f6f866)

commit a1c7193

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[core/timeline\_inc.php](#diff-cb97b9aef8315477424782708e149080852472f94454f1f68228c30a266008a2 "core/timeline_inc.php")

Show comments

[View file](/mantisbt/mantisbt/blob/a1c719313d61b07bbe8700005807b8195fdc32f1/core/timeline_inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,7 +46,7 @@ |
|  |  | $t\_block\_css = $t\_collapse\_block ? 'collapsed' : ''; |
|  |  | $t\_block\_icon = $t\_collapse\_block ? 'fa-chevron-down' : 'fa-chevron-up'; |
|  |  |  |
|  |  | $t\_url\_page = $\_SERVER["PHP\_SELF"]; |
|  |  | $t\_url\_page = string\_sanitize\_url( basename( $\_SERVER['SCRIPT\_NAME'] ) ); |
|  |  | $t\_url\_params = $\_GET; |
|  |  | if( isset( $t\_url\_params['all'] ) ) { |
|  |  | unset( $t\_url\_params['all'] ); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a1c7193`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa1c71931) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


