Based on the provided content, here's a breakdown of the vulnerability described by CVE-2017-7620:

**1. Root Cause:**

- The vulnerability stems from improper handling of backslashes (`\`) within the `string_sanitize_url()` function in MantisBT's `core/string_api.php` file. This function is intended to sanitize URLs, but it failed to account for escaped backslashes, allowing attackers to bypass the intended sanitization.

**2. Weaknesses/Vulnerabilities:**

- **CSRF (Cross-Site Request Forgery):** The `permalink_page.php` was vulnerable to CSRF, allowing an attacker to inject arbitrary links.
- **Open Redirection:** The `login_page.php` was vulnerable to open redirection, allowing an attacker to redirect users to arbitrary external URLs.
- **Insufficient Input Sanitization:** The core issue is that `string_sanitize_url()` function failed to properly sanitize user supplied URLs with escaped backslashes.

**3. Impact of Exploitation:**

- **Arbitrary Link Injection:** Attackers could inject malicious links into the MantisBT interface via the `permalink_page.php`, potentially leading users to phishing sites or other malicious content.
- **Open Redirection:** Attackers could redirect users to arbitrary websites via the login page. This could be exploited for phishing attacks or to mask malicious activity.

**4. Attack Vectors:**

- **CSRF:**  Attackers could craft a malicious web page that, when visited by a logged-in MantisBT user, would submit a form with a crafted URL to `permalink_page.php`.
- **Open Redirection:** Attackers can create a crafted URL with an escaped backslash in the `return` parameter, leading the user to an external site upon login.

**5. Required Attacker Capabilities/Position:**

- **Remote Attacker:** The attacker needs to be able to host a malicious web page or send a crafted URL that a MantisBT user would visit while logged in.
- **User Interaction:** The attack requires a logged-in MantisBT user to visit the malicious link or web page.
- No specific privileged access is required.

**Technical Details:**

- The `string_sanitize_url()` function in `core/string_api.php` was intended to check if a URL was internal to MantisBT. It used a regular expression to extract the script part of the URL.
- However, if a backslash (`\`) was included in the URL, the sanitization failed.  For example, a URL like `\/attacker.com` would be parsed by `string_sanitize_url()` as pointing to `attacker.com` and not as an internal resource.
- Example vulnerable URL: `<http://VICTIM-IP/mantisbt-2.3.0/permalink_page.php?url=\/ATTACKER-IP>`
- The fix involved encoding the backslashes as `%5C` in the script part of the URL to prevent redirection to external sites and adding a form security token to `permalink_page.php` to prevent CSRF.

**Patches:**

- The vulnerability was addressed in version 1.3.11 and later.
- The fix included changes to `core/filter_api.php`, `core/string_api.php`, `permalink_page.php` and tests (`tests/Mantis/StringTest.php`).
- Backslashes in URLs are now encoded as `%5C` to prevent bypassing the sanitization routine, ensuring URLs remain within the MantisBT domain. Additionally, CSRF tokens were implemented in permalink\_page.php.