```
{
  "cve": "CVE-2017-7654",
  "description": "It was discovered that Mosquitto broker incorrectly handled certain specially crafted input and network packets. A remote attacker could use this to cause a denial of service.",
  "affected_packages": [
    "mosquitto"
  ],
  "vulnerability_details": {
    "root_cause": "A memory leak vulnerability exists in the Mosquitto broker where a crafted CONNECT message, specifically one with an invalid protocol version, can trigger a memory leak because allocated memory for `protocol_name` is not freed in the error handling path. ",
    "weaknesses": [
      "Memory leak",
      "Improper error handling"
    ],
     "impact": "A remote unauthenticated attacker can cause a denial of service by sending crafted CONNECT packets that trigger the memory leak. Repeatedly exploiting this leak could exhaust server resources, leading to denial of service.",
    "attack_vectors": "The attack vector is remote. An attacker sends specially crafted MQTT CONNECT packets to the broker via network connections. The crafted packets include specific elements to trigger the memory leak in the error handling path.",
    "required_capabilities": "The attacker needs the ability to establish network connections and send MQTT packets to the vulnerable Mosquitto broker."
  },
    "additional_information": {
    "fix_details": "The fix involves allocating a fixed-size buffer for protocol name and validating its length before processing. If the length is invalid or if processing fails, the allocated memory is properly freed. It also changes the way the protocol name is read, using `_mosquitto_read_bytes` with size verification instead of `_mosquitto_read_string`.",
    "affected_versions": "Versions of Mosquitto before the fix are affected. The specific versions fixed include: 1.4.15-2ubuntu0.18.10.3, 1.4.15-2ubuntu0.18.04.3, 1.4.8-1ubuntu0.16.04.7, and 1.3.4-2+deb8u3.",
    "cwe": "CWE-401: Missing Release of Memory after Effective Lifetime"
  }
}
```