=== Content from github.com_9853ee65_20250125_001248.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fntop%2Fntopng%2Fcommit%2F01f47e04fd7c8d54399c9e465f823f0017069f8f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fntop%2Fntopng%2Fcommit%2F01f47e04fd7c8d54399c9e465f823f0017069f8f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ntop%2Fntopng)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ntop](/ntop)
/
**[ntopng](/ntop/ntopng)**
Public

* [Notifications](/login?return_to=%2Fntop%2Fntopng) You must be signed in to change notification settings
* [Fork
  663](/login?return_to=%2Fntop%2Fntopng)
* [Star
   6.4k](/login?return_to=%2Fntop%2Fntopng)

* [Code](/ntop/ntopng)
* [Issues
  214](/ntop/ntopng/issues)
* [Pull requests
  2](/ntop/ntopng/pulls)
* [Actions](/ntop/ntopng/actions)
* [Projects
  0](/ntop/ntopng/projects)
* [Wiki](/ntop/ntopng/wiki)
* [Security](/ntop/ntopng/security)
* [Insights](/ntop/ntopng/pulse)

Additional navigation options

* [Code](/ntop/ntopng)
* [Issues](/ntop/ntopng/issues)
* [Pull requests](/ntop/ntopng/pulls)
* [Actions](/ntop/ntopng/actions)
* [Projects](/ntop/ntopng/projects)
* [Wiki](/ntop/ntopng/wiki)
* [Security](/ntop/ntopng/security)
* [Insights](/ntop/ntopng/pulse)

## Commit

[Permalink](/ntop/ntopng/commit/01f47e04fd7c8d54399c9e465f823f0017069f8f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Security fix: prevents empty host from being used

[Browse files](/ntop/ntopng/tree/01f47e04fd7c8d54399c9e465f823f0017069f8f)
Browse the repository at this point in the history

* Loading branch information

[![@simonemainardi](https://avatars.githubusercontent.com/u/3397663?s=40&v=4)](/simonemainardi)

[simonemainardi](/ntop/ntopng/commits?author=simonemainardi "View all commits by simonemainardi")
committed
Feb 13, 2017

1 parent
[97515fd](/ntop/ntopng/commit/97515fd76b4e4ccb78dece5e2476af0213876577)

commit 01f47e0

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**4 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/Lua.cpp
    [Lua.cpp](#diff-244403abaf983d0c3a206fd7061dc64d1eb59ba65dd189856b983f4898a10b61)
  + src/NetworkInterface.cpp
    [NetworkInterface.cpp](#diff-57758010ff492d76bc022b034aefa549028041e56cdc4f39a024c2cbb9b90539)

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[src/Lua.cpp](#diff-244403abaf983d0c3a206fd7061dc64d1eb59ba65dd189856b983f4898a10b61 "src/Lua.cpp")

Show comments

[View file](/ntop/ntopng/blob/01f47e04fd7c8d54399c9e465f823f0017069f8f/src/Lua.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6018,7 +6018,8 @@ void Lua::setParamsTable(lua\_State\* vm, const char\* table\_name, |
|  |  | char \*\_equal; |
|  |  |  |
|  |  | if(strncmp(tok, "csrf", strlen("csrf")) /\* Do not put csrf into the params table \*/ |
|  |  | && (\_equal = strchr(tok, '='))) { |
|  |  | && (\_equal = strchr(tok, '=')) |
|  |  | && (strlen(\_equal) > 1)) { |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fntop%2Fntopng%2Fcommit%2F01f47e04fd7c8d54399c9e465f823f0017069f8f)       Sorry, something went wrong.           Copy link    Quote reply     @emanuele-f **[emanuele-f](/emanuele-f)** [Feb 14, 2017](#r20875629) Contributor   [@simonemainardi](https://github.com/simonemainardi) this cuts off some valid empty parameters, like "custom\_name"      All reactions          This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fntop%2Fntopng%2Fcommit%2F01f47e04fd7c8d54399c9e465f823f0017069f8f)       Sorry, something went wrong.           Copy link    Quote reply     @simonemainardi **[simonemainardi](/simonemainardi)** [Feb 14, 2017](#r20876135) Author  Contributor   with this I am no longer allowing empty-string parameters. If you want to release this extra check, please double check for other possible NULL pointer dereferencing as in line 2203 below      All reactions | | |
|  |  | char \*decoded\_buf; |
|  |  | int len; |
|  |  |  |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[src/NetworkInterface.cpp](#diff-57758010ff492d76bc022b034aefa549028041e56cdc4f39a024c2cbb9b90539 "src/NetworkInterface.cpp")

Show comments

[View file](/ntop/ntopng/blob/01f47e04fd7c8d54399c9e465f823f0017069f8f/src/NetworkInterface.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2200,6 +2200,8 @@ Host\* NetworkInterface::getHost(char \*host\_ip, u\_int16\_t vlan\_id) { |
|  |  | struct in6\_addr a6; |
|  |  | Host \*h = NULL; |
|  |  |  |
|  |  | if(!host\_ip) return(NULL); |
|  |  |  |
|  |  | /\* Check if address is invalid \*/ |
|  |  | if((inet\_pton(AF\_INET, (const char\*)host\_ip, &a4) == 0) |
|  |  | && (inet\_pton(AF\_INET6, (const char\*)host\_ip, &a6) == 0)) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `01f47e0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fntop%2Fntopng%2Fcommit%2F01f47e04fd7c8d54399c9e465f823f0017069f8f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7ba2f6ea_20250125_001247.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fntop%2Fntopng%2Fblob%2F3.0%2FCHANGELOG.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fntop%2Fntopng%2Fblob%2F3.0%2FCHANGELOG.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=ntop%2Fntopng)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ntop](/ntop)
/
**[ntopng](/ntop/ntopng)**
Public

* [Notifications](/login?return_to=%2Fntop%2Fntopng) You must be signed in to change notification settings
* [Fork
  663](/login?return_to=%2Fntop%2Fntopng)
* [Star
   6.4k](/login?return_to=%2Fntop%2Fntopng)

* [Code](/ntop/ntopng/tree/3.0)
* [Issues
  214](/ntop/ntopng/issues)
* [Pull requests
  2](/ntop/ntopng/pulls)
* [Actions](/ntop/ntopng/actions)
* [Projects
  0](/ntop/ntopng/projects)
* [Wiki](/ntop/ntopng/wiki)
* [Security](/ntop/ntopng/security)
* [Insights](/ntop/ntopng/pulse)

Additional navigation options

* [Code](/ntop/ntopng/tree/3.0)
* [Issues](/ntop/ntopng/issues)
* [Pull requests](/ntop/ntopng/pulls)
* [Actions](/ntop/ntopng/actions)
* [Projects](/ntop/ntopng/projects)
* [Wiki](/ntop/ntopng/wiki)
* [Security](/ntop/ntopng/security)
* [Insights](/ntop/ntopng/pulse)

## Files

 3.0
## Breadcrumbs

1. [ntopng](/ntop/ntopng/tree/3.0)
/
# CHANGELOG.md

Copy path Blame  Blame
## Latest commit

## History

[History](/ntop/ntopng/commits/3.0/CHANGELOG.md)170 lines (149 loc) · 6.77 KB 3.0
## Breadcrumbs

1. [ntopng](/ntop/ntopng/tree/3.0)
/
# CHANGELOG.md

Top
## File metadata and controls

* Preview
* Code
* Blame

170 lines (149 loc) · 6.77 KB[Raw](https://github.com/ntop/ntopng/raw/refs/tags/3.0/CHANGELOG.md)
# Changelog

#### ntopng 3.0 (May 2017)

## New features (Community)

* Layer-2 Devices
  + MAC devices page
  + Implemented MAC last seen tracking in redis
  + Manufacturer filter and sort
* Host pools (logical groups of hosts)
* Logstash flow export extension
* Implemented data anonymization: hosts and top sites
* Implements CPU load average and memory usage
* Virtual Interfaces
  + ZMQ: disaggregate based on probeIP or ingress interfaceId
  + Packet: disaggregate on VLANId
* ElasticSearch and MySQL flow export statistics
* Tiny Flows
* Alerts
  + Implements alerts on a per-interface per-vlan basis
  + Global alert thresolds for all local hosts/interfaces/local networks
  + LUA alerts generation
  + Adds hosts stateful syn attacks alerts
  + Visualization/Retrieval of Host Alerts
  + Added the ability to generate alert when ntopng detects traffic produced by malware hosts
  + Slack integration: send alerts to slack
  + Alerts for anomalous flows
  + Host blacklisted alerts
  + Alerts delete by type, older than, by host
  + SSL certificates mismatch alerts generation
* Implement SSL/TLS handshake detection
* Integrated MSDN support
* Implemented DHCP dissection for name resolution

## New features

* Traffic bridging
  + Per host pool, per host pool member policies
  + Per L7 protocol category policies
  + Flashstart categories to block
  + Time and Traffic quotas
  + Support to google Safe Search DNS
  + Ability to set custom DNS
* Captive portal
  + Limited lifetime users
  + Support for pc, kindle, android, ipad devices
* SNMP
  + Periodic SNMP device monitoring and polling
  + Historical SNMP timeseries
  + Host-to-SNMP devices mapping
* Daily/Weekly/Monthly Traffic Report: per host, interface, network
* Added ability to define host blacklists
* DNS flow characterization with FlashStart ([www.flashstart.it](http://www.flashstart.it))
* Flow LUA scripts: on flow creation, protocol detected, expire
* Periodic MySQL flows aggregation
* Batched MySQL flows insertions
* sFlow device/interface counters
* Implementation of flow devices stats

## Improvements

* Allows web server binding to system ports for non-privileged users
* Improved VLAN support
* Improved IPv6 support
* Implements a script to add users from the command line
* View interfaces rework
* Reported number of Layer-2 devices in ntopng footer
* Preferences re-organization and search
* Adds RIPE integration for Autonomous Systems
* Search host by custom name
* Move to the UTF-8 encoding
* Make real-time statics refresh time configurable (footer, dashboard)
* Adds support for localization (i18n)
* Traffic bridging: improved stability
* Traffic profiles: improved stability and data persistence
* Charts
  + Improved historical graphs
  + Traffic report rework and optimizations
  + Improves the responsiveness and interactivity of historical exploration (ajax)
  + Stacked top hosts
  + Add ZMQ flows/sec graph
  + Profiles graphs
  + Implemented ICMP detailed stats for local hosts
  + ASN graphs: traffic and protocols history
  + ARP requests VS replies sent and received by hosts
  + Implement host TCP flags distribution
  + DNS packets ratio
  + FlashStart category graphs
  + Added ARP protocol in interface statistics
  + SNMP port graphs

## Voip (nProbe required)

* Changes and rework for SIP and RTP protocol
* Adds VoIP SIP to RTP flow search
* Improves VoIP visualization (RTP)

## Security Fixes

* Disable TLS 1.0 (vulnerable) in mongoose
* Disabled insecure cyphers in SSL (when using ntopng over SSL)
* Hardens the code to prevent SQL injections
* Enforce POST form CSRF to prevent programmer mistakes
* Strict GET and POST parameters validation to prevent XSS
* Prevent HTTP splitting attacks
* Force default admin password change

---

#### ntopng 2.4.0

* Fundamental memory-management, stability and speed improvements
* Security fixes to prevent privileges escalation and XSS
* Improved alerts with support for
  + Re-arming
  + Nagios
  + Network-based triggers
  + Suspicious probing attempts
* Netfilter support with optional packet dropping features
* Routing visibility through RIPE
* Hosts/flows listing and grouping facilities implemented directly into the C core rather than in Lua
* Fine-grained historical data drill-down features in the Professional/Small Business version. Features include top talkers, top applications, and interactions between hosts.
* Integrations with other tools:
  + LDAP authentication support
  + alerts forwarding/withdrawal to Nagios
  + nBox integration to request pcaps of monitored flows
  + Apache Kafka flows export
* Extended and improved traffic *monitoring*:
  + TCP sessions throughput estimations and state breakdown (e.g., established, reset, etc.)
  + Goodput monitoring
  + Trends detection
  + Highlight of low-goodput flows and hosts
  + Added hosts top-visited sites
* Built-in support for:
  + GRE detunnelling
  + per-VLAN historical statistics
  + ICMP and ICMPv6 dissection
* Extended and improved supported OSes: Ubuntu 16, Debian 7, EdgeOS
* Optional support for hosts categorization via service `flashstart.it`
* New options:
  + `--capture-direction` that allows the user to chose which direction to monitor (tx only, rx only, or both)
  + `--zmq-collector-mode` to assure proper nProbe flow collection behind firewalls
  + `--online-license-check` for to check licenses online
  + `--print-ndpi-protocols` to print nDPI Layer-7 application protocols supported

#### ntopng 2.2.0

* Implementation of **traffic profiles**, logical flow-based aggregations -- e.g., Facebook traffic originating at host X. Real-time statistics as well as historical data are collected for each traffic profile
* Added a **fine-grained network traffic breakdown** that captures and stores ingress, egress, and inner traffic for each local network
* Ex-novo redesign of historical interfaces. Historical interface data have been seamlessly integrated with real-time data
* Historical flow dump and runtime drill-down of historical data with support for MySQL and ElasticSearch
* Built-in support for protocols:
  + CAPWAP (Control And Provisioning of Wireless Access Points, <https://tools.ietf.org/html/rfc5415>)
  + BATMAN (<http://www.open-mesh.org/projects/open-mesh/wiki/BATMANConcept>)
  + TZSP (TaZmen Sniffer Protocol)
* Added SIP and RTP protocols information in flow details
* Additional MAC-based host classification
* Added support for Linux TUN/TAP devices in TUN mode
* Extended and improved supported OSes: EdgeOS, Centos 6/7, Ubuntu 12.04/14.04, Debian, Windows x64, Raspbian (Raspberry)
* Extended and improved supported architectures: x86, x86-64, MIPS, ARM.
* Documentation and User Guide significantly improved
* Added a great deal of READMEs, including ElasticSearch, bridging, traffic shaping and policing, NetBeans development
* Improved stability both under normal and high network loads
* Fixed tens of minor bugs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


