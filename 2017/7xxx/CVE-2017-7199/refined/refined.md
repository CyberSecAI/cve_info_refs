```
{
  "vulnerability": {
    "cve_id": "CVE-2017-7199",
    "description": "Nessus 6.6.2 - 6.10.3 contains a flaw related to insecure permissions that may allow a local attacker to escalate privileges when the software is running in Agent Mode. Version 6.10.4 fixes this issue.",
    "technical_details": {
      "root_cause": "The Tenable Nessus Agent service (nessusd.exe), running as SYSTEM, attempts to execute `java.exe` located in the `plugins` directory. The `plugins` directory and its subdirectories under `c:\\programdata\\tenable\\nessus agent` have default ACLs that allow low-privileged users to write files and create directories. Additionally, the agent uses `DeleteFileA` function which is not intended for deleting directories and fails when it encounters a directory.",
       "weaknesses": [
        "Insecure file/directory permissions: The default ACLs on `c:\\programdata\\tenable\\nessus agent` allow low-privileged users to create directories and files.",
        "Improper deletion: The service uses `DeleteFileA` instead of `RemoveDirectory` function to remove `java.exe` which is vulnerable to path manipulation by creating a directory."
      ],
      "impact": "A low-privileged local user can escalate to SYSTEM privileges.",
      "attack_vectors": [
        "Local access: The attacker needs local access to the target machine.",
        "File system manipulation: The attacker needs the ability to create a directory named `java.exe` in the plugins directory and copy a malicious executable to `java -version.exe` within that directory."
      ],
      "required_attacker_capabilities": [
        "Ability to create directories and write files to `c:\\programdata\\tenable\\nessus agent\\plugins`",
        "Ability to trigger a restart of the Nessus agent service or reboot the machine."
      ],
       "exploit_steps": [
        "Create a directory named `java.exe` within `c:\\programdata\\tenable\\nessus agent\\plugins`. ",
        "Copy a malicious executable and rename it to `java -version.exe` inside the created directory.",
        "Trigger a restart of the Nessus agent service, or reboot the machine.",
        "The nessusd.exe service will then execute the `java -version.exe` with SYSTEM privileges."
      ]
    },
    "remediation": "Upgrade to Nessus version 6.10.4 or later.",
    "references": [
      "https://www.tenable.com/security/tns-2017-08",
      "https://aspe1337.blogspot.nl/2017/04/writeup-of-cve-2017-7199.html",
      "http://www.securitytracker.com/id/1038124",
      "http://www.securityfocus.com/bid/97110"
    ]
  }
}
```