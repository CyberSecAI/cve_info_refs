Based on the provided content, here's a breakdown of the vulnerability described in CVE-2017-7280:

**Root Cause of Vulnerability:**
- The vulnerability lies in the `change_system_password` function within the `/api/includes/systems.php` file of Unitrends appliances. This function uses `popen` to execute the `passwd` command for changing system user passwords.
- The core issue is that the function fails to sanitize the username passed to the `passwd` command. Specifically, backticks (``) are not properly escaped or filtered, which allows for command injection.

**Weaknesses/Vulnerabilities Present:**
- **Command Injection:** The `popen` function executes a command string constructed with user-supplied data without proper sanitization. This enables an attacker to inject arbitrary commands by using backticks within the username parameter, leading to arbitrary code execution on the server.
- **Lack of Input Validation:** The application does not validate or sanitize the user input passed to the `change_system_password` function, specifically the `user` parameter.
- **Running Webserver as Root:** The Unitrends appliance runs the webserver as root, which is necessary for changing user passwords. This amplifies the impact of the command injection vulnerability as injected commands are executed with root privileges.

**Impact of Exploitation:**
- **Remote Code Execution (RCE):** Successful exploitation allows a remote attacker to execute arbitrary commands on the server with root privileges.
- **Complete System Compromise:** With the ability to execute arbitrary commands as root, an attacker can take full control of the Unitrends appliance, potentially leading to data breaches, denial of service, or further lateral movement within the network.

**Attack Vectors:**
- **HTTP Request:** The vulnerability can be exploited by crafting a malicious HTTP request to the `/recoveryconsole/bpl/password.php` endpoint.
- **`$_REQUEST` Variable Manipulation:** The `$_REQUEST` variables, particularly 'user', are used to pass the malicious payload.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to have network access to the Unitrends appliance's web interface.
- **Authentication:** The attacker needs a valid 'AuthToken' which is set as a cookie after a succesfull login. This suggests that the attacker needs to be able to authenticate to the application (either with valid credentials or by using the default password mentioned) before they can exploit the vulnerability.

**Additional Details:**
- The vulnerability is present in Unitrends versions prior to 9.0.0.
- The specific vulnerability can be exploited by injecting commands into the `user` parameter, as shown in the example using  `sleep 10`, using a crafted HTTP POST request to `/recoveryconsole/bpl/password.php`.
- A python script was created to automate the process of sending the malicious payload.

The provided content includes code snippets from the vulnerable file, showing the problematic `popen` command and the context in which the function is called from `password.php` and it also demonstrates the exploitation process, and also explains how to obtain the 'AuthToken' required for making requests.