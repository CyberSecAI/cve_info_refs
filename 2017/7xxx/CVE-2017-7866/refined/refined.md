The provided content is related to CVE-2017-7866.

**Root cause of vulnerability:**
The vulnerability is caused by an off-by-one error in the `decode_zbuf` function in `libavcodec/pngdec.c`. Specifically, the `zstream.avail_out` variable was being decremented by 1 after it had already been set with the buffer size.

**Weaknesses/vulnerabilities present:**
- Off-by-one error leading to potential out-of-bounds access.

**Impact of exploitation:**
- Out-of-bounds read/write, which can cause program crashes or potentially lead to arbitrary code execution.

**Attack vectors:**
- Processing a specially crafted PNG file with a malformed zlib compressed data stream.

**Required attacker capabilities/position:**
- The attacker needs to be able to supply the vulnerable application with a crafted PNG file.