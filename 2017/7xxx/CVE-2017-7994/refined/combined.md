=== Content from github.com_f4d40e81_20250124_213834.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ficepng%2FPoC%2Ftree%2Fmaster%2FPoC1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ficepng%2FPoC%2Ftree%2Fmaster%2FPoC1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=icepng%2FPoC)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[icepng](/icepng)
/
**[PoC](/icepng/PoC)**
Public

* [Notifications](/login?return_to=%2Ficepng%2FPoC) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Ficepng%2FPoC)
* [Star
   0](/login?return_to=%2Ficepng%2FPoC)

* [Code](/icepng/PoC)
* [Issues
  0](/icepng/PoC/issues)
* [Pull requests
  0](/icepng/PoC/pulls)
* [Actions](/icepng/PoC/actions)
* [Projects
  0](/icepng/PoC/projects)
* [Security](/icepng/PoC/security)
* [Insights](/icepng/PoC/pulse)

Additional navigation options

* [Code](/icepng/PoC)
* [Issues](/icepng/PoC/issues)
* [Pull requests](/icepng/PoC/pulls)
* [Actions](/icepng/PoC/actions)
* [Projects](/icepng/PoC/projects)
* [Security](/icepng/PoC/security)
* [Insights](/icepng/PoC/pulse)

## Files

 master
## Breadcrumbs

1. [PoC](/icepng/PoC/tree/master)
/
# PoC1

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/icepng/PoC/commits/master/PoC1) master
## Breadcrumbs

1. [PoC](/icepng/PoC/tree/master)
/
# PoC1

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/icepng/PoC/tree/master) | | |
| [PoC](/icepng/PoC/blob/master/PoC1/PoC "PoC") | | [PoC](/icepng/PoC/blob/master/PoC1/PoC "PoC") |  |  |
| [analysis.md](/icepng/PoC/blob/master/PoC1/analysis.md "analysis.md") | | [analysis.md](/icepng/PoC/blob/master/PoC1/analysis.md "analysis.md") |  |  |
| View all files | | |

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from icepng.github.io_348d8261_20250124_213835.html ===

[ICEPNG](/)

[Archives](/archives)
[Categories](/categories)
[Vuls](/categories/vuls)
[5G](/categories/5G)
[iots](/categories/iots)

[1  **Analyzer**](#Analyzer)

---

[2  **Crash Info**](#Crash-Info)

---

[3  **analysis**](#analysis)

# PoDoFo 0.9.5 NULL pointer dereference

Apr 21 2017

2 minutes read (About 365 words)

PoDoFo 0.9.5 function TextExtractor::ExtractText in TextExtractor.cpp:77 cause a NULL pointer dereference

## Analyzer

code from <https://sourceforge.net/p/podofo/code/HEAD/tree/podofo/trunk/> (2017-04-09)

compile:

| ``` 12 ``` | ``` cmake -G "Unix Makefiles" -DCMAKE_INSTALL_PREFIX=/home/icepng/aaaa/ -DCMAKE_BUILD_TYPE=DEBUG -DCMAKE_EXE_LINKER_FLAGS="-fsanitize=address -fno-omit-frame-pointer" ../make -j ``` |
| --- | --- |

and run it:

| ``` 1 ``` | ``` ./podofo-code/podofo/trunk/build/tools/podofotxtextract/podofotxtextract ./PoC ``` |
| --- | --- |

## Crash Info

| ``` 12345678910111213 ``` | ``` ===================================================================12966==ERROR: AddressSanitizer: SEGV on unknown address 0xbebec0bd (pc 0x080f4c21 bp 0xbf8fcbc8 sp 0xbf8fcbc0 T0)    #0 0x80f4c20 in PoDoFo::PdfVariant::DelayedLoad() const /home/icepng/podofo-code/podofo/trunk/podofo/base/../../src/base/PdfVariant.h:545    #1 0x80f4c8f in PoDoFo::PdfVariant::GetReal() const /home/icepng/podofo-code/podofo/trunk/src/base/PdfVariant.h:675    #2 0x80f38af in TextExtractor::ExtractText(PoDoFo::PdfMemDocument*, PoDoFo::PdfPage*) /home/icepng/podofo-code/podofo/trunk/tools/podofotxtextract/TextExtractor.cpp:77    #3 0x80f36a5 in TextExtractor::Init(char const*) /home/icepng/podofo-code/podofo/trunk/tools/podofotxtextract/TextExtractor.cpp:48    #4 0x80f6ceb in main /home/icepng/podofo-code/podofo/trunk/tools/podofotxtextract/podofotxtextract.cpp:52    #5 0xb6a9b636 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x18636)    #6 0x80f3470  (/home/icepng/podofo-code/podofo/trunk/build/tools/podofotxtextract/podofotxtextract+0x80f3470)AddressSanitizer can not provide additional info.SUMMARY: AddressSanitizer: SEGV /home/icepng/podofo-code/podofo/trunk/podofo/base/../../src/base/PdfVariant.h:545 PoDoFo::PdfVariant::DelayedLoad() const==12966==ABORTING ``` |
| --- | --- |

## analysis

and the Process is easy, When use podofotxtextract to extract txt info from a pdf file, first extract the input file to a PdfMemDocument object, and then let each page to a PdfContentsTokenizer object, which contained many tokens, and last deal each token.

| ``` 12345678910111213141516 ``` | ``` if( eType == ePdfContentsType_Keyword )        {            // support 'l' and 'm' tokens            if( strcmp( pszToken, "l" ) == 0 ||  // l: line to                 strcmp( pszToken, "m" ) == 0 )  // m: move to             {                dCurPosX = stack.top().GetReal();                stack.pop();                dCurPosY = stack.top().GetReal();                stack.pop();            }......else if ( eType == ePdfContentsType_Variant )        {            stack.push( var );        } ``` |
| --- | --- |

I set the breakpoints and I found there had 45 ePdfContentsType\_Variant but 23 MoveTo Tokens.
so stack.top() will be NULL in “dCurPosY = stack.top().GetReal();”, then cause a NULL point dereference.
So the upstream don’t give strict check about Path Construction Operators “MoveTo”.

[如何快速识别DLL劫持漏洞](/2017/05/08/DLL-Hijacking/)

[jbig2dec-vul](/2017/04/20/jbig2dec-vul/)

© 2020 icepng
Powered by [Hexo](http://hexo.io/) & [Minos](http://github.com/ppoffice/hexo-theme-minos)

###### Your browser is out-of-date!

Update your browser to view this website correctly. [Update my browser now](http://outdatedbrowser.com/)

×


