Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2017-7472:

**Root Cause of Vulnerability:**

The vulnerability stems from a flaw in the `keyctl_set_reqkey_keyring()` function within the Linux kernel's KEYS subsystem. This function was incorrectly creating a new thread keyring every time it was called with the `KEY_REQKEY_DEFL_THREAD_KEYRING` flag, even if a thread keyring already existed for the current thread. This resulted in a memory leak, as the old keyrings were not being properly freed when new ones were allocated.

**Weaknesses/Vulnerabilities Present:**

* **Uncontrolled Memory Consumption:** The vulnerability allowed an unprivileged local user to repeatedly trigger the creation of new thread keyrings via the `keyctl_set_reqkey_keyring()` system call, leading to excessive memory consumption in the kernel.
* **Incorrect Handling of Existing Keyrings**: The function logic was flawed because, instead of reusing the existing keyring, the function created new ones, leading to a memory leak.

**Impact of Exploitation:**

* **Denial of Service (DoS):** Repeated calls to `keyctl_set_reqkey_keyring()` using the vulnerable function would eventually exhaust the kernel's memory, resulting in a denial of service. The system could become unresponsive, crash, or otherwise become unusable.

**Attack Vectors:**

* **Local User Exploitation:** A local user with low privileges can trigger the vulnerability by executing a program or script containing repeated `keyctl_set_reqkey_keyring()` calls with the `KEY_REQKEY_DEFL_THREAD_KEYRING` flag.

**Required Attacker Capabilities/Position:**

* **Local User Access:** The attacker needs to have local user access to the system. No special privileges beyond a normal user account are required to exploit this vulnerability.

**Additional Details:**

*   The vulnerability was present in the Linux kernel before version 4.10.13.
*   The issue was fixed by adding a check to see if a thread keyring already existed. If it does, the function would then return 0 instead of creating a new one.
*   The fix also updated the `install_thread_keyring_to_cred()` and `install_process_keyring_to_cred()` functions to return 0 if the corresponding keyring is already present.
*   The fix was introduced by the commit `c9f838d104fed6f2f61d68164712e3204bf5271b` in the Linux kernel.

The provided content provides a clear description of a memory leak vulnerability leading to a local DoS in the Linux kernel.