=== Content from bugzilla.mozilla.org_88e5a220_20250126_041501.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1368490)
* [XML](/show_bug.cgi?ctype=xml&id=1368490)

Closed
[Bug 1368490](/show_bug.cgi?id=1368490)
(CVE-2017-7758)

Opened 8 years ago
Closed 8 years ago

# Write past end of allocation in InterleaveTrackData

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Write past end of allocation in InterleaveTrackData

## Categories

### (Core :: Audio/Video: Playback, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Audio%2FVideo%3A%20Playback#Audio%2FVideo%3A%20Playback)

Audio/Video: Playback
▾

Core :: Audio/Video: Playback
For problems related to the HTML 5 media elements (<video> and <audio>) -- including WebM, MP4, MSE and EME issues. This would also typically include decoding problems in the codecs themselves (e.g. VP8, VP9, H.264, AAC) experienced during playback.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Audio%2FVideo%3A%20Playback&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Audio%2FVideo%3A%20Playback&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Audio%2FVideo%3A%20Playback)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

43 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla55

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=wontfix) |
| firefox-esr52 | [54+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=54%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=verified) |
| firefox53 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix) |
| firefox54 | [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=verified) |
| firefox55 | [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 |  | wontfix |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr52 | 54+ | verified |
| firefox53 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox54 | + | verified |
| firefox-esr128 | --- | --- |
| firefox55 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: ntrippar, Assigned: bryce)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/6226491cc7996ff7ecf805b6c0ca7f2b?d=mm&size=40)  [bryce](/user_profile?user_id=560379)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/6f6eefa8fdefe22e00e619f0e8240a40?d=mm&size=40)  [ntrippar](/user_profile?user_id=596168)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jimm](/user_profile?user_id=279663)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

22 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[901633](/show_bug.cgi?id=901633 "RESOLVED FIXED - Improve internal support for stereo audio in the webrtc media pipeline")

Dependency [tree](/showdependencytree.cgi?id=1368490&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1368490)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-bounds, reporter-external, sec-high, Whiteboard: [post-critsmash-triage][adv-main54+][adv-esr52.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2017-7758

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main54+][adv-esr52.2+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a614034_1689 "8 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c35 "7 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [poc.html](/attachment.cgi?id=8872359)  [8 years ago](#c0)  [ntrippar](/user_profile?user_id=596168)   625 bytes, text/html |  | [Details](/attachment.cgi?id=8872359&action=edit) |
| --- | --- | --- |
| [Make sure number of channels is correctly set for opus encoder](/attachment.cgi?id=8872553)  [8 years ago](#c5)  [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)   1.83 KB, patch | jesup : [review+](#a203166_11539 "8 years ago")  abillings : [approval-mozilla-beta+](#c22 "8 years ago")  abillings : [approval-mozilla-esr52+](#c22 "8 years ago")  abillings : [sec-approval+](#c22 "8 years ago") | [Details](/attachment.cgi?id=8872553&action=edit) | [Diff](/attachment.cgi?id=8872553&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872553) |
| [Add crashtest for media recorder when reducing number of source stream channels](/attachment.cgi?id=8872791)  [8 years ago](#c13)  [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)   2.07 KB, patch |  | [Details](/attachment.cgi?id=8872791&action=edit) | [Diff](/attachment.cgi?id=8872791&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872791) |
| [Add crashtest for media recorder when reducing number of source stream channels](/attachment.cgi?id=8872793)  [8 years ago](#c14)  [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)   2.01 KB, patch | jesup : [review+](#c16 "8 years ago")  abillings : [sec-approval+](#c32 "7 years ago") | [Details](/attachment.cgi?id=8872793&action=edit) | [Diff](/attachment.cgi?id=8872793&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872793) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [ntrippar](/user_profile?user_id=596168)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1368490#c0)• 8 years ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=8872359)
— [Details](attachment.cgi?id=8872359&action=edit)

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_12\_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
Steps to reproduce:
open the file and it will crash. now you added the vector accessor checks. in tor browser in my last test was maybe exploitable because didnt have that check
Actual results:
=================================================================
==23790==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x00000051b5b6 bp 0x7fa3d2c89e50 sp 0x7fa3d2c89ce0 T25)
==23790==The signal is caused by a WRITE memory access.
==23790==Hint: address points to the zero page.
#0 0x51b5b5 in MOZ\_CrashPrintf /home/worker/workspace/build/src/mfbt/Assertions.cpp:63:3
#1 0x7fa4370e5ebf in InvalidArrayIndex\_CRASH(unsigned long, unsigned long) /home/worker/workspace/build/src/xpcom/ds/nsTArray.cpp:26:3
#2 0x7fa43c182296 in ElementAt /home/worker/workspace/build/src/obj-firefox/dist/include/nsTArray.h:1043:7
#3 0x7fa43c182296 in operator[] /home/worker/workspace/build/src/obj-firefox/dist/include/nsTArray.h:1081
#4 0x7fa43c182296 in mozilla::AudioTrackEncoder::InterleaveTrackData(mozilla::AudioChunk&, int, unsigned int, float\*) /home/worker/workspace/build/src/dom/media/encoder/TrackEncoder.cpp:151
#5 0x7fa43c17dfd7 in mozilla::OpusTrackEncoder::GetEncodedTrack(mozilla::EncodedFrameContainer&) /home/worker/workspace/build/src/dom/media/encoder/OpusTrackEncoder.cpp:349:9
#6 0x7fa43c1794a6 in mozilla::MediaEncoder::WriteEncodedDataToMuxer(mozilla::TrackEncoder\*) /home/worker/workspace/build/src/dom/media/encoder/MediaEncoder.cpp:344:32
#7 0x7fa43c1779f5 in mozilla::MediaEncoder::GetEncodedData(nsTArray<nsTArray<unsigned char> >\*, nsAString&) /home/worker/workspace/build/src/dom/media/encoder/MediaEncoder.cpp:290:12
#8 0x7fa43c0aa574 in mozilla::dom::MediaRecorder::Session::Extract(bool) /home/worker/workspace/build/src/dom/media/MediaRecorder.cpp:620:15
#9 0x7fa43c0aa0aa in mozilla::dom::MediaRecorder::Session::ExtractRunnable::Run() /home/worker/workspace/build/src/dom/media/MediaRecorder.cpp:278:19
#10 0x7fa4371bd02e in nsThread::ProcessNextEvent(bool, bool\*) /home/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1321:14
#11 0x7fa4371c8db8 in NS\_ProcessNextEvent(nsIThread\*, bool) /home/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:472:10
#12 0x7fa437f6e800 in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate\*) /home/worker/workspace/build/src/ipc/glue/MessagePump.cpp:338:20
#13 0x7fa437ecae00 in RunInternal /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:238:10
#14 0x7fa437ecae00 in RunHandler /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:231
#15 0x7fa437ecae00 in MessageLoop::Run() /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:211
#16 0x7fa4371b5502 in nsThread::ThreadFunc(void\*) /home/worker/workspace/build/src/xpcom/threads/nsThread.cpp:501:11
#17 0x7fa4517d8453 in \_pt\_root /home/worker/workspace/build/src/nsprpub/pr/src/pthreads/ptthread.c:216:5
#18 0x7fa45519f6d9 in start\_thread (/lib/x86\_64-linux-gnu/libpthread.so.0+0x76d9)
#19 0x7fa45422517e in clone /build/glibc-cxyGtm/glibc-2.24/misc/../sysdeps/unix/sysv/linux/x86\_64/clone.S:105
AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /home/worker/workspace/build/src/mfbt/Assertions.cpp:63:3 in MOZ\_CrashPrintf
Thread T25 (Media\_Encoder) created by T0 (Web Content) here:
#0 0x4a3d56 in \_\_interceptor\_pthread\_create /builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan\_interceptors.cc:245:3
#1 0x7fa4517d51f9 in \_PR\_CreateThread /home/worker/workspace/build/src/nsprpub/pr/src/pthreads/ptthread.c:457:14
#2 0x7fa4517d4e0e in PR\_CreateThread /home/worker/workspace/build/src/nsprpub/pr/src/pthreads/ptthread.c:548:12
#3 0x7fa4371b7737 in nsThread::Init(nsACString const&) /home/worker/workspace/build/src/xpcom/threads/nsThread.cpp:682:8
#4 0x7fa4371c1fff in nsThreadManager::NewNamedThread(nsACString const&, unsigned int, nsIThread\*\*) /home/worker/workspace/build/src/xpcom/threads/nsThreadManager.cpp:273:22
#5 0x7fa4371c4213 in NS\_NewNamedThread(nsACString const&, nsIThread\*\*, nsIRunnable\*, unsigned int) /home/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:113:45
#6 0x7fa43c0a5a2a in NS\_NewNamedThread<14> /home/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:72:10
#7 0x7fa43c0a5a2a in mozilla::dom::MediaRecorder::Session::InitEncoder(unsigned char, int) /home/worker/workspace/build/src/dom/media/MediaRecorder.cpp:771
#8 0x7fa43c0a6b3f in mozilla::dom::MediaRecorder::Session::TracksAvailableCallback::NotifyTracksAvailable(mozilla::DOMMediaStream\*) /home/worker/workspace/build/src/dom/media/MediaRecorder.cpp:355:17
#9 0x7fa43be42753 in mozilla::DOMMediaStream::CheckTracksAvailable() /home/worker/workspace/build/src/dom/media/DOMMediaStream.cpp:1287:19
#10 0x7fa43be5f112 in applyImpl<mozilla::DOMMediaStream, void (mozilla::DOMMediaStream::\*)()> /home/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1084:12
#11 0x7fa43be5f112 in apply<mozilla::DOMMediaStream, void (mozilla::DOMMediaStream::\*)()> /home/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1090
#12 0x7fa43be5f112 in mozilla::detail::RunnableMethodImpl<mozilla::DOMMediaStream\*, void (mozilla::DOMMediaStream::\*)(), true, (mozilla::RunnableKind)0>::Run() /home/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:1133
#13 0x7fa4371bd02e in nsThread::ProcessNextEvent(bool, bool\*) /home/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1321:14
#14 0x7fa4371c8db8 in NS\_ProcessNextEvent(nsIThread\*, bool) /home/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:472:10
#15 0x7fa437f6d461 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate\*) /home/worker/workspace/build/src/ipc/glue/MessagePump.cpp:96:21
#16 0x7fa437ecae00 in RunInternal /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:238:10
#17 0x7fa437ecae00 in RunHandler /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:231
#18 0x7fa437ecae00 in MessageLoop::Run() /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:211
#19 0x7fa43d37b80f in nsBaseAppShell::Run() /home/worker/workspace/build/src/widget/nsBaseAppShell.cpp:156:27
#20 0x7fa440c0eea7 in XRE\_RunAppShell() /home/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:893:22
#21 0x7fa437ecae00 in RunInternal /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:238:10
#22 0x7fa437ecae00 in RunHandler /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:231
#23 0x7fa437ecae00 in MessageLoop::Run() /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:211
#24 0x7fa440c0e909 in XRE\_InitChildProcess(int, char\*\*, XREChildData const\*) /home/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:709:34
#25 0x4eb7a3 in content\_process\_main /home/worker/workspace/build/src/browser/app/../../ipc/contentproc/plugin-container.cpp:64:30
#26 0x4eb7a3 in main /home/worker/workspace/build/src/browser/app/nsBrowserApp.cpp:285
#27 0x7fa45413d3f0 in \_\_libc\_start\_main /build/glibc-cxyGtm/glibc-2.24/csu/../csu/libc-start.c:291
==23790==ABORTING

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1368490#c1)• 8 years ago |
|  | |

Maire or Chris, can you forward to the relevant folks? Thanks!Group: firefox-core-security → core-securityComponent: Untriaged → Audio/Video: PlaybackFlags: needinfo?(mreavy)Flags: needinfo?(cpearce)Product: Firefox → Core

|  | [Chris Pearce [:cpearce (Not reading bugmail)]](/user_profile?user_id=287422) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1368490#c2)• 8 years ago |
|  | |

Bryce, can you look at this?Flags: needinfo?(mreavy)Flags: needinfo?(cpearce)Flags: needinfo?(bvandyk)

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1368490#c3)• 8 years ago |
|  | |

Will do.Assignee: nobody → bvandykFlags: needinfo?(bvandyk)

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1368490#c4)• 8 years ago |
|  | |

The issue here is that the OpusEncoder sets mChannels at Init, but the number of channels on the stream to the recorder can change in that encoder's lifetime without the encoder being updated. The AudioTrackEncoder does not anticipate this change and if newNumChannels < oldNumChannels then we end up reading out of bounds (specifically off the end of aChunk.mChannelData). This is easily reproducible as shown by the proof of concept. The out of bounds data is read into an array that expects audio channel data. It looks to me like this data will be interleaved and then fed through the opus encoder before being exposed by the media recorder API.
Would appreciate checking of my working. At this stage I think the upshot is exposure of memory (whatever follows aChunk.mChannelData), this data is fed through the opus encoder before being exposed.
Have a WIP fix, to follow shortly for feedback.

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1368490#c5)• 8 years ago |
|  | |

Attached patch

[Make sure number of channels is correctly set for opus encoder](attachment.cgi?id=8872553&action=diff)
— [Details](attachment.cgi?id=8872553&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872553)

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1368490#c6)• 8 years ago |
|  | |

Comment on [attachment 8872553](/attachment.cgi?id=8872553 "Make sure number of channels is correctly set for opus encoder") [[details]](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") [[diff]](/attachment.cgi?id=8872553&action=diff "Make sure number of channels is correctly set for opus encoder") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872553)
Make sure number of channels is correctly set for opus encoder
I don't think it makes sense to change the number of channels mid flight for opus (webm doesn't support this, and the opus encoder/decoder don't appear to). As such I suggest we keep the same encoder, and up or down sample to maintain the same number of channels. I've run a couple of test cases over chrome, who appear to do this.
We could also stop recording, but I prefer the above as more user friendly, barring any concerns.
[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: review?(pehrson)

|  | [Andreas Pehrson [:pehrsons]](/user_profile?user_id=489889) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1368490#c7)• 8 years ago |
|  | |

Comment on [attachment 8872553](/attachment.cgi?id=8872553 "Make sure number of channels is correctly set for opus encoder") [[details]](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") [[diff]](/attachment.cgi?id=8872553&action=diff "Make sure number of channels is correctly set for opus encoder") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872553)
Make sure number of channels is correctly set for opus encoder
Review of [attachment 8872553](/attachment.cgi?id=8872553 "Make sure number of channels is correctly set for opus encoder") [[details]](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") [[diff]](/attachment.cgi?id=8872553&action=diff "Make sure number of channels is correctly set for opus encoder") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872553):
-----------------------------------------------------------------
The code looks good as far as avoiding a crash goes.
What happens when the number of channels increases? Do we know which channels to pick and encode?
What happens when the number of channels decreases? Do we encode silence or garbage on the ones that didn't make the cut?
Would it make more sense to abort and raise an error event instead?
Also write a crash test before landing please. The attachment would be easy to convert.
[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: review?(pehrson)

|  | [Andreas Pehrson [:pehrsons]](/user_profile?user_id=489889) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a68886_489889)• 8 years ago |

Status: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1368490#c8)• 8 years ago |
|  | |

Will do on the crash test.
Does the existing upmix and downmix when interleaving code handle those cases? Would you prefer the error approach? I'm not sure which is more intuitive/useful to the user. If they're expecting a channel # change in the output file then it could be misleading to not error. However, an error would break web app compat between us and chrome.
Are these questions you'd like resolved as part of this bug, or food for thought going forward?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a70679_428608)• 8 years ago |

Flags: sec-bounty?

|  | [Andreas Pehrson [:pehrsons]](/user_profile?user_id=489889) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1368490#c9)• 8 years ago |
|  | |

(In reply to Bryce Van Dyk (:SingingTree) from [comment #8](/show_bug.cgi?id=1368490#c8 "VERIFIED FIXED - Write past end of allocation in InterleaveTrackData"))
> Does the existing upmix and downmix when interleaving code handle those
> cases? Would you prefer the error approach? I'm not sure which is more
> intuitive/useful to the user. If they're expecting a channel # change in the
> output file then it could be misleading to not error. However, an error
> would break web app compat between us and chrome.
Is there even existing code to upmix and downmix? I see that we support mono and stereo only, but nothing about dynamic changes. Is that even supported by opus? If we want to support this we IMHO need a set of gtests to prove its functionality.
My first thought is to follow the spec. If the spec doesn't mention what to do, and what to do isn't obvious, we should raise an error to show that the feature is unsupported and no further thought has been given on the behavior. Like we did for video resolution changes until we added support and tests.
IMO compat is secondary here since it's not in the spec, and it's not a regression.

|  | [Maire Reavy [:mreavy]](/user_profile?user_id=74434) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1368490#c10)• 8 years ago |
|  | |

Thanks, Chris and Bryce, for handling this.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1368490#c11)• 8 years ago |
|  | |

(In reply to Andreas Pehrson [:pehrsons] (Telenor) from [comment #9](/show_bug.cgi?id=1368490#c9 "VERIFIED FIXED - Write past end of allocation in InterleaveTrackData"))
> (In reply to Bryce Van Dyk (:SingingTree) from [comment #8](/show_bug.cgi?id=1368490#c8 "VERIFIED FIXED - Write past end of allocation in InterleaveTrackData"))
> > Does the existing upmix and downmix when interleaving code handle those
> > cases? Would you prefer the error approach? I'm not sure which is more
> > intuitive/useful to the user. If they're expecting a channel # change in the
> > output file then it could be misleading to not error. However, an error
> > would break web app compat between us and chrome.
>
> Is there even existing code to upmix and downmix? I see that we support mono
> and stereo only, but nothing about dynamic changes. Is that even supported
> by opus? If we want to support this we IMHO need a set of gtests to prove
> its functionality.
For audio playback and other reasons, we have dynamic up/down-mixers, including this one.
It handles channels on a chunk-by-chunk basis, adapting it to the target. If you're recording in stereo, it will handle a stream of mixed mono and stereo fine. Opus never sees a change in the number of tracks encoded (which is the point of this function).
> My first thought is to follow the spec. If the spec doesn't mention what to
> do, and what to do isn't obvious, we should raise an error to show that the
> feature is unsupported and no further thought has been given on the
> behavior. Like we did for video resolution changes until we added support
> and tests.
This patch is just fixing a bug in the adaptive mixing to the target number of channels (which is what I think most people would expect; erroring on channels changing is not something I would anticipate as an app developer). And it already works for the mono input to a stereo recorder. (And probably usually works in the non-ASAN case, perhaps always or virtually so.)
> IMO compat is secondary here since it's not in the spec, and it's not a
> regression.
Bryce: when landing this bug, make the test a separate patch, and do NOT check in the test with the patch unless told to by the security guys (who give security-approval)Group: media-core-security

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a80824_11539)• 8 years ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a80885_11539)• 8 years ago |

Summary: heap overflow in InterleaveTrackData → Write past end of allocation in InterleaveTrackData

|  | [Andreas Pehrson [:pehrsons]](/user_profile?user_id=489889) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1368490#c12)• 8 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #11](/show_bug.cgi?id=1368490#c11 "VERIFIED FIXED - Write past end of allocation in InterleaveTrackData"))
> (In reply to Andreas Pehrson [:pehrsons] (Telenor) from [comment #9](/show_bug.cgi?id=1368490#c9 "VERIFIED FIXED - Write past end of allocation in InterleaveTrackData"))
> > Is there even existing code to upmix and downmix? I see that we support mono
> > and stereo only, but nothing about dynamic changes. Is that even supported
> > by opus? If we want to support this we IMHO need a set of gtests to prove
> > its functionality.
>
> For audio playback and other reasons, we have dynamic up/down-mixers,
> including this one.
Ah, I see now. My apologies, this is not code that I know so well. Get a test up and I or jesup can r+.

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1368490#c13)• 8 years ago |
|  | |

Attached patch

[Add crashtest for media recorder when reducing number of source stream channels](attachment.cgi?id=8872791&action=diff) (obsolete)
— [Details](attachment.cgi?id=8872791&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872791)

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1368490#c14)• 8 years ago |
|  | |

Attached patch

[Add crashtest for media recorder when reducing number of source stream channels](attachment.cgi?id=8872793&action=diff)
— [Details](attachment.cgi?id=8872793&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872793)

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a113747_560379)• 8 years ago |

[Attachment #8872791](/attachment.cgi?id=8872791&action=edit "Add crashtest for media recorder when reducing number of source stream channels") -
Attachment is obsolete: true

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a113869_560379)• 8 years ago |

[Attachment #8872793](/attachment.cgi?id=8872793&action=edit "Add crashtest for media recorder when reducing number of source stream channels") -
Flags: review?(rjesup)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1368490#c15)• 8 years ago |
|  | |

Regression from [bug 901633](/show_bug.cgi?id=901633 "RESOLVED FIXED - Improve internal support for stereo audio in the webrtc media pipeline") IIUC.Blocks: [901633](/show_bug.cgi?id=901633 "RESOLVED FIXED - Improve internal support for stereo audio in the webrtc media pipeline")
[status-firefox53](/buglist.cgi?f1=cf_status_firefox53&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix)
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected)
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=wontfix)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)
[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%3F)
[tracking-firefox55](/buglist.cgi?f1=cf_tracking_firefox55&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%3F)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F)Version: unspecified → 43 Branch

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1368490#c16)• 8 years ago |
|  | |

Comment on [attachment 8872793](/attachment.cgi?id=8872793 "Add crashtest for media recorder when reducing number of source stream channels") [[details]](/attachment.cgi?id=8872793&action=edit "Add crashtest for media recorder when reducing number of source stream channels") [[diff]](/attachment.cgi?id=8872793&action=diff "Add crashtest for media recorder when reducing number of source stream channels") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872793)
Add crashtest for media recorder when reducing number of source stream channels
Review of [attachment 8872793](/attachment.cgi?id=8872793 "Add crashtest for media recorder when reducing number of source stream channels") [[details]](/attachment.cgi?id=8872793&action=edit "Add crashtest for media recorder when reducing number of source stream channels") [[diff]](/attachment.cgi?id=8872793&action=diff "Add crashtest for media recorder when reducing number of source stream channels") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872793):
-----------------------------------------------------------------
Don't check in until told to do so by security (abillings/dveditz/etc)
[Attachment #8872793](/attachment.cgi?id=8872793&action=edit "Add crashtest for media recorder when reducing number of source stream channels") -
Flags: review?(rjesup) → review+

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a203166_11539)• 8 years ago |

[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: review+

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1368490#c17)• 8 years ago |
|  | |

Bryce - request s-a and uplift at the same time, please.Flags: needinfo?(bvandyk)

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1368490#c18)• 8 years ago |
|  | |

Comment on [attachment 8872553](/attachment.cgi?id=8872553 "Make sure number of channels is correctly set for opus encoder") [[details]](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") [[diff]](/attachment.cgi?id=8872553&action=diff "Make sure number of channels is correctly set for opus encoder") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872553)
Make sure number of channels is correctly set for opus encoder
Approval Request Comment
[Feature/Bug causing the regression]:
[User impact if declined]:
[Is this code covered by automated tests?]:
[Has the fix been verified in Nightly?]:
[Needs manual test from QE? If yes, steps to reproduce]:
[List of other uplifts needed for the feature/fix]:
[Is the change risky?]:
[Why is the change risky/not risky?]:
[String changes made/needed]:
Approval Request Comment
[Feature/Bug causing the regression]:
[User impact if declined]:
[Is this code covered by automated tests?]:
[Has the fix been verified in Nightly?]:
[Needs manual test from QE? If yes, steps to reproduce]:
[List of other uplifts needed for the feature/fix]:
[Is the change risky?]:
[Why is the change risky/not risky?]:
[String changes made/needed]:
Approval Request Comment
[Feature/Bug causing the regression]:
[User impact if declined]:
[Is this code covered by automated tests?]:
[Has the fix been verified in Nightly?]:
[Needs manual test from QE? If yes, steps to reproduce]:
[List of other uplifts needed for the feature/fix]:
[Is the change risky?]:
[Why is the change risky/not risky?]:
[String changes made/needed]:
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
User impact if declined:
Fix Landed on Version:
Risk to taking this patch (and alternatives if risky):
String or UUID changes made by this patch:
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
- An attacker familiar with the media recorder and processing APIs could likely figure out how to begin exploiting this. Once an attacker has figured out that this can be done, triggering the the read off the end of the array is trivial (see the PoC or the attached test). However, the data will be fed through the opus encoder before being exposed to the attacker, which increases the difficulty of exploiting this.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
- The comment is left intentionally vague to avoid this. The code change very obviously deals with array indexing, one could likely infer that it is to avoid indexing off the end of an array. The follow up test should not be landed with this, as it paints a clear target by being a crash test. I will follow up with another bug to land it later.
Which older supported branches are affected by this flaw?
- All supported: 54, 55, and 52esr appear to be affected, as well as various older, unsupported branches.
If not all supported branches, which bug introduced the flaw?
- All supported branches appear to be impacted.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
- I believe this patch should work for the other branches. This code doesn't look to have changed since 52[1], so the same patch should work.
How likely is this patch to cause regressions; how much testing does it need?
- The patch is small and specific, I do not think it likely it will cause regressions. It does slightly alter existing behaviour if users are non-maliciously changing channel counts (specifically if users create a mono recorder then change the input to stereo). However, I think questions about up and down mixing can be handled in a non secure follow up once this is seen to. Testing would be good to ensure this works, for security purposes decreasing the number of input channels appears to be the most important test. I don't think increasing the number of channels would result in the issue, but would be good to test also.
[1]: <https://dxr.mozilla.org/mozilla-esr52/source/dom/media/encoder/TrackEncoder.cpp>Flags: needinfo?(bvandyk)
[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: sec-approval?
[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: approval-mozilla-esr52?
[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: approval-mozilla-beta?

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1368490#c19)• 8 years ago |
|  | |

Ack, follow up to previous comment:
Approval Request Comment
[Feature/Bug causing the regression]: Appear to be [bug 901633](/show_bug.cgi?id=901633 "RESOLVED FIXED - Improve internal support for stereo audio in the webrtc media pipeline") based on [comment #15](/show_bug.cgi?id=1368490#c15 "VERIFIED FIXED - Write past end of allocation in InterleaveTrackData").
[User impact if declined]: Possible exposure of memory.
[Is this code covered by automated tests?]: Not yet, a test is proposed but should not be landed due to painting a target.
[Has the fix been verified in Nightly?]: This code has not yet been landed. Locally the fix works.
[Needs manual test from QE? If yes, steps to reproduce]: Probably good to test. Can be tested using the attached PoC.
[List of other uplifts needed for the feature/fix]: Only the proposed patch is required at this stage.
[Is the change risky?]: Low risk.
[Why is the change risky/not risky?]: It is a small and specific change.
[String changes made/needed]: None.
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration: Rating to be decided. At this stage uplift request is being made on a security basis.
User impact if declined: Possible exposure of memory.
Fix Landed on Version: Not yet landed. Would be 55.
Risk to taking this patch (and alternatives if risky): Low risk.
String or UUID changes made by this patch: None.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1368490#c20)• 8 years ago |
|  | |

Release management, do we still have time to take this in 54?
If so, I will give sec-approval+ for trunk and you can give branch approvals.Flags: needinfo?(rkothari)Flags: needinfo?(lhenry)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1368490#c21)• 8 years ago |
|  | |

Yes, we can still take it for 54.Flags: needinfo?(rkothari)Flags: needinfo?(lhenry)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a259776_451704)• 8 years ago |

[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B)
[tracking-firefox55](/buglist.cgi?f1=cf_tracking_firefox55&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1368490#c22)• 8 years ago |
|  | |

Comment on [attachment 8872553](/attachment.cgi?id=8872553 "Make sure number of channels is correctly set for opus encoder") [[details]](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") [[diff]](/attachment.cgi?id=8872553&action=diff "Make sure number of channels is correctly set for opus encoder") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872553)
Make sure number of channels is correctly set for opus encoder
All approvals given.
[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: sec-approval?
[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: sec-approval+
[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: approval-mozilla-esr52?
[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: approval-mozilla-esr52+
[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: approval-mozilla-beta?
[Attachment #8872553](/attachment.cgi?id=8872553&action=edit "Make sure number of channels is correctly set for opus encoder") -
Flags: approval-mozilla-beta+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a266413_280903)• 8 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1368490#c23)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/26e9faf36fc093367053243daf9ff3a1663dcdd9>Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1368490#c24)• 8 years ago |
|  | |

Backed out for bustage.
<https://hg.mozilla.org/integration/autoland/rev/15e32469eb048957223bac458140776a30251c6b>
<https://treeherder.mozilla.org/logviewer.html#?job_id=103769109&repo=autoland>
Bruce or Randell, we're on a pretty tight time window here, so can one of you fix and re-land ASAP?Flags: needinfo?(rjesup)Flags: needinfo?(bvandyk)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1368490#c25)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/542348829591bffff44980cb5689c8a0a4bf80bb>Flags: needinfo?(rjesup)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1368490#c26)• 8 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/9589dfc1041b>
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed)Flags: needinfo?(bvandyk)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1368490#c27)• 8 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr52/rev/279bffa85beb>
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed)

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1368490#c28)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/542348829591>Status: ASSIGNED → RESOLVEDClosed: 8 years ago
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla55

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a361747_452604)• 8 years ago |

Flags: qe-verify+Whiteboard: [post-critsmash-triage]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a370042_1689)• 8 years ago |

Group: media-core-security, core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a614034_1689)• 8 years ago |

[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F) → [54+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=54%2B)Flags: sec-bounty? → sec-bounty+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a708200_280903)• 8 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main54+][adv-esr52.2+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a710917_280903)• 8 years ago |

Alias: CVE-2017-7758

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1368490#c29)• 8 years ago |
|  | |

I've managed to reproduce the crash on 52.0.2 (Ubuntu 16.04 x64) and 53.0a1 Nightly (Mac OS X 10.11.6).
The crash is not reproducible anymore with 54.0 (20170605204906) and latest Nightly 55.a01 (2017-06-07) under the following OSes:
- Win 10 x64
- Mac OS 10.11.6
- Ubuntu 16.04 x64 LTSStatus: RESOLVED → VERIFIED
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=verified)
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=verified)Flags: qe-verify+

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1368490#c30)• 8 years ago |
|  | |

This is also verified on esr 52.2.0 (20170607123825).
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=verified)

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1368490#c31)• 7 years ago |
|  | |

Comment on [attachment 8872793](/attachment.cgi?id=8872793 "Add crashtest for media recorder when reducing number of source stream channels") [[details]](/attachment.cgi?id=8872793&action=edit "Add crashtest for media recorder when reducing number of source stream channels") [[diff]](/attachment.cgi?id=8872793&action=diff "Add crashtest for media recorder when reducing number of source stream channels") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872793)
Add crashtest for media recorder when reducing number of source stream channels
Requesting sec approval to land delayed test case:
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
- This test makes it clear how the code can trigger the abusable bug. Weaponising the bug would require further effort.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
- This is test that painted a target to a patched bug. Landing it has been delayed to avoid this.
Which older supported branches are affected by this flaw?
- All supported branches should be immune due to earlier patch.
If not all supported branches, which bug introduced the flaw?
- All supported branches should be immune.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
- Backports are not needed.
How likely is this patch to cause regressions; how much testing does it need?
- Regressions in any other code are unlikely, any problems should be limited to the test itself.
[Attachment #8872793](/attachment.cgi?id=8872793&action=edit "Add crashtest for media recorder when reducing number of source stream channels") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1368490#c32)• 7 years ago |
|  | |

Comment on [attachment 8872793](/attachment.cgi?id=8872793 "Add crashtest for media recorder when reducing number of source stream channels") [[details]](/attachment.cgi?id=8872793&action=edit "Add crashtest for media recorder when reducing number of source stream channels") [[diff]](/attachment.cgi?id=8872793&action=diff "Add crashtest for media recorder when reducing number of source stream channels") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1368490&attachment=8872793)
Add crashtest for media recorder when reducing number of source stream channels
Fixed in 54? Sure, land away!
[Attachment #8872793](/attachment.cgi?id=8872793&action=edit "Add crashtest for media recorder when reducing number of source stream channels") -
Flags: sec-approval? → sec-approval+

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1368490#c33)• 7 years ago |
|  | |

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=6a3f54a2a0f6>

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1368490#c34)• 7 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/bc2cbce028cbdbe33bbbddaa2fd0213479fb3c2a>
[Bug 1368490](/show_bug.cgi?id=1368490 "VERIFIED FIXED - Write past end of allocation in InterleaveTrackData") - Add crashtest for media recorder when reducing number of source stream channels. r=jesup

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1368490#c35)• 7 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/bc2cbce028cb>Flags: in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a13001987_1689)• 7 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1368490#a221017987_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1368490&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [ntrippar](/user_profile?user_id=596168)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_43447d02_20250124_225312.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2017-15

## Security vulnerabilities fixed in Firefox 54

Announced
June 13, 2017
Impact
critical
Products
Firefox
Fixed in

* Firefox 54

#### [#CVE-2017-5472: Use-after-free using destroyed node when regenerating trees](#CVE-2017-5472)

Reporter
Nils
Impact
critical
##### Description

A use-after-free vulnerability with the frameloader during tree reconstruction while regenerating CSS layout when attempting to use a node in the tree that no longer exists. This results in a potentially exploitable crash.

##### References

* [Bug 1365602](https://bugzilla.mozilla.org/show_bug.cgi?id=1365602)

#### [#CVE-2017-7749: Use-after-free during docshell reloading](#CVE-2017-7749)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability when using an incorrect URL during the reloading of a docshell. This results in a potentially exploitable crash.

##### References

* [Bug 1355039](https://bugzilla.mozilla.org/show_bug.cgi?id=1355039)

#### [#CVE-2017-7750: Use-after-free with track elements](#CVE-2017-7750)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability during video control operations when a `<track>` element holds a reference to an older window if that window has been replaced in the DOM. This results in a potentially exploitable crash.

##### References

* [Bug 1356558](https://bugzilla.mozilla.org/show_bug.cgi?id=1356558)

#### [#CVE-2017-7751: Use-after-free with content viewer listeners](#CVE-2017-7751)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability with content viewer listeners that results in a potentially exploitable crash.

##### References

* [Bug 1363396](https://bugzilla.mozilla.org/show_bug.cgi?id=1363396)

#### [#CVE-2017-7752: Use-after-free with IME input](#CVE-2017-7752)

Reporter
Nils
Impact
moderate
##### Description

A use-after-free vulnerability during specific user interactions with the input method editor (IME) in some languages due to how events are handled. This results in a potentially exploitable crash but would require specific user interaction to trigger.

##### References

* [Bug 1359547](https://bugzilla.mozilla.org/show_bug.cgi?id=1359547)

#### [#CVE-2017-7754: Out-of-bounds read in WebGL with ImageInfo object](#CVE-2017-7754)

Reporter
Tobias Klein
Impact
high
##### Description

An out-of-bounds read in WebGL with a maliciously crafted `ImageInfo` object during WebGL operations.

##### References

* [Bug 1357090](https://bugzilla.mozilla.org/show_bug.cgi?id=1357090)

#### [#CVE-2017-7755: Privilege escalation through Firefox Installer with same directory DLL files](#CVE-2017-7755)

Reporter
Yuji Tounai of NTT Communications, Eili Masami of Tachibana Lab
Impact
high
##### Description

The Firefox installer on Windows can be made to load malicious DLL files stored in the same directory as the installer when it is run. This allows privileged execution if the installer is run with elevated privileges.
*Note: This attack only affects Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1361326](https://bugzilla.mozilla.org/show_bug.cgi?id=1361326)

#### [#CVE-2017-7756: Use-after-free and use-after-scope logging XHR header errors](#CVE-2017-7756)

Reporter
Abhishek Arya
Impact
high
##### Description

A use-after-free and use-after-scope vulnerability when logging errors from headers for XML HTTP Requests (XHR). This could result in a potentially exploitable crash.

##### References

* [Bug 1366595](https://bugzilla.mozilla.org/show_bug.cgi?id=1366595)

#### [#CVE-2017-7757: Use-after-free in IndexedDB](#CVE-2017-7757)

Reporter
F. Alonso (revskills)
Impact
high
##### Description

A use-after-free vulnerability in IndexedDB when one of its objects is destroyed in memory while a method on it is still being executed. This results in a potentially exploitable crash.

##### References

* [Bug 1356824](https://bugzilla.mozilla.org/show_bug.cgi?id=1356824)

#### [#CVE-2017-7778: Vulnerabilities in the Graphite 2 library](#CVE-2017-7778)

Reporter
Holger Fuhrmannek, Tyson Smith
Impact
high
##### Description

A number of security vulnerabilities in the Graphite 2 library including out-of-bounds reads, buffer overflow reads and writes, and the use of uninitialized memory. These issues were addressed in Graphite 2 version 1.3.10.

##### References

* [Graphite2 lz4::decompress out of bounds write (CVE-2017-7778)](https://bugzilla.mozilla.org/show_bug.cgi?id=1349310)
* [Graphite2 out of bounds read [@ graphite2::Pass::readPass] (CVE-2017-7771)](https://bugzilla.mozilla.org/show_bug.cgi?id=1350047)
* [Graphite2 heap-buffer-overflow write [@ lz4::decompress] (CVE-2017-7772)](https://bugzilla.mozilla.org/show_bug.cgi?id=1352745)
* [Graphite2 heap-buffer-overflow write [@ lz4::decompress] src/Decompressor (CVE-2017-7773)](https://bugzilla.mozilla.org/show_bug.cgi?id=1352747)
* [Graphite2 out of bounds read [@ graphite2::Silf::readGraphite] (CVE-2017-7774)](https://bugzilla.mozilla.org/show_bug.cgi?id=1355174)
* [Graphite2 Assertion 'size() > n' failed (CVE-2017-7775)](https://bugzilla.mozilla.org/show_bug.cgi?id=1355182)
* [Graphite2 heap-buffer-overflow read [@ graphite2::Silf::getClassGlyph] (CVE-2017-7776)](https://bugzilla.mozilla.org/show_bug.cgi?id=1356607)
* [Graphite2 use of uninitialized memory [@ graphite2::GlyphCache::Loader::read\_glyph] (CVE-2017-7777)](https://bugzilla.mozilla.org/show_bug.cgi?id=1358551)

#### [#CVE-2017-7758: Out-of-bounds read in Opus encoder](#CVE-2017-7758)

Reporter
Nicolas Trippar of Zimperium zLabs
Impact
high
##### Description

An out-of-bounds read vulnerability with the Opus encoder when the number of channels in an audio stream changes while the encoder is in use.

##### References

* [Bug 1368490](https://bugzilla.mozilla.org/show_bug.cgi?id=1368490)

#### [#CVE-2017-7759: Android intent URLs can cause navigation to local file system](#CVE-2017-7759)

Reporter
Takeshi Terada
Impact
high
##### Description

Android intent URLs given to Firefox for Android can be used to navigate from HTTP or HTTPS URLs to local `file:` URLs, allowing for the reading of local data through a violation of same-origin policy.
*Note: This attack only affects Firefox for Android. Other operating systems are not affected.*

##### References

* [Bug 1356893](https://bugzilla.mozilla.org/show_bug.cgi?id=1356893)

#### [#CVE-2017-7760: File manipulation and privilege escalation via callback parameter in Mozilla Windows Updater and Maintenance Service](#CVE-2017-7760)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

The Mozilla Windows updater modifies some files to be updated by reading the original file and applying changes to it. The location of the original file can be altered by a malicious user by passing a special path to the callback parameter through the Mozilla Maintenance Service, allowing the manipulation of files in the installation directory and privilege escalation by manipulating the Mozilla Maintenance Service, which has privileged access.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1348645](https://bugzilla.mozilla.org/show_bug.cgi?id=1348645)

#### [#CVE-2017-7761: File deletion and privilege escalation through Mozilla Maintenance Service helper.exe application](#CVE-2017-7761)

Reporter
Holger Fuhrmannek
Impact
moderate
##### Description

The Mozilla Maintenance Service `helper.exe` application creates a temporary directory writable by non-privileged users. When this is combined with creation of a junction (a form of symbolic link), protected files in the target directory of the junction can be deleted by the Mozilla Maintenance Service, which has privileged access.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1215648](https://bugzilla.mozilla.org/show_bug.cgi?id=1215648)
* [Code execution / Privilege escalation problems with NSIS installers](https://sourceforge.net/p/nsis/bugs/1125/)

#### [#CVE-2017-7762: Addressbar spoofing in Reader mode](#CVE-2017-7762)

Reporter
Jun Kokatsu
Impact
moderate
##### Description

When entered directly, Reader Mode did not strip the username and password section of URLs displayed in the addressbar. This can be used for spoofing the domain of the current page.

##### References

* [Bug 1358248](https://bugzilla.mozilla.org/show_bug.cgi?id=1358248)

#### [#CVE-2017-7763: Mac fonts render some unicode characters as spaces](#CVE-2017-7763)

Reporter
Michał Bentkowski
Impact
moderate
##### Description

Default fonts on OS X display some Tibetan characters as whitespace. When used in the addressbar as part of an IDN this can be used for domain name spoofing attacks.
*Note: This attack only affects OS X operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1360309](https://bugzilla.mozilla.org/show_bug.cgi?id=1360309)

#### [#CVE-2017-7764: Domain spoofing with combination of Canadian Syllabics and other unicode blocks](#CVE-2017-7764)

Reporter
Samuel Erb
Impact
moderate
##### Description

Characters from the "Canadian Syllabics" unicode block can be mixed with characters from other unicode blocks in the addressbar instead of being rendered as their raw "punycode" form, allowing for domain name spoofing attacks through character confusion. The current Unicode standard allows characters from "Aspirational Use Scripts" such as Canadian Syllabics to be mixed with Latin characters in the "moderately restrictive" IDN profile. We have changed Firefox behavior to match the upcoming Unicode version 10.0 which removes this category and treats them as "Limited Use Scripts."

##### References

* [Bug 1364283](https://bugzilla.mozilla.org/show_bug.cgi?id=1364283)
* [Proposed Update to Unicode Standard Annex](http://www.unicode.org/reports/tr31/tr31-26.html#Aspirational_Use_Scripts)

#### [#CVE-2017-7765: Mark of the Web bypass when saving executable files](#CVE-2017-7765)

Reporter
Jonathan Birch and Microsoft Vulnerability Research
Impact
moderate
##### Description

The "Mark of the Web" was not correctly saved on Windows when files with very long names were downloaded from the Internet. Without the Mark of the Web data, the security warning that Windows displays before running executables downloaded from the Internet is not shown.
*Note: This attack only affects Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1273265](https://bugzilla.mozilla.org/show_bug.cgi?id=1273265)

#### [#CVE-2017-7766: File execution and privilege escalation through updater.ini, Mozilla Windows Updater, and Mozilla Maintenance Service](#CVE-2017-7766)

Reporter
Seb Patane
Impact
high
##### Description

An attack using manipulation of `updater.ini` contents, used by the Mozilla Windows Updater, and privilege escalation through the Mozilla Maintenance Service to allow for arbitrary file execution and deletion by the Maintenance Service, which has privileged access.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1342742](https://bugzilla.mozilla.org/show_bug.cgi?id=1342742)

#### [#CVE-2017-7767: Privilege escalation and arbitrary file overwrites through Mozilla Windows Updater and Mozilla Maintenance Service](#CVE-2017-7767)

Reporter
Seb Patane
Impact
moderate
##### Description

The Mozilla Maintenance Service can be invoked by an unprivileged user to overwrite arbitrary files with junk data using the Mozilla Windows Updater, which runs with the Maintenance Service's privileged access.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1336964](https://bugzilla.mozilla.org/show_bug.cgi?id=1336964)

#### [#CVE-2017-7768: 32 byte arbitrary file read through Mozilla Maintenance Service](#CVE-2017-7768)

Reporter
Seb Patane
Impact
moderate
##### Description

The Mozilla Maintenance Service can be invoked by an unprivileged user to read 32 bytes of any arbitrary file on the local system by convincing the service that it is reading a status file provided by the Mozilla Windows Updater. The Mozilla Maintenance Service executes with privileged access, bypassing system protections against unprivileged users.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1336979](https://bugzilla.mozilla.org/show_bug.cgi?id=1336979)

#### [#CVE-2017-7770: Addressbar spoofing with JavaScript events and fullscreen mode](#CVE-2017-7770)

Reporter
Jordi Chancel
Impact
moderate
##### Description

A mechanism where when a new tab is loaded through JavaScript events, if fullscreen mode is then entered, the addressbar will not be rendered. This would allow a malicious site to displayed a spoofed addressbar, showing the location of an arbitrary website instead of the one loaded.
*Note: this issue only affects Firefox for Android. Desktop Firefox is unaffected.*

##### References

* [Bug 1317242](https://bugzilla.mozilla.org/show_bug.cgi?id=1317242)

#### [#CVE-2017-5471: Memory safety bugs fixed in Firefox 54](#CVE-2017-5471)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Mats Palmgren, Philipp, Byron Campen, Christian Holler, Gary Kwong, Benjamin Bouvier, Bob Clary, Jon Coppeard, and Michael Layzell reported memory safety bugs present in Firefox 53. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 54](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1349604%2C1318645%2C1361098%2C1361100%2C1341026%2C1349421%2C1360852%2C1299147%2C1352073%2C1354853%2C1366446%2C1342181%2C1343069)

#### [#CVE-2017-5470: Memory safety bugs fixed in Firefox 54 and Firefox ESR 52.2](#CVE-2017-5470)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Tyson Smith, Mats Palmgren, Philipp, Masayuki Nakano, Christian Holler, Andrew McCreight, Gary Kwong, André Bargull, Carsten Book, Jesse Schwartzentruber, Julian Hector, Marcia Knous, Ronald Crane, and Nils Ohlmeier reported memory safety bugs present in Firefox 53 and Firefox ESR 52.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 54 and Firefox ESR 52.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1359639%2C1349595%2C1352295%2C1352556%2C1342552%2C1342567%2C1346012%2C1366140%2C1368732%2C1297111%2C1362590%2C1357462%2C1363280%2C1349266%2C1352093%2C1348424%2C1347748%2C1356025%2C1325513%2C1367692)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_805cb9c3_20250126_041456.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1358248)
* [XML](/show_bug.cgi?ctype=xml&id=1358248)

Closed
[Bug 1358248](/show_bug.cgi?id=1358248)
(CVE-2017-7762)

Opened 8 years ago
Closed 8 years ago

# Address bar spoof in reader mode

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Address bar spoof in reader mode

## Categories

### (Toolkit :: Reader Mode, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Reader%20Mode#Reader%20Mode)

Reader Mode
▾

Toolkit :: Reader Mode
The component for displaying pages in a special reader mode. Includes about:reader page and Readability article-parsing library.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Reader%20Mode&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Reader%20Mode&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Reader%20Mode)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla55

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=unaffected) |
| firefox-esr52 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=wontfix) |
| firefox53 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix) |
| firefox54 | [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=verified) |
| firefox55 | [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr52 |  | wontfix |
| firefox53 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox54 | + | verified |
| firefox-esr128 | --- | --- |
| firefox55 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: s.h.h.n.j.k, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/a1dbf5def4b5ddfd93a268b649c043bc?d=mm&size=40)  [s.h.h.n.j.k](/user_profile?user_id=538140)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

23 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1173823](/show_bug.cgi?id=1173823 "RESOLVED FIXED - Reader View ignores <base href=\"...\">"), [CVE-2017-5463](/show_bug.cgi?id=1338867 "RESOLVED FIXED - Fennec allows address bar spoofing in reader view with userinfo field in front of hostname of url")

Dependency [tree](/showdependencytree.cgi?id=1358248&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1358248)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main54+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2017-7762

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main54+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2496234_1689 "8 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Patch to fix url bar display on desktop](/attachment.cgi?id=8860639)  [8 years ago](#c4)  [:Gijs (he/him)](/user_profile?user_id=159069)   5.23 KB, patch | cnevinchen : [review+](#c24 "8 years ago")  evanxd : [review+](#c18 "8 years ago") | [Details](/attachment.cgi?id=8860639&action=edit) | [Diff](/attachment.cgi?id=8860639&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639) |
| --- | --- | --- |
| [Patch to fix baseURI display](/attachment.cgi?id=8860640)  [8 years ago](#c5)  [:Gijs (he/him)](/user_profile?user_id=159069)   4.78 KB, patch | evanxd : [review+](#c17 "8 years ago") | [Details](/attachment.cgi?id=8860640&action=edit) | [Diff](/attachment.cgi?id=8860640&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860640) |
| [Patches for beta](/attachment.cgi?id=8868506)  [8 years ago](#c32)  [:Gijs (he/him)](/user_profile?user_id=159069)   13.38 KB, patch | Gijs : [review+](#c32 "8 years ago")  gchang : [approval-mozilla-beta+](#c37 "8 years ago") | [Details](/attachment.cgi?id=8868506&action=edit) | [Diff](/attachment.cgi?id=8868506&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8868506) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jun (Request needinfo for comment, I ignore other updates)](/user_profile?user_id=538140)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1358248#c0)• 8 years ago |
|  | |

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_12\_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36
Steps to reproduce:
1. Go to about:reader?url=https%3A%2F%2Ftest.shhnjk.com%2Fcsp\_read.php
Actual results:
address before @ is shown in address bar which could be used for phishing.
Expected results:
user information (left side of @) in url should not be shown in address bar. This is incomplete fix of <https://www.mozilla.org/en-US/security/advisories/mfsa2017-10/#﷒0>﷓

|  | [Jun (Request needinfo for comment, I ignore other updates)](/user_profile?user_id=538140)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1358248#c1)• 8 years ago |
|  | |

Sorry,
This is incomplete fix of [https://bugzilla.mozilla.org/show\_bug.cgi?id=1338867](/show_bug.cgi?id=1338867 "RESOLVED FIXED - Fennec allows address bar spoofing in reader view with userinfo field in front of hostname of url")

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1358248#a134453_159069)• 8 years ago |

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1358248#c2)• 8 years ago |
|  | |

Was this report intended to be about Firefox for Desktop or for Android?Blocks: [CVE-2017-5463](/show_bug.cgi?id=1338867 "RESOLVED FIXED - Fennec allows address bar spoofing in reader view with userinfo field in front of hostname of url")Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(s.h.h.n.j.k)

|  | [Jun (Request needinfo for comment, I ignore other updates)](/user_profile?user_id=538140)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1358248#c3)• 8 years ago |
|  | |

Desktop.Flags: needinfo?(s.h.h.n.j.k)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1358248#a151956_159069)• 8 years ago |

Status: UNCONFIRMED → NEWComponent: Untriaged → Reader ModeEver confirmed: trueProduct: Firefox → ToolkitVersion: 1.0 Branch → Trunk

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1358248#c4)• 8 years ago |
|  | |

Attached patch

[Patch to fix url bar display on desktop](attachment.cgi?id=8860639&action=diff)
— [Details](attachment.cgi?id=8860639&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639)

We should have put the exposableURI transform into reader mode and fixed desktop as well in [bug 1338867](/show_bug.cgi?id=1338867 "RESOLVED FIXED - Fennec allows address bar spoofing in reader view with userinfo field in front of hostname of url").Assignee: nobody → gijskruitbosch+bugsStatus: NEW → ASSIGNED
[Attachment #8860639](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") -
Flags: review?(max)
[Attachment #8860639](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") -
Flags: review?(evan)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1358248#c5)• 8 years ago |
|  | |

Attached patch

[Patch to fix baseURI display](attachment.cgi?id=8860640&action=diff)
— [Details](attachment.cgi?id=8860640&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860640)

This is a regression from [bug 1173823](/show_bug.cgi?id=1173823 "RESOLVED FIXED - Reader View ignores <base href=\"...\">"). We shouldn't prominently display a baseURI instead of the documentURI. This patch fixes that.
[Attachment #8860640](/attachment.cgi?id=8860640&action=edit "Patch to fix baseURI display") -
Flags: review?(evan)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1358248#c6)• 8 years ago |
|  | |

Comment on [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639)
Patch to fix url bar display on desktop
Review of [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639):
-----------------------------------------------------------------
::: mobile/android/chrome/content/browser.js
@@ +4519,5 @@
> }
> },
>
> \_stripAboutReaderURL: function (originalURI) {
> + return ReaderMode.getOriginalUrlObjectForDisplay(originalURI.spec) || originalURI;
Note that I haven't tested the android change here. It would be helpful if Max or someone else with the right Android knowledge / build setup could do this.

|  | [Jun (Request needinfo for comment, I ignore other updates)](/user_profile?user_id=538140)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1358248#a296135_538140)• 8 years ago |

Flags: sec-bounty?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1358248#a331436_75935)• 8 years ago |

[status-firefox53](/buglist.cgi?f1=cf_status_firefox53&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix)
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected)
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=unaffected)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)
[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%3F)
[tracking-firefox55](/buglist.cgi?f1=cf_tracking_firefox55&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%3F)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1358248#c7)• 8 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

Reporter, do not set the sec-bounty flag yourself. If you wish to nominate bugs for bounty, please follow the bounty program instructions at <https://www.mozilla.org/en-US/security/client-bug-bounty/> and email security@mozilla.org with your request.Flags: sec-bounty?

|  | [Max Liu [:maliu]](/user_profile?user_id=578584) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1358248#c8)• 8 years ago |
|  | |

Comment on [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639)
Patch to fix url bar display on desktop
redirect review to Nevin, current mobile ReaderMode owner.
[Attachment #8860639](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") -
Flags: review?(max) → review?(cnevinchen)

|  | [Nevin Chen(Not active on Bugzilla)](/user_profile?user_id=582291) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1358248#c9)• 8 years ago |
|  | |

Comment on [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639)
Patch to fix url bar display on desktop
mobile has some issue when cached reader page since we use startwith("about:reader") everywhere. Please let me check it and test for some time.Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1358248#c10)• 8 years ago |
|  | |

(In reply to Nevin Chen [:nechen] from [comment #9](/show_bug.cgi?id=1358248#c9 "VERIFIED FIXED - Address bar spoof in reader mode"))
> Comment on [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639)
> Patch to fix url bar display on desktop
>
> mobile has some issue when cached reader page since we use
> startwith("about:reader") everywhere. Please let me check it and test for
> some time.
Was there a question you wanted me to answer that prompted you to set needinfo? I'm not sure what you need from me right now.Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(cnevinchen)

|  | [Jun (Request needinfo for comment, I ignore other updates)](/user_profile?user_id=538140)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1358248#c11)• 8 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

(In reply to Al Billings [:abillings] from [comment #7](/show_bug.cgi?id=1358248#c7 "VERIFIED FIXED - Address bar spoof in reader mode"))
> Reporter, do not set the sec-bounty flag yourself. If you wish to nominate
> bugs for bounty, please follow the bounty program instructions at
> <https://www.mozilla.org/en-US/security/client-bug-bounty/> and email
> security@mozilla.org with your request.
Do I need to report browser bugs to security@mozilla.org if I need bounty? I didn't know that. I will send report to security@mozilla.org next time instead of Bugzilla.

|  | [Marcia Knous [:marcia]](/user_profile?user_id=8519) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1358248#c12)• 8 years ago |
|  | |

Tracking 54/55 and esr52+.
[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B)
[tracking-firefox55](/buglist.cgi?f1=cf_tracking_firefox55&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F) → [54+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=54%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1358248#c13)• 8 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

(In reply to s.h.h.n.j.k from [comment #11](/show_bug.cgi?id=1358248#c11 "VERIFIED FIXED - Address bar spoof in reader mode"))
> Do I need to report browser bugs to security@mozilla.org if I need bounty? I
> didn't know that. I will send report to security@mozilla.org next time
> instead of Bugzilla.
Please don't email us bug reports. Log the bug here. If you email us the bug report instead of opening the bug, one of us has to open the bug for you and then you're not on the bug anywhere and cannot see updates to it.
If you want a bug considered for a bounty, email security@mozilla.org and tell us that you want the bug considered for a bounty. Otherwise, just because you reported a security bug doesn't mean it will be considered for the bounty program. We get a lot of reports.

|  | [Nevin Chen(Not active on Bugzilla)](/user_profile?user_id=582291) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1358248#c14)• 8 years ago |
|  | |

Sorry I just need to wait for another bug to land to see how should we solve this bug.Flags: needinfo?(cnevinchen)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1358248#c15)• 8 years ago |
|  | |

The behavior between release and nightly is different. 53 is spoofy, mwobensmith reports nightly is not. What else changed in here?Blocks: [1173823](/show_bug.cgi?id=1173823 "RESOLVED FIXED - Reader View ignores <base href=\"...\">")Flags: needinfo?(gijskruitbosch+bugs)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1358248#c16)• 8 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #15](/show_bug.cgi?id=1358248#c15 "VERIFIED FIXED - Address bar spoof in reader mode"))
> The behavior between release and nightly is different. 53 is spoofy,
> mwobensmith reports nightly is not. What else changed in here?
I see the same results in today's nightly as in 53. Address bar shows <https://google,com@test.shhnjk.com/another.html>, in-document domain header shows "google.com".Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(mwobensmith)

|  | [Evan Tseng [:evanxd]](/user_profile?user_id=459562) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1358248#c17)• 8 years ago |
|  | |

Comment on [attachment 8860640](/attachment.cgi?id=8860640 "Patch to fix baseURI display") [[details]](/attachment.cgi?id=8860640&action=edit "Patch to fix baseURI display") [[diff]](/attachment.cgi?id=8860640&action=diff "Patch to fix baseURI display") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860640)
Patch to fix baseURI display
Looks good to me.
Sorry for the late review.
[Attachment #8860640](/attachment.cgi?id=8860640&action=edit "Patch to fix baseURI display") -
Flags: review?(evan) → review+

|  | [Evan Tseng [:evanxd]](/user_profile?user_id=459562) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1358248#c18)• 8 years ago |
|  | |

Comment on [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639)
Patch to fix url bar display on desktop
Looks good to me. :)
[Attachment #8860639](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") -
Flags: review?(evan) → review+

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1358248#c19)• 8 years ago |
|  | |

I see the opposite of [comment 15](/show_bug.cgi?id=1358248#c15 "VERIFIED FIXED - Address bar spoof in reader mode"). For me, only Nightly 55 is spoofy.
The behavior I see there is what Gijs sees in [comment 16](/show_bug.cgi?id=1358248#c16 "VERIFIED FIXED - Address bar spoof in reader mode").Flags: needinfo?(mwobensmith)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1358248#c20)• 8 years ago |
|  | |

(In reply to Matt Wobensmith [:mwobensmith][:matt:] from [comment #19](/show_bug.cgi?id=1358248#c19 "VERIFIED FIXED - Address bar spoof in reader mode"))
> I see the opposite of [comment 15](/show_bug.cgi?id=1358248#c15 "VERIFIED FIXED - Address bar spoof in reader mode"). For me, only Nightly 55 is spoofy.
>
> The behavior I see there is what Gijs sees in [comment 16](/show_bug.cgi?id=1358248#c16 "VERIFIED FIXED - Address bar spoof in reader mode").
OK, I still see that behaviour also in 53... in any case, this isn't severe enough to cause a dot-release for 53. We should just get it landed and fixed in 54, and potentially the related ESR.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1358248#c21)• 8 years ago |
|  | |

Nevin, will you be able to review this change in the near future, or should I find another android peer to have a look at it?Flags: needinfo?(cnevinchen)

|  | [Nevin Chen(Not active on Bugzilla)](/user_profile?user_id=582291) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1358248#c22)• 8 years ago |
|  | |

Comment on [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639)
Patch to fix url bar display on desktop
Review of [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639):
-----------------------------------------------------------------
I suggest to not to update the Android part. Since [bug 1358946](/show_bug.cgi?id=1358946 "VERIFIED FIXED - Reader mode page is saved as normal bookmark") will be landed soon.
[Attachment #8860639](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") -
Flags: review?(cnevinchen) → review-

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1358248#c23)• 8 years ago |
|  | |

Comment on [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639)
Patch to fix url bar display on desktop
(In reply to Nevin Chen [:nechen] from [comment #22](/show_bug.cgi?id=1358248#c22 "VERIFIED FIXED - Address bar spoof in reader mode"))
> Comment on [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639)
> Patch to fix url bar display on desktop
>
> Review of [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639):
> -----------------------------------------------------------------
>
> I suggest to not to update the Android part. Since [bug 1358946](/show_bug.cgi?id=1358946 "VERIFIED FIXED - Reader mode page is saved as normal bookmark") will be
> landed soon.
I don't think [bug 1358946](/show_bug.cgi?id=1358946 "VERIFIED FIXED - Reader mode page is saved as normal bookmark") should land in its current form, please see [bug 1358946 comment 16](/show_bug.cgi?id=1358946#c16 "VERIFIED FIXED - Reader mode page is saved as normal bookmark"). Please reconsider the r-. You can update android to do something separate from what is in ReaderMode.jsm if/when that is necessary, after this lands, but for the moment I don't see a convincing reason to stop the code sharing that is already there, especially given the regressions caused by the proposed patch in [bug 1358946](/show_bug.cgi?id=1358946 "VERIFIED FIXED - Reader mode page is saved as normal bookmark").
[Attachment #8860639](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") -
Flags: review- → review?(cnevinchen)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1358248#a1376655_1689)• 8 years ago |

Flags: sec-bounty?

|  | [Nevin Chen(Not active on Bugzilla)](/user_profile?user_id=582291) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1358248#c24)• 8 years ago |
|  | |

Comment on [attachment 8860639](/attachment.cgi?id=8860639 "Patch to fix url bar display on desktop") [[details]](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") [[diff]](/attachment.cgi?id=8860639&action=diff "Patch to fix url bar display on desktop") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8860639)
Patch to fix url bar display on desktop
># HG changeset patch
># User Gijs Kruitbosch <gijskruitbosch@gmail.com>
># Date 1492869622 -3600
># Sat Apr 22 15:00:22 2017 +0100
># Node ID 50cff9056c43624c2638e6f4ad7d3a80508053a3
># Parent 7d85b081bfabe91dbf18a421f1eee2a32f335823
>[Bug 1358248](/show_bug.cgi?id=1358248 "VERIFIED FIXED - Address bar spoof in reader mode"), r?maliu,evanxd
>
>MozReview-Commit-ID: 1EBZFcyvmY1
>
>diff --git a/browser/base/content/urlbarBindings.xml b/browser/base/content/urlbarBindings.xml
>--- a/browser/base/content/urlbarBindings.xml
>+++ b/browser/base/content/urlbarBindings.xml
>@@ -184,19 +184,19 @@ file, You can obtain one at <http://mozil>
> break;
> }
> case "extension": {
> returnValue = action.params.content;
> break;
> }
> }
> } else {
>- let originalUrl = ReaderMode.getOriginalUrl(aValue);
>+ let originalUrl = ReaderMode.getOriginalUrlObjectForDisplay(aValue);
> if (originalUrl) {
>- returnValue = originalUrl;
>+ returnValue = originalUrl.spec;
> }
> }
>
> // Set the actiontype only if the user is not overriding actions.
> if (action && this.\_pressedNoActionKeys.size == 0) {
> this.setAttribute("actiontype", action.type);
> } else {
> this.removeAttribute("actiontype");
>@@ -820,26 +820,27 @@ file, You can obtain one at <http://mozil>
> try {
> uri = uriFixup.createFixupURI(inputVal, Ci.nsIURIFixup.FIXUP\_FLAG\_NONE);
> } catch (e) {}
> if (!uri)
> return selectedVal;
> }
>
> // Avoid copying 'about:reader?url=', and always provide the original URI:
>- let readerOriginalURL = ReaderMode.getOriginalUrl(uri.spec);
>- if (readerOriginalURL) {
>- uri = uriFixup.createFixupURI(readerOriginalURL, Ci.nsIURIFixup.FIXUP\_FLAG\_NONE);
>+ // Reader mode ensures we call createExposableURI itself.
>+ let readerStrippedURI = ReaderMode.getOriginalUrlObjectForDisplay(uri.spec);
>+ if (readerStrippedURI) {
>+ uri = readerStrippedURI;
>+ } else {
>+ // Only copy exposable URIs
>+ try {
>+ uri = uriFixup.createExposableURI(uri);
>+ } catch (ex) {}
> }
>
>- // Only copy exposable URIs
>- try {
>- uri = uriFixup.createExposableURI(uri);
>- } catch (ex) {}
>-
> // If the entire URL is selected, just use the actual loaded URI,
> // unless we want a decoded URI, or it's a data: or javascript: URI,
> // since those are hard to read when encoded.
> if (inputVal == selectedVal &&
> !uri.schemeIs("javascript") && !uri.schemeIs("data") &&
> !Services.prefs.getBoolPref("browser.urlbar.decodeURLsOnCopy")) {
> return uri.spec;
> }
>diff --git a/mobile/android/chrome/content/browser.js b/mobile/android/chrome/content/browser.js
>--- a/mobile/android/chrome/content/browser.js
>+++ b/mobile/android/chrome/content/browser.js
>@@ -4515,24 +4515,17 @@ Tab.prototype = {
> // browser.contentDocument is changed to the new document we're loading
> this.contentDocumentIsDisplayed = false;
> this.hasTouchListener = false;
> Services.obs.notifyObservers(this.browser, "Session:NotifyLocationChange");
> }
> },
>
> \_stripAboutReaderURL: function (originalURI) {
>- try {
>- let strippedURL = ReaderMode.getOriginalUrl(originalURI.spec);
>- if(strippedURL){
>- // Continue to create exposable uri if original uri is stripped.
>- originalURI = URIFixup.createExposableURI(Services.io.newURI(strippedURL));
>- }
>- } catch (ex) { }
>- return originalURI;
>+ return ReaderMode.getOriginalUrlObjectForDisplay(originalURI.spec) || originalURI;
> },
>
> // Properties used to cache security state used to update the UI
> \_state: null,
> \_hostChanged: false, // onLocationChange will flip this bit
>
> onSecurityChange: function(aWebProgress, aRequest, aState) {
> // Don't need to do anything if the data we use to update the UI hasn't changed
>diff --git a/toolkit/components/reader/ReaderMode.jsm b/toolkit/components/reader/ReaderMode.jsm
>--- a/toolkit/components/reader/ReaderMode.jsm
>+++ b/toolkit/components/reader/ReaderMode.jsm
>@@ -161,16 +161,34 @@ this.ReaderMode = {
> let uriObj = Services.io.newURI(originalUrl);
> uriObj = Services.io.newURI("#" + outerHash, null, uriObj);
> originalUrl = uriObj.spec;
> } catch (ex) {}
> }
> return originalUrl;
> },
>
>+ getOriginalUrlObjectForDisplay(url) {
>+ let originalUrl = this.getOriginalUrl(url);
>+ if (originalUrl) {
>+ let uriObj;
>+ try {
>+ uriObj = Services.uriFixup.createFixupURI(originalUrl, Services.uriFixup.FIXUP\_FLAG\_NONE);
>+ } catch (ex) {
>+ return null;
>+ }
>+ try {
>+ return Services.uriFixup.createExposableURI(uriObj);
>+ } catch (ex) {
>+ return null;
>+ }
>+ }
>+ return null;
>+ },
>+
> /\*\*
> \* Decides whether or not a document is reader-able without parsing the whole thing.
> \*
> \* @param doc A document to parse.
> \* @return boolean Whether or not we should show the reader mode button.
> \*/
> isProbablyReaderable(doc) {
> // Only care about 'real' HTML documents:Flags: needinfo?(cnevinchen)
[Attachment #8860639](/attachment.cgi?id=8860639&action=edit "Patch to fix url bar display on desktop") -
Flags: review?(cnevinchen) → review+

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1358248#c25)• 8 years ago |
|  | |

remote: <https://hg.mozilla.org/integration/mozilla-inbound/rev/5e426eaa0546c421e106c47446ae4cc72c7bb110>
remote: <https://hg.mozilla.org/integration/mozilla-inbound/rev/3de9541d95106d727a09379e7c19d53774dd398b>

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1358248#c26)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/5e426eaa0546>
<https://hg.mozilla.org/mozilla-central/rev/3de9541d9510>
<https://hg.mozilla.org/mozilla-central/rev/9a806ddbcfc6>Status: ASSIGNED → RESOLVEDClosed: 8 years ago
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla55

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1358248#a1761896_1689)• 8 years ago |

Group: firefox-core-security → core-security-release

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1358248#c27)• 8 years ago |
|  | |

Can this ride the 55 train or should we consider it for backport?Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1358248#c28)• 8 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #27](/show_bug.cgi?id=1358248#c27 "VERIFIED FIXED - Address bar spoof in reader mode"))
> Can this ride the 55 train or should we consider it for backport?
We should probably backport to 54. I need to collapse in the eslint fix Wes kindly added for me and fill out uplift requests. Hopefully tomorrow / Saturday, otherwise Monday. Leaving ni.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1358248#c29)• 8 years ago |
|  | |

I'm assuming [comment 28](/show_bug.cgi?id=1358248#c28 "VERIFIED FIXED - Address bar spoof in reader mode") was an implicit wontfix for esr52.
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=wontfix)

|  | [Marcia Knous [:marcia]](/user_profile?user_id=8519) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1358248#c30)• 8 years ago |
|  | |

Gijs: [Bug 1364056](/show_bug.cgi?id=1364056 "RESOLVED FIXED - Reader view is broken some of the time due to attempting to use dead 'document' references to get a URL") indicates Reader view is not working properly both on Desktop and Android - can you take a look? Pascal's hint in [Comment 7](/show_bug.cgi?id=1358248#c7 "VERIFIED FIXED - Address bar spoof in reader mode") led me back to this bug.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1358248#c31)• 8 years ago |
|  | |

(In reply to Marcia Knous [:marcia - use ni] from [comment #30](/show_bug.cgi?id=1358248#c30 "VERIFIED FIXED - Address bar spoof in reader mode"))
> Gijs: [Bug 1364056](/show_bug.cgi?id=1364056 "RESOLVED FIXED - Reader view is broken some of the time due to attempting to use dead 'document' references to get a URL") indicates Reader view is not working properly both on
> Desktop and Android - can you take a look? Pascal's hint in [Comment 7](/show_bug.cgi?id=1358248#c7 "VERIFIED FIXED - Address bar spoof in reader mode") led me
> back to this bug.
I've commented on that bug. I'm jetlagged and have a pile of work on my plate right now. If nobody beats me to it I'll address this on Monday. Leaving ni and not requesting uplift until then.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1358248#c32)• 8 years ago |
|  | |

Attached patch

[Patches for beta](attachment.cgi?id=8868506&action=diff)
— [Details](attachment.cgi?id=8868506&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8868506)

Approval Request Comment
[Feature/Bug causing the regression]: reader mode URL display in desktop location bar / [bug 1173823](/show_bug.cgi?id=1173823 "RESOLVED FIXED - Reader View ignores <base href=\"...\">") for the in-content URL shown
[User impact if declined]: users might be misled about what page they're looking at
[Is this code covered by automated tests?]: in a general "does it work" sense: yes. In the "are these security bugs fixed" sense: no.
[Has the fix been verified in Nightly?]: not yet
[Needs manual test from QE? If yes, steps to reproduce]: Wouldn't hurt. Steps based on [comment 0](/show_bug.cgi?id=1358248#c0 "VERIFIED FIXED - Address bar spoof in reader mode"):
1. paste about:reader?url=https%3A%2F%2Ftest.shhnjk.com%2Fcsp\_read.php into the URL bar and hit enter.
Expected: location bar shows test.shhnjk.com but does NOT show 'google,com@'
Pre-patch: location bar also shows 'google,com@'
Second expectation: at the top of the page (ie in-content), the link should NOT say "google.com"
Pre-patch: that link says "google.com".
[List of other uplifts needed for the feature/fix]: none
[Is the change risky?]: not very
[Why is the change risky/not risky?]: It's a relatively small js-only patch. We're reorganizing some code so more of it is shared between desktop and android, to avoid hitting this problem in the future (as this bug was initially fixed only for android). This is relatively straightforward and the automated test coverage means we're relatively sure it doesn't majorly affect anything. I fixed one regression in [bug 1364056](/show_bug.cgi?id=1364056 "RESOLVED FIXED - Reader view is broken some of the time due to attempting to use dead 'document' references to get a URL"), which is included in this set of patches.
[String changes made/needed]: nopeFlags: needinfo?(gijskruitbosch+bugs)
[Attachment #8868506](/attachment.cgi?id=8868506&action=edit "Patches for beta") -
Flags: review+
[Attachment #8868506](/attachment.cgi?id=8868506&action=edit "Patches for beta") -
Flags: approval-mozilla-beta?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1358248#c33)• 8 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #29](/show_bug.cgi?id=1358248#c29 "VERIFIED FIXED - Address bar spoof in reader mode"))
> I'm assuming [comment 28](/show_bug.cgi?id=1358248#c28 "VERIFIED FIXED - Address bar spoof in reader mode") was an implicit wontfix for esr52.
FWIW, I am on the fence about esr52. This isn't sec-high/sec-crit, but I think the in-content domain we show is the typical kind of thing that, in principle, shouldn't matter to users and isn't even a security bug (after all, untrusted page content can say whatever it likes), but is helpful to scammers in practice.
On the flip side, reader mode is pretty careful about HTML sanitization and so it would be very hard to take advantage of this inside the page, as we strip forms, scripts, frames, and a bunch of other things. Plus you have to convince someone to manually navigate to the about:reader URL.
I could be convinced either way but I'm not requesting uplift for 52 right now.

|  | [Gerry Chang [:gchang]](/user_profile?user_id=506302) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1358248#c34)• 8 years ago |
|  | |

Hi Mihai & Brindusa,
could you help find someone to verify if this issue was fixed both in desktop & mobile on a latest Nightly build? Thanks!Flags: qe-verify+Flags: needinfo?(mihai.ninu)Flags: needinfo?(brindusa.tot)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1358248#c35)• 8 years ago |
|  | |

I could reproduce this issue with a Nightly build from 04/26/2017, Version 55.0a1, Build ID 20170426030329 under Windows 10.
Verified as fixed with latest Nightly build 55.0a1, Build ID 20170517030204 on Windows 10 x64, Mac 10.12 and Ubuntu 16.04.Status: RESOLVED → VERIFIED
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=verified)Flags: needinfo?(brindusa.tot)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1358248#a2496234_1689)• 8 years ago |

Flags: sec-bounty? → sec-bounty+Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---)

|  | [Jun (Request needinfo for comment, I ignore other updates)](/user_profile?user_id=538140)  Reporter |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1358248#c36)• 8 years ago |
|  | |

Thanks!!!

|  | [Gerry Chang [:gchang]](/user_profile?user_id=506302) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1358248#c37)• 8 years ago |
|  | |

Comment on [attachment 8868506](/attachment.cgi?id=8868506 "Patches for beta") [[details]](/attachment.cgi?id=8868506&action=edit "Patches for beta") [[diff]](/attachment.cgi?id=8868506&action=diff "Patches for beta") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1358248&attachment=8868506)
Patches for beta
Fix a security issue related to reader mode URL and was verified. Beta54+. Should be in 54 beta 10.
[Attachment #8868506](/attachment.cgi?id=8868506&action=edit "Patches for beta") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1358248#c38)• 8 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/ce1b967c11f7>
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed)

|  | [u549602](/user_profile?user_id=549602) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1358248#c39)• 8 years ago |
|  | |

No issues present on the latest Nightly build, 55.0a1 on mobile.
This issue was tested on a Samsung Galaxy s6 Edge(Android 6.0) and on a Xiaomi mi i4 (Android 5.0.2)Flags: needinfo?(mihai.ninu)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1358248#a3991268_280903)• 8 years ago |

[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
[54+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=54%2B) → ---Whiteboard: [adv-main54+]

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1358248#c40)• 8 years ago |
|  | |

I've reproduce this issue with an old Nightly build, following the STR from [comment 32](/show_bug.cgi?id=1358248#c32 "VERIFIED FIXED - Address bar spoof in reader mode").
This bug is not reproducible anymore on 54.0 (20170605134926) under Windows 10 x64, Mac OS X 10.11.6 and Ubuntu 16.04 x64 LTS.
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=verified)Flags: qe-verify+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1358248#a4061844_280903)• 8 years ago |

Alias: CVE-2017-7762

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1358248#a16352755_1689)• 7 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1358248#a224368649_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1358248&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [:Gijs (he/him)](/user_profile?user_id=159069)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_73f8d6fa_20250126_041500.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_4a990d69_20250124_225312.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2017-16

## Security vulnerabilities fixed in Firefox ESR 52.2

Announced
June 13, 2017
Impact
critical
Products
Firefox ESR
Fixed in

* Firefox ESR 52.2

#### [#CVE-2017-5472: Use-after-free using destroyed node when regenerating trees](#CVE-2017-5472)

Reporter
Nils
Impact
critical
##### Description

A use-after-free vulnerability with the frameloader during tree reconstruction while regenerating CSS layout when attempting to use a node in the tree that no longer exists. This results in a potentially exploitable crash.

##### References

* [Bug 1365602](https://bugzilla.mozilla.org/show_bug.cgi?id=1365602)

#### [#CVE-2017-7749: Use-after-free during docshell reloading](#CVE-2017-7749)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability when using an incorrect URL during the reloading of a docshell. This results in a potentially exploitable crash.

##### References

* [Bug 1355039](https://bugzilla.mozilla.org/show_bug.cgi?id=1355039)

#### [#CVE-2017-7750: Use-after-free with track elements](#CVE-2017-7750)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability during video control operations when a `<track>` element holds a reference to an older window if that window has been replaced in the DOM. This results in a potentially exploitable crash.

##### References

* [Bug 1356558](https://bugzilla.mozilla.org/show_bug.cgi?id=1356558)

#### [#CVE-2017-7751: Use-after-free with content viewer listeners](#CVE-2017-7751)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability with content viewer listeners that results in a potentially exploitable crash.

##### References

* [Bug 1363396](https://bugzilla.mozilla.org/show_bug.cgi?id=1363396)

#### [#CVE-2017-7752: Use-after-free with IME input](#CVE-2017-7752)

Reporter
Nils
Impact
moderate
##### Description

A use-after-free vulnerability during specific user interactions with the input method editor (IME) in some languages due to how events are handled. This results in a potentially exploitable crash but would require specific user interaction to trigger.

##### References

* [Bug 1359547](https://bugzilla.mozilla.org/show_bug.cgi?id=1359547)

#### [#CVE-2017-7754: Out-of-bounds read in WebGL with ImageInfo object](#CVE-2017-7754)

Reporter
Tobias Klein
Impact
high
##### Description

An out-of-bounds read in WebGL with a maliciously crafted `ImageInfo` object during WebGL operations.

##### References

* [Bug 1357090](https://bugzilla.mozilla.org/show_bug.cgi?id=1357090)

#### [#CVE-2017-7755: Privilege escalation through Firefox Installer with same directory DLL files](#CVE-2017-7755)

Reporter
Yuji Tounai of NTT Communications, Eili Masami of Tachibana Lab
Impact
high
##### Description

The Firefox installer on Windows can be made to load malicious DLL files stored in the same directory as the installer when it is run. This allows privileged execution if the installer is run with elevated privileges.
*Note: This attack only affects Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1361326](https://bugzilla.mozilla.org/show_bug.cgi?id=1361326)

#### [#CVE-2017-7756: Use-after-free and use-after-scope logging XHR header errors](#CVE-2017-7756)

Reporter
Abhishek Arya
Impact
high
##### Description

A use-after-free and use-after-scope vulnerability when logging errors from headers for XML HTTP Requests (XHR). This could result in a potentially exploitable crash.

##### References

* [Bug 1366595](https://bugzilla.mozilla.org/show_bug.cgi?id=1366595)

#### [#CVE-2017-7757: Use-after-free in IndexedDB](#CVE-2017-7757)

Reporter
F. Alonso (revskills)
Impact
high
##### Description

A use-after-free vulnerability in IndexedDB when one of its objects is destroyed in memory while a method on it is still being executed. This results in a potentially exploitable crash.

##### References

* [Bug 1356824](https://bugzilla.mozilla.org/show_bug.cgi?id=1356824)

#### [#CVE-2017-7778: Vulnerabilities in the Graphite 2 library](#CVE-2017-7778)

Reporter
Holger Fuhrmannek, Tyson Smith
Impact
high
##### Description

A number of security vulnerabilities in the Graphite 2 library including out-of-bounds reads, buffer overflow reads and writes, and the use of uninitialized memory. These issues were addressed in Graphite 2 version 1.3.10.

##### References

* [Graphite2 lz4::decompress out of bounds write (CVE-2017-7778)](https://bugzilla.mozilla.org/show_bug.cgi?id=1349310)
* [Graphite2 out of bounds read [@ graphite2::Pass::readPass] (CVE-2017-7771)](https://bugzilla.mozilla.org/show_bug.cgi?id=1350047)
* [Graphite2 heap-buffer-overflow write [@ lz4::decompress] (CVE-2017-7772)](https://bugzilla.mozilla.org/show_bug.cgi?id=1352745)
* [Graphite2 heap-buffer-overflow write [@ lz4::decompress] src/Decompressor (CVE-2017-7773)](https://bugzilla.mozilla.org/show_bug.cgi?id=1352747)
* [Graphite2 out of bounds read [@ graphite2::Silf::readGraphite] (CVE-2017-7774)](https://bugzilla.mozilla.org/show_bug.cgi?id=1355174)
* [Graphite2 Assertion 'size() > n' failed (CVE-2017-7775)](https://bugzilla.mozilla.org/show_bug.cgi?id=1355182)
* [Graphite2 heap-buffer-overflow read [@ graphite2::Silf::getClassGlyph] (CVE-2017-7776)](https://bugzilla.mozilla.org/show_bug.cgi?id=1356607)
* [Graphite2 use of uninitialized memory [@ graphite2::GlyphCache::Loader::read\_glyph] (CVE-2017-7777)](https://bugzilla.mozilla.org/show_bug.cgi?id=1358551)

#### [#CVE-2017-7758: Out-of-bounds read in Opus encoder](#CVE-2017-7758)

Reporter
Nicolas Trippar of Zimperium zLabs
Impact
high
##### Description

An out-of-bounds read vulnerability with the Opus encoder when the number of channels in an audio stream changes while the encoder is in use.

##### References

* [Bug 1368490](https://bugzilla.mozilla.org/show_bug.cgi?id=1368490)

#### [#CVE-2017-7760: File manipulation and privilege escalation via callback parameter in Mozilla Windows Updater and Maintenance Service](#CVE-2017-7760)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

The Mozilla Windows updater modifies some files to be updated by reading the original file and applying changes to it. The location of the original file can be altered by a malicious user by passing a special path to the callback parameter through the Mozilla Maintenance Service, allowing the manipulation of files in the installation directory and privilege escalation by manipulating the Mozilla Maintenance Service, which has privileged access.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1348645](https://bugzilla.mozilla.org/show_bug.cgi?id=1348645)

#### [#CVE-2017-7761: File deletion and privilege escalation through Mozilla Maintenance Service helper.exe application](#CVE-2017-7761)

Reporter
Holger Fuhrmannek
Impact
moderate
##### Description

The Mozilla Maintenance Service `helper.exe` application creates a temporary directory writable by non-privileged users. When this is combined with creation of a junction (a form of symbolic link), protected files in the target directory of the junction can be deleted by the Mozilla Maintenance Service, which has privileged access.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1215648](https://bugzilla.mozilla.org/show_bug.cgi?id=1215648)
* [Code execution / Privilege escalation problems with NSIS installers](https://sourceforge.net/p/nsis/bugs/1125/)

#### [#CVE-2017-7763: Mac fonts render some unicode characters as spaces](#CVE-2017-7763)

Reporter
Michał Bentkowski
Impact
moderate
##### Description

Default fonts on OS X display some Tibetan characters as whitespace. When used in the addressbar as part of an IDN this can be used for domain name spoofing attacks.
*Note: This attack only affects OS X operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1360309](https://bugzilla.mozilla.org/show_bug.cgi?id=1360309)

#### [#CVE-2017-7764: Domain spoofing with combination of Canadian Syllabics and other unicode blocks](#CVE-2017-7764)

Reporter
Samuel Erb
Impact
moderate
##### Description

Characters from the "Canadian Syllabics" unicode block can be mixed with characters from other unicode blocks in the addressbar instead of being rendered as their raw "punycode" form, allowing for domain name spoofing attacks through character confusion. The current Unicode standard allows characters from "Aspirational Use Scripts" such as Canadian Syllabics to be mixed with Latin characters in the "moderately restrictive" IDN profile. We have changed Firefox behavior to match the upcoming Unicode version 10.0 which removes this category and treats them as "Limited Use Scripts."

##### References

* [Bug 1364283](https://bugzilla.mozilla.org/show_bug.cgi?id=1364283)
* [Proposed Update to Unicode Standard Annex](http://www.unicode.org/reports/tr31/tr31-26.html#Aspirational_Use_Scripts)

#### [#CVE-2017-7765: Mark of the Web bypass when saving executable files](#CVE-2017-7765)

Reporter
Jonathan Birch and Microsoft Vulnerability Research
Impact
moderate
##### Description

The "Mark of the Web" was not correctly saved on Windows when files with very long names were downloaded from the Internet. Without the Mark of the Web data, the security warning that Windows displays before running executables downloaded from the Internet is not shown.
*Note: This attack only affects Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1273265](https://bugzilla.mozilla.org/show_bug.cgi?id=1273265)

#### [#CVE-2017-7766: File execution and privilege escalation through updater.ini, Mozilla Windows Updater, and Mozilla Maintenance Service](#CVE-2017-7766)

Reporter
Seb Patane
Impact
high
##### Description

An attack using manipulation of `updater.ini` contents, used by the Mozilla Windows Updater, and privilege escalation through the Mozilla Maintenance Service to allow for arbitrary file execution and deletion by the Maintenance Service, which has privileged access.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1342742](https://bugzilla.mozilla.org/show_bug.cgi?id=1342742)

#### [#CVE-2017-7767: Privilege escalation and arbitrary file overwrites through Mozilla Windows Updater and Mozilla Maintenance Service](#CVE-2017-7767)

Reporter
Seb Patane
Impact
moderate
##### Description

The Mozilla Maintenance Service can be invoked by an unprivileged user to overwrite arbitrary files with junk data using the Mozilla Windows Updater, which runs with the Maintenance Service's privileged access.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1336964](https://bugzilla.mozilla.org/show_bug.cgi?id=1336964)

#### [#CVE-2017-7768: 32 byte arbitrary file read through Mozilla Maintenance Service](#CVE-2017-7768)

Reporter
Seb Patane
Impact
moderate
##### Description

The Mozilla Maintenance Service can be invoked by an unprivileged user to read 32 bytes of any arbitrary file on the local system by convincing the service that it is reading a status file provided by the Mozilla Windows Updater. The Mozilla Maintenance Service executes with privileged access, bypassing system protections against unprivileged users.
*Note: This attack requires local system access and only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1336979](https://bugzilla.mozilla.org/show_bug.cgi?id=1336979)

#### [#CVE-2017-5470: Memory safety bugs fixed in Firefox 54 and Firefox ESR 52.2](#CVE-2017-5470)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Tyson Smith, Mats Palmgren, Philipp, Masayuki Nakano, Christian Holler, Andrew McCreight, Gary Kwong, André Bargull, Carsten Book, Jesse Schwartzentruber, Julian Hector, Marcia Knous, Ronald Crane, and Nils Ohlmeier reported memory safety bugs present in Firefox 53 and Firefox ESR 52.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 54 and Firefox ESR 52.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1359639%2C1349595%2C1352295%2C1352556%2C1342552%2C1342567%2C1346012%2C1366140%2C1368732%2C1297111%2C1362590%2C1357462%2C1363280%2C1349266%2C1352093%2C1348424%2C1347748%2C1356025%2C1325513%2C1367692)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_e17eb0c3_20250126_041458.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1215648)
* [XML](/show_bug.cgi?ctype=xml&id=1215648)

Closed
[Bug 1215648](/show_bug.cgi?id=1215648)
(CVE-2017-7761)

Opened 9 years ago
Closed 8 years ago

# Maintenance Service helper.exe File Deletion Elevation of Privilege

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Maintenance Service helper.exe File Deletion Elevation of Privilege

## Categories

### (Firefox :: Installer, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Installer#Installer)

Installer
▾

Firefox :: Installer
Bugs and feature requests for the Firefox application install wizard.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Installer&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Installer&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Installer)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla55

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=wontfix) |
| firefox52 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=wontfix) |
| firefox-esr52 | [54+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=54%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=verified) |
| firefox53 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix) |
| firefox54 | [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=verified) |
| firefox55 | [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 |  | wontfix |
| relnote-firefox |  | --- |
| firefox52 |  | wontfix |
| firefox-esr52 | 54+ | verified |
| firefox53 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox54 | + | verified |
| firefox-esr128 | --- | --- |
| firefox55 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: hofusec, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/270499a0d11a67b911327984af6ffe90?d=mm&size=40)  [hofusec](/user_profile?user_id=436533)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/50e82ef70720dfcf1385f583e34f9ba9?d=mm&size=40)  [erchen](/user_profile?user_id=753852)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

21 people

## References

### ( [URL](https://sourceforge.net/p/nsis/bugs/1125/ "https://sourceforge.net/p/nsis/bugs/1125/") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1236624](/show_bug.cgi?id=1236624 "RESOLVED FIXED - Please add NSIS 3 release to the Windows build slaves")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1215648&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1215648)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[sourceforge.net/p/nsis/bugs/1125](https://sourceforge.net/p/nsis/bugs/1125/ "https://sourceforge.net/p/nsis/bugs/1125/")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-moderate, Whiteboard: [adv-main54+][adv-esr52.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2017-7761

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main54+][adv-esr52.2+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c28 "8 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [qe-verify](#c27 "8 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [poc.zip](/attachment.cgi?id=8675071)  [9 years ago](#c0)  [Holger Fuhrmannek](/user_profile?user_id=436533)   2.68 MB, application/zip |  | [Details](/attachment.cgi?id=8675071&action=edit) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Holger Fuhrmannek](/user_profile?user_id=436533)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1215648#c0)• 9 years ago |
|  | |

Attached file
[poc.zip](attachment.cgi?id=8675071)
— [Details](attachment.cgi?id=8675071&action=edit)

The helper.exe creates a directory "ns{random character a-z generated with GetTickCount%26}{16bit hex value from GetTickCount()}.tmp" during execution in the C:\Windows\Temp directory und deletes it later.
At least in win7 the temp directory is writable for non privileged users. If during the execution a junction is created in the nsXXXX.tmp directory also the content of the target directory of the junction will be deleted from the helper.exe.
With the maintenance service and this vulnerbility it is possible to delete arbitrary files for non privileged users. Further with the ability to delete arbitrary files it´s possible to elevate privilege further.
The poc tries to empty the C:\test directory by creating a junction to it in the C:\Windows\temp\nsXXXX.tmp during the execution of the helper.exe. I have tested it with win7.
1.) first create the test directory which contains a file.
2.) in the updatework directory right to the loop.bat copy the updater.exe from the firefox directory and a current complete update mar file named to update.mar of the target firefox version (for example: <https://ftp.mozilla.org/pub/mozilla.org/firefox/releases/latest/update/win32/de/firefox-41.0.2.complete.mar>)
3.) alter the paths in the loop.bat
4.) start the poc.exe and poc.bat and after a short time if the poc.exe is closed the C:\test directory will be empty.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a339607_1689)• 9 years ago |

Flags: needinfo?(kjozwiak)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1215648#c1)• 9 years ago |
|  | |

Holger, I'm trying to reproduce this issue using the poc.zip you provided but I'm not having and luck.. Is there something that I'm missing? Here's the steps that I'm using:
\* created C:\test\removeMe.txt
\* installed fx 41.0.2
\* download the poc.zip from [comment #0](/show_bug.cgi?id=1215648#c0 "VERIFIED FIXED - Maintenance Service helper.exe File Deletion Elevation of Privilege") and extracted it into "Desktop"
\* copied the updater.exe from "C:\Program Files (x86)\Mozilla Firefox\" into "C:\Users\Kamil Jozwiak\Desktop\poc\updatework"
\* Downloaded <https://ftp.mozilla.org/pub/firefox/releases/latest/update/win32/en-US/firefox-41.0.2.complete.mar>
\* renamed firefox-41.0.2.complete.mar -> update.mar and placed it into "C:\Users\Kamil Jozwiak\Desktop\poc\updatework"
\* Changed the paths in loop.bat to the following:
sc start MozillaMaintenance MozillaMaintenance software-update "C:\Users\Kamil Jozwiak\Desktop\poc\updatework\updater.exe" "C:\Users\Kamil Jozwiak\Desktop\poc\updatework" "C:\Program Files (x86)\Mozilla Firefox" "C:\Program Files (x86)\Mozilla Firefox\updated" -1 /replace "C:\Users\Kamil Jozwiak\Desktop\poc\updatework\updater.exe" 3
goto :m
\* launched loop.bat & poc.exe at the same time.
Whenever I run the poc.exe, I get the following output from the start:
>> poc tries empty dir C:\test
>> success!
I tried running the poc.exe several times while loop.bat was running but got the same output as mentioned above. C:\test\removeMe.txt is never removed. I've also checked both "update.status" and "update.log" under "C:\Users\Kamil Jozwiak\Desktop\poc\updatework" and ensured that there weren't any issues related to incorrect paths.
I've also tried this on the following OS's:
\* Win 7 x64 VM - Couldn't reproduce
\* Win 8.1 x64 VM - Couldn't reproduce
\* Win 10 x64 VM -> Couldn't reproduceFlags: needinfo?(kjozwiak) → needinfo?(hofusec)

|  | [Holger Fuhrmannek](/user_profile?user_id=436533)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1215648#c2)• 9 years ago |
|  | |

I'm sorry it should be:
1.) first create the test directory which contains a file named a.txtFlags: needinfo?(hofusec)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1215648#c3)• 9 years ago |
|  | |

> I'm sorry it should be:
> 1.) first create the test directory which contains a file named a.txt
Thanks, that definitely helped :)
Using the steps from [comment #1](/show_bug.cgi?id=1215648#c1 "VERIFIED FIXED - Maintenance Service helper.exe File Deletion Elevation of Privilege"), I could reproduce the issue. Once I ran the poc.exe, I received the following command prompt:
>> poc tries empty dir C:\test
Launch loop.bat and within 30s-1m, poc.exe will close. Look into C:\test and you'll notice a.txt has been deleted from the directory.
OS's:
- Win 7 x64 VM - Reproduced (a.txt removed)
- Win 10 x64 VM - Reproduced (a.txt removed)
Dan, who should take a look at this? rstrong?Flags: needinfo?(dveditz)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1215648#c4)• 9 years ago |
|  | |

Hopefully spohl or mhowell can take this

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1215648#c5)• 9 years ago |
|  | |

I don't think we can do anything to fix this, because this particular temporary directory is completely managed by NSIS and our code never touches it directly. This is the same directory involved in [bug 709738](/show_bug.cgi?id=709738 "NEW - helper.exe should not drop system.dll in %TEMP% due to AppLocker not allowing the loading of DLL's from %TEMP%"); it's used as a place to unpack the NSIS plugin files into. We may be creating individual files in the same directory, I'm not sure, but if so then we delete those individually by name, so those are not the source of this problem.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a3367826_280903)• 9 years ago |

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1215648#c6)• 9 years ago |
|  | |

Is there a newer version of NSIS that doesn't have this problem?

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1215648#c7)• 9 years ago |
|  | |

Stephen, do you have any thoughts on this?Flags: needinfo?(spohl.mozilla.bugs)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1215648#c8)• 9 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #6](/show_bug.cgi?id=1215648#c6 "VERIFIED FIXED - Maintenance Service helper.exe File Deletion Elevation of Privilege"))
> Is there a newer version of NSIS that doesn't have this problem?
No; the newest version available is 3.0 beta 2, and it has the same behavior.

|  | [Stephen A Pohl [:spohl]](/user_profile?user_id=456485) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1215648#c9)• 9 years ago |
|  | |

(In reply to Matt Wobensmith [:mwobensmith][:matt] from [comment #7](/show_bug.cgi?id=1215648#c7 "VERIFIED FIXED - Maintenance Service helper.exe File Deletion Elevation of Privilege"))
> Stephen, do you have any thoughts on this?
Unfortunately, if this directory is completely managed by NSIS (as mentioned in [comment 5](/show_bug.cgi?id=1215648#c5 "VERIFIED FIXED - Maintenance Service helper.exe File Deletion Elevation of Privilege")) and there is no newer version of NSIS without this problem ([comment 8](/show_bug.cgi?id=1215648#c8 "VERIFIED FIXED - Maintenance Service helper.exe File Deletion Elevation of Privilege")) I don't have a good solution for this either.Flags: needinfo?(spohl.mozilla.bugs)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1215648#c10)• 9 years ago |
|  | |

Should we close this as "won't fix" if we are unable to fix this issue?
Is there no option to fix this in NSIS?Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1215648#c11)• 9 years ago |
|  | |

Yeah, the only thing we can do for this is wait and see if a new NSIS release does something about it. There has been a new version, 3.0 beta 3, since I posted [comment 8](/show_bug.cgi?id=1215648#c8 "VERIFIED FIXED - Maintenance Service helper.exe File Deletion Elevation of Privilege"), but I don't see any changes in it that would make a difference here. I assume that means we should WONTFIX this bug, instead of just leaving it alone in hopes of some new NSIS capability materializing?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1215648#c12)• 9 years ago |
|  | |

Matt: Have we reported this problem to NSIS so that they will fix it? If they don't even know we could be hoping for a long time.Flags: needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1215648#c13)• 9 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #12](/show_bug.cgi?id=1215648#c12 "VERIFIED FIXED - Maintenance Service helper.exe File Deletion Elevation of Privilege"))
> Matt: Have we reported this problem to NSIS so that they will fix it? If
> they don't even know we could be hoping for a long time.
NSIS has an issue on file [<https://sourceforge.net/p/nsis/bugs/1125/>] which includes this and other related points.
It looks like there's been some activity on that issue in recent releases; I'll look into whether this bug has been addressed.Flags: needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1215648#c14)• 9 years ago |
|  | |

I cannot reproduce this bug on a custom build which uses at least NSIS 3.0 beta 3; poc.exe spews out a bunch of error code 5 results (that's the Win32 code for "access denied") and the target file remains in place. It looks like the temp directory is now created with tighter permissions when NSIS detects that it is running elevated.
Since NSIS 3.0 beta 3 fixes this bug, it is dependent on switching automation to (at least) that version, which is [bug 1236624](/show_bug.cgi?id=1236624 "RESOLVED FIXED - Please add NSIS 3 release to the Windows build slaves").Depends on: [1236624](/show_bug.cgi?id=1236624 "RESOLVED FIXED - Please add NSIS 3 release to the Windows build slaves")

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a17274878_280903)• 9 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1215648#c15)• 9 years ago |
|  | |

Matt, any progress on updating NSIS? It would be great to get this nine month old sec-high bug fixed. Thanks.Flags: needinfo?(mhowell)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1215648#c16)• 9 years ago |
|  | |

Per [comment #14](/show_bug.cgi?id=1215648#c14 "VERIFIED FIXED - Maintenance Service helper.exe File Deletion Elevation of Privilege") that is dependent on [bug 1236624](/show_bug.cgi?id=1236624 "RESOLVED FIXED - Please add NSIS 3 release to the Windows build slaves"). I asked for an update there.Flags: needinfo?(mhowell)

|  | [Stephanie Ouillon [:arroway] (needinfo me)](/user_profile?user_id=485442) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1215648#c17)• 8 years ago |
|  | |

Hi Matt,
the patch for [bug 1236624](/show_bug.cgi?id=1236624 "RESOLVED FIXED - Please add NSIS 3 release to the Windows build slaves") has landed. Does the new version fix this bug?Flags: needinfo?(mhowell)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1215648#c18)• 8 years ago |
|  | |

configure hasn't been modified to use the new version of NSIS yet so more still needs to be done.

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1215648#c19)• 8 years ago |
|  | |

Yeah, it looks like 3.0 beta 1 is being used on the build slaves right now. So we're not there yet.Flags: needinfo?(mhowell)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1215648#c20)• 8 years ago |
|  | |

Any news or a timeline for bug [bug 1236624](/show_bug.cgi?id=1236624 "RESOLVED FIXED - Please add NSIS 3 release to the Windows build slaves"), Matt? This is a really long standing security bug.Flags: needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1215648#c21)• 8 years ago |
|  | |

Sorry for the lack of updates here; yes, there has been some progress. Just left a new comment on [bug 1236624](/show_bug.cgi?id=1236624 "RESOLVED FIXED - Please add NSIS 3 release to the Windows build slaves").Flags: needinfo?(mhowell)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1215648#c22)• 8 years ago |
|  | |

The fix for this will need to be in the installer so changing componentComponent: Application Update → NSIS Installer

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1215648#c23)• 8 years ago |
|  | |

We are now running NSIS 3.01 in automation as of today's nightly build, and as expected the STR no longer work for me with that version.Status: NEW → RESOLVEDClosed: 8 years agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1215648#c24)• 8 years ago |
|  | |

I'm going to nominate [bug 1347191](/show_bug.cgi?id=1347191 "RESOLVED FIXED - Add support for NSIS 3.01 to moz.configure") and [bug 1351482](/show_bug.cgi?id=1351482 "RESOLVED FIXED - Upgrade to NSIS 3.01 for buildbot jobs") for Aurora54/ESR52 uplift so we can hopefully get this fixed on those branches as well.
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=wontfix)
[status-firefox53](/buglist.cgi?f1=cf_status_firefox53&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix)
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected)
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=wontfix)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)
[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%3F)
[tracking-firefox55](/buglist.cgi?f1=cf_tracking_firefox55&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%3F)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F)

|  | [Marcia Knous [:marcia]](/user_profile?user_id=8519) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1215648#c25)• 8 years ago |
|  | |

Tracking 54/55 for this sec-high issue.
[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B)
[tracking-firefox55](/buglist.cgi?f1=cf_tracking_firefox55&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a47537484_75935)• 8 years ago |

[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a48282299_1689)• 8 years ago |

Group: toolkit-core-security → core-security-release

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1215648#c26)• 8 years ago |
|  | |

We're now using NSIS 3.01 for Firefox 54+ and ESR52.2+ \m/
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed)Target Milestone: --- → mozilla55

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1215648#c27)• 8 years ago |
|  | |

We should probably have QE verify this.Flags: qe-verify+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a50030072_280903)• 8 years ago |

Flags: sec-bounty?

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a50077623_580382)• 8 years ago |

[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F) → [54+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=54%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1215648#c28)• 8 years ago |
|  | |

Rating should be sec-moderate to be consistent with other local file deletion bugs facilitated by the maintenance service.Flags: sec-bounty? → sec-bounty+Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1215648#c29)• 8 years ago |
|  | |

Before going through the verification process, I ensured that I could still reproduce the original issue with an older m-c that was still using a vulnerable NSIS version. Used the following build:
\* fx55.0a1, buildid: 20170401030204, changeset: 00a166a8640d
\*\* <https://archive.mozilla.org/pub/firefox/nightly/2017/04/2017-04-01-03-02-04-mozilla-central/>
\* using the STR from [comment#1](/show_bug.cgi?id=1215648#c1 "VERIFIED FIXED - Maintenance Service helper.exe File Deletion Elevation of Privilege"), "a.txe" was removed from "C:\test"
Once I managed to reproduce the issue as mentioned above, I went through the following verification process:
Windows 10 x64 VM - PASSED
\* fx55.0a1, buildid: 20170603030204, changeset: 43039280fe46
\*\* <https://archive.mozilla.org/pub/firefox/nightly/2017/06/2017-06-03-03-02-04-mozilla-central/>
\* fx54.0b13, buildid: 20170601133324, changeset: 20170601133324
\*\* <https://archive.mozilla.org/pub/firefox/candidates/54.0b13-candidates/build1/win32/en-US/>
Windows 7 x64 VM - PASSED
\* fx55.0a1, buildid: 20170605030204, changeset: 275588f4d852
\*\* <https://archive.mozilla.org/pub/firefox/nightly/2017/06/2017-06-05-03-02-04-mozilla-central/>
\* fx54.0b13, buildid: 20170601133324, changeset: cb4a4275b365
\*\* <https://archive.mozilla.org/pub/firefox/candidates/54.0b13-candidates/build1/win32/en-US/>
Once the fx52.2esr installer becomes available when we get closer to the release date, I'll go through the same verification process as mentioned above.
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=verified)
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=verified)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a51685606_280903)• 8 years ago |

Whiteboard: [adv-main54+][adv-esr52.2+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a51756377_280903)• 8 years ago |

Alias: CVE-2017-7761

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1215648#c30)• 8 years ago |
|  | |

Went through the same STR/process as per [comment#29](/show_bug.cgi?id=1215648#c29 "VERIFIED FIXED - Maintenance Service helper.exe File Deletion Elevation of Privilege") using the following build:
\* fx52.2.0, buildid: 20170607123825, changeset: f68e0d98a22a
\*\* <https://archive.mozilla.org/pub/firefox/candidates/52.2.0esr-candidates/build1/>
\* Windows 10 x64 VM - PASSED
\* Windows 7 Pro x64 VM - PASSEDStatus: RESOLVED → VERIFIED
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=verified)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a52307670_1689)• 8 years ago |

URL: [https://sourceforge.net/p/nsis/bugs/1...](https://sourceforge.net/p/nsis/bugs/1125/)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a64047353_1689)• 7 years ago |

Group: core-security-release

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a247013105_1)• 1 years ago |

Component: NSIS Installer → InstallerProduct: Toolkit → Firefox

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1215648#a272061679_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1215648&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Holger Fuhrmannek](/user_profile?user_id=436533)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_bb56cc5e_20250124_225311.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1360309)
* [XML](/show_bug.cgi?ctype=xml&id=1360309)

Closed
[Bug 1360309](/show_bug.cgi?id=1360309)
(CVE-2017-7763)

Opened 8 years ago
Closed 8 years ago

# Security issue: Domain spoofing thanks to U+0F8C rendered as space on Mac

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Security issue: Domain spoofing thanks to U+0F8C rendered as space on Mac

## Categories

### (Firefox :: Address Bar, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Address%20Bar#Address%20Bar)

Address Bar
▾

Firefox :: Address Bar
For bugs in the Firefox "Smart Location Bar" (aka Awesome Bar) UI element, including the bookmark and history autocomplete matching behavior.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Address%20Bar&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Address%20Bar&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Address%20Bar)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

53 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Firefox 55

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=wontfix) |
| firefox-esr52 | [54+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=54%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=verified) |
| firefox53 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix) |
| firefox54 | [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=verified) |
| firefox55 | [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 |  | wontfix |
| relnote-firefox |  | --- |
| firefox-esr52 | 54+ | verified |
| firefox53 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox54 | + | verified |
| firefox-esr128 | --- | --- |
| firefox55 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: michal, Assigned: jfkthame)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=40)  [jfkthame](/user_profile?user_id=329583)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0846dd8df4d811a89921ccac67816176?d=mm&size=40)  [michal](/user_profile?user_id=548021)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/d949a35ad3900bd0ee47938b23a0cbee?d=mm&size=40)  [dao](/user_profile?user_id=219124)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

20 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1390980](/show_bug.cgi?id=1390980 "RESOLVED FIXED - Domain spoofing thanks to U+0F8C rendered as 'space' on Mac OS 10.11")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=714196 "https://bugs.chromium.org/p/chromium/issues/detail?id=714196")

## Details

### (4 keywords, Whiteboard: [post-critsmash-triage][adv-main54+][adv-esr52.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2017-7763

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main54+][adv-esr52.2+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1896426_1689 "8 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Domain spoofing example](/attachment.cgi?id=8862557)  [8 years ago](#c0)  [Michał Bentkowski](/user_profile?user_id=548021)   49.16 KB, image/png |  | [Details](/attachment.cgi?id=8862557&action=edit) |
| --- | --- | --- |
| [Script to find non-punycode domain names](/attachment.cgi?id=8863013)  [8 years ago](#c5)  [Michał Bentkowski](/user_profile?user_id=548021)   315 bytes, text/plain |  | [Details](/attachment.cgi?id=8863013&action=edit) |
| [Work around some broken Apple fonts](/attachment.cgi?id=8863754)  [8 years ago](#c12)  [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)   1.51 KB, patch | jrmuizel : [review+](#a419300_309398 "8 years ago")  ritu : [approval-mozilla-beta+](#c23 "8 years ago")  ritu : [approval-mozilla-esr52+](#c23 "8 years ago")  abillings : [sec-approval+](#c17 "8 years ago") | [Details](/attachment.cgi?id=8863754&action=edit) | [Diff](/attachment.cgi?id=8863754&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1360309&attachment=8863754) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Michał Bentkowski](/user_profile?user_id=548021)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1360309#c0)• 8 years ago |
|  | |

Attached image
[Domain spoofing example](attachment.cgi?id=8862557)
— [Details](attachment.cgi?id=8862557&action=edit)

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_12\_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.81 Safari/537.36
Steps to reproduce:
The character U+0F8C (TIBETAN SIGN INVERTED MCHU CAN) when used in a domain name in Firefox on Mac looks just like a space.
This can be abused to spoof a legitimate domain followed by a chain of the character, e.g. "accounts.google.com<U+0F8C x 52>.bntk.pl".
I have created a domain <https://important-domain.google.xn--com-lumaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.bntk.pl/> which is SSL-enabled and looks just like important-domain.google.com when your Firefox window is now wide enough to cover the whole address. The DNS limits makes it impossible to add arbitrary number of U+0F8C chars in the address bar. As a workaround, the attacker might add just a dot, hoping that the end-user will not notice it, for example: <http://important-domain.google.xn--com-lumaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.xn--cfdaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.bntk.pl/>.
I have attached a screenshot of a SSL-enabled domain using 53 U+0F8C characters.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a13107_159069)• 8 years ago |

Component: Untriaged → Location Bar

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a16054_280903)• 8 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1360309#c1)• 8 years ago |
|  | |

This could reasonably be moved to Core::Networking because it's IDNA, but we seem to be doing the correct thing. It's a valid "letter" (so adding it to our IDNA blacklist is problematic) and in the examples above there is no script mixing. On Windows there's no spoofing -- this character is included in their fonts.
Chrome has the same problem which is unsurprising because we're trying to follow the same standards. Why did Apple leave this character (and others!) blank? I don't expect them to have supported everything, but unsupported codepoints should have a placeholder.
Any thoughts, Gerv?Flags: needinfo?(gerv)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1360309#c2)• 8 years ago |
|  | |

In the "Location Bar" realm maybe there are things that could address spoofs like this -- and like the completely ascii attempts like <https://paypal.com.services.blahblahblahblahblah>. We do slightly highlight the base domain but it's not very noticeable. Maybe helps if you can see both parts side-by-side, but easy to forget about if the darker part is out of view.
\* we could try a super-obvious highlighting scheme (different background color?) so that people have a better chance of noticing its absence.
\* we could scroll super-long domains so that the base part starts in view even if that means cutting off the front of the URL. This kind of spoof is one reason earlier versions of Firefox (3.x) put the base domain in a blue box for secure origins (we worried less about spoofs of already-insecure sites).
\* keep a platform-dependent list of bogus-blank letters and do something if we see those. Maybe request punycode if we encounter any? In this example Macs would get a punycode label but Windows would see IDN, and Mac would see IDN for other Tibetan IDNs that did not contain any of this handful of blank characters. Seems fair, it's not like even Tibetans will be able to distinguish one blank from another different blank.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1360309#c3)• 8 years ago |
|  | |

\* Use a font we control in the Location Bar? That might have other advantages. Do we ship a font now, for Reader Mode? Could we use it, or is it not comprehensive enough?
This is clearly a bug in the font - if the font doesn't have a glyph for a character, it shouldn't offer to render it, and the end result should be fallback to whatever total fallback font the system has, which normally renders little boxes.
Do we have a handle on the scope of the problem? Is it just this one character, or are there quite a few? Michal: how did you discover this?
GervFlags: needinfo?(gerv)

|  | [Michał Bentkowski](/user_profile?user_id=548021)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1360309#c4)• 8 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #3](/show_bug.cgi?id=1360309#c3 "VERIFIED FIXED - Security issue: Domain spoofing thanks to U+0F8C rendered as space on Mac"))
> Do we have a handle on the scope of the problem? Is it just this one
> character, or are there quite a few? Michal: how did you discover this?
>
I have created a simple script (I'm attaching it) to check what characters might be used in domain names without being transformed to punycode. Then I've had a quick glance through them and noticed that there are four that looks like a space:
f8c <http://testྌ.bntk.pl>
f8d <http://xn--test-tzp.bntk.pl/>
f8e <http://xn--test-yzp.bntk.pl/>
f8f <http://xn--test-3zp.bntk.pl/>
However, it seems that in fact only u+0f8c might be abused in domain name since the other ones are transformed to punycode if there are at least two of them in sequence (for example: <http://test><u+0f8d><u+0f8d>.bntk.pl/ --> <http://xn--test-tzpa.bntk.pl/>.

|  | [Michał Bentkowski](/user_profile?user_id=548021)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1360309#c5)• 8 years ago |
|  | |

Attached file
[Script to find non-punycode domain names](attachment.cgi?id=8863013)
— [Details](attachment.cgi?id=8863013&action=edit)

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1360309#c6)• 8 years ago |
|  | |

Are we able to find out which font on the Mac has this problem?
CCing Jonathan Kew. Jonathan: can we fix this in our font code somewhere so we don't pick the dodgy font for this character?
If that's not possible, I agree that blacklisting it (ideally, on the Mac only) is probably the simplest thing.
Gerv

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1360309#c7)• 8 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #6](/show_bug.cgi?id=1360309#c6 "VERIFIED FIXED - Security issue: Domain spoofing thanks to U+0F8C rendered as space on Mac"))
> Are we able to find out which font on the Mac has this problem?
>
> CCing Jonathan Kew. Jonathan: can we fix this in our font code somewhere so
> we don't pick the dodgy font for this character?
+niFlags: needinfo?(jfkthame)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1360309#c8)• 8 years ago |
|  | |

On my Mac, font fallback is choosing the Simplified Chinese font "Songti SC" for this character. If I disable that font, it falls back to "Songti TC" (the Traditional Chinese version), which has the same issue; and if I disable that as well, it falls back to "STSong", which -also- has a blank glyph here.
Disabling all three of those fonts finally results in a missing-glyph hexbox instead of a blank.
I suppose we could add some code to blacklist this codepoint in those fonts, though it feels like a rather piecemeal approach to the issue.
One thing Chrome does, which we don't currently do, is to show an ellipsis (...) when the URL doesn't fit in the address bar, so there's at least \*some\* visual clue that it is truncated. I suspect users wouldn't usually notice this in the case where the URL appears to be quite short, then there's lots of blank space, and finally "..." at the end, so it's a pretty weak "protection", but nevertheless perhaps worth considering as a small step.
Mostly, though, I think the Location Bar should do something (e.g. scroll the URL such that the base domain is visible, and highlight it?) to help the user notice what the true origin is.Flags: needinfo?(jfkthame)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1360309#c9)• 8 years ago |
|  | |

(In reply to Jonathan Kew (:jfkthame) from [comment #8](/show_bug.cgi?id=1360309#c8 "VERIFIED FIXED - Security issue: Domain spoofing thanks to U+0F8C rendered as space on Mac"))
> On my Mac, font fallback is choosing the Simplified Chinese font "Songti SC"
> for this character. If I disable that font, it falls back to "Songti TC"
> (the Traditional Chinese version), which has the same issue; and if I
> disable that as well, it falls back to "STSong", which -also- has a blank
> glyph here.
>
> Disabling all three of those fonts finally results in a missing-glyph hexbox
> instead of a blank.
>
> I suppose we could add some code to blacklist this codepoint in those fonts,
> though it feels like a rather piecemeal approach to the issue.
Huh, this is unfortunate. :-(
What do we do on Windows where this (according to comments so far - I haven't checked!) doesn't work?
> One thing Chrome does, which we don't currently do, is to show an ellipsis
> (...) when the URL doesn't fit in the address bar, so there's at least
> \*some\* visual clue that it is truncated. I suspect users wouldn't usually
> notice this in the case where the URL appears to be quite short, then
> there's lots of blank space, and finally "..." at the end, so it's a pretty
> weak "protection", but nevertheless perhaps worth considering as a small
> step.
Yeah, I don't think this helps "normal" users, even if it would make power users feel better (maybe) about this type of attack, so I'm not convinced it's worth implementing, also because it's not trivial to do, so the cost/gain ratio is pretty bad.
> Mostly, though, I think the Location Bar should do something (e.g. scroll
> the URL such that the base domain is visible, and highlight it?) to help the
> user notice what the true origin is.
I'm not aware of a good way to know how far to 'scroll' a textbox to show a given substring of its value. A lot of the ways of scrolling the textbox also involve modifying the selection (which breaks some user workflows) and/or hiding the selection/cursor (ie if not modifying it, but scrolling the textbox), neither of which is really very nice.
Finally, it's not clear what happens when the base domain is longer than what we can display (ie if the domain is long and/or the url bar is narrow). Cropping anything will just leave us open to spoofing based on the remaining part.
Ironically, we currently go to some lengths to scroll the textbox to the \*beginning\* in various circumstances, to avoid spoofs that do the opposite and append fake information after the main domain...
Given all of that, I don't see a lot of good options beyond the nuclear Safari one - when the URL bar is not focused, display \*only\* the base domain.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1360309#c10)• 8 years ago |
|  | |

Do we have a conduit into Apple for reporting font bugs?
Regardless, this isn't going to get fixed any time soon. I suspect what solution we go for depends on what engineering resources we have available to us, but if we have to do the minimum effort solution, I'd be happy with a Mac-specific pref (can you append to prefs using our macro system?) to blacklist this single character.
Gerv

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1360309#c11)• 8 years ago |
|  | |

(In reply to :Gijs from [comment #9](/show_bug.cgi?id=1360309#c9 "VERIFIED FIXED - Security issue: Domain spoofing thanks to U+0F8C rendered as space on Mac"))
> What do we do on Windows where this (according to comments so far - I
> haven't checked!) doesn't work?
We don't "do" anything; Windows (presumably) just doesn't ship with a font that has a blank glyph at this (non-blank) character position. So users see either the proper (visible) glyph, or if no font supporting the character is present, a hexbox.

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1360309#c12)• 8 years ago |
|  | |

Attached patch

[Work around some broken Apple fonts](attachment.cgi?id=8863754&action=diff)
— [Details](attachment.cgi?id=8863754&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1360309&attachment=8863754)

Here's a patch that will make us render hexboxes instead of spurious blank glyphs on macOS for the affected characters here.

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a417183_329583)• 8 years ago |

[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: review?(jmuizelaar)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1360309#c13)• 8 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #10](/show_bug.cgi?id=1360309#c10 "VERIFIED FIXED - Security issue: Domain spoofing thanks to U+0F8C rendered as space on Mac"))
> Do we have a conduit into Apple for reporting font bugs?
Not really, aside from filing a Radar bug report.
> Regardless, this isn't going to get fixed any time soon.
Indeed. And even if/when it does get fixed, that won't help users on existing OS versions that (past experience says) won't get updated fonts; it will only benefit future versions.

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1360309#c14)• 8 years ago |
|  | |

FWIW, I filed issue 31936967 at bugreport.apple.com.

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a419300_309398)• 8 years ago |

[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: review?(jmuizelaar) → review+

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1360309#c15)• 8 years ago |
|  | |

Comment on [attachment 8863754](/attachment.cgi?id=8863754 "Work around some broken Apple fonts") [[details]](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") [[diff]](/attachment.cgi?id=8863754&action=diff "Work around some broken Apple fonts") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1360309&attachment=8863754)
Work around some broken Apple fonts
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
The patch identifies specific characters that may display incorrectly; from there to using those characters in a spoofed domain name is a pretty trivial step.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Pretty much: we're blacklisting specific characters in specific fonts, which is hard to disguise. The only slightly obscure thing is the idea that it might be possible to use these as part of a domain name.
Which older supported branches are affected by this flaw?
All
If not all supported branches, which bug introduced the flaw?
It's not our bug, it's a fault in Apple's fonts.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Patch should transplant easily to all branches.
How likely is this patch to cause regressions; how much testing does it need?
Minimal risk.
[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: sec-approval?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1360309#c16)• 8 years ago |
|  | |

We've called this kind of spoof "sec-high" at times, "sec-moderate" other times. This is at the low end of sec-high I guess since it's only one platform and not really our bug, but it's not wrong to say this could be a convincing spoof.Status: UNCONFIRMED → NEW
[status-firefox53](/buglist.cgi?f1=cf_status_firefox53&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix)
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected)
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=affected)
[status-firefox56](/buglist.cgi?f1=cf_status_firefox56&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=affected)
[status-firefox57](/buglist.cgi?f1=cf_status_firefox57&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox57&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=wontfix)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- → [54+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=54%2B)Ever confirmed: trueKeywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1360309#c17)• 8 years ago |
|  | |

Comment on [attachment 8863754](/attachment.cgi?id=8863754 "Work around some broken Apple fonts") [[details]](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") [[diff]](/attachment.cgi?id=8863754&action=diff "Work around some broken Apple fonts") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1360309&attachment=8863754)
Work around some broken Apple fonts
Sec-approval+. We'll want this on Beta and ESR52 as well.
[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a469768_280903)• 8 years ago |

[tracking-firefox54](/buglist.cgi?f1=cf_tracking_firefox54&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox54&o1=equals&v1=%2B)
[tracking-firefox55](/buglist.cgi?f1=cf_tracking_firefox55&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox55&o1=equals&v1=%2B)
[tracking-firefox56](/buglist.cgi?f1=cf_tracking_firefox56&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox56&o1=equals&v1=%2B)
[tracking-firefox57](/buglist.cgi?f1=cf_tracking_firefox57&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox57&o1=equals&v1=%2B)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1360309#c18)• 8 years ago |
|  | |

Has this been reported to chromium as well and do we need to coordinate anything with them in terms of disclosure when this lands?

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a485863_240353)• 8 years ago |

Assignee: nobody → jfkthamePriority: -- → P1

|  | [Michał Bentkowski](/user_profile?user_id=548021)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1360309#c19)• 8 years ago |
|  | |

(In reply to :Gijs from [comment #18](/show_bug.cgi?id=1360309#c18 "VERIFIED FIXED - Security issue: Domain spoofing thanks to U+0F8C rendered as space on Mac"))
> Has this been reported to chromium as well and do we need to coordinate
> anything with them in terms of disclosure when this lands?
Yes, it's been reported to Chromium. However they haven't decided to take any action on it yet, besides reporting the font bug to Apple.
They consider the blacklisting though (and I additionally urged them to do so) so I guess they'll go this way soon.
Not sure how your coordination with Chromium works, but if you need to specify a concrete bug in communication with them, here it is: <https://bugs.chromium.org/p/chromium/issues/detail?id=714196> (it's a private bug).

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1360309#c20)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/455d8ae18f2adb8eb051f0ddf84aa8f779d3c1d3>
[Bug 1360309](/show_bug.cgi?id=1360309 "VERIFIED FIXED - Security issue: Domain spoofing thanks to U+0F8C rendered as space on Mac") - Work around some broken Apple fonts. r=jrmuizel

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1360309#c21)• 8 years ago |
|  | |

Comment on [attachment 8863754](/attachment.cgi?id=8863754 "Work around some broken Apple fonts") [[details]](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") [[diff]](/attachment.cgi?id=8863754&action=diff "Work around some broken Apple fonts") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1360309&attachment=8863754)
Work around some broken Apple fonts
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
User impact if declined: possible domain-name spoofing
Fix Landed on Version: 55
Risk to taking this patch (and alternatives if risky): minimal risk
String or UUID changes made by this patch: none
Approval Request Comment
[Feature/Bug causing the regression]: bad Chinese fonts shipped on macOS
[User impact if declined]: possible domain-name spoofing
[Is this code covered by automated tests?]: no
[Has the fix been verified in Nightly?]: tested manually
[Needs manual test from QE? If yes, steps to reproduce]: yes, visit test URL from [comment 0](/show_bug.cgi?id=1360309#c0 "VERIFIED FIXED - Security issue: Domain spoofing thanks to U+0F8C rendered as space on Mac") and check rendering in Location Bar
[List of other uplifts needed for the feature/fix]: none
[Is the change risky?]: no
[Why is the change risky/not risky?]: trivial patch just blacklists specific codepoints in a few specific fonts at the time they're loaded
[String changes made/needed]: none
[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: approval-mozilla-esr52?
[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: approval-mozilla-beta?
[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: approval-mozilla-aurora?

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1360309#c22)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/455d8ae18f2a>Status: NEW → RESOLVEDClosed: 8 years ago
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → Firefox 55

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1360309#c23)• 8 years ago |
|  | |

Comment on [attachment 8863754](/attachment.cgi?id=8863754 "Work around some broken Apple fonts") [[details]](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") [[diff]](/attachment.cgi?id=8863754&action=diff "Work around some broken Apple fonts") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1360309&attachment=8863754)
Work around some broken Apple fonts
Sec-high, Beta54+, ESR52.2+
[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: approval-mozilla-esr52?
[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: approval-mozilla-esr52+
[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: approval-mozilla-beta?
[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: approval-mozilla-beta+
[Attachment #8863754](/attachment.cgi?id=8863754&action=edit "Work around some broken Apple fonts") -
Flags: approval-mozilla-aurora?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1360309#c24)• 8 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/d5a452ce541c>
<https://hg.mozilla.org/releases/mozilla-esr52/rev/c7fca0c66eac>
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a636639_1689)• 8 years ago |

Group: firefox-core-security → core-security-release

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1360309#c25)• 8 years ago |
|  | |

Flagging this for manual testing, instructions in [Comment 21](/show_bug.cgi?id=1360309#c21 "VERIFIED FIXED - Security issue: Domain spoofing thanks to U+0F8C rendered as space on Mac").Flags: qe-verify+

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a939877_538805)• 8 years ago |

[status-firefox56](/buglist.cgi?f1=cf_status_firefox56&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox56&o1=equals&v1=affected) → ---
[status-firefox57](/buglist.cgi?f1=cf_status_firefox57&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox57&o1=equals&v1=affected) → ---
[tracking-firefox56](/buglist.cgi?f1=cf_tracking_firefox56&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox56&o1=equals&v1=%2B) → ---
[tracking-firefox57](/buglist.cgi?f1=cf_tracking_firefox57&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox57&o1=equals&v1=%2B) → ---

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a1896426_1689)• 8 years ago |

Flags: sec-bounty? → sec-bounty+Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=714196>

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a3112279_452604)• 8 years ago |

Whiteboard: [post-critsmash-triage]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a3458981_280903)• 8 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main54+][adv-esr52.2+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a3462220_280903)• 8 years ago |

Alias: CVE-2017-7763

|  | [Cristian Comorasu, QA [:ccomorasu], Releae Desktop QA - Please contact mboldan@mozilla.com](/user_profile?user_id=572409) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1360309#c26)• 8 years ago |
|  | |

I can confirm this issue is fixed, I verified using Fx 54.0-build 3, Fx 52.2.0esr and Fx 55.0a1(2017-06-09) on mac OS X 10.12.4.
Cheers!
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=verified)
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=verified)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=verified)Flags: qe-verify+

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a3708755_159069)• 8 years ago |

Status: RESOLVED → VERIFIED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a10110613_1689)• 7 years ago |

See Also: → [1390980](/show_bug.cgi?id=1390980 "RESOLVED FIXED - Domain spoofing thanks to U+0F8C rendered as 'space' on Mac OS 10.11")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a15753090_1689)• 7 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1360309#a223768997_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1360309&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Michał Bentkowski](/user_profile?user_id=548021)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_3659d679_20250126_041459.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_e1d66f32_20250124_225313.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2017-17

## Security vulnerabilities fixed in Thunderbird 52.2

Announced
June 14, 2017
Impact
critical
Products
Thunderbird
Fixed in

* Thunderbird 52.2

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2017-5472: Use-after-free using destroyed node when regenerating trees](#CVE-2017-5472)

Reporter
Nils
Impact
critical
##### Description

A use-after-free vulnerability with the frameloader during tree reconstruction while regenerating CSS layout when attempting to use a node in the tree that no longer exists. This results in a potentially exploitable crash.

##### References

* [Bug 1365602](https://bugzilla.mozilla.org/show_bug.cgi?id=1365602)

#### [#CVE-2017-7749: Use-after-free during docshell reloading](#CVE-2017-7749)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability when using an incorrect URL during the reloading of a docshell. This results in a potentially exploitable crash.

##### References

* [Bug 1355039](https://bugzilla.mozilla.org/show_bug.cgi?id=1355039)

#### [#CVE-2017-7750: Use-after-free with track elements](#CVE-2017-7750)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability during video control operations when a `<track>` element holds a reference to an older window if that window has been replaced in the DOM. This results in a potentially exploitable crash.

##### References

* [Bug 1356558](https://bugzilla.mozilla.org/show_bug.cgi?id=1356558)

#### [#CVE-2017-7751: Use-after-free with content viewer listeners](#CVE-2017-7751)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability with content viewer listeners that results in a potentially exploitable crash.

##### References

* [Bug 1363396](https://bugzilla.mozilla.org/show_bug.cgi?id=1363396)

#### [#CVE-2017-7755: Privilege escalation through Firefox Installer with same directory DLL files](#CVE-2017-7755)

Reporter
Yuji Tounai of NTT Communications, Eili Masami of Tachibana Lab
Impact
high
##### Description

The Firefox installer on Windows can be made to load malicious DLL files stored in the same directory as the installer when it is run. This allows privileged execution if the installer is run with elevated privileges.
*Note: This attack only affects Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1361326](https://bugzilla.mozilla.org/show_bug.cgi?id=1361326)

#### [#CVE-2017-7752: Use-after-free with IME input](#CVE-2017-7752)

Reporter
Nils
Impact
moderate
##### Description

A use-after-free vulnerability during specific user interactions with the input method editor (IME) in some languages due to how events are handled. This results in a potentially exploitable crash but would require specific user interaction to trigger.

##### References

* [Bug 1359547](https://bugzilla.mozilla.org/show_bug.cgi?id=1359547)

#### [#CVE-2017-7754: Out-of-bounds read in WebGL with ImageInfo object](#CVE-2017-7754)

Reporter
Tobias Klein
Impact
high
##### Description

An out-of-bounds read in WebGL with a maliciously crafted `ImageInfo` object during WebGL operations.

##### References

* [Bug 1357090](https://bugzilla.mozilla.org/show_bug.cgi?id=1357090)

#### [#CVE-2017-7756: Use-after-free and use-after-scope logging XHR header errors](#CVE-2017-7756)

Reporter
Abhishek Arya
Impact
high
##### Description

A use-after-free and use-after-scope vulnerability when logging errors from headers for XML HTTP Requests (XHR). This could result in a potentially exploitable crash.

##### References

* [Bug 1366595](https://bugzilla.mozilla.org/show_bug.cgi?id=1366595)

#### [#CVE-2017-7757: Use-after-free in IndexedDB](#CVE-2017-7757)

Reporter
F. Alonso (revskills)
Impact
high
##### Description

A use-after-free vulnerability in IndexedDB when one of its objects is destroyed in memory while a method on it is still being executed. This results in a potentially exploitable crash.

##### References

* [Bug 1356824](https://bugzilla.mozilla.org/show_bug.cgi?id=1356824)

#### [#CVE-2017-7778: Vulnerabilities in the Graphite 2 library](#CVE-2017-7778)

Reporter
Holger Fuhrmannek, Tyson Smith
Impact
high
##### Description

A number of security vulnerabilities in the Graphite 2 library including out-of-bounds reads, buffer overflow reads and writes, and the use of uninitialized memory. These issues were addressed in Graphite 2 version 1.3.10.

##### References

* [Graphite2 lz4::decompress out of bounds write (CVE-2017-7778)](https://bugzilla.mozilla.org/show_bug.cgi?id=1349310)
* [Graphite2 out of bounds read [@ graphite2::Pass::readPass] (CVE-2017-7771)](https://bugzilla.mozilla.org/show_bug.cgi?id=1350047)
* [Graphite2 heap-buffer-overflow write [@ lz4::decompress] (CVE-2017-7772)](https://bugzilla.mozilla.org/show_bug.cgi?id=1352745)
* [Graphite2 heap-buffer-overflow write [@ lz4::decompress] src/Decompressor (CVE-2017-7773)](https://bugzilla.mozilla.org/show_bug.cgi?id=1352747)
* [Graphite2 out of bounds read [@ graphite2::Silf::readGraphite] (CVE-2017-7774)](https://bugzilla.mozilla.org/show_bug.cgi?id=1355174)
* [Graphite2 Assertion 'size() > n' failed (CVE-2017-7775)](https://bugzilla.mozilla.org/show_bug.cgi?id=1355182)
* [Graphite2 heap-buffer-overflow read [@ graphite2::Silf::getClassGlyph] (CVE-2017-7776)](https://bugzilla.mozilla.org/show_bug.cgi?id=1356607)
* [Graphite2 use of uninitialized memory [@ graphite2::GlyphCache::Loader::read\_glyph] (CVE-2017-7777)](https://bugzilla.mozilla.org/show_bug.cgi?id=1358551)

#### [#CVE-2017-7758: Out-of-bounds read in Opus encoder](#CVE-2017-7758)

Reporter
Nicolas Trippar of Zimperium zLabs
Impact
high
##### Description

An out-of-bounds read vulnerability with the Opus encoder when the number of channels in an audio stream changes while the encoder is in use.

##### References

* [Bug 1368490](https://bugzilla.mozilla.org/show_bug.cgi?id=1368490)

#### [#CVE-2017-7763: Mac fonts render some unicode characters as spaces](#CVE-2017-7763)

Reporter
Michał Bentkowski
Impact
moderate
##### Description

Default fonts on OS X display some Tibetan characters as whitespace. When used in the addressbar as part of an IDN this can be used for domain name spoofing attacks.
*Note: This attack only affects OS X operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1360309](https://bugzilla.mozilla.org/show_bug.cgi?id=1360309)

#### [#CVE-2017-7764: Domain spoofing with combination of Canadian Syllabics and other unicode blocks](#CVE-2017-7764)

Reporter
Samuel Erb
Impact
moderate
##### Description

Characters from the "Canadian Syllabics" unicode block can be mixed with characters from other unicode blocks in the addressbar instead of being rendered as their raw "punycode" form, allowing for domain name spoofing attacks through character confusion. The current Unicode standard allows characters from "Aspirational Use Scripts" such as Canadian Syllabics to be mixed with Latin characters in the "moderately restrictive" IDN profile. We have changed Firefox behavior to match the upcoming Unicode version 10.0 which removes this category and treats them as "Limited Use Scripts."

##### References

* [Bug 1364283](https://bugzilla.mozilla.org/show_bug.cgi?id=1364283)
* [Proposed Update to Unicode Standard Annex](http://www.unicode.org/reports/tr31/tr31-26.html#Aspirational_Use_Scripts)

#### [#CVE-2017-7765: Mark of the Web bypass when saving executable files](#CVE-2017-7765)

Reporter
Jonathan Birch and Microsoft Vulnerability Research
Impact
moderate
##### Description

The "Mark of the Web" was not correctly saved on Windows when files with very long names were downloaded from the Internet. Without the Mark of the Web data, the security warning that Windows displays before running executables downloaded from the Internet is not shown.
*Note: This attack only affects Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1273265](https://bugzilla.mozilla.org/show_bug.cgi?id=1273265)

#### [#CVE-2017-5470: Memory safety bugs fixed in Firefox 54, Firefox ESR 52.2, and Thunderbird 52.2](#CVE-2017-5470)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Tyson Smith, Mats Palmgren, Philipp, Masayuki Nakano, Christian Holler, Andrew McCreight, Gary Kwong, André Bargull, Carsten Book, Jesse Schwartzentruber, Julian Hector, Marcia Knous, Ronald Crane, and Nils Ohlmeier reported memory safety bugs present in Firefox 53, Firefox ESR 52.1, and Thunderbird 52.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 54, Firefox ESR 52.2, Thunderbird 52.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1359639%2C1349595%2C1352295%2C1352556%2C1342552%2C1342567%2C1346012%2C1366140%2C1368732%2C1297111%2C1362590%2C1357462%2C1363280%2C1349266%2C1352093%2C1348424%2C1347748%2C1356025%2C1325513%2C1367692)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


