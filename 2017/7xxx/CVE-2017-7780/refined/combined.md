=== Content from www.mozilla.org_130dd732_20250125_160011.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2017-18

## Security vulnerabilities fixed in Firefox 55

Announced
August 8, 2017
Impact
critical
Products
Firefox
Fixed in

* Firefox 55

#### [#CVE-2017-7798: XUL injection in the style editor in devtools](#CVE-2017-7798)

Reporter
Frederik Braun
Impact
critical
##### Description

The Developer Tools feature suffers from a XUL injection vulnerability due to improper sanitization of the web page source code. In the worst case, this could allow arbitrary code execution when opening a malicious page with the style editor tool.

##### References

* [Bug 1371586, 1372112](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1371586%2C1372112)

#### [#CVE-2017-7800: Use-after-free in WebSockets during disconnection](#CVE-2017-7800)

Reporter
Looben Yang
Impact
critical
##### Description

A use-after-free vulnerability can occur in WebSockets when the object holding the connection is freed before the disconnection operation is finished. This results in an exploitable crash.

##### References

* [Bug 1374047](https://bugzilla.mozilla.org/show_bug.cgi?id=1374047)

#### [#CVE-2017-7801: Use-after-free with marquee during window resizing](#CVE-2017-7801)

Reporter
Nils
Impact
critical
##### Description

A use-after-free vulnerability can occur while re-computing layout for a `marquee` element during window resizing where the updated style object is freed while still in use. This results in a potentially exploitable crash.

##### References

* [Bug 1371259](https://bugzilla.mozilla.org/show_bug.cgi?id=1371259)

#### [#CVE-2017-7809: Use-after-free while deleting attached editor DOM node](#CVE-2017-7809)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when an editor DOM node is deleted prematurely during tree traversal while still bound to the document. This results in a potentially exploitable crash.

##### References

* [Bug 1380284](https://bugzilla.mozilla.org/show_bug.cgi?id=1380284)

#### [#CVE-2017-7784: Use-after-free with image observers](#CVE-2017-7784)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when reading an image observer during frame reconstruction after the observer has been freed. This results in a potentially exploitable crash.

##### References

* [Bug 1376087](https://bugzilla.mozilla.org/show_bug.cgi?id=1376087)

#### [#CVE-2017-7802: Use-after-free resizing image elements](#CVE-2017-7802)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when manipulating the DOM during the resize event of an image element. If these elements have been freed due to a lack of strong references, a potentially exploitable crash may occur when the freed elements are accessed.

##### References

* [Bug 1378147](https://bugzilla.mozilla.org/show_bug.cgi?id=1378147)

#### [#CVE-2017-7785: Buffer overflow manipulating ARIA attributes in DOM](#CVE-2017-7785)

Reporter
Nils
Impact
high
##### Description

A buffer overflow can occur when manipulating Accessible Rich Internet Applications (ARIA) attributes within the DOM. This results in a potentially exploitable crash.

##### References

* [Bug 1356985](https://bugzilla.mozilla.org/show_bug.cgi?id=1356985)

#### [#CVE-2017-7786: Buffer overflow while painting non-displayable SVG](#CVE-2017-7786)

Reporter
Nils
Impact
high
##### Description

A buffer overflow can occur when the image renderer attempts to paint non-displayable SVG elements. This results in a potentially exploitable crash.

##### References

* [Bug 1365189](https://bugzilla.mozilla.org/show_bug.cgi?id=1365189)

#### [#CVE-2017-7806: Use-after-free in layer manager with SVG](#CVE-2017-7806)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when the layer manager is freed too early when rendering specific SVG content, resulting in a potentially exploitable crash.

##### References

* [Bug 1378113](https://bugzilla.mozilla.org/show_bug.cgi?id=1378113)

#### [#CVE-2017-7753: Out-of-bounds read with cached style data and pseudo-elements](#CVE-2017-7753)

Reporter
SkyLined
Impact
high
##### Description

An out-of-bounds read occurs when applying style rules to pseudo-elements, such as ::first-line, using cached style data.

##### References

* [Bug 1353312](https://bugzilla.mozilla.org/show_bug.cgi?id=1353312)

#### [#CVE-2017-7787: Same-origin policy bypass with iframes through page reloads](#CVE-2017-7787)

Reporter
Oliver Wagner
Impact
high
##### Description

Same-origin policy protections can be bypassed on pages with embedded iframes during page reloads, allowing the iframes to access content on the top level page, leading to information disclosure.

##### References

* [Bug 1322896](https://bugzilla.mozilla.org/show_bug.cgi?id=1322896)

#### [#CVE-2017-7807: Domain hijacking through AppCache fallback](#CVE-2017-7807)

Reporter
Mathias Karlsson
Impact
high
##### Description

A mechanism that uses AppCache to hijack a URL in a domain using fallback by serving the files from a sub-path on the domain. This has been addressed by requiring fallback files be inside the manifest directory.

##### References

* [Bug 1376459](https://bugzilla.mozilla.org/show_bug.cgi?id=1376459)

#### [#CVE-2017-7792: Buffer overflow viewing certificates with an extremely long OID](#CVE-2017-7792)

Reporter
Fraser Tweedale
Impact
high
##### Description

A buffer overflow will occur when viewing a certificate in the certificate manager if the certificate has an extremely long object identifier (OID). This results in a potentially exploitable crash.

##### References

* [Bug 1368652](https://bugzilla.mozilla.org/show_bug.cgi?id=1368652)

#### [#CVE-2017-7804: Memory protection bypass through WindowsDllDetourPatcher](#CVE-2017-7804)

Reporter
Stephen Fewer
Impact
high
##### Description

The destructor function for the `WindowsDllDetourPatcher` class can be re-purposed by malicious code in concert with another vulnerability to write arbitrary data to an attacker controlled location in memory. This can be used to bypass existing memory protections in this situation.
*Note: This attack only affects Windows operating systems. Other operating systems are not affected.*

##### References

* [Bug 1372849](https://bugzilla.mozilla.org/show_bug.cgi?id=1372849)

#### [#CVE-2017-7791: Spoofing following page navigation with data: protocol and modal alerts](#CVE-2017-7791)

Reporter
Jose María Acuña
Impact
moderate
##### Description

On pages containing an iframe, the `data:` protocol can be used to create a modal alert that will render over arbitrary domains following page navigation, spoofing of the origin of the modal alert from the iframe content.

##### References

* [Bug 1365875](https://bugzilla.mozilla.org/show_bug.cgi?id=1365875)

#### [#CVE-2017-7808: CSP information leak with frame-ancestors containing paths](#CVE-2017-7808)

Reporter
Jun Kokatsu
Impact
moderate
##### Description

A content security policy (CSP) `frame-ancestors` directive containing origins with paths allows for comparisons against those paths instead of the origin. This results in a cross-origin information leak of this path information.

##### References

* [Bug 1367531](https://bugzilla.mozilla.org/show_bug.cgi?id=1367531)

#### [#CVE-2017-7782: WindowsDllDetourPatcher allocates memory without DEP protections](#CVE-2017-7782)

Reporter
Arthur Edelstein
Impact
moderate
##### Description

An error in the `WindowsDllDetourPatcher` where a RWX ("Read/Write/Execute") 4k block is allocated but never protected, violating DEP protections.
*Note: This attack only affects Windows operating systems. Other operating systems are not affected.*

##### References

* [Bug 1344034](https://bugzilla.mozilla.org/show_bug.cgi?id=1344034)

#### [#CVE-2017-7781: Elliptic curve point addition error when using mixed Jacobian-affine coordinates](#CVE-2017-7781)

Reporter
Antonio Sanso
Impact
moderate
##### Description

An error occurs in the elliptic curve point addition algorithm that uses mixed Jacobian-affine coordinates where it can yield a result `POINT_AT_INFINITY` when it should not. A man-in-the-middle attacker could use this to interfere with a connection, resulting in an attacked party computing an incorrect shared secret.

##### References

* [Bug 1352039](https://bugzilla.mozilla.org/show_bug.cgi?id=1352039)

#### [#CVE-2017-7794: Linux file truncation via sandbox broker](#CVE-2017-7794)

Reporter
Jann Horn
Impact
moderate
##### Description

On Linux systems, if the content process is compromised, the sandbox broker will allow files to be truncated even though the sandbox explicitly only has read access to the local file system and no write permissions.
*Note: This attack only affects the Linux operating system. Other operating systems are not affected.*

##### References

* [Bug 1374281](https://bugzilla.mozilla.org/show_bug.cgi?id=1374281)

#### [#CVE-2017-7803: CSP containing 'sandbox' improperly applied](#CVE-2017-7803)

Reporter
Rhys Enniks
Impact
moderate
##### Description

When a page’s content security policy (CSP) header contains a `sandbox` directive, other directives are ignored. This results in the incorrect enforcement of CSP.

##### References

* [Bug 1377426](https://bugzilla.mozilla.org/show_bug.cgi?id=1377426)

#### [#CVE-2017-7799: Self-XSS XUL injection in about:webrtc](#CVE-2017-7799)

Reporter
Frederik Braun
Impact
moderate
##### Description

JavaScript in the `about:webrtc` page is not sanitized properly being assigned to `innerHTML`. Data on this page is supplied by WebRTC usage and is not under third-party control, making this difficult to exploit, but the vulnerability could possibly be used for a cross-site scripting (XSS) attack.

##### References

* [Bug 1372509](https://bugzilla.mozilla.org/show_bug.cgi?id=1372509)

#### [#CVE-2017-7783: DOS attack through long username in URL](#CVE-2017-7783)

Reporter
Amit Sangra
Impact
low
##### Description

If a long user name is used in a username/password combination in a site URL (such as  `http://UserName:Password@example.com`), the resulting modal prompt will hang in a non-responsive state or crash, causing a denial of service.

##### References

* [Bug 1360842](https://bugzilla.mozilla.org/show_bug.cgi?id=1360842)

#### [#CVE-2017-7788: Sandboxed about:srcdoc iframes do not inherit CSP directives](#CVE-2017-7788)

Reporter
Muneaki Nishimura
Impact
low
##### Description

When an `iframe` has a `sandbox` attribute and its content is specified using `srcdoc`, that content does not inherit the containing page's Content Security Policy (CSP) as it should unless the sandbox attribute included `allow-same-origin`.

##### References

* [Bug 1073952](https://bugzilla.mozilla.org/show_bug.cgi?id=1073952)

#### [#CVE-2017-7789: Failure to enable HSTS when two STS headers are sent for a connection](#CVE-2017-7789)

Reporter
Muneaki Nishimura
Impact
low
##### Description

If a server sends two Strict-Transport-Security (STS) headers for a single connection, they will be rejected as invalid and HTTP Strict Transport Security (HSTS) will not be enabled for the connection.

##### References

* [Bug 1074642](https://bugzilla.mozilla.org/show_bug.cgi?id=1074642)

#### [#CVE-2017-7790: Windows crash reporter reads extra memory for some non-null-terminated registry values](#CVE-2017-7790)

Reporter
Xiaoyin Liu
Impact
low
##### Description

On Windows systems, if non-null-terminated strings are copied into the crash reporter for some specific registry keys, stack memory data can be copied until a null is found. This can potentially contain private data from the local system.
*Note: This attack only affects Windows operating systems. Other operating systems are not affected.*

##### References

* [Bug 1350460](https://bugzilla.mozilla.org/show_bug.cgi?id=1350460)

#### [#CVE-2017-7796: Windows updater can delete any file named update.log](#CVE-2017-7796)

Reporter
Matt Howell
Impact
low
##### Description

On Windows systems, the logger run by the Windows updater deletes the file "update.log" before it runs in order to write a new log of that name. The path to this file is supplied at the command line to the updater and could be used in concert with another local exploit to delete a different file named "update.log" instead of the one intended.
*Note: This attack only affects Windows operating systems. Other operating systems are not affected.*

##### References

* [Bug 1234401](https://bugzilla.mozilla.org/show_bug.cgi?id=1234401)

#### [#CVE-2017-7797: Response header name interning leaks across origins](#CVE-2017-7797)

Reporter
Anne van Kesteren
Impact
low
##### Description

Response header name interning does not have same-origin protections and these headers are stored in a global registry. This allows stored header names to be available cross-origin.

##### References

* [Bug 1334776](https://bugzilla.mozilla.org/show_bug.cgi?id=1334776)

#### [#CVE-2017-7780: Memory safety bugs fixed in Firefox 55](#CVE-2017-7780)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Gary Kwong, Christian Holler, André Bargull, Bob Clary, Carsten Book, Emilio Cobos Álvarez, Masayuki Nakano, Sebastian Hengst, Franziskus Kiefer, Tyson Smith, and Ronald Crane reported memory safety bugs present in Firefox 54. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 55](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484)

#### [#CVE-2017-7779: Memory safety bugs fixed in Firefox 55 and Firefox ESR 52.3](#CVE-2017-7779)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Masayuki Nakano, Gary Kwong, Ronald Crane, Andrew McCreight, Tyson Smith, Bevis Tseng, Christian Holler, Bryce Van Dyk, Dragana Damjanovic, Kartikaya Gupta, Philipp, Tristan Bourvon, and Andi-Bogdan Postelnicu reported memory safety bugs present in Firefox 54 and Firefox ESR 52.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 55 and Firefox ESR 52.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1354443%2C1368576%2C1366903%2C1369913%2C1371424%2C1346590%2C1371890%2C1372985%2C1362924%2C1368105%2C1369994%2C1371283%2C1368362%2C1378826%2C1380426%2C1368030%2C1373220%2C1321384%2C1383002)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_d2f9a897_20250126_100555.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1334776)
* [XML](/show_bug.cgi?ctype=xml&id=1334776)

Closed
[Bug 1334776](/show_bug.cgi?id=1334776)
(CVE-2017-7797)

Opened 8 years ago
Closed 8 years ago

# Header name interning leaks across origins

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Header name interning leaks across origins

## Categories

### (Core :: Networking: HTTP, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking%3A%20HTTP#Networking%3A%20HTTP)

Networking: HTTP
▾

Core :: Networking: HTTP
For bugs in Mozilla's HTTP networking code. This component deals with HTTP specific issues like pipelining, keep-alive, HTTP proxies, 1.1 issues, redirects, authentication (basic), etc.

Examples of appropriate bugs: Problems with proxy authentication; HTTP redirects looping indefinitely, etc.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking%3A%20HTTP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla55

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr52 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=wontfix) |
| firefox53 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix) |
| firefox54 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=wontfix) |
| firefox55 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr52 |  | wontfix |
| firefox53 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox54 |  | wontfix |
| firefox55 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: annevk, Assigned: dragana)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/91b350e2ab5eb2590adffaa3d0c9293a?d=mm&size=40)  [dragana](/user_profile?user_id=508195)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/09bb44ac3625a121017cd98d0a7dc52c?d=mm&size=40)  [annevk](/user_profile?user_id=102998)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-disclosure, privacy, sec-low, Whiteboard: [necko-active][fingerprinting][adv-main55+][post-critsmash-triage])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2017-7797

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-active][fingerprinting][adv-main55+][post-critsmash-triage]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c51 "8 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | [qe-verify](#a15949737_452604 "7 years ago") | - |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 7 obsolete files)

| [web-platform-tests test demonstrating the issue](/attachment.cgi?id=8831420)  [8 years ago](#c0)  [Anne (:annevk)](/user_profile?user_id=102998)   2.28 KB, patch |  | [Details](/attachment.cgi?id=8831420&action=edit) | [Diff](/attachment.cgi?id=8831420&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8831420) |
| --- | --- | --- |
| [bug\_1334776\_v1.patch](/attachment.cgi?id=8835557)  [8 years ago](#c6)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   39.74 KB, patch |  | [Details](/attachment.cgi?id=8835557&action=edit) | [Diff](/attachment.cgi?id=8835557&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8835557) |
| [bug\_1334776\_v2.patch](/attachment.cgi?id=8836114)  [8 years ago](#c11)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   34.92 KB, patch | mcmanus : [review-](#c16 "8 years ago") | [Details](/attachment.cgi?id=8836114&action=edit) | [Diff](/attachment.cgi?id=8836114&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8836114) |
| [0001-wip.patch](/attachment.cgi?id=8854485)  [8 years ago](#c26)  [Patrick McManus [:mcmanus]](/user_profile?user_id=32546)   36.79 KB, patch |  | [Details](/attachment.cgi?id=8854485&action=edit) | [Diff](/attachment.cgi?id=8854485&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8854485) |
| [bug\_1334776\_v2.patch](/attachment.cgi?id=8856494)  [8 years ago](#c30)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   36.09 KB, patch | mcmanus : [review-](#c32 "8 years ago") | [Details](/attachment.cgi?id=8856494&action=edit) | [Diff](/attachment.cgi?id=8856494&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8856494) |
| [bug\_1334776\_v2.patch](/attachment.cgi?id=8856573)  [8 years ago](#c35)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   36.25 KB, patch | mcmanus : [review+](#c39 "8 years ago") | [Details](/attachment.cgi?id=8856573&action=edit) | [Diff](/attachment.cgi?id=8856573&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8856573) |
| [bug\_1334776\_v2.patch](/attachment.cgi?id=8857011)  [8 years ago](#c40)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   36.47 KB, patch | dragana : [review+](#c40 "8 years ago") | [Details](/attachment.cgi?id=8857011&action=edit) | [Diff](/attachment.cgi?id=8857011&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8857011) |
| [bug\_1334776\_v2.patch](/attachment.cgi?id=8858298)  [8 years ago](#c41)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   42.20 KB, patch | dragana : [review+](#c41 "8 years ago") | [Details](/attachment.cgi?id=8858298&action=edit) | [Diff](/attachment.cgi?id=8858298&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8858298) |
| [bug\_1334776\_devtools.patch](/attachment.cgi?id=8858309)  [8 years ago](#c42)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   16.15 KB, patch | Honza : [review+](#c44 "8 years ago") | [Details](/attachment.cgi?id=8858309&action=edit) | [Diff](/attachment.cgi?id=8858309&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8858309) |
| [bug\_1334776\_v2.patch](/attachment.cgi?id=8861308)  [8 years ago](#c45)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   43.70 KB, patch | dragana : [review+](#c45 "8 years ago") | [Details](/attachment.cgi?id=8861308&action=edit) | [Diff](/attachment.cgi?id=8861308&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8861308) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Anne (:annevk)](/user_profile?user_id=102998)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1334776#c0)• 8 years ago |
|  | |

Attached patch

[web-platform-tests test demonstrating the issue](attachment.cgi?id=8831420&action=diff)
— [Details](attachment.cgi?id=8831420&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8831420)

Apparently the way we do header interning doesn't have any kind of boundary. We should probably limit it to each header list rather than keep a global registry.
I attached a web-platform-test patch demonstrating the issue.
Chrome and Safari do not have this problem as far as I can tell.

|  | [Anne (:annevk)](/user_profile?user_id=102998)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1334776#c1)• 8 years ago |
|  | |

FWIW, I think this is problematic even just across requests/responses, but the origin leakage makes it a little scarier.

|  | [Anne (:annevk)](/user_profile?user_id=102998)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1334776#c2)• 8 years ago |
|  | |

Potential attack: session supercookie.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1334776#a308668_1689)• 8 years ago |

Group: core-security → network-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1334776#a459626_406194)• 8 years ago |

[Attachment #8831420](/attachment.cgi?id=8831420&action=edit "web-platform-tests test demonstrating the issue") -
Attachment is patch: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1334776#c3)• 8 years ago |
|  | |

Patrick: what are the implications here?Flags: needinfo?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1334776#c4)• 8 years ago |
|  | |

I believe dragana was the last one to touch the js facing header interfaces, so I'll ask her to weigh in here. :annevk it might be helpful if you could describe a scenario with a little more prose too so we're sure we know what you're talking about.
a few background things that may or may not be relevant:
header names are technically case insensitive.. h2 normalizes everything to lower case on the wire.. common headers have atoms defined and are in mixed case (no matter their wire representation).. and we've had folks in the distant past file bugs when getHeader gave them different case than their server produced (probably due to the atoms, tho I might be misremembering that)Flags: needinfo?(mcmanus) → needinfo?(dd.mozilla)

|  | [Anne (:annevk)](/user_profile?user_id=102998)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1334776#c5)• 8 years ago |
|  | |

This is not about JavaScript APIs (although they help expose it).
The problem is that for unknown header names we store the first one we see and then later we case-insensitively match against that name \*globally\*. That means you can track if a user agent has already seen a certain header name used (by using a different casing and observing whether it gets normalized). This would allow you to see if a user has used a sensitive service that uses custom header names, or allows you to track a user across sites, by teaching the browser about a certain header case once and then observing if different casings get normalized to that.
What we should do instead is only store the casing for a header name for each header list and not globally. That way it only leaks where it's expected (and necessary) to leak.
The test demonstrates the global leakage.

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1334776#a517890_508195)• 8 years ago |

Assignee: nobody → dd.mozillaStatus: NEW → ASSIGNEDFlags: needinfo?(dd.mozilla)

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1334776#a774165_508195)• 8 years ago |

Whiteboard: [necko-active]

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1334776#c6)• 8 years ago |
|  | |

Attached patch

[bug\_1334776\_v1.patch](attachment.cgi?id=8835557&action=diff) (obsolete)
— [Details](attachment.cgi?id=8835557&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8835557)

I have tried to make it less invasive possible(this code is very old), so that we can maybe uplift it.
[Attachment #8835557](/attachment.cgi?id=8835557&action=edit "bug_1334776_v1.patch") -
Flags: review?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1334776#c7)• 8 years ago |
|  | |

dragana can you provide a bugzilla comment about what the patch is meant to do?

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1334776#c8)• 8 years ago |
|  | |

(In reply to Patrick McManus [:mcmanus] from [comment #7](/show_bug.cgi?id=1334776#c7 "RESOLVED FIXED - Header name interning leaks across origins"))
> dragana can you provide a bugzilla comment about what the patch is meant to
> do?
I was avoiding comments in the code.
nsHttpAtom now holds the old nsHttpAtom and a string that is case sensitive (only for not standard headers).
So nsHttpAtom holds a pointer to a header name. (header names are store on a static structure). This is how it used to be. I left that part the same but added a nsCString which holds a string that was used to resoled the header name. So when we parse headers we call ResolveHeader with a char\*. If it is a new header name the char\* will be stored in a HttpHeapAtom, nsHttpAtom::\_val will point to HttpHeapAtom::value and the same strings will be stored in mLocalCaseSensitiveHeader. For the first resolve request they will be the same but for the following maybe not. At the end this nsHttpAtom will be stored in nsHttpHeaderArray. For all operation we will used the old char\* except when we are returning it to a script using VisitHeaders.
I thought this is less invasive, I could supply the header name(with casing) differently but that would be a bigger change and also I was afraid to miss a spot.
I also split the header name hashTable because adding a flag to that old structure is much more work and I am afraid to uplift it.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1334776#a1066641_1689)• 8 years ago |

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)Whiteboard: [necko-active] → [necko-active][fingerprinting]

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1334776#c9)• 8 years ago |
|  | |

I'm not sure we should worry too much about uplifting this, or hiding what the new setup is, really. Ideally the design of the new setup would just be in the commit message or so.

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1334776#c10)• 8 years ago |
|  | |

(In reply to Boris Zbarsky [:bz] (still a bit busy) from [comment #9](/show_bug.cgi?id=1334776#c9 "RESOLVED FIXED - Header name interning leaks across origins"))
> I'm not sure we should worry too much about uplifting this, or hiding what
> the new setup is, really. Ideally the design of the new setup would just be
> in the commit message or so.
Thinking of it a bit longer, the approach I took it is good, I find it better that the one I mentioned in [comment 8](/show_bug.cgi?id=1334776#c8 "RESOLVED FIXED - Header name interning leaks across origins") (i.e. leaving nsHttpAtom in tact and adding string to the setHeader functions).
I could make a refinement and add the cased string only if it is needed. I will update the patch.

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1334776#a1124724_508195)• 8 years ago |

[Attachment #8835557](/attachment.cgi?id=8835557&action=edit "bug_1334776_v1.patch") -
Flags: review?(mcmanus)

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1334776#c11)• 8 years ago |
|  | |

Attached patch

[bug\_1334776\_v2.patch](attachment.cgi?id=8836114&action=diff) (obsolete)
— [Details](attachment.cgi?id=8836114&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8836114)

This one adds a string to nsHttpHeaderArray::nsEntry that holds the original header name. It is set only if the original header name does not match the nsHttpAtom string (so it wikll be empty most of the time).
nsHttpHeaderArray::SetHeader, SetEmptyHeader, SetHeaderFromNet and SetResponseHeaderFromCache must be called with the original header name if needed(if not used from the internal code, e.g. SetHeader(nsHttp::Cookie...)
[Attachment #8835557](/attachment.cgi?id=8835557&action=edit "bug_1334776_v1.patch") -
Attachment is obsolete: true
[Attachment #8836114](/attachment.cgi?id=8836114&action=edit "bug_1334776_v2.patch") -
Flags: review?(mcmanus)

|  | [Anne (:annevk)](/user_profile?user_id=102998)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1334776#c12)• 8 years ago |
|  | |

FWIW, to fully match what Chrome (and I think Edge) are doing would be to not even have interning for "known" header names. E.g., if you use setRequestHeader() or the Headers object API in Chrome, you can use `content-type` or `CONTENT-type` and get that passed-through to the server as-is.
We obviously don't need to do that to fix this issue, but it's something to consider going forward (especially with H2 making most of this obsolete anyway due to always using lowercase header names).

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1334776#c13)• 8 years ago |
|  | |

(In reply to Anne (:annevk) from [comment #12](/show_bug.cgi?id=1334776#c12 "RESOLVED FIXED - Header name interning leaks across origins"))
> FWIW, to fully match what Chrome (and I think Edge) are doing would be to
> not even have interning for "known" header names. E.g., if you use
> setRequestHeader() or the Headers object API in Chrome, you can use
> `content-type` or `CONTENT-type` and get that passed-through to the server
> as-is.
>
> We obviously don't need to do that to fix this issue, but it's something to
> consider going forward (especially with H2 making most of this obsolete
> anyway due to always using lowercase header names).
The last patch will behave the same as Chrome.

|  | [Anne (:annevk)](/user_profile?user_id=102998)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1334776#c14)• 8 years ago |
|  | |

Cool, here's another test I landed today for that (doesn't expose the security issue, just tests casing of headers): <http://w3c-test.org/XMLHttpRequest/getallresponseheaders-cl.htm>.

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1334776#c15)• 8 years ago |
|  | |

I'm going to suggest that we comment this, both in headerArray and the merge commit as "preserve http response header case per transaction"

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1334776#c16)• 8 years ago |
|  | |

Comment on [attachment 8836114](/attachment.cgi?id=8836114 "bug_1334776_v2.patch") [[details]](/attachment.cgi?id=8836114&action=edit "bug_1334776_v2.patch") [[diff]](/attachment.cgi?id=8836114&action=diff "bug_1334776_v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8836114)
bug\_1334776\_v2.patch
Review of [attachment 8836114](/attachment.cgi?id=8836114 "bug_1334776_v2.patch") [[details]](/attachment.cgi?id=8836114&action=edit "bug_1334776_v2.patch") [[diff]](/attachment.cgi?id=8836114&action=diff "bug_1334776_v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8836114):
-----------------------------------------------------------------
I like the patch - unfortunately it crashes :(
[Attachment #8836114](/attachment.cgi?id=8836114&action=edit "bug_1334776_v2.patch") -
Flags: review?(mcmanus) → review-

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1334776#c17)• 8 years ago |
|  | |

when I run the testcase anne provided
./mach web-platform-tests --debugger=gdb testing/web-platform/tests/XMLHttpRequest/cross-origin-header-interning.htm
also have to add it to testing/web-platform/meta/MANIFEST.json
I didnt' try and debug it at all..
[Child 12076] WARNING: '!compMgr', file /home/mcmanus/src/mozilla2/wd/gecko-dev/xpcom/components/nsComponentManagerUtils.cpp, line 63
[Child 12076] WARNING: NS\_ENSURE\_SUCCESS(rv, rv) failed with result 0x80004005: file /home/mcmanus/src/mozilla2/wd/gecko-dev/toolkit/xre/nsXREDirProvider.cpp, line 1699
Thread 1 "firefox" received signal SIGILL, Illegal instruction.
0x00007fffe3406770 in mozilla::net::nsHttpHeaderArray::SetHeader (this=0x7fffc3eb3160, headerName=..., value=..., merge=false, variety=mozilla::net::nsHttpHeaderArray::eVarietyRequestOverride)
at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpHeaderArray.cpp:33
33 SetHeader(header, headerName, value, merge, variety);
(gdb) bt
#0 0x00007fffe3406770 in mozilla::net::nsHttpHeaderArray::SetHeader (this=0x7fffc3eb3160, headerName=..., value=..., merge=false, variety=mozilla::net::nsHttpHeaderArray::eVarietyRequestOverride)
at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpHeaderArray.cpp:33
#1 0x00007fffe3423199 in mozilla::net::nsHttpRequestHead::SetHeader (this=0x7fffc3eb3160, h=..., v=..., m=false) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpRequestHead.cpp:143
#2 0x00007fffe335d6d2 in mozilla::net::HttpBaseChannel::SetRequestHeader (this=0x7fffc3eb3000, aHeader=..., aValue=..., aMerge=false) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/HttpBaseChannel.cpp:1827
#3 0x00007fffe6bd5eb3 in mozilla::dom::RequestHeaders::ApplyToChannel (this=0x7fffd294ce78, aHttpChannel=0x7fffc3eb3058) at /home/mcmanus/src/mozilla2/wd/gecko-dev/dom/xhr/XMLHttpRequestMainThread.cpp:4121

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1334776#c18)• 8 years ago |
|  | |

(In reply to Patrick McManus [:mcmanus] from [comment #17](/show_bug.cgi?id=1334776#c17 "RESOLVED FIXED - Header name interning leaks across origins"))
> when I run the testcase anne provided
> ./mach web-platform-tests --debugger=gdb
> testing/web-platform/tests/XMLHttpRequest/cross-origin-header-interning.htm
>
> also have to add it to testing/web-platform/meta/MANIFEST.json
>
> I didnt' try and debug it at all..
>
> [Child 12076] WARNING: '!compMgr', file
> /home/mcmanus/src/mozilla2/wd/gecko-dev/xpcom/components/
> nsComponentManagerUtils.cpp, line 63
> [Child 12076] WARNING: NS\_ENSURE\_SUCCESS(rv, rv) failed with result
> 0x80004005: file
> /home/mcmanus/src/mozilla2/wd/gecko-dev/toolkit/xre/nsXREDirProvider.cpp,
> line 1699
>
> Thread 1 "firefox" received signal SIGILL, Illegal instruction.
> 0x00007fffe3406770 in mozilla::net::nsHttpHeaderArray::SetHeader
> (this=0x7fffc3eb3160, headerName=..., value=..., merge=false,
> variety=mozilla::net::nsHttpHeaderArray::eVarietyRequestOverride)
> at
> /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/
> nsHttpHeaderArray.cpp:33
> 33 SetHeader(header, headerName, value, merge, variety);
> (gdb) bt
> #0 0x00007fffe3406770 in mozilla::net::nsHttpHeaderArray::SetHeader
> (this=0x7fffc3eb3160, headerName=..., value=..., merge=false,
> variety=mozilla::net::nsHttpHeaderArray::eVarietyRequestOverride)
> at
> /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/
> nsHttpHeaderArray.cpp:33
> #1 0x00007fffe3423199 in mozilla::net::nsHttpRequestHead::SetHeader
> (this=0x7fffc3eb3160, h=..., v=..., m=false) at
> /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/
> nsHttpRequestHead.cpp:143
> #2 0x00007fffe335d6d2 in mozilla::net::HttpBaseChannel::SetRequestHeader
> (this=0x7fffc3eb3000, aHeader=..., aValue=..., aMerge=false) at
> /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/
> HttpBaseChannel.cpp:1827
> #3 0x00007fffe6bd5eb3 in mozilla::dom::RequestHeaders::ApplyToChannel
> (this=0x7fffd294ce78, aHttpChannel=0x7fffc3eb3058) at
> /home/mcmanus/src/mozilla2/wd/gecko-dev/dom/xhr/XMLHttpRequestMainThread.cpp:
> 4121
I have tested it with the test, interesting, I will see what is wrong.

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1334776#c19)• 8 years ago |
|  | |

I have tried to reproduce the crash, I could not.. I tried many times...
Can you reproduce it?

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1334776#a3215095_508195)• 8 years ago |

Flags: needinfo?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1334776#c20)• 8 years ago |
|  | |

I just did a clean rebuild. I can't even start the browser with this patch :)
I'll try and investigate more..Flags: needinfo?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1334776#c21)• 8 years ago |
|  | |

this seems to be compiler specific.. this is what valgrind has to say about clang version 3.8.1-12ubuntu1 (tags/RELEASE\_381/final)
gcc (Ubuntu 6.2.0-5ubuntu12) 6.2.0 20161005 WFM
going to check on clang 3.7
=30180== valgrind: Unrecognised instruction at address 0x115be7b0.
==30180== at 0x115BE7B0: mozilla::net::nsHttpHeaderArray::SetHeader(nsACString\_internal const&, nsACString\_internal const&, bool, mozilla::net::nsHttpHeaderArray::HeaderVariety) (nsHttpHeaderArray.cpp:33)
==30180== by 0x115DB1B8: mozilla::net::nsHttpRequestHead::SetHeader(nsACString\_internal const&, nsACString\_internal const&, bool) (nsHttpRequestHead.cpp:143)
==30180== by 0x11515741: mozilla::net::HttpBaseChannel::SetRequestHeader(nsACString\_internal const&, nsACString\_internal const&, bool) (HttpBaseChannel.cpp:1827)
==30180== by 0x14D9AB52: mozilla::dom::RequestHeaders::ApplyToChannel(nsIHttpChannel\*) const (XMLHttpRequestMainThread.cpp:4117)
==30180== by 0x14D99D04: mozilla::dom::XMLHttpRequestMainThread::InitiateFetch(nsIInputStream\*, long, nsACString\_internal&) (XMLHttpRequestMainThread.cpp:2568)
==30180== by 0x14D9BE51: mozilla::dom::XMLHttpRequestMainThread::SendInternal(mozilla::dom::BodyExtractorBase const\*) (XMLHttpRequestMainThread.cpp:2940)
==30180== by 0x14DB266B: mozilla::dom::XMLHttpRequestMainThread::Send(JSContext\*, mozilla::ErrorResult&) (XMLHttpRequestMainThread.h:313)
==30180== by 0x13739C52: mozilla::dom::XMLHttpRequestBinding::send(JSContext\*, JS::Handle<JSObject\*>, mozilla::dom::XMLHttpRequest\*, JSJitMethodCallArgs const&) (XMLHttpRequestBinding.cpp:651)
==30180== by 0x13B85664: mozilla::dom::GenericBindingMethod(JSContext\*, unsigned int, JS::Value\*) (BindingUtils.cpp:2953)
==30180== by 0x1745A8A3: js::CallJSNative(JSContext\*, bool (\*)(JSContext\*, unsigned int, JS::Value\*), JS::CallArgs const&) (jscntxtinlines.h:282)
==30180== by 0x1744B09E: js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) (Interpreter.cpp:448)
==30180== by 0x1744B49C: InternalCall(JSContext\*, js::AnyInvokeArgs const&) (Interpreter.cpp:493)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1334776#c22)• 8 years ago |
|  | |

this also fails the "casing of known headers 2" test from <http://w3c-test.org/XMLHttpRequest/getallresponseheaders-cl.htm> that anne mentioned. (I didn't investigate it)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1334776#c23)• 8 years ago |
|  | |

tree fails to compile (unrelated to this patch) with
Ubuntu clang version 3.7.1-3ubuntu4 (tags/RELEASE\_371/final) (based on LLVM 3.7.1)
Target: x86\_64-pc-linux-gnu
Thread model: posix
That's fine - just not useful as a datapoint.

|  | [Anne (:annevk)](/user_profile?user_id=102998)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1334776#c24)• 8 years ago |
|  | |

I think this is also causing [bug 1348390](/show_bug.cgi?id=1348390 "RESOLVED FIXED - Permfail: XMLHttpRequest/getallresponseheaders.htm assert_equals: expected \"also-here: Mr. PB\r\newok: lego\r\nfoo-test: 1, 2\r\n\" but got \"foo-TEST: 1, 2\r\nALSO-here: Mr. PB\r\newok: lego\r\n\""). Which would be <http://w3c-test.org/XMLHttpRequest/getallresponseheaders.htm>.
It's probably okay to disable that test, but once we land this fix we should enable it again.

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1334776#c25)• 8 years ago |
|  | |

I tried to reproduce the crash, but no luck. Do you have time to investigate a bit? I looked at the code but I do not see anything suspicious.

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1334776#c26)• 8 years ago |
|  | |

Attached patch

[0001-wip.patch](attachment.cgi?id=8854485&action=diff) (obsolete)
— [Details](attachment.cgi?id=8854485&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8854485)

\* bitrot fixed
\* fixed a return value of SetHeader() (that didn't return a value but was defined as nsresult)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1334776#c27)• 8 years ago |
|  | |

good news - no more sigILL. of course I might have screwed up the rebasing.
<http://w3c-test.org/XMLHttpRequest/getallresponseheaders-cl.htm> runs but fails
while
<http://w3c-test.org/XMLHttpRequest/getallresponseheaders.htm>
crashes on what looks like uaf
0x00007fffe24a2997 in std::\_\_atomic\_base<int>::fetch\_add (this=0xe5e5e5e5e5e5e5dd, \_\_i=1, \_\_m=std::memory\_order\_seq\_cst) at /usr/bin/../lib/gcc/x86\_64-linux-gnu/6.2.0/../../../../include/c++/6.2.0/bits/atomic\_base.h:514
514 { return \_\_atomic\_fetch\_add(&\_M\_i, \_\_i, \_\_m); }
(gdb) bt
#0 0x00007fffe24a2997 in std::\_\_atomic\_base<int>::fetch\_add (this=0xe5e5e5e5e5e5e5dd, \_\_i=1, \_\_m=std::memory\_order\_seq\_cst) at /usr/bin/../lib/gcc/x86\_64-linux-gnu/6.2.0/../../../../include/c++/6.2.0/bits/atomic\_base.h:514
#1 0x00007fffe24a28f0 in mozilla::detail::IntrinsicAddSub<int, (mozilla::MemoryOrdering)2>::add (aPtr=..., aVal=1) at ../../dist/include/mozilla/Atomics.h:254
#2 0x00007fffe24a28ca in mozilla::detail::IntrinsicIncDec<int, (mozilla::MemoryOrdering)2>::inc (aPtr=...) at ../../dist/include/mozilla/Atomics.h:286
#3 0x00007fffe249d865 in mozilla::detail::AtomicBaseIncDec<int, (mozilla::MemoryOrdering)2>::operator++ (this=0xe5e5e5e5e5e5e5dd) at ../../dist/include/mozilla/Atomics.h:609
#4 0x00007fffe248f3bf in nsStringBuffer::AddRef (this=0xe5e5e5e5e5e5e5dd) at /home/mcmanus/src/mozilla2/wd/gecko-dev/xpcom/string/nsSubstring.cpp:189
#5 0x00007fffe2492b04 in nsACString::Assign (this=0x7fffb81d59c0, aStr=..., aFallible=...) at ../../../gecko-dev/xpcom/string/nsTSubstring.cpp:452
#6 0x00007fffe24867a6 in nsACString::Assign (this=0x7fffb81d59c0, aStr=...) at ../../../gecko-dev/xpcom/string/nsTSubstring.cpp:418
#7 0x00007fffe249d107 in nsCString::operator= (this=0x7fffb81d59c0, aStr=...) at ../../../gecko-dev/xpcom/string/nsTString.h:98
#8 0x00007fffe2cbcd99 in mozilla::net::nsHttpHeaderArray::SetHeader\_internal (this=0x7fffb81d5700, header=..., headerName=..., value=..., variety=mozilla::net::nsHttpHeaderArray::eVarietyResponse)
at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpHeaderArray.cpp:111
#9 0x00007fffe2ccf9dd in mozilla::net::nsHttpHeaderArray::MergeHeader (this=0x7fffb81d5700, header=..., entry=0x7fffb81d6dc8, value=..., variety=mozilla::net::nsHttpHeaderArray::eVarietyResponse)
at ../../../../gecko-dev/netwerk/protocol/http/nsHttpHeaderArray.h:277
#10 0x00007fffe2cbd1f1 in mozilla::net::nsHttpHeaderArray::SetHeaderFromNet (this=0x7fffb81d5700, header=..., headerNameOrg=..., value=..., response=true) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpHeaderArray.cpp:183
#11 0x00007fffe2cc28b1 in mozilla::net::nsHttpResponseHead::ParseHeaderLine\_locked (this=0x7fffb81d5700, line=..., originalFromNetHeaders=true) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpResponseHead.cpp:605
#12 0x00007fffe2cc3b88 in mozilla::net::nsHttpResponseHead::ParseHeaderLine (this=0x7fffb81d5700, line=...) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpResponseHead.cpp:590
#13 0x00007fffe2ccc292 in mozilla::net::nsHttpTransaction::ParseLine (this=0x7fffbd4b6000, line=...) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpTransaction.cpp:1287

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1334776#c28)• 8 years ago |
|  | |

I think I have a fix for the crash - assigning a substring to a nsAutoCString make a shared substring and I did not want that.
I have looked into tests:
<http://w3c-test.org/XMLHttpRequest/getallresponseheaders-cl.htm>
there is 3 tests:
The first fails because it expects content-length: 0\r\n" but we got "CONTENT-LENGTH: 0\r\n". Anne do you want us to make non-standard casing all small? I think we should not. Chrome fails in the same way as firefox with my patch.
The second passes (this one uses XHR).
The third fails. It uses fetch.:
the test sets 2 headers "THIS-is-A-test: 1" and "THIS-IS-A-TEST: 2". The fetch code transform it into all small case header names. Chrome does the same. The fetch code uses SetRequestHeader with parameter merge=false and therefore we end up having only "this-is-a-test: 2". Chrome has "this-is-a-test: 1,2". I do not know why we use merge=false.
<http://w3c-test.org/XMLHttpRequest/getallresponseheaders.htm>
The second test fails for 2 reasons: the first reason is the same as the first test in <http://w3c-test.org/XMLHttpRequest/getallresponseheaders-cl.htm>. The second reason is the order of headers. Chrome and Firefox does not order headers in the same way and the test does not match neither Firefox nor Chrome.

|  | [Anne (:annevk)](/user_profile?user_id=102998)  Reporter |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1334776#c29)• 8 years ago |
|  | |

For <http://w3c-test.org/XMLHttpRequest/getallresponseheaders-cl.htm>:
1) The lowercasing should probably not happen in Necko. If we do this it should be in our XMLHttpRequest code and done separately from this bug.
2) Great!
3) That seems like a bug, but again, not in Necko.
For
<http://w3c-test.org/XMLHttpRequest/getallresponseheaders.htm>:
2) This again seems like something to be fixed outside of Necko.

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1334776#c30)• 8 years ago |
|  | |

Attached patch

[bug\_1334776\_v2.patch](attachment.cgi?id=8856494&action=diff) (obsolete)
— [Details](attachment.cgi?id=8856494&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8856494)

[Attachment #8836114](/attachment.cgi?id=8836114&action=edit "bug_1334776_v2.patch") -
Attachment is obsolete: true
[Attachment #8854485](/attachment.cgi?id=8854485&action=edit "0001-wip.patch") -
Attachment is obsolete: true
[Attachment #8856494](/attachment.cgi?id=8856494&action=edit "bug_1334776_v2.patch") -
Flags: review?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1334776#c31)• 8 years ago |
|  | |

unfortunately <http://w3c-test.org/XMLHttpRequest/getallresponseheaders.htm> still crashes for me
does the safety of the assign() in ParseheaderLine depend on the actual type of the nsACstring? i.e. is a substring passed in there always dangerous? maybe the type needs to be changed.. just brainstorming - not sure.
Thread 9 "Socket Thread" received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7fffda1da700 (LWP 6215)]
0x00007fffe22ecefb in std::\_\_atomic\_base<unsigned int>::fetch\_add (this=0xe5e5e5e5e5e5e5dd, \_\_i=1, \_\_m=std::memory\_order\_relaxed) at /usr/bin/../lib/gcc/x86\_64-linux-gnu/6.2.0/../../../../include/c++/6.2.0/bits/atomic\_base.h:514
514 { return \_\_atomic\_fetch\_add(&\_M\_i, \_\_i, \_\_m); }
(gdb) bt
#0 0x00007fffe22ecefb in std::\_\_atomic\_base<unsigned int>::fetch\_add (this=0xe5e5e5e5e5e5e5dd, \_\_i=1, \_\_m=std::memory\_order\_relaxed) at /usr/bin/../lib/gcc/x86\_64-linux-gnu/6.2.0/../../../../include/c++/6.2.0/bits/atomic\_base.h:514
#1 0x00007fffe22dea16 in nsStringBuffer::AddRef (this=0xe5e5e5e5e5e5e5dd) at /home/mcmanus/src/mozilla2/wd/gecko-dev/xpcom/string/nsSubstring.cpp:200
#2 0x00007fffe22e2144 in nsACString::Assign (this=0x7fffbdc79ec0, aStr=..., aFallible=...) at ../../../gecko-dev/xpcom/string/nsTSubstring.cpp:452
#3 0x00007fffe22d5dd6 in nsACString::Assign (this=0x7fffbdc79ec0, aStr=...) at ../../../gecko-dev/xpcom/string/nsTSubstring.cpp:418
#4 0x00007fffe22ec767 in nsCString::operator= (this=0x7fffbdc79ec0, aStr=...) at ../../../gecko-dev/xpcom/string/nsTString.h:98
#5 0x00007fffe2b1a239 in mozilla::net::nsHttpHeaderArray::SetHeader\_internal (this=0x7fffbdc79e00, header=..., headerName=..., value=..., variety=mozilla::net::nsHttpHeaderArray::eVarietyResponse)
at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpHeaderArray.cpp:111
#6 0x00007fffe2b2cead in mozilla::net::nsHttpHeaderArray::MergeHeader (this=0x7fffbdc79e00, header=..., entry=0x7fffbdc8a748, value=..., variety=mozilla::net::nsHttpHeaderArray::eVarietyResponse)
at ../../../../gecko-dev/netwerk/protocol/http/nsHttpHeaderArray.h:279
#7 0x00007fffe2b1a691 in mozilla::net::nsHttpHeaderArray::SetHeaderFromNet (this=0x7fffbdc79e00, header=..., headerNameOrg=..., value=..., response=true) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpHeaderArray.cpp:184
#8 0x00007fffe2b1fd81 in mozilla::net::nsHttpResponseHead::ParseHeaderLine\_locked (this=0x7fffbdc79e00, line=..., originalFromNetHeaders=true) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpResponseHead.cpp:605
#9 0x00007fffe2b21058 in mozilla::net::nsHttpResponseHead::ParseHeaderLine (this=0x7fffbdc79e00, line=...) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpResponseHead.cpp:590
#10 0x00007fffe2b29762 in mozilla::net::nsHttpTransaction::ParseLine (this=0x7fffbdcf4400, line=...) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpTransaction.cpp:1287
#11 0x00007fffe2b29879 in mozilla::net::nsHttpTransaction::ParseLineSegment (this=0x7fffbdcf4400, segment=0x7fffbdca002b "foo-test: 3\n", '\344' <repeats 187 times>, <incomplete sequence \344>..., len=12)
at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpTransaction.cpp:1304
#12 0x00007fffe2b28ed8 in mozilla::net::nsHttpTransaction::ParseHead (this=0x7fffbdcf4400, buf=0x7fffbdca002b "foo-test: 3\n", '\344' <repeats 187 times>, <incomplete sequence \344>..., count=55, countRead=0x7fffda1d93d4)
at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpTransaction.cpp:1431
#13 0x00007fffe2b26c3a in mozilla::net::nsHttpTransaction::ProcessData (this=0x7fffbdcf4400, buf=0x7fffbdca0000 "HTTP/1.1 280 HELLO\nfoo-test: 1\nfoo-test: 2\nfoo-test: 3\n", '\344' <repeats 144 times>, <incomplete sequence \344>..., count=55,
countRead=0x7fffda1d94b0) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpTransaction.cpp:1690
#14 0x00007fffe2b26a4d in mozilla::net::nsHttpTransaction::WritePipeSegment (stream=0x7fffc88f3958, closure=0x7fffbdcf4400,
buf=0x7fffbdca0000 "HTTP/1.1 280 HELLO\nfoo-test: 1\nfoo-test: 2\nfoo-test: 3\n", '\344' <repeats 144 times>, <incomplete sequence \344>..., offset=0, count=32768, countWritten=0x7fffda1d94b0)
at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpTransaction.cpp:823
#15 0x00007fffe23cd1fc in nsPipeOutputStream::WriteSegments (this=0x7fffc88f3958, aReader=0x7fffe2b26840 <mozilla::net::nsHttpTransaction::WritePipeSegment(nsIOutputStream\*, void\*, char\*, unsigned int, unsigned int, unsigned int\*)>, aClosure=0x7fffbdcf4400,
aCount=32768, aWriteCount=0x7fffda1d9624) at /home/mcmanus/src/mozilla2/wd/gecko-dev/xpcom/io/nsPipe3.cpp:1817
#16 0x00007fffe2b2824e in mozilla::net::nsHttpTransaction::WriteSegments (this=0x7fffbdcf4400, writer=0x7fffc718fe28, count=32768, countWritten=0x7fffda1d9624) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpTransaction.cpp:859
#17 0x00007fffe2a7b6bd in mozilla::net::nsAHttpTransaction::WriteSegmentsAgain (this=0x7fffbdcf4400, writer=0x7fffc718fe28, count=32768, countWritten=0x7fffda1d9624, again=0x7fffda1d9623) at ../../../../gecko-dev/netwerk/protocol/http/nsAHttpTransaction.h:93
#18 0x00007fffe2ae569d in mozilla::net::nsHttpConnection::OnSocketReadable (this=0x7fffc718fe20) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpConnection.cpp:1812
#19 0x00007fffe2ae62fb in mozilla::net::nsHttpConnection::OnInputStreamReady (this=0x7fffc718fe20, in=0x7fffbded3e80) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/protocol/http/nsHttpConnection.cpp:2148
#20 0x00007fffe25befb1 in mozilla::net::nsSocketInputStream::OnSocketReady (this=0x7fffbded3e80, condition=nsresult::NS\_OK) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/base/nsSocketTransport2.cpp:293
#21 0x00007fffe25c662d in mozilla::net::nsSocketTransport::OnSocketReady (this=0x7fffbded3c00, fd=0x7fffddebff70, outFlags=1) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/base/nsSocketTransport2.cpp:1996
#22 0x00007fffe25cf5e7 in mozilla::net::nsSocketTransportService::DoPollIteration (this=0x7fffdfa3d660, pollDuration=0x7fffda1d99b8) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/base/nsSocketTransportService2.cpp:1135
#23 0x00007fffe25ce98b in mozilla::net::nsSocketTransportService::Run (this=0x7fffdfa3d660) at /home/mcmanus/src/mozilla2/wd/gecko-dev/netwerk/base/nsSocketTransportService2.cpp:909
#24 0x00007fffe2433abe in nsThread::ProcessNextEvent (this=0x7ffff6bbe600, aMayWait=false, aResult=0x7fffda1d9bfe) at /home/mcmanus/src/mozilla2/wd/gecko-dev/xpcom/threads/nsThread.cpp:1269
#25 0x00007fffe2431c4c in NS\_ProcessNextEvent (aThread=0x7ffff6bbe600, aMayWait=false) at /home/mcmanus/src/mozilla2/wd/gecko-dev/xpcom/threads/nsThreadUtils.cpp:389
#26 0x00007fffe2d42330 in mozilla::ipc::MessagePumpForNonMainThreads::Run (this=0x7fffddd10d00, aDelegate=0x7ffff6bb85c0) at /home/mcmanus/src/mozilla2/wd/gecko-dev/ipc/glue/MessagePump.cpp:338
#27 0x00007fffe2c831f5 in MessageLoop::RunInternal (this=0x7ffff6bb85c0) at /home/mcmanus/src/mozilla2/wd/gecko-dev/ipc/chromium/src/base/message\_loop.cc:238
#28 0x00007fffe2c83175 in MessageLoop::RunHandler (this=0x7ffff6bb85c0) at /home/mcmanus/src/mozilla2/wd/gecko-dev/ipc/chromium/src/base/message\_loop.cc:231
#29 0x00007fffe2c8314d in MessageLoop::Run (this=0x7ffff6bb85c0) at /home/mcmanus/src/mozilla2/wd/gecko-dev/ipc/chromium/src/base/message\_loop.cc:211
#30 0x00007fffe24304d7 in nsThread::ThreadFunc (aArg=0x7fffffff9e10) at /home/mcmanus/src/mozilla2/wd/gecko-dev/xpcom/threads/nsThread.cpp:500
#31 0x00007ffff7f04335 in \_pt\_root (arg=0x7ffff6ba4340) at ../../../../../gecko-dev/nsprpub/pr/src/pthreads/ptthread.c:216
#32 0x00007ffff7bc16ca in start\_thread (arg=0x7fffda1da700) at pthread\_create.c:333
#33 0x00007ffff6e4f0af in clone () at ../sysdeps/unix/sysv/linux/x86\_64/clone.S:105

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1334776#c32)• 8 years ago |
|  | |

Comment on [attachment 8856494](/attachment.cgi?id=8856494 "bug_1334776_v2.patch") [[details]](/attachment.cgi?id=8856494&action=edit "bug_1334776_v2.patch") [[diff]](/attachment.cgi?id=8856494&action=diff "bug_1334776_v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8856494)
bug\_1334776\_v2.patch
Review of [attachment 8856494](/attachment.cgi?id=8856494 "bug_1334776_v2.patch") [[details]](/attachment.cgi?id=8856494&action=edit "bug_1334776_v2.patch") [[diff]](/attachment.cgi?id=8856494&action=diff "bug_1334776_v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8856494):
-----------------------------------------------------------------
::: netwerk/protocol/http/nsHttpHeaderArray.cpp
@@ +415,5 @@
>
> // assign return values
> if (hdr) \*hdr = atom;
> if (val) val->Assign(p, p2 - p + 1);
> + if (headerName) headerName->Assign(sub.BeginReading(), sub.Length());
might as well put a comment on the subtle part here, given that we both missed it the first time around.
[Attachment #8856494](/attachment.cgi?id=8856494&action=edit "bug_1334776_v2.patch") -
Flags: review?(mcmanus) → review-

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1334776#c33)• 8 years ago |
|  | |

> assigning a substring to a nsAutoCString make a shared substring and I did not want that.
Uh... what do you mean? Assigning to an nsAutoCString should generally give it its own stringbuffer, copying as needed.
Looking at the stack in [comment 31](/show_bug.cgi?id=1334776#c31 "RESOLVED FIXED - Header name interning leaks across origins"), we have a freed stringbuffer pointer:
nsStringBuffer::AddRef (this=0xe5e5e5e5e5e5e5dd)
Which string is that? Is that the entry->headerNameOrg string or something else?

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1334776#c34)• 8 years ago |
|  | |

This is all my mistake. Sorry for the noise.
103 nsEntry \*entry = mHeaders.AppendElement();
104 if (!entry) {
105 return NS\_ERROR\_OUT\_OF\_MEMORY;
106 }
107 entry->header = header;
108 // Only same original form of a header if it is different than the header
109 // string.
110 if (!headerName.Equals(header.get())) {
111 entry->headerNameOrg = headerName;
entry->headerNameOrg get the value of headerName. mData of entry->headerNameOrg string is assigned mData of headerName. This mData is freed. This is because headerName is entry->headerNameOrg, here entry is another entry (which is probably empty) and both are part of the same nsTArray<nsEntry> so probably after the new one is created the old one is reallocated. Does this make sense ?

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1334776#c35)• 8 years ago |
|  | |

Attached patch

[bug\_1334776\_v2.patch](attachment.cgi?id=8856573&action=diff) (obsolete)
— [Details](attachment.cgi?id=8856573&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8856573)

[Attachment #8856494](/attachment.cgi?id=8856494&action=edit "bug_1334776_v2.patch") -
Attachment is obsolete: true
[Attachment #8856573](/attachment.cgi?id=8856573&action=edit "bug_1334776_v2.patch") -
Flags: review?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1334776#c36)• 8 years ago |
|  | |

I'm sorry; I don't understand what the problem was (i.e. how we ended up in uaf)
specifically there are lots of ways to call setheader\_internal, why does copying in that one case make a difference. why does the header value (instead of name) never need to be copied?
Is it somehow a re-entrant issue where entry->name was overwritten (and then deleted) on the stack and the caller is unaware?

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1334776#c37)• 8 years ago |
|  | |

Comment on [attachment 8856573](/attachment.cgi?id=8856573 "bug_1334776_v2.patch") [[details]](/attachment.cgi?id=8856573&action=edit "bug_1334776_v2.patch") [[diff]](/attachment.cgi?id=8856573&action=diff "bug_1334776_v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8856573)
bug\_1334776\_v2.patch
Review of [attachment 8856573](/attachment.cgi?id=8856573 "bug_1334776_v2.patch") [[details]](/attachment.cgi?id=8856573&action=edit "bug_1334776_v2.patch") [[diff]](/attachment.cgi?id=8856573&action=diff "bug_1334776_v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8856573):
-----------------------------------------------------------------
I will admit I don't totally understand what the problem is here.
::: netwerk/protocol/http/nsHttpHeaderArray.cpp
@@ +104,5 @@
> if (!entry) {
> return NS\_ERROR\_OUT\_OF\_MEMORY;
> }
> entry->header = header;
> + // Only same original form of a header if it is different than the header
s/same/save
@@ +105,5 @@
> return NS\_ERROR\_OUT\_OF\_MEMORY;
> }
> entry->header = header;
> + // Only same original form of a header if it is different than the header
> + // string.
atom string
[Attachment #8856573](/attachment.cgi?id=8856573&action=edit "bug_1334776_v2.patch") -
Flags: review?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1334776#c38)• 8 years ago |
|  | |

(In reply to Patrick McManus [:mcmanus] from [comment #36](/show_bug.cgi?id=1334776#c36 "RESOLVED FIXED - Header name interning leaks across origins"))
> I'm sorry; I don't understand what the problem was (i.e. how we ended up in
> uaf)
>
> specifically there are lots of ways to call setheader\_internal, why does
> copying in that one case make a difference. why does the header value
> (instead of name) never need to be copied?
dragana and I spoke out of band. the answer is that mergeHeader is special - the values if they are merged are rewritten with a comma (so the old string can be safely destroyed) and previously the name was always based on the persistent atom (not anymore - thus the problem).

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1334776#c39)• 8 years ago |
|  | |

Comment on [attachment 8856573](/attachment.cgi?id=8856573 "bug_1334776_v2.patch") [[details]](/attachment.cgi?id=8856573&action=edit "bug_1334776_v2.patch") [[diff]](/attachment.cgi?id=8856573&action=diff "bug_1334776_v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8856573)
bug\_1334776\_v2.patch
Review of [attachment 8856573](/attachment.cgi?id=8856573 "bug_1334776_v2.patch") [[details]](/attachment.cgi?id=8856573&action=edit "bug_1334776_v2.patch") [[diff]](/attachment.cgi?id=8856573&action=diff "bug_1334776_v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8856573):
-----------------------------------------------------------------
::: netwerk/protocol/http/nsHttpHeaderArray.h
@@ +127,5 @@
> // Must be copy-constructable and assignable
> struct nsEntry
> {
> nsHttpAtom header;
> + nsCString headerNameOrg;
let's rename all instances of headerNameOrg to headerNameOriginal (or perhaps headerNameOrig)
I know its a pain. thanks!
[Attachment #8856573](/attachment.cgi?id=8856573&action=edit "bug_1334776_v2.patch") -
Flags: review+

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1334776#c40)• 8 years ago |
|  | |

Attached patch

[bug\_1334776\_v2.patch](attachment.cgi?id=8857011&action=diff) (obsolete)
— [Details](attachment.cgi?id=8857011&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8857011)

[Attachment #8856573](/attachment.cgi?id=8856573&action=edit "bug_1334776_v2.patch") -
Attachment is obsolete: true
[Attachment #8857011](/attachment.cgi?id=8857011&action=edit "bug_1334776_v2.patch") -
Flags: review+

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1334776#c41)• 8 years ago |
|  | |

Attached patch

[bug\_1334776\_v2.patch](attachment.cgi?id=8858298&action=diff) (obsolete)
— [Details](attachment.cgi?id=8858298&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8858298)

Fix some tests.
[Attachment #8857011](/attachment.cgi?id=8857011&action=edit "bug_1334776_v2.patch") -
Attachment is obsolete: true
[Attachment #8858298](/attachment.cgi?id=8858298&action=edit "bug_1334776_v2.patch") -
Flags: review+

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1334776#c42)• 8 years ago |
|  | |

Attached patch

[bug\_1334776\_devtools.patch](attachment.cgi?id=8858309&action=diff)
— [Details](attachment.cgi?id=8858309&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8858309)

This is a patch for devtools. With this patch all test are passing but I am afraid that there is some code that the tests do not cover.
Honza, I do not know who is the right person to review this.
[Attachment #8858309](/attachment.cgi?id=8858309&action=edit "bug_1334776_devtools.patch") -
Flags: review?(odvarko)

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1334776#c43)• 8 years ago |
|  | |

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=7e6631888c7b7809e9a69bb0f04193a541945928>

|  | [Jan Honza Odvarko [:Honza] (always need-info? me)](/user_profile?user_id=303767) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1334776#c44)• 8 years ago |
|  | |

Comment on [attachment 8858309](/attachment.cgi?id=8858309 "bug_1334776_devtools.patch") [[details]](/attachment.cgi?id=8858309&action=edit "bug_1334776_devtools.patch") [[diff]](/attachment.cgi?id=8858309&action=diff "bug_1334776_devtools.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8858309)
bug\_1334776\_devtools.patch
Review of [attachment 8858309](/attachment.cgi?id=8858309 "bug_1334776_devtools.patch") [[details]](/attachment.cgi?id=8858309&action=edit "bug_1334776_devtools.patch") [[diff]](/attachment.cgi?id=8858309&action=diff "bug_1334776_devtools.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8858309):
-----------------------------------------------------------------
If I understand correctly, we should treat all headers case-insensitive => lower case, correct?
If yes, the patch looks good to me.
R+ assuming try is green.
Honza
[Attachment #8858309](/attachment.cgi?id=8858309&action=edit "bug_1334776_devtools.patch") -
Flags: review?(odvarko) → review+

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1334776#c45)• 8 years ago |
|  | |

Attached patch

[bug\_1334776\_v2.patch](attachment.cgi?id=8861308&action=diff)
— [Details](attachment.cgi?id=8861308&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8861308)

rebased
[Attachment #8858298](/attachment.cgi?id=8858298&action=edit "bug_1334776_v2.patch") -
Attachment is obsolete: true
[Attachment #8861308](/attachment.cgi?id=8861308&action=edit "bug_1334776_v2.patch") -
Flags: review+

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1334776#c46)• 8 years ago |
|  | |

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=cf7aacaca2319d80863613729b569518aa810dea>
at this one there is an error in web-platform-test, but that is my mistake. I marked that the first test in getallresponseheaders-cl.htm pass but it does not, this is explained in [comment 28](/show_bug.cgi?id=1334776#c28 "RESOLVED FIXED - Header name interning leaks across origins"). I fixed it:
<https://treeherder.mozilla.org/#/jobs?repo=try&revision=e8d136b54bfdd8b44727848d0f83e9240e6ca41d>

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1334776#c47)• 8 years ago |
|  | |

(In reply to Jan Honza Odvarko [:Honza] from [comment #44](/show_bug.cgi?id=1334776#c44 "RESOLVED FIXED - Header name interning leaks across origins"))
> Comment on [attachment 8858309](/attachment.cgi?id=8858309 "bug_1334776_devtools.patch") [[details]](/attachment.cgi?id=8858309&action=edit "bug_1334776_devtools.patch") [[diff]](/attachment.cgi?id=8858309&action=diff "bug_1334776_devtools.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8858309)
> bug\_1334776\_devtools.patch
>
> Review of [attachment 8858309](/attachment.cgi?id=8858309 "bug_1334776_devtools.patch") [[details]](/attachment.cgi?id=8858309&action=edit "bug_1334776_devtools.patch") [[diff]](/attachment.cgi?id=8858309&action=diff "bug_1334776_devtools.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8858309):
> -----------------------------------------------------------------
>
> If I understand correctly, we should treat all headers case-insensitive =>
> lower case, correct?
>
> If yes, the patch looks good to me.
>
> R+ assuming try is green.
>
> Honza
A header name will have the same form as when it is received from a server or set using setHeader. So it is easiest to treat is case-insensitive and transform i to lower case.

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1334776#c48)• 8 years ago |
|  | |

Comment on [attachment 8861308](/attachment.cgi?id=8861308 "bug_1334776_v2.patch") [[details]](/attachment.cgi?id=8861308&action=edit "bug_1334776_v2.patch") [[diff]](/attachment.cgi?id=8861308&action=diff "bug_1334776_v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8861308)
bug\_1334776\_v2.patch
[Security approval request comment]
How easily could an exploit be constructed based on the patch? The patch shows what the problem is. How to exploit it described in description ,[comment 1](/show_bug.cgi?id=1334776#c1 "RESOLVED FIXED - Header name interning leaks across origins") and 2
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem? yes
Which older supported branches are affected by this flaw? all, this is handle in the same way from the beginning.
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
I am afraid that backports are risky, I would like this parch to run a bit longer before release. We now return case-sensitive header names and I am afraid some application will break because they are expecting something different.
How likely is this patch to cause regressions; how much testing does it need?
It is possible that this will cause problems but they are hard to test, we will maybe break some sites.
[Attachment #8861308](/attachment.cgi?id=8861308&action=edit "bug_1334776_v2.patch") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1334776#c49)• 8 years ago |
|  | |

Comment on [attachment 8861308](/attachment.cgi?id=8861308 "bug_1334776_v2.patch") [[details]](/attachment.cgi?id=8861308&action=edit "bug_1334776_v2.patch") [[diff]](/attachment.cgi?id=8861308&action=diff "bug_1334776_v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1334776&attachment=8861308)
bug\_1334776\_v2.patch
As a sec-low rated issue, this doesn't need sec-approval to be checked in. I'm clearing the flag.
<https://wiki.mozilla.org/Security/Bug_Approval_Process>
Go ahead and check into trunk.
[Attachment #8861308](/attachment.cgi?id=8861308&action=edit "bug_1334776_v2.patch") -
Flags: sec-approval?

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1334776#c50)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/9bf8e9f799c3>
<https://hg.mozilla.org/mozilla-central/rev/32aa533e3335>Status: ASSIGNED → RESOLVEDClosed: 8 years ago
[status-firefox55](/buglist.cgi?f1=cf_status_firefox55&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox55&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla55

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1334776#c51)• 8 years ago |
|  | |

Sounds like this is a wontfix for 54 then based on [comment 48](/show_bug.cgi?id=1334776#c48 "RESOLVED FIXED - Header name interning leaks across origins"). Given that this is a fingerprinting issue, I'm leaving esr52 set to affected for possible backport there in a future release (maybe 52.3 or 52.4?).
[status-firefox53](/buglist.cgi?f1=cf_status_firefox53&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox53&o1=equals&v1=wontfix)
[status-firefox54](/buglist.cgi?f1=cf_status_firefox54&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox54&o1=equals&v1=wontfix)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F)Flags: in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1334776#a8217494_1689)• 8 years ago |

Group: network-core-security → core-security-release

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1334776#c52)• 8 years ago |
|  | |

As a sec-low, we wouldn't normally take this on ESR52 without a reason.Whiteboard: [necko-active][fingerprinting] → [necko-active][fingerprinting][adv-main55+]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1334776#c53)• 8 years ago |
|  | |

Arthur, is this something that would be useful to backport to ESR52 for Tor?Flags: needinfo?(arthuredelstein)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1334776#a13247049_280903)• 8 years ago |

Alias: CVE-2017-7797

|  | [Arthur Edelstein [:arthur]](/user_profile?user_id=474980) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1334776#c54)• 8 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #53](/show_bug.cgi?id=1334776#c53 "RESOLVED FIXED - Header name interning leaks across origins"))
> Arthur, is this something that would be useful to backport to ESR52 for Tor?
Yes, I think it would be. Thanks for bringing it to our attention.Flags: needinfo?(arthuredelstein)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1334776#c55)• 8 years ago |
|  | |

Thanks for the reply, Arthur. Dragana, can you please nominate this for ESR52 approval? Thanks :)Flags: needinfo?(dd.mozilla)

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1334776#c56)• 8 years ago |
|  | |

This patch changes some header casing. I am afraid that some application will depend on old casing. This patch is on beta and nightly, it is still not on release. Pushing this to esr52 is connected with some risk. I will double check with Patrick.Flags: needinfo?(dd.mozilla) → needinfo?(mcmanus)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1334776#c57)• 8 years ago |
|  | |

I don't think "useful" is the right metric for backporting. Hopefully all patches are useful to someone :)
the risk here is in compat.. it doesn't seem to meet esr criteria and hasn't seen the broadest release audience yet.Flags: needinfo?(mcmanus)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1334776#c58)• 8 years ago |
|  | |

Sounds like the earliest we'd want to consider this then would be for 52.4, i.e. the next cycle. Which would already be halfway through ESR52's lifespan. Let's just wontfix unless people strongly want it (and I assume the Tor folks can just include it locally in their builds).
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=wontfix)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=%3F) → ---

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1334776#a15949737_452604)• 7 years ago |

Flags: qe-verify-Whiteboard: [necko-active][fingerprinting][adv-main55+] → [necko-active][fingerprinting][adv-main55+][post-critsmash-triage]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1334776#a31932540_1689)• 7 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1334776&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Anne (:annevk)](/user_profile?user_id=102998)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_1d40aa1b_20250125_160010.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sat Jan 25 2025 08:00:09 PST

* **Bug ID:**
  1353763,
  1353356,
  1370070,
  1375435,
  1373663,
  1363150,
  1370817,
  1273678,
  1367850,
  1347968,
  1361749,
  1349138,
  1371982,
  1344666,
  1369836,
  1330739,
  1371511,
  1371484

---

18 bugs found.

| [ID](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [1371484](/show_bug.cgi?id=1371484 "RESOLVED FIXED - Write beyond bounds in Key::EncodeAsString()") |  | [Write beyond bounds in Key::EncodeAsString()](/show_bug.cgi?id=1371484) | Core | Storage: IndexedDB | bevistseng | RESO | FIXE | 2024-05-30 |
| [1330739](/show_bug.cgi?id=1330739 "RESOLVED FIXED - crash near null and potential UAF [@mozilla::a11y::DocManager::CreateDocOrRootAccessible]") |  | [crash near null and potential UAF [@mozilla::a11y::DocManager::CreateDocOrRootAccessible]](/show_bug.cgi?id=1330739) | Core | Disability Access AP | eitan | RESO | FIXE | 2018-02-01 |
| [1371982](/show_bug.cgi?id=1371982 "RESOLVED FIXED - Intermittent AddressSanitizer: heap-use-after-free /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/MozPromise.h:867:5 in mozilla::MozPromise<mozilla::UniquePtr<int, mozilla::DefaultDelete<int> >, bool, true>::ThenInternal(mozilla::Abstra") |  | [Intermittent AddressSanitizer: heap-use-after-free /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/MozPromise.h:867:5 in mozilla::MozPromise<mozilla::UniquePtr<int, mozilla::DefaultDelete<int> >, bool, true>::ThenInternal(mozilla::Abstra](/show_bug.cgi?id=1371982) | Core | XPCOM | suro001 | RESO | FIXE | 2020-02-28 |
| [1370817](/show_bug.cgi?id=1370817 "RESOLVED FIXED - Unsafe use of Array.prototype.slice in Intl.js") |  | [Unsafe use of Array.prototype.slice in Intl.js](/show_bug.cgi?id=1370817) | Core | JavaScript: Internat | andrebargull | RESO | FIXE | 2018-02-01 |
| [1371511](/show_bug.cgi?id=1371511 "RESOLVED FIXED - InvalidArrayIndex_CRASH {@ mozilla::a11y::NotificationController::WillRefresh]") |  | [InvalidArrayIndex\_CRASH {@ mozilla::a11y::NotificationController::WillRefresh]](/show_bug.cgi?id=1371511) | Core | Disability Access AP | eitan | RESO | FIXE | 2018-02-01 |
| [1361749](/show_bug.cgi?id=1361749 "RESOLVED FIXED - Initialize a bunch of variables that are left uninitialized on construction after bug 1316556") |  | [Initialize a bunch of variables that are left uninitialized on construction after bug 1316556](/show_bug.cgi?id=1361749) | Core | Layout | emilio | RESO | FIXE | 2018-07-06 |
| [1370070](/show_bug.cgi?id=1370070 "RESOLVED FIXED - Assertion failure: CheckCapacity(aLength) (String is too large.), at dist/include/nsTSubstring.h:1125") |  | [Assertion failure: CheckCapacity(aLength) (String is too large.), at dist/include/nsTSubstring.h:1125](/show_bug.cgi?id=1370070) | Core | DOM: File | ericrahm+bz | RESO | FIXE | 2018-02-01 |
| [1344666](/show_bug.cgi?id=1344666 "RESOLVED FIXED - Undefined behaviour in pr_inet_aton") |  | [Undefined behaviour in pr\_inet\_aton](/show_bug.cgi?id=1344666) | NSPR | NSPR | franziskuskiefer | RESO | FIXE | 2018-02-01 |
| [1347968](/show_bug.cgi?id=1347968 "RESOLVED FIXED - Intermittent ts_paint | application crashed [@ IPC::Channel::ChannelImpl::ProcessIncomingMessages(base::MessagePumpForIO::IOContext *,unsigned long)]") |  | [Intermittent ts\_paint | application crashed [@ IPC::Channel::ChannelImpl::ProcessIncomingMessages(base::MessagePumpForIO::IOContext \*,unsigned long)]](/show_bug.cgi?id=1347968) | Core | General | gkrizsanits | RESO | FIXE | 2018-10-01 |
| [1363150](/show_bug.cgi?id=1363150 "RESOLVED FIXED - Assertion failure: !denseElementsAreFrozen(), at /home/andre/git/mozilla-central/js/src/vm/NativeObject-inl.h:223") |  | [Assertion failure: !denseElementsAreFrozen(), at /home/andre/git/mozilla-central/js/src/vm/NativeObject-inl.h:223](/show_bug.cgi?id=1363150) | Core | JavaScript Engine | jdemooij | RESO | FIXE | 2018-02-01 |
| [1373663](/show_bug.cgi?id=1373663 "RESOLVED FIXED - Assertion failure: off.assigned() && offset >= 0 && unsigned(offset) < size(), at js/src/jit/shared/IonAssemblerBuffer.h:380 with wasm") |  | [Assertion failure: off.assigned() && offset >= 0 && unsigned(offset) < size(), at js/src/jit/shared/IonAssemblerBuffer.h:380 with wasm](/show_bug.cgi?id=1373663) | Core | JavaScript Engine | lhansen | RESO | FIXE | 2018-02-01 |
| [1349138](/show_bug.cgi?id=1349138 "RESOLVED FIXED - Subclasses of nsITransaction shouldn't use raw reference to store EditorBase") |  | [Subclasses of nsITransaction shouldn't use raw reference to store EditorBase](/show_bug.cgi?id=1349138) | Core | DOM: Editor | masayuki | RESO | FIXE | 2018-02-01 |
| [1367850](/show_bug.cgi?id=1367850 "RESOLVED FIXED - REFTEST PROCESS-CRASH | http://10.252.73.233:33649/tests/dom/media/test/crashtests/1236639.html | application crashed [@ libc.so + 0x4027e]") |  | [REFTEST PROCESS-CRASH | http://10.252.73.233:33649/tests/dom/media/test/crashtests/1236639.html | application crashed [@ libc.so + 0x4027e]](/show_bug.cgi?id=1367850) | Firefox for Android | General | rbarker | RESO | FIXE | 2020-12-21 |
| [1353356](/show_bug.cgi?id=1353356 "RESOLVED FIXED - Assertion failure: aIndex < mLength, at dist/include/mozilla/Vector.h:533 with Debugger") |  | [Assertion failure: aIndex < mLength, at dist/include/mozilla/Vector.h:533 with Debugger](/show_bug.cgi?id=1353356) | Core | JavaScript Engine | shu | RESO | FIXE | 2018-02-01 |
| [1369836](/show_bug.cgi?id=1369836 "RESOLVED FIXED - heap-use-after-free in [@ mozilla::a11y::DocAccessible::UncacheChildrenInSubtree]") |  | [heap-use-after-free in [@ mozilla::a11y::DocAccessible::UncacheChildrenInSubtree]](/show_bug.cgi?id=1369836) | Core | Disability Access AP | surkov.alexander | RESO | FIXE | 2018-02-01 |
| [1273678](/show_bug.cgi?id=1273678 "RESOLVED FIXED - AddressSanitizer: heap-use-after-free on address in nssPKIObject_AddRef") |  | [AddressSanitizer: heap-use-after-free on address in nssPKIObject\_AddRef](/show_bug.cgi?id=1273678) | NSS | Libraries | ttaubert | RESO | FIXE | 2020-02-28 |
| [1353763](/show_bug.cgi?id=1353763 "VERIFIED FIXED - Crash [@ js::gc::IsInsideNursery]") |  | [Crash [@ js::gc::IsInsideNursery]](/show_bug.cgi?id=1353763) | Core | JavaScript Engine | mail | VERI | FIXE | 2023-12-06 |
| [1375435](/show_bug.cgi?id=1375435 "VERIFIED FIXED - Assertion failure: resumePointsEmpty(), at js/src/jit/MIRGraph.cpp:1092") |  | [Assertion failure: resumePointsEmpty(), at js/src/jit/MIRGraph.cpp:1092](/show_bug.cgi?id=1375435) | Core | JavaScript Engine | nicolas.b.pierron | VERI | FIXE | 2023-12-06 |

18 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=1353763%2C1353356%2C1370070%2C1375435%2C1373663%2C1363150%2C1370817%2C1273678%2C1367850%2C1347968%2C1361749%2C1349138%2C1371982%2C1344666%2C1369836%2C1330739%2C1371511%2C1371484&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |


