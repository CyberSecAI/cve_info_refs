Based on the provided information, here's an analysis of CVE-2017-7781:

**Root cause of vulnerability:**
The vulnerability stems from an incorrect implementation of the elliptic curve point addition algorithm using mixed Jacobian-affine coordinates within the Network Security Services (NSS) library. Specifically, the algorithm failed to handle a scenario where an intermediate value C could equal zero, which should have resulted in a point doubling operation, but instead incorrectly led to a POINT_AT_INFINITY result.

**Weaknesses/vulnerabilities present:**
- Incorrect elliptic curve point addition algorithm.
- Failure to account for a specific case in the algorithm where intermediate calculations resulted in zero.

**Impact of exploitation:**
- A man-in-the-middle (MITM) attacker could exploit this vulnerability to interfere with a connection using elliptic curve cryptography.
- This interference could result in the attacked party computing an incorrect shared secret. Although the attacker would not learn the correct secret, the connection could be compromised.

**Attack vectors:**
- Man-in-the-middle attack.
- Exploiting vulnerable elliptic curve point addition during key exchange.

**Required attacker capabilities/position:**
- Ability to intercept and modify network traffic during a connection setup involving elliptic curve cryptography.
-  Ability to manipulate the parameters of the key exchange such that the faulty case is triggered.

**Additional details:**
- The vulnerability exists in the `ec_GFp_pt_add_jm_aff` function within NSS.
- The incorrect algorithm was copied from a paper with incomplete formulas.
- The issue was also present in Java's native code for Elliptic Curve, as it was based on the same code base.
- The vulnerability was rated as sec-moderate due to the difficulty in triggering and exploiting it.
- The fix involves adding a check for the case where C=0 and performing a point doubling operation instead of incorrectly yielding point at infinity.
- The fix was included in NSS 3.31 and Firefox 55, and backported to Firefox ESR 52.3.
- Proof-of-concept code to trigger the vulnerability was made available by the reporter.