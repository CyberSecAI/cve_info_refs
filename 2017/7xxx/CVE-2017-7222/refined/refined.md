Based on the provided content, here's an analysis of CVE-2017-7222:

**Root cause of vulnerability:**
The `window_title` configuration option in MantisBT was not sanitized before being rendered in the HTML output. This allowed users with sufficient privileges to inject arbitrary HTML and JavaScript code.

**Weaknesses/vulnerabilities present:**
- **Cross-Site Scripting (XSS):** The primary vulnerability is a stored XSS. Malicious code injected into the `window_title` config could be executed in the browsers of other users viewing the page.
- **Lack of Input Sanitization:** The root cause is the failure to sanitize or encode the `window_title` config option.

**Impact of exploitation:**
- **Arbitrary code execution:** An attacker could inject JavaScript code that would execute in the context of the victim's browser. This could enable actions such as:
    - Stealing session cookies.
    - Redirecting the user to malicious sites.
    - Performing actions on behalf of the user.
    - Defacing the web page.
- **Image Injection:**  Even with Content Security Policy (CSP) enabled, an attacker can inject malicious images.

**Attack vectors:**
- **Configuration Modification:** An attacker needs to have sufficient access to modify the `window_title` configuration option, typically via the "Manage Configuration" section of the MantisBT interface.

**Required attacker capabilities/position:**
- **Trusted User/Administrative Access:** The attacker needs to be a trusted user with the ability to set the application configurations via the "Manage Configuration" section.

**Additional Notes:**
- **CSP Mitigation:** While the issue could be mitigated by using CSP,  it is noted that CSP can be disabled or may not be supported by older browsers. As such, the vulnerability is still considered a security issue.
- **Affected Versions:** The issue was introduced in MantisBT version 2.0.0-beta.1 and fixed in 2.1.1. It does not affect 1.3.x as the layout API was introduced in 2.x
- **Fix:** The fix involves sanitizing the `window_title` using the `string_display_line()` function to prevent code injection.