=== Content from bugs.ghostscript.com_ce0b9dbb_20250124_164937.html ===


Bugzilla – Bug 697762
Out of bounds write in mark\_line\_tr()
Last modified: 2017-04-25 09:36:27 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=697762&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=697762&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 697762**](show_bug.cgi?id=697762)
- Out of bounds write in mark\_line\_tr()

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Out of bounds write in mark\_line\_tr()

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Ghostscript | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Ghostscript "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Graphics Library ([show other bugs](buglist.cgi?component=Graphics%20Library&product=Ghostscript&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | master | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P1 normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Robin Watts | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-04-18 04:59 UTC by Kamil Frankowicz | | --- | --- | | Modified: | 2017-04-25 09:36 UTC ([History](show_activity.cgi?id=697762)) | | CC List: | 1 user (show)  peterkoczan | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Customer:](page.cgi?id=fields.html#cf_customer "A custom Free Text field in this installation of Bugzilla.") |  | | [Word Size:](page.cgi?id=fields.html#cf_wordsize "For example x86 would be 32 and x86_64 would be 64.") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**POC to trigger out of bounds write (gs)**](attachment.cgi?id=13585 "View the content of the attachment") (138 bytes, text/plain)  [2017-04-18 04:59 UTC](#attach_13585 "Go to the comment associated with the attachment"), Kamil Frankowicz | [Details](attachment.cgi?id=13585&action=edit) | | [**Second POC to trigger OOBW**](attachment.cgi?id=13586 "View the content of the attachment") (142 bytes, text/plain)  [2017-04-18 05:04 UTC](#attach_13586 "Go to the comment associated with the attachment"), Kamil Frankowicz | [Details](attachment.cgi?id=13586&action=edit) | | [Add an attachment](attachment.cgi?bugid=697762&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=697762&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=697762#c0)  Kamil Frankowicz    2017-04-18 04:59:41 UTC  ``` Created [attachment 13585](attachment.cgi?id=13585 "POC to trigger out of bounds write (gs)") [[details]](attachment.cgi?id=13585&action=edit "POC to trigger out of bounds write (gs)") POC to trigger out of bounds write (gs)  After some fuzz testing I found a crashing test case.  Git Head: [6d65aaa8af3a9f56c1828e7943c6e1c8b93cf614](http://www.ghostscript.com/cgi-bin/findgit.cgi?6d65aaa8af3a9f56c1828e7943c6e1c8b93cf614)  Command: gs -dNOPAUSE -sDEVICE=bit -sOUTPUTFILE=/dev/null -dSAFER gs_oobw_mark_line_tr -c quit  ASAN:  ==12630==ERROR: AddressSanitizer: SEGV on unknown address 0x62ff9d51ac60 (pc 0x00000191e7e7 bp 0x62a00027e010 sp 0x7ffc56ee1100 T0) ==12630==The signal is caused by a WRITE memory access.     #0 0x191e7e6 in mark_line_tr XYZ/ghostpdl/./base/gxscanc.c:2093:13     #1 0x191e295 in mark_curve_tr XYZ/ghostpdl/./base/gxscanc.c:2118:9     #2 0x191e205 in mark_curve_tr XYZ/ghostpdl/./base/gxscanc.c:2121:9     #3 0x191e205 in mark_curve_tr XYZ/ghostpdl/./base/gxscanc.c:2121:9     #4 0x191d146 in gx_scan_convert_tr XYZ/ghostpdl/./base/gxscanc.c:2196:21     #5 0x17a4773 in gx_general_fill_path XYZ/ghostpdl/./base/gxfill.c:482:24     #6 0x17a4773 in gx_default_fill_path XYZ/ghostpdl/./base/gxfill.c:702     #7 0x1837e21 in gx_fill_path XYZ/ghostpdl/./base/gxpaint.c:52:12     #8 0x1490499 in do_fill XYZ/ghostpdl/./base/gspaint.c:317:12     #9 0x1490499 in fill_with_rule XYZ/ghostpdl/./base/gspaint.c:351     #10 0x14c8b3c in gs_fapi_finish_render XYZ/ghostpdl/./base/gxfapi.c:1066:24     #11 0x14d321a in gs_fapi_do_char XYZ/ghostpdl/./base/gxfapi.c:1682:16     #12 0x1bc61de in FAPI_char XYZ/ghostpdl/./psi/zfapi.c:2358:13     #13 0x1a270fe in interp XYZ/ghostpdl/./psi/interp.c:1320:40     #14 0x1a270fe in gs_call_interp XYZ/ghostpdl/./psi/interp.c:517     #15 0x1a270fe in gs_interpret XYZ/ghostpdl/./psi/interp.c:474     #16 0x19f9de2 in gs_main_interpret XYZ/ghostpdl/./psi/imain.c:247:12     #17 0x19f9de2 in gs_main_run_string_end XYZ/ghostpdl/./psi/imain.c:665     #18 0x19f9de2 in gs_main_run_string_with_length XYZ/ghostpdl/./psi/imain.c:623     #19 0x1a05efe in run_string XYZ/ghostpdl/./psi/imainarg.c:978:16     #20 0x1a05efe in runarg XYZ/ghostpdl/./psi/imainarg.c:968     #21 0x1a05358 in argproc XYZ/ghostpdl/./psi/imainarg.c:901:16     #22 0x19fddc3 in gs_main_init_with_args XYZ/ghostpdl/./psi/imainarg.c:238:24     #23 0x547608 in main XYZ/ghostpdl/./psi/gs.c:96:16     #24 0x7f5bed87b82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)     #25 0x47ba38 in _start (/usr/local/bin/gs+0x47ba38)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV XYZ/ghostpdl/./base/gxscanc.c:2093:13 in mark_line_tr ==12630==ABORTING ```  [Comment 1](show_bug.cgi?id=697762#c1)  Kamil Frankowicz    2017-04-18 05:03:44 UTC  ``` I found another bug, but I think, the root cause is the same.  ASAN:  ==15589==ERROR: AddressSanitizer: SEGV on unknown address 0x62a24e9cdbb8 (pc 0x00000192a0b0 bp 0x000000000100 sp 0x7ffdc55f5100 T0) ==15589==The signal is caused by a WRITE memory access.     #0 0x192a0af in cursor_output_inrange_tr XYZ/ghostpdl/./base/gxscanc.c:2639:9     #1 0x192a0af in cursor_always_inrange_step_right_tr XYZ/ghostpdl/./base/gxscanc.c:2766     #2 0x192a0af in mark_line_tr_app XYZ/ghostpdl/./base/gxscanc.c:3131     #3 0x19240dc in mark_curve_tr_app XYZ/ghostpdl/./base/gxscanc.c:3426:13     #4 0x19240dc in mark_curve_tr_app XYZ/ghostpdl/./base/gxscanc.c:3426:13     #5 0x19240dc in mark_curve_tr_app XYZ/ghostpdl/./base/gxscanc.c:3426:13     #6 0x19240dc in mark_curve_tr_app XYZ/ghostpdl/./base/gxscanc.c:3426:13     #7 0x1920fa6 in gx_scan_convert_tr_app XYZ/ghostpdl/./base/gxscanc.c:3514:21     #8 0x17a468b in gx_general_fill_path XYZ/ghostpdl/./base/gxfill.c:499:24     #9 0x17a468b in gx_default_fill_path XYZ/ghostpdl/./base/gxfill.c:702     #10 0x1837e21 in gx_fill_path XYZ/ghostpdl/./base/gxpaint.c:52:12     #11 0x1490499 in do_fill XYZ/ghostpdl/./base/gspaint.c:317:12     #12 0x1490499 in fill_with_rule XYZ/ghostpdl/./base/gspaint.c:351     #13 0x1a270fe in interp XYZ/ghostpdl/./psi/interp.c:1320:40     #14 0x1a270fe in gs_call_interp XYZ/ghostpdl/./psi/interp.c:517     #15 0x1a270fe in gs_interpret XYZ/ghostpdl/./psi/interp.c:474     #16 0x19f9de2 in gs_main_interpret XYZ/ghostpdl/./psi/imain.c:247:12     #17 0x19f9de2 in gs_main_run_string_end XYZ/ghostpdl/./psi/imain.c:665     #18 0x19f9de2 in gs_main_run_string_with_length XYZ/ghostpdl/./psi/imain.c:623     #19 0x1a05efe in run_string XYZ/ghostpdl/./psi/imainarg.c:978:16     #20 0x1a05efe in runarg XYZ/ghostpdl/./psi/imainarg.c:968     #21 0x1a05358 in argproc XYZ/ghostpdl/./psi/imainarg.c:901:16     #22 0x19fddc3 in gs_main_init_with_args XYZ/ghostpdl/./psi/imainarg.c:238:24     #23 0x547608 in main XYZ/ghostpdl/./psi/gs.c:96:16     #24 0x7fd1c6cd582f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)     #25 0x47ba38 in _start (/usr/local/bin/gs+0x47ba38) ```  [Comment 2](show_bug.cgi?id=697762#c2)  Kamil Frankowicz    2017-04-18 05:04:22 UTC  ``` Created [attachment 13586](attachment.cgi?id=13586 "Second POC to trigger OOBW") [[details]](attachment.cgi?id=13586&action=edit "Second POC to trigger OOBW") Second POC to trigger OOBW ```  [Comment 3](show_bug.cgi?id=697762#c3)  Ken Sharp    2017-04-18 05:19:06 UTC  ``` Passing to Robin to deal with scan converter problems, making P1 for a seg fault.  Exhibits on a Windows 32-bit debug build as well. Looks like its caused by the monstrous scale factor (2000,80 x 20,80 x 20,80).  The second file has 300000 8 scale, so I'm reasonably sure its the same problem. ```  [Comment 4](show_bug.cgi?id=697762#c4)  Robin Watts    2017-04-18 05:21:09 UTC  ``` I can confirm the bug and reproduce it on windows. Thanks for the report.  I should point out that it's   -sOutputFile=  not   -sOUTPUTFILE=  gs is case sensitive in the arguments it is given. ```  [Comment 5](show_bug.cgi?id=697762#c5)  Robin Watts    2017-04-18 05:33:44 UTC  ``` (In reply to Robin Watts from [comment #4](show_bug.cgi?id=697762#c4)) > I can confirm the bug and reproduce it on windows. Thanks for the report. >  > I should point out that it's >  >  -sOutputFile= >  > not >  >  -sOUTPUTFILE= >  > gs is case sensitive in the arguments it is given.  Apparently we have an exception hardcoded to cope with -sOUTPUTFILE. Ick. ```  [Comment 6](show_bug.cgi?id=697762#c6)  Robin Watts    2017-04-19 04:36:00 UTC  ``` Fixed in:  commit [8210a2864372723b49c526e2b102fdc00c9c4699](http://www.ghostscript.com/cgi-bin/findgit.cgi?8210a2864372723b49c526e2b102fdc00c9c4699) Author: Robin Watts <robin.watts@artifex.com> Date:   Wed Apr 19 12:06:39 2017 +0100      [Bug 697762](show_bug.cgi?id=697762 "RESOLVED FIXED - Out of bounds write in mark_line_tr()"): Fix scan converter SEGVs.      The SEGVs are caused by the scan converter allowing less room     in the table than is actually required. This happens due to     the mark_curve subdivision overflowing.      For example, if we have a curve such as:       0 0x80000000 moveto      0 0x80000000 0 0x80000000 0 0x80000000 curveto      Then the current subdivision logic does:       fixed ay = (sy + c1y)>>1      For sy = c1y = 0x80000000 this gives ay = 0, when clearly     the average should be 0x80000000.      An alternative formulation of the splitting code:       fixed ay = (sy>>1) + (c1y>>1)      gives the required result, at the expense of dropping accuracy at     the low end.      This commit therefore has 2 formulations of the splitting code, one     for 'big' values (values that might overflow), and ones for normal     values (values that won't).      We select between the two pieces of code by comparing the top 2     bits of each value; if they differ, then we use the big variant.      Also, when calculating the size of the table required, we were     incorrectly closing the curve more often than we needed to. This     had no ill effect other than inflating the amount of memory we     needed.  Many thanks for the report. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=697762)
* - [XML](show_bug.cgi?ctype=xml&id=697762)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=697762)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=697762&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=697762&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from security.gentoo.org_469a05f5_20250124_164938.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# GPL Ghostscript: Multiple vulnerabilities — GLSA **201811-12**

Multiple vulnerabilities have been found in GPL Ghostscript, the
worst of which could result in the execution of arbitrary code.

### Affected packages

| Package | **app-text/ghostscript-gpl** on all architectures |
| --- | --- |
| Affected versions | < **9.26** |
| Unaffected versions | >= **9.26** |

### Background

Ghostscript is an interpreter for the PostScript language and for PDF.

### Description

Multiple vulnerabilities have been discovered in GPL Ghostscript. Please
review the CVE identifiers referenced below for additional information.

### Impact

A context-dependent attacker could entice a user to open a specially
crafted PostScript file or PDF document using GPL Ghostscript possibly
resulting in the execution of arbitrary code with the privileges of the
process, a Denial of Service condition, or other unspecified impacts,

### Workaround

There is no known workaround at this time.

### Resolution

All GPL Ghostscript users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-text/ghostscript-gpl-9.26"

```
### References

* [CVE-2017-11714](https://nvd.nist.gov/vuln/detail/CVE-2017-11714)
* [CVE-2017-7948](https://nvd.nist.gov/vuln/detail/CVE-2017-7948)
* [CVE-2017-9610](https://nvd.nist.gov/vuln/detail/CVE-2017-9610)
* [CVE-2017-9611](https://nvd.nist.gov/vuln/detail/CVE-2017-9611)
* [CVE-2017-9612](https://nvd.nist.gov/vuln/detail/CVE-2017-9612)
* [CVE-2017-9618](https://nvd.nist.gov/vuln/detail/CVE-2017-9618)
* [CVE-2017-9619](https://nvd.nist.gov/vuln/detail/CVE-2017-9619)
* [CVE-2017-9620](https://nvd.nist.gov/vuln/detail/CVE-2017-9620)
* [CVE-2017-9726](https://nvd.nist.gov/vuln/detail/CVE-2017-9726)
* [CVE-2017-9727](https://nvd.nist.gov/vuln/detail/CVE-2017-9727)
* [CVE-2017-9739](https://nvd.nist.gov/vuln/detail/CVE-2017-9739)
* [CVE-2017-9740](https://nvd.nist.gov/vuln/detail/CVE-2017-9740)
* [CVE-2017-9835](https://nvd.nist.gov/vuln/detail/CVE-2017-9835)
* [CVE-2018-10194](https://nvd.nist.gov/vuln/detail/CVE-2018-10194)
* [CVE-2018-15908](https://nvd.nist.gov/vuln/detail/CVE-2018-15908)
* [CVE-2018-15909](https://nvd.nist.gov/vuln/detail/CVE-2018-15909)
* [CVE-2018-15910](https://nvd.nist.gov/vuln/detail/CVE-2018-15910)
* [CVE-2018-15911](https://nvd.nist.gov/vuln/detail/CVE-2018-15911)
* [CVE-2018-16509](https://nvd.nist.gov/vuln/detail/CVE-2018-16509)
* [CVE-2018-16510](https://nvd.nist.gov/vuln/detail/CVE-2018-16510)
* [CVE-2018-16511](https://nvd.nist.gov/vuln/detail/CVE-2018-16511)
* [CVE-2018-16513](https://nvd.nist.gov/vuln/detail/CVE-2018-16513)
* [CVE-2018-16539](https://nvd.nist.gov/vuln/detail/CVE-2018-16539)
* [CVE-2018-16540](https://nvd.nist.gov/vuln/detail/CVE-2018-16540)
* [CVE-2018-16541](https://nvd.nist.gov/vuln/detail/CVE-2018-16541)
* [CVE-2018-16542](https://nvd.nist.gov/vuln/detail/CVE-2018-16542)
* [CVE-2018-16543](https://nvd.nist.gov/vuln/detail/CVE-2018-16543)
* [CVE-2018-16585](https://nvd.nist.gov/vuln/detail/CVE-2018-16585)
* [CVE-2018-16802](https://nvd.nist.gov/vuln/detail/CVE-2018-16802)
* [CVE-2018-18284](https://nvd.nist.gov/vuln/detail/CVE-2018-18284)
* [CVE-2018-19409](https://nvd.nist.gov/vuln/detail/CVE-2018-19409)

**Release date**

November 24, 2018

**Latest revision**

November 24, 2018: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [618820](https://bugs.gentoo.org/show_bug.cgi?id=618820)
* [626418](https://bugs.gentoo.org/show_bug.cgi?id=626418)
* [635426](https://bugs.gentoo.org/show_bug.cgi?id=635426)
* [655404](https://bugs.gentoo.org/show_bug.cgi?id=655404)
* [668846](https://bugs.gentoo.org/show_bug.cgi?id=668846)
* [671732](https://bugs.gentoo.org/show_bug.cgi?id=671732)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


