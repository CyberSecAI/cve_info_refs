```
{
  "vulnerability": {
    "cve_id": "CVE-2017-12061",
    "description": "An XSS issue was discovered in admin/install.php in MantisBT before 1.3.12 and 2.x before 2.5.2. Some variables under user control in the MantisBT installation script are not properly sanitized before being output, allowing remote attackers to inject arbitrary JavaScript code, as demonstrated by the $f_database, $f_db_username, and $f_admin_username variables. This is mitigated by the fact that the admin/ folder should be deleted after installation, and also prevented by CSP.",
    "root_cause": "The vulnerability is due to insufficient sanitization of user-controlled variables within the MantisBT installation script (admin/install.php) before outputting them in error messages.",
     "weaknesses": [
        "CWE-79"
      ],
    "impact": "A remote attacker can inject and execute arbitrary JavaScript code in the context of the victim's browser.",
    "attack_vector": "The attack vector is network-based, leveraging crafted HTTP requests to the vulnerable installation script.",
    "required_capabilities": "The attacker needs to be able to make HTTP requests to the vulnerable server. No authentication is required. The attacker needs to craft requests with malicious javascript payload via the `database_name`, `db_username` and/or `admin_username` parameters.",
    "additional_details": [
        "The vulnerability exists because the MantisBT installation script does not properly sanitize the $f_database, $f_db_username, and $f_admin_username variables before displaying them in error messages. These variables are under user control via HTTP GET parameters.",
        "The vulnerable code is within the admin/install.php file, specifically in the way it handles and displays error messages related to database connection during installation.",
        "The vulnerability is mitigated by the fact that the /admin directory should be removed after installation. Additionally, Content Security Policy (CSP) headers are supposed to prevent such kind of XSS although it was not effective in all scenarios.",
          "The issue is present in MantisBT versions 1.3.11 and earlier, as well as 2.5.1 and earlier.",
          "The vulnerability was addressed in versions 1.3.12, 2.5.2, and 2.6.0 of MantisBT.",
          "The fix involves sanitizing the database error message before output using `string_attribute()`",
          "The issue was reported by aLLy from ONSEC, and the fix was implemented by Damien Regad."
       ]
  }
}
```