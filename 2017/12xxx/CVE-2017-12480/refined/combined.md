=== Content from medium.com_b2ab82ba_20250124_194106.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F41ad0562f41&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fbayinmin.medium.com%2Fcve-2017-12480-sandboxie-installer-dll-hijacking-or-unsafe-dll-loading-vulnerability-41ad0562f41&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fbayinmin.medium.com%2Fcve-2017-12480-sandboxie-installer-dll-hijacking-or-unsafe-dll-loading-vulnerability-41ad0562f41&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# [CVE-2017–12480] Sandboxie installer — DLL Hijacking or Unsafe DLL Loading Vulnerability

[![Ba Yin Min](https://miro.medium.com/v2/resize:fill:88:88/1*Fesf1n6a-c6JrwJGmTLpYw.png)](/?source=post_page---byline--41ad0562f41--------------------------------)

[Ba Yin Min](/?source=post_page---byline--41ad0562f41--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbb90b160db7f&operation=register&redirect=https%3A%2F%2Fbayinmin.medium.com%2Fcve-2017-12480-sandboxie-installer-dll-hijacking-or-unsafe-dll-loading-vulnerability-41ad0562f41&user=Ba+Yin+Min&userId=bb90b160db7f&source=post_page-bb90b160db7f--byline--41ad0562f41---------------------post_header-----------)

1 min read·Aug 6, 2017

--

Listen

Share

# **1. Overview & Impact**

Sandboxie installer was vulnerable to DLL hijacking. The product did not verify the authenticity of the DLL file before loading thus a malicious individual or program may leverage this vulnerability to execute arbitrary code on the targeted machine.

# **2. Product Description**

**Sandboxie** — Sandbox security software for Windows. Install and run programs in a virtual sandbox environment without writing to the hard drive.

# 3. PROOF-OF-CONCEPT

1. Upon installation of affected exe file, the installer searched for non-existent **dwmapi.dll** and **profapi.dll** files from **C:\Users\<username>\AppData\Local\Temp** directory

**2.** To leverage this, created customised DLL shell code with arbitrary command ( eg. launching calc.exe) renamed as affected DLLs name and placed in the same directory

**3.** After placing the malicious DLL, clicked the installer again for installation. Subsequently, installer loaded these malicious DLLs file without verification and resulting in code execution.

4. Additionally, it was noted that **SandboxieInstall-64-bit-5071703.exe** was created in same affected directory when the main **SandboxieInstall.exe** was run. **SandboxieInstall-64-bit-5071703.exe was** similarly vulnerable to DLL hijacking.

**Affected DLL**

* dwmapi.dll,
* profapi.dll

# Version Affected

Tested in the following version:

* SandboxieInstall.exe for SandboxieInstall-64-bit-5071703.exe
* SandboxieInstall-64-bit-5071703.exe

# Credit

This vulnerability was discovered by Min Thu Han

# **Disclosure Timeline**

* 03–08–2017: Notified Vendor
* 03–08–2017: Vendor replied to post vulnerability report in publicly accessible Sandboxie forum
* 04–08–2017: Requested to MITRE for CVE
* 06–08–2017: Vulnerability disclosed
* 06–08–2017: Vulnerability report posted in Vendor forum
[Cve](https://medium.com/tag/cve?source=post_page-----41ad0562f41--------------------------------)[Dll Hijacking](https://medium.com/tag/dll-hijacking?source=post_page-----41ad0562f41--------------------------------)[Dll Preloading](https://medium.com/tag/dll-preloading?source=post_page-----41ad0562f41--------------------------------)[Disclosure](https://medium.com/tag/disclosure?source=post_page-----41ad0562f41--------------------------------)[Advisory](https://medium.com/tag/advisory?source=post_page-----41ad0562f41--------------------------------)

--

--

[![Ba Yin Min](https://miro.medium.com/v2/resize:fill:96:96/1*Fesf1n6a-c6JrwJGmTLpYw.png)](/?source=post_page---post_author_info--41ad0562f41--------------------------------)[![Ba Yin Min](https://miro.medium.com/v2/resize:fill:128:128/1*Fesf1n6a-c6JrwJGmTLpYw.png)](/?source=post_page---post_author_info--41ad0562f41--------------------------------)Follow[## Written by Ba Yin Min](/?source=post_page---post_author_info--41ad0562f41--------------------------------)[40 Followers](/followers?source=post_page---post_author_info--41ad0562f41--------------------------------)·[2 Following](/following?source=post_page---post_author_info--41ad0562f41--------------------------------)

Pentester. Application & Cyber Security enthusiast. Insatiable learner.

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----41ad0562f41--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----41ad0562f41--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----41ad0562f41--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----41ad0562f41--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----41ad0562f41--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----41ad0562f41--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----41ad0562f41--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----41ad0562f41--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----41ad0562f41--------------------------------)[Teams](https://medium.com/business?source=post_page-----41ad0562f41--------------------------------)


