- **Root cause of vulnerability:** The Sandboxie installer attempts to load specific DLL files (dwmapi.dll and profapi.dll) from the user's temporary directory (C:\Users\<username>\AppData\Local\Temp) without verifying their authenticity.
- **Weaknesses/vulnerabilities present:** DLL Hijacking or Unsafe DLL Loading. The installer searches for and loads DLLs from an insecure location without proper verification.
- **Impact of exploitation:** Arbitrary code execution. A malicious attacker can place specially crafted DLL files in the user's temporary directory, which will be loaded and executed by the vulnerable installer. This allows the attacker to run arbitrary code on the targeted machine with the privileges of the installer.
- **Attack vectors:** The attacker needs to place malicious DLL files (named dwmapi.dll and profapi.dll) into the userâ€™s temporary directory before the vulnerable installer is executed. When the installer runs it will load and execute these malicious DLLs.
- **Required attacker capabilities/position:** The attacker needs write access to the victim's user temp directory (C:\Users\<username>\AppData\Local\Temp) and the ability to trick the user into running the vulnerable installer after malicious DLLs are placed in the temp directory.