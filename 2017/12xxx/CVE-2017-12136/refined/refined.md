The provided content relates to CVE-2017-12136.

**Root cause of vulnerability:**
- The grant table code in Xen uses a semi-lockfree allocator for grant mappings (maptrack entries). This allocator contains a race condition that allows corruption of the free list.
- Specifically, when removing an entry from the free list, the code assumes that if the head item is not the tail, it will remain not the tail. However, another thread might remove and replace the entry, making it the tail by the time it's removed with cmpxchg.
- Also, a stolen entry is put back on the free list with an incorrect link field, which will corrupt the list.

**Weaknesses/vulnerabilities present:**
- Race condition in the maptrack free list handling within the grant table code.
- Incorrect link field assignment when returning a stolen entry to the free list.
- Lack of proper locking mechanisms in the allocator.

**Impact of exploitation:**
- A malicious guest administrator can crash the host.
- Privilege escalation to the host level is likely possible.

**Attack vectors:**
- Exploitation requires a malicious guest administrator.

**Required attacker capabilities/position:**
- The attacker needs to be a guest administrator on a vulnerable Xen hypervisor.
- The vulnerability is exploitable via local access from the guest.

**Additional details:**
- Vulnerable systems include Xen 4.6 and later. Xen 4.5 and earlier are not affected.
- There is no mitigation for this vulnerability other than patching.
- The vulnerability was discovered by Ian Jackson of Citrix.
- Patches are available for xen-unstable, Xen 4.9.x, Xen 4.8.x, Xen 4.7.x, and Xen 4.6.x
- The vulnerability is also referenced as XSA-228.