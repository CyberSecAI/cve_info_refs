- **Root cause of vulnerability:** The vulnerability lies in the lack of sanitization of the SSID string obtained from a Wi-Fi scan before it's used in a `sed` command. The `iwinfo` tool outputs the SSID without escaping, allowing an attacker to inject arbitrary characters, including newline characters, into the output that is then used in the `sed` command.
- **Weaknesses/vulnerabilities present:** Command Injection (CWE-77). The `sed` command is vulnerable to injection due to unsanitized input from the SSID.
- **Impact of exploitation:** An attacker can execute arbitrary `sed` commands, potentially leading to a denial of service (freezing the device). The provided proof of concept freezes the device on startup requiring manual power-cycling to recover.
- **Attack vectors:** The attacker sets up a malicious access point broadcasting a crafted SSID. The vulnerable device scans for nearby Wi-Fi networks and parses the crafted SSID when the malicious access point is detected.
- **Required attacker capabilities/position:** The attacker needs to be within Wi-Fi range of the vulnerable device and be able to create an access point with a malicious SSID.