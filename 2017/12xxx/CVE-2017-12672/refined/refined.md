- **Root cause of vulnerability:** A memory leak exists in the `ReadMATImage` function within the `coders/mat.c` file of ImageMagick.
- **Weaknesses/vulnerabilities present:** The `ReadMATImage` function fails to properly deallocate memory after use, leading to a memory leak. Specifically, memory allocated by `AcquireImage` and `AcquireImageInfo` during the processing of a crafted MAT file is not freed.
- **Impact of exploitation:** An attacker can cause a denial-of-service by repeatedly processing specially crafted MAT files. This will eventually exhaust the available memory and crash the application.
- **Attack vectors:** The attack vector is through a crafted MAT file that is processed by ImageMagick. This could occur via direct command-line processing using the `magick` utility, or via a program using the ImageMagick library to process images.
- **Required attacker capabilities/position:** The attacker needs to be able to provide a specially crafted MAT file to ImageMagick for processing. No specific user privilege is needed beyond the ability to execute the `magick` command or utilize a service that leverages the ImageMagick library. The attacker doesn't necessarily need direct access to the system but can also exploit the vulnerability remotely if the service is exposed.