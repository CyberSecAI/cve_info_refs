```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from incorrect handling of malformed image files, specifically within the `ReadOneMNGImage` function, where a crafted MNG file can cause out-of-bounds access to the `mng_info->x_off` array.",
    "weaknesses": [
      "Heap buffer overflow due to insufficient bounds checking in the processing of the MOVE chunk within MNG image files.",
      "Improper input sanitization, specifically in the handling of `first_object` and `last_object` parameters which are read directly from the file data and used to index an array.",
       "Insufficient validation of `i` index against `MNG_MAX_OBJECTS` before accessing `mng_info->x_off[i]`."
    ],
    "impact": "A crafted image file can cause a denial of service or potentially lead to arbitrary code execution with the privileges of the user invoking the program.",
    "attack_vectors": [
      "The primary attack vector is through the processing of a specially crafted image file, which contains a malicious MOVE chunk.",
      "An attacker could leverage a system or application that utilizes ImageMagick to open or process untrusted image files."
    ],
    "required_capabilities": "The attacker needs to provide a specially crafted image file that will be processed by ImageMagick."
  },
  "affected_versions": [
    "ImageMagick versions prior to the patched versions."
  ],
  "references": [
    "https://ubuntu.com/security/notices/USN-3681-1",
    "https://www.debian.org/security/2017/dsa-4019",
    "https://www.debian.org/security/2017/dsa-4040",
    "https://github.com/ImageMagick/ImageMagick/issues/542",
    "https://github.com/ImageMagick/ImageMagick/commit/307fa45d512641fcd105f0d57ca50c1437cd1b81"
  ]
}
```