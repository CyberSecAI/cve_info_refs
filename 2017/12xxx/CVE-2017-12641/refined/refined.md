The provided content relates to CVE-2017-12641.

**Root cause of vulnerability:**
The vulnerability is due to a memory leak in the `ReadOneJNGImage` function within the `png.c` file of ImageMagick. The issue arises when processing JNG images, leading to memory not being freed. Specifically, the code was missing the cleanup of `color_image` and `color_image_info` in case of a `CorruptImage` error.

**Weaknesses/vulnerabilities present:**
- Memory Leak: The primary vulnerability is a memory leak. The function allocates memory for image processing, and under specific error conditions such as "CorruptImage", this memory is not freed, resulting in a leak.

**Impact of exploitation:**
- Repeated processing of crafted JNG images can exhaust available memory, leading to denial of service (DoS) conditions or instability of the application.

**Attack vectors:**
- Malicious image files: An attacker could craft a JNG image file designed to trigger the memory leak. This file could then be processed by an application using ImageMagick, leading to resource exhaustion.

**Required attacker capabilities/position:**
- The attacker needs the ability to make the target application process a crafted malicious JNG image. This might involve uploading the image to a server, or sending the image to a program via email attachment or any other input method.
- The attacker does not need to be local to the vulnerable machine.

**Additional Details:**
- The provided github issue and commit log details the following:
    - The memory leak was detected using AddressSanitizer.
    - The leak happens in the function `ReadOneJNGImage` in `png.c`.
    - The leak occurs during error handling where `color_image` and `color_image_info` are not cleaned up upon a `CorruptImage` error.
    - The fix commits a cleanup for `color_image` and `color_image_info` if these exist before throwing the `CorruptImage` error.
    - A test case that triggers the leak is provided.