Based on the provided information, here's a breakdown of the vulnerability described by CVE-2017-12137:

**Root Cause of Vulnerability:**

*   The vulnerability lies in the way Xen handles mapping grant references for Paravirtualized (PV) guests on x86 systems. When a PV guest requests a grant to be mapped, it provides either a linear address or an L1 pagetable entry where the grant should be mapped.
*   The code path handling direct nomination of an L1 pagetable entry lacks proper alignment checks on the provided parameter.

**Weaknesses/Vulnerabilities Present:**

*   **Incorrect Alignment Handling:** The primary weakness is the failure to validate the alignment of the provided L1 pagetable entry.
*   **Pagetable Corruption:** Due to the missing alignment check, Xen makes an incorrectly aligned update to a page table entry.
*   **Heap Corruption:** This misaligned update corrupts the intended entry and the subsequent entry. If the misaligned value crosses a page boundary, an arbitrary heap page can be corrupted with guest controlled values.

**Impact of Exploitation:**

*   **Privilege Escalation:** A PV guest can exploit this vulnerability to elevate its privileges to that of the host system (hypervisor).
*   **Arbitrary Code Execution:** Through the corruption of memory, it becomes possible to execute arbitrary code.

**Attack Vectors:**

*   A malicious PV guest can trigger the vulnerability by providing a misaligned address when requesting a grant mapping using the direct L1 entry path.
*   The vulnerability can be exposed to HVM guests which are served by a PV stub qemu, as HVM guests are assumed to be able to compromise the PV stub QEMU process.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to control a PV guest running on the vulnerable Xen hypervisor.
*   The attacker needs to be able to provide inputs to Xen that specify the location for the grant mapping.

**Additional Details:**

*   **Affected Systems:** All versions of Xen on x86 systems are vulnerable.
*   **Mitigation:** Running only HVM guests, served by a dom0-based qemu, can avoid this vulnerability.
*   **Resolution:** The issue is resolved by applying a patch to the Xen hypervisor that enforces proper alignment checks.

This information provides more technical details than the basic CVE description, which simply states "incorrect validation of grants may result in privilege escalation." The additional details explain the specific mechanism of the vulnerability and its impact more clearly.