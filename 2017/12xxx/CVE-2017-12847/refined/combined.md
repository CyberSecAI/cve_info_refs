=== Content from github.com_9a15f93c_20250124_202812.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fcommit%2F3baffa78bafebbbdf9f448890ba5a952ea2d73cb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fcommit%2F3baffa78bafebbbdf9f448890ba5a952ea2d73cb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=NagiosEnterprises%2Fnagioscore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NagiosEnterprises](/NagiosEnterprises)
/
**[nagioscore](/NagiosEnterprises/nagioscore)**
Public

* [Notifications](/login?return_to=%2FNagiosEnterprises%2Fnagioscore) You must be signed in to change notification settings
* [Fork
  452](/login?return_to=%2FNagiosEnterprises%2Fnagioscore)
* [Star
   1.6k](/login?return_to=%2FNagiosEnterprises%2Fnagioscore)

* [Code](/NagiosEnterprises/nagioscore)
* [Issues
  186](/NagiosEnterprises/nagioscore/issues)
* [Pull requests
  4](/NagiosEnterprises/nagioscore/pulls)
* [Actions](/NagiosEnterprises/nagioscore/actions)
* [Projects
  0](/NagiosEnterprises/nagioscore/projects)
* [Security](/NagiosEnterprises/nagioscore/security)
* [Insights](/NagiosEnterprises/nagioscore/pulse)

Additional navigation options

* [Code](/NagiosEnterprises/nagioscore)
* [Issues](/NagiosEnterprises/nagioscore/issues)
* [Pull requests](/NagiosEnterprises/nagioscore/pulls)
* [Actions](/NagiosEnterprises/nagioscore/actions)
* [Projects](/NagiosEnterprises/nagioscore/projects)
* [Security](/NagiosEnterprises/nagioscore/security)
* [Insights](/NagiosEnterprises/nagioscore/pulse)

## Commit

[Permalink](/NagiosEnterprises/nagioscore/commit/3baffa78bafebbbdf9f448890ba5a952ea2d73cb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

configure.ac: use /run/nagios.lock as the default lockfile path.

[Browse files](/NagiosEnterprises/nagioscore/tree/3baffa78bafebbbdf9f448890ba5a952ea2d73cb)
Browse the repository at this point in the history

```
The previous default path for the lockfile was located in
$localstatedir, which is generally writable by the nagios user. That
presents a security risk, since the nagios user can delete the
lockfile and replace it with another file containing the PID of a
root-owned process. This commit changes the default lockfile path to
/run/nagios.lock, and completes the fix for Github issue [#404](https://github.com/NagiosEnterprises/nagioscore/issues/404).
```

* Loading branch information

[![@orlitzky](https://avatars.githubusercontent.com/u/1432135?s=40&v=4)](/orlitzky)

[orlitzky](/NagiosEnterprises/nagioscore/commits?author=orlitzky "View all commits by orlitzky")
committed
Aug 5, 2017

1 parent
[9f5e955](/NagiosEnterprises/nagioscore/commit/9f5e9551f8b9530b1950cbfc28990e2cd1e5bc9a)

commit 3baffa7

Showing
**1 changed file**
with
**2 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[configure.ac](#diff-49473dca262eeab3b4a43002adb08b4db31020d190caaad1594b47f1d5daa810 "configure.ac")

Show comments

[View file](/NagiosEnterprises/nagioscore/blob/3baffa78bafebbbdf9f448890ba5a952ea2d73cb/configure.ac)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -267,9 +267,9 @@ AC\_SUBST(init\_dir) |
|  |  | dnl User can override lock file location |
|  |  | AC\_ARG\_WITH(lockfile, |
|  |  | AC\_HELP\_STRING([--with-lockfile=<path>], |
|  |  | [sets path and file name for lock file]), |
|  |  | [sets path for lock file (default: /run/nagios.lock)]), |
|  |  | lockfile=$withval, |
|  |  | lockfile=$localstatedir/nagios.lock |
|  |  | lockfile=/run/nagios.lock |
|  |  | ) |
|  |  | AC\_SUBST(lockfile) |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3baffa7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fcommit%2F3baffa78bafebbbdf9f448890ba5a952ea2d73cb) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_536592e3_20250124_202813.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fissues%2F404)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fissues%2F404)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=NagiosEnterprises%2Fnagioscore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NagiosEnterprises](/NagiosEnterprises)
/
**[nagioscore](/NagiosEnterprises/nagioscore)**
Public

* [Notifications](/login?return_to=%2FNagiosEnterprises%2Fnagioscore) You must be signed in to change notification settings
* [Fork
  452](/login?return_to=%2FNagiosEnterprises%2Fnagioscore)
* [Star
   1.6k](/login?return_to=%2FNagiosEnterprises%2Fnagioscore)

* [Code](/NagiosEnterprises/nagioscore)
* [Issues
  186](/NagiosEnterprises/nagioscore/issues)
* [Pull requests
  4](/NagiosEnterprises/nagioscore/pulls)
* [Actions](/NagiosEnterprises/nagioscore/actions)
* [Projects
  0](/NagiosEnterprises/nagioscore/projects)
* [Security](/NagiosEnterprises/nagioscore/security)
* [Insights](/NagiosEnterprises/nagioscore/pulse)

Additional navigation options

* [Code](/NagiosEnterprises/nagioscore)
* [Issues](/NagiosEnterprises/nagioscore/issues)
* [Pull requests](/NagiosEnterprises/nagioscore/pulls)
* [Actions](/NagiosEnterprises/nagioscore/actions)
* [Projects](/NagiosEnterprises/nagioscore/projects)
* [Security](/NagiosEnterprises/nagioscore/security)
* [Insights](/NagiosEnterprises/nagioscore/pulse)

# nagios daemon should create its PID file before dropping privileges #404

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[nagios daemon should create its PID file before dropping privileges](#top)#404Copy linkAssignees [![hedenface](https://avatars.githubusercontent.com/u/16650353?s=64&u=ffebb3538cffb0239cdbce2c663aeeac72b28e3c&v=4)](/hedenface)Labels[Enhancement](https://github.com/NagiosEnterprises/nagioscore/issues?q=state%3Aopen%20label%3A%22Enhancement%22)[Need Review](https://github.com/NagiosEnterprises/nagioscore/issues?q=state%3Aopen%20label%3A%22Need%20Review%22)Milestone[4.3.3](https://github.com/NagiosEnterprises/nagioscore/milestone/7)[![@orlitzky](https://avatars.githubusercontent.com/u/1432135?v=4&size=80)](/orlitzky)
## Description

[![@orlitzky](https://avatars.githubusercontent.com/u/1432135?v=4&size=48)](/orlitzky)[orlitzky](https://github.com/orlitzky)opened [on Jul 28, 2017](https://github.com/NagiosEnterprises/nagioscore/issues/404#issue-246453575)

**Summary**

The nagios daemon should create its PID file before dropping

privileges. This represents a minor security issue; additional factors

are needed to make it exploitable.

**Description**

The purpose of the PID file is to hold the PID of the running daemon,

so that later it can be stopped, restarted, or otherwise signalled

(many daemons reload their configurations in response to a SIGHUP).

To fulfill that purpose, the contents of the PID file need to be

trustworthy. If the PID file is writable by a non-root user, then he

can replace its contents with the PID of a root process. Afterwards,

any attempt to signal the PID contained in the PID file will instead

signal a root process chosen by the non-root user (a vulnerability).

This is commonly exploitable by init scripts that are run as root and

which blindly trust the contents of their PID files. If one daemon

flushes its cache in response to SIGUSR2 and another daemon drops all

connections in response to SIGUSR2, it is not hard to imagine a

denial-of-service by the user of the first daemon against the second.

**Exploitation**

There is only a risk of exploitation when some other user relies on

the data in the PID file. But you have to wonder, what's the point of

the PID file if not to provide the PID to other people? Any situation

where the PID file is used is therefore suspicious.

The init script `daemon-init.in` that ships with nagios itself relies on the PID file to

e.g. reload the nagios configuration.

## Metadata

### Assignees

* [![@hedenface](https://avatars.githubusercontent.com/u/16650353?s=64&u=ffebb3538cffb0239cdbce2c663aeeac72b28e3c&v=4)hedenface](/hedenface)
### Labels

[Enhancement](https://github.com/NagiosEnterprises/nagioscore/issues?q=state%3Aopen%20label%3A%22Enhancement%22)[Need Review](https://github.com/NagiosEnterprises/nagioscore/issues?q=state%3Aopen%20label%3A%22Need%20Review%22)
### Type

No type
### Projects

No projects
### Milestone

* [4.3.3](https://github.com/NagiosEnterprises/nagioscore/milestone/7)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_41e44fcf_20250124_202810.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fblob%2Fmaster%2FChangelog)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fblob%2Fmaster%2FChangelog)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=NagiosEnterprises%2Fnagioscore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NagiosEnterprises](/NagiosEnterprises)
/
**[nagioscore](/NagiosEnterprises/nagioscore)**
Public

* [Notifications](/login?return_to=%2FNagiosEnterprises%2Fnagioscore) You must be signed in to change notification settings
* [Fork
  452](/login?return_to=%2FNagiosEnterprises%2Fnagioscore)
* [Star
   1.6k](/login?return_to=%2FNagiosEnterprises%2Fnagioscore)

* [Code](/NagiosEnterprises/nagioscore)
* [Issues
  186](/NagiosEnterprises/nagioscore/issues)
* [Pull requests
  4](/NagiosEnterprises/nagioscore/pulls)
* [Actions](/NagiosEnterprises/nagioscore/actions)
* [Projects
  0](/NagiosEnterprises/nagioscore/projects)
* [Security](/NagiosEnterprises/nagioscore/security)
* [Insights](/NagiosEnterprises/nagioscore/pulse)

Additional navigation options

* [Code](/NagiosEnterprises/nagioscore)
* [Issues](/NagiosEnterprises/nagioscore/issues)
* [Pull requests](/NagiosEnterprises/nagioscore/pulls)
* [Actions](/NagiosEnterprises/nagioscore/actions)
* [Projects](/NagiosEnterprises/nagioscore/projects)
* [Security](/NagiosEnterprises/nagioscore/security)
* [Insights](/NagiosEnterprises/nagioscore/pulse)

## Files

 master
## Breadcrumbs

1. [nagioscore](/NagiosEnterprises/nagioscore/tree/master)
/
# Changelog

Copy path Blame  Blame
## Latest commit

## History

[History](/NagiosEnterprises/nagioscore/commits/master/Changelog)662 lines (583 loc) · 37.3 KB master
## Breadcrumbs

1. [nagioscore](/NagiosEnterprises/nagioscore/tree/master)
/
# Changelog

Top
## File metadata and controls

* Code
* Blame

662 lines (583 loc) · 37.3 KB[Raw](https://github.com/NagiosEnterprises/nagioscore/raw/refs/heads/master/Changelog)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662########################Nagios Core 4 Change Log########################
4.5.10 - 2025-XX-XX-------------------\* Update quickstart and documentations links (Aaron Cieslicki)
4.5.9 - 2024-12-19------------------\* Fix unreachable notifications (Dylan Anderson)\* Add light option in new exfoliation theme (Dylan Anderson)\* Fix authentication in trends.cgi (Dylan Anderson)
4.5.8 - 2024-11-19------------------\* Improve new exfoliation theme and add back in PID information (Dylan Anderson)\* Fix issues with downtimes that are both flexible and triggered and improve downtime additions in general (#595) (Dylan Anderson)
4.5.7 - 2024-10-24------------------\* Expand the custom variable macros to an empty string, if the custom variable does not exist (Andre Klärner)\* Fix notification logic to not send a notification if a host and services parents are down (#873) (Dylan Anderson)\* Update Exfoliation theme (Dylan Anderson)
4.5.6 - 2024-10-08------------------\* Send a recovery notification if the object recovered while flapping (#847) (Dylan Anderson)\* Fix for separate build directory & a couple small cleanups (Doug Nazar)\* Update tutorial links in Readme (Igor Udot)
4.5.5 - 2024-09-17------------------\* Update configure scripts using newer versions of autotools (Dylan Anderson)\* Disable maintainer mode for TAP testing and add Github Actions (Dylan Anderson)
4.5.4 - 2024-08-14------------------\* Fix inconsistent links for 'View {Trends,Alert Histogram} For This {Host,Service}' (Mauricio Faria de Oliveira)\* Fix broken links from removing AngularJS pages in 4.5.3 (Dylan Anderson)
4.5.3 - 2024-06-11 ------------------\* Update jQuery (#960) (Dylan Anderson) \* Remove pages using outdated AngularJS framework (#960) (Dylan Anderson)\* Fix html encoding of some ascii characters (#813) (Dylan Anderson)\* Updated several page links to use 'nofollow' (#965) - (Griffin Westerman)
4.5.2 - 2024-04-30------------------\* Fix handling of timeperiods w/ downtime availability calculations in the Availability CGI report (Sebastian Wolf)\* Fix build when compiling against musl libc (#952) (Sebastian Wolf)\* Fix downtime comment using current time instead of the downtime's entry time (#910) (Dylan Anderson)
4.5.1 - 2024-02-28-------------------\* Fix text rendering in Configuration -> Command Expansion when the command ends in whitespace (Thanks Joran LEREEC for reporting this issue) (Dylan Anderson)
4.5.0 - 2023-11-16-------------------Note: this release is backward-compatible, but does include updates to the header files.If you are using any NEB modules in your monitoring solution, you will need to recompile them with the new nagios-4.5.0 headers to avoid segmentation faults.ENHANCEMENTS\* Add event\_handler\_period configuration option to hosts and services (#913) (Dylan Anderson)\* Add external commands CHANGE\_HOST\_EVENT\_HANDLER\_TIMEPERIOD and CHANGE\_SVC\_EVENT\_HANDLER\_TIMEPERIOD (#913) (Dylan Anderson)\* Added support for separating your build directory from your source directory (#867) (Doug Nazar)
4.4.14 - 2023-08-01-------------------\* Fix missing macros when running performance data commands (#904) (Doug Nazar)
4.4.13 - 2023-06-01-------------------FIXES\* Fix broken logo images in status pages (regression from 4.4.12) (#917) (Harbie34)
4.4.12 - 2023-05-30-------------------FIXES\* Clean up most compiler warnings on GCC and clang (#901) (Doug Nazar)\* Fix incorrect HTML entity escaping in CGIs (#907, #902) (Doug Nazar, Sebastian Wolf)\* Fix issue where predictive dependency checks were not being scheduled for services (#908) (Sebastian Wolf)\* Fix several typos (#898, #884) (Harbie34, Josh Soref)
4.4.11 - 2023-04-14-------------------FIXES\* Fix incorrect error message in preflight check (#865) (Andre Klärner)\* Fix use-after-free in qh\_deregister\_handler (#866) (Doug Nazar)\* Fix memory leak in qh\_deregister\_handler (#866) (Doug Nazar)\* Fix mismatched host/service behavior when changing from SOFT to HARD state (#891) (Sebastian Wolf)\* Minor performance improvements in CGI utility functions (#866) (Doug Nazar)
4.4.10 - 2023-01-17-------------------FIXES\* Fix memory leak in nagiostats.c when using -c, -s, -d, or -D multiple times (#888) (ggvl)\* Improve service scheduling at startup (#887) (anetyn)\* Improve compilation/reduce warnings when using Clang 16 (#889) (Sam James)\* Improve compilation on other, stricter C99 compilers (#890) (Florian Weimer)
4.4.9 - 2022-11-16------------------FIXES\* Fixed check\_attempts remaining high during a HARD service recovery (#837) (Sebastian Wolf)\* Fixed memory leak in NERD (#872) (ggvl)
4.4.8 - 2022-10-04------------------FIXES\* Minor interface updates\* Fixed crash when checking for updates using SSL (Doug Nazar)
4.4.7 - 2022-04-14------------------FIXES\* Fixed checkboxes in jsonquery.html (#778) (Rfferrao87)\* Added SSL support for version update check (Sebastian Wolf)\* Note: NEB modules using the priority/scheduling queues in libnagios may need to update headers due to symbol conflicts with OpenSSL.\* Fixed XSS in homepage when displaying update check results (Sebastian Wolf)\* Fixed allocation error in getcgi.c (#820) (Ariadne Conill)\* Fixed Error: NULL variable for lines of spaces in resource.cfg (#814) (Ralf Herrmann)\* Fixed crash when handling large check output (#825, #828) (Kilvador)\* Update packaging instructions for RPM/EPEL (#850) (T.J. Yang)\* Include packaging instructions for DEB (#842) (Catfriend1)\* Fixed CGI object processing when names end in \ (#819) (Sebastian Wolf)\* $SERVICEPROBLEMID$ now accessible when notifications are sent (#688) (Sebastian Wolf)
4.4.6 - 2020-04-28------------------FIXES\* Fixed Map display in Internet Explorer 11 (#714) (Scott Wilkerson)\* Fixed duplicate properties appearing in statusjson.cgi (#718) (Sebastian Wolf)\* Fixed NERD not building when enabled in ./configure (#723) (Sebastian Wolf)\* Fixed build process when using GCC 10 (#721) (Michael Orlitzky)\* Fixed postauth vulnerabilities in histogram.js, map.js, trends.js (CVE-2020-13977) (Thanks UraSec Team) (Sebastian Wolf)\* When using systemd, configuration will be verified before reloading (#715) (tatref)\* Fixed HARD OK states triggering on the maximum check attempt (#757) (Sebastian Wolf)
4.4.5 - 2019-08-20------------------FIXES\* Reverted changes related to #625 due to CPU load issues\* Partially reverted changes for #647 due to CPU load issues\* Fixed "Quick Search" so that leading/trailing whitespace doesn't affect output (#681) (Sebastian Wolf)\* Fixed build issues on non-RPM-based platforms (#617) (T.J. Yang)
4.4.4 - 2019-07-29------------------FIXES\* Fixed log rotation logic to not repeatedly schedule rotation on a DST change (#610, #626) (Jaroslav Jindrak & Sebastian Wolf)\* Fixed $SERVICEPROBLEMID$ to be reset after service recovery (#621) (Sebastian Wolf)\* Fixed defunct worker processes appearing after nagios was reloaded (#441, #620) (Sebastian Wolf)\* Fixed main nagios thread to release nagios.qh on a closed connection (#635) (Sebastian Wolf)\* Fixed semicolon escaping to remove prepended backslash (\) (#643) (Sebastian Wolf)\* Fixed 'Checks of this host have been disabled' message showing on passive-only hosts (#632) (Vojtěch Širůček & Sebastian Wolf)\* Fixed last\_hard\_state showing the current hard state when service status is brokered (#633) (Sebastian Wolf)\* Fixed long plugin output (>8KB) occasionally getting truncated (#625) (Sebastian Wolf)\* Fixed check scheduling for objects with large check\_intervals and small timeperiods (#647) (Sebastian Wolf)\* Fixed SOFT recoveries sending when services had HARD recovery some time after host recovery (#651) (Sebastian Wolf)\* Fixed incorrect permissions on debugging builds of FreeBSD (#420) (Sebastian Wolf)\* Fixed NEB callback lists being partially orphaned when multiple modules subscribe to one callback (#590) (Sebastian Wolf)\* Fixed memory leaks in run\_async\_service\_check(), run\_async\_host\_check() when checks are brokered (#664) (Sebastian Wolf)\* Fixed potential XSS in main.php, map.php (#671, #672) (Jak Gibb)\* Removed NEB brokering for nagios daemonization, since daemonization occurs before NEB initialization (#591) (Sebastian Wolf)
4.4.3 - 2019-01-15------------------FIXES\* Fixed services sending recovery emails when they recover if host in down state (#572) (Scott Wilkerson)\* Fixed a make error when building on the aarch64 architecture (#598) (Gareth Randall)\* Fixed --with-cgibindir and --with-webdir to actually set values given (#585) (lawsontyler)\* Fixed soft recovery states for services (#575) (Jake Omann)\* Fixed XSS vulnerability in Alert Summary report (CVE-2018-18245) (Jake Omann)\* Fixed services in soft states sometimes not switching into hard states (#576) (Jake Omann)\* Fixed last\_state\_change to update when a state goes from soft -> hard state (#592) (Jake Omann)\* Fixed Map link always being set to undefined host and don't show link for Nagios Process root note (#539) (Jake Omann)\* Fixed notifications sending when services went into hard state on a down or unreachable host (#584) (Jake Omann)\* Fixed log\_host\_retries not logging the host soft state checks (#599) (Jake Omann)\* Fixed stalking\_options N option to properly log only when a notification is actually sent (#604) (Jake Omann)\* Fixed issue with service status totals being zero when servicegroup=all on servicegroup status page (#579) (Jake Omann)\* Fixed escalation notifications logic and recovery notifications not going out (#582) (Jake Omann)\* Fixed not finding child index causing duplicate hosts showing in the Map (#471) (Jake Omann)\* Fixed Map configuration popup checkboxes not working and Root Node not populating (#543) (Jake Omann)\* Fixed cleanup and deinit of neb modules on reload (#573) (Jake Omann)
4.4.2 - 2018-08-16------------------FIXES\* Fix comment data being duplicated after a `service nagios reload` or similar (#549) (Bryan Heden)\* Fix check\_interval and retry\_interval not changing at the appropriate times (#551) (Scott Wilkerson)\* Fixed passive checks sending recovery email when host was previously UP (#552) (Scott Wilkerson)\* Fixed flapping comments duplication on nagios reload (#554) (Christian Jung)\* Fix for CVE-2018-13441, CVE-2018-13458, CVE-2018-13457 null pointer dereference (Trevor McDonald)\* Fixed syntax error in file: default-init.in (#558) (ccztux)\* Reset current notification number and state flags when the host recovers, reset all service variables when they recover fixes (#557) (Scott Wilkerson)\* Fixed wrong counting of service status totals when showing servicegroup details (#548) (ccztux, Bryan Heden)\* Fixed avail.cgi not printing CSV output when checkbox is checked (for any type: host/service/hostgroup/servicegroup) (#570) (Bryan Heden)\* Fixed nagios not logging SOFT state changes after 1 (Scott Wilkerson)
4.4.1 - 2018-06-25------------------FIXES\* Revert some macro->kvvec changes causing problems when `enable\_environment\_macros` was enabled (Bryan Heden)\* Adjust `process\_macro\_r` function logic so that it handles macros properly (Bryan Heden)\* Fix spec file for systemd (Karsten Weiss, Fr3dY, Bryan Heden)\* Fix bug where `ssize\_t` typedef to int on some systems (Bryan Heden)
4.4.0 - 2018-06-19------------------ENHANCEMENTS\* new status for check dependencies (John Frickson)\* Allow more flexible requirements for comments (John Frickson)\* Add a `statusCRITICALACK` class for the status column (John Frickson)\* CSV output based on groups (all options) (John Frickson)\* New Macro(s) to generate URL for host / service object to be used in notifications (John Frickson)\* New Macro(s) to determine if host/service notifications are enabled (#419) (Bryan Heden)\* New Macro(s) for obtaining the host/service notification periods (#350) (Bryan Heden)\* enable\_page\_tour interface option (Bryan Heden)\* Code cleanups in important sections (Workers, Handling Results) (Bryan Heden)\* Automatic mail program detection (with same /bin/mail failback) (Bryan Heden)\* Incorporated [autoconf-macros](https://github.com/NagiosEnterprises/autoconf-macros) into Core (Bryan Heden)\* Lots of enhancements/additions to configure/make process. (Bryan Heden) \* Moved all files to startup/ \* Added upstart job\* Added system limit detection (RLIMIT\_NPROC) to check for anticipated fork() failures (#434) (Bryan Heden)\* Added stalking on notifications (`N` or `notifications` option when specifying `stalking\_options`) (#342) (Bryan Heden)\* Added automatic `systemctl daemon-reload` and `initctl reload-configuration` where applicable on `make install-init` (Bryan Heden)\* Added case-insensitive command submission. (#373) (Bryan Heden)\* Enabled `check\_external\_commands` by default (Bryan Heden)
FIXES\* Command line macro detection skips potential macros with no ending dollar sign (Bryan Heden, Jake Omann)\* Fixed a lockup condition sometimes encountered on shutdown or restart (Aaron Beck)\* Fixed negative time offset calculations computing incorrectly sometimes (bbeutel)\* Fixed reloads causing defunct (zombie) processes (#441) (Bryan Heden)\* Fixed wait3(), wait4() implementations (replaced with waitpid()) (#326) (Bryan Heden)\* Fixed additive inheritance not testing for duplicates in hosts/services/(+escalations) (#392) (Bryan Heden)\* Fixed very very (around 600k chars or greater) large plugin output crashing Nagios (#432) (Bryan Heden)\* Fixed first\_notification\_delay not beeing calculated from last\_hard\_state\_change (#425) (ccztux)\* Fixed duplicate downtime ID occurring from downtimes in retention file (#506) (Franz [feisenko])\* Fixed segfault when navbarsearch was used in status.cgi for something other than a host (#489) (Bryan Heden)\* Fixed some miscellaneous ./configure issues on Solaris (Bryan Heden, Troy Lea)\* Fixed "Locate host on map" link (#496) (Troy Lea)\* Fixed service groups defined with unknown service members (that aren't first in the list) not erroring out (#500) (Bryan Heden)\* Fixed tac.cgi to have consistent behavior with the other cgis (#481) (Bryan Heden, Matt Capra)\* Fixed clear\_host/service\_flapping command logic to broker/notify properly (#525) (Bryan Heden, Karsten Weiss)
4.3.4 - 2017-08-24------------------\* Improved config file parsing (Mark Felder)\* Fixed configure script to check for existence of /run for lock file (in regards to CVE-2017-12847, Bryan Heden)\* Use absolute paths when deleting check results files (Emmanuel Dreyfus)\* Add sanity checking in reassign\_worker (sq5bpf)
4.3.3 - 2017-08-12------------------\* xodtemplate.c wrong option-deprecation code warning (alex2grad / John Frickson)\* On-demand host check always use cached host state (John Frickson)\* 'á' causes Service Status Information to not be displayed (John Frickson)\* New Macro(s) to generate URL for host / service object (John Frickson)\* Fix minor map issues (Troy Lea)\* Fix lockfile issues (Bryan Heden)\* Switch order of daemon\_init and drop\_privileges (CVE-2017-12847, Bryan Heden)\* Add an OpenRC init script (Michael Orlitzky)
4.3.2 - 2017-05-09------------------FIXES\* Every 15sec /var/log/messages is flooded with "nagios: set\_environment\_var" (John Frickson)\* Changed release date to ISO format (yyyy-mm-dd) (John Frickson)\* `make all` fails if unzip is not installed (John Frickson)\* Quick Search no longer allows search by Alias (John Frickson)\* flexible downtime on a service immediately turns off notifications (John Frickson)\* Fix to allow url\_encode to be called twice (Z. Liu)\* Update timeperiods.cfg.in (spelling) (Parth Laxmikant Kolekar)\* Spelling fixes (Josh Soref)\* Vent command pipe before remove to avoid deadlocks on writing end (Kai Kunstmann)\* CGI utility cgiutil.c does not process relative config file path names properly (John Frickson)\* xdata/xodtemplate.c bug in option-deprecation code (John Frickson)\* Wildcard searching causes service status links to not work properly (John Frickson)\* Quick search with no hits shows a permission denied error (John Frickson)\* Setting a service as its own parent is not caught by the sanity checker (-v) and causes a segfault (John Frickson)
4.3.1 - 2017-02-23------------------FIXES\* Service hard state generation and host hard or soft down status (John Frickson)\* Comments are duplicated through Nagios reload (John Frickson)\* host hourly value is incorrectly dumped as json boolean (John Frickson)\* Bug - Quick Search no longer allows search by IP (John Frickson)\* Config: status\_update\_interval can not be set to 1 (John Frickson)\* Check attempts not increasing if nagios is reloaded (John Frickson)\* nagios hangs on reload while sending external command to cmd file (John Frickson)\* Feature Request: return code xxx out of bounds - include message as well (John Frickson)
4.3.0 - 2017-02-21------------------SECURITY FIXES\* Fix for CVE-2016-6209 - The "corewindow" parameter (as in http://localhost/nagios?corewindow=www.somewhere.com) has been disabled by default. See the UPGRADING document for how to enable it. (John Frickson)
FIXES\* Fix early event scheduling (pmalek / John Frickson)\* on-demand host checks triggered by service checks cause attempt number increments (fredericve)\* Service notification not being send when host is in soft down state (John Frickson)\* configure does not error if no perl installed on CentOS 7 (John Frickson)\* failed passive requests leave .ok files in checkresults dir (caronc)\* Services don't show in status.cgi if "noheader" specified (John Frickson)\* Standardized check interval config file names (John Frickson)\* "Event Log" (showlog.cgi) could not open log file (John Frickson)\* "nagios\_check\_command" has been deprecated since v3.0. Last vestiges removed (John Frickson)
ENHANCEMENTS\* Added new flag to cgi.cfg: tac\_cgi\_hard\_only to show only HARD states (John Frickson)\* Add broker-event for the end of a timed event (NEBTYPE\_TIMEDEVENT\_END) (John Frickson)\* There is no Macro to retrieve addresses of hostgroup members (now $HOSTGROUPMEMBERADDRESSES$) (John Frickson)\* Add "Page Tour" videos to several of the core web pages (John Frickson)\* Added a login page, and a `Logoff` links (John Frickson)\* On the status map, the host name will be colored if services are not all OK. (John Frickson)\* Added "Clear flapping state" command on host and services detail pages. (John Frickson)\* User-entered comment now displays below generated comment for downtime (John Frickson)
4.2.4 - 2016-12-07------------------SECURITY FIXES\* Fixed another root privilege escalation (CVE-2016-9566) Thanks for bringing this to our attention go to Dawid Golunski (http://legalhackers.com).
4.2.3 - 2016-11-21-------------------SECURITY FIXES\* Fixed a root privilege escalation (CVE-2016-8641) (John Frickson)
FIXES\* external command during reload doesn't work (John Frickson)\* Nagios provides no error condition as to why it fails on the verify for serviceescalation (John Frickson)\* No root group in FreeBSD and Apple OS X (John Frickson)\* jsonquery.html doesn't display scheduled\_time\_ok correctly (John Frickson)\* daemon\_dumps\_core=1 has no effect on Linux when Nagios started as root (John Frickson)\* Configuration check in hostgroup - misspelled hostname does not error (John Frickson)\* contacts or contact\_groups directive with no value should not be allowed (John Frickson)\* Compile 64-bit on SPARC produces LD error (John Frickson)\* HOSTSTATEID returns 0 even if host does not exist (John Frickson)\* Submitting UNREACHABLE passive result for host sets it as DOWN if the host has no parents (John Frickson)\* nagios: job XX (pid=YY): read() returned error 11 (changed from LOG\_ERR to LOG\_NOTICE) (John Frickson)\* Fix for quick search not showing services if wildcard used (John Frickson)
4.2.2 - 2016-10-24------------------SECURITY FIXES\* There was a fix to vulnerability CVE-2008-4796 in the 4.2.0 release on August 1, 2016. The fix was apparently incomplete, as there was still a problem. However, we are now getting all RSS feeds using AJAX calls instead of the (outdated) MagpieRSS package. Thanks for bringing this to our attention go to Dawid Golunski (http://legalhackers.com).
ENHANCEMENTS\* Update status.c to display passive check icon for hosts when passive checks are enabled and actives disabled (John Frickson)
FIXES\* Fix permissions for Host Groups reports (status.cgi) (Patrik Halfar)\* Service Parents does not appear to be functioning as intended (lev)\* Availability report mixes up scheduled and unscheduled warning percentages (Helmut Mikulcik)\* Invalid values for saved\_stamp in compute\_subject\_downtime\_times() (John Frickson)\* Remove deprecated "framespacing" (John Frickson)\* The nagios tarball contains two identical jquery copies (John Frickson)\* extinfo.cgi does not set content-type (most cgi's don't) (John Frickson)\* Timeperiods are corrupted by external command CHANGE\_SVC\_CHECK\_TIMEPERIOD (xoubih)\* Quick search doesn't show hosts without services (service status detail page) (John Frickson)\* In host/services details view, if exactly 100 entries would not show last one (John Frickson)\* nagios host URL parameter for NEW map doesn`t work - Network Map for All Hosts (John Frickson)\* next\_problem\_id is improperly initialized (gherteg)\* Passive problems not showing as "unhandled" (John Frickson)\* September reported as Sept instead of Sep (Rostislav Opočenský)\* Notifications are not sent for active alerts after scheduled downtime ends (John Frickson)\* Nagios 4.2.0 not working on Solaris (John Frickson)\* install-exfoliation and install-classicui don't work FreeBSD and Mac OS X (John Frickson)\* Updated makefile to delete some no-longer-needed files (John Frickson)
4.2.1 - 2016-09-06------------------FIXES\* Fix undefined variable php error (John Frickson)\* Links on the sidebar menu under 'Problems' are indented too far (John Frickson)\* Using $ARGn$ Macros in perfdata (John Frickson)\* using a wildcard in search returns service status total all zero's (John Frickson)\* read\_only does not take priority (deppy)\* Running nagios -v on 4.2.0 takes 90+ seconds (John Frickson)\* Bare "make" invoked in subtarget (mjo)\* Theme images/stylesheets installed with inconsistent permissions (mjo / John Frickson)\* Missing Image for Host and Service State Trends in Availability Report (nichokap / John Frickson)\* Maintain non-persistent comments through reload (John Frickson)\* Servicegroup availability report ignores includesoftstates in service report links (PriceChild)\* error: format not a string literal and no format arguments (Karsten Weiss)\* Synced config.guess and config.sub with GNU (Zakhar Kleyman)
4.2.0 - 2016-08-01------------------SECURITY FIXES\* Fixed vulnerability CVE-2008-4796 (John Frickson)\* Fixed vulnerability CVE-2013-4214 (John Frickson)\* web interface vulnerable to Cross-Site Request Forgery attacks (John Frickson)
ENHANCEMENTS\* Increase socket queue length for listen()\* Added host name to the website page title (leres / John Frickson)\* Added additional icons for NetBSD and SuSE (John Frickson)\* The new Status Map will now use cgi.cfg options (John Frickson) default\_statusmap\_layout will default to "6" for the new map\* The new Status Map will now show some valid values in the popup for "Nagios Process" (John Frickson)
FIXES\* Network outage view without access to all hosts (John Frickson)\* Core workers looping (John Frickson)\* service query returns duplicate host\_name and description fields in the returned data (John Frickson)\* HTML output of plug-ins is parsed in wrong way => webgui unusable (John Frickson)\* Command worker fails to handle SIGPIPE\* "View Status" links under "Map" broken in Nagios Core Version 4.1.1 (John Frickson)\* Can't send big buffer - wproc: Core Worker seems to be choked (velripn / John Frickson)\* Too big CPU load on FreeBSD and other systems using poll() interface (cejkar)\* Flexible downtime recorded as unscheduled downtime (John Frickson)\* Service Flexible downtimes produce 1 notification before entering (John Frickson)\* Once you "set flap\_detection\_enabled 0" it should remove flapping state from the host/services page (John Frickson)\* New map doesn't finish loading if a logo image is not found (John Frickson)\* Extraneous Div end tag in map.html (Scott Wilkerson)\* Issue with "Problems" section (John Frickson)\* Status Map icons and online/offline status dots disappear in IE11 (John Frickson)\* New network map overlays the nagios process with objects (John Frickson)\* Added Default-Start and Default-Stop to the init script (John Frickson)\* Compile / logging issues with BSD 6\* Related to above, Fixed a lot of incorrectly handled time\_t's in \*printf's (John Frickson)\* New map not working for RU locale (actually, most locales) (John Frickson)\* Replaced all instances of signal() with sigaction() + blocking (John Frickson)\* UTF-8 characters like german ä are not processed properly by function url\_encode (John Frickson)\* nagios worker processes can hog CPU (huxley / John Frickson)\* custom time periods that include special characters were not being handled in reports (John Frickson)\* Fixed init script to wait up to 90 seconds then kill the nagios process (John Frickson)\* No Host Groups results in wrong error message (John Frickson)\* Setup Nagios users to view specific host is not working in the new network map (John Frickson)\* statusjson.cgi fails glibc realloc truncate response output (John Frickson)\* Report Time Period does not work if an @ character is in the timeperiod name (John Frickson)\* State History does not use actual plugin long\_output (John Frickson)\* Time period corruption (xoubih)\* Tactical Overview - Disabled Flap Detection Link (John Frickson)
4.1.1 - 08/19/2015------------------FIXES\* CGI Could not read object configuration data (broken by error in 4.1.0)\* exclude (!) not working (broken by mis-applied fix for 4.1.0)
4.1.0 - 08/18/2015------------------ENHANCEMENTS\* Promoted JSON CGIs to released status (Eric Stanley)\* New graphical CGI displays: statusmap, trends, histogram (Eric Stanley)\* Make sticky status for acks and comments configurable enhancement #20 (Trevor McDonald / Scott Wilkerson)\* Add host\_down\_disable\_service\_checks directive to nagios.cfg #44 (Trevor McDonald / Scott Wilkerson)\* httpd.conf doesn't support Apache versions > 2.3 (DanielB / John Frickson)
FIXES\* Fix for not all service dependencies created (John Frickson)\* Fix SIGSEGV with empty custom variable (orbis / John Frickson)\* Fix contact macros in environment variables (dvoryanchikov)\* Fixed host's current attempt goes to 1 after going to hard state (John Frickson)\* Fixed two bugs/problems: Replace use of %zd in base/utils.c & incorrect va\_start() in cgi/jsonutils.c (Peter Eriksson)\* Fixed: Let remove\_specialized actually remove all workers (Phil Mayers)\* Fixed log file spam caused when using perfdata command directives in nagios.cfg (shashikanthbussa)\* Fixed off-by-one error in bounds check leads to segfault (Phil Mayers)\* Added links for legacy graphical displays (Eric Stanley)\* Update embedded URL's to https versions of Nagios websites (scottwilkerson)\* Fixed doxygen comments to work with latest doxygen 1.8.9.1 #30 (Trevor McDonald)\* Fixed makefile target "html" to PHONY to fix GitHub issue #28 (Trevor McDonald)\* Fixed typo as per GitHub issue #27 (Trevor McDonald)\* Fixed jsonquery.php 404 not found error, and disabled Send Query button until form populates #43 (Scott Wilkerson)\* Fixed linking in Tactical Overview for several of the Host entries in Featured section #48 (Scott Wilkerson)\* Fixed passing limit and sort options to pagination and sort links #42 (Scott Wilkerson)\* Added form field for icon URL and clean-up when it changes in CGI Status Map. (Eric Stanley)\* Added options to cgi.cfg to uncheck sticky and send when acknowledging a problem (Trevor McDonald)\* Low impact changes to automate the generation of RPMs from nagios.spec file. (T.J. Yang)\* Update index.php (Trevor McDonald)\* Fixed escaping of corewindow parameter to account for possible XSS injection (Scott Wilkerson)\* Typo correction (T.J. Yang)\* Make getCoreStatus respect cgi\_base\_url (Moritz Schlarb)\* Adjusted map layout to work within frames (Eric Stanley)\* Fixed map displays are now the full size of browser window (Eric Stanley)\* Fixed labels and icons on circular markup no longer scale on zoom (Eric Stanley)\* Got all maps except circular markup working with icons (Eric Stanley)\* Fixes to make legacy CGIs work again. (Eric Stanley)\* Fixes to make all/html target tolerant of being run multiple times (Eric Stanley)\* For user-supplied maps, converted node group to have transform (Eric Stanley)\* Fixed issue transitioning from circular markup map to other maps (Eric Stanley)\* Fix displayForm to trigger on the button press (Scott Wilkerson)\* Fix fo getBBox crash on Firefox (Eric Stanley)\* Fixed map now resets zoom when form apply()'d (Eric Stanley)\* Fixed so close box on dialogs actually closes dialog (Eric Stanley)\* Corrected directive in trends display (Eric Stanley)\* Fixed minor issue with link in trends links (Eric Stanley)\* Fixed issue with map displaying on Firefox (Eric Stanley)\* Added exclusions for ctags generation (Eric Stanley)\* Update map-popup.html (Scott Wilkerson)\* Initial commit of new graphical CGIs (Eric Stanley)\* Fixed GitHub bug #18 - archivejson.cgi returns wrong host for state change query (Eric Stanley)\* Status JSON: Added next\_check to service details (Eric Stanley)\* Fixed escaping of keys for scalar values in JSON CGIs (Eric Stanley)\* build: Include <sys/loadavg.h> if it exists. (Eric J. Mislivec)\* lib-tests: test-io{cache|broker} need -lsocket to link. (Eric J. Mislivec)\* lib-tests: test-runcmd assumes GNU echo. (Eric J. Mislivec)\* lib-tests: Signal handlers don't return int on most platforms, and using a cast was the wrong way to resolve this. (Eric J. Mislivec)\* Fix some type/format mismatch warnings for pid\_t. (Eric J. Mislivec)\* Fix build on Solaris. (Eric J. Mislivec)\* runcmd: Fix build when we don't HAVE\_SETENV. (Eric J. Mislivec)\* Fixed checkresult output processing (Eric Mislivec)\* Corrected escaping of long output macros (Eric Mislivec)\* Fixed null pointer dereferences in archive JSON (Eric Stanley)\* Fixed memory overwrite issue in JSON string escaping (Eric Stanley)\* JSON CGI: Now escaping object and array keys (Eric Stanley)
KNOWN ISSUES\* New map does not account for multiple parents, leaving "legacy" map as an option in the menu
4.0.8 - 08/12/2014------------------ENHANCEMENTS\* Removed 8 kB string size limitation in JSON CGIs (Eric Stanley)\* Re-implemented auto-rescheduling of checks (Eric Mislivec)\* Avoid bunching of checks delayed due to timeperiod constraints (Eric Stanley)\* Limit the number of autocalculated core workers to not spawn too many on large systems (Eric Mislivec, Janice Singh)
FIXES\* Removed quotes from numeric duration values in JSON CGIs (Eric Stanley)\* Fixed escaping in JSON CGIs so all required characters are escaped, and in the correct order (Eric Stanley)\* Fixed segfault in archive JSON CGI when plugin output was empty (Eric Stanley)\* Fixed several possibilities for buffer overflow (Eric Mislivec, Dirkjan Bussink)\* Fixed Tracker #582, #626: Handle VAR=VAL assignments at the start of simple commands (Eric Mislivec, Phil Randal)\* Fixed Tracker #630: Recognize '<' and '>' as redirection operators (Eric Mislivec)\* Corrected worker communication protocol documentation (Phil Mayers)\* Fixed init script to leave config test log in a better location, let sysconfig override init script variables, and not remove nagios.cmd when attempting to start with another instance running (Eric Mislivec, Robin Kearney)\* Fixed Tracker #361: Downtime notifications not displayed properly (Andrew Widdersheim)
4.0.7 - 06/03/2014------------------ENHANCEMENTS\* Added value of custom variables to Object JSON output for hosts, services and contacts (Eric Stanley)
FIXES\* Fixed bug #616: Unescape plugin output read from checkresult files, fix multiline perf data concatenation, and avoid extra memory allocation and copies. (Eric Mislivec)\* Fixed bug #609: Image on home page doesn't have correct image path prefix. (Derek Brewer)\* Fixed bug #608: Extra newline in service check timeout output string. (Mauno Pihelgas)\* Fixed bug #596: Crashes checking contact authorization for host escalations. (Alexey Dvoryanchikov - duplicates #590, #586)\* Fixed bug #496: Syntax error in exfoliation's common.css. (Karsten Weiss)
4.0.6 - 04/29/2014------------------ENHANCEMENTS\* Added name of authenticated user to JSON CGI results object (Eric Stanley)\* Added Nagios Core version to the Status JSON CGI programstatus query (Eric Stanley)\* Added daemon status to main page (Eric Mislivec)
FIXES\* Fixed bug #600: Service Check Timeout State always returns OK (0) status (Mauno Pihelgas, Eric Stanley)\* Fixed bug #583: Status Check Output of (No output on stdout) stderr: (EricStanley - duplicate of bug #573)\* Fixed bug #573: Service checks returns (No output on stdout) stderr (Eric Stanley)\* Fixed bug #438: Reloads during downtime causes wrong availability calculations (Eric Stanley)\* Fixed feed updates when daemon can not access external networks (Eric Mislivec)\* Archive JSON: Fixed bugs calculating availability (Eric Stanley)\* Archive JSON: Allow missing logs to be skipped (Eric Stanley)
4.0.5 - 04/11/2014------------------\* Fixed bug #595: Nagios 4 security fix (Alexey Dvoryanchikov, Eric Stanley)\* Fixed bug #594: Nagios 4 fix contactgroups parsing (Alexey Dvoryanchikov, Eric Stanley)\* Fixed bug #577: Nagios 4 checks stalled when write to socket failed (Alexey Dvoryanchikov)\* Fixed bug #580: Nagios 4 memory leak (Eric Stanley)\* Fixed init script to remove the switching of users when performing configuration verification which was causing failures if nagios user was set to nologin (Scott Wilkerson)\* Fixed auto creation of RAMDISK via environment variables in init script to properly check existence using $RAMDISK\_DIR environment variable. (Scott Wilkerson)\* Fixed unreferenced variable NagiosVarDir in daemon-init (Eric Mislivec)\* Fixed bug where audio alerts wouldn't work with a 0 height and width - https://support.nagios.com/forum/viewtopic.php?t=26387 (Scott Wilkerson)
4.0.4 - 03/14/2014------------------ENHANCEMENTS\* JSON CGIs moved to beta status (Eric Stanley)
FIXES\* Fixed bug #491,#553: Rebuilt the daemon-init scripts back to something that should work on all systems (Scott Wilkerson)
4.0.3 - 02/28/2014------------------ENHANCEMENTS\* Aliased hourly\_value to importance and minimum\_value to minimum\_importance and deprecated the former (Eric Stanley)\* Added host and service importance macros (Eric Stanley)\* Added notifications on flexible downtime expiration (Dan Wittenberg)
FIXES\* Bug #548: Temporary fix that rejects all external command during restart to prevent Core from crashing (Eric Stanley)\* Corrected calculation of host importance and importance defaults (Eric Stanley)\* Fixed bug #498: Nagios 4 enable\_environment\_macros=1 not working (Eric Stanley, Alexey Dvoryanchikov)\* No longer checks whether logs can be written when verifying configuration (Eric Stanley)\* Fixed CGI bug where the CGI could read past the end of the list of CGI variables, potentially crashing the CGI (Scott Wilkerson)\* Fixed inheritance of hourly\_value from host and service templates (Scott Wilkerson)\* Fixed bug #502: 4.0.0: Configuration -> Service Escalations = incomplete list (Eric Stanley)\* Fixed bug #523: quotes and double quotes in plugin message are converted to HTML escapes in Nagios 4.0 (duplicate of bug #524)\* Fixed bug #524: URLs returned in plugin check results are not correctly displayed (Eric Stanley)\* Fixed bug where passive service checks would return "Service check timed out after 0.00 seconds" (Scott Wilkerson)
4.0.2 - 11/25/2013------------------FIXES\* Fixed bug 528: Nagios 4.0.1: Logrotation: Only current host- and servicestates saved in rotated logfiles (duplicate of 507)\* Fixed bug 507: Nagios 4.0.0 - Problem during log rotate (Stefano Ghelfi)\* Fixed bug 530: RPM spec file sets wrong permissions on plugins directory (duplicate of bug 494)\* Fixed bug 494: nagios.spec fixes (with patch) (Karsten Weiss)\* Fixed bug 515: Segsegv after starting up nagios (duplicate of bug 526)\* Fixed bug 513: Crash while entering downtime for service (duplicate of bug 526)\* Fixed bug 529: Core Worker failed to reap child in 4.0.1 Description\* Fixed bug 514: scheduled downtime not showing in web interface (Eric Stanley)\* Fixed bug 526: sort\_downtime() corrupts scheduled\_downtime\_list causing segfault (Adam James)\* Fixed bug 492: Nagios 4 fails to remove/add checks upon reload (Eric Stanley)\* Fixed Bug 484: Beta4.0.0b4 service checks returning (No output on stdout) (Eric Stanley)\* Fixed Bug 470: statusmap doesn't display info (Cameron Moore)\* Fixed Bug 499: Security issue in daemon-init.in, function check\_config (Tómas Edwardsson)
4.0.1 - 10/15/2013------------------ENHANCEMENTS\* Added compiler flags in RPM spec file to reduce compiler noise (Dan Wittenberg)\* Added logging of failure in dlclose() call (Anton Lofgren)\* Added a simple query handler interface, nagios-qh.rb (Dan Wittenberg)\* Multiple code simplifications, additional error handling in downtime code (Andreas Ericsson)
FIXES\* Reverted commit f99a9a7b which set check\_interval to 1 if it was configured as zero.\* Corrected order of arguments when logging unknown hosts/services (Scott Wilkerson)\* Downtime initialized before retention data read (Eric Stanley)\* Patches to make RPM build again (Dan Wittenberg)\* Ensure that scheduled\_downtime\_depth never drops below zero (Andreas Ericsson)
4.0.0 - 09/20/2013------------------See https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/4/en/whatsnew.html for alist of the changes in Nagios Core 4

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_055e1436_20250124_202814.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Nagios: Multiple vulnerabilities — GLSA **201710-20**

Multiple vulnerabilities have been found in Nagios, the worst of
which could lead to the remote execution of arbitrary code.

### Affected packages

| Package | **net-analyzer/nagios-core** on all architectures |
| --- | --- |
| Affected versions | < **4.3.3** |
| Unaffected versions | >= **4.3.3** |

### Background

Nagios is an open source host, service and network monitoring program.

### Description

Multiple vulnerabilities have been discovered in Nagios. Please review
the referenced CVE identifiers for details.

### Impact

A remote attacker could possibly escalate privileges to root, thus
allowing the execution of arbitrary code, by leveraging CVE-2016-9565.
Additionally, a local attacker could cause a Denial of Service condition
against arbitrary processes due to the improper dropping of privileges.

### Workaround

There is no known workaround at this time.

### Resolution

All Nagios users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-analyzer/nagios-core-4.3.3"

```
### References

* [CVE-2016-9565](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9565)
* [CVE-2016-9566](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9566)
* [CVE-2017-12847](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-12847)

**Release date**

October 18, 2017

**Latest revision**

October 18, 2017: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [602216](https://bugs.gentoo.org/show_bug.cgi?id=602216)
* [628086](https://bugs.gentoo.org/show_bug.cgi?id=628086)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from github.com_7254e4ed_20250124_202811.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fcommit%2F1b197346d490df2e2d3b1dcce5ac6134ad0c8752)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fcommit%2F1b197346d490df2e2d3b1dcce5ac6134ad0c8752)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=NagiosEnterprises%2Fnagioscore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NagiosEnterprises](/NagiosEnterprises)
/
**[nagioscore](/NagiosEnterprises/nagioscore)**
Public

* [Notifications](/login?return_to=%2FNagiosEnterprises%2Fnagioscore) You must be signed in to change notification settings
* [Fork
  452](/login?return_to=%2FNagiosEnterprises%2Fnagioscore)
* [Star
   1.6k](/login?return_to=%2FNagiosEnterprises%2Fnagioscore)

* [Code](/NagiosEnterprises/nagioscore)
* [Issues
  186](/NagiosEnterprises/nagioscore/issues)
* [Pull requests
  4](/NagiosEnterprises/nagioscore/pulls)
* [Actions](/NagiosEnterprises/nagioscore/actions)
* [Projects
  0](/NagiosEnterprises/nagioscore/projects)
* [Security](/NagiosEnterprises/nagioscore/security)
* [Insights](/NagiosEnterprises/nagioscore/pulse)

Additional navigation options

* [Code](/NagiosEnterprises/nagioscore)
* [Issues](/NagiosEnterprises/nagioscore/issues)
* [Pull requests](/NagiosEnterprises/nagioscore/pulls)
* [Actions](/NagiosEnterprises/nagioscore/actions)
* [Projects](/NagiosEnterprises/nagioscore/projects)
* [Security](/NagiosEnterprises/nagioscore/security)
* [Insights](/NagiosEnterprises/nagioscore/pulse)

## Commit

[Permalink](/NagiosEnterprises/nagioscore/commit/1b197346d490df2e2d3b1dcce5ac6134ad0c8752)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

halfway revert hack/configure changes - switch order of daemon\_init/d…

[Browse files](/NagiosEnterprises/nagioscore/tree/1b197346d490df2e2d3b1dcce5ac6134ad0c8752)
Browse the repository at this point in the history

```
…rop_privileges
```

* Loading branch information

[![@hedenface](https://avatars.githubusercontent.com/u/16650353?s=40&v=4)](/hedenface)

[hedenface](/NagiosEnterprises/nagioscore/commits?author=hedenface "View all commits by hedenface")
committed
Jul 30, 2017

1 parent
[60638cf](/NagiosEnterprises/nagioscore/commit/60638cfb6033b56f75258e8952d9b956e5edea22)

commit 1b19734

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**21 additions**
and
**23 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Changelog
  [Changelog](#diff-ead07c84baac57a9542f388a07a2a5209456ce790b04251bc9bd7d179ea85cb1)
* THANKS
  [THANKS](#diff-cba98d84635a013da383b41ac94b727826547fff8c838136e4be7c041759d0ac)
* base

  + base/nagios.c
    [nagios.c](#diff-60a7c4740b42f76f675e198b8b85ddfdd517bd99b2143f3de9a5d9e26b5bf895)
* configure.ac
  [configure.ac](#diff-49473dca262eeab3b4a43002adb08b4db31020d190caaad1594b47f1d5daa810)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[Changelog](#diff-ead07c84baac57a9542f388a07a2a5209456ce790b04251bc9bd7d179ea85cb1 "Changelog")

Show comments

[View file](/NagiosEnterprises/nagioscore/blob/1b197346d490df2e2d3b1dcce5ac6134ad0c8752/Changelog)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,6 +8,8 @@ Nagios Core 4 Change Log |
|  |  | \* On-demand host check always use cached host state (John Frickson) |
|  |  | \* 'á' causes Serivce Status Information to not be displayed (John Frickson) |
|  |  | \* New Macro(s) to generate URL for host / service object (John Frickson) |
|  |  | \* Fix minor map issues (Troy Lea) |
|  |  | \* Fix lockfile issues (Bryan Heden) |
|  |  |  |
|  |  |  |
|  |  | 4.3.2 - 2017-05-09 |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[THANKS](#diff-cba98d84635a013da383b41ac94b727826547fff8c838136e4be7c041759d0ac "THANKS")

Show comments

[View file](/NagiosEnterprises/nagioscore/blob/1b197346d490df2e2d3b1dcce5ac6134ad0c8752/THANKS)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -320,6 +320,7 @@ wrong, please let me know. |
|  |  | \* Tomer Okavi |
|  |  | \* Ton Voon |
|  |  | \* Torsten Huebler |
|  |  | \* Troy Lea |
|  |  | \* Tyler Lund |
|  |  | \* Uwe Knop |
|  |  | \* Uwe Knop |
| Expand Down | |  |

31 changes: 16 additions & 15 deletions

31
[base/nagios.c](#diff-60a7c4740b42f76f675e198b8b85ddfdd517bd99b2143f3de9a5d9e26b5bf895 "base/nagios.c")

Show comments

[View file](/NagiosEnterprises/nagioscore/blob/1b197346d490df2e2d3b1dcce5ac6134ad0c8752/base/nagios.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -592,6 +592,22 @@ int main(int argc, char \*\*argv) { |
|  |  | program\_start = time(NULL); |
|  |  | my\_free(mac->x[MACRO\_PROCESSSTARTTIME]); |
|  |  | asprintf(&mac->x[MACRO\_PROCESSSTARTTIME], "%llu", (unsigned long long)program\_start); |
|  |  |  |
|  |  | /\* enter daemon mode (unless we're restarting...) \*/ |
|  |  | if(daemon\_mode == TRUE && sigrestart == FALSE) { |
|  |  |  |
|  |  | result = daemon\_init(); |
|  |  |  |
|  |  | /\* we had an error daemonizing, so bail... \*/ |
|  |  | if(result == ERROR) { |
|  |  | logit(NSLOG\_PROCESS\_INFO | NSLOG\_RUNTIME\_ERROR, TRUE, "Bailing out due to failure to daemonize. (PID=%d)", (int)getpid()); |
|  |  | cleanup(); |
|  |  | exit(EXIT\_FAILURE); |
|  |  | } |
|  |  |  |
|  |  | /\* get new PID \*/ |
|  |  | nagios\_pid = (int)getpid(); |
|  |  | } |
|  |  |  |
|  |  | /\* drop privileges \*/ |
|  |  | if(drop\_privileges(nagios\_user, nagios\_group) == ERROR) { |
| Expand All | | @@ -612,21 +628,6 @@ int main(int argc, char \*\*argv) { |
|  |  | /\* error has already been logged \*/ |
|  |  | exit(EXIT\_FAILURE); |
|  |  | } |
|  |  | /\* enter daemon mode (unless we're restarting...) \*/ |
|  |  | if(daemon\_mode == TRUE && sigrestart == FALSE) { |
|  |  |  |
|  |  | result = daemon\_init(); |
|  |  |  |
|  |  | /\* we had an error daemonizing, so bail... \*/ |
|  |  | if(result == ERROR) { |
|  |  | logit(NSLOG\_PROCESS\_INFO | NSLOG\_RUNTIME\_ERROR, TRUE, "Bailing out due to failure to daemonize. (PID=%d)", (int)getpid()); |
|  |  | cleanup(); |
|  |  | exit(EXIT\_FAILURE); |
|  |  | } |
|  |  |  |
|  |  | /\* get new PID \*/ |
|  |  | nagios\_pid = (int)getpid(); |
|  |  | } |
|  |  |  |
|  |  | /\* this must be logged after we read config data, as user may have changed location of main log file \*/ |
|  |  | logit(NSLOG\_PROCESS\_INFO, TRUE, "Nagios %s starting... (PID=%d)\n", PROGRAM\_VERSION, (int)getpid()); |
| Expand Down | |  |

10 changes: 2 additions & 8 deletions

10
[configure.ac](#diff-49473dca262eeab3b4a43002adb08b4db31020d190caaad1594b47f1d5daa810 "configure.ac")

Show comments

[View file](/NagiosEnterprises/nagioscore/blob/1b197346d490df2e2d3b1dcce5ac6134ad0c8752/configure.ac)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -227,6 +227,7 @@ AC\_ARG\_WITH(checkresult-dir, |
|  |  | if test x$CHECKRESULTDIR = xno; then |
|  |  | CHECKRESULTDIR="$localstatedir/spool/checkresults" |
|  |  | fi |
|  |  | AC\_SUBST(CHECKRESULTDIR) |
|  |  |  |
|  |  | dnl Location of check result path |
|  |  | TMPDIR=no |
| Expand Down  Expand Up | | @@ -270,7 +271,7 @@ AC\_ARG\_WITH(lockfile, |
|  |  | lockfile=$withval, |
|  |  | lockfile=$localstatedir/nagios.lock |
|  |  | ) |
|  |  |  |
|  |  | AC\_SUBST(lockfile) |
|  |  |  |
|  |  | dnl Determine the library to be used by the iobroker |
|  |  |  |
| Expand Down  Expand Up | | @@ -819,13 +820,6 @@ perl subst sample-config/template-object/printer.cfg |
|  |  | perl subst sample-config/template-object/switch.cfg |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | eval localstatedir=$localstatedir |
|  |  | eval lockfile=$lockfile |
|  |  | eval CHECKRESULTDIR=$CHECKRESULTDIR |
|  |  | AC\_SUBST(CHECKRESULTDIR) |
|  |  | AC\_SUBST(lockfile) |
|  |  |  |
|  |  | dnl Review options |
|  |  | echo "" |
|  |  | echo "" |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1b19734`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fcommit%2F1b197346d490df2e2d3b1dcce5ac6134ad0c8752) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


