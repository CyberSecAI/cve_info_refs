=== Content from simplesamlphp.org_2934f01e_20250125_012442.html ===


[Simple
SAML
php](https://simplesamlphp.org)

[Home](https://simplesamlphp.org) Â» SSPSA 201705-01: Session fixation issue and authentication bypass in the authcrypt module

[Download](/download)

[Documentation](/docs)

[Security](/security)

[Modules](/modules/)

[Support](/support/)

[Contribute](/contrib/)

## Date

May 5, 2017
## Affected versions

`SimpleSAMLphp 1.14.12, 1.14.13`
## Severity

Critical
## References

CVE-2017-12868
# 201705-01

**Session fixation issue and authentication bypass in the authcrypt module**

### Background

In the previous [SSPSA 201703-01](/security/201703-01) advisory, a constant time comparison function was introduced
to avoid *timing side-channel attacks* when evaluating the authentication token tied to a session (which avoids *session
fixation attacks*), and also when authenticating with the *authcrypt* module and using passwords hashed with the
[`crypt()` algorithm](https://en.wikipedia.org/wiki/Crypt_%28C%29) used in *htpasswd* files.

### Description

The countermeasure to avoid this timing side-channel attacks consisted on the introduction of the
`SimpleSAML\Utils\Crypto::secureCompare()` function. However, an issue in the implementation of this function introduced
another vulnerability, as the output of the function was always true for strings with equal length, regardless of their
contents, when running a version of PHP older than 5.6.

The issue was due to improper conversion to an integer of individual bytes in both strings, right before applying the
XOR operator to them (`^`). In PHP, the XOR operation applied to strings (or characters) returns always an empty string,
which was then converted to numerical `0` before applying a bitwise OR operation. This implies the result of the
constant time comparison was always `0`, making the function return the boolean `true` even if the contents of the two
strings were completely different.

Strings with different length were not affected, as an specific check for that condition exists in the function.

Similarly, those running a version of PHP equal or newer than 5.6 were not affected, since in their case the
function acts as a simple wrapper to `hash_equals()`.

### Affected versions

**SimpleSAMLphp** versions **1.14.12** and **1.14.13**.

### Impact

The issue described here has a critical impact, as it runs the affected function useless. As such, the session
validation mechanism, consisting on the check for an authentication cookie whose value must be equal to an identifier
held in the sessionâ€™s contents, is also useless, opening for
[session fixation attacks](https://www.owasp.org/index.php/Session_fixation) under certain circumstances.

In the same way, authentication with the *authcrypt* module is also affected by this issue. By exploiting it, an
attacker can authenticate with any account and a random password, provided that the original password is stored in an
*htpasswd* file and hashed using the `crypt()` algorithm. While this is even more critical than a session fixation
attack, the `crypt()` algorithm has been considered insecure for many years now, and even without this particular
issue it would be possible to exploit it to gain unauthorized access. Therefore, the fix for the issue described here
does not make the use of this algorithm secure, and it should be avoided in any case.

### Resolution

Upgrade to the [latest version](/download).

### Credit

This security issue was discovered on May 5, 2017 by Jaime PÃ©rez Crespo, and reported on the same day by Matt
Schwager.

![](/res/ssplogo-fish-2.svg)



=== Content from lists.debian.org_8499cd86_20250125_012441.html ===


---

[[Date Prev](msg00016.html)][Date Next]
[[Thread Prev](msg00016.html)][Thread Next]
[[Date Index](maillist.html#00017)]
[[Thread Index](threads.html#00017)]

# [SECURITY] [DLA 1408-1] simplesamlphp security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1408-1] simplesamlphp security update
* *From*: Thorsten Alteholz <debian@alteholz.de>
* *Date*: Fri, 29 Jun 2018 23:05:32 +0200 (CEST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/alpine.DEB.2.02.1806292302530.11919%40jupiter.server.alteholz.net)Â [alpine.DEB.2.02.1806292302530.11919@jupiter.server.alteholz.net](msg00017.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : simplesamlphp
Version        : 1.13.1-2+deb8u2
CVE ID         : CVE-2017-12868 CVE-2017-12872

CVE-2017-12872 / CVE-2017-12868

    The (1) Htpasswd authentication source in the authcrypt module and (2)
    SimpleSAML_Session class in SimpleSAMLphp 1.14.11 and earlier allow
    remote attackers to conduct timing side-channel attacks by leveraging
    use of the standard comparison operator to compare secret material
    against user input.

    CVE-2017-12868 was a about an improper fix of CVE-2017-12872 in the
    initial patch released by upstream. We have used the correct patch.

For Debian 8 "Jessie", these problems have been fixed in version
1.13.1-2+deb8u2.

We recommend that you upgrade your simplesamlphp packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQJ8BAEBCgBmBQJbNp8cXxSAAAAAAC4AKGlzc3Vlci1mcHJAbm90YXRpb25zLm9w
ZW5wZ3AuZmlmdGhob3JzZW1hbi5uZXQ2MjAxRkJGRkRCQkRFMDc4MjJFQUJCOTY5
NkZDQUMwRDM4N0I1ODQ3AAoJEJb8rA04e1hHt/YP/AzBB6nGcpRJWraLor/sZuZu
9Xg2UpugDuY3Dc8pskHQS8jTDh6e/Rny45FOnvSOlG9rZWOEA4EkmEuVqEUmEb/S
gsxmYeqiMMKZLIujMc1v6aO4wL1cto/DaGSBDDoKSYEY8C//HwDRyBy9T3TADPcf
Jb40cNExpCeds2rm/vFrNnL9l/X4ZP0yZI45wpqEce/nbCtYOCgbIog91qrOVTJ6
fNdFNYXgDmzAUGmXnSTlRunOrfN4dujg5cnTxR4v4qErZnVpp01+zLWJYsBxTaNl
x5XotLVaapaVJyT7AZEDg4LoB/ZONW2ZPAHeoy2mX2bDVEBvjitP6ohsmwwKsj9d
7VFAxTguXmBgGwL0bCzySlZMMUsM5+UAnAUxAPr4yigwGLs2Ei5nudhd7FlN6Ggr
VhIshmRVwaQlx2JPjovKKD+8Mnz5qC8UEEPcqiLLzn/UoLEDhLDc0jz4UkOOci5t
dx750JTlVY6x6uI6AQ6vLw9/lTAf0tUjRgJn0gZwWR8impXy+BqLDFk4GnH2g+L8
ww/RAbs4ctA5SVtFjCJPQdnS7gePqctF6gqQw/wLb6u/zuhTpIu7UcIt0Ic8zFzD
ptMe1UrEGQ4cLvtl/d4NO2CtFV0zesZOYYzT9cEeoer2L0IakrkR1+2vkKdXZNjU
ynXvOBHibMD98EwzateT
=/3Ft
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_fa45bf75_20250125_012441.html ===


---

[[Date Prev](msg00006.html)][[Date Next](msg00008.html)]
[[Thread Prev](msg00006.html)][[Thread Next](msg00008.html)]
[[Date Index](maillist.html#00007)]
[[Thread Index](threads.html#00007)]

# [SECURITY] [DLA 1205-1] simplesamlphp security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1205-1] simplesamlphp security update
* *From*: Raphael Hertzog <hertzog@debian.org>
* *Date*: Tue, 12 Dec 2017 11:13:22 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20171212101322.GA31613%40home.ouaza.com)Â [20171212101322.GA31613@home.ouaza.com](msg00007.html)>
* *Mail-followup-to*: Raphael Hertzog <hertzog@debian.org>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : simplesamlphp
Version        : 1.9.2-1+deb7u1
CVE ID         : CVE-2017-12867 CVE-2017-12868 CVE-2017-12869 CVE-2017-12872
                 CVE-2017-12873 CVE-2017-12874

The simplesamlphp package in wheezy is vulnerable to multiple attacks
on authentication-related code, leading to unauthorized access and
information disclosure.

CVE-2017-12867

    The SimpleSAML_Auth_TimeLimitedToken class allows attackers with
    access to a secret token to extend its validity period by manipulating
    the prepended time offset.

CVE-2017-12869

    The multiauth module allows remote attackers to bypass authentication
    context restrictions and use an authentication source defined in
    config/authsources.php via vectors related to improper validation of
    user input.

CVE-2017-12872 / CVE-2017-12868

    The (1) Htpasswd authentication source in the authcrypt module and (2)
    SimpleSAML_Session class in SimpleSAMLphp 1.14.11 and earlier allow
    remote iattackers to conduct timing side-channel attacks by leveraging
    use of the standard comparison operator to compare secret material
    against user input.

    CVE-2017-12868 was a about an improper fix of CVE-2017-12872 in the
    initial patch released by upstream. We have used the correct patch.

CVE-2017-12873

    SimpleSAMLphp might allow attackers to obtain sensitive information,
    gain unauthorized access, or have unspecified other impacts by
    leveraging incorrect persistent NameID generation when an Identity
    Provider (IdP) is misconfigured.

CVE-2017-12874

    The InfoCard module for SimpleSAMLphp allows attackers to spoof
    XML messages by leveraging an incorrect check of return values in
    signature validation utilities.

For Debian 7 "Wheezy", these problems have been fixed in version
1.9.2-1+deb7u1.

We recommend that you upgrade your simplesamlphp packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
RaphaÃ«l Hertzog â—ˆ Debian Developer

Support Debian LTS: <https://www.freexian.com/services/debian-lts.html>
Learn to master Debian: <https://debian-handbook.info/get/>

```

**Attachment:
[signature.asc](pgpDsDmUtFRIL.pgp)**

*Description:* PGP signature

---



=== Content from github.com_c5024c8d_20250125_012441.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimplesamlphp%2Fsimplesamlphp%2Fcommit%2F4bc629658e7b7d17c9ac3fe0da7dc5df71f1b85e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimplesamlphp%2Fsimplesamlphp%2Fcommit%2F4bc629658e7b7d17c9ac3fe0da7dc5df71f1b85e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=simplesamlphp%2Fsimplesamlphp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[simplesamlphp](/simplesamlphp)
/
**[simplesamlphp](/simplesamlphp/simplesamlphp)**
Public

* [Notifications](/login?return_to=%2Fsimplesamlphp%2Fsimplesamlphp) You must be signed in to change notification settings
* [Fork
  685](/login?return_to=%2Fsimplesamlphp%2Fsimplesamlphp)
* [Star
   1.1k](/login?return_to=%2Fsimplesamlphp%2Fsimplesamlphp)

* [Code](/simplesamlphp/simplesamlphp)
* [Issues
  87](/simplesamlphp/simplesamlphp/issues)
* [Pull requests
  23](/simplesamlphp/simplesamlphp/pulls)
* [Actions](/simplesamlphp/simplesamlphp/actions)
* [Projects
  1](/simplesamlphp/simplesamlphp/projects)
* [Wiki](/simplesamlphp/simplesamlphp/wiki)
* [Security](/simplesamlphp/simplesamlphp/security)
* [Insights](/simplesamlphp/simplesamlphp/pulse)

Additional navigation options

* [Code](/simplesamlphp/simplesamlphp)
* [Issues](/simplesamlphp/simplesamlphp/issues)
* [Pull requests](/simplesamlphp/simplesamlphp/pulls)
* [Actions](/simplesamlphp/simplesamlphp/actions)
* [Projects](/simplesamlphp/simplesamlphp/projects)
* [Wiki](/simplesamlphp/simplesamlphp/wiki)
* [Security](/simplesamlphp/simplesamlphp/security)
* [Insights](/simplesamlphp/simplesamlphp/pulse)

## Commit

[Permalink](/simplesamlphp/simplesamlphp/commit/4bc629658e7b7d17c9ac3fe0da7dc5df71f1b85e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

bugfix: SimpleSAML\Utils\Crypto returns true for different strings usâ€¦

[Browse files](/simplesamlphp/simplesamlphp/tree/4bc629658e7b7d17c9ac3fe0da7dc5df71f1b85e)
Browse the repository at this point in the history

```
â€¦ing PHP < 5.6.

The reason was the lack of conversion to integer for each character of the strings before applying the XOR operator to them. The operator returns always an empty string when applied to two characters, and applying a binary-wise OR between 0 and an empty string, yields 0. Therefore, $diff is always 0, and the function returns true for every two strings with same length, regardless of their contents.
```

* Loading branch information

[![@jaimeperez](https://avatars.githubusercontent.com/u/1942728?s=40&v=4)](/jaimeperez)

[jaimeperez](/simplesamlphp/simplesamlphp/commits?author=jaimeperez "View all commits by jaimeperez")
committed
May 5, 2017

1 parent
[f931e2e](/simplesamlphp/simplesamlphp/commit/f931e2eb8967710b520620d816add9f492fb006d)

commit 4bc6296

Showing
**1 changed file**
with
**2 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[lib/SimpleSAML/Utils/Crypto.php](#diff-cca3439eded50221779137e4bb134e1889adf893e08651a31833b4f8888ee565 "lib/SimpleSAML/Utils/Crypto.php")

Show comments

[View file](/simplesamlphp/simplesamlphp/blob/4bc629658e7b7d17c9ac3fe0da7dc5df71f1b85e/lib/SimpleSAML/Utils/Crypto.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -404,8 +404,8 @@ public static function secureCompare($known, $user) |
|  |  | return false; // length differs |
|  |  | } |
|  |  | $diff = 0; |
|  |  | for ($i = 0; $i < $len; ++$i) { |
|  |  | $diff |= $known[$i] ^ $user[$i]; |
|  |  | for ($i = 0; $i < $len; $i++) { |
|  |  | $diff |= ord($known[$i]) ^ ord($user[$i]); |
|  |  | } |
|  |  | // if all the bytes in $a and $b are identical, $diff should be equal to 0 |
|  |  | return $diff === 0; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4bc6296`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimplesamlphp%2Fsimplesamlphp%2Fcommit%2F4bc629658e7b7d17c9ac3fe0da7dc5df71f1b85e) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


