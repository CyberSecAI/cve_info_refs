```
# CVE-2017-12942
The provided content relates to CVE-2017-12942, detailing multiple vulnerabilities in RAR and UnRAR.

**Root Cause of Vulnerability:**

*   **Directory Traversal:** Improper handling of symbolic links during extraction allows writing files to arbitrary locations.
*   **Out-of-bounds read in `Archive::ReadHeader15` / `EncodeFileName::Decode`**: When `NameSize` is larger than the allocated buffer `NM*4`, the `EncodeFileName::Decode` function reads out of bounds.
*   **Out-of-bounds read in `Unpack::Unpack20`**:  The `DistNumber` is used as an index into an array of size 48, but can have a value of 58 leading to an out of bounds read.
*   **Buffer overflow in `Unpack::LongLZ`**:  The `DistancePlace` is used as an index into an array of size 256 but can have a value of 256 leading to out of bounds write.

**Weaknesses/Vulnerabilities Present:**

*   Directory traversal vulnerability due to inadequate checks when processing symlinks within RAR archives, allowing writes outside intended directories.
*   Memory safety issues including out-of-bounds reads and a buffer overflow stemming from incorrect size checks and index calculations when handling file names and decompression.

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** By exploiting the vulnerabilities and enticing a user to open a specially crafted RAR, attackers could execute arbitrary code with the privileges of the user running the process.
*   **Denial of Service (DoS):** Vulnerabilities could cause a crash, leading to a denial-of-service condition.
*   **File Overwriting/Creation:** Directory traversal allows writing files to arbitrary locations, potentially overwriting critical files, or creating malicious files in unintended locations.

**Attack Vectors:**

*   The primary attack vector is through a specially crafted RAR file.
*   Attackers can entice users to open these malicious archives via email, downloads or other methods.

**Required Attacker Capabilities/Position:**

*   An attacker needs the ability to craft malicious RAR files.
*   The attacker must induce the victim to open the crafted RAR file.
```