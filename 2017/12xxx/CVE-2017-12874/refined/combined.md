=== Content from www.debian.org_5ef32076_20250125_131126.html ===


---

[[Date Prev](msg00051.html)][[Date Next](msg00053.html)]
[[Thread Prev](msg00051.html)][[Thread Next](msg00053.html)]
[[Date Index](maillist.html#00052)]
[[Thread Index](threads.html#00052)]

# [SECURITY] [DSA 4127-1] simplesamlphp security update

---

* *To*: <debian-security-announce@lists.debian.org>
* *Subject*: [SECURITY] [DSA 4127-1] simplesamlphp security update
* *From*: Thijs Kinkhorst <thijs@debian.org>
* *Date*: Fri, 2 Mar 2018 07:15:39 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/d799a440-d6f3-6b56-2a75-52fa2c61fc46%40debian.org)Â [d799a440-d6f3-6b56-2a75-52fa2c61fc46@debian.org](msg00052.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4127-1                   security@debian.org
<https://www.debian.org/security/>                          Thijs Kinkhorst
March 02, 2018                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : simplesamlphp
CVE ID         : CVE-2017-12867 CVE-2017-12869 CVE-2017-12873
                 CVE-2017-12874 CVE-2017-18121 CVE-2017-18122
                 CVE-2018-6519 CVE-2018-6521
Debian Bug     : 889286

Several vulnerabilities have been discovered in SimpleSAMLphp, a
framework for authentication, primarily via the SAML protocol.

CVE-2017-12867

     Attackers with access to a secret token could extend its validity
     period by manipulating the prepended time offset.

CVE-2017-12869

    When using the multiauth module, attackers can bypass authentication
    context restrictions and use any authentication source defined in
    the config.

CVE-2017-12873

    Defensive measures have been taken to prevent the administrator
    from misconfiguring persistent NameIDs to avoid identifier clash.
    (Affects Debian 8 Jesse only.)

CVE-2017-12874

    The InfoCard module could accept incorrectly signed XML messages
    in rare occasions.

CVE-2017-18121

    The consentAdmin module was vulnerable to a Cross-Site Scripting
    attack, allowing an attacker to craft links that could execute
     arbitrary JavaScript code in the victim's browser.

CVE-2017-18122

    The (deprecated) SAML 1.1 implementation would regard as valid any
    unsigned SAML response containing more than one signed assertion,
    provided that the signature of at least one of the assertions was
    valid, allowing an attacker that could obtain a valid signed
    assertion from an IdP to impersonate users from that IdP.

CVE-2018-6519

    Regular expression denial of service when parsing extraordinarily
    long timestamps.

CVE-2018-6521

    Change sqlauth module MySQL charset from utf8 to utf8mb to
    prevent theoretical query truncation that could allow remote
    attackers to bypass intended access restrictions

SSPSA-201802-01 (no CVE yet)

    Critical signature validation vulnerability.

For the oldstable distribution (jessie), these problems have been fixed
in version 1.13.1-2+deb8u1.

For the stable distribution (stretch), these problems have been fixed in
version 1.14.11-1+deb9u1.

We recommend that you upgrade your simplesamlphp packages.

For the detailed security status of simplesamlphp please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/simplesamlphp>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQEuBAEBCAAYBQJamOwIERx0aGlqc0BkZWJpYW4ub3JnAAoJEFb2GnlAHawEn6IH
/3wbUbHLQUuTHhS2E+n4u//hv9kE0TUrjXZak47KYo6vFwhxHyDeKAWlDFqwld8y
L6a5OFL9UZNaQbTOh8MvgD7Q9y8dwiGlC2USjBWlA7BO2HunZ2jqy904c1q36d7I
fAH4TszQ7P/k8uxkNCRPH5GZZiiYnZXRtjiC+x2R860jSHvtlLg0/rMKqSdgBKXd
sD5Dkx4oSeXTZiIVJQl7J+d1rUnuxBAidaqcSIgJOzXsOoPHbS7pfczpZ6kte9K6
s6PfSP39OPIfwbFTTxs1q9SBV3lv59QL3tW91i/XucAAyvsUsvqLVN5xRDllAIAc
RjhqAED45Wis3aG2D7c7Rhc=
=6tNs
-----END PGP SIGNATURE-----

```

---



=== Content from simplesamlphp.org_9bac1172_20250125_131125.html ===


[Simple
SAML
php](https://simplesamlphp.org)

[Home](https://simplesamlphp.org) Â» SSPSA 201612-03: Incorrect signature verification

[Download](/download)

[Documentation](/docs)

[Security](/security)

[Modules](/modules/)

[Support](/support/)

[Contribute](/contrib/)

## Date

December 12, 2016
## Affected versions

`simplesamlphp/simplesamlphp-module-infocard < 1.0.1`
## Severity

Medium
## References

CVE-2017-12874
# 201612-03

**Incorrect signature verification**

### Background

An incorrect check of return values in the signature validation utilities allows an attacker to get invalid signatures
accepted as valid by forcing an error during validation.

### Description

The `InfoCard` SimpleSAMLphp module allows incorporates a series of libraries provided by the Zend Framework. As part
of this third-party library, the class `Zend_InfoCard_Xml_Security` allows the verification of the XML digital signature
of XML chunks with a given key. In particular, the `validateXMLSignature()` method receives an string containing an XML
document and a key to verify it, and throws an exception in case there is any error, either caused by incorrect input or
an invalid signature. This method uses the `openssl_verify()` function provided by the *openssl* PHP extension.

The `openssl_verify()` function returns `1` when the signature was successfully verified, `0` if it failed to verify
with the given key, and `-1` in case an error occurs. PHP allows translating numerical values to *boolean* implicitly,
with the following correspondences:

* `0` equals `false`.
* Non-zero equals `true`.

This means that an implicit conversion to boolean of the values returned by `openssl_verify()` will convert an error
state, signaled by the value `-1`, to a successful verification of the signature (represented by the boolean `true`).

The aforementioned method was performing an implicit conversion to boolean of the values returned by the
`openssl_verify()` function. This means an error during signature verification is treated as a successful verification
by the method.

### Affected versions

The **InfoCard** module version **1.0**.

### Impact

Upon successful exploitation, an invalid signature would be regarded as valid by an affected version of the software.
This allows attackers to modify or manually craft **XML messages** and, by triggering a signature validation
error in the affected party, get those messages accepted as valid and coming from a trusted entity. In practice, this
could mean the capability to access resources while impersonating other individuals, effectively bypassing
authentication.

In order to exploit the issue an incorrect context must be fed to the signature validation routines, or an exceptional
error must be triggered. So far, the following cases have been identified:

* Using a DSA public key to validate an XML signature made with an RSA-related algorithm.
* Using an RSA public key to validate an XML signature made with a DSA-related algorithm.
* Exhausting available memory while verifying the signature.

The code allows for both DSA and RSA keys being used. However, a check between the configured key and the one received
in the XML message is performed, aborting execution in case a mismatch is detected.

Regarding memory exhaustion, it is in theory possible to attack a service provider causing the consumption of all
available memory while a message with an invalid signature is being validated. However, memory exhaustion must happen
only during signature validation and not immediately before or after. This means exploitation of this case is extremely
difficult due to the small time window available for the attacker and the precise control that is needed over the
service provider.

All in all, the consequences of this issue are critical, so even though we consider it difficult to exploit, and
considering that other ways to trigger failures in signature validation could be possible but so far unidentified, we
recommend updating the affected software as soon as possible.

### Resolution

Upgrade to the [latest version](https://github.com/simplesamlphp/simplesamlphp-module-infocard/releases).

![](/res/ssplogo-fish-2.svg)



=== Content from lists.debian.org_fa45bf75_20250125_131125.html ===


---

[[Date Prev](msg00006.html)][[Date Next](msg00008.html)]
[[Thread Prev](msg00006.html)][[Thread Next](msg00008.html)]
[[Date Index](maillist.html#00007)]
[[Thread Index](threads.html#00007)]

# [SECURITY] [DLA 1205-1] simplesamlphp security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1205-1] simplesamlphp security update
* *From*: Raphael Hertzog <hertzog@debian.org>
* *Date*: Tue, 12 Dec 2017 11:13:22 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20171212101322.GA31613%40home.ouaza.com)Â [20171212101322.GA31613@home.ouaza.com](msg00007.html)>
* *Mail-followup-to*: Raphael Hertzog <hertzog@debian.org>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : simplesamlphp
Version        : 1.9.2-1+deb7u1
CVE ID         : CVE-2017-12867 CVE-2017-12868 CVE-2017-12869 CVE-2017-12872
                 CVE-2017-12873 CVE-2017-12874

The simplesamlphp package in wheezy is vulnerable to multiple attacks
on authentication-related code, leading to unauthorized access and
information disclosure.

CVE-2017-12867

    The SimpleSAML_Auth_TimeLimitedToken class allows attackers with
    access to a secret token to extend its validity period by manipulating
    the prepended time offset.

CVE-2017-12869

    The multiauth module allows remote attackers to bypass authentication
    context restrictions and use an authentication source defined in
    config/authsources.php via vectors related to improper validation of
    user input.

CVE-2017-12872 / CVE-2017-12868

    The (1) Htpasswd authentication source in the authcrypt module and (2)
    SimpleSAML_Session class in SimpleSAMLphp 1.14.11 and earlier allow
    remote iattackers to conduct timing side-channel attacks by leveraging
    use of the standard comparison operator to compare secret material
    against user input.

    CVE-2017-12868 was a about an improper fix of CVE-2017-12872 in the
    initial patch released by upstream. We have used the correct patch.

CVE-2017-12873

    SimpleSAMLphp might allow attackers to obtain sensitive information,
    gain unauthorized access, or have unspecified other impacts by
    leveraging incorrect persistent NameID generation when an Identity
    Provider (IdP) is misconfigured.

CVE-2017-12874

    The InfoCard module for SimpleSAMLphp allows attackers to spoof
    XML messages by leveraging an incorrect check of return values in
    signature validation utilities.

For Debian 7 "Wheezy", these problems have been fixed in version
1.9.2-1+deb7u1.

We recommend that you upgrade your simplesamlphp packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
RaphaÃ«l Hertzog â—ˆ Debian Developer

Support Debian LTS: <https://www.freexian.com/services/debian-lts.html>
Learn to master Debian: <https://debian-handbook.info/get/>

```

**Attachment:
[signature.asc](pgpDsDmUtFRIL.pgp)**

*Description:* PGP signature

---


