Based on the provided information, here's a breakdown of CVE-2017-12874:

**Root Cause of Vulnerability:**

*   The vulnerability stems from an incorrect check of return values within the signature validation process in the `InfoCard` module of SimpleSAMLphp. The `openssl_verify()` function, which returns `1` for success, `0` for failure, and `-1` for error, was not properly evaluated. An implicit conversion to boolean was performed, which treats `-1` (error) as `true` (success).

**Weaknesses/Vulnerabilities Present:**

*   **Incorrect Signature Validation:** The core issue is that an error during XML signature verification is incorrectly interpreted as a successful validation.
*   **Implicit Type Conversion:** The vulnerability arises due to the implicit boolean conversion of the integer return value of `openssl_verify()`.
*   **Third-party Library Issue:** The vulnerability exists within the `Zend_InfoCard_Xml_Security` class, which is part of the Zend Framework.

**Impact of Exploitation:**

*   **Bypassing Authentication:** Attackers can craft or modify XML messages with invalid signatures, which will be improperly validated and accepted as valid by the software.
*   **Impersonation:** By bypassing signature verification, attackers can impersonate other users, gaining unauthorized access to resources and potentially performing actions on their behalf.
*   **Spoofing XML Messages:** Attackers are able to get invalid XML messages accepted as valid from a trusted entity.

**Attack Vectors:**

*   **Crafted XML Messages:** The attacker needs to craft or modify XML messages with invalid signatures.
*   **Triggering Validation Error:** Attackers must trigger an error during the signature validation process.
*   Specific scenarios identified include:
    *   Using a DSA public key to validate an XML signature made with an RSA-related algorithm.
    *   Using an RSA public key to validate an XML signature made with a DSA-related algorithm.
    *   Exhausting available memory while verifying the signature.

**Required Attacker Capabilities/Position:**

*   **Ability to Craft or Modify XML Messages:** The attacker must be able to create or manipulate XML messages that would normally be signed.
*   **Ability to Trigger Validation Error:** Attackers must be able to induce a signature validation error through methods like using mismatched key types or exhausting memory.

**Additional Information:**

*   The vulnerability affects versions of `simplesamlphp/simplesamlphp-module-infocard` prior to 1.0.1.
*   The issue is considered of medium severity, although the consequences could be critical, therefore updates are strongly recommended.
*   Exploiting memory exhaustion is theoretically possible but difficult, due to precise timing requirements.