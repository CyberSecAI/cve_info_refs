=== Content from www.talosintelligence.com_35f6504c_20250124_214230.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2017-0467

## CPP-Ethereum JSON-RPC miner\_setEtherbase improper authorization Vulnerability

##### January 9, 2018

##### CVE Number

CVE-2017-12115

### Summary

An exploitable improper authorization vulnerability exists in miner\_setEtherbase API of cpp-ethereum’s JSON-RPC (commit 4e1015743b95821849d001618a7ce82c7c073768).
A JSON request can cause an access to the restricted functionality resulting in authorization bypass. An attacker can send JSON to trigger this vulnerability.

### Tested Versions

Ethereum commit 4e1015743b95821849d001618a7ce82c7c073768

### Product URLs

<http://cpp-ethereum.org>

### CVSSv3 Score

6.8 - CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N

### CWE

CWE-285: Improper Authorization

### Details

```
CPP-Ethereum is a C++ ethereum client, one of the 3 most popular clients for the ethereum platform.  One of the components that is part of cpp-ethereum is a JSON-RPC server which exposes various APIs to manage client/node functionality.  Improper authorization checks in the implementation of the `miner_setEtherbase` API allows a remote attacker without any credentials to triggers functionality reserved only for a user with administrator privileges. We can observe a similar approach in two other clients (lack of any kind of authorization) but in this case the situation is exacerbated by the fact that:

-	By default interface is bound to 0.0.0.0, which means it’s exposed to the world
-	The Content-Type set to ‘application/json’ during requests is not enforced, which means that even if eth JSON-RPC daemon is ran on machine behind a NAT
	the JSON-RPC APIs can still be easily triggered by CSRF or SSRF attacks.
-	older version of the same API had implemented an authorization check
-	there is no visible option to change the default JSON-RPC interface to localhost

```

For comparison let us take geth (the go ethereum client) which also implements a JSON-RPC interface but using much better security practices:
- by default the interface is bound to localhost
- The “Content-Type” request header value must be set to ‘application/json’
- CORS settings are set to block by default all “cross-domain” requests

Let us take a look at `miner_setEtherbase` and describe in details improper/consistency check of authorization.

```
Line 253	bool AdminEth::miner_setEtherbase(string const& _uuidOrAddress)
Line 254	{
Line 255		Address a;
Line 256		h128 uuid = fromUUID(_uuidOrAddress);
Line 257		if (uuid)
Line 258			a = m_keyManager.address(uuid);
Line 259		else if (isHash<Address>(_uuidOrAddress))
Line 260			a = Address(_uuidOrAddress);
Line 261		else
Line 262			throw jsonrpc::JsonRpcException("Invalid UUID or address");
Line 263
Line 264		if (m_setMiningBenefactor)
Line 265			m_setMiningBenefactor(a);
Line 266		else
Line 267			m_eth.setAuthor(a);
Line 268		return true;
Line 269	}

```

As we can see there is no check for calling user privileges which is done in couple other APIs via `RPC_ADMIN` macro.
Same functionality is exposed over `admin_eth_setMiningBenefactor` API where at the beginning of API body, privileges check is made:

```
Line 147	bool AdminEth::admin_eth_setMiningBenefactor(string const& _uuidOrAddress, string const& _session)
Line 148	{
Line 149		RPC_ADMIN;
Line 150		return miner_setEtherbase(_uuidOrAddress);
Line 151	}

```

We are aware that this client is not recommended for mining and that the mentioned functionality related with the administrator interface is turned off by default.
However when enabled the default behavior is insecure and can allow a remote attacker to perform unauthenticated RPC requests.

### Crash Information

```
icewall@ubuntu:~/bugs/cpp-ethereum/build/eth$ ./eth -j --ipc --private 123 --no-discovery --datadir `pwd`/data --config config.json --admin-via-http
cpp-ethereum, a C++ Ethereum client
cpp-ethereum 1.3.0
  By cpp-ethereum contributors, (c) 2013-2016.
  See the README for contributors and credits.
Networking disabled. To start, use netstart or pass --bootstrap or a remote host.
JSONRPC Admin Session Key: Zt9zxSANHZs=

icewall@ubuntu:~/bugs/cpp-ethereum$ curl -X POST --data '{"jsonrpc":"2.0","method":"miner_setEtherbase","params":["0x00803aba77731ed25d31dcafa6a9847a5261d518"],"id":1}' localhost:8545
{"id":1,"jsonrpc":"2.0","result":true}

```
### Timeline

2017-11-03 - Vendor Disclosure

2018-01-09 - Public Release

##### Credit

Discovered by Marcin 'Icewall' Noga of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2017-0468](/vulnerability_reports/TALOS-2017-0468) [Previous Report

TALOS-2017-0466](/vulnerability_reports/TALOS-2017-0466)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


