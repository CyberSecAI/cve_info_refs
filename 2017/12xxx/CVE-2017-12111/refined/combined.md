=== Content from www.talosintelligence.com_4eac064a_20250124_193140.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2017-0463

## libxls xls\_addCell Formula Code Execution Vulnerability

##### November 15, 2017

##### CVE Number

CVE-2017-12111

### Summary

An exploitable out-of-bounds vulnerability exists in the xls\_addCell function of libxls 1.4.
A specially crafted XLS file with a formula record can cause memory corruption resulting in remote code execution.
An attacker can send a malicious XLS file to trigger this vulnerability.

### Tested Versions

libxls 1.4

### Product URLs

<http://libxls.sourceforge.net/>

### CVSSv3 Score

8.8 - CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
CVSSv3 Calculator: https://www.first.org/cvss/calculator/3.0

### CWE

CWE-787: Out-of-bounds Write

### Details

libxls is a C library supported on windows, mac, cygwin which can read Microsoft Excel File Format ( XLS ) files. The library is used by the readxl package that can be installed in the R programming language. However this particular vulnerability does not impact the readxl package.

To analyze this vulnerability, we need to start at the `xls_preparseWorkSheet` function.

```
Line 970	void xls_preparseWorkSheet(xlsWorkSheet* pWS)
Line 971	{
			(...)
Line 1018			case 0x0203:        //NUMBER
Line 1019			case 0x027e:        //RK
Line 1020			case 0x00FD:        //LABELSST
Line 1021			case 0x0201:        //BLANK
Line 1022			case 0x0204:        //LABEL
Line 1023			case 0x0006:        //FORMULA
Line 1024				if (pWS->rows.lastcol<xlsShortVal(((COL*)buf)->col))
Line 1025					pWS->rows.lastcol=xlsShortVal(((COL*)buf)->col);
Line 1026				if (pWS->rows.lastrow<xlsShortVal(((COL*)buf)->row))
Line 1027					pWS->rows.lastrow=xlsShortVal(((COL*)buf)->row);
Line 1028				break;
Line 1029			}

```

The `xls_preparseWorkSheet` function iterates over all existing records and tries to find a maximum value for the `col` and `row` fields, these values are stored in `pWS->rows.lastcol` and `pWS->rows.lastcol`, respectively.
These values are later used for buffers allocations inside the `xls_makeTable` function:

```
Line 409	void xls_makeTable(xlsWorkSheet* pWS)
Line 410	{
				(...)
Line 415		pWS->rows.row=(struct st_row_data *)calloc((pWS->rows.lastrow+1),sizeof(struct st_row_data));
				(...)
Line 426			tmp->cells.cell=(struct st_cell_data *)calloc(tmp->cells.count,sizeof(struct st_cell_data));

```

Later in the `xls_parseWorkSheet` function, the `xls_addCell` function is called for nearly the same set of records that we saw in the `xls_preparseWorkSheet` but with one exception, `FORMULA (Apple Numbers Bug)`:

```
Line 1063	void xls_parseWorkSheet(xlsWorkSheet* pWS)
Line 1064	{
				(...)
Line 1141				case 0x00BD:		//MULRK
Line 1142				case 0x00BE:		//MULBLANK
Line 1143				case 0x0203:		//NUMBER
Line 1144				case 0x027e:		//RK
Line 1145				case 0x00FD:		//LABELSST
Line 1146				case 0x0201:		//BLANK
Line 1147				case 0x0204:		//LABEL
Line 1148				case 0x0006:		//FORMULA
Line 1149				case 0x0406:		//FORMULA (Apple Numbers Bug)
Line 1150					cell = xls_addCell(pWS,&tmp,buf);

```

We did not see `FORMULA (Apple Numbers Bug)` with id `0x0406` in the`xls_preparseWorkSheet` function. This means that for this record, the fields `col` and `row` have not been checked whether
their value exceed the current maximum values stored in `pWS->rows.lastcol`, `pWS->rows.lastrow`.
That lack of check for this type of record leads to an out of bound write in the `xls_addCell` function. Let’s take a look at the vulnerable code:

```
Line 446	struct st_cell_data *xls_addCell(xlsWorkSheet* pWS,BOF* bof,BYTE* buf)
Line 447	{
Line 448		struct st_cell_data*	cell;
Line 449		struct st_row_data*		row;
Line 450		int						i;
Line 451
Line 452		verbose ("xls_addCell");
Line 453
Line 454		// printf("ROW: %u COL: %u\n", xlsShortVal(((COL*)buf)->row), xlsShortVal(((COL*)buf)->col));
Line 455		row=&pWS->rows.row[xlsShortVal(((COL*)buf)->row)];
Line 456		//cell=&row->cells.cell[((COL*)buf)->col - row->fcell]; DFH - inconsistent
Line 457		cell=&row->cells.cell[xlsShortVal(((COL*)buf)->col)];
Line 458		cell->id=bof->id;
Line 459		cell->xf=xlsShortVal(((COL*)buf)->xf);

```

The `col` value coming from the record is used as an index for the `row->cells.cell` array at `line 457`.
The malformed `Formula` record is located at offset : 0xCB1F

```
 CB1Fh: 06 04 20 00 00 01 FF FF                          .. ...ÿÿ

 `col` field is set to 0xFFFF

```

Because this value has not been checked, it can easily exceed array’s range. Write operations at lines `458-459` can subsequently cause an out-of-bounds write which subsequently leads to memory corruption.

### Crash Information

```
Program received signal SIGSEGV, Segmentation fault.
[----------------------------------registers-----------------------------------]
RAX: 0x27fff9
RBX: 0x21 ('!')
RCX: 0x7fffffffdb40 --> 0x200406
RDX: 0x406
RSI: 0x7fffffffdb40 --> 0x200406
RDI: 0xffffffff
RBP: 0x7fffffffdb20 --> 0x7fffffffdbc0 --> 0x7fffffffdc30 --> 0x401610 (<__libc_csu_init>:      push   r15)
RSP: 0x7fffffffdac0 --> 0x60f3a0 --> 0x8000000c90b
RIP: 0x7ffff7bce936 (<xls_addCell+144>: mov    WORD PTR [rax],dx)
R8 : 0x60f360 --> 0x0
R9 : 0x800000003000000
R10: 0x6f ('o')
R11: 0x7ffff7bce8a6 (<xls_addCell>:     push   rbp)
R12: 0x400b60 (<_start>:        xor    ebp,ebp)
R13: 0x7fffffffdd10 --> 0x2
R14: 0x0
R15: 0x0
EFLAGS: 0x10206 (carry PARITY adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x7ffff7bce92b <xls_addCell+133>:    mov    rax,QWORD PTR [rbp-0x50]
   0x7ffff7bce92f <xls_addCell+137>:    movzx  edx,WORD PTR [rax]
   0x7ffff7bce932 <xls_addCell+140>:    mov    rax,QWORD PTR [rbp-0x28]
=> 0x7ffff7bce936 <xls_addCell+144>:    mov    WORD PTR [rax],dx
   0x7ffff7bce939 <xls_addCell+147>:    mov    rax,QWORD PTR [rbp-0x58]
   0x7ffff7bce93d <xls_addCell+151>:    movzx  eax,WORD PTR [rax+0x4]
   0x7ffff7bce941 <xls_addCell+155>:    cwde
   0x7ffff7bce942 <xls_addCell+156>:    mov    edi,eax
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffdac0 --> 0x60f3a0 --> 0x8000000c90b
0008| 0x7fffffffdac8 --> 0x6077d0 --> 0xbbbbbbbbffff0100
0016| 0x7fffffffdad0 --> 0x7fffffffdb40 --> 0x200406
0024| 0x7fffffffdad8 --> 0x60f3a0 --> 0x8000000c90b
0032| 0x7fffffffdae0 --> 0x60f3a0 --> 0x8000000c90b
0040| 0x7fffffffdae8 --> 0x60f360 --> 0x0
0048| 0x7fffffffdaf0 --> 0x800000003000000
0056| 0x7fffffffdaf8 --> 0x27fff9
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x00007ffff7bce936 in xls_addCell (pWS=0x60f3a0, bof=0x7fffffffdb40, buf=0x6077d0 "") at xls.c:458
458         cell->id=bof->id;
gdb-peda$ bt
#0  0x00007ffff7bce936 in xls_addCell (pWS=0x60f3a0, bof=0x7fffffffdb40, buf=0x6077d0 "") at xls.c:458
#1  0x00007ffff7bd0b1a in xls_parseWorkSheet (pWS=0x60f3a0) at xls.c:1150
#2  0x0000000000400ff8 in main (argc=0x2, argv=0x7fffffffdd18) at xls2csv.c:149
#3  0x00007ffff781c830 in __libc_start_main (main=0x400d78 <main>, argc=0x2, argv=0x7fffffffdd18, init=<optimized out>, fini=
<optimized
out>, rtld_fini=<optimized out>, stack_end=0x7fffffffdd08) at ../csu/libc-start.c:291
#4  0x0000000000400b89 in _start ()
gdb-peda$ source ~/tools/triage_tools/exploitable/exploitable/exploitable.py
gdb-peda$ exploitable -m
__main__:102: UserWarning: GDB v7.11 may not support required Python API
Warning: machine string printing is deprecated and may be removed in a future release.
EXCEPTION_FAULTING_ADDRESS:0x0000000027fff9
EXCEPTION_CODE:0xb
FAULTING_INSTRUCTION:mov    WORD PTR [rax],dx
MAJOR_HASH:34754c1fb7e7f36e18e374f783e4c876
MINOR_HASH:34754c1fb7e7f36e18e374f783e4c876
STACK_DEPTH:3
STACK_FRAME:/home/icewall/bugs/libxls-1.4.0/build/lib/libxlsreader.so.1.2.1!xls_addCell+0x0
STACK_FRAME:/home/icewall/bugs/libxls-1.4.0/build/lib/libxlsreader.so.1.2.1!xls_parseWorkSheet+0x0
STACK_FRAME:/home/icewall/bugs/libxls-1.4.0/build/bin/xls2csv!main+0x0
INSTRUCTION_ADDRESS:0x007ffff7bce936
INVOKING_STACK_FRAME:0
DESCRIPTION:Access violation on destination operand
SHORT_DESCRIPTION:DestAv (9/29)
OTHER_RULES:AccessViolation (28/29)
CLASSIFICATION:EXPLOITABLE
EXPLANATION:The target crashed on an access violation at an address matching the destination operand of the instruction. This
     likely indicates a write access violation, which means the attacker may control the write address and/or value.
Description: Access violation on destination operand
Short description: DestAv (9/29)
Hash: 34754c1fb7e7f36e18e374f783e4c876.34754c1fb7e7f36e18e374f783e4c876
Exploitability Classification: EXPLOITABLE
Explanation: The target crashed on an access violation at an address matching the destination operand of the instruction. This
    likely indicates a write access violation, which means the attacker may control the write address and/or value.
Other tags: AccessViolation (28/29)

```
### Timeline

2017-10-25 - Vendor Disclosure

2017-11-15 - Public Release

##### Credit

Discovered by Marcin 'Icewall' Noga of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2017-0461](/vulnerability_reports/TALOS-2017-0461) [Previous Report

TALOS-2017-0462](/vulnerability_reports/TALOS-2017-0462)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from www.debian.org_cfaac9ea_20250124_193139.html ===


---

[[Date Prev](msg00099.html)][[Date Next](msg00101.html)]
[[Thread Prev](msg00099.html)][[Thread Next](msg00101.html)]
[[Date Index](maillist.html#00100)]
[[Thread Index](threads.html#00100)]

# [SECURITY] [DSA 4173-1] r-cran-readxl security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4173-1] r-cran-readxl security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Mon, 16 Apr 2018 20:59:25 +0200
* *Message-id*: <[[🔎]](/msgid-search/20180416185925.GA31669%40pisco.westfalen.local) [20180416185925.GA31669@pisco.westfalen.local](msg00100.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4173-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
April 16, 2018                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : r-cran-readxl
CVE ID         : CVE-2017-2896 CVE-2017-2897 CVE-2017-2919 CVE-2017-12110
                 CVE-2017-12111

Marcin Noga discovered multiple vulnerabilities in readxl, a GNU R
package to read Excel files (via the integrated libxls library), which
could result in the execution of arbitrary code if a malformed
spreadsheet is processed.

For the stable distribution (stretch), these problems have been fixed in
version 0.1.1-1+deb9u1.

We recommend that you upgrade your r-cran-readxl packages.

For the detailed security status of r-cran-readxl please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/r-cran-readxl>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlrU8jcACgkQEMKTtsN8
Tjb54RAAqS5BWcANJ9Y3cGTV7PU81OTLc2ZOjPga3nXpnvyOdpaKHLIIeuN1pJEo
GYm9HxklsnQFMXMoY6g1QCd6NXPCSigpKaVpa8HM9E+Iln14C0may+mA/KEoQFCi
RzicV96RAzxit2z+iaSgkLV7QVIUsB5NlwAcGfy11SDYQZ0L9ztZUfRN0okBtbWZ
FThj5mg0ma0OHfKpCrhVcAuASOh3qRp7uWO3CwHLqa8Mgcg2TlgkjDn7UJ7aUfrf
nbrbJg4OkwWJx2Gwed+cSrfuKl929TiAkOlETprX0GJ314ul+KgqLtbnZ4L2xmD8
sDegbfYNQUhthPLfYXs7UoRFnGwUUwDM1h3Pvdmjaq2QY8wg++nPT/79i3xLK/XT
gDG5ejSLCWvq4IN7Red0/G5UaLfrX7kO9ye8WWNxNHKqr+6pE72DQ9Vb9GcDWWtn
Gi9e1wYvRde+jgZELup5O+jErYvcTSZVu3+e0EuQCWhpP9NoTt6jszdK0k1dR76v
CqZB1k+RpR8HgdNB382MSCuaAIYM7vteAVC/L/dNLFwlHyP0sZVl83wB0fxfTLNt
c8TE+UOws1QWLCqMPPATTtQEQskcRn/qS88XFgMbrnWY9wcEvdk+7Q6v0wfYJITU
9phFNKWNmYgd/Kxwq6KNak/9PcVSLugzm5k+HPLvrEtUQ/8gcLg=
=DzaJ
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_0af3a802_20250124_193138.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# libxls: Multiple vulnerabilities — GLSA **202003-64**

Multiple vulnerabilities have been found in libxls, the worst of
which could result in the arbitrary execution of code.

### Affected packages

| Package | **dev-libs/libxls** on all architectures |
| --- | --- |
| Affected versions | < **1.5.2** |
| Unaffected versions | >= **1.5.2** |

### Background

libxls is a C library for reading Excel files in the nasty old binary
OLE format, plus a command-line tool for converting XLS to CSV.

### Description

Multiple vulnerabilities have been discovered in libxls. Please review
the CVE identifiers referenced below for details.

### Impact

A remote attacker could entice a user to process a specially crafted
Excel file using libxls, possibly resulting in execution of arbitrary
code with the privileges of the process or a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All libxls users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-libs/libxls-1.5.2"

```
### References

* [CVE-2017-12110](https://nvd.nist.gov/vuln/detail/CVE-2017-12110)
* [CVE-2017-12111](https://nvd.nist.gov/vuln/detail/CVE-2017-12111)
* [CVE-2017-2896](https://nvd.nist.gov/vuln/detail/CVE-2017-2896)
* [CVE-2017-2897](https://nvd.nist.gov/vuln/detail/CVE-2017-2897)
* [CVE-2017-2919](https://nvd.nist.gov/vuln/detail/CVE-2017-2919)
* [CVE-2018-20450](https://nvd.nist.gov/vuln/detail/CVE-2018-20450)
* [CVE-2018-20452](https://nvd.nist.gov/vuln/detail/CVE-2018-20452)

**Release date**

March 30, 2020

**Latest revision**

March 30, 2020: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [638336](https://bugs.gentoo.org/show_bug.cgi?id=638336)
* [674006](https://bugs.gentoo.org/show_bug.cgi?id=674006)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


