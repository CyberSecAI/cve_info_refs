=== Content from lists.debian.org_fa45bf75_20250124_162929.html ===


---

[[Date Prev](msg00006.html)][[Date Next](msg00008.html)]
[[Thread Prev](msg00006.html)][[Thread Next](msg00008.html)]
[[Date Index](maillist.html#00007)]
[[Thread Index](threads.html#00007)]

# [SECURITY] [DLA 1205-1] simplesamlphp security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1205-1] simplesamlphp security update
* *From*: Raphael Hertzog <hertzog@debian.org>
* *Date*: Tue, 12 Dec 2017 11:13:22 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20171212101322.GA31613%40home.ouaza.com)Â [20171212101322.GA31613@home.ouaza.com](msg00007.html)>
* *Mail-followup-to*: Raphael Hertzog <hertzog@debian.org>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : simplesamlphp
Version        : 1.9.2-1+deb7u1
CVE ID         : CVE-2017-12867 CVE-2017-12868 CVE-2017-12869 CVE-2017-12872
                 CVE-2017-12873 CVE-2017-12874

The simplesamlphp package in wheezy is vulnerable to multiple attacks
on authentication-related code, leading to unauthorized access and
information disclosure.

CVE-2017-12867

    The SimpleSAML_Auth_TimeLimitedToken class allows attackers with
    access to a secret token to extend its validity period by manipulating
    the prepended time offset.

CVE-2017-12869

    The multiauth module allows remote attackers to bypass authentication
    context restrictions and use an authentication source defined in
    config/authsources.php via vectors related to improper validation of
    user input.

CVE-2017-12872 / CVE-2017-12868

    The (1) Htpasswd authentication source in the authcrypt module and (2)
    SimpleSAML_Session class in SimpleSAMLphp 1.14.11 and earlier allow
    remote iattackers to conduct timing side-channel attacks by leveraging
    use of the standard comparison operator to compare secret material
    against user input.

    CVE-2017-12868 was a about an improper fix of CVE-2017-12872 in the
    initial patch released by upstream. We have used the correct patch.

CVE-2017-12873

    SimpleSAMLphp might allow attackers to obtain sensitive information,
    gain unauthorized access, or have unspecified other impacts by
    leveraging incorrect persistent NameID generation when an Identity
    Provider (IdP) is misconfigured.

CVE-2017-12874

    The InfoCard module for SimpleSAMLphp allows attackers to spoof
    XML messages by leveraging an incorrect check of return values in
    signature validation utilities.

For Debian 7 "Wheezy", these problems have been fixed in version
1.9.2-1+deb7u1.

We recommend that you upgrade your simplesamlphp packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
RaphaÃ«l Hertzog â—ˆ Debian Developer

Support Debian LTS: <https://www.freexian.com/services/debian-lts.html>
Learn to master Debian: <https://debian-handbook.info/get/>

```

**Attachment:
[signature.asc](pgpDsDmUtFRIL.pgp)**

*Description:* PGP signature

---



=== Content from lists.debian.org_8499cd86_20250124_162929.html ===


---

[[Date Prev](msg00016.html)][Date Next]
[[Thread Prev](msg00016.html)][Thread Next]
[[Date Index](maillist.html#00017)]
[[Thread Index](threads.html#00017)]

# [SECURITY] [DLA 1408-1] simplesamlphp security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1408-1] simplesamlphp security update
* *From*: Thorsten Alteholz <debian@alteholz.de>
* *Date*: Fri, 29 Jun 2018 23:05:32 +0200 (CEST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/alpine.DEB.2.02.1806292302530.11919%40jupiter.server.alteholz.net)Â [alpine.DEB.2.02.1806292302530.11919@jupiter.server.alteholz.net](msg00017.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : simplesamlphp
Version        : 1.13.1-2+deb8u2
CVE ID         : CVE-2017-12868 CVE-2017-12872

CVE-2017-12872 / CVE-2017-12868

    The (1) Htpasswd authentication source in the authcrypt module and (2)
    SimpleSAML_Session class in SimpleSAMLphp 1.14.11 and earlier allow
    remote attackers to conduct timing side-channel attacks by leveraging
    use of the standard comparison operator to compare secret material
    against user input.

    CVE-2017-12868 was a about an improper fix of CVE-2017-12872 in the
    initial patch released by upstream. We have used the correct patch.

For Debian 8 "Jessie", these problems have been fixed in version
1.13.1-2+deb8u2.

We recommend that you upgrade your simplesamlphp packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQJ8BAEBCgBmBQJbNp8cXxSAAAAAAC4AKGlzc3Vlci1mcHJAbm90YXRpb25zLm9w
ZW5wZ3AuZmlmdGhob3JzZW1hbi5uZXQ2MjAxRkJGRkRCQkRFMDc4MjJFQUJCOTY5
NkZDQUMwRDM4N0I1ODQ3AAoJEJb8rA04e1hHt/YP/AzBB6nGcpRJWraLor/sZuZu
9Xg2UpugDuY3Dc8pskHQS8jTDh6e/Rny45FOnvSOlG9rZWOEA4EkmEuVqEUmEb/S
gsxmYeqiMMKZLIujMc1v6aO4wL1cto/DaGSBDDoKSYEY8C//HwDRyBy9T3TADPcf
Jb40cNExpCeds2rm/vFrNnL9l/X4ZP0yZI45wpqEce/nbCtYOCgbIog91qrOVTJ6
fNdFNYXgDmzAUGmXnSTlRunOrfN4dujg5cnTxR4v4qErZnVpp01+zLWJYsBxTaNl
x5XotLVaapaVJyT7AZEDg4LoB/ZONW2ZPAHeoy2mX2bDVEBvjitP6ohsmwwKsj9d
7VFAxTguXmBgGwL0bCzySlZMMUsM5+UAnAUxAPr4yigwGLs2Ei5nudhd7FlN6Ggr
VhIshmRVwaQlx2JPjovKKD+8Mnz5qC8UEEPcqiLLzn/UoLEDhLDc0jz4UkOOci5t
dx750JTlVY6x6uI6AQ6vLw9/lTAf0tUjRgJn0gZwWR8impXy+BqLDFk4GnH2g+L8
ww/RAbs4ctA5SVtFjCJPQdnS7gePqctF6gqQw/wLb6u/zuhTpIu7UcIt0Ic8zFzD
ptMe1UrEGQ4cLvtl/d4NO2CtFV0zesZOYYzT9cEeoer2L0IakrkR1+2vkKdXZNjU
ynXvOBHibMD98EwzateT
=/3Ft
-----END PGP SIGNATURE-----

```

---



=== Content from simplesamlphp.org_2698c28a_20250124_162929.html ===


[Simple
SAML
php](https://simplesamlphp.org)

[Home](https://simplesamlphp.org) Â» SSPSA 201703-01: Multiple timing side-channel issues

[Download](/download)

[Documentation](/docs)

[Security](/security)

[Modules](/modules/)

[Support](/support/)

[Contribute](/contrib/)

## Date

March 30, 2017
## Affected versions

`SimpleSAMLphp <= 1.14.11`
## Severity

Medium
## References

CVE-2017-12872
# 201703-01

**Multiple timing side-channel issues**

### Background

A timing side-channel attack is a kind of side channel that reveals confidential or secret information by testing the
amount of time taken by the vulnerable software to process an input, and infer in that way the secret by testing
random inputs incrementally, one character at a time.

This kind of side channel is difficult to exploit but has been demonstrated to work, and is heavily dependant on
the characteristics of the hardware running the vulnerable software, as well as the transmission medium (e.g. the
network used by the attacker to send requests and measure the time taken to respond) and the execution context (e.g.
the operating system).

### Description

Two different timing side-channel attacks have been discovered in SimpleSAMLphp. Both cases are caused by a relaxed
comparison of secret material against user input, using the standard comparison operator. This operator compares both
input strings character by character, returning as soon as it spots a difference. Therefore, it takes a variable amount
of time to compare two strings, depending on how long does it take to find a different character.

There are two known ways to effectively remove this kind of side channel. One consists on performing a **comparison in
constant time**, no matter when the first difference is spotted. The other is a **double HMAC comparison**, consisting
on the application of an HMAC function to both strings in the input, and comparing the resulting hashes. This solution
works because one single change in the input makes its corresponding hash change completely due to the avalanche effect,
and therefore there is no longer a relation between the change in the input and the amount of processing time taken to
compare.

The first issue affects the `SimpleSAML_Session` class. An authentication token is used to prevent session fixation
attacks, and such token, included in a cookie, is compared to a random string generated at authentication time and
stored in the session itself. By monitoring the response time, an attacker may test different values of the
authentication token until being able to guess the value stored in a given session. For this attack to succeed, though,
the attacker needs access to a given valid session, and that implies the ability to mount a session fixation attack in
the first place.

The second issue was found in the `Htpasswd` authentication source included in the `authcrypt` module. In this case,
the relaxed comparison was used to compare a given password against the one stored, and therefore could lead to the
original password being leaked to the attacker.

Both issues have been resolved by introducing the `secureCompare()` method in the `SimpleSAML\Utils\Crypto` class, which
acts as a wrapper to the standard `hash_equals()` function when available (PHP >= 5.6), or performs the comparison
manually in constant time when not.

### Affected versions

All **SimpleSAMLphp** versions before and including **1.14.11**.

### Impact

The issue discovered in SimpleSAMLphpâ€™s session handling affects the validation of the authentication token, which could
therefore be leaked to an attacker. Even though this attack is considered difficult to exploit, given the very nature
of the network, which introduces timing variations usually much bigger than the ones that may be observed during the
processing of a request by the server, it affects every single installation of SimpleSAMLphp, so it should be taken
with caution. Fortunately, the mere possession of the authentication token does not guarantee being recognized as
authenticated by SimpleSAMLphp, so an attacker must also perform a session fixation attack on the victim, which is
difficult in this context.

Additionally, every installation of SimpleSAMLphp using the `Htpasswd` authentication source of the `authcrypt` module
is also affected. In this case, it is the password of a given user that could be leaked by measuring the time taken
to respond to an authentication attempt, and therefore the issue must be considered critical in this case.

### Resolution

Upgrade to the [latest version](/download).

![](/res/ssplogo-fish-2.svg)


