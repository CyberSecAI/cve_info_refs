=== Content from security.gentoo.org_176dc221_20250124_232620.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# RAR, UnRAR: Multiple vulnerabilities — GLSA **201709-24**

Multiple vulnerabilities have been found in RAR and UnRAR, the
worst of which may allow attackers to execute arbitrary code.

### Affected packages

| Package | **app-arch/rar** on all architectures |
| --- | --- |
| Affected versions | < **5.5.0\_p20170811** |
| Unaffected versions | >= **5.5.0\_p20170811** |

| Package | **app-arch/unrar** on all architectures |
| --- | --- |
| Affected versions | < **5.5.7** |
| Unaffected versions | >= **5.5.7** |

### Background

RAR and UnRAR provide command line interfaces for compressing and
decompressing RAR files.

### Description

Multiple vulnerabilities have been discovered in RAR and UnRAR. Please
review the referenced CVE identifiers for details.

### Impact

A remote attacker, by enticing a user to open a specially crafted RAR,
could possibly execute arbitrary code with the privileges of the process
or cause a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All RAR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-arch/rar-5.5.0_p20170811"

```

All UnRAR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-arch/unrar-5.5.7"

```
### References

* [CVE-2012-6706](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2012-6706)
* [CVE-2017-12940](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-12940)
* [CVE-2017-12941](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-12941)
* [CVE-2017-12942](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-12942)

**Release date**

September 25, 2017

**Latest revision**

September 25, 2017: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [622342](https://bugs.gentoo.org/show_bug.cgi?id=622342)
* [628182](https://bugs.gentoo.org/show_bug.cgi?id=628182)
* [628184](https://bugs.gentoo.org/show_bug.cgi?id=628184)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from seclists.org_7151a234_20250124_232618.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](289)
[By Date](date.html#290)
[![Next](/images/right-icon-16x16.png)](291)

[![Previous](/images/left-icon-16x16.png)](289)
[By Thread](index.html#290)
[![Next](/images/right-icon-16x16.png)](321)

![](/shared/images/nst-icons.svg#search)

# UnRAR: directory traversal + memory safety bugs

---

*From*: Jakub Wilk <jwilk () jwilk net>

*Date*: Tue, 15 Aug 2017 00:39:48 +0200

---

(I'm not sure UnRAR bugs are on-topic here. UnRAR is not free software, even
though the source is available. But the last time UnRAR was discussed nobody
objected, so hey, let me try too.)
```

```
I found directory traversal and a few memory safety bugs in UnRAR 5.5.6. These
bugs have been fixed in UnRAR 5.5.7.
```

The memory safety bugs were found using American Fuzzy Lop.

Here are details of the bugs:

* Directory traversal

The PoC (traversal.rar) contains two symlinks and a regular file:

  cur -> .
  cur/par -> ..
  par/moo

This setup defeats UnRAR's directory traversal protections:

  $ ls ../moo
  /bin/ls: cannot access '../moo': No such file or directory

  $ unrar x traversal.rar
  ...
  Extracting  cur                                                       OK
  Extracting  cur/par                                                   OK
  Extracting  par/moo                                                   OK
  All OK

  $ ls ../moo
  ../moo

The code that was used to generate the PoC is available here:
<https://github.com/jwilk/path-traversal-samples>

* Out-of-bounds read in Archive::ReadHeader15 / EncodeFileName::Decode

```
The Archive::ReadHeader15 method contains the following code (with boring parts
omitted):
```

  size_t NameSize=Raw.Get2();
  // ...
  char FileName[NM*4];
  size_t ReadNameSize=Min(NameSize,ASIZE(FileName)-1);
  Raw.GetB((byte *)FileName,ReadNameSize);
  FileName[ReadNameSize]=0;

  if (FileBlock)
  {
    if ((hd->Flags & LHD_UNICODE)!=0)
    {
      EncodeFileName NameCoder;
      size_t Length=strlen(FileName);
      Length++;
      NameCoder.Decode(FileName,(byte *)FileName+Length,
                       NameSize-Length,hd->FileName,
                       ASIZE(hd->FileName));
  // ...

```
If NameSize is bigger than NM\*4, this can make EncodeFileName::Decode read past
the bounds of the FileName array.
```

PoC: oob-archive-readheader15.rar

* Out-of-bounds reads in Unpack::Unpack20

This method contains:

    int DistNumber=DecodeNumber(Inp,&BlockTables.DD);
    unsigned int Distance=DDecode[DistNumber]+1;

```
The array size is 48; but for the PoC (oob-unpack-unpack20.rar), DistNumber is
58.
```

* Buffer overflow in Unpack::LongLZ

This method contains:

  ChSetB[DistancePlace]=ChSetB[NewDistancePlace];

```
The array size is 256; but for the PoC (oob-unpack-longlz.rar), DistancePlace
is 256.
```

--
Jakub Wilk

```

**Attachment:
[traversal.rar](att-290/traversal_rar.bin)**

*Description:*

**Attachment:
[oob-archive-readheader15.rar](att-290/oob-archive-readheader15_rar.bin)**

*Description:*

**Attachment:
[oob-unpack-unpack20.rar](att-290/oob-unpack-unpack20_rar.bin)**

*Description:*

**Attachment:
[oob-unpack-longlz.rar](att-290/oob-unpack-longlz_rar.bin)**

*Description:*

---

[![Previous](/images/left-icon-16x16.png)](289)
[By Date](date.html#290)
[![Next](/images/right-icon-16x16.png)](291)

[![Previous](/images/left-icon-16x16.png)](289)
[By Thread](index.html#290)
[![Next](/images/right-icon-16x16.png)](321)

### Current thread:

* **UnRAR: directory traversal + memory safety bugs** *Jakub Wilk (Aug 14)*
  + [Re: \*\*\*UNCHECKED\*\*\* [oss-security] UnRAR: directory traversal + memory safety bugs](321) *Marcus Meissner (Aug 18)*
  + [Re: \*\*\*UNCHECKED\*\*\* [oss-security] UnRAR: directory traversal + memory safety bugs](322) *Marcus Meissner (Aug 18)*
    - [Re: Re: \*\*\*UNCHECKED\*\*\* [oss-security] UnRAR: directory traversal + memory safety bugs](326) *Marcus Meissner (Aug 18)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from kc.mcafee.com_5c53f69b_20250124_232619.html ===
Loading×Sorry to interruptCSS ErrorRefresh
