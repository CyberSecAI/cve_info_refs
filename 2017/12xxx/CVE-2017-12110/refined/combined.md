=== Content from www.talosintelligence.com_4004d311_20250125_130038.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2017-0462

## libxls xls\_appendSST Code Execution Vulnerability

##### November 15, 2017

##### CVE Number

CVE-2017-12110

### Summary

An exploitable integer overflow vulnerability exists in the xls\_appendSST function of libxls 1.4.
A specially crafted XLS file can cause memory corruption resulting in remote code execution.
An attacker can send a malicious XLS file to trigger this vulnerability.

### Tested Versions

libxls 1.4
readxl package 1.0.0 for R (tested using Microsoft R 4.3.1)

### Product URLs

<http://libxls.sourceforge.net/>

### CVSSv3 Score

8.8 - CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
CVSSv3 Calculator: https://www.first.org/cvss/calculator/3.0

### CWE

CWE-787: Out-of-bounds Write

### Details

libxls is a C library supported on windows, mac, cygwin which can read Microsoft Excel File Format ( XLS ) files. The library is used by the readxl package
that can be installed in the R programming language.
Before we will discuss the location where the out-of-bounds write appears, first let’s check code where space allocation for that array takes place:

```
Line 120	void xls_addSST(xlsWorkBook* pWB,SST* sst,DWORD size)
Line 121	{
Line 122		verbose("xls_addSST");
Line 123
Line 124		pWB->sst.continued=0;
Line 125		pWB->sst.lastln=0;
Line 126		pWB->sst.lastid=0;
Line 127		pWB->sst.lastrt=0;
Line 128		pWB->sst.lastsz=0;
Line 129
Line 130		pWB->sst.count = sst->num;
Line 131		pWB->sst.string =(struct str_sst_string *)calloc(pWB->sst.count, sizeof(struct str_sst_string));
Line 132		xls_appendSST(pWB,&sst->strings,size-8);
Line 133	}

```

As you can see at `line 131` space for `pWB->sst.string` array is allocated based on the `pWB->sst.count` value. This value is obtained at `line 130` from `sst->num`.
The `sst` structure passed as argument is fully controlled by attacker. By controlling the `sst` structure, we can force allocation for any size, for example 1.
The malformed `SST` record is located at offset 0x088F:

```
088Fh: FC 00 20 20 E7 01 00 00 00 00 00 00 0F 00 00 43  ü.  ç..........C
089Fh: 69 73 63 6F 54 61 6C 6F 73 20 20 20 20 20 03 00  iscoTalos     ..
08AFh: 00 53 37 38 03 00 00 53 37 39 03 00 00 53 37 36  .S78...S79...S76
08BFh: 04 00 00 53 31 30 33 04 00 00 53 31 30 32 03 00  ...S103...S102..
08CFh: 00 53 37 37 03 00 00 53 37 34 03 00 00 53 37 35  .S77...S74...S75
08DFh: 03 00 00 53 32 39 03 00 00 53 32 38 03 00 00 53  ...S29...S28...S
08EFh: 32 37 03 00 00 53 37 33 03 00 00 53 32 32 03 00  27...S73...S22..
08FFh: 00                                               .
(...)

```

The `sst` strcture looks as follows in memory:

```
p *sst
$2 = {
  num = 0x0,
  numofstr = 0x0,
  strings = 0xf
}

```

The `num` field is at offset 0x897.

With an `sst` structure where values are set like these above, the `pWB->sst.string` array will have space for just one element.
Going further inside the `xls_appendSST` function. Each string entry in `sst->strings`, after optional conversion, will be assigned (its address exactly) to separate entry in `pWB->sst.string` array.
These string entries look as follows:

```
[string_size](SHORT)[flags](BYTE)[string...]

example:

0F 00 00 43 69 73 63 6F 54 61 6C 6F  .......CiscoTalo
73 20 20 20 20 20

```

We can observe this in the code below, where the `ret` variable at `line 235` containing a “decoded” string address is assigned to the `pWB->sst.string` array entry at `line 257`.
Notice that for each string, `lastid` field value is increased being used as a index in `pWB->sst.string` array.

```
Line 135	void xls_appendSST(xlsWorkBook* pWB,BYTE* buf,DWORD size)
Line 136	{
Line 137		DWORD ln;	// String character count
Line 138		DWORD ofs;	// Current offset in SST buffer
Line 139		DWORD rt;	// Count of rich text formatting runs
Line 140		DWORD sz;	// Size of asian phonetic settings block
Line 141		BYTE flag;	// String flags
Line 142		BYTE* ret;

				(...)

Line 163		else
Line 164        {
Line 165            ln=xlsShortVal(*(WORD_UA *)(buf+ofs));
Line 166            rt = 0;
Line 167            sz = 0;
Line 168
Line 169            ofs+=2;
Line 170        }

				(...)

Line 231		else
Line 232		{
Line 233			ln_toread = min((size-ofs), ln);
Line 234
Line 235			ret = utf8_decode((buf+ofs), ln_toread, pWB->charset);
Line 236
Line 237			ln  -= ln_toread;
Line 238			ofs +=ln_toread;
Line 239
Line 240			if (xls_debug) {
Line 241				printf("String8SST: %s(%u) \n",ret,ln);
Line 242			}
Line 243		}

				(...)

Line 250        if (  (ln_toread > 0)
Line 251            ||(!pWB->sst.continued) )
Line 252        {
Line 253            // Concat string if it's a continue, or add string in table
Line 254            if (!pWB->sst.continued)
Line 255            {
Line 256                pWB->sst.lastid++;
Line 257                pWB->sst.string[pWB->sst.lastid-1].str=ret;
Line 258            }

```

In our case, the attempt to assign a second string to that array will cause an out-of-bounds write, resulting in memory corruption and potential code execution.

### Crash Information

```
Microsoft R crash

(96c.954): Access violation - code c0000005 (!!! second chance !!!)
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\Users\Icewall\Documents\R\win-library\3.4\readxl\libs\x64\readxl.dll -
readxl!xls_appendSST+0xa4:
00000000`6534a974 4c890cc2        mov     qword ptr [rdx+rax*8],r9 ds:00000000`30b49000=????????????????
0:000> r
rax=0000000000000002 rbx=000000000000001e rcx=0000000000000000
rdx=0000000030b48ff0 rsi=0000000031619f70 rdi=0000000000000000
rip=000000006534a974 rsp=000000000440ba00 rbp=0000000000000000
 r8=0000000000000000  r9=0000000030b4eff0 r10=000000000000001b
r11=0000000030b4eff0 r12=0000000000002018 r13=0000000000000000
r14=0000000000000003 r15=0000000000000003
iopl=0         nv up ei pl zr na po nc
cs=0033  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010244
readxl!xls_appendSST+0xa4:
00000000`6534a974 4c890cc2        mov     qword ptr [rdx+rax*8],r9 ds:00000000`30b49000=????????????????
0:000> kb 5
 # RetAddr           : Args to Child                                                           : Call Site
00 00000000`6534bdf9 : 00000000`31796ff0 00000000`31798fe8 00000000`3161bfb0 00000000`65349fe7 : readxl!xls_appendSST+0xa4
01 00000000`6534cc96 : 00000000`31619f70 00000000`00000006 00000000`00000000 00000000`0440bd68 : readxl!xls_parseWorkBook+0x3d9
02 00000000`6538025b : 00000000`0000003e 00000000`0440bc10 00000000`106f0788 00007ffe`155d9a00 : readxl!xls_open+0x136
03 00000000`65344d9d : 00000000`00000001 00000000`6cbfdb68 000cc587`59d3b80a 00000000`106f0788 : readxl!ZN11XlsWorkBookC1ERKSs+0x11b
04 00000000`65341efa : 00000000`00000000 00000000`0440be80 00000000`0440c700 00000000`6c87662c : readxl!Z10xls_sheetsSs+0x1d

0:000> lmv m readxl
Browse full module list
start             end                 module name
00000000`65340000 00000000`6543f000   readxl     (export symbols)       C:\Users\Icewall\Documents\R\win-library\3.4\readxl\libs\x64\readxl.dll
	Loaded symbol image file: C:\Users\Icewall\Documents\R\win-library\3.4\readxl\libs\x64\readxl.dll
	Image path: C:\Users\Icewall\Documents\R\win-library\3.4\readxl\libs\x64\readxl.dll
	Image name: readxl.dll
	Browse all global symbols  functions  data
	Timestamp:        Wed Aug 30 18:38:23 2017 (59A6E9FF)
	CheckSum:         001018F6
	ImageSize:        000FF000
	Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4

Linux version

icewall@ubuntu:~/bugs/libxls-1.4.0/build/bin$ valgrind ./xls2csv test/poc.xls
==37508== Memcheck, a memory error detector
==37508== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.
==37508== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info
==37508== Command: ./xls2csv test/poc.xls
==37508==
==37508== Invalid write of size 8
==37508==    at 0x4E4207E: xls_appendSST (xls.c:257)
==37508==    by 0x4E41D25: xls_addSST (xls.c:132)
==37508==    by 0x4E43B12: xls_parseWorkBook (xls.c:781)
==37508==    by 0x4E44F7B: xls_open (xls.c:1272)
==37508==    by 0x400E80: main (xls2csv.c:108)
==37508==  Address 0x54607d0 is 0 bytes after a block of size 0 alloc'd
==37508==    at 0x4C2FB55: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==37508==    by 0x4E41CFD: xls_addSST (xls.c:131)
==37508==    by 0x4E43B12: xls_parseWorkBook (xls.c:781)
==37508==    by 0x4E44F7B: xls_open (xls.c:1272)

```
### Timeline

2017-10-25 - Vendor Disclosure

2017-11-15 - Public Release

##### Credit

Discovered by Marcin 'Icewall' Noga of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2017-0463](/vulnerability_reports/TALOS-2017-0463) [Previous Report

TALOS-2017-0460](/vulnerability_reports/TALOS-2017-0460)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from www.debian.org_cfaac9ea_20250125_130014.html ===


---

[[Date Prev](msg00099.html)][[Date Next](msg00101.html)]
[[Thread Prev](msg00099.html)][[Thread Next](msg00101.html)]
[[Date Index](maillist.html#00100)]
[[Thread Index](threads.html#00100)]

# [SECURITY] [DSA 4173-1] r-cran-readxl security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4173-1] r-cran-readxl security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Mon, 16 Apr 2018 20:59:25 +0200
* *Message-id*: <[[🔎]](/msgid-search/20180416185925.GA31669%40pisco.westfalen.local) [20180416185925.GA31669@pisco.westfalen.local](msg00100.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4173-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
April 16, 2018                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : r-cran-readxl
CVE ID         : CVE-2017-2896 CVE-2017-2897 CVE-2017-2919 CVE-2017-12110
                 CVE-2017-12111

Marcin Noga discovered multiple vulnerabilities in readxl, a GNU R
package to read Excel files (via the integrated libxls library), which
could result in the execution of arbitrary code if a malformed
spreadsheet is processed.

For the stable distribution (stretch), these problems have been fixed in
version 0.1.1-1+deb9u1.

We recommend that you upgrade your r-cran-readxl packages.

For the detailed security status of r-cran-readxl please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/r-cran-readxl>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlrU8jcACgkQEMKTtsN8
Tjb54RAAqS5BWcANJ9Y3cGTV7PU81OTLc2ZOjPga3nXpnvyOdpaKHLIIeuN1pJEo
GYm9HxklsnQFMXMoY6g1QCd6NXPCSigpKaVpa8HM9E+Iln14C0may+mA/KEoQFCi
RzicV96RAzxit2z+iaSgkLV7QVIUsB5NlwAcGfy11SDYQZ0L9ztZUfRN0okBtbWZ
FThj5mg0ma0OHfKpCrhVcAuASOh3qRp7uWO3CwHLqa8Mgcg2TlgkjDn7UJ7aUfrf
nbrbJg4OkwWJx2Gwed+cSrfuKl929TiAkOlETprX0GJ314ul+KgqLtbnZ4L2xmD8
sDegbfYNQUhthPLfYXs7UoRFnGwUUwDM1h3Pvdmjaq2QY8wg++nPT/79i3xLK/XT
gDG5ejSLCWvq4IN7Red0/G5UaLfrX7kO9ye8WWNxNHKqr+6pE72DQ9Vb9GcDWWtn
Gi9e1wYvRde+jgZELup5O+jErYvcTSZVu3+e0EuQCWhpP9NoTt6jszdK0k1dR76v
CqZB1k+RpR8HgdNB382MSCuaAIYM7vteAVC/L/dNLFwlHyP0sZVl83wB0fxfTLNt
c8TE+UOws1QWLCqMPPATTtQEQskcRn/qS88XFgMbrnWY9wcEvdk+7Q6v0wfYJITU
9phFNKWNmYgd/Kxwq6KNak/9PcVSLugzm5k+HPLvrEtUQ/8gcLg=
=DzaJ
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_0af3a802_20250125_130014.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# libxls: Multiple vulnerabilities — GLSA **202003-64**

Multiple vulnerabilities have been found in libxls, the worst of
which could result in the arbitrary execution of code.

### Affected packages

| Package | **dev-libs/libxls** on all architectures |
| --- | --- |
| Affected versions | < **1.5.2** |
| Unaffected versions | >= **1.5.2** |

### Background

libxls is a C library for reading Excel files in the nasty old binary
OLE format, plus a command-line tool for converting XLS to CSV.

### Description

Multiple vulnerabilities have been discovered in libxls. Please review
the CVE identifiers referenced below for details.

### Impact

A remote attacker could entice a user to process a specially crafted
Excel file using libxls, possibly resulting in execution of arbitrary
code with the privileges of the process or a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All libxls users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-libs/libxls-1.5.2"

```
### References

* [CVE-2017-12110](https://nvd.nist.gov/vuln/detail/CVE-2017-12110)
* [CVE-2017-12111](https://nvd.nist.gov/vuln/detail/CVE-2017-12111)
* [CVE-2017-2896](https://nvd.nist.gov/vuln/detail/CVE-2017-2896)
* [CVE-2017-2897](https://nvd.nist.gov/vuln/detail/CVE-2017-2897)
* [CVE-2017-2919](https://nvd.nist.gov/vuln/detail/CVE-2017-2919)
* [CVE-2018-20450](https://nvd.nist.gov/vuln/detail/CVE-2018-20450)
* [CVE-2018-20452](https://nvd.nist.gov/vuln/detail/CVE-2018-20452)

**Release date**

March 30, 2020

**Latest revision**

March 30, 2020: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [638336](https://bugs.gentoo.org/show_bug.cgi?id=638336)
* [674006](https://bugs.gentoo.org/show_bug.cgi?id=674006)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


