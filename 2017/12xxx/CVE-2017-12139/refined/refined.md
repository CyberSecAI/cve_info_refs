- **Root cause of vulnerability:** The `image_mimetype` field in the database is populated with the media type of an uploaded file without sanitization. The media type is obtained from the browser and is not validated, which allows an attacker to inject malicious code.

- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS) vulnerability. The application stores unvalidated user-provided input (the file's media type) into the database, which is later displayed to other users in a web page.

- **Impact of exploitation:** An attacker can inject malicious JavaScript code into the `image_mimetype` field. When this data is displayed to other users, the attacker's script will execute in their browsers, potentially allowing the attacker to steal cookies, redirect users, deface the website, or perform other malicious actions.

- **Attack vectors:** An attacker uploads a file with a manipulated `Content-Type` header that contains malicious JavaScript code within it (e.g., `<script>alert('XSS')</script>`). When the image metadata is stored into the database, the malicious header gets saved. The malicious code is executed when a user views the image information.

- **Required attacker capabilities/position:** An attacker needs the ability to upload files to the vulnerable application.