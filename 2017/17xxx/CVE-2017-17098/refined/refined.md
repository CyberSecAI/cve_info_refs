Based on the provided content, here's a breakdown of the vulnerabilities related to CVE-2017-17098:

**CVE-2017-17098:**

*   **Root Cause of Vulnerability:**
    *   The `writeLog` function in `fn_common.php` does not properly sanitize user-supplied input when writing to log files. Specifically, it fails to prevent injection of PHP code via a crafted request. This occurs during admin log viewing.
*   **Weaknesses/Vulnerabilities Present:**
    *   **Remote Code Injection:** The primary vulnerability is the ability to inject arbitrary PHP code into log files.  The function `mysql_real_escape_string()`  adds slashes to quotes, requiring a payload without quotes, which PHP can interpret.
*   **Impact of Exploitation:**
    *   An attacker can inject malicious PHP code into the server's log files. This code is executed when an administrator views the logs, potentially leading to complete server compromise.
    *   While the log files are generally only accessible by admin sessions, the exploit details indicate this can be bypassed due to a separate admin account hijack vulnerability, making remote code execution fully exploitable.
*   **Attack Vectors:**
    *   A remote attacker can inject code by crafting a malicious request to the web application.
    *   The example given is injecting the payload via the password recovery function, specifically within the email field.
*   **Required Attacker Capabilities/Position:**
    *   The attacker needs to be able to send HTTP requests to the vulnerable web application.
    *   The attacker needs to know that the admin will be viewing the logs in order to trigger execution of the malicious code.

**Additional Notes:**

*   The provided content notes that the code injection vulnerability is present in versions 3.0 and below of the gps-server.net software.
*   The exploit description notes that the `mysql_real_escape_string()` function is used on all POST data, which requires the attacker to use a quote-less PHP payload.
*   The content also references a password reset vulnerability (CVE-2017-17097), which, when combined with the RCE, allows for complete remote takeover.
*   The code injection is triggered when an admin views the log files, however, this is coupled with a password reset vulnerability to obtain admin access and then view logs to trigger the RCE, making the RCE exploitable.
*   The software versions affected are up to 3.0, and the recommended mitigation is to update to version 3.1.

This content provides more detail than the basic CVE description.