```
{
  "vulnerability": {
    "root_cause": "A race condition exists in the IPv4 raw socket implementation of the Linux kernel.",
    "weaknesses": [
      "The `inet->hdrincl` flag, which determines if the IP header is included in the user-supplied data, is read multiple times without proper synchronization. This can lead to inconsistent state if the flag is modified concurrently.",
      "Use of the `inet->hdrincl` bit field directly without using `READ_ONCE()`.",
      "Uninitialized pointer usage can occur in `raw_sendmsg` due to the race condition."
    ],
    "impact": "A local attacker can exploit the race condition to cause a denial of service (kernel crash) or potentially execute arbitrary code. Kernel addresses may be leaked due to inconsistent state.",
    "attack_vectors": "Local access to the system with the ability to create raw sockets.",
    "attacker_capabilities": "Attacker needs to have the ability to create raw sockets on the system. No specific privileges beyond this are mentioned in the provided text, meaning the vulnerability could be exploited by an unprivileged local user.",
    "additional_details": "The vulnerability occurs in the `raw_sendmsg` function where the `inet->hdrincl` is checked multiple times without proper synchronization. The fix ensures the value of `inet->hdrincl` is read only once and stored in a local variable to avoid the race condition. The issue was introduced with commit `c008ba5bdc9f` which attempted to avoid reading user iov twice after raw_probe_proto_opt. This commit did not protect the usage of hdrincl flag."
  },
  "affected_packages": [
    "linux-azure",
    "linux-gcp",
    "linux-hwe",
    "linux-oem",
    "linux",
    "linux-aws",
    "linux-kvm",
    "linux-raspi2",
    "linux-snapdragon",
	"linux-lts-xenial"
  ],
  "patch_details": "The fix involves reading the `inet->hdrincl` value only once into a local variable `hdrincl` and using this variable for the rest of the function execution, ensuring a consistent value and preventing the race condition. The upstream commit that fixed this is `8f659a03a0ba9289b9aeb9b4470e6fb263d6f483`."
}
```