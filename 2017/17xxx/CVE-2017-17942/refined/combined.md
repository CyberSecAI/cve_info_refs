=== Content from bugzilla.maptools.org_5c60ae51_20250124_154106.html ===


|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Search](query.cgi)
* |
* | [Reports](report.cgi)
* | [New Account](createaccount.cgi)
* |
  [Help](docs/en/html/bug_page.html)
* | [Log In](http://bugzilla.maptools.org/show_bug.cgi?id=2767&GoAheadAndLogIn=1)

*First*
*Last*
*Prev*
*Next*

*No search results available*

[**Bug 2767**](show_bug.cgi?id=2767) -
A heap-buffer-overflow in libtiff 4.0.8.

| Summary: | A heap-buffer-overflow in libtiff 4.0.8. |
| --- | --- |

| | **[Status](page.cgi?id=fields.html#status)**: | RESOLVED LATER | | --- | --- | |  | | | **Product**: | libtiff | | **[Component](describecomponents.cgi?product=libtiff):** | default | | **Version**: | unspecified | | **Platform**: | PC Linux | |  | | | **[Importance](page.cgi?id=fields.html#importance)**: | P2 enhancement | | **Target Milestone**: | --- | | **[Assigned To](page.cgi?id=fields.html#assigned_to)**: | Frank Warmerdam | |  | | | **[URL](https://github.com/xiaosatianyu/for-cve/blob/master/collect_poc/libtiff4.0.8/bmp2tiff/cve-2017-17942/cve-2017-17942-poc)**: | [https://github.com/xiaosatianyu/for-c...](https://github.com/xiaosatianyu/for-cve/blob/master/collect_poc/libtiff4.0.8/bmp2tiff/cve-2017-17942/cve-2017-17942-poc) | | **Whiteboard**: |  | | | **[Keywords](describekeywords.cgi)**: | migrated\_to\_gitlab | | |  | | | Depends on: |  | | Blocks: |  ||  | Show dependency [tree](showdependencytree.cgi?id=2767&hide_resolved=1) / [graph](showdependencygraph.cgi?id=2767) | | |  | | **Reported**: | 2017-12-27 07:28 by xiaosatianyu@126.com | | --- | --- | | **Modified**: | 2019-10-01 14:20 ([History](show_activity.cgi?id=2767)) | |  | | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| Attachments | |
| --- | --- |
| [**poc**](attachment.cgi?id=835 "View the content of the attachment") (2.91 KB, application/octet-stream)  [2017-12-27 07:28](#attach_835 "Go to the comment associated with the attachment"), xiaosatianyu@126.com | [Details](attachment.cgi?id=835&action=edit) |
| [Add an attachment](attachment.cgi?bugid=2767&action=enter) (proposed patch, testcase, etc.) | |

| Note You need to [log in](show_bug.cgi?id=2767&GoAheadAndLogIn=1) before you can comment on or make changes to this bug.   ---   *[Description](show_bug.cgi?id=2767#c0) From xiaosatianyu@126.com  2017-12-27 07:28:48* ``` [Created an attachment (id=835)](attachment.cgi?id=835 "poc") [[details]](attachment.cgi?id=835&action=edit "poc") poc  There is a heap-buffer-overflow in PackBitsEncode function tif_packbits.c line 88 in libtiff 4.0.8. ================================================================= ==23471==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x619000000980 at pc 0x0000006eedf5 bp 0x7fffa9c16820 sp 0x7fffa9c16818 READ of size 1 at 0x619000000980 thread T0     #0 0x6eedf4 in PackBitsEncode /home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_packbits.c:88:25     #1 0x61a451 in TIFFWriteScanline /home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_write.c:173:11     #2 0x530827 in main /home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/bmp2tiff.c:775:9     #3 0x7f70dbcbef44 in __libc_start_main /build/eglibc-SvCtMH/eglibc-2.19/csu/libc-start.c:287     #4 0x41c8cb in _start (/home/binzhang/Desktop/bmp2tiff/bmp2tiff+0x41c8cb)  0x619000000980 is located 0 bytes to the right of 1024-byte region [0x619000000580,0x619000000980) allocated by thread T0 here:     #0 0x4f55d6 in __interceptor_malloc /home/xiaosatianyu/workspace/git/LLVM/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:88     #1 0x6274b0 in _TIFFmalloc /home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_unix.c:316:10     #2 0x52e5dd in main /home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/tools/bmp2tiff.c:678:34     #3 0x7f70dbcbef44 in __libc_start_main /build/eglibc-SvCtMH/eglibc-2.19/csu/libc-start.c:287  SUMMARY: AddressSanitizer: heap-buffer-overflow /home/xiaosatianyu/workspace/git/fuzz/for-new-CVE/benlibtiff/libtiff/libtiff/tif_packbits.c:88:25 in PackBitsEncode Shadow bytes around the buggy address:   0x0c327fff80e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x0c327fff80f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x0c327fff8100: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x0c327fff8110: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x0c327fff8120: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x0c327fff8130:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c327fff8140: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c327fff8150: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c327fff8160: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c327fff8170: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c327fff8180: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07    Heap left redzone:       fa   Freed heap region:       fd   Stack left redzone:      f1   Stack mid redzone:       f2   Stack right redzone:     f3   Stack after return:      f5   Stack use after scope:   f8   Global redzone:          f9   Global init order:       f6   Poisoned by user:        f7   Container overflow:      fc   Array cookie:            ac   Intra object redzone:    bb   ASan internal:           fe   Left alloca redzone:     ca   Right alloca redzone:    cb ==23471==ABORTING ```  ------- *Comment [#1](show_bug.cgi?id=2767#c1) From Petr Gajdos  2018-08-24 05:16:03* ------- ``` Hello xiaosatianyu@126.com, could you please attach a real testcase and command to run? Otherwise I would consider this bug as invalid. ```  ------- *Comment [#2](show_bug.cgi?id=2767#c2) From xiaosatianyu@126.com  2018-08-24 19:54:28* ------- ``` (In reply to [comment #1](show_bug.cgi?id=2767#c1)) > Hello xiaosatianyu@126.com, could you please attach a real testcase and command > to run? Otherwise I would consider this bug as invalid.   Sorry， I  rearrange my git repositories and move the poc to a new path. Currently, the new path of the poc is  <https://github.com/xiaosatianyu/for-cve/blob/master/collect_poc/libtiff4.0.8/bmp2tiff/cve-2017-17942/cve-2017-17942-poc> ```  ------- *Comment [#3](show_bug.cgi?id=2767#c3) From Petr Gajdos  2018-08-27 02:51:06* ------- ``` Just from the backtrace, it seems similar to [bug 2562](show_bug.cgi?id=2562 "RESOLVED WONTFIX - CVE-2016-5319: heap buffer overflow in PackBitsEncode"). ```  ------- *Comment [#4](show_bug.cgi?id=2767#c4) From Even Rouault  2019-10-01 14:20:50* ------- ``` Bugzilla is no longer used for tracking libtiff issues. Remaining open tickets, such as this one, have been migrated to the libtiff GitLab instance at <https://gitlab.com/libtiff/libtiff/issues> .  The migrated tickets have their summary prefixed with [BZ#XXXX] where XXXX is the initial Bugzilla issue number. ``` |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=2767)
* - [XML](show_bug.cgi?ctype=xml&id=2767)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=2767)
* - Top of page

*First*
*Last*
*Prev*
*Next*

*No search results available*

* Actions:
  + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Search](query.cgi)
  + |
  + | [Reports](report.cgi)
  + | [New Account](createaccount.cgi)
  + |
    [Help](docs/en/html/bug_page.html)
  + | [Log In](http://bugzilla.maptools.org/show_bug.cgi?id=2767&GoAheadAndLogIn=1)


