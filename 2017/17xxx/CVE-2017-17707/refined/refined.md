The provided content relates to CVE-2017-17707.

**Root cause of vulnerability:**
The vulnerability stems from missing authorization checks within the Pleasant Password Server application, specifically regarding access to attachments associated with password safe entries.

**Weaknesses/vulnerabilities present:**
- **Incorrect Access Control:** The primary weakness is the lack of proper authorization checks when accessing, uploading, and deleting attachments. Any authenticated user can perform these actions if they know the "CredentialId" of the entry.
- **Exposure of CredentialId:** Although "CredentialId" values are GUIDs and hard to guess, they can be exposed to malicious users through read-only or temporary grants of access to a password entry.

**Impact of exploitation:**
- **Unauthorized Access:** An attacker can list, download, upload, and delete attachments associated with password entries without proper authorization.
- **Data Breach:** This could lead to the exposure of sensitive information stored in attachments.
- **Data Manipulation:** An attacker could modify or delete attachments, causing disruption or damage.

**Attack vectors:**
The attack vector involves sending crafted HTTP requests to specific endpoints within the Pleasant Password Server web application.

**Required attacker capabilities/position:**
- **Authenticated User:** The attacker must have a valid user account on the Pleasant Password Server.
- **Knowledge of CredentialId:** The attacker needs to obtain the "CredentialId" of the password entry they wish to target. This can be achieved if they have been granted some level of access to the entry, even read-only access.

**Technical Details:**
- **Affected Product:** Pleasant Password Server
- **Affected Version:** 7.7.5.0 (lower versions not tested)
- **Vulnerable Endpoints:**
    - `POST /WebClient/CredentialAttachmentGrid/Select?CredentialId=<CredentialId>` (Listing attachments)
    - `GET /WebClient/Attachment/DownloadAttachment?attachmentId=<attachmentId>` (Downloading attachments)
    - `POST /WebClient/Attachment/UploadAttachment?CredentialId=<CredentialId>` (Uploading attachments)
    - `POST /WebClient/CredentialAttachmentGrid/Delete?CredentialId=<CredentialId>` (Deleting attachments)
- **Vulnerable Parameters:** CredentialId, attachmentId
- **Request Methods:** HTTP GET and POST
- **CVSS Score:** 8.8 (High) - CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H