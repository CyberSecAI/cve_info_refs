=== Content from downloads.asterisk.org_5b9e7595_20250125_072905.html ===


Asterisk
Project Security Advisory - AST-2017-014

| **Product** | Asterisk |
| **Summary** | Crash in PJSIP resource when missing a contact header |
| **Nature of Advisory** | Remote Crash |
| **Susceptibility** | Remote Unauthenticated Sessions |
| **Severity** | Moderate |
| **Exploits Known** | No |
| **Reported On** | December 12, 2017 |
| **Reported By** | Ross Beer |
| **Posted On** |  |
| **Last Updated On** | December 22, 2017 |
| **Advisory Contact** | Kevin Harwell <kharwell AT digium DOT com> |
| **CVE Name** | CVE-2017-17850 |

| **Description** | A select set of SIP messages create a dialog in Asterisk. Those SIP messages must contain a contact header. For those messages, if the header was not present and using the PJSIP channel driver, it would cause Asterisk to crash. The severity of this vulnerability is somewhat mitigated if authentication is enabled. If authentication is enabled a user would have to first be authorized before reaching the crash point. |

| **Resolution** | When using the Asterisk PJSIP resource, and one of the SIP messages that create a dialog is received Asterisk now checks to see if the message contains a contact header. If it does not Asterisk now responds with a â400 Missing Contact headerâ. |

| **Affected Versions** | | |
| **Product** | **Release Series** |  |
| Asterisk Open Source | 13.x | All versions |
| Asterisk Open Source | 14.x | All versions |
| Asterisk Open Source | 15.x | All versions |
| Certified Asterisk | 13.18 | All versions |

| **Corrected In** | |
| **Product** | **Release** |
| Asterisk Open Source | 13.18.5, 14.7.5, 15.1.5 |
| Certified Asterisk | 13.18-cert2 |
|  |  |

| **Patches** | |
| **SVN URL** | **Revision** |
| http://downloads.asterisk.org/pub/security/AST-2017-014-13.diff | Asterisk 13 |
| http://downloads.asterisk.org/pub/security/AST-2017-014-14.diff | Asterisk 14 |
| http://downloads.asterisk.org/pub/security/AST-2017-014-15.diff | Asterisk 15 |
| http://downloads.asterisk.org/pub/security/AST-2017-014-13.18.diff | Certified Asterisk 13.18 |

| **Links** | https://issues.asterisk.org/jira/browse/ASTERISK-27480 |

| Asterisk Project Security Advisories are posted at <http://www.asterisk.org/security>  This document may be superseded by later versions; if so, the latest version will be posted at http://downloads.digium.com/pub/security/AST-2017-014.pdf and http://downloads.digium.com/pub/security/AST-2017-014.html |

| **Revision History** | | |
| **Date** | **Editor** | **Revisions Made** |
| December 20, 2017 | Kevin Harwell | Initial Revision |
| December 22, 2017 | Kevin Harwell | Updated with CVE |

Asterisk
Project Security Advisory - AST-2017-014
Copyright
Â© 2017
Digium, Inc. All Rights Reserved.
Permission is hereby granted
to distribute and publish this advisory in its original, unaltered
form.



=== Content from security.gentoo.org_558294a3_20250125_072906.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Asterisk: Multiple vulnerabilities — GLSA **201811-11**

Multiple vulnerabilities have been found in Asterisk, the worst of
which could result in a Denial of Service condition.

### Affected packages

| Package | **net-misc/asterisk** on all architectures |
| --- | --- |
| Affected versions | < **13.23.1** |
| Unaffected versions | >= **13.23.1** |

### Background

A Modular Open Source PBX System.

### Description

Multiple vulnerabilities have been discovered in Asterisk. Please review
the referenced CVE identifiers for details.

### Impact

A remote attacker could cause a Denial of Service condition or conduct
information gathering.

### Workaround

There is no known workaround at this time.

### Resolution

All Asterisk users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-misc/asterisk-13.23.1"

```
### References

* [CVE-2017-16671](https://nvd.nist.gov/vuln/detail/CVE-2017-16671)
* [CVE-2017-16672](https://nvd.nist.gov/vuln/detail/CVE-2017-16672)
* [CVE-2017-17850](https://nvd.nist.gov/vuln/detail/CVE-2017-17850)
* [CVE-2018-12227](https://nvd.nist.gov/vuln/detail/CVE-2018-12227)
* [CVE-2018-17281](https://nvd.nist.gov/vuln/detail/CVE-2018-17281)

**Release date**

November 24, 2018

**Latest revision**

November 24, 2018: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [636972](https://bugs.gentoo.org/show_bug.cgi?id=636972)
* [645710](https://bugs.gentoo.org/show_bug.cgi?id=645710)
* [668848](https://bugs.gentoo.org/show_bug.cgi?id=668848)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from issues.asterisk.org_1ae4d88d_20250125_072906.html ===

[[Home](/)]

| Summary: | ASTERISK-27480: Security: Authenticated SUBSCRIBE without Contact crashes asterisk | | |
| --- | --- | --- | --- |
| Reporter: | Ross Beer (rossbeer) | Labels: | patch pjsip |
| Date Opened: | 2017-12-12 08:03:42.000-0600 | Date Closed: | 2017-12-22 15:58:41.000-0600 |
| Priority: | Major | Regression? |  |
| Status: | Closed/Complete | Components: | Channels/chan\_pjsip |
| Versions: | 13.18.3 GIT | Frequency ofOccurrence | Constant |
| RelatedIssues: |  | | |
| Environment: | Fedora 23 CentOS 7 | Attachments: | ( 0) [AST-2017-014.pdf](../attachments/27/ASTERISK-27480/00-AST-2017-014.pdf)( 1) [no\_contact.diff](../attachments/27/ASTERISK-27480/01-no_contact.diff) |
| Description: | When an authenticated SUBSCRIBE without a Contact  is sent to Asterisk it crashes | | |
| Comments: | By: Asterisk Team (asteriskteam) 2017-12-12 08:03:43.527-0600Thanks for creating a report! The issue has entered the triage process. That means the issue will wait in this status until a Bug Marshal has an opportunity to review the issue. Once the issue has been reviewed you will receive comments regarding the next steps towards resolution.   A good first step is for you to review the [Asterisk Issue Guidelines|https://wiki.asterisk.org/wiki/display/AST/Asterisk+Issue+Guidelines] if you haven't already. The guidelines detail what is expected from an Asterisk issue report.   Then, if you are submitting a patch, please review the [Patch Contribution Process|https://wiki.asterisk.org/wiki/display/AST/Patch+Contribution+Process].  ---   By: George Joseph (gjoseph) 2017-12-12 08:19:57.517-0600I can reproduce easily.  In this case, the incoming subscribe packet had a chunk missing that contained the Contact and Expires headers but the Authorization header was still there and intact.  The first thing we do in ast\_sip\_create\_dialog\_uas is get the contact header and use it to set the transport selector without checking it..  ---   By: Ross Beer (rossbeer) 2017-12-21 14:59:10.956-0600Is there a patch you would like me to test for this issue?  ---   By: Kevin Harwell (kharwell) 2017-12-21 15:08:35.410-0600{quote}  Is there a patch you would like me to test for this issue?  {quote}  Yes! Give [^no\_contact.diff] a shot.  ---   By: Friendly Automation (friendly-automation) 2017-12-22 15:58:41.690-0600Change 7720 merged by Kevin Harwell:  AST-2017-014: res\_pjsip - Missing contact header can cause crash   [https://gerrit.asterisk.org/7720|https://gerrit.asterisk.org/7720]  ---   By: Friendly Automation (friendly-automation) 2017-12-22 15:58:51.482-0600Change 7721 merged by Kevin Harwell:  AST-2017-014: res\_pjsip - Missing contact header can cause crash   [https://gerrit.asterisk.org/7721|https://gerrit.asterisk.org/7721]  ---   By: Friendly Automation (friendly-automation) 2017-12-22 15:58:58.019-0600Change 7722 merged by Kevin Harwell:  AST-2017-014: res\_pjsip - Missing contact header can cause crash   [https://gerrit.asterisk.org/7722|https://gerrit.asterisk.org/7722]  ---   By: Friendly Automation (friendly-automation) 2017-12-22 15:59:11.321-0600Change 7719 merged by Kevin Harwell:  AST-2017-014: res\_pjsip - Missing contact header can cause crash   [https://gerrit.asterisk.org/7719|https://gerrit.asterisk.org/7719]  ---   By: Friendly Automation (friendly-automation) 2017-12-22 15:59:17.868-0600Change 7724 merged by Kevin Harwell:  AST-2017-014: res\_pjsip - Missing contact header can cause crash   [https://gerrit.asterisk.org/7724|https://gerrit.asterisk.org/7724]  ---   By: Friendly Automation (friendly-automation) 2017-12-22 16:15:39.455-0600Change 7727 merged by Kevin Harwell:  AST-2017-014: res\_pjsip - Missing contact header can cause crash   [https://gerrit.asterisk.org/7727|https://gerrit.asterisk.org/7727]  ---   By: Friendly Automation (friendly-automation) 2017-12-22 16:15:47.787-0600Change 7728 merged by Kevin Harwell:  AST-2017-014: res\_pjsip - Missing contact header can cause crash   [https://gerrit.asterisk.org/7728|https://gerrit.asterisk.org/7728]  ---   By: Friendly Automation (friendly-automation) 2017-12-22 16:22:39.773-0600Change 7729 merged by Kevin Harwell:  AST-2017-014: res\_pjsip - Missing contact header can cause crash   [https://gerrit.asterisk.org/7729|https://gerrit.asterisk.org/7729]  ---   By: Friendly Automation (friendly-automation) 2017-12-22 16:22:47.384-0600Change 7730 merged by Kevin Harwell:  AST-2017-014: res\_pjsip - Missing contact header can cause crash   [https://gerrit.asterisk.org/7730|https://gerrit.asterisk.org/7730]  ---   By: Friendly Automation (friendly-automation) 2017-12-22 16:22:55.455-0600Change 7731 merged by Kevin Harwell:  AST-2017-014: res\_pjsip - Missing contact header can cause crash   [https://gerrit.asterisk.org/7731|https://gerrit.asterisk.org/7731]  --- | | |


