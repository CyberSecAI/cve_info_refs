=== Content from usn.ubuntu.com_b66b23f5_20250125_025117.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3694-1: NASM vulnerabilities

28 June 2018

NASM could be made to crash or run programs if it opened a specially
crafted file.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [nasm](/security/cves?package=nasm) - General-purpose x86 assembler

## Details

It was discovered that NASM incorrectly handled certain source files. If a

user or automated system were tricked into processing a specially crafted

source file, a remote attacker could use these issues to cause NASM to

crash, resulting in a denial of service, or possibly execute arbitrary

code.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 14.04

* [nasm](https://launchpad.net/ubuntu/%2Bsource/nasm)
  -
  [2.10.09-1ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/nasm/2.10.09-1ubuntu0.1)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2017-10686](/security/CVE-2017-10686)
* [CVE-2017-11111](/security/CVE-2017-11111)
* [CVE-2017-14228](/security/CVE-2017-14228)
* [CVE-2017-17810](/security/CVE-2017-17810)
* [CVE-2017-17811](/security/CVE-2017-17811)
* [CVE-2017-17812](/security/CVE-2017-17812)
* [CVE-2017-17813](/security/CVE-2017-17813)
* [CVE-2017-17814](/security/CVE-2017-17814)
* [CVE-2017-17815](/security/CVE-2017-17815)
* [CVE-2017-17816](/security/CVE-2017-17816)
* [CVE-2017-17817](/security/CVE-2017-17817)
* [CVE-2017-17818](/security/CVE-2017-17818)
* [CVE-2017-17819](/security/CVE-2017-17819)
* [CVE-2017-17820](/security/CVE-2017-17820)
* [CVE-2018-8881](/security/CVE-2018-8881)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from repo.or.cz_2c9594d5_20250125_025114.html ===

[![git](/git-logo.png)](http://git-scm.com/ "git homepage") [repo.or.cz](/) / [nasm.git](/nasm.git) / commit

commit
grep
author
committer
pickaxe
[?](/nasm.git/search_help "search help") search:

re

[summary](/nasm.git) | [log](/nasm.git/shortlog/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9) | [graphiclog1](/git-browser/by-commit.html?r=nasm.git) | [graphiclog2](/git-browser/by-date.html?r=nasm.git) | commit | [commitdiff](/nasm.git/commitdiff/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9) | [tree](/nasm.git/tree/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9) | [refs](/nasm.git/refs) | [edit](/editproj.cgi?name=nasm.git) | [fork](/regproj.cgi?fork=nasm.git)

(parent: [6f8109e](/nasm.git/commit/6f8109ebf18e3de69a8a2ad63867fe8498e49bf0)) | [patch](/nasm.git/patch/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9)

[prepoc: Fix heap-buffer-overflow in detoken](/nasm.git/commitdiff/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9)

| commit | 9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9 |
| --- | --- |
| author | [Cyrill Gorcunov](/nasm.git/search/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9?s=Cyrill+Gorcunov;st=author "Search for commits authored by Cyrill Gorcunov") [<gorcunov@gmail.com>](/nasm.git/search/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9?s=gorcunov@gmail.com;st=author "Search for commits authored by gorcunov@gmail.com") |  |
|  | Sun, 22 Oct 2017 18:42:59 +0000 (22 21:42 +0300) |
| committer | [Cyrill Gorcunov](/nasm.git/search/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9?s=Cyrill+Gorcunov;st=committer "Search for commits committed by Cyrill Gorcunov") [<gorcunov@gmail.com>](/nasm.git/search/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9?s=gorcunov@gmail.com;st=committer "Search for commits committed by gorcunov@gmail.com") |  |
|  | Sun, 22 Oct 2017 18:42:59 +0000 (22 21:42 +0300) |
| tree | [de70785d6b73d21d1da0c4b71bf04f9b44bcdb74](/nasm.git/tree/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9) | [tree](/nasm.git/tree/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9) | snapshot ([tar.gz](/nasm.git/snapshot/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9.tar.gz) [zip](/nasm.git/snapshot/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9.zip)) |
| parent | [6f8109ebf18e3de69a8a2ad63867fe8498e49bf0](/nasm.git/commit/6f8109ebf18e3de69a8a2ad63867fe8498e49bf0) | [commit](/nasm.git/commit/6f8109ebf18e3de69a8a2ad63867fe8498e49bf0) | [diff](/nasm.git/commitdiff/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9?hp=6f8109ebf18e3de69a8a2ad63867fe8498e49bf0) |

prepoc: Fix heap-buffer-overflow in detoken

Just make sure we've a data to process.

https://bugzilla.nasm.us/show\_bug.cgi?id=[3392424](/nasm.git/object/3392424)

Signed-off-by: Cyrill Gorcunov <gorcunov@gmail.com>

| [asm/preproc.c](/nasm.git/blob/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9%3A/asm/preproc.c) |  | [diff](/nasm.git/blobdiff/6f8109ebf18e3de69a8a2ad63867fe8498e49bf0..9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9%3A/asm/preproc.c) | [blob](/nasm.git/blob/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9%3A/asm/preproc.c) | [blame](/nasm.git/blame/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9%3A/asm/preproc.c) | [history](/nasm.git/history/9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9%3A/asm/preproc.c) |
| --- | --- | --- |

The Netwide Assembler
[RSS](/nasm.git/rss "log RSS feed")
[Atom](/nasm.git/atom "log Atom feed")



=== Content from bugzilla.nasm.us_fb625602_20250125_025116.html ===


Bugzilla – Bug 3392424
There is a heap based buffer overflow in function detoken() of nasm
Last modified: 2017-10-22 14:44:39 PDT

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](docs/en/html/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=3392424&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=3392424&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

Self-registration is disabled due to spam issue (mail gorcunov@gmail.com or hpa@zytor.com to create an account)

[**Bug 3392424**](show_bug.cgi?id=3392424)
- There is a heap based buffer overflow in function detoken() of nasm

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
There is a heap based buffer overflow in function detoken() of nasm

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | NASM | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=NASM "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Assembler ([show other bugs](buglist.cgi?component=Assembler&product=NASM&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | Medium blocker | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | nobody | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-08-28 04:01 PDT by owl337 | | --- | --- | | Modified: | 2017-10-22 14:44 PDT ([History](show_activity.cgi?id=3392424)) | | CC List: | 3 users (show)  gorcunov hpa nasm-bugs | |  | | | [Obtained from:](page.cgi?id=fields.html#cf_build "Please indicate where you obtained and/or built your version of NASM.") | Binary from nasm.us | | [Generated by:](page.cgi?id=fields.html#cf_robot "Was this bug report generated by an automatic tool, such as a memory leak detector or fuzzer, *without* including a human validation description or analysis of the problem?") | --- | | [Bug category:](page.cgi?id=fields.html#cf_category "The general category of this bug oor request.") |  | | [Breaks existing code:](page.cgi?id=fields.html#cf_breaks "This bug report breaks existing code in production or under development.") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Triggered by " ./nasm -f bin POC4 -o tmp "**](attachment.cgi?id=411602 "View the content of the attachment") (630 bytes, application/x-rar)  [2017-08-28 04:01 PDT](#attach_411602 "Go to the comment associated with the attachment"), owl337 | [Details](attachment.cgi?id=411602&action=edit) | | [Add an attachment](attachment.cgi?bugid=3392424&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=3392424&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=3392424#c0)  owl337    2017-08-28 04:01:29 PDT  ``` Created [attachment 411602](attachment.cgi?id=411602 "Triggered by \" ./nasm -f bin  POC4 -o tmp \"") [[details]](attachment.cgi?id=411602&action=edit "Triggered by \" ./nasm -f bin  POC4 -o tmp \"") Triggered by " ./nasm -f bin  POC4 -o tmp "  Description:  The debugging information is as follows:  $ ./nasm -f bin  POC4 -o tmp  id:000244,sig:11,src:003034,op:havoc,rep:4:6: warning: unterminated string id:000244,sig:11,src:003034,op:havoc,rep:4:13: warning: unterminated %{ construct id:000244,sig:11,src:003034,op:havoc,rep:4:20: error: parser: instruction expected id:000244,sig:11,src:003034,op:havoc,rep:4:25: error: (b_struc:3) `'1': parameter identifier expected id:000244,sig:11,src:003034,op:havoc,rep:4:7: ... from macro `b_struc' defined here id:000244,sig:11,src:003034,op:havoc,rep:4:25: warning: forward reference in RESx can have unpredictable results id:000244,sig:11,src:003034,op:havoc,rep:4:13: ... from macro `b_struc' defined here ... Segmentation fault   The GDB debugging information is as follows:  (gdb)set args -f bin  POC4 -o tmp (gdb) r ... Breakpoint 4, detoken (expand_locals=false, tlist=<optimized out>) at asm/preproc.c:1255 1255	        if (t->type == TOK_PREPROC_ID && t->text[1] == '!') { (gdb) c 355  Will ignore next 354 crossings of breakpoint 4.  Continuing. id:000244,sig:11,src:003034,op:havoc,rep:4:6: warning: unterminated string id:000244,sig:11,src:003034,op:havoc,rep:4:13: warning: unterminated %{ construct id:000244,sig:11,src:003034,op:havoc,rep:4:20: error: parser: instruction expected id:000244,sig:11,src:003034,op:havoc,rep:4:25: error: (b_struc:3) `'1': parameter identifier expected id:000244,sig:11,src:003034,op:havoc,rep:4:7: ... from macro `b_struc' defined here id:000244,sig:11,src:003034,op:havoc,rep:4:25: warning: forward reference in RESx can have unpredictable results id:000244,sig:11,src:003034,op:havoc,rep:4:13: ... from macro `b_struc' defined here id:000244,sig:11,src:003034,op:havoc,rep:4:25: warning: forward reference in RESx can have unpredictable results ... Breakpoint 4, detoken (expand_locals=false, tlist=<optimized out>) at asm/preproc.c:1255 1255	        if (t->type == TOK_PREPROC_ID && t->text[1] == '!') { (gdb) s 1288	        if (expand_locals && ... (gdb) s 1254	    list_for_each(t, tlist) { (gdb) s  ================================================================= ==86909==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000010891 at pc 0x53214e bp 0x7fffffffde30 sp 0x7fffffffde28 READ of size 1 at 0x602000010891 thread T0  ==86909==WARNING: Trying to symbolize code, but external symbolizer is not initialized!     #0 0x53214d (/home/company/check_nasm/nasm-2.14rc0/install_asan/bin/nasm+0x53214d)     #1 0x5195c8 (/home/company/check_nasm/nasm-2.14rc0/install_asan/bin/nasm+0x5195c8)     #2 0x483516 (/home/company/check_nasm/nasm-2.14rc0/install_asan/bin/nasm+0x483516)     #3 0x7ffff6ee6a3f (/lib/x86_64-linux-gnu/libc.so.6+0x20a3f)     #4 0x47e7e8 (/home/company/check_nasm/nasm-2.14rc0/install_asan/bin/nasm+0x47e7e8)  0x602000010891 is located 0 bytes to the right of 1-byte region [0x602000010890,0x602000010891) allocated by thread T0 here:     #0 0x4686f9 (/home/company/check_nasm/nasm-2.14rc0/install_asan/bin/nasm+0x4686f9)     #1 0x49b6a8 (/home/company/check_nasm/nasm-2.14rc0/install_asan/bin/nasm+0x49b6a8)  SUMMARY: AddressSanitizer: heap-buffer-overflow ??:0 ?? Shadow bytes around the buggy address:   0x0c047fffa0c0: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa   0x0c047fffa0d0: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa   0x0c047fffa0e0: fa fa 02 fa fa fa 02 fa fa fa 00 fa fa fa 02 fa   0x0c047fffa0f0: fa fa 03 fa fa fa 03 fa fa fa 03 fa fa fa 03 fa   0x0c047fffa100: fa fa 03 fa fa fa 03 fa fa fa 03 fa fa fa 07 fa =>0x0c047fffa110: fa fa[01]fa fa fa fd fd fa fa 02 fa fa fa fd fa   0x0c047fffa120: fa fa fd fa fa fa 06 fa fa fa 06 fa fa fa 02 fa   0x0c047fffa130: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa   0x0c047fffa140: fa fa fd fa fa fa fd fa fa fa fd fa fa fa 00 fa   0x0c047fffa150: fa fa 00 fa fa fa 06 fa fa fa 00 fa fa fa 00 fa   0x0c047fffa160: fa fa 06 fa fa fa 02 fa fa fa 04 fa fa fa 04 fa Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07    Heap left redzone:     fa   Heap right redzone:    fb   Freed heap region:     fd   Stack left redzone:    f1   Stack mid redzone:     f2   Stack right redzone:   f3   Stack partial redzone: f4   Stack after return:    f5   Stack use after scope: f8   Global redzone:        f9   Global init order:     f6   Poisoned by user:      f7   ASan internal:         fe ==86909==ABORTING [Inferior 1 (process 86909) exited with code 01] (gdb)   The bug was trigged in: detoken (expand_locals=false, tlist=<optimized out>) at asm/preproc.c:1254 1254	        if (t->type == TOK_PREPROC_ID && t->text[1] == '!') { (gdb) list  1250	    char *line, *p; 1251	    const char *q; 1252	    int len = 0; 1253	 1254	    list_for_each(t, tlist) { 1255	        if (t->type == TOK_PREPROC_ID && t->text[1] == '!') { 1256	            char *v; 1257	            char *q = t->text; 1258	 1259	            v = t->text + 2;    Credits:  This vulnerability is detected by team OWL337, with our custom fuzzer collAFL. Please contact ganshuitao@gmail.com   and chaoz@tsinghua.edu.cn if you need more info about the team, the tool or the vulnerability. ```  [Comment 1](show_bug.cgi?id=3392424#c1)  Cyrill Gorcunov    2017-10-22 14:44:39 PDT  ``` commit 9b7ee09abfd426b99aa1ea81d19a3b2818eeabf9 Author: Cyrill Gorcunov <gorcunov@gmail.com> Date:   Sun Oct 22 21:42:59 2017 +0300      prepoc: Fix heap-buffer-overflow in detoken          Just make sure we've a data to process.          [https://bugzilla.nasm.us/show_bug.cgi?id=3392424](show_bug.cgi?id=3392424 "RESOLVED FIXED - There is a heap based buffer overflow in function detoken() of nasm")          Signed-off-by: Cyrill Gorcunov <gorcunov@gmail.com>  ---  Thanks for report. Note there are a numbed of leaks in other places remains but this particular one is fixed. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3392424)
* - [XML](show_bug.cgi?ctype=xml&id=3392424)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3392424)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](docs/en/html/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=3392424&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=3392424&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


