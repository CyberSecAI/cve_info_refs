The provided content is a commit diff for `custom/run.cgi` in the Webmin project. The commit message "HTML escape command description" suggests a fix related to HTML escaping. Let's analyze the changes in the diff:

**Root cause of vulnerability:**

The vulnerability stems from a lack of proper HTML escaping of the `cmd->{'desc'}` variable before it's used in the HTML output within the `custom/run.cgi` script. This means that if the command description contains special HTML characters, they would be interpreted as HTML code rather than displayed literally.

**Weaknesses/vulnerabilities present:**

- **Cross-Site Scripting (XSS):** The vulnerability is an XSS vulnerability. Specifically, it's a reflected XSS vulnerability since the command description is reflected back to the user in the output. Without proper escaping, a malicious user could inject arbitrary HTML or JavaScript into the command description, leading to the execution of the attacker's code in the victim's browser.

**Impact of exploitation:**

An attacker who controls the command description input could inject malicious JavaScript code. This code would then be executed in the browsers of users viewing the page, leading to various harmful activities:
-   Session hijacking
-   Stealing sensitive data (cookies, session tokens)
-   Redirecting users to malicious websites
-   Defacing websites
-   Performing actions on behalf of the user

**Attack vectors:**

The attack vector is a crafted command description provided as input to the custom command execution feature in webmin.

**Required attacker capabilities/position:**

The attacker would need the ability to create or modify a custom command which can set the `desc` parameter to a value containing malicious html, or access the webmin configuration to change a description used in the context. This would typically require administrative privileges within the webmin environment.

**Additional Details:**

The diff shows the following changes:
- The line `&ui_print_unbuffered_header($cmd->{'desc'}, $text{'run_title'}, "", -d "help" ? "run" : undef);` has been removed.
- The line `&ui_print_unbuffered_header( &html_escape($cmd->{'desc'}), $text{'run_title'}, "", -d "help" ? "run" : undef);` has been added.

The key change is the addition of `&html_escape` around `$cmd->{'desc'}`. This ensures that HTML characters in the description are converted to their corresponding HTML entities, preventing the browser from interpreting them as code.