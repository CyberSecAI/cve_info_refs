=== Content from usn.ubuntu.com_57df2232_20250125_210647.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3619-2: Linux kernel (Xenial HWE) vulnerabilities

5 April 2018

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [linux-aws](/security/cves?package=linux-aws) - Linux kernel for Amazon Web Services (AWS) systems
* [linux-lts-xenial](/security/cves?package=linux-lts-xenial) - Linux hardware enablement kernel from Xenial for Trusty

## Details

USN-3619-1 fixed vulnerabilities in the Linux kernel for Ubuntu 16.04

LTS. This update provides the corresponding updates for the Linux

Hardware Enablement (HWE) kernel from Ubuntu 16.04 LTS for Ubuntu

14.04 LTS.

Jann Horn discovered that the Berkeley Packet Filter (BPF) implementation

in the Linux kernel improperly performed sign extension in some situations.

A local attacker could use this to cause a denial of service (system crash)

or possibly execute arbitrary code. ([CVE-2017-16995](/security/CVE-2017-16995))

It was discovered that a race condition leading to a use-after-free

vulnerability existed in the ALSA PCM subsystem of the Linux kernel. A

local attacker could use this to cause a denial of service (system crash)

or possibly execute arbitrary code. ([CVE-2017-0861](/security/CVE-2017-0861))

It was discovered that the KVM implementation in the Linux kernel allowed

passthrough of the diagnostic I/O port 0x80. An attacker in a guest VM

could use this to cause a denial of service (system crash) in the host OS.

([CVE-2017-1000407](/security/CVE-2017-1000407))

It was discovered that an information disclosure vulnerability existed in

the ACPI implementation of the Linux kernel. A local attacker could use

this to expose sensitive information (kernel memory addresses).

([CVE-2017-11472](/security/CVE-2017-11472))

It was discovered that a use-after-free vulnerability existed in the

network namespaces implementation in the Linux kernel. A local attacker

could use this to cause a denial of service (system crash) or possibly

execute arbitrary code. ([CVE-2017-15129](/security/CVE-2017-15129))

It was discovered that the Advanced Linux Sound Architecture (ALSA)

subsystem in the Linux kernel contained a use-after-free when handling

device removal. A physically proximate attacker could use this to cause a

denial of service (system crash) or possibly execute arbitrary code.

([CVE-2017-16528](/security/CVE-2017-16528))

Andrey Konovalov discovered that the usbtest device driver in the Linux

kernel did not properly validate endpoint metadata. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2017-16532](/security/CVE-2017-16532))

Andrey Konovalov discovered that the Conexant cx231xx USB video capture

driver in the Linux kernel did not properly validate interface descriptors.

A physically proximate attacker could use this to cause a denial of service

(system crash). ([CVE-2017-16536](/security/CVE-2017-16536))

Andrey Konovalov discovered that the SoundGraph iMON USB driver in the

Linux kernel did not properly validate device metadata. A physically

proximate attacker could use this to cause a denial of service (system

crash). ([CVE-2017-16537](/security/CVE-2017-16537))

Andrey Konovalov discovered that the IMS Passenger Control Unit USB driver

in the Linux kernel did not properly validate device descriptors. A

physically proximate attacker could use this to cause a denial of service

(system crash). ([CVE-2017-16645](/security/CVE-2017-16645))

Andrey Konovalov discovered that the DiBcom DiB0700 USB DVB driver in the

Linux kernel did not properly handle detach events. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2017-16646](/security/CVE-2017-16646))

Andrey Konovalov discovered that the CDC USB Ethernet driver did not

properly validate device descriptors. A physically proximate attacker could

use this to cause a denial of service (system crash). ([CVE-2017-16649](/security/CVE-2017-16649))

Andrey Konovalov discovered that the QMI WWAN USB driver did not properly

validate device descriptors. A physically proximate attacker could use this

to cause a denial of service (system crash). ([CVE-2017-16650](/security/CVE-2017-16650))

It was discovered that the USB Virtual Host Controller Interface (VHCI)

driver in the Linux kernel contained an information disclosure

vulnerability. A physically proximate attacker could use this to expose

sensitive information (kernel memory). ([CVE-2017-16911](/security/CVE-2017-16911))

It was discovered that the USB over IP implementation in the Linux kernel

did not validate endpoint numbers. A remote attacker could use this to

cause a denial of service (system crash). ([CVE-2017-16912](/security/CVE-2017-16912))

It was discovered that the USB over IP implementation in the Linux kernel

did not properly validate CMD\_SUBMIT packets. A remote attacker could use

this to cause a denial of service (excessive memory consumption).

([CVE-2017-16913](/security/CVE-2017-16913))

It was discovered that the USB over IP implementation in the Linux kernel

contained a NULL pointer dereference error. A remote attacker could use

this to cause a denial of service (system crash). ([CVE-2017-16914](/security/CVE-2017-16914))

It was discovered that the HugeTLB component of the Linux kernel did not

properly handle holes in hugetlb ranges. A local attacker could use this to

expose sensitive information (kernel memory). ([CVE-2017-16994](/security/CVE-2017-16994))

It was discovered that the netfilter component of the Linux did not

properly restrict access to the connection tracking helpers list. A local

attacker could use this to bypass intended access restrictions.

([CVE-2017-17448](/security/CVE-2017-17448))

It was discovered that the netlink subsystem in the Linux kernel did not

properly restrict observations of netlink messages to the appropriate net

namespace. A local attacker could use this to expose sensitive information

(kernel netlink traffic). ([CVE-2017-17449](/security/CVE-2017-17449))

It was discovered that the netfilter passive OS fingerprinting (xt\_osf)

module did not properly perform access control checks. A local attacker

could improperly modify the system-wide OS fingerprint list.

([CVE-2017-17450](/security/CVE-2017-17450))

It was discovered that the core USB subsystem in the Linux kernel did not

validate the number of configurations and interfaces in a device. A

physically proximate attacker could use this to cause a denial of service

(system crash). ([CVE-2017-17558](/security/CVE-2017-17558))

Dmitry Vyukov discovered that the KVM implementation in the Linux kernel

contained an out-of-bounds read when handling memory-mapped I/O. A local

attacker could use this to expose sensitive information. ([CVE-2017-17741](/security/CVE-2017-17741))

It was discovered that the Salsa20 encryption algorithm implementations in

the Linux kernel did not properly handle zero-length inputs. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2017-17805](/security/CVE-2017-17805))

It was discovered that the HMAC implementation did not validate the state

of the underlying cryptographic hash algorithm. A local attacker could use

this to cause a denial of service (system crash) or possibly execute

arbitrary code. ([CVE-2017-17806](/security/CVE-2017-17806))

It was discovered that the keyring implementation in the Linux kernel did

not properly check permissions when a key request was performed on a task's

default keyring. A local attacker could use this to add keys to

unauthorized keyrings. ([CVE-2017-17807](/security/CVE-2017-17807))

Alexei Starovoitov discovered that the Berkeley Packet Filter (BPF)

implementation in the Linux kernel contained a branch-pruning logic issue

around unreachable code. A local attacker could use this to cause a denial

of service. ([CVE-2017-17862](/security/CVE-2017-17862))

It was discovered that the parallel cryptography component of the Linux

kernel incorrectly freed kernel memory. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2017-18075](/security/CVE-2017-18075))

It was discovered that a race condition existed in the Device Mapper

component of the Linux kernel. A local attacker could use this to cause a

denial of service (system crash). ([CVE-2017-18203](/security/CVE-2017-18203))

It was discovered that a race condition existed in the OCFS2 file system

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (kernel deadlock). ([CVE-2017-18204](/security/CVE-2017-18204))

It was discovered that an infinite loop could occur in the madvise(2)

implementation in the Linux kernel in certain circumstances. A local

attacker could use this to cause a denial of service (system hang).

([CVE-2017-18208](/security/CVE-2017-18208))

Andy Lutomirski discovered that the KVM implementation in the Linux kernel

was vulnerable to a debug exception error when single-stepping through a

syscall. A local attacker in a non-Linux guest vm could possibly use this

to gain administrative privileges in the guest vm. ([CVE-2017-7518](/security/CVE-2017-7518))

It was discovered that the Broadcom NetXtremeII ethernet driver in the

Linux kernel did not properly validate Generic Segment Offload (GSO) packet

sizes. An attacker could use this to cause a denial of service (interface

unavailability). ([CVE-2018-1000026](/security/CVE-2018-1000026))

It was discovered that the Reliable Datagram Socket (RDS) implementation in

the Linux kernel contained an out-of-bounds write during RDMA page

allocation. An attacker could use this to cause a denial of service (system

crash) or possibly execute arbitrary code. ([CVE-2018-5332](/security/CVE-2018-5332))

Mohamed Ghannam discovered a null pointer dereference in the RDS (Reliable

Datagram Sockets) protocol implementation of the Linux kernel. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2018-5333](/security/CVE-2018-5333))

范龙飞 discovered that a race condition existed in loop block device

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2018-5344](/security/CVE-2018-5344))

It was discovered that an integer overflow error existed in the futex

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash). ([CVE-2018-6927](/security/CVE-2018-6927))

It was discovered that a NULL pointer dereference existed in the RDS

(Reliable Datagram Sockets) protocol implementation in the Linux kernel. A

local attacker could use this to cause a denial of service (system crash).

([CVE-2018-7492](/security/CVE-2018-7492))

It was discovered that the Broadcom UniMAC MDIO bus controller driver in

the Linux kernel did not properly validate device resources. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2018-8043](/security/CVE-2018-8043))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 14.04

* [linux-image-4.4.0-1016-aws](https://launchpad.net/ubuntu/%2Bsource/linux-aws)
  -
  [4.4.0-1016.16](https://launchpad.net/ubuntu/%2Bsource/linux-aws/4.4.0-1016.16)
* [linux-image-4.4.0-119-generic](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial)
  -
  [4.4.0-119.143~14.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial/4.4.0-119.143~14.04.1)
* [linux-image-4.4.0-119-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial)
  -
  [4.4.0-119.143~14.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial/4.4.0-119.143~14.04.1)
* [linux-image-4.4.0-119-lowlatency](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial)
  -
  [4.4.0-119.143~14.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial/4.4.0-119.143~14.04.1)
* [linux-image-4.4.0-119-powerpc-e500mc](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial)
  -
  [4.4.0-119.143~14.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial/4.4.0-119.143~14.04.1)
* [linux-image-4.4.0-119-powerpc-smp](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial)
  -
  [4.4.0-119.143~14.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial/4.4.0-119.143~14.04.1)
* [linux-image-4.4.0-119-powerpc64-emb](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial)
  -
  [4.4.0-119.143~14.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial/4.4.0-119.143~14.04.1)
* [linux-image-4.4.0-119-powerpc64-smp](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial)
  -
  [4.4.0-119.143~14.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-lts-xenial/4.4.0-119.143~14.04.1)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2017-0861](/security/CVE-2017-0861)
* [CVE-2017-1000407](/security/CVE-2017-1000407)
* [CVE-2017-11472](/security/CVE-2017-11472)
* [CVE-2017-15129](/security/CVE-2017-15129)
* [CVE-2017-16528](/security/CVE-2017-16528)
* [CVE-2017-16532](/security/CVE-2017-16532)
* [CVE-2017-16536](/security/CVE-2017-16536)
* [CVE-2017-16537](/security/CVE-2017-16537)
* [CVE-2017-16645](/security/CVE-2017-16645)
* [CVE-2017-16646](/security/CVE-2017-16646)
* [CVE-2017-16649](/security/CVE-2017-16649)
* [CVE-2017-16650](/security/CVE-2017-16650)
* [CVE-2017-16911](/security/CVE-2017-16911)
* [CVE-2017-16912](/security/CVE-2017-16912)
* [CVE-2017-16913](/security/CVE-2017-16913)
* [CVE-2017-16914](/security/CVE-2017-16914)
* [CVE-2017-16994](/security/CVE-2017-16994)
* [CVE-2017-16995](/security/CVE-2017-16995)
* [CVE-2017-17448](/security/CVE-2017-17448)
* [CVE-2017-17449](/security/CVE-2017-17449)
* [CVE-2017-17450](/security/CVE-2017-17450)
* [CVE-2017-17558](/security/CVE-2017-17558)
* [CVE-2017-17741](/security/CVE-2017-17741)
* [CVE-2017-17805](/security/CVE-2017-17805)
* [CVE-2017-17806](/security/CVE-2017-17806)
* [CVE-2017-17807](/security/CVE-2017-17807)
* [CVE-2017-17862](/security/CVE-2017-17862)
* [CVE-2017-18075](/security/CVE-2017-18075)
* [CVE-2017-18203](/security/CVE-2017-18203)
* [CVE-2017-18204](/security/CVE-2017-18204)
* [CVE-2017-18208](/security/CVE-2017-18208)
* [CVE-2017-7518](/security/CVE-2017-7518)
* [CVE-2018-1000026](/security/CVE-2018-1000026)
* [CVE-2018-5332](/security/CVE-2018-5332)
* [CVE-2018-5333](/security/CVE-2018-5333)
* [CVE-2018-5344](/security/CVE-2018-5344)
* [CVE-2018-6927](/security/CVE-2018-6927)
* [CVE-2018-7492](/security/CVE-2018-7492)
* [CVE-2018-8043](/security/CVE-2018-8043)

## Related notices

* [USN-3583-2](/security/notices/USN-3583-2)
* [USN-3617-1](/security/notices/USN-3617-1)
* [USN-3619-1](/security/notices/USN-3619-1)
* [USN-3617-3](/security/notices/USN-3617-3)
* [USN-3617-2](/security/notices/USN-3617-2)
* [USN-3632-1](/security/notices/USN-3632-1)
* [USN-3583-1](/security/notices/USN-3583-1)
* [USN-3754-1](/security/notices/USN-3754-1)
* [USN-3822-2](/security/notices/USN-3822-2)
* [USN-3822-1](/security/notices/USN-3822-1)
* [USN-3523-2](/security/notices/USN-3523-2)
* [USN-3633-1](/security/notices/USN-3633-1)
* [USN-3523-1](/security/notices/USN-3523-1)
* [USN-3523-3](/security/notices/USN-3523-3)
* [USN-3620-1](/security/notices/USN-3620-1)
* [USN-3620-2](/security/notices/USN-3620-2)
* [USN-3653-1](/security/notices/USN-3653-1)
* [USN-3657-1](/security/notices/USN-3657-1)
* [USN-3655-1](/security/notices/USN-3655-1)
* [USN-3653-2](/security/notices/USN-3653-2)
* [USN-3655-2](/security/notices/USN-3655-2)
* [USN-3698-2](/security/notices/USN-3698-2)
* [USN-3697-1](/security/notices/USN-3697-1)
* [USN-3698-1](/security/notices/USN-3698-1)
* [USN-3697-2](/security/notices/USN-3697-2)
* [USN-3674-2](/security/notices/USN-3674-2)
* [USN-3674-1](/security/notices/USN-3674-1)
* [USN-3677-1](/security/notices/USN-3677-1)
* [USN-3677-2](/security/notices/USN-3677-2)
* [USN-3630-2](/security/notices/USN-3630-2)
* [USN-3630-1](/security/notices/USN-3630-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from usn.ubuntu.com_f16c8f2b_20250125_210646.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3617-3: Linux kernel (Raspberry Pi 2) vulnerabilities

4 April 2018

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 17.10](/security/notices?release=artful)

## Packages

* [linux-raspi2](/security/cves?package=linux-raspi2) - Linux kernel for Raspberry Pi 2

## Details

It was discovered that a race condition leading to a use-after-free

vulnerability existed in the ALSA PCM subsystem of the Linux kernel. A

local attacker could use this to cause a denial of service (system crash)

or possibly execute arbitrary code. ([CVE-2017-0861](/security/CVE-2017-0861))

It was discovered that a use-after-free vulnerability existed in the

network namespaces implementation in the Linux kernel. A local attacker

could use this to cause a denial of service (system crash) or possibly

execute arbitrary code. ([CVE-2017-15129](/security/CVE-2017-15129))

Andrey Konovalov discovered that the usbtest device driver in the Linux

kernel did not properly validate endpoint metadata. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2017-16532](/security/CVE-2017-16532))

Andrey Konovalov discovered that the SoundGraph iMON USB driver in the

Linux kernel did not properly validate device metadata. A physically

proximate attacker could use this to cause a denial of service (system

crash). ([CVE-2017-16537](/security/CVE-2017-16537))

Andrey Konovalov discovered that the IMS Passenger Control Unit USB driver

in the Linux kernel did not properly validate device descriptors. A

physically proximate attacker could use this to cause a denial of service

(system crash). ([CVE-2017-16645](/security/CVE-2017-16645))

Andrey Konovalov discovered that the DiBcom DiB0700 USB DVB driver in the

Linux kernel did not properly handle detach events. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2017-16646](/security/CVE-2017-16646))

Andrey Konovalov discovered that the ASIX Ethernet USB driver in the Linux

kernel did not properly handle suspend and resume events. A physically

proximate attacker could use this to cause a denial of service (system

crash). ([CVE-2017-16647](/security/CVE-2017-16647))

Andrey Konovalov discovered that the CDC USB Ethernet driver did not

properly validate device descriptors. A physically proximate attacker could

use this to cause a denial of service (system crash). ([CVE-2017-16649](/security/CVE-2017-16649))

Andrey Konovalov discovered that the QMI WWAN USB driver did not properly

validate device descriptors. A physically proximate attacker could use this

to cause a denial of service (system crash). ([CVE-2017-16650](/security/CVE-2017-16650))

It was discovered that the HugeTLB component of the Linux kernel did not

properly handle holes in hugetlb ranges. A local attacker could use this to

expose sensitive information (kernel memory). ([CVE-2017-16994](/security/CVE-2017-16994))

It was discovered that the netfilter component of the Linux did not

properly restrict access to the connection tracking helpers list. A local

attacker could use this to bypass intended access restrictions.

([CVE-2017-17448](/security/CVE-2017-17448))

It was discovered that the netfilter passive OS fingerprinting (xt\_osf)

module did not properly perform access control checks. A local attacker

could improperly modify the system-wide OS fingerprint list.

([CVE-2017-17450](/security/CVE-2017-17450))

Dmitry Vyukov discovered that the KVM implementation in the Linux kernel

contained an out-of-bounds read when handling memory-mapped I/O. A local

attacker could use this to expose sensitive information. ([CVE-2017-17741](/security/CVE-2017-17741))

It was discovered that the Salsa20 encryption algorithm implementations in

the Linux kernel did not properly handle zero-length inputs. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2017-17805](/security/CVE-2017-17805))

It was discovered that the HMAC implementation did not validate the state

of the underlying cryptographic hash algorithm. A local attacker could use

this to cause a denial of service (system crash) or possibly execute

arbitrary code. ([CVE-2017-17806](/security/CVE-2017-17806))

It was discovered that the keyring implementation in the Linux kernel did

not properly check permissions when a key request was performed on a task's

default keyring. A local attacker could use this to add keys to

unauthorized keyrings. ([CVE-2017-17807](/security/CVE-2017-17807))

It was discovered that a race condition existed in the OCFS2 file system

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (kernel deadlock). ([CVE-2017-18204](/security/CVE-2017-18204))

It was discovered that the Broadcom NetXtremeII ethernet driver in the

Linux kernel did not properly validate Generic Segment Offload (GSO) packet

sizes. An attacker could use this to cause a denial of service (interface

unavailability). ([CVE-2018-1000026](/security/CVE-2018-1000026))

It was discovered that the Reliable Datagram Socket (RDS) implementation in

the Linux kernel contained an out-of-bounds write during RDMA page allocation. An

attacker could use this to cause a denial of service (system crash) or

possibly execute arbitrary code. ([CVE-2018-5332](/security/CVE-2018-5332))

Mohamed Ghannam discovered a null pointer dereference in the RDS (Reliable

Datagram Sockets) protocol implementation of the Linux kernel. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2018-5333](/security/CVE-2018-5333))

范龙飞 discovered that a race condition existed in loop block device

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2018-5344](/security/CVE-2018-5344))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 17.10

* [linux-image-4.13.0-1016-raspi2](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2)
  -
  [4.13.0-1016.17](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2/4.13.0-1016.17)
* [linux-image-raspi2](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2)
  -
  [4.13.0.1016.14](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2/4.13.0-1016.17)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2017-0861](/security/CVE-2017-0861)
* [CVE-2017-15129](/security/CVE-2017-15129)
* [CVE-2017-16532](/security/CVE-2017-16532)
* [CVE-2017-16537](/security/CVE-2017-16537)
* [CVE-2017-16645](/security/CVE-2017-16645)
* [CVE-2017-16646](/security/CVE-2017-16646)
* [CVE-2017-16647](/security/CVE-2017-16647)
* [CVE-2017-16649](/security/CVE-2017-16649)
* [CVE-2017-16650](/security/CVE-2017-16650)
* [CVE-2017-16994](/security/CVE-2017-16994)
* [CVE-2017-17448](/security/CVE-2017-17448)
* [CVE-2017-17450](/security/CVE-2017-17450)
* [CVE-2017-17741](/security/CVE-2017-17741)
* [CVE-2017-17805](/security/CVE-2017-17805)
* [CVE-2017-17806](/security/CVE-2017-17806)
* [CVE-2017-17807](/security/CVE-2017-17807)
* [CVE-2017-18204](/security/CVE-2017-18204)
* [CVE-2018-1000026](/security/CVE-2018-1000026)
* [CVE-2018-5332](/security/CVE-2018-5332)
* [CVE-2018-5333](/security/CVE-2018-5333)
* [CVE-2018-5344](/security/CVE-2018-5344)

## Related notices

* [USN-3583-2](/security/notices/USN-3583-2)
* [USN-3619-2](/security/notices/USN-3619-2)
* [USN-3617-1](/security/notices/USN-3617-1)
* [USN-3619-1](/security/notices/USN-3619-1)
* [USN-3617-2](/security/notices/USN-3617-2)
* [USN-3632-1](/security/notices/USN-3632-1)
* [USN-3583-1](/security/notices/USN-3583-1)
* [USN-3754-1](/security/notices/USN-3754-1)
* [USN-3822-2](/security/notices/USN-3822-2)
* [USN-3822-1](/security/notices/USN-3822-1)
* [USN-3620-1](/security/notices/USN-3620-1)
* [USN-3620-2](/security/notices/USN-3620-2)
* [USN-3655-1](/security/notices/USN-3655-1)
* [USN-3655-2](/security/notices/USN-3655-2)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.kernel.org_03ffd909_20250125_210656.html ===
commit 5fd159e1ee6a87a72626139813034f24f047d0e6
Author: Greg Kroah-Hartman
Date: Thu Dec 14 09:53:15 2017 +0100
Linux 4.14.6
commit 80e642c066f9882007174be870c1465f69df8257
Author: David Howells
Date: Thu Nov 2 15:27:48 2017 +0000
afs: Connect up the CB.ProbeUuid
[ Upstream commit f4b3526d83c40dd8bf5948b9d7a1b2c340f0dcc8 ]
The handler for the CB.ProbeUuid operation in the cache manager is
implemented, but isn't listed in the switch-statement of operation
selection, so won't be used. Fix this by adding it.
Signed-off-by: David Howells
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 49e186e3278d0d800021b59286dc97d748593fd6
Author: David Howells
Date: Thu Nov 2 15:27:51 2017 +0000
afs: Fix total-length calculation for multiple-page send
[ Upstream commit 1199db603511d7463d9d3840f96f61967affc766 ]
Fix the total-length calculation in afs\_make\_call() when the operation
being dispatched has data from a series of pages attached.
Despite the patched code looking like that it should reduce mathematically
to the current code, it doesn't because the 32-bit unsigned arithmetic
being used to calculate the page-offset-difference doesn't correctly extend
to a 64-bit value when the result is effectively negative.
Without this, some FS.StoreData operations that span multiple pages fail,
reporting too little or too much data.
Signed-off-by: David Howells
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit d702be100eaf043b97687c050565c154a48d763d
Author: Majd Dibbiny
Date: Mon Oct 30 14:23:13 2017 +0200
IB/mlx5: Assign send CQ and recv CQ of UMR QP
[ Upstream commit 31fde034a8bd964a5c7c1a5663fc87a913158db2 ]
The UMR's QP is created by calling mlx5\_ib\_create\_qp directly, and
therefore the send CQ and the recv CQ on the ibqp weren't assigned.
Assign them right after calling the mlx5\_ib\_create\_qp to assure
that any access to those pointers will work as expected and won't
crash the system as might happen as part of reset flow.
Fixes: e126ba97dba9 ("mlx5: Add driver for Mellanox Connect-IB adapters")
Signed-off-by: Majd Dibbiny
Reviewed-by: Yishai Hadas
Signed-off-by: Leon Romanovsky
Signed-off-by: Doug Ledford
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 192c689319429672e15d73969fa0230e7379779a
Author: Mark Bloch
Date: Thu Nov 2 15:22:26 2017 +0200
IB/mlx4: Increase maximal message size under UD QP
[ Upstream commit 5f22a1d87c5315a98981ecf93cd8de226cffe6ca ]
Maximal message should be used as a limit to the max message payload allowed,
without the headers. The ConnectX-3 check is done against this value includes
the headers. When the payload is 4K this will cause the NIC to drop packets.
Increase maximal message to 8K as workaround, this shouldn't change current
behaviour because we continue to set the MTU to 4k.
To reproduce;
set MTU to 4296 on the corresponding interface, for example:
ifconfig eth0 mtu 4296 (both server and client)
On server:
ib\_send\_bw -c UD -d mlx4\_0 -s 4096 -n 1000000 -i1 -m 4096
On client:
ib\_send\_bw -d mlx4\_0 -c UD  -s 4096 -n 1000000 -i 1 -m 4096
Fixes: 6e0d733d9215 ("IB/mlx4: Allow 4K messages for UD QPs")
Signed-off-by: Mark Bloch
Reviewed-by: Majd Dibbiny
Signed-off-by: Leon Romanovsky
Signed-off-by: Doug Ledford
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 971110c72991c9c4662d0abf48bd6275b7e211f7
Author: Sriharsha Basavapatna
Date: Fri Nov 3 02:39:04 2017 +0530
bnxt\_re: changing the ip address shouldn't affect new connections
[ Upstream commit 063fb5bd1a01937094f40169a20e4aa5ca030db1 ]
While adding a new gid, the driver currently does not return the context
back to the stack. A subsequent del\_gid() (e.g, when ip address is changed)
doesn't find the right context in the driver and it ends up dropping that
request. This results in the HW caching a stale gid entry and traffic fails
because of that. Fix by returning the proper context in bnxt\_re\_add\_gid().
Signed-off-by: Sriharsha Basavapatna
Signed-off-by: Doug Ledford
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit a76d81af17ceadd8bae46da297d8e24dd8ea0838
Author: Chao Yu
Date: Mon Nov 13 17:32:39 2017 +0800
f2fs: fix to clear FI\_NO\_PREALLOC
[ Upstream commit 28cfafb73853f0494b06649716687a3ea07681d5 ]
We need to clear FI\_NO\_PREALLOC flag in error path of f2fs\_file\_write\_iter,
otherwise we will lose the chance to preallocate blocks in latter write()
at one time.
Fixes: dc91de78e5e1 ("f2fs: do not preallocate blocks which has wrong buffer")
Signed-off-by: Chao Yu
Signed-off-by: Jaegeuk Kim
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 6610b9cb80ad9a58f71940b9658e3116262663db
Author: Herbert Xu
Date: Fri Nov 10 14:14:06 2017 +1100
xfrm: Copy policy family in clone\_policy
[ Upstream commit 0e74aa1d79a5bbc663e03a2804399cae418a0321 ]
The syzbot found an ancient bug in the IPsec code. When we cloned
a socket policy (for example, for a child TCP socket derived from a
listening socket), we did not copy the family field. This results
in a live policy with a zero family field. This triggers a BUG\_ON
check in the af\_key code when the cloned policy is retrieved.
This patch fixes it by copying the family field over.
Reported-by: syzbot
Signed-off-by: Herbert Xu
Signed-off-by: Steffen Klassert
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit f0e1cd056e99c1ac7ec59f46ad152c11f1b69570
Author: Ilya Lesokhin
Date: Mon Nov 13 10:22:44 2017 +0200
tls: Use kzalloc for aead\_request allocation
[ Upstream commit 61ef6da622aa7b66bf92991bd272490eea6c712e ]
Use kzalloc for aead\_request allocation as
we don't set all the bits in the request.
Fixes: 3c4d7559159b ('tls: kernel TLS support')
Signed-off-by: Ilya Lesokhin
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 2de359062feea90c1e8baa2fa9771ba98d1fadfa
Author: Jason Baron
Date: Mon Nov 13 16:48:47 2017 -0500
jump\_label: Invoke jump\_label\_test() via early\_initcall()
[ Upstream commit 92ee46efeb505ead3ab06d3c5ce695637ed5f152 ]
Fengguang Wu reported that running the rcuperf test during boot can cause
the jump\_label\_test() to hit a WARN\_ON(). The issue is that the core jump
label code relies on kernel\_text\_address() to detect when it can no longer
update branches that may be contained in \_\_init sections. The
kernel\_text\_address() in turn assumes that if the system\_state variable is
greter than or equal to SYSTEM\_RUNNING then \_\_init sections are no longer
valid (since the assumption is that they have been freed). However, when
rcuperf is setup to run in early boot it can call kernel\_power\_off() which
sets the system\_state to SYSTEM\_POWER\_OFF.
Since rcuperf initialization is invoked via a module\_init(), we can make
the dependency of jump\_label\_test() needing to complete before rcuperf
explicit by calling it via early\_initcall().
Reported-by: Fengguang Wu
Signed-off-by: Jason Baron
Acked-by: Paul E. McKenney
Cc: Linus Torvalds
Cc: Peter Zijlstra
Cc: Steven Rostedt
Cc: Thomas Gleixner
Link: http://lkml.kernel.org/r/1510609727-2238-1-git-send-email-jbaron@akamai.com
Signed-off-by: Ingo Molnar
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit bbcedaeba78040aaa0f0d6a7f39add578f81f356
Author: Arvind Yadav
Date: Tue Nov 14 13:42:38 2017 +0530
atm: horizon: Fix irq release error
[ Upstream commit bde533f2ea607cbbbe76ef8738b36243939a7bc2 ]
atm\_dev\_register() can fail here and passed parameters to free irq
which is not initialised. Initialization of 'dev->irq' happened after
the 'goto out\_free\_irq'. So using 'irq' insted of 'dev->irq' in
free\_irq().
Signed-off-by: Arvind Yadav
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 8928998d1ed8c4bf76d0ce75570665982266825c
Author: Masahiro Yamada
Date: Sat Sep 30 10:10:09 2017 +0900
kbuild: rpm-pkg: fix jobserver unavailable warning
[ Upstream commit 606625be47bc87b6fab0af10cd57aaa675cb9e42 ]
If "make rpm-pkg" or "make binrpm-pkg" is run with -j[jobs] option,
the following warning message is displayed.
warning: jobserver unavailable: using -j1. Add '+' to parent make rule.
Follow the suggestion.
Signed-off-by: Masahiro Yamada
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit e5aa0e86f957709fc72d02ed3d5d0d775a2592f6
Author: Sudeep Holla
Date: Thu Sep 28 11:18:53 2017 +0100
mailbox: mailbox-test: don't rely on rx\_buffer content to signal data ready
[ Upstream commit e339c80af95e14de3712d69ddea09a3868fa14cd ]
Currently we rely on the first byte of the Rx buffer to check if there's
any data available to be read. If the first byte of the received buffer
is zero (i.e. null character), then we fail to signal that data is
available even when it's available.
Instead introduce a boolean variable to track the data availability and
update it in the channel receive callback as ready and clear it when the
data is read.
Signed-off-by: Sudeep Holla
Signed-off-by: Jassi Brar
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 8356c5754cb9854a25e0cebac0ee94a352b3debe
Author: Zhong Kaihua
Date: Mon Aug 7 22:51:56 2017 +0800
clk: hi3660: fix incorrect uart3 clock freqency
[ Upstream commit d33fb1b9f0fcb67f2b9f8b1891465a088a9480f8 ]
UART3 clock rate is doubled in previous commit.
This error is not detected until recently a mezzanine board which makes
real use of uart3 port (through LS connector of 96boards) was setup
and tested on hi3660-hikey960 board.
This patch changes clock source rate of clk\_factor\_uart3 to 100000000.
Signed-off-by: Zhong Kaihua
Signed-off-by: Guodong Xu
Signed-off-by: Stephen Boyd
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit a967ab0f7338e84d379b7a764bf446221de21d3e
Author: Masahiro Yamada
Date: Thu Oct 5 11:32:59 2017 +0900
clk: uniphier: fix DAPLL2 clock rate of Pro5
[ Upstream commit 67affb78a4e4feb837953e3434c8402a5c3b272f ]
The parent of DAPLL2 should be DAPLL1. Fix the clock connection.
Signed-off-by: Masahiro Yamada
Signed-off-by: Stephen Boyd
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit cd11ce209d73cba69a5776818795446a7991755e
Author: Johan Hovold
Date: Sat Nov 11 17:29:28 2017 +0100
clk: qcom: common: fix legacy board-clock registration
[ Upstream commit 43a51019cc8ff1b1cd2ba72e86563beb40d356fc ]
Make sure to search only the child nodes of "/clocks", rather than the
whole device-tree depth-first starting at "/clocks" when determining
whether to register a fixed clock in the legacy board-clock registration
helper.
Fixes: ee15faffef11 ("clk: qcom: common: Add API to register board clocks backwards compatibly")
Signed-off-by: Johan Hovold
Signed-off-by: Stephen Boyd
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit de1090298880468eb6e29e5b1e046862f2301950
Author: Mylene JOSSERAND
Date: Sun Nov 5 17:51:34 2017 +0100
clk: sunxi-ng: a83t: Fix i2c buses bits
[ Upstream commit cc54c0955d6f8618a38a999eecdc3d95306b90de ]
i2c1 and i2c2 bits for CCU are not bit 0 but bit 1 and bit 2.
Because of that, the i2c0 (bit 0) was not correctly configured.
Fixed the correct bits for i2c1 and i2c2.
Fixes: 05359be1176b ("clk: sunxi-ng: Add driver for A83T CCU")
Signed-off-by: Mylène Josserand
Acked-by: Maxime Ripard
Signed-off-by: Stephen Boyd
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 8474be654b2723426f37ad95a48bff1acdb022f7
Author: Gabriel Fernandez
Date: Wed Oct 11 08:57:24 2017 +0200
clk: stm32h7: fix test of clock config
[ Upstream commit c1ea839c41d049604a3f64ef72712d1c7c6639d0 ]
fix test of composite clock config (bad copy / past)
Signed-off-by: Gabriel Fernandez
Fixes: 3e4d618b0722 ("clk: stm32h7: Add stm32h743 clock driver")
Signed-off-by: Stephen Boyd
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit b316280c81337971e5cbf239400186425de7bae9
Author: Eric Dumazet
Date: Tue Nov 14 17:15:50 2017 -0800
bpf: fix lockdep splat
[ Upstream commit 89ad2fa3f043a1e8daae193bcb5fe34d5f8caf28 ]
pcpu\_freelist\_pop() needs the same lockdep awareness than
pcpu\_freelist\_populate() to avoid a false positive.
[ INFO: SOFTIRQ-safe -> SOFTIRQ-unsafe lock order detected ]
switchto-defaul/12508 [HC0[0]:SC0[6]:HE0:SE0] is trying to acquire:
(&htab->buckets[i].lock){......}, at: [] \_\_htab\_percpu\_map\_update\_elem+0x1cb/0x300
and this task is already holding:
(dev\_queue->dev->qdisc\_class ?: &qdisc\_tx\_lock#2){+.-...}, at: [] \_\_dev\_queue\_xmit+0
x868/0x1240
which would create a new lock dependency:
(dev\_queue->dev->qdisc\_class ?: &qdisc\_tx\_lock#2){+.-...} -> (&htab->buckets[i].lock){......}
but this new dependency connects a SOFTIRQ-irq-safe lock:
(dev\_queue->dev->qdisc\_class ?: &qdisc\_tx\_lock#2){+.-...}
... which became SOFTIRQ-irq-safe at:
[] \_\_lock\_acquire+0x42b/0x1f10
[] lock\_acquire+0xbc/0x1b0
[] \_raw\_spin\_lock+0x38/0x50
[] \_\_dev\_queue\_xmit+0x868/0x1240
[] dev\_queue\_xmit+0x10/0x20
[] ip\_finish\_output2+0x439/0x590
[] ip\_finish\_output+0x150/0x2f0
[] ip\_output+0x7d/0x260
[] ip\_local\_out+0x5e/0xe0
[] ip\_queue\_xmit+0x205/0x620
[] tcp\_transmit\_skb+0x5a8/0xcb0
[] tcp\_write\_xmit+0x242/0x1070
[] \_\_tcp\_push\_pending\_frames+0x3c/0xf0
[] tcp\_rcv\_established+0x312/0x700
[] tcp\_v4\_do\_rcv+0x11c/0x200
[] tcp\_v4\_rcv+0xaa2/0xc30
[] ip\_local\_deliver\_finish+0xa7/0x240
[] ip\_local\_deliver+0x66/0x200
[] ip\_rcv\_finish+0xdd/0x560
[] ip\_rcv+0x295/0x510
[] \_\_netif\_receive\_skb\_core+0x988/0x1020
[] \_\_netif\_receive\_skb+0x21/0x70
[] process\_backlog+0x6f/0x230
[] net\_rx\_action+0x229/0x420
[] \_\_do\_softirq+0xd8/0x43d
[] do\_softirq\_own\_stack+0x1c/0x30
[] do\_softirq+0x55/0x60
[] \_\_local\_bh\_enable\_ip+0xa8/0xb0
[] cpu\_startup\_entry+0x1c7/0x500
[] start\_secondary+0x113/0x140
to a SOFTIRQ-irq-unsafe lock:
(&head->lock){+.+...}
... which became SOFTIRQ-irq-unsafe at:
... [] \_\_lock\_acquire+0x82f/0x1f10
[] lock\_acquire+0xbc/0x1b0
[] \_raw\_spin\_lock+0x38/0x50
[] pcpu\_freelist\_pop+0x7a/0xb0
[] htab\_map\_alloc+0x50c/0x5f0
[] SyS\_bpf+0x265/0x1200
[] entry\_SYSCALL\_64\_fastpath+0x12/0x17
other info that might help us debug this:
Chain exists of:
dev\_queue->dev->qdisc\_class ?: &qdisc\_tx\_lock#2 --> &htab->buckets[i].lock --> &head->lock
Possible interrupt unsafe locking scenario:
CPU0 CPU1
---- ----
lock(&head->lock);
local\_irq\_disable();
lock(dev\_queue->dev->qdisc\_class ?: &qdisc\_tx\_lock#2);
lock(&htab->buckets[i].lock);
lock(dev\_queue->dev->qdisc\_class ?: &qdisc\_tx\_lock#2);
\*\*\* DEADLOCK \*\*\*
Fixes: e19494edab82 ("bpf: introduce percpu\_freelist")
Signed-off-by: Eric Dumazet
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 81a1c2d3f9eb5996714d47dc0fcab91cee0678d4
Author: Hangbin Liu
Date: Wed Nov 15 09:43:09 2017 +0800
geneve: fix fill\_info when link down
[ Upstream commit fd7eafd02121d6ef501ef1a4a891e6061366c952 ]
geneve->sock4/6 were added with geneve\_open and released with geneve\_stop.
So when geneve link down, we will not able to show remote address and
checksum info after commit 11387fe4a98 ("geneve: fix fill\_info when using
collect\_metadata").
Fix this by avoid passing \*\_REMOTE{,6} for COLLECT\_METADATA since they are
mutually exclusive, and always show UDP\_ZERO\_CSUM6\_RX info.
Fixes: 11387fe4a98 ("geneve: fix fill\_info when using collect\_metadata")
Signed-off-by: Hangbin Liu
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 6e9c2a05c368a0b53d5b6647798e67830f5508e0
Author: Jeff Layton
Date: Tue Nov 14 14:43:56 2017 -0500
fcntl: don't leak fd reference when fixup\_compat\_flock fails
[ Upstream commit 9280a601e6080c9ff658468c1c775ff6514099a6 ]
Currently we just return err here, but we need to put the fd reference
first.
Fixes: 94073ad77fff (fs/locks: don't mess with the address limit in compat\_fcntl64)
Signed-off-by: Jeff Layton
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 0c7e787bfc91cb374b60ba5fe7055178c94a7cb7
Author: Xin Long
Date: Wed Nov 15 16:57:26 2017 +0800
sctp: use the right sk after waking up from wait\_buf sleep
[ Upstream commit cea0cc80a6777beb6eb643d4ad53690e1ad1d4ff ]
Commit dfcb9f4f99f1 ("sctp: deny peeloff operation on asocs with threads
sleeping on it") fixed the race between peeloff and wait sndbuf by
checking waitqueue\_active(&asoc->wait) in sctp\_do\_peeloff().
But it actually doesn't work, as even if waitqueue\_active returns false
the waiting sndbuf thread may still not yet hold sk lock. After asoc is
peeled off, sk is not asoc->base.sk any more, then to hold the old sk
lock couldn't make assoc safe to access.
This patch is to fix this by changing to hold the new sk lock if sk is
not asoc->base.sk, meanwhile, also set the sk in sctp\_sendmsg with the
new sk.
With this fix, there is no more race between peeloff and waitbuf, the
check 'waitqueue\_active' in sctp\_do\_peeloff can be removed.
Thanks Marcelo and Neil for making this clear.
v1->v2:
fix it by changing to lock the new sock instead of adding a flag in asoc.
Suggested-by: Neil Horman
Signed-off-by: Xin Long
Acked-by: Neil Horman
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 191d96120f955f23474176da8272a26fd6d0b9bd
Author: Xin Long
Date: Wed Nov 15 16:55:54 2017 +0800
sctp: do not free asoc when it is already dead in sctp\_sendmsg
[ Upstream commit ca3af4dd28cff4e7216e213ba3b671fbf9f84758 ]
Now in sctp\_sendmsg sctp\_wait\_for\_sndbuf could schedule out without
holding sock sk. It means the current asoc can be freed elsewhere,
like when receiving an abort packet.
If the asoc is just created in sctp\_sendmsg and sctp\_wait\_for\_sndbuf
returns err, the asoc will be freed again due to new\_asoc is not nil.
An use-after-free issue would be triggered by this.
This patch is to fix it by setting new\_asoc with nil if the asoc is
already dead when cpu schedules back, so that it will not be freed
again in sctp\_sendmsg.
v1->v2:
set new\_asoc as nil in sctp\_sendmsg instead of sctp\_wait\_for\_sndbuf.
Suggested-by: Neil Horman
Reported-by: Dmitry Vyukov
Signed-off-by: Xin Long
Acked-by: Neil Horman
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 5ca94e03675a961424d47ee8d21c4b84606b742d
Author: Miles Chen
Date: Wed Nov 15 17:32:25 2017 -0800
slub: fix sysfs duplicate filename creation when slub\_debug=O
[ Upstream commit 11066386efa692f77171484c32ea30f6e5a0d729 ]
When slub\_debug=O is set. It is possible to clear debug flags for an
"unmergeable" slab cache in kmem\_cache\_open(). It makes the "unmergeable"
cache became "mergeable" in sysfs\_slab\_add().
These caches will generate their "unique IDs" by create\_unique\_id(), but
it is possible to create identical unique IDs. In my experiment,
sgpool-128, names\_cache, biovec-256 generate the same ID ":Ft-0004096" and
the kernel reports "sysfs: cannot create duplicate filename
'/kernel/slab/:Ft-0004096'".
To repeat my experiment, set disable\_higher\_order\_debug=1,
CONFIG\_SLUB\_DEBUG\_ON=y in kernel-4.14.
Fix this issue by setting unmergeable=1 if slub\_debug=O and the the
default slub\_debug contains any no-merge flags.
call path:
kmem\_cache\_create()
\_\_kmem\_cache\_alias() -> we set SLAB\_NEVER\_MERGE flags here
create\_cache()
\_\_kmem\_cache\_create()
kmem\_cache\_open() -> clear DEBUG\_METADATA\_FLAGS
sysfs\_slab\_add() -> the slab cache is mergeable now
sysfs: cannot create duplicate filename '/kernel/slab/:Ft-0004096'
------------[ cut here ]------------
WARNING: CPU: 0 PID: 1 at fs/sysfs/dir.c:31 sysfs\_warn\_dup+0x60/0x7c
Modules linked in:
CPU: 0 PID: 1 Comm: swapper/0 Tainted: G W 4.14.0-rc7ajb-00131-gd4c2e9f-dirty #123
Hardware name: linux,dummy-virt (DT)
task: ffffffc07d4e0080 task.stack: ffffff8008008000
PC is at sysfs\_warn\_dup+0x60/0x7c
LR is at sysfs\_warn\_dup+0x60/0x7c
pc : lr : pstate: 60000145
Call trace:
sysfs\_warn\_dup+0x60/0x7c
sysfs\_create\_dir\_ns+0x98/0xa0
kobject\_add\_internal+0xa0/0x294
kobject\_init\_and\_add+0x90/0xb4
sysfs\_slab\_add+0x90/0x200
\_\_kmem\_cache\_create+0x26c/0x438
kmem\_cache\_create+0x164/0x1f4
sg\_pool\_init+0x60/0x100
do\_one\_initcall+0x38/0x12c
kernel\_init\_freeable+0x138/0x1d4
kernel\_init+0x10/0xfc
ret\_from\_fork+0x10/0x18
Link: http://lkml.kernel.org/r/1510365805-5155-1-git-send-email-miles.chen@mediatek.com
Signed-off-by: Miles Chen
Acked-by: Christoph Lameter
Cc: Pekka Enberg
Cc: David Rientjes
Cc: Joonsoo Kim
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 1238334082ea47738c79c2acb4546767593e1a75
Author: Sergey Senozhatsky
Date: Wed Nov 15 17:34:03 2017 -0800
zsmalloc: calling zs\_map\_object() from irq is a bug
[ Upstream commit 1aedcafbf32b3f232c159b14cd0d423fcfe2b861 ]
Use BUG\_ON(in\_interrupt()) in zs\_map\_object(). This is not a new
BUG\_ON(), it's always been there, but was recently changed to
VM\_BUG\_ON(). There are several problems there. First, we use use
per-CPU mappings both in zsmalloc and in zram, and interrupt may easily
corrupt those buffers. Second, and more importantly, we believe it's
possible to start leaking sensitive information. Consider the following
case:
-> process P
swap out
zram
per-cpu mapping CPU1
compress page A
-> IRQ
swap out
zram
per-cpu mapping CPU1
compress page B
write page from per-cpu mapping CPU1 to zsmalloc pool
iret
-> process P
write page from per-cpu mapping CPU1 to zsmalloc pool [\*]
return
\* so we store overwritten data that actually belongs to another
page (task) and potentially contains sensitive data. And when
process P will page fault it's going to read (swap in) that
other task's data.
Link: http://lkml.kernel.org/r/20170929045140.4055-1-sergey.senozhatsky@gmail.com
Signed-off-by: Sergey Senozhatsky
Acked-by: Minchan Kim
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 99dac8af6e6fe6100aaaba0a69e44fcb886c2b92
Author: Pavel Tatashin
Date: Wed Nov 15 17:36:18 2017 -0800
sparc64/mm: set fields in deferred pages
[ Upstream commit 2a20aa171071a334d80c4e5d5af719d8374702fc ]
Without deferred struct page feature (CONFIG\_DEFERRED\_STRUCT\_PAGE\_INIT),
flags and other fields in "struct page"es are never changed prior to
first initializing struct pages by going through \_\_init\_single\_page().
With deferred struct page feature enabled there is a case where we set
some fields prior to initializing:
mem\_init() {
register\_page\_bootmem\_info();
free\_all\_bootmem();
...
}
When register\_page\_bootmem\_info() is called only non-deferred struct
pages are initialized. But, this function goes through some reserved
pages which might be part of the deferred, and thus are not yet
initialized.
mem\_init
register\_page\_bootmem\_info
register\_page\_bootmem\_info\_node
get\_page\_bootmem
.. setting fields here ..
such as: page->freelist = (void \*)type;
free\_all\_bootmem()
free\_low\_memory\_core\_early()
for\_each\_reserved\_mem\_region()
reserve\_bootmem\_region()
init\_reserved\_page() <- Only if this is deferred reserved page
\_\_init\_single\_pfn()
\_\_init\_single\_page()
memset(0) <-- Loose the set fields here
We end up with similar issue as in the previous patch, where currently
we do not observe problem as memory is zeroed. But, if flag asserts are
changed we can start hitting issues.
Also, because in this patch series we will stop zeroing struct page
memory during allocation, we must make sure that struct pages are
properly initialized prior to using them.
The deferred-reserved pages are initialized in free\_all\_bootmem().
Therefore, the fix is to switch the above calls.
Link: http://lkml.kernel.org/r/20171013173214.27300-4-pasha.tatashin@oracle.com
Signed-off-by: Pavel Tatashin
Reviewed-by: Steven Sistare
Reviewed-by: Daniel Jordan
Reviewed-by: Bob Picco
Acked-by: David S. Miller
Acked-by: Michal Hocko
Cc: Alexander Potapenko
Cc: Andrey Ryabinin
Cc: Ard Biesheuvel
Cc: Catalin Marinas
Cc: Christian Borntraeger
Cc: Dmitry Vyukov
Cc: Heiko Carstens
Cc: "H. Peter Anvin"
Cc: Ingo Molnar
Cc: Mark Rutland
Cc: Matthew Wilcox
Cc: Mel Gorman
Cc: Michal Hocko
Cc: Sam Ravnborg
Cc: Thomas Gleixner
Cc: Will Deacon
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 60bed713ab191588edeba77f2cfa8cc13ccb7000
Author: Ming Lei
Date: Thu Nov 16 08:08:44 2017 +0800
block: wake up all tasks blocked in get\_request()
[ Upstream commit 34d9715ac1edd50285168dd8d80c972739a4f6a4 ]
Once blk\_set\_queue\_dying() is done in blk\_cleanup\_queue(), we call
blk\_freeze\_queue() and wait for q->q\_usage\_counter becoming zero. But
if there are tasks blocked in get\_request(), q->q\_usage\_counter can
never become zero. So we have to wake up all these tasks in
blk\_set\_queue\_dying() first.
Fixes: 3ef28e83ab157997 ("block: generic request\_queue reference counting")
Signed-off-by: Ming Lei
Signed-off-by: Jens Axboe
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 84e0b87ebfb56041d8130bf220d1494515332b65
Author: Johan Hovold
Date: Thu Nov 9 18:07:17 2017 +0100
dt-bindings: usb: fix reg-property port-number range
[ Upstream commit f42ae7b0540937e00fe005812997f126aaac4bc2 ]
The USB hub port-number range for USB 2.0 is 1-255 and not 1-31 which
reflects an arbitrary limit set by the current Linux implementation.
Note that for USB 3.1 hubs the valid range is 1-15.
Increase the documented valid range in the binding to 255, which is the
maximum allowed by the specifications.
Signed-off-by: Johan Hovold
Signed-off-by: Rob Herring
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit f4da9e07a6a27939f9e976ade9945c735ad026b9
Author: Darrick J. Wong
Date: Tue Nov 14 16:34:44 2017 -0800
xfs: fix forgotten rcu read unlock when skipping inode reclaim
[ Upstream commit 962cc1ad6caddb5abbb9f0a43e5abe7131a71f18 ]
In commit f2e9ad21 ("xfs: check for race with xfs\_reclaim\_inode"), we
skip an inode if we're racing with freeing the inode via
xfs\_reclaim\_inode, but we forgot to release the rcu read lock when
dumping the inode, with the result that we exit to userspace with a lock
held. Don't do that; generic/320 with a 1k block size fails this
very occasionally.
================================================
WARNING: lock held when returning to user space!
4.14.0-rc6-djwong #4 Tainted: G W
------------------------------------------------
rm/30466 is leaving the kernel with locks still held!
1 lock held by rm/30466:
#0: (rcu\_read\_lock){....}, at: [] xfs\_ifree\_cluster.isra.17+0x2c3/0x6f0 [xfs]
------------[ cut here ]------------
WARNING: CPU: 1 PID: 30466 at kernel/rcu/tree\_plugin.h:329 rcu\_note\_context\_switch+0x71/0x700
Modules linked in: deadline\_iosched dm\_snapshot dm\_bufio ext4 mbcache jbd2 dm\_flakey xfs libcrc32c dax\_pmem device\_dax nd\_pmem sch\_fq\_codel af\_packet [last unloaded: scsi\_debug]
CPU: 1 PID: 30466 Comm: rm Tainted: G W 4.14.0-rc6-djwong #4
Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.10.2-1ubuntu1djwong0 04/01/2014
task: ffff880037680000 task.stack: ffffc90001064000
RIP: 0010:rcu\_note\_context\_switch+0x71/0x700
RSP: 0000:ffffc90001067e50 EFLAGS: 00010002
RAX: 0000000000000001 RBX: ffff880037680000 RCX: ffff88003e73d200
RDX: 0000000000000002 RSI: ffffffff819e53e9 RDI: ffffffff819f4375
RBP: 0000000000000000 R08: 0000000000000000 R09: ffff880062c900d0
R10: 0000000000000000 R11: 0000000000000000 R12: ffff880037680000
R13: 0000000000000000 R14: ffffc90001067eb8 R15: ffff880037680690
FS: 00007fa3b8ce8700(0000) GS:ffff88003ec00000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00007f69bf77c000 CR3: 000000002450a000 CR4: 00000000000006e0
Call Trace:
\_\_schedule+0xb8/0xb10
schedule+0x40/0x90
exit\_to\_usermode\_loop+0x6b/0xa0
prepare\_exit\_to\_usermode+0x7a/0x90
retint\_user+0x8/0x20
RIP: 0033:0x7fa3b87fda87
RSP: 002b:00007ffe41206568 EFLAGS: 00000246 ORIG\_RAX: ffffffffffffff02
RAX: 0000000000000000 RBX: 00000000010e88c0 RCX: 00007fa3b87fda87
RDX: 0000000000000000 RSI: 00000000010e89c8 RDI: 0000000000000005
RBP: 0000000000000000 R08: 0000000000000003 R09: 0000000000000000
R10: 000000000000015e R11: 0000000000000246 R12: 00000000010c8060
R13: 00007ffe41206690 R14: 0000000000000000 R15: 0000000000000000
---[ end trace e88f83bf0cfbd07d ]---
Fixes: f2e9ad212def50bcf4c098c6288779dd97fff0f0
Cc: Omar Sandoval
Signed-off-by: Darrick J. Wong
Reviewed-by: Christoph Hellwig
Reviewed-by: Omar Sandoval
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 1cb98be5f989fc2820d7198170098939c38579a3
Author: Pieter Jansen van Vuuren
Date: Thu Nov 16 17:06:39 2017 -0800
nfp: fix flower offload metadata flag usage
[ Upstream commit 6c3ab204f4ca00374a374bc0fc9a275b64d1bcbb ]
Hardware has no notion of new or last mask id, instead it makes use of the
message type (i.e. add flow or del flow) in combination with a single bit
in metadata flags to determine when to add or delete a mask id. Previously
we made use of the new or last flags to indicate that a new mask should be
allocated or deallocated, respectively. This incorrect behaviour is fixed
by making use single bit in metadata flags to indicate mask allocation or
deallocation.
Fixes: 43f84b72c50d ("nfp: add metadata to each flow offload")
Signed-off-by: Pieter Jansen van Vuuren
Reviewed-by: Jakub Kicinski
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit cfcbc4f35a73c95d8843495274cd9fff1d5f4c33
Author: Dirk van der Merwe
Date: Thu Nov 16 17:06:41 2017 -0800
nfp: inherit the max\_mtu from the PF netdev
[ Upstream commit 743ba5b47f7961fb29f2e06bb694fb4f068ac58f ]
The PF netdev is used for data transfer for reprs, so reprs inherit the
maximum MTU settings of the PF netdev.
Fixes: 5de73ee46704 ("nfp: general representor implementation")
Signed-off-by: Dirk van der Merwe
Reviewed-by: Jakub Kicinski
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 94d6b7fa7226dba65a3ea718db6499a87b7623c3
Author: Chuck Lever
Date: Fri Nov 3 13:46:06 2017 -0400
sunrpc: Fix rpc\_task\_begin trace point
[ Upstream commit b2bfe5915d5fe7577221031a39ac722a0a2a1199 ]
The rpc\_task\_begin trace point always display a task ID of zero.
Move the trace point call site so that it picks up the new task ID.
Signed-off-by: Chuck Lever
Signed-off-by: Anna Schumaker
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 57f94fd10554a2d73e92490ba0eb8e575b8b8fbb
Author: Trond Myklebust
Date: Mon Nov 6 15:28:04 2017 -0500
NFS: Fix a typo in nfs\_rename()
[ Upstream commit d803224c84be067754db7fa58a93f36f61566493 ]
On successful rename, the "old\_dentry" is retained and is attached to
the "new\_dir", so we need to call nfs\_set\_verifier() accordingly.
Signed-off-by: Trond Myklebust
Signed-off-by: Anna Schumaker
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 8cb22e0793d41e466bbaa42c01a87afb869c8e9b
Author: Randy Dunlap
Date: Fri Nov 17 15:27:35 2017 -0800
dynamic-debug-howto: fix optional/omitted ending line number to be LARGE instead of 0
[ Upstream commit 1f3c790bd5989fcfec9e53ad8fa09f5b740c958f ]
line-range is supposed to treat "1-" as "1-endoffile", so
handle the special case by setting last\_lineno to UINT\_MAX.
Fixes this error:
dynamic\_debug:ddebug\_parse\_query: last-line:0 < 1st-line:1
dynamic\_debug:ddebug\_exec\_query: query parse failed
Link: http://lkml.kernel.org/r/10a6a101-e2be-209f-1f41-54637824788e@infradead.org
Signed-off-by: Randy Dunlap
Acked-by: Jason Baron
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 346008fe47ed099f1793f2ba6721c9bc5b67e3a3
Author: Stephen Bates
Date: Fri Nov 17 15:28:16 2017 -0800
lib/genalloc.c: make the avail variable an atomic\_long\_t
[ Upstream commit 36a3d1dd4e16bcd0d2ddfb4a2ec7092f0ae0d931 ]
If the amount of resources allocated to a gen\_pool exceeds 2^32 then the
avail atomic overflows and this causes problems when clients try and
borrow resources from the pool. This is only expected to be an issue on
64 bit systems.
Add the  header to pull in atomic\_long\* operations. So
that 32 bit systems continue to use atomic32\_t but 64 bit systems can
use atomic64\_t.
Link: http://lkml.kernel.org/r/1509033843-25667-1-git-send-email-sbates@raithlin.com
Signed-off-by: Stephen Bates
Reviewed-by: Logan Gunthorpe
Reviewed-by: Mathieu Desnoyers
Reviewed-by: Daniel Mentz
Cc: Jonathan Corbet
Cc: Andrew Morton
Cc: Will Deacon
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 30c2f774e13547f0dbb68cf779911d4d8920f0bc
Author: Joe Lawrence
Date: Fri Nov 17 15:29:17 2017 -0800
pipe: match pipe\_max\_size data type with procfs
[ Upstream commit 98159d977f71c3b3dee898d1c34e56f520b094e7 ]
Patch series "A few round\_pipe\_size() and pipe-max-size fixups", v3.
While backporting Michael's "pipe: fix limit handling" patchset to a
distro-kernel, Mikulas noticed that current upstream pipe limit handling
contains a few problems:
1 - procfs signed wrap: echo'ing a large number into
/proc/sys/fs/pipe-max-size and then cat'ing it back out shows a
negative value.
2 - round\_pipe\_size() nr\_pages overflow on 32bit: this would
subsequently try roundup\_pow\_of\_two(0), which is undefined.
3 - visible non-rounded pipe-max-size value: there is no mutual
exclusion or protection between the time pipe\_max\_size is assigned
a raw value from proc\_dointvec\_minmax() and when it is rounded.
4 - unsigned long -> unsigned int conversion makes for potential odd
return errors from do\_proc\_douintvec\_minmax\_conv() and
do\_proc\_dopipe\_max\_size\_conv().
This version underwent the same testing as v1:
https://marc.info/?l=linux-kernel&m=150643571406022&w=2
This patch (of 4):
pipe\_max\_size is defined as an unsigned int:
unsigned int pipe\_max\_size = 1048576;
but its procfs/sysctl representation is an integer:
static struct ctl\_table fs\_table[] = {
...
{
.procname = "pipe-max-size",
.data = &pipe\_max\_size,
.maxlen = sizeof(int),
.mode = 0644,
.proc\_handler = &pipe\_proc\_fn,
.extra1 = &pipe\_min\_size,
},
...
that is signed:
int pipe\_proc\_fn(struct ctl\_table \*table, int write, void \_\_user \*buf,
size\_t \*lenp, loff\_t \*ppos)
{
...
ret = proc\_dointvec\_minmax(table, write, buf, lenp, ppos)
This leads to signed results via procfs for large values of pipe\_max\_size:
% echo 2147483647 >/proc/sys/fs/pipe-max-size
% cat /proc/sys/fs/pipe-max-size
-2147483648
Use unsigned operations on this variable to avoid such negative values.
Link: http://lkml.kernel.org/r/1507658689-11669-2-git-send-email-joe.lawrence@redhat.com
Signed-off-by: Joe Lawrence
Reported-by: Mikulas Patocka
Reviewed-by: Mikulas Patocka
Cc: Michael Kerrisk
Cc: Randy Dunlap
Cc: Al Viro
Cc: Jens Axboe
Cc: Josh Poimboeuf
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 65c4767b0e715d9c3310f9d26a7e981caf15c428
Author: Christophe JAILLET
Date: Fri Nov 17 15:37:57 2017 -0800
drivers/rapidio/devices/rio\_mport\_cdev.c: fix resource leak in error handling path in 'rio\_dma\_transfer()'
[ Upstream commit b1402dcb5643b7a27d46a05edd7491d49ba0e248 ]
If 'dma\_map\_sg()', we should branch to the existing error handling path
to free some resources before returning.
Link: http://lkml.kernel.org/r/61292a4f369229eee03394247385e955027283f8.1505687047.git.christophe.jaillet@wanadoo.fr
Signed-off-by: Christophe JAILLET
Reviewed-by: Logan Gunthorpe
Cc: Matt Porter
Cc: Alexandre Bounine
Cc: Lorenzo Stoakes
Cc: Jesper Nilsson
Cc: Christian K\_nig
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit f52688ce0d7bb5bd6932be99faec931be59d9c63
Author: Colin Ian King
Date: Thu Nov 16 17:39:18 2017 +0000
rsi: fix memory leak on buf and usb\_reg\_buf
[ Upstream commit d35ef8f846c72d84bfccf239c248c84f79c3a7e8 ]
In the cases where len is too long, the error return path fails to
kfree allocated buffers buf and usb\_reg\_buf. The simplest fix is to
perform the sanity check on len before the allocations to avoid having
to do the kfree'ing in the first place.
Detected by CoverityScan, CID#1452258,1452259 ("Resource Leak")
Fixes: 59f73e2ae185 ("rsi: check length before USB read/write register")
Signed-off-by: Colin Ian King
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit ad199b18a9c00729bd000cf3565f6a45ebd4e177
Author: Xin Long
Date: Fri Nov 17 14:27:06 2017 +0800
route: update fnhe\_expires for redirect when the fnhe exists
[ Upstream commit e39d5246111399dbc6e11cd39fd8580191b86c47 ]
Now when creating fnhe for redirect, it sets fnhe\_expires for this
new route cache. But when updating the exist one, it doesn't do it.
It will cause this fnhe never to be expired.
Paolo already noticed it before, in Jianlin's test case, it became
even worse:
When ip route flush cache, the old fnhe is not to be removed, but
only clean it's members. When redirect comes again, this fnhe will
be found and updated, but never be expired due to fnhe\_expires not
being set.
So fix it by simply updating fnhe\_expires even it's for redirect.
Fixes: aee06da6726d ("ipv4: use seqlock for nh\_exceptions")
Reported-by: Jianlin Shi
Acked-by: Hannes Frederic Sowa
Signed-off-by: Xin Long
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 407de7d97a689d478e1c4b4fe2198af9c8cc3fcb
Author: Xin Long
Date: Fri Nov 17 14:27:18 2017 +0800
route: also update fnhe\_genid when updating a route cache
[ Upstream commit cebe84c6190d741045a322f5343f717139993c08 ]
Now when ip route flush cache and it turn out all fnhe\_genid != genid.
If a redirect/pmtu icmp packet comes and the old fnhe is found and all
it's members but fnhe\_genid will be updated.
Then next time when it looks up route and tries to rebind this fnhe to
the new dst, the fnhe will be flushed due to fnhe\_genid != genid. It
causes this redirect/pmtu icmp packet acutally not to be applied.
This patch is to also reset fnhe\_genid when updating a route cache.
Fixes: 5aad1de5ea2c ("ipv4: use separate genid for next hop exceptions")
Acked-by: Hannes Frederic Sowa
Signed-off-by: Xin Long
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit ffe6293d19dc965916177986aec254d0cb9cd71e
Author: Alexey Kodanev
Date: Fri Nov 17 19:16:17 2017 +0300
gre6: use log\_ecn\_error module parameter in ip6\_tnl\_rcv()
[ Upstream commit 981542c526ecd846920bc500e9989da906ee9fb9 ]
After commit 308edfdf1563 ("gre6: Cleanup GREv6 receive path, call
common GRE functions") it's not used anywhere in the module, but
previously was used in ip6gre\_rcv().
Fixes: 308edfdf1563 ("gre6: Cleanup GREv6 receive path, call common GRE functions")
Signed-off-by: Alexey Kodanev
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 266fd76296bea9f392ae205e7a08f5f5726dc7f9
Author: Ben Hutchings
Date: Fri Nov 10 18:48:50 2017 +0000
mac80211\_hwsim: Fix memory leak in hwsim\_new\_radio\_nl()
[ Upstream commit 67bd52386125ce1159c0581cbcd2740addf33cd4 ]
hwsim\_new\_radio\_nl() now copies the name attribute in order to add a
null-terminator. mac80211\_hwsim\_new\_radio() (indirectly) copies it
again into the net\_device structure, so the first copy is not used or
freed later. Free the first copy before returning.
Fixes: ff4dd73dd2b4 ("mac80211\_hwsim: check HWSIM\_ATTR\_RADIO\_NAME length")
Signed-off-by: Ben Hutchings
Signed-off-by: Johannes Berg
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit ad7acca17e31d14ceca8824728440e727150ddd0
Author: Dave Hansen
Date: Fri Nov 10 16:12:29 2017 -0800
x86/mpx/selftests: Fix up weird arrays
[ Upstream commit a6400120d042397675fcf694060779d21e9e762d ]
The MPX hardware data structurse are defined in a weird way: they define
their size in bytes and then union that with the type with which we want
to access them.
Yes, this is weird, but it does work. But, new GCC's complain that we
are accessing the array out of bounds. Just make it a zero-sized array
so gcc will stop complaining. There was not really a bug here.
Signed-off-by: Dave Hansen
Acked-by: Thomas Gleixner
Cc: Andy Lutomirski
Cc: Borislav Petkov
Cc: Brian Gerst
Cc: Denys Vlasenko
Cc: H. Peter Anvin
Cc: Josh Poimboeuf
Cc: Linus Torvalds
Cc: Peter Zijlstra
Link: http://lkml.kernel.org/r/20171111001229.58A7933D@viggo.jf.intel.com
Signed-off-by: Ingo Molnar
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 897088926c3477ef8d3d299473a2777dd9d1c9cb
Author: John Johansen
Date: Wed Nov 15 15:25:30 2017 -0800
apparmor: fix leak of null profile name if profile allocation fails
[ Upstream commit 4633307e5ed6128975595df43f796a10c41d11c1 ]
Fixes: d07881d2edb0 ("apparmor: move new\_null\_profile to after profile lookup fns()")
Reported-by: Seth Arnold
Signed-off-by: John Johansen
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 86d1d015fe06267b60d496971d01c859aaa8ce08
Author: Madhavan Srinivasan
Date: Wed Nov 22 10:45:38 2017 +0530
powerpc/perf: Fix pmu\_count to count only nest imc pmus
[ Upstream commit de34787f1096cce38e2590be0013b44418d14546 ]
"pmu\_count" in opal\_imc\_counters\_probe() is intended to hold
the number of successful nest imc pmu registerations. But
current code also counts other imc units like core\_imc and
thread\_imc. Patch add a check to count only nest imc pmus.
Signed-off-by: Madhavan Srinivasan
Signed-off-by: Michael Ellerman
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 394d0c93b9dd2dee2024a9d922a60b3a3aadb538
Author: Masahiro Yamada
Date: Tue Nov 14 20:38:07 2017 +0900
coccinelle: fix parallel build with CHECK=scripts/coccicheck
[ Upstream commit d7059ca0147adcd495f3c5b41f260e1ac55bb679 ]
The command "make -j8 C=1 CHECK=scripts/coccicheck" produces
lots of "coccicheck failed" error messages.
Julia Lawall explained the Coccinelle behavior as follows:
"The problem on the Coccinelle side is that it uses a subdirectory
with the name of the semantic patch to store standard output and
standard error for the different threads. I didn't want to use a
name with the pid, so that one could easily find this information
while Coccinelle is running. Normally the subdirectory is cleaned
up when Coccinelle completes, so there is only one of them at a time.
Maybe it is best to just add the pid. There is the risk that these
subdirectories will accumulate if Coccinelle crashes in a way such
that they don't get cleaned up, but Coccinelle could print a warning
if it detects this case, rather than failing."
When scripts/coccicheck is used as CHECK tool and -j option is given
to Make, the whole of build process runs in parallel. So, multiple
processes try to get access to the same subdirectory.
I notice spatch creates the subdirectory only when it runs in parallel
(i.e. --jobs  is given and  is greater than 1).
Setting NPROC=1 is a reasonable solution; spatch does not create the
subdirectory. Besides, ONLINE=1 mode takes a single file input for
each spatch invocation, so there is no reason to parallelize it in
the first place.
Signed-off-by: Masahiro Yamada
Acked-by: Julia Lawall
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 54a13eb7f03ac8bb92b3b2c358e42eb08834240b
Author: Masahiro Yamada
Date: Wed Nov 15 18:17:07 2017 +0900
kbuild: pkg: use --transform option to prefix paths in tar
[ Upstream commit 2dbc644ac62bbcb9ee78e84719953f611be0413d ]
For rpm-pkg and deb-pkg, a source tar file is created. All paths in
the archive must be prefixed with the base name of the tar so that
everything is contained in the directory when you extract it.
Currently, scripts/package/Makefile uses a symlink for that, and
removes it after the tar is created.
If you terminate the build during the tar creation, the symlink is
left over. Then, at the next package build, you will see a warning
like follows:
ln: '.' and 'kernel-4.14.0+/.' are the same file
It is possible to fix it by adding -n (--no-dereference) option to
the "ln" command, but a cleaner way is to use --transform option
of "tar" command. This option is GNU extension, but it should not
hurt to use it in the Linux build system.
The 'S' flag is needed to exclude symlinks from the path fixup.
Without it, symlinks in the kernel are broken.
Signed-off-by: Masahiro Yamada
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 4d0d1bc65b5710f45bc5fe10b4fbfc2671b0851d
Author: Ursula Braun
Date: Tue Nov 21 13:23:53 2017 +0100
net/smc: use sk\_rcvbuf as start for rmb creation
[ Upstream commit 4e1061f4a2bba1669c7297455c73ddafbebf2b12 ]
Commit 3e034725c0d8 ("net/smc: common functions for RMBs and send buffers")
merged handling of SMC receive and send buffers. It introduced sk\_buf\_size
as merged start value for size determination. But since sk\_buf\_size is not
used at all, sk\_sndbuf is erroneously used as start for rmb creation.
This patch makes sure, sk\_buf\_size is really used as intended, and
sk\_rcvbuf is used as start value for rmb creation.
Fixes: 3e034725c0d8 ("net/smc: common functions for RMBs and send buffers")
Signed-off-by: Ursula Braun
Reviewed-by: Hans Wippel
Signed-off-by: David S. Miller
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit f0d564230e08d314aac54cbcb1865a4b8fafe906
Author: Colin Ian King
Date: Fri Nov 17 18:35:53 2017 +0000
irqchip/qcom: Fix u32 comparison with value less than zero
[ Upstream commit e9990d70e8a063a7b894c5cbb99f630a0f41200d ]
The comparison of u32 nregs being less than zero is never true since
nregs is unsigned. Fix this by making nregs a signed integer.
Fixes: f20cc9b00c7b ("irqchip/qcom: Add IRQ combiner driver")
Signed-off-by: Colin Ian King
Signed-off-by: Thomas Gleixner
Cc: Marc Zyngier
Cc: kernel-janitors@vger.kernel.org
Cc: Jason Cooper
Link: https://lkml.kernel.org/r/20171117183553.2739-1-colin.king@canonical.com
Signed-off-by: Sasha Levin
Signed-off-by: Greg Kroah-Hartman
commit 14f13c9d58d8d738666d58fa7b2f8872286655bf
Author: Russell King
Date: Mon Nov 27 11:22:42 2017 +0000
ARM: avoid faulting on qemu
commit 3aaf33bebda8d4ffcc0fc8ef39e6c1ac68823b11 upstream.
When qemu starts a kernel in a bare environment, the default SCR has
the AW and FW bits clear, which means that the kernel can't modify
the PSR A or PSR F bits, and means that FIQs and imprecise aborts are
always masked.
When running uboot under qemu, the AW and FW SCR bits are set, and the
kernel functions normally - and this is how real hardware behaves.
Fix this for qemu by ignoring the FIQ bit.
Fixes: 8bafae202c82 ("ARM: BUG if jumping to usermode address in kernel mode")
Signed-off-by: Russell King
Cc: Alex Shi
Signed-off-by: Greg Kroah-Hartman
commit 21e1e6192ba653dfcc42bb0b275a4af7af5e32b0
Author: Russell King
Date: Fri Nov 24 23:49:34 2017 +0000
ARM: BUG if jumping to usermode address in kernel mode
commit 8bafae202c82dc257f649ea3c275a0f35ee15113 upstream.
Detect if we are returning to usermode via the normal kernel exit paths
but the saved PSR value indicates that we are in kernel mode. This
could occur due to corrupted stack state, which has been observed with
"ftracetest".
This ensures that we catch the problem case before we get to user code.
Signed-off-by: Russell King
Cc: Alex Shi
Signed-off-by: Greg Kroah-Hartman
commit 077415efefe77f6f3e82ae4868867e32ede01286
Author: LEROY Christophe
Date: Fri Oct 6 15:04:43 2017 +0200
crypto: talitos - fix ctr-aes-talitos
commit 70d355ccea899dad47dc22d3a4406998f55143fd upstream.
ctr-aes-talitos test fails as follows on SEC2
[ 0.837427] alg: skcipher: Test 1 failed (invalid result) on encryption for ctr-aes-talitos
[ 0.845763] 00000000: 16 36 d5 ee 34 f8 06 25 d7 7f 8e 56 ca 88 43 45
[ 0.852345] 00000010: f9 3f f7 17 2a b2 12 23 30 43 09 15 82 dd e1 97
[ 0.858940] 00000020: a7 f7 32 b5 eb 25 06 13 9a ec f5 29 25 f8 4d 66
[ 0.865366] 00000030: b0 03 5b 8e aa 9a 42 b6 19 33 8a e2 9d 65 96 95
This patch fixes the descriptor type which is special for CTR AES
Fixes: 5e75ae1b3cef6 ("crypto: talitos - add new crypto modes")
Signed-off-by: Christophe Leroy
Signed-off-by: Herbert Xu
Signed-off-by: Greg Kroah-Hartman
commit 2040f8e814055a330aae1ed83c3fe2aba26173f0
Author: LEROY Christophe
Date: Fri Oct 6 15:04:41 2017 +0200
crypto: talitos - fix use of sg\_link\_tbl\_len
commit fbb22137c4d9bab536958b152d096fb3f98020ea upstream.
sg\_link\_tbl\_len shall be used instead of cryptlen, otherwise
SECs which perform HW CICV verification will fail.
Signed-off-by: Christophe Leroy
Signed-off-by: Herbert Xu
Signed-off-by: Greg Kroah-Hartman
commit a2d93ada4fd30feeb3d0c914926f7a9fdea10102
Author: LEROY Christophe
Date: Fri Oct 6 15:04:39 2017 +0200
crypto: talitos - fix AEAD for sha224 on non sha224 capable chips
commit 6cda075aff67a1b9b5ba1b2818091dc939643b6c upstream.
sha224 AEAD test fails with:
[ 2.803125] talitos ff020000.crypto: DEUISR 0x00000000\_00000000
[ 2.808743] talitos ff020000.crypto: MDEUISR 0x80100000\_00000000
[ 2.814678] talitos ff020000.crypto: DESCBUF 0x20731f21\_00000018
[ 2.820616] talitos ff020000.crypto: DESCBUF 0x0628d64c\_00000010
[ 2.826554] talitos ff020000.crypto: DESCBUF 0x0631005c\_00000018
[ 2.832492] talitos ff020000.crypto: DESCBUF 0x0628d664\_00000008
[ 2.838430] talitos ff020000.crypto: DESCBUF 0x061b13a0\_00000080
[ 2.844369] talitos ff020000.crypto: DESCBUF 0x0631006c\_00000080
[ 2.850307] talitos ff020000.crypto: DESCBUF 0x0631006c\_00000018
[ 2.856245] talitos ff020000.crypto: DESCBUF 0x063100ec\_00000000
[ 2.884972] talitos ff020000.crypto: failed to reset channel 0
[ 2.890503] talitos ff020000.crypto: done overflow, internal time out, or rngu error: ISR 0x20000000\_00020000
[ 2.900652] alg: aead: encryption failed on test 1 for authenc-hmac-sha224-cbc-3des-talitos: ret=22
This is due to SHA224 not being supported by the HW. Allthough for
hash we are able to init the hash context by SW, it is not
possible for AEAD. Therefore SHA224 AEAD has to be deactivated.
Signed-off-by: Christophe Leroy
Signed-off-by: Herbert Xu
Signed-off-by: Greg Kroah-Hartman
commit 62744ebaeb91ff089865f90d0a0a1475a924809f
Author: LEROY Christophe
Date: Fri Oct 6 15:04:37 2017 +0200
crypto: talitos - fix setkey to check key weakness
commit f384cdc4faf350fdb6ad93c5f26952b9ba7c7566 upstream.
Crypto manager test report the following failures:
[ 3.061081] alg: skcipher: setkey failed on test 5 for ecb-des-talitos: flags=100
[ 3.069342] alg: skcipher-ddst: setkey failed on test 5 for ecb-des-talitos: flags=100
[ 3.077754] alg: skcipher-ddst: setkey failed on test 5 for ecb-des-talitos: flags=100
This is due to setkey being expected to detect weak keys.
Signed-off-by: Christophe Leroy
Signed-off-by: Herbert Xu
Signed-off-by: Greg Kroah-Hartman
commit 68b426477820e396f204e06c6de4063a82d63422
Author: LEROY Christophe
Date: Fri Oct 6 15:04:35 2017 +0200
crypto: talitos - fix memory corruption on SEC2
commit e04a61bebc5da1535b6f194b464295b8d558e2fc upstream.
On SEC2, when using the old descriptors type (hmac snoop no afeu)
for doing IPsec, the CICV out pointeur points out of the allocated
memory.
[ 2.502554] =============================================================================
[ 2.510740] BUG dma-kmalloc-256 (Not tainted): Redzone overwritten
[ 2.516907] -----------------------------------------------------------------------------
[ 2.516907]
[ 2.526535] Disabling lock debugging due to kernel taint
[ 2.531845] INFO: 0xde858108-0xde85810b. First byte 0xf8 instead of 0xcc
[ 2.538549] INFO: Allocated in 0x806181a9 age=0 cpu=0 pid=58
[ 2.544229] \_\_kmalloc+0x374/0x564
[ 2.547649] talitos\_edesc\_alloc+0x17c/0x48c
[ 2.551929] aead\_edesc\_alloc+0x80/0x154
[ 2.555863] aead\_encrypt+0x30/0xe0
[ 2.559368] \_\_test\_aead+0x5a0/0x1f3c
[ 2.563042] test\_aead+0x2c/0x110
[ 2.566371] alg\_test\_aead+0x5c/0xf4
[ 2.569958] alg\_test+0x1dc/0x5a0
[ 2.573305] cryptomgr\_test+0x50/0x70
[ 2.576984] kthread+0xd8/0x134
[ 2.580155] ret\_from\_kernel\_thread+0x5c/0x64
[ 2.584534] INFO: Freed in ipsec\_esp\_encrypt\_done+0x130/0x240 age=6 cpu=0 pid=0
[ 2.591839] ipsec\_esp\_encrypt\_done+0x130/0x240
[ 2.596395] flush\_channel+0x1dc/0x488
[ 2.600161] talitos2\_done\_4ch+0x30/0x200
[ 2.604185] tasklet\_action+0xa0/0x13c
[ 2.607948] \_\_do\_softirq+0x148/0x6cc
[ 2.611623] irq\_exit+0xc0/0x124
[ 2.614869] call\_do\_irq+0x24/0x3c
[ 2.618292] do\_IRQ+0x78/0x108
[ 2.621369] ret\_from\_except+0x0/0x14
[ 2.625055] finish\_task\_switch+0x58/0x350
[ 2.629165] schedule+0x80/0x134
[ 2.632409] schedule\_preempt\_disabled+0x38/0xc8
[ 2.637042] cpu\_startup\_entry+0xe4/0x190
[ 2.641074] start\_kernel+0x3f4/0x408
[ 2.644741] 0x3438
[ 2.646857] INFO: Slab 0xdffbdb00 objects=9 used=1 fp=0xde8581c0 flags=0x0080
[ 2.653978] INFO: Object 0xde858008 @offset=8 fp=0xca4395df
[ 2.653978]
[ 2.661032] Redzone de858000: cc cc cc cc cc cc cc cc ........
[ 2.669029] Object de858008: 00 00 00 02 00 00 00 02 00 6b 6b 6b 1e 83 ea 28 .........kkk...(
[ 2.677628] Object de858018: 00 00 00 70 1e 85 80 64 ff 73 1d 21 6b 6b 6b 6b ...p...d.s.!kkkk
[ 2.686228] Object de858028: 00 20 00 00 1e 84 17 24 00 10 00 00 1e 85 70 00 . .....$......p.
[ 2.694829] Object de858038: 00 18 00 00 1e 84 17 44 00 08 00 00 1e 83 ea 28 .......D.......(
[ 2.703430] Object de858048: 00 80 00 00 1e 84 f0 00 00 80 00 00 1e 85 70 10 ..............p.
[ 2.712030] Object de858058: 00 20 6b 00 1e 85 80 f4 6b 6b 6b 6b 00 80 02 00 . k.....kkkk....
[ 2.720629] Object de858068: 1e 84 f0 00 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b ....kkkkkkkkkkkk
[ 2.729230] Object de858078: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk
[ 2.737830] Object de858088: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk
[ 2.746429] Object de858098: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk
[ 2.755029] Object de8580a8: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk
[ 2.763628] Object de8580b8: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk
[ 2.772229] Object de8580c8: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk
[ 2.780829] Object de8580d8: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk
[ 2.789430] Object de8580e8: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 73 b0 ea 9f kkkkkkkkkkkks...
[ 2.798030] Object de8580f8: e8 18 80 d6 56 38 44 c0 db e3 4f 71 f7 ce d1 d3 ....V8D...Oq....
[ 2.806629] Redzone de858108: f8 bd 3e 4f ..>O
[ 2.814279] Padding de8581b0: 5a 5a 5a 5a 5a 5a 5a 5a ZZZZZZZZ
[ 2.822283] CPU: 0 PID: 0 Comm: swapper Tainted: G B 4.9.50-g995be12679 #179
[ 2.831819] Call Trace:
[ 2.834301] [dffefd20] [c01aa9a8] check\_bytes\_and\_report+0x100/0x194 (unreliable)
[ 2.841801] [dffefd50] [c01aac3c] check\_object+0x200/0x530
[ 2.847306] [dffefd80] [c01ae584] free\_debug\_processing+0x290/0x690
[ 2.853585] [dffefde0] [c01aec8c] \_\_slab\_free+0x308/0x628
[ 2.859000] [dffefe80] [c05057f4] ipsec\_esp\_encrypt\_done+0x130/0x240
[ 2.865378] [dffefeb0] [c05002c4] flush\_channel+0x1dc/0x488
[ 2.870968] [dffeff10] [c05007a8] talitos2\_done\_4ch+0x30/0x200
[ 2.876814] [dffeff30] [c002fe38] tasklet\_action+0xa0/0x13c
[ 2.882399] [dffeff60] [c002f118] \_\_do\_softirq+0x148/0x6cc
[ 2.887896] [dffeffd0] [c002f954] irq\_exit+0xc0/0x124
[ 2.892968] [dffefff0] [c0013adc] call\_do\_irq+0x24/0x3c
[ 2.898213] [c0d4be00] [c000757c] do\_IRQ+0x78/0x108
[ 2.903113] [c0d4be30] [c0015c08] ret\_from\_except+0x0/0x14
[ 2.908634] --- interrupt: 501 at finish\_task\_switch+0x70/0x350
[ 2.908634] LR = finish\_task\_switch+0x58/0x350
[ 2.919327] [c0d4bf20] [c085e1d4] schedule+0x80/0x134
[ 2.924398] [c0d4bf50] [c085e2c0] schedule\_preempt\_disabled+0x38/0xc8
[ 2.930853] [c0d4bf60] [c007f064] cpu\_startup\_entry+0xe4/0x190
[ 2.936707] [c0d4bfb0] [c096c434] start\_kernel+0x3f4/0x408
[ 2.942198] [c0d4bff0] [00003438] 0x3438
[ 2.946137] FIX dma-kmalloc-256: Restoring 0xde858108-0xde85810b=0xcc
[ 2.946137]
[ 2.954158] FIX dma-kmalloc-256: Object at 0xde858008 not freed
This patch reworks the handling of the CICV out in order
to properly handle all cases.
Signed-off-by: Christophe Leroy
Signed-off-by: Herbert Xu
Signed-off-by: Greg Kroah-Hartman
commit 7b9cf144dc0b164761212586dd86ace41fd601f4
Author: LEROY Christophe
Date: Fri Oct 6 15:04:33 2017 +0200
crypto: talitos - fix AEAD test failures
commit ec8c7d14acc0a477429d3a6fade5dab72c996c82 upstream.
AEAD tests fail when destination SG list has more than 1 element.
[ 2.058752] alg: aead: Test 1 failed on encryption for authenc-hmac-sha1-cbc-aes-talitos
[ 2.066965] 00000000: 53 69 6e 67 6c 65 20 62 6c 6f 63 6b 20 6d 73 67
00000010: c0 43 ff 74 c0 43 ff e0 de 83 d1 20 de 84 8e 54
00000020: de 83 d7 c4
[ 2.082138] alg: aead: Test 1 failed on encryption for authenc-hmac-sha1-cbc-aes-talitos
[ 2.090435] 00000000: 53 69 6e 67 6c 65 20 62 6c 6f 63 6b 20 6d 73 67
00000010: de 84 ea 58 c0 93 1a 24 de 84 e8 59 de 84 f1 20
00000020: 00 00 00 00
[ 2.105721] alg: aead: Test 1 failed on encryption for authenc-hmac-sha1-cbc-3des-talitos
[ 2.114259] 00000000: 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72 73 74
00000010: 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63 74 65
00000020: 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72
00000030: 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63
00000040: 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65
00000050: 65 72 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53
00000060: 72 63 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20
00000070: 63 65 65 72 73 74 54 20 6f 6f 4d 20 6e 61 0a 79
00000080: c0 50 f1 ac c0 50 f3 38 c0 50 f3 94 c0 50 f5 30
00000090: c0 99 74 3c
[ 2.166410] alg: aead: Test 1 failed on encryption for authenc-hmac-sha1-cbc-3des-talitos
[ 2.174794] 00000000: 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72 73 74
00000010: 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63 74 65
00000020: 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72
00000030: 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63
00000040: 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65
00000050: 65 72 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53
00000060: 72 63 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20
00000070: 63 65 65 72 73 74 54 20 6f 6f 4d 20 6e 61 0a 79
00000080: c0 50 f1 ac c0 50 f3 38 c0 50 f3 94 c0 50 f5 30
00000090: c0 99 74 3c
[ 2.226486] alg: No test for authenc(hmac(sha224),cbc(aes)) (authenc-hmac-sha224-cbc-aes-talitos)
[ 2.236459] alg: No test for authenc(hmac(sha224),cbc(aes)) (authenc-hmac-sha224-cbc-aes-talitos)
[ 2.247196] alg: aead: Test 1 failed on encryption for authenc-hmac-sha224-cbc-3des-talitos
[ 2.255555] 00000000: 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72 73 74
00000010: 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63 74 65
00000020: 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72
00000030: 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63
00000040: 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65
00000050: 65 72 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53
00000060: 72 63 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20
00000070: 63 65 65 72 73 74 54 20 6f 6f 4d 20 6e 61 0a 79
00000080: c0 50 f1 ac c0 50 f3 38 c0 50 f3 94 c0 50 f5 30
00000090: c0 99 74 3c c0 96 e5 b8
[ 2.309004] alg: aead: Test 1 failed on encryption for authenc-hmac-sha224-cbc-3des-talitos
[ 2.317562] 00000000: 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72 73 74
00000010: 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63 74 65
00000020: 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72
00000030: 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63
00000040: 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65
00000050: 65 72 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53
00000060: 72 63 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20
00000070: 63 65 65 72 73 74 54 20 6f 6f 4d 20 6e 61 0a 79
00000080: c0 50 f1 ac c0 50 f3 38 c0 50 f3 94 c0 50 f5 30
00000090: c0 99 74 3c c0 96 e5 b8
[ 2.370710] alg: aead: Test 1 failed on encryption for authenc-hmac-sha256-cbc-aes-talitos
[ 2.379177] 00000000: 53 69 6e 67 6c 65 20 62 6c 6f 63 6b 20 6d 73 67
00000010: 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63 74 65
00000020: 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72
[ 2.397863] alg: aead: Test 1 failed on encryption for authenc-hmac-sha256-cbc-aes-talitos
[ 2.406134] 00000000: 53 69 6e 67 6c 65 20 62 6c 6f 63 6b 20 6d 73 67
00000010: 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63 74 65
00000020: 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72
[ 2.424789] alg: aead: Test 1 failed on encryption for authenc-hmac-sha256-cbc-3des-talitos
[ 2.433491] 00000000: 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72 73 74
00000010: 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63 74 65
00000020: 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72
00000030: 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63
00000040: 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65
00000050: 65 72 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53
00000060: 72 63 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20
00000070: 63 65 65 72 73 74 54 20 6f 6f 4d 20 6e 61 0a 79
00000080: c0 50 f1 ac c0 50 f3 38 c0 50 f3 94 c0 50 f5 30
00000090: c0 99 74 3c c0 96 e5 b8 c0 96 e9 20 c0 00 3d dc
[ 2.488832] alg: aead: Test 1 failed on encryption for authenc-hmac-sha256-cbc-3des-talitos
[ 2.497387] 00000000: 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72 73 74
00000010: 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63 74 65
00000020: 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65 65 72
00000030: 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53 72 63
00000040: 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20 63 65
00000050: 65 72 73 74 54 20 6f 6f 4d 20 6e 61 20 79 65 53
00000060: 72 63 74 65 20 73 6f 54 20 6f 61 4d 79 6e 53 20
00000070: 63 65 65 72 73 74 54 20 6f 6f 4d 20 6e 61 0a 79
00000080: c0 50 f1 ac c0 50 f3 38 c0 50 f3 94 c0 50 f5 30
00000090: c0 99 74 3c c0 96 e5 b8 c0 96 e9 20 c0 00 3d dc
This patch fixes that.
Signed-off-by: Christophe Leroy
Signed-off-by: Herbert Xu
Signed-off-by: Greg Kroah-Hartman
commit 796c9d1e275e3e35ae13b16021498bc12ab2593e
Author: Daniel Jurgens
Date: Wed Nov 29 20:10:39 2017 +0200
IB/core: Only enforce security for InfiniBand
commit 315d160c5a4e034a576a13aa21e7235d5c9ec609 upstream.
For now the only LSM security enforcement mechanism available is
specific to InfiniBand. Bypass enforcement for non-IB link types.
This fixes a regression where modify\_qp fails for iWARP because
querying the PKEY returns -EINVAL.
Cc: Paul Moore
Cc: Don Dutile
Reported-by: Potnuri Bharat Teja
Fixes: d291f1a65232("IB/core: Enforce PKey security on QPs")
Fixes: 47a2b338fe63("IB/core: Enforce security on management datagrams")
Signed-off-by: Daniel Jurgens
Reviewed-by: Parav Pandit
Tested-by: Potnuri Bharat Teja
Signed-off-by: Leon Romanovsky
Signed-off-by: Jason Gunthorpe
Signed-off-by: Greg Kroah-Hartman
commit 45f846ca6b2119237adfa19a9bbfce43dadb558e
Author: Parav Pandit
Date: Thu Nov 2 15:22:27 2017 +0200
IB/core: Avoid unnecessary return value check
commit 2e4c85c6edc80fa532b2c7e1eb3597ef4d4bbb8f upstream.
Since there is nothing done with non zero return value, such check is
avoided.
Signed-off-by: Parav Pandit
Reviewed-by: Daniel Jurgens
Signed-off-by: Leon Romanovsky
Signed-off-by: Doug Ledford
Signed-off-by: Greg Kroah-Hartman
commit 1cef55be2b6bba7f4c262b35db385425ae1bf04e
Author: Kim Phillips
Date: Wed Oct 11 22:33:24 2017 +0100
bus: arm-ccn: fix module unloading Error: Removing state 147 which has instances left.
commit b69f63ebf553504739cc8534cbed31bd530c6f0b upstream.
Unregistering the driver before calling cpuhp\_remove\_multi\_state() removes
any remaining hotplug cpu instances so \_\_cpuhp\_remove\_state\_cpuslocked()
doesn't emit this warning:
[ 268.748362] Error: Removing state 147 which has instances left.
[ 268.748373] ------------[ cut here ]------------
[ 268.748386] WARNING: CPU: 2 PID: 5476 at kernel/cpu.c:1734 \_\_cpuhp\_remove\_state\_cpuslocked+0x454/0x4f0
[ 268.748389] Modules linked in: arm\_ccn(-) [last unloaded: arm\_ccn]
[ 268.748403] CPU: 2 PID: 5476 Comm: rmmod Tainted: G W 4.14.0-rc4+ #3
[ 268.748406] Hardware name: AMD Seattle/Seattle, BIOS 10:18:39 Dec 8 2016
[ 268.748410] task: ffff8001a18ca000 task.stack: ffff80019c120000
[ 268.748416] PC is at \_\_cpuhp\_remove\_state\_cpuslocked+0x454/0x4f0
[ 268.748421] LR is at \_\_cpuhp\_remove\_state\_cpuslocked+0x448/0x4f0
[ 268.748425] pc : [] lr : [] pstate: 60000145
[ 268.748427] sp : ffff80019c127d30
[ 268.748430] x29: ffff80019c127d30 x28: ffff8001a18ca000
[ 268.748437] x27: ffff20000c2cb000 x26: 1fffe4000042d490
[ 268.748443] x25: ffff20000216a480 x24: 0000000000000000
[ 268.748449] x23: ffff20000b08e000 x22: 0000000000000001
[ 268.748455] x21: 0000000000000093 x20: 00000000000016f8
[ 268.748460] x19: ffff20000c2cbb80 x18: 0000ffffb5fe7c58
[ 268.748466] x17: 00000000004402d0 x16: 1fffe40001864f01
[ 268.748472] x15: ffff20000c4bf8b0 x14: 0000000000000000
[ 268.748477] x13: 0000000000007032 x12: ffff20000829ae48
[ 268.748483] x11: ffff20000c4bf000 x10: 0000000000000004
[ 268.748488] x9 : 0000000000006fbc x8 : ffff20000c318a40
[ 268.748494] x7 : 0000000000000000 x6 : ffff040001864f02
[ 268.748500] x5 : 0000000000000000 x4 : 0000000000000000
[ 268.748505] x3 : 0000000000000007 x2 : dfff200000000000
[ 268.748510] x1 : 000000000000ad3d x0 : 00000000000001f0
[ 268.748516] Call trace:
[ 268.748521] Exception stack(0xffff80019c127bf0 to 0xffff80019c127d30)
[ 268.748526] 7be0: 00000000000001f0 000000000000ad3d
[ 268.748531] 7c00: dfff200000000000 0000000000000007 0000000000000000 0000000000000000
[ 268.748535] 7c20: ffff040001864f02 0000000000000000 ffff20000c318a40 0000000000006fbc
[ 268.748539] 7c40: 0000000000000004 ffff20000c4bf000 ffff20000829ae48 0000000000007032
[ 268.748544] 7c60: 0000000000000000 ffff20000c4bf8b0 1fffe40001864f01 00000000004402d0
[ 268.748548] 7c80: 0000ffffb5fe7c58 ffff20000c2cbb80 00000000000016f8 0000000000000093
[ 268.748553] 7ca0: 0000000000000001 ffff20000b08e000 0000000000000000 ffff20000216a480
[ 268.748557] 7cc0: 1fffe4000042d490 ffff20000c2cb000 ffff8001a18ca000 ffff80019c127d30
[ 268.748562] 7ce0: ffff2000081729e0 ffff80019c127d30 ffff2000081729ec 0000000060000145
[ 268.748566] 7d00: 00000000000001f0 0000000000000000 0001000000000000 0000000000000000
[ 268.748569] 7d20: ffff80019c127d30 ffff2000081729ec
[ 268.748575] [] \_\_cpuhp\_remove\_state\_cpuslocked+0x454/0x4f0
[ 268.748580] [] \_\_cpuhp\_remove\_state+0x54/0x80
[ 268.748597] [] arm\_ccn\_exit+0x2c/0x70 [arm\_ccn]
[ 268.748604] [] SyS\_delete\_module+0x5a4/0x708
[ 268.748607] Exception stack(0xffff80019c127ec0 to 0xffff80019c128000)
[ 268.748612] 7ec0: 0000000019bb7258 0000000000000800 ba64d0fb3d26a800 00000000000000da
[ 268.748616] 7ee0: 0000ffffb6144e28 0000ffffcd95b409 fefefefefefefeff 7f7f7f7f7f7f7f7f
[ 268.748621] 7f00: 000000000000006a 1999999999999999 0000ffffb6179000 0000000000bbcc6d
[ 268.748625] 7f20: 0000ffffb6176b98 0000ffffcd95c2d0 0000ffffb5fe7b58 0000ffffb6163000
[ 268.748630] 7f40: 0000ffffb60ad3e0 00000000004402d0 0000ffffb5fe7c58 0000000019bb71f0
[ 268.748634] 7f60: 0000ffffcd95c740 0000000000000000 0000000019bb71f0 0000000000416700
[ 268.748639] 7f80: 0000000000000000 00000000004402e8 0000000019bb6010 0000ffffcd95c748
[ 268.748643] 7fa0: 0000000000000000 0000ffffcd95c460 00000000004113a8 0000ffffcd95c460
[ 268.748648] 7fc0: 0000ffffb60ad3e8 0000000080000000 0000000019bb7258 000000000000006a
[ 268.748652] 7fe0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
[ 268.748657] [] \_\_sys\_trace\_return+0x0/0x4
[ 268.748661] ---[ end trace a996d358dcaa7f9c ]---
Fixes: 8df038725ad5 ("bus/arm-ccn: Use cpu-hp's multi instance support instead custom list")
Signed-off-by: Kim Phillips
Acked-by: Sebastian Andrzej Siewior
Signed-off-by: Pawel Moll
Signed-off-by: Greg Kroah-Hartman
commit 8741b5ab49403be43771adc57e1c0031514910b9
Author: Marc Zyngier
Date: Tue Oct 3 18:14:12 2017 +0100
bus: arm-ccn: Fix use of smp\_processor\_id() in preemptible context
commit b18c2b9487d8e797fc0a757e57ac3645348c5fba upstream.
Booting a DEBUG\_PREEMPT enabled kernel on a CCN-based system
results in the following splat:
[...]
arm-ccn e8000000.ccn: No access to interrupts, using timer.
BUG: using smp\_processor\_id() in preemptible [00000000] code: swapper/0/1
caller is debug\_smp\_processor\_id+0x1c/0x28
CPU: 1 PID: 1 Comm: swapper/0 Not tainted 4.13.0 #6111
Hardware name: AMD Seattle/Seattle, BIOS 17:08:23 Jun 26 2017
Call trace:
[] dump\_backtrace+0x0/0x278
[] show\_stack+0x24/0x30
[] dump\_stack+0x8c/0xb0
[] check\_preemption\_disabled+0xfc/0x100
[] debug\_smp\_processor\_id+0x1c/0x28
[] arm\_ccn\_probe+0x358/0x4f0
[...]
as we use smp\_processor\_id() in the wrong context.
Turn this into a get\_cpu()/put\_cpu() that extends over the CPU hotplug
registration, making sure that we don't race against a CPU down operation.
Signed-off-by: Marc Zyngier
Acked-by: Mark Rutland
Signed-off-by: Pawel Moll
Signed-off-by: Greg Kroah-Hartman
commit a724b569a50d2e94fd2d3ea123e1b5ad32293c61
Author: Christophe JAILLET
Date: Sun Aug 27 11:06:50 2017 +0100
bus: arm-ccn: Check memory allocation failure
commit 24771179c5c138f0ea3ef88b7972979f62f2d5db upstream.
Check memory allocation failures and return -ENOMEM in such cases
This avoids a potential NULL pointer dereference.
Signed-off-by: Christophe JAILLET
Acked-by: Scott Branden
Signed-off-by: Pawel Moll
Signed-off-by: Greg Kroah-Hartman
commit 2ced9e2a850c40d3bfd7af4791f985318facff68
Author: Marc Zyngier
Date: Tue Oct 3 18:14:13 2017 +0100
bus: arm-cci: Fix use of smp\_processor\_id() in preemptible context
commit 4608af8aa53e7f3922ddee695d023b7bcd5cb35b upstream.
The ARM CCI driver seem to be using smp\_processor\_id() in a
preemptible context, which is likely to make a DEBUG\_PREMPT
kernel scream at boot time.
Turn this into a get\_cpu()/put\_cpu() that extends over the CPU
hotplug registration, making sure that we don't race against
a CPU down operation.
Signed-off-by: Marc Zyngier
Acked-by: Mark Rutland
Signed-off-by: Pawel Moll
Signed-off-by: Greg Kroah-Hartman
commit 1d6c92408159ccfdc60cd988fe229804447f9c7e
Author: Fabio Estevam
Date: Wed Nov 15 10:03:53 2017 -0200
Revert "ARM: dts: imx53: add srtc node"
commit e501506d3ea00eefa64463ebd9e5c13ee70990bd upstream.
This reverts commit 5b725054147deaf966b3919e10a86c6bfe946a18.
The rtc block on i.MX53 is a completely different hardware than the
one found on i.MX25.
Reported-by: Noel Vellemans
Suggested-by: Juergen Borleis
Signed-off-by: Fabio Estevam
Signed-off-by: Shawn Guo
Signed-off-by: Greg Kroah-Hartman
commit e7ef4e829fe1a7e783a5e8233cde4889f4b65729
Author: Will Deacon
Date: Wed Dec 6 10:51:12 2017 +0000
arm64: SW PAN: Update saved ttbr0 value on enter\_lazy\_tlb
commit d96cc49bff5a7735576cc6f6f111f875d101cec8 upstream.
enter\_lazy\_tlb is called when a kernel thread rides on the back of
another mm, due to a context switch or an explicit call to unuse\_mm
where a call to switch\_mm is elided.
In these cases, it's important to keep the saved ttbr value up to date
with the active mm, otherwise we can end up with a stale value which
points to a potentially freed page table.
This patch implements enter\_lazy\_tlb for arm64, so that the saved ttbr0
is kept up-to-date with the active mm for kernel threads.
Cc: Mark Rutland
Cc: Ard Biesheuvel
Cc: Vinayak Menon
Fixes: 39bc88e5e38e9b21 ("arm64: Disable TTBR0\_EL1 during normal kernel execution")
Reviewed-by: Catalin Marinas
Reviewed-by: Mark Rutland
Reported-by: Vinayak Menon
Signed-off-by: Will Deacon
Signed-off-by: Greg Kroah-Hartman
commit a5347596586db3ab5201ff24be75286dd911f897
Author: Will Deacon
Date: Wed Dec 6 10:42:10 2017 +0000
arm64: SW PAN: Point saved ttbr0 at the zero page when switching to init\_mm
commit 0adbdfde8cfc9415aeed2a4955d2d17b3bd9bf13 upstream.
update\_saved\_ttbr0 mandates that mm->pgd is not swapper, since swapper
contains kernel mappings and should never be installed into ttbr0. However,
this means that callers must avoid passing the init\_mm to update\_saved\_ttbr0
which in turn can cause the saved ttbr0 value to be out-of-date in the context
of the idle thread. For example, EFI runtime services may leave the saved ttbr0
pointing at the EFI page table, and kernel threads may end up with stale
references to freed page tables.
This patch changes update\_saved\_ttbr0 so that the init\_mm points the saved
ttbr0 value to the empty zero page, which always exists and never contains
valid translations. EFI and switch can then call into update\_saved\_ttbr0
unconditionally.
Cc: Mark Rutland
Cc: Ard Biesheuvel
Cc: Vinayak Menon
Fixes: 39bc88e5e38e9b21 ("arm64: Disable TTBR0\_EL1 during normal kernel execution")
Reviewed-by: Catalin Marinas
Reviewed-by: Mark Rutland
Reported-by: Vinayak Menon
Signed-off-by: Will Deacon
Signed-off-by: Greg Kroah-Hartman
commit d0e9c7727224011c17e37f3415daec8dd7685ca7
Author: Dave Martin
Date: Tue Dec 5 14:56:42 2017 +0000
arm64: fpsimd: Prevent registers leaking from dead tasks
commit 071b6d4a5d343046f253a5a8835d477d93992002 upstream.
Currently, loading of a task's fpsimd state into the CPU registers
is skipped if that task's state is already present in the registers
of that CPU.
However, the code relies on the struct fpsimd\_state \* (and by
extension struct task\_struct \*) to unambiguously identify a task.
There is a particular case in which this doesn't work reliably:
when a task exits, its task\_struct may be recycled to describe a
new task.
Consider the following scenario:
1) Task P loads its fpsimd state onto cpu C.
per\_cpu(fpsimd\_last\_state, C) := P;
P->thread.fpsimd\_state.cpu := C;
2) Task X is scheduled onto C and loads its fpsimd state on C.
per\_cpu(fpsimd\_last\_state, C) := X;
X->thread.fpsimd\_state.cpu := C;
3) X exits, causing X's task\_struct to be freed.
4) P forks a new child T, which obtains X's recycled task\_struct.
T == X.
T->thread.fpsimd\_state.cpu == C (inherited from P).
5) T is scheduled on C.
T's fpsimd state is not loaded, because
per\_cpu(fpsimd\_last\_state, C) == T (== X) &&
T->thread.fpsimd\_state.cpu == C.
(This is the check performed by fpsimd\_thread\_switch().)
So, T gets X's registers because the last registers loaded onto C
were those of X, in (2).
This patch fixes the problem by ensuring that the sched-in check
fails in (5): fpsimd\_flush\_task\_state(T) is called when T is
forked, so that T->thread.fpsimd\_state.cpu == C cannot be true.
This relies on the fact that T is not schedulable until after
copy\_thread() completes.
Once T's fpsimd state has been loaded on some CPU C there may still
be other cpus D for which per\_cpu(fpsimd\_last\_state, D) ==
&X->thread.fpsimd\_state. But D is necessarily != C in this case,
and the check in (5) must fail.
An alternative fix would be to do refcounting on task\_struct. This
would result in each CPU holding a reference to the last task whose
fpsimd state was loaded there. It's not clear whether this is
preferable, and it involves higher overhead than the fix proposed
in this patch. It would also move all the task\_struct freeing
work into the context switch critical section, or otherwise some
deferred cleanup mechanism would need to be introduced, neither of
which seems obviously justified.
Fixes: 005f78cd8849 ("arm64: defer reloading a task's FPSIMD state to userland resume")
Signed-off-by: Dave Martin
Reviewed-by: Ard Biesheuvel
[will: word-smithed the comment so it makes more sense]
Signed-off-by: Will Deacon
Signed-off-by: Greg Kroah-Hartman
commit fdbc5f3c5ece0a5db265537185d3bb7ff3b52d0d
Author: Marc Zyngier
Date: Thu Nov 16 17:58:18 2017 +0000
KVM: arm/arm64: vgic-its: Check result of allocation before use
commit 686f294f2f1ae40705283dd413ca1e4c14f20f93 upstream.
We miss a test against NULL after allocation.
Fixes: 6d03a68f8054 ("KVM: arm64: vgic-its: Turn device\_id validation into generic ID validation")
Reported-by: AKASHI Takahiro
Acked-by: Christoffer Dall
Signed-off-by: Marc Zyngier
Signed-off-by: Christoffer Dall
Signed-off-by: Greg Kroah-Hartman
commit c6c0913bd13f89d1a875cc7d85b3646840bead07
Author: Marc Zyngier
Date: Thu Nov 16 17:58:16 2017 +0000
KVM: arm/arm64: vgic: Preserve the revious read from the pending table
commit ddb4b0102cb9cdd2398d98b3e1e024e08a2f4239 upstream.
The current pending table parsing code assumes that we keep the
previous read of the pending bits, but keep that variable in
the current block, making sure it is discarded on each loop.
We end-up using whatever is on the stack. Who knows, it might
just be the right thing...
Fixes: 280771252c1ba ("KVM: arm64: vgic-v3: KVM\_DEV\_ARM\_VGIC\_SAVE\_PENDING\_TABLES")
Reported-by: AKASHI Takahiro
Reviewed-by: Christoffer Dall
Signed-off-by: Marc Zyngier
Signed-off-by: Christoffer Dall
Signed-off-by: Greg Kroah-Hartman
commit af85c1e04ec5737d595a9b4d0af0ef72a3ceb23b
Author: Marc Zyngier
Date: Thu Nov 16 17:58:15 2017 +0000
KVM: arm/arm64: vgic-irqfd: Fix MSI entry allocation
commit 150009e2c70cc3c6e97f00e7595055765d32fb85 upstream.
Using the size of the structure we're allocating is a good idea
and avoids any surprise... In this case, we're happilly confusing
kvm\_kernel\_irq\_routing\_entry and kvm\_irq\_routing\_entry...
Fixes: 95b110ab9a09 ("KVM: arm/arm64: Enable irqchip routing")
Reported-by: AKASHI Takahiro
Reviewed-by: Christoffer Dall
Signed-off-by: Marc Zyngier
Signed-off-by: Christoffer Dall
Signed-off-by: Greg Kroah-Hartman
commit 73c4af9627c0914b81832e162deb34f4894760cb
Author: Christoffer Dall
Date: Sun Dec 3 23:54:41 2017 +0100
KVM: arm/arm64: Fix broken GICH\_ELRSR big endian conversion
commit fc396e066318c0a02208c1d3f0b62950a7714999 upstream.
We are incorrectly rearranging 32-bit words inside a 64-bit typed value
for big endian systems, which would result in never marking a virtual
interrupt as inactive on big endian systems (assuming 32 or fewer LRs on
the hardware). Fix this by not doing any word order manipulation for
the typed values.
Acked-by: Christoffer Dall
Signed-off-by: Christoffer Dall
Signed-off-by: Greg Kroah-Hartman
commit a52c2829cd60492fc75bafc323145cab1af915f5
Author: Andrew Honig
Date: Fri Dec 1 10:21:09 2017 -0800
KVM: VMX: remove I/O port 0x80 bypass on Intel hosts
commit d59d51f088014f25c2562de59b9abff4f42a7468 upstream.
This fixes CVE-2017-1000407.
KVM allows guests to directly access I/O port 0x80 on Intel hosts. If
the guest floods this port with writes it generates exceptions and
instability in the host kernel, leading to a crash. With this change
guest writes to port 0x80 on Intel will behave the same as they
currently behave on AMD systems.
Prevent the flooding by removing the code that sets port 0x80 as a
passthrough port. This is essentially the same as upstream patch
99f85a28a78e96d28907fe036e1671a218fee597, except that patch was
for AMD chipsets and this patch is for Intel.
Signed-off-by: Andrew Honig
Signed-off-by: Jim Mattson
Fixes: fdef3ad1b386 ("KVM: VMX: Enable io bitmaps to avoid IO port 0x80 VMEXITs")
Signed-off-by: Radim Krčmář
Signed-off-by: Greg Kroah-Hartman
commit ba8cbedca6dfca432db2eb9ed4013a2dcb358a71
Author: Marc Zyngier
Date: Thu Nov 16 17:58:21 2017 +0000
arm: KVM: Fix VTTBR\_BADDR\_MASK BUG\_ON off-by-one
commit 5553b142be11e794ebc0805950b2e8313f93d718 upstream.
VTTBR\_BADDR\_MASK is used to sanity check the size and alignment of the
VTTBR address. It seems to currently be off by one, thereby only
allowing up to 39-bit addresses (instead of 40-bit) and also
insufficiently checking the alignment. This patch fixes it.
This patch is the 32bit pendent of Kristina's arm64 fix, and
she deserves the actual kudos for pinpointing that one.
Fixes: f7ed45be3ba52 ("KVM: ARM: World-switch implementation")
Reported-by: Kristina Martsenko
Reviewed-by: Christoffer Dall
Signed-off-by: Marc Zyngier
Signed-off-by: Christoffer Dall
Signed-off-by: Greg Kroah-Hartman
commit c4e71b6f7fd75ff372e766e01aded59d869d7cec
Author: Kristina Martsenko
Date: Thu Nov 16 17:58:20 2017 +0000
arm64: KVM: fix VTTBR\_BADDR\_MASK BUG\_ON off-by-one
commit 26aa7b3b1c0fb3f1a6176a0c1847204ef4355693 upstream.
VTTBR\_BADDR\_MASK is used to sanity check the size and alignment of the
VTTBR address. It seems to currently be off by one, thereby only
allowing up to 47-bit addresses (instead of 48-bit) and also
insufficiently checking the alignment. This patch fixes it.
As an example, with 4k pages, before this patch we have:
PHYS\_MASK\_SHIFT = 48
VTTBR\_X = 37 - 24 = 13
VTTBR\_BADDR\_SHIFT = 13 - 1 = 12
VTTBR\_BADDR\_MASK = ((1 << 35) - 1) << 12 = 0x00007ffffffff000
Which is wrong, because the mask doesn't allow bit 47 of the VTTBR
address to be set, and only requires the address to be 12-bit (4k)
aligned, while it actually needs to be 13-bit (8k) aligned because we
concatenate two 4k tables.
With this patch, the mask becomes 0x0000ffffffffe000, which is what we
want.
Fixes: 0369f6a34b9f ("arm64: KVM: EL2 register definitions")
Reviewed-by: Suzuki K Poulose
Reviewed-by: Christoffer Dall
Signed-off-by: Kristina Martsenko
Signed-off-by: Marc Zyngier
Signed-off-by: Christoffer Dall
Signed-off-by: Greg Kroah-Hartman
commit f889ad87b2147dbde1d81715175cf44bdee91fab
Author: Sean Young
Date: Sun Nov 19 16:57:27 2017 -0500
media: rc: partial revert of "media: rc: per-protocol repeat period"
commit 67f0f15ad5c47490e19f2526f8f9cea97c5ce1a6 upstream.
Since commit d57ea877af38 ("media: rc: per-protocol repeat period"), most
IR protocols have a lower keyup timeout. This causes problems on the
ite-cir, which has default IR timeout of 200ms.
Since the IR decoders read the trailing space, with a IR timeout of 200ms,
the last keydown will have at least a delay of 200ms. This is more than
the protocol timeout of e.g. rc-6 (which is 164ms). As a result the last
IR will be interpreted as a new keydown event, and we get two keypresses.
Revert the protocol timeout to 250ms, except for cec which needs a timeout
of 550ms.
Fixes: d57ea877af38 ("media: rc: per-protocol repeat period")
Reported-by: Matthias Reichl
Signed-off-by: Sean Young
Tested-by: Matthias Reichl
Signed-off-by: Mauro Carvalho Chehab
Signed-off-by: Greg Kroah-Hartman
commit 2f2241083a773b52e3319103b0ba2d1331b1f6c0
Author: Sean Young
Date: Wed Nov 8 16:19:45 2017 -0500
media: rc: sir\_ir: detect presence of port
commit 30b4e122d71cbec2944a5f8b558b88936ee42f10 upstream.
Without this test, sir\_ir clumsy claims resources for a device which
does not exist.
The 0-day kernel test robot reports the following errors (in a loop):
sir\_ir sir\_ir.0: Trapped in interrupt
genirq: Flags mismatch irq 4. 00000000 (ttyS0) vs. 00000000 (sir\_ir)
When sir\_ir is loaded with the default io and irq, the following happens:
- sir\_ir claims irq 4
- user space opens /dev/ttyS0
- in serial8250\_do\_startup(), some setup is done for ttyS0, which causes
irq 4 to fire (in THRE test)
- sir\_ir does not realise it was not for it, and spins until the "trapped
in interrupt"
- now serial driver calls setup\_irq() and fails and we get the
"Flags mismatch" error.
There is no port present at 0x3e8 so simply check for the presence of a
port, as suggested by Linus.
Reported-by: kbuild test robot
Tested-by: Fengguang Wu
Signed-off-by: Sean Young
Signed-off-by: Mauro Carvalho Chehab
Signed-off-by: Greg Kroah-Hartman
commit 9a11204d2b26324636ff54f8d28095ed5dd17e91
Author: Laurent Caumont
Date: Sat Nov 11 12:44:46 2017 -0500
media: dvb: i2c transfers over usb cannot be done from stack
commit 6d33377f2abbf9f0e561b116dd468d1c3ff36a6a upstream.
Signed-off-by: Laurent Caumont
Signed-off-by: Sean Young
Signed-off-by: Mauro Carvalho Chehab
Signed-off-by: Greg Kroah-Hartman
commit e547af2582b53354073790df012ba3f852526410
Author: Ville Syrjälä
Date: Wed Nov 29 17:37:30 2017 +0200
drm/i915: Fix vblank timestamp/frame counter jumps on gen2
commit a87e55f89f0b0dc541d89248a8445635936a3858 upstream.
Previously I was under the impression that the scanline counter
reads 0 when the pipe is off. Turns out that's not correct, and
instead the scanline counter simply stops when the pipe stops, and
it retains it's last value until the pipe starts up again, at which
point the scanline counter jumps to vblank start.
These jumps can cause the timestamp to jump backwards by one frame.
Since we use the timestamps to guesstimage also the frame counter
value on gen2, that would cause the frame counter to also jump
backwards, which leads to a massice difference from the previous value.
The end result is that flips/vblank events don't appear to complete as
they're stuck waiting for the frame counter to catch up to that massive
difference.
Fix the problem properly by actually making sure the scanline counter
has started to move before we assume that it's safe to enable vblank
processing.
v2: Less pointless duplication in the code (Chris)
Cc: Daniel Vetter
Cc: Chris Wilson
Reviewed-by: Chris Wilson
Fixes: b7792d8b54cc ("drm/i915: Wait for pipe to start before sampling vblank timestamps on gen2")
Signed-off-by: Ville Syrjälä
Link: https://patchwork.freedesktop.org/patch/msgid/20171129153732.3612-1-ville.syrjala@linux.intel.com
(cherry picked from commit 8fedd64dabc86d0f31a0d1e152be3aa23c323553)
Signed-off-by: Joonas Lahtinen
Signed-off-by: Greg Kroah-Hartman
commit 4b929631c110645b46115d67172d590b210fa8c1
Author: Marek Szyprowski
Date: Wed Nov 22 14:14:47 2017 +0100
drm/exynos: gem: Drop NONCONTIG flag for buffers allocated without IOMMU
commit 120a264f9c2782682027d931d83dcbd22e01da80 upstream.
When no IOMMU is available, all GEM buffers allocated by Exynos DRM driver
are contiguous, because of the underlying dma\_alloc\_attrs() function
provides only such buffers. In such case it makes no sense to keep
BO\_NONCONTIG flag for the allocated GEM buffers. This allows to avoid
failures for buffer contiguity checks in the subsequent operations on GEM
objects.
Signed-off-by: Marek Szyprowski
Signed-off-by: Inki Dae
Signed-off-by: Greg Kroah-Hartman
commit 25df8b009734b241ce581ac7505efc587cf0402e
Author: Marek Szyprowski
Date: Tue Nov 21 08:49:36 2017 +0100
drm/bridge: analogix dp: Fix runtime PM state in get\_modes() callback
commit 510353a63796d467b41237ab4f136136f68c297d upstream.
get\_modes() callback might be called asynchronously from the DRM core and
it is not synchronized with bridge\_enable(), which sets proper runtime PM
state of the main DP device. Fix this by calling pm\_runtime\_get\_sync()
before calling drm\_get\_edid(), which in turn calls drm\_dp\_i2c\_xfer() and
analogix\_dp\_transfer() to ensure that main DP device is runtime active
when doing any access to its registers.
This fixes the following kernel issue on Samsung Exynos5250 Snow board:
Unhandled fault: imprecise external abort (0x406) at 0x00000000
pgd = c0004000
[00000000] \*pgd=00000000
Internal error: : 406 [#1] PREEMPT SMP ARM
Modules linked in:
CPU: 0 PID: 62 Comm: kworker/0:2 Not tainted 4.13.0-rc2-00364-g4a97a3da420b #3357
Hardware name: SAMSUNG EXYNOS (Flattened Device Tree)
Workqueue: events output\_poll\_execute
task: edc14800 task.stack: edcb2000
PC is at analogix\_dp\_transfer+0x15c/0x2fc
LR is at analogix\_dp\_transfer+0x134/0x2fc
pc : [] lr : [] psr: 60000013
sp : edcb3be8 ip : 0000002a fp : 00000001
r10: 00000000 r9 : edcb3cd8 r8 : edcb3c40
r7 : 00000000 r6 : edd3b380 r5 : edd3b010 r4 : 00000064
r3 : 00000000 r2 : f0ad3000 r1 : edcb3c40 r0 : edd3b010
Flags: nZCv IRQs on FIQs on Mode SVC\_32 ISA ARM Segment none
Control: 10c5387d Table: 4000406a DAC: 00000051
Process kworker/0:2 (pid: 62, stack limit = 0xedcb2210)
Stack: (0xedcb3be8 to 0xedcb4000)
[] (analogix\_dp\_transfer) from [] (drm\_dp\_i2c\_do\_msg+0x8c/0x2b4)
[] (drm\_dp\_i2c\_do\_msg) from [] (drm\_dp\_i2c\_xfer+0x98/0x214)
[] (drm\_dp\_i2c\_xfer) from [] (\_\_i2c\_transfer+0x140/0x29c)
[] (\_\_i2c\_transfer) from [] (i2c\_transfer+0x70/0xe4)
[] (i2c\_transfer) from [] (drm\_do\_probe\_ddc\_edid+0xb4/0x114)
[] (drm\_do\_probe\_ddc\_edid) from [] (drm\_probe\_ddc+0x18/0x28)
[] (drm\_probe\_ddc) from [] (drm\_get\_edid+0x124/0x2d4)
[] (drm\_get\_edid) from [] (analogix\_dp\_get\_modes+0x90/0x114)
[] (analogix\_dp\_get\_modes) from [] (drm\_helper\_probe\_single\_connector\_modes+0x198/0x68c)
[] (drm\_helper\_probe\_single\_connector\_modes) from [] (drm\_setup\_crtcs+0x1b4/0xd18)
[] (drm\_setup\_crtcs) from [] (drm\_fb\_helper\_hotplug\_event+0x94/0xd0)
[] (drm\_fb\_helper\_hotplug\_event) from [] (drm\_kms\_helper\_hotplug\_event+0x24/0x28)
[] (drm\_kms\_helper\_hotplug\_event) from [] (output\_poll\_execute+0x6c/0x174)
[] (output\_poll\_execute) from [] (process\_one\_work+0x188/0x3fc)
[] (process\_one\_work) from [] (worker\_thread+0x30/0x4b8)
[] (worker\_thread) from [] (kthread+0x128/0x164)
[] (kthread) from [] (ret\_from\_fork+0x14/0x24)
Code: 0a000002 ea000009 e2544001 0a00004a (e59537c8)
---[ end trace cddc7919c79f7878 ]---
Reported-by: Misha Komarovskiy
Signed-off-by: Marek Szyprowski
Signed-off-by: Greg Kroah-Hartman
Signed-off-by: Archit Taneja
Link: https://patchwork.freedesktop.org/patch/msgid/20171121074936.22520-1-m.szyprowski@samsung.com
commit 55b26ae24c64ee66188952daacb00aa33bd29407
Author: Song Liu
Date: Sun Nov 19 22:17:00 2017 -0800
md/r5cache: move mddev\_lock() out of r5c\_journal\_mode\_set()
commit ff35f58e8f8eb520367879a0ccc6f2ec4b62b17b upstream.
r5c\_journal\_mode\_set() is called by r5c\_journal\_mode\_store() and
raid\_ctr() in dm-raid. We don't need mddev\_lock() when calling from
raid\_ctr(). This patch fixes this by moves the mddev\_lock() to
r5c\_journal\_mode\_store().
Signed-off-by: Song Liu
Signed-off-by: Shaohua Li
Signed-off-by: Greg Kroah-Hartman
commit 425704be0968368005eabbf5c68182a4d4b23c8b
Author: Daniel Thompson
Date: Mon Mar 2 14:13:36 2015 +0000
kdb: Fix handling of kallsyms\_symbol\_next() return value
commit c07d35338081d107e57cf37572d8cc931a8e32e2 upstream.
kallsyms\_symbol\_next() returns a boolean (true on success). Currently
kdb\_read() tests the return value with an inequality that
unconditionally evaluates to true.
This is fixed in the obvious way and, since the conditional branch is
supposed to be unreachable, we also add a WARN\_ON().
Reported-by: Dan Carpenter
Signed-off-by: Daniel Thompson
Signed-off-by: Jason Wessel
Signed-off-by: Greg Kroah-Hartman
commit 01b43f2e3cad60c626daa9b174667a202cee6987
Author: Arend Van Spriel
Date: Sat Nov 25 21:39:25 2017 +0100
brcmfmac: change driver unbind order of the sdio function devices
commit 5c3de777bdaf48bd0cfb43097c0d0fb85056cab7 upstream.
In the function brcmf\_sdio\_firmware\_callback() the driver is
unbound from the sdio function devices in the error path.
However, the order in which it is done resulted in a use-after-free
issue (see brcmf\_ops\_sdio\_remove() in bcmsdh.c). Hence change
the order and first unbind sdio function #2 device and then
unbind sdio function #1 device.
Fixes: 7a51461fc2da ("brcmfmac: unbind all devices upon failure in firmware callback")
Reported-by: Stefan Wahren
Reviewed-by: Hante Meuleman
Reviewed-by: Pieter-Paul Giesberts
Reviewed-by: Franky Lin
Signed-off-by: Arend van Spriel
Signed-off-by: Kalle Valo
Signed-off-by: Greg Kroah-Hartman
commit 15f36a5ea2278e3ee3fecbdac21895886ee80294
Author: David Spinadel
Date: Mon Nov 21 17:01:25 2016 +0200
iwlwifi: mvm: enable RX offloading with TKIP and WEP
commit 9d0fc5a50a0548f8e5d61243e5e5f26d5c405aef upstream.
Set the flag that indicates that ICV was stripped on if
this option was enabled in the HW.
[this is needed for the 9000-series HW to work properly]
Signed-off-by: David Spinadel
Signed-off-by: Luca Coelho
Signed-off-by: Greg Kroah-Hartman
commit 0d46809c6b84cde3d7379f8877bad0528c038460
Author: Emmanuel Grumbach
Date: Sun Nov 19 10:35:14 2017 +0200
iwlwifi: mvm: fix packet injection
commit b13f43a48571f0cd0fda271b5046b65f1f268db5 upstream.
We need to have a station and a queue for the monitor
interface to be able to inject traffic. We used to have
this traffic routed to the auxiliary queue, but this queue
isn't scheduled for the station we had linked to the
monitor vif.
Allocate a new queue, link it to the monitor vif's station
and make that queue use the BE fifo.
This fixes https://bugzilla.kernel.org/show\_bug.cgi?id=196715
Signed-off-by: Emmanuel Grumbach
Signed-off-by: Luca Coelho
Signed-off-by: Greg Kroah-Hartman
commit 26d4d23ae67fc3097e73f50fd55a6cb9fbce2a1e
Author: Ihab Zhaika
Date: Thu Nov 16 09:29:19 2017 +0200
iwlwifi: add new cards for 9260 and 22000 series
commit 567deca8e72df3ceb6c07c63f8541a4928f64d3b upstream.
add 1 PCI ID for 9260 series and 1 for 22000 series.
Signed-off-by: Ihab Zhaika
Signed-off-by: Luca Coelho
Signed-off-by: Greg Kroah-Hartman
commit 60e942644974fe4254b8c6ab6cbbb6e69e88a3f8
Author: Johannes Berg
Date: Mon Nov 13 17:26:09 2017 +0100
iwlwifi: mvm: flush queue before deleting ROC
commit 6c2d49fdc5d947c5fe89935bd52e69f10000f4cb upstream.
Before deleting a time event (remain-on-channel instance), flush
the queue so that frames cannot get stuck on it. We already flush
the AUX STA queues, but a separate station is used for the P2P
Device queue.
Signed-off-by: Johannes Berg
Signed-off-by: Luca Coelho
Signed-off-by: Greg Kroah-Hartman
commit 3e6c41d3ed846e6e5120e9c139778a8788212ff1
Author: Emmanuel Grumbach
Date: Mon Nov 13 09:50:47 2017 +0200
iwlwifi: mvm: don't use transmit queue hang detection when it is not possible
commit 0b9832b712d6767d6c7b01965fd788d1ca84fc92 upstream.
When we act as an AP, new firmware versions handle
internally the power saving clients and the driver doesn't
know that the peers went to sleep. It is, hence, possible
that a peer goes to sleep for a long time and stop pulling
frames. This will cause its transmit queue to hang which is
a condition that triggers the recovery flow in the driver.
While this client is certainly buggy (it should have pulled
the frame based on the TIM IE in the beacon), we can't blow
up because of a buggy client.
Change the current implementation to not enable the
transmit queue hang detection on queues that serve peers
when we act as an AP / GO.
We can still enable this mechanism using the debug
configuration which can come in handy when we want to
debug why the client doesn't wake up.
Signed-off-by: Emmanuel Grumbach
Signed-off-by: Luca Coelho
Signed-off-by: Greg Kroah-Hartman
commit 3b1b28d246c333e9b8ce84e294ae4cad09cfc909
Author: Sara Sharon
Date: Mon Feb 8 23:30:47 2016 +0200
iwlwifi: mvm: mark MIC stripped MPDUs
commit bf19037074e770aad74b3b90f37b8b98db3f3748 upstream.
When RADA is active, the hardware decrypts the packets and strips off
the MIC as it is useless after decryption. Indicate that to mac80211.
[this is needed for the 9000-series HW to work properly]
Signed-off-by: Sara Sharon
Signed-off-by: Luca Coelho
Signed-off-by: Greg Kroah-Hartman
commit f11f5c4b87164c88da85193430f36d7d14bdcec4
Author: Nicholas Piggin
Date: Wed Dec 6 18:21:14 2017 +1000
powerpc/64s: Initialize ISAv3 MMU registers before setting partition table
commit 371b80447ff33ddac392c189cf884a5a3e18faeb upstream.
kexec can leave MMU registers set when booting into a new kernel,
the PIDR (Process Identification Register) in particular. The boot
sequence does not zero PIDR, so it only gets set when CPUs first
switch to a userspace processes (until then it's running a kernel
thread with effective PID = 0).
This leaves a window where a process table entry and page tables are
set up due to user processes running on other CPUs, that happen to
match with a stale PID. The CPU with that PID may cause speculative
accesses that address quadrant 0 (aka userspace addresses), which will
result in cached translations and PWC (Page Walk Cache) for that
process, on a CPU which is not in the mm\_cpumask and so they will not
be invalidated properly.
The most common result is the kernel hanging in infinite page fault
loops soon after kexec (usually in schedule\_tail, which is usually the
first non-speculative quadrant 0 access to a new PID) due to a stale
PWC. However being a stale translation error, it could result in
anything up to security and data corruption problems.
Fix this by zeroing out PIDR at boot and kexec.
Fixes: 7e381c0ff618 ("powerpc/mm/radix: Add mmu context handling callback for radix")
Signed-off-by: Nicholas Piggin
Signed-off-by: Michael Ellerman
Signed-off-by: Greg Kroah-Hartman
commit d46be2f67c1088077e35ab87da6fc2b0d367fb88
Author: David Gibson
Date: Mon Dec 4 16:27:25 2017 +1100
Revert "powerpc: Do not call ppc\_md.panic in fadump panic notifier"
commit ab9dbf771ff9b6b7e814e759213ed01d7f0de320 upstream.
This reverts commit a3b2cb30f252b21a6f962e0dd107c8b897ca65e4.
That commit tried to fix problems with panic on powerpc in certain
circumstances, where some output from the generic panic code was being
dropped.
Unfortunately, it breaks things worse in other circumstances. In
particular when running a PAPR guest, it will now attempt to reboot
instead of informing the hypervisor (KVM or PowerVM) that the guest
has crashed. The crash notification is important to some
virtualization management layers.
Revert it for now until we can come up with a better solution.
Fixes: a3b2cb30f252 ("powerpc: Do not call ppc\_md.panic in fadump panic notifier")
Signed-off-by: David Gibson
[mpe: Tweak change log a bit]
Signed-off-by: Michael Ellerman
Signed-off-by: Greg Kroah-Hartman
commit 59d97bf77a98adb08ce98073842374f17d7876de
Author: Janosch Frank
Date: Mon Dec 4 12:19:11 2017 +0100
KVM: s390: Fix skey emulation permission check
commit ca76ec9ca871e67d8cd0b6caba24aca3d3ac4546 upstream.
All skey functions call skey\_check\_enable at their start, which checks
if we are in the PSTATE and injects a privileged operation exception
if we are.
Unfortunately they continue processing afterwards and perform the
operation anyhow as skey\_check\_enable does not deliver an error if the
exception injection was successful.
Let's move the PSTATE check into the skey functions and exit them on
such an occasion, also we now do not enable skey handling anymore in
such a case.
Signed-off-by: Janosch Frank
Reviewed-by: Christian Borntraeger
Fixes: a7e19ab ("KVM: s390: handle missing storage-key facility")
Reviewed-by: Cornelia Huck
Reviewed-by: Thomas Huth
Signed-off-by: Christian Borntraeger
Signed-off-by: Greg Kroah-Hartman
commit 0fad60d717bccf42b60b45969bcddba577785d5d
Author: Heiko Carstens
Date: Wed Dec 6 16:11:27 2017 +0100
s390: fix compat system call table
commit e779498df587dd2189b30fe5b9245aefab870eb8 upstream.
When wiring up the socket system calls the compat entries were
incorrectly set. Not all of them point to the corresponding compat
wrapper functions, which clear the upper 33 bits of user space
pointers, like it is required.
Fixes: 977108f89c989 ("s390: wire up separate socketcalls system calls")
Signed-off-by: Heiko Carstens
Signed-off-by: Martin Schwidefsky
Signed-off-by: Greg Kroah-Hartman
commit eb7fb979f090997654d70c24d975e8d3c5711b32
Author: Heiko Carstens
Date: Mon Dec 4 09:42:45 2017 +0100
s390/mm: fix off-by-one bug in 5-level page table handling
commit 8d306f53b63099fec2d56300149e400d181ba4f5 upstream.
Martin Cermak reported that setting a uprobe doesn't work. Reason for
this is that the common uprobes code tries to get an unmapped area at
the last possible page within an address space.
This broke with commit 1aea9b3f9210 ("s390/mm: implement 5 level pages
tables") which introduced an off-by-one bug which prevents to map
anything at the last possible page within an address space.
The check with the off-by-one bug however can be removed since with
commit 8ab867cb0806 ("s390/mm: fix BUG\_ON in crst\_table\_upgrade") the
necessary check is done at both call sites.
Reported-by: Martin Cermak
Bisected-by: Thomas Richter
Fixes: 1aea9b3f9210 ("s390/mm: implement 5 level pages tables")
Reviewed-by: Hendrik Brueckner
Signed-off-by: Heiko Carstens
Signed-off-by: Martin Schwidefsky
Signed-off-by: Greg Kroah-Hartman
commit cb90fcfcdd9062453c463622be3029548966f34a
Author: Heiko Carstens
Date: Mon Nov 20 12:38:44 2017 +0100
s390: always save and restore all registers on context switch
commit fbbd7f1a51965b50dd12924841da0d478f3da71b upstream.
The switch\_to() macro has an optimization to avoid saving and
restoring register contents that aren't needed for kernel threads.
There is however the possibility that a kernel thread execve's a user
space program. In such a case the execve'd process can partially see
the contents of the previous process, which shouldn't be allowed.
To avoid this, simply always save and restore register contents on
context switch.
Fixes: fdb6d070effba ("switch\_to: dont restore/save access & fpu regs for kernel threads")
Signed-off-by: Heiko Carstens
Signed-off-by: Martin Schwidefsky
Signed-off-by: Greg Kroah-Hartman
commit b68df97ec8d0fd2074c130a64c831b8b760f1228
Author: Lai Jiangshan
Date: Tue Nov 28 21:19:53 2017 +0800
smp/hotplug: Move step CPUHP\_AP\_SMPCFD\_DYING to the correct place
commit 46febd37f9c758b05cd25feae8512f22584742fe upstream.
Commit 31487f8328f2 ("smp/cfd: Convert core to hotplug state machine")
accidently put this step on the wrong place. The step should be at the
cpuhp\_ap\_states[] rather than the cpuhp\_bp\_states[].
grep smpcfd /sys/devices/system/cpu/hotplug/states
40: smpcfd:prepare
129: smpcfd:dying
"smpcfd:dying" was missing before.
So was the invocation of the function smpcfd\_dying\_cpu().
Fixes: 31487f8328f2 ("smp/cfd: Convert core to hotplug state machine")
Signed-off-by: Lai Jiangshan
Signed-off-by: Thomas Gleixner
Cc: Peter Zijlstra
Cc: Richard Weinberger
Cc: Sebastian Andrzej Siewior
Cc: Boris Ostrovsky
Link: https://lkml.kernel.org/r/20171128131954.81229-1-jiangshanlai@gmail.com
Signed-off-by: Greg Kroah-Hartman
commit ce1079588ebc42a2e3a0d310a2ea1f3a75aa8d49
Author: Robin Murphy
Date: Thu Sep 28 15:14:01 2017 +0100
iommu/vt-d: Fix scatterlist offset handling
commit 29a90b70893817e2f2bb3cea40a29f5308e21b21 upstream.
The intel-iommu DMA ops fail to correctly handle scatterlists where
sg->offset is greater than PAGE\_SIZE - the IOVA allocation is computed
appropriately based on the page-aligned portion of the offset, but the
mapping is set up relative to sg->page, which means it fails to actually
cover the whole buffer (and in the worst case doesn't cover it at all):
(sg->dma\_address + sg->dma\_len) ----+
sg->dma\_address ---------+ |
iov\_pfn------+ | |
| | |
v v v
iova: a b c d e f
|--------|--------|--------|--------|--------|
<...calculated....>
[\_\_\_\_\_mapped\_\_\_\_\_\_]
pfn: 0 1 2 3 4 5
|--------|--------|--------|--------|--------|
^ ^ ^
| | |
sg->page ----+ | |
sg->offset --------------+ |
(sg->offset + sg->length) ----------+
As a result, the caller ends up overrunning the mapping into whatever
lies beyond, which usually goes badly:
[ 429.645492] DMAR: DRHD: handling fault status reg 2
[ 429.650847] DMAR: [DMA Write] Request device [02:00.4] fault addr f2682000 ...
Whilst this is a fairly rare occurrence, it can happen from the result
of intermediate scatterlist processing such as scatterwalk\_ffwd() in the
crypto layer. Whilst that particular site could be fixed up, it still
seems worthwhile to bring intel-iommu in line with other DMA API
implementations in handling this robustly.
To that end, fix the intel\_map\_sg() path to line up the mapping
correctly (in units of MM pages rather than VT-d pages to match the
aligned\_nrpages() calculation) regardless of the offset, and use
sg\_phys() consistently for clarity.
Reported-by: Harsh Jain
Signed-off-by: Robin Murphy
Reviewed by: Ashok Raj
Tested by: Jacob Pan
Signed-off-by: Alex Williamson
Signed-off-by: Greg Kroah-Hartman
commit 3884d12e17ab770aa0f5d4bc65bfbfd006f417fa
Author: Jaejoong Kim
Date: Mon Dec 4 15:31:49 2017 +0900
ALSA: usb-audio: Add check return value for usb\_string()
commit 89b89d121ffcf8d9546633b98ded9d18b8f75891 upstream.
snd\_usb\_copy\_string\_desc() returns zero if usb\_string() fails.
In case of failure, we need to check the snd\_usb\_copy\_string\_desc()'s
return value and add an exception case
Signed-off-by: Jaejoong Kim
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 3936d752df21f3f83155df3a19ec3617c18741be
Author: Jaejoong Kim
Date: Mon Dec 4 15:31:48 2017 +0900
ALSA: usb-audio: Fix out-of-bound error
commit 251552a2b0d454badc8f486e6d79100970c744b0 upstream.
The snd\_usb\_copy\_string\_desc() retrieves the usb string corresponding to
the index number through the usb\_string(). The problem is that the
usb\_string() returns the length of the string (>= 0) when successful, but
it can also return a negative value about the error case or status of
usb\_control\_msg().
If iClockSource is '0' as shown below, usb\_string() will returns -EINVAL.
This will result in '0' being inserted into buf[-22], and the following
KASAN out-of-bound error message will be output.
AudioControl Interface Descriptor:
bLength 8
bDescriptorType 36
bDescriptorSubtype 10 (CLOCK\_SOURCE)
bClockID 1
bmAttributes 0x07 Internal programmable Clock (synced to SOF)
bmControls 0x07
Clock Frequency Control (read/write)
Clock Validity Control (read-only)
bAssocTerminal 0
iClockSource 0
To fix it, check usb\_string()'return value and bail out.
==================================================================
BUG: KASAN: stack-out-of-bounds in parse\_audio\_unit+0x1327/0x1960 [snd\_usb\_audio]
Write of size 1 at addr ffff88007e66735a by task systemd-udevd/18376
CPU: 0 PID: 18376 Comm: systemd-udevd Not tainted 4.13.0+ #3
Hardware name: LG Electronics 15N540-RFLGL/White Tip Mountain, BIOS 15N5
Call Trace:
dump\_stack+0x63/0x8d
print\_address\_description+0x70/0x290
? parse\_audio\_unit+0x1327/0x1960 [snd\_usb\_audio]
kasan\_report+0x265/0x350
\_\_asan\_store1+0x4a/0x50
parse\_audio\_unit+0x1327/0x1960 [snd\_usb\_audio]
? save\_stack+0xb5/0xd0
? save\_stack\_trace+0x1b/0x20
? save\_stack+0x46/0xd0
? kasan\_kmalloc+0xad/0xe0
? kmem\_cache\_alloc\_trace+0xff/0x230
? snd\_usb\_create\_mixer+0xb0/0x4b0 [snd\_usb\_audio]
? usb\_audio\_probe+0x4de/0xf40 [snd\_usb\_audio]
? usb\_probe\_interface+0x1f5/0x440
? driver\_probe\_device+0x3ed/0x660
? build\_feature\_ctl+0xb10/0xb10 [snd\_usb\_audio]
? save\_stack\_trace+0x1b/0x20
? init\_object+0x69/0xa0
? snd\_usb\_find\_csint\_desc+0xa8/0xf0 [snd\_usb\_audio]
snd\_usb\_mixer\_controls+0x1dc/0x370 [snd\_usb\_audio]
? build\_audio\_procunit+0x890/0x890 [snd\_usb\_audio]
? snd\_usb\_create\_mixer+0xb0/0x4b0 [snd\_usb\_audio]
? kmem\_cache\_alloc\_trace+0xff/0x230
? usb\_ifnum\_to\_if+0xbd/0xf0
snd\_usb\_create\_mixer+0x25b/0x4b0 [snd\_usb\_audio]
? snd\_usb\_create\_stream+0x255/0x2c0 [snd\_usb\_audio]
usb\_audio\_probe+0x4de/0xf40 [snd\_usb\_audio]
? snd\_usb\_autosuspend.part.7+0x30/0x30 [snd\_usb\_audio]
? \_\_pm\_runtime\_idle+0x90/0x90
? kernfs\_activate+0xa6/0xc0
? usb\_match\_one\_id\_intf+0xdc/0x130
? \_\_pm\_runtime\_set\_status+0x2d4/0x450
usb\_probe\_interface+0x1f5/0x440
Signed-off-by: Jaejoong Kim
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 8a4b29a72a7cac97a44dec1b74ec804e0176cca8
Author: Takashi Iwai
Date: Thu Nov 30 10:08:28 2017 +0100
ALSA: seq: Remove spurious WARN\_ON() at timer check
commit 43a3542870328601be02fcc9d27b09db467336ef upstream.
The use of snd\_BUG\_ON() in ALSA sequencer timer may lead to a spurious
WARN\_ON() when a slave timer is deployed as its backend and a
corresponding master timer stops meanwhile. The symptom was triggered
by syzkaller spontaneously.
Since the NULL timer is valid there, rip off snd\_BUG\_ON().
Reported-by: syzbot
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 0482dcd51004920b13b59995b7afb66df49937da
Author: Robb Glasser
Date: Tue Dec 5 09:16:55 2017 -0800
ALSA: pcm: prevent UAF in snd\_pcm\_info
commit 362bca57f5d78220f8b5907b875961af9436e229 upstream.
When the device descriptor is closed, the `substream->runtime` pointer
is freed. But another thread may be in the ioctl handler, case
SNDRV\_CTL\_IOCTL\_PCM\_INFO. This case calls snd\_pcm\_info\_user() which
calls snd\_pcm\_info() which accesses the now freed `substream->runtime`.
Note: this fixes CVE-2017-0861
Signed-off-by: Robb Glasser
Signed-off-by: Nick Desaulniers
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit c6705e4c64eb549c1eb86007438034dd7b7a6129
Author: Kailang Yang
Date: Tue Dec 5 15:38:24 2017 +0800
ALSA: hda/realtek - New codec support for ALC257
commit f429e7e494afaded76e62c6f98211a635aa03098 upstream.
Add new support for ALC257 codec.
[ It's supposed to be almost equivalent with other ALC25x variants,
just adding another type and id -- tiwai ]
Signed-off-by: Kailang Yang
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit a121ecb3764e84da656b8d20138997f2fd6aed6f
Author: Jeff Mahoney
Date: Tue Nov 21 13:58:49 2017 -0500
btrfs: handle errors while updating refcounts in update\_ref\_for\_cow
commit 692826b2738101549f032a761a9191636e83be4e upstream.
Since commit fb235dc06fa (btrfs: qgroup: Move half of the qgroup
accounting time out of commit trans) the assumption that
btrfs\_add\_delayed\_{data,tree}\_ref can only return 0 or -ENOMEM has
been false. The qgroup operations call into btrfs\_search\_slot
and friends and can now return the full spectrum of error codes.
Fortunately, the fix here is easy since update\_ref\_for\_cow failing
is already handled so we just need to bail early with the error
code.
Fixes: fb235dc06fa (btrfs: qgroup: Move half of the qgroup accounting ...)
Signed-off-by: Jeff Mahoney
Reviewed-by: Edmund Nadolski
Reviewed-by: Qu Wenruo
Signed-off-by: David Sterba
Signed-off-by: Greg Kroah-Hartman
commit 85ab61fdfa4866cd0465c75fb97a0601fed9973d
Author: Jeff Mahoney
Date: Mon Dec 4 13:11:45 2017 -0500
btrfs: fix missing error return in btrfs\_drop\_snapshot
commit e19182c0fff451e3744c1107d98f072e7ca377a0 upstream.
If btrfs\_del\_root fails in btrfs\_drop\_snapshot, we'll pick up the
error but then return 0 anyway due to mixing err and ret.
Fixes: 79787eaab4612 ("btrfs: replace many BUG\_ONs with proper error handling")
Signed-off-by: Jeff Mahoney
Reviewed-by: David Sterba
Signed-off-by: David Sterba
Signed-off-by: Greg Kroah-Hartman
commit 58582f04bc87b9d8d848d9163ce3355dd6f00602
Author: Radim Krčmář
Date: Thu Nov 30 19:05:45 2017 +0100
KVM: x86: fix APIC page invalidation
commit b1394e745b9453dcb5b0671c205b770e87dedb87 upstream.
Implementation of the unpinned APIC page didn't update the VMCS address
cache when invalidation was done through range mmu notifiers.
This became a problem when the page notifier was removed.
Re-introduce the arch-specific helper and call it from ...range\_start.
Reported-by: Fabian Grünbichler
Fixes: 38b9917350cb ("kvm: vmx: Implement set\_apic\_access\_page\_addr")
Fixes: 369ea8242c0f ("mm/rmap: update to new mmu\_notifier semantic v2")
Reviewed-by: Paolo Bonzini
Reviewed-by: Andrea Arcangeli
Tested-by: Wanpeng Li
Tested-by: Fabian Grünbichler
Signed-off-by: Radim Krčmář
Signed-off-by: Greg Kroah-Hartman
commit d333778b05edfa13a3eb51f3d98efae7b7c2caa8
Author: Rafael J. Wysocki
Date: Fri Dec 1 15:08:12 2017 +0100
x86/PCI: Make broadcom\_postcore\_init() check acpi\_disabled
commit ddec3bdee05b06f1dda20ded003c3e10e4184cab upstream.
acpi\_os\_get\_root\_pointer() may return a valid address even if acpi\_disabled
is set, but the host bridge information from the ACPI tables is not going
to be used in that case and the Broadcom host bridge initialization should
not be skipped then, So make broadcom\_postcore\_init() check acpi\_disabled
too to avoid this issue.
Fixes: 6361d72b04d1 (x86/PCI: read Broadcom CNB20LE host bridge info before PCI scan)
Reported-by: Dave Hansen
Signed-off-by: Rafael J. Wysocki
Signed-off-by: Thomas Gleixner
Cc: Bjorn Helgaas
Cc: Linux PCI
Link: https://lkml.kernel.org/r/3186627.pxZj1QbYNg@aspire.rjw.lan
Signed-off-by: Ingo Molnar
Signed-off-by: Greg Kroah-Hartman
commit e7bb5cf984ba767bc7badbb4f2bead35b88783d6
Author: Chunyu Hu
Date: Mon Nov 27 22:21:39 2017 +0800
x86/idt: Load idt early in start\_secondary
commit 55d2d0ad2fb4325f615d1950486fbc5e6fba1769 upstream.
On a secondary, idt is first loaded in cpu\_init() with load\_current\_idt(),
i.e. no exceptions can be handled before that point.
The conversion of WARN() to use UD requires the IDT being loaded earlier as
any warning between start\_secondary() and load\_curren\_idt() in cpu\_init()
will result in an unhandled @UD exception and therefore fail the bringup of
the CPU.
Install the IDT handlers right in start\_secondary() before calling cpu\_init().
[ tglx: Massaged changelog ]
Fixes: 9a93848fe787 ("x86/debug: Implement \_\_WARN() using UD0")
Signed-off-by: Chunyu Hu
Signed-off-by: Thomas Gleixner
Cc: peterz@infradead.org
Cc: bp@alien8.de
Cc: rostedt@goodmis.org
Cc: luto@kernel.org
Link: https://lkml.kernel.org/r/1511792499-4073-1-git-send-email-chuhu@redhat.com
Signed-off-by: Greg Kroah-Hartman
commit 70feeaaabf4fabf78812d33facd7f8f993b33011
Author: Eric Biggers
Date: Fri Dec 8 15:13:29 2017 +0000
X.509: fix comparisons of ->pkey\_algo
commit 54c1fb39fe0495f846539ab765925b008f86801c upstream.
->pkey\_algo used to be an enum, but was changed to a string by commit
4e8ae72a75aa ("X.509: Make algo identifiers text instead of enum"). But
two comparisons were not updated. Fix them to use strcmp().
This bug broke signature verification in certain configurations,
depending on whether the string constants were deduplicated or not.
Fixes: 4e8ae72a75aa ("X.509: Make algo identifiers text instead of enum")
Signed-off-by: Eric Biggers
Signed-off-by: David Howells
Signed-off-by: Greg Kroah-Hartman
commit 31b3bcc66f52790010f6a5d4458cabf89f2ffcfa
Author: Eric Biggers
Date: Fri Dec 8 15:13:27 2017 +0000
X.509: reject invalid BIT STRING for subjectPublicKey
commit 0f30cbea005bd3077bd98cd29277d7fc2699c1da upstream.
Adding a specially crafted X.509 certificate whose subjectPublicKey
ASN.1 value is zero-length caused x509\_extract\_key\_data() to set the
public key size to SIZE\_MAX, as it subtracted the nonexistent BIT STRING
metadata byte. Then, x509\_cert\_parse() called kmemdup() with that bogus
size, triggering the WARN\_ON\_ONCE() in kmalloc\_slab().
This appears to be harmless, but it still must be fixed since WARNs are
never supposed to be user-triggerable.
Fix it by updating x509\_cert\_parse() to validate that the value has a
BIT STRING metadata byte, and that the byte is 0 which indicates that
the number of bits in the bitstring is a multiple of 8.
It would be nice to handle the metadata byte in asn1\_ber\_decoder()
instead. But that would be tricky because in the general case a BIT
STRING could be implicitly tagged, and/or could legitimately have a
length that is not a whole number of bytes.
Here was the WARN (cleaned up slightly):
WARNING: CPU: 1 PID: 202 at mm/slab\_common.c:971 kmalloc\_slab+0x5d/0x70 mm/slab\_common.c:971
Modules linked in:
CPU: 1 PID: 202 Comm: keyctl Tainted: G B 4.14.0-09238-g1d3b78bbc6e9 #26
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.11.0-20171110\_100015-anatol 04/01/2014
task: ffff880033014180 task.stack: ffff8800305c8000
Call Trace:
\_\_do\_kmalloc mm/slab.c:3706 [inline]
\_\_kmalloc\_track\_caller+0x22/0x2e0 mm/slab.c:3726
kmemdup+0x17/0x40 mm/util.c:118
kmemdup include/linux/string.h:414 [inline]
x509\_cert\_parse+0x2cb/0x620 crypto/asymmetric\_keys/x509\_cert\_parser.c:106
x509\_key\_preparse+0x61/0x750 crypto/asymmetric\_keys/x509\_public\_key.c:174
asymmetric\_key\_preparse+0xa4/0x150 crypto/asymmetric\_keys/asymmetric\_type.c:388
key\_create\_or\_update+0x4d4/0x10a0 security/keys/key.c:850
SYSC\_add\_key security/keys/keyctl.c:122 [inline]
SyS\_add\_key+0xe8/0x290 security/keys/keyctl.c:62
entry\_SYSCALL\_64\_fastpath+0x1f/0x96
Fixes: 42d5ec27f873 ("X.509: Add an ASN.1 decoder")
Signed-off-by: Eric Biggers
Signed-off-by: David Howells
Reviewed-by: James Morris
Signed-off-by: Greg Kroah-Hartman
commit 28e7c9a8e548c8c7e839f6ae1e21d61dc92308b0
Author: Eric Biggers
Date: Fri Dec 8 15:13:29 2017 +0000
KEYS: reject NULL restriction string when type is specified
commit 18026d866801d0c52e5550210563222bd6c7191d upstream.
keyctl\_restrict\_keyring() allows through a NULL restriction when the
"type" is non-NULL, which causes a NULL pointer dereference in
asymmetric\_lookup\_restriction() when it calls strcmp() on the
restriction string.
But no key types actually use a "NULL restriction" to mean anything, so
update keyctl\_restrict\_keyring() to reject it with EINVAL.
Reported-by: syzbot
Fixes: 97d3aa0f3134 ("KEYS: Add a lookup\_restriction function for the asymmetric key type")
Signed-off-by: Eric Biggers
Signed-off-by: David Howells
Signed-off-by: Greg Kroah-Hartman
commit 69d5894ce0a67d37f900d2597fc0b2b8cef6c863
Author: Eric Biggers
Date: Fri Dec 8 15:13:27 2017 +0000
KEYS: add missing permission check for request\_key() destination
commit 4dca6ea1d9432052afb06baf2e3ae78188a4410b upstream.
When the request\_key() syscall is not passed a destination keyring, it
links the requested key (if constructed) into the "default" request-key
keyring. This should require Write permission to the keyring. However,
there is actually no permission check.
This can be abused to add keys to any keyring to which only Search
permission is granted. This is because Search permission allows joining
the keyring. keyctl\_set\_reqkey\_keyring(KEY\_REQKEY\_DEFL\_SESSION\_KEYRING)
then will set the default request-key keyring to the session keyring.
Then, request\_key() can be used to add keys to the keyring.
Both negatively and positively instantiated keys can be added using this
method. Adding negative keys is trivial. Adding a positive key is a
bit trickier. It requires that either /sbin/request-key positively
instantiates the key, or that another thread adds the key to the process
keyring at just the right time, such that request\_key() misses it
initially but then finds it in construct\_alloc\_key().
Fix this bug by checking for Write permission to the keyring in
construct\_get\_dest\_keyring() when the default keyring is being used.
We don't do the permission check for non-default keyrings because that
was already done by the earlier call to lookup\_user\_key(). Also,
request\_key\_and\_link() is currently passed a 'struct key \*' rather than
a key\_ref\_t, so the "possessed" bit is unavailable.
We also don't do the permission check for the "requestor keyring", to
continue to support the use case described by commit 8bbf4976b59f
("KEYS: Alter use of key instantiation link-to-keyring argument") where
/sbin/request-key recursively calls request\_key() to add keys to the
original requestor's destination keyring. (I don't know of any users
who actually do that, though...)
Fixes: 3e30148c3d52 ("[PATCH] Keys: Make request-key create an authorisation key")
Signed-off-by: Eric Biggers
Signed-off-by: David Howells
Signed-off-by: Greg Kroah-Hartman
commit 4c69b34050996d1a1167242f625973dfb9f54271
Author: Eric Biggers
Date: Fri Dec 8 15:13:27 2017 +0000
ASN.1: check for error from ASN1\_OP\_END\_\_ACT actions
commit 81a7be2cd69b412ab6aeacfe5ebf1bb6e5bce955 upstream.
asn1\_ber\_decoder() was ignoring errors from actions associated with the
opcodes ASN1\_OP\_END\_SEQ\_ACT, ASN1\_OP\_END\_SET\_ACT,
ASN1\_OP\_END\_SEQ\_OF\_ACT, and ASN1\_OP\_END\_SET\_OF\_ACT. In practice, this
meant the pkcs7\_note\_signed\_info() action (since that was the only user
of those opcodes). Fix it by checking for the error, just like the
decoder does for actions associated with the other opcodes.
This bug allowed users to leak slab memory by repeatedly trying to add a
specially crafted "pkcs7\_test" key (requires CONFIG\_PKCS7\_TEST\_KEY).
In theory, this bug could also be used to bypass module signature
verification, by providing a PKCS#7 message that is misparsed such that
a signature's ->authattrs do not contain its ->msgdigest. But it
doesn't seem practical in normal cases, due to restrictions on the
format of the ->authattrs.
Fixes: 42d5ec27f873 ("X.509: Add an ASN.1 decoder")
Signed-off-by: Eric Biggers
Signed-off-by: David Howells
Reviewed-by: James Morris
Signed-off-by: Greg Kroah-Hartman
commit 2c4c01d13f74ef37299b4e23a95bb0691298370a
Author: Eric Biggers
Date: Fri Dec 8 15:13:27 2017 +0000
ASN.1: fix out-of-bounds read when parsing indefinite length item
commit e0058f3a874ebb48b25be7ff79bc3b4e59929f90 upstream.
In asn1\_ber\_decoder(), indefinitely-sized ASN.1 items were being passed
to the action functions before their lengths had been computed, using
the bogus length of 0x80 (ASN1\_INDEFINITE\_LENGTH). This resulted in
reading data past the end of the input buffer, when given a specially
crafted message.
Fix it by rearranging the code so that the indefinite length is resolved
before the action is called.
This bug was originally found by fuzzing the X.509 parser in userspace
using libFuzzer from the LLVM project.
KASAN report (cleaned up slightly):
BUG: KASAN: slab-out-of-bounds in memcpy ./include/linux/string.h:341 [inline]
BUG: KASAN: slab-out-of-bounds in x509\_fabricate\_name.constprop.1+0x1a4/0x940 crypto/asymmetric\_keys/x509\_cert\_parser.c:366
Read of size 128 at addr ffff880035dd9eaf by task keyctl/195
CPU: 1 PID: 195 Comm: keyctl Not tainted 4.14.0-09238-g1d3b78bbc6e9 #26
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.11.0-20171110\_100015-anatol 04/01/2014
Call Trace:
\_\_dump\_stack lib/dump\_stack.c:17 [inline]
dump\_stack+0xd1/0x175 lib/dump\_stack.c:53
print\_address\_description+0x78/0x260 mm/kasan/report.c:252
kasan\_report\_error mm/kasan/report.c:351 [inline]
kasan\_report+0x23f/0x350 mm/kasan/report.c:409
memcpy+0x1f/0x50 mm/kasan/kasan.c:302
memcpy ./include/linux/string.h:341 [inline]
x509\_fabricate\_name.constprop.1+0x1a4/0x940 crypto/asymmetric\_keys/x509\_cert\_parser.c:366
asn1\_ber\_decoder+0xb4a/0x1fd0 lib/asn1\_decoder.c:447
x509\_cert\_parse+0x1c7/0x620 crypto/asymmetric\_keys/x509\_cert\_parser.c:89
x509\_key\_preparse+0x61/0x750 crypto/asymmetric\_keys/x509\_public\_key.c:174
asymmetric\_key\_preparse+0xa4/0x150 crypto/asymmetric\_keys/asymmetric\_type.c:388
key\_create\_or\_update+0x4d4/0x10a0 security/keys/key.c:850
SYSC\_add\_key security/keys/keyctl.c:122 [inline]
SyS\_add\_key+0xe8/0x290 security/keys/keyctl.c:62
entry\_SYSCALL\_64\_fastpath+0x1f/0x96
Allocated by task 195:
\_\_do\_kmalloc\_node mm/slab.c:3675 [inline]
\_\_kmalloc\_node+0x47/0x60 mm/slab.c:3682
kvmalloc ./include/linux/mm.h:540 [inline]
SYSC\_add\_key security/keys/keyctl.c:104 [inline]
SyS\_add\_key+0x19e/0x290 security/keys/keyctl.c:62
entry\_SYSCALL\_64\_fastpath+0x1f/0x96
Fixes: 42d5ec27f873 ("X.509: Add an ASN.1 decoder")
Reported-by: Alexander Potapenko
Signed-off-by: Eric Biggers
Signed-off-by: David Howells
Signed-off-by: Greg Kroah-Hartman
commit f4d901739324cc1c400f322767a9df6de7d838ce
Author: Pan Bian
Date: Wed Dec 6 09:50:09 2017 +0000
efi/esrt: Use memunmap() instead of kfree() to free the remapping
commit 89c5a2d34bda58319e3075e8e7dd727ea25a435c upstream.
The remapping result of memremap() should be freed with memunmap(), not kfree().
Signed-off-by: Pan Bian
Signed-off-by: Ard Biesheuvel
Cc: H. Peter Anvin
Cc: Linus Torvalds
Cc: Matt Fleming
Cc: Peter Zijlstra
Cc: Thomas Gleixner
Cc: linux-efi@vger.kernel.org
Link: http://lkml.kernel.org/r/20171206095010.24170-3-ard.biesheuvel@linaro.org
Signed-off-by: Ingo Molnar
Signed-off-by: Greg Kroah-Hartman
commit 985ce9ee25cca9d8841b0cc31ced92dbd1f9bf99
Author: Greg Kroah-Hartman
Date: Wed Dec 6 09:50:08 2017 +0000
efi: Move some sysfs files to be read-only by root
commit af97a77bc01ce49a466f9d4c0125479e2e2230b6 upstream.
Thanks to the scripts/leaking\_addresses.pl script, it was found that
some EFI values should not be readable by non-root users.
So make them root-only, and to do that, add a \_\_ATTR\_RO\_MODE() macro to
make this easier, and use it in other places at the same time.
Reported-by: Linus Torvalds
Tested-by: Dave Young
Signed-off-by: Greg Kroah-Hartman
Signed-off-by: Ard Biesheuvel
Cc: H. Peter Anvin
Cc: Matt Fleming
Cc: Peter Zijlstra
Cc: Thomas Gleixner
Cc: linux-efi@vger.kernel.org
Link: http://lkml.kernel.org/r/20171206095010.24170-2-ard.biesheuvel@linaro.org
Signed-off-by: Ingo Molnar
Signed-off-by: Greg Kroah-Hartman
commit a326fc91abb834c832166cff9f4362f98ff7f95d
Author: Huacai Chen
Date: Tue Nov 21 14:23:39 2017 +0100
scsi: libsas: align sata\_device's rps\_resp on a cacheline
commit c2e8fbf908afd81ad502b567a6639598f92c9b9d upstream.
The rps\_resp buffer in ata\_device is a DMA target, but it isn't
explicitly cacheline aligned. Due to this, adjacent fields can be
overwritten with stale data from memory on non-coherent architectures.
As a result, the kernel is sometimes unable to communicate with an SATA
device behind a SAS expander.
Fix this by ensuring that the rps\_resp buffer is cacheline aligned.
This issue is similar to that fixed by Commit 84bda12af31f93 ("libata:
align ap->sector\_buf") and Commit 4ee34ea3a12396f35b26 ("libata: Align
ata\_device's id on a cacheline").
Signed-off-by: Huacai Chen
Signed-off-by: Christoph Hellwig
Signed-off-by: Martin K. Petersen
Signed-off-by: Greg Kroah-Hartman
commit 21747052c4b31f453e9fbbf4ee46f221c58cf2cd
Author: Huacai Chen
Date: Tue Nov 21 14:23:38 2017 +0100
scsi: use dma\_get\_cache\_alignment() as minimum DMA alignment
commit 90addc6b3c9cda0146fbd62a08e234c2b224a80c upstream.
In non-coherent DMA mode, kernel uses cache flushing operations to
maintain I/O coherency, so scsi's block queue should be aligned to the
value returned by dma\_get\_cache\_alignment(). Otherwise, If a DMA buffer
and a kernel structure share a same cache line, and if the kernel
structure has dirty data, cache\_invalidate (no writeback) will cause
data corruption.
Signed-off-by: Huacai Chen
[hch: rebased and updated the comment and changelog]
Signed-off-by: Christoph Hellwig
Signed-off-by: Martin K. Petersen
Signed-off-by: Greg Kroah-Hartman
commit bc2b3046048bc193def020ef9d871f4edb3f47ba
Author: Christoph Hellwig
Date: Tue Nov 21 14:23:37 2017 +0100
scsi: dma-mapping: always provide dma\_get\_cache\_alignment
commit 860dd4424f344400b491b212ee4acb3a358ba9d9 upstream.
Provide the dummy version of dma\_get\_cache\_alignment that always returns
1 even if CONFIG\_HAS\_DMA is not set, so that drivers and subsystems can
use it without ifdefs.
Signed-off-by: Christoph Hellwig
Signed-off-by: Martin K. Petersen
Signed-off-by: Greg Kroah-Hartman
commit 400391d711b1f783c85679b70f71c5fea56c0341
Author: William Breathitt Gray
Date: Wed Nov 8 10:23:11 2017 -0500
isa: Prevent NULL dereference in isa\_bus driver callbacks
commit 5a244727f428a06634f22bb890e78024ab0c89f3 upstream.
The isa\_driver structure for an isa\_bus device is stored in the device
platform\_data member of the respective device structure. This
platform\_data member may be reset to NULL if isa\_driver match callback
for the device fails, indicating a device unsupported by the ISA driver.
This patch fixes a possible NULL pointer dereference if one of the
isa\_driver callbacks to attempted for an unsupported device. This error
should not occur in practice since ISA devices are typically manually
configured and loaded by the users, but we may as well prevent this
error from popping up for the 0day testers.
Fixes: a5117ba7da37 ("[PATCH] Driver model: add ISA bus")
Signed-off-by: William Breathitt Gray
Acked-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit ff8307709c0aff44bb1919e7d98ffa245af7cf6a
Author: Guenter Roeck
Date: Wed Nov 15 13:00:45 2017 -0800
firmware: vpd: Fix platform driver and device registration/unregistration
commit 0631fb8b027f5968c2f5031f0b3ff7be3e4bebcc upstream.
The driver exit function needs to unregister both platform device and
driver. Also, during registration, register driver first and perform
error checks.
Fixes: 049a59db34eb ("firmware: Google VPD sysfs driver")
Signed-off-by: Guenter Roeck
Tested-by: Randy Dunlap
Reviewed-by: Dmitry Torokhov
Signed-off-by: Greg Kroah-Hartman
commit 03bb8e9a18190ee12f5250ff4e97ac035fb2abca
Author: Guenter Roeck
Date: Wed Nov 15 13:00:44 2017 -0800
firmware: vpd: Tie firmware kobject to device lifetime
commit e4b28b3c3a405b251fa25db58abe1512814a680a upstream.
It doesn't make sense to have /sys/firmware/vpd if the device is not
instantiated, so tie its lifetime to the device.
Fixes: 049a59db34eb ("firmware: Google VPD sysfs driver")
Signed-off-by: Guenter Roeck
Reviewed-by: Dmitry Torokhov
Tested-by: Randy Dunlap
Signed-off-by: Greg Kroah-Hartman
commit cdc5340c054b37655ea1f8fef99d3e4ab39855d8
Author: Guenter Roeck
Date: Wed Nov 15 13:00:43 2017 -0800
firmware: vpd: Destroy vpd sections in remove function
commit 811d7e0215fb738fb9a9f0bcb1276516ad161ed1 upstream.
vpd sections are initialized during probe and thus should be destroyed
in the remove function.
Fixes: 049a59db34eb ("firmware: Google VPD sysfs driver")
Signed-off-by: Guenter Roeck
Reviewed-by: Dmitry Torokhov
Tested-by: Randy Dunlap
Signed-off-by: Greg Kroah-Hartman
Signed-off-by: Greg Kroah-Hartman
commit 7b167dc4b875aa9d3bddf5c29b34ccfe8b87174e
Author: Robin H. Johnson
Date: Thu Nov 16 14:36:12 2017 -0800
firmware: cleanup FIRMWARE\_IN\_KERNEL message
commit 0946b2fb38fdb6585a5ac3ca84ac73924f645952 upstream.
The help for FIRMWARE\_IN\_KERNEL still references the firmware\_install
command that was recently removed by commit 5620a0d1aacd ("firmware:
delete in-kernel firmware").
Clean up the message to direct the user to their distribution's
linux-firmware package, and remove any reference to firmware being
included in the kernel source tree.
Fixes: 5620a0d1aacd ("firmware: delete in-kernel firmware").
Cc: Masahiro Yamada
Cc: David Woodhouse
Signed-off-by: Robin H. Johnson
Signed-off-by: Greg Kroah-Hartman
commit 070703364a970ac029f04c09d3e42a6d2287e01a
Author: Paul Meyer
Date: Tue Nov 14 13:06:47 2017 -0700
hv: kvp: Avoid reading past allocated blocks from KVP file
commit 297d6b6e56c2977fc504c61bbeeaa21296923f89 upstream.
While reading in more than one block (50) of KVP records, the allocation
goes per block, but the reads used the total number of allocated records
(without resetting the pointer/stream). This causes the records buffer to
overrun when the refresh reads more than one block over the previous
capacity (e.g. reading more than 100 KVP records whereas the in-memory
database was empty before).
Fix this by reading the correct number of KVP records from file each time.
Signed-off-by: Paul Meyer
Signed-off-by: Long Li
Signed-off-by: K. Y. Srinivasan
Signed-off-by: Greg Kroah-Hartman
commit 3f77a2c68ba8377f7f7ddcadff5ffda238cb83db
Author: K. Y. Srinivasan
Date: Tue Nov 14 06:53:33 2017 -0700
Drivers: hv: vmbus: Fix a rescind issue
commit 7fa32e5ec28b1609abc0b797b58267f725fc3964 upstream.
The current rescind processing code will not correctly handle
the case where the host immediately rescinds a channel that has
been offerred. In this case, we could be blocked in the open call and
since the channel is rescinded, the host will not respond and we could
be blocked forever in the vmbus open call.i Fix this problem.
Signed-off-by: K. Y. Srinivasan
Signed-off-by: Greg Kroah-Hartman
commit 6c802ac42f970976d26241068e7202a84c9fd8b7
Author: Gregory CLEMENT
Date: Tue Nov 14 17:51:50 2017 +0100
pinctrl: armada-37xx: Fix direction\_output() callback behavior
commit 6702abb3bf2394f250af0ee04070227bb5dda788 upstream.
The direction\_output callback of the gpio\_chip structure is supposed to
set the output direction but also to set the value of the gpio. For the
armada-37xx driver this callback acted as the gpio\_set\_direction callback
for the pinctrl.
This patch fixes the behavior of the direction\_output callback by also
applying the value received as parameter.
Fixes: 5715092a458c ("pinctrl: armada-37xx: Add gpio support")
Reported-by: Alexandre Belloni
Signed-off-by: Gregory CLEMENT
Signed-off-by: Linus Walleij
Signed-off-by: Greg Kroah-Hartman
commit b13ec02ab4a24192ad56b47e39a82269cc4825ca
Author: Martin Blumenstingl
Date: Tue Oct 31 21:01:45 2017 +0100
iio: adc: meson-saradc: Meson8 and Meson8b do not have REG11 and REG13
commit 96748823c483c6eed8321f78bd128dd33f09c55c upstream.
The Meson GXBB and newer SoCs have a few more registers than the older
Meson8 and Meson8b SoCs.
Use a separate regmap config to limit the older SoCs to the DELTA\_10
register.
Fixes: 6c76ed31cd05 ("iio: adc: meson-saradc: add Meson8b SoC compatibility")
Signed-off-by: Martin Blumenstingl
Signed-off-by: Jonathan Cameron
Signed-off-by: Greg Kroah-Hartman
commit b6c6d01a2debe8df9541a9bd21cc60760d20f6a2
Author: Martin Blumenstingl
Date: Tue Oct 31 21:01:44 2017 +0100
iio: adc: meson-saradc: initialize the bandgap correctly on older SoCs
commit d85eed9f576369bc90322659de96b7dbea1f9a57 upstream.
Meson8 and Meson8b do not have the MESON\_SAR\_ADC\_REG11 register. The
bandgap setting for these SoCs is configured in the
MESON\_SAR\_ADC\_DELTA\_10 register instead.
Make the driver aware of this difference and use the correct bandgap
register depending on the SoC.
This has worked fine on Meson8 and Meson8b because the bootloader is
already initializing the bandgap setting.
Fixes: 6c76ed31cd05 ("iio: adc: meson-saradc: add Meson8b SoC compatibility")
Signed-off-by: Martin Blumenstingl
Signed-off-by: Jonathan Cameron
Signed-off-by: Greg Kroah-Hartman
commit ac2d7838808c5bb68ea357f748cc4c1710555d6d
Author: Martin Blumenstingl
Date: Tue Oct 31 21:01:43 2017 +0100
iio: adc: meson-saradc: fix the bit\_idx of the adc\_en clock
commit 7a6b0420d2fe4ce59437bd318826fe468f0d71ae upstream.
Meson8 and Meson8b SoCs use the the SAR ADC gate clock provided by the
MESON\_SAR\_ADC\_REG3 register within the SAR ADC register area.
According to the datasheet (and the existing MESON\_SAR\_ADC\_REG3\_CLK\_EN
definition) the gate is on bit 30.
The fls() function returns the last set bit, which is "bit index + 1"
(fls(MESON\_SAR\_ADC\_REG3\_CLK\_EN) returns 31). Fix this by switching to
\_\_ffs() which returns the first set bit, which is bit 30 in our case.
This off by one error results in the ADC not being usable on devices
where the bootloader did not enable the clock.
Fixes: 3adbf3427330 ("iio: adc: add a driver for the SAR ADC found in Amlogic Meson SoCs")
Signed-off-by: Martin Blumenstingl
Signed-off-by: Jonathan Cameron
Signed-off-by: Greg Kroah-Hartman
commit 6f4a0a44ba5aafcb4884b863e0e27923c41ab2ec
Author: Pan Bian
Date: Mon Nov 13 00:01:20 2017 +0800
iio: adc: cpcap: fix incorrect validation
commit 81b039ec36a41a5451e1e36f05bb055eceab1dc8 upstream.
Function platform\_get\_irq\_byname() returns a negative error code on
failure, and a zero or positive number on success. However, in function
cpcap\_adc\_probe(), positive IRQ numbers are also taken as error cases.
Use "if (ddata->irq < 0)" instead of "if (!ddata->irq)" to validate the
return value of platform\_get\_irq\_byname().
Signed-off-by: Pan Bian
Fixes: 25ec249632d50 ("iio: adc: cpcap: Add minimal support for CPCAP PMIC ADC")
Reviewed-by: Sebastian Reichel
Acked-by: Tony Lindgren
Signed-off-by: Jonathan Cameron
Signed-off-by: Greg Kroah-Hartman
commit aaeba39ddfe21321c8cfd5e3caeaef1b7153b184
Author: Peter Meerwald-Stadler
Date: Fri Oct 27 21:45:31 2017 +0200
iio: health: max30102: Temperature should be in milli Celsius
commit ad44a9f804c1591ba2a2ec0ac8d916a515d2790c upstream.
As per ABI temperature should be in milli Celsius after scaling,
not Celsius
Note on stable cc. This driver is breaking the standard IIO
ABI. (JC)
Signed-off-by: Peter Meerwald-Stadler
Acked-by: Matt Ranostay
Signed-off-by: Jonathan Cameron
Signed-off-by: Greg Kroah-Hartman
commit c55befc42a9e65fed575dd7ce4e605e1164df79a
Author: Arnd Bergmann
Date: Wed Sep 6 14:56:50 2017 +0200
iio: stm32: fix adc/trigger link error
commit 6d745ee8b5e81f3a33791e3c854fbbfd6f3e585e upstream.
The ADC driver can trigger on either the timer or the lptim
trigger, but it only uses a Kconfig 'select' statement
to ensure that the first of the two is present. When the lptim
trigger is enabled as a loadable module, and the adc driver
is built-in, we now get a link error:
drivers/iio/adc/stm32-adc.o: In function `stm32\_adc\_get\_trig\_extsel':
stm32-adc.c:(.text+0x4e0): undefined reference to `is\_stm32\_lptim\_trigger'
We could use a second 'select' statement and always have both
trigger drivers enabled when the adc driver is, but it seems that
the lptimer trigger was intentionally left optional, so it seems
better to keep it that way.
This adds a hack to use 'IS\_REACHABLE()' rather than 'IS\_ENABLED()',
which avoids the link error, but instead leads to the lptimer trigger
not being used in the broken configuration. I've added a runtime
warning for this case to help users figure out what they did wrong
if this should ever be done by accident.
Fixes: f0b638a7f6db ("iio: adc: stm32: add support for lptimer triggers")
Signed-off-by: Arnd Bergmann
Signed-off-by: Jonathan Cameron
Signed-off-by: Greg Kroah-Hartman
commit c5a5c47c40ce2478ad5b42b781b16c3e3849438f
Author: weiping zhang
Date: Wed Nov 29 09:23:01 2017 +0800
virtio: release virtio index when fail to device\_register
commit e60ea67bb60459b95a50a156296041a13e0e380e upstream.
index can be reused by other virtio device.
Signed-off-by: weiping zhang
Reviewed-by: Cornelia Huck
Signed-off-by: Michael S. Tsirkin
Signed-off-by: Greg Kroah-Hartman
commit 1f5d203906bc32ddb57d73ec6ea1694505ab7ffa
Author: Stephane Grosjean
Date: Thu Dec 7 16:13:43 2017 +0100
can: peak/pcie\_fd: fix potential bug in restarting tx queue
commit 91785de6f94b58c3fb6664609e3682f011bd28d2 upstream.
Don't rely on can\_get\_echo\_skb() return value to wake the network tx
queue up: can\_get\_echo\_skb() returns 0 if the echo array slot was not
occupied, but also when the DLC of the released echo frame was 0.
Signed-off-by: Stephane Grosjean
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit 67464fbca35ccfbe2f5e957ff2a31334390b7947
Author: Martin Kelly
Date: Tue Dec 5 11:15:50 2017 -0800
can: usb\_8dev: cancel urb on -EPIPE and -EPROTO
commit 12147edc434c9e4c7c2f5fee2e5519b2e5ac34ce upstream.
In mcba\_usb, we have observed that when you unplug the device, the driver will
endlessly resubmit failing URBs, which can cause CPU stalls. This issue
is fixed in mcba\_usb by catching the codes seen on device disconnect
(-EPIPE and -EPROTO).
This driver also resubmits in the case of -EPIPE and -EPROTO, so fix it
in the same way.
Signed-off-by: Martin Kelly
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit 421b93cb0f352c84964b701cf1db2e221c187d37
Author: Martin Kelly
Date: Tue Dec 5 11:15:48 2017 -0800
can: esd\_usb2: cancel urb on -EPIPE and -EPROTO
commit 7a31ced3de06e9878e4f9c3abe8f87d9344d8144 upstream.
In mcba\_usb, we have observed that when you unplug the device, the driver will
endlessly resubmit failing URBs, which can cause CPU stalls. This issue
is fixed in mcba\_usb by catching the codes seen on device disconnect
(-EPIPE and -EPROTO).
This driver also resubmits in the case of -EPIPE and -EPROTO, so fix it
in the same way.
Signed-off-by: Martin Kelly
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit e7a80033fd226b71bd49602052ff8242355fd4a5
Author: Martin Kelly
Date: Tue Dec 5 11:15:47 2017 -0800
can: ems\_usb: cancel urb on -EPIPE and -EPROTO
commit bd352e1adfe0d02d3ea7c8e3fb19183dc317e679 upstream.
In mcba\_usb, we have observed that when you unplug the device, the driver will
endlessly resubmit failing URBs, which can cause CPU stalls. This issue
is fixed in mcba\_usb by catching the codes seen on device disconnect
(-EPIPE and -EPROTO).
This driver also resubmits in the case of -EPIPE and -EPROTO, so fix it
in the same way.
Signed-off-by: Martin Kelly
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit b96f17231dca5ddc2136999ca147cdeb842b2664
Author: Martin Kelly
Date: Tue Dec 5 10:34:03 2017 -0800
can: mcba\_usb: cancel urb on -EPROTO
commit c7f33023308f3142433b7379718af5f0c2c322a6 upstream.
When we unplug the device, we can see both -EPIPE and -EPROTO depending
on exact timing and what system we run on. If we continue to resubmit
URBs, they will immediately fail, and they can cause stalls, especially
on slower CPUs.
Fix this by not resubmitting on -EPROTO, as we already do on -EPIPE.
Signed-off-by: Martin Kelly
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit d04d52a6f268b635b4e69cbe28beaf5fd19228e1
Author: Martin Kelly
Date: Tue Dec 5 11:15:49 2017 -0800
can: kvaser\_usb: cancel urb on -EPIPE and -EPROTO
commit 6aa8d5945502baf4687d80de59b7ac865e9e666b upstream.
In mcba\_usb, we have observed that when you unplug the device, the driver will
endlessly resubmit failing URBs, which can cause CPU stalls. This issue
is fixed in mcba\_usb by catching the codes seen on device disconnect
(-EPIPE and -EPROTO).
This driver also resubmits in the case of -EPIPE and -EPROTO, so fix it
in the same way.
Signed-off-by: Martin Kelly
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit 6f4fd93f349036ebeb136838444336f376f0e7db
Author: Jimmy Assarsson
Date: Tue Nov 21 08:22:28 2017 +0100
can: kvaser\_usb: ratelimit errors if incomplete messages are received
commit 8bd13bd522ff7dfa0eb371921aeb417155f7a3be upstream.
Avoid flooding the kernel log with "Formate error", if incomplete message
are received.
Signed-off-by: Jimmy Assarsson
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit 5250169e7390db30c60d35515b6b40501764164d
Author: Jimmy Assarsson
Date: Tue Nov 21 08:22:27 2017 +0100
can: kvaser\_usb: Fix comparison bug in kvaser\_usb\_read\_bulk\_callback()
commit e84f44eb5523401faeb9cc1c97895b68e3cfb78d upstream.
The conditon in the while-loop becomes true when actual\_length is less than
2 (MSG\_HEADER\_LEN). In best case we end up with a former, already
dispatched msg, that got msg->len greater than actual\_length. This will
result in a "Format error" error printout.
Problem seen when unplugging a Kvaser USB device connected to a vbox guest.
warning: comparison between signed and unsigned integer expressions
[-Wsign-compare]
Signed-off-by: Jimmy Assarsson
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit 896ae65aabc8438a3fa9405e3996bd59e3372055
Author: Jimmy Assarsson
Date: Tue Nov 21 08:22:26 2017 +0100
can: kvaser\_usb: free buf in error paths
commit 435019b48033138581a6171093b181fc6b4d3d30 upstream.
The allocated buffer was not freed if usb\_submit\_urb() failed.
Signed-off-by: Jimmy Assarsson
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit 63f2bd86ccc0a2864bdb0d9bb7bb6735276019af
Author: Oliver Stäbler
Date: Mon Nov 20 14:45:15 2017 +0100
can: ti\_hecc: Fix napi poll return value for repoll
commit f6c23b174c3c96616514827407769cbcfc8005cf upstream.
After commit d75b1ade567f ("net: less interrupt masking in NAPI") napi
repoll is done only when work\_done == budget.
So we need to return budget if there are still packets to receive.
Signed-off-by: Oliver Stäbler
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit 39797254631553b51b2e64d5160ff8709a66254c
Author: Marc Kleine-Budde
Date: Mon Nov 27 09:18:21 2017 +0100
can: flexcan: fix VF610 state transition issue
commit 29c64b17a0bc72232acc45e9533221d88a262efb upstream.
Enable FLEXCAN\_QUIRK\_BROKEN\_PERR\_STATE for VF610 to report correct state
transitions.
Tested-by: Mirza Krak
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit 5b65e2916c4ba62ce543cd1366a6649a9ff5bcb2
Author: Stephane Grosjean
Date: Thu Nov 23 15:44:35 2017 +0100
can: peak/pci: fix potential bug when probe() fails
commit 5c2cb02edf79ad79d9b8d07c6d52243a948c4c9f upstream.
PCI/PCIe drivers for PEAK-System CAN/CAN-FD interfaces do some access to the
PCI config during probing. In case one of these accesses fails, a POSITIVE
PCIBIOS\_xxx error code is returned back. This POSITIVE error code MUST be
converted into a NEGATIVE errno for the probe() function to indicate it
failed. Using the pcibios\_err\_to\_errno() function, we make sure that the
return code will always be negative.
Signed-off-by: Stephane Grosjean
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit ba4eed1bd4d82ed591f07eee628b1efade7e6764
Author: Martin Kelly
Date: Mon Nov 27 15:49:16 2017 -0800
can: mcba\_usb: fix device disconnect bug
commit 1cb35a33a28394fd711bb26ddf3a564f4e9d9125 upstream.
Currently, when you disconnect the device, the driver infinitely
resubmits all URBs, so you see:
Rx URB aborted (-32)
in an infinite loop.
Fix this by catching -EPIPE (what we get in urb->status when the device
disconnects) and not resubmitting.
With this patch, I can plug and unplug many times and the driver
recovers correctly.
Signed-off-by: Martin Kelly
Signed-off-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit 4dc9c1cfa9fffed0ec812a85e4b06a68efb6afea
Author: John Keeping
Date: Mon Nov 27 18:15:40 2017 +0000
usb: f\_fs: Force Reserved1=1 in OS\_DESC\_EXT\_COMPAT
commit a3acc696085e112733d191a77b106e67a4fa110b upstream.
The specification says that the Reserved1 field in OS\_DESC\_EXT\_COMPAT
must have the value "1", but when this feature was first implemented we
rejected any non-zero values.
This was adjusted to accept all non-zero values (while now rejecting
zero) in commit 53642399aa71 ("usb: gadget: f\_fs: Fix wrong check on
reserved1 of OS\_DESC\_EXT\_COMPAT"), but that breaks any userspace
programs that worked previously by returning EINVAL when Reserved1 == 0
which was previously the only value that succeeded!
If we just set the field to "1" ourselves, both old and new userspace
programs continue to work correctly and, as a bonus, old programs are
now compliant with the specification without having to fix anything
themselves.
Fixes: 53642399aa71 ("usb: gadget: f\_fs: Fix wrong check on reserved1 of OS\_DESC\_EXT\_COMPAT")
Signed-off-by: John Keeping
Signed-off-by: Felipe Balbi
Signed-off-by: Greg Kroah-Hartman
commit ce42ed5ae8982360dba581acfafdaff88f2b3fbe
Author: Johan Hovold
Date: Fri Nov 3 15:30:56 2017 +0100
serdev: ttyport: fix tty locking in close
commit 90dbad8cd6efccbdce109d5ef0724f8434a6cdde upstream.
Make sure to hold the tty lock as required when calling tty-driver
close() (e.g. to avoid racing with hangup()).
Note that the serport active flag is currently set under the lock at
controller open, but really isn't protected by it.
Fixes: cd6484e1830b ("serdev: Introduce new bus for serial attached devices")
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit 5a3da8bd93c78b6a4aed19c83cb8f493dfc4dfef
Author: Johan Hovold
Date: Fri Nov 3 15:30:55 2017 +0100
serdev: ttyport: fix NULL-deref on hangup
commit 8bcd4e6a8decac251d55c4377e2e67f052777ce0 upstream.
Make sure to use a properly refcounted tty\_struct in write\_wake up to
avoid dereferencing a NULL-pointer when a port is being hung up.
Fixes: bed35c6dfa6a ("serdev: add a tty port controller driver")
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit d415ccdd0be1a745904a7b12b87437463aa35a8d
Author: Johan Hovold
Date: Fri Nov 3 15:30:52 2017 +0100
serdev: ttyport: add missing receive\_buf sanity checks
commit eb281683621b71ab9710d9dccbbef0c2e1769c97 upstream.
The receive\_buf tty-port callback should return the number of bytes
accepted and must specifically never return a negative errno (or a value
larger than the buffer size) to the tty layer.
A serdev driver not providing a receive\_buf callback would currently
cause the flush\_to\_ldisc() worker to spin in a tight loop when the tty
buffer pointers are incremented with -EINVAL (-22) after data has been
received.
A serdev driver occasionally returning a negative errno (or a too large
byte count) could cause information leaks or crashes when accessing
memory outside the tty buffers in consecutive callbacks.
Fixes: cd6484e1830b ("serdev: Introduce new bus for serial attached devices")
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit 28ddc2b45f5f409b905dc78e79d959377789fc12
Author: Roger Quadros
Date: Tue Oct 31 15:56:29 2017 +0200
usb: gadget: core: Fix ->udc\_set\_speed() speed handling
commit a4f0927ef588cf62bb864707261482c874352942 upstream.
Currently UDC core calls ->udc\_set\_speed() with the speed parameter
containing the maximum speed supported by the gadget function
driver. This might very well be more than that supported by the
UDC controller driver.
Select the lesser of the 2 speeds so both UDC and gadget function
driver are operating within limits.
This fixes PHY Erratic errors and 2 second enumeration delay on
TI's AM437x platforms.
Fixes: 6099eca796ae ("usb: gadget: core: introduce ->udc\_set\_speed() method")
Reported-by: Dylan Howey
Signed-off-by: Roger Quadros
Signed-off-by: Felipe Balbi
Signed-off-by: Greg Kroah-Hartman
commit cb6c13d914e0f5b7badc3ec455114e4b45177c2a
Author: Yoshihiro Shimoda
Date: Mon Nov 13 17:59:18 2017 +0900
usb: gadget: udc: renesas\_usb3: fix number of the pipes
commit a58204ab91ad8cae4d8474aa0ba5d1fc504860c9 upstream.
This controller on R-Car Gen3 has 6 pipes that included PIPE 0 for
control actually. But, the datasheet has error in writing as it has
31 pipes. (However, the previous code defined 30 pipes wrongly...)
Anyway, this patch fixes it.
Fixes: 746bfe63bba3 ("usb: gadget: renesas\_usb3: add support for Renesas USB3.0 peripheral controller")
Signed-off-by: Yoshihiro Shimoda
Signed-off-by: Felipe Balbi
Signed-off-by: Greg Kroah-Hartman


=== Content from usn.ubuntu.com_60fb3e57_20250125_210644.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3617-1: Linux kernel vulnerabilities

3 April 2018

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 17.10](/security/notices?release=artful)

## Packages

* [linux](/security/cves?package=linux) - Linux kernel

## Details

It was discovered that a race condition leading to a use-after-free

vulnerability existed in the ALSA PCM subsystem of the Linux kernel. A

local attacker could use this to cause a denial of service (system crash)

or possibly execute arbitrary code. ([CVE-2017-0861](/security/CVE-2017-0861))

It was discovered that the KVM implementation in the Linux kernel allowed

passthrough of the diagnostic I/O port 0x80. An attacker in a guest VM

could use this to cause a denial of service (system crash) in the host OS.

([CVE-2017-1000407](/security/CVE-2017-1000407))

It was discovered that a use-after-free vulnerability existed in the

network namespaces implementation in the Linux kernel. A local attacker

could use this to cause a denial of service (system crash) or possibly

execute arbitrary code. ([CVE-2017-15129](/security/CVE-2017-15129))

Andrey Konovalov discovered that the usbtest device driver in the Linux

kernel did not properly validate endpoint metadata. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2017-16532](/security/CVE-2017-16532))

Andrey Konovalov discovered that the SoundGraph iMON USB driver in the

Linux kernel did not properly validate device metadata. A physically

proximate attacker could use this to cause a denial of service (system

crash). ([CVE-2017-16537](/security/CVE-2017-16537))

Andrey Konovalov discovered that the IMS Passenger Control Unit USB driver

in the Linux kernel did not properly validate device descriptors. A

physically proximate attacker could use this to cause a denial of service

(system crash). ([CVE-2017-16645](/security/CVE-2017-16645))

Andrey Konovalov discovered that the DiBcom DiB0700 USB DVB driver in the

Linux kernel did not properly handle detach events. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2017-16646](/security/CVE-2017-16646))

Andrey Konovalov discovered that the ASIX Ethernet USB driver in the Linux

kernel did not properly handle suspend and resume events. A physically

proximate attacker could use this to cause a denial of service (system

crash). ([CVE-2017-16647](/security/CVE-2017-16647))

Andrey Konovalov discovered that the CDC USB Ethernet driver did not

properly validate device descriptors. A physically proximate attacker could

use this to cause a denial of service (system crash). ([CVE-2017-16649](/security/CVE-2017-16649))

Andrey Konovalov discovered that the QMI WWAN USB driver did not properly

validate device descriptors. A physically proximate attacker could use this

to cause a denial of service (system crash). ([CVE-2017-16650](/security/CVE-2017-16650))

It was discovered that the HugeTLB component of the Linux kernel did not

properly handle holes in hugetlb ranges. A local attacker could use this to

expose sensitive information (kernel memory). ([CVE-2017-16994](/security/CVE-2017-16994))

It was discovered that the netfilter component of the Linux did not

properly restrict access to the connection tracking helpers list. A local

attacker could use this to bypass intended access restrictions.

([CVE-2017-17448](/security/CVE-2017-17448))

It was discovered that the netfilter passive OS fingerprinting (xt\_osf)

module did not properly perform access control checks. A local attacker

could improperly modify the system-wide OS fingerprint list.

([CVE-2017-17450](/security/CVE-2017-17450))

Dmitry Vyukov discovered that the KVM implementation in the Linux kernel

contained an out-of-bounds read when handling memory-mapped I/O. A local

attacker could use this to expose sensitive information. ([CVE-2017-17741](/security/CVE-2017-17741))

It was discovered that the Salsa20 encryption algorithm implementations in

the Linux kernel did not properly handle zero-length inputs. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2017-17805](/security/CVE-2017-17805))

It was discovered that the HMAC implementation did not validate the state

of the underlying cryptographic hash algorithm. A local attacker could use

this to cause a denial of service (system crash) or possibly execute

arbitrary code. ([CVE-2017-17806](/security/CVE-2017-17806))

It was discovered that the keyring implementation in the Linux kernel did

not properly check permissions when a key request was performed on a task's

default keyring. A local attacker could use this to add keys to

unauthorized keyrings. ([CVE-2017-17807](/security/CVE-2017-17807))

It was discovered that a race condition existed in the OCFS2 file system

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (kernel deadlock). ([CVE-2017-18204](/security/CVE-2017-18204))

It was discovered that the Broadcom NetXtremeII ethernet driver in the

Linux kernel did not properly validate Generic Segment Offload (GSO) packet

sizes. An attacker could use this to cause a denial of service (interface

unavailability). ([CVE-2018-1000026](/security/CVE-2018-1000026))

It was discovered that the Reliable Datagram Socket (RDS) implementation in

the Linux kernel contained an out-of-bounds write during RDMA page allocation. An

attacker could use this to cause a denial of service (system crash) or

possibly execute arbitrary code. ([CVE-2018-5332](/security/CVE-2018-5332))

Mohamed Ghannam discovered a null pointer dereference in the RDS (Reliable

Datagram Sockets) protocol implementation of the Linux kernel. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2018-5333](/security/CVE-2018-5333))

范龙飞 discovered that a race condition existed in loop block device

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2018-5344](/security/CVE-2018-5344))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 17.10

* [linux-image-4.13.0-38-generic](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.13.0-38.43](https://launchpad.net/ubuntu/%2Bsource/linux/4.13.0-38.43)
* [linux-image-4.13.0-38-lowlatency](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.13.0-38.43](https://launchpad.net/ubuntu/%2Bsource/linux/4.13.0-38.43)
* [linux-image-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.13.0.38.41](https://launchpad.net/ubuntu/%2Bsource/linux/4.13.0-38.43)
* [linux-image-4.13.0-38-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.13.0-38.43](https://launchpad.net/ubuntu/%2Bsource/linux/4.13.0-38.43)
* [linux-image-generic](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.13.0.38.41](https://launchpad.net/ubuntu/%2Bsource/linux/4.13.0-38.43)
* [linux-image-lowlatency](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.13.0.38.41](https://launchpad.net/ubuntu/%2Bsource/linux/4.13.0-38.43)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2017-0861](/security/CVE-2017-0861)
* [CVE-2017-1000407](/security/CVE-2017-1000407)
* [CVE-2017-15129](/security/CVE-2017-15129)
* [CVE-2017-16532](/security/CVE-2017-16532)
* [CVE-2017-16537](/security/CVE-2017-16537)
* [CVE-2017-16645](/security/CVE-2017-16645)
* [CVE-2017-16646](/security/CVE-2017-16646)
* [CVE-2017-16647](/security/CVE-2017-16647)
* [CVE-2017-16649](/security/CVE-2017-16649)
* [CVE-2017-16650](/security/CVE-2017-16650)
* [CVE-2017-16994](/security/CVE-2017-16994)
* [CVE-2017-17448](/security/CVE-2017-17448)
* [CVE-2017-17450](/security/CVE-2017-17450)
* [CVE-2017-17741](/security/CVE-2017-17741)
* [CVE-2017-17805](/security/CVE-2017-17805)
* [CVE-2017-17806](/security/CVE-2017-17806)
* [CVE-2017-17807](/security/CVE-2017-17807)
* [CVE-2017-18204](/security/CVE-2017-18204)
* [CVE-2018-1000026](/security/CVE-2018-1000026)
* [CVE-2018-5332](/security/CVE-2018-5332)
* [CVE-2018-5333](/security/CVE-2018-5333)
* [CVE-2018-5344](/security/CVE-2018-5344)

## Related notices

* [USN-3583-2](/security/notices/USN-3583-2)
* [USN-3619-2](/security/notices/USN-3619-2)
* [USN-3619-1](/security/notices/USN-3619-1)
* [USN-3617-3](/security/notices/USN-3617-3)
* [USN-3617-2](/security/notices/USN-3617-2)
* [USN-3632-1](/security/notices/USN-3632-1)
* [USN-3583-1](/security/notices/USN-3583-1)
* [USN-3754-1](/security/notices/USN-3754-1)
* [USN-3822-2](/security/notices/USN-3822-2)
* [USN-3822-1](/security/notices/USN-3822-1)
* [USN-3620-1](/security/notices/USN-3620-1)
* [USN-3620-2](/security/notices/USN-3620-2)
* [USN-3655-1](/security/notices/USN-3655-1)
* [USN-3655-2](/security/notices/USN-3655-2)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from lists.debian.org_49214923_20250125_210644.html ===


---

[[Date Prev](msg00003.html)][[Date Next](msg00005.html)]
[[Thread Prev](msg00003.html)][[Thread Next](msg00005.html)]
[[Date Index](maillist.html#00004)]
[[Thread Index](threads.html#00004)]

# [SECURITY] [DLA 1232-1] linux security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1232-1] linux security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Sun, 07 Jan 2018 22:38:18 +0000
* *Message-id*: <[[🔎]](/msgid-search/1515364698.13978.25.camel%40debian.org) [1515364698.13978.25.camel@debian.org](msg00004.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : linux
Version        : 3.2.96-3
CVE ID         : CVE-2017-5754 CVE-2017-17558 CVE-2017-17741 CVE-2017-17805
                 CVE-2017-17806 CVE-2017-17807

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2017-5754

    Multiple researchers have discovered a vulnerability in Intel
    processors, enabling an attacker controlling an unprivileged
    process to read memory from arbitrary addresses, including from
    the kernel and all other processes running on the system.

    This specific attack has been named Meltdown and is addressed in
    the Linux kernel for the Intel x86-64 architecture by a patch set
    named Kernel Page Table Isolation, enforcing a near complete
    separation of the kernel and userspace address maps and preventing
    the attack. This solution might have a performance impact, and can
    be disabled at boot time by passing `pti=off' to the kernel
    command line.

CVE-2017-17558

    Andrey Konovalov reported that that USB core did not correctly
    handle some error conditions during initialisation.  A physically
    present user with a specially designed USB device can use this to
    cause a denial of service (crash or memory corruption), or
    possibly for privilege escalation.

CVE-2017-17741

    Dmitry Vyukov reported that the KVM implementation for x86 would
    over-read data from memory when emulating an MMIO write if the
    kvm_mmio tracepoint was enabled.  A guest virtual machine might be
    able to use this to cause a denial of service (crash).

CVE-2017-17805

    It was discovered that some implementations of the Salsa20 block
    cipher did not correctly handle zero-length input.  A local user
    could use this to cause a denial of service (crash) or possibly
    have other security impact.

CVE-2017-17806

    It was discovered that the HMAC implementation could be used with
    an underlying hash algorithm that requires a key, which was not
    intended.  A local user could use this to cause a denial of
    service (crash or memory corruption), or possibly for privilege
    escalation.

CVE-2017-17807

    Eric Biggers discovered that the KEYS subsystem lacked a check for
    write permission when adding keys to a process's default keyring.
    A local user could use this to cause a denial of service or to
    obtain sensitive information.

For Debian 7 "Wheezy", these problems have been fixed in version
3.2.96-3.

We recommend that you upgrade your linux packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
Ben Hutchings - Debian developer, member of kernel, installer and LTS teams
```

**Attachment:
[signature.asc](pgpOCStJH6Qxq.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from git.kernel.org_6107086b_20250125_210643.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Biggers <ebiggers@google.com> | 2017-12-08 15:13:27 +0000 |
| --- | --- | --- |
| committer | David Howells <dhowells@redhat.com> | 2017-12-08 15:13:27 +0000 |
| commit | [4dca6ea1d9432052afb06baf2e3ae78188a4410b](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b)) | |
| tree | [6ace59f18f7f7283ffb5dec6d316d7222c0c625e](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b) | |
| parent | [a2d8737d5c781d388b553dd085b56d7295fffc6c](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=a2d8737d5c781d388b553dd085b56d7295fffc6c) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b&id2=a2d8737d5c781d388b553dd085b56d7295fffc6c)) | |
| download | [linux-4dca6ea1d9432052afb06baf2e3ae78188a4410b.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-4dca6ea1d9432052afb06baf2e3ae78188a4410b.tar.gz) | |

KEYS: add missing permission check for request\_key() destinationWhen the request\_key() syscall is not passed a destination keyring, it
links the requested key (if constructed) into the "default" request-key
keyring. This should require Write permission to the keyring. However,
there is actually no permission check.
This can be abused to add keys to any keyring to which only Search
permission is granted. This is because Search permission allows joining
the keyring. keyctl\_set\_reqkey\_keyring(KEY\_REQKEY\_DEFL\_SESSION\_KEYRING)
then will set the default request-key keyring to the session keyring.
Then, request\_key() can be used to add keys to the keyring.
Both negatively and positively instantiated keys can be added using this
method. Adding negative keys is trivial. Adding a positive key is a
bit trickier. It requires that either /sbin/request-key positively
instantiates the key, or that another thread adds the key to the process
keyring at just the right time, such that request\_key() misses it
initially but then finds it in construct\_alloc\_key().
Fix this bug by checking for Write permission to the keyring in
construct\_get\_dest\_keyring() when the default keyring is being used.
We don't do the permission check for non-default keyrings because that
was already done by the earlier call to lookup\_user\_key(). Also,
request\_key\_and\_link() is currently passed a 'struct key \*' rather than
a key\_ref\_t, so the "possessed" bit is unavailable.
We also don't do the permission check for the "requestor keyring", to
continue to support the use case described by commit 8bbf4976b59f
("KEYS: Alter use of key instantiation link-to-keyring argument") where
/sbin/request-key recursively calls request\_key() to add keys to the
original requestor's destination keyring. (I don't know of any users
who actually do that, though...)
Fixes: 3e30148c3d52 ("[PATCH] Keys: Make request-key create an authorisation key")
Cc: <stable@vger.kernel.org> # v2.6.13+
Signed-off-by: Eric Biggers <ebiggers@google.com>
Signed-off-by: David Howells <dhowells@redhat.com>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b)

| -rw-r--r-- | [security/keys/request\_key.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/security/keys/request_key.c?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b) | 46 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 37 insertions, 9 deletions

| diff --git a/security/keys/request\_key.c b/security/keys/request\_key.cindex c6880af8b41120..114f7408feee62 100644--- a/[security/keys/request\_key.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/security/keys/request_key.c?id=a2d8737d5c781d388b553dd085b56d7295fffc6c)+++ b/[security/keys/request\_key.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/security/keys/request_key.c?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b)@@ -251,11 +251,12 @@ static int construct\_key(struct key \*key, const void \*callout\_info, \* The keyring selected is returned with an extra reference upon it which the \* caller must release. \*/-static void construct\_get\_dest\_keyring(struct key \*\*\_dest\_keyring)+static int construct\_get\_dest\_keyring(struct key \*\*\_dest\_keyring) { struct request\_key\_auth \*rka; const struct cred \*cred = current\_cred(); struct key \*dest\_keyring = \*\_dest\_keyring, \*authkey;+ int ret;  kenter("%p", dest\_keyring); @@ -264,6 +265,8 @@ static void construct\_get\_dest\_keyring(struct key \*\*\_dest\_keyring) /\* the caller supplied one \*/ key\_get(dest\_keyring); } else {+ bool do\_perm\_check = true;+ /\* use a default keyring; falling through the cases until we \* find one that we actually have \*/ switch (cred->jit\_keyring) {@@ -278,8 +281,10 @@ static void construct\_get\_dest\_keyring(struct key \*\*\_dest\_keyring) dest\_keyring = key\_get(rka->dest\_keyring); up\_read(&authkey->sem);- if (dest\_keyring)+ if (dest\_keyring) {+ do\_perm\_check = false; break;+ } }  case KEY\_REQKEY\_DEFL\_THREAD\_KEYRING:@@ -314,11 +319,29 @@ static void construct\_get\_dest\_keyring(struct key \*\*\_dest\_keyring) default: BUG(); }++ /\*+ \* Require Write permission on the keyring. This is essential+ \* because the default keyring may be the session keyring, and+ \* joining a keyring only requires Search permission.+ \*+ \* However, this check is skipped for the "requestor keyring" so+ \* that /sbin/request-key can itself use request\_key() to add+ \* keys to the original requestor's destination keyring.+ \*/+ if (dest\_keyring && do\_perm\_check) {+ ret = key\_permission(make\_key\_ref(dest\_keyring, 1),+ KEY\_NEED\_WRITE);+ if (ret) {+ key\_put(dest\_keyring);+ return ret;+ }+ } }  \*\_dest\_keyring = dest\_keyring; kleave(" [dk %d]", key\_serial(dest\_keyring));- return;+ return 0; }  /\*@@ -444,11 +467,15 @@ static struct key \*construct\_key\_and\_link(struct keyring\_search\_context \*ctx, if (ctx->index\_key.type == &key\_type\_keyring) return ERR\_PTR(-EPERM); - user = key\_user\_lookup(current\_fsuid());- if (!user)- return ERR\_PTR(-ENOMEM);+ ret = construct\_get\_dest\_keyring(&dest\_keyring);+ if (ret)+ goto error; - construct\_get\_dest\_keyring(&dest\_keyring);+ user = key\_user\_lookup(current\_fsuid());+ if (!user) {+ ret = -ENOMEM;+ goto error\_put\_dest\_keyring;+ }  ret = construct\_alloc\_key(ctx, dest\_keyring, flags, user, &key); key\_user\_put(user);@@ -463,7 +490,7 @@ static struct key \*construct\_key\_and\_link(struct keyring\_search\_context \*ctx, } else if (ret == -EINPROGRESS) { ret = 0; } else {- goto couldnt\_alloc\_key;+ goto error\_put\_dest\_keyring; }  key\_put(dest\_keyring);@@ -473,8 +500,9 @@ static struct key \*construct\_key\_and\_link(struct keyring\_search\_context \*ctx, construction\_failed: key\_negate\_and\_link(key, key\_negative\_timeout, NULL, NULL); key\_put(key);-couldnt\_alloc\_key:+error\_put\_dest\_keyring: key\_put(dest\_keyring);+error: kleave(" = %d", ret); return ERR\_PTR(ret); } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-25 21:05:20 +0000



=== Content from usn.ubuntu.com_934b3684_20250125_210650.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3632-1: Linux kernel (Azure) vulnerabilities

24 April 2018

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 16.04 ESM](/security/notices?release=xenial)

## Packages

* [linux-azure](/security/cves?package=linux-azure) - Linux kernel for Microsoft Azure Cloud systems

## Details

It was discovered that a race condition leading to a use-after-free

vulnerability existed in the ALSA PCM subsystem of the Linux kernel. A

local attacker could use this to cause a denial of service (system crash)

or possibly execute arbitrary code. ([CVE-2017-0861](/security/CVE-2017-0861))

It was discovered that the KVM implementation in the Linux kernel allowed

passthrough of the diagnostic I/O port 0x80. An attacker in a guest VM

could use this to cause a denial of service (system crash) in the host OS.

([CVE-2017-1000407](/security/CVE-2017-1000407))

It was discovered that a use-after-free vulnerability existed in the

network namespaces implementation in the Linux kernel. A local attacker

could use this to cause a denial of service (system crash) or possibly

execute arbitrary code. ([CVE-2017-15129](/security/CVE-2017-15129))

It was discovered that the HugeTLB component of the Linux kernel did not

properly handle holes in hugetlb ranges. A local attacker could use this to

expose sensitive information (kernel memory). ([CVE-2017-16994](/security/CVE-2017-16994))

It was discovered that the netfilter component of the Linux did not

properly restrict access to the connection tracking helpers list. A local

attacker could use this to bypass intended access restrictions.

([CVE-2017-17448](/security/CVE-2017-17448))

It was discovered that the netfilter passive OS fingerprinting (xt\_osf)

module did not properly perform access control checks. A local attacker

could improperly modify the system-wide OS fingerprint list.

([CVE-2017-17450](/security/CVE-2017-17450))

Dmitry Vyukov discovered that the KVM implementation in the Linux kernel

contained an out-of-bounds read when handling memory-mapped I/O. A local

attacker could use this to expose sensitive information. ([CVE-2017-17741](/security/CVE-2017-17741))

It was discovered that the Salsa20 encryption algorithm implementations in

the Linux kernel did not properly handle zero-length inputs. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2017-17805](/security/CVE-2017-17805))

It was discovered that the HMAC implementation did not validate the state

of the underlying cryptographic hash algorithm. A local attacker could use

this to cause a denial of service (system crash) or possibly execute

arbitrary code. ([CVE-2017-17806](/security/CVE-2017-17806))

It was discovered that the keyring implementation in the Linux kernel did

not properly check permissions when a key request was performed on a task's

default keyring. A local attacker could use this to add keys to

unauthorized keyrings. ([CVE-2017-17807](/security/CVE-2017-17807))

It was discovered that the Broadcom NetXtremeII ethernet driver in the

Linux kernel did not properly validate Generic Segment Offload (GSO) packet

sizes. An attacker could use this to cause a denial of service (interface

unavailability). ([CVE-2018-1000026](/security/CVE-2018-1000026))

It was discovered that the Reliable Datagram Socket (RDS) implementation in

the Linux kernel contained an out-of-bounds write during RDMA page

allocation. An attacker could use this to cause a denial of service (system

crash) or possibly execute arbitrary code. ([CVE-2018-5332](/security/CVE-2018-5332))

Mohamed Ghannam discovered a null pointer dereference in the RDS (Reliable

Datagram Sockets) protocol implementation of the Linux kernel. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2018-5333](/security/CVE-2018-5333))

范龙飞 discovered that a race condition existed in loop block device

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2018-5344](/security/CVE-2018-5344))

It was discovered that the Broadcom UniMAC MDIO bus controller driver in

the Linux kernel did not properly validate device resources. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2018-8043](/security/CVE-2018-8043))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 16.04

* [linux-image-4.13.0-1014-azure](https://launchpad.net/ubuntu/%2Bsource/linux-azure)
  -
  [4.13.0-1014.17](https://launchpad.net/ubuntu/%2Bsource/linux-azure/4.13.0-1014.17)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2017-0861](/security/CVE-2017-0861)
* [CVE-2017-1000407](/security/CVE-2017-1000407)
* [CVE-2017-15129](/security/CVE-2017-15129)
* [CVE-2017-16994](/security/CVE-2017-16994)
* [CVE-2017-17448](/security/CVE-2017-17448)
* [CVE-2017-17450](/security/CVE-2017-17450)
* [CVE-2017-17741](/security/CVE-2017-17741)
* [CVE-2017-17805](/security/CVE-2017-17805)
* [CVE-2017-17806](/security/CVE-2017-17806)
* [CVE-2017-17807](/security/CVE-2017-17807)
* [CVE-2018-1000026](/security/CVE-2018-1000026)
* [CVE-2018-5332](/security/CVE-2018-5332)
* [CVE-2018-5333](/security/CVE-2018-5333)
* [CVE-2018-5344](/security/CVE-2018-5344)
* [CVE-2018-8043](/security/CVE-2018-8043)

## Related notices

* [USN-3583-2](/security/notices/USN-3583-2)
* [USN-3619-2](/security/notices/USN-3619-2)
* [USN-3617-1](/security/notices/USN-3617-1)
* [USN-3619-1](/security/notices/USN-3619-1)
* [USN-3617-3](/security/notices/USN-3617-3)
* [USN-3617-2](/security/notices/USN-3617-2)
* [USN-3583-1](/security/notices/USN-3583-1)
* [USN-3620-1](/security/notices/USN-3620-1)
* [USN-3620-2](/security/notices/USN-3620-2)
* [USN-3630-2](/security/notices/USN-3630-2)
* [USN-3630-1](/security/notices/USN-3630-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from github.com_44ad7baa_20250125_210643.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F4dca6ea1d9432052afb06baf2e3ae78188a4410b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F4dca6ea1d9432052afb06baf2e3ae78188a4410b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=torvalds%2Flinux)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[torvalds](/torvalds)
/
**[linux](/torvalds/linux)**
Public

* [Notifications](/login?return_to=%2Ftorvalds%2Flinux) You must be signed in to change notification settings
* [Fork
  54.9k](/login?return_to=%2Ftorvalds%2Flinux)
* [Star
   186k](/login?return_to=%2Ftorvalds%2Flinux)

* [Code](/torvalds/linux)
* [Pull requests
  437](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects
  0](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

Additional navigation options

* [Code](/torvalds/linux)
* [Pull requests](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

## Commit

[Permalink](/torvalds/linux/commit/4dca6ea1d9432052afb06baf2e3ae78188a4410b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

KEYS: add missing permission check for request\_key() destination

[Browse files](/torvalds/linux/tree/4dca6ea1d9432052afb06baf2e3ae78188a4410b)
Browse the repository at this point in the history

```
When the request_key() syscall is not passed a destination keyring, it
links the requested key (if constructed) into the "default" request-key
keyring.  This should require Write permission to the keyring.  However,
there is actually no permission check.

This can be abused to add keys to any keyring to which only Search
permission is granted.  This is because Search permission allows joining
the keyring.  keyctl_set_reqkey_keyring(KEY_REQKEY_DEFL_SESSION_KEYRING)
then will set the default request-key keyring to the session keyring.
Then, request_key() can be used to add keys to the keyring.

Both negatively and positively instantiated keys can be added using this
method.  Adding negative keys is trivial.  Adding a positive key is a
bit trickier.  It requires that either /sbin/request-key positively
instantiates the key, or that another thread adds the key to the process
keyring at just the right time, such that request_key() misses it
initially but then finds it in construct_alloc_key().

Fix this bug by checking for Write permission to the keyring in
construct_get_dest_keyring() when the default keyring is being used.

We don't do the permission check for non-default keyrings because that
was already done by the earlier call to lookup_user_key().  Also,
request_key_and_link() is currently passed a 'struct key *' rather than
a key_ref_t, so the "possessed" bit is unavailable.

We also don't do the permission check for the "requestor keyring", to
continue to support the use case described by commit [8bbf497](https://github.com/torvalds/linux/commit/8bbf4976b59fc9fc2861e79cab7beb3f6d647640)
("KEYS: Alter use of key instantiation link-to-keyring argument") where
/sbin/request-key recursively calls request_key() to add keys to the
original requestor's destination keyring.  (I don't know of any users
who actually do that, though...)

Fixes: [3e30148](https://github.com/torvalds/linux/commit/3e30148c3d524a9c1c63ca28261bc24c457eb07a) ("[PATCH] Keys: Make request-key create an authorisation key")
Cc: <stable@vger.kernel.org>	# v2.6.13+
Signed-off-by: Eric Biggers <ebiggers@google.com>
Signed-off-by: David Howells <dhowells@redhat.com>
```

* Loading branch information

[![@ebiggers](https://avatars.githubusercontent.com/u/2373140?s=40&v=4)](/ebiggers) [![@dhowells](https://avatars.githubusercontent.com/u/22451301?s=40&v=4)](/dhowells)

[ebiggers](/torvalds/linux/commits?author=ebiggers "View all commits by ebiggers")
authored and
[dhowells](/torvalds/linux/commits?author=dhowells "View all commits by dhowells")
committed
Dec 8, 2017

1 parent
[a2d8737](/torvalds/linux/commit/a2d8737d5c781d388b553dd085b56d7295fffc6c)

commit 4dca6ea

Showing
**1 changed file**
with
**37 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

46 changes: 37 additions & 9 deletions

46
[security/keys/request\_key.c](#diff-01e73f1c25e8bc884178ce21f50f5e6402181fdc18f95783199f920c40605e30 "security/keys/request_key.c")

Show comments

[View file](/torvalds/linux/blob/4dca6ea1d9432052afb06baf2e3ae78188a4410b/security/keys/request_key.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -251,11 +251,12 @@ static int construct\_key(struct key \*key, const void \*callout\_info, |
|  |  | \* The keyring selected is returned with an extra reference upon it which the |
|  |  | \* caller must release. |
|  |  | \*/ |
|  |  | static void construct\_get\_dest\_keyring(struct key \*\*\_dest\_keyring) |
|  |  | static int construct\_get\_dest\_keyring(struct key \*\*\_dest\_keyring) |
|  |  | { |
|  |  | struct request\_key\_auth \*rka; |
|  |  | const struct cred \*cred = current\_cred(); |
|  |  | struct key \*dest\_keyring = \*\_dest\_keyring, \*authkey; |
|  |  | int ret; |
|  |  |  |
|  |  | kenter("%p", dest\_keyring); |
|  |  |  |
| Expand All | | @@ -264,6 +265,8 @@ static void construct\_get\_dest\_keyring(struct key \*\*\_dest\_keyring) |
|  |  | /\* the caller supplied one \*/ |
|  |  | key\_get(dest\_keyring); |
|  |  | } else { |
|  |  | bool do\_perm\_check = true; |
|  |  |  |
|  |  | /\* use a default keyring; falling through the cases until we |
|  |  | \* find one that we actually have \*/ |
|  |  | switch (cred->jit\_keyring) { |
| Expand All | | @@ -278,8 +281,10 @@ static void construct\_get\_dest\_keyring(struct key \*\*\_dest\_keyring) |
|  |  | dest\_keyring = |
|  |  | key\_get(rka->dest\_keyring); |
|  |  | up\_read(&authkey->sem); |
|  |  | if (dest\_keyring) |
|  |  | if (dest\_keyring) { |
|  |  | do\_perm\_check = false; |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | case KEY\_REQKEY\_DEFL\_THREAD\_KEYRING: |
| Expand Down  Expand Up | | @@ -314,11 +319,29 @@ static void construct\_get\_dest\_keyring(struct key \*\*\_dest\_keyring) |
|  |  | default: |
|  |  | BUG(); |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* Require Write permission on the keyring. This is essential |
|  |  | \* because the default keyring may be the session keyring, and |
|  |  | \* joining a keyring only requires Search permission. |
|  |  | \* |
|  |  | \* However, this check is skipped for the "requestor keyring" so |
|  |  | \* that /sbin/request-key can itself use request\_key() to add |
|  |  | \* keys to the original requestor's destination keyring. |
|  |  | \*/ |
|  |  | if (dest\_keyring && do\_perm\_check) { |
|  |  | ret = key\_permission(make\_key\_ref(dest\_keyring, 1), |
|  |  | KEY\_NEED\_WRITE); |
|  |  | if (ret) { |
|  |  | key\_put(dest\_keyring); |
|  |  | return ret; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | \*\_dest\_keyring = dest\_keyring; |
|  |  | kleave(" [dk %d]", key\_serial(dest\_keyring)); |
|  |  | return; |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | /\* |
| Expand Down  Expand Up | | @@ -444,11 +467,15 @@ static struct key \*construct\_key\_and\_link(struct keyring\_search\_context \*ctx, |
|  |  | if (ctx->index\_key.type == &key\_type\_keyring) |
|  |  | return ERR\_PTR(-EPERM); |
|  |  |  |
|  |  | user = key\_user\_lookup(current\_fsuid()); |
|  |  | if (!user) |
|  |  | return ERR\_PTR(-ENOMEM); |
|  |  | ret = construct\_get\_dest\_keyring(&dest\_keyring); |
|  |  | if (ret) |
|  |  | goto error; |
|  |  |  |
|  |  | construct\_get\_dest\_keyring(&dest\_keyring); |
|  |  | user = key\_user\_lookup(current\_fsuid()); |
|  |  | if (!user) { |
|  |  | ret = -ENOMEM; |
|  |  | goto error\_put\_dest\_keyring; |
|  |  | } |
|  |  |  |
|  |  | ret = construct\_alloc\_key(ctx, dest\_keyring, flags, user, &key); |
|  |  | key\_user\_put(user); |
| Expand All | | @@ -463,7 +490,7 @@ static struct key \*construct\_key\_and\_link(struct keyring\_search\_context \*ctx, |
|  |  | } else if (ret == -EINPROGRESS) { |
|  |  | ret = 0; |
|  |  | } else { |
|  |  | goto couldnt\_alloc\_key; |
|  |  | goto error\_put\_dest\_keyring; |
|  |  | } |
|  |  |  |
|  |  | key\_put(dest\_keyring); |
| Expand All | | @@ -473,8 +500,9 @@ static struct key \*construct\_key\_and\_link(struct keyring\_search\_context \*ctx, |
|  |  | construction\_failed: |
|  |  | key\_negate\_and\_link(key, key\_negative\_timeout, NULL, NULL); |
|  |  | key\_put(key); |
|  |  | couldnt\_alloc\_key: |
|  |  | error\_put\_dest\_keyring: |
|  |  | key\_put(dest\_keyring); |
|  |  | error: |
|  |  | kleave(" = %d", ret); |
|  |  | return ERR\_PTR(ret); |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4dca6ea`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F4dca6ea1d9432052afb06baf2e3ae78188a4410b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.debian.org_febdc126_20250125_210652.html ===


---

[[Date Prev](msg00003.html)][[Date Next](msg00005.html)]
[[Thread Prev](msg00003.html)][[Thread Next](msg00005.html)]
[[Date Index](maillist.html#00004)]
[[Thread Index](threads.html#00004)]

# [SECURITY] [DSA 4082-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4082-1] linux security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Tue, 09 Jan 2018 16:10:52 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1eYwUG-0006Ko-DT%40seger.debian.org) [E1eYwUG-0006Ko-DT@seger.debian.org](msg00004.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4082-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
January 09, 2018                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2017-5754 CVE-2017-8824 CVE-2017-15868 CVE-2017-16538
                 CVE-2017-16939 CVE-2017-17448 CVE-2017-17449 CVE-2017-17450
                 CVE-2017-17558 CVE-2017-17741 CVE-2017-17805 CVE-2017-17806
                 CVE-2017-17807 CVE-2017-1000407 CVE-2017-1000410

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2017-5754

    Multiple researchers have discovered a vulnerability in Intel
    processors, enabling an attacker controlling an unprivileged
    process to read memory from arbitrary addresses, including from
    the kernel and all other processes running on the system.

    This specific attack has been named Meltdown and is addressed in
    the Linux kernel for the Intel x86-64 architecture by a patch set
    named Kernel Page Table Isolation, enforcing a near complete
    separation of the kernel and userspace address maps and preventing
    the attack. This solution might have a performance impact, and can
    be disabled at boot time by passing `pti=off' to the kernel
    command line.

CVE-2017-8824

    Mohamed Ghannam discovered that the DCCP implementation did not
    correctly manage resources when a socket is disconnected and
    reconnected, potentially leading to a use-after-free.  A local
    user could use this for denial of service (crash or data
    corruption) or possibly for privilege escalation.  On systems that
    do not already have the dccp module loaded, this can be mitigated
    by disabling it:
    echo >> /etc/modprobe.d/disable-dccp.conf install dccp false

CVE-2017-15868

    Al Viro found that the Bluebooth Network Encapsulation Protocol
    (BNEP) implementation did not validate the type of the second
    socket passed to the BNEPCONNADD ioctl(), which could lead to
    memory corruption.  A local user with the CAP_NET_ADMIN capability
    can use this for denial of service (crash or data corruption) or
    possibly for privilege escalation.

CVE-2017-16538

    Andrey Konovalov reported that the dvb-usb-lmedm04 media driver
    did not correctly handle some error conditions during
    initialisation.  A physically present user with a specially
    designed USB device can use this to cause a denial of service
    (crash).

CVE-2017-16939

    Mohamed Ghannam reported (through Beyond Security's SecuriTeam
    Secure Disclosure program) that the IPsec (xfrm) implementation
    did not correctly handle some failure cases when dumping policy
    information through netlink.  A local user with the CAP_NET_ADMIN
    capability can use this for denial of service (crash or data
    corruption) or possibly for privilege escalation.

CVE-2017-17448

    Kevin Cernekee discovered that the netfilter subsystem allowed
    users with the CAP_NET_ADMIN capability in any user namespace, not
    just the root namespace, to enable and disable connection tracking
    helpers.  This could lead to denial of service, violation of
    network security policy, or have other impact.

CVE-2017-17449

    Kevin Cernekee discovered that the netlink subsystem allowed
    users with the CAP_NET_ADMIN capability in any user namespace
    to monitor netlink traffic in all net namespaces, not just
    those owned by that user namespace.  This could lead to
    exposure of sensitive information.

CVE-2017-17450

    Kevin Cernekee discovered that the xt_osf module allowed users
    with the CAP_NET_ADMIN capability in any user namespace to modify
    the global OS fingerprint list.

CVE-2017-17558

    Andrey Konovalov reported that that USB core did not correctly
    handle some error conditions during initialisation.  A physically
    present user with a specially designed USB device can use this to
    cause a denial of service (crash or memory corruption), or
    possibly for privilege escalation.

CVE-2017-17741

    Dmitry Vyukov reported that the KVM implementation for x86 would
    over-read data from memory when emulating an MMIO write if the
    kvm_mmio tracepoint was enabled.  A guest virtual machine might be
    able to use this to cause a denial of service (crash).

CVE-2017-17805

    Dmitry Vyukov reported that the KVM implementation for x86 would
    over-read data from memory when emulating an MMIO write if the
    kvm_mmio tracepoint was enabled.  A guest virtual machine might be
    able to use this to cause a denial of service (crash).

CVE-2017-17806

    It was discovered that the HMAC implementation could be used with
    an underlying hash algorithm that requires a key, which was not
    intended.  A local user could use this to cause a denial of
    service (crash or memory corruption), or possibly for privilege
    escalation.

CVE-2017-17807

    Eric Biggers discovered that the KEYS subsystem lacked a check for
    write permission when adding keys to a process's default keyring.
    A local user could use this to cause a denial of service or to
    obtain sensitive information.

CVE-2017-1000407

    Andrew Honig reported that the KVM implementation for Intel
    processors allowed direct access to host I/O port 0x80, which
    is not generally safe.  On some systems this allows a guest
    VM to cause a denial of service (crash) of the host.

CVE-2017-1000410

    Ben Seri reported that the Bluetooth subsystem did not correctly
    handle short EFS information elements in L2CAP messages.  An
    attacker able to communicate over Bluetooth could use this to
    obtain sensitive information from the kernel.

For the oldstable distribution (jessie), these problems have been fixed
in version 3.16.51-3+deb8u1.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAlpU5cRfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0Qsnw//euNWKwOR4R+JFEyKECrS5GHFzLdj1kpion3oGGZyyJ8VjmVv+MombQPk
xk17ge5QWl44CMzXlkE6QREdrXQfed49us9O6CzS2BPwV/QWsoUc7WLmqYD0OQmh
c5/RqvkzUfXzEJ7efLzChXAs94RB0A9kOKoRxNrXfdhvevM+FumB17dErIrT2nxP
KcX3Tyh05twrJqCnbNIo189LDexKfEyAN9pnwBekknzXB0V3zmvPwebVz85v1I8p
aiWSXX9EjWvVeZG31XDOysEcrwO4T71zqCgPxPeurAOVTJNvK0B8je7wFBD9ayoy
PFNdykxRUBA9rBJ8Aoi3zcZBJYxTYBzOKDUkPaO/80mflsN6yDCaWwQ+antyuQ8y
jO02bAEZiKmpsuclKvK48rfvtoFqXsp6WhO1NoWnmpFvsxXN0DdqKRB60rycrMMA
Q2wLYnPX2QNRNdxtkJ0D380VkTdPjJT4yOPM4UuIJ1S7jwzVcQKnu8VswdFey0nq
k42DigyVQryZd1elqiyGWWtNkJ9BRscSgkpCAfEUo2XCR61wEXu7aOHGksPuTTZr
2FJGIa4OR1dAc2pPGy7CUWYnloGwSCCq7F85bi6v5KG7YnHlic/XnJva+hT+0lGT
1HQlCKU9bicaLL0GIK9Qt5vaUseZLWiOXMHU6JKvo/y6AL3FHnI=
=Ozoc
-----END PGP SIGNATURE-----

```

---



=== Content from usn.ubuntu.com_df8d3ffc_20250125_210648.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3620-1: Linux kernel vulnerabilities

4 April 2018

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [linux](/security/cves?package=linux) - Linux kernel

## Details

It was discovered that the netlink 802.11 configuration interface in the

Linux kernel did not properly validate some attributes passed from

userspace. A local attacker with the CAP\_NET\_ADMIN privilege could use this

to cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2017-11089](/security/CVE-2017-11089))

It was discovered that a buffer overflow existed in the ioctl handling code

in the ISDN subsystem of the Linux kernel. A local attacker could use this

to cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2017-12762](/security/CVE-2017-12762))

It was discovered that the netfilter component of the Linux did not

properly restrict access to the connection tracking helpers list. A local

attacker could use this to bypass intended access restrictions.

([CVE-2017-17448](/security/CVE-2017-17448))

Dmitry Vyukov discovered that the KVM implementation in the Linux kernel

contained an out-of-bounds read when handling memory-mapped I/O. A local

attacker could use this to expose sensitive information. ([CVE-2017-17741](/security/CVE-2017-17741))

It was discovered that the Salsa20 encryption algorithm implementations in

the Linux kernel did not properly handle zero-length inputs. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2017-17805](/security/CVE-2017-17805))

It was discovered that the keyring implementation in the Linux kernel did

not properly check permissions when a key request was performed on a

task's default keyring. A local attacker could use this to add keys to

unauthorized keyrings. ([CVE-2017-17807](/security/CVE-2017-17807))

It was discovered that the Broadcom NetXtremeII ethernet driver in the

Linux kernel did not properly validate Generic Segment Offload (GSO) packet

sizes. An attacker could use this to cause a denial of service (interface

unavailability). ([CVE-2018-1000026](/security/CVE-2018-1000026))

It was discovered that the Reliable Datagram Socket (RDS) implementation in

the Linux kernel contained an out-of-bounds write during RDMA page

allocation. An attacker could use this to cause a denial of service (system

crash) or possibly execute arbitrary code. ([CVE-2018-5332](/security/CVE-2018-5332))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 14.04

* [linux-image-3.13.0-144-generic](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.13.0-144.193](https://launchpad.net/ubuntu/%2Bsource/linux/3.13.0-144.193)
* [linux-image-3.13.0-144-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.13.0-144.193](https://launchpad.net/ubuntu/%2Bsource/linux/3.13.0-144.193)
* [linux-image-3.13.0-144-lowlatency](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.13.0-144.193](https://launchpad.net/ubuntu/%2Bsource/linux/3.13.0-144.193)
* [linux-image-3.13.0-144-powerpc-e500](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.13.0-144.193](https://launchpad.net/ubuntu/%2Bsource/linux/3.13.0-144.193)
* [linux-image-3.13.0-144-powerpc-e500mc](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.13.0-144.193](https://launchpad.net/ubuntu/%2Bsource/linux/3.13.0-144.193)
* [linux-image-3.13.0-144-powerpc-smp](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.13.0-144.193](https://launchpad.net/ubuntu/%2Bsource/linux/3.13.0-144.193)
* [linux-image-3.13.0-144-powerpc64-emb](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.13.0-144.193](https://launchpad.net/ubuntu/%2Bsource/linux/3.13.0-144.193)
* [linux-image-3.13.0-144-powerpc64-smp](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.13.0-144.193](https://launchpad.net/ubuntu/%2Bsource/linux/3.13.0-144.193)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2017-11089](/security/CVE-2017-11089)
* [CVE-2017-12762](/security/CVE-2017-12762)
* [CVE-2017-17448](/security/CVE-2017-17448)
* [CVE-2017-17741](/security/CVE-2017-17741)
* [CVE-2017-17805](/security/CVE-2017-17805)
* [CVE-2017-17807](/security/CVE-2017-17807)
* [CVE-2018-1000026](/security/CVE-2018-1000026)
* [CVE-2018-5332](/security/CVE-2018-5332)

## Related notices

* [USN-3620-2](/security/notices/USN-3620-2)
* [USN-3420-1](/security/notices/USN-3420-1)
* [USN-3420-2](/security/notices/USN-3420-2)
* [USN-3619-2](/security/notices/USN-3619-2)
* [USN-3617-1](/security/notices/USN-3617-1)
* [USN-3619-1](/security/notices/USN-3619-1)
* [USN-3617-3](/security/notices/USN-3617-3)
* [USN-3617-2](/security/notices/USN-3617-2)
* [USN-3632-1](/security/notices/USN-3632-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from usn.ubuntu.com_98c63144_20250125_210649.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3620-2: Linux kernel (Trusty HWE) vulnerabilities

5 April 2018

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [linux-lts-trusty](/security/cves?package=linux-lts-trusty) - Linux hardware enablement kernel from Trusty for Precise ESM

## Details

USN-3620-1 fixed vulnerabilities in the Linux kernel for Ubuntu 14.04

LTS. This update provides the corresponding updates for the Linux

Hardware Enablement (HWE) kernel from Ubuntu 14.04 LTS for Ubuntu

12.04 ESM.

Jann Horn discovered that microprocessors utilizing speculative execution

and branch prediction may allow unauthorized memory reads via sidechannel

attacks. This flaw is known as Spectre. A local attacker could use this to

expose sensitive information, including kernel memory. ([CVE-2017-5715](/security/CVE-2017-5715))

It was discovered that the netlink 802.11 configuration interface in the

Linux kernel did not properly validate some attributes passed from

userspace. A local attacker with the CAP\_NET\_ADMIN privilege could use this

to cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2017-11089](/security/CVE-2017-11089))

It was discovered that a buffer overflow existed in the ioctl handling code

in the ISDN subsystem of the Linux kernel. A local attacker could use this

to cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2017-12762](/security/CVE-2017-12762))

It was discovered that the netfilter component of the Linux did not

properly restrict access to the connection tracking helpers list. A local

attacker could use this to bypass intended access restrictions.

([CVE-2017-17448](/security/CVE-2017-17448))

Dmitry Vyukov discovered that the KVM implementation in the Linux kernel

contained an out-of-bounds read when handling memory-mapped I/O. A local

attacker could use this to expose sensitive information. ([CVE-2017-17741](/security/CVE-2017-17741))

It was discovered that the Salsa20 encryption algorithm implementations in

the Linux kernel did not properly handle zero-length inputs. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2017-17805](/security/CVE-2017-17805))

It was discovered that the keyring implementation in the Linux kernel did

not properly check permissions when a key request was performed on a

task's default keyring. A local attacker could use this to add keys to

unauthorized keyrings. ([CVE-2017-17807](/security/CVE-2017-17807))

It was discovered that the Broadcom NetXtremeII ethernet driver in the

Linux kernel did not properly validate Generic Segment Offload (GSO) packet

sizes. An attacker could use this to cause a denial of service (interface

unavailability). ([CVE-2018-1000026](/security/CVE-2018-1000026))

It was discovered that the Reliable Datagram Socket (RDS) implementation in

the Linux kernel contained an out-of-bounds write during RDMA page

allocation. An attacker could use this to cause a denial of service (system

crash) or possibly execute arbitrary code. ([CVE-2018-5332](/security/CVE-2018-5332))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 12.04

* [linux-image-3.13.0-144-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux-lts-trusty)
  -
  [3.13.0-144.193~precise1](https://launchpad.net/ubuntu/%2Bsource/linux-lts-trusty/3.13.0-144.193~precise1)
* [linux-image-generic-lpae-lts-trusty](https://launchpad.net/ubuntu/%2Bsource/linux-lts-trusty)
  -
  [3.13.0.144.135](https://launchpad.net/ubuntu/%2Bsource/linux-lts-trusty/3.13.0-144.193~precise1)
* [linux-image-3.13.0-144-generic](https://launchpad.net/ubuntu/%2Bsource/linux-lts-trusty)
  -
  [3.13.0-144.193~precise1](https://launchpad.net/ubuntu/%2Bsource/linux-lts-trusty/3.13.0-144.193~precise1)
* [linux-image-generic-lts-trusty](https://launchpad.net/ubuntu/%2Bsource/linux-lts-trusty)
  -
  [3.13.0.144.135](https://launchpad.net/ubuntu/%2Bsource/linux-lts-trusty/3.13.0-144.193~precise1)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2017-11089](/security/CVE-2017-11089)
* [CVE-2017-12762](/security/CVE-2017-12762)
* [CVE-2017-17448](/security/CVE-2017-17448)
* [CVE-2017-17741](/security/CVE-2017-17741)
* [CVE-2017-17805](/security/CVE-2017-17805)
* [CVE-2017-17807](/security/CVE-2017-17807)
* [CVE-2017-5715](/security/CVE-2017-5715)
* [CVE-2018-1000026](/security/CVE-2018-1000026)
* [CVE-2018-5332](/security/CVE-2018-5332)

## Related notices

* [USN-3620-1](/security/notices/USN-3620-1)
* [USN-3420-1](/security/notices/USN-3420-1)
* [USN-3420-2](/security/notices/USN-3420-2)
* [USN-3619-2](/security/notices/USN-3619-2)
* [USN-3617-1](/security/notices/USN-3617-1)
* [USN-3619-1](/security/notices/USN-3619-1)
* [USN-3617-3](/security/notices/USN-3617-3)
* [USN-3617-2](/security/notices/USN-3617-2)
* [USN-3632-1](/security/notices/USN-3632-1)
* [USN-3530-1](/security/notices/USN-3530-1)
* [USN-3594-1](/security/notices/USN-3594-1)
* [USN-3580-1](/security/notices/USN-3580-1)
* [USN-3541-2](/security/notices/USN-3541-2)
* [USN-3531-3](/security/notices/USN-3531-3)
* [USN-3560-1](/security/notices/USN-3560-1)
* [USN-3531-1](/security/notices/USN-3531-1)
* [USN-3540-1](/security/notices/USN-3540-1)
* [USN-3540-2](/security/notices/USN-3540-2)
* [USN-3561-1](/security/notices/USN-3561-1)
* [USN-3549-1](/security/notices/USN-3549-1)
* [USN-3777-3](/security/notices/USN-3777-3)
* [USN-3581-1](/security/notices/USN-3581-1)
* [USN-3690-1](/security/notices/USN-3690-1)
* [USN-3582-2](/security/notices/USN-3582-2)
* [USN-3597-2](/security/notices/USN-3597-2)
* [USN-3516-1](/security/notices/USN-3516-1)
* [USN-3541-1](/security/notices/USN-3541-1)
* [USN-3597-1](/security/notices/USN-3597-1)
* [USN-3582-1](/security/notices/USN-3582-1)
* [USN-3542-1](/security/notices/USN-3542-1)
* [USN-3542-2](/security/notices/USN-3542-2)
* [USN-3581-2](/security/notices/USN-3581-2)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.debian.org_4720f19e_20250125_210651.html ===


---

[[Date Prev](msg00335.html)][[Date Next](msg00337.html)]
[[Thread Prev](msg00335.html)][[Thread Next](msg00337.html)]
[[Date Index](maillist.html#00336)]
[[Thread Index](threads.html#00336)]

# [SECURITY] [DSA 4073-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4073-1] linux security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Sat, 23 Dec 2017 20:13:02 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1eSqAI-0001Hg-U1%40seger.debian.org) [E1eSqAI-0001Hg-U1@seger.debian.org](msg00336.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4073-1                   security@debian.org
<https://www.debian.org/security/>                            Ben Hutchings
December 23, 2017                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2017-8824 CVE-2017-16538 CVE-2017-16644 CVE-2017-16995
                 CVE-2017-17448 CVE-2017-17449 CVE-2017-17450 CVE-2017-17558
                 CVE-2017-17712 CVE-2017-17741 CVE-2017-17805 CVE-2017-17806
                 CVE-2017-17807 CVE-2017-17862 CVE-2017-17863 CVE-2017-17864
                 CVE-2017-1000407 CVE-2017-1000410

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2017-8824

    Mohamed Ghannam discovered that the DCCP implementation did not
    correctly manage resources when a socket is disconnected and
    reconnected, potentially leading to a use-after-free.  A local
    user could use this for denial of service (crash or data
    corruption) or possibly for privilege escalation.  On systems that
    do not already have the dccp module loaded, this can be mitigated
    by disabling it:
    echo >> /etc/modprobe.d/disable-dccp.conf install dccp false

CVE-2017-16538

    Andrey Konovalov reported that the dvb-usb-lmedm04 media driver
    did not correctly handle some error conditions during
    initialisation.  A physically present user with a specially
    designed USB device can use this to cause a denial of service
    (crash).

CVE-2017-16644

    Andrey Konovalov reported that the hdpvr media driver did not
    correctly handle some error conditions during initialisation.  A
    physically present user with a specially designed USB device can
    use this to cause a denial of service (crash).

CVE-2017-16995

    Jann Horn discovered that the Extended BPF verifier did not
    correctly model the behaviour of 32-bit load instructions.  A
    local user can use this for privilege escalation.

CVE-2017-17448

    Kevin Cernekee discovered that the netfilter subsystem allowed
    users with the CAP_NET_ADMIN capability in any user namespace, not
    just the root namespace, to enable and disable connection tracking
    helpers.  This could lead to denial of service, violation of
    network security policy, or have other impact.

CVE-2017-17449

    Kevin Cernekee discovered that the netlink subsystem allowed
    users with the CAP_NET_ADMIN capability in any user namespace
    to monitor netlink traffic in all net namespaces, not just
    those owned by that user namespace.  This could lead to
    exposure of sensitive information.

CVE-2017-17450

    Kevin Cernekee discovered that the xt_osf module allowed users
    with the CAP_NET_ADMIN capability in any user namespace to modify
    the global OS fingerprint list.

CVE-2017-17558

    Andrey Konovalov reported that that USB core did not correctly
    handle some error conditions during initialisation.  A physically
    present user with a specially designed USB device can use this to
    cause a denial of service (crash or memory corruption), or
    possibly for privilege escalation.

CVE-2017-17712

    Mohamed Ghannam discovered a race condition in the IPv4 raw socket
    implementation.  A local user could use this to obtain sensitive
    information from the kernel.

CVE-2017-17741

    Dmitry Vyukov reported that the KVM implementation for x86 would
    over-read data from memory when emulating an MMIO write if the
    kvm_mmio tracepoint was enabled.  A guest virtual machine might be
    able to use this to cause a denial of service (crash).

CVE-2017-17805

    It was discovered that some implementations of the Salsa20 block
    cipher did not correctly handle zero-length input.  A local user
    could use this to cause a denial of service (crash) or possibly
    have other security impact.

CVE-2017-17806

    It was discovered that the HMAC implementation could be used with
    an underlying hash algorithm that requires a key, which was not
    intended.  A local user could use this to cause a denial of
    service (crash or memory corruption), or possibly for privilege
    escalation.

CVE-2017-17807

    Eric Biggers discovered that the KEYS subsystem lacked a check for
    write permission when adding keys to a process's default keyring.
    A local user could use this to cause a denial of service or to
    obtain sensitive information.

CVE-2017-17862

    Alexei Starovoitov discovered that the Extended BPF verifier
    ignored unreachable code, even though it would still be processed
    by JIT compilers.  This could possibly be used by local users for
    denial of service.  It also increases the severity of bugs in
    determining unreachable code.

CVE-2017-17863

    Jann Horn discovered that the Extended BPF verifier did not
    correctly model pointer arithmetic on the stack frame pointer.
    A local user can use this for privilege escalation.

CVE-2017-17864

    Jann Horn discovered that the Extended BPF verifier could fail to
    detect pointer leaks from conditional code.  A local user could
    use this to obtain sensitive information in order to exploit
    other vulnerabilities.

CVE-2017-1000407

    Andrew Honig reported that the KVM implementation for Intel
    processors allowed direct access to host I/O port 0x80, which
    is not generally safe.  On some systems this allows a guest
    VM to cause a denial of service (crash) of the host.

CVE-2017-1000410

    Ben Seri reported that the Bluetooth subsystem did not correctly
    handle short EFS information elements in L2CAP messages.  An
    attacker able to communicate over Bluetooth could use this to
    obtain sensitive information from the kernel.

The various problems in the Extended BPF verifier can be mitigated by
disabling use of Extended BPF by unprivileged users:
sysctl kernel.unprivileged_bpf_disabled=1

Debian disables unprivileged user namespaces by default, but if they
are enabled (via the kernel.unprivileged_userns_clone sysctl) then
CVE-2017-17448 can be exploited by any local user.

For the stable distribution (stretch), these problems have been fixed in
version 4.9.65-3+deb9u1.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to its security
tracker page at: <https://security-tracker.debian.org/tracker/linux>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAlo+tXhfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0Q6Cw//XzzFXYAjPIxZYROKUCLUjQpPsO5NHisnwBSV9plv8xsnwm9K0r+kfsl1
OuIIWA7En9qFvxGcfNP6c1KdKqCtWfz0fR+MsN6LyBJ1MVj+E6dfmqwakfSqEEKy
+kQ73xGybkZz/SxoacEC/QFoddajraiX1uMJpmeVoKttpJLUNkoCm4saM4Nqw/p4
gwdhOPNWDsk2jlWXO4/e7Mitfqc/0qQdJ6U5iICvsMTC+JvDUrBGm9AsmnsETnR4
yxfAmy8QjPj642q2wrr1+rDudNTOVWIThKpKXtxokYiBC1JT1kxPVsMd3yzb2Uhc
c7S6T4MDkxPhLn/S2ZSYGMwO9cxCpX0t5fpNe9YZ14RSq8k75FaAOhcAxqTv/lTh
UvRU1sjTkU2inHGiYV0IdxGmfJrXiLtGaJDmyvWs8yjUTQTz6+FMjHmZxbGLBvXp
EWpGPHhVh6oHgtLj2t9PgBLRINueMWNhb2GEqhwP7y3C3Y3Iqapg3v2tfBhel1el
MnlJQJjV4o+wWTOUHaB8EiMDfd641nvtjXeqFyzcJzsMiQgaPv3BccSsgd8OJknC
EIkT8FoZu2j8+4Vb+3XnEjCRIyHgkgLjexyyvE+6eYBVeoPkqyxWjJy3M7kzzL5E
g+IxairitQGtV8a/bgGLdWr12oaY+MAwbqPybRO/siqbZBhvHb8=
=hqlD
-----END PGP SIGNATURE-----

```

---



=== Content from usn.ubuntu.com_1eabcf2d_20250125_210646.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3619-1: Linux kernel vulnerabilities

4 April 2018

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 16.04 ESM](/security/notices?release=xenial)

## Packages

* [linux](/security/cves?package=linux) - Linux kernel
* [linux-aws](/security/cves?package=linux-aws) - Linux kernel for Amazon Web Services (AWS) systems
* [linux-kvm](/security/cves?package=linux-kvm) - Linux kernel for cloud environments
* [linux-raspi2](/security/cves?package=linux-raspi2) - Linux kernel for Raspberry Pi 2
* [linux-snapdragon](/security/cves?package=linux-snapdragon) - Linux kernel for Snapdragon processors

## Details

Jann Horn discovered that the Berkeley Packet Filter (BPF) implementation

in the Linux kernel improperly performed sign extension in some situations.

A local attacker could use this to cause a denial of service (system crash)

or possibly execute arbitrary code. ([CVE-2017-16995](/security/CVE-2017-16995))

It was discovered that a race condition leading to a use-after-free

vulnerability existed in the ALSA PCM subsystem of the Linux kernel. A

local attacker could use this to cause a denial of service (system crash)

or possibly execute arbitrary code. ([CVE-2017-0861](/security/CVE-2017-0861))

It was discovered that the KVM implementation in the Linux kernel allowed

passthrough of the diagnostic I/O port 0x80. An attacker in a guest VM

could use this to cause a denial of service (system crash) in the host OS.

([CVE-2017-1000407](/security/CVE-2017-1000407))

It was discovered that an information disclosure vulnerability existed in

the ACPI implementation of the Linux kernel. A local attacker could use

this to expose sensitive information (kernel memory addresses).

([CVE-2017-11472](/security/CVE-2017-11472))

It was discovered that a use-after-free vulnerability existed in the

network namespaces implementation in the Linux kernel. A local attacker

could use this to cause a denial of service (system crash) or possibly

execute arbitrary code. ([CVE-2017-15129](/security/CVE-2017-15129))

It was discovered that the Advanced Linux Sound Architecture (ALSA)

subsystem in the Linux kernel contained a use-after-free when handling

device removal. A physically proximate attacker could use this to cause a

denial of service (system crash) or possibly execute arbitrary code.

([CVE-2017-16528](/security/CVE-2017-16528))

Andrey Konovalov discovered that the usbtest device driver in the Linux

kernel did not properly validate endpoint metadata. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2017-16532](/security/CVE-2017-16532))

Andrey Konovalov discovered that the Conexant cx231xx USB video capture

driver in the Linux kernel did not properly validate interface descriptors.

A physically proximate attacker could use this to cause a denial of service

(system crash). ([CVE-2017-16536](/security/CVE-2017-16536))

Andrey Konovalov discovered that the SoundGraph iMON USB driver in the

Linux kernel did not properly validate device metadata. A physically

proximate attacker could use this to cause a denial of service (system

crash). ([CVE-2017-16537](/security/CVE-2017-16537))

Andrey Konovalov discovered that the IMS Passenger Control Unit USB driver

in the Linux kernel did not properly validate device descriptors. A

physically proximate attacker could use this to cause a denial of service

(system crash). ([CVE-2017-16645](/security/CVE-2017-16645))

Andrey Konovalov discovered that the DiBcom DiB0700 USB DVB driver in the

Linux kernel did not properly handle detach events. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2017-16646](/security/CVE-2017-16646))

Andrey Konovalov discovered that the CDC USB Ethernet driver did not

properly validate device descriptors. A physically proximate attacker could

use this to cause a denial of service (system crash). ([CVE-2017-16649](/security/CVE-2017-16649))

Andrey Konovalov discovered that the QMI WWAN USB driver did not properly

validate device descriptors. A physically proximate attacker could use this

to cause a denial of service (system crash). ([CVE-2017-16650](/security/CVE-2017-16650))

It was discovered that the USB Virtual Host Controller Interface (VHCI)

driver in the Linux kernel contained an information disclosure vulnerability.

A physically proximate attacker could use this to expose sensitive

information (kernel memory). ([CVE-2017-16911](/security/CVE-2017-16911))

It was discovered that the USB over IP implementation in the Linux kernel

did not validate endpoint numbers. A remote attacker could use this to

cause a denial of service (system crash). ([CVE-2017-16912](/security/CVE-2017-16912))

It was discovered that the USB over IP implementation in the Linux kernel

did not properly validate CMD\_SUBMIT packets. A remote attacker could use

this to cause a denial of service (excessive memory consumption).

([CVE-2017-16913](/security/CVE-2017-16913))

It was discovered that the USB over IP implementation in the Linux kernel

contained a NULL pointer dereference error. A remote attacker could use

this to cause a denial of service (system crash). ([CVE-2017-16914](/security/CVE-2017-16914))

It was discovered that the HugeTLB component of the Linux kernel did not

properly handle holes in hugetlb ranges. A local attacker could use this to

expose sensitive information (kernel memory). ([CVE-2017-16994](/security/CVE-2017-16994))

It was discovered that the netfilter component of the Linux did not

properly restrict access to the connection tracking helpers list. A local

attacker could use this to bypass intended access restrictions.

([CVE-2017-17448](/security/CVE-2017-17448))

It was discovered that the netlink subsystem in the Linux kernel did not

properly restrict observations of netlink messages to the appropriate net

namespace. A local attacker could use this to expose sensitive information

(kernel netlink traffic). ([CVE-2017-17449](/security/CVE-2017-17449))

It was discovered that the netfilter passive OS fingerprinting (xt\_osf)

module did not properly perform access control checks. A local attacker

could improperly modify the system-wide OS fingerprint list.

([CVE-2017-17450](/security/CVE-2017-17450))

It was discovered that the core USB subsystem in the Linux kernel did not

validate the number of configurations and interfaces in a device. A

physically proximate attacker could use this to cause a denial of service

(system crash). ([CVE-2017-17558](/security/CVE-2017-17558))

Dmitry Vyukov discovered that the KVM implementation in the Linux kernel

contained an out-of-bounds read when handling memory-mapped I/O. A local

attacker could use this to expose sensitive information. ([CVE-2017-17741](/security/CVE-2017-17741))

It was discovered that the Salsa20 encryption algorithm implementations in

the Linux kernel did not properly handle zero-length inputs. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2017-17805](/security/CVE-2017-17805))

It was discovered that the HMAC implementation did not validate the state

of the underlying cryptographic hash algorithm. A local attacker could use

this to cause a denial of service (system crash) or possibly execute

arbitrary code. ([CVE-2017-17806](/security/CVE-2017-17806))

It was discovered that the keyring implementation in the Linux kernel did

not properly check permissions when a key request was performed on a

task's default keyring. A local attacker could use this to add keys to

unauthorized keyrings. ([CVE-2017-17807](/security/CVE-2017-17807))

Alexei Starovoitov discovered that the Berkeley Packet Filter (BPF)

implementation in the Linux kernel contained a branch-pruning logic issue

around unreachable code. A local attacker could use this to cause a denial

of service. ([CVE-2017-17862](/security/CVE-2017-17862))

It was discovered that the parallel cryptography component of the Linux

kernel incorrectly freed kernel memory. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2017-18075](/security/CVE-2017-18075))

It was discovered that a race condition existed in the Device Mapper

component of the Linux kernel. A local attacker could use this to cause a

denial of service (system crash). ([CVE-2017-18203](/security/CVE-2017-18203))

It was discovered that a race condition existed in the OCFS2 file system

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (kernel deadlock). ([CVE-2017-18204](/security/CVE-2017-18204))

It was discovered that an infinite loop could occur in the madvise(2)

implementation in the Linux kernel in certain circumstances. A local

attacker could use this to cause a denial of service (system hang).

([CVE-2017-18208](/security/CVE-2017-18208))

Andy Lutomirski discovered that the KVM implementation in the Linux kernel

was vulnerable to a debug exception error when single-stepping through a

syscall. A local attacker in a non-Linux guest vm could possibly use this

to gain administrative privileges in the guest vm. ([CVE-2017-7518](/security/CVE-2017-7518))

It was discovered that the Broadcom NetXtremeII ethernet driver in the

Linux kernel did not properly validate Generic Segment Offload (GSO) packet

sizes. An attacker could use this to cause a denial of service (interface

unavailability). ([CVE-2018-1000026](/security/CVE-2018-1000026))

It was discovered that the Reliable Datagram Socket (RDS)

implementation in the Linux kernel contained an out-of-bounds write

during RDMA page allocation. An attacker could use this to cause a

denial of service (system crash) or possibly execute arbitrary code.

([CVE-2018-5332](/security/CVE-2018-5332))

Mohamed Ghannam discovered a null pointer dereference in the RDS (Reliable

Datagram Sockets) protocol implementation of the Linux kernel. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2018-5333](/security/CVE-2018-5333))

范龙飞 discovered that a race condition existed in loop block device

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2018-5344](/security/CVE-2018-5344))

It was discovered that an integer overflow error existed in the futex

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash). ([CVE-2018-6927](/security/CVE-2018-6927))

It was discovered that a NULL pointer dereference existed in the RDS

(Reliable Datagram Sockets) protocol implementation in the Linux kernel. A

local attacker could use this to cause a denial of service (system crash).

([CVE-2018-7492](/security/CVE-2018-7492))

It was discovered that the Broadcom UniMAC MDIO bus controller driver in

the Linux kernel did not properly validate device resources. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2018-8043](/security/CVE-2018-8043))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 16.04

* [linux-image-4.4.0-1020-kvm](https://launchpad.net/ubuntu/%2Bsource/linux-kvm)
  -
  [4.4.0-1020.25](https://launchpad.net/ubuntu/%2Bsource/linux-kvm/4.4.0-1020.25)
* [linux-image-4.4.0-1054-aws](https://launchpad.net/ubuntu/%2Bsource/linux-aws)
  -
  [4.4.0-1054.63](https://launchpad.net/ubuntu/%2Bsource/linux-aws/4.4.0-1054.63)
* [linux-image-4.4.0-1086-raspi2](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2)
  -
  [4.4.0-1086.94](https://launchpad.net/ubuntu/%2Bsource/linux-raspi2/4.4.0-1086.94)
* [linux-image-4.4.0-1088-snapdragon](https://launchpad.net/ubuntu/%2Bsource/linux-snapdragon)
  -
  [4.4.0-1088.93](https://launchpad.net/ubuntu/%2Bsource/linux-snapdragon/4.4.0-1088.93)
* [linux-image-4.4.0-119-generic](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.4.0-119.143](https://launchpad.net/ubuntu/%2Bsource/linux/4.4.0-119.143)
* [linux-image-4.4.0-119-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.4.0-119.143](https://launchpad.net/ubuntu/%2Bsource/linux/4.4.0-119.143)
* [linux-image-4.4.0-119-lowlatency](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.4.0-119.143](https://launchpad.net/ubuntu/%2Bsource/linux/4.4.0-119.143)
* [linux-image-4.4.0-119-powerpc-e500mc](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.4.0-119.143](https://launchpad.net/ubuntu/%2Bsource/linux/4.4.0-119.143)
* [linux-image-4.4.0-119-powerpc-smp](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.4.0-119.143](https://launchpad.net/ubuntu/%2Bsource/linux/4.4.0-119.143)
* [linux-image-4.4.0-119-powerpc64-emb](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.4.0-119.143](https://launchpad.net/ubuntu/%2Bsource/linux/4.4.0-119.143)
* [linux-image-4.4.0-119-powerpc64-smp](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [4.4.0-119.143](https://launchpad.net/ubuntu/%2Bsource/linux/4.4.0-119.143)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2017-0861](/security/CVE-2017-0861)
* [CVE-2017-1000407](/security/CVE-2017-1000407)
* [CVE-2017-11472](/security/CVE-2017-11472)
* [CVE-2017-15129](/security/CVE-2017-15129)
* [CVE-2017-16528](/security/CVE-2017-16528)
* [CVE-2017-16532](/security/CVE-2017-16532)
* [CVE-2017-16536](/security/CVE-2017-16536)
* [CVE-2017-16537](/security/CVE-2017-16537)
* [CVE-2017-16645](/security/CVE-2017-16645)
* [CVE-2017-16646](/security/CVE-2017-16646)
* [CVE-2017-16649](/security/CVE-2017-16649)
* [CVE-2017-16650](/security/CVE-2017-16650)
* [CVE-2017-16911](/security/CVE-2017-16911)
* [CVE-2017-16912](/security/CVE-2017-16912)
* [CVE-2017-16913](/security/CVE-2017-16913)
* [CVE-2017-16914](/security/CVE-2017-16914)
* [CVE-2017-16994](/security/CVE-2017-16994)
* [CVE-2017-16995](/security/CVE-2017-16995)
* [CVE-2017-17448](/security/CVE-2017-17448)
* [CVE-2017-17449](/security/CVE-2017-17449)
* [CVE-2017-17450](/security/CVE-2017-17450)
* [CVE-2017-17558](/security/CVE-2017-17558)
* [CVE-2017-17741](/security/CVE-2017-17741)
* [CVE-2017-17805](/security/CVE-2017-17805)
* [CVE-2017-17806](/security/CVE-2017-17806)
* [CVE-2017-17807](/security/CVE-2017-17807)
* [CVE-2017-17862](/security/CVE-2017-17862)
* [CVE-2017-18075](/security/CVE-2017-18075)
* [CVE-2017-18203](/security/CVE-2017-18203)
* [CVE-2017-18204](/security/CVE-2017-18204)
* [CVE-2017-18208](/security/CVE-2017-18208)
* [CVE-2017-7518](/security/CVE-2017-7518)
* [CVE-2018-1000026](/security/CVE-2018-1000026)
* [CVE-2018-5332](/security/CVE-2018-5332)
* [CVE-2018-5333](/security/CVE-2018-5333)
* [CVE-2018-5344](/security/CVE-2018-5344)
* [CVE-2018-6927](/security/CVE-2018-6927)
* [CVE-2018-7492](/security/CVE-2018-7492)
* [CVE-2018-8043](/security/CVE-2018-8043)

## Related notices

* [USN-3583-2](/security/notices/USN-3583-2)
* [USN-3619-2](/security/notices/USN-3619-2)
* [USN-3617-1](/security/notices/USN-3617-1)
* [USN-3617-3](/security/notices/USN-3617-3)
* [USN-3617-2](/security/notices/USN-3617-2)
* [USN-3632-1](/security/notices/USN-3632-1)
* [USN-3583-1](/security/notices/USN-3583-1)
* [USN-3754-1](/security/notices/USN-3754-1)
* [USN-3822-2](/security/notices/USN-3822-2)
* [USN-3822-1](/security/notices/USN-3822-1)
* [USN-3523-2](/security/notices/USN-3523-2)
* [USN-3633-1](/security/notices/USN-3633-1)
* [USN-3523-1](/security/notices/USN-3523-1)
* [USN-3523-3](/security/notices/USN-3523-3)
* [USN-3620-1](/security/notices/USN-3620-1)
* [USN-3620-2](/security/notices/USN-3620-2)
* [USN-3653-1](/security/notices/USN-3653-1)
* [USN-3657-1](/security/notices/USN-3657-1)
* [USN-3655-1](/security/notices/USN-3655-1)
* [USN-3653-2](/security/notices/USN-3653-2)
* [USN-3655-2](/security/notices/USN-3655-2)
* [USN-3698-2](/security/notices/USN-3698-2)
* [USN-3697-1](/security/notices/USN-3697-1)
* [USN-3698-1](/security/notices/USN-3698-1)
* [USN-3697-2](/security/notices/USN-3697-2)
* [USN-3674-2](/security/notices/USN-3674-2)
* [USN-3674-1](/security/notices/USN-3674-1)
* [USN-3677-1](/security/notices/USN-3677-1)
* [USN-3677-2](/security/notices/USN-3677-2)
* [USN-3630-2](/security/notices/USN-3630-2)
* [USN-3630-1](/security/notices/USN-3630-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from usn.ubuntu.com_15f3fe1f_20250125_210645.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3617-2: Linux (HWE) vulnerabilities

3 April 2018

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 16.04 ESM](/security/notices?release=xenial)

## Packages

* [linux-gcp](/security/cves?package=linux-gcp) - Linux kernel for Google Cloud Platform (GCP) systems
* [linux-hwe](/security/cves?package=linux-hwe) - Linux hardware enablement (HWE) kernel
* [linux-oem](/security/cves?package=linux-oem) - Linux kernel for OEM processors

## Details

USN-3617-1 fixed vulnerabilities in the Linux kernel for Ubuntu 17.10.

This update provides the corresponding updates for the Linux Hardware

Enablement (HWE) kernel from Ubuntu 17.10 for Ubuntu 16.04 LTS.

It was discovered that a race condition leading to a use-after-free

vulnerability existed in the ALSA PCM subsystem of the Linux kernel. A

local attacker could use this to cause a denial of service (system crash)

or possibly execute arbitrary code. ([CVE-2017-0861](/security/CVE-2017-0861))

It was discovered that the KVM implementation in the Linux kernel allowed

passthrough of the diagnostic I/O port 0x80. An attacker in a guest VM

could use this to cause a denial of service (system crash) in the host OS.

([CVE-2017-1000407](/security/CVE-2017-1000407))

It was discovered that a use-after-free vulnerability existed in the

network namespaces implementation in the Linux kernel. A local attacker

could use this to cause a denial of service (system crash) or possibly

execute arbitrary code. ([CVE-2017-15129](/security/CVE-2017-15129))

Andrey Konovalov discovered that the usbtest device driver in the Linux

kernel did not properly validate endpoint metadata. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2017-16532](/security/CVE-2017-16532))

Andrey Konovalov discovered that the SoundGraph iMON USB driver in the

Linux kernel did not properly validate device metadata. A physically

proximate attacker could use this to cause a denial of service (system

crash). ([CVE-2017-16537](/security/CVE-2017-16537))

Andrey Konovalov discovered that the IMS Passenger Control Unit USB driver

in the Linux kernel did not properly validate device descriptors. A

physically proximate attacker could use this to cause a denial of service

(system crash). ([CVE-2017-16645](/security/CVE-2017-16645))

Andrey Konovalov discovered that the DiBcom DiB0700 USB DVB driver in the

Linux kernel did not properly handle detach events. A physically proximate

attacker could use this to cause a denial of service (system crash).

([CVE-2017-16646](/security/CVE-2017-16646))

Andrey Konovalov discovered that the ASIX Ethernet USB driver in the Linux

kernel did not properly handle suspend and resume events. A physically

proximate attacker could use this to cause a denial of service (system

crash). ([CVE-2017-16647](/security/CVE-2017-16647))

Andrey Konovalov discovered that the CDC USB Ethernet driver did not

properly validate device descriptors. A physically proximate attacker could

use this to cause a denial of service (system crash). ([CVE-2017-16649](/security/CVE-2017-16649))

Andrey Konovalov discovered that the QMI WWAN USB driver did not properly

validate device descriptors. A physically proximate attacker could use this

to cause a denial of service (system crash). ([CVE-2017-16650](/security/CVE-2017-16650))

It was discovered that the HugeTLB component of the Linux kernel did not

properly handle holes in hugetlb ranges. A local attacker could use this to

expose sensitive information (kernel memory). ([CVE-2017-16994](/security/CVE-2017-16994))

It was discovered that the netfilter component of the Linux did not

properly restrict access to the connection tracking helpers list. A local

attacker could use this to bypass intended access restrictions.

([CVE-2017-17448](/security/CVE-2017-17448))

It was discovered that the netfilter passive OS fingerprinting (xt\_osf)

module did not properly perform access control checks. A local attacker

could improperly modify the system-wide OS fingerprint list.

([CVE-2017-17450](/security/CVE-2017-17450))

Dmitry Vyukov discovered that the KVM implementation in the Linux kernel

contained an out-of-bounds read when handling memory-mapped I/O. A local

attacker could use this to expose sensitive information. ([CVE-2017-17741](/security/CVE-2017-17741))

It was discovered that the Salsa20 encryption algorithm implementations in

the Linux kernel did not properly handle zero-length inputs. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2017-17805](/security/CVE-2017-17805))

It was discovered that the HMAC implementation did not validate the state

of the underlying cryptographic hash algorithm. A local attacker could use

this to cause a denial of service (system crash) or possibly execute

arbitrary code. ([CVE-2017-17806](/security/CVE-2017-17806))

It was discovered that the keyring implementation in the Linux kernel did

not properly check permissions when a key request was performed on a task's

default keyring. A local attacker could use this to add keys to

unauthorized keyrings. ([CVE-2017-17807](/security/CVE-2017-17807))

It was discovered that a race condition existed in the OCFS2 file system

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (kernel deadlock). ([CVE-2017-18204](/security/CVE-2017-18204))

It was discovered that the Broadcom NetXtremeII ethernet driver in the

Linux kernel did not properly validate Generic Segment Offload (GSO) packet

sizes. An attacker could use this to cause a denial of service (interface

unavailability). ([CVE-2018-1000026](/security/CVE-2018-1000026))

It was discovered that the Reliable Datagram Socket (RDS) implementation in

the Linux kernel contained an out-of-bounds write during RDMA page allocation. An

attacker could use this to cause a denial of service (system crash) or

possibly execute arbitrary code. ([CVE-2018-5332](/security/CVE-2018-5332))

Mohamed Ghannam discovered a null pointer dereference in the RDS (Reliable

Datagram Sockets) protocol implementation of the Linux kernel. A local

attacker could use this to cause a denial of service (system crash).

([CVE-2018-5333](/security/CVE-2018-5333))

范龙飞 discovered that a race condition existed in loop block device

implementation in the Linux kernel. A local attacker could use this to

cause a denial of service (system crash) or possibly execute arbitrary

code. ([CVE-2018-5344](/security/CVE-2018-5344))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 16.04

* [linux-image-4.13.0-1012-gcp](https://launchpad.net/ubuntu/%2Bsource/linux-gcp)
  -
  [4.13.0-1012.16](https://launchpad.net/ubuntu/%2Bsource/linux-gcp/4.13.0-1012.16)
* [linux-image-4.13.0-1022-oem](https://launchpad.net/ubuntu/%2Bsource/linux-oem)
  -
  [4.13.0-1022.24](https://launchpad.net/ubuntu/%2Bsource/linux-oem/4.13.0-1022.24)
* [linux-image-4.13.0-38-generic](https://launchpad.net/ubuntu/%2Bsource/linux-hwe)
  -
  [4.13.0-38.43~16.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-hwe/4.13.0-38.43~16.04.1)
* [linux-image-4.13.0-38-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux-hwe)
  -
  [4.13.0-38.43~16.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-hwe/4.13.0-38.43~16.04.1)
* [linux-image-4.13.0-38-lowlatency](https://launchpad.net/ubuntu/%2Bsource/linux-hwe)
  -
  [4.13.0-38.43~16.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-hwe/4.13.0-38.43~16.04.1)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2017-0861](/security/CVE-2017-0861)
* [CVE-2017-1000407](/security/CVE-2017-1000407)
* [CVE-2017-15129](/security/CVE-2017-15129)
* [CVE-2017-16532](/security/CVE-2017-16532)
* [CVE-2017-16537](/security/CVE-2017-16537)
* [CVE-2017-16645](/security/CVE-2017-16645)
* [CVE-2017-16646](/security/CVE-2017-16646)
* [CVE-2017-16647](/security/CVE-2017-16647)
* [CVE-2017-16649](/security/CVE-2017-16649)
* [CVE-2017-16650](/security/CVE-2017-16650)
* [CVE-2017-16994](/security/CVE-2017-16994)
* [CVE-2017-17448](/security/CVE-2017-17448)
* [CVE-2017-17450](/security/CVE-2017-17450)
* [CVE-2017-17741](/security/CVE-2017-17741)
* [CVE-2017-17805](/security/CVE-2017-17805)
* [CVE-2017-17806](/security/CVE-2017-17806)
* [CVE-2017-17807](/security/CVE-2017-17807)
* [CVE-2017-18204](/security/CVE-2017-18204)
* [CVE-2018-1000026](/security/CVE-2018-1000026)
* [CVE-2018-5332](/security/CVE-2018-5332)
* [CVE-2018-5333](/security/CVE-2018-5333)
* [CVE-2018-5344](/security/CVE-2018-5344)

## Related notices

* [USN-3583-2](/security/notices/USN-3583-2)
* [USN-3619-2](/security/notices/USN-3619-2)
* [USN-3617-1](/security/notices/USN-3617-1)
* [USN-3619-1](/security/notices/USN-3619-1)
* [USN-3617-3](/security/notices/USN-3617-3)
* [USN-3632-1](/security/notices/USN-3632-1)
* [USN-3583-1](/security/notices/USN-3583-1)
* [USN-3754-1](/security/notices/USN-3754-1)
* [USN-3822-2](/security/notices/USN-3822-2)
* [USN-3822-1](/security/notices/USN-3822-1)
* [USN-3620-1](/security/notices/USN-3620-1)
* [USN-3620-2](/security/notices/USN-3620-2)
* [USN-3655-1](/security/notices/USN-3655-1)
* [USN-3655-2](/security/notices/USN-3655-2)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


