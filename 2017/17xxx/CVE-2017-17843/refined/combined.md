=== Content from lists.debian.org_0118e7bd_20250124_234203.html ===


---

[[Date Prev](msg00020.html)][[Date Next](msg00022.html)]
[[Thread Prev](msg00020.html)][[Thread Next](msg00022.html)]
[[Date Index](maillist.html#00021)]
[[Thread Index](threads.html#00021)]

# [SECURITY] [DLA 1219-1] enigmail security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1219-1] enigmail security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Sat, 23 Dec 2017 12:35:08 +0100
* *Message-id*: <[[üîé]](/msgid-search/e64ce501-1394-a685-4366-69c021107319%40debian.org)¬†[e64ce501-1394-a685-4366-69c021107319@debian.org](msg00021.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Package        : enigmail
Version        : 2:1.9.9-1~deb7u1
CVE ID         : CVE-2017-17843 CVE-2017-17844 CVE-2017-17845 CVE-2017-17846
                 CVE-2017-17847 CVE-2017-17848

Multiple vulnerabilities were discovered in Enigmail, an OpenPGP
extension for Thunderbird, which could result in a loss of
confidentiality, faked signatures, plain text leaks and denial of
service. Additional information can be found under
<https://enigmail.net/download/other/Enigmail%20Pentest%20Report%20by%20Cure53%20-%20Excerpt.pdf>

For Debian 7 "Wheezy", these problems have been fixed in version
2:1.9.9-1~deb7u1.

We recommend that you upgrade your enigmail packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAlo+P2wACgkQnUbEiOQ2
gwLvEA/9HEDdLgsPf5iTUdTVtKXyCm/coBHiWRKH3/rChlXofh55Q0vyxb8wrgAt
UBOeylQ3Ft+2d1HxbxVoIlrjR0Skzm5fyDIuSDno2BgyRqA6ArKovvSHC7UyZxJb
4vklXev7MvWDhiNs8CD6DYfb3wQm2BpL5ncIayPPZv3nnBe/LlH5M89QLEnv+lUz
s5WgzQ36lGot0OZC/9oOoKHYeryfibRrW+WpFStu5a1OfjZeK10lCCHjORKrE6Sa
24ccSiQ0mP6cNITfv+/aFeRaujDw88VY/e74mK51yYbYyA8Fi8wQhlOfE9kaoJDj
9kqK3OvuK40N4l2pHmVBvyuWqYnOXw4riodnzqh4hwT++8uhYbHXiwQGmThoACGH
gOrqKKwcch/YdgaT3P4DAb0QqinW2nFqREf2XUIX0uW5kVQ3lsNibif9+ZSQwgB8
qwLmsGM157sofLFcranXNmL9Vm3lIWU71VJV5zmiWR9/PzXfQSDlGFOgpo6A9Zvh
EsHrPm+maGPYN598I5j86BPC7d2xmxanDPrCwa3NSMcoDlBV7S9zzLeEO/zZRv+Z
De7N5o+NEqIew01jvbiOWjbrVKSlb5E4f3UpS0rfAX9gPPJWiM9AbYQCus3cJiFn
phGVErzofShK7JpTmmVcYWWWtlSXA4RnIGinUb0LtVgy1EgbpPw=
=zF6j
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_ce2f6952_20250124_234203.html ===


---

[[Date Prev](msg00332.html)][[Date Next](msg00334.html)]
[[Thread Prev](msg00332.html)][[Thread Next](msg00334.html)]
[[Date Index](maillist.html#00333)]
[[Thread Index](threads.html#00333)]

# [SECURITY] [DSA 4070-1] enigmail security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4070-1] enigmail security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 21 Dec 2017 20:33:18 +0100
* *Message-id*: <[[üîé]](/msgid-search/20171221193318.ni7cnpbfuj2cvn6o%40pisco.westfalen.local)¬†[20171221193318.ni7cnpbfuj2cvn6o@pisco.westfalen.local](msg00333.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4070-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 21, 2017                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : enigmail
CVE ID         : not yet available

Multiple vulnerabilities were discovered in Enigmail, an OpenPGP
extension for Thunderbird, which could result in a loss of
confidentiality, faked signatures, plain text leaks and denial of
service. Additional information can be found under
<https://enigmail.net/download/other/Enigmail%20Pentest%20Report%20by%20Cure53%20-%20Excerpt.pdf>

For the oldstable distribution (jessie), this problem has been fixed
in version 2:1.9.9-1~deb8u1.

For the stable distribution (stretch), this problem has been fixed in
version 2:1.9.9-1~deb9u1.

We recommend that you upgrade your enigmail packages.

For the detailed security status of enigmail please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/enigmail>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlo8DDoACgkQEMKTtsN8
TjaU/w//QGpZp546SbzcrhM9uW2qRkXCXpiOCu279FZeFZLU7EMn5KLERc9kizKS
CUYR/vNBrn1a+A5Bv1PzroyZ3cr+3bECQjTXLj9scEPLI0s39LcxQ5Nc686jsBla
mNBCabhZABwrwLncwXpPptrAjow9Xi6NfMZSL9SvYRnBpfOK1k31QsVgc/keJp8O
KXtpkbg2WDFdAUsp1NQhI6sBNG1taydXRS2b8l+hvtfK6RWmVbRDFz3J3d1GNScr
wY7TlEoOjhX6DD2hYanYGHSZ7rDSiDThpeGdjry/XuG+hS4WssclONrMdYE7z3U1
MwlT6WhS6ScwUrEjzSpslQdDOHYE4blW7+F8/s9RjvH6C7LTUWt5TITW7KOaiOKD
sSJ4/chAtzPA5978AZjJ+T1ZynYlNPX9SLJOOHsOQmotk/GE8dtzLevVASxmTYk+
3Lnf0u4Gy8Mu1va4i6N6q0N7wTBjLZ4/gCwHAqhO69+M/dUtl0+mgh3MCrmf/+1U
fkjtPhaYg0RwdfYT39UknpFL2BPYiLFolIpKe1RaZ4WcSI7rgDi+rZNHHGoJ7XDg
7A/kmoqWkkEE3QgIrDZABluzbGqbLxS+KkShfEfuLxVxyWA4JKqGYN+exCqRAz3O
Kq6xoIc8vvurCRA+cgIXcEV2OsKALdEz8TQxRbAuWfOZKaIPhDs=
=ctoe
-----END PGP SIGNATURE-----

```

---



=== Content from www.mail-archive.com_cdf9af14_20250124_234208.html ===


[Skip to site navigation (Press enter)](#nav)

# [Re: [Enigmail] [ANN] Enigmail v1.9.9 available](/search?l=enigmail-users@enigmail.net&q=subject:%22Re%5C%3A+%5C%5BEnigmail%5C%5D+%5C%5BANN%5C%5D+Enigmail+v1.9.9+available%22&o=newest)

[Patrick Brunschwig](/search?l=enigmail-users@enigmail.net&q=from:%22Patrick+Brunschwig%22)
[Tue, 19 Dec 2017 11:49:15 -0800](/search?l=enigmail-users@enigmail.net&q=date:20171219)

```
Am 19. Dezember 2017 20:28:25 MEZ schrieb Daniel Kahn Gillmor
<d...@fifthhorseman.net>:
>Thanks very much for this work, Patrick!  And thanks to Posteo and
>Mozilla for funding this research.
>
>On Tue 2017-12-19 08:45:29 +0100, Patrick Brunschwig wrote:
>> [1]
>>
><<https://enigmail.net/download/other/Enigmail%20Pentest%20Report%20by%20Cure53%20-%20Excerpt.pdf>>
>> [2] <<https://sourceforge.net/p/enigmail/bugs/709/>>
>
>Are there CVE numbers assigned to these?
```
```

Not yet., but I'll take care of that tomorrow. Thanks for the reminder.

Patrick

```

**[![Attachment:](../attachment.png)](msg04280/signature.asc)
[signature.asc](msg04280/signature.asc)**

*Description:* PGP signature

```
_______________________________________________
enigmail-users mailing list
enigmail-users@enigmail.net
To unsubscribe or make changes to your subscription click here:
<https://admin.hostpoint.ch/mailman/listinfo/enigmail-users_enigmail.net>

```

* [Previous message](msg04279.html)
* [View by thread](index.html#04280)
* [View by date](maillist.html#04280)
* [Next message](msg04281.html)

* [[Enigmail] [ANN] Enigmail v1.9.9 available](msg04277.html) Patrick Brunschwig
* + [Re: [Enigmail] [ANN] Enigmail v1.9.9 available](msg04278.html) Ian Mann
  + [Re: [Enigmail] [ANN] Enigmail v1.9.9 available](msg04279.html) Daniel Kahn Gillmor
  + - Re: [Enigmail] [ANN] Enigmail v1.9.9 availabl... Patrick Brunschwig

## Reply via email to

[![The Mail Archive](/logo.png)](/)

Search the site

* [The Mail Archive home](/)
* [enigmail-users - all messages](/enigmail-users%40enigmail.net/)
* [enigmail-users - about the list](/enigmail-users%40enigmail.net/info.html)
* [Expand](/search?l=enigmail-users@enigmail.net&q=subject:%22Re%5C%3A+%5C%5BEnigmail%5C%5D+%5C%5BANN%5C%5D+Enigmail+v1.9.9+available%22&o=newest&f=1 "e")
* [Previous message](msg04279.html "p")
* [Next message](msg04281.html "n")

* [The Mail Archive home](/)
* [Add your mailing list](/faq.html#newlist)
* [FAQ](/faq.html)
* [Support](/faq.html#support)
* [Privacy](/faq.html#privacy)
* 3891770F-A6F1-49C1-A831-500F0ADCE6DC@enigmail.net



=== Content from www.debian.org_1d588d85_20250124_234204.html ===


---

[[Date Prev](msg00332.html)][[Date Next](msg00334.html)]
[[Thread Prev](msg00332.html)][[Thread Next](msg00334.html)]
[[Date Index](maillist.html#00333)]
[[Thread Index](threads.html#00333)]

# [SECURITY] [DSA 4070-1] enigmail security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4070-1] enigmail security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 21 Dec 2017 20:33:18 +0100
* *Message-id*: <[[üîé]](/msgid-search/20171221193318.ni7cnpbfuj2cvn6o%40pisco.westfalen.local)¬†[20171221193318.ni7cnpbfuj2cvn6o@pisco.westfalen.local](msg00333.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4070-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 21, 2017                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : enigmail
CVE ID         : not yet available

Multiple vulnerabilities were discovered in Enigmail, an OpenPGP
extension for Thunderbird, which could result in a loss of
confidentiality, faked signatures, plain text leaks and denial of
service. Additional information can be found under
<https://enigmail.net/download/other/Enigmail%20Pentest%20Report%20by%20Cure53%20-%20Excerpt.pdf>

For the oldstable distribution (jessie), this problem has been fixed
in version 2:1.9.9-1~deb8u1.

For the stable distribution (stretch), this problem has been fixed in
version 2:1.9.9-1~deb9u1.

We recommend that you upgrade your enigmail packages.

For the detailed security status of enigmail please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/enigmail>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlo8DDoACgkQEMKTtsN8
TjaU/w//QGpZp546SbzcrhM9uW2qRkXCXpiOCu279FZeFZLU7EMn5KLERc9kizKS
CUYR/vNBrn1a+A5Bv1PzroyZ3cr+3bECQjTXLj9scEPLI0s39LcxQ5Nc686jsBla
mNBCabhZABwrwLncwXpPptrAjow9Xi6NfMZSL9SvYRnBpfOK1k31QsVgc/keJp8O
KXtpkbg2WDFdAUsp1NQhI6sBNG1taydXRS2b8l+hvtfK6RWmVbRDFz3J3d1GNScr
wY7TlEoOjhX6DD2hYanYGHSZ7rDSiDThpeGdjry/XuG+hS4WssclONrMdYE7z3U1
MwlT6WhS6ScwUrEjzSpslQdDOHYE4blW7+F8/s9RjvH6C7LTUWt5TITW7KOaiOKD
sSJ4/chAtzPA5978AZjJ+T1ZynYlNPX9SLJOOHsOQmotk/GE8dtzLevVASxmTYk+
3Lnf0u4Gy8Mu1va4i6N6q0N7wTBjLZ4/gCwHAqhO69+M/dUtl0+mgh3MCrmf/+1U
fkjtPhaYg0RwdfYT39UknpFL2BPYiLFolIpKe1RaZ4WcSI7rgDi+rZNHHGoJ7XDg
7A/kmoqWkkEE3QgIrDZABluzbGqbLxS+KkShfEfuLxVxyWA4JKqGYN+exCqRAz3O
Kq6xoIc8vvurCRA+cgIXcEV2OsKALdEz8TQxRbAuWfOZKaIPhDs=
=ctoe
-----END PGP SIGNATURE-----

```

---



=== Content from enigmail.net_6bef1175_20250124_234202.html ===
Pentest-Report Enigmail by Cure53

The following is an extract of a Pentest Report created by Cure53 (www.cure53.de). The report was funded by
Posteo (www.posteo.de) and the Mozilla's Secure Open Source fund (MOSS; https://www.mozilla.org/en-
US/moss/secure-open-source/) and covers both Thunderbird and Enigmail. As not all vulnerabilities have been fixed
at the time of writing (2017-12-10), this extract only mentions the vulnerabilities that needed fixing in Enigmail. The
full report will be published once all issues are fixed.

The Enigmail Project likes to thank Posteo and MOSS for sponsoring this highly valuable report.

Identified Vulnerabilities

The following sections list both vulnerabilities and implementation issues spotted during the testing
period. Note that findings are listed in a chronological order rather than by their degree of severity and
impact. The aforementioned severity rank is simply given in brackets following the title heading for each
vulnerability. Each vulnerability is additionally given a unique identifier (e.g. TBE-01-001) for the purpose
of facilitating any future follow-up correspondence.

TBE-01-002 Enigmail: Weak Parsing Causes Confidentiality Compromise (Critical)

The tests revealed a weakness in email parsing. Specifically, this flaw might lead to a vulnerability in
which Enigmail can be coerced to use a malicious PGP public key with a corresponding secret key
controlled by an attacker. An example scenario for this attack is outlined next.

1.  Bob sends an email to Alice. The email appears to be from Bob and is signed and encrypted

under Mallory‚Äôs PGP identity.

2.  Mallory, a network attacker that can only modify Bob‚Äôs ‚ÄúFull Name‚Äù field in SMTP

communications, changes Bob‚Äôs ‚ÄúFull name‚Äù field in a specific way that, because of one aspect of
this vulnerability, is covert. In other words, Alice cannot detect the manipulation.

3.  Alice replies to Mallory‚Äôs email. Due to Mallory‚Äôs surreptitious modification of Bob‚Äôs ‚ÄúFull Name‚Äù

field, however, Alice‚Äôs message response ends up using a completely different PGP key than the
initial one of Bob. This PGP key could be controlled by Mallory, or could actually be any other
PGP key at all.

As exemplified above, this leads to a complete and silent Man-in-the-Middle (MitM) compromise of the
email thread. Evidently, the associated level of risk signifies a vulnerability with a ‚ÄúCritical‚Äù severity and
impact.

Two regular expressions in Enigmail lie at the core of this issue. They can be used for spoofing an
arbitrary email address. The description below explains how this leads to a critical issue, but it should be
noted that the flaw has additional further impact, as can be seen in TBE-01-004.

Enigmail‚Äôs funcs.jsm defines a stripEmail function which is supposed to extract the email address
contained in <evil@example.com> from a comma-separated list of emails. As a first sanity check, a

regular expression is used to make sure that no two <> follow each other. This is done by making sure
that they are separated by commas:

EnigmailFuncsRegexTwoAddr = new RegExp("<[^>,]*>[^,<]*<[^>,]*>");

The problem is, however, that this regular expression can be fooled if the attacker injects an additional
pair of <> and includes a comma in the spoofed email address:

<good@example.com,><evil@example.com>

Then the second regular expression tries to match the email in between the <> pair to extract it:

EnigmailFuncsRegexExtractPureEmail = new RegExp("(^|,)[^,]*<([^>]+)>[^,]*",
"g");

This causes the first email with the comma to be matched, instead of the correct one in
evil@example.com:

<good@example.com,><evil@example.com>

In the efforts to act correctly, Enigmail actually makes things worse by stripping away the comma:

mailAddrs.replace(/[,;]+/g, ",").replace(/^,/, "").replace(/,$/, "");

Therefore, it can be supposed that Bob‚Äôs ‚ÄúFull Name‚Äù field has been changed from Bob Bobbington to
Bob Bobbington <mallory@gmail.com,>.

This change could be made not only by Mallory but also by Bob himself should he wish to deceive Alice.
If Bob‚Äôs ‚ÄúFull Name‚Äù was specified as shown above, then Enigmail will look up the PGP key under
mallory@gmail.com when Alice attempts to reply to Bob. The latter will be used for encryption instead.
Now, this example is far from ‚Äúcovert‚Äù as mentioned in the introduction of this issue. However, it is also
important to consider that Mallory can equally alter Bob‚Äôs ‚ÄúFull Name‚Äù field to Bob Bobbington
<bob@gm–∞il.com,>

The above appears to completely match Bob‚Äôs genuine email address, namely bob@gmail.com. Yet in
fact it does not, because the ‚Äúa‚Äù one sees in ‚Äúgmail‚Äù is actually the UTF-8 Cyrillic character ‚Äú–∞‚Äù. As a
result, the string above does not match the original string in ‚Äúbob@gmail.com‚Äù which represents Bob‚Äôs
actually true email address. To clarify, Mallory could upload a new identity posing as Bob to PGP key
servers. If Mallory maliciously used a Cyrillic character for differentiation, Enigmail would be tricked into
automatically fetching the fake identity. In effect, Enigmail would encrypt that information, thereby
extending the implications of this vulnerability with an aspect of a covert component.

This vulnerability could be remedied by double-checking the regular expressions used for parsing. The
verification should be performed in order to disallow malicious injections of email identifiers. It should be
emphasized that Enigmail uses these identifiers as the basis for the SQLite database lookup, internally
employed for retrieving the corresponding PGP identities. For that reason, flaws in this level of parsing
can be fatal, as demonstrated by this multi-layered finding.

TBE-01-005 Enigmail: Replay of encrypted Contents leads to Plaintext Leak (High)

It was found that an attacker can retrieve plaintext of encrypted mails, provided that they were previously
sent to the victim. This can be achieved by including the encrypted data block into the email‚Äôs body. If the
victim responds to the email in question without discarding the original message, the decrypted content is
leaked to the attacker. Enigmail supports partially encrypted emails wherein only a selection of the

message‚Äôs body is encrypted. This is what makes the attack realistic, since encrypted message blocks
can be hidden in longer conversations.

Steps to reproduce:

‚Ä¢  Mallory intercepts an encrypted message sent from Alice to Bob.

‚Ä¢  Mallory starts a conversation with Bob. In order to make this attack work, Bob ‚Ä®must not discard

the original message when replying to an email.

‚Ä¢

At some point when the conversation is long enough, Mallory slips the intercepted PGP block into
the conversation and leaves the rest of the email ‚Ä®unencrypted.

‚Ä¢  When Bob receives the message, the PGP block will be decrypted automatically.

‚Ä¢

As Bob will likely not read the earlier conversation again, he will have no way of noticing the
additional text. However, if he expectedly responds to the message, the decrypted content will be
leaked to Mallory.

An alternative way to exploit this issue requires social engineering and makes use of Thunderbird‚Äôs
forwarding feature. Actions that need to be completed for this alternative route are enumerated next.

Steps to reproduce:

1.  Mallory intercepts an encrypted message which is sent from Alice to Bob.

2.  Mallory sends Bob a very long text message which includes the encrypted PGP block and a short

text which convinces Bob to forward this email to Trudy without ‚Ä®reading the actual message.

3.

If Bob follows Mallory‚Äôs instructions and forwards the email, Enigmail will ‚Ä®automatically decrypt
the included PGP block and the plaintext is leaked to Trudy.

It should be noted that this issue is rather a design flaw. Specifically, it predominantly relies on the
unawareness or lazy behavior of users.

Thunderbird already displays an info box when an email contains partly encrypted data. However, this
message can be easily overseen or ignored. It is recommended to leave messages about partial
encryption when they are being forwarded or responded to. It is alternatively recommended to display a
clear warning when a response to a partly encrypted message is composed or when such a message is
forwarded.

TBE-01-021 Enigmail: Flawed parsing allows faked Signature Display (Critical)

Enigmail will incorrectly find and verify signatures of attached email files. The error lies in parsing the
email and failing to separate the contents of the email from the contents of the attachment. If an attached
email is signed, Enigmail will verify that signature against the text of the attached email, but it will appear
to the user as if the entire message was signed. This allows an attacker to create a forged email, e.g.,
from bob@cure53.de, that has an email as an attachment signed by bob@cure53.de. To the recipient it
seems as if the message in its entirety - rather than just the attachment - was signed by Bob.

Steps to reproduce:

1.  Save an email with a correct signature from the victim.

2.  Create a new email and add the saved email as an attachment.

3.  Send the email to the targeted recipient.

4.  The target will now see the email as having a valid signature from the victim.

Sample email body:

Delivered-To: jonas@cure53.de
Return-Path: <mario@cure53.de>
To: Mario Heiderich <mario@cure53.de>, Jonas Magazinius <jonas@cure53.de>
From: "Dr.-Ing. Mario Heiderich" <mario@cure53.de>
Subject: This is totally signed by mario@cure53.de!
Date: Fri, 29 Sep 2017 12:35:19 +0200
Content-Type: multipart/mixed;
  boundary="------------AEA294334A39599F740CD34A"

This is a multi-part message in MIME format.

--------------AEA294334A39599F740CD34A
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: quoted-printable

Hey!

Just writing this totally legit email and it's totally signed by me
(mario@cure53.de).

/Mario

--------------AEA294334A39599F740CD34A
Content-Type: message/rfc822;
  name="poc.eml"
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
  filename="poc.eml"
Subject: [REDACTED]
To: jonas@cure53.de
From: "Dr.-Ing. Mario Heiderich" <mario@cure53.de>
Content-Type: multipart/signed; micalg=pgp-sha256;
  protocol="application/pgp-signature";
  boundary="PWpC1qlx6dsQoTPWMjFMqgqCjLq1TuoEA"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)

--PWpC1qlx6dsQoTPWMjFMqgqCjLq1TuoEA
Content-Type: multipart/mixed;
  boundary="MkhracRKbd653uoMlB5pR9frBfLDD2DJK";
  protected-headers="v1"
From: "Dr.-Ing. Mario Heiderich" <mario@cure53.de>
To: jonas@cure53.de
Subject: [REDACTED]

--MkhracRKbd653uoMlB5pR9frBfLDD2DJK
Content-Type: text/plain; charset=utf-8
Content-Language: en-US
Content-Transfer-Encoding: quoted-printable

Hi,
[REDACTED]

Cheers,

=2Emario

--MkhracRKbd653uoMlB5pR9frBfLDD2DJK--
--PWpC1qlx6dsQoTPWMjFMqgqCjLq1TuoEA
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJZdwtDAAoJEMJshYCQ9wra/7kP/20hr3PCSO4Lm0eZ6OCpuhGj
p04h38Mx6Jxrn+i85yMA/Bk7aU48spraWNm9cVBv8sFnVLdSTs9IiNcNsEznUCM3
KMxkva+E8u3+uuOZEGlo70L/c8EFIkXT2TrW241ZMJFLzhvcAaQLKD4V+cnsJ6CS
bV9v0WYfFH3sS4ImTj1VPVGKfLgYQnxZK/OTnxVM7oHwb4ibshqGBic2L4C4afDI
K8MRc4Fek+llKPBqH/1Am72tTyyweGFyRAfJJ5BfxJTrSSJ08KPMya6NHQq4QG0A
63Sy1Ji1l5j9BoK+Y7VolwmONDnBYLnyTkN/UoPl/6C7rA8SVQzuQtG/qihXete6
6vrlwEADuS904BZv3BJuhwIw9irmqFSjMFcx4gRldZzvyII7MD7IvtSouSsbwSTZ
3swiifz5fNRUrKq4yNarLCqOKbXn+W0mSjS6Ft23wnMosadGNyT49t6f9ZPILpuB
kL2Cro1Sihsrryzg/Y5NG52Dy2BFH7VfBHjIIl++1dTU6nnfGCZ3XWdnXB5sX2BH
i+cZ2GFiu05ICgi7tdIAjL7Zwh0P1Pf4uAwZ4o5F7Ilxo1ez5LFMTPMoVa1R1E8t
bS/DwqhzTad5EXhhJknpNDt8VZJpx+XjHbD+QW4z8OTlLSVQ2UYnLZXqQsgzK8yE
hGGHg2U2a9dCF7psD2Cf
=VrRa

-----END PGP SIGNATURE-----
--PWpC1qlx6dsQoTPWMjFMqgqCjLq1TuoEA--
--------------AEA294334A39599F740CD34A--

As it is already clear from the opening description, it is recommended fix the parsing of the email in the
signature verification flow. It should be ascertained that the whole email - instead of the attached emails
only - is signed.

Miscellaneous Issues

This section covers those noteworthy findings that did not lead to an exploit but might aid an attacker in
achieving their malicious goals in the future. Most of these results are vulnerable code snippets that did
not provide an easy way to be called. Conclusively, while a vulnerability is present, an exploit might not
always be possible.

TBE-01-001 Enigmail: Insecure Random Secret Generation (Low)

Enigmail‚Äôs implementation of pretty Easy privacy (pEp)1
JavaScript‚Äôs Math.Random() feature. This does not signify a cryptographically secure pseudo-random
umber generator2

generates security tokens with calls to

approach.

1	https://en.wikipedia.org/wiki/Pretty_Easy_privacy
2	https://stackoverflow.com/questions/5651789/is-math-random-cryptographically-secure

Affected File:

/enigmail-source/package/rng.jsm

Called in:

/enigmail-source/packagepEpAdapter.jsm:

Affected Code:

gSecurityToken = EnigmailRNG.generateRandomString(40);
 [...]

/**
 * Create a string of random characters with numChars length
 */
function generateRandomString(numChars) {
  let b = "";
  let r = 0;

  for (let i = 0; i < numChars; i++) {‚Ä®r = Math.floor(Math.random() * 58);
				b += String.fromCharCode((r < 10 ? 48 : (r < 34 ? 55 : 63)) + r);
  }‚Ä®return b;
}

The generateRandomString() function employs Math.random(), which is not an advised route in this
realm. Instead, it is recommended to make use of the already present and considerably more secure
random number generators that are referenced in the same file (rng.jsm). Generally, the most widely
available secure source of pseudo-randomness in JavaScript is the window.crypto.getRandomValues()
function, and it should be used exclusively for sensitive random value generation contexts.

TBE-01-003 Enigmail: Regular Expressions Exploitable for Denial of Service (Low)

Regular expressions used to parse user-input or gnupg output are specified too broadly. As such, they
give way to Denial of Service (DoS) attacks. In the instances that were discovered, arbitrary-length inputs
were accepted as valid for attachment headers, URL protocol headers, and email address links. This can
allow an attacker to pass an extremely large string into internal Enigmail functions, causing Denial of
Service on the client-side and ultimately crashing the client.

No further negative effect has been observed as part of this issue, so it is not viewed as actually
compromising any user-security. Neither it is able to accomplish anything other than inconveniencing or
disrupting the user‚Äôs workflow.

Affected File:

/enigmail-source/package/decryption.jsm

Affected Code:

if (attachmentHead.match(/-----BEGIN PGP \w+ KEY BLOCK-----/)) {
 // attachment appears to be a PGP key file

Affected File:

/enigmail-source/package/decryptPermanently.jsm

Affected Code:

if (attachmentHead.match(/-----BEGIN PGP \w+ KEY BLOCK-----/)) {
		// attachment appears to be a PGP key file, we just go-a-head
  resolve(o);‚Ä®return;
}

Affected File:

/enigmail-source/ui/content/enigmailMessengerOverlay.js

Affected Code:

// Hyperlink URLs
var urls = text.match(/\b(http|https|ftp):\S+\s/g);

Affected File:

/enigmail-source/ui/content/enigmailMessengerOverlay.js

Affected Code:

// Hyperlink email addresses
var addrs = text.match(/\b[A-Za-z0-9_+.-]+@[A-Za-z0-9.-]+\b/g);

Across all of the detected examples, it was possible to replace instances of regular expression matching
for arbitrary-length inputs with inputs of fixed length. Similarly, a predetermined but long range of, for
example, 1 to 1024 characters, could be accomplished. Conversely, for the PGP header, a predetermined
length of 1 to 10 characters is sufficient.


