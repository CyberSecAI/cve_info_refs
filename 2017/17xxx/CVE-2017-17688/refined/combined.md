=== Content from twitter.com_6c3b43df_20250125_233152.html ===



=== Content from lists.gnupg.org_b60a05ee_20250125_233149.html ===

# Efail press release

**Robert J. Hansen**
rjh at sixdemonbag.org

*Mon May 14 14:27:44 CEST 2018*

* Previous message (by thread): [Mailpile on Efail](060333.html)
* Next message (by thread): [US-CERT now issuing a warning for OpenPGP-SMIME-Mail-Client-Vulnerabilities](060351.html)
* **Messages sorted by:**
  [[ date ]](date.html#60334)
  [[ thread ]](thread.html#60334)
  [[ subject ]](subject.html#60334)
  [[ author ]](author.html#60334)

---

```
Over the last few hours, Werner, Andre, and I have been working on an
official statement about the Efail paper.  Without further ado, here it is.

An Official Statement on New Claimed Vulnerabilities
== ======== ========= == === ======= ===============
by the GnuPG and Gpg4Win teams

(This statement is only about the susceptibility of OpenPGP, GnuPG, and
Gpg4Win.  It does not cover S/MIME.)

Recently some security researchers published a paper named "Efail:
Breaking S/MIME and OpenPGP Encryption using Exfiltration Channels".
The EFF has gone so far as to recommend immediately uninstalling
Enigmail.  We have three things to say, and then we're going to show you
why we're right.

1. This paper is misnamed.

2. This attack targets buggy email clients.

3. The authors made a list of buggy email clients.

In 1999 we realized OpenPGP's symmetric cipher mode (a variant of cipher
feedback) had a weakness: in some cases an attacker could modify text.
As Werner Koch, the founder of GnuPG, put it: "[Phil Zimmermann] and Jon
Callas asked me to attend the AES conference in Rome to discuss problems
with the CFB mode which were on the horizon.  That discussion was in
March 1999 and PGP and GnuPG implemented a first version [of our
countermeasure] about a month later.  According to GnuPG's NEWS file,
[our countermeasure] went live in Summer 2000."

The countermeasure Werner mentions is called a Modification Detection
Code, or MDC.  It's been a standard part of GnuPG for almost eighteen
years.  For almost all that time, any message which does not have an MDC
attached has caused GnuPG to throw up big, clear, and obvious warning
messages.  They look something like this:

    gpg: encrypted with 256-bit ECDH key, ID 7F3B7ED4319BCCA8, created
2017-01-01
          "Werner Koch <[wk at gnupg.org](http://lists.gnupg.org/mailman/listinfo/gnupg-users)>"
    [GNUPG:] BEGIN_DECRYPTION
    [GNUPG:] DECRYPTION_INFO 0 7
    [GNUPG:] PLAINTEXT 62 1526109594
    [GNUPG:] PLAINTEXT_LENGTH 69
    There is more to life than increasing its speed.
                    -- Mahatma Gandhi
    gpg: WARNING: message was not integrity protected
    [GNUPG:] DECRYPTION_FAILED
    [GNUPG:] END_DECRYPTION

GnuPG also throws large warning messages if an MDC indicates a message
has been modified.  In both cases, if your email client respects this
warning and does the right thing -- namely, not showing you the email --
then you are completely protected from the Efail attack, as it's just a
modern spin on something we started defending against almost twenty
years ago.

If you're worried about the Efail attack, upgrade to the latest version
of GnuPG and check with your email plugin vendor to see if they handle
MDC errors correctly.  Most do.

You might be vulnerable if you're running an ancient version of GnuPG
(the 1.0 series; the current is 2.2), or if your email plugin doesn't
handle GnuPG's warning correctly.  You might also have had some exposure
in the past if back then you used a pre-2000 version of GnuPG, and/or an
email plugin which didn't handle the warning correctly.

We made three statements about the Efail attack at the beginning.  We're
going to repeat them here and give a little explanation.  Now that we've
explained the situation, we're confident you'll concur in our judgment.

1.  This paper is misnamed.  It's not an attack on OpenPGP.  It's an
attack on broken email clients that ignore GnuPG's warnings and do silly
things after being warned.

2.  This attack targets buggy email clients.  Correct use of the MDC
completely prevents this attack.  GnuPG has had MDC support since the
summer of 2000.

3.  The authors made a list of buggy email clients.  It's worth looking
over their list of email clients (found at the very end) to see if yours
is vulnerable.  But be careful, because it may not be accurate -- for
example, Mailpile says they're not vulnerable, but the paper indicates
Mailpile has some susceptibility.

The authors have done the community a good service by cataloguing buggy
email email clients.  We're grateful to them for that.  We do wish,
though, this thing had been handled with a little less hype.  A whole
lot of people got scared, and over very little.

```

---

* Previous message (by thread): [Mailpile on Efail](060333.html)
* Next message (by thread): [US-CERT now issuing a warning for OpenPGP-SMIME-Mail-Client-Vulnerabilities](060351.html)
* **Messages sorted by:**
  [[ date ]](date.html#60334)
  [[ thread ]](thread.html#60334)
  [[ subject ]](subject.html#60334)
  [[ author ]](author.html#60334)

---

[More information about the Gnupg-users
mailing list](http://lists.gnupg.org/mailman/listinfo/gnupg-users)



=== Content from efail.de_29cf9087_20250125_233149.html ===


![](media/img/logo.svg)

# EFAIL

* [Mitigations](#mitigations)
* [FAQ](#faq)
* [Paper/Talks](#paper)
* [Coverage](#press)

**EFAIL describes vulnerabilities in the end-to-end encryption technologies OpenPGP and S/MIME that leak the plaintext of encrypted emails.**

Email is a plaintext communication medium whose communication paths are partly protected by TLS ([TLS](https://en.wikipedia.org/wiki/Transport_Layer_Security)). For people in hostile environments (journalists, political activists, whistleblowers, ...) who depend on the confidentiality of digital communication, this may not be enough. Powerful attackers such as nation state agencies are known to eavesdrop on email communications of a large number of people. To address this, [OpenPGP](https://en.wikipedia.org/wiki/Pretty_Good_Privacy) offers [end-to-end encryption](https://en.wikipedia.org/wiki/End-to-end_encryption) specifically for sensitive communication in view of these powerful attackers. [S/MIME](https://en.wikipedia.org/wiki/S/MIME) is an alternative standard for email end-to-end encryption that is typically used to secure corporate email communication.

![](media/img/overview1.jpg)

The EFAIL attacks exploit vulnerabilities in the OpenPGP and S/MIME standards to reveal the plaintext of encrypted emails. In a nutshell, EFAIL abuses active content of HTML emails, for example externally loaded images or styles, to exfiltrate plaintext through requested URLs. To create these exfiltration channels, the attacker first needs access to the encrypted emails, for example, by eavesdropping on network traffic, compromising email accounts, email servers, backup systems or client computers. The emails could even have been collected years ago.

![](media/img/overview2.jpg)

The attacker changes an encrypted email in a particular way and sends this changed encrypted email to the victim. The victim's email client decrypts the email and loads any external content, thus exfiltrating the plaintext to the attacker.

#### The CBC/CFB Gadget Attack

There are two different flavors of EFAIL attacks. First, we describe the novel *CBC/CFB gadget* attacks which abuse vulnerabilities in the specification of OpenPGP and S/MIME to exfiltrate the plaintext. The diagram below describes the idea of CBC gadgets in S/MIME. Because of the specifics of the [CBC mode of operation](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation), an attacker can precisely modify plaintext blocks if she knows the plaintext. S/MIME encrypted emails usually start with "Content-type: multipart/signed" so the attacker knows at least one full block of plaintext as shown in *(a)*. She can then form a *canonical plaintext block* whose content is all zeros as shown in (b). We call the block pair *X* and *C0* a CBC gadget. In step (c), she then repeatedly appends CBC gadgets to inject an image tag into the encrypted plaintext. This creates a single encrypted body part that exfiltrates its own plaintext when the user opens the attacker email. OpenPGP uses the [CFB mode of operation](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Feedback_.28CFB.29), which has very similar cryptographic properties as CBC and allows the same attack using CFB gadgets.

![](media/img/smime-attack.png)

The difference here is that any standard-conforming client will be vulnerable and that each vendor may cook their own mitigations that may or may not prevent the attacks. Thus, in the long term, it is necessary to update the specification to find and document changes that fix the underlying root causes of the vulnerabilities.

While the CBC/CFB gadget attacks on PGP and S/MIME are technically very similar, the requirements for a successful attack differ substantially. Attacking S/MIME is straightforward and an attacker can break multiple (in our tests up to 500) S/MIME encrypted emails by sending a single crafted S/MIME email to the victim. As opposed to S/MIME, modern OpenPGP implementations offer a Modification Detection Code (MDC) that can detect modified plaintexts, effectively preventing the CFB gadget attack. However, we found that several clients only gave a warning to the user for invalid MDCs, but still displayed the modified plaintext. This allowed the CFB gadget attack despite the MDC. Furthermore, PGP compresses the plaintext before encrypting it, which complicates guessing known plaintext bytes. Given the current state of our research, the CFB gadget attack against PGP only has a success rate of approximately one in three attempts. We feel that plaintext compression is not a fundamental limitation of the EFAIL attacks but more a technical hitch and that attacks become more efficient in future research.

#### Direct Exfiltration

![](media/img/exfil1.png)

Second, the *direct exfiltration* attack abuses vulnerabilities in Apple Mail, iOS Mail and Mozilla Thunderbird to directly exfiltrate the plaintext of encrypted emails. These vulnerabilities can be fixed in the respective email clients. The attack works like this. The attacker creates a new multipart email with three body parts as shown below. The first is an HTML body part essentially containing an HTML image tag. Note that the src attribute of that image tag is opened with quotes but not closed. The second body part contains the PGP or S/MIME ciphertext. The third is an HTML body part again that closes the src attribute of the first body part.

![](media/img/exfil2.png)

The attacker now sends this email to the victim. The victim's client decrypts the encrypted second body part and stitches the three body parts together in one HTML email as shown below. Note that the src attribute of the image tag in line 1 is closed in line 4, so the URL spans over all four lines.

![](media/img/exfil3.png)

The email client then URL encodes all non-printable characters (e.g., %20 is a whitespace) and requests an image from that URL. As the path of the URL contains the plaintext of the encrypted email, the victim's email client sends the plaintext to the attacker.

The direct exfiltration EFAIL attacks work for encrypted PGP as well as S/MIME emails.

## Mitigations

Here are some strategies to prevent EFAIL attacks:

**Short term: No decryption in email client.** The best way to prevent EFAIL attacks is to only decrypt S/MIME or PGP emails in a separate application outside of your email client. Start by removing your S/MIME and PGP private keys from your email client, then decrypt incoming encrypted emails by copy&pasting the ciphertext into a separate application that does the decryption for you. That way, the email clients cannot open exfiltration channels. This is currently the safest option with the downside that the process gets more involved.

**Short term: Disable HTML rendering.** The EFAIL attacks abuse active content, mostly in the form of HTML images, styles, etc. Disabling the presentation of *incoming* HTML emails in your email client will close the most prominent way of attacking EFAIL. Note that there are other possible backchannels in email clients which are not related to HTML but these are more difficult to exploit.

**Medium term: Patching.** Some vendors will publish patches that either fix the EFAIL vulnerabilities or make them much harder to exploit.

**Long term: Update OpenPGP and S/MIME standards.** The EFAIL attacks exploit flaws and undefined behavior in the [MIME](https://en.wikipedia.org/wiki/MIME), S/MIME, and OpenPGP standards. Therefore, the standards need to be updated, which will take some time.
**Update:** The changes in the current draft of [OpenPGP RFC4880 (bis05)](https://tools.ietf.org/html/draft-ietf-openpgp-rfc4880bis-05) reflect our recommendation to [deprecate the SE packet type](https://tools.ietf.org/html/draft-ietf-openpgp-rfc4880bis-05#section-5.8) and that [modified ciphertexts should not be displayed](https://tools.ietf.org/html/draft-ietf-openpgp-rfc4880bis-05#page-104).

## Paper

The full technical paper is available at 27th USENIX Security Symposium.

[**Efail: Breaking S/MIME and OpenPGP Email Encryption using Exfiltration Channels**](https://www.usenix.org/conference/usenixsecurity18/presentation/poddebniak)

*Damian Poddebniak, Christian Dresen, Jens Müller, Fabian Ising, Sebastian Schinzel, Simon Friedberger, Juraj Somorovsky, and Jörg Schwenk.*

27th USENIX Security Symposium, Baltimore, August 2018.

## Talks

There are several talks describing EFAIL.

[**Efail: Breaking S/MIME and OpenPGP Email Encryption using Exfiltration Channels**](https://www.youtube.com/watch?v=KrdljMp2li8)

*Damian Poddebniak, Christian Dresen.*

RuhrSec 2018.

[**Efail: Breaking S/MIME and OpenPGP Email Encryption using Exfiltration Channels**](https://www.youtube.com/watch?v=jRb54Xb7TCI&list=PLH15HpR5qRsVAXGmSVfjWrGtGLJjIJuGe&index=51&t=0s)

*Christian Dresen, Jens Müller.*

BlackHat USA 2018.

[**Efail: Angriffe gegen Ende-zu-Ende-Verschlüsselung von E-Mail-Kommunikation mit S/MIME und OpenPGP**](https://www.youtube.com/watch?v=bsYck9SRsHA&list=PLCUxWIPmliVmG6fr0EiqnKqd27nYKNTuV)

*Christian Dresen*

German OWASP Day 2018 Münster.

[**Attacking end-to-end email encryption**](https://www.youtube.com/watch?v=kKjtZy87iI0)

*Sebastian Schinzel*

35th Chaos Communication Congress (35C3).

## Questions and Answers

* [What is PGP and S/MIME encryption?](#what-is)
* [What are the EFAIL attacks?](#what-are)
* [Are there CVEs for EFAIL?](#cve)
* [Who is affected?](#who-is)
* [Can you read my emails?](#can-you)
* [But my emails are TLS encrypted!](#but-my)
* [Is my email client affected?](#is-my)
* [Can I find out whether I have already been attacked?](#been-p0wned)
* [I don't send HTML emails. Am I safe?](#i-dont)
* [I have disabled HTML in my email client. Am I safe?](#i-have)
* [Will signatures prevent these attacks?](#will-signatures)
* [Can you decrypt my own encrypted emails when I lost my private key?](#can-i-decrypt)
* [Do I need to revoke my certificate or public key?](#do-i-need)
* [I have encrypted data using OpenPGP or S/MIME and I won't decrypt it in the email context. Am I safe?](#i-have-encrypted)
* [What happens if there are quotes in the encrypted email?](#no-quotes)
* [Will SPF/DKIM/DMARC mitigate the EFAIL attacks?](#dkim)
* [How did EFAIL influence the developments in the current standards?](#impact)

#### What is PGP and S/MIME encryption?

Both technologies add an additional layer of security to your email communication. If used properly, both technologies should guarantee confidentiality and authenticity of your email messages even if an attacker has full access to your email account. The EFAIL attacks break this additional encryption layer.

#### What are the EFAIL attacks?

The EFAIL attacks break PGP and S/MIME email encryption by coercing clients into sending the full plaintext of the emails to the attacker.

#### Are there CVEs for EFAIL?

Yes, there are two official CVE nummers for the CBC/CFB gadget attacks:

CVE-2017-17688: OpenPGP CFB gadget attacks

CVE-2017-17689: S/MIME CBC gadget attacks

Different vendors assigned further CVEs for specific security issues relevant to EFAIL, for example, direct exfiltration attacks.

#### Who is affected?

Journalists, political activists or whistleblowers use an additional encryption layer, often PGP, because they fear that someone gets access to their email communication. The EFAIL attacks can be used to break this additional encryption layer. This leads to the situation where anyone getting access to their email communication can also read the victims emails even if they use additional PGP encryption. The same attacks apply to S/MIME which is typically used in enterprise infrastructures.

#### Can you read my emails?

No. The EFAIL attacks require the attacker to have access to your S/MIME or PGP encrypted emails. You are thus only affected if an attacker already has access to your emails. However, the very goal of PGP or S/MIME encryption is the protection against this kind of attacker. For those users who rely on PGP and S/MIME encryption, the EFAIL attacks may be a big deal!

#### But my emails are TLS encrypted!

TLS is a transport layer encryption technology that encrypts network traffic among email clients and email servers, or between two email servers. However, the emails are processed and stored in plaintext on the servers and in the email accounts. Any attacker getting access to these emails, either via compromising an email account or an email server, can read and change these emails. PGP and S/MIME are used to protect the confidentiality and integrity of emails in case an attacker can already access the emails.

#### Is my email client affected?

Our analysis shows that EFAIL plaintext exfiltration channels exist for 25 of the 35 tested S/MIME email clients and 10 of the 28 tested OpenPGP email clients. While it is necessary to change the OpenPGP and S/MIME standards to reliably fix these vulnerabilities, Apple Mail, iOS Mail and Mozilla Thunderbird had even more severe implementation flaws allowing direct exfiltration of the plaintext that is technically very easy to execute.

#### Can I find out whether I have already been attacked?

Not for sure. You can of course search in your inbox for malicious emails indicating EFAIL attacks. A strong indication for these attacks could be, for example, malformed emails with unclosed img tags followed by encrypted content, or encrypted content that exfiltrates the plaintext to foreign URLs. However, note that emails are encrypted with the keys of sender as well as all receivers. The attacker can target any of these parties to exfiltrate content that is important to you. In advanced attack scenarios where the attacker is in control of the email server, she could have deleted the malicious emails after the victim has processed them.

#### I don't send HTML emails. Am I safe?

No. The attacker can change encrypted text/only emails to HTML emails. You need to disable *viewing* HTML email to increase protection from EFAIL attacks.

#### I have disabled HTML in my email client. Am I safe now?

Depends. S/MIME or PGP encrypted emails are encrypted with the public keys of *all* recipients *and* the sender. The attacker can thus perform the EFAIL attacks if only one of the participants is vulnerable. In order to prevent the EFAIL attacks, *all* participants must use secure email clients.

#### Will signatures prevent these attacks?

No. PGP and S/MIME emails are displayed in the email program independently of whether or not they are signed or whether an existing signature is valid or not. Even if signatures did matter: an attacker can copy the altered ciphertext into a separate email and create a valid signature under his own name.

#### Can you decrypt my own encrypted emails when I lost my private key?

No. The EFAIL attacks target a victim, who is in possession of the private key and who decrypts our prepared emails in an email client. If the private key is lost, the EFAIL attacks won't help recovering encrypted messages.

#### Do I need to revoke my certificate or public key?

No. Using the EFAIL attacks, the attacker can retrieve the plaintext of encrypted OpenPGP and S/MIME messages. She does not get direct access to the private key.

#### I have encrypted data using OpenPGP or S/MIME and I won't decrypt it in the email context. Am I safe?

For now yes. There may be edge cases though that we hadn't looked into. For example, if you encrypted a directory with sensitive files, an attacker could change these encrypted files to contain false information or even malware. If a victim decrypts the directory and opens any of the files, malware or even just an HTML file could be used to exfiltrate plaintext or even compromise the system.

#### What happens if there are quotes in the encrypted email?

Quotes in the plaintext might end the URL that is used to exfiltrate the plaintext so that either the bytes after the quote are not exfiltrated or that the exploit may not work at all. Because of the properties of the CBC and CFB modes of operation, an attacker can split a single S/MIME or PGP ciphertext into multiple parts and exfiltrate each independently with separate HTML tags (but still in one email). If one part contains quotes then only the residual plaintext bytes in that part are missing. There is a whole zoo of techniques that the attacker can use to exfiltrate the full plaintext despite these technical obstacles.

#### Will SPF/DKIM/DMARC mitigate the EFAIL attacks? (Update 2018-05-16)

No. These technologies offer message authenticity and protection against email sender spoofing. Our EFAIL attacker would copy the S/MIME or PGP ciphertext from the original email and past the changed ciphertext into a new message. The attacker now sends the message under his own name with valid values for SPF/DKIM/DMARC.

#### How did EFAIL influence the developments in the current standards?

There is an ongoing work on two new email security standards. Both considered countermeasures presented in our paper.

The [S/MIME standard draft](https://tools.ietf.org/html/draft-ietf-lamps-rfc5751-bis-11) references our EFAIL paper and recommends the usage of authenticated encryption with AES-GCM. Furthermore, it warns that different parts in multipart/mixed emails should be treated as *being of different origins*.

The [OpenPGP standard draft](https://tools.ietf.org/html/draft-ietf-openpgp-rfc4880bis-05) deprecates Symmetrically Encrypted (SE) data packets which are not protected by MDCs. It proposes AEAD protected data packets and mentions that *the implementation should not allow users to access erroneous data*.

## Responsible Disclosure

We have responsibly disclosed our findings to the affected vendors who have applied (or are in the process of applying) countermeasures. Please note that in general these countermeasures are specific hotfixes and we cannot rule out that extended attacks with further backchannels or exfiltrations will be found. (**Update:** After the disclosure, bypasses were indeed published for [Thunderbird](https://www.golem.de/news/pgp-smime-thunderbird-update-notwendig-um-efail-zu-verhindern-1805-134472.html) and [Apple Mail](https://theintercept.com/2018/05/25/in-apple-mail-theres-no-protecting-pgp-encrypted-messages/).) Moreover, even if all backchannels are closed, both standards are still vulnerable to attacks where the attacker can modify email content or inject malicious code into attachments which get executed in a context beyond email client.

We informed German CERT and BSI about our attacks in December 2017. They forwarded all the relevant information to other CERTs and companies.

We disclosed our attacks to the GnuPG developers on the 24th of November 2017. Further clients are listed below. For reference we also include case numbers and CVEs if they have been assigned. Note that as of May 2018 fixes have been deployed for various mail clients, for details check the vendors' websites.

Attacks on S/MIME clients:

![](media/img/efail-disclosure-smime.png)

\* Due to the amount of disclosed products we have missed communication with this vendor.

Attacks on PGP clients:

![](media/img/efail-disclosure-pgp.png)

Direct exfiltration attacks:

![](media/img/efail-disclosure-direct.png)

## Coverage

Electronic Frontier Foundation

MAY 14, 2018

**Attention PGP Users: New Vulnerabilities Require You To Take Action Now**

<https://www.eff.org/deeplinks/2018/05/attention-pgp-users-new-vulnerabilities-require-you-take-action-now>

Ars Technica

MAY 14, 2018

**Critical PGP and S/MIME bugs can reveal encrypted e-mails. Uninstall now**

<https://arstechnica.com/information-technology/2018/05/critical-pgp-and-smime-bugs-can-reveal-encrypted-e-mails-uninstall-now/>

Golem

MAY 14, 2018

**PGP und S/MIME abschalten**

<https://www.golem.de/news/e-mail-verschluesselung-pgp-und-s-mime-abschalten-1805-134359.html>

Süddeutsche Zeitung

MAY 14, 2018

**Verschlüsselte E-Mails sind nicht sicher**

<https://www.sueddeutsche.de/digital/exklusiv-verschluesselte-e-mails-sind-nicht-sicher-1.3978608>

Forbes

MAY 14, 2018

**Major #eFail Vulnerability Exposes PGP Encrypted Email**

<https://www.forbes.com/sites/thomasbrewster/2018/05/14/pgp-encrypted-email-vulnerability-exposes-private-messages/#4c3963723e2a>

Wired

MAY 14, 2018

**Encrypted email has a major, divisive flaw**

<https://www.wired.com/story/efail-encrypted-email-flaw-pgp-smime/>

Heise Online

MAY 14, 2018

**PGP und S/MIME: E-Mail-Verschlüsselung akut angreifbar**

<https://www.heise.de/security/meldung/PGP-E-Mail-Verschluesselung-akut-angreifbar-4048489.html>

The Register

MAY 14, 2018

**S/MIME artists: EFAIL email app flaws menace PGP-encrypted chats**

<https://www.theregister.co.uk/2018/05/14/smime_pgp_encryption_flaw_emails_vulnerable_to_snooping/>

Vice Motherboard

MAY 14, 2018

**People Are Freaking Out That PGP Is ‘Broken’—But You Shouldn’t Be Using It Anyway**

<https://motherboard.vice.com/en_us/article/3k4nd9/pgp-gpg-efail-vulnerability>

The Atlantic

MAY 21, 2018

**Email Is Dangerous**

<https://www.theatlantic.com/technology/archive/2018/05/email-is-dangerous/560780/>

Golem

MAY 22, 2018

**Die wichtigsten Fakten zu Efail**

<https://www.golem.de/news/pgp-smime-die-wichtigsten-fakten-zu-efail-1805-134493.html>

Bruce Schneier

MAY 24, 2018

**What "Efail" Tells Us About Email Vulnerabilities and Disclosure**

<https://www.schneier.com/essays/archives/2018/05/what_efail_tells_us_.html>

Last updated May 14, 2018 | The Efail website free to use under GPL | Logo designed by Jana Runde and Zuzana Somorovska (free to use under a CC0 license) | [Imprint](imprint.html)



=== Content from www.synology.com_92a7dd4a_20250125_233152.html ===


* [Security Advisory](security/advisory)
# Synology-SA-18:22 EFAIL

Publish Time: 2018-05-15 19:16:15 UTC+8

Last Updated: 2019-12-24 14:27:10 UTC+8

Severity
Not affected

Status
Resolved

**Abstract**

The EFAIL attacks allow remote attackers to reveal the plaintext of encrypted emails.

Synology products are not affected because MailPlus, Android MailPlus, and iOS MailPlus do not render HTML for OpenPGP nor S/MIME messages.

**Affected Products**

| Product | Severity | Fixed Release Availability |
| --- | --- | --- |
| MailPlus | Not affected | N/A |
| Android MailPlus | Not affected | N/A |
| iOS MailPlus | Not affected | N/A |

**Mitigation**

None

**Detail**

* CVE-2017-17688

  + Severity: Moderate
  + CVSS3 Base Score: 5.3
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N)
  + \*\* DISPUTED \*\* The OpenPGP specification allows a Cipher Feedback Mode (CFB) malleability-gadget attack that can indirectly lead to plaintext exfiltration, aka EFAIL. NOTE: third parties report that this is a problem in applications that mishandle the Modification Detection Code (MDC) feature or accept an obsolete packet type, not a problem in the OpenPGP specification.
* CVE-2017-17689

  + Severity: Moderate
  + CVSS3 Base Score: 5.3
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N)
  + The S/MIME specification allows a Cipher Block Chaining (CBC) malleability-gadget attack that can indirectly lead to plaintext exfiltration, aka EFAIL.

**Reference**

* <https://efail.de>
* [OpenPGP and S/MIME mail client vulnerabilities](https://www.kb.cert.org/vuls/id/122919)
* [OpenPGP, S/MIME Mail Client Vulnerabilities](https://www.us-cert.gov/ncas/current-activity/2018/05/14/OpenPGP-SMIME-Mail-Client-Vulnerabilities)
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2017-17688>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2017-17689>

**Revision**

| Revision | Date | Description |
| --- | --- | --- |
| 1 | 2018-05-15 | Initial public release. |
| 2 | 2019-12-24 | Disclosed vulnerability details. |

## What can we do for you?

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector_home.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector in homepage")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator_home.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator in homepage")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector_home.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector in homepage")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base_home.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center in homepage")

[![Downloads icon](img/footer/2019/footer_icon_downloads_home.png)

Downloads](support/download "Navigate to Downloads in homepage")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter_home.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter in homepage")

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center")

[![Downloads icon](img/footer/2019/footer_icon_downloads.png)

Downloads](support/download "Navigate to Downloads")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter")

Company

* [About Synology](company)
* [Blog](https://blog.synology.com/)
* [Newsroom](company/news)
* [Media Coverage](company/reviews)
* [Customer Stories](company/case_study)
* [Office Locations](company/office_location)
* [ESG](company/esg)

Sales

* [Where to Buy](wheretobuy)
* [Contact Us](company/contact_us)
* [Become a Partner](/form/inquiry/sales)

Compatibility

* [HDD/SSD](compatibility?search_by=drives)
* [IP Cameras](compatibility/camera)
* [Network Cards](compatibility?search_by=category&category=network_interface_cards&p=1)
* [I/O Modules, IP Speakers, Access Controllers](compatibility/surveillance_devices)
* [Other Devices](compatibility?search_by=category)

Resources

* [Products A-Z](products-a-z)
* [Beta Program](beta)
* [Bounty Program](security/bounty_program)
* [Community](https://community.synology.com/enu)
* [Events](https://event.synology.com/en-global)
* [Subscribe to Newsletter](/subscribe-newsletter)

Copyright © 2025 Synology Inc. All rights reserved.
[Terms & Conditions](company/legal/terms_conditions "Terms & Conditions")
| [Privacy](company/legal/privacy "Privacy")
| Cookie Preference

 Global - English

Continue



=== Content from protonmail.com_fc3910db_20250125_233151.html ===
  [![Proton](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fproton-purple_lf83vr.svg)](/)

* Products[![Proton Mail](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ficons%2Fmail_xxy4bg.svg)![Proton](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fproton-black_zvq72v.svg)![Mail](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fmail-purple_resbmb.svg)

  Encrypted email that's private by default.](/mail)[![Proton Calendar](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ficons%2Fcalendar_ylg2jq.svg)![Proton](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fproton-black_zvq72v.svg)![Calendar](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fcalendar-purple_axpwhi.svg)

  Your calendar is a record of your life. Keep it safe.](/calendar)[![Proton Drive](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ficons%2Fdrive_wo2nx4.svg)![Proton](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fproton-black_zvq72v.svg)![Drive](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fdrive-purple_gvgywi.svg)

  Secure cloud storage that gives you control of your data.](/drive)[![Proton VPN](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ficons%2Fvpn_f9embt.svg)![Proton](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fproton-black_zvq72v.svg)![VPN](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fvpn-purple_afexu9.svg)

  Your gateway to online freedom.

  (new window)](https://protonvpn.com/?ref=pme_blog_b2c_proton_submenu)[![Proton Pass](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ficons%2Fpass_wl1fk9.svg)![Proton](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fproton-black_zvq72v.svg)![Pass](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fpass-purple_h2rbko.svg)

  An encrypted password manager that protects your online identity.](/pass)[![Proton Wallet](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ficons%2Fwallet_hnlslt.svg)![Proton](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fproton-black_zvq72v.svg)![Wallet](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fwallet-purple_gxmyyv.svg)

  Store and transact Bitcoin privately with an encrypted self-custody wallet.](/wallet)

  ---

  [![Proton](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fproton-black_zvq72v.svg)![For Business](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fbusiness-black_xc1ryk.svg)

  Improve the security of your business and comply with data protection laws.](/business)
* [Proton for Business](/business)
* Who we are[Proton

  A better internet starts with privacy and freedom.](/)[About us

  Proton stands for privacy. Always has, always will.](/about)[Team

  Meet the people building a better internet.](/about/team)[Impact

  Defending freedom through tech is why we exist.](/about/impact)[CareersWe're hiring

  Seeking talented people to take Proton to the next level.](/careers)

  ---

  We've always been guided by the Proton community.

  [Community

  Join the fight to make the internet a better place.](/community)[Open source

  Everyone is welcome to inspect our code. We're open.](/community/open-source)[Proton Foundation

  Our non-profit model puts people before profit.](/foundation)
* Resources and supportHelp[Switch to Proton

  Move to Proton in just a few clicks with Easy Switch.](/easyswitch)[Help and support

  Guides and customer support for Proton products.](/support)[Password generator

  Create strong, random passwords.](/pass/password-generator)Blog[News

  Latest news on privacy and the Internet.](/blog)[Product updates](/blog/product-updates)[Proton news](/blog/news)[Privacy guides](/blog/privacy-guides)Download the apps[Proton Mail](/mail/download)[Proton Calendar](/calendar/download)[Proton Drive](/drive/download)[Proton VPN(new window)](https://protonvpn.com/download?ref=pme_blog_b2c_proton_submenu)[Proton Pass](/pass/download)

[Create a free account](/pricing)[Sign in](https://account.proton.me/login)Open menu[![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1693233221%2Fstatic%2Flogos%2Fproton-blog-logo_ktossq.svg)](/blog)

* Product updates
* [Proton news](/blog/news)
* [Privacy news](/blog/privacy-news)
* [Privacy guides](/blog/privacy-guides)
* [Opinion](/blog/opinion)
* [For business](/blog/business)
[Subscribe by RSS](/blog/feed)Search for blog posts[Create account](/pricing)     ![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=images%2Ff_auto%2Cq_auto%2Fv1707576407%2Fwp-pme%2Fprotonmail-efail-technical-analysis%2Fprotonmail-efail-technical-analysis.%3F_i%3DAA)

* [Privacy news](/blog/privacy-news)
# No, PGP is not broken, not even with the Efail vulnerabilities

![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fstatic%2Favatars%2FAndy_Yen_a53kbq.png)[Andy Yen](/blog/author/ayen)

Share this page

* [![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1712065300%2Fstatic%2Fsocial%2Fx-widestroke-gray_f2ti5x.svg)(new window)](https://twitter.com/share?url=https://proton.me/blog/pgp-vulnerability-efail&text=PGP is not broken, not even with the Efail vulnerabilities&via=ProtonPrivacy)
* [![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1711363892%2Fstatic%2Fsocial%2Freddit-gray.svg)(new window)](https://www.reddit.com/submit?url=https://proton.me/blog/pgp-vulnerability-efail&title=PGP is not broken, not even with the Efail vulnerabilities)
* [![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1711363891%2Fstatic%2Fsocial%2Ffacebook-gray.svg)(new window)](https://www.facebook.com/sharer/sharer.php?u=https://proton.me/blog/pgp-vulnerability-efail&quote=PGP is not broken, not even with the Efail vulnerabilities)
* [![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1711363892%2Fstatic%2Fsocial%2Flinkedin-gray.svg)(new window)](https://www.linkedin.com/shareArticle?url=https://proton.me/blog/pgp-vulnerability-efail&mini=true&title=PGP is not broken, not even with the Efail vulnerabilities&summary=Recently, news broke about potential vulnerabilities in PGP, dubbed Efail. However, despite reports to the contrary, PGP is not actually broken, as we will explain in this post.&source=Proton "PGP is not broken, not even with the Efail vulnerabilities")

      Published on May 15, 2018

The vulnerability report, which came with its own website, [efail.de(new window)](https://efail.de), has attracted a lot of headlines such as the one below, along with recommendations to [disable the usage of PGP plugins(new window)](https://www.eff.org/deeplinks/2018/05/attention-pgp-users-new-vulnerabilities-require-you-take-action-now). This was not helped by the fact that until earlier today, the full details of the “vulnerability” were not disclosed to the community. However, now that the information is public and we have completed our analysis, we can say that **these headlines are wrong**, and recommendations to stop using PGP plugins are misguided. We have published our own recommendations below as well.

[![pgp-vulnerability](https://res.cloudinary.com/dbulfrlrz/images/w_500,h_325,c_scale/f_auto,q_auto/v1714645181/wp-pme/pgp-headline_29569451f0/pgp-headline_29569451f0.jpg?_i=AA)(new window)](https://res.cloudinary.com/dbulfrlrz/images/f_auto%2Cq_auto/v1714645181/wp-pme/pgp-headline_29569451f0/pgp-headline_29569451f0.jpg?_i=AA)

**First, Proton Mail is not impacted by the Efail PGP vulnerabilities.** This includes our web and mobile applications, and also our [Proton Mail Bridge(new window)](/mail/bridge) software for desktop. In the second part of this post, we have included a full technical analysis explaining why Proton Mail is not vulnerable.

**It is equally important to state that, other than one minor exception (discussed later), Efail is not a vulnerability in PGP itself.** What the authors of Efail did was catalogue a list of PGP clients that have errors in their PGP implementation. In the worst case, these implementation flaws can lead to encrypted emails being decrypted, provided the attackers already have a copy of your [encrypted email](/mail) and the capability to resend it to you (both are pretty strong caveats that dramatically limit the scope of the vulnerability).

### PGP Security and Efail

PGP has a long history, dating back over 20 years, and while some may use this to claim that PGP is “outdated” or “unfashionable”, it also means that PGP is time and battle-tested. Simply put, it is the best way to encrypt emails, and because the protocol is open, it has had over two decades of peer review and security audits. This means it is very unlikely to have undiscovered vulnerabilities lurking under the hood.

However, in cryptography, as in many things, the devil is in the details, and implementing PGP securely is indeed a challenge. Many of the PGP software libraries and plugins have not undergone the same level of scrutiny as the OpenPGP protocol itself. Indeed, some of the vulnerabilities disclosed in Efail have been [known to the PGP developer community since 1999(new window)](https://lists.gnupg.org/pipermail/gnupg-users/2018-May/060334.html) and some PGP plugins remain vulnerable.

As an open standard, anybody can implement PGP, and some do it better than others, so it should come as no surprise that some PGP implementations have security vulnerabilities. However, this should not be taken to be an indictment of PGP. **At its core, PGP remains cryptographically sound**, and using a few bad implementations to claim that “PGP has a serious flaw” is both untrue and disingenuous.

### Recommendations for PGP users

**Recommendations to disable PGP plugins and stop encrypting emails are completely unwarranted and could put lives at risk.** The correct response to vulnerable PGP implementations should not be to stop using PGP, but to use secure PGP implementations. If a vulnerability is discovered in your operating system, you don’t throw away your computer. Instead, you update it and patch it. When it comes to vulnerabilities in PGP implementations, the same principle applies. If you are a PGP user, we recommend the same strategy. **Apply updates to your PGP software when they become available** (if necessary). Because the vulnerabilities are in the PGP implementations and not the OpenPGP protocol itself, these bugs are very easy for PGP plugin developers to patch. **Or you can switch to [using Proton Mail(new window)](/mail) which is not susceptible to the Efail vulnerabilities.**

### Proton Mail is not impacted by the Efail PGP vulnerabilities

In this section, we will provide a technical analysis of why Proton Mail is not impacted by the PGP implementation vulnerabilities disclosed in the Efail paper. Due to the subject matter, the discussion is necessarily technical in nature. At the end, we also discuss our views on the future of PGP.

There are three distinct attacks [presented in the paper(new window)](https://efail.de/efail-attack-paper.pdf) – a direct exfiltration attack, an attack on S/MIME, and an attack on OpenPGP. We have analyzed the first and third for any potential vulnerabilities, as Proton Mail does not use or support S/MIME. We will note, however, that S/MIME is actually the more serious vulnerability because it is widely used by government and military and may be unfixable, so the media’s fixation on PGP is misplaced since PGP itself is not actually broken.

#### Direct Exfiltration Channel Attack

The first attack presented in the paper is the “direct exfiltration channel” attack, in which an adversary constructs an email structure where a plaintext part with an <img> element is prepended to the ciphertext. Then, when the ciphertext is decrypted by the recipient, it will theoretically be replaced by the corresponding plaintext in the client, and then the client will attempt to parse the image source, sending the plaintext in the HTTP request path.

Proton Mail is not vulnerable to this attack because we do not handle emails containing both plaintext and ciphertext in the way described in the paper. When Proton Mail’s servers parse incoming mail, a message of this structure is treated as a plaintext email and encrypted with the recipient’s public keys before being sent to Proton Mail clients. The only case in which the message is not encrypted by the server before being sent to the client is if the message begins with a valid ASCII-armored PGP message. In this case, the PGP message is used directly and any subsequent plaintext is discarded. This ensures that all emails sent to the clients are encrypted and cannot be a mixture of plaintext and ciphertext.

When a message is opened, the Proton Mail client attempts to decrypt the entire PGP message from the server using the recipient’s private keys. If decryption succeeds and the decrypted content contains any additional encrypted content, the client will never attempt to decrypt this “nested” content. Therefore, an attempted attack of this type would merely result in the encrypted text being sent in the HTTP request path (which, according to the attack parameters, the attacker would have already), and only if the user chose to load remote content, which is always disabled by default. Additionally, because Proton Mail’s clients never do any “nested” decryption, it would be impossible for Proton Mail’s servers to launch this type of attack.

#### Malleability Gadget Exfiltration Channel Attack

The “malleability gadget exfiltration channel” attack relies on the fact that due to the malleability of Cipher Feedback Mode (CFB), the mode of encryption used by OpenPGP, knowledge of some of a ciphertext’s decrypted content can allow an attacker to inject malicious content into the ciphertext itself.

This attack is circumvented by the use of the Symmetrically Encrypted with Integrity Protection (SEIP) OpenPGP packet for storing encrypted data, which Proton Mail has always used for encrypted emails sent between Proton Mail users, and which is used by the vast majority of modern PGP clients. When data is encrypted with this packet type, the plaintext data that is about to be encrypted is hashed and stored in a Modification Detection Code (MDC) packet. During the decryption process, the decrypted data is hashed and compared with the result stored in the MDC packet. If the results are not equal, this is treated by all of Proton Mail’s OpenPGP libraries as a decryption failure, and clients will not load the decrypted content.

The paper brings up three methods by which integrity protection could be defeated. The first and second, Ignoring the MDC and Stripping the MDC, are not feasible in Proton Mail’s clients because our cryptography libraries would treat these scenarios as decryption failures. The third method is for the attacker to change an SEIP packet into a Symmetrically Encrypted packet, which is an obsolete OpenPGP packet with no modification detection capabilities.

This is the minor exception that we mentioned previously. While this can be construed as a vulnerability in the OpenPGP standard, the solution is easy (drop support for this obsolete packet type). The open-source library used by our web application, OpenPGP.js, is not vulnerable to this attack because it already does not allow the use of Symmetrically Encrypted packets with any AES ciphers, which are the only ciphers supported for symmetric encryption by Proton Mail and most PGP clients. Even without this, Proton Mail users are protected from this attack because Proton Mail servers disallow all OpenPGP packets of the Symmetrically Encrypted type from all mail.

### The Future of PGP

**PGP remains to this day, the best way for encrypting emails, and if implemented properly, is both secure and reliable.** While Proton Mail was not impacted by the recent PGP implementation vulnerabilities, we recognize that as the leaders in this space, we also need to play a part in ensuring that other PGP implementations are also secure. In pursuit of this goal, and as part of our responsibilities as the [maintainers of OpenPGPjs](/blog/openpgpjs-3-release), we are doing the following:

First, we are dropping support of the obsolete Symmetrically Encrypted packet type when OpenPGPjs is used with default options. As OpenPGPjs is one of the world’s most widely used OpenPGP libraries (powering popular plugins such as [Enigmail(new window)](https://www.enigmail.net/index.php/en/), [Mailvelope(new window)](https://www.mailvelope.com/en), and many others), this will help to protect the PGP ecosystem from Malleability Gadget Exfiltration Channel Attacks in the future.

Secondly, we will continue to push forward Authenticated Encryption. Authenticated encryption with associated data (AEAD) is a form of encryption that provides confidentiality, integrity, and authenticity guarantees on data, evading any attack of the types described in the paper. The Efail paper erroneously claims that “there were efforts to introduce authenticated encryption in OpenPGP which are, however, expired.” This is untrue, as there is currently a [working draft for AEAD support in OpenPGP(new window)](https://tools.ietf.org/html/draft-ietf-openpgp-rfc4880bis-04), which has been gaining significant traction in the security community. We have also recently completed a full implementation of [AEAD in OpenPGP.js(new window)](https://github.com/openpgpjs/openpgpjs/releases/tag/v3.0.9) which is currently undergoing a third party security audit.

As the world’s largest secure email provider, we take security very seriously and will continue to innovate to ensure that your data remains secure and private, both today and in the future.

For the official statement from the maintainers of GNUPG, another common PGP software, please [see here(new window)](https://lists.gnupg.org/pipermail/gnupg-users/2018-May/060334.html).

*The above analysis includes contributions from Sanjana Rajan, Bart Butler, Andy Yen, Daniel Huigens and Yanfeng Zhang from the Proton Mail team.*

***Sign up and get a [free encrypted email(new window)](/mail/pricing) account from Proton Mail.***

***We also provide a*** [***free VPN service***(new window)](https://protonvpn.com/free-vpn/) ***to protect your privacy.***

   Protect your privacy with Proton[Create a free account](/pricing)

Share this page

* [![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1712065300%2Fstatic%2Fsocial%2Fx-widestroke-gray_f2ti5x.svg)(new window)](https://twitter.com/share?url=https://proton.me/blog/pgp-vulnerability-efail&text=PGP is not broken, not even with the Efail vulnerabilities&via=ProtonPrivacy)
* [![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1711363892%2Fstatic%2Fsocial%2Freddit-gray.svg)(new window)](https://www.reddit.com/submit?url=https://proton.me/blog/pgp-vulnerability-efail&title=PGP is not broken, not even with the Efail vulnerabilities)
* [![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1711363891%2Fstatic%2Fsocial%2Ffacebook-gray.svg)(new window)](https://www.facebook.com/sharer/sharer.php?u=https://proton.me/blog/pgp-vulnerability-efail&quote=PGP is not broken, not even with the Efail vulnerabilities)
* [![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1711363892%2Fstatic%2Fsocial%2Flinkedin-gray.svg)(new window)](https://www.linkedin.com/shareArticle?url=https://proton.me/blog/pgp-vulnerability-efail&mini=true&title=PGP is not broken, not even with the Efail vulnerabilities&summary=Recently, news broke about potential vulnerabilities in PGP, dubbed Efail. However, despite reports to the contrary, PGP is not actually broken, as we will explain in this post.&source=Proton "PGP is not broken, not even with the Efail vulnerabilities")

  ![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fstatic%2Favatars%2FAndy_Yen_a53kbq.png)[Andy Yen](/blog/author/ayen)

Andy is the founder and CEO of Proton. He is a long-time advocate for privacy rights and has spoken at TED, Web Summit, and the United Nations about online privacy issues. Previously, Andy was a research scientist at CERN and has a PhD in particle physics from Harvard University.

## Related articles

![](https://pmecdn.protonweb.com/image-transformation/?s=c&image=images%2Ff_auto%2Cq_auto%2Fv1737754349%2Fwp-pme%2F2025_privacy_predictions_blog_cover2x%2F2025_privacy_predictions_blog_cover2x.png%3F_i%3DAA)Jan 24, 2025

* Opinion
[Our predictions for the internet in 2025](/blog/2025-internet-predictions)See our predictions for the internet in 2025, from AI cyberattacks to DIY
surveillance.![he cover image for a blog explaining how to see and manage your saved passwords easily in Proton Pass](https://pmecdn.protonweb.com/image-transformation/?s=c&image=images%2Ff_auto%2Cq_auto%2Fv1737727752%2Fwp-pme%2Fhow-to-view-saved-passwords-easily%2Fhow-to-view-saved-passwords-easily.png%3F_i%3DAA)Jan 24, 2025

* Privacy guides
[How to view your saved passwords easily — and privately](/blog/saved-passwords)Saving passwords in a password manager can help you stay safe online, but how
can you see all your saved passwords in one place? Find out with Proton Pass.![Email password 101: Fully secure your inbox with 2 simple tools](https://pmecdn.protonweb.com/image-transformation/?s=c&image=images%2Ff_auto%2Cq_auto%2Fv1737690339%2Fwp-pme%2Femail_password101_blog_cover%2Femail_password101_blog_cover.png%3F_i%3DAA)Jan 24, 2025

* Privacy guides
[Email password 101: Fully secure your inbox with 2 simple solutions](/blog/email-password)Learn how to secure your email password and inbox with strong passwords, 2FA,
passkeys, and tips to prevent data breaches and unauthorized access.![The cover image for a Proton Pass blog about advanced email aliases](https://pmecdn.protonweb.com/image-transformation/?s=c&image=images%2Ff_auto%2Cq_auto%2Fv1737627935%2Fwp-pme%2Fblog_cover_reverse_alias_management2x%2Fblog_cover_reverse_alias_management2x.png%3F_i%3DAA)Jan 23, 2025

* Product updates
* Proton Pass
[Organize your inbox and banish spam with advanced email aliases in Proton Pass](/blog/benefits-of-email-aliases)Your email aliases can send emails, save you money on hosting services, and help
you manage multiple inboxes: find out how![TikTok ban: Switching to RedNote? Your privacy is at stake.](https://pmecdn.protonweb.com/image-transformation/?s=c&image=images%2Ff_auto%2Cq_auto%2Fv1737126366%2Fwp-pme%2Ftiktok_ban_ver01_blog_cover_8173649d47%2Ftiktok_ban_ver01_blog_cover_8173649d47.png%3F_i%3DAA)Jan 17, 2025

* Privacy news
[TikTok ban: Switching to RedNote? Your privacy is at stake.](/blog/tiktok-ban-rednote-privacy-concerns)As the treat of a TikTok ban looms, many U.S. users are flocking to a new TikTok
alternative called RedNote. But should they be?![Big Tech's annual fines (the cash in red) are dwarfed by its annual free cash flow](https://pmecdn.protonweb.com/image-transformation/?s=c&image=images%2Ff_auto%2Cq_auto%2Fv1737033282%2Fwp-pme%2Fbig_tech_fines2024_blog_cover2x%2Fbig_tech_fines2024_blog_cover2x.png%3F_i%3DAA)Jan 17, 2025

* Privacy news
[Big Tech earns enough in less than 3 weeks to pay all 2024 fines](/blog/big-tech-pays-fines-under-3-weeks)Big Tech fines reached more than $8 billion in 2024. Unfortunately, not even
this fine will give Big Tech pause. But progress is being made.    ![Proton](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1703162849%2Fstatic%2Flogos%2Ftexts%2Fproton-purple_lf83vr.svg)

Privacy by default

* [![X](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Fx.svg)(new window)](https://x.com/intent/user?screen_name=ProtonPrivacy)
* [![Reddit](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Freddit.svg)(new window)](https://www.reddit.com/r/ProtonMail/)
* [![Instagram](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Finstagram.svg)(new window)](https://www.instagram.com/protonprivacy/)
* [![Facebook](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Ffacebook.svg)(new window)](https://www.facebook.com/Proton)
* [![LinkedIn](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Flinkedin.svg)(new window)](https://www.linkedin.com/company/protonprivacy/)
* [![Mastodon](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Fmastodon.svg)(new window)](https://mastodon.social/%40protonprivacy)
* [![RSS](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Frss.svg)](/blog/feed)
* [![Threads](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Fthreads.svg)(new window)](https://www.threads.net/%40protonprivacy)
* [![WhatsApp](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Fwhatsapp.svg)(new window)](https://www.whatsapp.com/channel/0029VaErt8I4tRrjiU8eMd1U)
* [![Telegram](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Ftelegram.svg)(new window)](https://t.me/proton_privacy)
* [![UserVoice](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Fuservoice.svg)(new window)](https://protonmail.uservoice.com/)
* [![YouTube](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Fyoutube.svg)(new window)](https://www.youtube.com/%40ProtonAG?sub_confirmation=1)
* [![TikTok](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Ftiktok.svg)(new window)](https://www.tiktok.com/%40privacytok)
* [![Bluesky](https://pmecdn.protonweb.com/image-transformation/?s=c&image=image%2Fupload%2Fv1727943149%2Fstatic%2Fsocial%2Fsquare%2Fbluesky.svg)(new window)](https://bsky.app/profile/proton.me)

Proton AGRoute de la Galaise 32
1228 Plan-les-Ouates
Geneva, Switzerland

* ### Products
* Products
  + [Proton Mail](/mail)
  + [Proton Calendar](/calendar)
  + [Proton Drive](/drive)
  + [Proton VPN(new window)](https://protonvpn.com/?ref=pme_blog_b2c_proton_footer)
  + [Proton Pass](/pass)
  + [Proton Wallet](/wallet)
  + [Proton for Business](/business)
* ### Privacy and community
* Privacy and community
  + [Password generator](/pass/password-generator)
  + [Tor](/tor)
  + [Switch to Proton](/easyswitch)
  + [Community](/community)
  + [Open source](/community/open-source)
  + [Pricing](/pricing)
  + [Student discount](/student)
* ### Company
* Company
  + [About us](/about)
  + [Team](/about/team)
  + [Impact](/about/impact)
  + [Proton Foundation](/foundation)
  + [Careers We’re hiring](/careers)
  + [Shop(new window)](https://shop.proton.me)
* ### Connect
* Connect
  + [Blog](/blog)
  + [Help and support](/support)
  + [Partners and affiliates](/partners)
  + [Press and media](/media)
  + [Contact us](/support/contact-product)

---

* [System status(new window)](https://status.proton.me)
* [Report abuse](/support/report-abuse)
* [Report a problem](/support/report-bug)
* [Report a security issue](/security/response-center)
* [Request a feature(new window)](https://protonmail.uservoice.com)

* [Privacy Policy](/legal/privacy)
* [Terms & conditions](/legal/terms)
* [Transparency report](/legal/transparency)
* © 2024 Proton AG. All rights reserved.


=== Content from news.ycombinator.com_199012a8_20250125_233150.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D17066419) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [tc](user?id=tc) [on May 14, 2018](item?id=17066419)   | [parent](item?id=17064129) | [context](context?id=17066419) | [favorite](fave?id=17066419&auth=52b1aa2f022157f0f70fd32a7a7f8a9568008a12) | on: [EFail – Vulnerabilities in end-to-end encryption t...](item?id=17064129)  Let's summarize the situation: Abstract: S/MIME and MUAs are broken. OpenPGP (with MDC) is not, but clients MUST check for GPG error codes. Use Mutt carefully or copy/paste into GPG for now. - Some mail clients concatenate all parts of a multipart message together, even joining partial HTML elements, allowing the decrypted plaintext of an OpenPGP or S/MIME encrypted part to be exfiltrated via an image tag. Mail clients shouldn't be doing this in any world, and can fix this straightforwardly. - S/MIME (RFC 5751) does not provide for authenticated encryption, so the ciphertext is trivially malleable. An attacker can use a CBC gadget to add the image tag into the ciphertext itself. We can't expect a mail client to avoid exfiltrating the plaintext in this case. S/MIME itself needs to be fixed (or abandoned). - OpenPGP (RFC 4880) provides for authenticated encryption (called "MDC", see sections 5.13 and 13.11 of the RFC) which would prevent a similar CFB-based gadget attack if enforced. GPG added this feature in 2000 or 2001. If the MDC tag is missing or invalid, GPG returns an error. If GPG is asked to write the plaintext as a file, it will refuse. When the output is directed to a pipe, it will write the output and return an error code [1]. An application such as an MUA using it in this manner must check for the error code before rendering or processing the result. It seems this requirement was not made clear enough to implementors. The mail clients need to release patches to check for this error. This will create an incompatibility with broken OpenPGP implementations that have not yet implemented MDC. - Even without clients enforcing or checking the authentication tag, it's a bit trickier to pull off the attack against OpenPGP because the plaintext may be compressed before encryption. The authors were still able to pull it off a reasonable percentage of the time. Section 14 of RFC 4880 actually describes a much earlier attack which was complicated in this same manner; it caused the OpenPGP authors to declare decompression errors as security errors. Net-net, using encrypted email with Mutt is safe [2, Table 4], though even there, opening HTML parts encrypted with S/MIME in a browser is not, and double-checking how it handles GPG errors would be prudent before forking a browser on any OpenPGP encrypted parts. See the paper for other unaffected clients, including Claws (as noted below) and K-9 Mail (which does not support S/MIME). Otherwise, it's probably best to copy and paste into GPG (check the error code or ask it to write to a file) until this is worked out. [1] [https://lists.gnupg.org/pipermail/gnupg-users/2018-May/06031...](https://lists.gnupg.org/pipermail/gnupg-users/2018-May/060315.html) [2] <https://efail.de/efail-attack-paper.pdf> | | --- | --- | --- |  | |  |  | [jwildeboer](user?id=jwildeboer) [on May 14, 2018](item?id=17069422)   | [next](#17066951) [–]  “If GPG is asked to write the plaintext as a file, it will refuse. When the output is directed to a pipe, it will write the output and return an error code” I honestly don’t care about the rationale, but this inconsistent behaviour is simply wrong. After 18 years of discussion, end this. Whenever DECRYPTION\_FAIL occurs, there MUST be no decrypted content. | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [dfabulich](user?id=dfabulich) [on May 14, 2018](item?id=17069716)   | [parent](#17069422) | [next](#17066951) [–]  That's not really compatible with piped output. The encrypted message can't be authenticated until it has been completely processed, but the whole point of piping is to output bytes as soon as they're available. Perhaps the moral of this story is to disable GPG's pipe feature? But it's a legitimate and significant performance improvement for authentic messages. You "just" have to remember to check the error code and it's fine/safe. Perhaps that's just too much to ask. Maybe we just can't have fast streaming decryption because it's too hard for client developers to use safely. But that point of view is at least not obvious. (On the other hand, what were you planning to do with the piped output in the first place? Probably render it, right? If GPG clients stream unauthenticated bytes into a high-performance HTML renderer, the result will surely be efail.) | | --- | --- | --- | | | |  |  | [tptacek](user?id=tptacek) [on May 14, 2018](item?id=17070307)   | [root](#17069422) | [parent](#17069716) | [next](#17070205) [–]  That is *not* the whole point of piping, and the default behavior of GPG should be to buffer, validate the MDC, and release plaintext only after it's been authenticated. Pipes are a standardized Unix interface between processes, not a solemn pledge to deliver bytes as quickly as possible. If pipes had the connotation you claim they do, *it would never be safe to pipe ciphertext*, because the whole goal of modern AEAD cryptography is never to release unauthenticated plaintext to callers. Clients encrypting whole ISO images should expect that decryption will require a non-default flag. Ideally, GPG would do two-pass decryption, first checking the MDC and then decrypting. Either way, the vast, commanding majority of all messages GPG ever processes --- in fact, that the PGP protocol processes --- should be buffered and checked. If you have a complaint about how unwieldy this process is, *your complaint is with the PGP protocol*. The researchers, and cryptographers in general, agree with you. | | --- | --- | --- | | | |  |  | [a3\_nm](user?id=a3_nm) [on May 15, 2018](item?id=17073384)   | [root](#17069422) | [parent](#17070307) | [next](#17070416) [–]  Is it so easy for GPG to buffer the cleartext while validating the MDC? As the cleartext may not fit in RAM, this means that GPG could need to write it to a temporary file, right? But then, if decryption is aborted messily (e.g., the machine loses power), then this means that GPG would be leaving a file with part of the cleartext behind, which has obvious security implications. You could also imagine a two-pass approach where you first verify and then decrypt, but then what about a timing attack where a process would be modifying the encrypted file between the two passes? It doesn't look so easy to solve this problem -- arguably the right way would be to change the design of the OpenPGP protocol, cf [https://www.imperialviolet.org/2014/06/27/streamingencryptio...](https://www.imperialviolet.org/2014/06/27/streamingencryption.html) | | --- | --- | --- | | | |  |  | [tptacek](user?id=tptacek) [on May 15, 2018](item?id=17074429)   | [root](#17069422) | [parent](#17073384) | [next](#17070416) [–]  Again, the cleartext virtually always fits trivially in RAM, and when it doesn't, it can error out and require a flag to process. Yes, this is easy to fix. OpenPGP needs to change as well, but that doesn't make insecure behavior acceptable in the interim, no matter what Werner Koch thinks. | | --- | --- | --- | | | |  |  | [dfabulich](user?id=dfabulich) [on May 14, 2018](item?id=17070416)   | [root](#17069422) | [parent](#17070307) | [prev](#17073384) | [next](#17070205) [–]  What *is* the point of piping, in your view? My understanding is that it's a stream of bytes with backpressure, designed specifically to minimize buffering (by pausing output when downstream receivers are full/busy). > If pipes had the connotation you claim they do, *it would never be safe to pipe ciphertext,* because the whole goal of modern AEAD cryptography is never to release unauthenticated plaintext to callers. You say that like it's a reductio ad absurdum, but I think that's essentially right; you can't do backpressure with unauthenticated ciphertext. You have to buffer the entire output to be sure that it's safe for further processing. Thus, if you want to buffer the entire output, don't use a pipe; ask the tool to generate a file, and then read the file only when the process says that the file is done and correct. (I'd say that's a lot more wieldy than two-pass decryption.) Based on your other remarks about PGP, (nuke it from orbit) I'm not sure you have any constructive remarks to make on how to improve GPG, but I guess making it two-pass by default (with a --dangerous-single-pass flag) would be an improvement. For normal size emails, users probably wouldn't notice the performance cost of the second pass, and clients who care about performance at that level can opt into single-pass decryption and just promise to check the error code. | | --- | --- | --- | | | |  |  | [tedunangst](user?id=tedunangst) [on May 15, 2018](item?id=17071112)   | [root](#17069422) | [parent](#17070416) | [next](#17070428) [–]  You know sort works with pipes, right? It doesn't squirt out mostly sorted output whenever it feels like it. | | --- | --- | --- | | | |  |  | [tptacek](user?id=tptacek) [on May 14, 2018](item?id=17070428)   | [root](#17069422) | [parent](#17070416) | [prev](#17071112) | [next](#17072877) [–]  Backpressure is a *feature* of Unix pipes. It isn't their raison d'être. I don't care how you implement it, but any claim that you can't check the MDC in GPG because it's a piped interface is obviously false. GPG can, like any number of Unix utilities, some casually written and some carefully written, simply buffer the data, process it, and write it. | | --- | --- | --- | | | |  |  | [dfabulich](user?id=dfabulich) [on May 15, 2018](item?id=17070533)   | [root](#17069422) | [parent](#17070428) | [next](#17072877) [–]  Nobody said "you can't check the MDC." Everybody said "you have to check GPG's error code." And I think it's clear to everybody (in this thread) that GPG's approach is a dangerous blame-the-user approach to API design, even granting that this dangerous approach offers optimum performance (especially relative to adding an entire second pass). | | --- | --- | --- | | | |  |  | [tptacek](user?id=tptacek) [on May 15, 2018](item?id=17070611)   | [root](#17069422) | [parent](#17070533) | [next](#17072877) [–]  There's no difference. You're talking about the program, I'm talking about the mechanism. Either way: \* GPG should never release unauthenticated plaintext to callers. The exit code is a red herring. \* Nothing about "pipes" prevents them from squelching unauthenticated plaintext. | | --- | --- | --- | | | |  |  | [JdeBP](user?id=JdeBP) [on May 15, 2018](item?id=17072877)   | [root](#17069422) | [parent](#17070416) | [prev](#17070428) | [next](#17070205) [–]  You are getting your concepts confused. Pipes are one thing, but the concept at hand is in fact *filters*, programs that primarily read data from their standard inputs and write other (processed) data to their standard outputs. What pipes involve is a red herring, because filters do not necessitate pipes. *Filters* have no requirements that they write output whilst there is still input to be read, and several well-known filter programs indeed do not do that. | | --- | --- | --- | | | |  |  | [loup-vaillant](user?id=loup-vaillant) [on May 14, 2018](item?id=17070205)   | [root](#17069422) | [parent](#17069716) | [prev](#17070307) | [next](#17072766) [–]  This is why I initially hesitated to implement a streaming interface for my crypto library¹ (authenticated encryption and signatures). I eventually did it, but felt compelled to sprinkle the manual with warnings about how streaming interfaces encourage the processing of unauthenticated messages. Now that we have a vulnerability with a name, I think I can make those warning even scarier. I'll update that manual. [1]: <https://monocypher.org/> | | --- | --- | --- | | | |  |  | [tome](user?id=tome) [on May 15, 2018](item?id=17072766)   | [root](#17069422) | [parent](#17069716) | [prev](#17070205) | [next](#17066951) [–]  Isn't it possible to adjust any existing authentication scheme to authenticate block-by-block? | | --- | --- | --- | | | |  |  | [orivej](user?id=orivej) [on May 14, 2018](item?id=17066951)   | [prev](#17069422) | [next](#17069814) [–]  > Use Mutt carefully or copy/paste into GPG for now. According to [1], Claws Mail is also unaffected. I don't know if it was tested with or without its HTML plugin, but this should make no difference as long as the plugin is not configured to access remote resources. (By default it can not make network requests.) [https://twitter.com/matthew\_d\_green/status/99599862678571417...](https://twitter.com/matthew_d_green/status/995998626785714177) | | --- | --- | --- | | | |  |  | [mirimir](user?id=mirimir) [on May 14, 2018](item?id=17069814)   | [prev](#17066951) | [next](#17068507) [–]  OK, so Thunderbird plus Enigmail is probably most popular in Linux. And according to Robert J. Hansen:[0] > By default, GnuPG will scream bloody murder if a message lacks an MDC or if the MDC is invalid. At that point it's up to your email client to pay attention to the warning and do the right thing. Enigmail 2.0 and later are fine, but I can't speak for other systems. So if you use Enigmail, do make sure that you're not at v1.99. Just get the add-on in Thunderbird. Also, of course, make sure that external resources aren't being fetched. 0) [https://lists.gnupg.org/pipermail/gnupg-users/2018-May/06032...](https://lists.gnupg.org/pipermail/gnupg-users/2018-May/060321.html) Edit: Oh, but damn. There's more in that thread. Enigmail >v2 can be forced to decrypt with MDC missing.[1] And this is a gpg bug:[2] > ... and Patrick, moving faster than the speed of light, already has the bug triaged and bounced back. This is actually a GnuPG bug, not an Enigmail bug. ... However:[3] > It's worth noting, incidentally, the #Efail attack flat-out requires MIME. So inline PGP messages are not vulnerable, as there's no MIME parsing pass which can be exploited. So you're *still* safe, although this is still a bug that should be fixed. ;) I also saw something about it requiring HTML decoding, but can't find it again :( 1) [https://lists.gnupg.org/pipermail/gnupg-users/2018-May/06032...](https://lists.gnupg.org/pipermail/gnupg-users/2018-May/060325.html) 2) [https://lists.gnupg.org/pipermail/gnupg-users/2018-May/06032...](https://lists.gnupg.org/pipermail/gnupg-users/2018-May/060329.html) 3) [https://lists.gnupg.org/pipermail/gnupg-users/2018-May/06032...](https://lists.gnupg.org/pipermail/gnupg-users/2018-May/060328.html) More: Yes, disable HTML rendering. In Thunderbird, select "/ View / Message Body As / Plain Text". And:[4] > The EFAIL attacks break PGP and S/MIME email encryption by coercing clients into sending the full plaintext of the emails to the attacker. In a nutshell, EFAIL abuses active content of HTML emails, for example externally loaded images or styles, to exfiltrate plaintext through requested URLs. To create these exfiltration channels, the attacker first needs access to the encrypted emails, for example, by eavesdropping on network traffic, compromising email accounts, email servers, backup systems or client computers. The emails could even have been collected years ago. So basically, 1) the attacker embeds a link to the encrypted message, 2) the email client fetches and decrypts it, and then 3) sends plaintext back to the attacker. 4) [https://lists.cpunks.org/pipermail/cypherpunks/2018-May/0421...](https://lists.cpunks.org/pipermail/cypherpunks/2018-May/042194.html) | | --- | --- | --- | | | |  |  | [ms7821b](user?id=ms7821b) [on May 15, 2018](item?id=17071981)   | [parent](#17069814) | [next](#17068507) [–]  > So basically, 1) the attacker embeds a link to the encrypted message, 2) the email client fetches and decrypts it, and then 3) sends plaintext back to the attacker. What? The attacker embeds secure content inside a link, not a link to the content. It could come from files stored in a public place or emails. | | --- | --- | --- | | | |  |  | [mirimir](user?id=mirimir) [on May 15, 2018](item?id=17077128)   | [root](#17069814) | [parent](#17071981) | [next](#17068507) [–]  Thanks. | | --- | --- | --- | | | |  |  | [FrantaH](user?id=FrantaH) [on May 14, 2018](item?id=17068507)   | [prev](#17069814) [–]  Check RFC2634 before you abandon S/MIME. Triple wrapping solves surreptitious forwarding, which is how this attack works. Sadly AFAIK it's implemented only in Trustedbird. | | --- | --- | --- | | |
| |  | | --- |   [Consider applying for YC's Spring batch! Applications are open till Feb 11.](https://www.ycombinator.com/apply/) [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |


