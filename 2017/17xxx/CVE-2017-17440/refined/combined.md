=== Content from security-tracker.debian.org_2622e4f3_20250126_025242.html ===

# CVE-2017-15922

| **Name** | CVE-2017-15922 |
| --- | --- |
| **Description** | In GNU Libextractor 1.4, there is an out-of-bounds read in the EXTRACTOR\_dvi\_extract\_method function in plugins/dvi\_extractor.c. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2017-15922) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2017-15922); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2017-15922), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2017-15922), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2017-15922), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2017-15922), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-15922), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2017-15922), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2017-15922), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2017-15922)/[CVE](https://www.suse.com/security/cve/CVE-2017-15922/), GitHub [advisories](https://github.com/advisories?query=CVE-2017-15922)/[code](https://github.com/search?type=Code&q=%22CVE-2017-15922%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2017-15922%22), [web search](https://duckduckgo.com/html?q=%22CVE-2017-15922%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DLA-1198-1](/tracker/DLA-1198-1) |
| **Debian Bugs** | [880016](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=880016) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [libextractor](/tracker/source-package/libextractor) ([PTS](https://tracker.debian.org/pkg/libextractor)) | bullseye | 1:1.11-2 | fixed |
|  | bookworm | 1:1.11-7 | fixed |
|  | sid, trixie | 1:1.13-8 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [libextractor](/tracker/source-package/libextractor) | source | wheezy | 1:0.6.3-5+deb7u1 |  | [DLA-1198-1](/tracker/DLA-1198-1) |  |
| [libextractor](/tracker/source-package/libextractor) | source | jessie | 1:1.3-2+deb8u1 |  |  |  |
| [libextractor](/tracker/source-package/libextractor) | source | stretch | 1:1.3-4+deb9u1 |  |  |  |
| [libextractor](/tracker/source-package/libextractor) | source | (unstable) | 1:1.6-2 | low |  | [880016](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=880016) |

## Notes

```
<http://lists.gnu.org/archive/html/bug-libextractor/2017-10/msg00008.html>
Fixed by: <https://git.gnunet.org/libextractor.git/commit/?id=d4d488b0e5ab13dda241d688d87a07816368f117>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from lists.gnu.org_26221868_20250124_185210.html ===


| | **bug-libextractor** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-libextractor)

---

[[Date Prev](msg00001.html)][[Date Next](msg00003.html)][[Thread Prev](msg00001.html)][[Thread Next](msg00003.html)][[Date Index](index.html#00002)][[Thread Index](threads.html#00002)]

## [bug-libextractor] NULL Pointer Dereference vulneribility in libextracto

---

| **From**: | Leon Zhao |
| --- | --- |

| **Subject**: | [bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_sid\_extract\_method |
| **Date**: | Wed, 1 Nov 2017 14:22:50 +0800 |

---

**Tested Version:**libextractor v1.6
**Tested System:**Linux leon-virtual-machine 4.10.0-35-generic #39~16.04.1-Ubuntu SMP Wed Sep 13 09:02:42 UTC 2017 x86\_64 x86\_64 x86\_64 GNU/Linux
**Details:**In function EXTRACTOR\_sid\_extract\_method at sid\_extractor.cÂ Â 179Â  Â if (sizeof (struct header) >Â 180Â  Â  Â  Â ec->read (ec->cls,Â 181Â  Â  Â  Â  Â  Â  Â  Â  Â &data,Â 182Â  Â  Â  Â  Â  Â  Â  Â  Â sizeof (struct header)))Â 183Â  Â  Â return;Â 184Â  Â head = data;Â 185Â Â 186Â  Â /\* Check "magic" id bytes \*/Â 187Â  Â if ( (0 != memcmp (head->magicid, "PSID", 4)) &&Â 188Â  Â  Â  Â  (0 != memcmp (head->magicid, "RSID", 4)) )Â 189Â  Â  Â return;Â 190Â Â 191Â  Â /\* Mime-type \*/Â 192Â  Â ADD ("audio/prs.sid", EXTRACTOR\_METATYPE\_MIMETYPE);ec->read function set data to NULL.Â **Crash Information:**The output with address sanitizer enabled./extract -i extract.EXTRACTOR\_sid\_extract\_method.sid\_extractor.187.crashÂ Keywords for file extract.EXTRACTOR\_sid\_extract\_method.sid\_extractor.187.crash:ASAN:SIGSEGV===================================================================41155==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7f047403cfe4 bp 0x7ffd91e2f930 sp 0x7ffd91e2f0b8 T0)Â  Â  #0 0x7f047403cfe3Â  (/lib/x86\_64-linux-gnu/libc.so.6+0x16efe3)Â  Â  #1 0x7f047456b74e in memcmp (/usr/lib/x86\_64-linux-gnu/libasan.so.2+0x7774e)Â  Â  #2 0x7f046c67ef93 in EXTRACTOR\_sid\_extract\_method /root/libextractor-1.6/src/plugins/sid\_extractor.c:187Â  Â  #3 0x7f04742b49a1 in do\_extract /root/libextractor-1.6/src/main/extractor.c:583Â  Â  #4 0x7f04742b4db5 in EXTRACTOR\_extract /root/libextractor-1.6/src/main/extractor.c:662Â  Â  #5 0x4044f9 in main /root/libextractor-1.6/src/main/extract.c:983Â  Â  #6 0x7f0473eee82f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2082f)Â  Â  #7 0x4017c8 in \_start (/opt/asan/bin/extract+0x4017c8)
AddressSanitizer can not provide additional info.SUMMARY: AddressSanitizer: SEGV ??:0 ??==41155==ABORTING
**CREDIT**Zhao Liang, Huawei Weiran Labs
Attachment is POC file

**[![Attachment:](/icons/binary.png)](binCAY7f6xMIZ.bin)
[extract.EXTRACTOR\_sid\_extract\_method.sid\_extractor.187.crash](binCAY7f6xMIZ.bin)**

*Description:* Binary data

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_sid\_extract\_method**,
  *Leon Zhao* **<=**

---

* Prev by Date:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_s3m\_extract\_method](msg00001.html)**
* Next by Date:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor with invalid check of DGifGetExtension](msg00003.html)**
* Previous by thread:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_s3m\_extract\_method](msg00001.html)**
* Next by thread:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor with invalid check of DGifGetExtension](msg00003.html)**
* Index(es):
  + [**Date**](index.html#00002)
  + [**Thread**](threads.html#00002)



=== Content from lists.gnu.org_d853955b_20250124_185210.html ===


| | **bug-libextractor** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-libextractor)

---

[[Date Prev](msg00003.html)][[Date Next](msg00005.html)][[Thread Prev](msg00003.html)][[Thread Next](msg00005.html)][[Date Index](index.html#00004)][[Thread Index](threads.html#00004)]

## [bug-libextractor] NULL Pointer Dereference vulneribility in libextracto

---

| **From**: | Leon Zhao |
| --- | --- |

| **Subject**: | [bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_xm\_extract\_method |
| **Date**: | Wed, 1 Nov 2017 14:28:45 +0800 |

---

**Tested Version:**libextractor v1.6
**Tested System:**Linux leon-virtual-machine 4.10.0-35-generic #39~16.04.1-Ubuntu SMP Wed Sep 13 09:02:42 UTC 2017 x86\_64 x86\_64 x86\_64 GNU/Linux
**Details:**In function EXTRACTOR\_xm\_extract\_method at xm\_extractor.cÂ Â 73Â  Â if (sizeof (struct Header) >Â 74Â  Â  Â  Â ec->read (ec->cls,Â 75Â  Â  Â  Â  Â  Â  Â  Â  Â &data,Â 76Â  Â  Â  Â  Â  Â  Â  Â  Â sizeof (struct Header)))Â 77Â  Â  Â return;Â 78Â  Â head = data;Â 79Â  Â /\* Check "magic" id bytes \*/Â 80Â  Â if (memcmp (head->magicid, "Extended Module: ", 17))Â 81Â  Â  Â return;Â 82Â  Â ADD("audio/x-xm", EXTRACTOR\_METATYPE\_MIMETYPE);ec->read function set data to NULL.Â **Crash Information:**The output with address sanitizer enabled./extract -i extract.EXTRACTOR\_xm\_extract\_method.xm\_extractor.80.crashÂ Keywords for file extract.EXTRACTOR\_xm\_extract\_method.xm\_extractor.80.crash:ASAN:SIGSEGV===================================================================24253==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7f30231c2051 bp 0x7ffc95c6e700 sp 0x7ffc95c6de88 T0)Â  Â  #0 0x7f30231c2050Â  (/lib/x86\_64-linux-gnu/libc.so.6+0x16f050)Â  Â  #1 0x7f30236f074e in memcmp (/usr/lib/x86\_64-linux-gnu/libasan.so.2+0x7774e)Â  Â  #2 0x7f301bc86def in EXTRACTOR\_xm\_extract\_method /root/libextractor-1.6/src/plugins/xm\_extractor.c:80Â  Â  #3 0x7f30234399a1 in do\_extract /root/libextractor-1.6/src/main/extractor.c:583Â  Â  #4 0x7f3023439db5 in EXTRACTOR\_extract /root/libextractor-1.6/src/main/extractor.c:662Â  Â  #5 0x4044f9 in main /root/libextractor-1.6/src/main/extract.c:983Â  Â  #6 0x7f302307382f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2082f)Â  Â  #7 0x4017c8 in \_start (/opt/asan/bin/extract+0x4017c8)
AddressSanitizer can not provide additional info.SUMMARY: AddressSanitizer: SEGV ??:0 ??==24253==ABORTING
**CREDIT**Zhao Liang, Huawei Weiran Labs
Attachment is POC file

**[![Attachment:](/icons/binary.png)](binuMGdAQi3JW.bin)
[extract.EXTRACTOR\_xm\_extract\_method.xm\_extractor.80.crash](binuMGdAQi3JW.bin)**

*Description:* Binary data

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [[Next in Thread](msg00005.html)] |
| --- | --- | --- |

* **[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_xm\_extract\_method**,
  *Leon Zhao* **<=**
  + **[Re: [bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_xm\_extract\_method](msg00005.html)**, *Christian Grothoff*, 2017/11/01

---

* Prev by Date:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor with invalid check of DGifGetExtension](msg00003.html)**
* Next by Date:
  **[Re: [bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_xm\_extract\_method](msg00005.html)**
* Previous by thread:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor with invalid check of DGifGetExtension](msg00003.html)**
* Next by thread:
  **[Re: [bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_xm\_extract\_method](msg00005.html)**
* Index(es):
  + [**Date**](index.html#00004)
  + [**Thread**](threads.html#00004)



=== Content from security-tracker.debian.org_62133d6b_20250126_025242.html ===

# CVE-2017-17440

| **Name** | CVE-2017-17440 |
| --- | --- |
| **Description** | GNU Libextractor 1.6 allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via a crafted GIF, IT (Impulse Tracker), NSFE, S3M (Scream Tracker 3), SID, or XM (eXtended Module) file, as demonstrated by the EXTRACTOR\_xm\_extract\_method function in plugins/xm\_extractor.c. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2017-17440) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2017-17440); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2017-17440), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2017-17440), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2017-17440), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2017-17440), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-17440), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2017-17440), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2017-17440), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2017-17440)/[CVE](https://www.suse.com/security/cve/CVE-2017-17440/), GitHub [advisories](https://github.com/advisories?query=CVE-2017-17440)/[code](https://github.com/search?type=Code&q=%22CVE-2017-17440%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2017-17440%22), [web search](https://duckduckgo.com/html?q=%22CVE-2017-17440%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [883528](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=883528) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [libextractor](/tracker/source-package/libextractor) ([PTS](https://tracker.debian.org/pkg/libextractor)) | bullseye | 1:1.11-2 | fixed |
|  | bookworm | 1:1.11-7 | fixed |
|  | sid, trixie | 1:1.13-8 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [libextractor](/tracker/source-package/libextractor) | source | jessie | 1:1.3-2+deb8u1 |  |  |  |
| [libextractor](/tracker/source-package/libextractor) | source | stretch | 1:1.3-4+deb9u1 |  |  |  |
| [libextractor](/tracker/source-package/libextractor) | source | (unstable) | 1:1.6-2 |  |  | [883528](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=883528) |

## Notes

```
[wheezy] - libextractor <no-dsa> (Minor issue)
Fixed by: <https://git.gnunet.org/libextractor.git/commit/?id=7cc63b001ceaf81143795321379c835486d0c92e>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from gnunet.org_a009aecc_20250124_185209.html ===


| [cgit logo](/) | Public GNU Git Repositories at gnunet.org |
| --- | --- |
| Source code of various GNU packages |

| [index](/) |  |
| --- | --- |

| [Name](/?s=name) | [Description](/?s=desc) | [Idle](/?s=idle) | Links |
| --- | --- | --- | --- |
| GNU Anastasis (key escrow and recovery) | | | |
| [anastasis-gtk.git](/anastasis-gtk.git/) | [Demonstrator GUI for Anastasis](/anastasis-gtk.git/) | 11 days | [summary](/anastasis-gtk.git/)[log](/anastasis-gtk.git/log/)[tree](/anastasis-gtk.git/tree/) |
| [anastasis-mobile.git](/anastasis-mobile.git/) | [Anastasis Client App for Android (experimental)](/anastasis-mobile.git/) |  | [summary](/anastasis-mobile.git/)[log](/anastasis-mobile.git/log/)[tree](/anastasis-mobile.git/tree/) |
| [anastasis-www.git](/anastasis-www.git/) | [Anastasis.lu Website](/anastasis-www.git/) | 7 days | [summary](/anastasis-www.git/)[log](/anastasis-www.git/log/)[tree](/anastasis-www.git/tree/) |
| [anastasis.git](/anastasis.git/) | [Credential backup and recovery protocol and service](/anastasis.git/) | 6 days | [summary](/anastasis.git/)[log](/anastasis.git/log/)[tree](/anastasis.git/tree/) |
| [frosix.git](/frosix.git/) | [Multiparty signature service (experimental)](/frosix.git/) | 11 days | [summary](/frosix.git/)[log](/frosix.git/log/)[tree](/frosix.git/tree/) |
| GNU Taler Deployment | | | |
| [ansible-taler-exchange.git](/ansible-taler-exchange.git/) | [Ansible playbook to deploy a production Taler Exchange](/ansible-taler-exchange.git/) | 3 days | [summary](/ansible-taler-exchange.git/)[log](/ansible-taler-exchange.git/log/)[tree](/ansible-taler-exchange.git/tree/) |
| [sandcastle-ng.git](/sandcastle-ng.git/) | [Scripts for the deployment of Sandcastle (GNU Taler)](/sandcastle-ng.git/) | 3 days | [summary](/sandcastle-ng.git/)[log](/sandcastle-ng.git/log/)[tree](/sandcastle-ng.git/tree/) |
| [taler-deployment.git](/taler-deployment.git/) | [Deployment scripts and configuration files](/taler-deployment.git/) | 23 hours | [summary](/taler-deployment.git/)[log](/taler-deployment.git/log/)[tree](/taler-deployment.git/tree/) |
| GNU Taler Documentation | | | |
| [bafin.git](/bafin.git/) | [System documentation for regulators](/bafin.git/) | 11 days | [summary](/bafin.git/)[log](/bafin.git/log/)[tree](/bafin.git/tree/) |
| [erp-integration-spec.git](/erp-integration-spec.git/) | [ERP integration specification](/erp-integration-spec.git/) | 7 days | [summary](/erp-integration-spec.git/)[log](/erp-integration-spec.git/log/)[tree](/erp-integration-spec.git/tree/) |
| [large-media.git](/large-media.git/) | [Large media files, largely user interface design documents/ideas/studies](/large-media.git/) | 11 days | [summary](/large-media.git/)[log](/large-media.git/log/)[tree](/large-media.git/tree/) |
| [marketing.git](/marketing.git/) | [Marketing materials (presentations, posters, flyers)](/marketing.git/) | 2 days | [summary](/marketing.git/)[log](/marketing.git/log/)[tree](/marketing.git/tree/) |
| [taler-code-examples.git](/taler-code-examples.git/) | [Reference examples (sample code)](/taler-code-examples.git/) | 11 days | [summary](/taler-code-examples.git/)[log](/taler-code-examples.git/log/)[tree](/taler-code-examples.git/tree/) |
| [taler-docs.git](/taler-docs.git/) | [Documentation for GNU Taler components, APIs and protocols](/taler-docs.git/) | 33 hours | [summary](/taler-docs.git/)[log](/taler-docs.git/log/)[tree](/taler-docs.git/tree/) |
| [taler-lectures.git](/taler-lectures.git/) | [Lectures related to GNU Taler](/taler-lectures.git/) | 11 days | [summary](/taler-lectures.git/)[log](/taler-lectures.git/log/)[tree](/taler-lectures.git/tree/) |
| [taler-ops-www.git](/taler-ops-www.git/) | [Source code for taler-ops.ch](/taler-ops-www.git/) | 6 days | [summary](/taler-ops-www.git/)[log](/taler-ops-www.git/log/)[tree](/taler-ops-www.git/tree/) |
| [taler-systems-www.git](/taler-systems-www.git/) | [Source code for taler-systems.com](/taler-systems-www.git/) | 7 days | [summary](/taler-systems-www.git/)[log](/taler-systems-www.git/log/)[tree](/taler-systems-www.git/tree/) |
| [taler-tutorial-videos.git](/taler-tutorial-videos.git/) | [Tutorial Videos](/taler-tutorial-videos.git/) | 11 days | [summary](/taler-tutorial-videos.git/)[log](/taler-tutorial-videos.git/log/)[tree](/taler-tutorial-videos.git/tree/) |
| [taler-tutorials.git](/taler-tutorials.git/) | [Tutorials](/taler-tutorials.git/) | 4 days | [summary](/taler-tutorials.git/)[log](/taler-tutorials.git/log/)[tree](/taler-tutorials.git/tree/) |
| [taler-www.git](/taler-www.git/) | [Main taler.net website](/taler-www.git/) | 11 days | [summary](/taler-www.git/)[log](/taler-www.git/log/)[tree](/taler-www.git/tree/) |
| GNU Taler Extensions and Integrations | | | |
| [cash2ecash.git](/cash2ecash.git/) | [cash2ecash: cash acceptor that issues digital cash](/cash2ecash.git/) | 7 days | [summary](/cash2ecash.git/)[log](/cash2ecash.git/log/)[tree](/cash2ecash.git/tree/) |
| [cashless2ecash.git](/cashless2ecash.git/) | [cashless2ecash: pay with cards for digital cash](/cashless2ecash.git/) | 11 days | [summary](/cashless2ecash.git/)[log](/cashless2ecash.git/log/)[tree](/cashless2ecash.git/tree/) |
| [depolymerization.git](/depolymerization.git/) | [wire gateway for Bitcoin/Ethereum](/depolymerization.git/) | 11 days | [summary](/depolymerization.git/)[log](/depolymerization.git/log/)[tree](/depolymerization.git/tree/) |
| [ekyc.git](/ekyc.git/) | [Electronic KYC process with uploading ID document using OAuth 2.1 (experimental)](/ekyc.git/) | 11 days | [summary](/ekyc.git/)[log](/ekyc.git/log/)[tree](/ekyc.git/tree/) |
| [gnu-taler-payment-for-joomla-payage.git](/gnu-taler-payment-for-joomla-payage.git/) | [Integration of GNU Taler payments into Joomla! e-commerce framework](/gnu-taler-payment-for-joomla-payage.git/) | 11 days | [summary](/gnu-taler-payment-for-joomla-payage.git/)[log](/gnu-taler-payment-for-joomla-payage.git/log/)[tree](/gnu-taler-payment-for-joomla-payage.git/tree/) |
| [gnu-taler-payment-for-magento.git](/gnu-taler-payment-for-magento.git/) | [Adobe Commerce (Magento) plugin to enable payments with GNU Taler](/gnu-taler-payment-for-magento.git/) | 11 days | [summary](/gnu-taler-payment-for-magento.git/)[log](/gnu-taler-payment-for-magento.git/log/)[tree](/gnu-taler-payment-for-magento.git/tree/) |
| [gnu-taler-payment-for-woocommerce.git](/gnu-taler-payment-for-woocommerce.git/) | [WooCommerce plugin to enable payments with GNU Taler](/gnu-taler-payment-for-woocommerce.git/) | 11 days | [summary](/gnu-taler-payment-for-woocommerce.git/)[log](/gnu-taler-payment-for-woocommerce.git/log/)[tree](/gnu-taler-payment-for-woocommerce.git/tree/) |
| [taler-mdb.git](/taler-mdb.git/) | [GNU Taler Extensions and Integrations](/taler-mdb.git/) | 11 days | [summary](/taler-mdb.git/)[log](/taler-mdb.git/log/)[tree](/taler-mdb.git/tree/) |
| [taler-merchant-demos.git](/taler-merchant-demos.git/) | [Python-based Frontends for the Demonstration Web site](/taler-merchant-demos.git/) | 11 days | [summary](/taler-merchant-demos.git/)[log](/taler-merchant-demos.git/log/)[tree](/taler-merchant-demos.git/tree/) |
| GNU Taler System | | | |
| [build-common.git](/build-common.git/) | [Shared build system code (usually as a git submodule)](/build-common.git/) | 11 days | [summary](/build-common.git/)[log](/build-common.git/log/)[tree](/build-common.git/tree/) |
| [challenger.git](/challenger.git/) | [OAuth 2.0-based authentication service that validates user can receive messages ...](/challenger.git/) | 23 hours | [summary](/challenger.git/)[log](/challenger.git/log/)[tree](/challenger.git/tree/) |
| [donau.git](/donau.git/) | [Donation authority for GNU Taler (experimental)](/donau.git/) | 31 hours | [summary](/donau.git/)[log](/donau.git/log/)[tree](/donau.git/tree/) |
| [exchange.git](/exchange.git/) | [Base system with REST service to issue digital coins, run by the payment service...](/exchange.git/) | 6 hours | [summary](/exchange.git/)[log](/exchange.git/log/)[tree](/exchange.git/tree/) |
| [libeufin.git](/libeufin.git/) | [Integration and sandbox testing for FinTech APIs and data formats](/libeufin.git/) | 6 hours | [summary](/libeufin.git/)[log](/libeufin.git/log/)[tree](/libeufin.git/tree/) |
| [merchant.git](/merchant.git/) | [Merchant backend to process payments, run by merchants](/merchant.git/) | 23 hours | [summary](/merchant.git/)[log](/merchant.git/log/)[tree](/merchant.git/tree/) |
| [quickjs-tart.git](/quickjs-tart.git/) | [quickjs-based runtime for wallet-core logic](/quickjs-tart.git/) | 11 days | [summary](/quickjs-tart.git/)[log](/quickjs-tart.git/log/)[tree](/quickjs-tart.git/tree/) |
| [sync.git](/sync.git/) | [Backup service to store encrypted wallet databases (experimental)](/sync.git/) | 23 hours | [summary](/sync.git/)[log](/sync.git/log/)[tree](/sync.git/tree/) |
| [taldir.git](/taldir.git/) | [Directory service to resolve wallet mailboxes by messenger addresses](/taldir.git/) | 9 hours | [summary](/taldir.git/)[log](/taldir.git/log/)[tree](/taldir.git/tree/) |
| [taler-android.git](/taler-android.git/) | [Android apps for GNU Taler (wallet, PoS, cashier)](/taler-android.git/) | 30 hours | [summary](/taler-android.git/)[log](/taler-android.git/log/)[tree](/taler-android.git/tree/) |
| [taler-assets.git](/taler-assets.git/) | [Shared resources (icons) for user interfaces](/taler-assets.git/) | 11 days | [summary](/taler-assets.git/)[log](/taler-assets.git/log/)[tree](/taler-assets.git/tree/) |
| [taler-go.git](/taler-go.git/) | [Utility functions in Go language](/taler-go.git/) | 11 days | [summary](/taler-go.git/)[log](/taler-go.git/log/)[tree](/taler-go.git/tree/) |
| [taler-ios.git](/taler-ios.git/) | [iOS apps for GNU Taler (wallet)](/taler-ios.git/) | 11 days | [summary](/taler-ios.git/)[log](/taler-ios.git/log/)[tree](/taler-ios.git/tree/) |
| [taler-mailbox.git](/taler-mailbox.git/) | [Service for asynchronous wallet-to-wallet payment messages](/taler-mailbox.git/) | 11 days | [summary](/taler-mailbox.git/)[log](/taler-mailbox.git/log/)[tree](/taler-mailbox.git/tree/) |
| [taler-rpm.git](/taler-rpm.git/) | [Specifications for RPM packages (experimental)](/taler-rpm.git/) | 3 months | [summary](/taler-rpm.git/)[log](/taler-rpm.git/log/)[tree](/taler-rpm.git/tree/) |
| [taler-rust.git](/taler-rust.git/) | [GNU Taler code in Rust. Largely core banking integrations.](/taler-rust.git/) | 26 hours | [summary](/taler-rust.git/)[log](/taler-rust.git/log/)[tree](/taler-rust.git/tree/) |
| [taler-typescript-core.git](/taler-typescript-core.git/) | [Wallet core logic and WebUIs for various components](/taler-typescript-core.git/) | 3 days | [summary](/taler-typescript-core.git/)[log](/taler-typescript-core.git/log/)[tree](/taler-typescript-core.git/tree/) |
| [twister.git](/twister.git/) | [HTTP fault injector for testing](/twister.git/) | 11 days | [summary](/twister.git/)[log](/twister.git/log/)[tree](/twister.git/tree/) |
| [wallet-testdata.git](/wallet-testdata.git/) | [Wallet database snapshots for migration testing](/wallet-testdata.git/) | 11 days | [summary](/wallet-testdata.git/)[log](/wallet-testdata.git/log/)[tree](/wallet-testdata.git/tree/) |
| GNU libextractor | | | |
| [libextractor-java.git](/libextractor-java.git/) | [GNU libextractor](/libextractor-java.git/) | 3 years | [summary](/libextractor-java.git/)[log](/libextractor-java.git/log/)[tree](/libextractor-java.git/tree/) |
| [libextractor-mono.git](/libextractor-mono.git/) | [GNU libextractor](/libextractor-mono.git/) | 3 years | [summary](/libextractor-mono.git/)[log](/libextractor-mono.git/log/)[tree](/libextractor-mono.git/tree/) |

* [[1]](/ "Page 1")
* [[2]](/?ofs=50 "Page 2")
* [[3]](/?ofs=100 "Page 3")

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.39.1](https://git-scm.com/)) at 2025-01-24 18:50:38 +0000



=== Content from bugs.debian.org_d6f0937b_20250124_185207.html ===

# Debian Bug report logs - #883528 libextractor: CVE-2017-17440: various null pointer dereferences in GIF, IT, NSFE, S3M, SID and XM plugins

[![version graph](version.cgi?fixed=libextractor%2F1%3A1.6-2;width=2;package=src%3Alibextractor;collapse=1;height=2;found=libextractor%2F1%3A1.6-1;absolute=0)](version.cgi?fixed=libextractor%2F1%3A1.6-2;info=1;package=src%3Alibextractor;collapse=1;absolute=0;found=libextractor%2F1%3A1.6-1)

Package:
[src:libextractor](pkgreport.cgi?src=libextractor);
Maintainer for [src:libextractor](pkgreport.cgi?src=libextractor) is [Debian QA Group <packages@qa.debian.org>](pkgreport.cgi?maint=packages%40qa.debian.org);

Reported by: [Markus Koschany <apo@debian.org>](pkgreport.cgi?submitter=apo%40debian.org)

Date: Mon, 4 Dec 2017 19:15:01 UTC

Severity: important

Tags: fixed-upstream, security, upstream

Found in version libextractor/1:1.6-1

Fixed in version libextractor/1:1.6-2

**Done:** Bertrand Marc <bmarc@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=883528;mbox=yes), [status mbox](bugreport.cgi?bug=883528;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=883528;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, apo@debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Bertrand Marc <bmarc@debian.org>`:

`Bug#883528`; Package `src:libextractor`.
(Mon, 04 Dec 2017 19:15:04 GMT) ([full text](bugreport.cgi?bug=883528;msg=2), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Markus Koschany <apo@debian.org>`:

New Bug report received and forwarded. Copy sent to `apo@debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Bertrand Marc <bmarc@debian.org>`.
(Mon, 04 Dec 2017 19:15:04 GMT) ([full text](bugreport.cgi?bug=883528;msg=4), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=883528;msg=5), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=apo%40debian.org)
From: Markus Koschany <apo@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: libextractor: CVE-2017-15600 and CVE-2017-15602 are not completely fixed
Date: Mon, 04 Dec 2017 20:13:38 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=883528;msg=5) (text/plain, inline)]
```
```
Package: src:libextractor
Version: 1:1.6-1
Severity: important
Tags: security

Hi,

while I was working on the security update for Wheezy I discovered
that libextractor in Buster/Sid is still vulnerable to [CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600)
and [CVE-2017-15602](https://security-tracker.debian.org/tracker/CVE-2017-15602). I could reproduce two segmentation faults with the
provided POCs. They are attached to the upstream bug report:

<http://lists.gnu.org/archive/html/bug-libextractor/2017-10/msg00004.html>
<http://lists.gnu.org/archive/html/bug-libextractor/2017-10/msg00005.html>

Just run "extract -i $POC"

I'm attaching my gdb log files to this bug report.

Regards,

Markus

-- System Information:
Debian Release: buster/sid
  APT prefers unstable-debug
  APT policy: (500, 'unstable-debug'), (500, 'unstable'), (1, 'experimental')
Architecture: amd64 (x86_64)

Kernel: Linux 4.13.0-1-amd64 (SMP w/2 CPU cores)
Locale: LANG=en_GB.UTF-8, LC_CTYPE=en_GB.UTF-8 (charmap=UTF-8), LANGUAGE=en_GB.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: unable to detect

```
```
[[CVE-2017-15600_gdb.txt](bugreport.cgi?att=1;bug=883528;filename=CVE-2017-15600_gdb.txt;msg=5) (text/plain, attachment)]
```
```
[[CVE-2017-15602_gdb.txt](bugreport.cgi?att=2;bug=883528;filename=CVE-2017-15602_gdb.txt;msg=5) (text/plain, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Bertrand Marc <bmarc@debian.org>`:

`Bug#883528`; Package `src:libextractor`.
(Mon, 04 Dec 2017 19:30:03 GMT) ([full text](bugreport.cgi?bug=883528;msg=7), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Bertrand Marc <bmarc@debian.org>`.
(Mon, 04 Dec 2017 19:30:04 GMT) ([full text](bugreport.cgi?bug=883528;msg=9), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 883528@bugs.debian.org ([full text](bugreport.cgi?bug=883528;msg=10), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Markus Koschany <apo@debian.org>, 883528@bugs.debian.org
Cc: Debian Security Team <team@security.debian.org>
Subject: Re: Bug#883528: libextractor: CVE-2017-15600 and CVE-2017-15602 are
not completely fixed
Date: Mon, 4 Dec 2017 20:27:13 +0100
```
Hi Markus,

On Mon, Dec 04, 2017 at 08:13:38PM +0100, Markus Koschany wrote:
> Package: src:libextractor
> Version: 1:1.6-1
> Severity: important
> Tags: security
>
> Hi,
>
> while I was working on the security update for Wheezy I discovered
> that libextractor in Buster/Sid is still vulnerable to [CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600)
> and [CVE-2017-15602](https://security-tracker.debian.org/tracker/CVE-2017-15602). I could reproduce two segmentation faults with the
> provided POCs. They are attached to the upstream bug report:
>
> <http://lists.gnu.org/archive/html/bug-libextractor/2017-10/msg00004.html>
> <http://lists.gnu.org/archive/html/bug-libextractor/2017-10/msg00005.html>
>
> Just run "extract -i $POC"
>
> I'm attaching my gdb log files to this bug report.

Since the issues happen in different places from the original reports,
can you request two new CVEs for those issues?

So for tracking purposes these are two new raised issues, different
from [CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600) and [CVE-2017-15602](https://security-tracker.debian.org/tracker/CVE-2017-15602) and would possibly require two
new ones. Can you as well report it to upstream in case Bertrand
cannot cime in?

In case not let me know, and I can take care of it tomorrow.

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Bertrand Marc <bmarc@debian.org>`:

`Bug#883528`; Package `src:libextractor`.
(Mon, 04 Dec 2017 19:57:05 GMT) ([full text](bugreport.cgi?bug=883528;msg=12), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Bertrand Marc <bmarc@debian.org>`.
(Mon, 04 Dec 2017 19:57:05 GMT) ([full text](bugreport.cgi?bug=883528;msg=14), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 883528@bugs.debian.org ([full text](bugreport.cgi?bug=883528;msg=15), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 883528@bugs.debian.org
Cc: Markus Koschany <apo@debian.org>,
Debian Security Team <team@security.debian.org>
Subject: Re: Bug#883528: libextractor: CVE-2017-15600 and CVE-2017-15602 are
not completely fixed
Date: Mon, 4 Dec 2017 20:53:01 +0100
```
Hi

On Mon, Dec 04, 2017 at 08:27:13PM +0100, Salvatore Bonaccorso wrote:
> Hi Markus,
>
> On Mon, Dec 04, 2017 at 08:13:38PM +0100, Markus Koschany wrote:
> > Package: src:libextractor
> > Version: 1:1.6-1
> > Severity: important
> > Tags: security
> >
> > Hi,
> >
> > while I was working on the security update for Wheezy I discovered
> > that libextractor in Buster/Sid is still vulnerable to [CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600)
> > and [CVE-2017-15602](https://security-tracker.debian.org/tracker/CVE-2017-15602). I could reproduce two segmentation faults with the
> > provided POCs. They are attached to the upstream bug report:
> >
> > <http://lists.gnu.org/archive/html/bug-libextractor/2017-10/msg00004.html>
> > <http://lists.gnu.org/archive/html/bug-libextractor/2017-10/msg00005.html>
> >
> > Just run "extract -i $POC"
> >
> > I'm attaching my gdb log files to this bug report.
>
> Since the issues happen in different places from the original reports,
> can you request two new CVEs for those issues?
>
> So for tracking purposes these are two new raised issues, different
> from [CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600) and [CVE-2017-15602](https://security-tracker.debian.org/tracker/CVE-2017-15602) and would possibly require two
> new ones. Can you as well report it to upstream in case Bertrand
> cannot cime in?
>
> In case not let me know, and I can take care of it tomorrow.

Interestignly the issues you describe does not seem triggerable with a
fresh build of 1.6 in sid (with --enable-shared=no,
--enable-static=yes with -O0).

sid:~/libextractor-1.6# ./src/main/extract -i ~/1338044
Keywords for file /root/1338044:
sid:~/libextractor-1.6# ./src/main/extract -i ~/bin_6iRW3tXve.bin
Keywords for file /root/bin_6iRW3tXve.bin:
sid:~/libextractor-1.6#

and neither with current HEAD (6c70420641fc1d081bcecf323671ca169b13a129).

It is though with the Debian package (re)build. What is different?

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Bertrand Marc <bmarc@debian.org>`:

`Bug#883528`; Package `src:libextractor`.
(Mon, 04 Dec 2017 20:09:05 GMT) ([full text](bugreport.cgi?bug=883528;msg=17), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Bertrand Marc <bmarc@debian.org>`.
(Mon, 04 Dec 2017 20:09:05 GMT) ([full text](bugreport.cgi?bug=883528;msg=19), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 883528@bugs.debian.org ([full text](bugreport.cgi?bug=883528;msg=20), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 883528@bugs.debian.org
Cc: Markus Koschany <apo@debian.org>,
Debian Security Team <team@security.debian.org>
Subject: Re: Bug#883528: libextractor: CVE-2017-15600 and CVE-2017-15602 are
not completely fixed
Date: Mon, 4 Dec 2017 21:05:46 +0100
```
And additionally the results from an ASAN build:

For the one related to the [CVE-2017-15000](https://security-tracker.debian.org/tracker/CVE-2017-15000) reproducer:

root@sid:~# extract -i extract-nsf_extract_method-nsf_extractor-164.crash
Keywords for file extract-nsf_extract_method-nsf_extractor-164.crash:
xm_extractor.c:80:7: runtime error: null pointer passed as argument 1, which is declared to never be null
ASAN:DEADLYSIGNAL
=================================================================
==22442==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000008 (pc 0x7f916bdf6d06 bp 0x7ffd356d46c0 sp 0x7ffd356d4520 T0)
==22442==The signal is caused by a READ memory access.
==22442==Hint: address points to the zero page.
    #0 0x7f916bdf6d05 in EXTRACTOR_xm_extract_method (/usr/lib/x86_64-linux-gnu/libextractor/libextractor_xm.so+0x1d05)
    #1 0x7f917a6d709c  (/usr/lib/x86_64-linux-gnu/libextractor.so.3+0x3209c)
    #2 0x7f917a6d85d3 in EXTRACTOR_extract (/usr/lib/x86_64-linux-gnu/libextractor.so.3+0x335d3)
    #3 0x403892  (/usr/bin/extract+0x403892)
    #4 0x7f91793fa560 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x20560)
    #5 0x404ce9  (/usr/bin/extract+0x404ce9)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV (/usr/lib/x86_64-linux-gnu/libextractor/libextractor_xm.so+0x1d05) in EXTRACTOR_xm_extract_method
==22442==ABORTING
root@sid:~#

for the one related to the [CVE-2017-15602](https://security-tracker.debian.org/tracker/CVE-2017-15602) reproducer:

root@sid:~# extract -i bin_6iRW3tXve.bin
Keywords for file bin_6iRW3tXve.bin:
=================================================================
==22470==ERROR: AddressSanitizer: negative-size-param: (size=-8)
    #0 0x7fb94e64279b  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x7679b)
    #1 0x7fb93ba7be6c  (/usr/lib/x86_64-linux-gnu/libgme.so.0+0x8e6c)
    #2 0x7fb93ba7bc89  (/usr/lib/x86_64-linux-gnu/libgme.so.0+0x8c89)
    #3 0x7fb93ba9f231  (/usr/lib/x86_64-linux-gnu/libgme.so.0+0x2c231)
    #4 0x7fb93ba9f5f2  (/usr/lib/x86_64-linux-gnu/libgme.so.0+0x2c5f2)
    #5 0x7fb93ba7f94d  (/usr/lib/x86_64-linux-gnu/libgme.so.0+0xc94d)
    #6 0x7fb93ba7eb7b in gme_load_data (/usr/lib/x86_64-linux-gnu/libgme.so.0+0xbb7b)
    #7 0x7fb93ba7ec33 in gme_open_data (/usr/lib/x86_64-linux-gnu/libgme.so.0+0xbc33)
    #8 0x7fb93f2be581  (/usr/lib/x86_64-linux-gnu/libavformat.so.57+0xbc581)
    #9 0x7fb93f3ad16f in avformat_open_input (/usr/lib/x86_64-linux-gnu/libavformat.so.57+0x1ab16f)
    #10 0x7fb93f8ece71 in EXTRACTOR_previewopus_extract_method (/usr/lib/x86_64-linux-gnu/libextractor/libextractor_previewopus.so+0x4e71)
    #11 0x7fb94e39b09c  (/usr/lib/x86_64-linux-gnu/libextractor.so.3+0x3209c)
    #12 0x7fb94e39c5d3 in EXTRACTOR_extract (/usr/lib/x86_64-linux-gnu/libextractor.so.3+0x335d3)
    #13 0x403892  (/usr/bin/extract+0x403892)
    #14 0x7fb94d0be560 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x20560)
    #15 0x404ce9  (/usr/bin/extract+0x404ce9)

0x61600000789e is located 30 bytes inside of 482-byte region [0x616000007880,0x616000007a62)
allocated by thread T0 here:
    #0 0x7fb94e6a6758 in __interceptor_posix_memalign (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xda758)
    #1 0x7fb93f68c782 in av_malloc (/usr/lib/x86_64-linux-gnu/libavutil.so.55+0x31782)

SUMMARY: AddressSanitizer: negative-size-param (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x7679b)
==22470==ABORTING
root@sid:~#

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Bertrand Marc <bmarc@debian.org>`:

`Bug#883528`; Package `src:libextractor`.
(Mon, 04 Dec 2017 21:00:05 GMT) ([full text](bugreport.cgi?bug=883528;msg=22), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent**
to `Markus Koschany <apo@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Bertrand Marc <bmarc@debian.org>`.
(Mon, 04 Dec 2017 21:00:05 GMT) ([full text](bugreport.cgi?bug=883528;msg=24), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 883528@bugs.debian.org ([full text](bugreport.cgi?bug=883528;msg=25), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=apo%40debian.org)
From: Markus Koschany <apo@debian.org>
To: Salvatore Bonaccorso <carnil@debian.org>
Cc: 883528@bugs.debian.org, Debian Security Team <team@security.debian.org>
Subject: Re: Bug#883528: libextractor: CVE-2017-15600 and CVE-2017-15602 are
not completely fixed
Date: Mon, 4 Dec 2017 21:56:27 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=883528;msg=25) (text/plain, inline)]
```
```
Am 04.12.2017 um 20:53 schrieb Salvatore Bonaccorso:
> Hi
>
> On Mon, Dec 04, 2017 at 08:27:13PM +0100, Salvatore Bonaccorso wrote:
>> Hi Markus,
>>
>> On Mon, Dec 04, 2017 at 08:13:38PM +0100, Markus Koschany wrote:
>>> Package: src:libextractor
>>> Version: 1:1.6-1
>>> Severity: important
>>> Tags: security
>>>
>>> Hi,
>>>
>>> while I was working on the security update for Wheezy I discovered
>>> that libextractor in Buster/Sid is still vulnerable to [CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600)
>>> and [CVE-2017-15602](https://security-tracker.debian.org/tracker/CVE-2017-15602). I could reproduce two segmentation faults with the
>>> provided POCs. They are attached to the upstream bug report:
>>>
>>> <http://lists.gnu.org/archive/html/bug-libextractor/2017-10/msg00004.html>
>>> <http://lists.gnu.org/archive/html/bug-libextractor/2017-10/msg00005.html>
>>>
>>> Just run "extract -i $POC"
>>>
>>> I'm attaching my gdb log files to this bug report.
>>
>> Since the issues happen in different places from the original reports,
>> can you request two new CVEs for those issues?
>>
>> So for tracking purposes these are two new raised issues, different
>> from [CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600) and [CVE-2017-15602](https://security-tracker.debian.org/tracker/CVE-2017-15602) and would possibly require two
>> new ones. Can you as well report it to upstream in case Bertrand
>> cannot cime in?
>>
>> In case not let me know, and I can take care of it tomorrow.
>
> Interestignly the issues you describe does not seem triggerable with a
> fresh build of 1.6 in sid (with --enable-shared=no,
> --enable-static=yes with -O0).
>
> sid:~/libextractor-1.6# ./src/main/extract -i ~/1338044
> Keywords for file /root/1338044:
> sid:~/libextractor-1.6# ./src/main/extract -i ~/bin_6iRW3tXve.bin
> Keywords for file /root/bin_6iRW3tXve.bin:
> sid:~/libextractor-1.6#
>
> and neither with current HEAD (6c70420641fc1d081bcecf323671ca169b13a129).
>
> It is though with the Debian package (re)build. What is different?

I can still reproduce it when I rebuild the package. If you disable
optimization with -O0 some compiler behaviors will change. I don't know
the details but what is undefined behavior with -O2 is somehow OK with
-O0. I just wanted to forward this upstream but if you say that it is
not reproducible with upstream HEAD, it's probably pointless.

Maybe we should wait for the next release which will also fix
[CVE-2017-15922](https://security-tracker.debian.org/tracker/CVE-2017-15922) or Bertrand could package the latest Git snapshot? Shall
I remove the fixed versions for both CVE in the security tracker?

Regards,

Markus

```
```
[[signature.asc](bugreport.cgi?att=1;bug=883528;filename=signature.asc;msg=25) (application/pgp-signature, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Bertrand Marc <bmarc@debian.org>`:

`Bug#883528`; Package `src:libextractor`.
(Mon, 04 Dec 2017 21:21:02 GMT) ([full text](bugreport.cgi?bug=883528;msg=27), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=27), [link](#26)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Bertrand Marc <bmarc@debian.org>`.
(Mon, 04 Dec 2017 21:21:03 GMT) ([full text](bugreport.cgi?bug=883528;msg=29), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 883528@bugs.debian.org ([full text](bugreport.cgi?bug=883528;msg=30), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Markus Koschany <apo@debian.org>, 883528@bugs.debian.org
Cc: Debian Security Team <team@security.debian.org>
Subject: Re: Bug#883528: libextractor: CVE-2017-15600 and CVE-2017-15602 are
not completely fixed
Date: Mon, 4 Dec 2017 22:17:09 +0100
```
Hi Markus,

On Mon, Dec 04, 2017 at 09:56:27PM +0100, Markus Koschany wrote:
> Am 04.12.2017 um 20:53 schrieb Salvatore Bonaccorso:
> > Hi
> >
> > On Mon, Dec 04, 2017 at 08:27:13PM +0100, Salvatore Bonaccorso wrote:
> >> Hi Markus,
> >>
> >> On Mon, Dec 04, 2017 at 08:13:38PM +0100, Markus Koschany wrote:
> >>> Package: src:libextractor
> >>> Version: 1:1.6-1
> >>> Severity: important
> >>> Tags: security
> >>>
> >>> Hi,
> >>>
> >>> while I was working on the security update for Wheezy I discovered
> >>> that libextractor in Buster/Sid is still vulnerable to [CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600)
> >>> and [CVE-2017-15602](https://security-tracker.debian.org/tracker/CVE-2017-15602). I could reproduce two segmentation faults with the
> >>> provided POCs. They are attached to the upstream bug report:
> >>>
> >>> <http://lists.gnu.org/archive/html/bug-libextractor/2017-10/msg00004.html>
> >>> <http://lists.gnu.org/archive/html/bug-libextractor/2017-10/msg00005.html>
> >>>
> >>> Just run "extract -i $POC"
> >>>
> >>> I'm attaching my gdb log files to this bug report.
> >>
> >> Since the issues happen in different places from the original reports,
> >> can you request two new CVEs for those issues?
> >>
> >> So for tracking purposes these are two new raised issues, different
> >> from [CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600) and [CVE-2017-15602](https://security-tracker.debian.org/tracker/CVE-2017-15602) and would possibly require two
> >> new ones. Can you as well report it to upstream in case Bertrand
> >> cannot cime in?
> >>
> >> In case not let me know, and I can take care of it tomorrow.
> >
> > Interestignly the issues you describe does not seem triggerable with a
> > fresh build of 1.6 in sid (with --enable-shared=no,
> > --enable-static=yes with -O0).
> >
> > sid:~/libextractor-1.6# ./src/main/extract -i ~/1338044
> > Keywords for file /root/1338044:
> > sid:~/libextractor-1.6# ./src/main/extract -i ~/bin_6iRW3tXve.bin
> > Keywords for file /root/bin_6iRW3tXve.bin:
> > sid:~/libextractor-1.6#
> >
> > and neither with current HEAD (6c70420641fc1d081bcecf323671ca169b13a129).
> >
> > It is though with the Debian package (re)build. What is different?
>
> I can still reproduce it when I rebuild the package. If you disable
> optimization with -O0 some compiler behaviors will change. I don't know
> the details but what is undefined behavior with -O2 is somehow OK with
> -O0. I just wanted to forward this upstream but if you say that it is
> not reproducible with upstream HEAD, it's probably pointless.

Well, need to further properly investigate that. It was just a quick
ASAN build of the current head. From my reply in
<https://bugs.debian.org/883528#20> it might actually be that the second
issue is not an upstream one but. Please note that I misstyped the
CVEs.

> Maybe we should wait for the next release which will also fix
> [CVE-2017-15922](https://security-tracker.debian.org/tracker/CVE-2017-15922) or Bertrand could package the latest Git snapshot?

Yes, for [CVE-2017-15922](https://security-tracker.debian.org/tracker/CVE-2017-15922) either works, cherry-pick the commit, wait for
the new upstream release or package the latest git snapshot.

> Shall
> I remove the fixed versions for both CVE in the security tracker?

Please not. The first issue is actually a different one (happening
with same reproducer for [CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600), but in a different place,
unless I'm completely mistaken. So [CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600) should be kept
associated with the 38e8933539ee9d044057b18a971c2eae3c21aba7 commit
and track your finding as separate issue.

For the issue reproduced with the [CVE-2017-1560](https://security-tracker.debian.org/tracker/CVE-2017-1560)2-reproducing file,
after beeing fixed with ffab889c1710c7646af9ed360c796a2a0a619efc
triggers a new issue, which is possibly in libgm or
libavformat.so/ffmpeg. So still not sure if the uncovered issue is in
src:libextractor.

See the ASAN traces from <https://bugs.debian.org/883528#20>

Thanks for your work on the libextractor update and triaging.

Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Bertrand Marc <bmarc@debian.org>`:

`Bug#883528`; Package `src:libextractor`.
(Wed, 06 Dec 2017 14:57:05 GMT) ([full text](bugreport.cgi?bug=883528;msg=32), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=32), [link](#31)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Bertrand Marc <bmarc@debian.org>`.
(Wed, 06 Dec 2017 14:57:05 GMT) ([full text](bugreport.cgi?bug=883528;msg=34), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=34), [link](#33)).

---

[Message #35](#35) received at 883528@bugs.debian.org ([full text](bugreport.cgi?bug=883528;msg=35), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=35), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 883528@bugs.debian.org
Cc: Markus Koschany <apo@debian.org>,
Debian Security Team <team@security.debian.org>
Subject: Re: Bug#883528: libextractor: CVE-2017-15600 and CVE-2017-15602 are
not completely fixed
Date: Wed, 6 Dec 2017 15:52:57 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=883528;msg=35) (text/plain, inline)]
```
```
Control: clone -1 -2
Control: retitle -1 libextractor: various null pointer dereferences in GIF, IT, NSFE, S3M, SID and XM plugins
Control: tags -1 + upstream fixed-upstream
Control: retitle -2 libextractor: extractor segfault (AddressSanitizer: negative-size-param: (size=-8)), issue in game-music-emu?

Hello Markus

So here are the results

The first issue is fixed in HEAD already, different from
[CVE-2017-15600](https://security-tracker.debian.org/tracker/CVE-2017-15600) and the fixing commit is

<https://gnunet.org/git/libextractor.git/commit/?id=7cc63b001ceaf81143795321379c835486d0c92e>

The issue this time lies in EXTRACTOR_xm_extract_method with the reproducer
file, but the commit fixes several similar issues in other plugins.

# ./src/main/extract -i ~/poc-1.crash
Keywords for file /root/poc-1.crash:
ASAN:DEADLYSIGNAL
=================================================================
==31921==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7f91b5d1c761 bp 0x7ffca14b9fb0 sp 0x7ffca14b9708 T0)
==31921==The signal is caused by a READ memory access.
==31921==Hint: address points to the zero page.
    #0 0x7f91b5d1c760  (/lib/x86_64-linux-gnu/libc.so.6+0x14b760)
    #1 0x7f91b645865b  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xab65b)
    #2 0x7f91a8da2d80 in EXTRACTOR_xm_extract_method /root/libextractor/src/plugins/xm_extractor.c:80
    #3 0x7f91b61983e7 in do_extract /root/libextractor/src/main/extractor.c:583
    #4 0x7f91b6198824 in EXTRACTOR_extract /root/libextractor/src/main/extractor.c:662
    #5 0x55edee351d69 in main /root/libextractor/src/main/extract.c:983
    #6 0x7f91b5bf1560 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x20560)
    #7 0x55edee34ebe9 in _start (/root/libextractor/src/main/.libs/extract+0x3be9)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV (/lib/x86_64-linux-gnu/libc.so.6+0x14b760)
==31921==ABORTING

here is the bisect log:

# broken: [bc2a59d25b35b0e88dab8895cf70b4d18d2844fc] release v1.6
git bisect broken bc2a59d25b35b0e88dab8895cf70b4d18d2844fc
# fixed: [6c70420641fc1d081bcecf323671ca169b13a129] fix misc NULL pointer exceptions
git bisect fixed 6c70420641fc1d081bcecf323671ca169b13a129
# broken: [d4d488b0e5ab13dda241d688d87a07816368f117] detect integer overflow in DVI extractor
git bisect broken d4d488b0e5ab13dda241d688d87a07816368f117
# fixed: [7cc63b001ceaf81143795321379c835486d0c92e] fix misc NULL pointer exceptions
git bisect fixed 7cc63b001ceaf81143795321379c835486d0c92e
# first fixed commit: [7cc63b001ceaf81143795321379c835486d0c92e] fix misc NULL pointer exceptions

The commit fixes several NULL pointer issues in plugins, one of those
is the XM plugin causing the issue. MITRE might want to assing here
individual CVEs or only one for the whole commit. I will ask.

But there are basically the reported ones in

<https://lists.gnu.org/archive/html/bug-libextractor/2017-11/msg00004.html>
<https://lists.gnu.org/archive/html/bug-libextractor/2017-11/msg00002.html>
<https://lists.gnu.org/archive/html/bug-libextractor/2017-11/msg00001.html>
<https://lists.gnu.org/archive/html/bug-libextractor/2017-11/msg00000.html>

and as well reported as fixed in

<https://lists.gnu.org/archive/html/bug-libextractor/2017-11/msg00005.html>

The second issue is still present in master
(6c70420641fc1d081bcecf323671ca169b13a129) but I'm again not sure this is
actually an issue in libextractor. This might need to be clarified with
upstream which have more insigts. Issue in game-music-emu? The ASAN trace:

# ./src/main/extract -i ~/poc-2.crash
Keywords for file /root/poc-2.crash:
=================================================================
==10520==ERROR: AddressSanitizer: negative-size-param: (size=-8)
    #0 0x7f658a1e879b  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x7679b)
    #1 0x7f6578af2e6c  (/usr/lib/x86_64-linux-gnu/libgme.so.0+0x8e6c)
    #2 0x7f6578af2c89  (/usr/lib/x86_64-linux-gnu/libgme.so.0+0x8c89)
    #3 0x7f6578b16231  (/usr/lib/x86_64-linux-gnu/libgme.so.0+0x2c231)
    #4 0x7f6578b165f2  (/usr/lib/x86_64-linux-gnu/libgme.so.0+0x2c5f2)
    #5 0x7f6578af694d  (/usr/lib/x86_64-linux-gnu/libgme.so.0+0xc94d)
    #6 0x7f6578af5b7b in gme_load_data (/usr/lib/x86_64-linux-gnu/libgme.so.0+0xbb7b)
    #7 0x7f6578af5c33 in gme_open_data (/usr/lib/x86_64-linux-gnu/libgme.so.0+0xbc33)
    #8 0x7f657c335581  (/usr/lib/x86_64-linux-gnu/libavformat.so.57+0xbc581)
    #9 0x7f657c42416f in avformat_open_input (/usr/lib/x86_64-linux-gnu/libavformat.so.57+0x1ab16f)
    #10 0x7f657c963420 in extract_audio /root/libextractor/src/plugins/previewopus_extractor.c:893
    #11 0x7f657c964441 in EXTRACTOR_previewopus_extract_method /root/libextractor/src/plugins/previewopus_extractor.c:1159
    #12 0x7f6589f5d3e7 in do_extract /root/libextractor/src/main/extractor.c:583
    #13 0x7f6589f5d824 in EXTRACTOR_extract /root/libextractor/src/main/extractor.c:662
    #14 0x55c628ff7d69 in main /root/libextractor/src/main/extract.c:983
    #15 0x7f65899b6560 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x20560)
    #16 0x55c628ff4be9 in _start (/root/libextractor/src/main/.libs/extract+0x3be9)

0x616000007b9e is located 30 bytes inside of 482-byte region [0x616000007b80,0x616000007d62)
allocated by thread T0 here:
    #0 0x7f658a24c758 in __interceptor_posix_memalign (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xda758)
    #1 0x7f657c703782 in av_malloc (/usr/lib/x86_64-linux-gnu/libavutil.so.55+0x31782)

SUMMARY: AddressSanitizer: negative-size-param (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x7679b)
==10520==ABORTING

When building you need to specify --with-plugindirname, if not installed,
otherwise the plugins cannot be loaded when running the test.

Attaching the two reproducing files.

Regards,
Salvatore

```
```
[[poc-1.crash](bugreport.cgi?att=1;bug=883528;filename=poc-1.crash;msg=35) (application/octet-stream, attachment)]
```
```
[[poc-2.crash](bugreport.cgi?att=2;bug=883528;filename=poc-2.crash;msg=35) (application/octet-stream, attachment)]
```

---

**Bug [883528](bugreport.cgi?bug=883528) cloned as bug [883691](bugreport.cgi?bug=883691)**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `883528-submit@bugs.debian.org`.
(Wed, 06 Dec 2017 14:57:05 GMT) ([full text](bugreport.cgi?bug=883528;msg=37), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=37), [link](#36)).

---

**Changed Bug title to 'libextractor: various null pointer dereferences in GIF, IT, NSFE, S3M, SID and XM plugins' from 'libextractor: CVE-2017-15600 and CVE-2017-15602 are not completely fixed'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `883528-submit@bugs.debian.org`.
(Wed, 06 Dec 2017 14:57:06 GMT) ([full text](bugreport.cgi?bug=883528;msg=39), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=39), [link](#38)).

---

**Added tag(s) fixed-upstream and upstream.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `883528-submit@bugs.debian.org`.
(Wed, 06 Dec 2017 14:57:07 GMT) ([full text](bugreport.cgi?bug=883528;msg=41), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=41), [link](#40)).

---

**Changed Bug title to 'libextractor: CVE-2017-17440: various null pointer dereferences in GIF, IT, NSFE, S3M, SID and XM plugins' from 'libextractor: various null pointer dereferences in GIF, IT, NSFE, S3M, SID and XM plugins'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 06 Dec 2017 18:30:16 GMT) ([full text](bugreport.cgi?bug=883528;msg=43), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=43), [link](#42)).

---

**Reply sent**
to `Bertrand Marc <bmarc@debian.org>`:

You have taken responsibility.
(Thu, 28 Dec 2017 17:36:06 GMT) ([full text](bugreport.cgi?bug=883528;msg=45), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=45), [link](#44)).

---

**Notification sent**
to `Markus Koschany <apo@debian.org>`:

Bug acknowledged by developer.
(Thu, 28 Dec 2017 17:36:06 GMT) ([full text](bugreport.cgi?bug=883528;msg=47), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=47), [link](#46)).

---

[Message #48](#48) received at 883528-close@bugs.debian.org ([full text](bugreport.cgi?bug=883528;msg=48), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=48), reply):

![](/cgi-bin/libravatar.cgi?email=bmarc%40debian.org)
From: Bertrand Marc <bmarc@debian.org>
To: 883528-close@bugs.debian.org
Subject: Bug#883528: fixed in libextractor 1:1.6-2
Date: Thu, 28 Dec 2017 17:34:40 +0000
```
Source: libextractor
Source-Version: 1:1.6-2

We believe that the bug you reported is fixed in the latest version of
libextractor, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 883528@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Bertrand Marc <bmarc@debian.org> (supplier of updated libextractor package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 28 Dec 2017 18:10:52 +0100
Source: libextractor
Binary: libextractor3 libextractor-dev extract
Architecture: source amd64
Version: 1:1.6-2
Distribution: unstable
Urgency: medium
Maintainer: Bertrand Marc <bmarc@debian.org>
Changed-By: Bertrand Marc <bmarc@debian.org>
Description:
 extract    - displays meta-data from files of arbitrary type
 libextractor-dev - extracts meta-data from files of arbitrary type (development)
 libextractor3 - extracts meta-data from files of arbitrary type (library)
Closes: [880016](bugreport.cgi?bug=880016) [883528](bugreport.cgi?bug=883528)
Changes:
 libextractor (1:1.6-2) unstable; urgency=medium
 .
   * Add patches from upstream to fix [CVE-2017-15922](https://security-tracker.debian.org/tracker/CVE-2017-15922) (Closes: #[880016](bugreport.cgi?bug=880016)) and
     [CVE-2017-17440](https://security-tracker.debian.org/tracker/CVE-2017-17440) (Closes: #[883528](bugreport.cgi?bug=883528)).
   * Standards-version: 4.1.3.
Checksums-Sha1:
 75d2b2c0b263e92ba2d06e1070a059e63b814833 2477 libextractor_1.6-2.dsc
 64a705f36d568ba72471fdd06f78e5b68d703544 17632 libextractor_1.6-2.debian.tar.xz
 0aa5775c7c9d85c86f9044df30546a50bc8bd11d 23720 extract-dbgsym_1.6-2_amd64.deb
 5effe57533221ad2bc4e3e48b80465fd118024c3 105120 extract_1.6-2_amd64.deb
 c7b0dc72bdd48cd049368c9871a460926e71dd1b 26792 libextractor-dev_1.6-2_amd64.deb
 535c70e978d13be87bd44bdd89c23fbed93f42c7 519632 libextractor3-dbgsym_1.6-2_amd64.deb
 9faf60d74a21ce428bfa59339fca4a488a70c7ba 112804 libextractor3_1.6-2_amd64.deb
 d55b22934388dc11ea05e6d09733360d9f0429d2 18366 libextractor_1.6-2_amd64.buildinfo
Checksums-Sha256:
 c540bb7b59f5f9785a5d22363715f13e454a5fe991bf5cd38f9107b078ed26fa 2477 libextractor_1.6-2.dsc
 57c4c6b29962f006114182e5d8c9c12a25534c286781117216a0cbb0e8e19649 17632 libextractor_1.6-2.debian.tar.xz
 b35286b42ed91660a8d1c6321ccfa5cae5ceaebb113f02078c11a6b3b29c3fa3 23720 extract-dbgsym_1.6-2_amd64.deb
 ad008edd97dbacb656e6d7f0b542e6d43bb57e338ffdcc20ed186601b5b263e9 105120 extract_1.6-2_amd64.deb
 94ef20994ebaefe381427a7711adbefc9939f7a412178b9e71cf01a8385a868c 26792 libextractor-dev_1.6-2_amd64.deb
 9050bfdea5ce8588abca6d730340c8d2d97550b6578b23aab918d62281efd99d 519632 libextractor3-dbgsym_1.6-2_amd64.deb
 93f1f90b6cffe4ec8a75b2e7534b24d9e0ba148c16a3390acbd662c1cd7ef9c2 112804 libextractor3_1.6-2_amd64.deb
 1dbafc3228bb7f245c41d876a107a05bcf64ea35f9ae501b69ca109dbd416078 18366 libextractor_1.6-2_amd64.buildinfo
Files:
 10dbf42d18bdb3f437b44b22b858b38c 2477 libs optional libextractor_1.6-2.dsc
 275097e35933afceeb30f7893685f8d2 17632 libs optional libextractor_1.6-2.debian.tar.xz
 332de9a904dd170b204aeade1468a8b9 23720 debug optional extract-dbgsym_1.6-2_amd64.deb
 19647747868070987e317f42242f346d 105120 utils optional extract_1.6-2_amd64.deb
 5abc9d7048ec3cca8bb3fe226af244a6 26792 libdevel optional libextractor-dev_1.6-2_amd64.deb
 f2a644c04714458193885371996a3808 519632 debug optional libextractor3-dbgsym_1.6-2_amd64.deb
 b007f5b1d1a4ed2c1e39bfa518c77d2d 112804 libs optional libextractor3_1.6-2_amd64.deb
 c0134ba759b4e6cecc04e4514b839a68 18366 libs optional libextractor_1.6-2_amd64.buildinfo

-----BEGIN PGP SIGNATURE-----

iQJFBAEBCAAvFiEEKUUr1GPOZwMj0JuIoEqzutviY+4FAlpFJx0RHGJtYXJjQGRl
Ymlhbi5vcmcACgkQoEqzutviY+7b7BAAhPbgZt6ysW3mLme0569hrv+I/8e0B6lj
9/7j2sImKS0ziJidctuNf2uWiRDiC/YfrhEQuCPp+K8faj7pedbbbm9BH1axu4rC
fWHXFDrcA8kxDceKN8r2sPI5oy8tuY5Bh0AYTmv9AiYYJMDs39uCtau6UrUYYRBy
yaEKlSncpd8iJF6hMqDCrhcNswTW24u7r4b4cwdPebFTlpgdfOS6pFUa9/6BSMIi
CjD1Jmib6JF6hyiWCDDTAy1SFfaKapLmHB9IgJl9KxOjBo7z+Fdll7EhAtrDuIzO
2LRiVvzpo6WwsBe+QhWsUaLGwZLd02/nQB21nsQ1O0zYOSwD2PPkRcHYOj+P4NC+
DhjsiGDMkdyuvzOdHeZHggGLRTVxUblLybNpVzcm8uD/4cOjhxtfZl71aYvVyMv9
u8q2zwDGBS9Hyq0jkzDSSoh+8bqnKLZxhrKbODFI1hh1wN1AM4YJPiKam6Z/uQeB
UES/TsykwgTlMNPJnhUSLS0yS8KQbfUeOEt49DWb52Rk4rlevKcI17sjCjACnyIw
eXYmVbgSFe8WslnphCm2Yzt7BkFf2avCfH20jl+sBraXUPjr5b7du9ZdvJvbZLrB
SH8DB1MtYTBTJ1i/piNHkCwKckdIcpWzKkw4urTCWMyxh3cn03OygX56lkA6TVAx
eB1oq/gEUiM=
=Po1K
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 31 Jan 2018 07:29:45 GMT) ([full text](bugreport.cgi?bug=883528;msg=50), [mbox](bugreport.cgi?bug=883528;mbox=yes;msg=50), [link](#49)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=883528).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 18:52:07 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from lists.gnu.org_766e1536_20250124_185210.html ===


| | **bug-libextractor** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-libextractor)

---

[[Date Prev](msg00004.html)][Date Next][[Thread Prev](msg00004.html)][Thread Next][[Date Index](index.html#00005)][[Thread Index](threads.html#00005)]

## Re: [bug-libextractor] NULL Pointer Dereference vulneribility in libextr

---

| **From**: | Christian Grothoff |
| --- | --- |

| **Subject**: | Re: [bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_xm\_extract\_method |
| **Date**: | Wed, 1 Nov 2017 09:12:29 +0100 |
| **User-agent**: | Mozilla/5.0 (X11; Linux x86\_64; rv:52.0) Gecko/20100101 Thunderbird/52.4.0 |

---

```
Thanks for reporting, I've fixed all of the reports from 7:19-7:28 on
the list today in Git 7cc63b00.  (As usual, they are all only noticable
for the 'in-process' execution, the plugin mechanism otherwise hides the
crashes.)

Happy hacking!

Christian

```

**[![Attachment:](/icons/generic.png)](pgpyKY3npFHZL.pgp)
[signature.asc](pgpyKY3npFHZL.pgp)**

*Description:* OpenPGP digital signature

---

reply via email to

---

| [[Prev in Thread](msg00004.html)] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_xm\_extract\_method](msg00004.html)**, *Leon Zhao*, 2017/11/01
  + **Re: [bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_xm\_extract\_method**,
    *Christian Grothoff* **<=**

---

* Prev by Date:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_xm\_extract\_method](msg00004.html)**
* Previous by thread:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_xm\_extract\_method](msg00004.html)**
* Index(es):
  + [**Date**](index.html#00005)
  + [**Thread**](threads.html#00005)



=== Content from lists.gnu.org_bee35ca0_20250124_185210.html ===


| | **bug-libextractor** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-libextractor)

---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)][[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)][[Date Index](index.html#00001)][[Thread Index](threads.html#00001)]

## [bug-libextractor] NULL Pointer Dereference vulneribility in libextracto

---

| **From**: | Leon Zhao |
| --- | --- |

| **Subject**: | [bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_s3m\_extract\_method |
| **Date**: | Wed, 1 Nov 2017 14:21:24 +0800 |

---

**Tested Version:**libextractor v1.6
**Tested System:**Linux leon-virtual-machine 4.10.0-35-generic #39~16.04.1-Ubuntu SMP Wed Sep 13 09:02:42 UTC 2017 x86\_64 x86\_64 x86\_64 GNU/Linux
**Details:**In function EXTRACTOR\_s3m\_extract\_method at s3m\_extractor.cÂ Â 83Â  Â if (sizeof (header) >Â 84Â  Â  Â  Â ec->read (ec->cls,Â 85Â  Â  Â  Â  Â  Â  Â  Â  Â &data,Â 86Â  Â  Â  Â  Â  Â  Â  Â  Â sizeof (header)))Â 87Â  Â  Â return;Â 88Â  Â memcpy (&header, data, sizeof (header));Â 89Â  Â if ( (0x1A != header.byte\_1A) ||Â 90Â  Â  Â  Â  (0 != memcmp (header.SCRM, "SCRM", 4)) )Â 91Â  Â  Â return;ec->read function set data to NULL, so it crash when the code want to copy data to header.Â **Crash Information:**The output with address sanitizer enabled./extract -i extract.EXTRACTOR\_s3m\_extract\_method.s3m\_extractor.88.crashÂ Keywords for file extract.EXTRACTOR\_s3m\_extract\_method.s3m\_extractor.88.crash:comment - r~rL?ASAN:SIGSEGV===================================================================49338==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7fc077662c44 bp 0x7ffe92149d60 sp 0x7ffe92149be0 T0)Â  Â  #0 0x7fc077662c43 in EXTRACTOR\_s3m\_extract\_method /root/libextractor-1.6/src/plugins/s3m\_extractor.c:88Â  Â  #1 0x7fc07e5909a1 in do\_extract /root/libextractor-1.6/src/main/extractor.c:583Â  Â  #2 0x7fc07e590db5 in EXTRACTOR\_extract /root/libextractor-1.6/src/main/extractor.c:662Â  Â  #3 0x4044f9 in main /root/libextractor-1.6/src/main/extract.c:983Â  Â  #4 0x7fc07e1ca82f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2082f)Â  Â  #5 0x4017c8 in \_start (/opt/asan/bin/extract+0x4017c8)
AddressSanitizer can not provide additional info.SUMMARY: AddressSanitizer: SEGV /root/libextractor-1.6/src/plugins/s3m\_extractor.c:88 EXTRACTOR\_s3m\_extract\_method==49338==ABORTING
**CREDIT**Zhao Liang, Huawei Weiran Labs
Attachment is POC file

**[![Attachment:](/icons/binary.png)](binFTuH4jnWgO.bin)
[extract.EXTRACTOR\_s3m\_extract\_method.s3m\_extractor.88.crash](binFTuH4jnWgO.bin)**

*Description:* Binary data

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_s3m\_extract\_method**,
  *Leon Zhao* **<=**

---

* Prev by Date:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_nsfe\_extract\_method](msg00000.html)**
* Next by Date:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_sid\_extract\_method](msg00002.html)**
* Previous by thread:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_nsfe\_extract\_method](msg00000.html)**
* Next by thread:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_sid\_extract\_method](msg00002.html)**
* Index(es):
  + [**Date**](index.html#00001)
  + [**Thread**](threads.html#00001)



=== Content from lists.gnu.org_fe28ab60_20250124_185209.html ===


| | **bug-libextractor** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-libextractor)

---

[Date Prev][[Date Next](msg00001.html)][Thread Prev][[Thread Next](msg00001.html)][[Date Index](index.html#00000)][[Thread Index](threads.html#00000)]

## [bug-libextractor] NULL Pointer Dereference vulneribility in libextracto

---

| **From**: | Leon Zhao |
| --- | --- |

| **Subject**: | [bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_nsfe\_extract\_method |
| **Date**: | Wed, 1 Nov 2017 14:19:11 +0800 |

---

**Tested Version:**libextractor v1.6
**Tested System:**Linux leon-virtual-machine 4.10.0-35-generic #39~16.04.1-Ubuntu SMP Wed Sep 13 09:02:42 UTC 2017 x86\_64 x86\_64 x86\_64 GNU/Linux
**Details:**In function EXTRACTOR\_nsfe\_extract\_method at nsfe\_extractor.cÂ Â 345Â  Â if (sizeof (struct header) >Â 346Â  Â  Â  Â ec->read (ec->cls,Â 347Â  Â  Â  Â  Â  Â  Â  Â  Â &data,Â 348Â  Â  Â  Â  Â  Â  Â  Â  Â sizeof (struct header)))Â 349Â  Â  Â return;Â 350Â  Â head = data;Â 351Â  Â if (0 != memcmp (head->magicid, "NSFE", 4))Â 352Â  Â  Â return;Â 353Â Â 354Â  Â if (0 != ec->proc (ec->cls,Â 355Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "nsfe",Â 356Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  EXTRACTOR\_METATYPE\_MIMETYPE,Â 357Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  EXTRACTOR\_METAFORMAT\_UTF8,Â 358Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "text/plain",Â 359Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "audio/x-nsfe",Â 360Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  strlen ("audio/x-nsfe") + 1))Â 361Â  Â  Â return;Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "nsfe",ec->read function set data to NULL, so it crash when the code want to use magicid of pointer head in line 351.Â **Crash Information:**The output with address sanitizer enabled./extract -i extract.EXTRACTOR\_nsfe\_extract\_method.nsfe\_extractor.351.crashÂ Keywords for file extract.EXTRACTOR\_nsfe\_extract\_method.nsfe\_extractor.351.crash:ASAN:SIGSEGV===================================================================19923==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7ff41c8bdfe4 bp 0x7fffd3ba7bd0 sp 0x7fffd3ba7358 T0)Â  Â  #0 0x7ff41c8bdfe3Â  (/lib/x86\_64-linux-gnu/libc.so.6+0x16efe3)Â  Â  #1 0x7ff41cdec74e in memcmp (/usr/lib/x86\_64-linux-gnu/libasan.so.2+0x7774e)Â  Â  #2 0x7ff416a919af in EXTRACTOR\_nsfe\_extract\_method /root/libextractor-1.6/src/plugins/nsfe\_extractor.c:351Â  Â  #3 0x7ff41cb359a1 in do\_extract /root/libextractor-1.6/src/main/extractor.c:583Â  Â  #4 0x7ff41cb35db5 in EXTRACTOR\_extract /root/libextractor-1.6/src/main/extractor.c:662Â  Â  #5 0x4044f9 in main /root/libextractor-1.6/src/main/extract.c:983Â  Â  #6 0x7ff41c76f82f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2082f)Â  Â  #7 0x4017c8 in \_start (/opt/asan/bin/extract+0x4017c8)
AddressSanitizer can not provide additional info.SUMMARY: AddressSanitizer: SEGV ??:0 ??==19923==ABORTING
**CREDIT**Zhao Liang, Huawei Weiran Labs
Attachment is POC file

**[![Attachment:](/icons/binary.png)](bino9pRrf2SaY.bin)
[extract.EXTRACTOR\_nsfe\_extract\_method.nsfe\_extractor.351.crash](bino9pRrf2SaY.bin)**

*Description:* Binary data

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_nsfe\_extract\_method**,
  *Leon Zhao* **<=**

---

* Next by Date:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_s3m\_extract\_method](msg00001.html)**
* Next by thread:
  **[[bug-libextractor] NULL Pointer Dereference vulneribility in libextractor EXTRACTOR\_s3m\_extract\_method](msg00001.html)**
* Index(es):
  + [**Date**](index.html#00000)
  + [**Thread**](threads.html#00000)


