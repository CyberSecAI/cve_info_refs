The provided content describes a Cross-Site Scripting (XSS) and Cross-Site Request Forgery (CSRF) vulnerability in Piwigo version 2.9.2.

**Root cause of vulnerability:**

*   **CSRF:** Lack of CSRF protection in the admin panel, specifically in the album properties modification page (`admin.php?page=album-3-properties`).
*   **XSS:** Insufficient input sanitization or output encoding when displaying album names, allowing for the injection of malicious scripts.

**Weaknesses/vulnerabilities present:**

*   **CSRF:** The application does not implement proper CSRF protection mechanisms.
*   **Stored XSS:** User-supplied input (album name) is not properly sanitized before being stored and later displayed.

**Impact of exploitation:**

*   **CSRF:** An attacker can trick an authenticated admin user into performing actions in the admin panel without their knowledge or consent. This includes modifying album properties.
*   **XSS:** An attacker can inject malicious JavaScript code that will be executed in the context of the admin user's browser when they view the affected album. This allows for a variety of malicious actions including session hijacking and data theft.

**Attack vectors:**

*   **CSRF:** The attacker crafts a malicious HTML page hosted on an external site. This page contains a form that, when submitted, makes a request to the vulnerable admin page in Piwigo. The attacker then tricks the admin user into visiting the malicious page while the admin user is logged in to Piwigo.
*   **XSS:** An attacker uses the CSRF vulnerability to make a malicious request that injects XSS payload into an album name. Then, when an admin user views the album's properties in the admin panel, the XSS payload will execute.

**Required attacker capabilities/position:**

*   The attacker needs to be able to host a malicious HTML page.
*   The attacker needs to trick an authenticated admin user into visiting the malicious HTML page while the user is logged into Piwigo.
* The attacker does not need to login into the admin panel themselves to exploit the vulnerability.