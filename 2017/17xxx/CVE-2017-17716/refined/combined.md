=== Content from gitlab.com_1062c952_20250125_212858.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

Project 'gitlab-org/gitlab-ce' was moved to 'gitlab-org/gitlab-foss'. Please update any links and bookmarks that may still have the old path.

# GitLab LDAP integration vulnerable to MITM attack

#### Overview

By default the `ruby-net-ldap` gem does not enabled SSL verification unless configured via [tls\_options](https://github.com/ruby-ldap/ruby-net-ldap/blob/master/lib/net/ldap.rb#L505-L515).

GitLab uses the [omniauth-ldap](https://gitlab.com/gitlab-org/omniauth-ldap) library for LDAP auth. There is currently an open issue [LDAP Server certificate not validated](https://github.com/intridea/omniauth-ldap/issues/58) which describes the SSL verification problem.

I've lodged this issue here for posterity. We should either address it upstream or in our fork.

#### Problem

As no verification is performed on the SSL certificate an attacker could easily impersonate an LDAP server.

#### Solution

We should patch our fork of the omniauth-ldap library to pass and verify SSL certificates by default.

cc [@briann](/briann "Brian Neel") [@dblessing](/dblessing "Drew Blessing") [@stanhu](/stanhu "Stan Hu")

---

* <https://gitlab.zendesk.com/agent/tickets/71302>

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


