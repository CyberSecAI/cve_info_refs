```
{
  "Root cause of vulnerability": "The `get_device_byif` function in `wportal.lua` does not sanitize the input parameter 'interface' before passing it to `io.popen`. This allows an attacker to inject arbitrary shell commands.",
  "Weaknesses/vulnerabilities present": [
    "Command injection",
    "Lack of input sanitization"
  ],
  "Impact of exploitation": "An attacker can execute arbitrary commands on the root shell of the router, potentially leading to complete compromise of the device.",
  "Attack vectors": "Remote, through HTTP POST request to `/cgi-bin/luci/;stok=<token>/admin/wportal?form=wechat`",
  "Required attacker capabilities/position": "The attacker must have valid web login credentials for the router or be able to bypass authentication (session hijack vulnerability, or weak credentials brute force). The attacker must be able to send an HTTP POST request to the vulnerable endpoint."
}
```