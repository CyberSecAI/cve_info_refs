=== Content from github.com_82f95c48_20250126_103203.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-fc3h-fxv9-79gq)

**CVE-2017-1000382**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-fc3h-fxv9-79gq)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2017-1000382](/advisories/GHSA-fc3h-fxv9-79gq)

## VIM version 8.0.1187 (and other versions most likely)...

Moderate severity

Unreviewed

Published
May 17, 2022
to the GitHub Advisory Database
•
Updated Feb 3, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-fc3h-fxv9-79gq/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

VIM version 8.0.1187 (and other versions most likely) ignores umask when creating a swap file ("[ORIGINAL\_FILENAME].swp") resulting in files that may be world readable or otherwise accessible in ways not intended by the user running the vi binary.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2017-1000382>
* <http://security.cucumberlinux.com/security/details.php?id=120>
* <http://www.openwall.com/lists/oss-security/2017/10/31/1>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2017-1000382)
Oct 31, 2017

Published to the GitHub Advisory Database
May 17, 2022

Last updated
Feb 3, 2023

### Severity

Moderate

5.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

### EPSS score

0.044%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (15th percentile)

### Weaknesses

[CWE-200](/advisories?query=cwe%3A200)

### CVE ID

CVE-2017-1000382

### GHSA ID

GHSA-fc3h-fxv9-79gq

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-fc3h-fxv9-79gq/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from groups.google.com_1deee28c_20250125_171156.html ===
[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")ConversationsAll groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
## vim\_dev

[Conversations](./g/vim_dev)[About](./g/vim_dev/about)[Privacy](https://policies.google.com/privacy?hl=en_US) • [Terms](https://policies.google.com/terms?hl=en_US)

Groups keyboard shortcuts have been updatedDismissSee shortcuts
# Security risk of vim swap files

 2,361 viewsSkip to first unread message![Hanno Böck's profile photo](//lh3.googleusercontent.com/a-/ALV-UjW-9c0BsQvwxCZyr087_vHuDhKOJrx2IDmN2olMj6DASgZqxA=s40-c)
### Hanno Böck

unread,Oct 31, 2017, 10:32:35 AM10/31/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_devHi,

I wanted to point out an issue here with vim swap files that make them

a security problem.

By default vim creates a file with the name .filename.swp in the same

directory while editing. They contain the full content of the edited

file. This usually gets deleted upon exit, but not if vim crashes or

gets killed (e.g. due to a reboot).

On web servers this can be a severe security risk. One can e.g. scan

for web hosts that have swap files of PHP configuration files and thus

expose settings like database passwords. (e.g. wget

<http://example.com/.wp-config.php.swp> )

In a scan of the alexa top 1 million I found ~750 instances of such

files. I tried to inform affected people as best as I could. I also

discovered such scans in my own web server logs, so I assume black hats

are already aware of this and it's actively exploitet.

I was wondering how to best avoid this on my own servers and I first

thought about saving the swap files to tmp ( with "set directory").

However on multiuser systems this creates another security problem.

These files are world readable, thus instead of leaking information to

the world it's now leaking information to other users on the same

system. Thus even if one is aware of the issue it's nontrivial to get

secure settings (I've now worked around this by having per-user tmp

dirs with secure permissions.)

I think vim should change the behavior of swap files:

1. they should be stored in /tmp by default

2. they should have secure permissions (tmp file security is

a tricky thing and needs careful consideration to avoid symlink attacks

and the like, but there are dedicated functions for this like mkstemp).

3. Ideally they also shouldn't leak currently edited filenames (e.g.

they shouldn't be called /tmp/.test.txt.swp, but more something

like /tmp/.vim\_swap.123782173)

--

Hanno Böck

<https://hboeck.de/>

mail/jabber: ha...@hboeck.de

GPG: FE73757FA60E4E21B937579FA5880072BBB51E42

![Hanno Böck's profile photo](//lh3.googleusercontent.com/a-/ALV-UjW-9c0BsQvwxCZyr087_vHuDhKOJrx2IDmN2olMj6DASgZqxA=s40-c)
### Hanno Böck

unread,Oct 31, 2017, 10:32:35 AM10/31/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@vim.org![Tony Mechelynck's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUzMikbSOQT7EPVEca5nIb_XgbrWp4FnAhgd7QkfhKhKa2I3n02=s40-c)
### Tony Mechelynck

unread,Oct 31, 2017, 10:59:49 AM10/31/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_devIsn't /tmp deleted at every bootup? If it is, or on the systems where

it is, this makes it useless for files whose chief utility is to allow

recovery after a program or system crash.

IMHO, the kind of considerations in Herrn Böcks message should not be

handled at Vim level but at the level of system security in general.

In particular neither system configuration files, nor files containing

passwords or the backups of such files, nor "invisible" files (whose

names start with a dot) — and this includes Vim swapfiles — should

IMHO be visible to the lambda web user. Whether a privileged login

should be allowed from a remote console is for every sysadmin to weigh

seriously, with consideration of the particular system's requirements.

On my machine I don't allow any remote login, and I don't open (other

than in "view source" mode) emails from dubious sources, but of course

other systems have other requirements: it is not always practical to

require that privileged logins should be allowed only from one

particular keyboard and screen located in the head office computer

room, to which only a few select operators (or BOFHs) are allowed

entry.

Best regards,

Tony.

![Hanno Böck's profile photo](//lh3.googleusercontent.com/a-/ALV-UjW-9c0BsQvwxCZyr087_vHuDhKOJrx2IDmN2olMj6DASgZqxA=s40-c)
### Hanno Böck

unread,Oct 31, 2017, 12:15:21 PM10/31/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.comOn Tue, 31 Oct 2017 11:59:41 +0100

Tony Mechelynck <antoine.m...@gmail.com> wrote:

> Isn't /tmp deleted at every bootup? If it is, or on the systems where

> it is, this makes it useless for files whose chief utility is to allow

> recovery after a program or system crash.

That is an interesting point, however this is not unified among

systems. An alternative would be to place them in a location like ~/.vim

> IMHO, the kind of considerations in Herrn Böcks message should not be

> handled at Vim level but at the level of system security in general.

> In particular neither system configuration files, nor files containing

> passwords or the backups of such files, nor "invisible" files (whose

> names start with a dot) — and this includes Vim swapfiles — should

> IMHO be visible to the lambda web user.

This seems quite vague and more like trying to discuss the issue away

instead of solving it. Can you be more specific what you have in mind?

It sounds like you expect from web servers to generally block access to

dot files. However that won't work, as there are standardized locations

on web servers i dot files (e.g. .well-known URLs, part of a couple of

modern standards). So how should that specifically work while not

breaking existing things? And who exactly should solve it in what way?

> Whether a privileged login

> should be allowed from a remote console is for every sysadmin to weigh

> seriously, with consideration of the particular system's requirements.

> On my machine I don't allow any remote login, and I don't open (other

> than in "view source" mode) emails from dubious sources, but of course

> other systems have other requirements: it is not always practical to

> require that privileged logins should be allowed only from one

> particular keyboard and screen located in the head office computer

> room, to which only a few select operators (or BOFHs) are allowed

> entry.

Sorry, can you explain what this part has to do with the problem?

Because I see no connection whatsoever.

--

Hanno Böck

<https://hboeck.de/>

mail/jabber: ha...@hboeck.de

GPG: FE73757FA60E4E21B937579FA5880072BBB51E42

![Marvin Renich's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWoJlE_ut-VnSffxEyDvb6Dqm8eE0gVZfT-JZD8WBlrgrNlqg=s40-c)
### Marvin Renich

unread,Oct 31, 2017, 12:26:54 PM10/31/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev\* Hanno Böck <ha...@hboeck.de> [171031 06:32]:

> I wanted to point out an issue here with vim swap files that make them

> a security problem.

>

> By default vim creates a file with the name .filename.swp in the same

> directory while editing. They contain the full content of the edited

> file. This usually gets deleted upon exit, but not if vim crashes or

> gets killed (e.g. due to a reboot).

>

> On web servers this can be a severe security risk. One can e.g. scan

> for web hosts that have swap files of PHP configuration files and thus

> expose settings like database passwords. (e.g. wget

> <http://example.com/.wp-config.php.swp> )

See the 'directory' option.

I don't see this as a problem with Vim; Vim gives the user appropriate

means to avoid it. The problem is one or both of (1) a web server that

serves files that the admin did not intend to serve and (2) the admin's

Vim configuration that puts temporary files in a location that the web

server serves without appropriate filtering.

Both problems are fixable with appropriate configuration. It would be

inappropriate for Vim's default to be to assume that having both the

file being edited and its swap file in the same directory would be a

security issue. The implication is that in most cases, if someone can

read the swap file, they can also read the original. This happens to

not always be true in the case of a web server that filters the PHP

configuration files but not Vim's swap files in the same directory.

...Marvin

![Manuel Ortega's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV3fADVS7Sv8qQLyKEcIzfilKYVhxAPdh3SBUXw6InvE2ZIfQ=s40-c)
### Manuel Ortega

unread,Oct 31, 2017, 1:01:43 PM10/31/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.comOn Tue, Oct 31, 2017 at 6:30 AM, Hanno Böck <ha...@hboeck.de> wrote:
> 3. Ideally they also shouldn't leak currently edited filenames (e.g.
>
> they shouldn't be called /tmp/.test.txt.swp, but more something
>
> like /tmp/.vim\_swap.123782173)

But Vim needs to know which swapfile is associated with which non-swap file.  How can it do that, other than by having the swapfile's name contain the original file's name?
Anyway I don't think it's Vim's job to cover up for foolish admins.
-Manny
![Christian Brabandt's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWiHR5GRz7AF2elHXCdc4YvLH7OqmOwDXRN6Th42aEf2UaHZmdW=s40-c)
### Christian Brabandt

unread,Oct 31, 2017, 2:11:55 PM10/31/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_devIt is true, that this can cause a problem. However, I am not sure its

correct to blame vim here.

First, I think you need to configure your webserver to be able to view

dotfiles. I believe a default installation of at least apache won't let

you show dotfiles. Second, I wonder why those swapfiles are not deleted.

Somehow Vim must have crashed or be killed and in that case one

certainly don't want that the swapfiles are deleted (think of recovery).

Finally, using git for managing your document root, can show you those

rubbish swap files, since the directory is not clean than, if you really

need to edit your files on the server directly and do not use a

deployment of some kind.

One could argue, that swap files should be stored below ~/.vim directory

tree. But what if several users edit the same file? One also needs to

make sure, the path would be encoded into the name, but then we might

run into trouble with filename length limitations.

So I think it in the users responsibility to configure Vim correctly

(check the directory option) to not have him litter his document root

with old swap files.

The best I can think of currently, is to add a warning to the

documentation, that swapfiles may cause a security problem.

Christian

--

"Wenn man alle Gesetze studieren sollte, so hätte man gar keine

Zeit, sie zu übertreten."

 -- Goethe, Maximen und Reflektionen, Nr. 347

![Bram Moolenaar's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUPk2XnJEQUtWlW0QSPj-JuFkQmiQJYKeE7MtgRjEU777o8_3GH=s40-c)
### Bram Moolenaar

unread,Oct 31, 2017, 9:20:27 PM10/31/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.com, Hanno Böck, vim...@vim.org

Hanno Böck wrote:

> I wanted to point out an issue here with vim swap files that make them

> a security problem.

>

> By default vim creates a file with the name .filename.swp in the same

> directory while editing. They contain the full content of the edited

> file. This usually gets deleted upon exit, but not if vim crashes or

> gets killed (e.g. due to a reboot).

>

> On web servers this can be a severe security risk. One can e.g. scan

> for web hosts that have swap files of PHP configuration files and thus

> expose settings like database passwords. (e.g. wget

> <http://example.com/.wp-config.php.swp> )

Why would a web server expose and serve such a file? That clearly is

the problem, not that Vim happens to create swap files (and undo and

backup files, depending on your configuration).

You probably also create new files and copies of files that should not

be served. If you care about security, the web server must always use

whitelisting, only serve files that were intentionally made public.

> In a scan of the alexa top 1 million I found ~750 instances of such

> files. I tried to inform affected people as best as I could. I also

> discovered such scans in my own web server logs, so I assume black hats

> are already aware of this and it's actively exploitet.

>

> I was wondering how to best avoid this on my own servers and I first

> thought about saving the swap files to tmp ( with "set directory").

> However on multiuser systems this creates another security problem.

> These files are world readable, thus instead of leaking information to

> the world it's now leaking information to other users on the same

> system. Thus even if one is aware of the issue it's nontrivial to get

> secure settings (I've now worked around this by having per-user tmp

> dirs with secure permissions.)

>

> I think vim should change the behavior of swap files:

> 1. they should be stored in /tmp by default

No, on Linux this is wiped clean on reboot. You lose your work on a

system crash.

> 2. they should have secure permissions (tmp file security is

> a tricky thing and needs careful consideration to avoid symlink attacks

> and the like, but there are dedicated functions for this like mkstemp).

The permissions are the same as the original file, and that is exactly

how it should be.

> 3. Ideally they also shouldn't leak currently edited filenames (e.g.

> they shouldn't be called /tmp/.test.txt.swp, but more something

> like /tmp/.vim\_swap.123782173)

Infeasible, Vim can't find that file when trying to recover the original

file.

--

BEDEVERE: Oooooh!

LAUNCELOT: No "Aaaaarrrrrrggghhh ... " at the back of the throat.

BEDEVERE: No! "Oooooh!" in surprise and alarm!

 "Monty Python and the Holy Grail" PYTHON (MONTY) PICTURES LTD

 /// Bram Moolenaar -- Br...@Moolenaar.net -- <http://www.Moolenaar.net> \\\

/// sponsor Vim, vote for features -- <http://www.Vim.org/sponsor/> \\\

\\\ an exciting new programming language -- <http://www.Zimbu.org> ///

 \\\ help me help AIDS victims -- <http://ICCF-Holland.org> ///

![Ken Takata's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXHnCEhi0yQPv-y1gis8-gctIGZmxUuxxXDbb53WuqFsHgUhw=s40-c)
### Ken Takata

unread,Nov 1, 2017, 3:32:43 AM11/1/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_devHi,

An issue related to this (not the same) is filed as CVE-2017-1000382:

 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000382>

 <https://security-tracker.debian.org/tracker/CVE-2017-1000382>

It seems that the problem is that Vim ignores umask:

 <http://www.openwall.com/lists/oss-security/2017/10/31/15>

(Similar one for Emacs:

 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000383> )

Regards,

Ken Takata![Ken Takata's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXHnCEhi0yQPv-y1gis8-gctIGZmxUuxxXDbb53WuqFsHgUhw=s40-c)
### Ken Takata

unread,Nov 2, 2017, 1:28:37 AM11/2/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_devHi,

How about the attached patch?

This makes Vim to respect umask when creating a swapfile.

(I'm not sure this is actually needed, though.)

Regards,

Ken Takatarespect-umask-for-swapfiles.patch[](https://groups.google.com/group/vim_dev/attach/80cbefd8584da/respect-umask-for-swapfiles.patch?part=0.1)![Bram Moolenaar's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUPk2XnJEQUtWlW0QSPj-JuFkQmiQJYKeE7MtgRjEU777o8_3GH=s40-c)
### Bram Moolenaar

unread,Nov 2, 2017, 1:09:49 PM11/2/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.com, Ken TakataThis is working as intended, Vim does not use umask this way.

Umask is only used by simple commands such as cp, not by long running

processes that deal with many files.

Problem is with the user expectations.

--

Permission is granted to read this message out aloud on Kings Cross Road,

London, under the condition that the orator is properly dressed.

![zdo...@redhat.com's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXRpB959VpKqeYttdpcmC9VoGfUgEd_EUsY3fquIvN4PqvkCQ=s40-c)
### zdo...@redhat.com

unread,Nov 2, 2017, 2:36:36 PM11/2/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_devHi Bram,

can VIm provide a way how to set permissions for swap files? So users which consider this VIm behavior as security risk can set permissions differently? Would that be possible for VIm (like setting set swap\_file\_perm=775 in vimrc file)?

![Christian Brabandt's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWiHR5GRz7AF2elHXCdc4YvLH7OqmOwDXRN6Th42aEf2UaHZmdW=s40-c)
### Christian Brabandt

unread,Nov 2, 2017, 4:50:32 PM11/2/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev

On Mi, 01 Nov 2017, Ken Takata wrote:

> This makes Vim to respect umask when creating a swapfile.

> (I'm not sure this is actually needed, though.)

I am also not sure if this is needed. However it makes sense to have the

swap file with the same permissions of the original file. Think of a

crash of an editing session of a file that has o+rw set. In that case

and with a restrictive umask of 0077 only the author could restore it,

while currently everybody who is allowed to edit that file can also

recover it.

Christian

--

Es kann so schön sein, alt zu werden, das Gefühl zu haben, das fast

schon ein Glück ist, mehr von jenen Dingen zu wissen, an die man

früher nicht einmal gedacht hat. Weil man angeblich keine Zeit hatte.

 -- Heinz Rühmann

![Marvin Renich's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWoJlE_ut-VnSffxEyDvb6Dqm8eE0gVZfT-JZD8WBlrgrNlqg=s40-c)
### Marvin Renich

unread,Nov 2, 2017, 6:49:46 PM11/2/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev\* zdo...@redhat.com <zdo...@redhat.com> [171102 10:36]:

What security risk do you see? The original file and swap file are

conceptually treated as one unit. If someone can do something to the

original (such as writing), preventing that person from writing the swap

file has absolutely no security benefit.

The purpose of umask is to allow a newly created file to have specific

permissions unset at time of creation, preventing a race condition

between file creation and subsequently setting file permissions with

chmod.

With vim and a swap file, using umask to create the swap file with

permissions more restrictive than the original does not prevent anyone

from doing anything he or she can still do with the original.

...Marvin

![z5...@z5t1.com's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUyL6TGLBMFSg8-4pkglWcW7Cvl9mb4c8vppaxgYNm1jyJkqA=s40-c)
### z5...@z5t1.com

unread,Nov 2, 2017, 8:24:36 PM11/2/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_devHi, I'd like to add my two cents to this.

I have reproduced this on Centos 6 and Cucumber Linux 1.0. We have established that the umask plays no role in the permissions on swap files; Vim creates its swap files with the same permissions as the file being edited.

However, there is another problem with the swap file permissions that has not yet been discussed: when Vim creates swap files, the .swp file is created with the owner and group set to the user who is editing the file (hereafter referred to as the "editor") and the editor's primary group respectively. The permission bits on the swap file are the same as the original file.

This is a problem, as the editor's primary group may be different from the group of the file being edited. Take /etc/shadow for example. That file is supposed to have the permissions 640 with owner: root, group: shadow as a quick `ls -l` shows:

-rw-r----- 1 root shadow 1195 Sep 16 20:09 /etc/shadow

However, shadow is not the root user's primary group; on this system it happens to be 'users', which every other user on the system is also a member of. Now if root goes to edit the file, a swap file is created in /etc/.shadow.swp with the following permissions:

-rw-r----- 1 root users 4096 Nov 2 13:52 /etc/.shadow.swp

This swap file is now readable by every user on the system. Keep in mind the /etc/shadow file contains hashes of every user's password, so now the password for every single user on the system may have been compromised.

--- Solution ---

I have found this problem can be mitigated by changing the swap directory with the 'set directory' directive as Hanno originally suggested. I have added the following lines to my '/etc/vimrc':

" Move the swap file location to protect against CVE-2017-1000382

silent !install -d -m 700 ~/.vim/swap/ 2>&1 > /dev/null

set directory=~/.vim/swap/

This safely sets the swap file directory to a directory that should not cause any security problems. For added security, the directory is created so that only the owner has access to it, regardless of how the system's umask or .swp file permissions are set.

Additionally, the swap file collision (if you edit both ~/foo/file and ~/bar/file at the same time) is not a major issue; Vim detects this and gives the second swap file a different file extension. When you go to restore from the swap file, you get a prompt asking which swap file you want to use (if there are two swap files with the same basename), which doesn't strike me as being terribly problematic. While this approach may have some minor issues/quirks, for me it seems far preferable to being vulnerable to this vulnerability.

I have already applied this fix on Cucumber Linux and thought you may want to consider applying a similar fix upstream.

![Christian Brabandt's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWiHR5GRz7AF2elHXCdc4YvLH7OqmOwDXRN6Th42aEf2UaHZmdW=s40-c)
### Christian Brabandt

unread,Nov 2, 2017, 8:50:37 PM11/2/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev

On Do, 02 Nov 2017, z5...@z5t1.com wrote:

>

> However, there is another problem with the swap file permissions that has not yet been discussed: when Vim creates swap files, the .swp file is created with the owner and group set to the user who is editing the file (hereafter referred to as the "editor") and the editor's primary group respectively. The permission bits on the swap file are the same as the original file.

>

> This is a problem, as the editor's primary group may be different from the group of the file being edited. Take /etc/shadow for example. That file is supposed to have the permissions 640 with owner: root, group: shadow as a quick `ls -l` shows:

>

> -rw-r----- 1 root shadow 1195 Sep 16 20:09 /etc/shadow

>

> However, shadow is not the root user's primary group; on this system it happens to be 'users', which every other user on the system is also a member of. Now if root goes to edit the file, a swap file is created in /etc/.shadow.swp with the following permissions:

>

> -rw-r----- 1 root users 4096 Nov 2 13:52 /etc/.shadow.swp

>

> This swap file is now readable by every user on the system. Keep in mind the /etc/shadow file contains hashes of every user's password, so now the password for every single user on the system may have been compromised.

That looks like a problem.

>

> --- Solution ---

>

> I have found this problem can be mitigated by changing the swap directory with the 'set directory' directive as Hanno originally suggested. I have added the following lines to my '/etc/vimrc':

>

> " Move the swap file location to protect against CVE-2017-1000382

> silent !install -d -m 700 ~/.vim/swap/ 2>&1 > /dev/null

you likely want to add a check if the directory exists, so that not

every time Vim is called, it needs to shell out. Note, there is also

`system()` available. See `:h isdirectory()` and `:h system()`

> set directory=~/.vim/swap/

,----[ :h 'directory' ]-

| - For Unix and Win32, if a directory ends in two path separators "//"

| or "\\", the swap file name will be built from the complete path to

| the file with all path separators substituted to percent '%' signs.

| This will ensure file name uniqueness in the preserve directory.

`----

> This safely sets the swap file directory to a directory that should

> not cause any security problems. For added security, the directory is

> created so that only the owner has access to it, regardless of how the

> system's umask or .swp file permissions are set.

What is with files that are edited by several users possibly at the same

time? They won't get a warning message now.

> Additionally, the swap file collision (if you edit both ~/foo/file and

> ~/bar/file at the same time) is not a major issue; Vim detects this

> and gives the second swap file a different file extension. When you go

> to restore from the swap file, you get a prompt asking which swap file

> you want to use (if there are two swap files with the same basename),

> which doesn't strike me as being terribly problematic. While this

> approach may have some minor issues/quirks, for me it seems far

> preferable to being vulnerable to this vulnerability.

And how do you know from which swap file to recover? Additionally, if

there is ~/.vim/swap/.foo.txt.swp and ~/.vim/swap/.foo.txt.swo and the

first swap file is removed (after the editing session finishes), you

won't get a swap file recovery message anymore when editing a file for

which only ~/.vim/swap/.foo.txt.swo exists.

> I have already applied this fix on Cucumber Linux and thought you may

> want to consider applying a similar fix upstream.

You might want to tweak your setting as mentioned above.

Christian

--

Die Welt ist eine Glocke, die einen Riss hat: Sie klappert, aber

klingt nicht.

 -- Goethe, Maximen und Reflektionen, Nr. 333

![Bram Moolenaar's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUPk2XnJEQUtWlW0QSPj-JuFkQmiQJYKeE7MtgRjEU777o8_3GH=s40-c)
### Bram Moolenaar

unread,Nov 2, 2017, 10:04:40 PM11/2/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.com, z5...@z5t1.com

z5t1 (???) wrote:

> Hi, I'd like to add my two cents to this.

>

> I have reproduced this on Centos 6 and Cucumber Linux 1.0. We have established that the umask plays no role in the permissions on swap files; Vim creates its swap files with the same permissions as the file being edited.

>

> However, there is another problem with the swap file permissions that has not yet been discussed: when Vim creates swap files, the .swp file is created with the owner and group set to the user who is editing the file (hereafter referred to as the "editor") and the editor's primary group respectively. The permission bits on the swap file are the same as the original file.

>

> This is a problem, as the editor's primary group may be different from the group of the file being edited. Take /etc/shadow for example. That file is supposed to have the permissions 640 with owner: root, group: shadow as a quick `ls -l` shows:

>

> -rw-r----- 1 root shadow 1195 Sep 16 20:09 /etc/shadow

>

> However, shadow is not the root user's primary group; on this system it happens to be 'users', which every other user on the system is also a member of. Now if root goes to edit the file, a swap file is created in /etc/.shadow.swp with the following permissions:

>

> -rw-r----- 1 root users 4096 Nov 2 13:52 /etc/.shadow.swp

>

> This swap file is now readable by every user on the system. Keep in mind the /etc/shadow file contains hashes of every user's password, so now the password for every single user on the system may have been compromised.

Eh, why is root's primary group one that all users on the system are a

member of? That is asking for trouble. Every file that root creates

will be readable by everybody by default.

> --- Solution ---

>

> I have found this problem can be mitigated by changing the swap directory with the 'set directory' directive as Hanno originally suggested. I have added the following lines to my '/etc/vimrc':

>

> " Move the swap file location to protect against CVE-2017-1000382

> silent !install -d -m 700 ~/.vim/swap/ 2>&1 > /dev/null

> set directory=~/.vim/swap/

>

> This safely sets the swap file directory to a directory that should not cause any security problems. For added security, the directory is created so that only the owner has access to it, regardless of how the system's umask or .swp file permissions are set.

>

> Additionally, the swap file collision (if you edit both ~/foo/file and ~/bar/file at the same time) is not a major issue; Vim detects this and gives the second swap file a different file extension. When you go to restore from the swap file, you get a prompt asking which swap file you want to use (if there are two swap files with the same basename), which doesn't strike me as being terribly problematic. While this approach may have some minor issues/quirks, for me it seems far preferable to being vulnerable to this vulnerability.

>

> I have already applied this fix on Cucumber Linux and thought you may want to consider applying a similar fix upstream.

--

Kisses may last for as much as, but no more than, five minutes.

 [real standing law in Iowa, United States of America]

![Z5T1's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUyL6TGLBMFSg8-4pkglWcW7Cvl9mb4c8vppaxgYNm1jyJkqA=s40-c)
### Z5T1

unread,Nov 2, 2017, 10:12:49 PM11/2/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.comThank you Christian; I'm tweaking my configuration as you suggested.

On 11/02/17 16:50, Christian Brabandt wrote:

>

> What is with files that are edited by several users possibly at the same

> time? They won't get a warning message now.

I thought about this. As I said, my fix has some issues. One possible

solution I thought of was modifying vim to create a .filename.lock file

in the directory of the file you are editing, but with nothing in it.

Vim can the check for the existence of a .lock file to determine if the

file is locked for editing, and further check the owner of that file to

determine who has locked the file for editing. This still allows for vim

to prevent multiple users from inadvertently editing the same file at

once without risking disclosing the file contents to unintended parties.

If I get a chance, I will try to write a patch doing this.

signature.asc[](https://groups.google.com/group/vim_dev/attach/73ebd0187adf4/signature.asc?part=0.1)![Marvin Renich's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWoJlE_ut-VnSffxEyDvb6Dqm8eE0gVZfT-JZD8WBlrgrNlqg=s40-c)
### Marvin Renich

unread,Nov 3, 2017, 12:43:43 AM11/3/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev\* Christian Brabandt <cbl...@256bit.org> [171102 16:50]:

>

> On Do, 02 Nov 2017, z5...@z5t1.com wrote:

>

> >

> > However, there is another problem with the swap file permissions

> > that has not yet been discussed: when Vim creates swap files, the

> > .swp file is created with the owner and group set to the user who is

> > editing the file (hereafter referred to as the "editor") and the

> > editor's primary group respectively. The permission bits on the swap

> > file are the same as the original file.

> >

> > This is a problem, as the editor's primary group may be different

> > from the group of the file being edited. Take /etc/shadow for

> > example. That file is supposed to have the permissions 640 with

> > owner: root, group: shadow as a quick `ls -l` shows:

> >

> > -rw-r----- 1 root shadow 1195 Sep 16 20:09 /etc/shadow

> >

> > However, shadow is not the root user's primary group; on this system

> > it happens to be 'users', which every other user on the system is

> > also a member of. Now if root goes to edit the file, a swap file is

> > created in /etc/.shadow.swp with the following permissions:

> >

> > -rw-r----- 1 root users 4096 Nov 2 13:52 /etc/.shadow.swp

> >

> > This swap file is now readable by every user on the system. Keep in

> > mind the /etc/shadow file contains hashes of every user's password,

> > so now the password for every single user on the system may have

> > been compromised.

>

> That looks like a problem.

I agree. One solution is if the user doing the editing has permission

to create the swap file with the original file's user:group, then do

that with the original file's perms. Otherwise use the editing user's

user:group and perm 0600.

Another solution would be to always use the editing user's user:group

and perm 0600.

There might need to be more logic added to recover to check if the

current user has rw permission on the swap file. However, this might

very well just 'work' (i.e. fail gracefully) with the current code.

Re Bram's question about root's default group being users: While that

seems like a bad idea in general, the situation could still come up with

very reasonable user/group combinations. Take a 'normal' user whose

default group is users, but who also happens to be a member of group

staff. A file with root:staff ownership and 0660 perms would have a

swap file with someone:users and perms 0660, thus giving most users rw

access to the swap file when they had neither r nor w access to the

original.

...Marvin

![zdo...@redhat.com's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXRpB959VpKqeYttdpcmC9VoGfUgEd_EUsY3fquIvN4PqvkCQ=s40-c)
### zdo...@redhat.com

unread,Nov 3, 2017, 7:44:51 AM11/3/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev> Another solution would be to always use the editing user's user:group
> and perm 0600.

I agree with this solution. And IMO the best way would be to create option for configure script+create option for vimrc configuration file, which can turn on/off this behavior (IMHO it's good to have option for users, who doesn't want this behavior).

Zdenek

![zdo...@redhat.com's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXRpB959VpKqeYttdpcmC9VoGfUgEd_EUsY3fquIvN4PqvkCQ=s40-c)
### zdo...@redhat.com

unread,Nov 3, 2017, 7:46:20 AM11/3/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_devOn Friday, November 3, 2017 at 8:44:51 AM UTC+1, zdo...@redhat.com wrote:
> > Another solution would be to always use the editing user's user:group
> > and perm 0600.
>
> I agree with this solution. And IMO the best way would be to create option
> for configure script+create option for vimrc configuration file, which can

If that's possible.

![Marvin Renich's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWoJlE_ut-VnSffxEyDvb6Dqm8eE0gVZfT-JZD8WBlrgrNlqg=s40-c)
### Marvin Renich

unread,Nov 3, 2017, 1:07:53 PM11/3/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev\* zdo...@redhat.com <zdo...@redhat.com> [171103 03:45]:

I think having this behavior configurable is overkill and unnecessary in

practice.

After thinking about it, I like my second solution (the one above) best.

My first solution has the advantage that anyone who has permission to

edit the file will be able to recover a crashed editing session. But I

don't see this as a real-world scenario. The above solution is simpler

to implement, simpler to understand, and makes it easier to identify

security implications.

I also think my first solution might cause problems if the containing

directory has the restricted deletion flag permission bit.

...Marvin

![Z5T1's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUyL6TGLBMFSg8-4pkglWcW7Cvl9mb4c8vppaxgYNm1jyJkqA=s40-c)
### Z5T1

unread,Nov 3, 2017, 1:18:29 PM11/3/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.comAnother option would be to copy the user and other permissions from the

original file, but reset the group permissions to 0. For example, if a

user goes to edit a file with permissions 754, the .swp file would have

the permissions 704. This prevents the security problem with .swp files

while still allowing anyone to recover changes for files that were world

readable to begin with. This might be a good compromise.

Still I think the least problematic solution though is to use a separate

directory for the .swp files. Also, what happens if a user goes to edit

a file that he has write access to in a directory that he doesn't have

write access to? Where does the .swp file get placed then? With the

approach separate directory approach this becomes a nonissue.

signature.asc[](https://groups.google.com/group/vim_dev/attach/7702928e2be9e/signature.asc?part=0.1)![Zdenek Dohnal's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXRpB959VpKqeYttdpcmC9VoGfUgEd_EUsY3fquIvN4PqvkCQ=s40-c)
### Zdenek Dohnal

unread,Nov 3, 2017, 1:26:43 PM11/3/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.comOn 11/03/2017 02:07 PM, Marvin Renich wrote:

> \* zdo...@redhat.com <zdo...@redhat.com> [171103 03:45]:

>>> Another solution would be to always use the editing user's user:group

>>> and perm 0600.

>> I agree with this solution. And IMO the best way would be to create

>> option for configure script+create option for vimrc configuration

>> file, which can turn on/off this behavior (IMHO it's good to have

>> option for users, who doesn't want this behavior).

> I think having this behavior configurable is overkill and unnecessary in

> practice.

Can other users open original file, which has .swp file belonging to

certain user:group with permissions 0600, as read-only with your

solution? If not, it could be change of behavior, which can make some

people unhappy -> that' why I thought it could be configurable behavior.

--

Zdenek Dohnal

Associate Software Engineer

Red Hat Czech - Brno TPB-C

signature.asc[](https://groups.google.com/group/vim_dev/attach/7709c3ae69337/signature.asc?part=0.1)![Bram Moolenaar's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUPk2XnJEQUtWlW0QSPj-JuFkQmiQJYKeE7MtgRjEU777o8_3GH=s40-c)
### Bram Moolenaar

unread,Nov 3, 2017, 5:35:31 PM11/3/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.com, Z5T1

Someone wrote:

> Another option would be to copy the user and other permissions from the

> original file, but reset the group permissions to 0. For example, if a

> user goes to edit a file with permissions 754, the .swp file would have

> the permissions 704. This prevents the security problem with .swp files

> while still allowing anyone to recover changes for files that were world

> readable to begin with. This might be a good compromise.

To cover the case that the user has his configuration wrong and has a

primary group that gives too many users access, we can attempt to change

the group of the swap file to that of the original file. If that works

then we can keep using the same permissions. If that fails, the group

is now different, we can set the group bits to zero. We can OR them

with the world bits (some systems have the weird behavior that when the

group matches it ignores the world bits, restricting permission if you

happen to be in the lucky group).

> Still I think the least problematic solution though is to use a separate

> directory for the .swp files. Also, what happens if a user goes to edit

> a file that he has write access to in a directory that he doesn't have

> write access to? Where does the .swp file get placed then? With the

> approach separate directory approach this becomes a nonissue.

Read the docs, it's covered.

--

bashian roulette:

$ ((RANDOM%6)) || rm -rf ~

![Marvin Renich's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWoJlE_ut-VnSffxEyDvb6Dqm8eE0gVZfT-JZD8WBlrgrNlqg=s40-c)
### Marvin Renich

unread,Nov 3, 2017, 6:37:31 PM11/3/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.com\* Zdenek Dohnal <zdo...@redhat.com> [171103 09:27]:

> On 11/03/2017 02:07 PM, Marvin Renich wrote:

> > \* zdo...@redhat.com <zdo...@redhat.com> [171103 03:45]:

> Can other users open original file, which has .swp file belonging to

> certain user:group with permissions 0600, as read-only with your

> solution? If not, it could be change of behavior, which can make some

> people unhappy -> that' why I thought it could be configurable behavior.

Yes. My current version (from Debian package; see below) will give the

"recovery" prompt, and then allow the user to edit it anyway (based on

the answer to the prompt). This looks like it is working just right.

VIM - Vi IMproved 8.0 (2016 Sep 12, compiled Oct 13 2017 22:38:50)

Included patches: 1-1144

...Marvin

![dez...@gmail.com's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUJtXJ6vjn-0hrAqIdbb44nYGCdXWAaXaFWVgP2K7kGlD5hbI5-BQ=s40-c)
### dez...@gmail.com

unread,Nov 6, 2017, 5:07:17 PM11/6/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_devOn Tuesday, October 31, 2017 at 3:11:55 PM UTC+1, Christian Brabandt wrote:

> It is true, that this can cause a problem. However, I am not sure its

> correct to blame vim here.

> First, I think you need to configure your webserver to be able to view

> dotfiles. I believe a default installation of at least apache won't let

> you show dotfiles. Second, I wonder why those swapfiles are not deleted.

> Somehow Vim must have crashed or be killed and in that case one

> certainly don't want that the swapfiles are deleted (think of recovery).

I agree. Although a multi-user system usually is connected via ssh - in that same scenario sometimes the connection is interrupted or people are on flaky wifi. This leaves ~ swapfiles littered over the system more frequently as a multi-user system over ssh. Which gives more reason to not litter the current directory for multi-user environments even with the argument of people editing the same file. Most people are annoyed by littered files over a filesystem.

> One could argue, that swap files should be stored below ~/.vim directory

> tree. But what if several users edit the same file? One also needs to

> make sure, the path would be encoded into the name, but then we might

> run into trouble with filename length limitations.

A shared directory in /tmp for all vim instances on a multi-user system would solve the issue while not littering the filesystem.

> So I think it in the users responsibility to configure Vim correctly

> (check the directory option) to not have him litter his document root

> with old swap files.

Almost every .vimrc I've ever read had a line to set directory to exclude current directory and it is more an annoyance than a feature when countless people are asking this question over and over again what filename~ files are. I agree vim should be geared towards multi-user systems as well and warn when appropriate. It just makes more sense to have it in $TMP in that case and retain that behaviour.![Scott Court's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUyL6TGLBMFSg8-4pkglWcW7Cvl9mb4c8vppaxgYNm1jyJkqA=s40-c)
### Scott Court

unread,Nov 6, 2017, 5:29:52 PM11/6/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.comThe problem with storing the .swp tiles in /tmp though is that (on most

distributions) /tmp gets cleared on every reboot, which is a problem

since one of the major purposes of .swp files is to allow recovery of a

vim session after system crash/hard reboot.

Also, the default Apache httpd config does permit serving of . (dot) files.

Perhaps we should store the swap files in a sticky directory visible by

all users that is a) not ever going to be on a \*\*shared\*\* NFS and b) not

going to be cleared on reboot (say /var/cache/vim/swap), and then set

the permissions for all .swp files to 0600.

It's also not really reasonable to expect every user of Vim to be aware

of every potential security vulnerability and edit his configuration

files to protect against them. See the first paragraph of the "Secure by

Default" section at <https://www.openbsd.org/security.html>.

signature.asc[](https://groups.google.com/group/vim_dev/attach/8699eacaa1f28/signature.asc?part=0.1)![Scott Court's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUyL6TGLBMFSg8-4pkglWcW7Cvl9mb4c8vppaxgYNm1jyJkqA=s40-c)
### Scott Court

unread,Nov 6, 2017, 5:39:46 PM11/6/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.com

Update: I just read through the Filesystem Hierarchy Standard
more carefully, and it appears there actually is a directory for
this purpose: /var/lib in which the FHS states we can create a
/var/lib/vim/swap subdirectory in for this purpose.

From
<http://www.pathname.com/fhs/pub/fhs-2.3.html#VARLIBLTEDITORGTEDITORBACKUPFILESAN>

> ### /var/lib/<editor> : Editor backup files and state (optional)
>
> #### Purpose
>
> These directories contain saved files generated by
> any
> unexpected termination of an editor (e.g., **elvis**,
> **jove**, **nvi**).
>
> Other editors may not require a directory for
> crash-recovery
> files, but may require a well-defined place to store other
> information
> while the editor is running. This information should be stored
> in a
> subdirectory under /var/lib
> (for example, GNU
> Emacs would place lock files in
> /var/lib/emacs/lock).

Maybe we should store the .swp files there.signature.asc[](https://groups.google.com/group/vim_dev/attach/86a28f0353378/signature.asc?part=0.1)![Nikolay Aleksandrovich Pavlov's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV2cqJZJOXmiUy-XLHXAYrDr_fsBsT7ThEQs9z3uSxF8SxSMw=s40-c)
### Nikolay Aleksandrovich Pavlov

unread,Nov 6, 2017, 6:20:18 PM11/6/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev2017-11-06 20:39 GMT+03:00 Scott Court <z5...@z5t1.com>:

> Update: I just read through the Filesystem Hierarchy Standard more

> carefully, and it appears there actually is a directory for this purpose:

> /var/lib in which the FHS states we can create a /var/lib/vim/swap

> subdirectory in for this purpose.

>

> From

> <http://www.pathname.com/fhs/pub/fhs-2.3.html#VARLIBLTEDITORGTEDITORBACKUPFILESAN>

>

> /var/lib/<editor> : Editor backup files and state (optional)

>

> Purpose

>

> These directories contain saved files generated by any unexpected

> termination of an editor (e.g., elvis, jove, nvi).

>

> Other editors may not require a directory for crash-recovery files, but may

> require a well-defined place to store other information while the editor is

> running. This information should be stored in a subdirectory under /var/lib

> (for example, GNU Emacs would place lock files in /var/lib/emacs/lock).

>

> Maybe we should store the .swp files there.

That needs active support from package maintainers: on my system

(Gentoo) /var/lib is writeable only by root and I do not think that is

uncommon. So Vim cannot create a directory there on its own when run

by a user and it needs to be created by a package when it is

installed. And there is still a question regarding what to do on

Windows.

Neovim has currently chosen to store swap, undo, backup (fallback,

first directory is still dot) and view files under $XDG\_DATA\_HOME/nvim

(Windows: $XDG\_DATA\_HOME is %LOCALAPPDATA%, but suffix is `nvim-data`

unlike just `nvim` on \*nix because $XDG\_CONFIG\_HOME is also

%LOCALAPPDATA% (our choice and not a standard, XDG does not apply on

Windows)). Reasoning (including “why you should not consider

‘preventing simultaneous access’ a valid argument for existence of

swap files in a particular location”) may be seen in

<https://github.com/neovim/neovim/issues/4481>.

> --

> --

> You received this message from the "vim\_dev" maillist.

> Do not top-post! Type your reply below the text you are replying to.

> For more information, visit <http://www.vim.org/maillist.php>

>

> ---

> You received this message because you are subscribed to the Google Groups

> "vim\_dev" group.

> To unsubscribe from this group and stop receiving emails from it, send an

> email to vim\_dev+u...@googlegroups.com.

> For more options, visit <https://groups.google.com/d/optout>.

![Scott Court's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUyL6TGLBMFSg8-4pkglWcW7Cvl9mb4c8vppaxgYNm1jyJkqA=s40-c)
### Scott Court

unread,Nov 6, 2017, 7:41:10 PM11/6/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.comThose are very valid points, and I agree that the way Neovim handles

.swp files is better. I've already explained on here and on Openwall

numerous reasons why I believe that is the best solution and made the

case that .swp files should be stored in ~/.vim/swap by default. However

Bram has veto power and shot that idea down.

So instead I'm trying to find the next best way to address this.

/var/lib being writable only by root and therefore requiring cooperation

from packagers did not occur to me, but that's definitely a problem.

Maybe it would be doable as a major change in the next major release of

Vim, but you're right; that definitely won't work as a security patch.

So much for that idea.

I maintain a Linux Distribution (Cucumber Linux) and have already

adopted the Neovim style ~/.vim/swap approach on there. Maybe we'll just

have to hope that other distributions independently start doing

something similar, as Bram seems pretty convinced this problem is

completely a user error and has nothing to do with the way Vim works;

he's also pretty set on not changing the default .swp location.

signature.asc[](https://groups.google.com/group/vim_dev/attach/870c8e113ab97/signature.asc?part=0.1)![Gary Johnson's profile photo](https://lh3.googleusercontent.com/a/default-user=s40-c)
### Gary Johnson

unread,Nov 6, 2017, 8:15:10 PM11/6/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.comOn 2017-11-06, Scott Court wrote:

> Those are very valid points, and I agree that the way Neovim handles

> .swp files is better. I've already explained on here and on Openwall

> numerous reasons why I believe that is the best solution and made the

> case that .swp files should be stored in ~/.vim/swap by default. However

> Bram has veto power and shot that idea down.

>

> So instead I'm trying to find the next best way to address this.

> /var/lib being writable only by root and therefore requiring cooperation

> from packagers did not occur to me, but that's definitely a problem.

> Maybe it would be doable as a major change in the next major release of

> Vim, but you're right; that definitely won't work as a security patch.

> So much for that idea.

What about using /var/tmp instead of /var/lib? It's writable by

everyone and my notes say that it is not cleared at power-up, but my

notes don't include a reference for that claim.

Regards,

Gary

![Nikolay Aleksandrovich Pavlov's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV2cqJZJOXmiUy-XLHXAYrDr_fsBsT7ThEQs9z3uSxF8SxSMw=s40-c)
### Nikolay Aleksandrovich Pavlov

unread,Nov 6, 2017, 8:15:44 PM11/6/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev2017-11-06 22:40 GMT+03:00 Scott Court <z5...@z5t1.com>:

> Those are very valid points, and I agree that the way Neovim handles

> .swp files is better. I've already explained on here and on Openwall

> numerous reasons why I believe that is the best solution and made the

> case that .swp files should be stored in ~/.vim/swap by default. However

> Bram has veto power and shot that idea down.

>

> So instead I'm trying to find the next best way to address this.

> /var/lib being writable only by root and therefore requiring cooperation

> from packagers did not occur to me, but that's definitely a problem.

> Maybe it would be doable as a major change in the next major release of

> Vim, but you're right; that definitely won't work as a security patch.

> So much for that idea.

>

> I maintain a Linux Distribution (Cucumber Linux) and have already

> adopted the Neovim style ~/.vim/swap approach on there. Maybe we'll just

> have to hope that other distributions independently start doing

> something similar, as Bram seems pretty convinced this problem is

> completely a user error and has nothing to do with the way Vim works;

> he's also pretty set on not changing the default .swp location.

This is not Neovim style, we use XDG and XDG says that user

configuration goes to $XDG\_CONFIG\_HOME while various data files (which

includes swap files) go to $XDG\_DATA\_HOME: these are separate places,

and for a good reason: users which keep their dotfiles under VCS would

normally keep ~/.vim under version control and placing swap files

there will require ignoring that. On the other hand, assuming all

applications strictly follow XDG it is fine to keep the entire

$XDG\_CONFIG\_HOME under VCS control without exceptions. Though not

really the case, but users do post bug reports regarding violations

and it is one of the major considerations when deciding between

CONFIG\_HOME and other variants.

![Bram Moolenaar's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUPk2XnJEQUtWlW0QSPj-JuFkQmiQJYKeE7MtgRjEU777o8_3GH=s40-c)
### Bram Moolenaar

unread,Nov 6, 2017, 8:33:20 PM11/6/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.com, Scott Court

Scott Court wrote:

> Those are very valid points, and I agree that the way Neovim handles

> .swp files is better. I've already explained on here and on Openwall

> numerous reasons why I believe that is the best solution and made the

> case that .swp files should be stored in ~/.vim/swap by default. However

> Bram has veto power and shot that idea down.

>

> So instead I'm trying to find the next best way to address this.

> /var/lib being writable only by root and therefore requiring cooperation

> from packagers did not occur to me, but that's definitely a problem.

> Maybe it would be doable as a major change in the next major release of

> Vim, but you're right; that definitely won't work as a security patch.

> So much for that idea.

>

> I maintain a Linux Distribution (Cucumber Linux) and have already

> adopted the Neovim style ~/.vim/swap approach on there. Maybe we'll just

> have to hope that other distributions independently start doing

> something similar, as Bram seems pretty convinced this problem is

> completely a user error and has nothing to do with the way Vim works;

> he's also pretty set on not changing the default .swp location.

There are a few situations you need to consider:

- Removable media, editing a file on a USB stick.

- Remote file systems (where the mount point may change over time).

- Multiple users editing a shared file.

- Renaming directories.

There are likely many more

--

FATAL ERROR! SYSTEM HALTED! - Press any key to continue doing nothing.

![Nikolay Aleksandrovich Pavlov's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV2cqJZJOXmiUy-XLHXAYrDr_fsBsT7ThEQs9z3uSxF8SxSMw=s40-c)
### Nikolay Aleksandrovich Pavlov

unread,Nov 6, 2017, 8:36:44 PM11/6/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_devIt is rather distribution-specific. AFAIR I have seen distributions

where this is the same as /tmp (one or the other is a symlink),

missing or not actually writeable by not root. Third is my case BTW,

though I do not remember whether it is Gentoo default or I have messed

up something; in any case no apps complain about such state of things:

I only have three directories there and all are related to system

package manager:

1. /var/tmp/portage with user:group portage:portage, 0775. The default

location for build files.

2. /var/tmp/distfiles, root:portage, 0775. Not default location, but

my own preference for where to keep source code archives.

3. /var/tmp/genkernel, root:root, 0755. Default location for genkernel

temporary files used when it builds the kernel.

`man hier` states that /var/tmp is like /tmp, but for “temporary files

stored for an unspecified duration” and that it itself is from FHS

version 2.3, so probably I messed up something with permissions

(handbook also briefly mentions 1777 permissions for /var/tmp), but

still it works like that.

>

> Regards,

> Gary

![Nikolay Aleksandrovich Pavlov's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV2cqJZJOXmiUy-XLHXAYrDr_fsBsT7ThEQs9z3uSxF8SxSMw=s40-c)
### Nikolay Aleksandrovich Pavlov

unread,Nov 6, 2017, 9:26:48 PM11/6/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev, Scott Court- Remote file systems is a case \*against\* using swap files in the

current directory, should they be slow Vim starts being unresponsive

when it does something with swap file.

- Removable media is a case against swap files as well: while nowadays

you are unlikely to exhaust write cycles or cause unresponsiveness by

using swap files there, there are still considerations like

 1. Whether “user saved and removed the media without properly

closing the editor or wiping out buffer” is less common scenario then

“user removed the media without …, but did not save and now wants to

restore on another machine”. Swap files there are welcome only if

second scenario is more common, but there is a second point as well.

 2. Removable media is also commonly used for sharing not between

computers belonging to one user, but between computers belonging to

different users. Swap files would be nothing other then annoying

garbage when shared with a user not using \*Vim and either using

Windows (i.e. OS which does not hide dotfiles) or having his file

manager configured to show hidden files. Also if files with swap files

nearby were edited on such a machine trying to restore something from

them will do more harm then good.

- Swap files are utterly useless for preventing editing a single file

by multiple users: way too many conditions need to be true for that to

work: users need to both use \*Vim, users need to both have configured

to save swap files in the current directory, users need to pay

attention and not discard the message thinking e.g. that it was an

artifact from previous disconnect.

 Also Vim does not provide any way to do anything sensible with the

situation “two users simultaneously edit the same file”. False

positives and negatives do not make the situation better as well:

neither Vim checks whether currently running process with PID stored

in swap file has anything to do with the creator of swap files, nor

there is any way to determine whether simultaneous editing actually

happens in “remote file system with access from different machines”

and “access from same machine, but separated via various means like

PID namespaces” cases. Enough false alarms and users will stop caring

about them.

- Yet another case \*against\* the idea of `set directory=.`: consider

the simple script which simulates renaming directory without closing

the file:

 mkdir test-br.d

 #vim -u NONE -i NONE -N \

 # test-br.d/file \

 # -c write -c '!mv test-br.d test-ar.d' \

 # -c 'file test-ar.d/file' \

 vim -u NONE -i NONE -N \

 test-br.d/file \

 -c write \

 -c '!mv test-br.d test-ar.d' \

 -c 'bw' \

 -c 'edit test-ar.d/file'

 What will you see in both commented and uncommented cases? Right,

E325: ATTENTION! Is there any value in seeing it? No, file was already

saved, PID belongs to the same Vim instance, but, unfortunately, you

can’t delete that swap file from Vim menu for Vim process being

“already running”. But should you have

 rm -rf test-br?.d

 mkdir test-br.d

 mkdir test-swap.d

 vim -u NONE -i NONE -N \

 --cmd 'let &directory=getcwd()."/test-swap.d//"' \

 test-br.d/file \

 -c write \

 -c '!mv test-br.d test-ar.d' \

 -c 'bw' \

 -c 'edit test-ar.d/file'

 and Vim automatically and correctly deletes the no-longer-needed

swap file attached to the previous location of the file.

>

> --

> FATAL ERROR! SYSTEM HALTED! - Press any key to continue doing nothing.

>

> /// Bram Moolenaar -- Br...@Moolenaar.net -- <http://www.Moolenaar.net> \\\

> /// sponsor Vim, vote for features -- <http://www.Vim.org/sponsor/> \\\

> \\\ an exciting new programming language -- <http://www.Zimbu.org> ///

> \\\ help me help AIDS victims -- <http://ICCF-Holland.org> ///

>

![Christoffer Aasted's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWwlQgbEE9UuvO5Iv1wcskioRcRR_CTfQI6abWv5zhJz3SiCw=s40-c)
### Christoffer Aasted

unread,Nov 6, 2017, 10:27:49 PM11/6/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.comI’d like to add that few programs litter the filesystem like this. It is much more common for multi-user systems via ssh to get disconnected and leave a swap. It would make more sense to recreate a temporary directory for this. I’m not so much in for the security, but I believe in retaining the ability to trigger a warning on editing the same file on multi-user - meanwhile avoiding using the whole filesystem and network shares for this unless explicitly enabled. There could be multiple solutions for this and I believe Bram would have a say that could improve this refactoring if it could be done.


> You received this message because you are subscribed to a topic in the Google Groups "vim\_dev" group.
>
> To unsubscribe from this topic, visit <https://groups.google.com/d/topic/vim_dev/sRT9BtjLWMk/unsubscribe>.
>
> To unsubscribe from this group and all its topics, send an email to vim\_dev+u...@googlegroups.com.

> For more options, visit <https://groups.google.com/d/optout>.

--

Best Regards/Venlig Hilsen
Christoffer Aasted
![Nikolay Aleksandrovich Pavlov's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV2cqJZJOXmiUy-XLHXAYrDr_fsBsT7ThEQs9z3uSxF8SxSMw=s40-c)
### Nikolay Aleksandrovich Pavlov

unread,Nov 7, 2017, 1:48:34 AM11/7/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev2017-11-07 1:27 GMT+03:00 Christoffer Aasted <chr.a...@gmail.com>:

> I’d like to add that few programs litter the filesystem like this. It is

> much more common for multi-user systems via ssh to get disconnected and

> leave a swap. It would make more sense to recreate a temporary directory for

> this. I’m not so much in for the security, but I believe in retaining the

> ability to trigger a warning on editing the same file on multi-user -

> meanwhile avoiding using the whole filesystem and network shares for this

> unless explicitly enabled. There could be multiple solutions for this and I

> believe Bram would have a say that could improve this refactoring if it

> could be done.

Well, you got a warning and now what? Warning itself is useless

without a plan for handling the issue. Could you at least first write

an exact plan how \*you\* are going to handle the situation in your

specific case?

Then imagine that you want to extend `:h E325` with a more useful and

multi-user-environment-adapted advice then just “you must find out

what the situation is yourself”. I guess that would include, at least,

`ps` and somehow determining the machine identifier (e.g. IP or

internal hostname) of whoever connected to a ssh (because in some

cases different people may not have dedicated users and instead

connect using a single one); then somehow connecting `ps` output

(likely user name) or machine identifier with some kind of

communication channel. And lots of if’s covering permission issues.

One should also not forget that advice will probably start with “open

another shell” or “copy the information and press Q”: user may want to

retain data displayed with E325 to e.g. start checking the process ID,

but Vim is rather unfriendly here, this data is not even in

`:messages` and `<C-z>` does not work.

Also you should not forget one thing: if you have E325 then some other

user \*may\* be editing the same file you are editing. But both it is

\*may\*, and the opposite is absolutely not true: there are lots of

cases when other user is editing the same file as you, but you do not

get a warning because he

- is not using Vim;

- prefers to use scp://;

- has different &directory setting;

- …

This means that unless you have an agreement with all your collegues

to use Vim in a set way the mechanizm is absolutely unreliable and

thus better be not used for the purpose to not make you have a feeling

of the false safety.

On the other hand if you \*do\* have an agreement you \*don’t\* need to

rely on Vim defaults: just also agree e.g. that some &directory value

will be set in /etc/vimrc and must not be overridden by vimrc, it is

also not impossible to create autocommands which will check following

that agreement automatically.

![Christian Brabandt's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWiHR5GRz7AF2elHXCdc4YvLH7OqmOwDXRN6Th42aEf2UaHZmdW=s40-c)
### Christian Brabandt

unread,Nov 7, 2017, 12:37:57 PM11/7/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim\_dev

On Di, 07 Nov 2017, Nikolay Aleksandrovich Pavlov wrote:

> - Yet another case \*against\* the idea of `set directory=.`: consider

> the simple script which simulates renaming directory without closing

> the file:

It is not about renaming a directory while simultaneously editing a

file. What is meant with renaming a directory is, that if you have a

swapfile from a crashed session laying around (and the path has changed

because of moving/renaming a path component in between), Vim will

automatically notice that a previous editing session crashed and offer

you a way to recover your file.

Christian

--

Sein Jahrhundert kann man nicht verändern, aber man kann sich

dagegenstellen und glückliche Wirkungen vorbereiten.

 -- Johann Wolfgang von Goethe (Lehrjahre)

![Bram Moolenaar's profile photo](//lh3.googleusercontent.com/a-/ALV-UjUPk2XnJEQUtWlW0QSPj-JuFkQmiQJYKeE7MtgRjEU777o8_3GH=s40-c)
### Bram Moolenaar

unread,Nov 7, 2017, 12:46:49 PM11/7/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto vim...@googlegroups.com, Nikolay Aleksandrovich Pavlov, Scott CourtI don't get this. I use remote file systems all the time, from

different systems. Having the swap file in the same directory has saved

my work quite a number of times. Sudden disconnects are the main thing,

having to go to the file from a different system and use "vim -r". That

is impossible if the swap file is on a system that became unreachable.

If the original file becomes unreachable you can't do anything anyway.

On top of that, having the warning that a swap file exists, meaning you

already changed the file from another system, also often is a life

saver. Happens for me quite often when working on a test that fails on

MS-Windows.

> - Removable media is a case against swap files as well: while nowadays

> you are unlikely to exhaust write cycles or cause unresponsiveness by

> using swap files there, there are still considerations like

>

> 1. Whether “user saved and removed the media without properly

> closing the editor or wiping out buffer” is less common scenario then

> “user removed the media without …, but did not save and now wants to

> restore on another machine”. Swap files there are welcome only if

> second scenario is more common, but there is a second point as well.

That's exactly what happens: you edit a file on a USB stick, do

something else, have to catch a train, close the laptop without saving,

take the stick elsewhere, and now your swap file is on a system at home

while you are at work...

> 2. Removable media is also commonly used for sharing not between

> computers belonging to one user, but between computers belonging to

> different users. Swap files would be nothing other then annoying

> garbage when shared with a user not using \*Vim and either using

> Windows (i.e. OS which does not hide dotfiles) or having his file

> manager configured to show hidden files. Also if files with swap files

> nearby were edited on such a machine trying to restore something from

> them will do more harm then good.

That does not match my experience, sounds uncommon to me.

> - Swap files are utterly useless for preventing editing a single file

> by multiple users: way too many conditions need to be true for that to

> work: users need to both use \*Vim, users need to both have configured

> to save swap files in the current directory, users need to pay

> attention and not discard the message thinking e.g. that it was an

> artifact from previous disconnect.

It works very well for me. In multi-user setups it does get more

tricky, but using your personal store for swap files isn't going to be

an improvement in any way.

The only situation I'm aware of is when the swap file gets picked up by

a tool in an unwanted way. E.g. when creating an archive from a

directory or a version control system that isn't setup to ignore swap

files. In that case you want to set 'directory', that's what it is for.

> Also Vim does not provide any way to do anything sensible with the

> situation “two users simultaneously edit the same file”. False

> positives and negatives do not make the situation better as well:

> neither Vim checks whether currently running process with PID stored

> in swap file has anything to do with the creator of swap files, nor

> there is any way to determine whether simultaneous editing actually

> happens in “remote file system with access from different machines”

> and “access from same machine, but separated via various means like

> PID namespaces” cases. Enough false alarms and users will stop caring

> about them.

Does not match my experience. Two different users editing the same file

is very uncommon anyway. In most cases it's the same person working

from different accounts.

Yeah, I've been thinking of a way to delete the swap file automatically,

without the risk of deleting it when it's still needed. Work to be

done. BTW: this is independent of what 'directory' is set to, the swap

file will always refer to the original location.

--

The most powerful force in the universe is gossip.

![Nikolay Aleksandrovich Pavlov's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV2cqJZJOXmiUy-XLHXAYrDr_fsBsT7ThEQs9z3uSxF8SxSMw=s40-c)
### Nikolay Aleksandrovich Pavlov

unread,Nov 8, 2017, 11:47:53 PM11/8/17Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Bram Moolenaar, vim\_dev, Scott CourtHow would it help in deleting swap files? Simple test:

```

% mkdir abc

% touch abc/{a,b,c}

% vim -u NONE -i NONE -N --cmd 'set hidden' abc/? -c 'bufdo normal! i'

-c 'set directory=/tmp'

<C-z>

% ls -lA abc

```

How many swap files have Vim deleted from abc? Zero, &directory

changes do not apply for existing buffers with swap files already

assigned.

>

>> Also Vim does not provide any way to do anything sensible with the

>> situation “two users simultaneously edit the same file”. False

>> positives and negatives do not make the situation better as well:

>> neither Vim checks whether currently running process with PID stored

>> in swap file has anything to do with the creator of swap files, nor

>> there is any way to determine whether simultaneous editing actually

>> happens in “remote file system with access from different machines”

>> and “access from same machine, but separated via various means like

>> PID namespaces” cases. Enough false alarms and users will stop caring

>> about them.

>

> Does not match my experience. Two different users editing the same file

> is very uncommon anyway. In most cases it's the same person working

> from different accounts.

This concern does not completely nullify a point, just makes discovery

of the source of the problem easier and the situation looking more

likely: one user with two accounts or two users with two accounts,

there still is no protocol for the case in documentation and “swap

file exists” warning forces to make a decision right there, without

any checks (like running `ps`) should you forget that you were editing

a file.

Though in place of “should you forget” there is more practical example

of the case which needs investigation before making decision I once

experienced: I knew that previous session crashed, but Vim still

reported it as running: obviously, I got PID collision, but it is not

like I knew the mechanics of such detection at that point.

But if &directory is a dedicated directory in the above case Vim

deletes the swap file because buffer name did not change and neither

did location of the swap file. If it is dot original buffer name did

not change, but location of swap file did, so swap file of the

original buffer is considered “lost” (with a warning), and yet it

can’t be deleted from Vim dialogue.

>

> --

> The most powerful force in the universe is gossip.

>

> /// Bram Moolenaar -- Br...@Moolenaar.net -- <http://www.Moolenaar.net> \\\

> /// sponsor Vim, vote for features -- <http://www.Vim.org/sponsor/> \\\

> \\\ an exciting new programming language -- <http://www.Zimbu.org> ///

> \\\ help me help AIDS victims -- <http://ICCF-Holland.org> ///

It looks like the main reasoning is “ability to omit saving your work”

in conjunction with “working from a different computers with no easy

access to previously used ones”: without one or the other neither of

your points can make swap files in the current directory useful. My

experience says that while some of my collegues sometimes forget to

save even though they know they do not have UPS and power is known to

flash sometimes, second point is almost non-existent.

And as you said earlier, there \*is\* &directory setting, nobody is

voicing to remove it, just change the defaults. If dot suits your

workflow better you can set dot, but I very doubt that most Vim users

- do not use archives (or enjoy garbage there),

- do not share files on flash cards with non-Vim users which find swap

files suspicious garbage (just garbage if you explain) (BTW, not

necessary non-\*nix users: I once enabled showing hidden files and got

complains about single empty (dolphin configured so it would not leave

anything there) .Trash),

- love to create local .vcsignore files (also not all authors tolerate

swap file ignoring in project .vcsignore and local .vcsignore files

are for some reason less of a common knowledge),

- like to receive swap files in rarely needed `ag --unrestricted` (or

e.g. `grep -a`) output,

- find `ls -lA` output with garbage out there good and

- would not want to be able to create a fast and simple script which

does automatic recovery after a crash: swap files management is easier

if all swap files are in one location.

So far Neovim received almost no complains about the new default.

I have also checked how swap file location makes difference with a

laggy network filesystem (Yandex disk, but mounted with webdav in

place of using their FS synchronizing daemon):

 time (vim -u NONE -i NONE -N ~/mnt/yandex/foo --cmd 'set directory=.' -c cq)

reports almost six seconds (5.9),

 time (vim -u NONE -i NONE -N ~/mnt/yandex/foo --cmd 'set

directory=~/.vimswap//' -c cq)

reports less then a second (0.7 seconds). `~/mnt/yandex/foo` does not

exist, `~/mnt/yandex` is a wdfs (FUSE) network mount.

---

BTW I have a habit of saving file immediately I pause for a moment to

think for the next action, and for a good reasons: neither all

software I am using bothers with some kind of autosaving or recovery,

nor I find that autosave/recovery being always reliable.

Reply allReply to authorForward0 new messages

=== Content from lists.debian.org_44e27aac_20250125_171156.html ===


---

[[Date Prev](msg00002.html)][[Date Next](msg00004.html)]
[[Thread Prev](msg00002.html)][[Thread Next](msg00004.html)]
[[Date Index](maillist.html#00003)]
[[Thread Index](threads.html#00003)]

# [SECURITY] [DLA 1871-1] vim security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1871-1] vim security update
* *From*: Sylvain Beucler <beuc@beuc.net>
* *Date*: Sat, 3 Aug 2019 12:22:32 +0200
* *Message-id*: <[[🔎]](/msgid-search/20190803102232.w4fl5vi2chhejkbm%40mail.beuc.net) [20190803102232.w4fl5vi2chhejkbm@mail.beuc.net](msg00003.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : vim
Version        : 2:7.4.488-7+deb8u4
CVE ID         : CVE-2017-11109 CVE-2017-17087 CVE-2019-12735
Debian Bug     : 867720 930020

Several minor issues have been fixed in vim, a highly configurable
text editor.

CVE-2017-11109

    Vim allows attackers to cause a denial of service (invalid free)
    or possibly have unspecified other impact via a crafted source
    (aka -S) file.

CVE-2017-17087

    Vim sets the group ownership of a .swp file to the editor's
    primary group (which may be different from the group ownership of
    the original file), which allows local users to obtain sensitive
    information by leveraging an applicable group membership.

CVE-2019-12735

    Vim did not restrict the `:source!` command when executed in a
    sandbox.

For Debian 8 "Jessie", these problems have been fixed in version
2:7.4.488-7+deb8u4.

We recommend that you upgrade your vim packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCgAdFiEEQic8GuN/xDR88HkSj/HLbo2JBZ8FAl1FX5YACgkQj/HLbo2J
BZ89qgf8CoBW+7zggqjjTCsK4uFDShdFdpT3jqGhAsZt+N/j5J2BasHH9d00hidJ
c/gT8Mx5yZJ7+nvws7ysQ2wSk9WLqQ6cm5O5nN4GpAE6TE/Gzoxa0niTYniGDAwO
Fau+xxpNiCeXnTc5L1UeXNs6SQhnYFIdTo47BI957F4mJPW3WR0ka0tExgDTAdhY
yLh0lZLe6/8/3/e+xVaAkNW8y0NXcKbEJH2uNB0//VgeLhSQaM2vTo9hlkoASDyU
Ibase1K5FHYFziU0y+zRtvTySoJV1XQ8etiI7PwU59rLeWmyQy6W8drMgpzZXEaq
VSQJ3SjXXYQulK0Y+SqaiUuxHN5dqw==
=yqrh
-----END PGP SIGNATURE-----

```

---



=== Content from openwall.com_4d717aee_20250125_171144.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2017/11/22/9) [[thread-next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <540058ee-2c54-161a-1530-ff1b05673d25@Z5T1.com>
Date: Mon, 27 Nov 2017 14:10:54 -0500
From: Scott Court <z5t1@...1.com>
To: Kurt Seifried <kseifrie@...hat.com>
Cc: oss-security@...ts.openwall.com, Bram@...lenaar.net
Subject: Re: Re: Security risk of server side text editing ...

Hi Kurt,

Here's the summary you asked for. As far as I've been able to tell,
there are three vulnerabilities being discussed here:

    1. CVE-2017-1000382

This vulnerability was discovered by Hanno Böck. When editing a text
file in Vim, a .swp file is created in the same directory (if you edit
"foo", the swap file will be ".foo.swp"). Hanno pointed out that this
could create a security vulnerability on PHP enabled webservers as follows:

If a user goes to edit a .php file in the public_html directory (say
"foo.php"), a swap file will be created in the public_html directory
called ".foo.php.swp". This then exposes the contents of the PHP script
foo.php to the world. All someone has to do is go to
"<http://example.com/.foo.php.swp>" and he can view the .swp file which
contains the contents of the original foo.php file.

Hanno pointed out that this causes a problem with Wordpress sites if the
site administrator edits the wp-config.php file in Vim: he exposes all
of the database credentials. This is made worse if Vim crashes while he
is editing it as then the .wp-config.php.swp file sticks around. He
claims he has found 750 websites that are vulnerable to this.

    2. Vim .swp file group (Doesn't have a CVE ID)

This vulnerability was discovered by me. When Vim creates a .swp file,
the .swp file is created with the owner and group set to the editor and
editor's primary group respectively. The .swp file is the set to the
same permissions as the original file (i.e. chmod 640). This creates a
security vulnerability when the editor's primary group is not the same
as the original file's group.

For example, say the root user's primary group is "users", which every
user is a member of. If root goes to edit /etc/shadow, the
/etc/.shadow.swp file is created with permissions 640 and user:group set
to root:users. The original /etc/shadow file had user:group set to
root:shadow though; this now exposes the /etc/shadow file (which mind
you contains hashes of every user's password) to every user on the system.

Originally, I thought this was an extension of CVE-2017-1000382 so I
didn't bother trying to get a CVE ID for it; however, upon looking at it
for a second time, it seems that this is indeed a different
vulnerability. It is possible to patch this vulnerability without
patching CVE-2017-1000382.

    3. Vim.tiny race condition (Doesn't have a CVE ID as far as I know)

I'm not quite sure who discovered this vulnerability (I don't use or
follow vim.tiny); however, it has been discussed on here so I will
include my limited knowledge of it for completeness sake. This is a race
condition in which a world writable SUID binary is temporarily created.
This could (or course) theoretically allow an arbitrary user to write to
that binary and execute arbitrary code as root; however, there is debate
as to whether or not doing this is actually feasible.

---

I believe these are the three big ones; however, I may have missed
something. There has been a lot of discussion about this family of
vulnerabilities lately. There are definitely at least these three
though. I'm sure if I've missed anything everyone else on this mailing
list will be more than happy to let me know.

Sincerely,

Scott Court

On 11/22/2017 05:27 PM, Kurt Seifried wrote:
> Can you post a summary of the issues, it sounds like more than one CVE will be needed, thanks.
>
>
> -Kurt
>
>
>
>
>
>> On Nov 22, 2017, at 15:17, Solar Designer <solar@...nwall.com> wrote:
>>
>>> On Fri, Nov 17, 2017 at 11:35:15AM +0100, Bram Moolenaar wrote:
>>> Please check out patch 8.0.1300.
>> Thanks.  Personally, I don't have much to add.  This continues to do
>> what I find are weird and wrong things, so any implementation issues are
>> secondary to that.  I suppose you have some rationale for preserving the
>> old behavior of propagating the edited file's permissions onto related
>> temporary files, but I'm unaware of good reasons for that.
>>
>> If it's about users' collaboration, then I don't see a good reason for
>> other users in the group, even if they could access the original file
>> via group permissions, to also have access to recovery and backup files.
>>
>> As to the patch itself, aside from it propagating the possibly unsafe
>> permissions on purpose (I mean unsafe such as in Hanno's original
>> example, but also applying to backup files), it's also risky in
>> temporarily setting umask to 0.  On some systems, this could mean libc
>> or the kernel creating files with unsafe permissions if anything goes
>> very wrong during this time - e.g., a coredump.  Checking st_ino is OK
>> as a hardening measure, but might not always be sufficient: inode number
>> reuse is possible if the original file could have been deleted.
>> I suppose st_dev is not checked because of the use of O_NOFOLLOW, but I
>> guess Vim can be built on systems without working O_NOFOLLOW as well?
>>
>> In case anyone wants to review the patch for real, I've attached it to
>> this message, and here it is on GitHub (for expanding of the context):
>>
>> <https://github.com/vim/vim/commit/cd142e3369db8888163a511dbe9907bcd138829c>
>>
>> Alexander
>> <8.0.1300>

Content of type "text/html" skipped

Download attachment "[signature.asc](2/1)" of type "application/pgp-signature" (820 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.ubuntu.com_be8ed54b_20250126_103200.html ===


| **ubuntu-hardened -- Ubuntu security discussion** | |
| --- | --- |
|  | |
| **About ubuntu-hardened** | English (USA)   Chinese (Taiwan) |
| Discussion on Ubuntu security updates, development of new security technologies, and general "hardening" of the operating system.  A place to talk about MAC systems (SELinux, AppArmor, Smack) in Ubuntu, about both kernel-level and user-land security improvements and technologies, etc.  To see the collection of prior postings to the list, visit the [ubuntu-hardened Archives](https://lists.ubuntu.com/archives/ubuntu-hardened). | |
| **Using ubuntu-hardened** | |
| To post a message to all the list members, send email to ubuntu-hardened@lists.ubuntu.com. You can subscribe to the list, or change your existing subscription, in the sections below. | |
| **Subscribing to ubuntu-hardened** | |
| Subscribe to ubuntu-hardened by filling out the following form. You will be sent email requesting confirmation, to prevent others from gratuitously subscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.    | Your email address: |  |  | | --- | --- | --- | | Your name (optional): |  |  | | You may enter a privacy password below. This provides only mild security, but should prevent others from messing with your subscription. **Do not use a valuable password** as it will occasionally be emailed back to you in cleartext. If you choose not to enter a password, one will be automatically generated for you, and it will be sent to you once you've confirmed your subscription. You can always request a mail-back of your password when you edit your personal options. | | | | Pick a password: |  |  | | Reenter password to confirm: |  |  | | Which language do you prefer to display your messages? | English (USA)   Chinese (Taiwan) |  | | Would you like to receive list mail batched in a daily digest? | No  Yes | |  | | | | |

| **ubuntu-hardened Subscribers** | |
| (*The subscribers list is only available to the list administrator.*) Enter your admin address and password to visit the subscribers list: Admin address: Password:  To unsubscribe from ubuntu-hardened, get a password reminder, or change your subscription options enter your subscription email address: If you leave the field blank, you will be prompted for your email address | |

---

[ubuntu-hardened](../listinfo/ubuntu-hardened) list run by jamie at ubuntu.com, mdeslaur at ubuntu.com, sbeattie at ubuntu.com, alex.murray at canonical.com
[ubuntu-hardened administrative interface](../admin/ubuntu-hardened) (requires authorization)
[Overview of all lists.ubuntu.com mailing lists](../listinfo)

| [Delivered by Mailmanversion 2.1.20](http://www.gnu.org/software/mailman/index.html) | [Python Powered](http://www.python.org/) | [GNU's Not Unix](http://www.gnu.org/) | [Debian Powered](http://www.debian.org/) |
| --- | --- | --- | --- |

[![](http://tuxedo-es.org/images/hardened_debian.png)](http://www.debian-hardened.org)



=== Content from github.com_26694046_20250126_103204.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadviso)

[adviso](/adviso)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadviso)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Corg-login%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@adviso](https://avatars.githubusercontent.com/u/2564848?s=200&v=4)

# Adviso

* [7
  followers](/orgs/adviso/followers)
* Canada
* [http://www.adviso.ca](http://www.adviso.ca "www.adviso.ca")
* github@adviso.ca

* [Overview](/adviso)
* [Repositories](/orgs/adviso/repositories)
* [Projects](/orgs/adviso/projects)
* [Packages](/orgs/adviso/packages)
* [People](/orgs/adviso/people)

More

* [Overview](/adviso)
* [Repositories](/orgs/adviso/repositories)
* [Projects](/orgs/adviso/projects)
* [Packages](/orgs/adviso/packages)
* [People](/orgs/adviso/people)

## Popular repositories Loading

1. [RAdwordsPlus](/adviso/RAdwordsPlus) RAdwordsPlus
   Public

   Improvements over the RAdwords package.

   R

   [3](/adviso/RAdwordsPlus/stargazers)
   [3](/adviso/RAdwordsPlus/forks)
2. [www](/adviso/www) www
   Public
3. [googleLanguageR](/adviso/googleLanguageR) googleLanguageR
   Public

   Forked from [ropensci/googleLanguageR](/ropensci/googleLanguageR)

   R client for the Google Translation API, Google Cloud Natural Language API and Google Cloud Speech API

   R
4. [dbt-ga4](/adviso/dbt-ga4) dbt-ga4
   Public

   Forked from [Velir/dbt-ga4](/Velir/dbt-ga4)

   dbt Package for modeling raw data exported by Google Analytics 4. BigQuery support, only.

   SQL

### Repositories

 Loading

 Type

Select type

All

Public

Sources

Forks

Archived

Mirrors

Templates

 Language

Select language

All

R

SQL

 Sort

Select order

Last updated

Name

Stars

Showing 4 of 4 repositories

* [dbt-ga4](/adviso/dbt-ga4)
  Public

  Forked from
  [Velir/dbt-ga4](/Velir/dbt-ga4)

  dbt Package for modeling raw data exported by Google Analytics 4. BigQuery support, only.

   adviso/dbt-ga4’s past year of commit activity

  SQL

  0

  MIT

  [145](/adviso/dbt-ga4/forks)
  [0](/adviso/dbt-ga4/issues)
  [0](/adviso/dbt-ga4/pulls)
  Updated Jun 4, 2024
* [RAdwordsPlus](/adviso/RAdwordsPlus)
  Public

  Improvements over the RAdwords package.

   adviso/RAdwordsPlus’s past year of commit activity

  R

  [3](/adviso/RAdwordsPlus/stargazers)

  GPL-3.0

  [3](/adviso/RAdwordsPlus/forks)
  [2](/adviso/RAdwordsPlus/issues)
  [0](/adviso/RAdwordsPlus/pulls)
  Updated Dec 3, 2019
* [googleLanguageR](/adviso/googleLanguageR)
  Public

  Forked from
  [ropensci/googleLanguageR](/ropensci/googleLanguageR)

  R client for the Google Translation API, Google Cloud Natural Language API and Google Cloud Speech API

   adviso/googleLanguageR’s past year of commit activity

  R

  0

  [43](/adviso/googleLanguageR/forks)
  [0](/adviso/googleLanguageR/issues)
  [0](/adviso/googleLanguageR/pulls)
  Updated Apr 5, 2018
* [www](/adviso/www)
  Public

   adviso/www’s past year of commit activity

  0

  0

  [0](/adviso/www/issues)
  [0](/adviso/www/pulls)
  Updated Mar 13, 2014

[#### People](/orgs/adviso/people)
[![@portalhacker](https://avatars.githubusercontent.com/u/65234487?s=70&v=4)](/portalhacker)

#### Top languages

Loading…

#### Most used topics

Loading…

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_df601724_20250125_171157.html ===


---

[[Date Prev](msg00002.html)][[Date Next](msg00004.html)]
[[Thread Prev](msg00002.html)][[Thread Next](msg00004.html)]
[[Date Index](maillist.html#00003)]
[[Thread Index](threads.html#00003)]

# [SECURITY] [DLA 2876-1] vim security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2876-1] vim security update
* *From*: Anton Gladky <gladk@debian.org>
* *Date*: Mon, 10 Jan 2022 22:50:21 +0100
* *Message-id*: <[[🔎]](/msgid-search/20220110215021.B0AD54A013D%40thinkpad.localdomain) [20220110215021.B0AD54A013D@thinkpad.localdomain](msg00003.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2876-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                         Anton Gladky
January 10, 2022                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : vim
Version        : 2:8.0.0197-4+deb9u4
CVE ID         : CVE-2017-17087 CVE-2019-20807 CVE-2021-3778 CVE-2021-3796

Multiple issues have been discovered in vim: an enhanced vi text editor:

CVE-2017-17087
    fileio.c in Vim sets the group ownership of a .swp file to the editor's primary
    group (which may be different from the group ownership of the original file),
    which allows local users to obtain sensitive information by leveraging an
    applicable group membership.

CVE-2019-20807
    Users can circumvent the rvim restricted mode and execute arbitrary OS
    commands via scripting interfaces (e.g., Python, Ruby, or Lua).

CVE-2021-3778
    Heap-based Buffer Overflow with invalid utf-8 character was detected in
    regexp_nfa.c.

CVE-2021-3796
    Heap Use-After-Free memory error was detected in normal.c. A successful
    exploitation may lead to code execution.

For Debian 9 stretch, these problems have been fixed in version
2:8.0.0197-4+deb9u4.

We recommend that you upgrade your vim packages.

For the detailed security status of vim please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/vim>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEu71F6oGKuG/2fnKF0+Fzg8+n/wYFAmHcqhoACgkQ0+Fzg8+n
/wZilQ//WDE93KpT0jg1kuiTgqhXjdfF+CZVH5NrBkp95OmxkPRe97fwNqgE5Ufd
KqNx/3CV80fWIMtlGRgIK/nMQhiLvmbBlCmaG2UEdgz1SSd5ToU9GvcZXNOy13ps
C8GyGJfuzTMiqME20GfUKm6lIeHkyPbpAAIX/eFI/H3crkyHFqSYFGW/yDYjPvVs
9sF53kYeB7l8gqlKE+2jGownyNZYqmmo3eWakkTl/uCRnedxUEOstUY2woqkQwNe
H5i+Ug5KEPBo6hk5rOPGa196Oqg3nVF2ZOwCDFVC41ODlhespavZCzyZVTXeTRSV
uT4hymineqiPfFSs1qdJwBj3SOkbw3y3ml2d0TX1nTF/YBShELBS1BoL/PR0lgXz
I2v8CbLZLSU036+82lMeic8ayBcT+KS13dBPZWH+afikxdNTfh37+5hb5tci+PAc
cHf/10RNxVEXfpY2HufTIPKmFtAdezkrIDMRiCj1+7oty2EYAI7lwEHcombj4WEu
zlXxN6U58OkCx3PvgRLm2hE22KmIsvJ1hFYRPtizhi/BIxtSb1vF77PV+kB9LYjk
E73Sgrfe6830CQGDxveEQ/rts5moA1ZMHX+tz58z9NkgLmDj/rrpLYclwbm9XaP+
/5rm/OGf/IBbn6w8L0SDfPgjUzi9BF2PPHxcXaQEptJtT0vkW/s=
=9KDF
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_f22bbc39_20250126_103203.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-fmc8-f7rh-x4p9)

**CVE-2017-17087**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-fmc8-f7rh-x4p9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2017-17087](/advisories/GHSA-fmc8-f7rh-x4p9)

## fileio.c in Vim prior to 8.0.1263 sets the group...

Moderate severity

Unreviewed

Published
May 13, 2022
to the GitHub Advisory Database
•
Updated Feb 1, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-fmc8-f7rh-x4p9/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

fileio.c in Vim prior to 8.0.1263 sets the group ownership of a .swp file to the editor's primary group (which may be different from the group ownership of the original file), which allows local users to obtain sensitive information by leveraging an applicable group membership, as demonstrated by /etc/shadow owned by root:shadow mode 0640, but /etc/.shadow.swp owned by root:users mode 0640, a different vulnerability than [CVE-2017-1000382](https://github.com/advisories/GHSA-fc3h-fxv9-79gq "CVE-2017-1000382").

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2017-17087>
* [vim/vim@5a73e0c](https://github.com/vim/vim/commit/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8)
* <https://groups.google.com/d/msg/vim_dev/sRT9BtjLWMk/BRtSXNU4BwAJ>
* <https://lists.debian.org/debian-lts-announce/2019/08/msg00003.html>
* <https://lists.debian.org/debian-lts-announce/2022/01/msg00003.html>
* <https://usn.ubuntu.com/4582-1/>
* <http://openwall.com/lists/oss-security/2017/11/27/2>
* <http://security.cucumberlinux.com/security/details.php?id=166>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2017-17087)
Dec 1, 2017

Published to the GitHub Advisory Database
May 13, 2022

Last updated
Feb 1, 2023

### Severity

Moderate

5.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

### EPSS score

0.042%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (5th percentile)

### Weaknesses

[CWE-668](/advisories?query=cwe%3A668)

### CVE ID

CVE-2017-17087

### GHSA ID

GHSA-fmc8-f7rh-x4p9

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-fmc8-f7rh-x4p9/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from wiki.debian.org_8d48714b_20250126_103200.html ===

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")

[Wiki](/FrontPage "Debian Wiki Homepage")

[Login](/LTS?action=login)

* [FrontPage](/FrontPage)
* [RecentChanges](/RecentChanges)
* [FindPage](/FindPage)
* [HelpContents](/HelpContents)
* [LTS](/LTS)

Search:

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")
[Wiki](/FrontPage "Debian Wiki Homepage")/

* [Login](/LTS?action=login)
* Comments
* [Info](/LTS?action=info)
* [Attachments](/LTS?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  ------------------------
  Load
  Save
  SlideShow

# * [LTS](/LTS)

[Translation(s)](/DebianWiki/EditorGuide#translation): [English](/LTS) - [Deutsch](/de/LTS) - [Español](/es/LTS) - [Français](/fr/LTS) - [Italiano](/it/LTS) - [한국어](/ko/LTS) - [Português](/pt/LTS) - [Português (Brasil)](/pt_BR/LTS) - [Русский](/ru/LTS)

# Debian Long Term Support

Debian Long Term Support (LTS) is a project to extend the lifetime of all Debian stable releases to (at least) 5 years. Debian LTS is not handled by the Debian Security and Release teams, but by a separate group of volunteers and companies interested in making it a success.

Thus the Debian LTS team takes over security maintenance of the various releases once the Debian Security team stops its work.

![/!\](/htdocs/debwiki/img/alert.png "/!\")

LTS ([last modified 2024-08-15 02:46:47](/LTS?action=info))

* Debian [privacy policy](https://www.debian.org/legal/privacy), Wiki [team](/Teams/DebianWiki), [bugs](https://bugs.debian.org/wiki.debian.org) and [config](https://salsa.debian.org/debian/wiki.debian.org).
* Powered by [MoinMoin](https://moinmo.in/ "This site uses the MoinMoin Wiki software.") and [Python](https://moinmo.in/Python "MoinMoin is written in Python."), with hosting provided by [Metropolitan Area Network Darmstadt](https://www.man-da.de/).



=== Content from usn.ubuntu.com_00013498_20250125_171158.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4582-1: Vim vulnerabilities

14 October 2020

Several security issues were fixed in Vim.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.04 ESM](/security/notices?release=bionic)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)

## Packages

* [vim](/security/cves?package=vim) - Vi IMproved - enhanced vi editor

## Details

It was discovered that Vim incorrectly handled permissions on the .swp

file. A local attacker could possibly use this issue to obtain sensitive

information. This issue only affected Ubuntu 16.04 LTS. ([CVE-2017-17087](/security/CVE-2017-17087))

It was discovered that Vim incorrectly handled restricted mode. A local

attacker could possibly use this issue to bypass restricted mode and

execute arbitrary commands. Note: This update only makes executing shell

commands more difficult. Restricted mode should not be considered a

complete security measure. ([CVE-2019-20807](/security/CVE-2019-20807))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.04

* [vim](https://launchpad.net/ubuntu/%2Bsource/vim)
  -
  [2:8.0.1453-1ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/vim/2%3A8.0.1453-1ubuntu1.4)
* [vim-common](https://launchpad.net/ubuntu/%2Bsource/vim)
  -
  [2:8.0.1453-1ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/vim/2%3A8.0.1453-1ubuntu1.4)
* [vim-runtime](https://launchpad.net/ubuntu/%2Bsource/vim)
  -
  [2:8.0.1453-1ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/vim/2%3A8.0.1453-1ubuntu1.4)

##### Ubuntu 16.04

* [vim](https://launchpad.net/ubuntu/%2Bsource/vim)
  -
  [2:7.4.1689-3ubuntu1.5](https://launchpad.net/ubuntu/%2Bsource/vim/2%3A7.4.1689-3ubuntu1.5)
* [vim-common](https://launchpad.net/ubuntu/%2Bsource/vim)
  -
  [2:7.4.1689-3ubuntu1.5](https://launchpad.net/ubuntu/%2Bsource/vim/2%3A7.4.1689-3ubuntu1.5)
* [vim-runtime](https://launchpad.net/ubuntu/%2Bsource/vim)
  -
  [2:7.4.1689-3ubuntu1.5](https://launchpad.net/ubuntu/%2Bsource/vim/2%3A7.4.1689-3ubuntu1.5)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2019-20807](/security/CVE-2019-20807)
* [CVE-2017-17087](/security/CVE-2017-17087)

## Related notices

* [USN-5147-1](/security/notices/USN-5147-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from docs.github.com_332f0a88_20250126_103205.html ===
[Skip to main content](#main-content)[GitHub Docs](/en)Version: Free, Pro, & TeamSearch GitHub DocsSearchSelect language: current language is EnglishOpen Search BarClose Search BarOpen MenuOpen Sidebar

* [Building communities](/en/communities "Building communities")/
* [Moderation](/en/communities/moderating-comments-and-conversations "Moderation")/
* [Manage comments](/en/communities/moderating-comments-and-conversations/managing-disruptive-comments "Manage comments")
[Home](/en)[Building communities](/en/communities)

* Healthy contributions
  + [Management & moderation](/en/communities/setting-up-your-project-for-healthy-contributions/about-community-management-and-moderation)
  + [Community profiles](/en/communities/setting-up-your-project-for-healthy-contributions/about-community-profiles-for-public-repositories)
  + [Access community profiles](/en/communities/setting-up-your-project-for-healthy-contributions/accessing-a-projects-community-profile)
  + [Add a code of conduct](/en/communities/setting-up-your-project-for-healthy-contributions/adding-a-code-of-conduct-to-your-project)
  + [Contributor guidelines](/en/communities/setting-up-your-project-for-healthy-contributions/setting-guidelines-for-repository-contributors)
  + [Add a license to a repo](/en/communities/setting-up-your-project-for-healthy-contributions/adding-a-license-to-a-repository)
  + [Add support resources](/en/communities/setting-up-your-project-for-healthy-contributions/adding-support-resources-to-your-project)
  + [Community health file](/en/communities/setting-up-your-project-for-healthy-contributions/creating-a-default-community-health-file)
  + [Encourage contributions](/en/communities/setting-up-your-project-for-healthy-contributions/encouraging-helpful-contributions-to-your-project-with-labels)
* Issue & PR templates
  + [About templates](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/about-issue-and-pull-request-templates)
  + [Configure](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/configuring-issue-templates-for-your-repository)
  + [Syntax for issue forms](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-issue-forms)
  + [Syntax for GitHub's form schema](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-githubs-form-schema)
  + [Create a PR template](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/creating-a-pull-request-template-for-your-repository)
  + [Create an issue template](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/manually-creating-a-single-issue-template-for-your-repository)
  + [Common validation errors when creating issue forms](/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/common-validation-errors-when-creating-issue-forms)
* Moderation
  + [Manage comments](/en/communities/moderating-comments-and-conversations/managing-disruptive-comments)
  + [Locking conversations](/en/communities/moderating-comments-and-conversations/locking-conversations)
  + [Limit interactions in repo](/en/communities/moderating-comments-and-conversations/limiting-interactions-in-your-repository)
  + [Limit interactions in account](/en/communities/moderating-comments-and-conversations/limiting-interactions-for-your-personal-account)
  + [Limit interactions in org](/en/communities/moderating-comments-and-conversations/limiting-interactions-in-your-organization)
  + [Track comment changes](/en/communities/moderating-comments-and-conversations/tracking-changes-in-a-comment)
  + [Manage abuse in your org](/en/communities/moderating-comments-and-conversations/managing-how-contributors-report-abuse-in-your-organizations-repository)
  + [Manage reported content](/en/communities/moderating-comments-and-conversations/managing-reported-content-in-your-organizations-repository)
* Maintaining safety
  + [Block from your account](/en/communities/maintaining-your-safety-on-github/blocking-a-user-from-your-personal-account)
  + [View blocked users in account](/en/communities/maintaining-your-safety-on-github/viewing-users-youve-blocked-from-your-personal-account)
  + [Unblock from your account](/en/communities/maintaining-your-safety-on-github/unblocking-a-user-from-your-personal-account)
  + [Block from your org](/en/communities/maintaining-your-safety-on-github/blocking-a-user-from-your-organization)
  + [View blocked users in org](/en/communities/maintaining-your-safety-on-github/viewing-users-who-are-blocked-from-your-organization)
  + [Unblock from your org](/en/communities/maintaining-your-safety-on-github/unblocking-a-user-from-your-organization)
  + [Reporting abuse or spam](/en/communities/maintaining-your-safety-on-github/reporting-abuse-or-spam)
* Using wikis
  + [About wikis](/en/communities/documenting-your-project-with-wikis/about-wikis)
  + [Manage wiki pages](/en/communities/documenting-your-project-with-wikis/adding-or-editing-wiki-pages)
  + [Create footer or sidebar](/en/communities/documenting-your-project-with-wikis/creating-a-footer-or-sidebar-for-your-wiki)
  + [Editing wiki content](/en/communities/documenting-your-project-with-wikis/editing-wiki-content)
  + [View a history of changes](/en/communities/documenting-your-project-with-wikis/viewing-a-wikis-history-of-changes)
  + [Change access permissions](/en/communities/documenting-your-project-with-wikis/changing-access-permissions-for-wikis)
  + [Disabling wikis](/en/communities/documenting-your-project-with-wikis/disabling-wikis)

* [Building communities](/en/communities "Building communities")/
* [Moderation](/en/communities/moderating-comments-and-conversations "Moderation")/
* [Manage comments](/en/communities/moderating-comments-and-conversations/managing-disruptive-comments "Manage comments")
# Managing disruptive comments

You can hide, edit, or delete comments on issues, pull requests, and commits.

## In this article

* [Hiding a comment](#hiding-a-comment)
* [Unhiding a comment](#unhiding-a-comment)
* [Editing a comment](#editing-a-comment)
* [Redacting sensitive information](#redacting-sensitive-information)
* [Deleting a comment](#deleting-a-comment)
* [Further reading](#further-reading)
## [Hiding a comment](#hiding-a-comment)

Organization moderators, and anyone with write access to a repository, can hide comments on issues, pull requests, and commits.

If a comment is off-topic, outdated, or resolved, you may want to hide a comment to keep a discussion focused or make a pull request easier to navigate and review. Hidden comments are minimized but people with read access to the repository can expand them.

![Screenshot of a hidden comment. The only visible content is "This comment has been minimized", with a button to show the comment.](/assets/cb-13766/images/help/repository/hidden-comment.png)

1. Navigate to the comment you'd like to hide.
2. In the upper-right corner of the comment, click , then click **Hide**.

   ![Screenshot of a pull request comment by octo-user. Below an icon of three dots, a dropdown menu is expanded, and "Hide" is outlined in orange.](/assets/cb-42438/images/help/repository/comment-menu-hide.png)
3. Using the "Choose a reason" dropdown menu, choose a reason to hide the comment. Then select **Hide comment**.

   ![Screenshot of a comment showing a menu to select a reason to hide the comment: Spam, Abuse, Off Topic, Outdated, Duplicate, or Resolved.](/assets/cb-67538/images/help/repository/choose-reason-for-hiding-comment.png)

## [Unhiding a comment](#unhiding-a-comment)

Organization moderators, and anyone with write access to a repository, can unhide comments on issues, pull requests, and commits.

1. Navigate to the comment you'd like to unhide.
2. On the right side of the comment, click  **Show comment**.
3. On the right side of the expanded comment, select the  dropdown menu, then click **Unhide**.

   ![Screenshot of a pull request comment marked as spam. Below an icon of three dots, a dropdown menu is expanded, and "Unhide" is outlined in orange.](/assets/cb-50118/images/help/repository/comment-menu-hidden.png)

## [Editing a comment](#editing-a-comment)

Anyone with write access to a repository can edit comments on issues, pull requests, and commits.

It's appropriate to edit a comment and remove content that doesn't contribute to the conversation and violates your community's code of conduct or GitHub's [Community Guidelines](/en/site-policy/github-terms/github-community-guidelines).

Sometimes it may make sense to clearly indicate edits and their justification.

That said, anyone with read access to a repository can view a comment's edit history. The **edited** dropdown at the top of the comment contains a history of edits showing the user and timestamp for each edit.

![Screenshot of a comment by octo-user, which is partially redacted. In the header, next to "edited by octocat", a dropdown icon is outlined in orange.](/assets/cb-42069/images/help/repository/content-redacted-comment.png)

## [Redacting sensitive information](#redacting-sensitive-information)

Comment authors and anyone with write access to a repository can also delete sensitive information from a comment's edit history. For more information, see [Tracking changes in a comment](/en/communities/moderating-comments-and-conversations/tracking-changes-in-a-comment).

1. Navigate to the comment you'd like to edit.
2. In the upper-right corner of the comment, click , then click **Edit**.

   ![Screenshot of a pull request comment by octo-user. Below an icon of three dots, a dropdown menu is expanded, and "Edit" is outlined in orange.](/assets/cb-42473/images/help/repository/comment-menu-edit.png)
3. In the comment window, delete the content you'd like to remove, then type `[REDACTED]` to replace it.
4. At the bottom of the comment, type a note indicating that you have edited the comment, and optionally, why you edited the comment.
5. Click **Update comment**.

## [Deleting a comment](#deleting-a-comment)

Anyone with write access to a repository can delete comments on issues, pull requests, and commits. Organization owners, team maintainers, and the comment author can also delete a comment on a team page.

If a comment contains some constructive content that adds to the conversation in the issue or pull request, you can edit the comment instead.

Deleting a comment is your last resort as a moderator. It's appropriate to delete a comment if the entire comment adds no constructive content to a conversation and violates your community's code of conduct or GitHub's [Community Guidelines](/en/site-policy/github-terms/github-community-guidelines).

Deleting a comment creates a timeline event that is visible to anyone with read access to the repository. However, the username of the person who deleted the comment is only visible to people with write access to the repository. For anyone without write access, the timeline event is anonymized.

![Screenshot of a timeline event, which says "octo-org deleted a comment from hubot 6 minutes ago."](/assets/cb-10760/images/help/issues/anonymized-timeline-entry-for-deleted-comment.png)

Note

The initial comment (or body) of an issue or pull request can't be deleted. Instead, you can edit issue and pull request bodies to remove unwanted content.

### [Steps to delete a comment](#steps-to-delete-a-comment)

1. Navigate to the comment you'd like to delete.
2. In the upper-right corner of the comment, click , then click **Delete**.
   ![Screenshot of a pull request comment by octo-user. Below an icon of three dots, a dropdown menu is expanded, and "Delete" is outlined in orange.](/assets/cb-42453/images/help/repository/comment-menu-delete.png)
3. Optionally, write a comment noting that you deleted a comment and why.

## [Further reading](#further-reading)

* [Managing moderators in your organization](/en/organizations/managing-peoples-access-to-your-organization-with-roles/managing-moderators-in-your-organization)
## Help and support

### Did you find what you needed?

 Yes No[Privacy policy](/en/site-policy/privacy-policies/github-privacy-statement)
### Help us make these docs great!

All GitHub docs are open source. See something that's wrong or unclear? Submit a pull request.

[Make a contribution](https://github.com/github/docs/blob/main/content/communities/moderating-comments-and-conversations/managing-disruptive-comments.md)

[Learn how to contribute](/contributing)

### Still need help?

[Ask the GitHub community](https://github.com/orgs/community/discussions)[Contact support](https://support.github.com)
## Legal

* © 2025 GitHub, Inc.
* [Terms](/en/site-policy/github-terms/github-terms-of-service)
* [Privacy](/en/site-policy/privacy-policies/github-privacy-statement)
* [Status](https://www.githubstatus.com/)
* [Pricing](https://github.com/pricing)
* [Expert services](https://services.github.com)
* [Blog](https://github.blog)


=== Content from github.com_3c58a52d_20250125_171153.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvim%2Fvim%2Fcommit%2F5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvim%2Fvim%2Fcommit%2F5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=vim%2Fvim)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vim](/vim)
/
**[vim](/vim/vim)**
Public

* [Notifications](/login?return_to=%2Fvim%2Fvim) You must be signed in to change notification settings
* [Fork
  5.5k](/login?return_to=%2Fvim%2Fvim)
* [Star
   37.3k](/login?return_to=%2Fvim%2Fvim)

* [Code](/vim/vim)
* [Issues
  1.5k](/vim/vim/issues)
* [Pull requests
  44](/vim/vim/pulls)
* [Discussions](/vim/vim/discussions)
* [Actions](/vim/vim/actions)
* [Projects
  0](/vim/vim/projects)
* [Wiki](/vim/vim/wiki)
* [Security](/vim/vim/security)
* [Insights](/vim/vim/pulse)

Additional navigation options

* [Code](/vim/vim)
* [Issues](/vim/vim/issues)
* [Pull requests](/vim/vim/pulls)
* [Discussions](/vim/vim/discussions)
* [Actions](/vim/vim/actions)
* [Projects](/vim/vim/projects)
* [Wiki](/vim/vim/wiki)
* [Security](/vim/vim/security)
* [Insights](/vim/vim/pulse)

## Commit

[Permalink](/vim/vim/commit/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

patch 8.0.1263: others can read the swap file if a user is careless

[Browse files](/vim/vim/tree/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8)
Browse the repository at this point in the history

```
Problem:    Others can read the swap file if a user is careless with his
            primary group.
Solution:   If the group permission allows for reading but the world
            permissions doesn't, make sure the group is right.
```

* Loading branch information

[![@brammool](https://avatars.githubusercontent.com/u/8530623?s=40&v=4)](/brammool)

[brammool](/vim/vim/commits?author=brammool "View all commits by brammool")
committed
Nov 4, 2017

1 parent
[7dd88c5](/vim/vim/commit/7dd88c5133feda7e9ccfedcb38b6dfdba459d507)

commit 5a73e0c

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**99 additions**
and
**40 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/Makefile
    [Makefile](#diff-3e2513390df543315686d7c85bd901ca9256268970032298815d2f893a9f0685)
  + src/fileio.c
    [fileio.c](#diff-d63764951497182a8a3fd237136b91a72d4b68b1ab264919aa86abd840f26984)
  + testdir

    - src/testdir/test\_swap.vim
      [test\_swap.vim](#diff-f6bf989727b4c86a8b41afe509c24bdf577af2f289cebe1bf1d3d71b3d926b01)
  + src/version.c
    [version.c](#diff-ea763fdb2cbd2223b87bfc5dcbc65b0d0b7a9e07c7738d3ff1d136b98dce06fc)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[src/Makefile](#diff-3e2513390df543315686d7c85bd901ca9256268970032298815d2f893a9f0685 "src/Makefile")

Show comments

[View file](/vim/vim/blob/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8/src/Makefile)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2259,6 +2259,7 @@ test\_arglist \ |
|  |  | test\_stat \ |
|  |  | test\_statusline \ |
|  |  | test\_substitute \ |
|  |  | test\_swap \ |
|  |  | test\_syn\_attr \ |
|  |  | test\_syntax \ |
|  |  | test\_system \ |
| Expand Down | |  |

24 changes: 23 additions & 1 deletion

24
[src/fileio.c](#diff-d63764951497182a8a3fd237136b91a72d4b68b1ab264919aa86abd840f26984 "src/fileio.c")

Show comments

[View file](/vim/vim/blob/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8/src/fileio.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -716,7 +716,29 @@ readfile( |
|  |  | /\* Set swap file protection bits after creating it. \*/ |
|  |  | if (swap\_mode > 0 && curbuf->b\_ml.ml\_mfp != NULL |
|  |  | && curbuf->b\_ml.ml\_mfp->mf\_fname != NULL) |
|  |  | (void)mch\_setperm(curbuf->b\_ml.ml\_mfp->mf\_fname, (long)swap\_mode); |
|  |  | { |
|  |  | char\_u \*swap\_fname = curbuf->b\_ml.ml\_mfp->mf\_fname; |
|  |  |  |
|  |  | /\* |
|  |  | \* If the group-read bit is set but not the world-read bit, then |
|  |  | \* the group must be equal to the group of the original file. If |
|  |  | \* we can't make that happen then reset the group-read bit. This |
|  |  | \* avoids making the swap file readable to more users when the |
|  |  | \* primary group of the user is too permissive. |
|  |  | \*/ |
|  |  | if ((swap\_mode & 044) == 040) |
|  |  | { |
|  |  | stat\_T swap\_st; |
|  |  |  |
|  |  | if (mch\_stat((char \*)swap\_fname, &swap\_st) >= 0 |
|  |  | && st.st\_gid != swap\_st.st\_gid |
|  |  | && fchown(curbuf->b\_ml.ml\_mfp->mf\_fd, -1, st.st\_gid) |
|  |  | == -1) |
|  |  | swap\_mode &= 0600; |
|  |  | } |
|  |  |  |
|  |  | (void)mch\_setperm(swap\_fname, (long)swap\_mode); |
|  |  | } |
|  |  | #endif |
|  |  | } |
|  |  |  |
| Expand Down | |  |

112 changes: 73 additions & 39 deletions

112
[src/testdir/test\_swap.vim](#diff-f6bf989727b4c86a8b41afe509c24bdf577af2f289cebe1bf1d3d71b3d926b01 "src/testdir/test_swap.vim")

Show comments

[View file](/vim/vim/blob/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8/src/testdir/test_swap.vim)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,48 +1,82 @@ |
|  |  | " Tests for the swap feature |
|  |  |  |
|  |  | " Tests for 'directory' option. |
|  |  | func Test\_swap\_directory() |
|  |  | "" Tests for 'directory' option. |
|  |  | "func Test\_swap\_directory() |
|  |  | " if !has("unix") |
|  |  | " return |
|  |  | " endif |
|  |  | " let content = ['start of testfile', |
|  |  | " \ 'line 2 Abcdefghij', |
|  |  | " \ 'line 3 Abcdefghij', |
|  |  | " \ 'end of testfile'] |
|  |  | " call writefile(content, 'Xtest1') |
|  |  | " |
|  |  | " " '.', swap file in the same directory as file |
|  |  | " set dir=.,~ |
|  |  | " |
|  |  | " " Verify that the swap file doesn't exist in the current directory |
|  |  | " call assert\_equal([], glob(".Xtest1\*.swp", 1, 1, 1)) |
|  |  | " edit Xtest1 |
|  |  | " let swfname = split(execute("swapname"))[0] |
|  |  | " call assert\_equal([swfname], glob(swfname, 1, 1, 1)) |
|  |  | " |
|  |  | " " './dir', swap file in a directory relative to the file |
|  |  | " set dir=./Xtest2,.,~ |
|  |  | " |
|  |  | " call mkdir("Xtest2") |
|  |  | " edit Xtest1 |
|  |  | " call assert\_equal([], glob(swfname, 1, 1, 1)) |
|  |  | " let swfname = "Xtest2/Xtest1.swp" |
|  |  | " call assert\_equal(swfname, split(execute("swapname"))[0]) |
|  |  | " call assert\_equal([swfname], glob("Xtest2/\*", 1, 1, 1)) |
|  |  | " |
|  |  | " " 'dir', swap file in directory relative to the current dir |
|  |  | " set dir=Xtest.je,~ |
|  |  | " |
|  |  | " call mkdir("Xtest.je") |
|  |  | " call writefile(content, 'Xtest2/Xtest3') |
|  |  | " edit Xtest2/Xtest3 |
|  |  | " call assert\_equal(["Xtest2/Xtest3"], glob("Xtest2/\*", 1, 1, 1)) |
|  |  | " let swfname = "Xtest.je/Xtest3.swp" |
|  |  | " call assert\_equal(swfname, split(execute("swapname"))[0]) |
|  |  | " call assert\_equal([swfname], glob("Xtest.je/\*", 1, 1, 1)) |
|  |  | " |
|  |  | " set dir& |
|  |  | " call delete("Xtest1") |
|  |  | " call delete("Xtest2", "rf") |
|  |  | " call delete("Xtest.je", "rf") |
|  |  | "endfunc |
|  |  |  |
|  |  | func Test\_swap\_group() |
|  |  | if !has("unix") |
|  |  | return |
|  |  | endif |
|  |  | let content = ['start of testfile', |
|  |  | \ 'line 2 Abcdefghij', |
|  |  | \ 'line 3 Abcdefghij', |
|  |  | \ 'end of testfile'] |
|  |  | call writefile(content, 'Xtest1') |
|  |  |  |
|  |  | " '.', swap file in the same directory as file |
|  |  | set dir=.,~ |
|  |  |  |
|  |  | " Verify that the swap file doesn't exist in the current directory |
|  |  | call assert\_equal([], glob(".Xtest1\*.swp", 1, 1, 1)) |
|  |  | edit Xtest1 |
|  |  | let swfname = split(execute("swapname"))[0] |
|  |  | call assert\_equal([swfname], glob(swfname, 1, 1, 1)) |
|  |  |  |
|  |  | " './dir', swap file in a directory relative to the file |
|  |  | set dir=./Xtest2,.,~ |
|  |  |  |
|  |  | call mkdir("Xtest2") |
|  |  | edit Xtest1 |
|  |  | call assert\_equal([], glob(swfname, 1, 1, 1)) |
|  |  | let swfname = "Xtest2/Xtest1.swp" |
|  |  | call assert\_equal(swfname, split(execute("swapname"))[0]) |
|  |  | call assert\_equal([swfname], glob("Xtest2/\*", 1, 1, 1)) |
|  |  | let groups = split(system('groups')) |
|  |  | if len(groups) <= 1 |
|  |  | throw 'Skipped: need at least two groups, got ' . groups |
|  |  | endif |
|  |  |  |
|  |  | " 'dir', swap file in directory relative to the current dir |
|  |  | set dir=Xtest.je,~ |
|  |  | call delete('Xtest') |
|  |  | split Xtest |
|  |  | call setline(1, 'just some text') |
|  |  | wq |
|  |  | if system('ls -l Xtest') !~ ' ' . groups[0] . ' \d' |
|  |  | throw 'Skipped: test file does not have the first group' |
|  |  | else |
|  |  | silent !chmod 640 Xtest |
|  |  | call system('chgrp ' . groups[1] . ' Xtest') |
|  |  | if system('ls -l Xtest') !~ ' ' . groups[1] . ' \d' |
|  |  | throw 'Skipped: cannot set second group on test file' |
|  |  | else |
|  |  | split Xtest |
|  |  | let swapname = substitute(execute('swapname'), '[[:space:]]', '', 'g') |
|  |  | call assert\_match('Xtest', swapname) |
|  |  | " Group of swapfile must now match original file. |
|  |  | call assert\_match(' ' . groups[1] . ' \d', system('ls -l ' . swapname)) |
|  |  |  |
|  |  | call mkdir("Xtest.je") |
|  |  | call writefile(content, 'Xtest2/Xtest3') |
|  |  | edit Xtest2/Xtest3 |
|  |  | call assert\_equal(["Xtest2/Xtest3"], glob("Xtest2/\*", 1, 1, 1)) |
|  |  | let swfname = "Xtest.je/Xtest3.swp" |
|  |  | call assert\_equal(swfname, split(execute("swapname"))[0]) |
|  |  | call assert\_equal([swfname], glob("Xtest.je/\*", 1, 1, 1)) |
|  |  | bwipe! |
|  |  | endif |
|  |  | endif |
|  |  |  |
|  |  | set dir& |
|  |  | call delete("Xtest1") |
|  |  | call delete("Xtest2", "rf") |
|  |  | call delete("Xtest.je", "rf") |
|  |  | call delete('Xtest') |
|  |  | endfunc |

2 changes: 2 additions & 0 deletions

2
[src/version.c](#diff-ea763fdb2cbd2223b87bfc5dcbc65b0d0b7a9e07c7738d3ff1d136b98dce06fc "src/version.c")

Show comments

[View file](/vim/vim/blob/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8/src/version.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -761,6 +761,8 @@ static char \*(features[]) = |
|  |  |  |
|  |  | static int included\_patches[] = |
|  |  | { /\* Add new patch number below this line \*/ |
|  |  | /\*\*/ |
|  |  | 1263, |
|  |  | /\*\*/ |
|  |  | 1262, |
|  |  | /\*\*/ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 5 comments on commit `5a73e0c`

[![@kirotawa](https://avatars.githubusercontent.com/u/476400?s=80&v=4)](/kirotawa)

Copy link

### @kirotawa **[kirotawa](/kirotawa)** commented on `[5a73e0c](/vim/vim/commit/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8)` [Nov 6, 2017](#commitcomment-25434463) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Hi,

I did apply this patch (only the part of src/fileio.c)

And tried to reproduce the steps I found here <http://www.openwall.com/lists/oss-security/2017/10/31/15>

And what I see is that swap files still are created ignoring the umask. Not sure though if those steps are the correct one to test this. Any advice here would be nice. Thanks!

Sorry, something went wrong.

All reactions

[![@chrisbra](https://avatars.githubusercontent.com/u/244927?s=80&v=4)](/chrisbra)

Copy link

Member

### @chrisbra **[chrisbra](/chrisbra)** commented on `[5a73e0c](/vim/vim/commit/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8)` [Nov 7, 2017](#commitcomment-25452763)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Note, this commit does not talk about respecting the umask. It only changes the group ownership

Sorry, something went wrong.

All reactions

[![@Z5T1](https://avatars.githubusercontent.com/u/7872543?s=80&v=4)](/Z5T1)

Copy link

### @Z5T1 **[Z5T1](/Z5T1)** commented on `[5a73e0c](/vim/vim/commit/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8)` [Dec 1, 2017](#commitcomment-25983069)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This has been assigned [CVE-2017-17087](https://github.com/advisories/GHSA-fmc8-f7rh-x4p9 "CVE-2017-17087"). After careful examination, it was decided that this is a separate vulnerability from [CVE-2017-1000382](https://github.com/advisories/GHSA-fc3h-fxv9-79gq "CVE-2017-1000382") and has nothing to do with the umask.

Sorry, something went wrong.

All reactions

[![@xtspackages](https://avatars.githubusercontent.com/u/25753882?s=80&v=4)](/xtspackages)

Copy link

### @xtspackages **[xtspackages](/xtspackages)** commented on `[5a73e0c](/vim/vim/commit/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8)` [Apr 18, 2018](#commitcomment-28636429)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This commit does not guard the new use of fchown() in src/fileio.c. Elsewhere fchown is protected inside a "#ifdef HAVE\_FCHOWN" block. I've attached a patch to this comment.

[vim\_guard\_fchown.txt](https://github.com/vim/vim/files/1924479/vim_guard_fchown.txt)

Sorry, something went wrong.

All reactions

[![@brammool](https://avatars.githubusercontent.com/u/8530623?s=80&v=4)](/brammool)

Copy link

Contributor

Author

### @brammool **[brammool](/brammool)** commented on `[5a73e0c](/vim/vim/commit/5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8)` [Apr 19, 2018](#commitcomment-28659084) via email

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

 This commit does not guard the new use of fchown() in src/fileio.c.
Elsewhere fchown is protected inside a "#ifdef HAVE\_FCHOWN" block.
I've attached a patch to this comment.
[vim\_guard\_fchown.txt](<https://github.com/vim/vim/files/1924479/vim_guard_fchown.txt>)
I'll include it, thanks.
…
--
hundred-and-one symptoms of being an internet addict:
232. You start conversations with, "Have you gotten an ISDN line?"
/// Bram Moolenaar -- Bram@Moolenaar.net -- <http://www.Moolenaar.net> \\\
/// sponsor Vim, vote for features -- <http://www.Vim.org/sponsor/> \\\
\\\ an exciting new programming language -- <http://www.Zimbu.org> ///
\\\ help me help AIDS victims -- <http://ICCF-Holland.org> ///

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvim%2Fvim%2Fcommit%2F5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


