=== Content from github.com_e4233555_20250124_130032.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fruby-ldap%2Fruby-net-ldap%2Fissues%2F258)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fruby-ldap%2Fruby-net-ldap%2Fissues%2F258)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ruby-ldap%2Fruby-net-ldap)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ruby-ldap](/ruby-ldap)
/
**[ruby-net-ldap](/ruby-ldap/ruby-net-ldap)**
Public

* [Notifications](/login?return_to=%2Fruby-ldap%2Fruby-net-ldap) You must be signed in to change notification settings
* [Fork
  252](/login?return_to=%2Fruby-ldap%2Fruby-net-ldap)
* [Star
   398](/login?return_to=%2Fruby-ldap%2Fruby-net-ldap)

* [Code](/ruby-ldap/ruby-net-ldap)
* [Issues
  61](/ruby-ldap/ruby-net-ldap/issues)
* [Pull requests
  19](/ruby-ldap/ruby-net-ldap/pulls)
* [Actions](/ruby-ldap/ruby-net-ldap/actions)
* [Projects
  0](/ruby-ldap/ruby-net-ldap/projects)
* [Wiki](/ruby-ldap/ruby-net-ldap/wiki)
* [Security](/ruby-ldap/ruby-net-ldap/security)
* [Insights](/ruby-ldap/ruby-net-ldap/pulse)

Additional navigation options

* [Code](/ruby-ldap/ruby-net-ldap)
* [Issues](/ruby-ldap/ruby-net-ldap/issues)
* [Pull requests](/ruby-ldap/ruby-net-ldap/pulls)
* [Actions](/ruby-ldap/ruby-net-ldap/actions)
* [Projects](/ruby-ldap/ruby-net-ldap/projects)
* [Wiki](/ruby-ldap/ruby-net-ldap/wiki)
* [Security](/ruby-ldap/ruby-net-ldap/security)
* [Insights](/ruby-ldap/ruby-net-ldap/pulse)

# LDAPS vulnerable to MITM - failure to validate hostname against CN or SAN in X509 Cert #258

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosed[#279](https://github.com/ruby-ldap/ruby-net-ldap/pull/279)Closed[LDAPS vulnerable to MITM - failure to validate hostname against CN or SAN in X509 Cert](#top)#258[#279](https://github.com/ruby-ldap/ruby-net-ldap/pull/279)Copy linkLabels[Bugs](https://github.com/ruby-ldap/ruby-net-ldap/issues?q=state%3Aopen%20label%3A%22Bugs%22)[![@JPvRiel](https://avatars.githubusercontent.com/u/9722317?u=1b1d564e119da32a80fdb05fe52a6d12481e7014&v=4&size=80)](/JPvRiel)
## Description

[![@JPvRiel](https://avatars.githubusercontent.com/u/9722317?u=1b1d564e119da32a80fdb05fe52a6d12481e7014&v=4&size=48)](/JPvRiel)[JPvRiel](https://github.com/JPvRiel)opened [on Jan 14, 2016](https://github.com/ruby-ldap/ruby-net-ldap/issues/258#issue-126688914)

There are noted TLS/SSL limitations in the documented parts of the code and the info about [encryption](http://www.rubydoc.info/github/ruby-ldap/ruby-net-ldap/Net/LDAP%3Aencryption). Technically, TLS/SSL also provides the ability to authenticate servers by matching the hostname to a CN (common name) or a (SAN) Subject Alternative Name and from what I've seen, while net-ldap notes the certificate and trust chain limitations as insecure default, *but* it doesn't note the extra step needed to get to proper LDAP server authentication via LDAPS.

```
In order to verify certificates and enable other TLS options, the
  #   :tls_options hash can be passed alongside :simple_tls or :start_tls.
  #   This hash contains any options that can be passed to
  #   OpenSSL::SSL::SSLContext#set_params(). The most common options passed
  #   should be OpenSSL::SSL::SSLContext::DEFAULT_PARAMS, or the :ca_file option,
  #   which contains a path to a Certificate Authority file (PEM-encoded).

```

The above advice is not sufficient. It only assures that a server has a valid cert which was signed by a trusted CA, but it does not provide proof that it's the correct server E.g. evil.example.net with a cert issued as CN=evil.example.net could still impersonate ldap.example.net to steal credentials.

In addition to the above suggtestion setting a more secure and sane TLS/SSL context that validates certs , the net-ldap lib should also, probably by default, add and make use of [verify\_certificate\_identity](http://ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL/SSL.html#method-c-verify_certificate_identity). I've browsed [connection.rb](https://github.com/ruby-ldap/ruby-net-ldap/blob/master/lib/net/ldap/connection.rb) and don't see anything that checks the hostname (FQDN) is authenticated against the certficate.

```
  def self.wrap_with_ssl(io, tls_options = {})
    raise Net::LDAP::NoOpenSSLError, "OpenSSL is unavailable" unless Net::LDAP::HasOpenSSL

    ctx = OpenSSL::SSL::SSLContext.new

    # By default, we do not verify certificates. For a 1.0 release, this should probably be changed at some point.
    # See discussion in https://github.com/ruby-ldap/ruby-net-ldap/pull/161
    ctx.set_params(tls_options) unless tls_options.empty?

    conn = OpenSSL::SSL::SSLSocket.new(io, ctx)
    conn.connect

    # Doesn't work:
    # conn.sync_close = true

    conn.extend(GetbyteForSSLSocket) unless conn.respond_to?(:getbyte)
    conn.extend(FixSSLSocketSyncClose)

    conn
  end
```

Given ruby essentially 'wraps' OpenSSL, this [Hostname\_validation](https://wiki.openssl.org/index.php/Hostname_validation) reference also highlights the issue, with a choice extract

> One common mistake made by users of OpenSSL is to assume that OpenSSL will validate the hostname in the server's certificate. Versions prior to 1.0.2 did not perform hostname validation. Version 1.0.2 and up contain support for hostname validation, but they still require the user to call a few functions to set it up.

## Metadata

### Assignees

No one assigned

### Labels

[Bugs](https://github.com/ruby-ldap/ruby-net-ldap/issues?q=state%3Aopen%20label%3A%22Bugs%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a4528a60_20250124_130034.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fruby-ldap%2Fruby-net-ldap%2Fpull%2F279)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fruby-ldap%2Fruby-net-ldap%2Fpull%2F279)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=ruby-ldap%2Fruby-net-ldap)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ruby-ldap](/ruby-ldap)
/
**[ruby-net-ldap](/ruby-ldap/ruby-net-ldap)**
Public

* [Notifications](/login?return_to=%2Fruby-ldap%2Fruby-net-ldap) You must be signed in to change notification settings
* [Fork
  252](/login?return_to=%2Fruby-ldap%2Fruby-net-ldap)
* [Star
   398](/login?return_to=%2Fruby-ldap%2Fruby-net-ldap)

* [Code](/ruby-ldap/ruby-net-ldap)
* [Issues
  61](/ruby-ldap/ruby-net-ldap/issues)
* [Pull requests
  19](/ruby-ldap/ruby-net-ldap/pulls)
* [Actions](/ruby-ldap/ruby-net-ldap/actions)
* [Projects
  0](/ruby-ldap/ruby-net-ldap/projects)
* [Wiki](/ruby-ldap/ruby-net-ldap/wiki)
* [Security](/ruby-ldap/ruby-net-ldap/security)
* [Insights](/ruby-ldap/ruby-net-ldap/pulse)

Additional navigation options

* [Code](/ruby-ldap/ruby-net-ldap)
* [Issues](/ruby-ldap/ruby-net-ldap/issues)
* [Pull requests](/ruby-ldap/ruby-net-ldap/pulls)
* [Actions](/ruby-ldap/ruby-net-ldap/actions)
* [Projects](/ruby-ldap/ruby-net-ldap/projects)
* [Wiki](/ruby-ldap/ruby-net-ldap/wiki)
* [Security](/ruby-ldap/ruby-net-ldap/security)
* [Insights](/ruby-ldap/ruby-net-ldap/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fruby-ldap%2Fruby-net-ldap%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fruby-ldap%2Fruby-net-ldap%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# enable TLS hostname validation #279

 Merged

[jch](/jch)
merged 39 commits into
[ruby-ldap:master](/ruby-ldap/ruby-net-ldap/tree/master "ruby-ldap/ruby-net-ldap:master")
from
[tmaher:tls-verify-hostnames](/tmaher/ruby-net-ldap/tree/tls-verify-hostnames "tmaher/ruby-net-ldap:tls-verify-hostnames")

Aug 24, 2016

 Merged

# [enable TLS hostname validation](#top) #279

[jch](/jch)
merged 39 commits into
[ruby-ldap:master](/ruby-ldap/ruby-net-ldap/tree/master "ruby-ldap/ruby-net-ldap:master")
from
[tmaher:tls-verify-hostnames](/tmaher/ruby-net-ldap/tree/tls-verify-hostnames "tmaher/ruby-net-ldap:tls-verify-hostnames")

Aug 24, 2016

[Conversation
29](/ruby-ldap/ruby-net-ldap/pull/279)
[Commits
39](/ruby-ldap/ruby-net-ldap/pull/279/commits)
[Checks
0](/ruby-ldap/ruby-net-ldap/pull/279/checks)
[Files changed](/ruby-ldap/ruby-net-ldap/pull/279/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![tmaher](https://avatars.githubusercontent.com/u/297632?s=60&v=4)](/tmaher)

Copy link

Collaborator

### @tmaher **[tmaher](/tmaher)** commented [Aug 23, 2016](#issue-172619147) • edited Loading

This PR is a continuation of [#259](https://github.com/ruby-ldap/ruby-net-ldap/pull/259) and fixes [#258](https://github.com/ruby-ldap/ruby-net-ldap/issues/258). The major additions to [@JPvRiel](https://github.com/JPvRiel) 's work are...

* Fix Vagrant integration tests - `TestBindIntegration#test_bind_timeout` relies on an iptables-blackhole'd port (tcp/8389). I switched the iptable invocation in `script/install-openldap` so that blockage extends to the hypervisor. Also I updated the docs a bit.
* New `test/fixtures/ca` files - For Vagrant testing to work, the hypervisor & guest need to both agree on a CA. The previous `cacert.pem` didn't have a corresponding private key in the repo, which made that hard. This PR adds a new CA & key, and extends `script/install-openldap` to use them.
* A bunch of TLS tests - `test/integration/test_bind.rb` already included `test_bind_tls_with_cafile`, so I added the new TLS cert verification tests there. I also refactored that file a teeny bit because of all the repetition: mostly adding some default hashes.

The first CI run is going to fail, because I'm not entirely sure what the right value is for `test_bind_tls_with_multiple_bogus_hosts`'s exception. Once the PR is created and CI runs, I should be able to get that and add it. - FIXED

/cc [@jch](https://github.com/jch) [@etdsoft](https://github.com/etdsoft)

Sorry, something went wrong.

 👍
1
 JPvRiel reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

 Tom Maher
and others
added 25 commits
[August 22, 2016 18:44](#commits-pushed-84ab4c2)

`[fix iptables blackholing for macOS](/ruby-ldap/ruby-net-ldap/pull/279/commits/84ab4c2bd5a66fdf682dd9d543692236fd969a9c "fix iptables blackholing for macOS")`

`[84ab4c2](/ruby-ldap/ruby-net-ldap/pull/279/commits/84ab4c2bd5a66fdf682dd9d543692236fd969a9c)`

`[new fixture CA, now with private key](/ruby-ldap/ruby-net-ldap/pull/279/commits/7b2bb0284d3df4bfeb0b56f114bf1aad6dc90a0d "new fixture CA, now with private key")`

`[7b2bb02](/ruby-ldap/ruby-net-ldap/pull/279/commits/7b2bb0284d3df4bfeb0b56f114bf1aad6dc90a0d)`

`[vagrant fix for macOS v Linux?](/ruby-ldap/ruby-net-ldap/pull/279/commits/21373615cae10c3123d415d83938a65dee410b43 "vagrant fix for macOS v Linux?")`

`[2137361](/ruby-ldap/ruby-net-ldap/pull/279/commits/21373615cae10c3123d415d83938a65dee410b43)`

`[helper should use the new CA](/ruby-ldap/ruby-net-ldap/pull/279/commits/38b6147ac77f0e071df2b93002d30fde95d40a6c "helper should use the new CA")`

`[38b6147](/ruby-ldap/ruby-net-ldap/pull/279/commits/38b6147ac77f0e071df2b93002d30fde95d40a6c)`

`[rubocop fix](/ruby-ldap/ruby-net-ldap/pull/279/commits/b42e931359ec2c42efb8bc72a37209a59d7ea816 "rubocop fix")`

`[b42e931](/ruby-ldap/ruby-net-ldap/pull/279/commits/b42e931359ec2c42efb8bc72a37209a59d7ea816)`

[![@JPvRiel-SB](https://avatars.githubusercontent.com/u/139124182?s=40&v=4)](/JPvRiel-SB)

`[cherry pick from](/ruby-ldap/ruby-net-ldap/pull/279/commits/22eaf7caf0e5800a7517688760dc807c5f7de230 "cherry pick from https://github.com/ruby-ldap/ruby-net-ldap/pull/259") [ruby-ldap#259](https://github.com/ruby-ldap/ruby-net-ldap/pull/259)`

`[22eaf7c](/ruby-ldap/ruby-net-ldap/pull/279/commits/22eaf7caf0e5800a7517688760dc807c5f7de230)`

`[check that the encryption hash is defined before using it](/ruby-ldap/ruby-net-ldap/pull/279/commits/d7b36d1c8e9f8457e9aca4fa1ea0c7929baab5b6 "check that the encryption hash is defined before using it")`

`[d7b36d1](/ruby-ldap/ruby-net-ldap/pull/279/commits/d7b36d1c8e9f8457e9aca4fa1ea0c7929baab5b6)`

`[add tests for cert/hostname mismatch](/ruby-ldap/ruby-net-ldap/pull/279/commits/748f1b9fae8cf7947930578b0dcf4250bce3d9bf "add tests for cert/hostname mismatch")`

`[748f1b9](/ruby-ldap/ruby-net-ldap/pull/279/commits/748f1b9fae8cf7947930578b0dcf4250bce3d9bf)`

`[stupid portforwarding tricks for local testing](/ruby-ldap/ruby-net-ldap/pull/279/commits/9bab5a5d49bfd7747fa8996009a7b9c14c34e52d "stupid portforwarding tricks for local testing")`

`[9bab5a5](/ruby-ldap/ruby-net-ldap/pull/279/commits/9bab5a5d49bfd7747fa8996009a7b9c14c34e52d)`

`[omit example](/ruby-ldap/ruby-net-ldap/pull/279/commits/381fdf4fed5c39d36ada17ec8b2f07b3165cd003 "omit example")`

`[381fdf4](/ruby-ldap/ruby-net-ldap/pull/279/commits/381fdf4fed5c39d36ada17ec8b2f07b3165cd003)`

`[doc tweak](/ruby-ldap/ruby-net-ldap/pull/279/commits/fd1c8237f6523e3164f718e0773053670cd170a0 "doc tweak")`

`[fd1c823](/ruby-ldap/ruby-net-ldap/pull/279/commits/fd1c8237f6523e3164f718e0773053670cd170a0)`

`[too many markdown syntaxes](/ruby-ldap/ruby-net-ldap/pull/279/commits/7593af13d61a3976619febb7a02bc84706d33559 "too many markdown syntaxes")`

`[7593af1](/ruby-ldap/ruby-net-ldap/pull/279/commits/7593af13d61a3976619febb7a02bc84706d33559)`

`[remove stale reference to gem](/ruby-ldap/ruby-net-ldap/pull/279/commits/052f90d29fc28ba406db44e713a47b13c3139d9e "remove stale reference to gem")`

`[052f90d](/ruby-ldap/ruby-net-ldap/pull/279/commits/052f90d29fc28ba406db44e713a47b13c3139d9e)`

`[extra ldap object for multiple host tests](/ruby-ldap/ruby-net-ldap/pull/279/commits/ca4e39078848b04e071b2b1a17039fdb35607bca "extra ldap object for multiple host tests")`

`[ca4e390](/ruby-ldap/ruby-net-ldap/pull/279/commits/ca4e39078848b04e071b2b1a17039fdb35607bca)`

`[add multi-host SSL checks](/ruby-ldap/ruby-net-ldap/pull/279/commits/c6a465fbb86707ed6315a4871927d59bc033a20c "add multi-host SSL checks")`

`[c6a465f](/ruby-ldap/ruby-net-ldap/pull/279/commits/c6a465fbb86707ed6315a4871927d59bc033a20c)`

`[include "localhost" as valid cert name](/ruby-ldap/ruby-net-ldap/pull/279/commits/1300bc0944a019b8f21431433dbb64c15f80a1aa "include \"localhost\" as valid cert name")`

`[1300bc0](/ruby-ldap/ruby-net-ldap/pull/279/commits/1300bc0944a019b8f21431433dbb64c15f80a1aa)`

`[tidy up the TLS tests](/ruby-ldap/ruby-net-ldap/pull/279/commits/440ce7f01126983c5e368322e531db60007faedf "tidy up the TLS tests")`

`[440ce7f](/ruby-ldap/ruby-net-ldap/pull/279/commits/440ce7f01126983c5e368322e531db60007faedf)`

`[fix up to look like](/ruby-ldap/ruby-net-ldap/pull/279/commits/199f429bcf3b5cf13e075eb99d63a87e3b9188a6 "fix up to look like https://github.com/ruby-ldap/ruby-net-ldap/pull/259#discussion-diff-57030107") [ruby-ldap#259 (diff)](https://github.com/ruby-ldap/ruby-net-ldap/pull/259#discussion-diff-57030107)`

`[199f429](/ruby-ldap/ruby-net-ldap/pull/279/commits/199f429bcf3b5cf13e075eb99d63a87e3b9188a6)`

`[remove useless test CA](/ruby-ldap/ruby-net-ldap/pull/279/commits/caf191102f5d04cb1e4222b6b75c15a44470134e "remove useless test CA")`

`[caf1911](/ruby-ldap/ruby-net-ldap/pull/279/commits/caf191102f5d04cb1e4222b6b75c15a44470134e)`

`[only use tcp/9389 with vagrant, use the right exception for bad TLS c…](/ruby-ldap/ruby-net-ldap/pull/279/commits/c801132db0a692acabe56dd50c57ef6e80b2f1af "only use tcp/9389 with vagrant, use the right exception for bad TLS connections")`
 …

`[c801132](/ruby-ldap/ruby-net-ldap/pull/279/commits/c801132db0a692acabe56dd50c57ef6e80b2f1af)`

```
…onnections
```

`[handle both exceptions](/ruby-ldap/ruby-net-ldap/pull/279/commits/80bab6c769329f1d7b9c0ec246f3056fd0eeeeae "handle both exceptions")`

`[80bab6c](/ruby-ldap/ruby-net-ldap/pull/279/commits/80bab6c769329f1d7b9c0ec246f3056fd0eeeeae)`

`[single vs multiple hosts throw different exceptions](/ruby-ldap/ruby-net-ldap/pull/279/commits/eeb7a6d0ab591bba045d9765ba5313089db67b0a "single vs multiple hosts throw different exceptions")`

`[eeb7a6d](/ruby-ldap/ruby-net-ldap/pull/279/commits/eeb7a6d0ab591bba045d9765ba5313089db67b0a)`

`[more TLS tests around merging vs not merging the default options](/ruby-ldap/ruby-net-ldap/pull/279/commits/c5f212605f0cfbe6d162d527089f67ad614fab0d "more TLS tests around merging vs not merging the default options")`

`[c5f2126](/ruby-ldap/ruby-net-ldap/pull/279/commits/c5f212605f0cfbe6d162d527089f67ad614fab0d)`

`[fix bogus multi-host check](/ruby-ldap/ruby-net-ldap/pull/279/commits/d2ba5e6801d745f5a169ab102788d67c57e15f05 "fix bogus multi-host check")`

`[d2ba5e6](/ruby-ldap/ruby-net-ldap/pull/279/commits/d2ba5e6801d745f5a169ab102788d67c57e15f05)`

`[remove vagrant port override, because $INTEGRATION_PORT](/ruby-ldap/ruby-net-ldap/pull/279/commits/41881aa2efe6e4c00365b36680abb40f81983423 "remove vagrant port override, because $INTEGRATION_PORT")`

`[41881aa](/ruby-ldap/ruby-net-ldap/pull/279/commits/41881aa2efe6e4c00365b36680abb40f81983423)`

[![@tmaher](https://avatars.githubusercontent.com/u/297632?s=80&u=6e8942573f73a725d97e67115ca0d5bc683a1825&v=4)](/tmaher)

Copy link

Collaborator

Author

### **[tmaher](/tmaher)** commented [Aug 23, 2016](#issuecomment-241644639)

| Ack, what happened to CI??? |
| --- |

All reactions

Sorry, something went wrong.

[![@tmaher](https://avatars.githubusercontent.com/u/297632?s=80&u=6e8942573f73a725d97e67115ca0d5bc683a1825&v=4)](/tmaher)

Copy link

Collaborator

Author

### **[tmaher](/tmaher)** commented [Aug 23, 2016](#issuecomment-241644694)

| and it's back... huh |
| --- |

All reactions

Sorry, something went wrong.

`[more no-merge-default-opts tests, done properly](/ruby-ldap/ruby-net-ldap/pull/279/commits/19f9c7da13c937d27405609686f51213eccef8fb "more no-merge-default-opts tests, done properly")`

`[19f9c7d](/ruby-ldap/ruby-net-ldap/pull/279/commits/19f9c7da13c937d27405609686f51213eccef8fb)`

[![@tmaher](https://avatars.githubusercontent.com/u/297632?s=80&u=6e8942573f73a725d97e67115ca0d5bc683a1825&v=4)](/tmaher)

Copy link

Collaborator

Author

### **[tmaher](/tmaher)** commented [Aug 23, 2016](#issuecomment-241679346)

| Note to self to check tomorrow: <http://stackoverflow.com/questions/9199660/why-is-ruby-unable-to-verify-an-ssl-certificate#9238221> |
| --- |

All reactions

Sorry, something went wrong.

![jch](https://avatars.githubusercontent.com/u/19874?s=60&v=4)

 **[jch](/jch)**
reviewed
[Aug 23, 2016](#discussion-diff-75908048)
 [View reviewed changes](/ruby-ldap/ruby-net-ldap/pull/279/files/19f9c7da13c937d27405609686f51213eccef8fb#diff-82531db93fd7461980c226e6e3aabf29c01337b9dad436c148775e1eead9bf20)

[lib/net/ldap/connection.rb](/ruby-ldap/ruby-net-ldap/pull/279/files#diff-82531db93fd7461980c226e6e3aabf29c01337b9dad436c148775e1eead9bf20)

|  |  | (((size - n\_results) < 126) ? (size - n\_results) : 0) |
| --- | --- | --- |
|  |  | else |
|  |  | size |
|  |  | end |

Copy link

Member

### @jch **[jch](/jch)** [Aug 23, 2016](#discussion_r75908048)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

No behavioral change, just fiddling with syntax

Sorry, something went wrong.

All reactions

79 hidden items

Load more…

This was referenced Jan 24, 2023

[build(deps): bump net-ldap from 0.14.0 to 0.16.2 in /pkgs/servers/web-apps/discourse/plugins/discourse-ldap-auth
equirosa/nixpkgs#253](/equirosa/nixpkgs/pull/253)
 Closed

[build(deps): bump net-ldap from 0.14.0 to 0.16.2 in /pkgs/servers/web-apps/discourse/plugins/discourse-ldap-auth
jwiegley/nixpkgs#189](/jwiegley/nixpkgs/pull/189)
 Closed

[build(deps): bump net-ldap from 0.14.0 to 0.16.2 in /pkgs/servers/web-apps/discourse/plugins/discourse-ldap-auth
KAction/nixpkgs#207](/KAction/nixpkgs/pull/207)
 Open

[build(deps): bump net-ldap from 0.14.0 to 0.16.2 in /pkgs/servers/web-apps/discourse/plugins/discourse-ldap-auth
yoki31/nixpkgs#129](/yoki31/nixpkgs/pull/129)
 Open

[Bump net-ldap from 0.11 to 0.16.2 in /\_site/play-with-docker/Portus/Portus.1
collabnix/dockerlabs#490](/collabnix/dockerlabs/pull/490)
 Closed

[Bump net-ldap from 0.11 to 0.16.2 in /Docker/docker101-master/play-with-docker/Portus
chunche95/DevOps#18](/chunche95/DevOps/pull/18)
 Closed

[Bump net-ldap from 0.11 to 0.16.2 in /Docker/docker101-master/play-with-docker/Portus/Portus.1
chunche95/DevOps#19](/chunche95/DevOps/pull/19)
 Closed

[build(deps): bump net-ldap from 0.11 to 0.16.2
2359media/Portus#19](/2359media/Portus/pull/19)
 Open

[build(deps): bump net-ldap from 0.14.0 to 0.16.2 in /pkgs/servers/web-apps/discourse/plugins/discourse-ldap-auth
t-chab/nixpkgs#57](/t-chab/nixpkgs/pull/57)
 Open

[build(deps): bump net-ldap from 0.14.0 to 0.16.2 in /pkgs/servers/web-apps/discourse/plugins/discourse-ldap-auth
CorbanR/nixpkgs-1#108](/CorbanR/nixpkgs-1/pull/108)
 Open

[build(deps): bump net-ldap from 0.14.0 to 0.16.2 in /pkgs/servers/web-apps/discourse/plugins/discourse-ldap-auth
sar/nixpkgs#119](/sar/nixpkgs/pull/119)
 Open

[Bump net-ldap from 0.11 to 0.16.2 in /\_site/play-with-docker/Portus
collabnix/dockerlabs#491](/collabnix/dockerlabs/pull/491)
 Merged

[Bump net-ldap from 0.11 to 0.16.2 in /play-with-docker/Portus
ayoinc/dockerlabs#291](/ayoinc/dockerlabs/pull/291)
 Open

[Bump net-ldap from 0.15.0 to 0.16.2
dschmura/roulette#20](/dschmura/roulette/pull/20)
 Open

[Bump net-ldap from 0.11 to 0.16.2
johan--/cartodb#11](/johan--/cartodb/pull/11)
 Open

[build(deps): bump net-ldap from 0.14.0 to 0.16.2 in /pkgs/servers/web-apps/discourse/plugins/discourse-ldap-auth
jiegec/nixpkgs#84](/jiegec/nixpkgs/pull/84)
 Open

[build(deps): bump net-ldap from 0.14.0 to 0.16.2 in /pkgs/servers/web-apps/discourse/plugins/discourse-ldap-auth
fitzgibbon/nixpkgs#121](/fitzgibbon/nixpkgs/pull/121)
 Open

[build(deps): bump net-ldap from 0.14.0 to 0.16.2 in /pkgs/servers/web-apps/discourse/plugins/discourse-ldap-auth
cyntheticfox/nixpkgs#98](/cyntheticfox/nixpkgs/pull/98)
 Open

[Bump net-ldap from 0.3.1 to 0.16.2
cobyism/redmine-heroku#16](/cobyism/redmine-heroku/pull/16)
 Open

[Bump net-ldap from 0.3.1 to 0.16.2
utfsmlabs/rctm#4](/utfsmlabs/rctm/pull/4)
 Open

[Bump net-ldap from 0.3.1 to 0.16.2 in /sli/opstools/migration/admin\_account\_management
todd-fritz/secure-data-service#4](/todd-fritz/secure-data-service/pull/4)
 Open

[Bump net-ldap from 0.3.1 to 0.16.2
akusumoto/kredmine#12](/akusumoto/kredmine/pull/12)
 Open

[Bump net-ldap from 0.3.1 to 0.16.2
mastersin/chiliproject-openshift-quickstart#24](/mastersin/chiliproject-openshift-quickstart/pull/24)
 Open

[Bump net-ldap from 0.3.1 to 0.16.2 in /www/NeuroML-DB.org
scrook/neuroml-db#132](/scrook/neuroml-db/pull/132)
 Open

[Bump net-ldap from 0.3.1 to 0.16.2
e0da/account\_manager#57](/e0da/account_manager/pull/57)
 Open

[Bump net-ldap from 0.5.1 to 0.16.2 in /gateway/acceptance-tests
todd-fritz/legacy-projects#5](/todd-fritz/legacy-projects/pull/5)
 Open

[Bump net-ldap from 0.6.1 to 0.16.2
mconf/mconf-web-ufrgs#50](/mconf/mconf-web-ufrgs/pull/50)
 Open

[Bump net-ldap from 0.6.1 to 0.16.2
eric-erki/mconf-web#27](/eric-erki/mconf-web/pull/27)
 Open

[![@dependabot](https://avatars.githubusercontent.com/in/29110?s=40&v=4)](/apps/dependabot)
[dependabot](/apps/dependabot)
bot
mentioned this pull request
[Dec 18, 2023](#ref-pullrequest-2047339562)

[Bump the bundler group across 1 directories with 5 updates
GrantBirki/ldap-api#1](/GrantBirki/ldap-api/pull/1)
 Closed

[![@dependabot](https://avatars.githubusercontent.com/in/29110?s=40&v=4)](/apps/dependabot)
[dependabot](/apps/dependabot)
bot
mentioned this pull request
[May 14, 2024](#ref-pullrequest-2294137257)

[Bump the bundler group across 1 directory with 18 updates
chrisemoulton/cartodb#1](/chrisemoulton/cartodb/pull/1)
 Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fruby-ldap%2Fruby-net-ldap%2Fpull%2F279)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [LDAPS vulnerable to MITM - failure to validate hostname against CN or SAN in X509 Cert](https://github.com/ruby-ldap/ruby-net-ldap/issues/258)

6 participants

[![@tmaher](https://avatars.githubusercontent.com/u/297632?s=52&v=4)](/tmaher) [![@jch](https://avatars.githubusercontent.com/u/19874?s=52&v=4)](/jch) [![@chrisbloom7](https://avatars.githubusercontent.com/u/21250?s=52&v=4)](/chrisbloom7) [![@krzcho](https://avatars.githubusercontent.com/u/18173?s=52&v=4)](/krzcho) [![@JPvRiel](https://avatars.githubusercontent.com/u/9722317?s=52&v=4)](/JPvRiel) [![@JPvRiel-SB](https://avatars.githubusercontent.com/u/139124182?s=52&v=4)](/JPvRiel-SB)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from openwall.com_dd384225_20250124_130030.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAA7hUgEumKFGGWbfVe=j3xyxBoA0cXSDzds-=pDozm+h6X597A@mail.gmail.com>
Date: Sun, 17 Dec 2017 21:27:11 +0100
From: Raphael Geissert <atomo64@...il.com>
To: Open Source Security <oss-security@...ts.openwall.com>
Subject: Net::LDAP ruby gem, missing certificate validation

Hi,

Just another heads up that I requested a CVE id for issue #258[1] in the
Net::LDAP ruby gem. Versions older than 0.16.0 did not verify that the LDAP
server's certificate matched the host it was supposed to be connecting to.

This has now been assigned CVE-2017-17718 by MITRE.

Older versions did not perform any kind of validation at all, but it was
properly documented as such. Based on the changelog I believe this to have
changed in 0.10.0 by verifying the certificate's trust chain.

[1]<https://github.com/ruby-ldap/ruby-net-ldap/issues/258>

Cheers,
--
Raphael Geissert

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


