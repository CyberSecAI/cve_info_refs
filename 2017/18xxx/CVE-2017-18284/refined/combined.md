=== Content from security.gentoo.org_43ec91de_20250125_071514.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# BURP: Multiple vulnerabilities — GLSA **201806-03**

Multiple vulnerabilities were discovered in BURP's Gentoo ebuild,
the worst of which could lead to root privilege escalation.

### Affected packages

| Package | **app-backup/burp** on all architectures |
| --- | --- |
| Affected versions | < **2.1.32** |
| Unaffected versions | >= **2.1.32** |

### Background

A network backup and restore program.

### Description

It was discovered that Gentoo’s BURP ebuild does not properly set
permissions or place the pid file in a safe directory.

### Impact

A local attacker could escalate privileges.

### Workaround

Users should ensure the proper permissions are set as discussed in the
referenced bugs.

### Resolution

All BURP users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-backup/burp-2.1.32"

```
### References

* [CVE-2017-18284](https://nvd.nist.gov/vuln/detail/CVE-2017-18284)
* [CVE-2017-18285](https://nvd.nist.gov/vuln/detail/CVE-2017-18285)

**Release date**

June 13, 2018

**Latest revision**

June 13, 2018: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [628770](https://bugs.gentoo.org/show_bug.cgi?id=628770)
* [641842](https://bugs.gentoo.org/show_bug.cgi?id=641842)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.gentoo.org_f375af00_20250125_071514.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 628770
<app-backup/burp-2.1.32: privilege escalation via PID file manipulation
Last modified: 2018-06-13 20:56:35 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=628770&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=628770&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 628770**](show_bug.cgi?id=628770)
(CVE-2017-18284)
- <app-backup/burp-2.1.32: privilege escalation via PID file manipulation

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<app-backup/burp-2.1.32: privilege escalation via PID file manipulation

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2017-18284 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B3 [glsa+ cve] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [655950](show_bug.cgi?id=655950 "RESOLVED FIXED - =app-backup/burp-2.1.32: stabilisation request") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=628770&hide_resolved=1) | |  | | Reported: | 2017-08-23 20:31 UTC by Michael Orlitzky | | --- | --- | | Modified: | 2018-06-13 20:56 UTC ([History](show_activity.cgi?id=628770)) | | CC List: | 1 user (show)  marecki | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=628770&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=628770&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Michael Orlitzky   gentoo-dev  2017-08-23 20:31:56 UTC  ``` The tmpfiles.d entry for burp gives ownership of the PID file directory to the same user that the daemon runs as:    $ cat /usr/lib/tmpfiles.d/burp.conf   d /run/burp 0755 burp burp -  As a result, the "burp" user can write whatever he wants into the PID file. Later, that may be exploitable: when the service is stopped, root will call "kill" on the contents of that file.  But there's good news: even when running as the "burp" user, the daemon will create its PID file as root, before dropping privileges. For example on my system I see,    $ sudo grep user /etc/burp/burp-server.conf   # Run as different user/group.   user=burp    $ ls /run/burp   total 4.0K   -rw-r--r-- 1 root root 6 2017-08-23 16:23 burp.server.pid  As a result, you can either leave /run/burp as root:root, or simply store the PID file in /run (as opposed to /run/burp) to avoid the vulnerability.  In the systemd service file, I noticed you have,    [Service]   Type=simple   PIDFile=/run/burp/burp.server.pid  A "simple" service runs in the foreground, so I don't think you need the PIDFile line at all, even if the daemon creates one. ```  [Comment 1](#c1)  Marek Szuba (RETIRED)   archtester gentoo-dev  2017-12-20 16:51:05 UTC  ``` I wrote a long explanation here but my browser kindly axed it, therefore a short version this time. Chowning the pid-file directory was necessary in the event of burp server running as non-root for all version older than 2.1.18 because they dropped privileges before creading the pid file; this was only changed by upstream commit f765ad2c9f421eefcd3afc447ed45fa3fd2d17a0 in mid-August 2017. PIDFile was present in burp.service because it allowed systemd to get rid of leftover PID files after unit shutdown, that said I've checked that it does allow privilege escalation even for Type=simple services (in a slightly weird way - systemd ended up terminating both the correct process *and* the victim specified in the PIDFile) so now it is no longer set. As for the proper fix, it has been implemented in ebuilds for 2.1.24 for the dev branch and 2.0.54-r3 for the stable branch; in the latter case I have backported the aforementioned commit. Assuming neither of the two exhibits any major breakage within the next couple of days I will submit 2.0.54-r3 for fast-track stabilisation to supersede vulnerable 2.0.54, and remove the remaining vulnerable ebuilds (2.0.54, 2.0.54-r2, 2.1.22) from the tree. ```  [Comment 2](#c2)  Michael Orlitzky   gentoo-dev  2017-12-20 19:59:47 UTC  ``` Thank you for going the extra mile to fix this. I hate to say it, but while testing the fix I noticed another (unrelated) permissions issue that I'll open a separate bug for. ```  [Comment 3](#c3)  Marek Szuba (RETIRED)   archtester gentoo-dev  2017-12-21 14:44:49 UTC  ``` Sigh. s/2.0.54-r3/2.0.54-r4/, s/2.1.24/2.1.24-r1/. ```  [Comment 4](#c4)  Larry the Git Cow   gentoo-dev  2018-05-29 09:26:40 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=5cd39164b55ee94a0754a89c0069f228e58183ee>  commit 5cd39164b55ee94a0754a89c0069f228e58183ee Author:     Marek Szuba <marecki@gentoo.org> AuthorDate: 2018-05-29 09:25:37 +0000 Commit:     Marek Szuba <marecki@gentoo.org> CommitDate: 2018-05-29 09:26:30 +0000      app-backup/burp: remove old following full stabilisation of 2.1.32          There are now no versions left in the tree that are vulnerable to     either #628770 or #641842          Bug: [https://bugs.gentoo.org/show_bug.cgi?id=628770](show_bug.cgi?id=628770 "RESOLVED FIXED - <app-backup/burp-2.1.32: privilege escalation via PID file manipulation")     Bug: [https://bugs.gentoo.org/show_bug.cgi?id=641842](show_bug.cgi?id=641842 "RESOLVED FIXED - <app-backup/burp-2.1.32-r1: root privilege escalation via writable config directory")     Package-Manager: Portage-2.3.40, Repoman-2.3.9   app-backup/burp/Manifest                           |   1 -  app-backup/burp/burp-2.0.54-r4.ebuild              | 111 ---------------------  app-backup/burp/burp-2.0.54.ebuild                 | 110 --------------------  .../burp-2.0.54-chuser_after_getting_lock.patch    |  38 -------  .../files/burp-2.0.54-ncurses_pkg-config.patch     |  37 -------  .../burp/files/burp-2.0.54-no_mkdir_run.patch      |  10 --  .../files/burp-2.0.54-protocol1_by_default.patch   |  24 -----  app-backup/burp/files/burp.tmpfiles                |   1 -  app-backup/burp/files/burp2.initd                  |  45 ---------  9 files changed, 377 deletions(-) ```  [Comment 5](#c5)  Christopher Díaz Riveros (RETIRED)   gentoo-dev Security  2018-06-04 03:12:44 UTC  ``` CVE-2017-18284 assigned to this issue. ```  [Comment 6](#c6)  GLSAMaker/CVETool Bot   gentoo-dev  2018-06-13 20:56:35 UTC  ``` This issue was resolved and addressed in  GLSA 201806-03 at <https://security.gentoo.org/glsa/201806-03> by GLSA coordinator Aaron Bauman (b-man). ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=628770)
* - [XML](show_bug.cgi?ctype=xml&id=628770)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=628770)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=628770&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=628770&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=628770&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


