=== Content from blog.sucuri.net_c5a89d40_20250125_125342.html ===
  [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)
     [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
 [Login](https://dashboard.sucuri.net/login/)       [Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)
 Search for:  Search

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Security Education](https://blog.sucuri.net/category/security-education)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
# Unwanted “Shorte St” Ads in Unpatched Newspaper Theme

  [![](https://secure.gravatar.com/avatar/a6437791c9b8a7c6f79c91b3ee027f26?s=60&d=mm&r=g)](https://blog.sucuri.net/author/fernando)   [Fernando Barbosa](https://blog.sucuri.net/author/fernando)

* June 20, 2017
 ![](https://blog.sucuri.net/wp-content/uploads/2017/06/06202017-EN-unwanted-short-st-ads-in-unpathced-newspaper-theme_blog.jpg)

Unwanted ads are one of the most common problems that site owners ask us to solve. Recently, we’ve noticed quite a few requests to remove intrusive “**shorte st**” ads that they never installed on their sites themselves. My colleague [Denis Sinegubko](https://twitter.com/unmaskparasites) of [UnmaskParasites](http://www.unmaskparasites.com/) helped to investigate this case.

**Shorte[.]st** is a service that hijacks links, forcing visitors to view a page containing ads before they can visit the link they clicked on. Site owners usually install the script themselves and earn money for exposing site visitors to the (often deceptive) ads.

However, this time webmasters denied installing the “shorte st” ad script. Moreover, some said that the [“shorte st” ads replaced ads from other providers](https://www.namepros.com/threads/ads-not-running-due-to-adwords-advertising-policies.1020284/) they used for site monetization.

In addition to interstitials for clicks on links, full-screen ads are displayed when a visitor comes to the website for the first time.

[![](https://blog.sucuri.net/wp-content/uploads/2017/06/short-se-ad-example-650x338.jpg)](https://blog.sucuri.net/wp-content/uploads/2017/06/short-se-ad-example.png)

Example of a full screen “shorte st” ad overlay.

The ads vary for visitors from different countries, browsers, and operating systems. In general, the content of the ads is questionable. Sometimes, instead of seeing the ads, visitors see an empty rectangle or a full-screen block displaying a database error. Needless to say, this unwanted behavior significantly compromises the user experience for these sites.

In each of the cases, infected web pages contained the following injected code:

[![](https://blog.sucuri.net/wp-content/uploads/2017/06/short-se-ad-code-650x377.png)](https://blog.sucuri.net/wp-content/uploads/2017/06/short-se-ad-code.png)

The cdn.shorte[.]st/link-converter.min.js script

## Newspaper Theme Under Attack

The code was injected into the **wp\_options** table of WordPress database. Shortly after, we noticed that the infected sites were using a popular premium theme called **Newspaper** (and its sibling **Newsmag**  or its derivative). The theme had been sold to over **40 thousand** users, not counting pirated copies.

The injected ad code corresponds to the theme’s “**header ad**” that site administrators can modify in the theme panel of the WordPress admin interface.

[![](https://blog.sucuri.net/wp-content/uploads/2017/06/newspaper-theme-panel-short-se-650x245.png)](https://blog.sucuri.net/wp-content/uploads/2017/06/newspaper-theme-panel-short-se.png)

Header ad block in the Newspaper theme panel

At this point, it appeared that there was a major problem with this particular theme. It turned out that **versions 6.x** of this theme had a serious vulnerability that allowed attackers to modify arbitrary WordPress options.

One way to exploit this vulnerability was [disclosed a year ago](https://www.exploit-db.com/exploits/39894/). The security hole was quickly patched in version **6.7.2** of the theme, but as it often happens, quite a few sites didn’t update the theme. One year later, all the affected sites still used vulnerable versions **6.4 – 6.7.1**.

## Logs Showing Shorte St

To prove that this old vulnerability was indeed connected with the “shorte st” ad injection, we decided to scan logs of our [website firewall](https://sucuri.net/website-firewall/) that protects sites of thousands of our client’s websites.

It was easy to do because the injected code had the following unique “shorte st” tokens:

```
" token ": " a6f162b602a6de26110784b1c5ccc382 &quot;
" token ": " 8f1bc5aa7e697f9829c057cfd305bd64 &quot;

```

We discovered an ongoing attack that tried to inject the “shorte st” script passing it in the **td\_ads[header]** parameter of **admin-ajax.php** POST requests. We reconstructed the requests on our test servers and confirmed that the attack exploited the old vulnerability, and updated versions of the Newspaper theme **6.7.2+** are protected against it.

## Cleanup and Hardening

It’s easy to remove the injected “shorte st” ads. You just need to remove that code from the Newspaper theme panel’s “header ad” block in WordPress admin interface under **Newspaper > Theme panel > ADS > YOUR HEADER AD.**You can also replace it with your original ad code.

However, please don’t stop here. If you don’t do anything else, your site will be reinfected because the security hole is still open and the attackers already know that your site is vulnerable. We have reports that the unwanted ads return within a couple of days if the site is not hardened.

To prevent reinfections you need to **update your theme** to the latest version (patched in **6.7.2**). We realize that sometimes theme upgrades are not that easy, especially if for some reason the theme has been heavily customized. In such cases, you should consider using a [website firewall](https://sucuri.net/website-firewall/) that can virtually patch the security hole.

## Conclusion

This “shorte st” ad injection is not the only possible way to exploit the Newspaper theme vulnerability. Not only can the security hole be used to inject more malicious code, it also allows hackers to completely take over the blog (e.g. inject a script that would [steal admin user cookies](https://blog.sucuri.net/2017/05/fake-wordprssapi-stealing-cookies-and-hijacking-sessions.html) or enable user registrations that change the default role of new users).

Please take your website security seriously. Patch the vulnerability and then inspect your blog for a presence of suspicious users. Our free [SiteCheck](https://sitecheck.sucuri.net/) scanner can detect a number of security issues that show up in a browser. Test all settings, change passwords, and scan your server for backdoors that hackers could have left if they really broke into your site.

  [![](https://secure.gravatar.com/avatar/a6437791c9b8a7c6f79c91b3ee027f26?s=120&d=mm&r=g)](https://blog.sucuri.net/author/fernando)
##### [Fernando Barbosa](https://blog.sucuri.net/author/fernando)

Fernando Barbosa is a Sucuri's Software Development Manager who joined the company in 2012. Fernando's main responsibilities include leading Sucuri's backend teams and engineering solutions for our suite of security products. His professional experience also covers five years of malware analysis and incident response. When Fernando isn't working, you might find him having good times with his family. Connect with Fernando on [Twitter](https://twitter.com/fbarbosan).

##### Related Tags

* [Conditional Malware](https://blog.sucuri.net/tag/conditional-malware),
* [Malvertising](https://blog.sucuri.net/tag/malvertising),
* [WordPress Plugins and Themes](https://blog.sucuri.net/tag/wordpress-plugins-and-themes)
##### Related Categories

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Security Education](https://blog.sucuri.net/category/security-education)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
##### You May Also Like

 ![Sucuri October 2024 Vulnerability Roundup](https://blog.sucuri.net/wp-content/uploads/2024/11/October-2024-390x183.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Security Education](https://blog.sucuri.net/category/security-education)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPress Vulnerability & Patch Roundup October 2024](https://blog.sucuri.net/2024/11/wordpress-vulnerability-patch-roundup-october-2024.html)

* [![](https://blog.sucuri.net/wp-content/uploads/2024/07/avatar_user_112_1721420180-20x20.png)Sucuri Malware Research Team](https://blog.sucuri.net/author/malware-research "View all posts by Sucuri Malware Research Team")
* November 1, 2024
 Vulnerability reports and responsible disclosures are essential for website security awareness and education. Automated attacks targeting known software vulnerabilities are one of the leading causes…  [Read the Post](https://blog.sucuri.net/2024/11/wordpress-vulnerability-patch-roundup-october-2024.html)  ![Uncommon Radixes Obfuscation](https://blog.sucuri.net/wp-content/uploads/2019/03/03142019-uncommon-radixes-uses-in-malware-obfuscation_blog-390x183.jpg)

* [Security Education](https://blog.sucuri.net/category/security-education)
* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [String Concatenation: Obfuscation Techniques](https://blog.sucuri.net/2020/08/string-concatenation-obfuscation-techniques.html)

* [![](https://secure.gravatar.com/avatar/df2487806812cf3a45af64a37a1e0daf?s=20&d=mm&r=g)Krasimir Konov](https://blog.sucuri.net/author/krasimir "View all posts by Krasimir Konov")
* August 12, 2020
 While string concatenation has many valuable applications in development — such as making code more efficient or functions more effective — it is also a…  [Read the Post](https://blog.sucuri.net/2020/08/string-concatenation-obfuscation-techniques.html)  ![WordPress Vulnerablity Disclosre](https://blog.sucuri.net/wp-content/uploads/2016/08/wordpress-vulnerability-disclosure-390x184.jpg)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPress Update – 4.9.7 Security & Maintenance Release](https://blog.sucuri.net/2018/07/wordpress-update-4-9-7-security-maintenance-release.html)

* [![](https://secure.gravatar.com/avatar/8612a64e0ed5b9e586b548a984073120?s=20&d=mm&r=g)Marc-Alexandre Montpas](https://blog.sucuri.net/author/marc "View all posts by Marc-Alexandre Montpas")
* July 5, 2018
 The WordPress team has just released a critical security and maintenance update to resolve a number of bugs and security issues. Included in this release…  [Read the Post](https://blog.sucuri.net/2018/07/wordpress-update-4-9-7-security-maintenance-release.html)  ![](https://blog.sucuri.net/wp-content/uploads/2020/10/csam-networking-390x195.png)

* [Security Education](https://blog.sucuri.net/category/security-education)

## [Bridging the Gap Between Application and Network Security with CleanBrowsing](https://blog.sucuri.net/2020/10/application-network-security-cleanbrowsing.html)

* [![](https://secure.gravatar.com/avatar/c47101d30a0f98927ecf698e56454c4b?s=20&d=mm&r=g)Tony Perez & Daniel Cid](https://blog.sucuri.net/author/tonydaniel "View all posts by Tony Perez & Daniel Cid")
* October 30, 2020
 When we started Sucuri we set out to make enterprise security accessible, affordable, and effective for every day webmasters. It was at a time when…  [Read the Post](https://blog.sucuri.net/2020/10/application-network-security-cleanbrowsing.html)  ![](https://blog.sucuri.net/wp-content/uploads/2019/11/10302019_SkimmersMagnetoWordpress_blog-390x183.png)

* [Ecommerce Security](https://blog.sucuri.net/category/ecommerce-security)
* [Magento Security](https://blog.sucuri.net/category/magento-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Skimmers for Both Magento and WordPress](https://blog.sucuri.net/2019/11/skimmers-for-both-magento-and-wordpress.html)

* [![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=20&d=mm&r=g)Denis Sinegubko](https://blog.sucuri.net/author/denis "View all posts by Denis Sinegubko")
* November 7, 2019
 We often write about malware that steal payment information from sites built with Magento and other types of e-commerce CMS. When discussing credit card skimmers…  [Read the Post](https://blog.sucuri.net/2019/11/skimmers-for-both-magento-and-wordpress.html)  ![WordPress Redirect Hack via Test0.com/Default7.com](https://blog.sucuri.net/wp-content/uploads/2020/04/04212020_WordPress_Obfuscation_Dropper-390x183.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [R\_Evil WordPress Hacktool & Malicious JavaScript Injections](https://blog.sucuri.net/2020/10/r_evil-wordpress-hacktool-malicious-javascript-injections.html)

* [![](https://secure.gravatar.com/avatar/b020abf59d6245e6b2a4635063322498?s=20&d=mm&r=g)Luke Leal](https://blog.sucuri.net/author/luke "View all posts by Luke Leal")
* October 22, 2020
 We often see hackers reusing the same malware, with only a few new adjustments to obfuscate the code so that it is more difficult for…  [Read the Post](https://blog.sucuri.net/2020/10/r_evil-wordpress-hacktool-malicious-javascript-injections.html)  ![PHP repository exploited by hackers](https://blog.sucuri.net/wp-content/uploads/2019/12/20191118_HowPasswordsGetHacked_blog-390x183.png)

* [Security Education](https://blog.sucuri.net/category/security-education)
* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [P.A.S. Fork v. 1.0 — A Web Shell Revival](https://blog.sucuri.net/2020/10/p-a-s-fork-v-1-0-a-web-shell-revival.html)

* [![](https://secure.gravatar.com/avatar/b020abf59d6245e6b2a4635063322498?s=20&d=mm&r=g)Luke Leal](https://blog.sucuri.net/author/luke "View all posts by Luke Leal")
* October 26, 2020
 A PHP web shell containing multiple functions can easily consist of thousands of lines of code, so it’s no surprise that attackers often reuse the…  [Read the Post](https://blog.sucuri.net/2020/10/p-a-s-fork-v-1-0-a-web-shell-revival.html)  ![Content Security Policy](https://blog.sucuri.net/wp-content/uploads/2018/03/04032018-content-security-policy_en-blog-390x183.png)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Security Education](https://blog.sucuri.net/category/security-education)
* [Sucuri](https://blog.sucuri.net/category/sucuri)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [Content Security Policy](https://blog.sucuri.net/2018/04/content-security-policy.html)

* [![](https://secure.gravatar.com/avatar/02a5df4db823f09b2571a26104cf22a8?s=20&d=mm&r=g)Gerson Ruiz](https://blog.sucuri.net/author/gerson "View all posts by Gerson Ruiz")
* April 13, 2018
 As a website owner, it’s a good idea to be aware of the security issues that might affect your site. For example, Cross-site Scripting (XSS)…  [Read the Post](https://blog.sucuri.net/2018/04/content-security-policy.html)  ![A New Wave of Buggy WordPress Infections](https://blog.sucuri.net/wp-content/uploads/2019/09/09092019-how-to-audit-cleanup-wordpress-themes_blog-390x183.png)

* [Security Education](https://blog.sucuri.net/category/security-education)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [How to Audit & Cleanup WordPress Plugins & Themes](https://blog.sucuri.net/2019/09/wordpress-plugin-audit.html)

* [![](https://blog.sucuri.net/wp-content/uploads/2024/05/avatar_user_61_1716939211-20x20.jpg)Pilar Garcia](https://blog.sucuri.net/author/pilar "View all posts by Pilar Garcia")
* September 9, 2019
 In an interview with Smashing Magazine our CoFounder (now Head of Security Products at GoDaddy) Tony Perez was asked the following question. What Makes WordPress…  [Read the Post](https://blog.sucuri.net/2019/09/wordpress-plugin-audit.html)  ![What are website backdoors Sucuri Security](https://blog.sucuri.net/wp-content/uploads/2021/11/2021_Sucuri_BlogFeatureImage_1490x700_WhatAreBackdoors_final-390x183.jpg)

* [Security Education](https://blog.sucuri.net/category/security-education)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [What is a Website Backdoor?](https://blog.sucuri.net/2021/11/what-is-a-website-backdoor.html)

* [![](https://secure.gravatar.com/avatar/cb2f41c5519c65870fc6a4af3f853364?s=20&d=mm&r=g)Allison Bondi](https://blog.sucuri.net/author/allison-bondi "View all posts by Allison Bondi")
* November 18, 2021
 What is a Backdoor? A backdoor provides a shortcut for authorized or unauthorized users to gain access to an unauthorized location of a website, software,…  [Read the Post](https://blog.sucuri.net/2021/11/what-is-a-website-backdoor.html)
##### Search

 Search for:  Search[![WordPress Security Guide Sidebar](https://blog.sucuri.net/wp-content/uploads/2024/02/WordPress-Security-Guide-Sidebar.jpg)](https://sucuri.net/guides/wordpress-security/)[![](https://blog.sucuri.net/wp-content/uploads/2023/04/23-sucuri-newsletter-blog-banner.png)](https://info.sucuri.net/subscribe-to-security)[![Sucuri Sidebar Malware Removal to Signup Page](https://blog.sucuri.net/wp-content/uploads/2023/08/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-new.png)](https://sucuri.net/website-security-platform/signup/) ![Sucuri Logo](https://sucuri.net/wp-content/uploads/2022/12/sucuri_logo_dark.svg)

Let’s Connect

        [Products](https://sucuri.net/website-security/)   [Website Firewall](https://sucuri.net/website-firewall/)   [Website Security Platform](https://sucuri.net/website-security-platform/)   [WordPress Security](https://sucuri.net/wordpress-security/)   [Website Backups](https://sucuri.net/website-backups/)   [Hack Assistance](https://sucuri.net/website-security-platform/help-now/)   [Pricing](https://sucuri.net/website-security-platform/signup)   [Solutions](https://sucuri.net/ddos-protection/)   [DDoS Protection](https://sucuri.net/ddos-protection/)   [Malware Detection](https://sucuri.net/malware-detection-scanning/)   [Malware Removal](https://sucuri.net/website-malware-removal/)   [Malware Prevention](https://sucuri.net/website-hack-protection/)   [Blacklist Removal](https://sucuri.net/website-security-platform/blocklist-removal-and-repair/)   [SEO Spam Removal](https://sucuri.net/seo-spam-removal/)  USE CASES  [Developers](https://sucuri.net/developers/)   [Ecommerce](https://sucuri.net/ecommerce-website-security/)   [Agency Plans](https://sucuri.net/custom/agency/)   [Enterprise Services](https://sucuri.net/custom/agency/)   [HTTPS/2](https://sucuri.net/http-2-rapid-reset/)   [Virtual Patching](https://sucuri.net/virtual-patching/)   [Support](https://docs.sucuri.net/)   [Knowledge Base](https://docs.sucuri.net/)   [SiteCheck](https://sitecheck.sucuri.net/)   [Guides](https://sucuri.net/guides/)   [Research Labs](https://labs.sucuri.net/)   [Report Abuse](https://abuse.sucuri.net/)   [Status Report](https://status.sucuri.net/)   [Company](https://sucuri.net/company/)   [About Sucuri](https://sucuri.net/company/)   [Contact](https://sucuri.net/company/contact-us/)   [Blog](https://blog.sucuri.net/)   [Referral](https://sucuri.net/referral/)   [Partners](https://sucuri.net/partners/)   [Testimonials](https://sucuri.net/customers/)  [Terms of Use](https://sucuri.net/terms/) [Privacy Policy](https://sucuri.net/privacy/) [Do Not Sell My Personal Information](https://sucuri.net/cookies/) [Frequently Asked Questions](https://sucuri.net/faq/)

© 2025 GoDaddy Mediatemple, Inc., d/b/a Sucuri. All rights reserved.

   [back to top](#top "Going Top")  X

Sucuri Cookie Policy
 [See our policy>>](https://sucuri.net/cookies)

Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.

 Accept Decline Manage Options
