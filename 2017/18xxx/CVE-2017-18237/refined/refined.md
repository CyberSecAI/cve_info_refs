Based on the provided information, this content relates to **CVE-2017-18237**.

**Root cause of vulnerability:**
The vulnerability stems from a crash within the `PostScript_Support::ConvertToDate()` function when parsing a malformed PostScript file. Specifically, the code attempts to access `itr->token[0]` without verifying that the `token` string is not empty, and it also attempts to iterate beyond the end of a vector of tokens, leading to out-of-bounds access.

**Weaknesses/vulnerabilities present:**
- **Out-of-bounds read:** Accessing `itr->token[0]` when `itr->token` is empty.
- **Incorrect iterator handling:** The code iterates through a vector of tokens, and in some circumstances, it advances past the end of the vector and then tries to access the iterator contents.

**Impact of exploitation:**
- **Segmentation fault:** The program crashes due to the out-of-bounds access, leading to a denial-of-service.
- **Heap-buffer-overflow:** AddressSanitizer identified a heap-buffer-overflow, indicating a potential for memory corruption.

**Attack vectors:**
- **Malicious PostScript file:** An attacker can craft a specially designed PostScript file that triggers the vulnerability when processed by Exempi.

**Required attacker capabilities/position:**
- The attacker needs to be able to supply a crafted PostScript file to the Exempi library for processing.

**Technical details:**
- The vulnerable code resides in `XMPFiles/source/FormatSupport/PostScript_Support.cpp`, specifically in the `ConvertToDate` function.
- The fix addresses two issues:
    - It adds a check to ensure that `itr->token` is not empty before attempting to access `itr->token[0]`.
    - It adds a check to verify that the iterator `itr` is not at the end of the vector `tokenzs` before accessing the members, in order to avoid an out-of-bounds access when processing a corrupt file.
- The bug was discovered using American Fuzzy Lop (AFL), a fuzzer.
- The crash occurs when trying to parse a date string from a PostScript file.