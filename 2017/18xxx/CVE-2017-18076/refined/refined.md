```
{
  "cve": "CVE-2017-18076",
  "description": "In strategy.rb in OmniAuth before 1.3.2, the authenticity_token value is improperly protected because POST (in addition to GET) parameters are stored in the session and become available in the environment of the callback phase.",
  "affected_versions": "< 1.3.2",
  "patched_versions": "1.3.2",
  "root_cause": "The OmniAuth library was storing both GET and POST parameters in the session during the request phase. These parameters are then accessible in the callback phase. POST parameters can include the application's authenticity_token, which is used to protect against CSRF attacks.",
  "vulnerabilities": [
    "Improper protection of the authenticity_token",
    "Storage of POST parameters in session, exposing them in the callback phase"
  ],
  "impact": "An attacker with access to the callback environment, such as in a crafted web application, could access the CSRF token.",
  "attack_vectors": [
    "Crafted web application",
    "Exploitation through access to the callback environment"
  ],
  "attacker_capabilities": "The attacker needs access to the callback environment of an application using the vulnerable OmniAuth library.",
   "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2017-18076",
    "https://github.com/omniauth/omniauth/pull/867",
    "https://github.com/omniauth/omniauth/commit/71866c5264122e196847a3980c43051446a03e9b",
    "https://bugs.debian.org/888523",
    "https://www.debian.org/security/2018/dsa-4109",
    "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/omniauth/CVE-2017-18076.yml"
  ]
}
```