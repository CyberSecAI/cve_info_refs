- **Root cause of vulnerability**: A race condition exists in `chown` when using the `--recursive` and `-L` (dereference) options. The depth-first traversal of directories follows symbolic links, which can lead to changing ownership of files in an unexpected order.
- **Weaknesses/vulnerabilities present**:
    - Race condition due to order of operations when recursively changing ownership while dereferencing symlinks
    - Ability to change ownership of files outside of the intended directory structure via manipulation of symlinks
- **Impact of exploitation**: An attacker can trick the `chown` command (run as root) into changing the ownership of files, such as `/etc/passwd`, to an attacker-controlled user. This can allow the attacker to gain escalated privileges or unauthorized access.
- **Attack vectors**: Exploitation requires the ability to create symlinks and modify files within a directory that is the target of the `chown` command.
- **Required attacker capabilities/position**:
    - The attacker needs to be able to create a symlink that points upwards in the directory structure.
    - The attacker needs to be a local user with ability to modify files/directories in the target directory structure
    - The `chown` command must be run with root privileges and with the `-R` and `-L` options.
    - The system must have `fs.protected_symlinks` set to 0.