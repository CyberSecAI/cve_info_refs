Based on the provided content, here's the breakdown of CVE-2017-18217:

**Root cause of vulnerability:**
- The InvoicePlane application (version 1.5.0) had insufficient input sanitization, allowing user-supplied data to be stored and rendered unsafely within the application's response. Specifically, the "Email address" and "web address" fields within the "Add Client" functionality were vulnerable.

**Weaknesses/vulnerabilities present:**
- **Stored Cross-Site Scripting (XSS):** Malicious JavaScript code could be injected via the vulnerable fields. This code was then stored within the application's database and executed in the browsers of other users when they accessed the affected client information.
- **DOM-based XSS:** The vulnerability was also characterized as DOM-based, indicating that the malicious script execution could occur through the manipulation of the Document Object Model (DOM) within the client's browser.

**Impact of exploitation:**
- An attacker could inject malicious code into the application, which would then execute in the browser of any user viewing the relevant content.
- The injected code could perform various actions, including:
    - Stealing user cookies.
    - Performing actions on behalf of the user.
    - Capturing user keystrokes.

**Attack vectors:**
- An attacker would need to inject malicious JavaScript code into the "Email address" or "web address" fields when adding or editing client information.
- The attacker does not need any elevated privileges or special access to do this.

**Required attacker capabilities/position:**
- The attacker needs the ability to access the "Add Client" functionality within the InvoicePlane application.
- The attacker needs to be able to input data into the vulnerable fields.

**Additional Information:**
- The vulnerability was reported to the vendor on 08-Sep-2017, confirmed on 10-Sep-2017, and fixed in version 1.5.6 released on 13-Feb-2018.
- Pull requests #542 and #551 on the InvoicePlane GitHub repository addressed the vulnerability by implementing proper input sanitization, specifically for the client email and web address fields.