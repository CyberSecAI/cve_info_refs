```
{
  "vulnerability": {
    "CVE": "CVE-2017-18594",
    "description": "nse_libssh2.cc in Nmap 7.70 is subject to a denial of service condition due to a double free when an SSH connection fails, as demonstrated by a leading \\n character to ssh-brute.nse or ssh-auth-methods.nse.",
    "details": [
      {
        "type": "Root cause",
        "detail": "The vulnerability is caused by a double free in the `nse_libssh2.cc` module when an SSH connection fails due to an unexpected response from the server. Specifically, when Nmap's SSH scripts (like `ssh-brute.nse` or `ssh-auth-methods.nse`) attempt to connect to a port that does not respond with a standard SSH handshake, a double free can occur. This is triggered when a leading newline character is sent to the target port."
      },
      {
        "type": "Weaknesses",
        "detail": "The primary vulnerability is a double free condition. The libssh2 session data is freed but the session pointer is not set to NULL, which can lead to a double free if cleanup routines are called a second time."
      },
       {
        "type": "Impact",
        "detail": "The impact of this vulnerability is a denial of service (DoS). An attacker can cause Nmap to crash by sending a crafted response to an SSH connection attempt, specifically a leading newline character. This crash can disrupt network scanning operations."
      },
      {
        "type": "Attack vectors",
         "detail": "The attack vector is network-based. An attacker sends a crafted response with a leading newline character to a port that Nmap is trying to scan using SSH scripts."
      },
        {
        "type":"Required attacker capabilities/position",
        "detail": "The attacker needs to be able to send a crafted response, including a leading newline, to a target host on port 22 (or any port where Nmap is attempting an SSH connection with vulnerable scripts). The attacker could be a malicious server or a man-in-the-middle. "
        }
    ]
  }
}
```