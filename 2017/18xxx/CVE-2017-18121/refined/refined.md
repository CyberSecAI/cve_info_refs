Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2017-18121

**Root Cause of Vulnerability:**
The `consentAdmin` module in SimpleSAMLphp was vulnerable to a Cross-Site Scripting (XSS) attack due to improper sanitization of the URL used to build the logout link.

**Weaknesses/Vulnerabilities Present:**
- Cross-Site Scripting (XSS): The application did not sanitize the URL before using it to construct a logout link, allowing the injection of malicious JavaScript code.

**Impact of Exploitation:**
- An attacker could craft malicious links containing JavaScript code that would be executed within a victim's browser when the link is accessed.
- The attacker could potentially perform actions on behalf of the user, steal session cookies, redirect to a malicious site, or other malicious activities.

**Attack Vectors:**
- Crafted URLs: An attacker can manually construct a URL that includes malicious JavaScript code.
- Social engineering: The attacker would need to trick a user into clicking the malicious link.

**Required Attacker Capabilities/Position:**
- Ability to craft URLs: The attacker needs the ability to construct a URL containing the malicious JavaScript code.
- No specific network position or access is required as the exploit is delivered via a URL and executed on the client side.

**Additional Details:**
- The vulnerability exists in the `consentAdmin` module, which allows users to manage consents given to send attributes to third-party services.
- The module was using the current URL as observed by the server to build a logout link, without sanitizing the URL.
- The vulnerability affected all SimpleSAMLphp versions up to and including 1.14.15.
- The fix involved ignoring the current URL and manually building the logout link to prevent JavaScript injection.