=== Content from github.com_4c4c7640_20250125_050144.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FExiv2%2Fexiv2%2Fissues%2F168)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FExiv2%2Fexiv2%2Fissues%2F168)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Exiv2%2Fexiv2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Exiv2](/Exiv2)
/
**[exiv2](/Exiv2/exiv2)**
Public

* [Notifications](/login?return_to=%2FExiv2%2Fexiv2) You must be signed in to change notification settings
* [Fork
  286](/login?return_to=%2FExiv2%2Fexiv2)
* [Star
   966](/login?return_to=%2FExiv2%2Fexiv2)

* [Code](/Exiv2/exiv2)
* [Issues
  148](/Exiv2/exiv2/issues)
* [Pull requests
  21](/Exiv2/exiv2/pulls)
* [Discussions](/Exiv2/exiv2/discussions)
* [Actions](/Exiv2/exiv2/actions)
* [Projects
  0](/Exiv2/exiv2/projects)
* [Wiki](/Exiv2/exiv2/wiki)
* [Security](/Exiv2/exiv2/security)
* [Insights](/Exiv2/exiv2/pulse)

Additional navigation options

* [Code](/Exiv2/exiv2)
* [Issues](/Exiv2/exiv2/issues)
* [Pull requests](/Exiv2/exiv2/pulls)
* [Discussions](/Exiv2/exiv2/discussions)
* [Actions](/Exiv2/exiv2/actions)
* [Projects](/Exiv2/exiv2/projects)
* [Wiki](/Exiv2/exiv2/wiki)
* [Security](/Exiv2/exiv2/security)
* [Insights](/Exiv2/exiv2/pulse)

# CVE-2017-18005: NULL Pointer Dereference while extracting metadata of a malformed tiff #168

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[CVE-2017-18005: NULL Pointer Dereference while extracting metadata of a malformed tiff](#top)#168Copy linkAssignees [![D4N](https://avatars.githubusercontent.com/u/786021?s=64&v=4)](/D4N)Milestone[v0.27](https://github.com/Exiv2/exiv2/milestone/1)[![@kirit1193](https://avatars.githubusercontent.com/u/5624097?v=4&size=80)](/kirit1193)
## Description

[![@kirit1193](https://avatars.githubusercontent.com/u/5624097?v=4&size=48)](/kirit1193)[kirit1193](https://github.com/kirit1193)opened [on Nov 18, 2017](https://github.com/Exiv2/exiv2/issues/168#issue-275114755)

There's a NULL Pointer Dereference occurring during the metadata extraction from a malformed tiff file.

This can be triggered by running `./exiv2 -v pr -P EIXxgklnycsvth %file%` on the test-case, [exiv2-nullpointerderef.zip](https://github.com/Exiv2/exiv2/files/1485071/exiv2-nullpointerderef.zip).

The hexdump of the test-case is:

```
0000000 4949 002a 0050 0000 3030 3030 3030 3030
0000010 3030 3030 3030 3030 3030 3030 3030 3030
*
0000050 000f 0117 0006 0030 0000 3030 3030 3030
0000060 0003 0030 0000 3030 3030 3030 0002 0030
0000070 0000 3030 3030 3030 000b 0030 0000 3030
0000080 3030 3030 000b 0030 0000 3030 3030 3030
0000090 000b 0030 0000 3030 3030 3030 000b 0030
00000a0 0000 3030 3030 3030 0003 0030 0000 3030
00000b0 3030 3030 000b 0030 0000 3030 3030 3030
00000c0 000b 0030 0000 3030 3030 3030 000a 0000
00000d0 0000 3030 3030 3030 000b 0030 0000 3030
00000e0 3030 3030 000b 0030 0000 3030 3030 3030
00000f0 0003 0030 0000 3030 3030 3030 000c 0000
0000100 0000 3030 3030 0000 0000
0000109

```

The relevant ASAN output is:

```
==4728==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x557dc0c47468 bp 0x7fff7558bbb0 sp 0x7fff7558bbb0 T0)
==4728==The signal is caused by a READ memory access.
==4728==Hint: address points to the zero page.
    #0 0x557dc0c47467 in Exiv2::DataValue::toLong(long) const /home/ksg/exiv2/src/value.cpp:250
    #1 0x557dc0688058 in Action::Print::printMetadatum(Exiv2::Metadatum const&, Exiv2::Image const*) /home/ksg/exiv2/src/actions.cpp:731
    #2 0x557dc068bad2 in Action::Print::printMetadata(Exiv2::Image const*) /home/ksg/exiv2/src/actions.cpp:552
    #3 0x557dc068d61a in Action::Print::printList() /home/ksg/exiv2/src/actions.cpp:541
    #4 0x557dc06b8fff in Action::Print::run(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) /home/ksg/exiv2/src/actions.cpp:245
    #5 0x557dc05983a6 in main /home/ksg/exiv2/src/exiv2.cpp:170
    #6 0x7f2987d301c0 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x211c0)
    #7 0x557dc0621b59 in _start (/home/ksg/testbench/exiv2_asan+0x22bb59)

```

It looks like the NULL-Pointer Dereference is being triggered by a 0 value which is being used in the toLong function in the value of **n**, which is being dereferenced in

`return value_[n];`

This is indicated by the GDB backtrace:

```
Program received signal SIGSEGV, Segmentation fault.
Exiv2::DataValue::toLong (this=0x55555609d860, n=0) at value.cpp:250
250             return value_[n];
(gdb) bt
#0  Exiv2::DataValue::toLong (this=0x55555609d860, n=0) at value.cpp:250
#1  0x000055555561d5f1 in Action::Print::printMetadatum (this=this@entry=0x555556092e70, md=..., pImage=pImage@entry=0x555556093530) at actions.cpp:731
#2  0x000055555561ecf0 in Action::Print::printMetadata (this=this@entry=0x555556092e70, image=image@entry=0x555556093530) at actions.cpp:552
#3  0x000055555561f2fb in Action::Print::printList (this=this@entry=0x555556092e70) at actions.cpp:541
#4  0x00005555556313c8 in Action::Print::run (this=0x555556092e70, path="/home/ksg/exif-crashes/npd") at actions.cpp:245
#5  0x00005555555bc339 in main (argc=<optimized out>, argv=<optimized out>) at exiv2.cpp:170

```

Debug info:

Exiv2 version 0.26 001a00 (64 bit build)

Compiler: gcc 7.2, clang 4.0.1-6

OS: Ubuntu 17.10

## Metadata

### Assignees

* [![@D4N](https://avatars.githubusercontent.com/u/786021?s=64&v=4)D4N](/D4N)
### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

* [v0.27](https://github.com/Exiv2/exiv2/milestone/1)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_6d9ff48e_20250126_060952.html ===
�PNG

   
IHDR  �  �   �.�b  �IDATx������0 �8P��WU���XBR@�O�ڙ� �kjc���߫ � v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@¶z�;�c���{=������ v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$���c�9鼎9����'��M8���\�4��CrG��3H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���Hx�1Vo �q^v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�����9�c���{=���^v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�6���:��5�빯�@����;>�vsc>c���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A쀄�c���e$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�   ��D�'E��    IEND�B`�

=== Content from lists.debian.org_2a484556_20250125_050144.html ===


---

[[Date Prev](msg00003.html)][[Date Next](msg00005.html)]
[[Thread Prev](msg00003.html)][[Thread Next](msg00005.html)]
[[Date Index](maillist.html#00004)]
[[Thread Index](threads.html#00004)]

# [SECURITY] [DLA 3265-1] exiv2 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3265-1] exiv2 security update
* *From*: Helmut Grohne <helmut@subdivi.de>
* *Date*: Tue, 10 Jan 2023 18:02:40 +0100
* *Message-id*: <Y72aMPZ/Oh2YVUa/@alf.mars>
* *Mail-followup-to*: Helmut Grohne <helmut@subdivi.de>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3265-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Helmut Grohne
January 10, 2023                              <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : exiv2
Version        : 0.25-4+deb10u4
CVE ID         : CVE-2017-11591 CVE-2017-14859 CVE-2017-14862 CVE-2017-14864
                 CVE-2017-17669 CVE-2017-18005 CVE-2018-8976 CVE-2018-17581
                 CVE-2018-19107 CVE-2018-19108 CVE-2018-19535 CVE-2018-20097
                 CVE-2019-13110 CVE-2019-13112 CVE-2019-13114 CVE-2019-13504
                 CVE-2019-14369 CVE-2019-14370 CVE-2019-17402 CVE-2020-18771
                 CVE-2021-29458 CVE-2021-32815 CVE-2021-34334 CVE-2021-37620
                 CVE-2021-37621 CVE-2021-37622
Debian Bug     : 876893 885981 886006 903813 910060 913272 913273 915135
                 932467 946341 987277 992705 992706

This update fixes a number of memory access violations and other input
validation failures that can be triggered by passing specially crafted files to
exiv2.

CVE-2017-11591

    There is a Floating point exception in the Exiv2::ValueType function that
    will lead to a remote denial of service attack via crafted input.

CVE-2017-14859

    An Invalid memory address dereference was discovered in
    Exiv2::StringValueBase::read in value.cpp. The vulnerability causes a
    segmentation fault and application crash, which leads to denial of service.

CVE-2017-14862

    An Invalid memory address dereference was discovered in
    Exiv2::DataValue::read in value.cpp. The vulnerability causes a
    segmentation fault and application crash, which leads to denial of service.

CVE-2017-14864

    An Invalid memory address dereference was discovered in Exiv2::getULong in
    types.cpp. The vulnerability causes a segmentation fault and application
    crash, which leads to denial of service.

CVE-2017-17669

    There is a heap-based buffer over-read in the
    Exiv2::Internal::PngChunk::keyTXTChunk function of pngchunk_int.cpp. A
    crafted PNG file will lead to a remote denial of service attack.

CVE-2017-18005

    Exiv2 has a Null Pointer Dereference in the Exiv2::DataValue::toLong
    function in value.cpp, related to crafted metadata in a TIFF file.

CVE-2018-8976

    jpgimage.cpp allows remote attackers to cause a denial of service
    (image.cpp Exiv2::Internal::stringFormat out-of-bounds read) via a crafted
    file.

CVE-2018-17581

    CiffDirectory::readDirectory() at crwimage_int.cpp has excessive stack
    consumption due to a recursive function, leading to Denial of service.

CVE-2018-19107

    Exiv2::IptcParser::decode in iptc.cpp (called from psdimage.cpp in the PSD
    image reader) may suffer from a denial of service (heap-based buffer
    over-read) caused by an integer overflow via a crafted PSD image file.

CVE-2018-19108

    Exiv2::PsdImage::readMetadata in psdimage.cpp in the PSD image reader may
    suffer from a denial of service (infinite loop) caused by an integer
    overflow via a crafted PSD image file.

CVE-2018-19535

    PngChunk::readRawProfile in pngchunk_int.cpp may cause a denial of service
    (application crash due to a heap-based buffer over-read) via a crafted PNG
    file.

CVE-2018-20097

    There is a SEGV in Exiv2::Internal::TiffParserWorker::findPrimaryGroups of
    tiffimage_int.cpp. A crafted input will lead to a remote denial of service
    attack.

CVE-2019-13110

    A CiffDirectory::readDirectory integer overflow and out-of-bounds read
    allows an attacker to cause a denial of service (SIGSEGV) via a crafted CRW
    image file.

CVE-2019-13112

    A PngChunk::parseChunkContent uncontrolled memory allocation allows an
    attacker to cause a denial of service (crash due to an std::bad_alloc
    exception) via a crafted PNG image file.

CVE-2019-13114

    http.c allows a malicious http server to cause a denial of service (crash
    due to a NULL pointer dereference) by returning a crafted response that
    lacks a space character.

CVE-2019-13504

    There is an out-of-bounds read in Exiv2::MrwImage::readMetadata in
    mrwimage.cpp.

CVE-2019-14369

    Exiv2::PngImage::readMetadata() in pngimage.cpp allows attackers to cause a
    denial of service (heap-based buffer over- read) via a crafted image file.

CVE-2019-14370

    There is an out-of-bounds read in Exiv2::MrwImage::readMetadata() in
    mrwimage.cpp. It could result in denial of service.

CVE-2019-17402

    Exiv2 allows attackers to trigger a crash in Exiv2::getULong in types.cpp
    when called from Exiv2::Internal::CiffDirectory::readDirectory in
    crwimage_int.cpp, because there is no validation of the relationship of the
    total size to the offset and size.

CVE-2020-18771

    Exiv2 has a global buffer over-read in
    Exiv2::Internal::Nikon1MakerNote::print0x0088 in nikonmn_int.cpp which can
    result in an information leak.

CVE-2021-29458

    An out-of-bounds read was found in Exiv2. The out-of- bounds read is
    triggered when Exiv2 is used to write metadata into a crafted image file.
    An attacker could potentially exploit the vulnerability to cause a denial
    of service by crashing Exiv2, if they can trick the victim into running
    Exiv2 on a crafted image file. Note that this bug is only triggered when
    writing the metadata, which is a less frequently used Exiv2 operation than
    reading the metadata. For example, to trigger the bug in the Exiv2
    command-line application, you need to add an extra command-line argument
    such as insert.

CVE-2021-32815

    The assertion
    failure is triggered when Exiv2 is used to modify the metadata of a
    crafted image file. An attacker could potentially exploit the
    vulnerability to cause a denial of service, if they can trick the
    victim into running Exiv2 on a crafted image file. Note that this bug
    is only triggered when modifying the metadata, which is a less
    frequently used Exiv2 operation than reading the metadata. For
    example, to trigger the bug in the Exiv2 command-line application, you
    need to add an extra command-line argument such as `fi`.

CVE-2021-34334

    An infinite loop is triggered when Exiv2 is used to read the metadata of a
    crafted image file. An attacker could potentially exploit the vulnerability
    to cause a denial of service, if they can trick the victim into running
    Exiv2 on a crafted image file.

CVE-2021-37620

    An out-of-bounds read is triggered when Exiv2 is used to read the metadata
    of a crafted image file. An attacker could potentially exploit the
    vulnerability to cause a denial of service, if they can trick the victim
    into running Exiv2 on a crafted image file.

CVE-2021-37621

    An infinite loop is triggered when Exiv2 is used to print the metadata of a
    crafted image file. An attacker could potentially exploit the vulnerability
    to cause a denial of service, if they can trick the victim into running
    Exiv2 on a crafted image file. Note that this bug is only triggered when
    printing the image ICC profile, which is a less frequently used Exiv2
    operation that requires an extra command line option (`-p C`).

CVE-2021-37622

    An infinite loop is triggered when Exiv2 is used to modify the metadata of
    a crafted image file. An attacker could potentially exploit the
    vulnerability to cause a denial of service, if they can trick the victim
    into running Exiv2 on a crafted image file. Note that this bug is only
    triggered when deleting the IPTC data, which is a less frequently used
    Exiv2 operation that requires an extra command line option (`-d I rm`).

For Debian 10 buster, these problems have been fixed in version
0.25-4+deb10u4.

We recommend that you upgrade your exiv2 packages.

For the detailed security status of exiv2 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/exiv2>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpENYHXiOo6W.pgp)**

*Description:* PGP signature

---


