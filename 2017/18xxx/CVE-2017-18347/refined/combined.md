=== Content from community.st.com_0f837aed_20250124_221429.html ===


Browse

[STMicroelectronics Community](/)

[FAQs](/t5/help/faqpage)[Sign In](/plugins/common/feature/samlss/doauth/post?referer=https%3A%2F%2Fcommunity.st.com%2Ft5%2Fstm32-mcus-security%2Freadout-protection-cracked-on-stm32%2Fm-p%2F387997)

* [Product forums](/t5/product-forums/ct-p/product-forums)
  + [STM32 MCUs](/t5/stm32-mcus/ct-p/stm32-mcus)
    - [STM32 MCUs Products](/t5/stm32-mcus-products/bd-p/stm32-mcu-products-forum)
    - [STM32 MCUs Boards and hardware tools](/t5/stm32-mcus-boards-and-hardware/bd-p/mcu-boards-hardware-tools-forum)
    - [STM32 MCUs Software development tools](/t5/stm32-mcus-software-development/ct-p/mcu-software-development-tools)
    - [STM32 MCUs Embedded software](/t5/stm32-mcus-embedded-software/bd-p/mcu-embedded-software-forum)
    - [STM32 MCUs TouchGFX and GUI](/t5/stm32-mcus-touchgfx-and-gui/bd-p/mcu-touch-gfx-gui-forum)
    - [STM32 MCUs Motor control](/t5/stm32-mcus-motor-control/bd-p/mcu-motor-control-forum)
    - [STM32 MCUs Security](/t5/stm32-mcus-security/bd-p/mcu-security-forum)
    - [STM32 MCUs Wireless](/t5/stm32-mcus-wireless/bd-p/mcu-wireless-forum)
  + [STM32 MPUs](/t5/stm32-mpus/ct-p/stm32-mpus)
    - [STM32 MPUs Products](/t5/stm32-mpus-products/bd-p/stm32-mpu-products-forum)
    - [STM32 MPUs Boards and hardware tools](/t5/stm32-mpus-boards-and-hardware/bd-p/mpu-boards-hardware-tools-forum)
    - [STM32 MPUs Embedded software and solutions](/t5/stm32-mpus-embedded-software-and/bd-p/mpu-embedded-software-forum)
    - [STM32 MPUs Software development tools](/t5/stm32-mpus-software-development/bd-p/stm32-mpus-softwares-development-tools)
  + [MEMS and sensors](/t5/mems-and-sensors/ct-p/mems-sensors)
    - [MEMS (sensors)](/t5/mems-sensors/bd-p/mems-sensors-forum)
    - [Imaging (sensors)](/t5/imaging-sensors/bd-p/imaging-sensors-forum)
  + [Automotive and Transportation](/t5/automotive-and-transportation/ct-p/automotive-transportation)
    - [Automotive MCUs](/t5/automotive-mcus/bd-p/automotive-microcontrollers-forum)
    - [AutoDevKit Ecosystem](/t5/autodevkit-ecosystem/bd-p/autdevkit-ecosystem)
    - [GNSS positioning](/t5/gnss-positioning/bd-p/gnss-positioning)
  + [Edge AI](/t5/edge-ai/bd-p/edge-ai)
  + [Interface and connectivity ICs](/t5/interface-and-connectivity-ics/bd-p/interface-connectivity-ics-forum)
  + [Power management](/t5/power-management/bd-p/power-management-forum)
  + [ST25 NFC/RFID tags and readers](/t5/st25-nfc-rfid-tags-and-readers/bd-p/st25-nfc-rfid-tags-readers-forum)
  + [STM8 MCUs](/t5/stm8-mcus/bd-p/stm8-mcus-forum)
  + [Others: hardware and software](/t5/others-hardware-and-software/bd-p/other-hardware-forum)
  + [Analog and audio](/t5/analog-and-audio/bd-p/analog-audio-forum)
* [Knowledge base](/t5/knowledge-base/ct-p/knowledge-base)
  + [STM32 MCUs](/t5/stm32-mcus/tkb-p/stm32-mcus-knowledge-base)
  + [STM32 MPUs](/t5/stm32-mpus/tkb-p/stm32-mpus-knowledge-base)
  + [MEMS and sensors](/t5/mems-and-sensors/tkb-p/mems-sensors-knowledge-base)
  + [Analog and audio](/t5/analog-and-audio/tkb-p/analog-audio-knowledge-base)
  + [EMI filtering and signal conditioning](/t5/emi-filtering-and-signal/tkb-p/emi-filtering-signal-cond-knowledge-base)
  + [Interface and connectivity ICs](/t5/interface-and-connectivity-ics/tkb-p/interface-connectivity-ic-knowledge-base)
  + [Power management](/t5/power-management/tkb-p/power-management-knowledge-base)
  + [Quality & reliability](/t5/quality-reliability/tkb-p/quality-reliability-knowledge-base)
* [Academy](https://academy.st.com/s/learning-catalogs)
* [About](/t5/about/ct-p/about)
  + [Community guidelines](/t5/community-guidelines/tkb-p/community-guidelines)
  + [Feedback forum](/t5/feedback-forum/bd-p/feedback-forum)
  + [Community blog](/t5/community-blog/bg-p/announcements)
* [Developer news](/t5/developer-news/bg-p/developer-news)

All communityThis categoryThis boardKnowledge baseUsersProducts

cancel

[Turn on suggestions](https://community.st.com/t5/forums/v5/forumtopicpage.enableautocomplete%3Aenableautocomplete?t:ac=board-id/mcu-security-forum/message-id/5068/thread-id/5068&t:cp=action/contributions/searchactions)
Auto-suggest helps you quickly narrow down your search results by suggesting possible matches as you type.

Showing results for

Search instead for

Did you mean:

* [STMicroelectronics Community](/)
* [STM32 MCUs](/t5/stm32-mcus/ct-p/stm32-mcus)
* [STM32 MCUs Security](/t5/stm32-mcus-security/bd-p/mcu-security-forum)
* readout protection cracked on STM32

Options

* [Subscribe to RSS Feed](/ysqtg83639/rss/message?board.id=mcu-security-forum&message.id=5068)
* Mark Topic as New
* Mark Topic as Read
* Float this Topic for Current User
* Bookmark
* Subscribe
* Mute
* [Printer Friendly Page](/t5/forums/forumtopicprintpage/board-id/mcu-security-forum/message-id/5068/print-single-message/false/page/1)

# readout protection cracked on STM32

![dieter 123](https://community.st.com/legacyfs/online/avatars/005 "dieter 123")

[dieter 123](https://community.st.com/t5/user/viewprofilepage/user-id/35328)

Associate III

Options

* Mark as New
* Bookmark
* Subscribe
* Mute
* [Subscribe to RSS Feed](https://community.st.com/rss/message?board.id=mcu-security-forum&message.id=5068)
* [Permalink](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/387997/highlight/true#M5068)
* [Print](/t5/forums/forumtopicprintpage/board-id/mcu-security-forum/message-id/5068/print-single-message/true/page/1)
* Email to a Friend
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/387997)

‎2018-01-08
01:21 AM

 **Posted on January 08, 2018 at 10:21**

Am I correct that readout protection has a major issue and is not working at all? Are all STM32s affected? Any comments on this from ST?

See here:

<https://www.aisec.fraunhofer.de/en/FirmwareProtection.html>

#stm32-rdp-read-protection**Note: this post was migrated and contained many threaded conversations, some content may be missing.**

Labels:

* Labels:
* [RDP](/t5/forums/filteredbylabelpage/board-id/mcu-security-forum/label-name/rdp)

0
Kudos

Reply

* [All forum topics](/t5/stm32-mcus-security/bd-p/mcu-security-forum/page/141 "STM32 MCUs Security")
* [Previous Topic](/t5/stm32-mcus-security/crc32-questions/td-p/255511 "CRC32 questions")
* [Next Topic](/t5/stm32-mcus-security/aes-256-gcm-decryption-on-stm32l562/td-p/289979 "AES 256 GCM Decryption on STM32L562")

49 REPLIES 49

![stm322399](https://community.st.com/legacyfs/online/avatars/005 "stm322399")

[stm322399](https://community.st.com/t5/user/viewprofilepage/user-id/5634)

Senior

Options

* Mark as New
* Bookmark
* Subscribe
* Mute
* [Subscribe to RSS Feed](https://community.st.com/rss/message?board.id=mcu-security-forum&message.id=5069)
* [Permalink](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/387998/highlight/true#M5069)
* [Print](/t5/forums/forumtopicprintpage/board-id/mcu-security-forum/message-id/5069/print-single-message/true/page/1)
* Email to a Friend
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/387998)

‎2018-01-08
02:40 AM

 **Posted on January 08, 2018 at 11:40**

'not working at all' is a bit unfair.

1/ imho, cold boot stepping exploits a weakness of the bootloader, of course, any SRAM data is at risk (at RDP level1). Well lets use RDP level2.

2/ security downgrade from level2 uses probing. Are there any generic purpose MCU protected against probing ? Anyway, I agreed that the encoding of RDP is problematic.

3/ debug interface exploit looks really unreliable (how to sort FW from garbage?), even the author only says 'practically feasible'.

Security is often a trade-off between protection and effort (money). Imho RDP is (not perfect, but) good enough for a lot of needs, and probably brings more protection to your product than many software (unchecked user input, fw upgrade etc ...).

0
Kudos

Reply

![dieter 123](https://community.st.com/legacyfs/online/avatars/005 "dieter 123")

[dieter 123](https://community.st.com/t5/user/viewprofilepage/user-id/35328)

Associate III

[In response to stm322399](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/387998/highlight/true#M5069)

Options

* Mark as New
* Bookmark
* Subscribe
* Mute
* [Subscribe to RSS Feed](https://community.st.com/rss/message?board.id=mcu-security-forum&message.id=5070)
* [Permalink](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/387999/highlight/true#M5070)
* [Print](/t5/forums/forumtopicprintpage/board-id/mcu-security-forum/message-id/5070/print-single-message/true/page/1)
* Email to a Friend
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/387999)

‎2018-01-08
05:23 AM

 **Posted on January 08, 2018 at 13:23**

Is there any official statement from ST on this?  Are all STM32 series affected?

Does it also affect RDP level 2?

>> how to sort FW from garbage?

quite simple, no?: flash it on a second stm32 and check functionality

0
Kudos

Reply

![AvaTar](https://community.st.com/legacyfs/online/avatars/005 "AvaTar")

[AvaTar](https://community.st.com/t5/user/viewprofilepage/user-id/4176)

Lead

[In response to dieter 123](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/387999/highlight/true#M5070)

Options

* Mark as New
* Bookmark
* Subscribe
* Mute
* [Subscribe to RSS Feed](https://community.st.com/rss/message?board.id=mcu-security-forum&message.id=5071)
* [Permalink](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/388000/highlight/true#M5071)
* [Print](/t5/forums/forumtopicprintpage/board-id/mcu-security-forum/message-id/5071/print-single-message/true/page/1)
* Email to a Friend
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/388000)

‎2018-01-08
05:55 AM

 **Posted on January 08, 2018 at 13:55**

Is there any official statement from ST on this?

I'd wonder if there is/comes anything substantial.

Usually, a great part of 'security by obscurity' is involved.

Only large customers are informed and receive support.

Ask Microchip ...

As said by gonzales.laurent, this is a cost-benefit consideration. Blocking the casual hacker/copyist, even commercial, is mostly deemed sufficient.

Attacks with >1000k equipment and teams with unlimited pocket depth are not covered.

At least for short-lived consumer electronics.

0
Kudos

Reply

![dieter 123](https://community.st.com/legacyfs/online/avatars/005 "dieter 123")

[dieter 123](https://community.st.com/t5/user/viewprofilepage/user-id/35328)

Associate III

Options

* Mark as New
* Bookmark
* Subscribe
* Mute
* [Subscribe to RSS Feed](https://community.st.com/rss/message?board.id=mcu-security-forum&message.id=5072)
* [Permalink](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/388001/highlight/true#M5072)
* [Print](/t5/forums/forumtopicprintpage/board-id/mcu-security-forum/message-id/5072/print-single-message/true/page/1)
* Email to a Friend
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/388001)

‎2018-01-08
11:35 PM

 **Posted on January 09, 2018 at 08:35**

Hi

st.mcu

would you please comment on this? Is there an official statement from ST about this?

Thx

0
Kudos

Reply

![Amel NASRI](https://community.st.com/legacyfs/online/avatars/7293W000000L2Y3 "Amel NASRI")

[Amel NASRI](https://community.st.com/t5/user/viewprofilepage/user-id/430)

ST Employee

[In response to dieter 123](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/388001/highlight/true#M5072)

Options

* Mark as New
* Bookmark
* Subscribe
* Mute
* [Subscribe to RSS Feed](https://community.st.com/rss/message?board.id=mcu-security-forum&message.id=5073)
* [Permalink](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/388002/highlight/true#M5073)
* [Print](/t5/forums/forumtopicprintpage/board-id/mcu-security-forum/message-id/5073/print-single-message/true/page/1)
* Email to a Friend
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/388002)

‎2018-01-09
02:50 AM

 **Posted on January 09, 2018 at 10:50**

Hi,

We will come back to you with our official statement regarding this issue.

-Amel

To give better visibility on the answered topics, please click on ***Accept as Solution*** on the reply which solved your issue or answered your question.

0
Kudos

Reply

![re.wolff9](https://community.st.com/legacyfs/online/avatars/005 "re.wolff9")

[re.wolff9](https://community.st.com/t5/user/viewprofilepage/user-id/32593)

Senior

[In response to stm322399](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/387998/highlight/true#M5069)

Options

* Mark as New
* Bookmark
* Subscribe
* Mute
* [Subscribe to RSS Feed](https://community.st.com/rss/message?board.id=mcu-security-forum&message.id=5074)
* [Permalink](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/388003/highlight/true#M5074)
* [Print](/t5/forums/forumtopicprintpage/board-id/mcu-security-forum/message-id/5074/print-single-message/true/page/1)
* Email to a Friend
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/388003)

‎2018-01-11
06:07 AM

 **Posted on January 11, 2018 at 14:07**

gonzalez.laurent wrote:

2/ security downgrade from level2 uses probing. Are there any generic purpose MCU protected against probing ? Anyway, I agreed that the encoding of RDP is problematic.

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* -end-of-quote \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

Yes, the simple 'Any other combination is RDP2' would have made 'amateur' breaking of the protection close to impossible. Decapping a chip is easy enough, exposing to UV too.

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* -restart-of-quote \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

3/ debug interface exploit looks really unreliable (how to sort FW from garbage?), even the author only says 'practically feasible'.

The debug interface reports ERROR (permission denied, try again) or OK (you got your data, store it, and go to the next location). So this is completely easy.

The fact that the debug interface exploit works, together with openocd only supporting lock level 1, probably means that lots of people are not protected, when they thought they were.....

These guys are just some students that have tried a bunch of tricks to break this and report on the three tricks that worked. They probably aslo tried a few things that didn't work. But with such sloppy design (the encoding of lock-level-2 is wrong, everybody can see that!) it is likely that someone else may find another bug.

For example, it is clear that these guys are not good at controlling the power to their target. They claim 45 bytes per minute. So that means 11 succesful 32-bit attempts per minute, or about 22 raw tries. That translates to about 3 seconds per attempt. With a mosfet I can apply power to a CPU in less than a microsecond. Hold the reset line for a microsecond, and then release. Now start doing the SWD stuff, and a few microseconds later you have your results. Several hundred or thousand attempts per second should be possible. But if they use a mechanical relay to power up the device, then have to wait for big capacitors to drain then that can lead to a cycle time of several seconds.

But indeed. The result is that you can read a lockec STM32F0 at AT LEAST 45 bytes per second. But unless you're starting a business doing this and have tens of clients a day, that is not worth the further engineering effort.

0
Kudos

Reply

![Code Wrangler](https://community.st.com/legacyfs/online/avatars/005 "Code Wrangler")

[Code Wrangler](https://community.st.com/t5/user/viewprofilepage/user-id/24741)

Associate III

[In response to AvaTar](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/388000/highlight/true#M5071)

Options

* Mark as New
* Bookmark
* Subscribe
* Mute
* [Subscribe to RSS Feed](https://community.st.com/rss/message?board.id=mcu-security-forum&message.id=5075)
* [Permalink](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/388004/highlight/true#M5075)
* [Print](/t5/forums/forumtopicprintpage/board-id/mcu-security-forum/message-id/5075/print-single-message/true/page/1)
* Email to a Friend
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/388004)

‎2018-01-11
10:46 AM

 **Posted on January 11, 2018 at 18:46**

AvaTar wrote:

Attacks with >1000k equipment and teams with unlimited pocket depth are not covered.

It is not just companies with >1000k equipment. There are companies on a certain popular Chinese website that will crack any ST chip for $750 - $6000 USD (depending on part number). They also crack every other companies' microprocessors as well. (I don't want to post links to encourage anyone)

Bunnie (Andrew Huang) wrote a tutorial on cracking PIC chips for $50.

Anyone who counts on hardware locks for code protection is a fool.

0
Kudos

Reply

![Steve H](https://community.st.com/legacyfs/online/avatars/7290X000000srjo "Steve H")

[Steve H](https://community.st.com/t5/user/viewprofilepage/user-id/6028)

Associate III

[In response to Amel NASRI](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/388002/highlight/true#M5073)

Options

* Mark as New
* Bookmark
* Subscribe
* Mute
* [Subscribe to RSS Feed](https://community.st.com/rss/message?board.id=mcu-security-forum&message.id=5076)
* [Permalink](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/388005/highlight/true#M5076)
* [Print](/t5/forums/forumtopicprintpage/board-id/mcu-security-forum/message-id/5076/print-single-message/true/page/1)
* Email to a Friend
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/388005)

‎2018-01-12
09:00 AM

 **Posted on January 12, 2018 at 17:00**

I am **very** interested in that response, especially as regards the STM32F2 series MCUs, since we use them in our products. It would be a shame to have to migrate to another vendor because your security model was irretrievably broken.

0
Kudos

Reply

![Philipp Krause](https://community.st.com/legacyfs/online/avatars/005 "Philipp Krause")

[Philipp Krause](https://community.st.com/t5/user/viewprofilepage/user-id/4788)

Senior II

[In response to Steve H](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/388005/highlight/true#M5076)

Options

* Mark as New
* Bookmark
* Subscribe
* Mute
* [Subscribe to RSS Feed](https://community.st.com/rss/message?board.id=mcu-security-forum&message.id=5077)
* [Permalink](/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/m-p/388006/highlight/true#M5077)
* [Print](/t5/forums/forumtopicprintpage/board-id/mcu-security-forum/message-id/5077/print-single-message/true/page/1)
* Email to a Friend
* [Report Inappropriate Content](/t5/notifications/notifymoderatorpage/message-uid/388006)

‎2018-01-12
10:53 AM

 **Posted on January 12, 2018 at 18:53**

I'd recommend not to rely too much on readout protection. While it is nice to have attacks on the STM32F0 well-documented (I assume the other STM32 variants will follow soon - seems like good projects to hand out to interested students), that doesn't mean that other controllers are that much safer. Readout protection is just a small obstacle to increase readout time and effort a bit.

Look at the vendor list at the bottom of

<https://www.cl.cam.ac.uk/~sps32/mcu_lock.html>

. Practically every microcontroller vendor known is listed there as having their readout protection broken some way (by the author of that page - no doubt others have broken plenty of readout protections, too). And then there probably are people who directly make money from their findings instead of publishing them.

There are companies providing the service of reading data from protected microcontrollers. They typically operate in jurisdictions where it is legal for the owner of a device to read the data (i.e. those places have no law equivalent to the US DMCA). Examples:

<https://russiansemiresearch.com/>

,

<http://www.ic-cracker.com/>

. From their public price lists and what I've read on

<https://www.mikrocontroller.net/>

, they charge less than 2000â‚¬ for reading the flash from a controller.

Philipp

P.S.: There are, however some security-oriented microcontrollers in the market that are harder, but still not impossible to read out (or at least have part of their memory hardened against attacks). But you'll have to pay the price (both monetary by getting a worse performance/proce trade-off than for controllers with less protection, and often also in reliability as their self-destruct functionality might trigger on a false positive).

P.P.S.: Edited to fix a typo.

0
Kudos

Reply

![](/skins/images/FA997A776F5CC8FC5870841535F28949/responsive_peak/images/icon_anonymous_message.png)

Reply

* «
  Previous
* + 1
  + [2](https://community.st.com/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/td-p/387997/page/2)
  + [3](https://community.st.com/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/td-p/387997/page/3)
  + [4](https://community.st.com/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/td-p/387997/page/4)
  + [5](https://community.st.com/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/td-p/387997/page/5)
* [Next
  »](https://community.st.com/t5/stm32-mcus-security/readout-protection-cracked-on-stm32/td-p/387997/page/2)

Related Content

* [I can't burn my STM32F103 CPU](/t5/stm32-mcus-products/i-can-t-burn-my-stm32f103-cpu/td-p/754487)
  in [STM32 MCUs Products](/t5/stm32-mcus-products/bd-p/stm32-mcu-products-forum)  2024-12-17
* [Readout protection errorr](/t5/stm32-mcus-products/readout-protection-errorr/td-p/753408)
  in [STM32 MCUs Products](/t5/stm32-mcus-products/bd-p/stm32-mcu-products-forum)  2024-12-12
* [USART Bootloader get checksum command doesn't work](/t5/stm32cubeide-mcus/usart-bootloader-get-checksum-command-doesn-t-work/td-p/753221)
  in [STM32CubeIDE (MCUs)](/t5/stm32cubeide-mcus/bd-p/stm32-mcu-cubeide-forum)  2024-12-12
* [STLINK JTAG Vulnerability when RDP2](/t5/stm32-mcus-security/stlink-jtag-vulnerability-when-rdp2/td-p/729874)
  in [STM32 MCUs Security](/t5/stm32-mcus-security/bd-p/mcu-security-forum)  2024-10-10
* [STM32H503 cannot perform regression](/t5/stm32-mcus-security/stm32h503-cannot-perform-regression/td-p/727229)
  in [STM32 MCUs Security](/t5/stm32-mcus-security/bd-p/mcu-security-forum)  2024-10-02

Top

[![STMicro-logo](https://community.st.com/html/@2DF13DC2C9EBE01E42B1460D52914738/assets/st-logo-blue.svg)](https://www.st.com/content/st_com/en.html)

## About STMicroelectronics

* [Who we are](https://www.st.com/content/st_com/en/about/st_company_information/who-we-are.html)
* [Investor relations](https://investors.st.com/)
* [Sustainability](https://www.st.com/content/st_com/en/about/st_approach_to_sustainability/st_approach_to_sustainability.html)
* [Innovation & technology](https://www.st.com/content/st_com/en/about/innovation---technology/innovation---technology.html)
* [Careers](https://www.st.com/content/st_com/en/about/careers.html)
* [Blog](https://blog.st.com/)
* [General terms and conditions](https://www.st.com/content/st_com/en/about/procurement/general-terms-and-conditions.html)

## Connect with us

* [Contact ST offices](https://www.st.com/content/st_com/en/contact-us.html)
* [Find sales offices & distributors](https://www.st.com/content/st_com/en/contact-us.html)
* [Community](https://community.st.com/)
* [Newsroom](https://newsroom.st.com/)
* [Events & trainings](https://www.st.com/content/st_com/en/about/events/upcoming-events-and-technical-seminars.html)

## Browse

* [Shortcuts](https://www.st.com/content/st_com/en/shortcuts.html)
* [Sitemap](https://www.st.com/content/st_com/en/sitemap.html)

## Compliance, ethics & privacy

* [Ethics and compliance](https://www.st.com/content/st_com/en/about/st_company_information/ethics-and-compliance.html)
* [ST ethics hotline](https://www.speakupfeedback.eu/web/stmicroelectronics/)
* [Privacy portal](https://www.st.com/content/st_com/en/common/privacy-portal.html)

## Follow us

* [Twitter](https://twitter.com/st_world)
* [Linkedin](https://www.linkedin.com/company/stmicroelectronics)
* [Instagram](https://www.instagram.com/stmicroelectronics.nv/)
* [Facebook](https://www.facebook.com/STMicroelectronics.NV)
* [Youtube](https://www.youtube.com/user/STonlineMedia)

## Legal

* All rights reserved © 2025 STMicroelectronics
* [Terms of use](https://www.st.com/content/st_com/en/common/terms-of-use.html)
* [Sales terms & conditions](https://www.st.com/content/ccc/resource/legal/legal_agreement/sales_agreement/49/05/8c/68/a0/35/4a/6e/ST%20Terms%20and%20Conditions%20of%20Sales.pdf/files/ST%20Terms%20and%20Conditions%20of%20Sales.pdf/jcr%3Acontent/translations/en.ST%20Terms%20and%20Conditions%20of%20Sales.pdf)
* [Trademarks](https://www.st.com/content/st_com/en/about/st_company_information/stmicroelectronics-trademark-list.html)
* [Privacy portal](https://www.st.com/content/st_com/en/common/privacy-portal.html)
* Manage cookies



=== Content from www.usenix.org_5ae10b6b_20250124_221432.html ===


 [usenix\_logo\_notag\_white](/)

* [Sign In](/user?destination=conference/woot17/workshop-program/presentation/obermaier)
* [Conferences](/conferences)

 [![](https://www.usenix.org/sites/default/files/styles/neat_conference_menu_logo/public/woot17_logo_wordmark.png?itok=VV0Tlv9O)](/conference/woot17)

* [Attend](/conference/usenixsecurity17/registration-information)
  + [Registration Information](/conference/usenixsecurity17/registration-information)
  + [Registration Discounts](/conference/usenixsecurity17/registration-discounts)

  + [Venue, Hotel, and Travel](/conference/usenixsecurity17/venue-hotel-travel)
* [Program](/conference/woot17/workshop-program)
  + [Workshop Program](/conference/woot17/workshop-program)
* [Participate](/conference/woot17/call-for-papers)
  + [Call for Papers](/conference/woot17/call-for-papers)

  + [Instructions for Participants](/conference/woot17/instructions-participants)
* [Sponsorship](/conference/woot17#sponsorship)
* [About](/conference/woot17#about)
  + [Workshop Organizers](/conference/woot17#organizers)
  + [Questions](/conference/woot17#about)
  + [Past Workshops](https://www.usenix.org/conferences/byname/202)

# Shedding too much Light on a Microcontroller's Firmware Protection

Authors:

Johannes Obermaier and Stefan Tatschner, *Fraunhofer Institute AISEC*

Abstract:

Almost every microcontroller with integrated flash features firmware readout protection. This is a form of content protection which aims at securing intellectual property (IP) as well as cryptographic keys and algorithms from an adversary. One series of microcontrollers are the STM32 which have recently gained popularity and thus are increasingly under attack. However, no practical experience and information on the resilience of STM32 microcontrollers is publicly available. The paper presents the first investigation of the STM32 security concept, especially targeting the STM32F0 sub-series. Starting with a conceptual analysis, we discover three weaknesses and develop them to vulnerabilities by demonstrating corresponding Proofs-of-Concept. At first, we discover that a common security configuration provides low protection which can be exploited using our Cold-boot Stepping approach to extract critical data or even readout-protected firmware. Secondly, we reveal a design weakness in the security configuration storage which allows an attacker to downgrade the level of firmware protection, thereby enabling additional attacks. Thirdly, we discover and analyze a hardware flaw in the debug interface, attributed to a race condition, that allows us to directly extract read-protected firmware using an iterative approach. Each attack requires only low-priced equipment, thereby increasing the impact of each weakness and resulting in a severe threat altogether.

## [Johannes Obermaier, Fraunhofer Institute AISEC](/conference/woot17/speaker-or-organizer/johannes-obermaier-fraunhofer-institute-aisec)

## [Stefan Tatschner, Fraunhofer Institute AISEC](/conference/woot17/speaker-or-organizer/stefan-tatschner-fraunhofer-institute-aisec)

## Open Access Media

USENIX is committed to Open Access to the research presented at our events. Papers and proceedings are freely available to everyone once the event begins. Any video, audio, and/or slides that are posted after the event are also free and open to everyone. [Support USENIX](/annual-fund) and our commitment to Open Access.

BibTeX@inproceedings {206148,

author = {Johannes Obermaier and Stefan Tatschner},

title = {Shedding too much Light on a Microcontroller{\textquoteright}s Firmware Protection},

booktitle = {11th USENIX Workshop on Offensive Technologies (WOOT 17)},

year = {2017},

address = {Vancouver, BC},

url = {https://www.usenix.org/conference/woot17/workshop-program/presentation/obermaier},

publisher = {USENIX Association},

month = aug

}

[Download](/biblio/export/bibtex/206148)![PDF icon](/modules/file/icons/application-pdf.png "application/pdf") [Obermaier PDF](https://www.usenix.org/system/files/conference/woot17/woot17-paper-obermaier.pdf "woot17-paper-obermaier.pdf")[View the Slides](https://www.usenix.org/sites/default/files/conference/protected-files/woot17_slides_tatschner.pdf)

* [Log in](/user/login?destination=comment/reply/206149%23comment-form) or    [Register](/user/register?destination=comment/reply/206149%23comment-form) to post comments

* [Home](/conference/woot17)
* [Attend](/conference/usenixsecurity17/registration-information)
  + [Registration Information](/conference/usenixsecurity17/registration-information)
  + [Registration Discounts](/conference/usenixsecurity17/registration-discounts)
  + [Venue, Hotel, and Travel](/conference/usenixsecurity17/venue-hotel-travel)
* [Program](/conference/woot17/workshop-program)
  + [Workshop Program](/conference/woot17/workshop-program)
* [Participate](/conference/woot17/call-for-papers)
  + [Call for Papers](/conference/woot17/call-for-papers)
  + [Instructions for Participants](/conference/woot17/instructions-participants)
* [Sponsorship](/conference/woot17#sponsorship)
* [About](/conference/woot17#about)
  + [Workshop Organizers](/conference/woot17#organizers)
  + [Questions](/conference/woot17#about)
  + [Past Workshops](https://www.usenix.org/conferences/byname/202)

[Twitter](https://twitter.com/USENIXSecurity)[Facebook](https://www.facebook.com/USENIX-Security-Symposium-13544602263)[Google](https://plus.google.com/%2BUsenixOrg)

* [Privacy Policy](/privacy-policy)
* [Contact Us](/contact)

© USENIX



=== Content from www.aisec.fraunhofer.de_83b45f81_20250124_221430.html ===


Search

[![](/content/dam/aisec/aisec_190x52.gif)
Fraunhofer Institute for Applied and Integrated Security](/en.html)

[Fraunhofer Institute for Applied and Integrated Security](/en.html)

* [Jobs / Career](/en/jobs-career.html)
* [Blog](/en/Blog.html)
* [Contact](/en/about-us/contact.html)
* [Deutsch](/)

* [Jobs / Career](/en/jobs-career.html)
* [About Fraunhofer AISEC](/en/about-us.html)
  [X]
  [About Fraunhofer AISEC](/en/about-us.html)
  + [In Profile](/en/about-us/in-profile.html)
  + [Opportunities for collaboration](/en/about-us/Collaboration.html)
  + [How to find us](/en/about-us/how-to-find-us.html)
  + [Contact](/en/about-us/contact.html)
  + [Laboratories](/en/about-us/Laboratories.html)
  + [Scientific Excellence](/en/about-us/scientific_excellence.html)
  + [Quality Management](/en/about-us/quality_management.html)
  + [Competence Center for Post-Quantum Cryptography](/en/about-us/Competence-Center-PQC.html)
  + [Advisory Board](/en/about-us/advisory-board.html)
  + [Statement for Democracy](/en/about-us/statement-for-democracy.html)
* [Fields of Expertise](/en/fields-of-expertise.html)
  [X]
  [Fields of Expertise](/en/fields-of-expertise.html)
  + [Cognitive Security Technologies](/en/fields-of-expertise/CST.html)
    - [BayQS](/en/fields-of-expertise/CST/bayqs.html)
  + [Hardware Security](/en/fields-of-expertise/HWS.html)
  + [Secure Infrastructure](/en/fields-of-expertise/SIS.html)
  + [Secure Systems Engineering](/en/fields-of-expertise/SSE.html)
  + [Secure Operating Systems](/en/fields-of-expertise/SOS.html)
  + [Product Protection and Industrial Security](/en/fields-of-expertise/PIN.html)
  + [Service and Application Security](/en/fields-of-expertise/SAS.html)
* [Spotlights](/en/spotlights.html)
  [X]
  [Spotlights](/en/spotlights.html)
  + [Trusted Electronics](/en/spotlights/trusted-electronics.html)
  + [Post-Quantum Cryptography](/en/spotlights/Competence-Center-PQC.html)
  + [Deepfakes](/en/spotlights/Deepfakes.html)
  + [Cyber Resilience Act](/en/spotlights/the-cyber-resilience-act---security-requirements-for-products-wi.html)
* [Media](/en/media.html)
  [X]
  [Media](/en/media.html)
  + [Publications](/en/media/publications.html)
    - [Annual report 2022](/en/media/publications/Annual-report-2022.html)
    - [Annual Report 2023](/en/media/publications/annual-report-2023.html)
  + [Press Releases](/en/media/press-releases.html)
  + [Newsletter](/en/media/Newsletter.html)
  + [Events](/en/media/events.html)
    - [Workshop Secure & Trustworthy Hardware](/en/media/events/workshop--secure-and-trustworthy-hardware-.html)
  + [More media](/en/media/moremedia.html)
    - [Serious Game](/en/media/moremedia/CharlieQC.html)
* [Blog](/en/Blog.html)
* More

To view this video please enable JavaScript, and consider upgrading to a web browser that supports HTML5 video

Where am I?

* [English](/en.html)
* Shedding too much Light on a Microcontroller’s Firmware Protection

# Shedding too much Light on a Microcontroller's Firmware Protection

Proceedings of the 11th USENIX Workshop on Offensive Technologies (WOOT '17) - Vancouver, BC, Canada            [CVE number 2017-18347](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-18347)

Almost every microcontroller with integrated flash features firmware readout protection. This is a form of content protection which aims at securing intellectual property (IP) as well as cryptographic keys and algorithms from an adversary. One series of microcontrollers are the STM32 which have recently gained popularity and thus are increasingly under attack. However, no practical experience and information on the resilience of STM32 microcontrollers is publicly available. The paper presents the first investigation of the STM32 security concept, especially targeting the STM32F0 sub-series. Starting with a conceptual analysis, we discover three weaknesses and develop them to vulnerabilities by demonstrating corresponding Proofs-of-Concept. At first, we discover that a common security configuration provides low protection which can be exploited using our Cold-boot Stepping approach to extract critical data or even readout-protected firmware. Secondly, we reveal a design weakness in the security configuration storage which allows an attacker to downgrade the level of firmware protection, thereby enabling additional attacks. Thirdly, we discover and analyze a hardware flaw in the debug interface, attributed to a race condition, that allows us to directly extract readprotected firmware using an iterative approach. Each attack requires only low-priced equipment, thereby increasing the impact of each weakness and resulting in a severe threat altogether.

##

### Paper Download

[Download](/content/dam/aisec/ResearchExcellence/woot17-paper-obermaier.pdf "Download")

### Presentation

[Download](/content/dam/aisec/ResearchExcellence/firmwareprotection-pres-woot17.pdf "Download")

### Bibtex

[Download](/content/dam/aisec/Dokumente/Publikationen/Studien_TechReports/englisch/Biblio-Bibtex.bib "Download")

### Download

### Firmware under attack

[Download](/content/dam/aisec/ResearchExcellence/microbootCrc.zip "Download")

### Download

### Coldboot Stepping PoC

[Download](/content/dam/aisec/ResearchExcellence/coldbootStepping.zip "Download")

### Download

### Firmware Extraction PoC

[Download](/content/dam/aisec/ResearchExcellence/swdFirmwareExtractor.zip "Download")

## Laboratory setup for Cold Boot Stepping

[![](/en/FirmwareProtection/jcr:content/contentPar/sectioncomponent_0/sectionParsys/textwithasset/imageComponent/image.img.jpg/1501770805414/1-coldbootStepping-setup1.jpg)](/en/FirmwareProtection/jcr%3Acontent/contentPar/sectioncomponent_0/sectionParsys/textwithasset/imageComponent/image.img.4col.large.jpg/1501770805414/1-coldbootStepping-setup1.jpg)

By observing changes in SRAM, one can reverse-engineer the basic control flow, find out the usage of specific addresses and may also discover briefly visible secret data. The system is only allowed to run for a precisely controlled duration and is then stopped. The contents of the SRAM is read out and a snapshot is created. With well chosen and increasing runtime duration this is similar to stepping through the firmware, since only a few instructions are executed between each SRAM snapshot.

## UV-C irradiation setup for Security Downgrade

[![](/en/FirmwareProtection/jcr:content/contentPar/sectioncomponent_0/sectionParsys/textwithasset_0/imageComponent/image.img.jpg/1501770832653/2-uv1.jpg)](/en/FirmwareProtection/jcr%3Acontent/contentPar/sectioncomponent_0/sectionParsys/textwithasset_0/imageComponent/image.img.4col.large.jpg/1501770832653/2-uv1.jpg)

The STM32 Readout Protection Level protection mechanism is based on the RDP and nRDP bytes in the option byte memory region. At the power-on event, the option bytes are loaded from flash memory and the corresponding RDP Level is set. We show by experiment, that a flaw in the implementation evolves to a practical threat. The option byte memory region can be modified specifically by UV-C light performing optical fault injection.

## Setup for firmware extraction out of a device using RDP Level 1

[![](/en/FirmwareProtection/jcr:content/contentPar/sectioncomponent_0/sectionParsys/textwithasset_1/imageComponent/image.img.jpg/1501770858638/3-lvl1Extract.jpg)](/en/FirmwareProtection/jcr%3Acontent/contentPar/sectioncomponent_0/sectionParsys/textwithasset_1/imageComponent/image.img.4col.large.jpg/1501770858638/3-lvl1Extract.jpg)

The STM32F0 series microcontrollers use the Serial Wire Debug interface for debugging and flash programming. When a debugger becomes attached to this interface in Readout Protection Level 1, the flash protection logic cuts access to flash memory. Due to a race condition in the implementation not only a single access can be performed, but the whole firmware can be extracted from a microcontroller.

### Contact

### Contact Press / Media

#### Stefan Tatschner

Security Researcher

Fraunhofer AISEC
Lichtenbergstraße 11
85748 Garching b. München

* Send email
* stefan.tatschner@aisec.fraunhofer.de

## Navigation and Social Media

### Share

Print

* [Visitor regulations](/en/Visitorregulations.html)
* [Tenders](/en/Tenders.html)
* [Imprint](/en/imprint.html)
* [Data Protection](/en/data_protection.html)

© 2025

**Source: Fraunhofer-Gesellschaft
Fraunhofer Institute for Applied and Integrated Security - Shedding too much Light on a Microcontroller’s Firmware Protection**

Online in Internet; URL: https://www.aisec.fraunhofer.de/en/FirmwareProtection.html

Date: 24.1.2025 22:39


