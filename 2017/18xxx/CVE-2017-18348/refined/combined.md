=== Content from korelogic.com_40c9224e_20250124_115347.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
KL-001-2017-022 : Splunk Local Privilege Escalation
Title: Splunk Local Privilege Escalation
Advisory ID: KL-001-2017-022
Publication Date: 2017.11.03
Publication URL: https://www.korelogic.com/Resources/Advisories/KL-001-2017-022.txt
1. Vulnerability Details
Affected Vendor: Splunk
Affected Product: Splunk Enterprise
Affected Version: 6.6.x
Platform: Embedded Linux
CWE Classification: CWE-280: Improper Handling of Insufficient
Permissions or Privileges
Impact: Privilege Escalation
Attack vector: Local
2. Vulnerability Description
Splunk can be configured to run as a non-root user. However,
that user owns the configuration file that specifies the user
to run as, so it can trivially gain root privileges.
3. Technical Description
Splunk runs multiple daemons and network listeners as root
by default. It can be configured to drop privileges to a
specified non-root user at startup such as user splunk, via
the SPLUNK\_OS\_USER variable in the splunk-launch.conf file in
$SPLUNK\_HOME/etc/ (such as /opt/splunk/etc/splunk-launch.conf).
However, the instructions for enabling such a setup call
for chown'ing the entire $SPLUNK\_HOME directory to that same
non-root user. For instance:
http://docs.splunk.com/Documentation/Splunk/6.6.2/Installation/RunSplunkasadifferentornon-rootuser
"4. Run the chown command to change the ownership of the splunk
directory and everything under it to the user that you want
to run the software.
chown -R splunk:splunk $SPLUNK\_HOME"
Therefore, if an attacker gains control of the splunk account,
they can modify $SPLUNK\_HOME/etc/splunk-launch.conf to
remove/unset SPLUNK\_OS\_USER so that the software will retain
root privileges, and place backdoors under $SPLUNK\_HOME/bin/,
etc. that will take malicious actions as user root the next
time Splunk is restarted.
4. Mitigation and Remediation Recommendation
The vendor has published a mitigation for this vulnerability
at: https://www.splunk.com/view/SP-CAAAP3M
5. Credit
This vulnerability was discovered by Hank Leininger of
KoreLogic, Inc.
6. Disclosure Timeline
2017.08.17 - KoreLogic submits vulnerability details to Splunk.
2017.08.17 - Splunk confirms receipt.
2017.08.22 - Splunk notifies KoreLogic that the issue has been
assigned an internal ticket and will be addressed.
2017.09.29 - 30 business days have elapsed since the vulnerability
was reported to Splunk.
2017.10.17 - KoreLogic requests an update from Splunk.
2017.10.18 - Splunk informs KoreLogic that they will issue an advisory
on October 28th.
2017.10.23 - 45 business days have elapsed since the vulnerability
was reported to Splunk.
2017.10.30 - Splunk notifies KoreLogic that the advisory is published.
2017.11.03 - KoreLogic public disclosure.
7. Proof of Concept
See 3. Technical Description.
The contents of this advisory are copyright(c) 2017
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
http://creativecommons.org/licenses/by-sa/4.0/
KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
https://www.korelogic.com/about-korelogic.html
Our public vulnerability disclosure policy is available at:
https://www.korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.2.txt
-----BEGIN PGP SIGNATURE-----
iQFOBAEBCAA4FiEE+cSrtp5jQJEtra70TWWaLA4ZiQwFAln8krcaHGRpc2Nsb3N1
cmVzQGtvcmVsb2dpYy5jb20ACgkQTWWaLA4ZiQxrFgf/eOTnmXYD7kKwjfUP8+M/
S7NHUfErGAZfsVXnh6IrG6tdMQ/Qd/MflfMcl/gE4TioJGZQ63Us9mNPgdvuMKOA
+bTvlnZVK9ixVmj/SnMWIOMGs6clVHAD1qe6H/eA5GRxur2QuIDqpSh6mGENpkow
AJVPT+gVg+gRPPO6u2JfB822Qtsg6sWLA0Cs0cyhmzaL9Jyk5b0QwlEyKsd55/Om
TNly7BrH1OUFzajeJJGElMpB9j/71Q9IINE8k8poNsULO5xLzkgWLa0rUzRJA7m4
uKLpa4U6UXa2mf9z8rrHdInIwnV+iFL/E4ge/nKQNMzMqgELZi2rgO7E99aOySlL
5A==
=5NHS
-----END PGP SIGNATURE-----


=== Content from www.splunk.com_71398b1c_20250124_115348.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Splunk response to Potential Local Privilege Escalation through instructions to run Splunk as non-root user

**Advisory ID:** SP-CAAAP3M

**CVE ID:** [-](https://www.cve.org/CVERecord?id=-)

**Published:** 2017-11-27

**Last Update:** 2017-11-27

**CVSSv3.1 Score:** -, High

**CVSSv3.1 Vector:** [-](https://www.first.org/cvss/calculator/3.1#-)

**CWE:** [-](https://cwe.mitre.org/data/definitions/.html)

**Bug ID:** -

## Description

Splunk response to Potential Local Privilege Escalation through instructions to run Splunk as non-root user

* Potential Local Privilege Escalation through instructions to run Splunk as non-root user (SPL-144192)

At the time of this announcement, Splunk is not aware of any cases where these vulnerabilities have been actively exploited. Previous Product Security Announcements can be found on our Splunk Product Security Portal. Use SPL numbers when referencing issues in communication with Splunk. If there is no Common Vulnerabilities and Exposures (CVE) identifier listed with a vulnerability, it will be added once it is assigned by a CVE Numbering Authority. To standardize the calculation of severity scores for each vulnerability, when appropriate, Splunk uses Common Vulnerability Scoring System version 2 (CVSS v2).

## Affected Products and Components

### Potential Local Privilege Escalation through instructions to run Splunk as non-root user (SPL-144192)

#### Affected Components

Splunk Enterprise, Splunk Light, Splunk Universal Forwarder.

## Mitigation and Upgrades

In order to prevent escalation, Splunk recommends not to execute Splunk startup / run control scripts as the root user, where able.

For further details, please follow the updated “Enable boot-start as a non-root user” documentation in the Splunk Admin Manual as are relevant to your environment.

Locations of Affected Files

* Redhat Linux - /etc/rc.d/init.d/splunk
* HPUX - /etc/rc.config.d/splunk
* AIX - Not impacted as boot-start passes user path to mksys command
* Solaris /etc/init.d/splunk

## Vulnerability Descriptions and Ratings

### Potential Local Privilege Escalation through instructions to run Splunk as non-root user (SPL-144192)

#### Description

Specific configurations that have Splunk Enterprise, Splunk Light, or a Splunk Universal Forwarder running as non-root that match all the following characteristics

1. Splunk Enterprise, Splunk Light, or the Universal Forwarder are running as non-root user.
2. $SPLUNK\_HOME and $SPLUNK\_HOME/etc both are owned by the running splunk user.
3. Satisfied one of the following conditions
    a. A Splunk init script created via $SPLUNK\_HOME/bin/splunk enable boot-start –user  on Splunk 6.1.x or later. b. A line with SPLUNK\_OS\_USER= exists in $SPLUNK\_HOME/etc/splunk-launch.conf

The above specific configurations of Splunk Enterprise, Splunk Light and Universal Forwarders, are vulnerable to the Splunk Administrator being able to induce code execution as root.

#### Credits

Splunk would like to thank Hank Leininger (KoreLogic) for reporting this issue.

#### CVSS Severity (version 2.0)

CVSS Base Score 8.5
 CVSS Impact Subscore 10.0
 CVSS Exploitability Subscore 6.8
 Overall CVSS Score 8.5

## Document History

* 2017-Oct-27: Rev 1. Initial Release

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
