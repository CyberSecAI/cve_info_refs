=== Content from www.pentestpartners.com_f26c69e9_20250125_220350.html ===


[![Pen Test Partners Logo](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-ptp.png)

Security consulting and testing services](https://www.pentestpartners.com)

+44 20 3095 0500

+1 646 693 2501

* [About](https://www.pentestpartners.com/about-us/)
  + [PTP in the USA](https://www.pentestpartners.com/about-us/ptp-in-the-usa/)
  + [Careers](https://www.pentestpartners.com/about-us/careers/)
  + [Our Vision and Values](https://www.pentestpartners.com/our-vision-and-values/)
  + [In the news](https://www.pentestpartners.com/about-us/in-the-news/)
  + [Environmental Statement](https://www.pentestpartners.com/about-us/environmental-statement/)
  + [Vulnerability Disclosure Policy](https://www.pentestpartners.com/about-us/vulnerability-disclosure-policy/)
* [Services](https://www.pentestpartners.com/penetration-testing-services/)
  + [Red Teaming](https://www.pentestpartners.com/penetration-testing-services/red-teaming/)
  + [Purple Teaming](https://www.pentestpartners.com/penetration-testing-services/purple-teaming/)
  + [Penetration Testing](https://www.pentestpartners.com/penetration-testing-services/penetration-testing/)
  + [Agile Environment Testing](https://www.pentestpartners.com/penetration-testing-services/agile-environment-testing/)
  + [Aviation Cyber Security Testing](https://www.pentestpartners.com/penetration-testing-services/aviation-cyber-security-testing/)
  + [Automotive & IoT Testing](https://www.pentestpartners.com/penetration-testing-services/automotive-and-iot-testing/)
  + [Maritime Cyber Security Testing](https://www.pentestpartners.com/penetration-testing-services/maritime-cyber-security-testing/)
  + [Cloud Services Security](https://www.pentestpartners.com/penetration-testing-services/cloud-services-security/)
  + [DevOps Lifecycle Assurance](https://www.pentestpartners.com/devops-lifecycle-assurance/)
  + [Social Engineering](https://www.pentestpartners.com/penetration-testing-services/social-engineering/)
  + [Physical Security](https://www.pentestpartners.com/penetration-testing-services/physical-security/)
  + [Security Training](https://www.pentestpartners.com/penetration-testing-services/security-training/)
  + [Papa – Proactive Advanced Password Auditor](https://www.pentestpartners.com/penetration-testing-services/papa/)
  + [ICS, IIoT, SCADA Security Testing](https://www.pentestpartners.com/penetration-testing-services/ics-iiot-scada-security-testing/)
  + [CBEST Red Teaming](https://www.pentestpartners.com/penetration-testing-services/cbest-threat-intelligence-led-red-teaming/)
  + [CREST OVS Mobile & Apps](https://www.pentestpartners.com/crest-owasp-verification-standard-ovs-program/)
  + [TIBER-EU Assessments](https://www.pentestpartners.com/penetration-testing-services/tiber-eu-assessments/)
  + [CREST STAR-FS](https://www.pentestpartners.com/penetration-testing-services/crest-star-fs-assessments/)
  + [Cyber Essentials Testing](https://www.pentestpartners.com/penetration-testing-services/cyber-essentials-testing/)
  + [Cyber Security Consulting](https://www.pentestpartners.com/penetration-testing-services/cyber-security-consulting/)
  + [Compromise Assessment](https://www.pentestpartners.com/compromise-assessment/)
  + [Digital Forensics Services](https://www.pentestpartners.com/digital-forensics-services/)
  + [Incident Response Services](https://www.pentestpartners.com/incident-response-services/)
  + [Incident Response Retained Service](https://www.pentestpartners.com/incident-response-retained-service/)
  + [Incident Response Policy Assessment & Development](https://www.pentestpartners.com/incident-response-policy-assessment-development/)
  + [Attack Surface Assessment](https://www.pentestpartners.com/attack-surface-assessment/)
* [Events](https://www.pentestpartners.com/events-and-speaking/)
* [Security Blog](https://www.pentestpartners.com/security-blog/)
* [Demo Videos](https://www.pentestpartners.com/resources/hack-demo-videos/)
* [Contact Us](https://www.pentestpartners.com/contact-us/)

For the best user experience please upgrade your browser

Blog: Internet Of Things

# Nifty XSS in Annke SP1 HD wireless camera

Jamie Riden
23 Mar 2017

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2017/03/annkeW.png)

We found an interesting, though low risk cross-site scripting issue in the ANNKE SP1 HD wireless camera, using firmware version **v3.4.1.1604071109**.

What’s interesting is that the XSS is found when viewing available Wi-Fi access points in the Annke web interface. Hence, if you set up a rogue access point in range of your victim with SSID of the format:

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2017/03/ANNKE-SP1-1.png)

…then the SP1 camera will end up loading and running the JavaScript code hosted at <http://xjs.io/> (or <https://xjs.io/> depending on how you’re accessing the camera’s web UI) whenever the victim visits the wireless configuration page. This is because it does a site survey and populates the SSIDs it can see directly into the web page, so the script executes.

### Exploiting this

As a proof of concept we made this script to steal an image from the camera. This was hosted at //xjs.io/

PoC code is here  <https://github.com/pentestpartners/bits-for-blog/blob/master/annke-basic.js>.

Here’s an image which has been through the XSS exploit, the JavaScript, been POSTed to server and then recovered from there:

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2017/03/ANNKE-SP1-POST.png)

Here’s the image we stole with our XSS exploit:

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2017/03/ANNKE-SP1-3.png)

### More fun

If you want to have some more fun, you can use this attack to get the camera to pan, using the [Javascript  here](https://github.com/pentestpartners/bits-for-blog/blob/master/annke-spin.js).

### Disclosure

This has to be the best or lamest vendor response ever:

“Thanks for your message. I suppose you are a programmer. I will forward your discovery to our product apartment.” – 5th August 2016

Since then we’ve had no further updates – they may have fixed it in more recent firmware, and obviously, one needs to be physically close to even start exploiting this issue, so it’s not a huge vulnerability. It does illustrate that vendors need to be careful to validate input from any source, not just the standard GET/POST parameters on the web interface.

Many thanks to Luke and Senad for help developing this proof of concept – Luke for finding a URL I could grab an image from, and Senad for helping with transferring the data without it getting mangled.

### Stealing a camera image

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2017/03/ANNKE-SP1-2.png)

### Making the camera pan

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2017/03/ANNKE-SP1-4.png)

### Share

### Categories

Show all
Android  (71)
Automotive Security  (24)
Aviation Cyber Security  (44)
Blockchain  (3)
Breach Handling  (1)
Careers At PTP  (1)
Cloud Security  (5)
Code Repository  (1)
Consultancy advice  (5)
Consumer Advice  (35)
Cyber Essentials  (1)
Cyber Liability Insurance  (5)
DFIR  (29)
Hardware Hacking  (20)
Heartbleed  (5)
Honeypots  (6)
How-Tos  (264)
In the news  (1)
Internet Of Things  (169)
Macs / Apple  (31)
Maritime Cyber Security  (48)
Medical Device Security  (3)
Opinions  (107)
OPSEC  (9)
OT, ICS, IIoT, SCADA  (22)
Passwords  (39)
PCI Advice  (2)
Ransomware  (2)
Red Teaming  (26)
Reverse Engineering  (12)
Security Blog  (808)
Shameless Self Promotion  (11)
Show on homepage  (6)
Social Engineering  (12)
Sustainability  (2)
Virtual Environments  (1)
Vulnerabilities that aren’t  (4)
Vulnerability Advisory  (45)
Vulnerability Disclosure  (20)

[# See the other cool stuff we've been doing…](/blog/)

[Maritime Cyber Security

# Cyber security guidance for small fleet operators

24 Jan 2025](https://www.pentestpartners.com/security-blog/cyber-security-guidance-for-small-fleet-operators/)

[Hardware Hacking

# How to secure body-worn cameras and protect footage from cyber threats

21 Jan 2025](https://www.pentestpartners.com/security-blog/how-to-secure-body-worn-cameras-and-protect-footage-from-cyber-threats/)

[Consumer Advice

# Security flaws found in tiny phones promoted to children

15 Jan 2025](https://www.pentestpartners.com/security-blog/security-flaws-found-in-tiny-phones-promoted-to-children/)

[DFIR

# Tackling AI threats. Advanced DFIR methods and tools for deepfake detection

13 Jan 2025](https://www.pentestpartners.com/security-blog/tackling-ai-threats-advanced-dfir-methods-and-tools-for-deepfake-detection/)

[Aviation Cyber Security

# The unexpected effects of GPS spoofing on aviation safety

09 Jan 2025](https://www.pentestpartners.com/security-blog/the-unexpected-effects-of-gps-spoofing-on-aviation-safety/)

[Services

### Automotive & IoT Testing

Find out more »](https://www.pentestpartners.com/penetration-testing-services/automotive-and-iot-testing/)

### Our People

Being introduced to, and getting to know your tester is an often overlooked part of the process. Yes, our work is über technical, but faceless relationships do nobody any good.

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-alert.svg)](https://www.pentestpartners.com/penetration-testing-services/suffered-a-security-breach/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-mobile-security.svg)
## Mobile Security](https://www.pentestpartners.com/penetration-testing-services/mobile-security/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-social-engineering-grey.svg)
## Social Engineering](https://www.pentestpartners.com/penetration-testing-services/social-engineering/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-webapp.svg)
## Web application testing](https://www.pentestpartners.com/penetration-testing-services/web-application-testing/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-data-compliance-grey.svg)
## Security Consuting](https://www.pentestpartners.com/penetration-testing-services/security-consulting/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-papa-grey.svg)
## Papa - PTP Advance Password Auditor](https://www.pentestpartners.com/penetration-testing-services/papa/)

### Get in touch

**UK Office:**

Pen Test Partners LLP

Unit 2, Verney Junction Business Park

Buckingham

MK18 2LB

United Kingdom

+44 20 3095 0500
[Contact Us »](/contact-us/)

###

**US Office:**

+1 646 693 2501
[[email protected]](/cdn-cgi/l/email-protection#b8d1d6ded7f8c8ddd6ccddcbccc8d9caccd6ddcacb96dbd7d5)

### Connect

[Twitter](https://twitter.com/PentestPartners)
[LinkedIn](https://www.linkedin.com/company/pen-test-partners)
[YouTube](https://www.youtube.com/channel/UC2HCAhj6JiOsV_PcMFrjykw)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-pentest-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-fs-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/csir-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-ovs-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![logo-cbest](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cbest.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-check-ncsc.png)](https://www.ncsc.gov.uk/organisations/pen-test-partners)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-assure.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cyber-essentials2023.png)](https://iasme.co.uk/cyber-essentials/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/bsi-iso27001-logo-22.png)](/content/uploads/2023/12/PTP-ISO27001-Certificate-2023.pdf)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-pci-certified.png)](https://www.pcisecuritystandards.org/assessors_and_solutions/qualified_security_assessors)

[Privacy Policy](/privacy-policy/)

[Terms of Service](/terms-of-website-use/)

Manage Cookies

Company number: OC353362

VAT reg number: GB825526427

© 2025 Pen Test Partners


