=== Content from jvn.jp_79a4ca0e_20250125_172145.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2017/08/03  Last Updated:2017/08/03
# JVN#86724730 Installer of IP Messenger may insecurely load Dynamic Link Libraries

## Overview

Installer of IP Messenger may insecurely load Dynamic Link Libraries.

## Products Affected

* IP Messenger for Win 4.60 and earlier

## Description

IP Messenger is a LAN Messenger based on TCP/IP. IP Messenger contains an issue with the DLL search path, which may lead to insecurely loading Dynamic Link Libraries ([CWE-427](https://cwe.mitre.org/data/definitions/427.html)).

## Impact

Arbitrary code may be executed with the privilege of the user invoking the installer.

## Solution

**Use the latest installer**

Use the latest installer according to the information provided by the developer.

Users who already have installed IP Messenger do not need to re-install the application, because this issue affects the installer only.

## Vendor Status

| Vendor | Link |
| --- | --- |
| H.Shirouzu / Asahi Net, Inc. | [IP Messenger Installer vulnerability of DLL loading without intent](https://ipmsg.org/ipmsg_dll_vulnerability.html.en) |

## References

1. [Japan Vulnerability Note JVNTA#91240916](https://jvn.jp/en/ta/JVNTA91240916/index.html)
   Insecure DLL Loading and Command Execution Issues on Many Windows Application Programs

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
Base Score:
7.8

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:M/Au:N/C:P/I:P/A:P
Base Score:
6.8

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Comment

This analysis assumes that the user is tricked into placing a malicious DLL file prepared by an attacker in a specific folder.

## Credit

Eili Masami of Tachibana Lab. reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2017-10820](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-10820) |
| JVN iPedia | [JVNDB-2017-000196](http://jvndb.jvn.jp/jvndb/JVNDB-2017-000196) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2017 JPCERT/CC and IPA. All rights reserved.



=== Content from ipmsg.org_cc97d7b4_20250125_172142.html ===

## IP Messenger Installer vulnerability of DLL loading without intent

Create: 2017/07/31

Update: 2017/08/03

H.Shirouzu
### Overview

IP Messenger Installer(v4.60 or earlier) has vulnerability of DLL loading without intent.

If this vulnerability is exploited, there is a risk that arbitrary code will be executed during the execution of the installer.
### Affected version

IP Messenger Installer v4.60 or earlier.
### Solution

Please use IP Messenger Installer v4.61 or later.
### Occurrence condition

1) Restore the installer executable file in the installer zip archive to the folder where the malicious DLL is placed.

2) Execute the installer and press "start" button

Remarks: It will not be affected if it is executed directly from the explorer zip folder or when it is executed after restoring with folder.
### Technical details

Even if it is not written "DLL reading without absolute path" in the source code, it is automatically internally executed "DLL reading without absolute path" at some WinAPI or COM I/F called.

This is the reason of IP Messenger Installer vulnerability.

(\*) I confirmed in Win10Pro and found in the following.

1) ShellExecute API will load "urlmon.dll" without absolute path internally.

2) IShellLink(create shortcut or etc) COM will load a dll without absolute path internally.

### Related information

I will add the link to Public institution press at 2017/08/04.
JVN#86724730 <https://jvn.jp/en/jp/JVN86724730/>

JPCERT Coordination Center <http://www.jpcert.or.jp/english/>

IPA <http://www.ipa.go.jp/index-e.html>

### History

2017/08/03: Add JVN Number and related links because JPCERT announced about this vulnerability.

[Top Page](/index.html.en)

