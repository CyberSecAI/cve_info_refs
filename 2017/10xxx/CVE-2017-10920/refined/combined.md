=== Content from security.gentoo.org_1378f2b6_20250125_204915.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple vulnerabilities — GLSA **201710-17**

Multiple vulnerabilities have been found in Xen, the worst of which
may allow local attackers to escalate privileges.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.7.3** |
| Unaffected versions | >= **4.7.3** |

| Package | **app-emulation/xen-pvgrub** on all architectures |
| --- | --- |
| Affected versions | < **4.7.3** |
| Unaffected versions | >= **4.7.3** |

| Package | **app-emulation/xen-tools** on all architectures |
| --- | --- |
| Affected versions | < **4.7.3** |
| Unaffected versions | >= **4.7.3** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the
referenced CVE identifiers for details.

### Impact

A local attacker could escalate privileges, cause a Denial of Service
condition, obtain sensitive information, or have other unspecified
impacts.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.7.3"

```

All Xen pvgrub users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-pvgrub-4.7.3"

```

All Xen Tools users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-tools-4.7.3"

```
### References

* [CVE-2017-10912](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10912)
* [CVE-2017-10913](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10913)
* [CVE-2017-10914](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10914)
* [CVE-2017-10915](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10915)
* [CVE-2017-10918](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10918)
* [CVE-2017-10920](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10920)
* [CVE-2017-10921](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10921)
* [CVE-2017-10922](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10922)

**Release date**

October 18, 2017

**Latest revision**

October 18, 2017: 1

**Severity**

high

**Exploitable**

local

**Bugzilla entries**

* [624112](https://bugs.gentoo.org/show_bug.cgi?id=624112)
* [624116](https://bugs.gentoo.org/show_bug.cgi?id=624116)
* [624118](https://bugs.gentoo.org/show_bug.cgi?id=624118)
* [624124](https://bugs.gentoo.org/show_bug.cgi?id=624124)
* [624128](https://bugs.gentoo.org/show_bug.cgi?id=624128)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from xenbits.xen.org_65aa28f8_20250125_204915.html ===

# Information

| Advisory | [XSA-224](advisory-224.html) |
| --- | --- |
| Public release | 2017-06-20 11:58 |
| Updated | 2017-07-07 13:52 |
| Version | 5 |
| CVE(s) | [CVE-2017-10920](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-10920) [CVE-2017-10921](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-10921) [CVE-2017-10922](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-10922) |
| Title | grant table operations mishandle reference counts |

# Files

<advisory-224.txt> (signed advisory file)

<xsa224-unstable/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch>

<xsa224-unstable/0002-gnttab-never-create-host-mapping-unless-asked-to.patch>

<xsa224-unstable/0003-gnttab-correct-logic-to-get-page-references-during-m.patch>

<xsa224-unstable/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch>

<xsa224-4.5/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch>

<xsa224-4.5/0002-gnttab-never-create-host-mapping-unless-asked-to.patch>

<xsa224-4.5/0003-gnttab-correct-logic-to-get-page-references-during-m.patch>

<xsa224-4.5/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch>

<xsa224-4.6/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch>

<xsa224-4.6/0002-gnttab-never-create-host-mapping-unless-asked-to.patch>

<xsa224-4.6/0003-gnttab-correct-logic-to-get-page-references-during-m.patch>

<xsa224-4.6/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch>

<xsa224-4.7/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch>

<xsa224-4.7/0002-gnttab-never-create-host-mapping-unless-asked-to.patch>

<xsa224-4.7/0003-gnttab-correct-logic-to-get-page-references-during-m.patch>

<xsa224-4.7/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch>

<xsa224-4.8/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch>

<xsa224-4.8/0002-gnttab-never-create-host-mapping-unless-asked-to.patch>

<xsa224-4.8/0003-gnttab-correct-logic-to-get-page-references-during-m.patch>

<xsa224-4.8/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

 Xen Security Advisory CVE-2017-10920,CVE-2017-10921,CVE-2017-10922 / XSA-224
                              version 5

           grant table operations mishandle reference counts

UPDATES IN VERSION 5
====================

CVEs assigned.

ISSUE DESCRIPTION
=================

We have discovered a number of bugs in the code mapping and unmapping
grant references.

* If a grant is mapped with both the GNTMAP_device_map and
GNTMAP_host_map flags, but unmapped only with host_map, the device_map
portion remains but the page reference counts are lowered as though it
had been removed. This bug can be leveraged cause a page's reference
counts and type counts to fall to zero while retaining writeable
mappings to the page.  (CVE-2017-10920.)

* Under some specific conditions, if a grant is mapped with both the
GNTMAP_device_map and GNTMAP_host_map flags, the operation may not
grab sufficient type counts.  When the grant is then unmapped, the
type count will be erroneously reduced.  This bug can be leveraged
cause a page's reference counts and type counts to fall to zero while
retaining writeable mappings to the page.  (CVE-2017-10921.)

* When a grant reference is given to an MMIO region (as opposed to a
normal guest page), if the grant is mapped with only the
GNTMAP_device_map flag set, a mapping is created at host_addr anyway.
This does *not* cause reference counts to change, but there will be no
record of this mapping, so it will not be considered when reporting
whether the grant is still in use.  (CVE-2017-10922.)

IMPACT
======

For the worst issue, a PV guest could gain a writeable mapping of its
own pagetable, allowing it to escalate its privileges to that of the
host.

VULNERABLE SYSTEMS
==================

All versions of Xen are vulnerable.

Only x86 systems are vulnerable.

Any system running untrusted PV guests is vulnerable.

Systems with untrusted HVM guests are only vulnerable if those guests
are served by a trusted PV backend which is vulnerable: Namely, one
which calls grant_map() with both the GNTMAP_device_map and
GNTMAP_host_map flags.  The security team is not aware of any backends
which are vulnerable.

MITIGATION
==========

Running only HVM guests will avoid this vulnerability.

CREDITS
=======

This issue was discovered by Jan Beulich of SUSE.

RESOLUTION
==========

Applying the appropriate set of attached patched resolves this issue.
Note that these patches are assumed to be applied on top of the XSA-218
ones; not doing so may cause at least mechanical problems of applying
the ones here.

xsa224-unstable/*.patch         xen-unstable
xsa224-4.8/*.patch       Xen 4.8.x
xsa224-4.7/*.patch       Xen 4.7.x
xsa224-4.6/*.patch       Xen 4.6.x
xsa224-4.5/*.patch       Xen 4.5.x

$ sha256sum xsa224*/*
[db39535185c1879775b62873fbed1e6285300ec1e1bd5d09ac2d96a98ac6443c  xsa224-unstable/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch](xsa224-unstable/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch)
[1588257f5b0c7113cd478475014f56fbeb6e79de7acbe67cf6d7a265e2b3fa15  xsa224-unstable/0002-gnttab-never-create-host-mapping-unless-asked-to.patch](xsa224-unstable/0002-gnttab-never-create-host-mapping-unless-asked-to.patch)
[a7517ca0e253fb9fb5b1ea1e56d04167f32ef87be145462a15241af26e4e0d65  xsa224-unstable/0003-gnttab-correct-logic-to-get-page-references-during-m.patch](xsa224-unstable/0003-gnttab-correct-logic-to-get-page-references-during-m.patch)
[951217a88f9c945eb9f7933cd66615aef955206fab955020334ac54da05663fa  xsa224-unstable/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch](xsa224-unstable/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch)
[190470fbd77fca58aab89a9bd034732525ce8f7ce7c417a0ca5d25b366639baa  xsa224-4.5/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch](xsa224-4.5/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch)
[9374e4dd6666a63fb32e6cfbdc95071b0cc153ff7cb2d2efdd98468e0e079605  xsa224-4.5/0002-gnttab-never-create-host-mapping-unless-asked-to.patch](xsa224-4.5/0002-gnttab-never-create-host-mapping-unless-asked-to.patch)
[d825e6fa5827e28e3755c92b274044666cc91b6a8cbc16e2081f43e0371991d4  xsa224-4.5/0003-gnttab-correct-logic-to-get-page-references-during-m.patch](xsa224-4.5/0003-gnttab-correct-logic-to-get-page-references-during-m.patch)
[d3aaffaf487a84e43fe10f7dec5af72b64d1b2315440c36335a0ed8ec1439ca1  xsa224-4.5/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch](xsa224-4.5/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch)
[c6cd6b82ef774bec5eaad5f32e767c917bc7ad2a73ee81d3f7eef67aaf1a1330  xsa224-4.6/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch](xsa224-4.6/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch)
[db32d15757c9d147c7e89eebd10a16324e59141fbb5ce3feb87fc9bf01864a6a  xsa224-4.6/0002-gnttab-never-create-host-mapping-unless-asked-to.patch](xsa224-4.6/0002-gnttab-never-create-host-mapping-unless-asked-to.patch)
[6bc9bbcf320d673822bd41545a014bd998294d06c5b38d79a6badf1a154ed0d6  xsa224-4.6/0003-gnttab-correct-logic-to-get-page-references-during-m.patch](xsa224-4.6/0003-gnttab-correct-logic-to-get-page-references-during-m.patch)
[088064fec3192928f205b34b808ca40fd685a8ba5037bb665ed0a4f87d6d4035  xsa224-4.6/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch](xsa224-4.6/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch)
[cdd93fb950b823cf96fe52685f6394c1b5e0a1e3d7d3c961a5e781da83551a9f  xsa224-4.7/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch](xsa224-4.7/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch)
[0583da31891084b2557a9623bc2b11a480e296004a8716b91c79fe28a824a6e0  xsa224-4.7/0002-gnttab-never-create-host-mapping-unless-asked-to.patch](xsa224-4.7/0002-gnttab-never-create-host-mapping-unless-asked-to.patch)
[2323bf581a835f152285b98ed2e4b5b503b0f67bd8e3449d33e8fe03b14ce064  xsa224-4.7/0003-gnttab-correct-logic-to-get-page-references-during-m.patch](xsa224-4.7/0003-gnttab-correct-logic-to-get-page-references-during-m.patch)
[b4f4adb1ea850e0174e51f76da7e97769211977c71809bd62102d33d90444b09  xsa224-4.7/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch](xsa224-4.7/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch)
[88b20e6765f0bfffe7598215f3a8e25c0931dbe3c7223cb3c08f998842cfc14b  xsa224-4.8/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch](xsa224-4.8/0001-gnttab-Fix-handling-of-dev_bus_addr-during-unmap.patch)
[ce62c97f470d6fbf557f50be8936051e91592a6330527515b7cdb187a0d633b2  xsa224-4.8/0002-gnttab-never-create-host-mapping-unless-asked-to.patch](xsa224-4.8/0002-gnttab-never-create-host-mapping-unless-asked-to.patch)
[5fd8cd67737c6a038d6c47fcf3c5bd2d238f4ac361538d650292ee185bda8000  xsa224-4.8/0003-gnttab-correct-logic-to-get-page-references-during-m.patch](xsa224-4.8/0003-gnttab-correct-logic-to-get-page-references-during-m.patch)
[f9c65c7f04063872602c609d2fc3caffc44716b3d378569969a7884abe881a19  xsa224-4.8/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch](xsa224-4.8/0004-gnttab-__gnttab_unmap_common_complete-is-all-or-noth.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJZX5I3AAoJEIP+FMlX6CvZ2vcH/3JCnqxUvVBcIAQ0UK87wjzZ
GQnrro45f1mfO2JyBzhbm9sKDmS0NgcOVZRZ6hteQ54ykq4bQOTDjoXd/bPSwvlk
yvtKsQa7k2n6NDw5XSPJeo8Yl1H44XqHLEzBEMtbjhveKA2zE2p7HrTjaIjblHB5
Xm37DDGHix0T57MSCAWE3BKTbIxpe6FL+Isdgigo8dxYgf8GP5BjN77MZM3rLBmf
2C+5uuEIqrn2ObQGA19mg5flfHe2vluP0VxZfoA5/1EZRnSiNelQtlD2A5b50dKh
ruAs//sIW+tOYfwQqYlb4kvt/Q4rml6jGdgxOfqoRoFRfENHxZ+vb/azENwiGxU=
=fWMp
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team


=== Content from www.debian.org_19a5c40d_20250125_204913.html ===


---

[[Date Prev](msg00230.html)][[Date Next](msg00232.html)]
[[Thread Prev](msg00230.html)][[Thread Next](msg00232.html)]
[[Date Index](maillist.html#00231)]
[[Thread Index](threads.html#00231)]

# [SECURITY] [DSA 3969-1] xen security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3969-1] xen security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Tue, 12 Sep 2017 23:05:56 +0200
* *Message-id*: <[[🔎]](/msgid-search/20170912210556.nesfevi5v45szrat%40pisco.westfalen.local) [20170912210556.nesfevi5v45szrat@pisco.westfalen.local](msg00231.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3969-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
September 12, 2017                    <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : xen
CVE ID         : CVE-2017-10912 CVE-2017-10913 CVE-2017-10914
                 CVE-2017-10915 CVE-2017-10916 CVE-2017-10917
		 CVE-2017-10918 CVE-2017-10919 CVE-2017-10920
		 CVE-2017-10921 CVE-2017-10922 CVE-2017-12135
                 CVE-2017-12136 CVE-2017-12137 CVE-2017-12855

Multiple vulnerabilities have been discovered in the Xen hypervisor:

CVE-2017-10912

    Jann Horn discovered that incorrectly handling of page transfers might
    result in privilege escalation.

CVE-2017-10913 / CVE-2017-10914

    Jann Horn discovered that race conditions in grant handling might
    result in information leaks or privilege escalation.

CVE-2017-10915

    Andrew Cooper discovered that incorrect reference counting with
    shadow paging might result in privilege escalation.

CVE-2017-10916

    Andrew Cooper discovered an information leak in the handling
    of the the Memory Protection Extensions (MPX) and Protection
    Key (PKU) CPU features. This only affects Debian stretch.

CVE-2017-10917

    Ankur Arora discovered a NULL pointer dereference in event
    polling, resulting in denial of service.

CVE-2017-10918

    Julien Grall discovered that incorrect error handling in
    physical-to-machine memory mappings may result in privilege
    escalation, denial of service or an information leak.

CVE-2017-10919

    Julien Grall discovered that that incorrect handling of
    virtual interrupt injection on ARM systems may result in
    denial of service.

CVE-2017-10920 / CVE-2017-10921 / CVE-2017-10922

    Jan Beulich discovered multiple places where reference
    counting on grant table operations was incorrect, resulting
    in potential privilege escalation

CVE-2017-12135

    Jan Beulich found multiple problems in the handling of
    transitive grants which could result in denial of service
    and potentially privilege escalation.

CVE-2017-12136

    Ian Jackson discovered that race conditions in the allocator
    for grant mappings may result in denial of service or privilege
    escalation. This only affects Debian stretch.

CVE-2017-12137

    Andrew Cooper discovered that incorrect validation of
    grants may result in privilege escalation.

CVE-2017-12855

    Jan Beulich discovered that incorrect grant status handling, thus
    incorrectly informing the guest that the grant is no longer in use.

XSA-235 (no CVE yet)

    Wei Liu discovered that incorrect locking of add-to-physmap
    operations on ARM may result in denial of service.

For the oldstable distribution (jessie), these problems have been fixed
in version 4.4.1-9+deb8u10.

For the stable distribution (stretch), these problems have been fixed in
version 4.8.1-1+deb9u3.

We recommend that you upgrade your xen packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlm4TAgACgkQEMKTtsN8
TjY0fg/+M9abYbzVprbp5JfvELlm0tgfOcgqqbLAzh4j5Fk+KpuOjqCPoGTP9wux
fiuQgej7Vr3REScjSZWZL0kfAIBN/Em79GcNhBEhsXefbEeDbGR4XNkk6RAhie4W
JVkzsq2J0xV1gSiug71G6ujRiiAnuHO6EV5NHqa1Oi9mVQY8BrXl0Vyx4ZLcOI/X
HIajFwrIY5cCm+vyAng1YER31ApHTPUxJ+6oDyCwyCs7pm3Ep2GmyYJQ6mkYZ5JU
remFj8x59/Pt6FDX+Kk4KDb6LPJc5f0hchrYNyrL+Jv/hT0gVdSlqxF40CuAtXUv
qlzI18cdtCSNEJV2K82eDd9iF0UA/L5+SRnxg5zpbaa5pGLGneQQPGfrDqOLXTnM
T0BmVY2QvTp68858dUy7F8uZRt6gRLiZ2heGplt1xYfAeSKhrXhkBAyCBuuryCiT
rjwyHcRKjLd1RPIyeRMYjA8JTrPmwbkhYCTta+WyVA9CdAKBXOeISyKn4bix0jJg
KWYyJhUpmG5fCjKeTEruTmYlnrAX+/BqJPKUt1SFoCDJJ0SYQqCIFudcgcznkRgW
2yfgo3n1lS8gyP4J8Q5aSF5AkpjIoUTe4lYUER9UK9+nKyfT55+HliNkeZy2GIOi
vUSfPoRSFL2hge863SUxZ/fu6or9SttRVIlGqK5Q/BgoGXzNbQg=
=iDjs
-----END PGP SIGNATURE-----

```

---


