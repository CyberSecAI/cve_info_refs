- **Root cause of vulnerability:** The application fails to properly sanitize filenames, allowing for the injection of malicious JavaScript code within the filename itself.
- **Weaknesses/vulnerabilities present:** Cross-Site Scripting (XSS) vulnerability due to lack of filename sanitization.
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code in the context of the victim's browser. This could lead to the attacker reading all images uploaded by the target, removing images, and possibly other malicious actions within the application.
- **Attack vectors:** The attacker provides a crafted image file with a malicious filename, such as `<img src=x onerror=alert(0)>.jpg`. The victim uploads this file to the vulnerable application.
- **Required attacker capabilities/position:** The attacker needs to be able to provide a specially crafted image file to the victim, who must then upload this file to the vulnerable application. The attacker has to trick the user to use the crafted filename, which is noted as unlikely.