=== Content from xenbits.xen.org_0772aa2c_20250124_191931.html ===

# Information

| Advisory | [XSA-222](advisory-222.html) |
| --- | --- |
| Public release | 2017-06-20 11:58 |
| Updated | 2017-07-07 13:52 |
| Version | 3 |
| CVE(s) | [CVE-2017-10918](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-10918) |
| Title | stale P2M mappings due to insufficient error checking |

# Files

<advisory-222.txt> (signed advisory file)

<xsa222-1.patch>

<xsa222-1-4.6.patch>

<xsa222-1-4.7.patch>

<xsa222-2.patch>

<xsa222-2-4.5.patch>

<xsa222-2-4.6.patch>

<xsa222-2-4.7.patch>

<xsa222-2-4.8.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2017-10918 / XSA-222
                              version 3

         stale P2M mappings due to insufficient error checking

UPDATES IN VERSION 3
====================

CVE assigned.

ISSUE DESCRIPTION
=================

Certain actions require removing pages from a guest's P2M
(Physical-to-Machine) mapping.  When large pages are in use to map
guest pages in the 2nd-stage page tables, such a removal operation may
incur a memory allocation (to replace a large mapping with individual
smaller ones).  If this allocation fails, these errors are ignored by
the callers, which would then continue and (for example) free the
referenced page for reuse.  This leaves the guest with a mapping to a
page it shouldn't have access to.

The allocation involved comes from a separate pool of memory created
when the domain is created; under normal operating conditions it never
fails, but a malicious guest may be able to engineer situations where
this pool is exhausted.

IMPACT
======

A malicious guest may be able to access memory it doesn't own,
potentially allowing privilege escalation, host crashes, or
information leakage.

VULNERABLE SYSTEMS
==================

Xen versions from at least 3.2 onwards are vulnerable.  Older versions
have not been inspected.

Both x86 and ARM systems are vulnerable.

On x86 systems, only HVM guests can leverage the vulnerability.

MITIGATION
==========

On x86, specifying "hap_1gb=0 hap_2mb=0" on the hypervisor command
line will avoid the vulnerability.

Alternatively, running all x86 HVM guests in shadow mode will also
avoid this vulnerability.  (For example, by specifying "hap=0" in the
xl domain configuration file.)

There is no known mitigation on ARM systems.

CREDITS
=======

This issue was discovered by Julien Grall of ARM.

RESOLUTION
==========

Applying the appropriate pair of attached patches resolves this issue.

xsa222-[12].patch                        xen-unstable
xsa222-1.patch, xsa222-2-4.8.patch       Xen 4.8.x
xsa222-[12]-4.7.patch                    Xen 4.7.x
xsa222-[12]-4.6.patch                    Xen 4.6.x
xsa222-1-4.6.patch, xsa222-2-4.5.patch   Xen 4.5.x

$ sha256sum xsa222*
[8bd8807ee1cfe01c86194f5d5be38618ba5e0c1206667bb119ed952e5d155c1a  xsa222-1.patch](xsa222-1.patch)
[9288dfcae1f37e6c8f13910046f43ec161710abb7c94a9346b7e0eaba3258ccd  xsa222-1-4.6.patch](xsa222-1-4.6.patch)
[ebc2c070bad8012a196e984b568a72e013ff072bb077870508f09ed053c1a4c2  xsa222-1-4.7.patch](xsa222-1-4.7.patch)
[ee320b37b365cb3b6660e559902ff8bb50657b2a28ff0fa7ebaf9ffd33fc0942  xsa222-2.patch](xsa222-2.patch)
[97768f4fe564f702de8e4aebd0c4d24858814ebbb7be532b376cfae7ad6834a4  xsa222-2-4.5.patch](xsa222-2-4.5.patch)
[4142f76673b996b65301d52216cbf56e27b0c86e5607f6a9eb18dcc7df3f6343  xsa222-2-4.6.patch](xsa222-2-4.6.patch)
[a640e190b32e82f5ec7ee4968bf8b9f22137e8379314cc9a29556637c3dc8e87  xsa222-2-4.7.patch](xsa222-2-4.7.patch)
[ab43bd590139bed53957b3b37b854183c69bee26cf7cb00900e3f4a150d067a5  xsa222-2-4.8.patch](xsa222-2-4.8.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJZX5I0AAoJEIP+FMlX6CvZCG8IAJ9PQcPjjf4cHdmpZDlpRUtR
M94vFhyCcjSjoVUp3syJnlK+BKgJcEd1LyVplPYBJI/rKroFHSdnTbjJqjE0WAJi
uOb2hSe6nj9FD4bCAnL+B0y1BSn+pU5576i6IqEN/dDLTtVA+DH3S3qrnJbzIPuD
1fha4CafMcUJ6qXbs1IHAnlzy09sVI09o1oOtyzLZ/9W6ECiZqCCC9WtE5uBn7MB
NvqWuQrteCJmApDAAz6cAv02FxLJiSKra2reBfEDkx4Yy8u6Z4HGhGuInqI4gNbz
QHx9ufWNI6FA5E9l/oPpPdLgFv3TDhCcjl85dk+MsKeewA/b4nWtRfmgkg0ekKM=
=DNS7
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team


=== Content from www.debian.org_19a5c40d_20250124_191931.html ===


---

[[Date Prev](msg00230.html)][[Date Next](msg00232.html)]
[[Thread Prev](msg00230.html)][[Thread Next](msg00232.html)]
[[Date Index](maillist.html#00231)]
[[Thread Index](threads.html#00231)]

# [SECURITY] [DSA 3969-1] xen security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3969-1] xen security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Tue, 12 Sep 2017 23:05:56 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20170912210556.nesfevi5v45szrat%40pisco.westfalen.local)Â [20170912210556.nesfevi5v45szrat@pisco.westfalen.local](msg00231.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3969-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
September 12, 2017                    <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : xen
CVE ID         : CVE-2017-10912 CVE-2017-10913 CVE-2017-10914
                 CVE-2017-10915 CVE-2017-10916 CVE-2017-10917
		 CVE-2017-10918 CVE-2017-10919 CVE-2017-10920
		 CVE-2017-10921 CVE-2017-10922 CVE-2017-12135
                 CVE-2017-12136 CVE-2017-12137 CVE-2017-12855

Multiple vulnerabilities have been discovered in the Xen hypervisor:

CVE-2017-10912

    Jann Horn discovered that incorrectly handling of page transfers might
    result in privilege escalation.

CVE-2017-10913 / CVE-2017-10914

    Jann Horn discovered that race conditions in grant handling might
    result in information leaks or privilege escalation.

CVE-2017-10915

    Andrew Cooper discovered that incorrect reference counting with
    shadow paging might result in privilege escalation.

CVE-2017-10916

    Andrew Cooper discovered an information leak in the handling
    of the the Memory Protection Extensions (MPX) and Protection
    Key (PKU) CPU features. This only affects Debian stretch.

CVE-2017-10917

    Ankur Arora discovered a NULL pointer dereference in event
    polling, resulting in denial of service.

CVE-2017-10918

    Julien Grall discovered that incorrect error handling in
    physical-to-machine memory mappings may result in privilege
    escalation, denial of service or an information leak.

CVE-2017-10919

    Julien Grall discovered that that incorrect handling of
    virtual interrupt injection on ARM systems may result in
    denial of service.

CVE-2017-10920 / CVE-2017-10921 / CVE-2017-10922

    Jan Beulich discovered multiple places where reference
    counting on grant table operations was incorrect, resulting
    in potential privilege escalation

CVE-2017-12135

    Jan Beulich found multiple problems in the handling of
    transitive grants which could result in denial of service
    and potentially privilege escalation.

CVE-2017-12136

    Ian Jackson discovered that race conditions in the allocator
    for grant mappings may result in denial of service or privilege
    escalation. This only affects Debian stretch.

CVE-2017-12137

    Andrew Cooper discovered that incorrect validation of
    grants may result in privilege escalation.

CVE-2017-12855

    Jan Beulich discovered that incorrect grant status handling, thus
    incorrectly informing the guest that the grant is no longer in use.

XSA-235 (no CVE yet)

    Wei Liu discovered that incorrect locking of add-to-physmap
    operations on ARM may result in denial of service.

For the oldstable distribution (jessie), these problems have been fixed
in version 4.4.1-9+deb8u10.

For the stable distribution (stretch), these problems have been fixed in
version 4.8.1-1+deb9u3.

We recommend that you upgrade your xen packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlm4TAgACgkQEMKTtsN8
TjY0fg/+M9abYbzVprbp5JfvELlm0tgfOcgqqbLAzh4j5Fk+KpuOjqCPoGTP9wux
fiuQgej7Vr3REScjSZWZL0kfAIBN/Em79GcNhBEhsXefbEeDbGR4XNkk6RAhie4W
JVkzsq2J0xV1gSiug71G6ujRiiAnuHO6EV5NHqa1Oi9mVQY8BrXl0Vyx4ZLcOI/X
HIajFwrIY5cCm+vyAng1YER31ApHTPUxJ+6oDyCwyCs7pm3Ep2GmyYJQ6mkYZ5JU
remFj8x59/Pt6FDX+Kk4KDb6LPJc5f0hchrYNyrL+Jv/hT0gVdSlqxF40CuAtXUv
qlzI18cdtCSNEJV2K82eDd9iF0UA/L5+SRnxg5zpbaa5pGLGneQQPGfrDqOLXTnM
T0BmVY2QvTp68858dUy7F8uZRt6gRLiZ2heGplt1xYfAeSKhrXhkBAyCBuuryCiT
rjwyHcRKjLd1RPIyeRMYjA8JTrPmwbkhYCTta+WyVA9CdAKBXOeISyKn4bix0jJg
KWYyJhUpmG5fCjKeTEruTmYlnrAX+/BqJPKUt1SFoCDJJ0SYQqCIFudcgcznkRgW
2yfgo3n1lS8gyP4J8Q5aSF5AkpjIoUTe4lYUER9UK9+nKyfT55+HliNkeZy2GIOi
vUSfPoRSFL2hge863SUxZ/fu6or9SttRVIlGqK5Q/BgoGXzNbQg=
=iDjs
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_1378f2b6_20250124_191931.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple vulnerabilities â€” GLSA **201710-17**

Multiple vulnerabilities have been found in Xen, the worst of which
may allow local attackers to escalate privileges.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.7.3** |
| Unaffected versions | >= **4.7.3** |

| Package | **app-emulation/xen-pvgrub** on all architectures |
| --- | --- |
| Affected versions | < **4.7.3** |
| Unaffected versions | >= **4.7.3** |

| Package | **app-emulation/xen-tools** on all architectures |
| --- | --- |
| Affected versions | < **4.7.3** |
| Unaffected versions | >= **4.7.3** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the
referenced CVE identifiers for details.

### Impact

A local attacker could escalate privileges, cause a Denial of Service
condition, obtain sensitive information, or have other unspecified
impacts.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.7.3"

```

All Xen pvgrub users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-pvgrub-4.7.3"

```

All Xen Tools users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-tools-4.7.3"

```
### References

* [CVE-2017-10912](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10912)
* [CVE-2017-10913](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10913)
* [CVE-2017-10914](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10914)
* [CVE-2017-10915](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10915)
* [CVE-2017-10918](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10918)
* [CVE-2017-10920](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10920)
* [CVE-2017-10921](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10921)
* [CVE-2017-10922](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10922)

**Release date**

October 18, 2017

**Latest revision**

October 18, 2017: 1

**Severity**

high

**Exploitable**

local

**Bugzilla entries**

* [624112](https://bugs.gentoo.org/show_bug.cgi?id=624112)
* [624116](https://bugs.gentoo.org/show_bug.cgi?id=624116)
* [624118](https://bugs.gentoo.org/show_bug.cgi?id=624118)
* [624124](https://bugs.gentoo.org/show_bug.cgi?id=624124)
* [624128](https://bugs.gentoo.org/show_bug.cgi?id=624128)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**


