=== Content from security.gentoo.org_d03e5cea_20250125_043141.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# NASM: Multiple vulnerabilities — GLSA **201903-19**

Multiple vulnerabilities have been found in NASM, the worst of
which could result in the remote execution of arbitrary code.

### Affected packages

| Package | **dev-lang/nasm** on all architectures |
| --- | --- |
| Affected versions | < **2.14.02** |
| Unaffected versions | >= **2.14.02** |

### Background

NASM is a 80x86 assembler that has been created for portability and
modularity. NASM supports Pentium, P6, SSE MMX, and 3DNow extensions. It
also supports a wide range of objects formats (ELF, a.out, COFF, etc),
and has its own disassembler.

### Description

Multiple vulnerabilities have been discovered in NASM. Please review the
CVE identifiers referenced below for details.

### Impact

A remote attacker could cause a Denial of Service condition or execute
arbitrary code.

### Workaround

There is no known workaround at this time.

### Resolution

All NASM users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-lang/nasm-2.14.02"

```
### References

* [CVE-2017-10686](https://nvd.nist.gov/vuln/detail/CVE-2017-10686)
* [CVE-2017-11111](https://nvd.nist.gov/vuln/detail/CVE-2017-11111)
* [CVE-2017-14228](https://nvd.nist.gov/vuln/detail/CVE-2017-14228)

**Release date**

March 28, 2019

**Latest revision**

March 28, 2019: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [635358](https://bugs.gentoo.org/show_bug.cgi?id=635358)
* [659550](https://bugs.gentoo.org/show_bug.cgi?id=659550)
* [670884](https://bugs.gentoo.org/show_bug.cgi?id=670884)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from launchpad.net_92b3689d_20250126_055938.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/nasm/2.10.09-1ubuntu0.1/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[nasm package](https://launchpad.net/ubuntu/%2Bsource/nasm)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/nasm)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/nasm)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/nasm)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/nasm)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/nasm)

# nasm 2.10.09-1ubuntu0.1 source package in Ubuntu

## Changelog

```
nasm (2.10.09-1ubuntu0.1) trusty-security; urgency=medium

  * SECURITY UPDATE: code execution via heap use-after-free
    - debian/patches/CVE-2017-10686-1.patch: don't call free_mmacro in
      preproc.c.
    - debian/patches/CVE-2017-10686-2.patch: free token's text if only it
      has been modified in preproc.c.
    - CVE-2017-10686
  * SECURITY UPDATE: heap buffer overflow
    - debian/patches/CVE-2017-11111.patch: only concat tok->text if we
      accounted for its size in preproc.c.
    - CVE-2017-11111
  * SECURITY UPDATE: NULL pointer dereference in paste_tokens
    - debian/patches/CVE-2017-14228.patch: check length in preproc.c.
    - CVE-2017-14228
  * SECURITY UPDATE: DoS via macro calls with wrong number of arguments
    - debian/patches/CVE-2017-17810.patch: check arguments in preproc.c.
    - CVE-2017-17810
  * SECURITY UPDATE: DoS via heap over-read
    - debian/patches/CVE-2017-17812.patch: check for data to process in
      preproc.c.
    - CVE-2017-17812
  * SECURITY UPDATE: DoS via missing check
    - debian/patches/CVE-2017-17815.patch: don't leave nparam_max less than
      nparam_min in preproc.c.
    - CVE-2017-17815
  * SECURITY UPDATE: DoS via incorrect validation
    - debian/patches/CVE-2017-17819.patch: check for NULL pointer in
      preproc.c.
    - CVE-2017-17819
  * SECURITY UPDATE: heap-based overread
    - debian/patches/CVE-2018-8881.patch: handle unterminated strings in
      preproc.c.
    - CVE-2018-8881
  * The above patches also fix the following CVEs:
    - CVE-2017-17811
    - CVE-2017-17813
    - CVE-2017-17814
    - CVE-2017-17816
    - CVE-2017-17817
    - CVE-2017-17818
    - CVE-2017-17820

 -- Marc Deslauriers <email address hidden>  Thu, 28 Jun 2018 09:15:32 -0400
```

## Upload details

Uploaded by:
[Marc Deslauriers](/~mdeslaur)
on 2018-06-28

Uploaded to:
[Trusty](/ubuntu/trusty)

Original maintainer:
[Ubuntu Developers](/~ubuntu-devel-discuss-lists)

Architectures:
any

Section:
devel

Urgency:
Medium Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |
| [Trusty](/ubuntu/trusty) | updates | on 2018-06-28 | main | devel |
| [Trusty](/ubuntu/trusty) | security | on 2018-06-28 | main | devel |

## Builds

[Trusty](/ubuntu/trusty):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/15065101)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[arm64](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/15065102)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armhf](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/15065103)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/15065104)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[powerpc](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/15065105)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[ppc64el](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/15065106)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [nasm\_2.10.09.orig.tar.xz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/nasm/2.10.09-1ubuntu0.1/nasm_2.10.09.orig.tar.xz) | 670.3 KiB | 9ffd9f910c783ee798cf2986cec01ebeeb01ba0ecacef64d2d4bea927c41fbf2 |
| [nasm\_2.10.09-1ubuntu0.1.debian.tar.bz2](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/nasm/2.10.09-1ubuntu0.1/nasm_2.10.09-1ubuntu0.1.debian.tar.bz2) | 18.2 KiB | ca71724f9a0f8136111492d524e571cca9c90a1b0c0ae05660c62b302827cf59 |
| [nasm\_2.10.09-1ubuntu0.1.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/nasm/2.10.09-1ubuntu0.1/nasm_2.10.09-1ubuntu0.1.dsc) | 1.8 KiB | 7e559ed51e2df46252271aca351bfa69353c3b39aeac544af67d70119c9a5f03 |

### Available diffs

* [diff from 2.10.09-1 (in Debian) to 2.10.09-1ubuntu0.1](http://launchpadlibrarian.net/376372681/nasm_2.10.09-1_2.10.09-1ubuntu0.1.diff.gz) (4.1 KiB)

[View changes file](http://launchpadlibrarian.net/376372627/nasm_2.10.09-1ubuntu0.1_source.changes)

## Binary packages built by this source

[nasm](/ubuntu/trusty/%2Bpackage/nasm):
General-purpose x86 assembler

Netwide Assembler. NASM will currently output flat-form binary files,

 a.out, COFF and ELF Unix object files, and Microsoft 16-bit DOS and

 Win32 object files.

 .

 Also included is NDISASM, a prototype x86 binary-file disassembler

 which uses the same instruction table as NASM.

 .

 NASM is released under the GNU Lesser General Public License (LGPL).

[nasm-dbgsym](/ubuntu/trusty/%2Bpackage/nasm-dbgsym):
debug symbols for package nasm

Netwide Assembler. NASM will currently output flat-form binary files,

 a.out, COFF and ELF Unix object files, and Microsoft 16-bit DOS and

 Win32 object files.

 .

 Also included is NDISASM, a prototype x86 binary-file disassembler

 which uses the same instruction table as NASM.

 .

 NASM is released under the GNU Lesser General Public License (LGPL).

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugzilla.nasm.us_f0de6b0f_20250125_043140.html ===


Bugzilla – Bug 3392414
Multiple use after free vulnerabilities in the Nasm tool with latest vesion
Last modified: 2017-07-25 18:22:13 PDT

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](docs/en/html/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=3392414&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=3392414&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

Self-registration is disabled due to spam issue (mail gorcunov@gmail.com or hpa@zytor.com to create an account)

[**Bug 3392414**](show_bug.cgi?id=3392414)
- Multiple use after free vulnerabilities in the Nasm tool with latest vesion

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Multiple use after free vulnerabilities in the Nasm tool with latest vesion

| | [Status](page.cgi?id=fields.html#bug_status): | CLOSED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | NASM | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=NASM "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Assembler ([show other bugs](buglist.cgi?component=Assembler&product=NASM&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2.14.xx | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | Highest blocker | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Cyrill Gorcunov | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-06-24 00:45 PDT by owl337 | | --- | --- | | Modified: | 2017-07-25 18:22 PDT ([History](show_activity.cgi?id=3392414)) | | CC List: | 6 users (show)  amajer gorcunov hpa mizdebsk nasm-bugs v.owl337 | |  | | | [Obtained from:](page.cgi?id=fields.html#cf_build "Please indicate where you obtained and/or built your version of NASM.") | Binary from nasm.us | | [Generated by:](page.cgi?id=fields.html#cf_robot "Was this bug report generated by an automatic tool, such as a memory leak detector or fuzzer, *without* including a human validation description or analysis of the problem?") | --- | | [Bug category:](page.cgi?id=fields.html#cf_category "The general category of this bug oor request.") |  | | [Breaks existing code:](page.cgi?id=fields.html#cf_breaks "This bug report breaks existing code in production or under development.") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**four poc**](attachment.cgi?id=411595 "View the content of the attachment") (2.11 KB, application/x-rar)  [2017-07-04 02:06 PDT](#attach_411595 "Go to the comment associated with the attachment"), owl337 | [Details](attachment.cgi?id=411595&action=edit) | | [**t->text is not always overwritten but always freed.**](attachment.cgi?id=411598 "View the content of the attachment") (971 bytes, patch)  [2017-07-25 05:57 PDT](#attach_411598 "Go to the comment associated with the attachment"), amajer | [Details](attachment.cgi?id=411598&action=edit) | [Diff](attachment.cgi?id=411598&action=diff) | | [**workaround to usage-after-free**](attachment.cgi?id=411599 "View the content of the attachment") (1.23 KB, patch)  [2017-07-25 06:00 PDT](#attach_411599 "Go to the comment associated with the attachment"), amajer | [Details](attachment.cgi?id=411599&action=edit) | [Diff](attachment.cgi?id=411599&action=diff) | | [Add an attachment](attachment.cgi?bugid=3392414&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=3392414&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=3392414#c0)  owl337    2017-06-24 00:45:31 PDT  ``` There were multiple heap use after free vulnerabilities in the tool nasm with latest version(2.14rc0). The related heap was allocated at token() function and freed  at detoken() function(called by pp_getline())that used again at different positions later that could cause multiple damages.   In the loop "while ((line = preproc->getline()))" of  function assemble_file(called at nasm.c:453) ,pp_getline function freed a heap via calling detoken function(line:5214)  but the heap was read and written frequently later that caused multiple use after free vulnerabilities.     The asan and gdb debug information are as follows for all POCs:  POC1:  corrupted double-linked in detoken() function  $nasm -f bin  POC1   -o  nasm.out  ==98294==ERROR: AddressSanitizer: heap-use-after-free on address 0x602000006f90 at pc 0x50fe1e bp 0x7fffffffbb10 sp 0x7fffffffbb08 READ of size 1 at 0x602000006f90 thread T0 ==98294==WARNING: Trying to symbolize code, but external symbolizer is not initialized!     #0 0x50fe1d (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x50fe1d)     #1 0x4d71d9 (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x4d71d9)     #2 0x483bcd (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x483bcd)     #3 0x7ffff6ee6a3f (/lib/x86_64-linux-gnu/libc.so.6+0x20a3f)     #4 0x47e3f8 (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x47e3f8)  0x602000006f90 is located 0 bytes inside of 6-byte region [0x602000006f90,0x602000006f96] freed by thread T0 here:     #0 0x468189 (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x468189)     nasmlib/malloc.c:77　free(q)     #1 0x48b80a (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x48b80a)    preproc.c：5215 line = detoken(tline, true);     #2 0x4d71d9 (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x4d71d9)     #3 0x483bcd (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x483bcd)     #4 0x7ffff6ee6a3f (/lib/x86_64-linux-gnu/libc.so.6+0x20a3f)  previously allocated by thread T0 here:          #0 0x468309 (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x468309)     nasmlib/malloc.c:47  void *p = malloc(size);     #1 0x48b6b5 (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x48b6b5)     asm/T2 preproc.c:5124  tline = tokenize(line);     #2 0x4d33be (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x4d33be)     asm/nasm.c:1233  while ((line = preproc->getline())) {     #3 0x483bcd (/home/company/real/nasm-2.14rc0/install_asan/bin/nasm_asan+0x483bcd)     #4 0x7ffff6ee6a3f (/lib/x86_64-linux-gnu/libc.so.6+0x20a3f)  SUMMARY: AddressSanitizer: heap-use-after-free ??:0 ?? Shadow bytes around the buggy address:   0x0c047fff8da0: fa fa 03 fa fa fa fd fa fa fa 02 fa fa fa fd fa   0x0c047fff8db0: fa fa 02 fa fa fa fd fa fa fa 02 fa fa fa fd fa   0x0c047fff8dc0: fa fa 06 fa fa fa fd fa fa fa 04 fa fa fa fd fa   0x0c047fff8dd0: fa fa 05 fa fa fa fd fa fa fa 02 fa fa fa fd fa   0x0c047fff8de0: fa fa 03 fa fa fa fd fa fa fa 03 fa fa fa fd fa =>0x0c047fff8df0: fa fa[fd]fa fa fa fd fa fa fa fd fa fa fa 02 fa   0x0c047fff8e00: fa fa fd fa fa fa fd fa fa fa 02 fa fa fa fd fa   0x0c047fff8e10: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa   0x0c047fff8e20: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa   0x0c047fff8e30: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa   0x0c047fff8e40: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07    Heap left redzone:     fa   Heap right redzone:    fb   Freed heap region:     fd   Stack left redzone:    f1   Stack mid redzone:     f2   Stack right redzone:   f3   Stack partial redzone: f4   Stack after return:    f5   Stack use after scope: f8   Global redzone:        f9   Global init order:     f6   Poisoned by user:      f7   ASan internal:         fe ==98294==ABORTING   $gdb nasm (gdb)set args -f bin  POC1   -o  nasm.out (gdb) r ... (gdb) bt  #0  0x00007ffff7a44267 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:55 #1  0x00007ffff7a45eca in __GI_abort () at abort.c:89 #2  0x00007ffff7a87c53 in __libc_message (do_abort=do_abort@entry=1, fmt=fmt@entry=0x7ffff7ba01a8 "*** Error in `%s': %s: 0x%s ***\n") at ../sysdeps/posix/libc_fatal.c:175 #3  0x00007ffff7a8e468 in malloc_printerr (ptr=<optimized out>, str=0x7ffff7b9c2dd "corrupted double-linked list", action=1) at malloc.c:4965 #4  malloc_consolidate (av=av@entry=0x7ffff7dd3c00 <main_arena>) at malloc.c:4150 #5  0x00007ffff7a8ff18 in _int_free (av=0x7ffff7dd3c00 <main_arena>, p=<optimized out>, have_lock=0) at malloc.c:4042 #6  0x00007ffff7a9389c in __GI___libc_free (mem=<optimized out>) at malloc.c:2950 #7  0x0000000000408374 in saa_free (s=0x7411a0) at nasmlib/saa.c:71 #8  0x0000000000402c2d in main (argc=<optimized out>, argv=<optimized out>) at asm/nasm.c:481  POC2:  double free or corruption in delete_Token() function   $gdb nasm (gdb)set args -f bin  POC2   -o  nasm.out (gdb) r ...  Program received signal SIGABRT, Aborted. 0x00007ffff6efb267 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:55 55	../sysdeps/unix/sysv/linux/raise.c: No such file or directory. (gdb) bt #0  0x00007ffff6efb267 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:55 #1  0x00007ffff6efceca in __GI_abort () at abort.c:89 #2  0x00007ffff6f3ec53 in __libc_message (do_abort=do_abort@entry=1, fmt=fmt@entry=0x7ffff70571a8 "*** Error in `%s': %s: 0x%s ***\n") at ../sysdeps/posix/libc_fatal.c:175 #3  0x00007ffff6f46c69 in malloc_printerr (ptr=<optimized out>, str=0x7ffff7057270 "double free or corruption (fasttop)", action=1) at malloc.c:4965 #4  _int_free (av=<optimized out>, p=<optimized out>, have_lock=0) at malloc.c:3834 #5  0x00007ffff6f4a89c in __GI___libc_free (mem=<optimized out>) at malloc.c:2950 #6  0x0000000000438c71 in nasm_free (q=<optimized out>) at nasmlib/malloc.c:77 #7  0x0000000000506249 in delete_Token (t=<optimized out>) at asm/preproc.c:1236 #8  0x00000000004f1819 in pp_getline () at asm/preproc.c:612   POC3:  out of write caused segmentation fault in detoken() funtion  $gdb nasm (gdb)set args -f bin  POC3   -o  nasm.out (gdb) r ...  Program received signal SIGSEGV, Segmentation fault. 0x0000000000583173 in detoken (tlist=<optimized out>, expand_locals=<optimized out>) at asm/preproc.c:1316 1316	                *p++ = *q++; (gdb) bt #0  0x0000000000583173 in detoken (tlist=<optimized out>, expand_locals=<optimized out>) at asm/preproc.c:1316 #1  0x00000000004f17cc in pp_getline () at asm/preproc.c:5215 #2  0x0000000000427f52 in assemble_file (warning: Unmapped DWARF Register #-1 encountered.   POC4:  out of write caused segmentation fault in  new_Token() function  $gdb nasm (gdb)set args -f bin  POC4  -o  nasm.out (gdb) r ...  Program received signal SIGSEGV, Segmentation fault. strlen () at ../sysdeps/x86_64/strlen.S:106 106	../sysdeps/x86_64/strlen.S: No such file or directory. (gdb) bt #0  strlen () at ../sysdeps/x86_64/strlen.S:106 #1  0x00000000004f86ad in new_Token (next=<optimized out>, type=<optimized out>, text=<optimized out>, txtlen=<optimized out>) at asm/preproc.c:1225 #2  0x0000000000579845 in expand_mmac_params (tline=<optimized out>) at asm/preproc.c:4083 #3  0x00000000004e56a9 in pp_getline () at asm/preproc.c:5166 #4  0x0000000000427f52 in assemble_file (warning: Unmapped DWARF Register #-1 encountered.   Credits:  This vulnerability is detected by team OWL337, with our custom fuzzer collAFL. Please contact ganshuitao@gmail.com   and chaoz@tsinghua.edu.cn if you need more info about the team, the tool or the vulnerability. ```  [Comment 1](show_bug.cgi?id=3392414#c1)  owl337    2017-07-04 02:06:00 PDT  ``` Created [attachment 411595](attachment.cgi?id=411595 "four poc") [[details]](attachment.cgi?id=411595&action=edit "four poc") four poc ```  [Comment 2](show_bug.cgi?id=3392414#c2)  amajer    2017-07-25 05:57:53 PDT  ``` Created [attachment 411598](attachment.cgi?id=411598&action=diff "t->text is not always overwritten but always freed.") [[details]](attachment.cgi?id=411598&action=edit "t->text is not always overwritten but always freed.") t->text is not always overwritten but always freed. ```  [Comment 3](show_bug.cgi?id=3392414#c3)  amajer    2017-07-25 06:00:46 PDT  ``` Created [attachment 411599](attachment.cgi?id=411599&action=diff "workaround to usage-after-free") [[details]](attachment.cgi?id=411599&action=edit "workaround to usage-after-free") workaround to usage-after-free  The fix in this patch is not to free the mmacro as it seems it can continue to be used later. This leads to a small memory leak, but the usage-after-free condition is removed.  I didn't look more carefully into fixing this piece of code as there is already a TODO: to fix it ;)  Is this small memory leak acceptable, or should this be fixed another way? ```  [Comment 4](show_bug.cgi?id=3392414#c4)  Cyrill Gorcunov    2017-07-25 06:31:45 PDT  ``` I believe small leak is acceptable, we need to revisit the code and fix the macro reuse. Thanks a huge for the fix.  commit 736be08cf3ec4d1da31f350359feb8c1c782de9a Author: Adam Majer <amajer@suse.de> Date:   Tue Jul 25 10:42:01 2017 +0200      preproc: Workaround a usage after free bug          In some circumstantes this free is incorrect resulting     in usage after-free. Workaround it by not freeing memory     here.          [https://bugzilla.nasm.us/show_bug.cgi?id=3392414](show_bug.cgi?id=3392414 "CLOSED FIXED - Multiple use after free vulnerabilities in the Nasm tool with latest vesion")          gorcunov@:      - slightly tuneup the comment          Signed-off-by: Adam Majer <amajer@suse.de>     Signed-off-by: Cyrill Gorcunov <gorcunov@gmail.com> ```  [Comment 5](show_bug.cgi?id=3392414#c5)  Cyrill Gorcunov    2017-07-25 18:22:13 PDT  ``` commit b6a173fad54f25f6e1cb0c3eaf230ac11fb6a070 Author: Cyrill Gorcunov <gorcunov@gmail.com> Date:   Wed Jul 26 01:21:16 2017 +0300      preproc: Free token's text if only it has been modified          [https://bugzilla.nasm.us/show_bug.cgi?id=3392414](show_bug.cgi?id=3392414 "CLOSED FIXED - Multiple use after free vulnerabilities in the Nasm tool with latest vesion")          Signed-off-by: Cyrill Gorcunov <gorcunov@gmail.com> ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3392414)
* - [XML](show_bug.cgi?ctype=xml&id=3392414)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3392414)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](docs/en/html/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=3392414&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=3392414&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from usn.ubuntu.com_b66b23f5_20250125_043141.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3694-1: NASM vulnerabilities

28 June 2018

NASM could be made to crash or run programs if it opened a specially
crafted file.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [nasm](/security/cves?package=nasm) - General-purpose x86 assembler

## Details

It was discovered that NASM incorrectly handled certain source files. If a

user or automated system were tricked into processing a specially crafted

source file, a remote attacker could use these issues to cause NASM to

crash, resulting in a denial of service, or possibly execute arbitrary

code.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 14.04

* [nasm](https://launchpad.net/ubuntu/%2Bsource/nasm)
  -
  [2.10.09-1ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/nasm/2.10.09-1ubuntu0.1)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2017-10686](/security/CVE-2017-10686)
* [CVE-2017-11111](/security/CVE-2017-11111)
* [CVE-2017-14228](/security/CVE-2017-14228)
* [CVE-2017-17810](/security/CVE-2017-17810)
* [CVE-2017-17811](/security/CVE-2017-17811)
* [CVE-2017-17812](/security/CVE-2017-17812)
* [CVE-2017-17813](/security/CVE-2017-17813)
* [CVE-2017-17814](/security/CVE-2017-17814)
* [CVE-2017-17815](/security/CVE-2017-17815)
* [CVE-2017-17816](/security/CVE-2017-17816)
* [CVE-2017-17817](/security/CVE-2017-17817)
* [CVE-2017-17818](/security/CVE-2017-17818)
* [CVE-2017-17819](/security/CVE-2017-17819)
* [CVE-2017-17820](/security/CVE-2017-17820)
* [CVE-2018-8881](/security/CVE-2018-8881)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


