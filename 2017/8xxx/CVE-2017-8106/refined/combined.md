=== Content from launchpad.net_176c806f_20250126_042033.html ===

[Log in / Register](https://launchpad.net/~tyhicks/%2Blogin)

[![](https://launchpadlibrarian.net/83129119/tyhicks-small.png)](https://launchpad.net/~tyhicks)

## [Tyler Hicks](https://launchpad.net/~tyhicks)

* Overview
* [Code](https://code.launchpad.net/~tyhicks)
* [Bugs](https://bugs.launchpad.net/~tyhicks)
* [Blueprints](https://blueprints.launchpad.net/~tyhicks)
* [Translations](https://translations.launchpad.net/~tyhicks)
* [Answers](https://answers.launchpad.net/~tyhicks)

* [Related packages](https://launchpad.net/~tyhicks/%2Brelated-packages)
* [Related projects](https://launchpad.net/~tyhicks/%2Brelated-projects)

## User information

Launchpad Id:
tyhicks

Email:
[Log in](%2Blogin) for email information.

Member since:
2008-10-03

[![Icon of AppArmor Developers](https://launchpadlibrarian.net/65472736/toxie-14.png "Member of AppArmor Developers")](/~apparmor-dev)
[![Icon of Bluetooth](https://launchpadlibrarian.net/4683649/stock_bluetooth.png "Member of Bluetooth")](/~bluetooth)
[![Icon of eCryptfs](https://launchpadlibrarian.net/88108046/ecryptfs_14.png "Member of eCryptfs")](/~ecryptfs)
[![Icon of Edubuntu Developers](https://launchpadlibrarian.net/71879383/edubuntu-logo-only_14.png "Member of Edubuntu Developers")](/~edubuntu-dev)
[![Icon of GNOME3 Team](https://launchpadlibrarian.net/235731434/roundel14.png "Member of GNOME3 Team")](/~gnome3-team)
[![Icon of Indicator Applet Developers](https://launchpadlibrarian.net/22816053/add-notification-applet.14.png "Member of Indicator Applet Developers")](/~indicator-applet-developers)
[![Icon of Kubuntu Ninjas - Yellow belts](https://launchpadlibrarian.net/192173133/belt2-yellow3.png "Member of Kubuntu Ninjas - Yellow belts")](/~kubuntu-ninjas-yellow-belts)
[![Icon of Kubuntu Ninjas](https://launchpadlibrarian.net/31496145/icon.png "Member of Kubuntu Ninjas")](/~kubuntu-ninjas)
[![Icon of Kubuntu Package Archives](https://launchpadlibrarian.net/44411915/deb-small.png "Member of Kubuntu Package Archives")](/~kubuntu-ppa)
[![Icon of Lubuntu Code](https://launchpadlibrarian.net/704307155/lennyborg_14.png "Member of Lubuntu Code")](/~lubuntu-code)
[![Icon of Lubuntu Continuous Integration](https://launchpadlibrarian.net/704307325/lennyborg_14.png "Member of Lubuntu Continuous Integration")](/~lubuntu-ci)
[![Icon of Lubuntu Developers](https://launchpadlibrarian.net/704306355/lennyborg_14.png "Member of Lubuntu Developers")](/~lubuntu-dev)
[![Icon of Lubuntu Packages Team](https://launchpadlibrarian.net/704305879/lenny_bug_14.png "Member of Lubuntu Packages Team")](/~lubuntu-packaging)
[![Icon of Lubuntu](https://launchpadlibrarian.net/357050187/14.png "Member of Lubuntu")](/~lubuntu-desktop)
[![Icon of MOTU](https://launchpadlibrarian.net/1516491/motu-image-2.png "Member of MOTU")](/~motu)
[![Icon of Network-manager](https://launchpadlibrarian.net/11610188/nm-team.png "Member of Network-manager")](/~network-manager)
[![Icon of Super Friends](https://launchpadlibrarian.net/134634591/superman14.png "Member of Super Friends")](/~super-friends)
[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)
[![Icon of Ubuntu Contributing Developers](https://launchpadlibrarian.net/17290192/wrench_emblem-trans.png "Member of Ubuntu Contributing Developers")](/~ubuntu-developer-members)
[![Icon of Ubuntu Core Development Team](https://launchpadlibrarian.net/1072365/main.png "Member of Ubuntu Core Development Team")](/~ubuntu-core-dev)
[![Icon of Ubuntu Development Team](https://launchpadlibrarian.net/1072363/motu.png "Member of Ubuntu Development Team")](/~ubuntu-dev)
[![Icon of Ubuntu Documentation Project Team](https://launchpadlibrarian.net/162165522/ubuntu-doc.png "Member of Ubuntu Documentation Project Team")](/~ubuntu-doc)
[![Icon of Ubuntu GNOME Developers](https://launchpadlibrarian.net/254356645/roundel14.png "Member of Ubuntu GNOME Developers")](/~ubuntu-gnome-dev)
[![Icon of Ubuntu GNOME](https://launchpadlibrarian.net/258611022/ubuntu-gnome_14.png "Member of Ubuntu GNOME")](/~ubuntu-gnome)
[![Icon of Ubuntu Kylin Members](https://launchpadlibrarian.net/444398797/623185830.jpg "Member of Ubuntu Kylin Members")](/~ubuntukylin-members)
[![Icon of Ubuntu MATE Developers](https://launchpadlibrarian.net/212349832/icon.png "Member of Ubuntu MATE Developers")](/~ubuntu-mate-dev)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Studio Development](https://launchpadlibrarian.net/479050820/14.png "Member of Ubuntu Studio Development")](/~ubuntustudio-dev)
[![Icon of Xubuntu Artwork](https://launchpadlibrarian.net/341831649/icon_optimized_14.png "Member of Xubuntu Artwork")](/~xubuntu-art)
[![Icon of Xubuntu Developers](https://launchpadlibrarian.net/139019912/x-dev.png "Member of Xubuntu Developers")](/~xubuntu-dev)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

CE1D6FE48F85F246C77C3516AD3F818B34FA35B7

SSH keys:

[tyhicks@elm - Canonical](%2Bsshkeys)

[tyhicks@sec - Canonical](%2Bsshkeys)

[tyhicks@boyd - Canonical](%2Bsshkeys)

Time zone:

America/Chicago
(UTC-0600)

Karma:
[0](https://launchpad.net/~tyhicks/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**tyhicks**
 on
**irc.oftc.net**

![IRC](/@@/social-irc "IRC")
**tyhicks**
 on
**irc.libera.chat**

## [All bugs in progress](https://launchpad.net/~tyhicks/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1379536 [Coarse-grained kernel keyring mediation](https://bugs.launchpad.net/apparmor/%2Bbug/1379536) |  |
| --- | --- | --- |
| in [AppArmor](/apparmor), [Ubuntu](/ubuntu) | | |

| --- | --- | --- | --- | --- | --- |
||  | #842647 [[git] file blocks duplicated at the end of the file](https://bugs.launchpad.net/ecryptfs/%2Bbug/842647) |  |
| --- | --- | --- |
| in [eCryptfs](/ecryptfs), [Ubuntu](/ubuntu) | | |

||  | #1501913 [Apparmor Abstraction Prevents Firefox From Opening Torrents in Deluge-Gtk](https://bugs.launchpad.net/apparmor/%2Bbug/1501913) |  |
| --- | --- | --- |
| in [AppArmor](/apparmor), [Ubuntu](/ubuntu) | | |

||  | #1439849 [BUG: unable to handle kernel NULL pointer dereference at 0000000000000010](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1439849) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

## [All assigned blueprints](/~tyhicks/%2Bspecs?role=assignee) Assigned blueprints

| **[User data encryption requirements and work for 14.04](https://blueprints.launchpad.net/ubuntu/%2Bspec/client-1311-user-data-encryption "client-1311-user-data-encryption")** for **Ubuntu**  Ubuntu Desktop currently offer both encrypted disk and encrypted home as part of the install. Ubuntu Touch should also offer a user data encryption option for its users. | |
| --- | --- |
| **[Application Confinement (Online Accounts)](https://blueprints.launchpad.net/ubuntu/%2Bspec/security-r-app-online-accounts "security-r-app-online-accounts")** for **Ubuntu**  Acceptance criteria for July: Goal: Developers can integrate AppArmor into online accounts Acceptance criteria for August: Goal: Users receive a contextual runtime prompt when an app uses online accounts | |
| **[eCryptfs status and future](https://blueprints.launchpad.net/ubuntu/%2Bspec/security-p-ecryptfs "security-p-ecryptfs")** for **Ubuntu**  This session is about discussing the current status and issues with eCryptfs, and making a decision what needs to be done in order for it to be an appropriate install-time option in the LTS release. | |

## Personal package archives

| [AppArmor-mediated DBus prototype](/~tyhicks/%2Barchive/ubuntu/aadbus) |
| --- |
| [PPA named ecryptfs-utils-daily for Tyler Hicks](/~tyhicks/%2Barchive/ubuntu/ecryptfs-utils-daily) |
| [Testing PPA](/~tyhicks/%2Barchive/ubuntu/testing) |

* [View snap packages](https://launchpad.net/~tyhicks/%2Bsnaps)

## [All memberships](https://launchpad.net/~tyhicks/%2Bparticipation) Latest memberships

| [Ubuntu cloaked people on Libera](/~ubuntu-irc-cloaks)  Joined on 2021-05-24 | |
| --- | --- |
| [Ubuntu SSO 2-factor testers](/~sso-2f-testers)  Joined on 2020-02-20 | |
| [Ubuntu Core Development Team](/~ubuntu-core-dev)  Joined on 2016-02-29 | |
| [AppArmor Developers](/~apparmor-dev)  Joined on 2012-11-07 | |
| [eCryptfs](/~ecryptfs)  Joined on 2008-11-11 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from cveform.mitre.org_c3616b63_20250126_042031.html ===


[![CVE logo](Content/cveLogoR.svg)](https://cve.org/)

[CVE Records
![CVE Record search](Content/search_icon.png)](https://cve.mitre.org/cve/search_cve_list.html)

[Search CVE Records](https://cve.mitre.org/cve/search_cve_list.html)

## Submit a CVE Request

\* Required

![errors](Content/exclamation.jpg)

\* Select a request type

- Please choose an action -
Report Vulnerability/Request CVE ID
Notify CVE about a publication
Request an update to an existing CVE Entry
Request information on the CVE Numbering Authority (CNA) Program
Other

![errors](Content/exclamation.jpg)

\* Enter your e-mail address

![alert](Content/info.jpg)

IMPORTANT: Please add cve-request@mitre.org and cve@mitre.org as
safe senders in your email client before completing this form.

Enter a PGP Key (to encrypt)

Processing....

#### Legal

* [Terms of Use](https://cve.org/Legal/TermsOfUse)
* [Privacy Policy](https://cve.org/Legal/PrivacyPolicy)

#### Media

* [News](https://cve.org/Media/News)
* [Events](https://cve.org/Media/Events)
* [Sign up for e-newsletter](https://cve.mitre.org/news/newsletter.html)

##### Social Media

[github

![](Content/github.png)](https://github.com/CVEProject)
[linkedin

![](Content/linkedin.png)](https://www.linkedin.com/showcase/cve-cwe-capec)
[youtube

![](Content/youtube.png)](https://www.youtube.com/channel/UCUHd2XFDsKH8kjMZQaSKpDQ/)
[twitter for CVE New

![](Content/twitter.png)
New CVE Records](https://twitter.com/CVEnew/)
[twitter for CVE announce

![](Content/twitter.png)
 CVE Announce](https://twitter.com/CVEannounce/)

#### Contact

* [CVE Program Support](https://cveform.mitre.org)
* [CNA](https://cve.org/PartnerInformation/ListofPartners)
* [CVE Website Support](https://cveform.mitre.org)

Use of the CVE® List and the associated references from this website are subject to the
[terms of use](https://cve.org/Legal/TermsOfUse). CVE is sponsored by the
[U.S. Department of Homeland Security (DHS)](https://www.dhs.gov/)
 [Cybersecurity and Infrastructure Security Agency (CISA)](https://www.dhs.gov/cisa/cybersecurity-division/). Copyright © 1999-2023,
[The MITRE Corporation](https://www.mitre.org/). CVE and the CVE logo are registered trademarks of The MITRE Corporation.

×
#### Vulnerability Information

Vulnerability Type

CWE-ID

Definition

Buffer Overflow

[CWE-119](http://cwe.mitre.org/data/definitions/119.html)

The software performs operations on a memory buffer, but it can read from or write to a memory location that is outside of the intended boundary of the buffer.

Cross Site Scripting (XSS)

[CWE-79](http://cwe.mitre.org/data/definitions/79.html)

The software does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.

SQL Injection

[CWE-89](http://cwe.mitre.org/data/definitions/89.html)

The software constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component.

Directory Traversal

[CWE-22](http://cwe.mitre.org/data/definitions/22.html)

The software uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the software does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.

XML External Entity (XXE)

[CWE-611](http://cwe.mitre.org/data/definitions/611.html)

The software processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.

Insecure Permissions

[CWE-276](http://cwe.mitre.org/data/definitions/276.html)

The software, upon installation, sets incorrect permissions for an object that exposes it to an unintended actor.

Incorrect Access Control

[CWE-284](http://cwe.mitre.org/data/definitions/284.html)

The software does not restrict or incorrectly restricts access to a resource from an unauthorized actor.

Integer Overflow

[CWE-190](http://cwe.mitre.org/data/definitions/190.html)

The software performs a calculation that can produce an integer overflow or wraparound, when the logic assumes that the resulting value will always be larger than the original value. This can introduce other weaknesses when the calculation is used for resource management or execution control.

Cross Site Request Forgery (CSRF)

[CWE-352](http://cwe.mitre.org/data/definitions/352.html)

The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.

Missing SSL certification verification

[CWE-599](http://cwe.mitre.org/data/definitions/599.html)

The software uses OpenSSL and trusts or uses a certificate without using the SSL\_get\_verify\_result() function to ensure that the certificate satisfies all necessary security requirements.

Other or Unknown

N/A

The software contains a mistake other than above which can be directly used by a hacker to gain access to a system or network.

×
#### Other Vulnerability Information

You can find more information at [cwe.mitre.org](http://cwe.mitre.org)

* Algorithm complexity
* Array index error
* Auth bypass using cookie
* Buffer Overflow
* Cross-Site Request Forgery (CSRF)
* Cross-Site Scripting (XSS)
* Directory Traversal
* Double free
* Eval injection
* File Upload
* Format String
* HTTP Response Splitting

* HTTP Request Splitting
* Incomplete blacklist
* Integer Overflow
* Integer Signedness
* Memory Leak
* Shell Metacharacter Injectoin
* Open Redirect
* Redirect without Exit
* Path Disclosure
* Insecure Permissions
* PHP remote file inclusion
* Session Fixation

* SQL Injection
* Symbolic Link Following
* Untrusted Search Path
* Unquoted Windows search path
* Use after free
* Default user/password
* Large or infinite loop
* Exposed insecure/unsafe method in ActiveX control
* Generation of insufficiently random numbers
* XML Extneral Entity (XXE)
* Incorrect Access Control
* Missing SSL certificate validation

×
#### Vulnerability Information

Attack Type

Definition

Remote

The vulnerability can be exploited through a network. The attacker may be either on the adjacent or remote network.

Local

To exploit the vulnerability, the attacker needs to be logged into the operating system on a local machine or a guest operating system.

Physical

The attacker needs to be located near the victim or have physical access to the vulnerable system to exploit the vulnerability. Examples include touching a workstation keyboard or USB device, "shoulder surfing" to see a workstation's display, and touching the screen of a mobile device.

Context-dependent

The type of access needed to exploit the vulnerability is dependent on how the vulnerable product is used. This is most often used for libraries.

×
#### Vulnerability Information

Update Type

Definition

Duplicate

More than one CVE ID has been assigned to a single vulnerability.

Rejection

Vendor rejects the assignment of a particular CVE ID.

Split/Merge

A single CVE Entry should be split into two or more CVE Entries OR Two or more existing CVE Entries should be merged into a single CVE Entry.

Update Description

Update the description in an existing CVE Entry.

Update References

Add, remove, or change a reference for an existing CVE Entry.

Other

Any request related to an existing CVE Entry that does not fall within one of the other categories.



=== Content from bugzilla.kernel.org_cdad9bd0_20250124_230737.html ===


Kernel.org Bugzilla – Bug 195167
INVEPT might crash the host
Last modified: 2017-04-24 22:12:53 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/latest/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=195167&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](createaccount.cgi?request_new_password=1)
  Login:

  [x]

[**Bug 195167**](show_bug.cgi?id=195167)
- INVEPT might crash the host

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
INVEPT might crash the host

| | [Status](page.cgi?id=fields.html#bug_status): | NEW | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Virtualization | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Virtualization "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | kvm ([show other bugs](buglist.cgi?component=kvm&product=Virtualization&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86-64 Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P1 normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | virtualization\_kvm | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-03-31 02:30 UTC by minoura makoto | | --- | --- | | Modified: | 2017-04-24 22:12 UTC ([History](show_activity.cgi?id=195167)) | | CC List: | 1 user (show)  code | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Kernel Version:](page.cgi?id=fields.html#cf_kernel_version "A custom Free Text field in this installation of Bugzilla.") | 3.11 - 3.14 | | [Subsystem:](page.cgi?id=fields.html#cf_subsystem "The subsystem responsible for this bug (must match MAINTAINERS entry verbatim)") |  | | [Regression:](page.cgi?id=fields.html#cf_regression "A custom Drop Down field in this installation of Bugzilla.") | No | | [Bisected commit-id:](page.cgi?id=fields.html#cf_bisect_commit "Full commit-id of the commit that introduced this regression.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**build and insmod'ing the module on a guest linux crashes the host**](attachment.cgi?id=255653 "View the content of the attachment") (3.24 KB, text/plain)  [2017-03-31 02:30 UTC](#attach_255653 "Go to the comment associated with the attachment"), minoura makoto | [Details](attachment.cgi?id=255653&action=edit) | | [Add an attachment](attachment.cgi?bugid=195167&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=195167#c0)  minoura makoto    2017-03-31 02:30:17 UTC  ``` Created [attachment 255653](attachment.cgi?id=255653 "build and insmod'ing the module on a guest linux crashes the host") [[details]](attachment.cgi?id=255653&action=edit "build and insmod'ing the module on a guest linux crashes the host") build and insmod'ing the module on a guest linux crashes the host  KVM in linux 3.11 - 3.14 (including long term supported 3.12.72) has a flaw in INVEPT emulation that could crash the host.  [ 1046.384746] BUG: unable to handle kernel NULL pointer dereference at 0000000000000070 [ 1046.387386] IP: [<ffffffffa05b3ca3>] handle_invept+0x123/0x170 [kvm_intel] [ 1046.389577] PGD 0  [ 1046.390273] Oops: 0000 [#1] SMP   (tested with Ubuntu 14.04 linux-image-3.13.0-113-generic)  The host KVM touches NULL pointer (vmx->nested.current_vmcs12) when a (crafted or buggy) guest issues a single-context INVEPT instruction *without* VMPTRLD like this:  	kvm_cpu_vmxon(phys_addr); 	ept_sync_context(0);  (requires nested EPT; full PoC module code attached)  This flaw was introduced in commit bfd0a56b90005f8c8a004baf407ad90045c2b11e (nEPT: Nested INVEPT) and removed in 4b855078601fc422dbac3059f2215e776f49780f (KVM: nVMX: Don't advertise single context invalidation for invept). Therefore there should be two ways to fix this.  a. pullup bfd0a56b90005f (and 45e11817d5703e) b. check current_vmcs12 before accessing for minimal fix:  diff --git a/arch/x86/kvm/vmx.c b/arch/x86/kvm/vmx.c index d9e567f..d785e9c 100644 --- a/arch/x86/kvm/vmx.c +++ b/arch/x86/kvm/vmx.c @@ -6391,6 +6391,8 @@ static int handle_invept(struct kvm_vcpu *vcpu)    	switch (type) {  	case VMX_EPT_EXTENT_CONTEXT: +		if (to_vmx(vcpu)->nested.current_vmptr == -1ull) +			break;  		if ((operand.eptp & eptp_mask) !=  				(nested_ept_get_cr3(vcpu) & eptp_mask))  			break; ```  [Comment 1](show_bug.cgi?id=195167#c1)  Tyler Hicks    2017-04-24 20:45:17 UTC  ``` I've requested a CVE for this issue via <https://cveform.mitre.org/> ```  [Comment 2](show_bug.cgi?id=195167#c2)  Tyler Hicks    2017-04-24 22:12:53 UTC  ``` MITRE has assigned CVE-2017-8106 to this issue. ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=195167&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=195167)
* - [XML](show_bug.cgi?ctype=xml&id=195167)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=195167)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/latest/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=195167&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](createaccount.cgi?request_new_password=1)
    Login:

    [x]



=== Content from launchpad.net_db7b56d3_20250124_230739.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1678676/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[linux package](https://launchpad.net/ubuntu/%2Bsource/linux)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/linux)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/linux)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/linux)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/linux)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/linux)

# linux\_3.13.0-\*.\*: nVMX: Check current\_vmcs12 before accessing in handle\_invept()

Bug #1678676 reported by
[minoura](https://launchpad.net/~minoura-valinux)
on 2017-04-02

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [linux (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/linux "Latest release: 5.4.0-207.227, uploaded to main on 2025-01-21 03:36:11.159826+00:00 by Mehmet Basaran (mehmetbasaran), maintained by Ubuntu Kernel Team (kernel-team)") | Invalid | High | Unassigned |  |
|  | [Trusty](https://bugs.launchpad.net/ubuntu/trusty/%2Bsource/linux) | Fix Released | High | Unassigned |  |

### Bug Description

KVM in linux 3.11 - 3.14 (including ubuntu 14.04 linux <= 3.13.0-113.160) has a

flaw in INVEPT emulation that could crash the host.

[ 1046.384746] BUG: unable to handle kernel NULL pointer dereference at 0000000000000070

[ 1046.387386] IP: [<ffffffffa05b3ca3>] handle\_invept+0x123/0x170 [kvm\_intel]

[ 1046.389577] PGD 0

[ 1046.390273] Oops: 0000 [#1] SMP

(tested with Ubuntu 14.04 linux-image-3.13.0-113-generic)

The host KVM touches NULL pointer (vmx->nested.current\_vmcs12) when a

(crafted or buggy) guest issues a single-context INVEPT instruction

\*without\* VMPTRLD like this:

kvm\_cpu\_vmxon(phys\_addr);

 ept\_sync\_context(0);

(requires nested EPT; full linux kernel module code attached)

This code is introduced in upstream commit bfd0a56b90005f8c8a004baf407ad90045c2b11e

(nEPT: Nested INVEPT) and removed in 4b855078601fc422dbac3059f2215e776f49780f

(KVM: nVMX: Don't advertise single context invalidation for invept).

Therefore there should be two ways to fix this.

a. pullup bfd0a56b90005f (and 45e11817d5703e)

b. check current\_vmcs12 before accessing for minimal fix:

diff --git a/arch/x86/kvm/vmx.c b/arch/x86/kvm/vmx.c

index d9e567f..d785e9c 100644

--- a/arch/x86/kvm/vmx.c

+++ b/arch/x86/kvm/vmx.c

@@ -6391,6 +6391,8 @@ static int handle\_invept(struct kvm\_vcpu \*vcpu)

switch (type) {

  case VMX\_EPT\_EXTENT\_CONTEXT:

+ if (to\_vmx(vcpu)->nested.current\_vmptr == -1ull)

+ break;

   if ((operand.eptp & eptp\_mask) !=

     (nested\_ept\_get\_cr3(vcpu) & eptp\_mask))

    break;

Tags:

[verification-done-trusty](/ubuntu/%2Bsource/linux/%2Bbugs?field.tag=verification-done-trusty)

## CVE References

* [2016-8645](/bugs/cve/2016-8645 "The TCP stack in the Linux kernel bef...")
* [2017-8106](/bugs/cve/2017-8106 "The handle_invept function in arch/x8...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [minoura (minoura-valinux)](https://launchpad.net/~minoura-valinux) wrote on 2017-04-02: |  |  | [#1](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/1) |
| --- | --- | --- | --- |

* [build and insmod'ing the module on a guest linux crashes the host](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1678676/%2Battachment/4853047/%2Bfiles/invept.c)
  [Edit](/ubuntu/%2Bsource/linux/%2Bbug/1678676/%2Battachment/4853047)
  (3.1 KiB,
  text/x-csrc)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-04-13: |  |  | [#2](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/2) |
| --- | --- | --- | --- |

Hello and thank you for the bug report!

I don't see an existing CVE assigned to this issue. CVE-2014-3645 affects a similar area of the kernel source but it has a different impact and is not the same issue.

We need a little bit of time to verify the report. Thank you for such a clear description.

Hello and thank you for the bug report!
I don't see an existing CVE assigned to this issue. CVE-2014-3645 affects a similar area of the kernel source but it has a different impact and is not the same issue.
We need a little bit of time to verify the report. Thank you for such a clear description.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-04-13: |  |  | [#3](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/3) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/3/%2Bdownload) (3.6 KiB)

I have verified the host kernel BUG using a 14.04 host and guest combination:

[11266.585362] BUG: unable to handle kernel NULL pointer dereference at 0000000000000070

[11266.585396] IP: [<ffffffffa0321ca3>] handle\_invept+0x123/0x170 [kvm\_intel]

[11266.585430] PGD 0

[11266.585436] Oops: 0000 [#1] SMP

[11266.585452] Modules linked in: vhost\_net vhost macvtap macvlan ipt\_MASQUERADE iptable\_nat nf\_nat\_ipv4 nf\_nat nf\_conntrack\_ipv4 nf\_defrag\_ipv4 xt\_conntrack nf\_conntrack ipt\_REJECT xt\_CHECKSUM iptable\_mangle xt\_tcpudp bridge stp llc ip6table\_filter ip6\_tables iptable\_filter ip\_tables ebtable\_nat ebtables x\_tables kvm\_intel snd\_hda\_intel snd\_hda\_codec snd\_hwdep snd\_pcm kvm snd\_page\_alloc crct10dif\_pclmul snd\_seq\_midi crc32\_pclmul snd\_seq\_midi\_event ghash\_clmulni\_intel snd\_rawmidi aesni\_intel aes\_x86\_64 lrw gf128mul snd\_seq glue\_helper qxl ablk\_helper cryptd snd\_seq\_device ttm snd\_timer drm\_kms\_helper drm snd serio\_raw rfcomm bnep bluetooth soundcore i2c\_piix4 mac\_hid parport\_pc ppdev lp parport psmouse pata\_acpi floppy [last unloaded: kvm\_intel]

[11266.585506] CPU: 0 PID: 14128 Comm: qemu-system-x86 Not tainted 3.13.0-116-generic #163-Ubuntu

[11266.585509] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Ubuntu-1.8.2-1ubuntu1 04/01/2014

[11266.585511] task: ffff88001d1dc800 ti: ffff88003d544000 task.ti: ffff88003d544000

[11266.585513] RIP: 0010:[<ffffffffa0321ca3>] [<ffffffffa0321ca3>] handle\_invept+0x123/0x170 [kvm\_intel]

[11266.585523] RSP: 0018:ffff88003d545cb0 EFLAGS: 00010246

[11266.585525] RAX: 0000000000000000 RBX: ffff88003cd38000 RCX: 0000000000000000

[11266.585527] RDX: 0007fffffffff000 RSI: 00007f522360dd18 RDI: ffff88003d545cd8

[11266.585528] RBP: ffff88003d545cf0 R08: 0000000000000000 R09: 0000000000000010

[11266.585529] R10: 0000000000000000 R11: ffff88001f60da1e R12: 0000000000000001

[11266.585531] R13: 000000001061c100 R14: ffff88001d1dc800 R15: ffff88003cd38030

[11266.585533] FS: 00007f523085f700(0000) GS:ffff88003fc00000(0000) knlGS:0000000000000000

[11266.585535] CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033

[11266.585536] CR2: 0000000000000070 CR3: 0000000036bb6000 CR4: 00000000001427f0

[11266.585545] Stack:

[11266.585547] ffff88001f60dd08 ffff88003d545cf0 ffffffffa031f7b6 0000000000000000

[11266.585550] 0000000000000000 ffff88003cd38000 0000000000000032 0000000000000000

[11266.585553] ffff88003d545d40 ffffffffa032347d ffffffffffffff10 ffffffff00000000

[11266.585556] Call Trace:

[11266.585571] [<ffffffffa031f7b6>] ? handle\_vmon+0x106/0x160 [kvm\_intel]

[11266.585577] [<ffffffffa032347d>] vmx\_handle\_exit+0xbd/0x8e0 [kvm\_intel]

[11266.585677] [<ffffffffa02230e5>] vcpu\_enter\_guest+0x8b5/0xd80 [kvm]

[11266.585684] [<ffffffffa031f0b8>] ? vmx\_deliver\_posted\_interrupt+0x38/0x90 [kvm\_intel]

[11266.585702] [<ffffffffa0242165>] ? kvm\_apic\_local\_deliver+0x65/0x70 [kvm]

[11266.585718] [<ffffffffa02275f8>] kvm\_arch\_vcpu\_ioctl\_run+0x1e8/0x460 [kvm]

[11266.585729] [<ffffffffa0210fe2>] kvm\_vcpu\_ioctl+0x2a2/0x600 [kvm]

[11266.585779] [<ffffffff810dcfd1>] ? futex\_wake+0x1b1/0x1d0

[11266.585794] [<ffffffff811d5ad0>] do\_vfs\_ioctl+0x2e0/0x4c0

[11266.585797] [<ffffffff811d5d31>] SyS\_ioctl+0x81/0xa0

[11266.585824] [<...

[Read more...](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/3)

I have verified the host kernel BUG using a 14.04 host and guest combination:
[11266.585362] BUG: unable to handle kernel NULL pointer dereference at 0000000000000070
[11266.585396] IP: [<ffffffffa0321ca3>] handle\_invept+0x123/0x170 [kvm\_intel]
[11266.585430] PGD 0
[11266.585436] Oops: 0000 [#1] SMP
[11266.585452] Modules linked in: vhost\_net vhost macvtap macvlan ipt\_MASQUERADE iptable\_nat nf\_nat\_ipv4 nf\_nat nf\_conntrack\_ipv4 nf\_defrag\_ipv4 xt\_conntrack nf\_conntrack ipt\_REJECT xt\_CHECKSUM iptable\_mangle xt\_tcpudp bridge stp llc ip6table\_filter ip6\_tables iptable\_filter ip\_tables ebtable\_nat ebtables x\_tables kvm\_intel snd\_hda\_intel snd\_hda\_codec snd\_hwdep snd\_pcm kvm snd\_page\_alloc crct10dif\_pclmul snd\_seq\_midi crc32\_pclmul snd\_seq\_midi\_event ghash\_clmulni\_intel snd\_rawmidi aesni\_intel aes\_x86\_64 lrw gf128mul snd\_seq glue\_helper qxl ablk\_helper cryptd snd\_seq\_device ttm snd\_timer drm\_kms\_helper drm snd serio\_raw rfcomm bnep bluetooth soundcore i2c\_piix4 mac\_hid parport\_pc ppdev lp parport psmouse pata\_acpi floppy [last unloaded: kvm\_intel]
[11266.585506] CPU: 0 PID: 14128 Comm: qemu-system-x86 Not tainted 3.13.0-116-generic #163-Ubuntu
[11266.585509] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Ubuntu-1.8.2-1ubuntu1 04/01/2014
[11266.585511] task: ffff88001d1dc800 ti: ffff88003d544000 task.ti: ffff88003d544000
[11266.585513] RIP: 0010:[<ffffffffa0321ca3>] [<ffffffffa0321ca3>] handle\_invept+0x123/0x170 [kvm\_intel]
[11266.585523] RSP: 0018:ffff88003d545cb0 EFLAGS: 00010246
[11266.585525] RAX: 0000000000000000 RBX: ffff88003cd38000 RCX: 0000000000000000
[11266.585527] RDX: 0007fffffffff000 RSI: 00007f522360dd18 RDI: ffff88003d545cd8
[11266.585528] RBP: ffff88003d545cf0 R08: 0000000000000000 R09: 0000000000000010
[11266.585529] R10: 0000000000000000 R11: ffff88001f60da1e R12: 0000000000000001
[11266.585531] R13: 000000001061c100 R14: ffff88001d1dc800 R15: ffff88003cd38030
[11266.585533] FS: 00007f523085f700(0000) GS:ffff88003fc00000(0000) knlGS:0000000000000000
[11266.585535] CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[11266.585536] CR2: 0000000000000070 CR3: 0000000036bb6000 CR4: 00000000001427f0
[11266.585545] Stack:
[11266.585547] ffff88001f60dd08 ffff88003d545cf0 ffffffffa031f7b6 0000000000000000
[11266.585550] 0000000000000000 ffff88003cd38000 0000000000000032 0000000000000000
[11266.585553] ffff88003d545d40 ffffffffa032347d ffffffffffffff10 ffffffff00000000
[11266.585556] Call Trace:
[11266.585571] [<ffffffffa031f7b6>] ? handle\_vmon+0x106/0x160 [kvm\_intel]
[11266.585577] [<ffffffffa032347d>] vmx\_handle\_exit+0xbd/0x8e0 [kvm\_intel]
[11266.585677] [<ffffffffa02230e5>] vcpu\_enter\_guest+0x8b5/0xd80 [kvm]
[11266.585684] [<ffffffffa031f0b8>] ? vmx\_deliver\_posted\_interrupt+0x38/0x90 [kvm\_intel]
[11266.585702] [<ffffffffa0242165>] ? kvm\_apic\_local\_deliver+0x65/0x70 [kvm]
[11266.585718] [<ffffffffa02275f8>] kvm\_arch\_vcpu\_ioctl\_run+0x1e8/0x460 [kvm]
[11266.585729] [<ffffffffa0210fe2>] kvm\_vcpu\_ioctl+0x2a2/0x600 [kvm]
[11266.585779] [<ffffffff810dcfd1>] ? futex\_wake+0x1b1/0x1d0
[11266.585794] [<ffffffff811d5ad0>] do\_vfs\_ioctl+0x2e0/0x4c0
[11266.585797] [<ffffffff811d5d31>] SyS\_ioctl+0x81/0xa0
[11266.585824] [<ffffffff8173de1d>] system\_call\_fastpath+0x1a/0x1f
[11266.585826] Code: 48 89 df be 1c 00 00 00 e8 db 8f ff ff 48 89 df e8 83 d4 ff ff e9 22 ff ff ff 48 8b 83 98 3e 00 00 48 ba 00 f0 ff ff ff ff 07 00 <48> 8b 40 70 48 33 45 d8 48 85 d0 75 18 48 89 df e8 98 ec f0 ff
[11266.585854] RIP [<ffffffffa0321ca3>] handle\_invept+0x123/0x170 [kvm\_intel]
[11266.585860] RSP <ffff88003d545cb0>
[11266.585861] CR2: 0000000000000070
[11266.585870] ---[ end trace 6a783f3041a996d7 ]---

| Changed in linux (Ubuntu): | |
| --- | --- |
| **status**: | New → Confirmed |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [minoura (minoura-valinux)](https://launchpad.net/~minoura-valinux) wrote on 2017-04-13: |  |  | [#4](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/4) |
| --- | --- | --- | --- |

Thanks for confirmation.

> I don't see an existing CVE assigned to this issue. CVE-2014-3645 affects a similar area of the kernel source but > it has a different impact and is not the same issue.

Yeah, probably we've found this problem for the first time (as long as I've searched through the git.kernel.org) and I have no idea about reporting it to some security authority (CERT/CC? or something??) by myself.

Thanks for confirmation.
> I don't see an existing CVE assigned to this issue. CVE-2014-3645 affects a similar area of the kernel source but > it has a different impact and is not the same issue.
Yeah, probably we've found this problem for the first time (as long as I've searched through the git.kernel.org) and I have no idea about reporting it to some security authority (CERT/CC? or something??) by myself.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-04-13: |  |  | [#5](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/5) |
| --- | --- | --- | --- |

I can request the CVE and coordinate with other Linux distributions but I'd like the kernel team to verify the fix before I do that.

I can request the CVE and coordinate with other Linux distributions but I'd like the kernel team to verify the fix before I do that.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [minoura (minoura-valinux)](https://launchpad.net/~minoura-valinux) wrote on 2017-04-13: |  |  | [#6](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/6) |
| --- | --- | --- | --- |

That's what I expected. Thanks.

That's what I expected. Thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-04-21: |  |  | [#7](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/7) |
| --- | --- | --- | --- |

Hi minoura - I was able to verify that your proposed fix does prevent the NULL pointer exception. I had a question about the fix as I'm not very familiar with the code in vmx.c. Should we also check if to\_vmx(vcpu)->nested.current\_vmcs12 is NULL and, if so, break? I'm not clear if current\_vmptr and current\_vmcs12 are always guaranteed to have corresponding values.

Hi minoura - I was able to verify that your proposed fix does prevent the NULL pointer exception. I had a question about the fix as I'm not very familiar with the code in vmx.c. Should we also check if to\_vmx(vcpu)->nested.current\_vmcs12 is NULL and, if so, break? I'm not clear if current\_vmptr and current\_vmcs12 are always guaranteed to have corresponding values.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-04-21: |  |  | [#8](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/8) |
| --- | --- | --- | --- |

It looks to me that both variables are updated in lock-step. Also, I see that nested\_vmx\_failValid() and nested\_vmx\_check\_vmcs12() both only check current\_vmptr so perhaps that is sufficient.

It looks to me that both variables are updated in lock-step. Also, I see that nested\_vmx\_failValid() and nested\_vmx\_check\_vmcs12() both only check current\_vmptr so perhaps that is sufficient.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [minoura (minoura-valinux)](https://launchpad.net/~minoura-valinux) wrote on 2017-04-24: |  |  | [#9](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/9) |
| --- | --- | --- | --- |

Yeah, actually I copied it from the other parts in vmx.c, such as nested\_vmx\_check\_vmcs12, called from handle\_vmwrite and others.

Yeah, actually I copied it from the other parts in vmx.c, such as nested\_vmx\_check\_vmcs12, called from handle\_vmwrite and others.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-04-24: |  |  | [#10](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/10) |
| --- | --- | --- | --- |

Thanks!

I'm making this bug public since all the details and PoC are already public here:

<https://bugzilla.kernel.org/show_bug.cgi?id=195167>

Thanks!
I'm making this bug public since all the details and PoC are already public here:
https://bugzilla.kernel.org/show\_bug.cgi?id=195167

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-04-24: |  |  | [#11](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/11) |
| --- | --- | --- | --- |

I think the original bug description is incorrect about which kernel versions are affected. It looks to me like the flaw was introduced in 3.12:

$ git describe --contains bfd0a56b90005f8c8a004baf407ad90045c2b11e

v3.12-rc1~143^2~30

It was fixed in 3.16:

$ git describe --contains 4b855078601fc422dbac3059f2215e776f49780f

v3.16-rc4~21^2^2~33

3.12 through 3.15 are affected. In Ubuntu, only Ubuntu 14.04 is affected.

I think the original bug description is incorrect about which kernel versions are affected. It looks to me like the flaw was introduced in 3.12:
$ git describe --contains bfd0a56b90005f8c8a004baf407ad90045c2b11e
v3.12-rc1~143^2~30
It was fixed in 3.16:
$ git describe --contains 4b855078601fc422dbac3059f2215e776f49780f
v3.16-rc4~21^2^2~33
3.12 through 3.15 are affected. In Ubuntu, only Ubuntu 14.04 is affected.

[Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks)
on 2017-04-24

| Changed in linux (Ubuntu Trusty): | |
| --- | --- |
| **status**: | New → Triaged |
| **importance**: | Undecided → High |
| Changed in linux (Ubuntu): | |
| **status**: | Confirmed → Invalid |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2017-04-24: |  |  | [#12](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/12) |
| --- | --- | --- | --- |

This is CVE-2017-8106.

This is CVE-2017-8106.

[Thadeu Lima de Souza Cascardo (cascardo)](https://launchpad.net/~cascardo)
on 2017-04-26

| Changed in linux (Ubuntu Trusty): | |
| --- | --- |
| **status**: | Triaged → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brad Figg (brad-figg)](https://launchpad.net/~brad-figg) wrote on 2017-05-10: |  |  | [#13](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/13) |
| --- | --- | --- | --- |

This bug is awaiting verification that the kernel in -proposed solves the problem. Please test the kernel and update this bug with the results. If the problem is solved, change the tag 'verification-needed-trusty' to 'verification-done-trusty'. If the problem still exists, change the tag 'verification-needed-trusty' to 'verification-failed-trusty'.

If verification is not done by 5 working days from today, this fix will be dropped from the source code, and this bug will be closed.

See <https://wiki.ubuntu.com/Testing/EnableProposed> for documentation how to enable and use -proposed. Thank you!

This bug is awaiting verification that the kernel in -proposed solves the problem. Please test the kernel and update this bug with the results. If the problem is solved, change the tag 'verification-needed-trusty' to 'verification-done-trusty'. If the problem still exists, change the tag 'verification-needed-trusty' to 'verification-failed-trusty'.
If verification is not done by 5 working days from today, this fix will be dropped from the source code, and this bug will be closed.
See https://wiki.ubuntu.com/Testing/EnableProposed for documentation how to enable and use -proposed. Thank you!

| **tags**: | added: verification-needed-trusty |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [minoura (minoura-valinux)](https://launchpad.net/~minoura-valinux) wrote on 2017-05-11: |  |  | [#14](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/14) |
| --- | --- | --- | --- |

Tested with linux-image-3.13.0-119-generic 3.13.0-119.166 and confirmed the problem disappeared. Thanks!

Tested with linux-image-3.13.0-119-generic 3.13.0-119.166 and confirmed the problem disappeared. Thanks!

| **tags**: | added: verification-done-trustyremoved: verification-needed-trusty |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2017-05-16: |  |  | [#15](/ubuntu/%2Bsource/linux/%2Bbug/1678676/comments/15) |
| --- | --- | --- | --- |

This bug was fixed in the package linux - 3.13.0-119.166

---------------

linux (3.13.0-119.166) trusty; urgency=low

\* linux: 3.13.0-119.166 -proposed tracker (LP: [#1687718](/bugs/1687718))

\* CVE-2016-8645: Linux kernel mishandles socket buffer (skb) truncation

    (LP: [#1687107](/bugs/1687107))

    - rose: limit sk\_filter trim to payload

    - tcp: take care of truncations done by sk\_filter()

linux (3.13.0-118.165) trusty; urgency=low

\* linux: 3.13.0-118.165 -proposed tracker (LP: [#1686154](/bugs/1686154))

\* linux\_3.13.0-\*.\*: nVMX: Check current\_vmcs12 before accessing in

    handle\_invept() (LP: [#1678676](/bugs/1678676))

    - SAUCE: KVM has a flaw in INVEPT emulation that could crash the host

\* Please backport fix to reference leak in cgroup blkio throttle

    (LP: [#1683976](/bugs/1683976))

    - block: fix module reference leak on put\_disk() call for cgroups throttle

-- Thadeu Lima de Souza Cascardo <email address hidden> Tue, 02 May 2017 15:14:50 -0300

This bug was fixed in the package linux - 3.13.0-119.166
---------------
linux (3.13.0-119.166) trusty; urgency=low
\* linux: 3.13.0-119.166 -proposed tracker (LP: #1687718)
\* CVE-2016-8645: Linux kernel mishandles socket buffer (skb) truncation
(LP: #1687107)
- rose: limit sk\_filter trim to payload
- tcp: take care of truncations done by sk\_filter()
linux (3.13.0-118.165) trusty; urgency=low
\* linux: 3.13.0-118.165 -proposed tracker (LP: #1686154)
\* linux\_3.13.0-\*.\*: nVMX: Check current\_vmcs12 before accessing in
handle\_invept() (LP: #1678676)
- SAUCE: KVM has a flaw in INVEPT emulation that could crash the host
\* Please backport fix to reference leak in cgroup blkio throttle
(LP: #1683976)
- block: fix module reference leak on put\_disk() call for cgroups throttle
-- Thadeu Lima de Souza Cascardo <cascardo@canonical.com> Tue, 02 May 2017 15:14:50 -0300

| Changed in linux (Ubuntu Trusty): | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |
| **status**: | Fix Committed → Fix Released |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1678676/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/linux/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/linux/%2Bbug/1678676/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1678676/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1678676/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [build and insmod'ing the module on a guest linux crashes the host](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1678676/%2Battachment/4853047/%2Bfiles/invept.c)
  [Edit](/ubuntu/%2Bsource/linux/%2Bbug/1678676/%2Battachment/4853047 "Change attachment details")

* [Add attachment](/ubuntu/%2Bsource/linux/%2Bbug/1678676/%2Baddcomment)

## Remote bug watches

* [linux-kernel-bugs #195167](https://bugzilla.kernel.org/show_bug.cgi?id=195167)
  [Edit](/bugs/1678676/%2Bwatch/124015 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_aa43ad7d_20250126_042032.html ===

[Log in / Register](https://launchpad.net/~cascardo/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~cascardo)

## [Thadeu Lima de Souza Cascardo](https://launchpad.net/~cascardo)

* Overview
* [Code](https://code.launchpad.net/~cascardo)
* [Bugs](https://bugs.launchpad.net/~cascardo)
* [Blueprints](https://blueprints.launchpad.net/~cascardo)
* [Translations](https://translations.launchpad.net/~cascardo)
* [Answers](https://answers.launchpad.net/~cascardo)

* [Related packages](https://launchpad.net/~cascardo/%2Brelated-packages)
* [Related projects](https://launchpad.net/~cascardo/%2Brelated-projects)

## User information

Launchpad Id:
cascardo

Email:
[Log in](%2Blogin) for email information.

Member since:
2005-10-13

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

279357DB6127376E6D1DF1BCAAD56799FBFD0D3E,
596FD83780E809843A6F3BD7D065F8D1B7FB9A3C

SSH keys:

[cascardo@calabresa](%2Bsshkeys)

[cascardo@calabresa](%2Bsshkeys)

Time zone:

America/Sao\_Paulo
(UTC-0300)

Karma:
[19](https://launchpad.net/~cascardo/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**cascardo**
 on
**FreeNode**

## [All bugs in progress](https://launchpad.net/~cascardo/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1800856 [allow kexec\_file of unsigned images under lockdown](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1800856) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

| --- | --- | --- | --- | --- | --- |
||  | #1800856 [allow kexec\_file of unsigned images under lockdown](https://bugs.launchpad.net/ubuntu/bionic/%2Bsource/linux/%2Bbug/1800856) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

||  | #1788603 [libvirt fails with failure to open mount namespace](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1788603) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu), [Debian](/debian) | | |

||  | #1892411 [Package perf-trace examples and include files](https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1892411) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

||  | #1985527 [xen blkfront leaks memory when disconnecting devices](https://bugs.launchpad.net/ubuntu/xenial/%2Bsource/linux/%2Bbug/1985527) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

## Personal package archives

| [kdump](/~cascardo/%2Barchive/ubuntu/kdump2) |
| --- |
| [linux packages](/~cascardo/%2Barchive/ubuntu/linux) |
| [no name](/~cascardo/%2Barchive/ubuntu/linux3) |
| [linux build test](/~cascardo/%2Barchive/ubuntu/ppa) |
| [random packages](/~cascardo/%2Barchive/ubuntu/ppa2) |
| [more random packages](/~cascardo/%2Barchive/ubuntu/ppa3) |

## Latest memberships

Thadeu Lima de Souza Cascardo is not an
active member of any Launchpad teams.

## [Recent activities](https://launchpad.net/~cascardo/%2Bkarma) Most active in

| [Ubuntu](/ubuntu) |  |  |
| --- | --- | --- |
| [Kernel SRU Workflow](/kernel-sru-workflow) |  |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


