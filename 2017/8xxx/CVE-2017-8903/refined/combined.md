=== Content from xenbits.xen.org_e0b750ec_20250124_161242.html ===

# Information

| Advisory | [XSA-213](advisory-213.html) |
| --- | --- |
| Public release | 2017-05-02 11:18 |
| Updated | 2017-05-12 10:44 |
| Version | 3 |
| CVE(s) | [CVE-2017-8903](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8903) |
| Title | x86: 64bit PV guest breakout via pagetable use-after-mode-change |

# Files

<advisory-213.txt> (signed advisory file)

<xsa213.patch>

<xsa213-4.5.patch>

<xsa213-4.6.patch>

<xsa213-4.7.patch>

<xsa213-4.8.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2017-8903 / XSA-213
                              version 3

   x86: 64bit PV guest breakout via pagetable use-after-mode-change

UPDATES IN VERSION 3
====================

CVE assigned.

ISSUE DESCRIPTION
=================

64-bit PV guests typically use separate (root) page tables for their
kernel and user modes.  Hypercalls are accessible to guest kernel
context only, which certain hypercall handlers make assumptions on.
The IRET hypercall (replacing the identically name CPU instruction)
is used by guest kernels to transfer control from kernel mode to user
mode.  If such an IRET hypercall is placed in the middle of a multicall
batch, subsequent operations invoked by the same multicall batch may
wrongly assume the guest to still be in kernel mode.  If one or more of
these subsequent operations involve operations on page tables, they may
be using the wrong root page table, confusing internal accounting.  As
a result the guest may gain writable access to some of its page tables.

IMPACT
======

A malicious or buggy 64-bit PV guest may be able to access all of
system memory, allowing for all of privilege escalation, host crashes,
and information leaks.

VULNERABLE SYSTEMS
==================

All 64-bit Xen versions are vulnerable.

Only x86 systems are affected.  ARM systems are not vulnerable.

The vulnerability is only exposed to 64-bit PV guests.  HVM guests and
32-bit PV guests can't exploit the vulnerability.

MITIGATION
==========

Running only HVM or 32-bit PV guests will avoid the vulnerability.

The vulnerability can be avoided if the guest kernel is controlled by
the host rather than guest administrator, provided that further steps
are taken to prevent the guest administrator from loading code into
the kernel (e.g. by disabling loadable modules etc) or from using
other mechanisms which allow them to run code at kernel privilege.

CREDITS
=======

This issue was discovered by Jann Horn of Google Project Zero.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa213.patch           xen-unstable
xsa213-4.8.patch       Xen 4.8.x
xsa213-4.7.patch       Xen 4.7.x
xsa213-4.6.patch       Xen 4.6.x
xsa213-4.5.patch       Xen 4.5.x

$ sha256sum xsa213*
[cddea5eac2ad1f5a68b561da4e98afce891189a2fdedf93087a03889e9df6e99  xsa213.patch](xsa213.patch)
[fce9bbc9fc30769dfbab4d1830d87d220000b2742e5e70aac22f3e9d013b7614  xsa213-4.5.patch](xsa213-4.5.patch)
[dce026ed1a02db1cf22de89120e7129839f656d041379c450e7403ae909e7b99  xsa213-4.6.patch](xsa213-4.6.patch)
[d8202db5981e2f13d9942332cd3fefded98a5cbc302caee431c7a15051887e7f  xsa213-4.7.patch](xsa213-4.7.patch)
[20c12810ac73809ba74cfde811d420b1b544a07f759c393380afde1a09eb5274  xsa213-4.8.patch](xsa213-4.8.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJZFZInAAoJEIP+FMlX6CvZq7YIAL4qV4jk+XHwuTSPp/3DyOgX
CSwDduXqwdeUTfc+1qn6yQFiDxOMVUUUq8Qq1j+x6QrcBocJ6qNJNXhHdExbJ9Aa
VPMkf1c+WbuoqOy5BHgnVkTLbCjUzDknQmDBJF4JjADsFpWaIzaXXmLG7GLwSaaf
XIYIRcqa51XYSA32E0nvn+AC5OQCx7Pt5jQwRnQFfWH4e79abbI/2jNci3Xe7vfa
TmUFlmTEZ3qZ5WNL0+vW4qF/fwwLya9E3IqtqBKYf5BmI369dC9tQs4ELleJ1mqi
pj+81RnpVMeQlmYkt+31zP1Hzn/zBdF19yDzpBmvRZJYrF/I6rd+8mYXa8k5H5g=
=KN3M
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team


=== Content from security.gentoo.org_af725ea4_20250124_161241.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple vulnerabilities — GLSA **201705-11**

Multiple vulnerabilities have been found in Xen, the worst of which
could allow for privilege escalation.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.7.2-r1** |
| Unaffected versions | >= **4.7.2-r1** |

| Package | **app-emulation/xen-tools** on all architectures |
| --- | --- |
| Affected versions | < **4.7.2** |
| Unaffected versions | >= **4.7.2** |

| Package | **app-emulation/xen-pvgrub** on all architectures |
| --- | --- |
| Affected versions | < **4.7.2** |
| Unaffected versions | >= **4.7.2** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the
CVE identifiers and Xen Security Advisory referenced below for details.

### Impact

A local attacker could potentially execute arbitrary code with
privileges of Xen (QEMU) process on the host, gain privileges on the host
system, or cause a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.7.2-r1:0"

```

All Xen Tools users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-tools-4.7.2:0"

```

All Xen pvgrub users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/xen-pvgrub-4.7.2:0"

```
### References

* [CVE-2017-8903](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-8903)
* [CVE-2017-8904](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-8904)
* [CVE-2017-8905](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-8905)

**Release date**

May 26, 2017

**Latest revision**

May 26, 2017: 1

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [615980](https://bugs.gentoo.org/show_bug.cgi?id=615980)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from blog.xenproject.org_6a5cbe17_20250124_161241.html ===

[![Xen-Project](/img/logo-xen-reverse.svg)](/)

[Announcements](https://xenproject.org/blog/tag/announcements/)
# Updates on XSA-213, XSA-214 and XSA-215

[![George Dunlap](https://secure.gravatar.com/avatar/50841f4f45055834ad0650abafac28cc?s=512&d=mm&r=g)](/blog/author/dunlapg/)

#### [George Dunlap](/blog/author/dunlapg/)

May 2, 2017
— 2 min read

Today we released three patches for the following vulnerabilities: XSA-213, XSA-214 and XSA-215. Xen Project follows industry-accepted best practices regarding software security. This includes observing an embargo period, during which time the Xen Project security team will assess, respond, and prepare patches fixing the vulnerability, and distribute them privately to software and cloud providers before the public disclosure occurs.

When issuing a Xen Project Security Advisory (XSA), during the embargo this advisory is pre-disclosed to only members on the [Xen Project Pre-Disclosure List](http://www.xenproject.org/security-policy.html?ref=xenproject.org). Vendors and open source projects who are on the Xen Project pre-disclosure list will not be affected by this security vulnerability and have updated their systems. The Xen Project security team has created fixes for these vulnerabilities, which can be publicly downloaded here: http://xenbits.xen.org/xsa/

Public cloud providers on the Xen Project predisclosure list were notified of these vulnerabilities two weeks ago; if your public cloud provider is on the list it is likely that your VMs are not vulnerable. Distributions and other software providers were also notified; they should have updated packages available soon (if they are not available already).

All three vulnerabilities have the potential to enable a guest virtual machine to break out of the hypervisor isolation. However, in order to exploit this vulnerability, an attacker would need to be running code in kernel mode of one or more VMs on the system. Any system that allows untrusted users to run arbitrary kernels will be particularly vulnerable.

Systems which only allow trusted users (such as IT professionals employed by the company) to run arbitrary kernels are less vulnerable, because an attacker would first need to find one or more exploit in the software running on one of the VMs before being able to then exploit this vulnerability. However, **all users are encouraged to update as soon as possible**.

Any 64-bit PV guest can exploit the vulnerability with XSA-213. The other two are more constrained. XSA-214 requires an attacker to control two different kinds of guests (either a PV one and an HVM one or a 32-bit PV one and 64-bit PV one). XSA-215 only affects you if your host has a very large amount of memory (either 3.5 TiB or 5 TiB depending on configuration).

Again, even with these constraints, we encourage you to update as soon as possible.

We take security very seriously and have developed [security process best practices](http://www.xenproject.org/security-policy.html?ref=xenproject.org) that are aimed for cloud environments that maximize fairness and transparency. We also have a very strict standard of review when it comes to new code being added to the Xen Project. We run Coverity static analyzer regularly to prevent certain classes of programming errors from being introduced. Additionally, we regularly run a generational fuzzing tool on our instruction emulator.

The Xen Project community developed Live Patching and introduced it into Xen Project 4.7. Now security fixes can be deployed without having to reboot VMs or have significant spare compute capacity to avoid reboots via VM migration.

These vulnerabilities were discovered by Jann Horn, from Google Project Zero.

## Read more

Welcome Honda to the Xen Project Board
12/09/2024

We're excited to announce our newest Advisory Board Member Honda, to Xen Project.
Since its foundation, Honda has been committed to "creating a society that is useful to people" by utilizing its technologies and ideas. Honda also focuses on environmental responsiveness and traffic safety, and continue

[Read more](/blog/welcome-honda-to-xen-project/)

Say hello to our new website
12/05/2024

Hello Xen Community,
You may have noticed something different...
We've refreshed our existing website!
Why did we do this?
Well, all these new changes are part of an ongoing effort to increase our visibility and make it easier to find information on pages. We know how important it

[Read more](/blog/say-hello-to-our-new-website/)

Xen Project Announces Performance and Security Advancements with Release of 4.19
08/05/2024

New release marks significant enhancements in performance, security, and versatility across various architectures.
SAN FRANCISCO – July 31st, 2024 – The Xen Project, an open source project under the Linux Foundation, is proud to announce the release of Xen Project 4.19. This release marks a significant milestone in enhancing performance, security,

[Read more](/blog/xen-project-announces-performance-and-security-advancements-with-release-of-4-19/)

Upcoming Closure of Xen Project Colo Facility
07/10/2024

Dear Xen Community,
We regret to inform you that the Xen Project is currently experiencing unexpected changes due to the sudden shutdown of our colocated (colo) data center facility by Synoptek. This incident is beyond our control and will impact the continuity of OSSTest (the gating Xen Project CI loop)

[Read more](/blog/upcoming-closure-of-xen-project-colo-facility/)


