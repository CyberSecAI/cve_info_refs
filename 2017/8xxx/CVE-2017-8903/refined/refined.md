Based on the provided information, here's an analysis of CVE-2017-8903:

**Root Cause of Vulnerability:**

- The vulnerability arises from a use-after-mode-change issue in how Xen handles page tables for 64-bit PV (Paravirtualized) guests. Specifically, when a guest kernel uses the IRET hypercall within a multicall batch to switch from kernel mode to user mode, subsequent operations in the same batch might incorrectly assume the guest is still in kernel mode. This leads to incorrect page table usage and accounting.

**Weaknesses/Vulnerabilities Present:**

- **Use-After-Mode-Change:** The hypervisor doesn't properly track the mode change within a multicall batch, leading to operations being performed with the wrong page tables.
- **Incorrect Page Table Handling:** The vulnerability allows a guest to potentially use the incorrect root page table, leading to confusion in internal accounting and potentially allowing unauthorized access to page tables.

**Impact of Exploitation:**

- **Privilege Escalation:** A malicious or buggy 64-bit PV guest can gain writable access to its own page tables.
- **System Memory Access:** This can lead to access to all of system memory.
- **Host Crashes:** The incorrect manipulation of page tables could cause the hypervisor to crash.
- **Information Leaks:** Exploitation may allow an attacker to leak sensitive information from the host.

**Attack Vectors:**

- **Malicious or Buggy 64-bit PV Guest:** The vulnerability is exploitable by code running within a 64-bit PV guest.
- **Multicall Batch with IRET Hypercall:** The exploit requires a carefully crafted multicall batch that includes an IRET hypercall for mode switching.

**Required Attacker Capabilities/Position:**

- **Code Execution in Guest Kernel:** The attacker needs the ability to execute code in the kernel mode of a 64-bit PV guest.
- **Ability to Issue Hypercalls:** The attacker needs to be able to issue specific hypercalls, including `IRET`, as part of a multicall.

**Additional Notes:**

- **Affected Systems:** All 64-bit Xen versions on x86 systems are vulnerable. ARM systems are not affected.
- **Unaffected Systems:** HVM (Hardware Virtual Machine) guests and 32-bit PV guests are not vulnerable.
- **Mitigation:** Running only HVM or 32-bit PV guests avoids the vulnerability. Alternatively, controlling the guest kernel and disabling module loading can prevent exploitation.
- **Discovery:** The vulnerability was discovered by Jann Horn of Google Project Zero.
- **Resolution:**  Applying the appropriate patches provided for different Xen versions resolves the issue.
- The Gentoo Security Advisory (GLSA 201705-11) also references this CVE.
- An attacker needs to be able to run code within the guest kernel.