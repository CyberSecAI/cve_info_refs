```
{
  "vulnerability": {
    "root_cause": "The vulnerability is due to a missing check in the `vbf_stp_error` function within `cache_fetch.c` when handling `-sfile` Stevedore transient objects. Specifically, when `VFP_GetStorage` returns a buffer larger than requested, a subsequent `memcpy` operation can cause a heap-buffer-overflow.",
    "weaknesses": [
      "Heap-buffer-overflow",
      "Information Exposure"
    ],
    "impact": "The vulnerability allows a remote attacker to obtain sensitive information from process memory. It can also cause a denial of service through a segmentation fault (core dump).",
    "attack_vectors": [
      "Remote network attack via crafted requests",
      "Exploitation of error conditions in backend communication"
    ],
    "required_capabilities": "The attacker needs to send requests that trigger an error response from the backend. The Varnish configuration must use file or persistent storage with a synthetic object creation in `vcl_backend_error`.",
    "additional_details": "The vulnerability occurs when a synthetic object is stored in file or persistent stevedores, because the `VFP_GetStorage` may return a buffer larger than requested which is not handled by `memcpy`. The vulnerable versions are Varnish HTTP Cache 4.1.x before 4.1.9 and 5.x before 5.2.1. The transient storage should not be configured with `-sfile` or `-spersistent` stevedores. Also, TTL should be less than `shortlived` parameter in `vcl_backend_error`."
  }
}
```