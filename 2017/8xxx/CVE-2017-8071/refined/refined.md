```
Message-ID: <20170416202538.GA12165@grsecurity.net>
Date: Sun, 16 Apr 2017 16:25:38 -0400
From: Brad Spengler <spender@...ecurity.net>
To: oss-security@...ts.openwall.com
Subject: Silently (or obliviously) partially-fixed CONFIG_STRICT_DEVMEM bypass

Hi all,

I wanted to provide some small notice of upstream kernel developers silently
or obliviously partially fixing a CONFIG_STRICT_DEVMEM bypass which explicitly has
never been possible in grsecurity in the past 15 years.  I say this because the commit
message makes no mention of this partially fixing a CONFIG_STRICT_DEVMEM bypass (and I
suppose a Secure Boot bypass, but what isn't these days?), and similarly makes no
mentions of the modifications it makes to the write side.  CONFIG_STRICT_DEVMEM exists
to prevent userland from directly modifying kernel memory, yet the kernel will happily
make slab allocations in allowed regions below 1MB.  CONFIG_STRICT_DEVMEM explicitly
allowed both reads and writes to these allocations.  As noted, the commit below doesn't
fix the mmap side.

<https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=a4866aa812518ed1a37d8ea0c881dc946409de94>
```

**Root cause of vulnerability:** The Linux kernel's `CONFIG_STRICT_DEVMEM` feature, designed to prevent userland from directly modifying kernel memory, had a bypass. The kernel makes slab allocations in memory regions below 1MB, which `CONFIG_STRICT_DEVMEM` explicitly allowed userland to both read and write.

**Weaknesses/vulnerabilities present:** A bypass of the `CONFIG_STRICT_DEVMEM` protection mechanism, allowing userland to directly read and write to kernel memory in specific regions (below 1MB).

**Impact of exploitation:**
- Direct modification of kernel memory by userland processes
- Potential for privilege escalation and arbitrary code execution in the kernel
- Possible bypass of Secure Boot (though not explicitly confirmed)
 
**Attack vectors:**
- Exploiting a vulnerability allowing an attacker to read/write to low memory addresses

**Required attacker capabilities/position:**
- Ability to execute code in userland
- Needs to exploit a vulnerability which allows memory access at low addresses

**Additional Notes:**
- The provided content references a commit that *partially* fixed a write-side vulnerability. The read side bypass remains unfixed.
- This vulnerability specifically affects systems that have the `CONFIG_STRICT_DEVMEM` option enabled.
- There is also a mention of VMAP_STACK fallout, but this is not related to CVE-2017-8071.
- This content provides more context than the official CVE description placeholder.