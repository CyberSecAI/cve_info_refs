=== Content from bugs.ghostscript.com_8a779208_20250125_231051.html ===


Bugzilla – Bug 697810
Out of bounds read in mark\_line\_tr()
Last modified: 2017-06-02 07:04:18 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=697810&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=697810&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 697810**](show_bug.cgi?id=697810)
- Out of bounds read in mark\_line\_tr()

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Out of bounds read in mark\_line\_tr()

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Ghostscript | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Ghostscript "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Graphics Library ([show other bugs](buglist.cgi?component=Graphics%20Library&product=Ghostscript&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | master | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P1 normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Robin Watts | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-04-29 06:04 UTC by Kamil Frankowicz | | --- | --- | | Modified: | 2017-06-02 07:04 UTC ([History](show_activity.cgi?id=697810)) | | CC List: | 2 users (show)  carnil jsegitz | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Customer:](page.cgi?id=fields.html#cf_customer "A custom Free Text field in this installation of Bugzilla.") |  | | [Word Size:](page.cgi?id=fields.html#cf_wordsize "For example x86 would be 32 and x86_64 would be 64.") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=697810&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=697810&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=697810#c0)  Kamil Frankowicz    2017-04-29 06:04:37 UTC  ``` Created [attachment 13629](attachment.cgi?id=13629) [[details]](attachment.cgi?id=13629&action=edit) POC to trigger out of bounds read (gs)  After some fuzz testing I found a crashing test case.  Git Head: [04b37bbce174eed24edec7ad5b920eb93db4d47d](http://www.ghostscript.com/cgi-bin/findgit.cgi?04b37bbce174eed24edec7ad5b920eb93db4d47d)  Command: gs -dNOPAUSE -sDEVICE=bit -sOUTPUTFILE=/dev/null -dSAFER gs_oobr_mark_line_tr -c quit  ASAN:  ==14081==ERROR: AddressSanitizer: SEGV on unknown address 0x6311178a3868 (pc 0x00000192041c bp 0x62a00028a078 sp 0x7ffcdf457340 T0) ==14081==The signal is caused by a READ memory access.     #0 0x192041b in mark_line_tr XYZ/ghostpdl/./base/gxscanc.c:2185:29     #1 0x191f1b4 in gx_scan_convert_tr XYZ/ghostpdl/./base/gxscanc.c:2359:25     #2 0x17a6513 in gx_general_fill_path XYZ/ghostpdl/./base/gxfill.c:482:24     #3 0x17a6513 in gx_default_fill_path XYZ/ghostpdl/./base/gxfill.c:702     #4 0x1839bf1 in gx_fill_path XYZ/ghostpdl/./base/gxpaint.c:52:12     #5 0x1491e52 in do_fill XYZ/ghostpdl/./base/gspaint.c:319:12     #6 0x1491e52 in fill_with_rule XYZ/ghostpdl/./base/gspaint.c:353     #7 0x14ca8c8 in gs_fapi_finish_render XYZ/ghostpdl/./base/gxfapi.c:1066:24     #8 0x14d4faa in gs_fapi_do_char XYZ/ghostpdl/./base/gxfapi.c:1682:16     #9 0x1bc8fce in FAPI_char XYZ/ghostpdl/./psi/zfapi.c:2358:13     #10 0x1a29dee in interp XYZ/ghostpdl/./psi/interp.c:1320:40     #11 0x1a29dee in gs_call_interp XYZ/ghostpdl/./psi/interp.c:517     #12 0x1a29dee in gs_interpret XYZ/ghostpdl/./psi/interp.c:474     #13 0x19fcab2 in gs_main_interpret XYZ/ghostpdl/./psi/imain.c:247:12     #14 0x19fcab2 in gs_main_run_string_end XYZ/ghostpdl/./psi/imain.c:665     #15 0x19fcab2 in gs_main_run_string_with_length XYZ/ghostpdl/./psi/imain.c:623     #16 0x1a08c1e in run_string XYZ/ghostpdl/./psi/imainarg.c:983:16     #17 0x1a08c1e in runarg XYZ/ghostpdl/./psi/imainarg.c:973     #18 0x1a08078 in argproc XYZ/ghostpdl/./psi/imainarg.c:906:16     #19 0x1a00a93 in gs_main_init_with_args XYZ/ghostpdl/./psi/imainarg.c:238:24     #20 0x547608 in main XYZ/ghostpdl/./psi/gs.c:96:16     #21 0x7ffa44c6d82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)     #22 0x47ba38 in _start (/usr/local/bin/gs+0x47ba38)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV XYZ/ghostpdl/./base/gxscanc.c:2185:29 in mark_line_tr ==14081==ABORTING ```  [Comment 1](show_bug.cgi?id=697810#c1)  Robin Watts    2017-05-10 08:24:20 UTC  ``` I cannot reproduce this problem. I've tried 2 different linux boxes, with and without address sanitizer and valgrind.  Can you give me some more information as to what sort of box you were running on please? (32 or 64bit?)  Does it still exhibit with todays fixes in?  Thanks. ```  [Comment 2](show_bug.cgi?id=697810#c2)  Kamil Frankowicz    2017-05-10 10:02:12 UTC  ``` My OS: Ubuntu 16.04 x64 Compiler: Clang 4.0  I tested POC against [1a624d1bfa1e63ceab87f5e4e22c3daffa2d0f01](http://www.ghostscript.com/cgi-bin/findgit.cgi?1a624d1bfa1e63ceab87f5e4e22c3daffa2d0f01) and all went fine :) ```  [Comment 3](show_bug.cgi?id=697810#c3)  Robin Watts    2017-05-10 12:26:44 UTC  ``` Thanks! ```  [Comment 4](show_bug.cgi?id=697810#c4)  jsegitz    2017-06-02 07:04:18 UTC  ``` We would like to have the reproducer to test our updates. Can you please make it public or sent it to me (jsegitz at suse dot de). Thank you.  Also do you know which commit fixes this? Our maintainer is betting on [1a624d1bfa1e63ceab87f5e4e22c3daffa2d0f01](http://www.ghostscript.com/cgi-bin/findgit.cgi?1a624d1bfa1e63ceab87f5e4e22c3daffa2d0f01),  [210893fb2b271717957fcca4e6c049494024cc9d](http://www.ghostscript.com/cgi-bin/findgit.cgi?210893fb2b271717957fcca4e6c049494024cc9d) or [b38f2cb37b7bf469b36ac52b62c4aab6ccf55b6b](http://www.ghostscript.com/cgi-bin/findgit.cgi?b38f2cb37b7bf469b36ac52b62c4aab6ccf55b6b) ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=697810)
* - [XML](show_bug.cgi?ctype=xml&id=697810)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=697810)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=697810&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=697810&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


