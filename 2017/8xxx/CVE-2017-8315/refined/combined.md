=== Content from research.checkpoint.com_5d80e3ff_20250125_030618.html ===

[![](https://research.checkpoint.com/wp-content/uploads/2024/06/CPR-by-Check-Point-logo.svg)](https://research.checkpoint.com)

* [CONTACT US](https://research.checkpoint.com/contact/)
* [DISCLOSURE POLICY](https://research.checkpoint.com/disclosure-policy/)
* [CHECKPOINT.COM](https://www.checkpoint.com/)
* [UNDER ATTACK?](https://www.checkpoint.com/about-us/contact-incident-response/)

[![](https://research.checkpoint.com/wp-content/uploads/2024/06/CPR-by-Check-Point-logo.svg)](https://research.checkpoint.com)

* [Latest Publications](https://research.checkpoint.com/latest-publications/)
* [CPR Podcast Channel](https://research.checkpoint.com/cpr-podcast-channel/)
* [Web 3.0 Security](https://research.checkpoint.com/category/web3/)
* [Intelligence Reports](https://research.checkpoint.com/intelligence-reports/)
* Resources
  + [ThreatCloud AI](https://www.checkpoint.com/ai/)
  + [Threat Intelligence & Research](https://www.checkpoint.com/solutions/threat-intelligence-research/)
  + [Zero Day Protection](https://www.checkpoint.com/infinity/zero-day-protection/)
  + [Sandblast File Analysis](http://threatemulation.checkpoint.com/)
* [About Us](https://research.checkpoint.com/about-us/)
* [SUBSCRIBE](https://research.checkpoint.com/subscription/)

SUBSCRIBE

## CATEGORIES

* [Android Malware
  23](https://research.checkpoint.com/category/android-malware/)
* [Artificial Intelligence
  4](https://research.checkpoint.com/category/artificial-intelligence-2/)
* [ChatGPT
  3](https://research.checkpoint.com/category/chatgpt/)
* [Check Point Research Publications
  396](https://research.checkpoint.com/category/threat-research/)
* [Cloud Security
  1](https://research.checkpoint.com/category/cloud-security/)
* [CPRadio
  44](https://research.checkpoint.com/category/cpradio/)
* [Crypto
  2](https://research.checkpoint.com/category/crypto/)
* [Data & Threat Intelligence
  1](https://research.checkpoint.com/category/data-threat-intelligence/)
* [Data Analysis
  0](https://research.checkpoint.com/category/data-analysis/)
* [Demos
  22](https://research.checkpoint.com/category/demos/)
* [Global Cyber Attack Reports
  339](https://research.checkpoint.com/category/threat-intelligence-reports/)
* [How To Guides
  13](https://research.checkpoint.com/category/how-to-guides/)
* [Ransomware
  2](https://research.checkpoint.com/category/ransomware/)
* [Russo-Ukrainian War
  1](https://research.checkpoint.com/category/russo-ukrainian-war/)
* [Security Report
  1](https://research.checkpoint.com/category/security-report/)
* [Threat and data analysis
  0](https://research.checkpoint.com/category/threat-and-data-analysis/)
* [Threat Research
  172](https://research.checkpoint.com/category/threat-research-2/)
* [Web 3.0 Security
  9](https://research.checkpoint.com/category/web3/)
* [Wipers
  0](https://research.checkpoint.com/category/wipers/)

![ParseDroid – Targeting The Android Development & Research Community](https://research.checkpoint.com/wp-content/uploads/2017/07/Get-off-my-cloud-Post-Image-1021x580-light.jpg)

# ParseDroid: Targeting The Android Development & Research Community

December 4, 2017

https://research.checkpoint.com/2017/parsedroid-targeting-android-development-research-community/

Research By: Eran Vaknin, Gal Elbaz, Alon Boxiner, Oded Vanunu

Latest research from the Check Point Research Team has revealed several vulnerabilities, that puts each and every organization that does any type of Java/Android development at great risk of a threat actor exploiting these vulnerabilities and penetrating them.

The vulnerabilities in question are the developer tools, both downloadable and cloud based, that the Android application ecosystem, the largest application community in the world, is using. This includes the tools that all Java/Android programmers use to build their companies business applications and that security analysts and reverse engineers use to do their work.

Through our own research we have found several vulnerabilities that affect the most common Android IDEs – Google’s Android Studio and JetBrains’ IntelliJ IDEA and Eclipse, as well as the major reverse engineering tools for Android applications such as APKTool and more.

Our research below illustrates how we exploited these tools to gain access to internal files. Since this research, Check Point reported the discovery to APKTool developers and the other IDE companies back in May 2017. In turn, Google and JetBrains have verified and acknowledged the security issues and have since effectively deployed a fix.

**Technical Details – From XXE to RCE: Attacking The Second Layer**

The first stage of our research was focused on APKTool, (Android Application Package Tool).

As the most popular tool for reverse engineering third party Android apps, APKTool is used for supporting custom platforms, analyzing applications and much more, including the decoding and rebuilding of resources.

**The two main features of the APKTool are:**

1. Decompiling an APK file.

2. Building an APK file.

From our research we found that APKTool is vulnerable in both of these main features.

[![APK Diagram](/wp-content/uploads/2017/11/APK-Diagram.jpg)](/wp-content/uploads/2017/11/APK-Diagram.jpg)

By looking at the [source code](https://github.com/iBotPeaches/Apktool) of APKTool, we managed to identify an XML External Entity (XXE) vulnerability, due to the fact that the configured XML parser of APKTool does not disable external entity references when parsing an XML file within the program.

The vulnerable function is called *loadDocument* and it is being used in both core functionalities –  ‘Build’ and ‘Decompile’ – of APKTool.

[![](/wp-content/uploads/2017/11/Code.png)](/wp-content/uploads/2017/11/Code.png)The vulnerability exposes the whole OS file system of APKTool users, and as a result, attackers could then potentially retrieve any file on the victim’s PC by using a malicious “AndroidManifest.xml” file that exploits an XXE vulnerability, that could then be sent to a remote attacker server. And this attack scenario is just one of many possible XXE attack techniques that could lead to harmful outcomes.

[![](/wp-content/uploads/2017/11/XXE-attack-code.png)](/wp-content/uploads/2017/11/XXE-attack-code.png)[![](/wp-content/uploads/2017/12/3.png)](/wp-content/uploads/2017/12/3.png)Realizing the enormity of this vulnerability to the Android developer and researcher community, we extended our research to the vulnerable XML parser called “DocumentBuilderFactory”, which is being used in APKTool project.

**Vulnerabilities in Developer Tools**

This led us to find multiple vulnerable implementations of the XML parser within other projects. Moreover, we identified that the most popular IDEs that are used for building Android applications are affected – including Intellij, Eclipse, and Android Studio.

By simply loading the malicious “AndroidManifest.xml” file as part of any Android project, the IDEs starts spitting out any file configured by the attacker.

To demonstrate this vulnerability, we have uploaded a malicious project library to GitHub and cloned it to an Android Studio project.

**Example of a Malicious Github Project With The XXE Payload:**

[![](/wp-content/uploads/2017/11/malicious-github.png)](/wp-content/uploads/2017/11/malicious-github.png)

**Cloned to Android Studio:**[![](/wp-content/uploads/2017/11/Android-Studio.png)](/wp-content/uploads/2017/11/Android-Studio.png)

**Result:** The attack was delivered successfully, and the protected file was stolen and sent to the presented attacker’s server without the user being aware of it – See image below:

[![](/wp-content/uploads/2017/12/1.png)](/wp-content/uploads/2017/12/1.png)

Furthermore, we have found another attack scenario that can be used in the wild to attack a massive range of Android developers by injecting a malicious AAR (Android Archive Library) containing our XXE payload into repositories.

It is possible, for example, to upload an infected AAR to a public repository such as the central Maven repository, though for demonstration purposes we have uploaded an infected AAR to a local repository. Cloning the infected AAR from the repository by the victim would allow the attacker to steal sensitive files such as configuration files, source code, company digital proprietary and much more from the OS file system.

**Uploading a Malicious AAR to Local Repository:

[![Malicious AAR](/wp-content/uploads/2017/11/Malicious-AAR.jpg)](/wp-content/uploads/2017/11/Malicious-AAR.jpg)[![](/wp-content/uploads/2017/11/Malicious-AAR-Part-2.jpg)](/wp-content/uploads/2017/11/Malicious-AAR-Part-2.jpg)**

**Adding the AAR to Android Studio Project:

[![](/wp-content/uploads/2017/11/Adding-the-AAR-to-Android-Studio.jpg)](/wp-content/uploads/2017/11/Adding-the-AAR-to-Android-Studio.jpg)**

**Result:** The attack was delivered successfully, and the protected file was stolen and sent to the presented attacker’s server without the user being aware of it:[![](/wp-content/uploads/2017/12/2.jpg)](/wp-content/uploads/2017/12/2.jpg)

Further research of the APKTool then led us to find an additional vulnerability that allows us to execute OS commands on a victim’s PC.

For advance use of APKTool there is a configuration file named “APKTOOL.YML”.

This file contains an interesting section called “unknownFiles”, which allows users to include a non-standard file location that will be placed correctly on the rebuild process of an APK. The selected files are saved on the filesystem in the ‘Unknown’ folder.

A legitimate “APKTOOL.YML” file structure looks like this:

[![](/wp-content/uploads/2017/11/APKTOOL.YML-File-Structure.png)](/wp-content/uploads/2017/11/APKTOOL.YML-File-Structure.png)

By manipulating the path of the “unknownFiles” section inside the “APKTOOL.YML” file, it is possible to inject arbitrary files anywhere on the file system ([Path Traversal](https://www.owasp.org/index.php/Path_Traversal)). This is due to the fact that the APKTool does not validate the path of which the unknown files will be extracted from the packed APK.

Indeed, injecting arbitrary files anywhere in the filesystem leads to full Remote Code Execution (RCE) – meaning that any APKTool user/service that will try to decode a crafted malicious APK is vulnerable to RCE.

For demonstration purposes, we have created a Web Application similar to the official online APK decoder (<https://apk.tools>).

**[![](/wp-content/uploads/2017/11/Check-Point-APK-Web-Application.png)](/wp-content/uploads/2017/11/Check-Point-APK-Web-Application.png)**

APKTool will extract the malicious file (in this case we used a PHP web shell) to the wwwroot folder of that server:

[![](/wp-content/uploads/2017/11/APK-Web-Application-Extraction-of-Code.png)](/wp-content/uploads/2017/11/APK-Web-Application-Extraction-of-Code.png)

After building the APK with the modified configuration file, the result is a compressed APK with our malicious file inside the malformed path.

[![Compressed APK](/wp-content/uploads/2017/11/Compressed-APK.png)](/wp-content/uploads/2017/11/Compressed-APK.png)

Uploading the APK to the demo site allows the attacker to execute OS commands on the web application server. This attack could thus be launched against any online/offline service that decodes APKs behind the scenes using APKTool.

The way we chose to demonstrate this vulnerability of course is just one of many possible attack methods that can be used to achieve full RCE. Indeed, the Path Traversal method lets us copy any file to any location on the file system, making the attack surface wide and various.

All the attacks methods demonstrated above are cross-platform and generic and, as the APKTool is designed to work on top of several operating systems, it is also possible to attack any system on which it operates without restriction or limitation.

It is impossible to estimate the number of users of this well-known open source project. Yet, knowing that among them are some large services and companies (e.g. <https://apk.tools>, [http://www.javadecompilers.com/APKTool](http://www.javadecompilers.com/apktool), <https://www.apkdecompilers.com/>, <http://undroid.av-comparatives.info>, [Cuckoo droid](http://cuckoo-droid.readthedocs.io/en/latest/) and many more), we contacted APKTool developer and IDE companies and are pleased to report that they all fixed the security issues and released updated and improved versions of their products.

[![](https://research.checkpoint.com/wp-content/uploads/2022/10/back_arrow.svg)

GO UP](#single-post)

[BACK TO ALL POSTS](/latest-publications/)

## POPULAR POSTS

[![](https://research.checkpoint.com/wp-content/uploads/2023/01/AI-1059x529-copy.jpg)](https://research.checkpoint.com/2023/opwnai-cybercriminals-starting-to-use-chatgpt/)

* Artificial Intelligence
* ChatGPT
* Check Point Research Publications

[OPWNAI : Cybercriminals Starting to Use ChatGPT](https://research.checkpoint.com/2023/opwnai-cybercriminals-starting-to-use-chatgpt/)

[![](https://research.checkpoint.com/wp-content/uploads/2019/01/Fortnite_1021x580.jpg)](https://research.checkpoint.com/2019/hacking-fortnite/)

* Check Point Research Publications
* Threat Research

[Hacking Fortnite Accounts](https://research.checkpoint.com/2019/hacking-fortnite/)

[![](https://research.checkpoint.com/wp-content/uploads/2022/12/OpenAIchatGPT_header.jpg)](https://research.checkpoint.com/2022/opwnai-ai-that-can-save-the-day-or-hack-it-away/)

* Artificial Intelligence
* ChatGPT
* Check Point Research Publications

[OpwnAI: AI That Can Save the Day or HACK it Away](https://research.checkpoint.com/2022/opwnai-ai-that-can-save-the-day-or-hack-it-away/)

### BLOGS AND PUBLICATIONS

[![](https://research.checkpoint.com/wp-content/uploads/2020/02/CheckPointResearchTurkishRat_blog_header.jpg)](https://research.checkpoint.com/2020/the-turkish-rat-distributes-evolved-adwind-in-a-massive-ongoing-phishing-campaign/)

* Check Point Research Publications
* Global Cyber Attack Reports
* Threat Research

February 17, 2020
### “The Turkish Rat” Evolved Adwind in a Massive Ongoing Phishing Campaign

[![](https://research.checkpoint.com/wp-content/uploads/2017/08/WannaCry-Post-No-Image-1021x450.jpg)](https://research.checkpoint.com/2017/the-next-wannacry-vulnerability-is-here/)

* Check Point Research Publications

August 11, 2017
### “The Next WannaCry” Vulnerability is Here

[![](https://research.checkpoint.com/wp-content/uploads/2018/01/rubyminer.jpg)](https://research.checkpoint.com/2018/rubyminer-cryptominer-affects-30-ww-networks/)

* Check Point Research Publications

January 11, 2018
### ‘RubyMiner’ Cryptominer Affects 30% of WW Networks

[![](https://research.checkpoint.com/wp-content/uploads/2022/12/CheckPointResearchLogo_white-1-e1671590634727.png)](https://research.checkpoint.com)

* Publications
  + [Global cyber attack reports](/category/threat-intelligence-reports/)
  + [Research publications](/category/threat-research/)
  + [IPS advisories](https://advisories.checkpoint.com/advisories/)
  + [Check point blog](https://blog.checkpoint.com/)
  + [Demos](/category/demos/)
* Tools
  + [Sandblast file analysis](http://threatemulation.checkpoint.com/)
  + [ThreatCloud](https://www.checkpoint.com/infinity/threatcloud/)
  + [Threat Intelligence](https://www.checkpoint.com/solutions/threat-intelligence-research/)
  + [Zero day protection](https://www.checkpoint.com/infinity/zero-day-protection/)
  + [Live threat map](https://threatmap.checkpoint.com/)
* [About Us](https://research.checkpoint.com/about-us/)
  + [Contact Us](https://research.checkpoint.com/contact/)

### Let’s get in touch

Subscribe for cpr blogs, news and more

[Subscribe Now](/subscription/)

© 1994-2024 Check Point Software Technologies LTD. All rights reserved.

Property of [CheckPoint.com](https://www.checkpoint.com/)

[Privacy Policy](/privacy-policy/)

![](https://research.checkpoint.com/wp-content/uploads/2022/10/popup-side-image.jpg)

## SUBSCRIBE TO CYBER INTELLIGENCE REPORTS

First Name

Last Name

Country—Please choose an option—ChinaIndiaUnited StatesIndonesiaBrazilPakistanNigeriaBangladeshRussiaJapanMexicoPhilippinesVietnamEthiopiaEgyptGermanyIranTurkeyDemocratic Republic of the CongoThailandFranceUnited KingdomItalyBurmaSouth AfricaSouth KoreaColombiaSpainUkraineTanzaniaKenyaArgentinaAlgeriaPolandSudanUgandaCanadaIraqMoroccoPeruUzbekistanSaudi ArabiaMalaysiaVenezuelaNepalAfghanistanYemenNorth KoreaGhanaMozambiqueTaiwanAustraliaIvory CoastSyriaMadagascarAngolaCameroonSri LankaRomaniaBurkina FasoNigerKazakhstanNetherlandsChileMalawiEcuadorGuatemalaMaliCambodiaSenegalZambiaZimbabweChadSouth SudanBelgiumCubaTunisiaGuineaGreecePortugalRwandaCzech RepublicSomaliaHaitiBeninBurundiBoliviaHungarySwedenBelarusDominican RepublicAzerbaijanHondurasAustriaUnited Arab EmiratesIsraelSwitzerlandTajikistanBulgariaHong Kong (China)SerbiaPapua New GuineaParaguayLaosJordanEl SalvadorEritreaLibyaTogoSierra LeoneNicaraguaKyrgyzstanDenmarkFinlandSlovakiaSingaporeTurkmenistanNorwayLebanonCosta RicaCentral African RepublicIrelandGeorgiaNew ZealandRepublic of the CongoPalestineLiberiaCroatiaOmanBosnia and HerzegovinaPuerto RicoKuwaitMoldovMauritaniaPanamaUruguayArmeniaLithuaniaAlbaniaMongoliaJamaicaNamibiaLesothoQatarMacedoniaSloveniaBotswanaLatviaGambiaKosovoGuinea-BissauGabonEquatorial GuineaTrinidad and TobagoEstoniaMauritiusSwazilandBahrainTimor-LesteDjiboutiCyprusFijiReunion (France)GuyanaComorosBhutanMontenegroMacau (China)Solomon IslandsWestern SaharaLuxembourgSurinameCape VerdeMaltaGuadeloupe (France)Martinique (France)BruneiBahamasIcelandMaldivesBelizeBarbadosFrench Polynesia (France)VanuatuNew Caledonia (France)French Guiana (France)Mayotte (France)SamoaSao Tom and PrincipeSaint LuciaGuam (USA)Curacao (Netherlands)Saint Vincent and the GrenadinesKiribatiUnited States Virgin Islands (USA)GrenadaTongaAruba (Netherlands)Federated States of MicronesiaJersey (UK)SeychellesAntigua and BarbudaIsle of Man (UK)AndorraDominicaBermuda (UK)Guernsey (UK)Greenland (Denmark)Marshall IslandsAmerican Samoa (USA)Cayman Islands (UK)Saint Kitts and NevisNorthern Mariana Islands (USA)Faroe Islands (Denmark)Sint Maarten (Netherlands)Saint Martin (France)LiechtensteinMonacoSan MarinoTurks and Caicos Islands (UK)Gibraltar (UK)British Virgin Islands (UK)Aland Islands (Finland)Caribbean Netherlands (Netherlands)PalauCook Islands (NZ)Anguilla (UK)Wallis and Futuna (France)TuvaluNauruSaint Barthelemy (France)Saint Pierre and Miquelon (France)Montserrat (UK)Saint Helena, Ascension and Tristan da Cunha (UK)Svalbard and Jan Mayen (Norway)Falkland Islands (UK)Norfolk Island (Australia)Christmas Island (Australia)Niue (NZ)Tokelau (NZ)Vatican CityCocos (Keeling) Islands (Australia)Pitcairn Islands (UK)

Email

## We value your privacy!

BFSI uses cookies on this site. We use cookies to enable faster and easier experience for you. By continuing to visit this website you agree to our use of cookies.

ACCEPT
REJECT



=== Content from bugs.eclipse.org_47a1b0a5_20250125_030616.html ===


[![logo]()](https://www.eclipse.org/)

* [Download](https://www.eclipse.org/downloads/)
* [Getting Started](https://www.eclipse.org/users/)
* [Members](https://www.eclipse.org/membership/)
* [Projects](https://www.eclipse.org/projects/)
* Community
  + [Marketplace](http://marketplace.eclipse.org)
  + [Events](http://events.eclipse.org)
  + [Planet Eclipse](http://www.planeteclipse.org/)
  + [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
  + [Videos](https://www.youtube.com/user/EclipseFdn)
* Participate
  + [Report a Bug](https://bugs.eclipse.org/bugs/)
  + [Forums](https://www.eclipse.org/forums/)
  + [Mailing Lists](https://www.eclipse.org/mail/)
  + [Wiki](https://wiki.eclipse.org/)
  + [IRC](https://wiki.eclipse.org/IRC)
  + [How to Contribute](https://www.eclipse.org/contribute/)
* Working Groups
  + [Automotive](http://wiki.eclipse.org/Auto_IWG)
  + [Internet of Things](http://iot.eclipse.org)
  + [LocationTech](http://locationtech.org)
  + [Long-Term Support](http://lts.eclipse.org)
  + [PolarSys](http://polarsys.org)
  + [Science](http://science.eclipse.org)
  + [OpenMDM](http://www.openmdm.org)
* More
  + - **Community**
    - [Marketplace](http://marketplace.eclipse.org)
    - [Events](http://events.eclipse.org)
    - [Planet Eclipse](http://www.planeteclipse.org/)
    - [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
    - [Videos](https://www.youtube.com/user/EclipseFdn)
    - **Participate**
    - [Report a Bug](https://bugs.eclipse.org/bugs/)
    - [Forums](https://www.eclipse.org/forums/)
    - [Mailing Lists](https://www.eclipse.org/mail/)
    - [Wiki](https://wiki.eclipse.org/)
    - [IRC](https://wiki.eclipse.org/IRC)
    - [How to Contribute](https://www.eclipse.org/contribute/)
    - **Working Groups**
    - [Automotive](http://wiki.eclipse.org/Auto_IWG)
    - [Internet of Things](http://iot.eclipse.org)
    - [LocationTech](http://locationtech.org)
    - [Long-Term Support](http://lts.eclipse.org)
    - [PolarSys](http://polarsys.org)
    - [Science](http://science.eclipse.org)
    - [OpenMDM](http://www.openmdm.org)

Toggle navigation

[![logo](/eclipse.org-common/themes/solstice/public/images/logo/eclipse-800x188.png)](https://www.eclipse.org/)

Bugzilla – Bug 519169
XXE Vulnerability found in Eclipse
Last modified: 2020-01-10 11:49:27 EST

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=519169&GoAheadAndLogIn=1)

  [x]
| * [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
| * [Copyright Agent](http://www.eclipse.org/legal/copyright.php)

This Bugzilla instance is deprecated, and most Eclipse projects now use
[GitHub](https://github.com/eclipse) or [Eclipse GitLab](https://gitlab.eclipse.org/eclipse/). Please see the [deprecation plan](https://gitlab.eclipse.org/eclipsefdn/helpdesk/-/wikis/Gerrit/Gerrit-and-Bugzilla-deprecation-and-migration-plan) for details.

[**Bug 519169**](show_bug.cgi?id=519169)
- XXE Vulnerability found in Eclipse

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
XXE Vulnerability found in Eclipse

| | [Status](page.cgi?id=fields.html#bug_status): | ASSIGNED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | andmore | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Tools | | [Component:](describecomponents.cgi?product=andmore "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Core ([show other bugs](buglist.cgi?component=Core&product=andmore&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 0.5.0   [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P1 critical ([vote](page.cgi?id=voting/user.html&bug_id=519169#vote_519169)) | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | ---   [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | David Carver [CLA](https://wiki.eclipse.org/ECA) | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | security | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-07-04 10:54 EDT by Alon Boxiner [CLA](https://wiki.eclipse.org/ECA) | | --- | --- | | Modified: | 2020-01-10 11:49 EST ([History](show_activity.cgi?id=519169)) | | CC List: | 5 users (show)  alonbo david\_williams ed stephan.herrmann wayne.beaton | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**Test Case**](attachment.cgi?id=271649 "View the content of the attachment") (4.42 KB, text/xml)  [2017-11-27 02:15 EST](#attach_271649 "Go to the comment associated with the attachment"), Alon Boxiner [CLA](https://wiki.eclipse.org/ECA) | *no flags* | [Details](attachment.cgi?id=271649&action=edit) | | [View All](attachment.cgi?bugid=519169&action=viewall)  [Add an attachment](attachment.cgi?bugid=519169&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=519169&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=519169#c0)  Alon Boxiner [CLA](https://wiki.eclipse.org/ECA)    2017-07-04 10:54:44 EDT  ``` Steps to reproduce:   1. Open a new Android project in Eclipse or download a existing project (for example: GitHub).   2. Add XXE payload to the AndroidManifest.xml file.   3. Open the project with Eclipse and the payload will be executed.    An attacker can build a malicious project library containing XXE payload and distribute it. Anyone who downloads the malicious project and open it using Eclipse will be affected. An Attacker can extract any file he wishes to from the victim's file system. ```  [Comment 1](show_bug.cgi?id=519169#c1)  Stephan Herrmann [CLA](https://wiki.eclipse.org/ECA)    2017-07-04 11:08:40 EDT  ``` I don't understand the attack scenario, but let me still:  - move the bug to Andmore, assuming that this would be the component that handles AndroidManifest.xml (JDT doesn't)  - hide this bug until we understand and/or have a solution.  Specific question regarding the scenario:   If a user opens a malicious file on his/her local machine, how will the attacker benefit from this?   What kind of code can be executed and by which component? ```  [Comment 2](show_bug.cgi?id=519169#c2)  Alon Boxiner [CLA](https://wiki.eclipse.org/ECA)    2017-07-06 07:26:02 EDT  ``` Hello,  An example for an attack scenario: A user clones a project from GitHub. The GitHub project was created with XXE payload in AndroidManifest.xml. The user opens the cloned project in Eclipse and the payload is being executed. The attacker can steal any file from the file system (or the whole file system...). This is just an example for a benefit that the attacker can have using this attack. ```  [Comment 3](show_bug.cgi?id=519169#c3)  Stephan Herrmann [CLA](https://wiki.eclipse.org/ECA)    2017-07-06 07:43:36 EDT  ``` Again, I have close to no knowledge about XXE attacks, but my initial understanding was: typically this approach can be used to trick a webserver into answering some secret information. Inside the IDE there's no webserver involved. The attacker cannot see the result of retrieving, e.g., a local file UNLESS the attack can execute code that will connect to the network and send information back to the attacker. Is that what you are thinking about? Can XXE payload be executable Java code, e.g.? If not by actively connecting to the network, I don't see the attacker anywhere in the picture during runtime of Eclipse. ```  [Comment 4](show_bug.cgi?id=519169#c4)  Alon Boxiner [CLA](https://wiki.eclipse.org/ECA)    2017-07-10 06:21:19 EDT  ``` Hello again Stephan,  You are very close to understand the issue, however XXE attack can be launched against any user PC and not only against web application servers. This allows an attacker to create a malicious project and infect the victim with it.  Once the victim will load the project, the AndroidManifest.xml file, containing the XXE payload, will get executed on the victim PC. ```  [Comment 5](show_bug.cgi?id=519169#c5)  Alon Boxiner [CLA](https://wiki.eclipse.org/ECA)    2017-07-24 09:03:59 EDT  ``` Hi Stephan,  Two weeks have passed since the last message. Any updates?  Best Regards, Alon ```  [Comment 6](show_bug.cgi?id=519169#c6)  Stephan Herrmann [CLA](https://wiki.eclipse.org/ECA)    2017-07-24 11:24:42 EDT  ``` One: I still don't understand which part of an IDE would *execute* portions of an XML file.  Two: All seems to be specific to Android development, of which I know close to nothing. This is why I moved the bug to the Andmore component, in the hope a developer of Andmore would pick it up. ```  [Comment 7](show_bug.cgi?id=519169#c7)  Alon Boxiner [CLA](https://wiki.eclipse.org/ECA)    2017-08-08 07:17:03 EDT  ``` Hi Stephan/David,  Any update? ```  [Comment 8](show_bug.cgi?id=519169#c8)  Stephan Herrmann [CLA](https://wiki.eclipse.org/ECA)    2017-08-08 07:24:00 EDT  ``` I still haven't seen explanations for all of my questions. All I tried was to mediate between bug reported and a responsible developer, and since I can't help further I'm leaving this bug now. ```  [Comment 9](show_bug.cgi?id=519169#c9)  David Carver [CLA](https://wiki.eclipse.org/ECA)    2017-08-10 09:12:59 EDT  ``` (In reply to Stephan Herrmann from [comment #8](show_bug.cgi?id=519169#c8)) > I still haven't seen explanations for all of my questions. All I tried was > to mediate between bug reported and a responsible developer, and since I > can't help further I'm leaving this bug now.  Yeah, I need to research it myself. ```  [Comment 10](show_bug.cgi?id=519169#c10)  David Carver [CLA](https://wiki.eclipse.org/ECA)    2017-08-10 09:15:00 EDT  ``` More information around what XXE actually is.  [https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing](https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing) ```  [Comment 11](show_bug.cgi?id=519169#c11)  David Carver [CLA](https://wiki.eclipse.org/ECA)    2017-08-10 09:22:19 EDT  ``` Configuration options on combatting XXE for various Java related ways of parsing the XML can be found here.  [https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Prevention_Cheat_Sheet](https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Prevention_Cheat_Sheet)  I'll add this to my queue of stuff to look at, but I would not be surprised if other Eclipse related projects might be vulnerable to this if they use an XML parser that understands DTDs.  This is something that has to be specificially added by the User to the XML.  While we can handle this on the Andmore side by looking at how the XML Parsers are configured once it is built by the Android tooling and packaged as part of the APK it is out of our hands.  From our side, I think we can safely disable any DTD processing or use of external entities. ```  [Comment 12](show_bug.cgi?id=519169#c12)  David Carver [CLA](https://wiki.eclipse.org/ECA)    2017-08-24 14:00:56 EDT  ``` My weekend looks like it has freed up a bit, so I should be able to try get a simple fix for this by disabling DTD support within the Stax2 readers that are being used.  I don't think this will affect any down stream consumers, but we'll find out.  May have to make this configurable long term. ```  [Comment 13](show_bug.cgi?id=519169#c13)  Alon Boxiner [CLA](https://wiki.eclipse.org/ECA)    2017-08-28 01:35:48 EDT  ``` Hi David, you are right saying that this vulnerability should be fixed for the long term.  Thank you for the acknowledgement. ```  [Comment 14](show_bug.cgi?id=519169#c14)  David Carver [CLA](https://wiki.eclipse.org/ECA)    2017-08-30 11:09:56 EDT  ``` (In reply to Alon Boxiner from [comment #13](show_bug.cgi?id=519169#c13)) > Hi David, you are right saying that this vulnerability should be fixed for > the long term.  > Thank you for the acknowledgement.  Last weekends plans fell through, I have some pto coming up so will address what I can here this coming weekend. ```  [Comment 15](show_bug.cgi?id=519169#c15)  Alon Boxiner [CLA](https://wiki.eclipse.org/ECA)    2017-11-27 01:43:03 EST  ``` Hi,  We are going to publish the story today. almost 5 months have past and we did not get an update if the issue was solved. Please let me know what is the version number that it was solved on.  Thank you, Alon ```  [Comment 16](show_bug.cgi?id=519169#c16)  Alon Boxiner [CLA](https://wiki.eclipse.org/ECA)    2017-11-27 02:15:18 EST  ``` Created [attachment 271649](attachment.cgi?id=271649 "Test Case") [[details]](attachment.cgi?id=271649&action=edit "Test Case") Test Case  attached a test case. Please update me as quick as you can as it meant to go out today... ```  [Comment 17](show_bug.cgi?id=519169#c17)  David Carver [CLA](https://wiki.eclipse.org/ECA)    2017-11-27 13:18:55 EST  ``` (In reply to Alon Boxiner from [comment #16](show_bug.cgi?id=519169#c16)) > Created [attachment 271649](attachment.cgi?id=271649 "Test Case") [[details]](attachment.cgi?id=271649&action=edit "Test Case") > Test Case >  > attached a test case. > Please update me as quick as you can as it meant to go out today...  While this is a potential vulnerability, the risk here is pretty low.  Thanks for the test case, I've analyzed this vulnerability, and from experience, this is pretty low, as somebody would have to bring in the source code from an unknown source to be affected by it.  I'll keep this issue open so that we do address it, but there may be some valid reasons to allow Doctypes and custom entities to be created, to this affect one needs to be able to define System refernces.  This was also reported to Google back in 2015 as well, and so far they have not addressed the issue that I'm aware.  <http://www.securityweek.com/android-manifest-file-attacks-can-make-devices-inoperable> ```  [Comment 18](show_bug.cgi?id=519169#c18)  Ed Willink [CLA](https://wiki.eclipse.org/ECA)    2017-12-07 02:19:51 EST  ``` (In reply to David Carver from [comment #17](show_bug.cgi?id=519169#c17))  > While this is a potential vulnerability, the risk here is pretty low.   Earlier discussion suggests that import from GitHub is a hazard.  Provision of a GitHub repro is a common mechanism for supporting bug reports, so it appears that there is a major hazard for Eclipse committers. How can I review the content that I am provided? ```  [Comment 19](show_bug.cgi?id=519169#c19)  David Carver [CLA](https://wiki.eclipse.org/ECA)    2017-12-11 15:51:18 EST  ``` (In reply to Ed Willink from [comment #18](show_bug.cgi?id=519169#c18)) > (In reply to David Carver from [comment #17](show_bug.cgi?id=519169#c17))  > > While this is a potential vulnerability, the risk here is pretty low.  >  > Earlier discussion suggests that import from GitHub is a hazard. >  > Provision of a GitHub repro is a common mechanism for supporting bug > reports, so it appears that there is a major hazard for Eclipse committers. > How can I review the content that I am provided?  The thing with this particular bug, is that it pretty much makes any use of DTDs in XML documents useless.   So it means no importing of DTD that define other items that may be store via a URL.   In order to reproduce this, one would have to clone a repository that contains the vulnerability attached as a Test Case... then open that XML file, either through the Android tooling or another XML tool that did not have DTD support disabled.  This means tools like WTP which supports DTDs could be vulnerable to this if they opened an XML file that contained the bad System file.     The balancing point here is disabling needed functionality with the possiblity that you get a file that has this issue. ```  [Comment 20](show_bug.cgi?id=519169#c20)  Wayne Beaton [CLA](https://wiki.eclipse.org/ECA)    2019-05-14 16:19:42 EDT  ``` What is the status of this issue?  We are long past the time to disclose (by removing the committer-only flag). ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=519169)
* - [XML](show_bug.cgi?ctype=xml&id=519169)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=519169)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=519169&GoAheadAndLogIn=1)

    [x]
  | + [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
  | + [Copyright Agent](http://www.eclipse.org/legal/copyright.php)


