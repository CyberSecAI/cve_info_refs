- **Root cause of vulnerability:** The vulnerability arises from misconfigured permissions during the enablement of Azure AD Connect Password writeback, where the service account may be inadvertently granted Reset Password permission over on-premises AD privileged accounts. This allows a malicious Azure AD Administrator to reset the passwords of these accounts, leading to unauthorized access.
- **Weaknesses/vulnerabilities present:** Improper access control and privilege escalation due to overly permissive permissions assigned to the Azure AD Connect service account, specifically the Reset Password permission, over privileged on-premises AD accounts. This permission is granted when enabling the Password Writeback feature.
- **Impact of exploitation:** An attacker (malicious Azure AD Administrator) can exploit this vulnerability to reset passwords of privileged on-premises AD accounts (e.g., Enterprise and Domain Administrator accounts) to known values, gaining unauthorized privileged access to the customerâ€™s on-premises AD.
- **Attack vectors:** The attack vector is through the Azure AD Connect Password writeback feature. If the Azure AD Connect service account has the necessary permissions (Reset Password) on privileged on-premises accounts due to misconfiguration, a malicious Azure AD Administrator can initiate a password reset via Azure AD.
- **Required attacker capabilities/position:** The attacker needs to be a malicious Azure AD Administrator and the targeted Azure AD Connect instance must have the password writeback feature enabled with the AD DS account used by Azure AD Connect having Reset Password permissions over on-premises privileged user accounts. The attacker must be an administrator in Azure AD, not necessarily on-premises.