```
This fixes the bug: 'user-to-root privesc inside VM via bad translation
caching' reported by Jann Horn here:
<https://bugs.chromium.org/p/project-zero/issues/detail?id=1122>
```

**Root cause of vulnerability:**
The vulnerability is caused by a lack of proper instruction size check during translation in the QEMU i386 target. Specifically, QEMU did not check if the instruction being translated is larger than the maximum allowed size for x86 instruction, which is 15 bytes.

**Weaknesses/vulnerabilities present:**
- Insufficient size validation of x86 instructions during translation.
- The code was not limiting the instruction size which could lead to out-of-bounds read and other memory corruption issues.
- Improper caching of the translated code which has not been properly validated.

**Impact of exploitation:**
- User-to-root privilege escalation inside the virtual machine.
- Memory corruption

**Attack vectors:**
- Crafting a specially malformed instruction stream in the guest VM.
- The vulnerability can be triggered through code execution within the virtual machine

**Required attacker capabilities/position:**
- Attacker must have the ability to execute code inside the virtual machine.