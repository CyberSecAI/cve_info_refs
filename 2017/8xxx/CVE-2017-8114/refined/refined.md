Based on the provided content, here's a breakdown of the vulnerability described in CVE-2017-8114:

**Root Cause:**

*   The vulnerability lies within the `password` plugin of Roundcube, specifically in the `virtualmin` and `sasl` drivers.
*   The `save()` method within these drivers uses an `exec()` function to execute shell commands without properly sanitizing user-supplied inputs.

**Weaknesses/Vulnerabilities:**

*   **Insufficient Input Sanitization:** The `exec()` function is used with input sanitized only through `escapeshellcmd()`, which is insufficient. While `escapeshellcmd()` prevents execution of arbitrary commands by escaping special characters, it doesn't prevent injection of additional command parameters.
*   **Command Injection:**  Although arbitrary commands cannot be executed, additional parameters can be injected to the `modify-user` command, which allows manipulation of user accounts using the `chgvirtualminpasswd` utility.

**Impact of Exploitation:**

*   **Arbitrary Password Reset:** An attacker with valid login credentials can reset the password of any other user on the system by injecting crafted parameters in the new password field.
*  **Privilege Escalation:** By changing the shell of a user to `/bin/bash`, an attacker could obtain a shell with the privileges of the target user, potentially leading to a full system compromise, or privilege escalation to the root user if the `chgvirtualminpasswd` utility runs as root.
*   **Unauthorized Access:** Once an attacker gains access to another account or obtains a shell, they can potentially access sensitive data, install malware, or perform other malicious actions.

**Attack Vectors:**

*   **Web Interface:** The attack is carried out through the Roundcube web interface, targeting the password change functionality.
*   **Password Plugin:** The specific vulnerability resides within the `password` plugin's `virtualmin` and `sasl` drivers.

**Required Attacker Capabilities/Position:**

*   **Authentication:** The attacker needs valid login credentials to a Roundcube account.
*   **Network Access:** The attacker needs network access to the Roundcube instance.

**Additional Details:**

*   The `chgvirtualminpasswd` is a wrapper around `virtualmin` and executes as root, making the injection more impactful.
*   The vulnerability is present in Roundcube version 1.3-beta and likely in previous versions.
*   The vendor released updates to address this vulnerability in versions 1.2.5, 1.1.9, and 1.0.11.
*   The provided GitHub link describes the vulnerability, provides code details, and also provides a timeline of vendor notification and fixes.
*   Gentoo Security Advisory GLSA 201707-11 also discusses this vulnerability.

The vulnerability is caused by insufficient input validation when using `exec()`, allowing authenticated users to inject malicious parameters to a command which would normally require higher privileges. This could allow a malicious user to reset passwords of other users or gain shell access to the server.