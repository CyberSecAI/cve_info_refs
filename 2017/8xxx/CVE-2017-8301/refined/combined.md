=== Content from trac.nginx.org_132e9c46_20250124_173814.html ===


[![nginx](/nginx/chrome/site/nginx.gif)](http://www.nginx.org)

Search:

* [Login](https://trac.nginx.org/nginx/auth)
* [Preferences](/nginx/prefs)
* [Help/Guide](/nginx/wiki/TracGuide)
* [About Trac](/nginx/about)

* [Wiki](/nginx/wiki)
* [Timeline](/nginx/timeline)
* [Roadmap](/nginx/roadmap)
* [Browse Source](/nginx/browser)
* [View Tickets](/nginx/report)
* [Search](/nginx/search)

## Context Navigation

* ← [Previous Ticket](/nginx/ticket/1256 "Ticket #1256")
* [Next Ticket](/nginx/ticket/1258 "Ticket #1258") →

---

Opened [8 years ago](/nginx/timeline?from=2017-04-25T17%3A47%3A15Z&precision=second "See timeline at 04/25/17 17:47:15")

Closed [8 years ago](/nginx/timeline?from=2017-04-26T09%3A59%3A25Z&precision=second "See timeline at 04/26/17 09:59:25")

Last modified [8 years ago](/nginx/timeline?from=2017-05-06T16%3A27%3A25Z&precision=second "See timeline at 05/06/17 16:27:25")

## [#1257](/nginx/ticket/1257) [closed](/nginx/query?status=closed) [defect](/nginx/query?status=!closed&type=defect) ([invalid](/nginx/query?status=closed&resolution=invalid))

# Some nginx TLS tests started failing with LibreSSL 2.5.3

| Reported by: | jirutka@… | Owned by: |  |
| --- | --- | --- | --- |
| Priority: | [critical](/nginx/query?status=!closed&priority=critical) | Milestone: |  |
| Component: | [nginx-core](/nginx/query?status=!closed&component=nginx-core) | Version: |  |
| Keywords: | [libressl](/nginx/query?status=!closed&keywords=~libressl) [tls](/nginx/query?status=!closed&keywords=~tls) [security](/nginx/query?status=!closed&keywords=~security) | Cc: | ncopa@… |
| uname -a: |  | | |
| nginx -V: | nginx version: nginx/1.10.3  built with LibreSSL 2.5.3  TLS SNI support enabled  configure arguments: --prefix=/var/lib/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib/nginx/modules --conf-path=/etc/nginx/nginx.conf --pid-path=/run/nginx/nginx.pid --lock-path=/run/nginx/nginx.lock --http-client-body-temp-path=/var/lib/nginx/tmp/client\_body --http-proxy-temp-path=/var/lib/nginx/tmp/proxy --http-fastcgi-temp-path=/var/lib/nginx/tmp/fastcgi --http-uwsgi-temp-path=/var/lib/nginx/tmp/uwsgi --http-scgi-temp-path=/var/lib/nginx/tmp/scgi --with-perl\_modules\_path=/usr/lib/perl5/vendor\_perl --user=nginx --group=nginx --with-threads --with-file-aio --with-ipv6 --with-http\_ssl\_module --with-http\_v2\_module --with-http\_realip\_module --with-http\_addition\_module --with-http\_xslt\_module=dynamic --with-http\_image\_filter\_module=dynamic --with-http\_geoip\_module=dynamic --with-http\_sub\_module --with-http\_dav\_module --with-http\_flv\_module --with-http\_mp4\_module --with-http\_gunzip\_module --with-http\_gzip\_static\_module --with-http\_auth\_request\_module --with-http\_random\_index\_module --with-http\_secure\_link\_module --with-http\_slice\_module --with-http\_stub\_status\_module --with-http\_perl\_module=dynamic --with-http\_realip\_module --with-mail=dynamic --with-mail\_ssl\_module --with-stream=dynamic --with-stream\_ssl\_module | | |

## Description

After we updated LibreSSL from 2.4.4. to 2.5.3 in Alpine Linux, we have noticed that some TLS-related tests in nginx (both 1.10.3 and 1.12.0) started failing. Moreover, most of them fail because nginx accepted certificate that should be rejected! That’s pretty bad regression.

We’re not sure if the problem is in LibreSSL, nginx or nginx-tests, so reporting it to both.

People from VoidLinux has reproduced this issue too, on glibc.

```

Test Summary Report
-------------------
./h2_ssl_verify_client.t             (Wstat: 256 Tests: 5 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./mail_imap_ssl.t                    (Wstat: 512 Tests: 14 Failed: 2)
  Failed tests:  4, 10
  Non-zero exit status: 2
./proxy_bind_transparent.t           (Wstat: 512 Tests: 3 Failed: 2)
  Failed tests:  1-2
  Non-zero exit status: 2
./proxy_ssl_certificate.t            (Wstat: 256 Tests: 7 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./ssl_crl.t                          (Wstat: 512 Tests: 5 Failed: 2)
  Failed tests:  2-3
  Non-zero exit status: 2
./ssl_verify_client.t                (Wstat: 512 Tests: 12 Failed: 2)
  Failed tests:  4-5
  Non-zero exit status: 2
./ssl_verify_depth.t                 (Wstat: 256 Tests: 4 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./stream_proxy_ssl_certificate.t     (Wstat: 256 Tests: 7 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./stream_ssl_verify_client.t         (Wstat: 512 Tests: 12 Failed: 2)
  Failed tests:  3, 5
  Non-zero exit status: 2
Files=290, Tests=3628, 300 wallclock secs ( 1.91 usr  0.46 sys + 54.82 cusr  9.07 csys = 66.26 CPU)

```

Complete log: [​http://tpaste.us/Ynw6](http://tpaste.us/Ynw6)

### Attachments (1)

[nginx-tests.log](/nginx/attachment/ticket/1257/nginx-tests.log "View attachment")[​](/nginx/raw-attachment/ticket/1257/nginx-tests.log "Download")
(25.1 KB
) - added by jirutka@… [8 years ago](/nginx/timeline?from=2017-04-25T17%3A47%3A39Z&precision=second "See timeline at 04/25/17 17:47:39").
nginx-tests log

Download all attachments as:
[.zip](/nginx/zip-attachment/ticket/1257/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (10)

### by jirutka@…, [8 years ago](/nginx/timeline?from=2017-04-25T17%3A47%3A39Z&precision=second "See timeline at 04/25/17 17:47:39")

| Attachment: | [*nginx-tests.log*](/nginx/attachment/ticket/1257/nginx-tests.log)[​](/nginx/raw-attachment/ticket/1257/nginx-tests.log "Download") added |
| --- | --- |

nginx-tests log

### [comment:1](#comment:1) by jirutka@…, [8 years ago](/nginx/timeline?from=2017-04-25T17%3A50%3A01Z&precision=second "See timeline at 04/25/17 17:50:01")

LibreSSL bug report: [​https://github.com/libressl-portable/portable/issues/307](https://github.com/libressl-portable/portable/issues/307)

### [comment:2](#comment:2) by jirutka@…, [8 years ago](/nginx/timeline?from=2017-04-25T21%3A06%3A16Z&precision=second "See timeline at 04/25/17 21:06:16")

VoidLinux guys started investigating it more and according to them the problem lies in LibreSSL, not nginx.

### follow-up: [4](#comment:4) [comment:3](#comment:3) by jirutka@…, [8 years ago](/nginx/timeline?from=2017-04-26T01%3A08%3A54Z&precision=second "See timeline at 04/26/17 01:08:54")

So, Duncaen from VoidLinux has identified potential cause in LibreSSL code, commit [​https://github.com/libressl-portable/openbsd/commit/ddd98f8ea741a122952185a36c1396c14c2fda74](https://github.com/libressl-portable/openbsd/commit/ddd98f8ea741a122952185a36c1396c14c2fda74). I’ve tried to build LibreSSL 2.5.3 with patch reverting that commit, rebuild nginx, run tests and… all pass! So it seems that this is really the cause.

However, it also seems that the problem is even on the nginx’s side, in function `ngx_ssl_verify_callback(int ok, X509_STORE_CTX *x509_store)` ([​https://github.com/nginx/nginx/blob/branches/stable-1.10/src/event/ngx\_event\_openssl.c#L665-L706](https://github.com/nginx/nginx/blob/branches/stable-1.10/src/event/ngx_event_openssl.c#L665-L706)). It always returns 1, that seems to be wrong. It should return the given first argument (`ok`), that’s what `null_callback(int ok, X509_STORE_CTX *e)` (the default no-op callback) do, what other projects like OpenSMTPD use and what the OpenSSL documentation suggests. Why nginx always returns 1 here, i.e. saying that the cert is ok?

---

I’ve tried to change `ngx_ssl_verify_callback` to return the first given argument (`ok`) instead of `1` and build with unpatched LibreSSL 2.5.3.

```
--- a/src/event/ngx_event_openssl.c
+++ b/src/event/ngx_event_openssl.c
@@ -702,7 +702,7 @@
     }
 #endif

-    return 1;
+    return ok;
 }

```

Here are the results:

```
Test Summary Report
-------------------
./addition_buffered.t                (Wstat: 0 Tests: 3 Failed: 0)
  TODO passed:   1
./h2.t                               (Wstat: 0 Tests: 142 Failed: 0)
  TODO passed:   136-137
./h2_ssl_verify_client.t             (Wstat: 65280 Tests: 3 Failed: 0)
  Non-zero exit status: 255
  Parse errors: Bad plan.  You planned 5 tests but ran 3.
./mail_imap_ssl.t                    (Wstat: 65280 Tests: 5 Failed: 0)
  Non-zero exit status: 255
  Parse errors: Bad plan.  You planned 14 tests but ran 5.
./proxy_ssl_certificate.t            (Wstat: 256 Tests: 7 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./ssl_crl.t                          (Wstat: 512 Tests: 5 Failed: 2)
  Failed tests:  2-3
  Non-zero exit status: 2
./ssl_verify_client.t                (Wstat: 65280 Tests: 5 Failed: 0)
  Non-zero exit status: 255
  Parse errors: Bad plan.  You planned 12 tests but ran 5.
./ssl_verify_depth.t                 (Wstat: 256 Tests: 4 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./stream_proxy_ssl_certificate.t     (Wstat: 256 Tests: 7 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
Files=290, Tests=3234, 303 wallclock secs ( 1.73 usr  0.54 sys + 54.39 cusr  8.60 csys = 65.26 CPU)
Result: FAIL

```

Complete log: [​http://tpaste.us/Dk8e](http://tpaste.us/Dk8e)

### in reply to: [3](#comment:3) [comment:4](#comment:4) by Sergey Kandaurov, [8 years ago](/nginx/timeline?from=2017-04-26T09%3A58%3A41Z&precision=second "See timeline at 04/26/17 09:58:41")

Replying to [jirutka@…](/nginx/ticket/1257#comment:3 "Comment 3"):

> However, it also seems that the problem is even on the nginx’s side, in function `ngx_ssl_verify_callback(int ok, X509_STORE_CTX *x509_store)` ([​https://github.com/nginx/nginx/blob/branches/stable-1.10/src/event/ngx\_event\_openssl.c#L665-L706](https://github.com/nginx/nginx/blob/branches/stable-1.10/src/event/ngx_event_openssl.c#L665-L706)). It always returns 1, that seems to be wrong.
>
> [..](/nginx/ticket)

That is incorrect. According to the [​documentation](https://www.openssl.org/docs/man1.0.2/ssl/SSL_CTX_set_verify.html):

: The return value of verify\_callback controls the strategy of the

: further verification process. If verify\_callback returns 0, the

: verification process is immediately stopped with "verification failed"

: state. <..> If verify\_callback returns 1, the verification process is continued.

This is what was broken in LibreSSL in the aforementioned change.

### [comment:5](#comment:5) by Sergey Kandaurov, [8 years ago](/nginx/timeline?from=2017-04-26T09%3A59%3A25Z&precision=second "See timeline at 04/26/17 09:59:25")

| Resolution: | → invalid |
| --- | --- |
| Status: | new → closed |

As previously noted, this is not a problem in nginx.

### [comment:6](#comment:6) by jirutka@…, [8 years ago](/nginx/timeline?from=2017-04-26T12%3A09%3A30Z&precision=second "See timeline at 04/26/17 12:09:30")

Please read also the rest of the documentation:

If verify\_callback always returns 1, the TLS/SSL handshake will not be terminated with respect to verification failures and the connection will be established.

### follow-up: [8](#comment:8) [comment:7](#comment:7) by Maxim Dounin, [8 years ago](/nginx/timeline?from=2017-04-26T12%3A45%3A19Z&precision=second "See timeline at 04/26/17 12:45:19")

Yes, and this is exactly what nginx wants to happen. It then uses SSL\_get\_verify\_result() to check if the verification was successful or not, and acts appropriately - allows request to be handled, or returns an appropriate error. Unfortunately, this is broken in the current version of LibreSSL, and it does not seem to be possible to do anything with this on nginx side.

### in reply to: [7](#comment:7) [comment:8](#comment:8) by jirutka@…, [8 years ago](/nginx/timeline?from=2017-04-26T17%3A13%3A17Z&precision=second "See timeline at 04/26/17 17:13:17")

Replying to [mdounin](/nginx/ticket/1257#comment:7 "Comment 7"):

Thanks for clarification! We have discussed it on IRC and other guys agreed that you’re right. Also LibreSSL already responded on the issue:

> Thanks for digging into the issue and reporting this. It seems that the change does indeed break the documented API - we're looking into solutions and will follow up soon.

### [comment:9](#comment:9) by hdatma@…, [8 years ago](/nginx/timeline?from=2017-05-06T16%3A20%3A08Z&precision=second "See timeline at 05/06/17 16:20:08")

Last edited [8 years ago](/nginx/timeline?from=2017-05-06T16%3A27%3A25Z&precision=second "See timeline at 05/06/17 16:27:25") by hdatma@… ([previous](/nginx/ticket/1257?cversion=1&cnum_hist=9#comment:9))
([diff](/nginx/ticket/1257?action=comment-diff&cnum=9&version=2))

**Note:**
See [TracTickets](/nginx/wiki/TracTickets)
for help on using tickets.

### Download in other formats:

* [RSS Feed](/nginx/ticket/1257?format=rss)
* [Comma-delimited Text](/nginx/ticket/1257?format=csv)
* [Tab-delimited Text](/nginx/ticket/1257?format=tab)

---

[![Trac Powered](/nginx/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.4.3**](/nginx/about)

By [Edgewall Software](http://www.edgewall.org/)
.



=== Content from nmap.org_9ba698e9_20250126_023501.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) project—a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named “Security Product of the Year” by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmap -v -A *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_a54483fa_20250124_173812.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](144)
[By Date](date.html#145)
[![Next](/images/right-icon-16x16.png)](146)

[![Previous](/images/left-icon-16x16.png)](150)
[By Thread](index.html#145)
[![Next](/images/right-icon-16x16.png)](151)

![](/shared/images/nst-icons.svg#search)

# CVE-2017-8301: TLS verification vulnerability in LibreSSL 2.5.1 - 2.5.3

---

*From*: Jakub Jirutka <jakub () jirutka cz>

*Date*: Thu, 27 Apr 2017 20:58:10 +0200

---

```
Vulnerability Type: Missing TLS Certificate Validation
Affected Product Code Base: LibreSSL - 2.5.1 - 2.5.3
Vendor of Product: OpenBSD
Affected Component: SSL_set_verify, SSL_CTX_set_verify, SSL_get_verify_result

## Summary

LibreSSL 2.5.1 to 2.5.3 lacks TLS certificate verification if
SSL_get_verify_result is relied upon for a later check of a
verification result, in a use case where a user-provided verification
callback returns 1, as demonstrated by acceptance of invalid
certificates by nginx.

## Additional Information

LibreSSL versions from 2.5.1 until 2.5.3 suffer from a lack of TLS certificate
verification if the user-provided callback for verification returns 1.
This bug was introduced in commit ddd98f8ea741a122952185a36c1396c14c2fda74 [1]
(libcrypto/x509/x509_vfy.c, version 1.58) and has not been fixed upstream yet.

If the user verification callback returns 1, LibreSSL will force the
verification result to X509_V_OK resulting in, contrary to the documentation,
any later checks by the API user through SSL_get_verify_result() to be useless,
as it will always return X509_V_OK instead of any earlier error that occurred
in the verification process.

As such, any API user that matches the following prerequisites:

* Installs a verification callback that always returns 1, or returns 1 even
  when the first parameter (preverify_ok) is 0;
* Intends to check the verification result later using SSL_get_verify_result()
  in order to abort the connection at that point;

will be lead into thinking that the verification succeeded and thus possibly
allow connections to peers with invalid certificates, despite this clearly
not being the intention and in violation of the documentation of the original
OpenSSL API:

```
> ```
> If verify_callback always returns 1, the TLS/SSL handshake will not be
> terminated with respect to verification failures and the connection will be
> established. The calling process can however retrieve the error code of the
> last verification error using SSL_get_verify_result(3) or by maintaining
> its own error storage managed by verify_callback. -- [2]
>
> ```

```

An example of real-world software affected by this is nginx [3], bypassing
certificate verification entirely and InspIRCd [4], bypassing the option
of requiring trusted clients upon connect (<connect requiressl="trusted">).

This issue was discovered by Jakub Jirutka <jakub () jirutka cz> from Alpine Linux
using the nginx automated test suite [5] and further investigated by
Duncan Overbruck <duncaen () voidlinux eu> from Void Linux and Shiz <hi () shiz me>
from Alpine Linux.

Not fixed upstream yet, verified by vendor here [6].

This issue got assigned CVE-2017-8301 [7].

## Attack Vectors

Connect to an affected service over TLS using an arbitrary client
certificate, or an affected client connecting to a service that
presents an arbitrary server certificate.

## References

[1]: <https://github.com/libressl-portable/openbsd/commit/ddd98f8ea741a122952185a36c1396c14c2fda74>
[2]: [https://wiki.openssl.org/index.php/Manual:SSL_CTX_set_verify](https://wiki.openssl.org/index.php/Manual%3ASSL_CTX_set_verify)(3)
[3]: <https://trac.nginx.org/nginx/ticket/1257>
[4]:
<https://github.com/inspircd/inspircd/blob/5366dd2abd8fdeecf4a6ff173faf1f241d185628/src/modules/extra/m_ssl_openssl.cpp#L536>
[5]: <http://hg.nginx.org/nginx-tests/>
[6]: <https://github.com/libressl-portable/portable/issues/307#issuecomment-297469867>
[7]: <https://nvd.nist.gov/vuln/detail/CVE-2017-8301>

```

---

[![Previous](/images/left-icon-16x16.png)](144)
[By Date](date.html#145)
[![Next](/images/right-icon-16x16.png)](146)

[![Previous](/images/left-icon-16x16.png)](150)
[By Thread](index.html#145)
[![Next](/images/right-icon-16x16.png)](151)

### Current thread:

* **CVE-2017-8301: TLS verification vulnerability in LibreSSL 2.5.1 - 2.5.3** *Jakub Jirutka (Apr 27)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_4e722cae_20250126_023503.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibressl%2Fportable%2Fissues%2F307)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibressl%2Fportable%2Fissues%2F307)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=libressl%2Fportable)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[libressl](/libressl)
/
**[portable](/libressl/portable)**
Public

* [Notifications](/login?return_to=%2Flibressl%2Fportable) You must be signed in to change notification settings
* [Fork
  265](/login?return_to=%2Flibressl%2Fportable)
* [Star
   1.4k](/login?return_to=%2Flibressl%2Fportable)

* [Code](/libressl/portable)
* [Issues
  81](/libressl/portable/issues)
* [Pull requests
  5](/libressl/portable/pulls)
* [Actions](/libressl/portable/actions)
* [Security](/libressl/portable/security)
* [Insights](/libressl/portable/pulse)

Additional navigation options

* [Code](/libressl/portable)
* [Issues](/libressl/portable/issues)
* [Pull requests](/libressl/portable/pulls)
* [Actions](/libressl/portable/actions)
* [Security](/libressl/portable/security)
* [Insights](/libressl/portable/pulse)

# Some nginx TLS tests started failing with LibreSSL 2.5.3 (but not with 2.4.4) #307

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Some nginx TLS tests started failing with LibreSSL 2.5.3 (but not with 2.4.4)](#top)#307Copy linkAssignees [![bob-beck](https://avatars.githubusercontent.com/u/8124021?s=64&u=253904b010cbba036c7f4514e41a33a022787148&v=4)](/bob-beck)[![4a6f656c](https://avatars.githubusercontent.com/u/8142769?s=64&v=4)](/4a6f656c)[![@jirutka](https://avatars.githubusercontent.com/u/949228?u=fc07aa51a80b95b776f1cf16da7dc3d55499b615&v=4&size=80)](/jirutka)
## Description

[![@jirutka](https://avatars.githubusercontent.com/u/949228?u=fc07aa51a80b95b776f1cf16da7dc3d55499b615&v=4&size=48)](/jirutka)[jirutka](https://github.com/jirutka)opened [on Apr 25, 2017](https://github.com/libressl/portable/issues/307#issue-224210682)

After we updated LibreSSL from 2.4.4. to 2.5.3 in Alpine Linux, we have noticed that some TLS-related tests in nginx (both 1.10.3 and 1.12.0) started failing. Moreover, most of them fail because nginx accepted certificate that should be rejected! That’s pretty bad regression.

We’re not sure if the problem is in LibreSSL, nginx or nginx-tests, so reporting it to both. Nginx bug report: <https://trac.nginx.org/nginx/ticket/1257>.

People from VoidLinux have reproduced this issue too, on glibc.

```
Test Summary Report
-------------------
./h2_ssl_verify_client.t             (Wstat: 256 Tests: 5 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./mail_imap_ssl.t                    (Wstat: 512 Tests: 14 Failed: 2)
  Failed tests:  4, 10
  Non-zero exit status: 2
./proxy_bind_transparent.t           (Wstat: 512 Tests: 3 Failed: 2)
  Failed tests:  1-2
  Non-zero exit status: 2
./proxy_ssl_certificate.t            (Wstat: 256 Tests: 7 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./ssl_crl.t                          (Wstat: 512 Tests: 5 Failed: 2)
  Failed tests:  2-3
  Non-zero exit status: 2
./ssl_verify_client.t                (Wstat: 512 Tests: 12 Failed: 2)
  Failed tests:  4-5
  Non-zero exit status: 2
./ssl_verify_depth.t                 (Wstat: 256 Tests: 4 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./stream_proxy_ssl_certificate.t     (Wstat: 256 Tests: 7 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./stream_ssl_verify_client.t         (Wstat: 512 Tests: 12 Failed: 2)
  Failed tests:  3, 5
  Non-zero exit status: 2
Files=290, Tests=3628, 300 wallclock secs ( 1.91 usr  0.46 sys + 54.82 cusr  9.07 csys = 66.26 CPU)

```

Complete log: <http://tpaste.us/Ynw6> or [nginx-tests.log.txt](https://github.com/libressl-portable/portable/files/955912/nginx-tests.log.txt)

/cc [@ncopa](https://github.com/ncopa)

## Metadata

### Assignees

* [![@4a6f656c](https://avatars.githubusercontent.com/u/8142769?s=64&v=4)4a6f656c](/4a6f656c)
* [![@bob-beck](https://avatars.githubusercontent.com/u/8124021?s=64&u=253904b010cbba036c7f4514e41a33a022787148&v=4)bob-beck](/bob-beck)
### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0ca7a5f9_20250124_173813.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibressl%2Fportable%2Fissues%2F307)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibressl%2Fportable%2Fissues%2F307)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=libressl%2Fportable)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[libressl](/libressl)
/
**[portable](/libressl/portable)**
Public

* [Notifications](/login?return_to=%2Flibressl%2Fportable) You must be signed in to change notification settings
* [Fork
  265](/login?return_to=%2Flibressl%2Fportable)
* [Star
   1.4k](/login?return_to=%2Flibressl%2Fportable)

* [Code](/libressl/portable)
* [Issues
  81](/libressl/portable/issues)
* [Pull requests
  5](/libressl/portable/pulls)
* [Actions](/libressl/portable/actions)
* [Security](/libressl/portable/security)
* [Insights](/libressl/portable/pulse)

Additional navigation options

* [Code](/libressl/portable)
* [Issues](/libressl/portable/issues)
* [Pull requests](/libressl/portable/pulls)
* [Actions](/libressl/portable/actions)
* [Security](/libressl/portable/security)
* [Insights](/libressl/portable/pulse)

# Some nginx TLS tests started failing with LibreSSL 2.5.3 (but not with 2.4.4) #307

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Some nginx TLS tests started failing with LibreSSL 2.5.3 (but not with 2.4.4)](#top)#307Copy linkAssignees [![bob-beck](https://avatars.githubusercontent.com/u/8124021?s=64&u=253904b010cbba036c7f4514e41a33a022787148&v=4)](/bob-beck)[![4a6f656c](https://avatars.githubusercontent.com/u/8142769?s=64&v=4)](/4a6f656c)[![@jirutka](https://avatars.githubusercontent.com/u/949228?u=fc07aa51a80b95b776f1cf16da7dc3d55499b615&v=4&size=80)](/jirutka)
## Description

[![@jirutka](https://avatars.githubusercontent.com/u/949228?u=fc07aa51a80b95b776f1cf16da7dc3d55499b615&v=4&size=48)](/jirutka)[jirutka](https://github.com/jirutka)opened [on Apr 25, 2017](https://github.com/libressl/portable/issues/307#issue-224210682)

After we updated LibreSSL from 2.4.4. to 2.5.3 in Alpine Linux, we have noticed that some TLS-related tests in nginx (both 1.10.3 and 1.12.0) started failing. Moreover, most of them fail because nginx accepted certificate that should be rejected! That’s pretty bad regression.

We’re not sure if the problem is in LibreSSL, nginx or nginx-tests, so reporting it to both. Nginx bug report: <https://trac.nginx.org/nginx/ticket/1257>.

People from VoidLinux have reproduced this issue too, on glibc.

```
Test Summary Report
-------------------
./h2_ssl_verify_client.t             (Wstat: 256 Tests: 5 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./mail_imap_ssl.t                    (Wstat: 512 Tests: 14 Failed: 2)
  Failed tests:  4, 10
  Non-zero exit status: 2
./proxy_bind_transparent.t           (Wstat: 512 Tests: 3 Failed: 2)
  Failed tests:  1-2
  Non-zero exit status: 2
./proxy_ssl_certificate.t            (Wstat: 256 Tests: 7 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./ssl_crl.t                          (Wstat: 512 Tests: 5 Failed: 2)
  Failed tests:  2-3
  Non-zero exit status: 2
./ssl_verify_client.t                (Wstat: 512 Tests: 12 Failed: 2)
  Failed tests:  4-5
  Non-zero exit status: 2
./ssl_verify_depth.t                 (Wstat: 256 Tests: 4 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./stream_proxy_ssl_certificate.t     (Wstat: 256 Tests: 7 Failed: 1)
  Failed test:  2
  Non-zero exit status: 1
./stream_ssl_verify_client.t         (Wstat: 512 Tests: 12 Failed: 2)
  Failed tests:  3, 5
  Non-zero exit status: 2
Files=290, Tests=3628, 300 wallclock secs ( 1.91 usr  0.46 sys + 54.82 cusr  9.07 csys = 66.26 CPU)

```

Complete log: <http://tpaste.us/Ynw6> or [nginx-tests.log.txt](https://github.com/libressl-portable/portable/files/955912/nginx-tests.log.txt)

/cc [@ncopa](https://github.com/ncopa)

## Metadata

### Assignees

* [![@4a6f656c](https://avatars.githubusercontent.com/u/8142769?s=64&v=4)4a6f656c](/4a6f656c)
* [![@bob-beck](https://avatars.githubusercontent.com/u/8124021?s=64&u=253904b010cbba036c7f4514e41a33a022787148&v=4)bob-beck](/bob-beck)
### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


