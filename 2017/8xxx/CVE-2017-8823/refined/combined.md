=== Content from bugs.torproject.org_66a5e91f_20250125_075240.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

This is an archived project. Repository and other project resources are read-only.

# Fix TROVE-2017-013: Use-after-free in onion service v2 when rotating intro points

Ticket for high severity issue TROVE-2017-013

See <https://trac.torproject.org/projects/tor/wiki/TROVE>

```
TROVE-2017-13: Use-after-free in onion service v2 when rotating intro points

SEVERITY: High

ALSO TRACKED AS: CVE-2017-8823

DESCRIPTION

    An onion service v2 expires its intro points regularly at least
    once very 24 hours. While removing an intro point, if no circuit
    is found, it is put in a retry list. Then just after, if it is
    removed because it is expiring, it is put in the expiring list.

    Tor then tries to open a circuit to that node and, on failure, it
    will free the intro point without removing it from the expiring
    list ultimately leading to a use-after-free.

    This can only happens in specific conditions which are that the
    service's is unable to launch circuits, this can happen if it is
    missing descriptors for instance and if the intro points was just
    being expired. It only affects version 2 services.

MITIGATION NOTES:

    1. If you are not running an onion service, this doesn't affect
       you.

    2. If you are running tor version <= 0.2.6, this doesn't affect
       you.

    3. We believe this to be quite difficult to trigger remotely
       because of the specific conditions that tor needs to be
       in. However, it could be possible but hard to be induced by a
       malicious Guard node suspecting a connection to be an onion
       service.

ACKNOWLEDGMENTS:

    Thanks to an anonymous reporter on our bugtracker that opened a
    ticket which lead to the discovery of this issue.

FIX:

    Anybody running an onion service on an affected version should
    upgrade to one of the releases with the fix for this issue:
    0.2.8.17, 0.2.9.14, 0.3.0.13, 0.3.1.9, or 0.3.2.6-alpha.
```

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from bugs.torproject.org_bfa5eaf3_20250126_072336.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

This is an archived project. Repository and other project resources are read-only.

# Crash: died: Caught signal 11 [crash from rend\_consider\_services\_intro\_points]

```
[notice] Tor has successfully opened a circuit. Looks like client functionality is working.
[notice] Ignoring directory request, since no bridge nodes are available yet.
[notice] Ignoring directory request, since no bridge nodes are available yet.
[notice] Your network connection speed appears to have changed. Resetting timeout to 60s after 18 timeouts and 892 buildtimes.
[notice] Ignoring directory request, since no bridge nodes are available yet.
[notice] Our directory information is no longer up-to-date enough to build circuits: We're missing descriptors for 1/2 of our primary entry guards (total microdescriptors: 6124/6450).
[notice] I learned some more directory information, but not enough to build a circuit: We're missing descriptors for 1/2 of our primary entry guards (total microdescriptors: 6124/6450).
[notice] Ignoring directory request, since no bridge nodes are available yet.
[notice] Ignoring directory request, since no bridge nodes are available yet.
[notice] Ignoring directory request, since no bridge nodes are available yet.
[notice] Ignoring directory request, since no bridge nodes are available yet.
[notice] Ignoring directory request, since no bridge nodes are available yet.
[notice] Tor has successfully opened a circuit. Looks like client functionality is working.
[notice] Tor has successfully opened a circuit. Looks like client functionality is working.
[warn] Error launching circuit to node [scrubbed] for service [scrubbed].
[warn] Error launching circuit to node [scrubbed] for service [scrubbed].
[warn] Error launching circuit to node [scrubbed] for service [scrubbed].
[warn] Error launching circuit to node [scrubbed] for service [scrubbed].
[warn] Error launching circuit to node [scrubbed] for service [scrubbed].
[warn] Error launching circuit to node [scrubbed] for service [scrubbed].
[warn] Error launching circuit to node [scrubbed] for service [scrubbed].
[warn] Error launching circuit to node [scrubbed] for service [scrubbed].
============================================================ T= 1510821832
Tor 0.3.2.3-alpha (git-894b61b1d19f6235) died: Caught signal 11
/usr/bin/tor(+0x1830c9)[0x55c71b98d0c9]
/usr/bin/tor(extend_info_free+0x1d)[0x55c71b8e0add]
/usr/bin/tor(extend_info_free+0x1d)[0x55c71b8e0add]
/usr/bin/tor(rend_intro_point_free+0x25)[0x55c71b88a8d5]
/usr/bin/tor(rend_consider_services_intro_points+0x5c4)[0x55c71b894744]
/usr/bin/tor(hs_service_run_scheduled_events+0xa1c)[0x55c71b97c15c]
/usr/bin/tor(+0x4e931)[0x55c71b858931]
/usr/bin/tor(+0x6e6d0)[0x55c71b8786d0]
/usr/lib/x86_64-linux-gnu/libevent-2.0.so.5(event_base_loop+0x6a0)[0x7f0067487420]
/usr/bin/tor(do_main_loop+0x29d)[0x55c71b85be1d]
/usr/bin/tor(tor_main+0x1c25)[0x55c71b85f925]
/usr/bin/tor(main+0x19)[0x55c71b8575c9]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf1)[0x7f0065ea31c1]
/usr/bin/tor(_start+0x2a)[0x55c71b85761a]
```

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from trac.torproject.org_24b1a8a3_20250126_072334.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

This is an archived project. Repository and other project resources are read-only.

## Pages

1619



=== Content from www.debian.org_86b47815_20250125_075241.html ===


---

[[Date Prev](msg00316.html)][[Date Next](msg00318.html)]
[[Thread Prev](msg00316.html)][[Thread Next](msg00318.html)]
[[Date Index](maillist.html#00317)]
[[Thread Index](threads.html#00317)]

# [SECURITY] [DSA 4054-1] tor security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4054-1] tor security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 3 Dec 2017 19:53:58 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20171203185358.r6frr5osk7iqd3zv%40pisco.westfalen.local)Â [20171203185358.r6frr5osk7iqd3zv@pisco.westfalen.local](msg00317.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4054-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 03, 2017                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : tor
CVE ID         : CVE-2017-8819 CVE-2017-8820 CVE-2017-8821 CVE-2017-8822
                 CVE-2017-8823

Multiple vulnerabilities have been found in Tor, a connection-based
low-latency anonymous communication system.

For the oldstable distribution (jessie), these problems have been fixed
in version 0.2.5.16-1.

For the stable distribution (stretch), these problems have been fixed in
version 0.2.9.14-1.

We recommend that you upgrade your tor packages.

For the detailed security status of tor please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/tor>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlokR9MACgkQEMKTtsN8
TjZE9Q//SFF17onhGafnjYY+Sz9xsWRAU1BcZUI9OpoJmOtvzSbQOf4Xd1jQs+Xt
p1doWTw/yiKjzqf9Yi5dfhcLVgLJ5TzLLptB5JTAqgkE95C5NL7wNbjvXXbRn1f9
TR+KED8vxd6y6p96IeVMbiMm0ROBIZ3KuWVRlJGFZQtNA+1J/+/7/lP+PGReFyHu
4cq9M0OH8DVGnOW6Qr+xK2gtIC4K3xgAqNBSnC/mmiQkGIJT8eeBJ9Ngm1FutgZK
5WdaC1bPqv8TghwZBeg9TfJl+cJPm74X1gJYEZM8EcI/f/CGaCtZX04ACF5IwPlB
fLTMBdGMF2WNc9iklT4RzYe/UMefLLCswFLsH25dwobO4/w/o3++av2smyqmzabe
kpSjkcj/z3KbxljHPoXb9j68b3d/yrhypxa/rXfo9yCZvWOgwXY20WzVlqIOyN9C
qtGO3V0z257w1C9As+xLybmgdJb+nZMQ8V4ABgaAyMmFFo1BLqMwXDoGt6eaDZr6
Ph1BD7aXay+v8zic5QYJmWwdO9sTmzNCiIWlw/Tb5hkGD6FzcyMPtjW3Ohjc7s8k
eyIiY4FZRZwslyIkLhY8tOeen/TOcDkh4T4X6wyDq3jkURqcpICUXwNUtHnK0OA6
xQy80FdX+tOboah+gVxEhqn5rEuAFPP8nQxUR4fsy0r2bDgvWpQ=
=BMm1
-----END PGP SIGNATURE-----

```

---



=== Content from blog.torproject.org_19e5e55f_20250125_075239.html ===

[![Tor Blog](../static/images/logo.png)](../)

* [About](https://www.torproject.org/about/history/)
* [Support](https://support.torproject.org/)
* [Community](https://community.torproject.org/)
* [Forum](https://forum.torproject.org/)
* [Donate](https://donate.torproject.org/)

# New stable Tor releases, with security fixes: 0.3.1.9, 0.3.0.13, 0.2.9.14, 0.2.8.17, 0.2.5.16

by nickm | December 1, 2017

![](../static/images/lead.png)

There are new stable releases today, fixing the following security issues.Ã‚Â  For more information about the issues, follow the links from from<https://trac.torproject.org/projects/tor/wiki/TROVE>

TROVE-2017-009: Replay-cache ineffective for v2 onion services

TROVE-2017-010: Remote DoS attack against directory authorities

TROVE-2017-011: An attacker can make Tor ask for a password

TROVE-2017-012: Relays can pick themselves in a circuit path

TROVE-2017-013: Use-after-free in onion service v2

You can download the source for 0.3.1.9 from the usual place on the website. For the older release series, see <https://dist.torproject.org/>. Binary packages should be available soon. All users should update to one of these releases, or to 0.3.2.6-alpha, also released today.

Below is the changelog for 0.3.1.9.Ã‚Â  For the other releases, see the [tor-announceme email](https://lists.torproject.org/pipermail/tor-announce/2017-December/000147.html).

Tor 0.3.1.9 backports important security and stability fixes from the 0.3.2 development series. All Tor users should upgrade to this release, or to another of the releases coming out today.

## Changes in version 0.3.1.9 - 2017-12-01:

* Major bugfixes (security, backport from 0.3.2.6-alpha):
  + Fix a denial of service bug where an attacker could use a malformed directory object to cause a Tor instance to pause while OpenSSL would try to read a passphrase from the terminal. (Tor instances run without a terminal, which is the case for most Tor packages, are not impacted.) Fixes bug [24246](https://bugs.torproject.org/24246); bugfix on every version of Tor. Also tracked as TROVE-2017-011 and CVE-2017-8821. Found by OSS-Fuzz as testcase 6360145429790720.
  + Fix a denial of service issue where an attacker could crash a directory authority using a malformed router descriptor. Fixes bug [24245](https://bugs.torproject.org/24245); bugfix on 0.2.9.4-alpha. Also tracked as TROVE-2017-010 and CVE-2017-8820.
  + When checking for replays in the INTRODUCE1 cell data for a (legacy) onion service, correctly detect replays in the RSA- encrypted part of the cell. We were previously checking for replays on the entire cell, but those can be circumvented due to the malleability of Tor's legacy hybrid encryption. This fix helps prevent a traffic confirmation attack. Fixes bug [24244](https://bugs.torproject.org/24244); bugfix on 0.2.4.1-alpha. This issue is also tracked as TROVE-2017-009 and CVE-2017-8819.
* Major bugfixes (security, onion service v2, backport from 0.3.2.6-alpha):
  + Fix a use-after-free error that could crash v2 Tor onion services when they failed to open circuits while expiring introduction points. Fixes bug [24313](https://bugs.torproject.org/24313); bugfix on 0.2.7.2-alpha. This issue is also tracked as TROVE-2017-013 and CVE-2017-8823.

Ã‚

* Major bugfixes (security, relay, backport from 0.3.2.6-alpha):
  + When running as a relay, make sure that we never build a path through ourselves, even in the case where we have somehow lost the version of our descriptor appearing in the consensus. Fixes part of bug [21534](https://bugs.torproject.org/21534); bugfix on 0.2.0.1-alpha. This issue is also tracked as TROVE-2017-012 and CVE-2017-8822.
  + When running as a relay, make sure that we never choose ourselves as a guard. Fixes part of bug [21534](https://bugs.torproject.org/21534); bugfix on 0.3.0.1-alpha. This issue is also tracked as TROVE-2017-012 and CVE-2017-8822.
* Major bugfixes (exit relays, DNS, backport from 0.3.2.4-alpha):
  + Fix an issue causing DNS to fail on high-bandwidth exit nodes, making them nearly unusable. Fixes bugs 21394 and 18580; bugfix on 0.1.2.2-alpha, which introduced eventdns. Thanks to Dhalgren for identifying and finding a workaround to this bug and to Moritz, Arthur Edelstein, and Roger for helping to track it down and analyze it.
* Minor features (bridge):
  + Bridges now include notice in their descriptors that they are bridges, and notice of their distribution status, based on their publication settings. Implements ticket [18329](https://bugs.torproject.org/18329). For more fine- grained control of how a bridge is distributed, upgrade to 0.3.2.x or later.
* Minor features (directory authority, backport from 0.3.2.6-alpha):
  + Add an IPv6 address for the "bastet" directory authority. Closes ticket [24394](https://bugs.torproject.org/24394).
* Minor features (geoip):
  + Update geoip and geoip6 to the November 6 2017 Maxmind GeoLite2 Country database.
* Minor bugfix (relay address resolution, backport from 0.3.2.1-alpha):
  + Avoid unnecessary calls to directory\_fetches\_from\_authorities() on relays, to prevent spurious address resolutions and descriptor rebuilds. This is a mitigation for bug [21789](https://bugs.torproject.org/21789). Fixes bug [23470](https://bugs.torproject.org/23470); bugfix on in 0.2.8.1-alpha.
* Minor bugfixes (compilation, backport from 0.3.2.1-alpha):
  + Fix unused variable warnings in donna's Curve25519 SSE2 code. Fixes bug [22895](https://bugs.torproject.org/22895); bugfix on 0.2.7.2-alpha.
* Minor bugfixes (logging, relay shutdown, annoyance, backport from 0.3.2.2-alpha):
  + When a circuit is marked for close, do not attempt to package any cells for channels on that circuit. Previously, we would detect this condition lower in the call stack, when we noticed that the circuit had no attached channel, and log an annoying message. Fixes bug [8185](https://bugs.torproject.org/8185); bugfix on 0.2.5.4-alpha.
* Minor bugfixes (onion service, backport from 0.3.2.5-alpha):
  + Rename the consensus parameter "hsdir-interval" to "hsdir\_interval" so it matches dir-spec.txt. Fixes bug [24262](https://bugs.torproject.org/24262); bugfix on 0.3.1.1-alpha.
* Minor bugfixes (relay, crash, backport from 0.3.2.4-alpha):
  + Avoid a crash when transitioning from client mode to bridge mode. Previously, we would launch the worker threads whenever our "public server" mode changed, but not when our "server" mode changed. Fixes bug [23693](https://bugs.torproject.org/23693); bugfix on 0.2.6.3-alpha.

* [releases](../category/releases)

## Comments

Comments are closed.

## Recent Updates

## [New Alpha Release: Tor Browser 14.5a2](/new-alpha-release-tor-browser-145a2/)

by [ma1](/author/ma1) | January 14, 2025

Tor Browser 14.5a2 is now available from the Tor Browser download page and also from our distribution directory.

## [New Release: Tails 6.11](/new-release-tails-611/)

by [tails](/author/tails) | January 9, 2025

Tails 6.11 fixes several critical security vulnerabilities that were identified during an external audit.

## [New Release: Tor Browser 14.0.4](/new-release-tor-browser-1404/)

by [morgan](/author/morgan) | January 8, 2025

Tor Browser 14.0.4 is now available from the Tor Browser download page and also from our distribution directory.

### Download Tor Browser

Download Tor Browser to experience real private browsing without tracking, surveillance, or censorship.

[Download Tor Browser](https://www.torproject.org/download/)

### Subscribe to our Newsletter

Get monthly updates and opportunities from the Tor Project:

[Sign up](https://newsletter.torproject.org/)

####

####

####

####

####

####

####

Trademark, copyright notices, and rules for use by third parties can be found in our [FAQ](https://www.torproject.org/about/trademark/).


