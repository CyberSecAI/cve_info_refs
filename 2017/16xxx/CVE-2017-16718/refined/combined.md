=== Content from download.beckhoff.com_db140ff8_20250124_164235.html ===
Beckhoff Security Advisory

Advisory 2017-002: Add Route using "Encrypted Password" bases on fixed
key

Publication Date
Last Update
Current Version
Related CVE
CVSS 3.0
Weakness Enumerator

03/13/2017
12/18/2023
1.3
CVE-2017-16718
5.9 Medium (AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N)
CWE-321 Use of Hard-coded Cryptographic Key

Summary

Adding routes in ADS router supports encryption of credentials. This encryption bases on a fixed key. Attackers
could extract the fixed key in order to decrypt those credentials. Adding routes only locally prevents exposure
of the credentials.

Appearance

▪  All TwinCAT 3 Components featuring ADS remote route creation, except TwinCAT/BSD based

products

Description

Beckhoff  TwinCAT  3  supports  communication  over  ADS.  ADS  is  a  protocol  for  industrial  automation  in
protected environments [1]. This protocol uses user configured routes, that can be edited remotely via ADS.
This  special  command  supports  encrypted  authentication  with  username/password.  The  encryption  uses  a
fixed key, that could be extracted by an attacker.

Precondition of the exploitation of this weakness is network access at the moment a route is added.

Please note: TwinCAT/BSD based products have been released only after this advisory was published first
time. They come with default settings where the vulnerable ADS communication is blocked. Secure ADS is
used as a default replacement there which guards the credentials with a TLS encryption.

Solution

By adding the static routes only locally, no credentials will be transferred via network.

https://infosys.beckhoff.com/content/1033/tc3_system/818866059.html

Alternative is to block plain ADS and use Secure ADS only as described with the following document:

https://download.beckhoff.com/download/document/automation/twincat3/Secure_ADS_EN.pdf

All recent products from Beckhoff support it.

Please note: Because TwinCAT/BSD based products come with default settings which do forbid plain ADS

communication but allow Secure ADS communication these settings shall not be changed for security

reasons.

Beckhoff Automation GmbH & Co. KG
Hülshorstweg 20, 33415 Verl, Germany
Phone: +49 (0) 52 46/9 63 - 0
E-Mail: product-secincident@beckhoff.com
www.beckhoff.com

18.12.2023
Page 1 of 2

Beckhoff Security Advisory

Acknowledgement

Beckhoff Automation thanks for his support and efforts:

▪ Peter Schwanke, who is a student at FH Aachen, for coordinated disclosure.

Reporting vulnerabilities

Beckhoff Automation welcomes responsibly coordinated reports of vulnerabilities and Beckhoff will collaborate

with reporting parties to fix vulnerabilities or mitigate threats.

Additional Resources

[1] A general guideline for Beckhoff IPC Security:

http://download.beckhoff.com/download/Document/product-security/ipc_security_en.pdf

History

V 1.0
V 1.1

V 1.2

V 1.3

03/13/2017
07/02/2018

12/11/2023

12/18/2023

Publication
Added CVE
Added exception for TwinCAT/BSD
Added the use of Secure ADS as an alternative.
Corrected a hyperlink

Beckhoff Automation GmbH & Co. KG
Hülshorstweg 20, 33415 Verl, Germany
Phone: +49 (0) 52 46/9 63 - 0
E-Mail: product-secincident@beckhoff.com
www.beckhoff.com

18.12.2023
Page 2 of 2


