=== Content from medium.com_788f081c_20250125_183141.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4eabeca6bdbc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40esterling_%2Fcve-2017-16560-sandisk-secure-access-leaves-plain-text-copies-of-files-on-disk-4eabeca6bdbc&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40esterling_%2Fcve-2017-16560-sandisk-secure-access-leaves-plain-text-copies-of-files-on-disk-4eabeca6bdbc&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2017-16560 — SanDisk SecureAccess can leave plain-text temporary files on disk

[![Ethan](https://miro.medium.com/v2/resize:fill:88:88/0*_QoR1nv_sFVRxylS.jpg)](/%40esterling_?source=post_page---byline--4eabeca6bdbc--------------------------------)

[Ethan](/%40esterling_?source=post_page---byline--4eabeca6bdbc--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f2d166a8dc6&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40esterling_%2Fcve-2017-16560-sandisk-secure-access-leaves-plain-text-copies-of-files-on-disk-4eabeca6bdbc&user=Ethan&userId=5f2d166a8dc6&source=post_page-5f2d166a8dc6--byline--4eabeca6bdbc---------------------post_header-----------)

5 min read·Nov 15, 2017

--

4

Listen

Share

![]()

I recently picked up a SanDisk Ultra USB 3.0 128GB flash drive, it’s a fairly old model so I got it for cheap, but I noticed it came standard with a piece of SanDisk-branded encryption software. SanDisk SecureAccess is developed by a third-party named [EncryptStick](https://encryptstick.com/).

I couldn’t find any real reviews when I looked so I figured I do a bit of digging, and it wasn’t long before it became apparent that there was an issue with how the software handles opening encrypted files.

The software provides two methods for opening files, either you can “copy” them to a new location, whereby the application will load the file into memory, decrypt it, then dump it into the directory of your choice, or you can open the file “in place”. This works as you would expect, you double-click on the file in the file list and it opens in your default application.

![]()

The example file in this case is simply named “Document.docx”

Double-clicking the file to open it in Word, and examining procmon, you can see how this mechanism works. First off the program reads some basic information about the file you're opening, then it creates a temporary file in “%TEMP%\Sandisk SecureAccessV3\”. It then reads the encrypted file into memory, decrypts it, then writes it out to the temporary file.

![]()

In itself this isn’t great, but the real issues occur when the program needs to manage the file it decrypts. If you open a Word doc, for example, you would expect that SecureAccess would monitor the file and delete it when the file is closed. This is not the case, and the file will remain on disk until the user exits SecureAccess. During the exit routine the program will delete any temporary files created during that session.

This problem is made worse by the fact that, if the user has the file locked when they exit SecureAccess, the Delete command will fail. In this circumstance I expected to receive an error from SecureAccess stating that the file was open and must be closed, but instead the application exits and leaves the plain-text file on disk.

![]()

Secure Access tries to delete the file, which promptly fails because the file being locked

![]()

Contents of the temp dir after closing the app

A similar issue exists if the application crashes when the user has a file open. As SecureAccess creates a plain-text copy of the encrypted file on disk, if the program exits unexpectedly (program crash, power failure, or the user ends the process) the routine to delete the temporary files does not run, so any files you’ve opened during that session remain on disk in plain-text.

This is exacerbated by the way that Windows handles the “%TEMP%” directory. In standard operation this directory is not emptied unless the user explicitly empties it, either by deleting the content manually or using some other utility. Thus a user who uses SecureAccess fairly regularly is much more likely to end up with some plain-text copies of their files sat on their disk.

## Communication with vendor

After discovering this issue I reported it to the vendor, SanDisk , on the 5th of November and waited for a response. I received the initial response from the vendor in just six days which stated the following:

> Thank you for contacting SanDisk® Global Customer Care. We sincerely appreciate you sharing your feedback and pointing this out for us to know.
>
> Please be informed the application is ‘as designed’. We need to write a clean copy of the file to some temp space where applications like Word and Excel can access them, and where they can be checked by a virus scanner before they are opened. This implies that they are unencrypted and accessible at that specific moment, otherwise Word and Excel cannot work on then.
>
> *When the application closes, the file should be removed. When the file is locked, there is no way we can remove it or shred it. The OS prevents this.
> When this happens, the user gets a popup warning telling him that the file could not be deleted.*
>
> Please feel free to reply to this email if you have any other concerns.

I wasn’t satisfied with that response, while I understand their stance that they *do* need to store plain-text copies of files on disk temporarily so that user applications can interact with them, the software should *at least* warn the user if there is the possibility that these plain text copies might be left on the disk. They also state that the user would receive a pop-up telling them that the file could not be deleted, however this was not the case in any of my testing.

I followed up on their response outlining this, and that the application should at least give a warning or ideally refuse to exit if it is unable to remove any temporary files it creates, but was met with the following response:

> Thank you for the continued response. We value your feedback and please allow me to inform you that we have discuss this issue with the engineers and it is not a vulnerability, we have confirmed with the engineers that the software works as programmed. There is nothing we can do change it.

## **Timeline**

**05/11/2017** — Initial report to vendor
**11/11/2017** — Response from vendor stating that they do not believe this is a security issue, further details sent
**15/11/2017** — Confirmation from vendor that they do not believe this is a security issue

[Security](/tag/security?source=post_page-----4eabeca6bdbc--------------------------------)[Infosec](/tag/infosec?source=post_page-----4eabeca6bdbc--------------------------------)

--

--

4

[![Ethan](https://miro.medium.com/v2/resize:fill:96:96/0*_QoR1nv_sFVRxylS.jpg)](/%40esterling_?source=post_page---post_author_info--4eabeca6bdbc--------------------------------)[![Ethan](https://miro.medium.com/v2/resize:fill:128:128/0*_QoR1nv_sFVRxylS.jpg)](/%40esterling_?source=post_page---post_author_info--4eabeca6bdbc--------------------------------)Follow[## Written by Ethan](/%40esterling_?source=post_page---post_author_info--4eabeca6bdbc--------------------------------)[12 Followers](/%40esterling_/followers?source=post_page---post_author_info--4eabeca6bdbc--------------------------------)·[23 Following](/%40esterling_/following?source=post_page---post_author_info--4eabeca6bdbc--------------------------------)

IT man, Infrastructure Engineer, with a big interest in InfoSec and all the related good stuff

Follow
## Responses (4)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----4eabeca6bdbc--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----4eabeca6bdbc--------------------------------)[About](/about?autoplay=1&source=post_page-----4eabeca6bdbc--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----4eabeca6bdbc--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----4eabeca6bdbc--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----4eabeca6bdbc--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4eabeca6bdbc--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4eabeca6bdbc--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----4eabeca6bdbc--------------------------------)[Teams](/business?source=post_page-----4eabeca6bdbc--------------------------------)



=== Content from miro.medium.com_e4353b96_20250126_110219.html ===
���� �Exif  II\*                V       ^   (              i�    f       H      H        �    0210�      �    0100�    ��  �    X   �    X       �� C 

""$$6\*&&\*6>424>LDDL\_Z\_||��� C

""$$6\*&&\*6>424>LDDL\_Z\_||���  X X" ��               �� 7      !1AQaq"��2BR�#b��გ�����             �� +        !A1"Qaq�2�������   ? ��vOf�� S� 4���\_��?�T�� ̉?���6��� d���� Tף�ox�mEO���#�}�?x�Zn.m��in&�(��;�U��[��i�ZKc��s�X!�RA��m�Z�g�5M^S&�}5�n�ĀO^U�>U퓴��v���qLan!���P��
��{E�~��
R��,2�E\*��b�k�̭�����s��@���i̷���B�s�a̽��$ִ�}2[��![y7�$�>{횆i���rF��̊vc�/��G�In�I�O�>�[�B��q�zS݂6���EV�(y
�x�n\d�<D�8�RȘ軳�7�&:֞e>�Պ����Ht��&����x��>'���5k`nDwfď��^Cyl�S߼�A ⴽ1�;t��] i�n �U�E'c����E/�ڋoP3b�Γ��� yU5�MN}M�{��c��H�ث<~o�`M�#� �v� uZ��jtn2S��X�'�S1�?�b���W��RI9�'s����6|���YLǜ�I�s�$�
��A63�k��
��{o>�A����C�B��!��H{�� � &�4�"ɕ�O���mF�x ��]�'f\����Yɢ\�ȓ-��e��[yr��VS��j�|��F�5�#��",:�ǈ@�RF�S=���no�m=��xj�b\��z0Qޫ(e�)RHܫ��:�:�8���$���M�SZ[�]�,��l  UU��}�ߓ�\*�N�F��O��jnZ\_�V=p>.���EK��G�A,��'sԌ�,q�2p3ڊP���6�8�:
�W\*Xg��{��S���E�q N�h�|�`��l3\*�I �����S[���cL�E>�,�$l�4l���pDZFA�c+s
v���QD��9�>����S��;�T����2�!�q��u�Tn!W[X�TnbInr��;3N���Q������^a��[�&Lx���b�ǣ� �ʊĀ:{�Z�f�71�Z'^?1��E�.����������:�u��.s!��1,F0� w�H������FR
�H�Ã��I�%H��d���ː�54��6�s��YK
�����p̺������w�Rc��� &�~X"���#�5�4��|\*� gҠ)��H�B������lh�~��X��eʟ�f���\*�|�����1����f�{�]�$��Z�
F{;�1M���]��Zu�1�Ey1�ne#,͒j���y�U��U�9o�TCP�ng�V�J��9q�O=�\*��n�v�'�/cd�ڀ�`˝��+��#��{qv���u�7m&{[�I!Av��7;�w���.��n�!\������Ρ��r
1����Z�p1b�e�sk��%�C�\T&� N[������{�=7���9VV'#s�O[���vi�J>�nR�̑�'"ʛݑ�ơ�������\��,��HFq��'zG�j2L���B��X�??A��j�`����iN!�&wy�gb �7��J�� þ�� =�:� ���;�<���z��>�rG#��F\�V�!�H�[�nc��1`��3��4\&繢�)���9\_�)�᲼�gҙ��2����M�71;cΛ�ĝ�5�ޘ/F$ I�pU���Z�����9�;���I��ѿ�U܃�@˶NA�5;�T���l�6� ��}����)j\�gc=�B4�
��uD�M�
��25��'\*ѐA��{T�Ì��B��H�Pj��q(�.1����<�+ ���w�U��@a/D�%��Ы��#U� j7b�J�s�8���j���n"0�ه���&���Qt}~��Tf�C��,w\*rҶV+m?�`���]%�=a��,�?Ȓ^s����������W��1zσE"Q�EsM�ܬ�'4�\_���QEl�e�e�@����~�@����<�C����P�����m��z�����/�~��"M�&?I#;v�J\*
c�.�QHՎ��l����`:�^>e#zT��X�%
᪓n��6����hݻ�pT�y?�Zz����%�)�7���;
�;`�= �4QZL�l�.凮7>��QEI'��

=== Content from miro.medium.com_7ef5901b_20250126_110219.html ===
�PNG

   
IHDR   @   @   %�    pHYs     ��  �IDATx��Zmo�8&)ˎ��l��b7����ڭE\��v�&��}P�eI�&�׬�=(��
ɇ������A�& ����ށ�W(������,�����?'����hx��Z�4�1�s ���t2�N�NG����#PU�b1�n� Md��ݻ?...`�P������ij��?����ggo>|�����,"w��s�˗�ֺ$I�Q�fv�i�|��w���B�A$f���ǹAk�s� ��Zk熛�ϣ�~�]8����9j9�$�{3��ɭ�;�}׵EQh���Z�eѶm4��xB���D����EH���}4��8���ι�^\*y�J�q�ŉ���rY
�������e  {��C�@�?u]+��4 b]�"&Ѷ���NXM�ȘN�!Z�9�� w�Zg��'z��5D�K֚8�[`fkM�x��Yk��� C� �Bn�B��;���a��(��E�$Y�c�#�� Z��������D���z f�xI�QB� ,���,I�G8�$
��$�-�\_:I�0���t�L��L��G�C��h��h����2̌�J���"%w I�R����T���c�d�A8ԧi&t���,�hE���6�n�33sP
�P�������6��֞���y�a�D ����c�O�;�f6������/����g���������\_^]}���6d�\_]]с�{O�{�P!u �n�a8􊅈�ap��/�  t]�|�Z2��3ԩ#ڡ�,��,K ���B� �1M�<��WJ-��1f�����~+1�G���k���dg���Lvm=��4���ap]׵m��]�����gɟ���K��i��y>Ͳl�`�f{�{��/��YcL������1�R$�$a�COADZ�,�L&�,��4M���][�#���\.����Z���=#B`�HcL2���������:�L��d���Y8f[n�q�����b�[�ͬ��u ����J��o߽����������2M�Q����Hf�:�7�^^^l�O?,����� �\_;@JӴ(ʇ�l� �����C^�O�0�������\_��7c��n��AD��o���1��ڛ�(%�/�uU����ꁛ����7\_� "���i��\_1.˂�7��� ¢(V?���45����%A�ڶ�~}1�4Kkݫ�?�u9�"��\*\_� "Zefn�F�//"jۚ��m[��o[���z�TU�c��u]�
'�<�%    IEND�B`�
