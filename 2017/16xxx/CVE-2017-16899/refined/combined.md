=== Content from security-tracker.debian.org_1086e408_20250126_012203.html ===

# CVE-2017-16899

| **Name** | CVE-2017-16899 |
| --- | --- |
| **Description** | An array index error in the fig2dev program in Xfig 3.2.6a allows remote attackers to cause a denial-of-service attack or information disclosure with a maliciously crafted Fig format file, related to a negative font value in dev/gentikz.c, and the read\_textobject functions in read.c and read1\_3.c. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2017-16899) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2017-16899); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2017-16899), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2017-16899), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2017-16899), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2017-16899), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-16899), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2017-16899), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2017-16899), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2017-16899)/[CVE](https://www.suse.com/security/cve/CVE-2017-16899/), GitHub [advisories](https://github.com/advisories?query=CVE-2017-16899)/[code](https://github.com/search?type=Code&q=%22CVE-2017-16899%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2017-16899%22), [web search](https://duckduckgo.com/html?q=%22CVE-2017-16899%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [881143](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=881143) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [fig2dev](/tracker/source-package/fig2dev) ([PTS](https://tracker.debian.org/pkg/fig2dev)) | bullseye | 1:3.2.8-3+deb11u1 | fixed |
|  | bookworm | 1:3.2.8b-3 | fixed |
|  | trixie | 1:3.2.9a-1 | fixed |
|  | sid | 1:3.2.9a-2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [fig2dev](/tracker/source-package/fig2dev) | source | stretch | 1:3.2.6a-2+deb9u1 |  |  |  |
| [fig2dev](/tracker/source-package/fig2dev) | source | (unstable) | 1:3.2.6a-5 |  |  | [881143](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=881143) |
| [transfig](/tracker/source-package/transfig) | source | jessie | 1:3.2.5.e-4+deb8u1 |  |  |  |
| [transfig](/tracker/source-package/transfig) | source | (unstable) | (unfixed) |  |  |  |

## Notes

```
[wheezy] - transfig <no-dsa> (Minor issue)

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from bugs.debian.org_32aeaa44_20250124_134136.html ===

# Debian Bug report logs - #881143 fig2dev: CVE-2017-16899: out of bound read while running fig2dev with -L tikz

[![version graph](version.cgi?collapse=1;package=fig2dev;found=fig2dev%2F1%3A3.2.6a-4;found=fig2dev%2F1%3A3.2.6a-2;fixed=fig2dev%2F1%3A3.2.6a-5;fixed=fig2dev%2F1%3A3.2.6a-2%2Bdeb9u1;fixed=transfig%2F1%3A3.2.5.e-4%2Bdeb8u1;absolute=0;height=2;width=2)](version.cgi?absolute=0;collapse=1;fixed=fig2dev%2F1%3A3.2.6a-5;fixed=fig2dev%2F1%3A3.2.6a-2%2Bdeb9u1;fixed=transfig%2F1%3A3.2.5.e-4%2Bdeb8u1;package=fig2dev;info=1;found=fig2dev%2F1%3A3.2.6a-4;found=fig2dev%2F1%3A3.2.6a-2)

Package:
[fig2dev](pkgreport.cgi?package=fig2dev);
Maintainer for [fig2dev](pkgreport.cgi?package=fig2dev) is [Roland Rosenfeld <roland@debian.org>](pkgreport.cgi?maint=roland%40debian.org); Source for [fig2dev](pkgreport.cgi?package=fig2dev) is [src:fig2dev](pkgreport.cgi?src=fig2dev) ([PTS](https://tracker.debian.org/pkg/fig2dev), [buildd](https://buildd.debian.org/fig2dev), [popcon](https://qa.debian.org/popcon.php?package=fig2dev)).

Reported by: [Joonun Jang <joonun.jang@gmail.com>](pkgreport.cgi?submitter=joonun.jang%40gmail.com)

Date: Wed, 8 Nov 2017 06:45:02 UTC

Severity: important

Tags: security

Found in versions fig2dev/1:3.2.6a-4, fig2dev/1:3.2.6a-2

Fixed in versions fig2dev/1:3.2.6a-5, fig2dev/1:3.2.6a-2+deb9u1, transfig/1:3.2.5.e-4+deb8u1

**Done:** Roland Rosenfeld <roland@debian.org>

Bug is archived. No further changes may be made.

Forwarded to Thomas Loimer <thomas.loimer@tuwien.ac.at>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=881143;mbox=yes), [status mbox](bugreport.cgi?bug=881143;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=881143;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, joonun.jang@gmail.com, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Roland Rosenfeld <roland@debian.org>`:

`Bug#881143`; Package `fig2dev`.
(Wed, 08 Nov 2017 06:45:04 GMT) ([full text](bugreport.cgi?bug=881143;msg=2), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Joonun Jang <joonun.jang@gmail.com>`:

New Bug report received and forwarded. Copy sent to `joonun.jang@gmail.com, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Roland Rosenfeld <roland@debian.org>`.
(Wed, 08 Nov 2017 06:45:04 GMT) ([full text](bugreport.cgi?bug=881143;msg=4), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=881143;msg=5), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=joonun.jang%40gmail.com)
From: Joonun Jang <joonun.jang@gmail.com>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: fig2dev: out of bound read while running fig2dev with -L tikz
Date: Wed, 08 Nov 2017 15:40:29 +0900
```
[[Message part 1](bugreport.cgi?att=0;bug=881143;msg=5) (text/plain, inline)]
```
```
Package: fig2dev
Version: 1:3.2.6a-4
Severity: important
Tags: security

out of bound read while running fig2dev with -L tikz option

Running 'fig2dev -L tikz poc' with the attached file raises out of bound read bug
which may allow a remote attack to cause a denial-of-service attack or information
disclosure with a crafted file.

I expected the program to terminate without segfault, but the program crashes as follow

I sent this to debian security team before, but I didn't get any response.
So I send this to public.

=======================================================
june@june:~/project/analyze/poc/fig2dev/crash1$ fig2dev -L tikz poc
\ifx\XFigwidth\undefined\dimen1=0pt\else\dimen1\XFigwidth\fi
\divide\dimen1 by 1
\ifx\XFigheight\undefined\dimen3=0pt\else\dimen3\XFigheight\fi
\divide\dimen3 by 5
\ifdim\dimen1=0pt\ifdim\dimen3=0pt\dimen1=-9223372036854775808sp\dimen3\dimen1
\else\dimen1\dimen3\fi\else\ifdim\dimen3=0pt\dimen3\dimen1\fi\fi
\tikzpicture[x=+\dimen1, y=+\dimen3]
{\ifx\XFigu\undefined\catcode`\@11
\def\temp{\alloc@1\dimen\dimendef\insc@unt}\temp\XFigu\catcode`\@12\fi}
\XFigu-9223372036854775808sp
% Uncomment to scale line thicknesses with the same
% factor as width of the drawing.
%\pgfextractx\XFigu{\pgfqpointxy{1}{1}}
\ifdim\XFigu<0pt\XFigu-\XFigu\fi
\clip(91,-1) rectangle (92,4);
\tikzset{inner sep=+0pt, outer sep=+0pt}
Segmentation fault

[debugging]
Program received signal SIGSEGV, Segmentation fault.
strlen () at ../sysdeps/x86_64/strlen.S:106
106 ../sysdeps/x86_64/strlen.S: No such file or directory.
(gdb) bt
#0  strlen () at ../sysdeps/x86_64/strlen.S:106
#1  0x00007ffff7339d78 in _IO_vfprintf_internal (s=0x7ffff768b600 <_IO_2_1_stdout_>,
format=<optimized out>, ap=ap@entry=0x7fffffffde88) at vfprintf.c:1637
#2  0x00007ffff7340157 in __fprintf (stream=<optimized out>,
format=format@entry=0x5555555cc7e5 "\\normalfont%s ") at fprintf.c:32
#3  0x00005555555b4615 in put_font (t=0x555555810160) at gentikz.c:1725
#4  gentikz_text (t=0x555555810160) at gentikz.c:1769
#5  0x00005555555618cd in gendev_objects (dev=0x5555557f8ec0 <dev_tikz>, objects=0x7fffffffdfa0)
at fig2dev.c:833
#6  main (argc=<optimized out>, argv=<optimized out>) at fig2dev.c:467
(gdb) x/i $rip
=> 0x7ffff7371646 <strlen+38>:  movdqu (%rax),%xmm4
(gdb) i r rax
rax            0x29292922 690563362
(gdb) f 3
#3  0x00005555555b4615 in put_font (t=0x555555810160) at gentikz.c:1725
1725        fprintf(tfp, "\\normalfont%s ",
(gdb) p t->font
$1 = -51
(gdb) p texfonts[-51]
$3 = 0x29292922 <error: Cannot access memory at address 0x29292922>

with attached file, t->font can be set to negative value which causes this bug
[fig2dev/dev/gentikz.c]
1724   else
1725       fprintf(tfp, "\\normalfont%s ",
1726         texfonts[t->font <= MAX_FONT ? t->font : MAX_FONT - 1]);

=======================================================

This bug was found with a fuzzer developed by 'SoftSec' group at KAIST.

-- System Information:
Debian Release: buster/sid
  APT prefers unstable-debug
  APT policy: (500, 'unstable-debug'), (500, 'testing-debug'), (500, 'stable-updates'), (500, 'testing'), (500, 'stable'), (1, 'experimental-debug')
Architecture: amd64 (x86_64)

Kernel: Linux 4.9.0-3-amd64 (SMP w/1 CPU core)
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8), LANGUAGE=en_US:en (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: systemd (via /run/systemd/system)

Versions of packages fig2dev depends on:
ii  gawk         1:4.1.4+dfsg-1
ii  libc6        2.24-17
ii  libpng16-16  1.6.34-1
ii  libxpm4      1:3.5.12-1
ii  x11-common   1:7.7+19

Versions of packages fig2dev recommends:
ii  ghostscript  9.22~dfsg-1
ii  netpbm       2:10.0-15.3+b2

Versions of packages fig2dev suggests:
pn  xfig  <none>

-- no debconf information

```
```
[[poc](bugreport.cgi?att=1;bug=881143;filename=poc;msg=5) (text/plain, attachment)]
```

---

**Reply sent**
to `Roland Rosenfeld <roland@debian.org>`:

You have marked Bug as forwarded.
(Wed, 08 Nov 2017 08:09:09 GMT) ([full text](bugreport.cgi?bug=881143;msg=7), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=7), [link](#6)).

---

[Message #8](#8) received at 881143-forwarded@bugs.debian.org ([full text](bugreport.cgi?bug=881143;msg=8), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=8), reply):

![](/cgi-bin/libravatar.cgi?email=roland%40debian.org)
From: Roland Rosenfeld <roland@debian.org>
To: Thomas Loimer <thomas.loimer@tuwien.ac.at>
Cc: 881143-forwarded@bugs.debian.org
Subject: Bug#881143: fig2dev: out of bound read while running fig2dev with -L
tikz
Date: Wed, 8 Nov 2017 08:56:58 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=881143;msg=8) (text/plain, inline)]
```
```
Hi Thomas!

I received the following bug report against fig2dev, which I can
reproduce here in the same same way.  If you like, I can send you a
"bt full" or doe some more testing...

It seems that the FIG file parser of fig2dev should be somewhat
hardened, so it doesn't accept all input as valid.

Since some printer drivers internally run fig2dev, I have to admit
that this may be security relevant.

Greetings
Roland

```
```
[[Message part 2](bugreport.cgi?att=1;bug=881143;msg=8) (message/rfc822, inline)]
```
> ![](/cgi-bin/libravatar.cgi?email=joonun.jang%40gmail.com)
> From: Joonun Jang <joonun.jang@gmail.com>
> To: Debian Bug Tracking System <submit@bugs.debian.org>
> Subject: Bug#881143: fig2dev: out of bound read while running fig2dev with -L tikz
> Date: Wed, 08 Nov 2017 15:40:29 +0900
> ```
> [[Message part 3](bugreport.cgi?att=2;bug=881143;msg=8) (text/plain, inline)]
> ```
> ```
> Package: fig2dev
> Version: 1:3.2.6a-4
> Severity: important
> Tags: security
>
> out of bound read while running fig2dev with -L tikz option
>
> Running 'fig2dev -L tikz poc' with the attached file raises out of bound read bug
> which may allow a remote attack to cause a denial-of-service attack or information
> disclosure with a crafted file.
>
> I expected the program to terminate without segfault, but the program crashes as follow
>
> I sent this to debian security team before, but I didn't get any response.
> So I send this to public.
>
> =======================================================
> june@june:~/project/analyze/poc/fig2dev/crash1$ fig2dev -L tikz poc
> \ifx\XFigwidth\undefined\dimen1=0pt\else\dimen1\XFigwidth\fi
> \divide\dimen1 by 1
> \ifx\XFigheight\undefined\dimen3=0pt\else\dimen3\XFigheight\fi
> \divide\dimen3 by 5
> \ifdim\dimen1=0pt\ifdim\dimen3=0pt\dimen1=-9223372036854775808sp\dimen3\dimen1
> \else\dimen1\dimen3\fi\else\ifdim\dimen3=0pt\dimen3\dimen1\fi\fi
> \tikzpicture[x=+\dimen1, y=+\dimen3]
> {\ifx\XFigu\undefined\catcode`\@11
> \def\temp{\alloc@1\dimen\dimendef\insc@unt}\temp\XFigu\catcode`\@12\fi}
> \XFigu-9223372036854775808sp
> % Uncomment to scale line thicknesses with the same
> % factor as width of the drawing.
> %\pgfextractx\XFigu{\pgfqpointxy{1}{1}}
> \ifdim\XFigu<0pt\XFigu-\XFigu\fi
> \clip(91,-1) rectangle (92,4);
> \tikzset{inner sep=+0pt, outer sep=+0pt}
> Segmentation fault
>
> [debugging]
> Program received signal SIGSEGV, Segmentation fault.
> strlen () at ../sysdeps/x86_64/strlen.S:106
> 106 ../sysdeps/x86_64/strlen.S: No such file or directory.
> (gdb) bt
> #0  strlen () at ../sysdeps/x86_64/strlen.S:106
> #1  0x00007ffff7339d78 in _IO_vfprintf_internal (s=0x7ffff768b600 <_IO_2_1_stdout_>,
> format=<optimized out>, ap=ap@entry=0x7fffffffde88) at vfprintf.c:1637
> #2  0x00007ffff7340157 in __fprintf (stream=<optimized out>,
> format=format@entry=0x5555555cc7e5 "\\normalfont%s ") at fprintf.c:32
> #3  0x00005555555b4615 in put_font (t=0x555555810160) at gentikz.c:1725
> #4  gentikz_text (t=0x555555810160) at gentikz.c:1769
> #5  0x00005555555618cd in gendev_objects (dev=0x5555557f8ec0 <dev_tikz>, objects=0x7fffffffdfa0)
> at fig2dev.c:833
> #6  main (argc=<optimized out>, argv=<optimized out>) at fig2dev.c:467
> (gdb) x/i $rip
> => 0x7ffff7371646 <strlen+38>:  movdqu (%rax),%xmm4
> (gdb) i r rax
> rax            0x29292922 690563362
> (gdb) f 3
> #3  0x00005555555b4615 in put_font (t=0x555555810160) at gentikz.c:1725
> 1725        fprintf(tfp, "\\normalfont%s ",
> (gdb) p t->font
> $1 = -51
> (gdb) p texfonts[-51]
> $3 = 0x29292922 <error: Cannot access memory at address 0x29292922>
>
> with attached file, t->font can be set to negative value which causes this bug
> [fig2dev/dev/gentikz.c]
> 1724   else
> 1725       fprintf(tfp, "\\normalfont%s ",
> 1726         texfonts[t->font <= MAX_FONT ? t->font : MAX_FONT - 1]);
>
> =======================================================
>
> This bug was found with a fuzzer developed by 'SoftSec' group at KAIST.
>
> -- System Information:
> Debian Release: buster/sid
>   APT prefers unstable-debug
>   APT policy: (500, 'unstable-debug'), (500, 'testing-debug'), (500, 'stable-updates'), (500, 'testing'), (500, 'stable'), (1, 'experimental-debug')
> Architecture: amd64 (x86_64)
>
> Kernel: Linux 4.9.0-3-amd64 (SMP w/1 CPU core)
> Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8), LANGUAGE=en_US:en (charmap=UTF-8)
> Shell: /bin/sh linked to /bin/dash
> Init: systemd (via /run/systemd/system)
>
> Versions of packages fig2dev depends on:
> ii  gawk         1:4.1.4+dfsg-1
> ii  libc6        2.24-17
> ii  libpng16-16  1.6.34-1
> ii  libxpm4      1:3.5.12-1
> ii  x11-common   1:7.7+19
>
> Versions of packages fig2dev recommends:
> ii  ghostscript  9.22~dfsg-1
> ii  netpbm       2:10.0-15.3+b2
>
> Versions of packages fig2dev suggests:
> pn  xfig  <none>
>
> -- no debconf information
>
> ```
> ```
> [[poc](bugreport.cgi?att=3;bug=881143;filename=poc;msg=8) (text/plain, attachment)]
> ```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Roland Rosenfeld <roland@debian.org>`:

`Bug#881143`; Package `fig2dev`.
(Wed, 08 Nov 2017 17:18:02 GMT) ([full text](bugreport.cgi?bug=881143;msg=10), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=10), [link](#9)).

---

**Acknowledgement sent**
to `881143@bugs.debian.org, roland@debian.org`:

Extra info received and forwarded to list. Copy sent to `Roland Rosenfeld <roland@debian.org>`.
(Wed, 08 Nov 2017 17:18:02 GMT) ([full text](bugreport.cgi?bug=881143;msg=12), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=12), [link](#11)).

---

[Message #13](#13) received at 881143@bugs.debian.org ([full text](bugreport.cgi?bug=881143;msg=13), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=13), reply):

![](/cgi-bin/libravatar.cgi?email=roland%40debian.org)
From: Roland Rosenfeld <roland@debian.org>
To: Thomas Loimer <thomas.loimer@tuwien.ac.at>
Cc: 881143@bugs.debian.org
Subject: Re: Bug#881143: fig2dev: out of bound read while running fig2dev
with -L tikz
Date: Wed, 8 Nov 2017 18:07:42 +0100
```
Thomas Loimer schrieb am Mittwoch, den 08. November 2017:

> thank you for the bug report. This specific issue is quite easy to
> resolve, since the position in the code where this bug is triggered
> is indicated,

I'm happy to receive a patch or an update :-)

> Do you know, in which way fig2dev is used by some printer drivers?

The Debian packages printfilters-ppd, magicfilter and apsfilter depend
or suggest the transfig package (needs to be renamed, but the new
fig2dev already provides transfig, so this still works).

magicfilter internally runs "/usr/bin/fig2dev -Lps -P -l dummy" if
someone tries to print a file that has a #FIG header.

apsfilter calls "fig2dev -Lps -c -z "$PAPERSIZE" | print_ps" to print
fig-Files (file detection via file(1)).

In printfilters-ppd I cannot find the fig2dev call.  The packages
depends on transfig (not only a suggest), but it seems that the build
mechanism is somewhat broken, so it isn't included...

Greetings
Roland

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Roland Rosenfeld <roland@debian.org>`:

`Bug#881143`; Package `fig2dev`.
(Thu, 09 Nov 2017 11:09:03 GMT) ([full text](bugreport.cgi?bug=881143;msg=15), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=15), [link](#14)).

---

**Acknowledgement sent**
to `Thomas Loimer <thomas.loimer@tuwien.ac.at>`:

Extra info received and forwarded to list. Copy sent to `Roland Rosenfeld <roland@debian.org>`.
(Thu, 09 Nov 2017 11:09:03 GMT) ([full text](bugreport.cgi?bug=881143;msg=17), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=17), [link](#16)).

---

[Message #18](#18) received at 881143@bugs.debian.org ([full text](bugreport.cgi?bug=881143;msg=18), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=18), reply):

![](/cgi-bin/libravatar.cgi?email=thomas.loimer%40tuwien.ac.at)
From: Thomas Loimer <thomas.loimer@tuwien.ac.at>
To: <roland@debian.org>
Cc: <881143@bugs.debian.org>
Subject: Re: Bug#881143: fig2dev: out of bound read while running fig2dev with
-L tikz
Date: Thu, 9 Nov 2017 11:49:45 +0100
```
Naive me! The fscanf() function is able to read in all sort of garbage.
Really, this issue points to a bigger problem. A lot more checks have to
be added to sanitize input, both in read.c and read1_3.c. Nevertheless,
here is a patch that solves the specific issue reported here and the
related one in bug #881144. The diff was taken from my development
version, hope it applies cleanly.

diff --git a/fig2dev/read.c b/fig2dev/read.c
index f281b33..eea815c 100644
--- a/fig2dev/read.c
+++ b/fig2dev/read.c
@@ -1326,8 +1326,14 @@ read_textobject(FILE *fp)
                                | PSFONT_TEXT;

        /* keep the font number reasonable */
-       if (t->font > MAXFONT(t))
+       if (t->font > MAXFONT(t)) {
                t->font = MAXFONT(t);
+       } else if (t->font < 0 ) {
+               if (psfont_text(t) && t->font < -1)
+                       t->font = -1;
+               else
+                       t->font = 0;
+       }
        fix_and_note_color(&t->color);
        t->comments = attach_comments();        /* attach any comments */
        return t;
diff --git a/fig2dev/read1_3.c b/fig2dev/read1_3.c
index 41c0a72..acfca95 100644
--- a/fig2dev/read1_3.c
+++ b/fig2dev/read1_3.c
@@ -470,7 +470,16 @@ read_textobject(FILE *fp)
            free((char*) t);
            return(NULL);
            }
+       /* keep the font number within valid range */
+       if (t->font > MAXFONT(t)) {
+               t->font = MAXFONT(t);
+       } else if (t->font < 0 ) {
+               if (psfont_text(t) && t->font < -1)
+                       t->font = -1;
+               else
+                       t->font = 0;
+       }
        (void)strcpy(t->cstring, buf);
        if (t->size == 0) t->size = 18;

```

---

**Reply sent**
to `Roland Rosenfeld <roland@debian.org>`:

You have taken responsibility.
(Fri, 10 Nov 2017 09:39:07 GMT) ([full text](bugreport.cgi?bug=881143;msg=20), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=20), [link](#19)).

---

**Notification sent**
to `Joonun Jang <joonun.jang@gmail.com>`:

Bug acknowledged by developer.
(Fri, 10 Nov 2017 09:39:07 GMT) ([full text](bugreport.cgi?bug=881143;msg=22), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=22), [link](#21)).

---

[Message #23](#23) received at 881143-close@bugs.debian.org ([full text](bugreport.cgi?bug=881143;msg=23), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=23), reply):

![](/cgi-bin/libravatar.cgi?email=roland%40debian.org)
From: Roland Rosenfeld <roland@debian.org>
To: 881143-close@bugs.debian.org
Subject: Bug#881143: fixed in fig2dev 1:3.2.6a-5
Date: Fri, 10 Nov 2017 09:34:15 +0000
```
Source: fig2dev
Source-Version: 1:3.2.6a-5

We believe that the bug you reported is fixed in the latest version of
fig2dev, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 881143@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Roland Rosenfeld <roland@debian.org> (supplier of updated fig2dev package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 09 Nov 2017 13:25:48 +0100
Source: fig2dev
Binary: fig2dev
Architecture: source amd64
Version: 1:3.2.6a-5
Distribution: unstable
Urgency: medium
Maintainer: Roland Rosenfeld <roland@debian.org>
Changed-By: Roland Rosenfeld <roland@debian.org>
Description:
 fig2dev    - Utilities for converting XFig figure files
Closes: [881143](bugreport.cgi?bug=881143) [881144](bugreport.cgi?bug=881144)
Changes:
 fig2dev (1:3.2.6a-5) unstable; urgency=medium
 .
   * 31_input_sanitizing: Some input sanitizing on FIG files.
     (Closes: #[881143](bugreport.cgi?bug=881143), #[881144](bugreport.cgi?bug=881144)).
Checksums-Sha1:
 26e44237c3be242c5f5c23115038822819c3bee4 2092 fig2dev_3.2.6a-5.dsc
 b3db5fea149849b794d3aacdf0f96f90e8839664 209680 fig2dev_3.2.6a-5.debian.tar.xz
 3ef55452571d377e1cf844eb40787e30ad775d38 556128 fig2dev-dbgsym_3.2.6a-5_amd64.deb
 f6d5b82d4750c0a087013f8e5d012a2e9eea1dcd 9260 fig2dev_3.2.6a-5_amd64.buildinfo
 5a8d9202cbe44e2c4e748c6beaaf99af55a75301 661496 fig2dev_3.2.6a-5_amd64.deb
Checksums-Sha256:
 f5ba03621b3dabe84a0621eac14278c7c7c4dc1e35c435e1e9442e51aedf5e61 2092 fig2dev_3.2.6a-5.dsc
 6114ce30ad5dc2d2f04c3f8e416f95f4c7f74209b90a64c3b1ca8a5c1e972a44 209680 fig2dev_3.2.6a-5.debian.tar.xz
 c3a07688ae366c5015917d81574b4c8d31f875214170bc0063b26fcdea77300a 556128 fig2dev-dbgsym_3.2.6a-5_amd64.deb
 c631eab546c9d034457f9bf81d3667afd0dd6c8d32b3c0c49d2a5aab269b7c97 9260 fig2dev_3.2.6a-5_amd64.buildinfo
 db9855d194bfafed1e36569fff042f39261ee5931c4109ed5d8681dd6545a176 661496 fig2dev_3.2.6a-5_amd64.deb
Files:
 71f93d6bc139d477539edcd77a234e9d 2092 graphics optional fig2dev_3.2.6a-5.dsc
 0a3439a255d3f8da5eeb06a72bcbb0d6 209680 graphics optional fig2dev_3.2.6a-5.debian.tar.xz
 fc09e8d02e2d7256b40e15ab03a466f0 556128 debug optional fig2dev-dbgsym_3.2.6a-5_amd64.deb
 f610b06306736fac134db9436816c535 9260 graphics optional fig2dev_3.2.6a-5_amd64.buildinfo
 6c55b5c1de70f02a67724b621fd6b37c 661496 graphics optional fig2dev_3.2.6a-5_amd64.deb

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEErC+9sQSUPYpEoCEdAnE7z8pUELIFAloFbWkACgkQAnE7z8pU
ELK6Uw/+P5nJwD1DSzDXbxUgq0xeYKPfWoIMLhfsfvlJvipsmvYoG8iRwi16QDpN
XZgC1/S2VPByYtNeMXnCX3u8c7tV4wNvraE+qh+xDoEFAOM/loL8aSQX/FY15zsp
cBTLPUDc/Nz6HYKgPs4XkkBt1TdC49ptO2+wiVwypwylaEKhw+0KQ7IwegZXSB9F
uUeqLJA+OEf7YZNqFm1aSqvzEVleu+zGdbCMpEUhOgn7XiG6ZxlCX7CWbOUsJbPv
2QOoggBjvhXeIqVbFy8PNrfFXOSeqUEJcRbEOsjR50E94zNBB8NsLYwqbppVZ9pk
lyBcMIR8whCoG6VGYyDuiR2ZpYccpZ45PqBfdN4/0Pz6r8D8UMHXCnA57+YPl6nZ
7+1T9WBMS6yKQgi+LYPwHlVDLISMaDIA/JS6Xi1ATcrF15Z+7GdRzIsgYWN0c/rP
npJBxKVB644lMFG9vkrOV9fL2OUNkWgap/NdH+fSRKMfkklvGxi1yOlzIK+OVX6o
3nHOlzIBQEvdQ7vTLytABI2Rd77j/D4IKfwlNmGcspd3N3/ZX2lmwh4AXs5n1ag4
PUaw9kBdwbbvvU3qqrzh6zDp+Buif+MFfHZ3gs+m3vPXOu7HMLqdyv6MnaEYtHPM
5+lFawriXwjJ9PHSvUl3RkW35jiRoNUL+weMx10DGmUyJM6SmNs=
=fexj
-----END PGP SIGNATURE-----

```

---

**Changed Bug title to 'fig2dev: CVE-2017-16899: out of bound read while running fig2dev with -L tikz' from 'fig2dev: out of bound read while running fig2dev with -L tikz'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Mon, 20 Nov 2017 21:15:03 GMT) ([full text](bugreport.cgi?bug=881143;msg=25), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=25), [link](#24)).

---

**Marked as found in versions fig2dev/1:3.2.6a-2.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Mon, 20 Nov 2017 21:15:04 GMT) ([full text](bugreport.cgi?bug=881143;msg=27), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=27), [link](#26)).

---

**Reply sent**
to `Roland Rosenfeld <roland@debian.org>`:

You have taken responsibility.
(Sat, 02 Dec 2017 19:33:45 GMT) ([full text](bugreport.cgi?bug=881143;msg=29), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=29), [link](#28)).

---

**Notification sent**
to `Joonun Jang <joonun.jang@gmail.com>`:

Bug acknowledged by developer.
(Sat, 02 Dec 2017 19:33:46 GMT) ([full text](bugreport.cgi?bug=881143;msg=31), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=31), [link](#30)).

---

[Message #32](#32) received at 881143-close@bugs.debian.org ([full text](bugreport.cgi?bug=881143;msg=32), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=32), reply):

![](/cgi-bin/libravatar.cgi?email=roland%40debian.org)
From: Roland Rosenfeld <roland@debian.org>
To: 881143-close@bugs.debian.org
Subject: Bug#881143: fixed in fig2dev 1:3.2.6a-2+deb9u1
Date: Sat, 02 Dec 2017 19:32:30 +0000
```
Source: fig2dev
Source-Version: 1:3.2.6a-2+deb9u1

We believe that the bug you reported is fixed in the latest version of
fig2dev, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 881143@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Roland Rosenfeld <roland@debian.org> (supplier of updated fig2dev package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 30 Nov 2017 12:02:27 +0100
Source: fig2dev
Binary: fig2dev transfig
Architecture: source amd64 all
Version: 1:3.2.6a-2+deb9u1
Distribution: stretch
Urgency: medium
Maintainer: Roland Rosenfeld <roland@debian.org>
Changed-By: Roland Rosenfeld <roland@debian.org>
Description:
 fig2dev    - Utilities for converting XFig figure files
 transfig   - transitional dummy package for fig2dev
Closes: [881143](bugreport.cgi?bug=881143) [881144](bugreport.cgi?bug=881144) [881396](bugreport.cgi?bug=881396)
Changes:
 fig2dev (1:3.2.6a-2+deb9u1) stretch; urgency=medium
 .
   * [CVE-2017-16899](https://security-tracker.debian.org/tracker/CVE-2017-16899): 31_input_sanitizing: Some input sanitizing on FIG
     files (Closes: #[881143](bugreport.cgi?bug=881143), #[881144](bugreport.cgi?bug=881144)).
   * 32_fill-style-overflow: Sanitize input of fill patterns
     (Closes: #[881396](bugreport.cgi?bug=881396)).
Checksums-Sha1:
 e681b5727125d8c4b0ed91f864d637d787ba4df2 2076 fig2dev_3.2.6a-2+deb9u1.dsc
 f10d6851ec259c9bea50f6c672a3d18d34b6d8f7 209744 fig2dev_3.2.6a-2+deb9u1.debian.tar.xz
 833bad6f60300d3a2226b6befbf61eefa5238330 560448 fig2dev-dbgsym_3.2.6a-2+deb9u1_amd64.deb
 5809aa1359ed0601cca1b73aff0d5b76dccbda44 9572 fig2dev_3.2.6a-2+deb9u1_amd64.buildinfo
 4f86b307ea7c3ba2bc4362eee395a31d24f1885b 659728 fig2dev_3.2.6a-2+deb9u1_amd64.deb
 8cdf1267bfaf0a88260edde7fe4f8a2cefbe9762 39642 transfig_3.2.6a-2+deb9u1_all.deb
Checksums-Sha256:
 f0d24492af6ac9c15448729db0acc09a9223c0c33805dba2ca23a47b68c1883f 2076 fig2dev_3.2.6a-2+deb9u1.dsc
 379f161f08c17b3ec91d0d9c01e4dfcb8d083af32f76b6906d54927828b1ddac 209744 fig2dev_3.2.6a-2+deb9u1.debian.tar.xz
 93cdf9dba55e45a65da92ddbfeb1ff4b166ed87d058a55ca63a957fdf2b3b7d2 560448 fig2dev-dbgsym_3.2.6a-2+deb9u1_amd64.deb
 ddd3555054161b31653c9dda4e2787f15ccf6ff213c56e576c7e59819188ed97 9572 fig2dev_3.2.6a-2+deb9u1_amd64.buildinfo
 6fad90d69948ce4cb8174c8316e3dfb7ee6f391392c8ae034182cad34f1b4511 659728 fig2dev_3.2.6a-2+deb9u1_amd64.deb
 d6596fca2561f50387bcd8ce8cefa27609ad934b9a93fc340a0d70e7f133972f 39642 transfig_3.2.6a-2+deb9u1_all.deb
Files:
 215c73649f73f61bd8e8e423d37e809d 2076 graphics optional fig2dev_3.2.6a-2+deb9u1.dsc
 925bb074b865a5b60fb2b1854a42273c 209744 graphics optional fig2dev_3.2.6a-2+deb9u1.debian.tar.xz
 2e744e78e126a79b8488a02a01336df2 560448 debug extra fig2dev-dbgsym_3.2.6a-2+deb9u1_amd64.deb
 3f78b8c39ab369ac2f6109cb9b2e117a 9572 graphics optional fig2dev_3.2.6a-2+deb9u1_amd64.buildinfo
 b8f2e06131ac34ae7d243e7de62b1743 659728 graphics optional fig2dev_3.2.6a-2+deb9u1_amd64.deb
 f6a357d7c044d97ce3c77a2a8d4f4bcf 39642 oldlibs extra transfig_3.2.6a-2+deb9u1_all.deb

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEErC+9sQSUPYpEoCEdAnE7z8pUELIFAloiobEACgkQAnE7z8pU
ELIWBRAAmwvn9OsanDkPmtS//ijr9240HJpAfvR1VMo+aq+0eVSto1Y/VWmNEQvk
Fsgm1+bxQOq+W2QpYPpKGQWY5jZPAASy0ZKRCuKz4IBFm4A5TueS9srkTnTYlR5j
boYEX4YdJqePgXHblxvdNV1DiBvnwHm9Mkp1KbCol8PYEqRyws30+v+FXM1Irsc9
7pF3DfbEjYHmgcbp4yxsv0dLvtjDlPNn7w16rheJKal9yZTv+IIO/r8ACZvdNzcp
ktKt0vqyvwRIYjSeGzmGNi3T/b6Fo6NJGmHLJm7wb+uhD9VQC7PlGWpeyqOWpQsf
1nXtBQojPPTl30+2jUN15KBIeBIV8T4Vs/ocQX22xEBjrS1ZYWeZCxpiu37Bjh1K
vW5bxOuXF7gYov9GedXL2ZuZBmFmiAYHHWoCLcHAXtAF+9SCFA9+P2on1LZNSOWM
SotK2nf30+KROV8FR0+/pnWxCAFHgc6O6Zs5h7JlDdXgz/QrYg3CKQVBqvGQ9Abd
kaJpIShaEgMape50cGbPkAtLx2rFnUo5S3rsZc7AS7NCQdm08xHjHSVDrE+sBNWa
XIAktt+xErO+/umPpoESAnoxMyQKnvcU0XeTD9ybij6O3zLk7g9zvzVMkwdX2Euc
6nSfPdLgogDLLp2lMYV9Jj5eXRkSL+Tov2c5W7q4aS6027sZfIk=
=WRoa
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Roland Rosenfeld <roland@debian.org>`:

You have taken responsibility.
(Sat, 02 Dec 2017 19:33:48 GMT) ([full text](bugreport.cgi?bug=881143;msg=34), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=34), [link](#33)).

---

**Notification sent**
to `Joonun Jang <joonun.jang@gmail.com>`:

Bug acknowledged by developer.
(Sat, 02 Dec 2017 19:33:48 GMT) ([full text](bugreport.cgi?bug=881143;msg=36), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=36), [link](#35)).

---

[Message #37](#37) received at 881143-close@bugs.debian.org ([full text](bugreport.cgi?bug=881143;msg=37), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=37), reply):

![](/cgi-bin/libravatar.cgi?email=roland%40debian.org)
From: Roland Rosenfeld <roland@debian.org>
To: 881143-close@bugs.debian.org
Subject: Bug#881143: fixed in transfig 1:3.2.5.e-4+deb8u1
Date: Sat, 02 Dec 2017 19:32:58 +0000
```
Source: transfig
Source-Version: 1:3.2.5.e-4+deb8u1

We believe that the bug you reported is fixed in the latest version of
transfig, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 881143@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Roland Rosenfeld <roland@debian.org> (supplier of updated transfig package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 30 Nov 2017 12:17:07 +0100
Source: transfig
Binary: transfig
Architecture: source amd64
Version: 1:3.2.5.e-4+deb8u1
Distribution: jessie
Urgency: medium
Maintainer: Roland Rosenfeld <roland@debian.org>
Changed-By: Roland Rosenfeld <roland@debian.org>
Description:
 transfig   - Utilities for converting XFig figure files
Closes: [881143](bugreport.cgi?bug=881143) [881144](bugreport.cgi?bug=881144) [881396](bugreport.cgi?bug=881396)
Changes:
 transfig (1:3.2.5.e-4+deb8u1) jessie; urgency=medium
 .
   * [CVE-2017-16899](https://security-tracker.debian.org/tracker/CVE-2017-16899): 33_input_sanitizing: Some input sanitizing on FIG
     files (Closes: #[881143](bugreport.cgi?bug=881143), #[881144](bugreport.cgi?bug=881144)).
   * 34_fill-style-overflow: Sanitize input of fill patterns
     (Closes: #[881396](bugreport.cgi?bug=881396)).
Checksums-Sha1:
 a89c3c1f541b4781c5757d64b975473d36b24b15 1993 transfig_3.2.5.e-4+deb8u1.dsc
 72c917a599a777776ae644dae6e1630284a03031 224788 transfig_3.2.5.e-4+deb8u1.debian.tar.xz
 3a47752a78e921152ba6bc0081ce5c86b97daebc 635058 transfig_3.2.5.e-4+deb8u1_amd64.deb
Checksums-Sha256:
 b3f003b9285cce0253a6788fb97c1d66e14a8366d54fbe99cf903ec3e65e915e 1993 transfig_3.2.5.e-4+deb8u1.dsc
 378414e7eda28b5101c8070c9a29858194a257d328f37986f4b259f147bf6c4f 224788 transfig_3.2.5.e-4+deb8u1.debian.tar.xz
 93eb52e720fa603ca99d14961f750fa5543410dc8e28bc1fac2f4d4f2adcaf30 635058 transfig_3.2.5.e-4+deb8u1_amd64.deb
Files:
 4eab1e4e31246c39551f38a7d7fd6eec 1993 graphics optional transfig_3.2.5.e-4+deb8u1.dsc
 4fa556857c048c3910083892e008bbd6 224788 graphics optional transfig_3.2.5.e-4+deb8u1.debian.tar.xz
 1345e25485829887a38cac3945b66c1e 635058 graphics optional transfig_3.2.5.e-4+deb8u1_amd64.deb

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEErC+9sQSUPYpEoCEdAnE7z8pUELIFAloipD4ACgkQAnE7z8pU
ELIurRAAtj50i3OD0UGZYXkJiMquIWbP8VGajLDpRi3E4wcjJd0eZzTzbBkXanqE
O/fwBFJDOXkvIGl3un5UqIjlYqVrHyOLAr40nzOXixAId+ilrn0onPQuIAEKbCNf
bo0S9j8MBAGjPdwn0VJor9sqYQl2RnDp+Rma92FmT+rHpoISzOIw/R1cDqX93bvS
qdDQNo2j5OLKQ7Sy/S5FBBWxucKZPc/wcAz5GN6b5EdcWMQyHpq2a9MwSnaRRGFq
qvRo4Ftv+/7yaCURirU9zCCnldM2f8NTJVXQ0up5l+AgZ8ZN+Inmj71c6k2UxWXV
YRWpa20Ezcpby0P1e6Rds7LGM1iZnB/Q6zx258GeEVguCC/f/OrZCQlFew2RUrLo
euWdoTrZhsiOQtBugVWWmzs2gehaPQLfq+RI3KBLd6Y3MwQLT3z/avad0qHQqN3D
U67gKKON8pMNDYufH/K9Z7JWbXqAhWFOy9nfxqiBujjLwmnwcL+LhkIkIlChMMpm
o/yqaGWC97BlqmDLkx2mZ9R8J2HnhGzRRR6NYMqAGx2rIAZWqpxIoCbfhxVn7WXv
xoCwramZ6x59SdkuAEmD9PnlGSnK8/vK5PR+AmywpkUGrrFwdWIrx7bMAXEl5klT
+XWxoswgqjXn5Jbz6bGg92Q5Z3G9uQV7XBB9tCGiqhbuzeQCD0U=
=MrGw
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 31 Dec 2017 07:29:08 GMT) ([full text](bugreport.cgi?bug=881143;msg=39), [mbox](bugreport.cgi?bug=881143;mbox=yes;msg=39), [link](#38)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=881143).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 13:41:35 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


