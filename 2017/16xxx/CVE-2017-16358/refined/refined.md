The provided content relates to CVE-2017-16358.

**Root cause of vulnerability:**
- The vulnerability is a heap-buffer-overflow in the `string_scan_range` function within `libr/bin/bin.c`. This occurs when scanning for strings in a binary file with specific characteristics.

**Weaknesses/vulnerabilities present:**
- Heap-buffer-overflow: Reading out of bounds of allocated memory. Specifically, it attempts to read a byte at an address that is outside the bounds of the allocated buffer. The code attempts to adjust the string start position to account for BOM markers, but does so incorrectly, allowing a negative index when accessing the buffer.

**Impact of exploitation:**
- Denial of service: The heap-buffer-overflow can lead to a crash of the application, potentially causing a denial of service. This is evident from the AddressSanitizer reports that show crashes due to heap-buffer-overflows.

**Attack vectors:**
- Malicious crafted input: The vulnerability is triggered by crafted binary files that, when processed by radare2, cause the out-of-bounds read in string scanning functions

**Required attacker capabilities/position:**
- The attacker needs to provide a specially crafted binary file as input to the radare2 application. No special privileges are required, other than the ability to execute the radare2 tool.

**Additional details:**
- The issue was identified using AddressSanitizer, which detected the out-of-bounds read during the execution of radare2 on 32-bit Linux systems. The provided ASAN reports indicate the precise line of code where the overflow occurs in `string_scan_range`, also providing a call stack. The commit d31c4d3cbdbe01ea3ded16a584de94149ecd31d9 fixes this vulnerability.
- The vulnerability occurs when checking for wide strings with byte order marks (BOM) and tries to adjust the string start position, by subtracting from it without checking that this doesn't cause an underflow and results in reading outside of the provided buffer.