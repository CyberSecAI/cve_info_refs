The provided content describes two vulnerabilities, Server-Side Template Injection (SSTI) and Cross-site Scripting (XSS), in CMS Made Simple, which aligns with CVE-2017-16783.

**Server-Side Template Injection (SSTI):**

*   **Root Cause:**  The application unsafely embeds user-provided data into a server-side template. Specifically, the `cntnt01detailtemplate` GET parameter is used to load a template. By manipulating this parameter, an attacker can inject template code.
*   **Weaknesses:** Lack of sanitization of the `cntnt01detailtemplate` parameter when passed to the Smarty template engine.
*  **Impact:** Remote Code Execution. By injecting PHP code within the template parameter, the attacker can execute arbitrary code on the server.
*   **Attack Vector:**  By crafting a specific URL with the `cntnt01detailtemplate` parameter, an attacker can inject malicious code into the template engine.
*   **Attacker Capabilities:** The attacker does not need any specific capabilities or privileges to exploit the SSTI vulnerability.

**Cross-Site Scripting (XSS):**

*   **Root Cause:** Improper handling of user-supplied input in the `cntnt01detailtemplate` parameter, specifically through double encoding and subsequent decoding.
*   **Weaknesses:**
    *   The `detailtemplate` parameter is URL-decoded after initial sanitization.
    *   The HTML sanitization function doesn't encode the percentage (%) character, which is used in URL encoding.
    *   The decoded, unsanitized parameter is included in an error message template that is displayed to logged-in users, thus enabling XSS.
*   **Impact:**  An attacker can inject arbitrary JavaScript code, leading to potential session hijacking, defacement, and data theft.
*   **Attack Vector:**  By providing a double URL encoded payload in the `cntnt01detailtemplate` parameter in the URL, the attacker can inject malicious code that will be executed in the user's browser.
*   **Attacker Capabilities:** The attacker needs a logged-in user for this XSS vulnerability to be triggered.

The content provides more detail than a typical CVE description, including:

*   Specific vulnerable parameter names and attack vectors.
*   Code snippets showing the vulnerable code sections in the application.
*   Explanation of how the double encoding bypasses the initial sanitization.
*   A detailed analysis of why the XSS was difficult to find through manual testing.

The content also emphasizes the importance of automated vulnerability scanning tools like Invicti (formerly Netsparker) in detecting these types of vulnerabilities, especially those that involve complex data flows and code interactions.