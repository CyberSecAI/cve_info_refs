=== Content from www.invicti.com_ffcb5a31_20250126_124804.html ===


[Netsparker is now Invicti](https://www.invicti.com/blog/news/netsparker-is-now-invicti-signaling-a-new-era-for-modern-appsec/ "Netsparker is now Invicti")

[Get a demo](https://www.invicti.com/get-demo/)
 [![Invicti Logo - The Largest Dynamic Application Security Solutions Provider In The World](https://cdn.invicti.com/branding/invicti-logo-black.svg)
![Invicti Logo - The Largest Dynamic Application Security Solutions Provider In The World](https://cdn.invicti.com/branding/invicti-logo-black.svg)
![Invicti Logo - The Largest Dynamic Application Security Solutions Provider In The World](https://cdn.invicti.com/branding/invicti-logo-bone.svg)
AppSec with Zero Noise
![Invicti Logo - The Largest Dynamic Application Security Solutions Provider In The World](https://cdn.invicti.com/branding/invicti-logo-icon.svg)](https://www.invicti.com/)
[Get a demo](https://www.invicti.com/get-demo/)

[Get a demo](https://www.invicti.com/get-demo/)

* Product
  + [Web Application Security](https://www.invicti.com/product/)
  + [API Security](https://www.invicti.com/product/api-security/)
  + [Features](https://www.invicti.com/features/)
  + [DAST](https://www.invicti.com/product/dast/)
  + [SAST](https://www.invicti.com/product/sast/)
  + [SCA](https://www.invicti.com/product/sca/)
  + [Container Security](https://www.invicti.com/product/container-security/)
* Why Us?
  + Solutions
    - Industries
      * [IT & Telecom](https://www.invicti.com/solutions/it-and-telecom/)
      * [Government](https://www.invicti.com/solutions/government/)
      * [Financial Services](https://www.invicti.com/solutions/financial-services/)
      * [Education](https://www.invicti.com/solutions/higher-education/)
      * [Healthcare](https://www.invicti.com/solutions/healthcare/)
    - Roles
      * [CTO & CISO](https://www.invicti.com/solutions/cto-ciso/)
      * [Engineering Manager](https://www.invicti.com/solutions/engineering-manager/)
      * [Security Engineer](https://www.invicti.com/solutions/security-engineer/)
      * [DevSecOps](https://www.invicti.com/solutions/devsecops/)
  + [Comparison](https://www.invicti.com/vulnerability-scanner-comparison/)
  + [Case studies](https://www.invicti.com/case-studies/)
  + [Customers](https://www.invicti.com/customers/)
  + [Testimonials](https://www.invicti.com/testimonials/)
* [Pricing](https://www.invicti.com/pricing/)
* About Us
  + [Our Story](https://www.invicti.com/about/)
  + [In the news](https://www.invicti.com/blog/news/)
  + [Careers](https://www.invicti.com/careers/)
  + [Contact us](https://www.invicti.com/contact/)
* Resources
  + [Blog](https://www.invicti.com/blog/)
  + [White Papers](https://www.invicti.com/white-papers/)
  + [Webinars](https://www.invicti.com/webinars/)
  + [Podcasts](https://www.invicti.com/podcasts/)
  + [Invicti Learn](https://www.invicti.com/learn/)
  + [Resource Library](https://www.invicti.com/resources/)
  + Partners
    - [Channel](https://www.invicti.com/partners/)
    - [MSSP](https://www.invicti.com/clp/managed-security-service-provider/)
  + [Support](https://www.invicti.com/support/)

[Web Security Blog](https://www.invicti.com/blog/)

* [Web Security](https://www.invicti.com/blog/web-security/)
* [Security Labs](https://www.invicti.com/blog/security-labs/)
* [News](https://www.invicti.com/blog/news/)
* [Product Docs & FAQs](https://www.invicti.com/blog/docs-and-faqs/)

Search

Close search bar

# Exploiting SSTI and XSS in the CMS Made Simple Web Application

[Mithat Gogebakan](https://www.invicti.com/blog/author/mithatgogebakan/)  - Fri, 10 Nov 2017 -

Our Security Researcher found a vulnerability in a parameter in a URL in the address bar of the browser. Read more about how he did it, and how he was able to exploit it to carry out a few harmless changes.

Subscribe

Your Information will be kept [private](https://www.invicti.com/privacy-policy/).

Stay up to date on web security trends

SUBSCRIBE

Your Information will be kept [private](https://www.invicti.com/privacy-policy/).

CMS Made Simple is a content management system that was first released in July 2004 as an open source General Public License (GPL) package. It is currently used in both commercial and personal projects.

![CMS Made Simple logo](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_logo.png)

As Security Researchers working on the [Netsparker web application vulnerability scanner](https://www.invicti.com), we’re always excited about testing and scanning new open source web applications for vulnerabilities. Recently, I read researcher Osanda Malith’s blog post, [CMSMS 2.1.6 Multiple Vulnerabilities](https://osandamalith.com/2017/05/11/cmsms-2-1-6-multiple-vulnerabilities/), where he explains his findings following a review of the CMS Made Simple source code. I decided to see for myself what I could uncover.

## The First Step: Noticing the Parameters in the URL

After installing CMS on our local system, I was determined to try to find a vulnerability. Of course, from a black box point of view, a freshly installed application with default configuration lacks a lot of functionality. However, I decided to take a closer look.

It didn’t take long before I noticed the following URL in the address bar of the browser:

https://localhost/CMSMS/index.php?mact=News,cntnt01,detail,0&cntnt01articleid=1&cntnt01detailtemplate=Simplex%20News%20Detail&cntnt01returnid=1

![URL of note in the address bar of CMS made simple](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_url_parameters.png)

Finding so many parameters together in a URL always excites Security Researchers. Why? Well, the more parameters with different functionality you expose, the greater the number of potential attack surfaces.

## Manually Reviewing Potential Attack Surfaces

At this point, I decided to take a closer look at the URL. If the purpose of a parameter is not obvious, and there is no alternative, changing the value of a particular parameter may be the quickest way to find out. For example, if any parameter value is displayed on the page, it’s a good idea to check if it’s vulnerable to [Cross-site scripting (XSS)](https://www.invicti.com/learn/cross-site-scripting-xss/) first.

Let’s look at what happened when I modified the *cntnt01detailtemplate* parameter value by adding *=test*.

![](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_url_error.png)

As you might imagine, the entered string should match with another value in the back end. This error occurred even when I changed a single letter. I concluded that it was not a good idea to look for XSS there.

## Perhaps the Source Code Would Help Me Decide What To Do

After quickly checking the source code to see why it generated an error, I could see that the value was related to the template detail, as the parameter name implies. It was built using Smarty Template Engine, which keeps content, functionality and templates separate. However, as we know, developers must be careful when using template engines, because if implemented incorrectly in applications, they can lead to critical security problems.

I continued with the black box tests.

## Detecting and Exploiting Template Injection to Gain Remote Code Execution

I decided to add a simple payload to the following URL (instead of ‘Simplex News Detail’) to help me see what was happening:

https://localhost/CMSMS/index.php?mact=News,cntnt01,detail,0&cntnt01articleid=1&cntnt01detailtemplate=string:Netsparker&cntnt01returnid=1

I added, simply: *string:Netsparker*. This displayed ‘Netsparker’ in the window.

![](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_simple_payload.png)

I then retested it with another payload:

https://localhost/CMSMS/index.php?mact=News,cntnt01,detail,0&cntnt01articleid=1&cntnt01detailtemplate=string:{6\*3}&cntnt01returnid=1

I added: *string:{6\*3}*. Again, I was able to display a number in the window.

![](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_retested_with_another_payload.png)

Most template engines have a ‘sandboxed’ mode to prevent you from going further. However. depending on the template engine used, it is sometimes possible to escape the sandbox and execute arbitrary code. In this case, exploiting unsandboxed Smarty was a simple matter:

https://localhost/CMSMS/index.php?mact=News,cntnt01,detail,0&cntnt01articleid=1&cntnt01detailtemplate=string:{php}phpinfo();{/php}&cntnt01returnid=1

I added this: string: *{php}phpinfo();{/php}*. And, I was able to see the output of the *phpinfo* function displayed in the screenshot.

![](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_output_of_the_phpinfo_function.png)
## What Did I Overlook During the Manual Audit?

Basically, what I was trying to do was to observe the output following particular requests, or any particular user input during manual tests. The input you observe, such as *cntnt01detailtemplate*, can produce different outputs for many reasons. It is very difficult to use manual testing to observe all possible behaviors. The *cntnt01detailtemplate* did not initially reflect the changes I made on the parameter. At this point, many Security Researchers would not waste further time searching for an XSS vulnerability on this parameter. In addition, sometimes there are simply too many prerequisites for a successful attack to occur, and you may need to test hundreds of possibilities for a single parameter to even detect all of these preconditions.

This is a serious problem for security researchers – but not for the [dead accurate web vulnerability scanner Netsparker](https://www.invicti.com).

## **Netsparker Automatically Identified the XSS Vulnerability in the Same Parameter**

To add insult to injury, the Server Site Template Injection was not the only vulnerability in this parameter. There was an additional Cross-site Scripting vulnerability that could be triggered by double encoding the payload, and the *urldecode* function was used on that input value. This led to an XSS vulnerability, even though the special characters were encoded to HTML entities once they entered the application.

This is the XSS vulnerability we found when we scanned the web application with Netsparker:

![XSS vulnerability](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_xss_vulnerability.png)

Let’s take a closer look at why we did not find this XSS vulnerability during the manual tests. Even when using a whitebox approach, the XSS was quite hard to find. This was because the developers used object-oriented programming (OOP) style with lots of interconnected classes, and put some of the application logic into templates. This makes it very hard to trace the code and find out where data enters and exits the web application.

### A Detailed Explanation of the Cross-site Scripting Vulnerability Identified in CMS Made Simple

However, let me provide you with an overview of the vulnerability. The data enters the application in the lib/classes/class.moduleoperations.inc.php file in the function *GetModuleParameters*, where the *$\_REQUEST* variable is processed. The code strips the prefix from the parameter values and returns the resulting values in the *$params* array.

![](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_overview_of_the_vulnerability.png)

Following that, the parameters are sanitized against XSS in the lib/classes/class.CMSModule.php file, as shown.

![](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_parameters_sanitized.png)

This should be sufficient to sanitize the parameters. However, it is always better to save the raw data and encode it, depending on the context in which it is used. As mentioned above, the vulnerability is in the detail template parameter, which is currently correctly sanitized.

In the modules/News/action.detail.php file, the *detailtemplate* parameter is URL-decoded again, which ensures that the path to the template does not contain any URL-encoded characters. After all, the parameter is not intended to be printed, and should only be passed to a function that fetches the template. Even if it was printed, HTML special characters are still replaced with HTML entities.

![](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_detailtemplate_parameter.png)

So far everything looks fine. The *detailtemplate* parameter is not printed anywhere, and is only used to load the template. The problem, however, is that there is no valid template with the name of our payload. Therefore an exception is thrown in the index.php file.

![](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_detailtemplate_parameter_is_not_printed.png)

The *errorConsole* function is located in the lib/classes/internal/class.Smarty\_CMS.php file, and contains the following code.

![](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_errorconsole.png)

As you can see, *$e->getMessage()* is assigned to the template. However, the problem is that this contains the *detailtemplate* parameter, which was URL-decoded. When we look into the template located in the lib/assets/templates/cmsms-error-console.tpl file, it becomes apparent why only logged-in users, like administrators, are vulnerable to XSS.

![](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_problem_of_detailtemplate_parameter.png)

The *$loggedin* template variable was assigned above and is only true if the user is logged in. The output of *detailtemplate* is in *{$e\_message}*. As already mentioned, this is still encoded with HTML specialchars, even though *urldecode()* was already used to remove URL-encoded values.

The problem is that only certain special characters are sanitized by the HTML special character function, for example <, > and &. What it doesn’t sanitize is the percentage (%) character. However, this is the prefix of URL-encoded bytes. This means that if we double encode the value, by passing %253c in the template name, it will contain %3c instead of <.

For example instead of *<script>alert(1)</script>*, we pass *%253cscript%253ealert(1)%253c/script%253e* as our payload. It does not contain any character that is encoded to an HTML entity, so it will be stored as *%3cscript%3ealert(1)%3c/script%3e* on the server side. However, once the *urldecode()*function is used on this value it will be decoded to *<script>alert(1)</script>* and therefore introduce an XSS vulnerability through double encoding.

## The Importance of Automating the Vulnerability Assessment

Even though the vulnerability is relatively easy to fix, it is very hard to find, even in a whitebox test. While it looks like everything is sanitized correctly, a decoding function combined with the right input can still lead to cross-site scripting.

It is often easier to use an automated vulnerability scanner like Netsparker, since, as in this case, it can conduct a more thorough and accurate analysis of an application than a penetration tester. There are various reasons for this, one of which is the large codebase and the OOP style, which makes debugging harder. The other is the fact that testers usually have a limited amount of time in which they are able to analyse the application.

Had the vulnerable CMS Made Simple versions been scanned with Netsparker before being published, the vulnerabilities could have been fixed before being deployed in any production environment.

Since we know that open source projects are instrumental in providing secure applications to a broad range of customers, we supply [free Netsparker Enterprise licenses](https://www.invicti.com/blog/news/free-online-web-application-security-scans-open-source-projects/) to all open source web application developers.

## XSS Vulnerability Classification and Severity Table

| Classification | ID / Severity |
| --- | --- |
| PCI v3.1 | 6.5.7 |
| PCI v3.2 | 6.5.7 |
| CAPEC | 19 |
| CWE | 79 |
| WASC | 8 |
| OWASP 2013 | A3 |
| HIPAA | 164.308(a) |
| CVSS:3.0 | CVSS:3.0/VA:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N |
| Netsparker | High |

## SSTI Vulnerability Classification and Severity Table

| Classification | ID / Severity |
| --- | --- |
| PCI v3.1 | 6.5.1 |
| PCI v3.2 | 6.5.1 |
| CWE | 917 |
| OWASP 2013 | A1 |
| HIPAA | 164.308(a) |
| CVSS:3.0 | CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N |
| Netsparker | High |

## Related Articles

* [![getting-started-web-application-security](https://cdn.invicti.com/app/uploads/2022/06/28122528/getting-started-web-application-security.jpg "Complete beginner’s guide to web application security")Complete beginner’s guide to web application security](https://www.invicti.com/blog/web-security/getting-started-web-application-security/)
* [![An Introduction to the Digital Black Market, or as also known, the Dark Web](https://cdn.invicti.com/statics/img/webo/usenet_newsgroup.png "An Introduction to the Digital Black Market, or as also known, the Dark Web")An Introduction to the Digital Black Market, or as also known, the Dark Web](https://www.invicti.com/blog/web-security/introduction-digital-black-market-dark-web/)
* [![Type Juggling Authentication Bypass Vulnerability in CMS Made Simple](https://cdn.invicti.com/statics/img/blogposts/type_juggling_authentication_bypass_cms_made_simple_1.png "Type Juggling Authentication Bypass Vulnerability in CMS Made Simple")Type Juggling Authentication Bypass Vulnerability in CMS Made Simple](https://www.invicti.com/blog/web-security/type-juggling-authentication-bypass-cms-made-simple/)
* [![Stealing-data-with-css-selectors-and-javascript](https://cdn.invicti.com/app/uploads/2022/06/28121335/Stealing-data-with-css-selectors-and-javascript.jpg "Acquiring Data with CSS Selectors and Javascript on Time Based Attacks")Acquiring Data with CSS Selectors and Javascript on Time Based Attacks](https://www.invicti.com/blog/web-security/acquiring-data-with-css-selectors-and-javascript-on-time-based-attacks/)

## Most Popular Articles

[![](https://cdn.invicti.com/app/uploads/2023/12/15091757/most-popular-articles-sql-injection-cheat-sheet.jpg)
### SQL Injection Cheat Sheet](https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet/)

[![HTTP security headers: An easy way to harden your web applications](https://cdn.invicti.com/app/uploads/2024/05/17071830/invicti-helix-blog-image.jpg)
### HTTP security headers: An easy way to harden your web applications](https://www.invicti.com/blog/web-security/http-security-headers/)

[![](https://cdn.invicti.com/app/uploads/2023/12/15091754/most-popular-articles-disable-directory-listing-web-servers.jpg)
### How you can disable directory listing on your web server – and why you should](https://www.invicti.com/blog/web-security/disable-directory-listing-web-servers/)

[![JSON Injection](https://cdn.invicti.com/app/uploads/2024/05/17071830/invicti-helix-blog-image.jpg)
### JSON injection](https://www.invicti.com/learn/json-injection/)

![Invicti Logo - The Largest Dynamic Application Security Solutions Provider In The World](https://cdn.invicti.com/branding/invicti-logo-black.svg)

Invicti Security Corp
1000 N Lamar Blvd Suite 300
Austin, TX 78703, US

© Invicti 2025

* RESOURCES
  + [Features](https://www.invicti.com/features/)
  + [Integrations](https://www.invicti.com/integrations/)
  + [Plans](https://www.invicti.com/plans/)
  + [Case Studies](https://www.invicti.com/case-studies/)
  + [Changelogs](https://www.invicti.com/changelogs/)
  + [Invicti Learn](https://www.invicti.com/learn/welcome/)
* USE CASES
  + [Penetration Testing Software](https://www.invicti.com/penetration-testing-software/)
  + [Website Security Scanner](https://www.invicti.com/website-security-scanner/)
  + [Ethical Hacking Software](https://www.invicti.com/ethical-hacking-software/)
  + [Web Vulnerability Scanner](https://www.invicti.com/web-vulnerability-scanner/)
  + [Comparisons](https://www.invicti.com/vulnerability-scanner-comparison/)
  + [Online Application Scanner](https://www.invicti.com/online-web-application-security-scanner/)
* WEB SECURITY
  + [The Problem with False Positives](https://www.invicti.com/blog/web-security/false-positives-web-application-security/)
  + [Why Pay for Web Scanners](https://www.invicti.com/blog/web-security/comparison-commercial-non-commercial-web-application-security-scanner/)
  + [SQL Injection Cheat Sheet](https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet/)
  + [Getting Started with Web Security](https://www.invicti.com/blog/web-security/getting-started-web-application-security/)
  + [Vulnerability Index](https://www.invicti.com/web-vulnerability-scanner/vulnerabilities/)
  + [Using Content Security Policy to Secure Web Applications](https://www.invicti.com/blog/web-security/content-security-policy/)
* COMPARISON
  + [Acunetix vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-acunetix/)
  + [Burp Suite vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-burp-suite/)
  + [Checkmarx vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-checkmarx/)
  + [Probely vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-probely/)
  + [Qualys vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-qualys/)
  + [Tenable Nessus vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-nessus/)
* COMPANY
  + [About Us](https://www.invicti.com/about/)
  + [Contact Us](https://www.invicti.com/contact/)
  + [Support](https://www.invicti.com/support/)
  + [Careers](https://www.invicti.com/careers/)
  + [Resources](https://www.invicti.com/resources/)
  + [Partners](https://www.invicti.com/partners/)

© Invicti 2025

* [Compliance](https://www.invicti.com/compliance/)
* [Legal](https://www.invicti.com/legal/)
* [Privacy Policy](https://www.invicti.com/compliance/privacy-policy/)
* [California Privacy Rights](https://www.invicti.com/compliance/california-privacy-rights/)
* [Terms of Use](https://www.invicti.com/legal/terms/)
* [Accessibility](https://www.invicti.com/accessibility/)
* [Sitemap](https://www.invicti.com/sitemap/)

By using this website you agree with our use of cookies to improve its performance and enhance your experience. More information in our [Privacy Policy](https://www.invicti.com/privacy-policy).

OK



=== Content from packetstormsecurity.com_f6c823ea_20250125_233103.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.netsparker.com_248b49f5_20250125_233106.html ===


[Netsparker is now Invicti](https://www.invicti.com/blog/news/netsparker-is-now-invicti-signaling-a-new-era-for-modern-appsec/ "Netsparker is now Invicti")

[Get a demo](https://www.invicti.com/get-demo/)
 [![Invicti Logo - The Largest Dynamic Application Security Solutions Provider In The World](https://cdn.invicti.com/branding/invicti-logo-black.svg)
![Invicti Logo - The Largest Dynamic Application Security Solutions Provider In The World](https://cdn.invicti.com/branding/invicti-logo-black.svg)
![Invicti Logo - The Largest Dynamic Application Security Solutions Provider In The World](https://cdn.invicti.com/branding/invicti-logo-bone.svg)
AppSec with Zero Noise
![Invicti Logo - The Largest Dynamic Application Security Solutions Provider In The World](https://cdn.invicti.com/branding/invicti-logo-icon.svg)](https://www.invicti.com/)
[Get a demo](https://www.invicti.com/get-demo/)

[Get a demo](https://www.invicti.com/get-demo/)

* Product
  + [Web Application Security](https://www.invicti.com/product/)
  + [API Security](https://www.invicti.com/product/api-security/)
  + [Features](https://www.invicti.com/features/)
  + [DAST](https://www.invicti.com/product/dast/)
  + [SAST](https://www.invicti.com/product/sast/)
  + [SCA](https://www.invicti.com/product/sca/)
  + [Container Security](https://www.invicti.com/product/container-security/)
* Why Us?
  + Solutions
    - Industries
      * [IT & Telecom](https://www.invicti.com/solutions/it-and-telecom/)
      * [Government](https://www.invicti.com/solutions/government/)
      * [Financial Services](https://www.invicti.com/solutions/financial-services/)
      * [Education](https://www.invicti.com/solutions/higher-education/)
      * [Healthcare](https://www.invicti.com/solutions/healthcare/)
    - Roles
      * [CTO & CISO](https://www.invicti.com/solutions/cto-ciso/)
      * [Engineering Manager](https://www.invicti.com/solutions/engineering-manager/)
      * [Security Engineer](https://www.invicti.com/solutions/security-engineer/)
      * [DevSecOps](https://www.invicti.com/solutions/devsecops/)
  + [Comparison](https://www.invicti.com/vulnerability-scanner-comparison/)
  + [Case studies](https://www.invicti.com/case-studies/)
  + [Customers](https://www.invicti.com/customers/)
  + [Testimonials](https://www.invicti.com/testimonials/)
* [Pricing](https://www.invicti.com/pricing/)
* About Us
  + [Our Story](https://www.invicti.com/about/)
  + [In the news](https://www.invicti.com/blog/news/)
  + [Careers](https://www.invicti.com/careers/)
  + [Contact us](https://www.invicti.com/contact/)
* Resources
  + [Blog](https://www.invicti.com/blog/)
  + [White Papers](https://www.invicti.com/white-papers/)
  + [Webinars](https://www.invicti.com/webinars/)
  + [Podcasts](https://www.invicti.com/podcasts/)
  + [Invicti Learn](https://www.invicti.com/learn/)
  + [Resource Library](https://www.invicti.com/resources/)
  + Partners
    - [Channel](https://www.invicti.com/partners/)
    - [MSSP](https://www.invicti.com/clp/managed-security-service-provider/)
  + [Support](https://www.invicti.com/support/)

[Home](https://www.invicti.com/) / [Web Application Advisories](https://www.invicti.com/web-applications-advisories/) / Server-Side Template Injection Vulnerability in CMS Made Simple

# Server-Side Template Injection Vulnerability in CMS Made Simple

## Information

Advisory by Netsparker (now Invicti)
Name: Server-Side Template Injection Vulnerability in CMS Made Simple
Affected Software: CMS Made Simple
Affected Versions: Tested on  2.1.6
Vendor Homepage: <http://www.cmsmadesimple.org/>
Vulnerability Type: Server-Side Template Injection
Severity: Important
Status: Fixed
CVE-ID: CVE-2017-16783
CVSS Base Score (3.0): 9.8
CVSS Vector String(3.0): AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
Invicti Advisory Reference: NS-17-32
Detailed write up: <https://www.invicti.com/blog/web-security/exploiting-ssti-and-xss-in-cms-made-simple/>

## Description

Identified a Server Side Template Injection, which occurs when input data is unsafely embedded into a server-side template.

## Technical Details

Proof of Concept URL for SSTI vulnerability in CMS Made Simple;

**URL:** `/index.php?mact=News,cntnt01,default,0&cntnt01summarytemplate=string:{{7*7}}&cntnt01number=2&cntnt01detailtemplate=string:{php}phpinfo();{/php}&cntnt01category_id=1&cntnt01returnid=1`
**Parameter Name:** cntnt01detailtemplate
**Parameter Type:** GET
**Attack Pattern:** `string:{php}phpinfo();{/php}`

## Advisory Timeline

11 July 2017 – First Contact
26 Aug 2017 – Vendor Fixed
09 Nov 2017 – Advisory Released

## Solution

Avoid creating templates from user input. If this is not possible, whitelist all input and encode it in accordance with the underlying subsystem or review the related template engine’s documentation for hardening.

## Credits & Authors

These issues have been discovered by Mithat Gogebakan while testing [Invicti Web Application Security Scanner](https://www.invicti.com/web-vulnerability-scanner/).

## About Invicti

Invicti Security is transforming the way web applications are secured. Invicti empowers organizations in every industry to scale their overall security operations, make the best use of their security resources, and engage developers in helping to improve their overall security posture.

## Related Articles

* [![Exploiting SSTI and XSS in the CMS Made Simple Web Application](https://cdn.invicti.com/statics/img/blogposts/cms_made_simple_logo.png "Exploiting SSTI and XSS in the CMS Made Simple Web Application")Exploiting SSTI and XSS in the CMS Made Simple Web Application](https://www.invicti.com/blog/web-security/exploiting-ssti-and-xss-in-cms-made-simple/)
* [![Stealing-data-with-css-selectors-and-javascript](https://cdn.invicti.com/app/uploads/2022/06/28121335/Stealing-data-with-css-selectors-and-javascript.jpg "Acquiring Data with CSS Selectors and Javascript on Time Based Attacks")Acquiring Data with CSS Selectors and Javascript on Time Based Attacks](https://www.invicti.com/blog/web-security/acquiring-data-with-css-selectors-and-javascript-on-time-based-attacks/)
* [![CVSS-characterizing-and-scoring-vulnerabilities](https://cdn.invicti.com/app/uploads/2022/06/28121330/CVSS-characterizing-and-scoring-vulnerabilities.png "CVSS: Characterizing and Scoring Vulnerabilities")CVSS: Characterizing and Scoring Vulnerabilities](https://www.invicti.com/blog/web-security/cvss-characterizing-and-scoring-vulnerabilities/)
* [![getting-started-web-application-security](https://cdn.invicti.com/app/uploads/2022/06/28122528/getting-started-web-application-security.jpg "Complete beginner’s guide to web application security")Complete beginner’s guide to web application security](https://www.invicti.com/blog/web-security/getting-started-web-application-security/)

![Invicti Logo - The Largest Dynamic Application Security Solutions Provider In The World](https://cdn.invicti.com/branding/invicti-logo-black.svg)

Invicti Security Corp
1000 N Lamar Blvd Suite 300
Austin, TX 78703, US

© Invicti 2025

* RESOURCES
  + [Features](https://www.invicti.com/features/)
  + [Integrations](https://www.invicti.com/integrations/)
  + [Plans](https://www.invicti.com/plans/)
  + [Case Studies](https://www.invicti.com/case-studies/)
  + [Changelogs](https://www.invicti.com/changelogs/)
  + [Invicti Learn](https://www.invicti.com/learn/welcome/)
* USE CASES
  + [Penetration Testing Software](https://www.invicti.com/penetration-testing-software/)
  + [Website Security Scanner](https://www.invicti.com/website-security-scanner/)
  + [Ethical Hacking Software](https://www.invicti.com/ethical-hacking-software/)
  + [Web Vulnerability Scanner](https://www.invicti.com/web-vulnerability-scanner/)
  + [Comparisons](https://www.invicti.com/vulnerability-scanner-comparison/)
  + [Online Application Scanner](https://www.invicti.com/online-web-application-security-scanner/)
* WEB SECURITY
  + [The Problem with False Positives](https://www.invicti.com/blog/web-security/false-positives-web-application-security/)
  + [Why Pay for Web Scanners](https://www.invicti.com/blog/web-security/comparison-commercial-non-commercial-web-application-security-scanner/)
  + [SQL Injection Cheat Sheet](https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet/)
  + [Getting Started with Web Security](https://www.invicti.com/blog/web-security/getting-started-web-application-security/)
  + [Vulnerability Index](https://www.invicti.com/web-vulnerability-scanner/vulnerabilities/)
  + [Using Content Security Policy to Secure Web Applications](https://www.invicti.com/blog/web-security/content-security-policy/)
* COMPARISON
  + [Acunetix vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-acunetix/)
  + [Burp Suite vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-burp-suite/)
  + [Checkmarx vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-checkmarx/)
  + [Probely vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-probely/)
  + [Qualys vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-qualys/)
  + [Tenable Nessus vs. Invicti](https://www.invicti.com/vulnerability-scanner-comparison/invicti-vs-nessus/)
* COMPANY
  + [About Us](https://www.invicti.com/about/)
  + [Contact Us](https://www.invicti.com/contact/)
  + [Support](https://www.invicti.com/support/)
  + [Careers](https://www.invicti.com/careers/)
  + [Resources](https://www.invicti.com/resources/)
  + [Partners](https://www.invicti.com/partners/)

© Invicti 2025

* [Compliance](https://www.invicti.com/compliance/)
* [Legal](https://www.invicti.com/legal/)
* [Privacy Policy](https://www.invicti.com/compliance/privacy-policy/)
* [California Privacy Rights](https://www.invicti.com/compliance/california-privacy-rights/)
* [Terms of Use](https://www.invicti.com/legal/terms/)
* [Accessibility](https://www.invicti.com/accessibility/)
* [Sitemap](https://www.invicti.com/sitemap/)

By using this website you agree with our use of cookies to improve its performance and enhance your experience. More information in our [Privacy Policy](https://www.invicti.com/privacy-policy).

OK


