```
Message-ID: <20171125235030.GA24195@breadbox.private.spodhuis.org>
Date: Sat, 25 Nov 2017 18:50:31 -0500
From: Phil Pennock <oss-security-phil@...dhuis.org>
To: oss-security@...ts.openwall.com
Subject: Re: RCE in Exim reported

bugs.exim.org/2199 :
  Use-after-free remote-code-execution
  CVE-2017-16943

Fix for the former has been confirmed by the reporter and is in git.
```

- **Root cause of vulnerability:** A use-after-free vulnerability exists in Exim's routines responsible for parsing mail headers. The vulnerability occurs when the buffer used to parse headers isn't large enough and Exim attempts to extend it.
- **Weaknesses/vulnerabilities:** Use-after-free. When extending a buffer for mail header parsing, Exim frees the original memory block but continues to use a pointer to it.
- **Impact of exploitation:** Remote code execution. An attacker can cause Exim to crash, leading to denial of service or potentially execute arbitrary code.
- **Attack vectors:** Sending a specially crafted email with specific header patterns that trigger the code responsible for buffer extension and memory management.
- **Required attacker capabilities/position:** A remote attacker that can send emails to an Exim server.