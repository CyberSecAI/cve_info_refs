=== Content from github.com_2a54a24f_20250124_165052.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fissues%2F8742)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fissues%2F8742)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=radareorg%2Fradare2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[radareorg](/radareorg)
/
**[radare2](/radareorg/radare2)**
Public

* [Notifications](/login?return_to=%2Fradareorg%2Fradare2) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Fradareorg%2Fradare2)
* [Star
   21k](/login?return_to=%2Fradareorg%2Fradare2)

* [Code](/radareorg/radare2)
* [Issues
  851](/radareorg/radare2/issues)
* [Pull requests
  26](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects
  0](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

Additional navigation options

* [Code](/radareorg/radare2)
* [Issues](/radareorg/radare2/issues)
* [Pull requests](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

# Memory corruption on 32bit system #8742

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Memory corruption on 32bit system](#top)#8742Copy linkMilestone[2.1.0](https://github.com/radareorg/radare2/milestone/23)[![@gsharpsh00ter](https://avatars.githubusercontent.com/u/24467455?v=4&size=80)](/gsharpsh00ter)
## Description

[![@gsharpsh00ter](https://avatars.githubusercontent.com/u/24467455?v=4&size=48)](/gsharpsh00ter)[gsharpsh00ter](https://github.com/gsharpsh00ter)opened [on Oct 26, 2017](https://github.com/radareorg/radare2/issues/8742#issue-268621513)

A memory corruption issue was found in radare2 on 32bit linux system when handling crafted ELF file.

Build information:

```
ctf@ubuntu:/home/g$ /home/g/radare2/bin/radare2 -v
radare2 2.1.0-git 16386 @ linux-x86-32 git.2.0.1-93-gcd8e103
commit: cd8e1037cd530560dfecdde224b5b0d0fafae31d build: 2017-10-24__20:30:19

```

Backtrace:

```
ctf@ubuntu:/home/g$ /home/g/radare2/bin/radare2 ./poc-free-memory-corruption-on-32bit
Warning: Cannot initialize strings table
Warning: Cannot initialize dynamic strings
Warning: section.shstrtab not found or invalid
Warning: Cannot initialize dynamic section
*** Error in `/home/g/radare2/bin/radare2': free(): invalid next size (fast): 0x80f88710 ***
======= Backtrace: =========
/lib/i386-linux-gnu/libc.so.6(+0x67f0a)[0xb55e1f0a]
/lib/i386-linux-gnu/libc.so.6(+0x6eb07)[0xb55e8b07]
/lib/i386-linux-gnu/libc.so.6(+0x6f446)[0xb55e9446]
/home/g/radare2/lib/libr_bin.so(+0x10566c)[0xb6fca66c]
/home/g/radare2/lib/libr_bin.so(Elf64_r_bin_elf_new_buf+0xf3)[0xb6fcff33]
/home/g/radare2/lib/libr_bin.so(+0xd796b)[0xb6f9c96b]
/home/g/radare2/lib/libr_bin.so(+0x349f7)[0xb6ef99f7]
/home/g/radare2/lib/libr_bin.so(r_bin_load_io_at_offset_as_sz+0x756)[0xb6efbd76]
/home/g/radare2/lib/libr_bin.so(r_bin_load_io_at_offset_as+0xb7)[0xb6efce77]
/home/g/radare2/lib/libr_bin.so(r_bin_load_io+0x72)[0xb6efd8a2]
/home/g/radare2/lib/libr_core.so(r_core_bin_load+0x1a16)[0xb74ab0e6]
/home/g/radare2/bin/radare2(main+0x2319)[0x80034098]
/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf6)[0xb5592276]
/home/g/radare2/bin/radare2(+0x2161)[0x80031161]
======= Memory map: ========
8002f000-80038000 r-xp 00000000 08:01 536986     /home/g/radare2/bin/radare2
80038000-80039000 r--p 00008000 08:01 536986     /home/g/radare2/bin/radare2
80039000-8003a000 rw-p 00009000 08:01 536986     /home/g/radare2/bin/radare2
8003a000-8009b000 rw-p 00000000 00:00 0
80e95000-80fa8000 rw-p 00000000 00:00 0          [heap]
b5300000-b5321000 rw-p 00000000 00:00 0
b5321000-b5400000 ---p 00000000 00:00 0
b549d000-b54b9000 r-xp 00000000 08:01 394771     /lib/i386-linux-gnu/libgcc_s.so.1
b54b9000-b54ba000 r--p 0001b000 08:01 394771     /lib/i386-linux-gnu/libgcc_s.so.1
b54ba000-b54bb000 rw-p 0001c000 08:01 394771     /lib/i386-linux-gnu/libgcc_s.so.1
b54d8000-b54f1000 r--s 00000000 08:01 678397     /home/g/radare2/share/radare2/2.1.0-git/opcodes/x86.sdb
b54f1000-b54f3000 rw-p 00000000 00:00 0
b54f3000-b54f5000 r-xp 00000000 08:01 397367     /lib/i386-linux-gnu/libutil-2.24.so
b54f5000-b54f6000 r--p 00001000 08:01 397367     /lib/i386-linux-gnu/libutil-2.24.so
b54f6000-b54f7000 rw-p 00002000 08:01 397367     /lib/i386-linux-gnu/libutil-2.24.so
b54f7000-b54fa000 r-xp 00000000 08:01 397352     /lib/i386-linux-gnu/libdl-2.24.so
b54fa000-b54fb000 r--p 00002000 08:01 397352     /lib/i386-linux-gnu/libdl-2.24.so
b54fb000-b54fc000 rw-p 00003000 08:01 397352     /lib/i386-linux-gnu/libdl-2.24.so
b54fc000-b554f000 r-xp 00000000 08:01 397353     /lib/i386-linux-gnu/libm-2.24.so
b554f000-b5550000 ---p 00053000 08:01 397353     /lib/i386-linux-gnu/libm-2.24.so
b5550000-b5551000 r--p 00053000 08:01 397353     /lib/i386-linux-gnu/libm-2.24.so
b5551000-b5552000 rw-p 00054000 08:01 397353     /lib/i386-linux-gnu/libm-2.24.so
b5552000-b556b000 r-xp 00000000 08:01 536917     /home/g/radare2/lib/libr_socket.so.2.1.0-git
b556b000-b556c000 r--p 00018000 08:01 536917     /home/g/radare2/lib/libr_socket.so.2.1.0-git
b556c000-b556d000 rw-p 00019000 08:01 536917     /home/g/radare2/lib/libr_socket.so.2.1.0-git
b556d000-b5578000 r-xp 00000000 08:01 536907     /home/g/radare2/lib/libr_lang.so.2.1.0-git
b5578000-b5579000 r--p 0000a000 08:01 536907     /home/g/radare2/lib/libr_lang.so.2.1.0-git
b5579000-b557a000 rw-p 0000b000 08:01 536907     /home/g/radare2/lib/libr_lang.so.2.1.0-git
b557a000-b572d000 r-xp 00000000 08:01 397349     /lib/i386-linux-gnu/libc-2.24.so
b572d000-b572e000 ---p 001b3000 08:01 397349     /lib/i386-linux-gnu/libc-2.24.so
b572e000-b5730000 r--p 001b3000 08:01 397349     /lib/i386-linux-gnu/libc-2.24.so
b5730000-b5731000 rw-p 001b5000 08:01 397349     /lib/i386-linux-gnu/libc-2.24.so
b5731000-b5734000 rw-p 00000000 00:00 0
b5734000-b574d000 r-xp 00000000 08:01 397363     /lib/i386-linux-gnu/libpthread-2.24.so
b574d000-b574e000 r--p 00018000 08:01 397363     /lib/i386-linux-gnu/libpthread-2.24.so
b574e000-b574f000 rw-p 00019000 08:01 397363     /lib/i386-linux-gnu/libpthread-2.24.so
b574f000-b5751000 rw-p 00000000 00:00 0
b5751000-b5948000 r-xp 00000000 08:01 536979     /home/g/radare2/lib/libr_util.so.2.1.0-git
b5948000-b594a000 r--p 001f6000 08:01 536979     /home/g/radare2/lib/libr_util.so.2.1.0-git
b594a000-b5952000 rw-p 001f8000 08:01 536979     /home/g/radare2/lib/libr_util.so.2.1.0-git
b5952000-b595e000 rw-p 00000000 00:00 0
b595e000-b5982000 r-xp 00000000 08:01 536890     /home/g/radare2/lib/libr_crypto.so.2.1.0-git
b5982000-b5983000 r--p 00023000 08:01 536890     /home/g/radare2/lib/libr_crypto.so.2.1.0-git
b5983000-b5984000 rw-p 00024000 08:01 536890     /home/g/radare2/lib/libr_crypto.so.2.1.0-git
b5984000-b5995000 rw-p 00000000 00:00 0
b5995000-b59bb000 r-xp 00000000 08:01 536894     /home/g/radare2/lib/libr_egg.so.2.1.0-git
b59bb000-b59bc000 r--p 00025000 08:01 536894     /home/g/radare2/lib/libr_egg.so.2.1.0-git
b59bc000-b59bd000 rw-p 00026000 08:01 536894     /home/g/radare2/lib/libr_egg.so.2.1.0-git
b59bd000-b59cf000 r-xp 00000000 08:01 536896     /home/g/radare2/lib/libr_flag.so.2.1.0-git
b59cf000-b59d0000 r--p 00011000 08:01 536896     /home/g/radare2/lib/libr_flag.so.2.1.0-git
b59d0000-b59d1000 rw-p 00012000 08:01 536896     /home/g/radare2/lib/libr_flag.so.2.1.0-git
b59d1000-b5a02000 r-xp 00000000 08:01 536909     /home/g/radare2/lib/libr_magic.so.2.1.0-git
b5a02000-b5a03000 r--p 00030000 08:01 536909     /home/g/radare2/lib/libr_magic.so.2.1.0-git
b5a03000-b5a04000 rw-p 00031000 08:01 536909     /home/g/radare2/lib/libr_magic.so.2.1.0-git
b5a04000-b5a24000 r-xp 00000000 08:01 536900     /home/g/radare2/lib/libr_hash.so.2.1.0-git
b5a24000-b5a25000 r--p 0001f000 08:01 536900     /home/g/radare2/lib/libr_hash.so.2.1.0-git
b5a25000-b5a26000 rw-p 00020000 08:01 536900     /home/g/radare2/lib/libr_hash.so.2.1.0-git
b5a26000-b5a2b000 r-xp 00000000 08:01 536974     /home/g/radare2/lib/libr_syscall.so.2.1.0-git
b5a2b000-b5a2c000 ---p 00005000 08:01 536974     /home/g/radare2/lib/libr_syscall.so.2.1.0-git
b5a2c000-b5a2d000 r--p 00005000 08:01 536974     /home/g/radare2/lib/libr_syscall.so.2.1.0-git
b5a2d000-b5a2e000 rw-p 00006000 08:01 536974     /home/g/radare2/lib/libr_syscall.so.2.1.0-git
b5a2e000-b5fec000 r-xp 00000000 08:01 536876     /home/g/radare2/lib/libr_asm.so.2.1.0-git
b5fec000-b604a000 r--p 005bd000 08:01 536876     /home/g/radare2/lib/libr_asm.so.2.1.0-git
b604a000-b637c000 rw-p 0061b000 08:01 536876     /home/g/radare2/lib/libr_asm.so.2.1.0-git
b637c000-b6453000 rw-p 00000000 00:00 0
b6453000-b6496000 r-xp 00000000 08:01 536898     /home/g/radare2/lib/libr_fs.so.2.1.0-git
b6496000-b6497000 r--p 00042000 08:01 536898     /home/g/radare2/lib/libr_fs.so.2.1.0-git
b6497000-b6498000 rw-p 00043000 08:01 536898     /home/g/radare2/lib/libr_fs.so.2.1.0-git
b6498000-b649f000 rw-p 00000000 00:00 0
b649f000-b6552000 r-xp 00000000 08:01 536902     /home/g/radare2/lib/libr_io.so.2.1.0-git
b6552000-b6553000 r--p 000b2000 08:01 536902     /home/g/radare2/lib/libr_io.so.2.1.0-git
b6553000-b655e000 rw-p 000b3000 08:01 536902     /home/g/radare2/lib/libr_io.so.2.1.0-git
b655e000-b6565000 rw-p 00000000 00:00 0
b6565000-b6572000 r-xp 00000000 08:01 536880     /home/g/radare2/lib/libr_bp.so.2.1.0-git
b6572000-b6573000 r--p 0000c000 08:01 536880     /home/g/radare2/lib/libr_bp.so.2.1.0-git
b6573000-b6574000 rw-p 0000d000 08:01 536880     /home/g/radare2/lib/libr_bp.so.2.1.0-git
b6574000-b6588000 r-xp 00000000 08:01 536913     /home/g/radare2/lib/libr_reg.so.2.1.0-git
b6588000-b6589000 r--p 00013000 08:01 536913     /home/g/radare2/lib/libr_reg.so.2.1.0-git
b6589000-b658a000 rw-p 00014000 08:01 536913     /home/g/radare2/lib/libr_reg.so.2.1.0-git
b658a000-b658c000 rw-p 00000000 00:00 0
b658c000-b6acd000 r-xp 00000000 08:01 536874     /home/g/radare2/lib/libr_anal.so.2.1.0-git
b6acd000-b6ae5000 r--p 00540000 08:01 536874     /home/g/radare2/lib/libr_anal.so.2.1.0-git
b6ae5000-b6d8e000 rw-p 00558000 08:01 536874     /home/g/radare2/lib/libr_anal.so.2.1.0-git
b6d8e000-b6e50000 rw-p 00000000 00:00 0
b6e50000-b6ec3000 r-xp 00000000 08:01 536892     /home/g/radare2/lib/libr_debug.so.2.1.0-git
b6ec3000-b6ec4000 r--p 00072000 08:01 536892     /home/g/radare2/lib/libr_debug.so.2.1.0-git
b6ec4000-b6ec5000 rw-p 00073000 08:01 536892     /home/g/radare2/lib/libr_debug.so.2.1.0-git
b6ec5000-b71ee000 r-xp 00000000 08:01 536878     /home/g/radare2/lib/libr_bin.so.2.1.0-git
b71ee000-b71f0000 r--p 00328000 08:01 536878     /home/g/radare2/lib/libr_bin.so.2.1.0-git
b71f0000-b71f4000 rw-p 0032a000 08:01 536878     /home/g/radare2/lib/libr_bin.so.2.1.0-git
b71f4000-b71ff000 r-xp 00000000 08:01 536882     /home/g/radare2/lib/libr_config.so.2.1.0-git
b71ff000-b7200000 r--p 0000a000 08:01 536882     /home/g/radare2/lib/libr_config.so.2.1.0-git
b7200000-b7201000 rw-p 0000b000 08:01 536882     /home/g/radare2/lib/libr_config.so.2.1.0-git
b7201000-b7261000 r-xp 00000000 08:01 536886     /home/g/radare2/lib/libr_cons.so.2.1.0-git
b7261000-b7262000 r--p 0005f000 08:01 536886     /home/g/radare2/lib/libr_cons.so.2.1.0-git
b7262000-b7263000 rw-p 00060000 08:01 536886     /home/g/radare2/lib/libr_cons.so.2.1.0-git
b7263000-b7266000 rw-p 00000000 00:00 0
b7266000-b727f000 r-xp 00000000 08:01 536915     /home/g/radare2/lib/libr_search.so.2.1.0-git
b727f000-b7280000 r--p 00018000 08:01 536915     /home/g/radare2/lib/libr_search.so.2.1.0-git
b7280000-b7281000 rw-p 00019000 08:01 536915     /home/g/radare2/lib/libr_search.so.2.1.0-git
b7281000-b72fd000 r-xp 00000000 08:01 536911     /home/g/radare2/lib/libr_parse.so.2.1.0-git
b72fd000-b72fe000 r--p 0007b000 08:01 536911     /home/g/radare2/lib/libr_parse.so.2.1.0-git
b72fe000-b72ff000 rw-p 0007c000 08:01 536911     /home/g/radare2/lib/libr_parse.so.2.1.0-git
b72ff000-b730f000 rw-p 00000000 00:00 0
b730f000-b76c1000 r-xp 00000000 08:01 536888     /home/g/radare2/lib/libr_core.so.2.1.0-git
b76c1000-b76c2000 ---p 003b2000 08:01 536888     /home/g/radare2/lib/libr_core.so.2.1.0-git
b76c2000-b76c3000 r--p 003b2000 08:01 536888     /home/g/radare2/lib/libr_core.so.2.1.0-git
b76c3000-b76cd000 rw-p 003b3000 08:01 536888     /home/g/radare2/lib/libr_core.so.2.1.0-git
b76cd000-b76ce000 rw-p 00000000 00:00 0
b76db000-b76dc000 rw-p 00000000 00:00 0
b76dc000-b76df000 r--s 00000000 08:01 1709578    /home/g/poc-free-memory-corruption-on-32bit
b76df000-b76e3000 r--s 00000000 08:01 678414     /home/g/radare2/share/radare2/2.1.0-git/syscall/linux-x86-32.sdb
b76e3000-b76e5000 r-xp 00000000 08:01 678210     /home/g/radare2/lib/radare2/2.1.0-git/asm_propeller.so
b76e5000-b76e6000 r--p 00001000 08:01 678210     /home/g/radare2/lib/radare2/2.1.0-git/asm_propeller.so
b76e6000-b76e7000 rw-p 00002000 08:01 678210     /home/g/radare2/lib/radare2/2.1.0-git/asm_propeller.so
b76e7000-b76eb000 r--s 00000000 08:01 678414     /home/g/radare2/share/radare2/2.1.0-git/syscall/linux-x86-32.sdb
b76eb000-b76ee000 rw-p 00000000 00:00 0
b76ee000-b76f0000 r--p 00000000 00:00 0          [vvar]
b76f0000-b76f2000 r-xp 00000000 00:00 0          [vdso]
b76f2000-b7715000 r-xp 00000000 08:01 397345     /lib/i386-linux-gnu/ld-2.24.so
b7715000-b7716000 r--p 00022000 08:01 397345     /lib/i386-linux-gnu/ld-2.24.so
b7716000-b7717000 rw-p 00023000 08:01 397345     /lib/i386-linux-gnu/ld-2.24.so
bf950000-bf971000 rw-p 00000000 00:00 0          [stack]
Aborted

```

Enviroment:

```
ctf@ubuntu:/home/g$ uname -a
Linux ubuntu 4.8.0-59-generic #64-Ubuntu SMP Thu Jun 29 19:37:59 UTC 2017 i686 i686 i686 GNU/Linux
ctf@ubuntu:/home/g$ cat /etc/*lease
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=16.10
DISTRIB_CODENAME=yakkety
DISTRIB_DESCRIPTION="Ubuntu 16.10"
NAME="Ubuntu Kylin"
VERSION="16.10 (Yakkety Yak)"
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME="Ubuntu Kylin 16.10"
VERSION_ID="16.10"
HOME_URL="http://www.ubuntu.com/"
SUPPORT_URL="http://help.ubuntu.com/"
BUG_REPORT_URL="http://bugs.launchpad.net/ubuntu/"
PRIVACY_POLICY_URL="http://www.ubuntu.com/legal/terms-and-policies/privacy-policy"
VERSION_CODENAME=yakkety
UBUNTU_CODENAME=yakkety
ctf@ubuntu:/home/g$

```

A POC file has been attached to reproduce this issue.

[poc-free-memory-corruption-on-32bit.zip](https://github.com/radare/radare2/files/1416900/poc-free-memory-corruption-on-32bit.zip)

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

* [2.1.0](https://github.com/radareorg/radare2/milestone/23)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_61ac64fa_20250124_165050.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fcommit%2F0b973e28166636e0ff1fad80baa0385c9c09c53a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fcommit%2F0b973e28166636e0ff1fad80baa0385c9c09c53a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=radareorg%2Fradare2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[radareorg](/radareorg)
/
**[radare2](/radareorg/radare2)**
Public

* [Notifications](/login?return_to=%2Fradareorg%2Fradare2) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Fradareorg%2Fradare2)
* [Star
   21k](/login?return_to=%2Fradareorg%2Fradare2)

* [Code](/radareorg/radare2)
* [Issues
  851](/radareorg/radare2/issues)
* [Pull requests
  26](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects
  0](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

Additional navigation options

* [Code](/radareorg/radare2)
* [Issues](/radareorg/radare2/issues)
* [Pull requests](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

## Commit

[Permalink](/radareorg/radare2/commit/0b973e28166636e0ff1fad80baa0385c9c09c53a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fixed crash in elf.c with 32bit r2 when shdr->sh\_size > max size\_t

[Browse files](/radareorg/radare2/tree/0b973e28166636e0ff1fad80baa0385c9c09c53a)
Browse the repository at this point in the history

* Loading branch information

[![@kazarmy](https://avatars.githubusercontent.com/u/12002672?s=40&v=4)](/kazarmy)

[kazarmy](/radareorg/radare2/commits?author=kazarmy "View all commits by kazarmy")
committed
Oct 28, 2017

1 parent
[2fd75e3](/radareorg/radare2/commit/2fd75e3063ebd5bdf76d8f83a5eb17367ec2b965)

commit 0b973e2

Showing
**1 changed file**
with
**2 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[libr/bin/format/elf/elf.c](#diff-c6b2132645334085ceec096eefd7b2a52ff95232882b5c7f9f1930f0b154fff8 "libr/bin/format/elf/elf.c")

Show comments

[View file](/radareorg/radare2/blob/0b973e28166636e0ff1fad80baa0385c9c09c53a/libr/bin/format/elf/elf.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -705,7 +705,7 @@ static Sdb \*store\_versioninfo\_gnu\_verdef(ELFOBJ \*bin, Elf\_(Shdr) \*shdr, int sz) |
|  |  | return false; |
|  |  | } |
|  |  | link\_shdr = &bin->shdr[shdr->sh\_link]; |
|  |  | if (shdr->sh\_size < 1) { |
|  |  | if (shdr->sh\_size < 1 || shdr->sh\_size > SIZE\_MAX) { |
|  |  | return false; |
|  |  | } |
|  |  | Elf\_(Verdef) \*defs = calloc (shdr->sh\_size, sizeof (char)); |
| Expand Down  Expand Up | | @@ -837,7 +837,7 @@ static Sdb \*store\_versioninfo\_gnu\_verneed(ELFOBJ \*bin, Elf\_(Shdr) \*shdr, int sz) |
|  |  | if (shdr->sh\_link > bin->ehdr.e\_shnum) { |
|  |  | return NULL; |
|  |  | } |
|  |  | if (shdr->sh\_size < 1) { |
|  |  | if (shdr->sh\_size < 1 || shdr->sh\_size > SIZE\_MAX) { |
|  |  | return NULL; |
|  |  | } |
|  |  | sdb = sdb\_new0 (); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0b973e2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fcommit%2F0b973e28166636e0ff1fad80baa0385c9c09c53a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


