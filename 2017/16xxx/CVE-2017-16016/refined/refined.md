The provided content relates to CVE-2017-16016.

**Root cause of vulnerability:**
The vulnerability stems from how the `sanitize-html` library handles text content within non-text tags when these tags are explicitly allowed. Specifically, the `ontext` method in the library's code does not properly escape HTML entities within these tags, leading to potential XSS. The htmlparser2 library's `decodeEntities` setting decodes the text before it reaches `sanitize-html`, which is the root of the problem.

**Weaknesses/vulnerabilities present:**
- Improper handling of HTML entities within non-text tags.
- The `ontext` method in the library does not re-encode HTML entities within non-text tags when allowed.
- Allowing certain tags such as `textarea` bypasses the intended sanitization, leading to XSS if not handled properly

**Impact of exploitation:**
- Cross-site scripting (XSS) attacks can be carried out by injecting malicious HTML code.
- Attackers could execute arbitrary JavaScript within the context of the user's browser.
- This can lead to stealing of cookies, session hijacking, or redirecting users to malicious sites.

**Attack vectors:**
- Injecting malicious HTML code within allowed non-text tags such as `<textarea>`.
- Specifically injecting HTML entities that, when decoded by the browser, form executable JavaScript or HTML elements.

**Required attacker capabilities/position:**
- The attacker needs the ability to inject HTML content that will be processed by the vulnerable `sanitize-html` library with the vulnerable configuration of allowing non-text tags.
- The attacker needs to be able to influence the input that goes into the sanitization function.