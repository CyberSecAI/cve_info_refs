=== Content from marc.info_adca729d_20250124_215310.html ===

```
[[prev in list](?l=bugtraq&m=112084432924328&w=2)] [[next in list](?l=bugtraq&m=112084335514599&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Advisory 08/2005: PunBB SQL Injection Vulnerability
From:       [Stefan Esser <sesser () hardened-php ! net>](?a=111922035400001&r=1&w=2)
Date:       [2005-07-07 22:43:38](?l=bugtraq&r=1&w=2&b=200507)
Message-ID: [20050707224338.GA5823 () hardened-php ! net](?i=20050707224338.GA5823%20()%20hardened-php%20!%20net)
[Download RAW [message](?l=bugtraq&m=112084384928950&q=mbox) or [body](?l=bugtraq&m=112084384928950&q=raw)]

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

                        Hardened-PHP Project
                        [www.hardened-php.net](http://www.hardened-php.net)

                      -= Security  Advisory =-

     Advisory: PunBB SQL Injection Vulnerability
 Release Date: 2005/08/05
Last Modified: 2005/08/05
       Author: Stefan Esser [sesser@hardened-php.net]

  Application: PunBB <= 1.2.5
     Severity: An uninitialised variable within PunBB allows
               SQL injection and can lead to forum privilege
	       escalation
         Risk: Critical
Vendor Status: Vendor has released an updated version
   References: <http://www.hardened-php.net/advisory-082005.php>

Overview:

   Quote from <http://www.punbb.org>
   "In short, PunBB is a fast and lightweight PHP powered discussion
   board. It is released under the GNU Public License. Its primary goal
   is to be a faster, smaller and less graphic alternative to otherwise
   excellent discussion boards such as phpBB, Invision Power Board or
   vBulletin. PunBB has fewer features than many other discussion
   boards, but is generally faster and outputs smaller pages."

   An audit of PunBB has revealed an SQL injection vulnerability in the
   user profile edit module. As a result of this an attacker may inject
   arbitrary field-updates into an UPDATE query, that is executed on the
   user table. By simply updating the group id of a useracount it is
   possible to become an admin.

   Due to the fact, that this bug relies on a not initialised variable
   it is only exploitable when register_globals is turned on, which is
   the case on most PHP servers, that actually use forums.

Details:

   During an audit of PunBB we stumbled on the following code-snippet
   that can be found in the user profile edit module in profile.php.

      // Singlequotes around non-empty values and NULL for ...
      while (list($key, $input) = @each($form))
      {
         $value = ($input !== '') ?
	                  '\''.$db->escape($input).'\'' : NULL;
         $temp[] = $key.'='.$value;
      }

      $db->query('UPDATE '.$db->prefix.'users SET '.
                                          implode(',', $temp)...

   This piece of code converts an array of form variables into an
   array of 'key=value' strings that are then used as parameters
   of an update query. The values are user supplied and therefore
   correctly escaped.

   However this code fails to initialize the $temp variable and
   so it is possible for an attacker to supply arbitrary 'key=value'
   strings through the GET, POST or COOKIE variables, when
   register_globals is on.

   Injecting something like temp[[0]](#0)=group_id=1 is enough to add
   yourself to the Administrators group. As an admin it is possible
   to execute arbitrary PHP code through the template system.
   (see Advisory 09/2005 for details)

Proof of Concept:

   The Hardened-PHP Project is not going to release an exploit
   for this vulnerability to the public.

Disclosure Timeline:

   27. June 2005 - Contacted security@punbb.org via email
   28. July 2005 - Discussed solution possibilities with vendor
   07. July 2005 - Vendor releases bugfixed version
   08. July 2005 - Public disclosure

Recommendation:

   We strongly recommend to upgrade to the vendor supplied
   new version

      PunBB 1.2.6
      <http://www.punbb.org/download/punbb-1.2.6.tar.gz>

GPG-Key:

   <http://www.hardened-php.net/hardened-php-signature-key.asc>

   pub  1024D/0A864AA1 2004-04-17 Hardened-PHP Signature Key
   Key fingerprint = 066F A6D0 E57E 9936 9082  7E52 4439 14CC 0A86 4AA1

Copyright 2005 Stefan Esser. All rights reserved.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.6 (GNU/Linux)
Comment: For info see <http://www.gnupg.org>

iD8DBQFCzbStRDkUzAqGSqERAr+0AJ9WHhwTBscP4sMxfMk/kGH2UPsI6ACgjyec
pnwtMpG5HFGQyBormf7Ej0o=
=rE61
-----END PGP SIGNATURE-----

[[prev in list](?l=bugtraq&m=112084432924328&w=2)] [[next in list](?l=bugtraq&m=112084335514599&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.hardened-php.net_4b698a53_20250124_215311.html ===

# [Hardened-PHP](http://www.hardened-php.net/)

## PHP Security

Menu
[Skip to content](#content)

* [Home](http://www.hardened-php.net/)

# Hardened PHP

PHP is far and away the most popular backend programming
language today, with more than 80 websites worldwide taking advantage of PHP
solutions.

All of the most popular CMS platforms – including WordPress,
Joomla!, and Drupal (just to name a few) leverage this technology. It’s
flexibility and versatility make it a powerhouse programming language, but that
doesn’t necessarily mean that it is as secure as it could or should be “right
out of the box”, so to speak.

It’s popularity, it’s widespread adaptation, and its
relatively easy to learn structure has made PHP a major target for cyber
criminals and hackers to exploit. This is why it’s mission-critical that you
harden your PHP files server-side as much as possible, protecting your server,
your content, and your visitors from these kinds of dangerous exploits.

PHP can be hardened manually as well as with patching
protocols. Below we highlight the steps you’ll want to take to make sure that
your PHP installation is as locked down as possible.

**Locate the PHP Config File You’re Hardening on Your Server**

The very first step in hardening your PHP installation is
first finding the PHP configuration file on your server to begin with.

Depending on the hosting that you are taking advantage of
(the actual provider as well as the type of hosting you have selected) it can
be in a variety of different locations. The best way to quickly locate this
critical file is to simply do a server-side search for “PHP.ini” as this is the
actual file that you’ll want to modify, edit, and harden moving forward.

**Editing the File on Shared Hosting**

Individuals looking to harden their PHP on a shared hosting platform (see [The Blog Starter](https://www.theblogstarter.com/) for hosting options) will have a bit of a tougher hill to climb, if only because most providers do not offer root access to the server with this level of hosting.

You’ll have to contact your hosting provider directly to see
if you can edit the main PHP.ini file itself. In the event that you aren’t
allowed this kind of access, you can still request to have access to the
“.HTaccess” file on your server to make the changes you need to.

You won’t be able to make changes quite as quickly this way
as you would have been able to with a patch (like we highlight below), but you
can manually make individual line edits to your PHP settings this way to enjoy
a higher level of security.

Shared hosting may still have limitations on the PHP elements you can edit no matter how much access you are granted. If you want total control over hardening your PHP (and total control over the security of your web platform), it’s not a bad idea to move to Dedicated or VPS servers if you can afford it.

**Editing the File on Dedicated/VPS servers**

If you are moving forward with a Virtual Private Server
(VPS) or Dedicated server set up the process for hardening your PHP is a lot
easier, though it’s still not as quick as applying a server wide patch like we
highlight below.

In the backend administration toolset of your server
solution you’ll find a tool called the Web Host Manager. This is usually
located under the “Service Configuration” settings option in your backend
dashboard.

This tool is going to allow you to select the PHP
Configuration Editor, and editor that allows you to make changes to your
PHP.ini file through a more user-friendly interface than actually downloading
the file, opening it up in Notepad or a similar application, and then making
the edits individually with the actual source code itself.

There are a handful of individual settings that you’re going
to want to reconfigure manually when taking this approach to hardening your PHP
installation, including (but not limited to):

•           Remote
Connections

•           Run Time
Settings

•           Input Data
Restrictions

•           Error
Handling

•           Restrict
File Access

•           File
Uploads

•           Session
Security

•           Soap Cache

… And that’s just the tip of the iceberg.

**Use a Patch like Suhosin to Harden PHP Almost Instantly**

The big attraction behind PHP is that it is so easy to learn,
so easy to develop with, and about as flexible as a programming language gets –
and that’s why a lot of people feel comfortable hardening their PHP manually,
running line by line through their PHP.ini file and doing the heavy lifting of
securing their system on their own.

And while you may be a top-tier programmer and feel
completely confident in your coding prowess, the truth of the matter is that if
you allow ANY coding from ANY outside developers to run on your server you’ll
still have vulnerabilities that you may not be able to address independently –
vulnerabilities that can compromise your entire platform.

This is why patching your PHP systemwide is such a savvy
move, and why so many developers, programmers, and website/web application
owners utilizing PHP decide to move forward with a solution like Suhosin.

Engineered specifically to provide an advanced layer of
protection to PHP installations, the Suhosin patch is a dual action component
that provides a level of hardening that may not be possible through any other
manual approach.

On the one hand, Suhosin works to patch the PHP core on your
server. This allows this patch to protect against issues like format string
vulnerabilities, buffer overflows, and other issues that may plague your as of
yet unsecured PHP installation.

On the other hand, Suhosin also acts as an extension to the
PHP that has already been installed on your server. This extension runs 24/7,
around-the-clock, to protect against all kinds of vulnerabilities (including
runtime vulnerabilities) as well as individual session issues while adding a
whole host of logging, filtering, and administrative tools at the same time.

Best of all, the installation of this PHP hardening patch is
about as simple and as straightforward as it gets.

All of the features it has to offer exist within its
extension module and “flipping the switch” to allow that extension to run is as
easy as activating the individual extension inside of the PHP.ini file.
Sometimes you’ll have to manually add a couple of extra Configuration
Directives to trigger the full suite of extension capabilities, but most of the
time the Suhosin patch works just as soon as the edits to the PHP.ini file go
live.

Search for:

### Categories

* [hphp](http://www.hardened-php.net/./hphp/)
* [Suhosin](http://www.hardened-php.net/./suhosin/)

[Proudly powered by WordPress](https://wordpress.org/ "Semantic Personal Publishing Platform")


