=== Content from www.gentoo.org_5233456c_20250125_130728.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# OpenTTD: Format string vulnerabilities — GLSA **200509-03**

OpenTTD is vulnerable to format string vulnerabilities which may result in
remote execution of arbitrary code.

### Affected packages

| Package | **games-simulation/openttd** on all architectures |
| --- | --- |
| Affected versions | < **0.4.0.1-r1** |
| Unaffected versions | >= **0.4.0.1-r1** |

### Background

OpenTTD is an open source clone of the simulation game "Transport
Tycoon Deluxe" by Microprose.

### Description

Alexey Dobriyan discovered several format string vulnerabilities in
OpenTTD.

### Impact

A remote attacker could exploit these vulnerabilities to crash the
OpenTTD server or client and possibly execute arbitrary code with the
rights of the user running OpenTTD.

### Workaround

There are no known workarounds at this time.

### Resolution

All OpenTTD users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=games-simulation/openttd-0.4.0.1-r1"
```
### References

* [CAN-2005-2763](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-2763)
* [CVE-2005-2764](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2764)

**Release date**

September 05, 2005

**Latest revision**

May 22, 2006: 02

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [102631](https://bugs.gentoo.org/show_bug.cgi?id=102631)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.gentoo.org_55ca263d_20250126_084749.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 10
Evolution-mail segfaults
Last modified: 2002-05-28 07:55:42 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=10&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=10&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 10**](show_bug.cgi?id=10)
- Evolution-mail segfaults

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Evolution-mail segfaults

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Linux | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Linux "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | [OLD] GNOME ([show other bugs](buglist.cgi?component=%5BOLD%5D%20GNOME&product=Gentoo%20Linux&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High minor | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Martin Schlemmer (RETIRED) | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | Duplicates (3): | [11](show_bug.cgi?id=11 "RESOLVED DUPLICATE - Evolution: mailcomponent crashes when opening mailsettings") [563](show_bug.cgi?id=563 "RESOLVED DUPLICATE - Evolution Mail Settings Broken") [602](show_bug.cgi?id=602 "RESOLVED DUPLICATE - evolution segfault")  ([view as bug list](buglist.cgi?bug_id=11,563,602)) | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2002-01-04 09:19 UTC by Grant Goodyear (RETIRED) | | --- | --- | | Modified: | 2002-05-28 07:55 UTC ([History](show_activity.cgi?id=10)) | | CC List: | 3 users (show)  hallski hoffman nic\_spam | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=10&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=10&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Grant Goodyear (RETIRED)   gentoo-dev  2002-01-04 09:19:09 UTC  ``` For some reason evolution-mail segfaults.  Specifically, I see evolution  segfault when I click on mail and then the mail-settings option. ```  [Comment 1](#c1)  Mikael Hallendal (hallski) (RETIRED)   gentoo-dev  2002-01-04 11:06:54 UTC  ``` *** [Bug 11](show_bug.cgi?id=11 "RESOLVED DUPLICATE - Evolution: mailcomponent crashes when opening mailsettings") has been marked as a duplicate of this bug. *** ```  [Comment 2](#c2)  Mikael Hallendal (hallski) (RETIRED)   gentoo-dev  2002-01-04 14:57:53 UTC  ``` test ```  [Comment 3](#c3)  Mikael Hallendal (hallski) (RETIRED)   gentoo-dev  2002-01-06 19:28:48 UTC  ``` Ok, have a way of going around the issue (I think).  The problem seems to occur if the mailclient crashes before you close the program the first time the configure-database gets corrupted.   If you directly after Evolution starts for the first time exits cleanly it seems to be working as it should after that. Can this be confirmed somewhere else?   ```  [Comment 4](#c4)  Grant Goodyear (RETIRED)   gentoo-dev  2002-01-06 20:45:26 UTC  ``` The shutdown-just-after-starting-the-first-time solution seems to work just fine.  Yayyyy!!!  Changing severity to minor, now that we have a  work-around. ```  [Comment 5](#c5)  Daniel Robbins (RETIRED)   gentoo-dev  2002-01-06 22:17:53 UTC  ``` I had this problem and had to login to my IMAP server first before opening mail settings.  I'm marking this as fixed since I think it's more of an evolution issue than anything we're doing wrong. ```  [Comment 6](#c6)  Mikael Hallendal (hallski) (RETIRED)   gentoo-dev  2002-01-06 23:48:45 UTC  ``` Please don't do this. I am assigned to the bug and I haven't marked it as being resolved since I want to look in to the issue. No other distributions has this problem. I wan't to make sure it's not due to our default -O3 CFLAGS. ```  [Comment 7](#c7)  Grant Goodyear (RETIRED)   gentoo-dev  2002-01-07 13:00:08 UTC  ``` Hmmm.  I often get a segfault when trying to print from an email, but it doesn't happen all of the time.  Worse, I don't see any pattern of when it happens. ```  [Comment 8](#c8)  JP Sartre    2002-01-19 11:14:09 UTC  ``` Well, I don't know about you guys, but I segfault everytime I try to apply a new filter. Just installed gentoo, so maybe I'm missing something? I can read and delete email fine, just can't add filters. Not sure if this is related or should be a new bug?  JP ```  [Comment 9](#c9)  Mikael Hallendal (hallski) (RETIRED)   gentoo-dev  2002-01-19 12:19:36 UTC  ``` it's probably not related.  ```  [Comment 10](#c10)  Mikael Hallendal (hallski) (RETIRED)   gentoo-dev  2002-01-26 11:00:41 UTC  ``` The filter crash is fixed in 1.0.1-r2.  ```  [Comment 11](#c11)  Grant Goodyear (RETIRED)   gentoo-dev  2002-02-07 10:08:37 UTC  ``` *** [Bug 563](show_bug.cgi?id=563 "RESOLVED DUPLICATE - Evolution Mail Settings Broken") has been marked as a duplicate of this bug. *** ```  [Comment 12](#c12)  Grant Goodyear (RETIRED)   gentoo-dev  2002-02-08 15:27:11 UTC  ``` *** [Bug 602](show_bug.cgi?id=602 "RESOLVED DUPLICATE - evolution segfault") has been marked as a duplicate of this bug. *** ```  [Comment 13](#c13)  Nathan Quinlan    2002-05-28 07:55:42 UTC  ``` First time installer of Gentoo, I got the iso image last week and finished  installing everything yesturday.  This Evolution bug still appears to exist.   Emerge installed Evolution 1.0.5 and since I didn't exit after doing the wizard  the evolution-mail process keeps segfaulting. After removing ~/evolution and following the work around it no longer segfaults  but this bug still happens.  Should be re-opened. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=10)
* - [XML](show_bug.cgi?ctype=xml&id=10)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=10)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=10&product=Gentoo%20Linux)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=10&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=10&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.gentoo.org_46a91e6d_20250125_130727.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 102631
games-simulation/openttd: format string vulnerabilities
Last modified: 2005-09-05 09:30:17 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=102631&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=102631&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 102631**](show_bug.cgi?id=102631)
- games-simulation/openttd: format string vulnerabilities

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
games-simulation/openttd: format string vulnerabilities

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B1 [glsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2005-08-15 10:35 UTC by Alexey Dobriyan | | --- | --- | | Modified: | 2005-09-05 09:30 UTC ([History](show_activity.cgi?id=102631)) | | CC List: | 1 user (show)  dholm | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**patch to fix possible buffer overflows + format string bugs**](attachment.cgi?id=66105 "View the content of the attachment") (ttd\_bugs.patch,6.07 KB, patch)  [2005-08-16 15:40 UTC](#attach_66105 "Go to the comment associated with the attachment"), Alexey Dobriyan | *no flags* | [Details](attachment.cgi?id=66105&action=edit) | [Diff](attachment.cgi?id=66105&action=diff) | | [View All](attachment.cgi?bugid=102631&action=viewall)  [Add an attachment](attachment.cgi?bugid=102631&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=102631&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Alexey Dobriyan    2005-08-15 10:35:12 UTC  ``` ttd.c:         char * CDECL str_fmt(const char *str, ...)         {         ===>    char buf[4096];    <===                 va_list va;                 int len;                 char *p;                  va_start(va, str);         ===>    len = vsprintf(buf, str, va);   <===                 va_end(va);                 p = malloc(len + 1);                 if (p)                         memcpy(p, buf, len + 1);                 return p;         } ------------------------------------------------------------------------------- str_fmt() is used everywhere, including the following snippet in unix.c:  ===>    const char *homedir = getenv("HOME");   <===          if (homedir == NULL) {                 const struct passwd *pw = getpwuid(getuid());                 if (pw != NULL) homedir = pw->pw_dir;         }          _path.personal_dir = str_fmt("%s" PATHSEP "%s", homedir, PERSONAL_DIR);                              ^^^^^^^ ^^^                ^^^^^^^ ------------------------------------------------------------------------------- Notice the first chunk mentions "Network".  diff -uprN openttd-0.4.0.1/network.c openttd-0.4.0.1-vsprintf/network.c --- openttd-0.4.0.1/network.c	2005-05-17 20:01:19.000000000 +0400 +++ openttd-0.4.0.1-vsprintf/network.c	2005-08-15 20:34:45.000000000 +0400 @@ -96,7 +96,7 @@ void CDECL NetworkTextMessage(NetworkAct  	StringID TempStr = STR_NULL;    	va_start(va, str); -	vsprintf(buf, str, va); +	vsnprintf(buf, sizeof(buf), str, va);  	va_end(va);    	switch (action) { diff -uprN openttd-0.4.0.1/os2.c openttd-0.4.0.1-vsprintf/os2.c --- openttd-0.4.0.1/os2.c	2005-05-15 18:01:35.000000000 +0400 +++ openttd-0.4.0.1-vsprintf/os2.c	2005-08-15 20:31:26.000000000 +0400 @@ -642,7 +642,7 @@ static long CDECL MidiSendCommand(const   	va_list va;  	char buf[512];  	va_start(va, cmd); -	vsprintf(buf, cmd, va); +	vsnprintf(buf, sizeof(buf), cmd, va);  	va_end(va);  	return mciSendString(buf, NULL, 0, NULL, 0);  } diff -uprN openttd-0.4.0.1/strgen/strgen.c openttd-0.4.0.1-vsprintf/strgen/strgen.c --- openttd-0.4.0.1/strgen/strgen.c	2005-04-24 19:41:01.000000000 +0400 +++ openttd-0.4.0.1-vsprintf/strgen/strgen.c	2005-08-15 20:37:12.000000000 +0400 @@ -84,7 +84,7 @@ void warning(const char *s, ...) {  	char buf[1024];  	va_list va;  	va_start(va, s); -	vsprintf(buf, s, va); +	vsnprintf(buf, sizeof(buf), s, va);  	va_end(va);  	fprintf(stderr, "%d: ERROR: %s\n", _cur_line, buf);  	_warnings = true; @@ -94,7 +94,7 @@ void NORETURN error(const char *s, ...)   	char buf[1024];  	va_list va;  	va_start(va, s); -	vsprintf(buf, s, va); +	vsnprintf(buf, sizeof(buf), s, va);  	va_end(va);  	fprintf(stderr, "%d: FATAL: %s\n", _cur_line, buf);  	exit(1); diff -uprN openttd-0.4.0.1/texteff.c openttd-0.4.0.1-vsprintf/texteff.c --- openttd-0.4.0.1/texteff.c	2005-03-28 16:38:02.000000000 +0400 +++ openttd-0.4.0.1-vsprintf/texteff.c	2005-08-15 20:36:22.000000000 +0400 @@ -57,7 +57,7 @@ void CDECL AddTextMessage(uint16 color,   	int length;    	va_start(va, message); -	vsprintf(buf, message, va); +	vsnprintf(buf, sizeof(buf), message, va);  	va_end(va);    	/* Special color magic */ diff -uprN openttd-0.4.0.1/ttd.c openttd-0.4.0.1-vsprintf/ttd.c --- openttd-0.4.0.1/ttd.c	2005-05-16 20:19:32.000000000 +0400 +++ openttd-0.4.0.1-vsprintf/ttd.c	2005-08-15 20:33:33.000000000 +0400 @@ -70,7 +70,7 @@ void CDECL error(const char *s, ...) {  	va_list va;  	char buf[512];  	va_start(va, s); -	vsprintf(buf, s, va); +	vsnprintf(buf, sizeof(buf), s, va);  	va_end(va);    	ShowOSErrorBox(buf); @@ -86,7 +86,7 @@ void CDECL ShowInfoF(const char *str, ..  	va_list va;  	char buf[1024];  	va_start(va, str); -	vsprintf(buf, str, va); +	vsnprintf(buf, sizeof(buf), str, va);  	va_end(va);  	ShowInfo(buf);  } @@ -99,7 +99,7 @@ char * CDECL str_fmt(const char *str, ..  	char *p;    	va_start(va, str); -	len = vsprintf(buf, str, va); +	len = vsnprintf(buf, sizeof(buf), str, va);  	va_end(va);  	p = malloc(len + 1);  	if (p) diff -uprN openttd-0.4.0.1/win32.c openttd-0.4.0.1-vsprintf/win32.c --- openttd-0.4.0.1/win32.c	2005-05-16 20:19:32.000000000 +0400 +++ openttd-0.4.0.1-vsprintf/win32.c	2005-08-15 20:37:31.000000000 +0400 @@ -841,7 +841,7 @@ static long CDECL MidiSendCommand(const   	char buf[512];    	va_start(va, cmd); -	vsprintf(buf, cmd, va); +	vsnprintf(buf, sizeof(buf), cmd, va);  	va_end(va);  	return mciSendStringA(buf, NULL, 0, 0);  } ```  [Comment 1](#c1)  Sune Kloppenborg Jeppesen (RETIRED)   gentoo-dev  2005-08-16 00:09:41 UTC  ``` Auditors please advise.  ```  [Comment 2](#c2)  Tavis Ormandy (RETIRED)   gentoo-dev  2005-08-16 02:11:33 UTC  ``` openttd is not installed suid or sgid, therefore there is no security impact  from the expansion of environment variables.  The win32.c looks like it's conditionally compiled on windows systems only, and  therefore is not an issue for Gentoo Linux users, however upstream might like to  be informed so they can investigate.  the NetworkTextMessage() does not look like it can be passed enough information  to overflow that buffer, Reporter: have you have tested this issue? There might  be a format string issue via player names, but I dont have any TTD files to  verify this.  The same for AddTextMessage() which is only called via NetworkTextMessage(), and  does not appear to be an issue.  os2.c does not appear to be compiled on non-os2 platforms, and therefore is not  an issue for Gentoo Linux users.  strgen.c appears to be a component of a tool used during build, and is not  installed as part of the final package. Therefore there is no potential for  security issues.  I checked every call to error(), it's mostly called with literal arguments,  except in a few places that include filenames and so on. As loading data files  should be considered a trusted operation, this doesn not appear to be an issue,  however upstream might be interested in your patch as a proactive step against  future typos.  The same for ShowInfoF(), the only attack vector seems to be via reading  malformed ini files, which should be a trusted operation.  str_fmt() also appears to only deal with opening language packs and so on.  The 3.6-r1 version is the only version marked stable on a security supported  architecture (ppc).  Reporter: if you have any testcases that demonstrate these bugs, please include  them in your bug report to help speed up the auditing process. ```  [Comment 3](#c3)  Tavis Ormandy (RETIRED)   gentoo-dev  2005-08-16 06:54:47 UTC  ``` I found a copy of the game online and attempted to trigger these issues, however  I could not, handing this over to the games team to see how they want to  proceed. ```  [Comment 4](#c4)  Alexey Dobriyan    2005-08-16 10:39:48 UTC  ``` Note about format bugs was damn right. Let's cook a malicious client.  network_client.c:    228	// Send an quit-packet over the network    229	DEF_CLIENT_SEND_COMMAND_PARAM(PACKET_CLIENT_QUIT)(const char *leavemsg)    230	{    231		//    232		// Packet: CLIENT_QUIT    233		// Function: The client is quiting the game    234		// Data:    235		//    String: leave-message    236		//    237		Packet *p = NetworkSend_Init(PACKET_CLIENT_QUIT);    238	    239	===>	NetworkSend_string(p, leavemsg);   <===    240		NetworkSend_Packet(p, MY_CLIENT);    241	}  Usually leavemsg = "leave", but we'll make it "%n".  On server side:  network_server.c:    921	DEF_SERVER_RECEIVE_COMMAND(PACKET_CLIENT_QUIT)    922	{    923		// The client wants to leave. Display this and report it to the other    924		//  clients.    925		NetworkClientState *new_cs;    926		char str[100];    927		char client_name[NETWORK_CLIENT_NAME_LENGTH];    928	    929		// The client was never joined.. thank the client for the packet, but ignore it    930		if (cs->status < STATUS_DONE_MAP || cs->quited) {    931			cs->quited = true;    932			return;    933		}    934	    935	===>	NetworkRecv_string(cs, p, str, 100);   <===    936	    937		NetworkGetClientName(client_name, sizeof(client_name), cs);    938	    939	===>	NetworkTextMessage(NETWORK_ACTION_LEAVE, 1, false, client_name, str);   <===  Server usually gets "leave", but now it's "%n" which is passed straight to vsprintf() in NetworkTextMessage().  /me recompiles, starts server, starts "client", joins, quits. Yup, "Segmentation fault" on server side.  For now, all places with 	NetworkRecv_string(,,str,); 	NetworkTextMessage(,,,,str); are invitations for DoS. Tavis?  ```  [Comment 5](#c5)  Tavis Ormandy (RETIRED)   gentoo-dev  2005-08-16 10:47:13 UTC  ``` Ah, okay, that does look like an issue. Reassigning back to security. ```  [Comment 6](#c6)  Tavis Ormandy (RETIRED)   gentoo-dev  2005-08-16 10:51:48 UTC  ``` Should be an easy fix,  - NetworkTextMessage(NETWORK_ACTION_LEAVE, 1, false, client_name, str); + NetworkTextMessage(NETWORK_ACTION_LEAVE, 1, false, client_name, "%s", str); ```  [Comment 7](#c7)  Alexey Dobriyan    2005-08-16 14:44:24 UTC  ``` How nice...  start server, client, join. In client type: ` (backtick, quake console appears) name %n  Bye-bye server.  After an obvious fix to network_server.c::DEF_SERVER_RECEIVE_COMMAND(PACKET_CLIENT_SET_NAME), server survives, client dies. Investigating further... ```  [Comment 8](#c8)  Alexey Dobriyan    2005-08-16 14:57:14 UTC  ``` Fix for client not crashing goes to network_client.c, line 347.     ```  [Comment 9](#c9)  Alexey Dobriyan    2005-08-16 15:40:39 UTC  ``` Created [attachment 66105](attachment.cgi?id=66105 "patch to fix possible buffer overflows + format string bugs") [[details](attachment.cgi?id=66105&action=edit "patch to fix possible buffer overflows + format string bugs"), [diff](attachment.cgi?id=66105&action=diff "patch to fix possible buffer overflows + format string bugs")] patch to fix possible buffer overflows + format string bugs  Chunk to console_cmds.c isn't tested. It's late here and I can't find codepath[s] in question. Other NetworkTextMessage()-related changes are tested.   P.S.: silly half-sleeping question: does vsnprintf() exist on OS/2 at all? ```  [Comment 10](#c10)  Thierry Carrez (RETIRED)   gentoo-dev  2005-08-18 10:04:26 UTC  ``` games team please advise. ```  [Comment 11](#c11)  Tavis Ormandy (RETIRED)   gentoo-dev  2005-08-22 00:49:06 UTC  ``` adding ppc, as they're the only affected security supported arch. ```  [Comment 12](#c12)  Michael Hanselmann (hansmi) (RETIRED)   gentoo-dev  2005-08-22 13:28:53 UTC  ``` Stable on ppc. ```  [Comment 13](#c13)  Thierry Carrez (RETIRED)   gentoo-dev  2005-08-23 01:02:09 UTC  ``` hansmi: in fact the version in Portage is not fixed, apparently you were called to give inputs rather than to mark stable. ```  [Comment 14](#c14)  Michael Hanselmann (hansmi) (RETIRED)   gentoo-dev  2005-08-23 11:15:20 UTC  ``` Sorry, I was half-sleeping yesterday. The patch looks good and doesn't contain any platform-specific things. Also, it compiled here. But I'm not games@. ```  [Comment 15](#c15)  Mr. Bones. (RETIRED)   gentoo-dev  2005-08-23 11:24:42 UTC  ``` Security team, please remember to cc the maintainer. ```  [Comment 16](#c16)  Michael Hanselmann (hansmi) (RETIRED)   gentoo-dev  2005-08-23 11:27:11 UTC  ``` dholm is currently moving and might not return in the next days, see /devaway/ ```  [Comment 17](#c17)  Thierry Carrez (RETIRED)   gentoo-dev  2005-08-25 11:41:14 UTC  ``` Can someone in games herd commit the fix while the dedicated maintainer is away ? Alexey: did you send your patch upstream ? ```  [Comment 18](#c18)  Alexey Dobriyan    2005-08-25 12:40:21 UTC  ``` Yes. ```  [Comment 19](#c19)  Mr. Bones. (RETIRED)   gentoo-dev  2005-08-25 13:10:38 UTC  ``` masked until dholm can deal with it. ```  [Comment 20](#c20)  Thierry Carrez (RETIRED)   gentoo-dev  2005-08-29 07:44:07 UTC  ``` Hm. Theorically if it stays that way we need to issue a masking GLSA for this one.  I guess we should rather find someone to commit the patch, since hansmi tested it OK and it's rather straightforward.  vapier: want to have a shot at it ? ```  [Comment 21](#c21)  Thierry Carrez (RETIRED)   gentoo-dev  2005-08-31 08:53:20 UTC  ``` vapier should handle the patching tonight. ```  [Comment 22](#c22)  Alexey Dobriyan    2005-08-31 10:22:41 UTC  ``` Slightly different patch was commited to openttd SVN:  <http://svn.openttd.org/cgi-bin/viewcvs.cgi?rev=2899&view=rev>  M trunk/console_cmds.c M trunk/network.c M trunk/network_client.c M trunk/network_server.c M trunk/texteff.c ```  [Comment 23](#c23)  SpanKY   gentoo-dev  2005-08-31 15:24:53 UTC  ``` i merged your fixes with the upstream changes ... think you could convince them to merge the rest of your vsprintf -> vnsprintf changes please ?  0.4.0.1-r1 now in portage stable for arches ```  [Comment 24](#c24)  Sune Kloppenborg Jeppesen (RETIRED)   gentoo-dev  2005-08-31 22:04:14 UTC  ``` This one is ready for GLSA. Anyone wants to contact upstream?  ```  [Comment 25](#c25)  SpanKY   gentoo-dev  2005-08-31 22:13:32 UTC  ``` upstream has already merged most of the fixes into their svn ... i'm hoping Alexey can convince them to merge the remaining vsprintf->vsnprintf changes ```  [Comment 26](#c26)  Thierry Carrez (RETIRED)   gentoo-dev  2005-09-01 00:46:14 UTC  ``` I asked MITRE for CAN numbers. ```  [Comment 27](#c27)  Alexey Dobriyan    2005-09-01 08:29:53 UTC  ``` So far nobody said "I will" or "I won't" at #openttd. ```  [Comment 28](#c28)  Thierry Carrez (RETIRED)   gentoo-dev  2005-09-01 13:35:52 UTC  ``` Use : CAN-2005-2763 for the format strings CAN-2005-2764 for the buffer overflows ```  [Comment 29](#c29)  Thierry Carrez (RETIRED)   gentoo-dev  2005-09-02 03:06:22 UTC  ``` Alexey, please forward the CAN numbers to your OpenTTD contacts. We shall release a GLSA very soon, crediting you as the discoverer. Feel free to come up with your own announcement if you want. ```  [Comment 30](#c30)  Stefan Cornelius (RETIRED)   gentoo-dev  2005-09-05 09:30:17 UTC  ``` GLSA 200509-03 Thanks to everybody involved. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=102631)
* - [XML](show_bug.cgi?ctype=xml&id=102631)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=102631)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=102631&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=102631&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=102631&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.vupen.com_032a4bac_20250125_130728.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


