=== Content from bugzilla.mozilla.org_3dce3a9d_20250125_205207.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/293159)
* [XML](/show_bug.cgi?ctype=xml&id=293159)

Closed
[Bug 293159](/show_bug.cgi?id=293159)

Opened 20 years ago
Closed 20 years ago

# [SECURITY] Anyone can change flags and access bug summaries due to a bad check in Flag::validate() and Flag::modify()

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[SECURITY] Anyone can change flags and access bug summaries due to a bad check in Flag::validate() and Flag::modify()

## Categories

### (Bugzilla :: Attachments & Requests, defect)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Attachments%20%26%20Requests#Attachments%20%26%20Requests)

Attachments & Requests
▾

Bugzilla :: Attachments & Requests
For problems with attachment creation/management and request creation/management. attachment.cgi, request.cgi
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Attachments%20%26%20Requests&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Attachments%20%26%20Requests&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Attachments%20%26%20Requests)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.17

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 2.18

## People

### (Reporter: LpSolit, Assigned: LpSolit)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

1 person

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[266159](/show_bug.cgi?id=266159 "RESOLVED FIXED - It's possible to create multiple flags by reloading, even if flag is not multiplicable"), [297749](/show_bug.cgi?id=297749 "RESOLVED FIXED - Security Advisory for 2.20rc1 and 2.18.2")

[294021](/show_bug.cgi?id=294021 "RESOLVED FIXED - Allow requestees to set attachment flags even if they don't have editbugs privs")

Dependency [tree](/showdependencytree.cgi?id=293159&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=293159)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [does not affect 2.16.x] [ready for 2.18.2] [ready for 2.20])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[does not affect 2.16.x] [ready for 2.18.2] [ready for 2.20]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [justdave](/user_profile?user_id=10297) | [approval](#a5401728_10297 "20 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [blocking2.20](#a90450_10297 "20 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | blocking2.20 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.18](#a5401728_10297 "20 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.18 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [blocking2.18.2](#a90450_10297 "20 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | blocking2.18.2 | + |
| --- | --- | --- |
|  | approval5.0 | ? |
| --- | --- | --- |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 4 obsolete files)

| [patch, v1](/attachment.cgi?id=184629)  [20 years ago](#c1)  [Frédéric Buclin](/user_profile?user_id=120380)   13.51 KB, patch |  | [Details](/attachment.cgi?id=184629&action=edit) | [Diff](/attachment.cgi?id=184629&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=184629) |
| --- | --- | --- |
| [patch, v2](/attachment.cgi?id=184644)  [20 years ago](#c3)  [Frédéric Buclin](/user_profile?user_id=120380)   14.26 KB, patch | myk : [review+](#c4 "20 years ago") | [Details](/attachment.cgi?id=184644&action=edit) | [Diff](/attachment.cgi?id=184644&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=184644) |
| [patch, v2.1](/attachment.cgi?id=185962)  [20 years ago](#c6)  [Frédéric Buclin](/user_profile?user_id=120380)   14.26 KB, patch | LpSolit : [review+](#c6 "20 years ago") | [Details](/attachment.cgi?id=185962&action=edit) | [Diff](/attachment.cgi?id=185962&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=185962) |
| [patch for 2.18.1, v1](/attachment.cgi?id=185974)  [20 years ago](#c7)  [Frédéric Buclin](/user_profile?user_id=120380)   13.01 KB, patch | myk : [review+](#c8 "20 years ago") | [Details](/attachment.cgi?id=185974&action=edit) | [Diff](/attachment.cgi?id=185974&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=185974) |
| [patch for trunk, v2.1.1](/attachment.cgi?id=188625)  [20 years ago](#c12)  [Frédéric Buclin](/user_profile?user_id=120380)   14.21 KB, patch | LpSolit : [review+](#c12 "20 years ago") | [Details](/attachment.cgi?id=188625&action=edit) | [Diff](/attachment.cgi?id=188625&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=188625) |
| [patch for 2.18.1, v1.0.1](/attachment.cgi?id=188626)  [20 years ago](#c13)  [Frédéric Buclin](/user_profile?user_id=120380)   13.08 KB, patch | LpSolit : [review+](#c13 "20 years ago") | [Details](/attachment.cgi?id=188626&action=edit) | [Diff](/attachment.cgi?id=188626&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=188626) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=293159#c0)• 20 years ago |
|  | |

Flag::validate() and Flag::modify() do not check that the flag ID one tries to
change is consistent with the bug ID and/or attachment ID passed to the
function. This way, we are able to access the summary of (almost) any bug which
has flags set on it.
It's very difficult to reproduce if you have no idea of flag IDs set on a given
bug. The idea is the following:
1) hack the URL in order to have something like:
process\_bug.cgi?id=196&product=Bugzilla&component=...&flag-481=%3F&requestee-481=guest%40foo.com
Here, the flag with ID = 481 is not related to the public [bug 196](/show_bug.cgi?id=196 "VERIFIED WONTFIX - warning fix : ns/lib/layout/editor.c") but is related
to another (confidential) bug. But as the URL contains the bug ID of a public
bug, neither process\_bug.cgi nor Flag::validate() or Flag::modify() will
complain as they all check if the user has access to the given bug or attachment
based on the bug/attachement ID passed in the URL.
2) use the same URL as above, but change flag-481=%3F to flag-481=X.
This way, you cancel the request and the requester (in our case: a bad guy) will
receive an email that this request has been cancelled. But the email contains
the summary of the bug!! <-- Oops!!
Note that you have to use an existing flag which is either set to + or -, else
this trick won't work (if the flag is not specifically requestable!).
Note also that this does not work if you try to create a new flag using
flag\_type in the URL instead of flag, because the new flag would be created in
the public bug (the one given in the URL). About this last comment, see also [bug
266159](/show_bug.cgi?id=266159 "RESOLVED FIXED - It's possible to create multiple flags by reloading, even if flag is not multiplicable").

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=293159#a61_120380)• 20 years ago |

Status: NEW → ASSIGNEDFlags: blocking2.20?Flags: blocking2.18.2?Target Milestone: --- → Bugzilla 2.18

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=293159#a7427_120380)• 20 years ago |

Blocks: [266159](/show_bug.cgi?id=266159 "RESOLVED FIXED - It's possible to create multiple flags by reloading, even if flag is not multiplicable")

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=293159#a90450_10297)• 20 years ago |

Flags: blocking2.20?Flags: blocking2.20+Flags: blocking2.18.2?Flags: blocking2.18.2+Whiteboard: [does not affect 2.16.x] [wanted for 2.18.2] [wanted for 2.20]

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=293159#a590244_120380)• 20 years ago |

Blocks: [294021](/show_bug.cgi?id=294021 "RESOLVED FIXED - Allow requestees to set attachment flags even if they don't have editbugs privs")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=293159#c1)• 20 years ago |
|  | |

Attached patch

[patch, v1](attachment.cgi?id=184629&action=diff) (obsolete)
— [Details](attachment.cgi?id=184629&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=184629)

[Attachment #184629](/attachment.cgi?id=184629&action=edit "patch, v1") -
Flags: review?(myk)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=293159#c2)• 20 years ago |
|  | |

Comment on [attachment 184629](/attachment.cgi?id=184629 "patch, v1") [[details]](/attachment.cgi?id=184629&action=edit "patch, v1") [[diff]](/attachment.cgi?id=184629&action=diff "patch, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=184629)
patch, v1
>+ [% ELSIF error == "invalid\_flag\_association" %]
>+ [% title = "Invalid Flag Association" %]
>+ Some flags do not belong to
>+ [% IF attach\_id %]
>+ attachment [% attach\_id FILTER html %].
>+ [% ELSE %]
>+ [% terms.bug %] [%+ bug\_id FILTER html %].
>+ [% END %]
Note to self: it should be [%+ terms.bug %].

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=293159#c3)• 20 years ago |
|  | |

Attached patch

[patch, v2](attachment.cgi?id=184644&action=diff) (obsolete)
— [Details](attachment.cgi?id=184644&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=184644)

Now catch inactive flag types + fix some minor nits (mainly typos).
[Attachment #184629](/attachment.cgi?id=184629&action=edit "patch, v1") -
Attachment is obsolete: true
[Attachment #184644](/attachment.cgi?id=184644&action=edit "patch, v2") -
Flags: review?(myk)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=293159#a1758894_120380)• 20 years ago |

[Attachment #184629](/attachment.cgi?id=184629&action=edit "patch, v1") -
Flags: review?(myk)

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=293159#c4)• 20 years ago |
|  | |

Comment on [attachment 184644](/attachment.cgi?id=184644 "patch, v2") [[details]](/attachment.cgi?id=184644&action=edit "patch, v2") [[diff]](/attachment.cgi?id=184644&action=diff "patch, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=184644)
patch, v2
Looks good. r=myk
[Attachment #184644](/attachment.cgi?id=184644&action=edit "patch, v2") -
Flags: review?(myk) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=293159#c5)• 20 years ago |
|  | |

Already requesting approval for the trunk. Give me a few hours to backport it to
2.18.1.Flags: approval?

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=293159#c6)• 20 years ago |
|  | |

Attached patch

[patch, v2.1](attachment.cgi?id=185962&action=diff) (obsolete)
— [Details](attachment.cgi?id=185962&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=185962)

FlagType.pm uses requestee\_type, not requestee (stupid copy paste). Carrying
forward myk's r+ (use interdiff between v2 and v2.1 if you don't trust me).
[Attachment #184644](/attachment.cgi?id=184644&action=edit "patch, v2") -
Attachment is obsolete: true
[Attachment #185962](/attachment.cgi?id=185962&action=edit "patch, v2.1") -
Flags: review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=293159#c7)• 20 years ago |
|  | |

Attached patch

[patch for 2.18.1, v1](attachment.cgi?id=185974&action=diff) (obsolete)
— [Details](attachment.cgi?id=185974&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=185974)

backport for the 2.18 branch. The code is a bit easier as 2.18 does not let you
add flags when creating a new attachment.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=293159#a3113402_120380)• 20 years ago |

[Attachment #185974](/attachment.cgi?id=185974&action=edit "patch for 2.18.1, v1") -
Flags: review?(myk)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=293159#a3418226_73187)• 20 years ago |

Blocks: [297749](/show_bug.cgi?id=297749 "RESOLVED FIXED - Security Advisory for 2.20rc1 and 2.18.2")

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=293159#c8)• 20 years ago |
|  | |

Comment on [attachment 185974](/attachment.cgi?id=185974 "patch for 2.18.1, v1") [[details]](/attachment.cgi?id=185974&action=edit "patch for 2.18.1, v1") [[diff]](/attachment.cgi?id=185974&action=diff "patch for 2.18.1, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=185974)
patch for 2.18.1, v1
Looks good, r=myk
[Attachment #185974](/attachment.cgi?id=185974&action=edit "patch for 2.18.1, v1") -
Flags: review?(myk) → review+

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=293159#c9)• 20 years ago |
|  | |

I missed this in my initial review, and it's nit, but if it's not too much
trouble could you change "Edition of Flags" to "Flag Editing" upon check-in and
then attach the patches with that update? The current syntax is technically
valid but uncommon and considered clunky, and making this change in new patches
on this bug would save having to deal with that minor issue in a separate bug.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=293159#c10)• 20 years ago |
|  | |

ok, I will fix this nit on checkin. Patches ready for approval! :)
Flags: approval2.18?Whiteboard: [does not affect 2.16.x] [wanted for 2.18.2] [wanted for 2.20] → [does not affect 2.16.x] [ready for 2.18.2] [ready for 2.20]

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=293159#a5041485_73187)• 20 years ago |

Severity: normal → criticalVersion: 2.19.2 → 2.17

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=293159#c11)• 20 years ago |
|  | |

For further information about this bug, see my comment in [bug 297749 comment 4](/show_bug.cgi?id=297749#c4 "RESOLVED FIXED - Security Advisory for 2.20rc1 and 2.18.2").

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=293159#c12)• 20 years ago |
|  | |

Attached patch

[patch for trunk, v2.1.1](attachment.cgi?id=188625&action=diff)
— [Details](attachment.cgi?id=188625&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=188625)

myk's nit fixed + unbitrot
[Attachment #185962](/attachment.cgi?id=185962&action=edit "patch, v2.1") -
Attachment is obsolete: true
[Attachment #188625](/attachment.cgi?id=188625&action=edit "patch for trunk, v2.1.1") -
Flags: review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=293159#c13)• 20 years ago |
|  | |

Attached patch

[patch for 2.18.1, v1.0.1](attachment.cgi?id=188626&action=diff)
— [Details](attachment.cgi?id=188626&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=293159&attachment=188626)

myk's nit fixed.
[Attachment #185974](/attachment.cgi?id=185974&action=edit "patch for 2.18.1, v1") -
Attachment is obsolete: true
[Attachment #188626](/attachment.cgi?id=188626&action=edit "patch for 2.18.1, v1.0.1") -
Flags: review+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=293159#a5401728_10297)• 20 years ago |

Flags: approval?Flags: approval2.18?Flags: approval2.18+Flags: approval+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=293159#c14)• 20 years ago |
|  | |

Tip:
Checking in attachment.cgi;
/cvsroot/mozilla/webtools/bugzilla/attachment.cgi,v <-- attachment.cgi
new revision: 1.89; previous revision: 1.88
done
Checking in process\_bug.cgi;
/cvsroot/mozilla/webtools/bugzilla/process\_bug.cgi,v <-- process\_bug.cgi
new revision: 1.263; previous revision: 1.262
done
Checking in Bugzilla/Flag.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Flag.pm,v <-- Flag.pm
new revision: 1.45; previous revision: 1.44
done
Checking in Bugzilla/FlagType.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/FlagType.pm,v <-- FlagType.pm
new revision: 1.19; previous revision: 1.18
done
Checking in template/en/default/global/code-error.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/code-error.html.tmpl,v
<-- code-error.html.tmpl
new revision: 1.52; previous revision: 1.51
done
2.18:
Checking in attachment.cgi;
/cvsroot/mozilla/webtools/bugzilla/attachment.cgi,v <-- attachment.cgi
new revision: 1.58.2.6; previous revision: 1.58.2.5
done
Checking in process\_bug.cgi;
/cvsroot/mozilla/webtools/bugzilla/process\_bug.cgi,v <-- process\_bug.cgi
new revision: 1.205.2.22; previous revision: 1.205.2.21
done
Checking in Bugzilla/Flag.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Flag.pm,v <-- Flag.pm
new revision: 1.18.2.7; previous revision: 1.18.2.6
done
Checking in Bugzilla/FlagType.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/FlagType.pm,v <-- FlagType.pm
new revision: 1.7.2.2; previous revision: 1.7.2.1
done
Checking in template/en/default/global/code-error.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/code-error.html.tmpl,v
<-- code-error.html.tmpl
new revision: 1.39.2.6; previous revision: 1.39.2.5
doneStatus: ASSIGNED → RESOLVEDClosed: 20 years agoResolution: --- → FIXEDSummary: Anyone can access bug summaries due to a bad check in Flag::validate() and Flag::modify() → [SECURITY] Anyone can change flags and access bug summaries due to a bad check in Flag::validate() and Flag::modify()

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=293159#c15)• 20 years ago |
|  | |

Removing from webtools-security because the advisory has been posted and the
release is complete.Group: webtools-security
You need to [log in](/show_bug.cgi?id=293159&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Frédéric Buclin](/user_profile?user_id=120380)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.bugzilla.org_30c8e740_20250125_205205.html ===

[![Bugzilla Logo](/assets/img/logo-header.svg)
Bugzilla](/)
Show Nav Menu

* [About](/about/ "Find out more about Bugzilla.")
  [Project](/about/ "Find out more about Bugzilla.")
  [Features](/about/features.html)
  [Who Uses Bugzilla?](/about/installation-list.html "Hundreds of companies and organizations trust Bugzilla.")
  [Meet the Team](/about/developers "Meet the Bugzilla team.")
  [Zarro Boogs Corporation](/about/zarroboogs.html "Find out about the company managing the Bugzilla Project.")
* [News](/blog/ "Get the low down on what's happening with the project.")
  [Blog](/blog/ "Bugzilla Blog")
  [Release Information](/releases/ "Information on current and previous releases.")
  [Security Advisories](/security/ "Important updates regarding Bugzilla security.")
  [Planet Bugzilla](http://planet.bugzilla.org "View the status of the Bugzilla project.")
* [Download](/download/ "Download Bugzilla")
* [Documentation](/docs/ "Bugzilla Documentation")
* [Support](/support/ "Find out where to get more information and help.")
* [Contribute](/contributing/ "Ways you can help Bugzilla")
  [How to?](/contributing/ "Ways you can help Bugzilla")
  [Report a Bug](/contributing/reporting_bugs "Let us know if there is an error in Bugzilla.")
  [Donate](/donate "Donate to Bugzilla, and see how your money is used.")
  [Wiki](https://wiki.mozilla.org/Bugzilla%3AHome "Collaboratively updated information about Bugzilla.")

Search bugzilla.org

1. [Security Advisories](/security/)
2. 2.18.1 and 2.19.3 Security Advisory

# 2.18.1 and 2.19.3 Security Advisory

Thursday, Jul 7th, 2005
```

Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* Any user can change a flag on any bug. This also allows the
  attacker to expose the summary of any bug, even a hidden bug.

* Summaries of private bugs are sometimes exposed under a very rare
  condition if you use MySQL replication.

All affected installations are encouraged to upgrade as soon as
possible.

Vulnerability Details
=====================

Class:       Unauthorized Bug Change, Information Leak
Affected:    2.17.1 - 2.18.1, 2.19.1 - 2.19.3
Description: Any user can change any flag on any bug, even if they don't
             have access to that bug, or even if they can't normally
             make bug changes. This also allows them to expose the
             summary of a bug.
             By manually modifying a link to process_bug.cgi, it is possible
             to change a flag on a bug that you do not have access to,
             because Bugzilla does not validate that the flag you are
             attempting to change is associated with the bug that you
             are attempting to change.
             If the attacker makes a flag change which causes the attacker
             to be emailed, the attacker will see the summary of the bug
             in that email.
             If you are using the request_group or grant_group features
             of 2.19, the attacker will be prevented from exploiting
             this security hole if they do not have permission to
             change the flag in the fashion that they are changing it.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=293159

Class:       Information Leak
Affected:    2.17.1 and above
Description: Bugs are inserted into the database before they are marked
             as private, in Bugzilla code. Thus, MySQL replication can
             lag in between the time that the bug is inserted and when
             it is marked as private (usually less than a second). If
             replication lags at this point, the bug summary will be
             accessible to all users until replication catches up.
             Also, on a very slow machine, there may be a pause
             longer than a second that allows users to see the title of
             the newly-filed bug.

Vulnerability Solutions
=======================

The fix for these issues is included in the
releases. Upgrading to a release with the relevant fix will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the security
vulnerability, there are patches available for the issues at the
"References" URL.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and git upgrade instructions are available at:

  https://www.bugzilla.org/download/

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix this
issue:

Issue 1 Reporter: Frédéric Buclin
Issue 1 Fixed by: Frédéric Buclin, Myk Melez

Issue 2 Reporter: Matthias Versen
Issue 2 Fixed by: Frédéric Buclin, Joel Peshkin

General information about the Bugzilla bug-tracking system can be found
at:

  https://www.bugzilla.org/

Comments and follow-ups can be directed to the support-bugzilla mailing list.
https://www.bugzilla.org/support/ has directions for accessing this forum.

```

* [GitHub
  GitHub](https://github.com/bugzilla "GitHub")
* [X](https://x.com/%40bugzilla "X")
* [Mastodon
  Mastodon](https://techhub.social/%40bugzilla "Mastodon")
* [Bluesky](https://bsky.app/profile/bugzilla.org "Bluesky")
* [Facebook
  Facebook](https://www.facebook.com/BugzillaProject "Facebook")
* [LinkedIn
  LinkedIn](https://www.linkedin.com/company/bugzilla-project "LinkedIn")
* [IRC
  IRC on Libera.Chat](https://web.libera.chat/#/#bugzilla "IRC on Libera.Chat")
* [Discord
  Discord](https://discord.gg/ZhN6uBA "Discord")
* [Matrix
  Matrix](https://matrix.to/#/#bugzilla:mozilla.org "Matrix")
* [YouTube
  YouTube](https://www.youtube.com/%40bugzillaproject "YouTube")
* [Twitch
  Twitch](https://twitch.tv/bugzillaproject "Twitch")

---

Copyright © 1998-2024 bugzilla.org contributors
Creative Commons Attribution-ShareAlike 2.0[Creative CommonsAttributionShareAlike](https://creativecommons.org/licenses/by-sa/2.0/)


