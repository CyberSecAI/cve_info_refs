=== Content from marc.info_db9f8de7_20250125_160258.html ===

```
[[prev in list](?l=bugtraq&m=112188282401681&w=2)] [[next in list](?l=bugtraq&m=112189099909147&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=112196774216825&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [PHPNews SQL injection vulnerability](?t=112189470300002&r=1&w=2)
From:       [ghc () ghc ! ru](?a=112024869000001&r=1&w=2)
Date:       [2005-07-20 6:34:29](?l=bugtraq&r=1&w=2&b=200507)
Message-ID: [20050720063429.16299.qmail () securityfocus ! com](?i=20050720063429.16299.qmail%20()%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=112189453304389&q=mbox) or [body](?l=bugtraq&m=112189453304389&q=raw)]

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Product: PHPNews
Version: 1.2.5 Release, bugfix 1.2.6 (and previous)
URL: <http://newsphp.sourceforge.net/>
VULNERABILITY CLASS: SQL injection
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[PRODUCT DESCRIPTION]
PHPNews is a popular script for news posting written in PHP (MySQL based).

[VULNERABILITY]

Vulnerable script: auth.php

[code]
   else if(isset($_POST['user']) && isset($_POST['password']))
  {
    $in_user = $_POST['user'];         // <-- not filtered
    $in_password = $_POST['password'];
  }

  $result = mysql_query('SELECT * FROM ' . $db_prefix . 'posters WHERE username = \'' \
. $in_user . '\' AND password = password(\'' . $in_password . '\')');  $dbQueries++;

  if(mysql_numrows($result) != 0)
  {
    $auth = true;
    $_SESSION['user'] = $in_user;
    $_SESSION['password'] = $in_password;
  }
[/code]

In case magic_quotes_gpc=0, an attacker can inject SQL statements through \
$_POST['user'] parameter.

Example of exploitation:
In the login form type "whatever' or '1'='1'/*" in the "Username" field and
"whatever" in the "Password" field (without double quotes).
Or just use "admin'/*" as username (where "admin" - is real login name of \
administrator).

Possible scenario of attack. Attacker can:
[[1]](#-1) log in admin panel, using SQL injection
[[2]](#-2) upload PHP file through "Upload Images" function (index.php?action=images) and \
have fun with php shell or edit template (index.php?action=modtemp) and put backdoor \
code into it.

[Bugfix]:

 [code]
   $in_user = $_POST['user'];
 [/code]

replace with:

 [code]
   if (!get_magic_quotes_gpc())  {$in_user=addslashes($_POST['user']);}
   else {$in_user = $_POST['user']; }
 [/code]

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[CREDITS]
RST/GHC
<http://www.ghc.ru>
<http://rst.void.ru>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[[prev in list](?l=bugtraq&m=112188282401681&w=2)] [[next in list](?l=bugtraq&m=112189099909147&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=112196774216825&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


