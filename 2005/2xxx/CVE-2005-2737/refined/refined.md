Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**

- The root cause is the failure to properly sanitize EXIF metadata extracted from JPEG files before displaying it in web-based image galleries. Specifically, the vulnerability arises when user-controlled data within the EXIF headers (such as Camera Model tag) is directly rendered into the HTML output without proper encoding.

**Weaknesses/vulnerabilities present:**

- **Cross-Site Scripting (XSS):** The primary vulnerability is XSS. By embedding malicious JavaScript code within the EXIF metadata, an attacker can inject arbitrary scripts into the context of a user's browser when viewing the image.

**Impact of exploitation:**

- **Arbitrary JavaScript execution:** An attacker can execute arbitrary JavaScript code within the user's browser when they view an image with malicious EXIF data, allowing for a wide range of malicious actions.
- **Session hijacking:** Attackers can potentially steal cookies to hijack a user's session.
- **Website defacement:** Attackers can modify the content of the displayed page.
- **Redirects:** Attackers can redirect users to malicious websites.
- **Other malicious activities:** The attacker can potentially perform other actions that are possible through JavaScript code execution.

**Attack vectors:**

- **Malicious EXIF metadata in JPEG files:** The attacker crafts a JPEG file with malicious JavaScript code embedded in EXIF tags (e.g., Camera Model).
- **Image upload:** The attacker uploads the malicious JPEG to a vulnerable image gallery.
- **Image display:** When a user views the uploaded image, the vulnerable gallery displays the unsanitized EXIF data, which executes the attacker's script.

**Required attacker capabilities/position:**

- **Ability to create/modify JPEG files:** The attacker needs to be able to edit EXIF metadata in JPEG files.
- **Access to a vulnerable image gallery:** The attacker needs to be able to upload the crafted JPEG to a vulnerable image gallery application.
- **User interaction:** The victim needs to view the image in the vulnerable gallery for the attack to be effective.

**Vulnerable Systems:**
* Coppermine (up to 1.3.3)
* Gallery 1.5.1-RC2 and prior
* phpGraphy (up to version 0.9.9a)
* YaPig 0.95 and prior
* PhotoPost PHP Pro (current version)

**Additional notes:**
- The vulnerability is triggered when the EXIF information is displayed by the vulnerable image gallery.
- The provided content mentions that several commercial galleries were also found to be vulnerable.
- The advisory also noted that popular online image hosting services like MSN, Yahoo, Shutterfly, Pixagogo, and PictureTrail do not display EXIF metadata and are therefore not affected by this vulnerability.
- The advisory details specific remediation steps for some of the affected products.