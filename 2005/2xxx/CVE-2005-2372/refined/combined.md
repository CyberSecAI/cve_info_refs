=== Content from marc.info_06fa9eb8_20250125_134652.html ===

```
[[prev in list](?l=bugtraq&m=112181380908044&w=2)] [[next in list](?l=bugtraq&m=112181242916757&w=2)] [[prev in thread](?l=bugtraq&m=112181380908044&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Oracle Security Advisory: Run any OS Command via unauthorized](?t=112180808700003&r=1&w=2)
From:       [ak () red-database-security ! com](?a=112129105900001&r=1&w=2)
Date:       [2005-07-19 12:25:39](?l=bugtraq&r=1&w=2&b=200507)
Message-ID: [20050719122539.4494.qmail () securityfocus ! com](?i=20050719122539.4494.qmail%20()%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=112180805413784&q=mbox) or [body](?l=bugtraq&m=112180805413784&q=raw)]

Dear Bugtraq Reader

3 months ago (15-april-2005) I informed the Oracle Security Team \
(secalert_us@oracle.com) that I will publish bug details if the bugs are not fixed \
with the next critical patch update (CPU July 2005). I know that Oracle products are \
complex and a good patch quality need some time. That's why I offered Oracle \
additional time if 3 months are not sufficient for fixing the bugs. Oracle never \
asked for more time.

Oracle's behaviour not fixing critical security bugs for a long time (over 650 days) \
is not acceptable for their customers. Oracle put their customers in danger. At least \
one critical vulnerability can be abused from any attacker via internet.

I decided to publish these vulnerabilities because it is possible to mitigate the \
risk of these vulnerabilities by using the workarounds provided in the advisories.

Kind Regards

 Alexander Kornbrust

 [www.red-database-security.com](http://www.red-database-security.com)

#################################################

Red-Database-Security GmbH  - Oracle Security Advisory

Run any OS Command via unauthorized Oracle Forms

 Name                Run any OS Command via unauthorized Oracle Forms
 Systems Affected    Oracle (Web) Forms 4.5, 5.0, 6.0, 6i, 9i, 10g
 Severity            High Risk
 Category            OS command execution
 Vendor URL          <http://www.oracle.com>
 Author              Alexander Kornbrust (ak at red-database-security.com)
 Date                19 July 2005 (V 1.00)
 Advisory            AKSEC2003-013
 Inital bug report   664 days ago
 Advisory-URL
<http://www.red-database-security.com/advisory/oracle_forms_run_any_os_command.ht>
ml

Details
#######
Oracle Forms Services, a component of the Oracle Application Server, is Oracle's
long-established technology to design and build enterprise applications. Oracle
itself is using Oracle Forms for the E-Business Suite. Many large customers are
using Oracle Forms for their enterprise applications.

Oracle Forms Services starts forms executables (*.fmx) from any directory and
any user on the application server. These forms are executed as user Oracle or
System (Windows). An attacker which is able to upload a specially crafted forms
executable to the application server is able to run any OS command and can
overtake the application server. The upload could be done via Webdav (Part of
the Oracle Application Server), SMB, Webutil, SAMBA, NFS, FTP, ...

By using the form or module parameter with an absolute path it is possible to
execute forms executables from ANY directory and ANY user.

Testcase
########
1. Create or modify a simple forms module and add the following command to the
"WHEN_NEW_FORM_INSTANCE"-Trigger Host('ls > forms_is_unsecure.txt' , NO_SCREEN);

2. Generate the forms executable (e.g. hacker.fmx) for the destination platform
(e.g. Linux, Solaris, Windows, ...)

3. Copy the forms executable hacker.fmx to a directory on the Oracle Application
Server (e.g. via SMB, file upload, Webdav, Samba, NFS, Webutil, FTP, ...)

4. Run the form "hacker.fmx" as user Oracle and specify an absolute path for the
forms executable
<http://myserver.com:7779/forms90/f90servlet?form=/public/johndoe/hacker.fmx>
or
<http://myserver.com:7779/forms90/f90servlet?module=/tmp/hacker.fmx>

5. The host command is executed as user Oracle (Unix) or user SYTEM (Windows).

Workarounds
###########
Available at <http://www.red-database-security.com/advisory/oracle_forms_run_any_os_command.html>

Patch Information
#################
This bug is NOT FIXED with Critical Patch Update July 2005 (CPU July 2005). It
seems that Oracle is NOT INTERESTED to fix this issue and provide patches for
this issue.
They recommend to migrate to Oracle Forms 10g because 9i and 10g are binary
compatible.

History
#######
24-sep-2003 Oracle secalert was informed

25-sep-2003 Bug confirmed

15-apr-2005 Red-Database-Security informed Oracle secalert that this
vulnerability will publish after CPU July 2005 Red-Database-Security offered
Oracle more time if it is not possible to provide a fix ==> NO FEEDBACK.

18-apr-2005 Oracle Forms Product Management contacted.

20-apr-2005 Email from Product Management that customers should migrate to Forms
10g. No patches for Forms 6i or 9i.

12-jul-2005 Oracle published CPU July 2005 without fixing this issue

19-jul-2005 Red-Database-Security published this advisory

© 2005 by Red-Database-Security GmbH - last update 19-july-2005

[[prev in list](?l=bugtraq&m=112181380908044&w=2)] [[next in list](?l=bugtraq&m=112181242916757&w=2)] [[prev in thread](?l=bugtraq&m=112181380908044&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.red-database-security.com_6067a85e_20250125_134653.html ===


[![](http://www.red-database-security.com/pictures/red_database_security_logo.jpg)](http://www.red-database-security.com)[![](http://red-database-security.com/pictures/teaser.jpg)](http://www.red-database-security.com/security_training/oracle_anti_hacker_training.html)

| [Red-Database-Security GmbH is specialized in Oracle Security](http://www.red-database-security.com)Products [Repscan 2.5](http://www.red-database-security.com/software/repscan.html) [Hedgehog Enterprise](http://www.red-database-security.com/software/hedgehog.html) [Checkpwd (free)](http://www.red-database-security.com/software/checkpwd.html)  Services [Oracle Audit / Hardening](http://www.red-database-security.com/services/audit.html) [Security Training](http://www.red-database-security.com/security_training/oracle_security_training.html) [Consulting](http://www.red-database-security.com/services/consulting.html)  Information [Oracle Security Blog](http://blog.red-database-security.com)  [Published Alerts](http://www.red-database-security.com/advisory/published_alerts.html)[RSS Published Alerts](http://www.red-database-security.com/advisory/published_alerts.xml) [Upcoming Alerts](http://www.red-database-security.com/advisory/upcoming_alerts.html)[RSS Published Alerts](http://www.red-database-security.com/advisory/published_alerts.xml) [Patch Information](http://www.red-database-security.com/whitepaper/oracle_patches.html) [Whitepaper](http://www.red-database-security.com/whitepaper/oracle_security_whitepaper.html) [Presentations](http://www.red-database-security.com/whitepaper/presentations.html) [Oracle Fact Sheets](http://www.red-database-security.com/whitepaper/fact_sheets.html) [Exploits](http://www.red-database-security.com/exploits/oracle_exploits.html) [Tutorials](http://www.red-database-security.com/tutorial/tutorials.html) [Videos](http://www.red-database-security.com/videos/oracle_videos.html)  [Scripts](http://www.red-database-security.com/scripts/oracle_security_scripts.html)  News & Events [Events](http://www.red-database-security.com/events/events.html) [News](http://www.red-database-security.com/news/rds_news.html)  Company [Contact](http://www.red-database-security.com/contact/contact.html) [People](http://www.red-database-security.com/people/people.html) [Partner](http://www.red-database-security.com/partner/partner.html) [Impressum](http://www.red-database-security.com/impressum/impressum.html) [Sitemap](http://www.red-database-security.com/sitemap/sitemap.html)    [Search](http://www.red-database-security.com/search/search.html)   | Search Red-Database-Security | | --- | | Run any OS Command via unauthorized Oracle Forms  | **Name** | Run any OS Command via unauthorized Oracle Forms | | --- | --- | | **Severity** | High Risk | | **Category** | OS command execution | | **Vendor URL** | <http://www.oracle.com/> | | **Author** | Alexander Kornbrust (ak at red-database-security.com) | | **Date** | 25 August 2005 (V 1.02) | | **Cert VU#** | 894813 | | **CVE** | CAN-2005-2372 | | **Inital bug report** | 842 days ago |   Details Oracle Forms Services, a component of the Oracle Application Server, is Oracle's long-established technology to design and build enterprise applications. Oracle itself is using Oracle Forms for the E-Business Suite. Many large customers are using Oracle Forms for their enterprise applications.  Oracle Forms Services starts forms executables (\*.fmx) from any directory and any user on the application server. These forms are executed as user Oracle or System (Windows). An attacker which is able to upload a specially crafted forms executable to the application server is able to run any OS command and can overtake the application server. The upload could be done via Webdav (Part of the Oracle Application Server), SMB, Webutil, SAMBA, NFS, FTP, ...  By using the form or module parameter with an absolute path it is possible to execute forms executables from ANY directory and ANY user.   Affected Products Internet Application Server Oracle Application Server Oracle Developer Suite  Patch Information This bug is NOT FIXED with Critical Patch Update October 2005 (CPU October 2005). It seems that Oracle is NOT INTERESTED to fix this issue and provide patches for this issue. If you think you need a patch to protect your Oracle Application Server you should contact Oracle.  Testcase  1. Create or modify a simple forms module and add the following command to the "WHEN\_NEW\_FORM\_INSTANCE"-Trigger Host('ls > forms\_is\_unsecure.txt' , NO\_SCREEN);  2. Generate the forms executable (e.g. hacker.fmx) for the destination platform (e.g. Linux, Solaris, Windows, ...)  3. Copy the forms executable hacker.fmx to a directory on the Oracle Application Server (e.g. via SMB, file upload, Webdav, Samba, NFS, Webutil, FTP, ...)  4. Run the form "hacker.fmx" as user Oracle and specify an absolute path for the forms executable http://myserver.com:7779/forms90/f90servlet?form=/public/johndoe/hacker.fmx or http://myserver.com:7779/forms90/f90servlet?module=/tmp/hacker.fmx  5. The host command is executed as user Oracle (Unix) or user SYTEM (Windows).    Workaround for Oracle Forms 10g Use the parameter restrictedURL in the configuration file formsweb.cfg. The parameter restrictedURL is a new feature in Forms 10g and restricts the end user (or hacker) from overriding all the parameters listed in the restrictedURLparams.  Keep in mind that it is important to block the form and the module parameter.  [myFormsApp1] form=.... restrictedURLparams=form,module   Workaround for Oracle Forms 6i/9i or 10g Do not allow users to upload content to the Application Server (e.g. via SMB, Webdav, SAMBA, FTP, ...)  or  Use URLRewrite to block potential dangerous URLs with module or form parameter and absolute or relative paths Block the following strings: "form=..", "module=..", "form=/", "module=/" , "form=c:\", "module=c:\", "form=d:\" ...  If you need different locations for your forms modules you could specify these locations in the FORMS90\_PATH / FORMS60\_PATH.   History 24-sep-2003 Oracle secalert was informed 25-sep-2003 Bug confirmed 15-apr-2005 Red-Database-Security informed Oracle secalert that this vulnerability will publish after CPU July 2005 Red-Database-Security offered Oracle more time if it is not possible to provide a fix ==> NO FEEDBACK. 18-apr-2005 Oracle Forms Product Management contacted. 20-apr-2005 Email from Product Management that customers should migrate to Forms 10g. No patches for Forms 6i or 9i. 12-jul-2005 Oracle published CPU July 2005 without fixing this issue 19-jul-2005 Red-Database-Security published this advisory 21-jul-2005 Cert VU# and affected products added 25-aug-2005 CVE number added  13-jan-2005 days since initial report updated    © 2006 by Red-Database-Security GmbH - last update 13-jan-2006 | Oracle Forms Oracle Forms, a component of the Oracle Developer Suite, is Oracle's long-established technology to design and build enterprise applications quickly and efficiently. Oracle remains committed to the development of this technology, and to the ongoing release as a component of the Oracle platform. This continuing commitment to Forms technology enables you to leverage your existing investment by easily upgrading and integrating existing Oracle Forms applications to take advantage of web technologies and service oriented architectures (SOA). |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |


