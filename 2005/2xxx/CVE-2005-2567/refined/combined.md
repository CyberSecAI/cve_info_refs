=== Content from marc.info_739d7aa2_20250125_195922.html ===

```
[[prev in list](?l=bugtraq&m=112351958432269&w=2)] [[next in list](?l=bugtraq&m=112352918204414&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Advisory 13/2005: Remote code execution in SysCP
From:       [Christopher Kunz <christopher.kunz () hardened-php ! net>](?a=112006309000004&r=1&w=2)
Date:       [2005-08-08 15:31:39](?l=bugtraq&r=1&w=2&b=200508)
Message-ID: [42F77ADB.10706 () hardened-php ! net](?i=42F77ADB.10706%20()%20hardened-php%20!%20net)
[Download RAW [message](?l=bugtraq&m=112352095923614&q=mbox) or [body](?l=bugtraq&m=112352095923614&q=raw)]

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

                        Hardened PHP Project
                        [www.hardened-php.net](http://www.hardened-php.net)

                      -= Security  Advisory =-

     Advisory: Remote code execution in SysCP
 Release Date: 2005/08/09
Last Modified: 2005/08/08
       Author: Christopher Kunz <christopher.kunz@hardened-php.net>
  Application: SysCP 1.2.10 and prior
     Severity: Arbitrary remote code execution
         Risk: Critical
Vendor Status: Vendor has released an updated version
   References: <http://www.hardened-php.net/advisory_132005.64.html>

Overview:

   SysCP is a server management application, similar to the popular Confixx and
   CPanel products - but open source. It is deployed by several large german
   hosting and co-location companies and can be used for complete server admin-
   istration, including web and database, FTP and mail servers, reseller access
   and more.
   With the PHP configuration flag "register_globals On" (which is still the
   case for a large installation base), a number of variables can be injected,
   leading to the execution of arbitrary remote code, which can also be inclu-
   ded from a remote server. This can lead to backdooring of the server in
   question.
   SysCP needs the MySQL root password to perform some of its functionality, so
   attackers can very easily obtain this critical information from SysCP's con-
   figuration file.

Details:

   During a rough scan through the SysCP source code, we found two possibili-
   ties to inject global variables via GET - experience shows that probably
   more occurances exist.
   The first of these holes allows direct inclusion of remote PHP code with
   just one GET parameter. By setting the language to any value not existant
   in the SysCP installation, inclusion of a language file can be forced -
   there are no checks if the included file was actually user-supplied.
   The second vulnerability allows passing curly brackets to SysCP's internal
   template engine which then eval()s this expression. A string like
   {${phpinfo();}} would then be evaluated to the phpinfo() function, which
   would subsequently be executed.

Proof of Concept:

   Due to the sensitive nature of the vulnerability, the Hardened PHP Project
   is not going to release a proof of concept to the public.

Disclosure Timeline:

   18. July 2005 - Initial vendor contact.
   23. July 2005 - PoC disclosed to vendor.
   04. August 2005 - Vendor has released updated version.
   09. August 2005 - public disclosure

Recommendation:

   All of these vulnerabilities could have been mitigated by using our
   Hardening Patch for PHP [[1]](#1), which includes protection against URL includes
   as well as eval() function protection.
   Apart from that, the vendor has released an updated version that add-
   resses the issue [[2]](#2).

Plug:

   You can discuss this and other vulnerabilities in our forum at
   <http://forum.hardened-php.net/> - an up-to-date list of advisories can be
   found at <http://www.hardened-php.net/>.

Links:

   [[1]](#1) <http://www.hardened-php.net/downloads.13.html>
   [[2]](#2) <http://www.syscp.de/forum/viewtopic.php?t=1772>

GPG-Key:

   <http://www.hardened-php.net/hardened-php-signature-key.asc>

   pub  1024D/0A864AA1 2004-04-17 Hardened-PHP Signature Key
   Key fingerprint = 066F A6D0 E57E 9936 9082  7E52 4439 14CC 0A86 4AA1

Copyright 2005 Christopher Kunz / Hardened PHP Project. All rights reserved.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.6 (GNU/Linux)
Comment: For info see <http://www.gnupg.org>

iD8DBQFC9zaIRDkUzAqGSqERArfZAKDXgmFdPQSONdLNXFNhMqApTYqUIwCgxzjb
T/i48IH5hId5eOLuXvWaVY0=
=KSeh
-----END PGP SIGNATURE-----
[[prev in list](?l=bugtraq&m=112351958432269&w=2)] [[next in list](?l=bugtraq&m=112352918204414&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.syscp.de_34368343_20250125_195924.html ===




=== Content from www.hardened-php.net_87cad26d_20250125_195923.html ===

# [Hardened-PHP](http://www.hardened-php.net/)

## PHP Security

Menu
[Skip to content](#content)

* [Home](http://www.hardened-php.net/)

# Hardened PHP

PHP is far and away the most popular backend programming
language today, with more than 80 websites worldwide taking advantage of PHP
solutions.

All of the most popular CMS platforms – including WordPress,
Joomla!, and Drupal (just to name a few) leverage this technology. It’s
flexibility and versatility make it a powerhouse programming language, but that
doesn’t necessarily mean that it is as secure as it could or should be “right
out of the box”, so to speak.

It’s popularity, it’s widespread adaptation, and its
relatively easy to learn structure has made PHP a major target for cyber
criminals and hackers to exploit. This is why it’s mission-critical that you
harden your PHP files server-side as much as possible, protecting your server,
your content, and your visitors from these kinds of dangerous exploits.

PHP can be hardened manually as well as with patching
protocols. Below we highlight the steps you’ll want to take to make sure that
your PHP installation is as locked down as possible.

**Locate the PHP Config File You’re Hardening on Your Server**

The very first step in hardening your PHP installation is
first finding the PHP configuration file on your server to begin with.

Depending on the hosting that you are taking advantage of
(the actual provider as well as the type of hosting you have selected) it can
be in a variety of different locations. The best way to quickly locate this
critical file is to simply do a server-side search for “PHP.ini” as this is the
actual file that you’ll want to modify, edit, and harden moving forward.

**Editing the File on Shared Hosting**

Individuals looking to harden their PHP on a shared hosting platform (see [The Blog Starter](https://www.theblogstarter.com/) for hosting options) will have a bit of a tougher hill to climb, if only because most providers do not offer root access to the server with this level of hosting.

You’ll have to contact your hosting provider directly to see
if you can edit the main PHP.ini file itself. In the event that you aren’t
allowed this kind of access, you can still request to have access to the
“.HTaccess” file on your server to make the changes you need to.

You won’t be able to make changes quite as quickly this way
as you would have been able to with a patch (like we highlight below), but you
can manually make individual line edits to your PHP settings this way to enjoy
a higher level of security.

Shared hosting may still have limitations on the PHP elements you can edit no matter how much access you are granted. If you want total control over hardening your PHP (and total control over the security of your web platform), it’s not a bad idea to move to Dedicated or VPS servers if you can afford it.

**Editing the File on Dedicated/VPS servers**

If you are moving forward with a Virtual Private Server
(VPS) or Dedicated server set up the process for hardening your PHP is a lot
easier, though it’s still not as quick as applying a server wide patch like we
highlight below.

In the backend administration toolset of your server
solution you’ll find a tool called the Web Host Manager. This is usually
located under the “Service Configuration” settings option in your backend
dashboard.

This tool is going to allow you to select the PHP
Configuration Editor, and editor that allows you to make changes to your
PHP.ini file through a more user-friendly interface than actually downloading
the file, opening it up in Notepad or a similar application, and then making
the edits individually with the actual source code itself.

There are a handful of individual settings that you’re going
to want to reconfigure manually when taking this approach to hardening your PHP
installation, including (but not limited to):

•           Remote
Connections

•           Run Time
Settings

•           Input Data
Restrictions

•           Error
Handling

•           Restrict
File Access

•           File
Uploads

•           Session
Security

•           Soap Cache

… And that’s just the tip of the iceberg.

**Use a Patch like Suhosin to Harden PHP Almost Instantly**

The big attraction behind PHP is that it is so easy to learn,
so easy to develop with, and about as flexible as a programming language gets –
and that’s why a lot of people feel comfortable hardening their PHP manually,
running line by line through their PHP.ini file and doing the heavy lifting of
securing their system on their own.

And while you may be a top-tier programmer and feel
completely confident in your coding prowess, the truth of the matter is that if
you allow ANY coding from ANY outside developers to run on your server you’ll
still have vulnerabilities that you may not be able to address independently –
vulnerabilities that can compromise your entire platform.

This is why patching your PHP systemwide is such a savvy
move, and why so many developers, programmers, and website/web application
owners utilizing PHP decide to move forward with a solution like Suhosin.

Engineered specifically to provide an advanced layer of
protection to PHP installations, the Suhosin patch is a dual action component
that provides a level of hardening that may not be possible through any other
manual approach.

On the one hand, Suhosin works to patch the PHP core on your
server. This allows this patch to protect against issues like format string
vulnerabilities, buffer overflows, and other issues that may plague your as of
yet unsecured PHP installation.

On the other hand, Suhosin also acts as an extension to the
PHP that has already been installed on your server. This extension runs 24/7,
around-the-clock, to protect against all kinds of vulnerabilities (including
runtime vulnerabilities) as well as individual session issues while adding a
whole host of logging, filtering, and administrative tools at the same time.

Best of all, the installation of this PHP hardening patch is
about as simple and as straightforward as it gets.

All of the features it has to offer exist within its
extension module and “flipping the switch” to allow that extension to run is as
easy as activating the individual extension inside of the PHP.ini file.
Sometimes you’ll have to manually add a couple of extra Configuration
Directives to trigger the full suite of extension capabilities, but most of the
time the Suhosin patch works just as soon as the edits to the PHP.ini file go
live.

Search for:

### Categories

* [hphp](http://www.hardened-php.net/./hphp/)
* [Suhosin](http://www.hardened-php.net/./suhosin/)

[Proudly powered by WordPress](https://wordpress.org/ "Semantic Personal Publishing Platform")


