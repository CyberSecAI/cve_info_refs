=== Content from secunia.com_60015381_20250125_200136.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from bugs.gentoo.org_d0581113_20250125_200135.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 96782
sys-apps/sandbox is full of tempfile races
Last modified: 2005-08-15 22:02:15 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=96782&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=96782&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 96782**](show_bug.cgi?id=96782)
- sys-apps/sandbox is full of tempfile races

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
sys-apps/sandbox is full of tempfile races

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Other | |  | | | [Importance](page.cgi?id=fields.html#importance): | High normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | A3 [glsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2005-06-22 06:43 UTC by Tavis Ormandy (RETIRED) | | --- | --- | | Modified: | 2005-08-15 22:02 UTC ([History](show_activity.cgi?id=96782)) | | CC List: | 3 users (show)  bartron sandbox wolf31o2 | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=96782&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=96782&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Tavis Ormandy (RETIRED)   gentoo-dev  2005-06-22 06:43:31 UTC  ``` the sandbox utility is full of toctou races, these are unacceptable and should be fixed.  the toctous are of the nature:  is_file_secure(foo); continue_being_insecure();  (note: i'll work on a patch soon). ```  [Comment 1](#c1)  Chris C. Blockschmidt    2005-06-23 15:14:19 UTC  ``` While you're at that, please review [Bug #47167](show_bug.cgi?id=47167 "RESOLVED INVALID - portage-2.0.50-r3 on crack?"). That bug being invalid was unacceptable last year but the situation has unimproved. Nowadays success rate  increased from 5/8 to nearly 100%.  ```  [Comment 2](#c2)  Tavis Ormandy (RETIRED)   gentoo-dev  2005-06-23 15:34:49 UTC  ``` Ughh ```  [Comment 3](#c3)  SpanKY   gentoo-dev  2005-06-23 15:58:00 UTC  ``` do you care to provide any real information ?  simply saying 'hey, sandbox sucks' isnt useful ```  [Comment 4](#c4)  Tavis Ormandy (RETIRED)   gentoo-dev  2005-06-23 16:42:51 UTC  ``` For example:  main(): ... if (file_exist(sandbox_pids_file, 1) < 0) { ... } else {  pids_file = file_open(sandbox_pids_file, "r+", 1, 0664, "portage"); ... } ...  file_open(): ... /* file_security_check() runs some tests then returns wether it's safe to  proceed, of course, there is no guarantee the filesystem hasnt changed since the  stat() was performed by f_s_c(), the results may not still be true */ file_security_check(filename); ...  fd = open(filename, file_getmode(mode));  file_security_check(filename); ...  where file_getmode(mode) resolves to O_RDWR | O_CREAT in this case, which is a  TOCTOU race, vulnerable to linking attacks. A solution in this case could be to  check if the file exists, if it doesnt, use O_EXCL, which would fail if anyone  tried to win the race. ```  [Comment 5](#c5)  Chris C. Blockschmidt    2005-06-24 18:12:05 UTC  ``` Why do you need /tmp/sandboxpids.tmp, anyway? IIRC, I think it was the reporter of [bug 21923](show_bug.cgi?id=21923 "RESOLVED FIXED - [portage/sandbox-1.1] - security issues with file creation in /tmp") (though I'll have to check) who first discovered in may 2003 that sandboxpids.tmp is only 'needed' when sandbox is injected via  /etc/ld.so.preload using sandboxpid's.tmp as some sort of reference count...  Sandbox adds itself to that file at startup (but only if it's the first  instance) and removes itself when it's finished (but only if it's the last  instance). Nowadays (even two years ago) sandbox does not use /etc/ld.so. preload,  so sandboxpids.tmp does not serve any useful purpose (checked it myself with  today's sandbox, all sandbox does is add and delete a single number to this  file but does not use it in any way for anything useful). Logfiles, I think  nobody I talked to could think of any reason why having those in /tmp would be a good idea.  ```  [Comment 6](#c6)  Martin Schlemmer (RETIRED)   gentoo-dev  2005-06-24 18:59:59 UTC  ``` Ill check the pids file - I am slowly cleaning out the dead code (as you noted, all the ld.so.preload stuff is out), but I have not really given that much attention, so cannot say for sure.  As for the logs ... Might move them to /var/log/sandbox/, but just having them in /var/log/ will bloat things a bit.  I am not a FHS expert, so somebody else might want to comment. ```  [Comment 7](#c7)  SpanKY   gentoo-dev  2005-06-24 22:27:44 UTC  ``` FHS doesnt say much about /var/log except that it's for logfiles ;)  /var/log/sandbox/ sounds good to me ```  [Comment 8](#c8)  Martin Schlemmer (RETIRED)   gentoo-dev  2005-07-08 16:47:19 UTC  ``` Ok, please check the latest code, and let me know if there are issues.   $ svn co svn+ssh://svn.gentoo.org/var/svnroot/path-sandbox  ```  [Comment 9](#c9)  Chris C. Blockschmidt    2005-07-08 18:04:10 UTC  ``` There's something else fishy going on since sandbox-1.2.9 - paths longer than PATH_MAX don't work at all and sandbox is caught in an endless loop (100% cpu). After studying [Bug #21766](show_bug.cgi?id=21766 "RESOLVED FIXED - coreutils-5.0 breaks sandbox") (comment  and 7) I think portage's getcwd is broken again. CC'ing (with permission) writer of [Bug #21766 Comment #7](show_bug.cgi?id=21766#c7 "RESOLVED FIXED - coreutils-5.0 breaks sandbox") (you are the  one who came up with the idea for portage's own getcwd, seems like the older one can handle unlimited paths and the newer one does not. opinion valued)  ```  [Comment 10](#c10)  bartron    2005-07-08 18:24:39 UTC   [Comment 11](#c11)  bartron    2005-07-08 18:24:39 UTC  ```   Well, it can't handle "unlimited" length paths... you still need to  `stat()' every path component either relative to `/' or `.'... nice  thing about the glibc version is that it goes backwards from `.' and  needs only two characters (`..') to go back one level as opposed to  the full directory name in the uclibc version.  In the particular  scenario used in [Bug 21766 comment #4](show_bug.cgi?id=21766#c4 "RESOLVED FIXED - coreutils-5.0 breaks sandbox"), ratio is 9/3, which means  glibc `getcwd()' can handle close to (PATH_MAX * 3) while uclib's  version is approx. (PATH_MAX * 1)...  no real gain here.     After closer inspection, other reasons why the version in sandbox-1.2.9+ can't work are...  (1) in `__syscall_egetcwd()', members of `struct stat st' are passed  uninitialized to `recurser()'... `st' should be initialized to "/".  (2) line #131 overwrites `stat_buf' with "/.." ... instead it should be  appending it (`strcat()' like in uclibs is perfectly save... previous  statement already makes sure there's enough room left).  (3) this particular implementation requires that the passed in buffer  points to an existing directory... use "." for best results...  ```  [Comment 12](#c12)  bartron    2005-07-08 18:27:32 UTC   [Comment 13](#c13)  bartron    2005-07-08 18:27:32 UTC  ```   However, since this is not related to tempfile races, see [bug #98419](show_bug.cgi?id=98419 "RESOLVED REMIND - [sandbox] built-in `getcwd()' implementation broken")  ```  [Comment 14](#c14)  Martin Schlemmer (RETIRED)   gentoo-dev  2005-07-09 02:08:42 UTC  ``` Well, even the glibc one fails with the specific test (handles a bit longer paths, but not the depth that coreutils test requires), is rather ugly and at some point redo the whole path with 'confdir3':    [http://bugs.gentoo.org/show_bug.cgi?id=21766#c39](show_bug.cgi?id=21766#c39 "RESOLVED FIXED - coreutils-5.0 breaks sandbox")  As for the recursion .. cannot say I can get it here.  Will look at the new bug though.  ```  [Comment 15](#c15)  bartron    2005-07-10 18:06:54 UTC   [Comment 16](#c16)  bartron    2005-07-10 18:06:54 UTC  ```   See [Bug #98419](show_bug.cgi?id=98419 "RESOLVED REMIND - [sandbox] built-in `getcwd()' implementation broken") for more info on `getcwd'. ```  [Comment 17](#c17)  Martin Schlemmer (RETIRED)   gentoo-dev  2005-07-11 00:11:52 UTC  ``` Right, besides getcwd() .. can somebody from security comment on the original problem?  ```  [Comment 18](#c18)  Tavis Ormandy (RETIRED)   gentoo-dev  2005-07-13 07:55:26 UTC  ``` Looks good, the logs are all moved into /var/log?  seems home_dir can be set to /tmp if HOME has been unset? is that ever likely to  happen? and if so, does it read or write anything in there? (sorry, unfamiliar  with it's operation :)  If that's not an issue, everything looks fine to me. ```  [Comment 19](#c19)  Martin Schlemmer (RETIRED)   gentoo-dev  2005-07-13 08:32:44 UTC  ``` Can do.  It should not anymore .. its more to make sure we have a sane TMPDIR and its writable for ./configure scripts, etc ... ```  [Comment 20](#c20)  Martin Schlemmer (RETIRED)   gentoo-dev  2005-07-15 03:01:10 UTC  ``` Actually, it already sets, home_dir to /tmp if all else fails. ```  [Comment 21](#c21)  Thierry Carrez (RETIRED)   gentoo-dev  2005-07-18 05:16:20 UTC  ``` Martin: do you have any idea of the release date for the fix ? ```  [Comment 22](#c22)  Martin Schlemmer (RETIRED)   gentoo-dev  2005-07-20 06:02:46 UTC  ``` Thierry, that should be already in 1.2.11. ```  [Comment 23](#c23)  Thierry Carrez (RETIRED)   gentoo-dev  2005-07-20 06:27:43 UTC  ``` Ah ok. Great :)  Any reason why we should not ask arch teams to test and stable-ize ? Or do you prefer to wait a little in ~ to catch bugs ? ```  [Comment 24](#c24)  Thierry Carrez (RETIRED)   gentoo-dev  2005-07-20 06:46:00 UTC  ``` Arches, please test sandbox-1.2.11 carefully and mark stable if it is. ```  [Comment 25](#c25)  Danny van Dyk (RETIRED)   gentoo-dev  2005-07-20 09:26:23 UTC  ``` amd64 stable ```  [Comment 26](#c26)  Gustavo Zacarias (RETIRED)   gentoo-dev  2005-07-20 10:43:10 UTC  ``` sparc stable. ```  [Comment 27](#c27)  Markus Rothe (RETIRED)   gentoo-dev  2005-07-20 13:32:27 UTC  ``` stable on ppc64 ```  [Comment 28](#c28)  Joe Jezak (RETIRED)   gentoo-dev  2005-07-20 19:28:18 UTC  ``` Tested and marked ppc stable. ```  [Comment 29](#c29)  Chris Gianelloni (RETIRED)   gentoo-dev  2005-07-21 08:15:48 UTC  ``` Tested and marked x86 stable ```  [Comment 30](#c30)  René Nussbaumer (RETIRED)   gentoo-dev  2005-07-21 11:52:43 UTC  ``` Stable on hppa. Sorry for the delay. ```  [Comment 31](#c31)  Chris Gianelloni (RETIRED)   gentoo-dev  2005-07-21 12:14:16 UTC  ``` Alpha and IA64 were done by agriffis ```  [Comment 32](#c32)  Sune Kloppenborg Jeppesen (RETIRED)   gentoo-dev  2005-07-23 04:47:33 UTC  ``` This one is ready for GLSA.  ```  [Comment 33](#c33)  Sune Kloppenborg Jeppesen (RETIRED)   gentoo-dev  2005-07-25 11:32:57 UTC  ``` GLSA 200507-22    arm and s390 don't forget to mark stable.  ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=96782)
* - [XML](show_bug.cgi?ctype=xml&id=96782)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=96782)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=96782&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=96782&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=96782&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.gentoo.org_11668eda_20250125_200138.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# sandbox: Insecure temporary file handling — GLSA **200507-22**

The sandbox utility may create temporary files in an insecure manner.

### Affected packages

| Package | **sys-apps/sandbox** on all architectures |
| --- | --- |
| Affected versions | < **1.2.11** |
| Unaffected versions | >= **1.2.11** |

### Background

sandbox is a Gentoo Linux utility used by the Portage package
management system.

### Description

The Gentoo Linux Security Audit Team discovered that the sandbox
utility was vulnerable to multiple TOCTOU (Time of Check, Time of Use)
file creation race conditions.

### Impact

Local users may be able to create or overwrite arbitrary files with the
permissions of the root user.

### Workaround

There is no known workaround at this time.

### Resolution

All sandbox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=sys-apps/sandbox-1.2.11"
```
### References

* [CAN-2005-2449](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-2449)

**Release date**

July 25, 2005

**Latest revision**

August 11, 2005: 02

**Severity**

low

**Exploitable**

local

**Bugzilla entries**

* [96782](https://bugs.gentoo.org/show_bug.cgi?id=96782)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


