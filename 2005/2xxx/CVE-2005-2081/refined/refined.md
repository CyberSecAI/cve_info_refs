- **Root cause of vulnerability**: A programming error in the function that parses commands in the Asterisk system leads to a stack overflow when processing CLI commands through the manager interface. Specifically, the command parsing function returns without error, but the calling function experiences a segmentation fault due to an overflow of one of its parameters.
- **Weaknesses/vulnerabilities present**: Stack overflow in the command parsing function of the Asterisk manager interface.
- **Impact of exploitation**: Successful exploitation of this vulnerability allows an attacker to execute arbitrary code with root privileges on the Asterisk system. This results in a remote root shell.
- **Attack vectors**: The vulnerability is triggered through the Asterisk Manager Interface by sending a specially crafted command string (e.g., a string of repeating double quotes followed by a tab character).
- **Required attacker capabilities/position**: An attacker needs to have a valid manager username and password, and the user needs to have 'command' permissions. This requires a specific configuration in manager.conf file with the 'write = command' option enabled. The attacker also needs network access to the Asterisk server's manager interface, which is bound to 127.0.0.1 by default.