=== Content from www.kb.cert.org_5215db05_20250125_163504.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#102014

## Optimistic TCP acknowledgements can cause denial of service

#### Vulnerability Note VU#102014

Original Release Date: 2005-11-10 | Last Revised: 2017-04-12

---

### Overview

A vulnerability in the TCP congestion control mechanism could be leveraged by an attacker to cause a denial of service.

### Description

| The Transmission Control Protocol (TCP) is described in [RFC 793](http://www.ietf.org/rfc/rfc793.txt) as a means to provide reliable host-to-host transmission in a packet-switched computer network. Numerous Internet protocols such as HTTP, SMTP, and FTP rely on TCP as their underlying transport protocol. Several different TCP congestion control mechanisms are specified in [RFC 2581](http://www.ietf.org/rfc/rfc2581.txt).  In the course of normal operation a TCP client acknowledges (ACKs) the receipt of packets sent to it by the server. A TCP sender varies its transmission rate based on receiving ACKs of the packets it sends. An *optimistic* ACK is an ACK sent by a client for a data segment that it has not yet received. A vulnerability exists in the potential for a client to craft optimistic ACKs timed in such a way that they correspond to legitimate packets that the sender has already injected into the network (often referred to as "in-flight" packets). As a result, the sender believes that the transfer is progressing better than it actually is and may increase the rate at which it sends packets. An important side effect of this condition is the amplification factor that it introduces. An attacker exploiting this vulnerability can potentially cause victims to transmit much more data than the bandwidth available to the attacker.This condition was first described in 1999 by Savage, Cardwell, Wetherall, and Anderson in their paper, "[*TCP Congestion Control with a Misbehaving Receiver*](http://www.cs.ucsd.edu/~savage/papers/CCR99.pdf)." Although this paper briefly mentioned the possibility of using this condition to mount a denial-of-service attack, it did not develop the details of the attack. In 2005, Sherwood, Bhattacharjee, and Braud published a paper, entitled "[*Misbehaving TCP Receivers Can Cause Internet-Wide Congestion Collapse,*](http://www.cs.umd.edu/~capveg/optack/optack-extended.pdf)" that examines the extent of the potential impact of an attack using this vulnerability. |
| --- |

### Impact

| A remote attacker can cause a TCP sender to transmit packets faster than it would in the course of a normal connection. The victim could potentially exhaust its network bandwidth, thereby resulting in a denial of service. In an attack involving multiple victims, the aggregate volume of generated traffic may cause congestion or a bandwidth exhaustion denial of service to intermediate transit network providers as well. |
| --- |

### Solution

| The CERT/CC is currently unaware of a practical solution to this problem. |
| --- |

| **Workarounds****Connection Throttling**Network administrators should consider implementing per-connection throttling or other forms of traffic shaping for services on their network that could be exploited. While this workaround does not remove the underlying vulnerability, it forces an attacker to use more hosts in order to have the same overall impact.**TCP Implementation Changes**Sherwood et al. proposes several implementation changes to mitigate this vulnerability. In particular, the authors suggest a strategy of randomly dropping segments on the sender. By doing this, receivers that ACK packets that are intentionally dropped by the sender can reliably be identified as misbehaving. The authors have provided a [patch](http://www.cs.umd.edu/~capveg/optack/optack.patch) that implements this workaround for Linux 2.4.24 kernel.It is important to note that these implementation changes have not been ratified by relevant standards bodies such as the IETF. Implementors and administrators should exercise careful consideration and be especially aware of unintended side effects when choosing to implement these implementation changes. |
| --- |

### Vendor Information

102014
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23102014/) to view vendors.**
### [Sun Microsystems, Inc.](#MIMG-6FUR5D) Affected

Notified:  September 02, 2005  Updated: November 03, 2005

**Statement Date:   November 03, 2005**

### Status

Affected

### Vendor Statement

Sun implements the TCP standard in Solaris, and as such acknowledges
that it is affected by vulnerability #102014.

Sun is evaluting this issue, including its impact and possible methods
for adressing it, and is currently communicating with organisations
such as the IETF to determine the best course of action.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [3com, Inc.](#MIMG-6FUQSM) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [AT&T](#MIMG-6FUQT4) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Alcatel](#MIMG-6FUQSS) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Apple Computer, Inc.](#MIMG-6FUQSX) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Avaya, Inc.](#MIMG-6FUQT9) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Avici Systems, Inc.](#MIMG-6FUQTE) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Borkerware Technologies](#MIMG-6FUQTK) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Charlotte's Web Networks](#MIMG-6FUQUN) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Check Point Software Technologies](#MIMG-6FUQTQ) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Chiaro Networks, Inc.](#MIMG-6FUQTV) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Cisco Systems, Inc.](#MIMG-6FUQU2) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Computer Associates](#MIMG-6FUQU7) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Conectiva Inc.](#MIMG-6HJSY4) Unknown

Notified:  October 26, 2005  Updated: October 26, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Cray Inc.](#MIMG-6FUQUH) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [D-Link Systems, Inc.](#MIMG-6FUQV5) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Data Connection, Ltd.](#MIMG-6FUQUT) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Debian Linux](#MIMG-6FUQUY) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [EMC, Inc. (formerly Data General Corporation)](#MIMG-6FUQV8) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Engarde Secure Linux](#MIMG-6FUQVD) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Ericsson](#MIMG-6FUQVJ) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Extreme Networks](#MIMG-6FUQVU) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [F5 Networks, Inc.](#MIMG-6FUQVZ) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Fedora Project](#MIMG-6HJSZK) Unknown

Notified:  October 26, 2005  Updated: October 26, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Force10 Networks, Inc.](#MIMG-6FUQW6) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Fortinet, Inc.](#MIMG-6FUQWB) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Foundry Networks, Inc.](#MIMG-6FUQWG) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [FreeBSD, Inc.](#MIMG-6FUQWM) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Fujitsu](#MIMG-6FUQWS) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [GNU netfilter](#MIMG-6FUR2K) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Gentoo Linux](#MIMG-6HJT2C) Unknown

Notified:  October 26, 2005  Updated: October 26, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Global Technology Associates](#MIMG-6FUQWX) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Hewlett-Packard Company](#MIMG-6FUQX9) Unknown

Notified:  September 02, 2005  Updated: November 22, 2005

**Statement Date:   November 16, 2005**

### Status

Unknown

### Vendor Statement

HP is investigating this issue.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Hitachi](#MIMG-6FUQX4) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Hyperchip](#MIMG-6FUQXE) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [IBM Corporation](#MIMG-6FUQXK) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [IBM Corporation (zseries)](#MIMG-6FUQXQ) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [IBM eServer](#MIMG-6FUQXV) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [IP Filter](#MIMG-6FUQYN) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Immunix Communications, Inc.](#MIMG-6FUQY2) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Ingrian Networks, Inc.](#MIMG-6FUQY7) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Intel Corporation](#MIMG-6FUQYC) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Internet Security Systems, Inc.](#MIMG-6FUQYT) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Intoto](#MIMG-6FUQYH) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Juniper Networks, Inc.](#MIMG-6FUQYY) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Linksys (A division of Cisco Systems)](#MIMG-6FUQZ5) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Lucent Technologies](#MIMG-6FUQZA) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Luminous Networks](#MIMG-6FUQZF) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Mandriva, Inc.](#MIMG-6FUQZJ) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Mandriva, Inc.](#MIMG-6FUQUC) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Microsoft Corporation](#MIMG-6FUQZP) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [MontaVista Software, Inc.](#MIMG-6FUQZU) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Multinet (owned Process Software Corporation)](#MIMG-6FUQZZ) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Multitech, Inc.](#MIMG-6FUR24) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [NEC Corporation](#MIMG-6FUR29) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [NetBSD](#MIMG-6FUR2E) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Network Appliance, Inc.](#MIMG-6FUR2Q) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [NextHop Technologies, Inc.](#MIMG-6FUR2V) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Nortel Networks, Inc.](#MIMG-6FUR32) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Novell, Inc.](#MIMG-6FUR37) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [OpenBSD](#MIMG-6FUR3C) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Openwall GNU/\*/Linux](#MIMG-6FUR3H) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [QNX, Software Systems, Inc.](#MIMG-6FUR3N) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Red Hat, Inc.](#MIMG-6FUR3Y) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Redback Networks, Inc.](#MIMG-6FUR3T) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Riverstone Networks, Inc.](#MIMG-6FUR45) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [SUSE Linux](#MIMG-6FUR5J) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Secure Computing Network Security Division](#MIMG-6FUR4L) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Sequent Computer Systems, Inc.](#MIMG-6FUR4R) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Silicon Graphics, Inc.](#MIMG-6FUR4W) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Slackware Linux Inc.](#MIMG-6HJT7C) Unknown

Notified:  October 26, 2005  Updated: October 26, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Sony Corporation](#MIMG-6FUR53) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [StoneSoft, Inc.](#MIMG-6FUR58) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Symantec, Inc.](#MIMG-6FUR5P) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [The SCO Group](#MIMG-6HJT6P) Unknown

Notified:  October 26, 2005  Updated: October 26, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [The SCO Group (SCO Linux)](#MIMG-6FUR4A) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [The SCO Group (SCO Unix)](#MIMG-6FUR4F) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Trustix Secure Linux](#MIMG-6HJT87) Unknown

Notified:  October 26, 2005  Updated: October 26, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Turbolinux](#MIMG-6FUR5U) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [UNISYS](#MIMG-6FUR63) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Ubuntu](#MIMG-6HJT8G) Unknown

Notified:  October 26, 2005  Updated: October 26, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Watchguard Technologies, Inc.](#MIMG-6FUR68) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Wind River Systems, Inc.](#MIMG-6FUR6D) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [ZyXEL](#MIMG-6FUR6J) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [eSoft, Inc.](#MIMG-6FUQVP) Unknown

Notified:  September 02, 2005  Updated: September 02, 2005

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

View all 85 vendorsView less vendors

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 0 | AV:--/AC:--/Au:--/C:--/I:--/A:-- |
| Temporal | 0 | E:ND/RL:ND/RC:ND |
| Environmental | 0 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://www.cs.umd.edu/~capveg/optack/optack-ccs05.pdf>
* <http://www.cs.umd.edu/~capveg/optack/optack-extended.pdf>
* <http://www.cs.ucsd.edu/~savage/papers/CCR99.pdf>
* <http://www-2.cs.cmu.edu/~kgao/course/15744/network.pdf>
* <http://mirrors.sec.informatik.tu-darmstadt.de/ftp.ietf.org/internet-drafts/draft-azcorra-tcpm-tcp-blind-ack-dos-00.txt>
* <http://mirrors.sec.informatik.tu-darmstadt.de/ftp.ietf.org/internet-drafts/draft-azcorra-tcpm-tcp-blind-ack-dos-01.txt>
* <http://jvn.jp/cert/JVNVU%23102014/index.html>
### Acknowledgements

Thanks to Rob Sherwood of the University of Maryland for reporting this vulnerability and researching its associated exploitation methods. The CERT/CC acknowledges Stefan Savage, Neal Cardwell, David Wetherall, and Tom Anderson for the original publication of the underlying protocol issue that causes the vulnerability.

This document was written by Chad Dougherty. Additional technical feedback and assistance with this vulnerability was provided by Hal Burch and Art Manion.

### Other Information

| **CVE IDs:** | [CVE-2005-3675](http://web.nvd.nist.gov/vuln/detail/CVE-2005-3675) |
| --- | --- |
| **Severity Metric:** | 10.50 |
| **Date Public:** | 2005-11-10 |
| **Date First Published:** | 2005-11-10 |
| **Date Last Updated:** | 2017-04-12 17:27 UTC |
| **Document Revision:** | 34 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.cs.umd.edu_f7c675af_20250125_163503.html ===
Misbehaving TCP Receivers Can Cause Internet-Wide Congestion
Collapse
Technical Report: UMD-CS-TR-4737

Rob Sherwood Bobby Bhattacharjee Ryan Braud
fcapveg,bobbyg@cs.umd.edu rbraud@cs.ucsd.edu

Abstract

An optimistic acknowledgment (opt-ack) is an acknowl-
edgment sent by a misbehaving client for a data segment
that it has not received. Whereas previous work has fo-
cused on opt-ack as a means to greedily improve end-to-
end performance, we study opt-ack exclusively as a denial
of service attack. Speci(cid:2)cally, an attacker sends optimistic
acknowledgments to many victims in parallel, thereby am-
plifying its effective bandwidth by a factor of 30 million
(worst case). Thus, even a relatively modest attacker can
totally saturate the paths from many victims back to the
attacker. Worse, a distributed network of compromised
machines ((cid:147)zombies(cid:148)) can exploit this attack in parallel to
bring about wide-spread, sustained congestion collapse.

We implement this attack both in simulation and in a
wide-area network, and show it severity both in terms of
number of packets and total traf(cid:2)c generated. We engi-
neer and implement a novel solution that does not require
client or network modi(cid:2)cations allowing for practical de-
ployment. Additionally, we demonstrate the solution’s ef-
(cid:2)ciency on a real network.

1 Introduction

Savage et al. [29] present three techniques by which a
misbehaving TCP receiver can manipulate the sender into
providing better service at the cost of fairness to other
nodes. With one such technique, optimistic acknowledg-
ment ((cid:147)opt-ack(cid:148)), the receiver deceives the sender by send-
ing acknowledgments (ACKs) for data segments before
In effect, the connec-
they have actually been received.
tion’s round trip time is reduced and the total through-
put increased. Savage et al. observe that a misbehav-
ing receiver could use opt-ack to conceal data losses, thus
improving end-to-end performance at the cost of data in-
tegrity. They further suggest that opt-ack could potentially
be used for denial of service, but do not investigate this
further.

In this paper, we consider a receiver whose sole interest
is exploiting opt-ack to mount a distributed denial of ser-
vice (DoS) attack against not just individual machines, but
entire networks. In this paper, we:

1. Demonstrate a previously unrealized and signi(cid:2)cant
danger from the opt-ack attack (one attacker, many
victims) through analysis (Section 3) and both simu-
lated and real world experiments.

2. Survey prevention techniques and present a novel, ef-
(cid:2)cient, and incrementally deployable solution (Sec-
tion 4.2) based on skipped segments, whereas previ-
ous solutions ignored practical deployment concerns.

3. Argue that the distributed opt-ack attack (many at-
tackers, many victims) has potential to bring about
sustained congestion collapse across large sections of
the Internet, thus necessitating immediate action.

1.1 An Attack Based on Positive Feedback

Two signi(cid:2)cant components of transport protocols are the
(cid:3)ow and congestion control algorithms. These algorithms,
by necessity, rely on remote feedback to determine the rate
at which packets should be sent. This feedback can come
directly from the network [26, 19] or, more typically, from
end hosts in the form of positive or negative acknowledg-
ments. These algorithms implicitly assume that the remote
entity generates correct feedback. This is typically a safe
assumption because incorrect feedback rapidly deteriorates
end-to-end performance [14]. However, an attacker who
does not care about data integrity could violate this as-
sumption to induce the sender into injecting many packets
into the network. While not all of these packets may arrive
at the receiver, they do serve to congest the sender’s net-
work and saturate the path from the sender to the receiver.
In this paper, we always assume that the attacker targets
multiple victims, in order to maximize the damage that the
attack can cause Because acknowledgment packets are rel-
atively small (40 bytes), it is trivial for an attacker to tar-
get hundreds and even thousands of victims in parallel. In

1

effect, not only are each victims’ access links saturated,
but, due to over-provisioning, higher bandwidth links in
the upstream ISPs begin to suffer congestion collapse in
aggregate as well.
In Section 2.4, we argue that suf(cid:2)-
ciently many attackers can overwhelm backbone links in
the core of the Internet, causing wide-area sustained con-
gestion collapse.

1.2 Road map

The rest of the paper is structured as follows. Section 2
describes attack pseudo-code, implementation challenges,
variants, and the distributed opt-ack attack. Section 3 dis-
cusses various bounds on the attacker’s bandwidth ampli-
(cid:2)cation. In Section 4, we consider and evaluate possible
solutions, propose one based on skipped segments, and de-
scribe its implementation. In Section 5, we present perfor-
mance numbers of attacked machines with and without the
proposed (cid:2)x, in real world and simulated topologies. Next,
we discuss related work in Section 6. We conclude with
implications of the opt-ack attack and future work in Sec-
tion 7. Appendix A describes the key observations required
in a practical implementation of the opt-ack attack.

2 Attack Analysis

In this section we describe pseudo-code for the attack, a
summary of implementation challenges, attack variants,
and the details of the distributed version of the opt-ack at-
tack. In Appendix A, we present the observations we made
in implementing the attack and techniques for mitigating
practical concerns.

2.1 The Opt-Ack Attack

Algorithm 1 shows how a single attacker can target many
victims at once. Typically, the attacker would employ
a compromised machine (a (cid:147)zombie(cid:148) [30]) rather than
launch the attack directly.1 Consider a set of victims,
v1 : : : vn, that serve (cid:2)les of various sizes. The attack con-
nects to each victim, then sends an application level re-
quest, e.g., an HTTP GET. The attacker then starts to ac-
knowledge data segments regardless of whether they ar-
rived or not (Figure 1). This causes the victim to saturate
its local links by responding faster and faster to the attack-
ers opt-acks. To sustain the attack, the attacker repeatedly
asks for the same (cid:2)les or iterates through a number of (cid:2)les.
The crux of the attack is that the attacker must produce
a seemingly valid sequence of ACKs. For an ACK to be
considered valid, it must not arrive before the victim has

1This attack can also be mounted if the attacker is able to spoof TCP
connections, either by being on the path between the victim and the
spoofed address, or from guessing the initial sequence number, but we
do not further consider it.

Algorithm 1 (cid:150)Attack(fv1 : : : vng, mss, wscale)

1: maxwindow  65535 (cid:2) 2wscale
2: n   jfv1; : : : ; vngj
3: for i   1 : : : n do
4:

connect(mss,wscale) to vi , get isni
acki   isni + 1
wi   mss

5:
6:
7: end for
8: for i   1 : : : n do
9:
10: end for
11: while true do
12:

for i   1 : : : n do

send vi data request f http get, ftp fetch, etc. . . g

13:
14:

15:

acki   acki + wi
send ACK for acki to vi f entire windowg
if wi < maxwindow then

wi   wi + mss

16:
17:

end if
end for
18:
19: end while

sent the corresponding packet. Thus, the attacker must es-
timate which packets are sent and when, based only on the
stream of ACKs the attacker has already sent. At (cid:2)rst this
might seem a dif(cid:2)cult challenge, but the victim’s behav-
ior on receiving an ACK is exactly prescribed by the TCP
congestion control algorithm! The attack takes three pa-
rameters: a list of n victims, the maximum segment size
(mss), and the window scaling (wscale) factor. In the al-
gorithm, the attacker keeps track of each victim’s estimated
window (wi) and sequence number to acknowledge (acki).
The upper bound of wi, maxwindow , is 65535 by default,
but can be changed by the window scaling option (see Sec-
tion 3). Note that the attacker can manipulate each victim’s
retransmission time out (RTO), because the RTO is a func-
tion of the round trip time, which is calculated by the ACK
arrival rate. So, in other words, the attack can completely
manipulate the victims in terms of how fast to send, how
much to send, and when to time out.

There is a near arbitrary number of potential victims,
given the pervasiveness of large (cid:2)les on the Internet. Any
machine that is capable of streaming TCP data is a po-
tential victim, including HTTP servers, FTP servers, con-
tent distribution networks (CDN), P2P (cid:2)le sharing peers
(KaZaa[2], Gnutella[1]), NNTP servers, or even machines
with the once common character generator (‘chargen’) ser-
vice.

The attack stream is dif(cid:2)cult to distinguish from legit-
imate traf(cid:2)c. To an external observer that is suf(cid:2)ciently
close to the victim, such as a network intrusion detection
system (IDS), this stream is in theory indistinguishable

2

Received Segments w/ Drops

Seg:

1

5

10

12

Attacker

Ack: 23 22 21 ...

Internet

Victim

Webserver

Opt Acks

Ack: 1 2 3

4

5

6

...

13

14

Seg:

23

22

21

20 19 18 17 16 15

Flooded Return Path

Figure 1: Opt-Ack Attack: Single Victim w/ Packet
Loss (One of many victims)

from a completely valid high speed connection.2 While
it is common for IDSs to send out alerts if a large stream of
packets enters the local network, the stream of ACKs from
the attacker is comparatively small (see Section 3 for exact
numbers). It is the stream of data leaving the network that
is the problem.

Additionally, an attacker can further obscure the attack
signature by sending acknowledgments to more victims
less often, with the total amount of traf(cid:2)c generated stay-
ing constant. In other words, by generating less traf(cid:2)c per
host and staying under the detection threshold, but increas-
ing the total number of hosts it is not locally obvious to the
victims that they are participating in an DDoS attack. As a
result, short of a globally coordination, potentially through
a distributed intrusion detection system, it is dif(cid:2)cult for
victims to locally determine if a given stream is malicious.
While Algorithm 1 works in theory, there are still chal-
lenges for the adversary to keep ACKs synchronized with
the segments the victims actually send. We address these
issues in the next section.

gets ahead of the victim in the sequence space, i.e., the
victim received ACKs for segments that are not yet sent,
the victim ignores these ACKs and the stream stops mak-
ing progress. We refer to this condition as overrunning the
victim. Overruns can occur in three different ways: ACKs
arriving too quickly, lost ACKs, and delays at the server.
However, if an attacker does overrun the server, it is pos-
sible for the attacker to detect this condition and recover
(Appendix A).

In accordance with RFC793 [4], Section 3.4, when the
sender receives ACKs that are not in the window, it should
not generate a RST, but instead an empty packet with the
correct sequence number. One of the tenets of the Internet
design philosophy is the robustness principle: (cid:147)be conser-
vative in what you send, and liberal in what you accept,(cid:148)
and it is this principle that opt-ack exploits.

There are many ways that an overrun condition may
result, most common being the sending application stalls
its output because it was preempted by another process.
In general, there are a myriad of factors that affect the
sender’s actual output rate, including:
the victim’s load,
application delay, the victim’s send buffer size, and the vic-
tim’s hardware buffer. However, these factors are mitigated
when the number of victims is large. By sending ACKs to
more victims, each individual victim receives ACKs less
often. This provides more time for the victim to (cid:3)ush its
buffers, place the sending application back into the run
queue, etc.

It is worth noting that the implementation we developed
is only a demonstration of the potential severity of opt-ack.
It is by no means an optimal attack. There are a number
of points where a more thorough attacker might be able
to mount a more ef(cid:2)cient attack. However, as we note in
Section 5, the implementation is suf(cid:2)ciently devastating as
to motivate immediate action.

In Appendix A, we discuss further strategies to mitigate

and recover from overrunning the victim.

2.2 Implementation Challenges

2.3 Lazy Opt-Ack

The main challenge in implementing the attack is to accu-
rately predict which segments the victim is sending and en-
sure that the corresponding ACKs arrive at the correct time.
In Figure 1, the attacker injects ACKs into the network be-
fore the corresponding segments have even reached the at-
tacker, so remaining synchronized with the victim can be
non-trivial. Maintaining this synchronization of sequence
numbers is crucial to the attack. If the attacker falls behind,
i.e., it starts to acknowledge segments slower than they are
sent, then the victim slows down, may time out, and the
effect of the attack is reduced. Similarly, if the attacker

2Presumably, a monitoring system deployed closer to the attacker
could detect the asynchrony between ACKs and data segments, but it is
not practical to store per-(cid:3)ow state deep in the network.

Lazy opt-ack is a variant of the standard opt-ack attack.
Recall that the main dif(cid:2)culty in our implementation is in
remaining synchronized with the sender’s sequence num-
ber. The synchronization issue can be totally avoided if
the attacker ACKs any segment that it actually receives,
independent of missing segments. This lazy variant is ma-
licious in that the attacker is effectively concealing any
packet loss, thereby creating a (cid:3)ow that does not decrease
its sending rate when faced with congestion ( i.e., a non-
responsive (cid:3)ow). Since the attacker is using the actual
RTT to the victim, it generates less traf(cid:2)c than the at-
tack described in Algorithm 1. However, it is well known
[12] that in a congested network, a non-responsive (cid:3)ow can
cause compliant (cid:3)ows to back off, creating a DoS. Note

3

that the lazy variant is different from the standard attack
in that it is impossible for the attacker to overrun the vic-
tim. This observation is precisely what makes many exist-
ing solutions insuf(cid:2)cient. The skipped segments solution
we provide in Section 4.2 protects against both the lazy and
standard attacks.

the Slammer worm. Recent studies[6] show that there ex-
ists networks of compromised machines( (cid:147)botnets(cid:148)) with
over 200,000 nodes. Since each of these nodes represents
a possible attacker, a large distributed opt-ack attack could
easily be catastrophic.

2.4 Distributed Opt-Ack Attack

In this section, we consider the distributed case where mul-
tiple attackers run the opt-ack attack in parallel, trivially,
and with devastating effect. The only coordination re-
quired is that each attacker chooses a different set of vic-
tims. Because a single attacker can solicit an overwhelm-
ing number of packets ( as we will see in Section 3) a rel-
atively small group of attackers can cause the Internet to
suffer widespread and sustained congestion collapse.

First, because opt-ack targets any TCP server, there are
millions of potential victims on the Internet. Considering
P2P (cid:2)le distribution networks alone, Kazaa and Gnutella
have over 2 million[18, 17, 28] and 1.4 millions [20] users
respectively that each host large multimedia (cid:2)les. While
P2P nodes are typically low bandwidth home users, the
popular content distributor Akamai runs over 14,000 [5]
highly provisioned, geographically distributed servers.

It is not immediately clear how much traf(cid:2)c is necessary
to adversely affect the wide-area Internet. One data point is
the traf(cid:2)c generated from the Slammer/Sapphire worm. In
[22], Moore et al. used sampling techniques to estimate the
peak global worm traf(cid:2)c at approximately 80 million pack-
ets per second. At 404 bytes/packet, the worm generated
approximately 31GB/s of global Internet traf(cid:2)c. Subse-
quent email exchanges by Internet operators [23] noted that
many access links were at full capacity, and completely
unusable. However, as noted in Table 1, it is theoreti-
cally possible for a single attacker on a modem to gen-
erate more than enough traf(cid:2)c to exceed this threshold us-
ing large wscale values. If using large wscale values were
infeasible (for example, if packets containing the wscale
option were (cid:2)rewalled), then (cid:2)ve attackers on T3 connec-
tions with more typical TCP options, i.e., mss = 536 and
wscale = 0, would be suf(cid:2)cient to match the Slammer
worm’s traf(cid:2)c. If each attacker targeted suf(cid:2)cient number
of victims, such that the load on no one victim was notably
high, it would be dif(cid:2)cult to locally distinguish malicious
and valid data streams. So, unlike Slammer, there would
be no clear local rule to apply to thwart the attack.

The traf(cid:2)c from the Slammer worm was not suf(cid:2)cient to
push the core of the Internet into congestion collapse. Be-
cause of the inherent dif(cid:2)culty in modeling wide scale In-
ternet phenomena, it is not clear how to estimate the num-
ber of opt-ack attackers required to induce such a collapse.
However, a single attacker on a modem or a small num-
ber of other attackers can induce traf(cid:2)c loads equivalent to

4

3 Ampli(cid:2)cation Factor

While it is not surprising that a victim can be induced to
send large amounts of data into the network, the actual opt-
ack ampli(cid:2)cation factor is truly alarming. For example, an
attacker on a 56Kbps modem can cause victims to push
71.2Mb/s of traf(cid:2)c into the network with standard TCP op-
tions. In the worst case, i.e., mss=88 and wscale=14, the
same attacker can cause up to 1.6Tb/s of traf(cid:2)c to be gen-
erated. See Table 1 for other examples. While estimating
these bounds is fairly simple (Section 3.1), our analysis in-
cludes the more sophisticated issues (Section 3.2) of maxi-
mum number of victims due to application time out, mini-
mum victim bandwidths, and the time to grow the force of
the attack.

3.1 Congestion Control Bounds

The upper bound on the traf(cid:2)c induced across all victims
from a single attacker is a function of four items: the num-
ber of victims (n), and for each individual victim i, the rate
at which ACKs arrive at each victim ((cid:11)i), the maximum
segment size (mssi ), and the size of the victim’s congestion
window (wi). Note that the attacker can use a single ACK
to acknowledge an entire congestion window of packets.
The number of packets from a single victim in the network
at any one time is b wi=mssi c. If we assume a standard
TCP/IP 40 byte header with no options and that the link
layer is Ethernet (14 byte header), then the packet size is
54+mssi bytes. The rate of attack traf(cid:2)c T in bytes/second
is simply the sum across each victim of the product of the
ACK arrival rate((cid:11)i), the number of packets( b wi=mssi c),
and the size of each packet ( 54 + mssi ), or:

n

T =

(cid:11)i (cid:2)

Xi=1

wi
mss i (cid:23)

(cid:22)

(cid:2) (54 + mssi )

(1)

To (cid:2)nd the theoretic maximum possible (cid:3)ooding rate,
Tmax, we have to consider the bandwidth the attacker ded-
icates to each victim (i.e., the thin dark line in Figure 1
from attacker to victim), which we denote (cid:12)i for the ith
victim. If we assume (cid:12)i is measured in bytes/second, each
ACK is 40 bytes, and again assume the link layer is Eth-
ernet (14 byte header), then we (cid:2)nd that (cid:12)i = 54(cid:11)i at
maximum bandwidth. We use (cid:12) =
to denote the
attacker’s total attack bandwidth to all victims, and for sim-
plicity assume that each victim has the same mss and wi,

n
i=1 (cid:12)i

P

Attacker Speed
(Tmax)
Multiplier (cid:12) = 1
Modem (cid:12) = 7000
DSL (cid:12) = 16000
T1 (cid:12) = 193000
T3 (cid:12) = 5625000

mss = 88

mss = 536

mss = 536 mss = 88
wscale = 0 wscale = 0 wscale = 14 wscale = 14
30.6 MB/s
1336 B/s
209.2 GB/s
8.9 MB/s
478.1 GB/s
20.4 MB/s
5.63 TB/s
245.8 MB/s
164.1 TB/s
7.0 GB/s

1958 B/s
13.1 MB/s
29.9 MB/s
360.5 MB/s
10.3 GB/s

20.9 MB/s
142.7 GB/s
326.1 GB/s
3.84 TB/s
112.0 TB/s

Table 1: Maximum theoretical (cid:3)ooding for various attacker speeds and options. MB/s refers to 220 bytes/second, etc.

i.e., 8i; mss i = mss and 8i; wi = maxwindow. Thus, sub-
stituting (cid:12), mss, and maxwindow into (1) and rearranging
produces:

Tmax =

(cid:22)

(cid:12) (cid:2) maxwindow (cid:2)

1
mss

(cid:18)

+

1
54 (cid:19)(cid:23)

(2)

As noted before,

the maximum congestion window
(maxwindow ) is typically 65535. For a wide area connec-
tion, a typical value for mss would be 536.3 Substituting
these values into (2) produces Tmax = 1336 (cid:12). Thus, us-
ing typical values, an attacker has an ampli(cid:2)cation factor
of 1336. In real world terms, that means an attacker on a
56 Kilo-bits/s modem ((cid:12) = 7000 B/s) can in theory gen-
erate 9,351,145 B/s or approximately 8.9MB/s of (cid:3)ooding
summed across all victims. This value is more than the ca-
pacity of a T3 line, and close to the theoretical limit of a
100Mb Ethernet connection. See Table 1 for the ampli(cid:2)-
cation factor, and more examples.

For non-standard values of mss and maxwindow , the
ampli(cid:2)cation factor of the opt-ack attack is signi(cid:2)cantly
magni(cid:2)ed. Recall from RFC 793 [4] that the mss is a
16 bit value set via TCP option by the receiver (the at-
tacker) in the SYN packet. Looking at (2), decreasing mss
makes packets smaller, but increases the number of pack-
ets sent, for a net increase in Tmax. While it is already
well known [27] that transferring large (cid:2)les with a low mss
value can create denial of service conditions, the damage
is signi(cid:2)cantly ampli(cid:2)ed when coupled with the opt-ack
attack. As noted by Reed, the minimum mss is highly sys-
tem dependent with values varying from 1 to 128 for popu-
lar OSes. For example, Windows 2000 and Linux 2.4 have
a minimum mss of 88, whereas Windows NT4’s is 1. Reed
also noted that at extremely low values of mss, the server
can become CPU-bound because of high context switching
from (cid:2)elding too many interrupts.

In addition, RFC 1323 [15] de(cid:2)nes the wscale TCP op-
tion to increase maxwindow . The attacker can use the
wscale option to scale the congestion window by a fac-
tor of 214, increasing maxwindow to 65535 (cid:2) 214 or ap-
proximately 109 bytes. As shown in Table 1, the effect of
3Another typical value is mss=1460, but the effect on Tmax is mini-

mal

window scaling on Tmax is dramatic. Speci(cid:2)cally, a ma-
licious connection with mss=88 and wscale=14 can reach
a theoretical ampli(cid:2)cation factor of 32,085,228 or over 32
million. With this level of ampli(cid:2)cation, it is possible for
an attacker on a modem targeting many victims to induce
more traf(cid:2)c than the Slammer worm (Section 2.4).

3.2 Application Timeouts and Growing the

Congestion Window

Fortunately, there is a signi(cid:2)cant difference between the
theoretical and practical effects of the opt-ack attack. First,
there is a limit to the number of victims an attacker can
target at once. From Algorithm 1, the attacker needs to
connect to each victim, and retrieve the initial sequence
number (ISN) for each connection before sending the ap-
plication data request (Line 8), e.g., an http get or ftp (cid:2)le
request. Note that it is very dif(cid:2)cult for an attacker to learn
new ISNs while attacking other hosts, because its incom-
ing links are saturated. Thus, the attacker must connect to
the entire victim set, learn their ISNs, and then launch the
attack. However, if the attacker targets too many nodes, the
loop in Algorithm 1 at line 3 will take too long, and the (cid:2)rst
victim will timeout at the application level before receiv-
ing its data request. If victims timeout before the request is
sent, then the connection is dropped and the attack foiled.
Note that the minimum time for the attacker to complete a
TCP connection is the time to send the SYN packet and the
time to send the ACK packet (2 (cid:2) (40 + 14) = 108 bytes).
This assumes that the attacker ef(cid:2)ciently interleaves SYNs
and ACKs to multiple victims, such that each victim’s time
to respond with the SYN-ACK is not a limiting factor.
Then, using the minimum connection time and the appli-
cation timeout (ATO) value, we can calculate maximum
possible number of victims as follows:

max victims = ATO (cid:2)

(cid:12)
108

(3)

Realistic ATO values are highly application dependent,
and even within applications, the timeout value is tuned
to the speci(cid:2)c environment and workload. For example,
a survey among an arbitrarily chosen set of popular web-
sites showed ATO values for http ranged from 135 seconds

5

(www.google.com) down to 15 seconds (www.cnn.com).
As a further data point, the popular web server package
Apache has a default timeout of 300 seconds. However,
even with an ATO of 15 seconds, an attacker on a home
DSL line (128Kbps up-link, (cid:12) = 16000) can attack 2307
victims in parallel.

Another limitation is that it is not possible to create more
(cid:3)ooding than the sum of the victims’ up-links capacities.
A direct implication of (3) is that each victim must have
a minimum amount of bandwidth in order for an attack
to reach the rates described in Table 1. To calculate the
minimum bandwidth of each victim, we divide (2) by (3)
and produce:

maxwindow
ATO

(cid:2)

108
mss

+ 2

min victim bandwidth =

(cid:18)

(cid:19)
(4)
In other words, the same attacker on a home DSL line
also needs each of the 2307 victims to have bandwidth
in excess of 220MB/s in order to achieve 478.1GB/s in
(cid:3)ooding as described in Table 1 (ATO=15, mss = 88 ,
wscale = 14 ). Obviously, this is not immediately prac-
tical. However, if any victim is below the minimum band-
width from (4), the result is simply that the sender satu-
rates its outgoing link, which is suf(cid:2)ciently devastating to
the victim’s local network.

The last bound on the ampli(cid:2)cation is the time to grow
the congestion window. The attacker must send suf(cid:2)cient
number of ACKs to each victim in order to increase the
congestion window to from its initial value (one mss) to
its maximum value(maxwindow). By Algorithm 1, as the
number of victims increase, the time between ACKs sent to
an individual node diminishes. Thus, we can calculate the
minimum time required for the attack to reach maximum
effect:

min time =

54 (cid:2) maxwindow (cid:2) n
mss (cid:2) (cid:12)

(5)

The values in Table 1 are upper bounds on T and may in
fact never be achieved in practice. Other factors such as the
victims’ TCP send buffer size, outgoing bandwidth, and
processing capacity affect the rate at which traf(cid:2)c is pro-
duced (as discussed in Appendix A). In Section 5, we show
that our implementation achieves nearly 100% of Tmax in
simulation.

4 Defending against Opt-Ack

In this section, we present a simple framework for eval-
uating different defense mechanisms against the opt-ack
attack, and evaluate potential solutions within that frame-
work. Finally, we present one particular solution, ran-
domly skipping segments, that ef(cid:2)ciently and effectively

6

defends against opt-ack. We also describe an implementa-
tion of randomly skipped segments in detail.

4.1 Solutions Overview

Any mechanism that defends against opt-ack should mini-
mally possess the following qualities:

1. Easy to Deploy Due to the severity of the attack, any
solution should be practically and quickly deployable
in the global infrastructure. Minimally, the solution
should allow incremental deployment, i.e., unmodi-
(cid:2)ed clients should be able to communicate with mod-
i(cid:2)ed servers.

2. Ef(cid:2)cient Compliant (i.e., non-attacking) TCP streams
should suffer minimal penalty under the proposed so-
lution. Also, low power embedded network devices
do not have spare computational cycles or storage
space. Because the problem is endemic to all imple-
mentations, the solution needs to be ef(cid:2)cient on all
devices that implement TCP.

3. Robust Any (cid:2)x needs to defend against all variants

(Section 2.3) of the opt-ack attack.

4. Easy to Implement This is a more pragmatic goal,
leading from the observation that TCP and IP are per-
vasive, and run on an diverse range of devices. Any
change in the TCP speci(cid:2)cation would affect hun-
dreds (or thousands) of different implementations. As
such, a simpler solution is more likely to be imple-
mented.

In the rest of this section, we describe a number of pos-
sible defenses against opt-ack, and present a summary of
solutions in Table 2.

4.1.1 Secure Nonces

One possible solution is to require that the client prove
receipt of a segment by repeating an unguessable nonce.
Assume each outgoing segment contains a random nonce
which the corresponding ACK would have to return in or-
der to be valid. Savage [29] et al.
improve on this solu-
tion with cumulative nonces. In their system, the response
nonce is a function of all of the packets being acknowl-
edged, i.e., a cumulative response, ensuring that the client
actually received the packets it claims to acknowledge.

Unfortunately, cumulative nonces are not practically de-
ployable. They requires both the client and server to be
modi(cid:2)ed, preventing incremental deployment. If deploy-
ment was attempted, updated servers would be required
to maintain backward compatibility with non-nonce en-
abled clients, until all client software was updated. As a

result, updated servers would have to chose between be-
ing vulnerable to attack or compatibility with unmodi(cid:2)ed
clients. Additionally, nonces require additional processing
and storage for the sender. Calling a secure pseudo-random
generator once per packet could prove expensive for de-
vices with limited power and CPU resources, violating our
ef(cid:2)ciency goal.

To aid deployment, one could consider implement-
ing nonces in existing, unmodi(cid:2)ed clients via the TCP
timestamp option. The send could replace high order
bits of the timestamp with a random challenge, and any
non-malicious client which implemented TCP timestamps
If a client
would respond correctly with the challenge.
did not implement timestamps, the server could restrict
throughput to something small, e.g, 4Kb/s. While this im-
proves on the deployment of nonces, this solution still has
problems. First, it loses the critical cumulative ACK prop-
erty of Savage’s solution. That is, an acknowledgment for
a set of packets does not necessarily imply that all packets
in the set were received, which opens itself to the lazy opt-
ack attack. Second, as we discuss in Section 4.1.3 below,
bandwidth caps are not effective.

4.1.2 Require ACK Alignment

One aspect of TCP that makes the opt-ack attack possible is
the predictability of the ACK sequence. Furthermore, be-
cause communication is a stream, the client can in theory
acknowledge the bytes anywhere in the sequence, not just
along packet boundaries. Clark [11] cites the ability to re-
transmit one large packet when a number of smaller pack-
ets are lost as a main bene(cid:2)t of this. In practice, with large
buffers and client-side window scaling, most implemen-
tations send only packet-aligned acknowledgments. We
could use this insight to require clients to acknowledge
only along packet boundaries, and then add a small, un-
predictable amount of noise to the packet size. For exam-
ple, with equal probability, the server could send a packet
of size mss or of size (mss (cid:0) 1 ).
In this way, a client
that actually received the packet would get information
that a opt-ack attacker does not have:
the actual packet
size. Only a client that actually receives all of the pack-
ets could continue to correctly ACK them probabilistically
over time. The noise could be generated pseudo-randomly
as a function of the sequence, so storing per-outstanding-
packet state at the server could be avoided.

ACK alignment suffers from many of the same prob-
lems as non-cumulative secure nonces. Speci(cid:2)cally, it is
not secure against the lazy variant of opt-ack, and ACK
alignment could be expensive for low powered devices. In
addition, network devices, such as network address transla-
tion (NAT) box translating FTP or a (cid:2)rewall, could change
the size of or split the packet in (cid:3)ight. Any such change

in the packet size would result in false positives, which are
unacceptable.

4.1.3 Bandwidth Caps

The obvious solution to an attacker consuming too many
resources, as is the case with the opt-ack attack, is to limit
resource consumption. Conceivably, this could be done at
the server with a per IP address bandwidth cap, but unfor-
tunately this is not suf(cid:2)cient. First, any restriction on band-
width can simply be over come by increasing the number
of victims. Suppose for example, that each victim sets the
policy that no client can use more than a fraction c 2 (0; 1]
of their bandwidth. Then the attacker need simply increase
the number of victims by 1=c to maintain the same total
attack traf(cid:2)c. Further, bandwidth caps interfere with legit-
imately fast clients, violating our ef(cid:2)ciency goal.

4.1.4 Network Support

Since the opt-ack attack stream acts essentially as a non-
responsive (cid:3)ow, one possible defense would be to imple-
ment fair queuing or (cid:147)penalty boxes(cid:148) in the network. As
[12] notes, this is not a new problem, and there exists a
wealth of research on the subject [8, 13, 9, 10]. A simi-
lar solution would be force (cid:3)ows that cause congestion to
solve puzzles[32] in order to maintain their rate. However,
these solutions are not currently widely deployed and the
cost of doing so would seem prohibitive.

4.1.5 Disallow Out of Window ACKs

A straightforward solution is to change the TCP speci(cid:2)ca-
tion to disallow out of window ACKs. Recall from Section
2.2 that our implementation runs the risk overrunning the
victim. If a victim sent a reset, terminating the connection,
upon receipt of an out of window ACK, the opt-ack attack
would be mitigated. However, this is not a viable solution
as this opens non-malicious connections to a new DoS at-
tack. A malicious third party could inject a forged out of
window ACK into a connection, causing a reset [33]. Be-
cause the ACK is out of window, there would be no need
to guess the sequence space. Also, compliant receivers
can send out of window acknowledgments due to delays or
packet reordering. For example, suppose ACKs for pack-
ets numbered 2 and 3 are sent but received in reverse order.
The ACK for packet 3 would advance the window, and then
the ACK for packet 2 would be and out of window ACK,
causing a RST.

4.1.6 Random Pauses

As described in Section 2.2, the main dif(cid:2)culty in the im-
plementation was to keep the attacker’s sequence numbers
synchronized with what the server was sending. Thus, one

7

Solution
Cumulative Secure Nonces
Secure Nonces w/ timestamps
ACK Alignment
Bandwidth Caps
Network Support
Random Pauses
Skipped Segments

Ef(cid:2)cient Robust Deployable

Simple Change TCP Spec.

yes
yes
yes
no
yes
no
yes

yes
no
no
no
yes
no
yes

no
yes
yes
yes
no
yes
yes

yes
yes
yes
yes
no
yes
yes

client & server
server only
server only
no
no
server only
server only

Table 2: Summary of Defenses to Opt-Ack Attack

way of thwarting the attacker would be for the server to
randomly pause. A client correctly implementing the pro-
tocol will reciprocate by pausing with the server and wait-
ing for more data. On the other hand, an attacker will con-
tinuously send ACKs for packets not yet sent, exposing
the attack. This solution does not prevent against the lazy
variant of the opt-ack attack. Also, if the server applied
this pausing test too often, performance could suffer sig-
ni(cid:2)cantly. Our (cid:2)nal proposed solution expands on the ran-
dom pausing idea with additional robustness and minimal
performance penalty.

4.2

Proposed Solution: Randomly Skipped
Segments

The main problem with the random pause solution is the ef-
(cid:2)ciency penalty to non-malicious clients. Instead of paus-
ing, we propose the server skip sending the current seg-
ment, and instead send the rest of the current window. Note
that this is equivalent to locally, intentionally dropping the
packet. A client that actually gets all of the packets, save
the skipped one, will start re-ACKing for the lost packet,
thereby invoking the fast retransmit algorithm. However,
an attacker, because it does not have a global view of the
network, cannot tell where along the path a given packet
was dropped, so it cannot tell the difference between an
intentionally dropped packet and a packet dropped in the
network by congestion. Thus, an attacker will ACK the
skipped packet, alerting the server to the attack. Note
that usually fast retransmission indicates network conges-
tion, so the congestion window is correspondingly halved.
However in this case, retransmission was not invoked due
to congestion in the network, so the sender should not
halve the congestion window/slow start threshold as it typ-
ically would. Given that most modern TCP stacks imple-
ment selective acknowledgments (SACK)[21], this solu-
tion is signi(cid:2)cantly more ef(cid:2)cient than randomly pausing
(see Section 5 for performance). The only penalty applied
to a conforming client is a single round trip time in delay.
To determine how often to apply the skipped packet test,
we maintain a counter of ACKs received. Once a threshold
number of ACKs are received, the skip test is applied. It

is important that the threshold be randomized, as the se-
curity of this system requires that the attack not predict
which segment was be skipped. However, there is an obvi-
ous trade off in where to make the skipped packet thresh-
old. If it is too low, the server will lose ef(cid:2)ciency from
skipping packets too often. Setting the threshold too high
allows the attacker to do more damage before being caught
(see Section 5 for an exploration of this trade-off). Our so-
lution is to chose the threshold uniformly at random over a
con(cid:2)gurable range of values.

This simple skipped segment solution meets all of our
goals.
It is ef(cid:2)cient: compliant clients suffer only one
round trip time in delay, the computational costs consist
of keeping only an extra counter, and the storage costs
are trivial (5 bytes per connection, described below). The
skipped packet solution is robust against the variations of
the attack described in Section 2.3, because it inherently
checks whether a client actually received the packets. This
solution is a local computation, so it needs no additional
coordination or infrastructure, i.e., the deployment require-
ments are met. Best of all, it is transparent to unmodi(cid:2)ed
clients, allowing for incremental deployment.

4.3 Skipped Packet Implementation

We implemented the skipped packet solution for the Linux
2.4.24 kernel. The total patch is under 200 lines (including
comments, prototypes, and headers), and was developed
and tested in under one week’s time by someone previously
unfamiliar with the Linux kernel. We add two entries to
the per connection state (struct tcp opt): opt ack mode (1
byte) and opt ack data (4 bytes). Further, we add 3 global
sysctl tcp opt ack enabled ,
con(cid:2)guration variables:
sysctl tcp opt ack min, and sysctl tcp opt ack max .
When a new connection is created, opt ack mode
initialized to OPT ACK MODE COUNTDOWN ,
is
and opt ack data is
to a number uniformly
set
sysctl tcp opt ack min
at
and
random between
sysctl tcp opt ack max ,
inclusive. With each suc-
cessful ACK, opt ack data is decremented, until
it
reaches zero. Upon opt ack data reaching zero, we set
opt ack mode to OPT ACK MODE SKIP, update the

8

send head pointer to the next block (skipping the segment),
and save the sequence number of the segment skipped into
opt ack data. A compliant client will ACK the beginning
of the hole (i.e. the sequence in opt ack data), where a
malicious attacker will ACK a segment past the hole. If
the client ACKs a segment before the hole, we leave the
test in place until another ACK arrives. If the client ACKs
past the hole, it fails the test: we reset the connection
In implementation,
and log a message to the console.
we use parameters sysctl tcp opt ack min = 100 and
sysctl tcp opt ack max = 200, as suggested by our
evaluations in Section 5.3. Last, under Linux, the retrans-
mission code automatically handles resending the skipped
segment for clients that correctly ACK the beginning of
the hole.

The description of the (cid:2)x is complete, except for a few
additional details. If a timeout occurs in the middle of the
skip test, we need to reset the threshold countdown, and go
back to mode OPT ACK MODE COUNTDOWN . The
reasoning is this: if the segment before the hole is lost, and
there are no segments after the hole (or they are all lost),
then the client will not ACK the beginning of the hole, until
after the retransmit. However when a timeout occurs, the
retransmit code might resend the skipped segment, negat-
ing the test. Resetting the threshold counter and changing
the mode in this obscure case solves this problem.

Also, to insure that the randomly skipped segments so-
lution does not introduce a new DoS attack, we must ig-
nore out of window ACKs during the skipped segments
test. Otherwise, it might be possible for a malicious node
to convince a server that a benevolent client was perform-
ing an opt-ackattack.

l

)
e
a
c
s

g
o
l
(

s
/
s
e
t
y
B

 1e+10

 1e+09

 1e+08

 1e+07

256 Victims

128 Victims

512 Victims

64 Victims

32 Victims

16 Victims

8 Victims

4 Victims

2 Victims

1 Victim

 0  10  20  30  40  50  60  70  80  90  100

Seconds

Figure 2: Maximum Traf(cid:2)c Induced Over Time; Attacker
on T1 with mss=1460,wscale=4

d
n
o
c
e
s
/
s
e
t
y
B

 6e+09

 5e+09

 4e+09

mss=1460,wscale=4

 3e+09

 2e+09

 1e+09

 0

 1

mss=88,wscale=0

mss=1460
wscale=0

 10

 100

 1000

 10000

Number of Victims

Figure 3: Maximum Traf(cid:2)c Induced By Number of Vic-
tims; Attacker on T1

5 Attack Evaluation

We evaluate the feasibility and effectiveness of the opt-ack
attack in a series of simulated, local area, and wide area
network experiments. In the (cid:2)rst set of simulations, we
determine the total amount of traf(cid:2)c induced by the opt-
ack attacks. Next, we determine the effect of the attack
on other (honest) clients trying to access the victim. We
also present results for the amount of traf(cid:2)c (described in
Section 3) our real world implementation actually achieves
across a variety of platforms and across different (cid:2)le sizes.
Finally, in Section 5.3, we evaluate the ef(cid:2)ciency of our
skipped segment solution.

5.1 Simulation Results

We have implemented the opt-ack attack in the popular
packet level simulator ns2 and simulate the amount of traf-
(cid:2)c induced in various attack con(cid:2)gurations. In each ex-
periment, there is a single attacker and multiple victims

connected in a star topology. Each victim has a link capac-
ity of 100Mb/s, and all links have 10ms latency (the choice
of delay is arbitrary because it does not affect the attack).
We vary the number of victims, and the mss and wscale of
the connection. The attacker makes a TCP connection to
each victim in turn, and only sends acknowledgments once
all victims have been contacted. Victims are running the
(cid:147)Application/FTP(cid:148) agent, which uses an in(cid:2)nite stream of
data.

In Figure 2, we show the sum of the attack traf(cid:2)c
generated over time with variable numbers of victims.
In this experiment, the attacker is on a T1 (1.544Mbs)
and uses connection parameters mss=1460 and wscale=4
(maxwindow =1048576). When the number of victims is
less than 512, the amount of (cid:3)ooding is limited by the sum
of the bandwidths of the victims, as predicted by Equation
4 in Section 3. The amount of traf(cid:2)c doubles as the num-
ber of victims double until 512 victims. The number of
victim’s increases, the attack takes longer to achieve full
effect as predicted by Equation 5. The case with 512 vic-

9

 4e+06

 3.5e+06

mss=88,wscale=0

d
n
o
c
e
s
/
s
t
e
k
c
a
P

 3e+06

 2.5e+06

 2e+06

 1.5e+06

 1e+06

 500000

 0

 1

mss=1460,
wscale=4

5.2.1 Single Victim DoS Effect - Lan and Wan

Experiment Average (sec)
No Attack
LAN Attack
WAN Attack

89.11
1552.03
779.93

Dev.
0.007
141.76
139.32

Increase
1
17.42
8.75

mss=1460,wscale=0

Figure 5: Average Times with Deviations for a Non-malicious
Client to Download a 100MB File

 10

 100

 1000

 10000

Number of Victims

Client

Figure 4: Maximum Packets Induced By Number of Vic-
tims; Attacker on T1

tims took 73 seconds to reach it peak attack rate, while all
others did so in under 30 seconds. At 512 victims, the sim-
ulation achieves 99.9% of the traf(cid:2)c predicted by Equation
2.

As shown in Figure 2, once the attack’s maximum effect
is reached, it can be sustained inde(cid:2)nitely. In Figure 3 and
Figure 4, we show the maximum traf(cid:2)c induced as we vary
the number of victims, mss and wscale for bytes/second
and packets/second respectively. As predicted by Section
3, attackers with a lower mss produce more traf(cid:2)c than one
with a higher value. Likewise, an increased wscale has a
dramatic increase in the total traf(cid:2)c generated.

Due to CPU and disk space limits, we were not able
to simulate more than 512 victims for all parameters, or
wscale values above 4, despite the fact that our simula-
tion machine was a dual processor 2.4Ghz Athlon-64 with
16GB ram and 300GB in disk.

5.2 Real World Implementation

In order to validate the attack, we implemented it C and
experimented on real machines in a number of network
settings. We measure the effect of the attack on a single
victim and the actual bandwidth generated from a single
victim running various popular operating systems.

It should be noted that we did not experiment with
multiple attackers or multiple victims due to real world
limitations of our test bed. Our experiments with a sin-
gle attacker and single victim were suf(cid:2)cient to cause
It would
overwhelming traf(cid:2)c on our local networks.
be irresponsible and potentially illegal
to have tested
the distributed attack on a wide-area test bed (e.g.,
PlanetLab[25]), and even our simple one attacker-one vic-
tim wide-area experiments caused network operators to
block our experiments.4

100Mb/s

Server

Switch

10Mb/s

Amplified
Data Stream

10Mb/s

LAN
Attacker

WAN
Attacker

128Kb/s

Internet

Figure 6: Topology for Experiments

This experiment measured the effect on a third party
client’s ef(cid:2)ciency in downloading a 100MB (cid:2)le from a sin-
gle victim during various attack conditions. We repeated
this experiment with no attacker, with an attacker on the
local area network, and with an attacker across the Internet
(see Figure 6). The local area attacker was a dual pro-
cessor Pentium III running Linux with a 10Mb Ethernet
card, while the WAN attacker was a 100Mhz Pentium run-
ning GNU/Linux on an asymmetric 608/128 Kb/s down-
stream/upstream residential DSL line. The latency on the
WAN link varied over time, with a average RTT of 13.5ms.
A typical web server runs on a fast local area network,
which connects to a slower wide area network. In order
to emulate this bottleneck, and also to safeguard against
saturation of our production Internet connection, we con-
nected our test web server to the world via a 10Mb con-
nection on a Cisco Catalyst 3550 switch. Furthermore,
both LAN and WAN attackers were con(cid:2)gured to use
TargetBandwidth of 109 bytes/second, and (cid:12) = 16000
bytes/s as their local bandwidth setting (see Appendix A
for description). The intuition is that the LAN and WAN
attackers should be equally capable with respect to their
available bandwidth, but the WAN attacker must compen-
sate for more end-to-end jitter and delay. Each run used
mss=536 and wscale=0, i.e., typical values for Internet
connections. Each experiment was repeated 10 times and
the values averaged. The numbers were measured with a

4Incoming traf(cid:2)c to one author’s home DSL IP address was temporar-
ily blocked as a result of these experiments. This did not serve to stop the

attack, as the outbound ACKs could still be sent. However, this served as
evidence that we should cease the experiment.

10

command line web client (similar to wget) specially in-
strumented to measure bandwidth at 10 ms intervals. We
present the results from these experiments in Table 5. The
(cid:147)Increase(cid:148) column refers to the increase in time relative to
the (cid:147)No Attack(cid:148) baseline.

The effect of the attack is signi(cid:2)cant. The 100MB (cid:2)le
takes on average 17.42 and 8.75 times longer to download
under LAN and WAN attack, respectively. We believe that
the time difference between the WAN and LAN attacks is
due to the increased jitter of the wide area Internet, and the
increased standard deviation in the results supports this.
This variability makes keeping synchronizing with the vic-
tim more dif(cid:2)cult due to the buffered ACK problem, as de-
scribed in Appendix A. However, more advanced attackers
could target more victims (Section 2.2) or potentially em-
ploy more sophisticated segment prediction to increase the
effectiveness of the attack.

We also re-ran the same set of experiments with a set
of hubs in place of the switch, effectively removing queu-
ing from the system. The times to download the 100MB
(cid:2)le while under attack were reduced to 5 times and 4.5
times the baseline for LAN and WAN attackers, respec-
tively.
In other words, having queuing on the bottle-
neck link signi(cid:2)cantly increased the damage from the at-
tack. We surmise this is because the opt-ack attacker used
mss = 536 and the non-malicious client, since it was on
local Ethernet, used mss = 1448. Once the queue was
full, the switch could service two of the attack packets be-
fore there was room for a legitimate (i.e. destined to the
non-malicious client) packet. Effectively, the higher rate
of smaller packets caused the switch to drop more non-
malicious/legitimate packets. Removing the queue from
the system reduced the amount of dropped legitimate pack-
ets, therefore increasing non-malicious throughput.

5.2.2 Ampli(cid:2)cation Factors

To evaluate the potential effectiveness of the distributed
opt-ack attack, we measure the amount of traf(cid:2)c that our
implementation code can induce in a single victim. In this
experiment, we use the LAN attacker, as above, to attack
various operating systems including GNU/Linux 2.4.24,
Solaris 5.8, Mac OS X 10.2.8, and Windows XP with ser-
vice pack 1. For this experiment, instead of a web server,
each victim ran a program that streamed data from mem-
ory. This was done to remove any potential application-
level bottlenecks from the experiment. As above, the at-
tacker used parameters (cid:12) = 16000, mss = 536, and
wscale = 0. We measured the bandwidth in one second
intervals using a custom tool written with the libpcap li-
brary. Each experiment in Table 3 was run 10 times, av-
eraged, and is shown as an ampli(cid:2)cation factor of the at-
tacker’s used local bandwidth.

11

OS
Linux 2.4.24
Mac OSX
Solaris 5.8
Windows XP

Avg. KB/s
3931.93
806.2
3150.6
640.62

Dev.
1102.38
258.1
1301.1
378.85

Ampli(cid:2)cation
251.6
51.6
201.6
41.0

Table 3: Average bytes/s of Induced Flooding, Stan-
dard Deviation, and Ampli(cid:2)cation Factor of Attacker’s
Bandwidth
File Size
No Attack
100MB File
10 MB File
1 MB File
512 KB File

Factor Increase
1
17.42
3.15
1.75
1.20

Time(s)
89.11
1552.03
281.00
152.87
106.63

Dev.
0.007
141.76
9.81
21.48
9.03

Table 4: Average Times for Client to Download a
100MB File, With Attacker Downloading Various-
Sized Files

We believe that the variation in amount of (cid:3)ooding by
OS is due to the lack of sophistication of our attack im-
plementation. The ampli(cid:2)cation factor for Linux is 251.6
times the used bandwidth, which translates to 251:6=1336
or approximately 18% of the theoretical maximum traf(cid:2)c,
Tmax. This low number is in part because the implemen-
tation sends four ACKs per window (as described in Ap-
pendix A), which alone limits the attack to 25% of Tmax.

5.2.3 Smaller Files

In the (cid:2)rst set of experiments, we assumed the victim
served a 100MB (cid:2)le for the attacker to download. While
there are (cid:2)les of this size and larger on the web (Windows
XP service pack 2 is 272MB and heavily replicated), we
repeated the experiment with smaller (cid:2)le sizes. The test
bed is exactly as above (Figure 6) with the LAN attacker
and queuing. Again, the non-malicious client downloaded
a 100MB (cid:2)le from the victim. In this experiment, we vary
the size of the (cid:2)le the attacker downloads. The results are
presented in Table 4. As expected, smaller (cid:2)les are less
useful for the attacker. However, even 10MB (cid:2)les cause
the client to slow down by a factor of 3.15, so smaller (cid:2)les
can still cause some damage.

Clearly, these results depend upon the attack implemen-
tation described in Appendix A, and there are inef(cid:2)ciencies
in our implementation that can be improved upon. For ex-
ample, the implementation code creates a new TCP stream
each time a download is complete, and starts again in a
loop. An easy optimization would have been to take ad-
vantage of HTTP’s persistent connections and download
multiple (cid:2)les on the same stream. However, the results
presented here are suf(cid:2)ciently motivating. As above, each

Experiment
Un(cid:2)xed
Fixed: 10-20
Fixed: 1-200
Fixed: 100-200

Time(s) Deviation
89.136
89.623
89.158
89.167

0.007
0.980
0.0234
0.0256

%
100%
99.457%
99.975 %
99.965 %

Table 5: Time to Download a 100MB File for Various
Fix Options - SACK Enabled

Experiment
Un(cid:2)xed
Fixed: 1-200
Fixed: 100-200

Time(s) Deviation
89.143
90.048
89.145

0.0152
0.3960
0.0111

%
100%
98.994%
99.998%

Table 6: Time to Download 100MB File for Various
Fix Options - SACK Disabled

data point represents the average of 10 experiments. The
(cid:147)Factor Increase(cid:148) column refers to the increase relative to
the (cid:147)No Attack(cid:148) baseline in Figure 5.

5.3 Performance of Skipped Segments Solu-

tion

In the (cid:2)nal experiment, we evaluate the ef(cid:2)ciency of our
proposed randomly skipped segments solution. Speci(cid:2)-
cally, we measure the time for a non-malicious client on
the LAN to download a 100MB (cid:2)le from the server with
and without the (cid:2)x, with and without selective acknowl-
egement (SACK) enabled on the client, and with various
threshold values for the (cid:2)x. The download times were mea-
sured with the UNIX time utility. Each experiment was run
ten times, the results were averaged, and they are presented
in Tables 5 and 6, with and without SACK respectively.
The two numbers in the (cid:2)rst column of each table refer to
the threshold values used for sysctl tcp opt ack min and
sysctl tcp opt ack max in each experiment.

The results show that the performance hit from the
proposed (cid:2)x is negligible for most parameters. Even
when we chose the threshold to be intentionally inef(cid:2)-
cient, i.e., skipping a segment every 10 to 20 ACKs, the
(cid:2)x maintained 99.457% ef(cid:2)cency. We found that vary-
ing sysctl tcp opt ack min value had little effect when
combined with SACK, but made a 1% difference without
SACK. We believe the loss from skipping segments every
100-200 ACKs, i.e., less than 0.1% with or with SACK, is
an acceptable price for defeating this attack.

more ef(cid:2)cient attacks.

6.1 Brute Force DoS Attacks

The salient feature of brute force attacks is the fact that it is
incumbent upon the attackers to provide the resource that
ultimately overloads the victim. Example attacks include
bandwidth (cid:3)ooding, connection (cid:3)ooding, and Syn (cid:3)ood-
ing. The commonality among these attacks is that the at-
tackers must be capable of draining more of a precious re-
source, be it bandwidth, (cid:2)le descriptors, or memory, than
the victim’s capacity. One possible defense against these
attacks is to obtain more of the resource, i.e. buy more
memory or lease more bandwidth.

The danger of the opt-ack attack is that the victim’s own
resources are being turned against them. If the victim adds
more bandwidth capacity, then the attacker can then use
the additional bandwidth to generate more traf(cid:2)c. While
there is a bound, Tmax, to the traf(cid:2)c the attacker can in-
duce (see Section 3), the victim is not necessarily safe if
it secures more than Tmax in capacity. Increasing the vic-
tim’s local capacity pushes the bottleneck link further into
the network, injecting more traf(cid:2)c into the Internet back-
bone.

6.2 Ef(cid:2)cient Attacks

We refer to ef(cid:2)cient attacks as those that require little re-
sources from the attacker but result in victims introducing
large amounts of resources to the network, essentially per-
forming their attack for them.

6.2.1 Smurf Attack

A smurf attack [3] consists of forging a ping packet from
the victim to the broadcast address of a large network. In
this way, a single packet is ampli(cid:2)ed by the size of the
network, and redirected at the victim. A variant of this
attack is to forge the ping from the broadcast address of
the victim, forcing the victim’s switches to do more work
in duplicating the packet.

The ampli(cid:2)cation aspects of this attack are similar to
the opt-ack attack. However, the attack signature of smurf
makes it easy to detect and defend against: simply block
traf(cid:2)c from a broadcast address or rate limit ICMP ECHO
traf(cid:2)c at the border router.
In contrast, opt-ack is not
known to have an obvious attack signature, and most site
policies would not allow blocking TCP traf(cid:2)c.

6 Related Work

There is a long history of denial of service attacks against
TCP, which we divide broadly into brute force attacks and

6.2.2 Shrew Attack

The attack most similar to opt-ack is the Shrew [16] at-
tack, in that it also attempts to exploit of TCP congestion
control. In Shrew, an attacker sends traf(cid:2)c directly to the

12

receiver/victim in short bursts, trying to force a retransmis-
sion due to packet loss. If the bursts are timed correctly,
the sender’s RTO period can be abused such that each re-
transmission coincides with another burst, and thus a DoS
condition is created. Analysis shows that a simple square
wave pattern of bursts forces the sender’s RTO period to
synchronize with the bursts. Further, the bursts can be suf-
(cid:2)ciently infrequent such that the average rate would not
alert a potential intrusion detection system.

Despite these similarities, the two attacks are quite dif-
ferent. In Shrew, it is the receiver who is attacked directly,
where with opt-ack, it is the sender who is attacked which
indirectly impacts all receivers. Also, Shrew assumes that
the attacker has enough bandwidth to directly force packet
loss. This is reasonable when the path from the attacker
to the receiver includes the bottleneck link from sender to
receiver, but this not always the case. In contrast, opt-ack
makes no such assumptions. With opt-ack, it is the sender’s
(cid:2)rst-hop link that is saturated, which thereby becomes the
bottleneck for all connections (assuming a single homed
sender). Further, even a relatively weak opt-ack adversary,
such as an attacker on a modem, presents a serious threat
to a comparatively high bandwidth server.

Also, it seems that the main advantage of the Shrew at-
tack is that the average attack traf(cid:2)c rate is low. However,
if the attack became popular, it seems intuitive that intru-
sion detection systems could easily adapt by examining the
maximum traf(cid:2)c rate in addition to the average traf(cid:2)c.

Lastly, as we note in Section 5, elements of the two at-
tacks can be combined. An intelligent opt-ack attacker can
vary the rate of ACKs sent to cause the return stream to
regularly burst like the Shrew attack. Using this method, it
is apparent that more damage can be generated.

6.2.3 Misbehaving Receivers

As previously mentioned, Savage et al.[29] discovered the
opt-ack attack as a method for misbehaving receivers to
get better end-to-end performance. While they suggest that
opt-ack can be used for denial of service, they did not in-
vestigate the magnitude of the ampli(cid:2)cation the attack can
achieve. As a result, their cumulative nonce solution to the
opt-ack attack does not consider global deployment as a
goal. In this work, through analysis and implementation,
we have shown that opt-ack is a serious threat. Further, we
have engineered an ef(cid:2)cient solution that does not require
client-side modi(cid:2)cation, and thus is more readily deploy-
able.

6.2.4 Re(cid:3)ector Attacks

In [24], Paxson discusses a number of attacks where the
initiator can obscure its identity by (cid:147)re(cid:3)ecting(cid:148) the attack
off non-malicious third parties. As a general solution, Pax-

son suggests upstream (cid:2)ltering based on the attack signa-
ture with the assumption that it is not possible to over-
whelm the upstream (cid:2)lter with useless data. The work
speci(cid:2)cally mentions that if the attacker is able to guess
the ISN of the third party, it is possible to mount a blind
opt-ack attack against an arbitrary victim. No analysis is
made of the amount of the ampli(cid:2)cation from the opt-ack
attack, nor is it immediately clear what (cid:2)lter rules could be
applied to arbitrary TCP data.

7 Discussion and Conclusion

We have described an analysis of the opt-ack attack on TCP
and demonstrated that ampli(cid:2)cation from the attack makes
it dangerous. We have also engineered an ef(cid:2)cient skipped
segments defense against attacks of this type that allows
for incremental deployment. The opt-ack attack succeeds
because it violates an underlying assumption made by the
designers of TCP: that peers on the network will provide
correct feedback. This assumption holds when clients are
interested in receiving data, since false feedback will usu-
ally lead to worse end-to-end performance. However, the
opt-ack attack shows that if malicious nodes do not care
about data transfer integrity, they can cause widespread
damage to other clients and to the stability of the network.
Since opt-ack violates an underlying assumption upon
which TCP is based, we believe a proper solution for the
opt-ack attack involves changing the TCP speci(cid:2)cation.
Although new features can be added to TCP (e.g., cumula-
tive nonces) to ensure the receiver TCP is in fact receiving
all of the segments, this type of solution is dif(cid:2)cult to de-
ploy because it requires client modi(cid:2)cation. The skipped
segment solution presented here requires modi(cid:2)cation of
only high capacity servers, and is thus more readily de-
ployable. In this paper, we have described different mech-
anisms that can be used to defend against opt-ack attacks.
We recommend a speci(cid:2)c change to the TCP speci(cid:2)cation
that we have shown to be easy to implement, ef(cid:2)cient for
fast connections, and which does not burden resource-poor
hosts.

References

[1] Gnutella Home Page. See http://gnutella.

wego.com.

[2] See www.kazaa.com.

[3] Smurf Attack: See http://www.cert.org/

advisories/CA-1998-01.html.

[4] RFC793: Transmitions Control Protocol, September

1981.

13

[5] http://www.akamai.com/en/html/

technology/overview.html.

[19] M. Lichtenberg and J. Curless. DECnet Transport
Architecture. Digital Technical Journal, 4(1), 1992.

[6] T. H. P. R. Alliance. Know your enemy: Track-
http://www.honeynet.org/

ing botnets.
papers/bots/.

[7] M. Allman and V. Paxson. On Estimating End-to-
End Network Path Properties. pages 263(cid:150)274. SIG-
COMM, 1999.

[8] B. Braden, D. Clark, and S. Shenker. Rfc1633: In-
tegrated Services in the Internet Architecture: an
Overview.

[9] W. chang Feng, D. Kandlur, D. Saha, and K. Shin.
BLUE: A New Class of Active Queue Management
Algorithms. Technical Report CSE-TR-387-99, 15,
1999.

[10] W. chang Feng, D. Kandlur, D. Saha, and K. Shin.
Stochastic Fair Blue: A Queue Management Algo-
rithm for Enforcing Fairness. pages 1520(cid:150)1529. IN-
FOCOM, 2001.

[11] D. D. Clark. The Design Philosophy of the DARPA
Internet Protocols. pages 106(cid:150)114, Stanford, CA,
Aug. 1988. SIGCOMM.

[12] S. Floyd and K. Fall. Promoting the Use of End-to-
End Congestion Control in the Internet. IEEE/ACM
Transactions on Networking, 7(4):458(cid:150)472, 1999.

[13] S. Floyd and V. Jacobson. Random Early Detection
IEEE/ACM

Gateways for Congestion Avoidance.
Transactions on Networking, 1(4):397(cid:150)413, 1993.

[14] V. Jacobson. Congestion Avoidance and Control.
ACM Computer Communication Review; Proceed-
ings of the Sigcomm ’88 Symposium in Stanford, CA,
August, 1988, 18, 4:314(cid:150)329, 1988.

[15] V. Jacobson, B. Braden, and D. Borman. RFC 1323:

TCP Extensions for High Performance, May 1992.

[16] A. Kuzmanovic and E. Knightly. Low-Rate TCP-
volume 33,

Targeted Denial of Service Attacks.
pages 75(cid:150)86. SIGCOMM, October 2003.

[17] N. Leibowitz, M. Ripeaunu, and A. Wierzbicki. De-
constructing the kazaa network. In 3rd IEEE Work-
shop on Internet Application. IEEE, 2003.

[18] J. Liang, R. Kumar, and K. W. Ross.
A Measurement

KaZaA Overlay:
http://cis.poly.edu/(cid:152)ross/papers/
KazaaOverlay.pdf.

The
Study.

[20] http://www.limewire.com/english/

content/netsize.shtml.

[21] M. Mathis, J. Mahdavi, S. Floyd, and A. Ramanov.
RFC2018: TCP Selective Acknowledgment Options,
October 1996.

[22] D. Moore, V. Paxson, S. Savage, C. Shannon,
Inside the Slam-
See http://www.caida.org/

S. Staniford, and N. Weaver.
mer Worm.
outreach/papers/2003/sapphire2/.

[23] Nanog email: Dos?

http://www.merit.

edu/mail.archives/nanog/2003-01/
msg00594.html.

[24] V. Paxson. An Analysis of Using Re(cid:3)ectors for Dis-
tributed Denial-of-service attacks. ACM Computer
Communications Review (CCR), 31(3), July 2001.

[25] Planet lab. http://www.planet-lab.org.

[26] K. Ramakrishnan, S. Floyd, and D. Black. RFC3168:
The Addition of Explicit Congestion Noti(cid:2)cation
(ECN) to IP.

[27] D. Reed. (cid:148)Small TCP Packets == very large over-
head == DoS?(cid:148), July 2001. See http://www.
securityfocus.com/archive/1/195457.

[28] S. Saroiu, K. Gummadi, and S. Gribble. Measur-
ing and Analyzing the Characteristics of Naptster and
Gnutella Hosts. volume 9, pages 170(cid:150)184. Multime-
dia Systems, Springer-Verlag, 2003.

[29] S. Savage, N. Cardwell, D. Wetherall, and T. Ander-
son. TCP Congestion Control with a Misbehaving
Receiver. Computer Communication Review, 29(5),
1999.

[30] S. Staniford, V. Paxson, and N. Weaver. How to 0wn
the Internet in Your Spare Time. USENIX Security
Symposium, 2002.

[31] W. R. Stevens. RFC2001: TCP Slow Start, Conges-
tion Avoidance, Fast Retransmit, and Fast Recovery
Algorithms, January 1997.

[32] X. Wang and M. K. Reiter. Mitigating bandwidth-
exhaustion attacks using congestion puzzles. In CCS
’04: Proceedings of the 11th ACM conference on
Computer and communications security, pages 257(cid:150)
267, New York, NY, USA, 2004. ACM Press.

[33] P. Watson.

Slipping In The Window: TCP Re-
See http://www.osvdb.org/
set Attacks.
reference/SlippingInTheWindow_v1.0.
doc.

14

Attacker Overrun

Slow

Start

A Implementing Opt-Ack

In this section, we describe an actual implementation of
opt-ack against TCP. There are three reasons we chose to
implement the attack in addition to simulating it. First, it
was clear that the opt-ack attack worked in theory, but we
wanted to demonstrate that it was feasible in practice. Sec-
ond, the implementation would allow us to test against de-
ployed networks and gauge the effectiveness of the attack
against real-world systems. Third, and most importantly,
we hoped that in implementing the real attack, we would
gather suf(cid:2)cient insight to design a viable solution. In the
rest of the section, we describe our experience with imple-
menting opt-ack, and highlight speci(cid:2)c challenges present
in real-world systems that we had to account for.

r
e
b
m
u
N
e
c
n
e
u
q
e
S

 4e+07

 3.5e+07

 3e+07

 2.5e+07

 2e+07

 1.5e+07

 1e+07

 5e+06

 0

 0

Attacker and Victim Sequence Space Over Time

Victim’s Segments
Attacker’s Acks

Attacker Overrun

Slow
Start

Artifact 2

Artifact 1

In Sync

 5

 10

 15

 20

Time (sec)

Figure 7: Attacker and Victim Sequence Space, Mea-
sured at Victim

Attacker and Victim Slow Start

Victim’s Segments
Attacker’s Acks

Start

Congestion Control

Transition Phase

r
e
b
m
u
N
e
c
n
e
u
q
e
S

 250000

 200000

 150000

 100000

 50000

 0

 0  0.05  0.1  0.15  0.2  0.25  0.3  0.35  0.4  0.45  0.5

Time (sec)

Figure 8: Detail: Attacker and Victim Slow Start

A.1 Recovery from Overruns

Compliant TCP streams are supposed to generate an empty
segment upon receipt of an out of window ACK (Sec-
tion 2.2). The attacker could use this empty segment
to detect overruns, but the durring the attack incoming

15

r
e
b
m
u
N
e
c
n
e
u
q
e
S

 5.85e+06

 5.8e+06

 5.75e+06

 5.7e+06

 5.65e+06

 5.6e+06

 5.55e+06

 5.5e+06

Attacker and Victim Sequence Space Over Time

Victim’s Segments
Attacker’s Acks

 6  6.01 6.02 6.03 6.04 6.05 6.06 6.07 6.08 6.09  6.1

Time (sec)

Figure 9: Detail: Attacker and Victim Synchronized

Buffered ACK Problem

Victim’s Segments
Attacker’s Acks

r
e
b
m
u
N
e
c
n
e
u
q
e
S

 2.65e+07

 2.64e+07

 2.63e+07

 2.62e+07

 2.61e+07

 2.6e+07

 2.59e+07

 2.58e+07

 2.57e+07

 11.96  11.98  12  12.02  12.04  12.06  12.08  12.1

Time (sec)

Figure 10: Artifact 1: Buffered ACKs

link is typically saturated, so the empty segment will be
dropped. Additionally, Linux ignores an out of window
ACK, times out on previous unACK’ed packets, and re-
transmits them. Other OSes, speci(cid:2)cally MacOS X 10.2
and Windows 2000, correctly generate the empty packet.
However, while a stream is making progress, the sequence
numbers of packets received increase monotonically (bar-
ring packet reordering). Upon a retransmission, or when
an empty packet is received, the sequence number is less
than or equal to the previous packet, breaking monotonic-
ity. So, by monitoring the sequence numbers of packets ac-
tually received, the attacker can detect overruns when the
sequence numbers no longer increase. When an overrun
is detected, the attacker can resume slow start on the last
received packet. This is an expensive process, as it poten-
tially requires waiting on the order of at least one second
[7] for the server to timeout.

Figure 7 shows the life cycle of an attack against a
GNU/Linux 2.4.20 victim, across a wide area network, as
measured at the victim. The (cid:147)attacker(cid:148) data points show
the ACKs at the time the victim received them, and the
(cid:147)victim(cid:148) data points show the segments being sent by the
victim. Note that for the majority of the time the two

Artifact 2

Artifact 1

Attacker and Victim Sequence Numbers Over Time

Victim’s Segments
Attacker’s Acks

 2.97e+07

 2.96e+07

 2.95e+07

 2.94e+07

 2.93e+07

 2.92e+07

r
e
b
m
u
N
e
c
n
e
u
q
e
S

 2.91e+07

 14.4

 14.44

 14.48

 14.52

 14.56

 14.6

Time (sec)

Figure 11: Artifact 2: Victim Delay and Buffered
ACKs

lines are indistinguishable, i.e. the attacker is synchronized
with the victim (Figure 9). However, on three occasions
the attacker overruns the victim’s sequence number, and is
forced to recover, as described above. The attacker blindly
continues sending ACKs that are ignored, as the victim
stops making progress in sending the stream (as demon-
strated by the (cid:3)at line). In the (cid:2)rst overrun, the victim ac-
tually retransmits three times before the attacker recovered,
because the retransmitted packets were also lost. However,
in the next two overruns, the attacker recovered faster, each
on the order of one second.

Recovery code must track the victim’s slowstart thresh-
old (ssthresh) in addition to the estimated congestion win-
dow (ecwnd ). The variable ssthresh is initialized to the
maximum window size, is set to half ecwnd with every
recovery, and grows with the congestion window, as pre-
scribed by [31].

A.2 Victim’s Processing Time

One of the most dif(cid:2)cult challenges in keeping the attacker
synchronized is estimating the time taken for the victim to
send the packets, which we call the processing time. Obvi-
ously, an attacker should not ACK segments faster than a
victim is capable of generating them. Through experimen-
tation, we (cid:2)nd that an upper bound on the processing time
of a victim if 50ms (Section 5). However, this is a lose
bound and in this section, we present techniques for more
exactly determining it.

If the attacker knows the victim’s processor speed,
server load, operating system, and local bandwidth, it may
be able to estimate the processing delay time. However,
this information is dif(cid:2)cult to determine, and underestimat-
ing the delay time leads to the attacker getting ahead of the
server as well as signi(cid:2)cant performance degradation. To
address this challenge, we introduce the TargetBandwidth

16

variable. With this variable, we can derive the processing
delay:

processing delay =

bcwnd =mssc (cid:2) (54 + mss)
TargetBandwidth

The TargetBandwidth variable represents the rate of
traf(cid:2)c the attacker is trying to induce the server to generate
(in bytes/second). While the value of TargetBandwidth
can be determined adaptively based on how often the at-
tacker is forced to recover, for the purposes of the imple-
mentation code, we specify it as a runtime parameter.

The processing time of an idle server is signi(cid:2)cantly
shorter than that of a busy server. This implies that an at-
tacker needs to estimate a server’s load before attacking
it. However, we noted that as the attacker’s (cid:3)ow rate in-
creases, the other connections are forced to back off, which
in turn decreases the processing time of the server. Thus,
we introduce the concept of adaptive delay. By overesti-
mating the initial processing time and the delay between
ACKs, i.e. sending ACKs slowly, and then progressively
ramping up the ACK speed to the desired rate, third party
streams are (cid:147)pushed(cid:148) out of the way with minimal over-
runs. How to do this effectively in an aggressive manner,
without causing the attacker to overrun and restart, is an
open question. However, in the implementation, we start
arbitrarily at 10 times the estimated processing time, and
then decrease down to the target processing time in steps
of 500 (cid:22)s per window.

Another variable affecting the processing time is the
coarse grained time slice in the victim’s scheduler. Peri-
odically, the victim process is suspended for a number of
time slices, which can cause a delay in sending if the ker-
nel buffer is drained before the process can be rescheduled.
An example of this is the second artifact (Figure 7, blown
up as Figure 11), where the server actually pauses for 36
ms. Note, it is less obvious from Figure 11, but the server
starts sending less than one millisecond before the buffered
ACKs arrive. We do not have a technique to predict these
delays, and rely on the recovery/restart mechanism.

A.3 Multiple ACKs Per Window and the

Transition Phase

We noted that during congestion avoidance, the server
rarely sent a full 64KB window, even when the congestion
window would otherwise have allowed for it. The effect
was that the number of segments in (cid:3)ight varied, and it be-
came dif(cid:2)cult for the attacker to ACK the correct number
of segments. We speculate this is due to operating sys-
tem buffering inef(cid:2)ciencies, and perhaps coarse grained
time slices. Whatever the reason, we changed the attack
algorithm to ACK half of the window at a time with the
appropriate delay instead of the full window all at once.
By ACKing half as much, twice as often, we were able to

keep the amount of (cid:3)ooding high, reducing the chance the
attacker gets ahead of the victim’s sequence number. The
downside is that by sending twice as many ACKs, we get
only half of the performance listed in Section 3.

An additional bene(cid:2)t of sending two ACKs per window
is resistance to lost ACKs. The basic algorithm assumes
that each ACK successfully reaches the victim, which is
obviously not true in general. To maximize this bene(cid:2)t in
implementation, we send two ACKs slightly offset from
each other twice per window for a total of four ACKs per
window. The bene(cid:2)t here is two fold. First, the attacker
can now lose three sequential ACKs in a row without over-
running the server. Second, with more ACKs the conges-
tion window grows faster after recovery from overrun. The
effect of sending four ACKs per window is we reduce the
expected ampli(cid:2)cation by a factor of four.

It was dif(cid:2)cult to track the exact state of the victim’s
congestion window and ssthresh, especially after recover-
ing. It was common for the attacker to stay correctly syn-
chronized with the victim through slow start and then get
out of sync immediately when moving to the congestion
avoidance algorithm. While we speculate there are many
factors that cause this behavior, i.e. unpredictable server
load, and the timing involved in the congestion avoidance
phase may need to be more accurate than the slow start
phase, it simply became easier to work around it. Thus,
we introduce a (cid:147)transition(cid:148) phase for the attacker between
slow start and congestion avoidance (see Figure 8). In this
transition phase, we ACK every expected packet in turn
for the full window. The effect of the transition phase is
that it allows for a larger margin of error in estimating the
victim’s ssthresh variable. In practice, we ACK two full
windows in the transition phase before transitioning to the
full congestion avoidance portion of the attack.

A.4 The Attacker’s Local Bandwidth

Algorithm 1 does not take into account the attacker’s local
bandwidth. Given a local bandwidth of (cid:12) in bytes per sec-
ond, ACKs can be sent at at most (cid:11) = (cid:12)=54 bytes/second.
At speeds faster than (cid:11), and the ACKs get buffered or
even dropped, which interferes with the timing of the at-
tack. When ACKs are buffered (as shown in the (cid:2)rst arti-
fact of Figure 7, and Figure 10))they arrive at the victim all
at once. The victim is not able to send fast enough to keep
up with the sudden (cid:3)ood of ACKs and this creates an over-
run. To (cid:2)x this, we limit the rate of outgoing ACKs from
the attacker as a function of the available local bandwidth,
which is speci(cid:2)ed at runtime. The main effect of rate limit-
ing the ACKs is to maintain even spacing when they arrive
at the victim, despite network jitter and buffering.

17


