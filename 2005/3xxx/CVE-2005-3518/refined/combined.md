=== Content from securityreason.com_5c55e5f2_20250125_121747.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **Punbb SQL Injection Vulnerability** **2005.10.15** Credit:  **[Devil\_box](https://cxsecurity.com/author/Devil_box/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **[CVE-2005-3518](https://cxsecurity.com/cveshow/CVE-2005-3518/ "Click to see CVE-2005-3518")** CWE: **[CWE-89](https://cxsecurity.com/cwe/CWE-89 "Click to see CWE-89")**  CVSS Base Score: **7.5/10** Impact Subscore: **6.4/10** Exploitability Subscore: **10/10** Exploit range: **Remote** Attack complexity: **Low** Authentication: **No required** Confidentiality impact: **Partial** Integrity impact: **Partial** Availability impact: **Partial** | | --- | |
| --- | --- | --- | --- |

[KAPDA::#6] Punbb SQL Injection Vulnerability
Punbb search.php SQL Injection Vulnerability
KAPDA New advisory
Vulnerable products : Punbb ( V 1.2.8 and 1.2.7 are tested,Hopefully all other versions)
Vendor: http://www.punbb.org/
Vulnerability: Sql injection
About Punbb
--------------------
PunBB is a fast and lightweight PHP-powered discussion board. It is released under the GNU
General Public License. Its primary goals are to be faster, smaller and less graphically intensive
as compared to other discussion boards. PunBB has fewer features than many other discussion
boards, but is generally faster and outputs smaller, semantically correct XHTML-compliant pages.
Vendor`s description : http://punbb.org/about.php
Discussion :
----------------
Scripts in page "Search.php" do not properly validate user-supplied input. A remote user can
create specially crafted parameter values that will execute SQL commands on the underlying
database.
While "Global\_register" of php.ini is set ON ,Remote user can poison local variables
of PHP pages to take control of web application or change its logical flow.
Vulnerabilities:
--------------------
In Search.php :
.......... start ...........
if ($db->num\_rows($result))
{
while ($row = $db->fetch\_row($result))
$old\_searches[] = '''.$db->escape($row[0]).''';
$db->query('DELETE FROM '.$db->prefix.'search\_cache WHERE ident NOT IN('
.implode(',', $old\_searches).')') or error('Unable to delete search results'
, \_\_FILE\_\_, \_\_LINE\_\_, $db->error());
}
.......... end ...........
The 4th line of pasted code sets old\_searches[] (array) to carefully validated data,
returned from database and then at next line it sends another query containing
old\_searches[].
If "Global\_register" of php.ini is set ON and there is no SQL injection filters ( or magic\_quotes)
then poisoning old\_searches can let remote users directly execute SQL commands.
Proof of Concepts:
--------------------
http://[site]/search.php?action=search&keywords=&author=d3vilbox&
forum=-1&search\_in=all&sort\_by=0&sort\_dir=DESC&show\_as=topics
&search=Submit&old\_searches[]=[sql injection]
Solution:
--------------------
find :
.......... Start ...........
if ($db->num\_rows($result))
{
while ($row = $db->fetch\_row($result))
$old\_searches[] = '''.$db->escape($row[0]).''';
.......... End ...........
and add "$old\_searches=array();" before beginning of "While" to clear old\_searches.
it should looks like :
.......... Start ...........
$old\_searches = array();
if ($db->num\_rows($result))
{
while ($row = $db->fetch\_row($result))
$old\_searches[] = '''.$db->escape($row[0]).''';
.......... End ...........
More Detail:
--------------------
http://www.kapda.ir/advisory-91.html
Visit above link for more details.
Credit :
--------------------
Devil\_box of KAPDA
devil\_box [at} kapda.ir
Kapda - Security Science Researchers Insitute of Iran
http://www.KAPDA.ir
(PersianHacker.NET)
Original Advisory : http://www.kapda.ir/advisory-91.html
Special thanks to : Trueend and Irannetjob

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2005100043)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_95d32ba3_20250126_082608.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_c5fb803d_20250126_082608.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_351744a6_20250126_082607.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from marc.info_0e769678_20250125_121745.html ===

```
[[prev in list](?l=bugtraq&m=112931270522688&w=2)] [[next in list](?l=bugtraq&m=112939745901283&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=112967629424854&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [[KAPDA::#6] Punbb SQL Injection Vulnerability](?t=112939699300001&r=1&w=2)
From:       [advisory () kapda ! ir](?a=112872622900001&r=1&w=2)
Date:       [2005-10-14 19:07:23](?l=bugtraq&r=1&w=2&b=200510)
Message-ID: [20051014190723.27852.qmail () securityfocus ! com](?i=20051014190723.27852.qmail%20()%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=112939699128430&q=mbox) or [body](?l=bugtraq&m=112939699128430&q=raw)]

[KAPDA::#6] Punbb SQL Injection Vulnerability

Punbb search.php SQL Injection Vulnerability

KAPDA New advisory

Vulnerable products : Punbb ( V 1.2.8 and 1.2.7 are tested,Hopefully all other versions)

Vendor: <http://www.punbb.org/>

Vulnerability: Sql injection

About Punbb
--------------------
   PunBB is a fast and lightweight PHP-powered discussion board. It is released under the GNU

General Public License. Its primary goals are to be faster, smaller and less graphically intensive

as compared to other discussion boards. PunBB has fewer features than many other discussion

boards, but is generally faster and outputs smaller, semantically correct XHTML-compliant pages.

	Vendor`s description : <http://punbb.org/about.php>

Discussion :
----------------
  Scripts in page "Search.php" do not properly validate user-supplied input. A remote user can

create specially crafted parameter values that will execute SQL commands on the underlying

database.

  While "Global_register" of php.ini is set ON ,Remote user can poison local variables

of PHP pages to take control of web application or change its logical flow.

Vulnerabilities:
--------------------
In Search.php :

.......... start ...........

if ($db->num_rows($result))
{
while ($row = $db->fetch_row($result))
$old_searches[] = '\''.$db->escape($row[0]).'\'';
$db->query('DELETE FROM '.$db->prefix.'search_cache WHERE ident NOT IN('
.implode(',', $old_searches).')') or error('Unable to delete search results'
, __FILE__, __LINE__, $db->error());
}

.......... end ...........

 The 4th line of pasted code sets old_searches[] (array) to carefully validated data,

returned from database and then at next line it sends another query containing

old_searches[].

 If  "Global_register" of php.ini is set ON and there is no SQL injection filters ( or magic_quotes)

then poisoning old_searches can let remote users directly execute SQL commands.

Proof of Concepts:
--------------------
http://[site]/search.php?action=search&keywords=&author=d3vilbox&
forum=-1&search_in=all&sort_by=0&sort_dir=DESC&show_as=topics
&search=Submit&old_searches[]=[sql injection]

Solution:
--------------------
find :
.......... Start ...........

if ($db->num_rows($result))
	{
while ($row = $db->fetch_row($result))

$old_searches[] = '\''.$db->escape($row[0]).'\'';
.......... End ...........

and add "$old_searches=array();" before beginning of "While" to clear old_searches.

it should looks like :

.......... Start ...........

$old_searches = array();

if ($db->num_rows($result))
	{
while ($row = $db->fetch_row($result))

$old_searches[] = '\''.$db->escape($row[0]).'\'';
.......... End ...........

More Detail:
--------------------
<http://www.kapda.ir/advisory-91.html>
Visit above link for more details.

Credit :
--------------------
Devil_box of KAPDA
devil_box [at}  kapda.ir
Kapda - Security Science Researchers Insitute of Iran
<http://www.KAPDA.ir>
(PersianHacker.NET)

Original Advisory : <http://www.kapda.ir/advisory-91.html>
Special thanks to : Trueend and Irannetjob
[[prev in list](?l=bugtraq&m=112931270522688&w=2)] [[next in list](?l=bugtraq&m=112939745901283&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=112967629424854&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


