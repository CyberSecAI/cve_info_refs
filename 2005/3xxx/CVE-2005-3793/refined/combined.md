=== Content from marc.info_96820b0c_20250125_182715.html ===

```
[[prev in list](?l=bugtraq&m=113210758511323&w=2)] [[next in list](?l=bugtraq&m=113209497112052&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Affiliate Network Pro v7.2 SQL Injections, Arbitrary code
From:       [r.verton () gmail ! com](?a=112611518500003&r=1&w=2)
Date:       [2005-11-15 17:44:01](?l=bugtraq&r=1&w=2&b=200511)
Message-ID: [20051115174401.4554.qmail () securityfocus ! com](?i=20051115174401.4554.qmail%20()%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=113209435819541&q=mbox) or [body](?l=bugtraq&m=113209435819541&q=raw)]

Affiliate Network Pro v7.2 SQL Injections, Arbitrary code execution, XSS
========================================================================

   Software: Affiliate Network Pro v7.2
   Severity: SQL Injection(s), Arbitrary code execution, XSS
   Risk: High
   Author: Robin Verton <r.verton@gmail.com>
   Date: Nov. 15 2005
   Vendor: [www.alstrasoft.com](http://www.alstrasoft.com)

   Description:

	AlstraSoft Affiliate Network Pro is the next generation affiliate network software \
solution that allows   you to start your own successful affiliate network just like \
LinkShare and Commission Junction.  [<http://www.alstrasoft.com/>]

   Details:

	1) /admin/admin_validate_login.php (with magic_quotes_gpc = Off)

    	   $login			=(trim($_POST['login']));         //  login name
    	   $passwd			=(trim($_POST['passwd']));        //  login passord

	   [...]

           $sql           ="SELECT * FROM partners_admin where admin_login='$login' \
AND admin_password='$passwd'";  $result        =mysql_query($sql);

	   Because of no input validation it is possible to injectio malicious code. By \
submitting (at the index.php login-form)  with the username admin and the password ' \
OR '1'='1 you can log in as an administrator.

	2) /admin/admin_options_manage.php

          $number=trim($_POST['number']);
	  $number        =$number;		//Notice by auditor: Great code here ;p
    	  if($number){
          	$filename  ="../includes/constants.php";
          	$fd = fopen ($filename, "r");
          	$contents = fread ($fd, filesize ($filename));
          	fclose($fd);

                $conts        =explode("\n",$contents);
            	$n        =count($conts);
            	for ($i=0; $i<$n; $i++) {
           		$tmp        =explode("=",$conts[$i]);
           		$tmp1        =trim($tmp[0]);

           		if($tmp1=="$"."lines"){
                            $conts[$i]        \
=str_replace($lines,$number,$conts[$i]);  continue;
            		}
           }

           $fd = fopen ($filename, "w");
           $cont1  =implode("\n",$conts);
           fwrite($fd,$cont1);
           fclose($fd);

	   Because the input of $_POST['numbers'] is not validated you can write each code \
you want into the /includes/constants.php file.  Example input to view a phpinfo() \
each time the /includes/constant.php is included or accessed:

	   0; phpinfo()

	3) /admin/index.php XSS Vulnerability

	   Via the $Err - which is not validated against XSS -  you can insert HTML-Code

	   /admin/index.php?Err=<script>alert('foobar');</script>

        4) /index.php?Act=register XSS Vulnerabilities

	   Same as in the /admin/index.php file - all fields in the register-form like \
$firstname, $lastname or $fax are vulnernable to XSS-attacks.

	   /index.php?Act=register&firstname=<script>alert('weeow :D');</script>
	   /index.php?Act=register&lastname=<script>alert('weeow :D');</script>

	5) /login_validate.php  (with magic_quotes_gpc = Off)

           $login                =trim($_POST['login']);       //login email id
           $passwd               =trim($_POST['password']);    //password
           $flag                 =trim($_POST['flag']);        //differentiate \
merchant and affiliate

	   $sql        ="SELECT * FROM partners_login where login_email='$login' AND \
login_password='$passwd' and login_flag='$type'";  $result     =mysql_query($sql);

	   Like in the admin-login-form the user-input isn't validated here, too. Same \
dimension -  you can log in as an random user or  insert malicious code.

	6) /togateway.php Path disclosure

           Because of the insufficient check if a file is direct access or not you \
can disclose here the path of the affiliate application.  This file is only an \
exmaple, nearly EVERY file who shouldn't be access trough direct browsing can be \
access directly !

	There are a few more SQL-Injections in this software, too much too count them all \
here.

   Patch:
          Best way to secure Affiliate Network Pro is to set magic_quotes_gpc in the \
php.ini ON or to insert a global addslashes for the  User-submitted variables.

   Credits:

	Credit goes to Robin Verton

   References:

	[[1]](#1) <http://www.alstrasoft.com/affiliate.htm>
	[[2]](#2) <http://myblog.it-security23.net>

[[prev in list](?l=bugtraq&m=113210758511323&w=2)] [[next in list](?l=bugtraq&m=113209497112052&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.vupen.com_e24fb5dd_20250125_182715.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


