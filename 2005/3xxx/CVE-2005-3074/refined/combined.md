=== Content from www.rsyslog.com_cb141dd7_20250125_044922.html ===
 [Skip to content](#zak-content)

![](data:image/svg+xml...)![](data:image/svg+xml...)

[rsyslog](https://www.rsyslog.com/)

The rocket-fast system for log processing

* PROJECT
  + [News Releases](https://www.rsyslog.com/news-releases/)
  + [Features](https://www.rsyslog.com/features/)
  + [Plugins](https://www.rsyslog.com/plugins/)
  + [ChangeLogs](https://www.rsyslog.com/changelogs/)
  + [Security Advisories](https://www.rsyslog.com/category/security-advisories/)
* [HELP](/guides/)
  + [Guides for rsyslog](https://www.rsyslog.com/category/guides-for-rsyslog/)
  + [Documentation](/doc/)
  + [Support](https://www.rsyslog.com/windows-agent/support/)
  + [FAQ](https://www.rsyslog.com/category/faq/)
  + [Video Tutorials](https://www.rsyslog.com/category/video-tutorials/)
* TOOLS
  + [Config builder](/rsyslog-configuration-builder/)
  + [Impstats Analyzer](https://www.rsyslog.com/impstats-analyzer/)
  + [RainerScript Constant String Escaper](https://www.rsyslog.com/rainerscript-constant-string-escaper/)
  + [Regex](https://www.rsyslog.com/regex/)
* SERVICES
  + [Enterprise Support](https://www.rsyslog.com/professional-services/enterprise-support/)
  + [Custom Development](https://www.rsyslog.com/professional-services/custom-development/)
* WINDOWS AGENT
  + [About Rsyslog Windows Agent](https://www.rsyslog.com/windows-agent/about-rsyslog-windows-agent/)
  + [Edition Comparison](https://www.rsyslog.com/windows-agent/edition-comparison/)
  + [Order Now](https://www.rsyslog.com/windows-agent/order-now/)
  + [Support Contract – Windows Agent](https://www.rsyslog.com/windows-agent/support-contract-windows-agent/)
  + [Manual](/download/files/windows-agent-manual/index.rsyslog.html)
  + [Support](https://www.rsyslog.com/windows-agent/support/)
  + [Windows Agent Download](https://www.rsyslog.com/windows-agent/windows-agent-download/)
  + [Guides for Windows Agent](https://www.rsyslog.com/category/guides-for-windows-agent/)
  + [RSyslog Windows Agent license document – EULA](https://www.rsyslog.com/rsyslog-windows-agent-eula/)
* [AWS Offering](https://www.rsyslog.com/aws-rsyslog-an-overview/)
    Search for:           Search for:

* PROJECT
  + [News Releases](https://www.rsyslog.com/news-releases/)
  + [Features](https://www.rsyslog.com/features/)
  + [Plugins](https://www.rsyslog.com/plugins/)
  + [ChangeLogs](https://www.rsyslog.com/changelogs/)
  + [Security Advisories](https://www.rsyslog.com/category/security-advisories/)
* [HELP](/guides/)
  + [Guides for rsyslog](https://www.rsyslog.com/category/guides-for-rsyslog/)
  + [Documentation](/doc/)
  + [Support](https://www.rsyslog.com/windows-agent/support/)
  + [FAQ](https://www.rsyslog.com/category/faq/)
  + [Video Tutorials](https://www.rsyslog.com/category/video-tutorials/)
* TOOLS
  + [Config builder](/rsyslog-configuration-builder/)
  + [Impstats Analyzer](https://www.rsyslog.com/impstats-analyzer/)
  + [RainerScript Constant String Escaper](https://www.rsyslog.com/rainerscript-constant-string-escaper/)
  + [Regex](https://www.rsyslog.com/regex/)
* SERVICES
  + [Enterprise Support](https://www.rsyslog.com/professional-services/enterprise-support/)
  + [Custom Development](https://www.rsyslog.com/professional-services/custom-development/)
* WINDOWS AGENT
  + [About Rsyslog Windows Agent](https://www.rsyslog.com/windows-agent/about-rsyslog-windows-agent/)
  + [Edition Comparison](https://www.rsyslog.com/windows-agent/edition-comparison/)
  + [Order Now](https://www.rsyslog.com/windows-agent/order-now/)
  + [Support Contract – Windows Agent](https://www.rsyslog.com/windows-agent/support-contract-windows-agent/)
  + [Manual](/download/files/windows-agent-manual/index.rsyslog.html)
  + [Support](https://www.rsyslog.com/windows-agent/support/)
  + [Windows Agent Download](https://www.rsyslog.com/windows-agent/windows-agent-download/)
  + [Guides for Windows Agent](https://www.rsyslog.com/category/guides-for-windows-agent/)
  + [RSyslog Windows Agent license document – EULA](https://www.rsyslog.com/rsyslog-windows-agent-eula/)
* [AWS Offering](https://www.rsyslog.com/aws-rsyslog-an-overview/)

# SQL Injection Vulnerability in rsyslogd

  By [Adiscon Support](https://www.rsyslog.com/author/admin/)Posted on [September 23, 2005](https://www.rsyslog.com/article35/)Posted in [Security Advisories](https://www.rsyslog.com/category/security-advisories/)Tagged [rsyslog](https://www.rsyslog.com/tag/rsyslog/), [SQL Injection](https://www.rsyslog.com/tag/sql-injection/)

**An SQL injection vulnerability was found in all rsyslog releases prior to the ones announced on 2005-09-23.** An attacker can send a specifically-crafted syslog message to rsyslogd and potentially take ownership of the machine.

This can be locally exploited if rsyslogd is listening on the local socket. Wes assume it is doing this in almost all cases. It can also be exploited remotely if rsyslogd is listening on network sockets and the attacker is not blocked from sending messages to rsyslogd (e.g. if not blocked by firewalling).

The vulnerability can potentially be used to take full ownership of the computer a compromised rsyslog is running on. The extend of the compromise is depending on the permissions of the user used to connect to MySQL.

We do not know of any case where this was exploited in practice. The bug was discovered during security-testing rsyslogd.

As of this writing, fixed versions exist both for the stable and the development branch. They are named 1.0.1 and 1.10.1. They can be obtained via the following links:

For 1.0.1 stable:
 <http://www.rsyslog.com/Downloads-index-req-getit-lid-17.phtml>

For 1.10.1 development:
 <http://www.rsyslog.com/Downloads-index-req-getit-lid-18.phtml>

**As this is a serious vulnerability, we urge all users to update to the fixed version as soon as possible.**

**If you have turned on NO\_BACKSLASH\_ESCAPES in MySQL, you MUST make changes to your configuration file. Read DETAILS below to learn more.**
 **DETAILS**
 While rsyslog currently supports MySQL only, it has a database-ignorant design approach. As part of it, SQL escaping is done inside the template system and not inside the database layer. This is also necessary because files can be used to store SQL commands that will be imported offline to a database (the same for pipes and other data destinations). Another reason for escaping in the template system is that rsyslogd – by intention – allows the user to craft any SQL statement with the template system. There is a special template option – SQL – telling the template system that the template is to be used for database and such escaping of special characters must occur.

During rsyslogd’s design, care has been taken that only templates with an active SQL option can be used together with the “write database” action.

The template system uses standard SQL escapes. Unfortuantely, some databases (MySQL is among them) violate the SQL standard and allow their own escape sequences. These MySQL-extended escape sequences were not properly escaped and could be used to circumvent the escaping mechanism present in the template system. This has now been fixed.

The fix now provides two different escaping options for the template system. One is “sql”, which now supports the MySQL extensions. The other one is “stdsql”, which supports the standard escapes. The option naming is not intuitive, one might have expected that “sql” would take care of SQL-standard compliant databases. However, we have decided against this because the way it is now allows users to fix the issue by just upgrading rsyslogd. As the “old” name has the new encoding and rsyslogd currently supports only MySQL, this will fix the issue. However, if the user has turned on NO\_BACKSLASH\_ESCAPES in MySQL, further action is required. The same is true if the SQL option was used to write log files that were later manually feed into another database. In these cases, review the new options, their meaning and restrictions in the rsyslog.conf manual:

http://www.rsyslog.com/Documentation-/rsyslog\_conf.html.phtml

**CREDITS**
 There was an anonymous poster quoting the possibility of a SQL injection on the sourcefourge bug tracker. While his report was very generic, it was one of the reasons a security audit was reapplied. Many thanks to whoever that was.

**QUESTIONS**
 … should be addressed either to the rsyslog mailing list or the support forums at rsyslog.com.

Rainer Gerhards

## Post navigation

[LibLogging is alive!](https://www.rsyslog.com/liblogging-is-alive/)[LibLogging 0.6.0 released](https://www.rsyslog.com/liblogging-0-6-0-released/)
## Current Version

[daily stable build (Ubuntu)](/downloads/download-daily-build/ "Daily build")
 [daily stable build (CentOS)](/rhelcentos-rpms/ "Daily build")

**8.2412.0** [[doc](/doc/v8-stable/ "doc")] [[download](/downloads/download-v8-stable/ "download")]

next: 8.2502.0, February 2025

[rsyslog docker container](https://hub.docker.com/r/rsyslog/syslog_appliance_alpine/ "rsyslog docker container")

[[packages and older versions](/downloads/download-other/ "packages and older versions")]

Windows Agent: **8.0** [[download](https://www.rsyslog.com/windows-agent/windows-agent-download/)]

## [Recent Posts](https://www.rsyslog.com/ "The rocket-fast system for log processing")

* [RSyslog Windows Agent 8.0 Released](https://www.rsyslog.com/rsyslog-windows-agent-8-0-released/?utm_source=rss&utm_medium=rss&utm_campaign=rsyslog-windows-agent-8-0-released "Release Date: 2025-01-23 Build-IDs: Service 8.0.0. ...")Release Date: 2025-01-23 Build-IDs: Service 8.0.0. ...
* [RSyslog Windows Agent 7.5c Released](https://www.rsyslog.com/rsyslog-windows-agent-7-5c-released/?utm_source=rss&utm_medium=rss&utm_campaign=rsyslog-windows-agent-7-5c-released "Release Date: 2024-10-06 Build-IDs: Service 7.5.0. ...")Release Date: 2024-10-06 Build-IDs: Service 7.5.0. ...
* [What to do when an External Script does not work?](https://www.rsyslog.com/what-to-do-when-an-external-script-does-not-work/?utm_source=rss&utm_medium=rss&utm_campaign=what-to-do-when-an-external-script-does-not-work "When a script runs fine interactively but fails in ...")When a script runs fine interactively but fails in ...
* [RSyslog Windows Agent 7.5b Released](https://www.rsyslog.com/rsyslog-windows-agent-7-5b-released/?utm_source=rss&utm_medium=rss&utm_campaign=rsyslog-windows-agent-7-5b-released "Release Date: 2024-08-22 Build-IDs: Service 7.5.0. ...")Release Date: 2024-08-22 Build-IDs: Service 7.5.0. ...
## COMMUNITY

* [Mailinglist](http://lists.adiscon.net/mailman/listinfo/rsyslog)
* [Github](https://github.com/rsyslog)
## About

* [About Adiscon / Impressum](https://www.rsyslog.com/about/)
* [Contact Us](https://www.rsyslog.com/contact-us)
* [Privacy policy / Datenschutzrichtlinien](/data-privacy-policy/)
* [Rainer's Blog](https://rainer.gerhards.net/)
## Related Products

* [LogAnalyzer](http://loganalyzer.adiscon.com/)
* [WinSyslog](http://www.winsyslog.com/en/)

Copyright © 2008-2020 [Adiscon GmbH](https://www.adiscon.com). Theme: [Zakra](https://zakratheme.com/ "Zakra") By ThemeGrill.

 Scroll to top   rsyslog.com uses cookies to ensure that we give you the best experience on our website. If you continue to use this site, you confirm and accept the use of Cookies on our site. You will find more informations in our [Data Privacy Policy](/data-privacy-policy).Ok[Read more](https://www.rsyslog.com/data-privacy-policy/)
