The provided content describes a SQL injection vulnerability in PHP-Fusion v6.00.109.

**Root cause of vulnerability:**
The vulnerability stems from insufficient sanitization of the `msg_send` parameter in `messages.php`. Specifically, the application fails to properly sanitize user-supplied input before including it in a SQL query. When `magic_quotes` is off, this allows an attacker to inject malicious SQL code.

**Weaknesses/vulnerabilities present:**
- SQL Injection vulnerability in `messages.php` via the `msg_send` parameter.

**Impact of exploitation:**
- An attacker can bypass authentication and retrieve sensitive data such as user passwords (MD5 hashes) from the `fusion_users` table.

**Attack vectors:**
- The attacker sends a crafted HTTP GET request to `messages.php` with a malicious SQL query in the `msg_send` parameter.
- The provided exploit also includes a login sequence to obtain a valid session cookie, which is required for the second phase of the attack.

**Required attacker capabilities/position:**
- The attacker must have access to the target web server running PHP-Fusion v6.00.109.
- The attacker needs to know the path to the PHP-Fusion installation.
- The attacker can also use a proxy server to send the exploit.
- `magic_quotes` must be disabled on the server.
- The attacker needs a valid username and password to obtain a session cookie, however, any valid user will be enough as the final SQLi is used to target admin users.

The content includes a proof-of-concept exploit script written in PHP, demonstrating the steps required to exploit the vulnerability. The exploit includes a login phase and a SQL injection phase to retrieve the MD5 password hash. It also displays the retrieved password hash after a successful attack. The original advisory link is also included, further confirming this is the vulnerability.