=== Content from marc.info_7489fe0b_20250125_210609.html ===

```
[[prev in list](?l=bugtraq&m=111032030705277&w=2)] [[next in list](?l=bugtraq&m=111049670101435&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Wfsection 1.07 vulnerabilities
From:       [kreon <kre0n () mail ! ru>](?a=111049619100006&r=1&w=2)
Date:       [2005-03-08 19:05:54](?l=bugtraq&r=1&w=2&b=200503)
Message-ID: [20050308220554.542ac1c2 () xaero ! tvpro ! net](?i=20050308220554.542ac1c2%20()%20xaero%20!%20tvpro%20!%20net)
[Download RAW [message](?l=bugtraq&m=111049618519821&q=mbox) or [body](?l=bugtraq&m=111049618519821&q=raw)]

Program: wfsections
Verion: 1.07
Bug Type: SQL Injection
Bug Discription:
=================================
In file class/wfsfiles.php, we can see this function:
//START
function getAllbyArticle($articleid) {
	$db =& Database::getInstance();
	$table = $db->prefix("wfs_files");
	$ret = array();
	$sql = "SELECT * FROM ".$table." WHERE articleid=".$articleid."";
	$result = $db->query($sql);
	while( $myrow = $db->fetchArray($result) ){
		$ret[] = new WfsFiles($myrow);
	}
	return $ret;
}
//END
Param $articleid inserts into sql-query without any checks, so we can
make sql-injection. Example:
http://[path]/[folder[/article.php?articleid=1[SQL Code[like OR 1=1]]
Patch: replace string
$sql = "SELECT * FROM ".$table." WHERE articleid=".$articleid."";
With string
$sql = "SELECT * FROM ".$table." WHERE
articleid=".intval($articleid)."";
=================================
Contact:
      // irc: #adz @ irc.quakenet.org
ADZ Security Team // <http://adz.void.ru>
=================================
[[prev in list](?l=bugtraq&m=111032030705277&w=2)] [[next in list](?l=bugtraq&m=111049670101435&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


