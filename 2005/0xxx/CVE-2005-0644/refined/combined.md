=== Content from www.kb.cert.org_280fd81c_20250125_043347.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#361180

## McAfee Scan Engine vulnerable to buffer overflow in LHA decoder

#### Vulnerability Note VU#361180

Original Release Date: 2005-03-18 | Last Revised: 2005-03-21

---

### Overview

A buffer overflow vulnerability in the McAfee Virus Scan Engine may allow a remote attacker to execute arbitrary code on an affected system. Because the vulnerability exists in a core component, a number of different McAfee products are affected.

### Description

| The McAfee Antivirus products feature the ability to detect malicious code in a number of compressed files, including those in the LHA format. A buffer overflow error has been discovered in the way that the McAfee Scan Engine handles the "type 2" headers in an LHA file. A remote attacker with the ability to craft a specifically malfomed LHA file may be able to exploit this vulnerability by introducing the malformed LHA file to an affected system via a web or FTP server, email message, or file server.  McAfee lists the following products as being potentially vulnerable to this issue, depending on the version of the scan engine they use:     + McAfee InternetSecurity Suite + VirusScan (all versions) + VirusScan Professional + Active Mail Protection + Active Threat Protection + Active Virus Defense SMB Edition + Active VirusScan SMB Edition + GroupShield for Exchange + GroupShield for Exchange 5.5 + GroupShield for Lotus Domino + GroupShield for Mail Servers with ePO + LinuxShield + Managed VirusScan + NetShield for Netware + PortalShield for Microsoft SharePoint + SecurityShield for Microsoft ISA Server + Virex + VirusScan ASaP + VirusScan Command Line + VirusScan Enterprise 8.0i + VirusScan for NetApp + WebShield Appliances + WebShield SMTP |
| --- |

### Impact

| An unauthenticated remote attacker may be able to execute code of their choosing on a vulnerable system. The attacker-supplied code would be run with Local System privileges, resulting in a complete system compromise. |
| --- |

### Solution

| **Apply an update from the vendor**McAfee has published updated versions of the Scan Engine (version 4400 - released November 2004) and DAT file (version 4436 - released March 1, 2005) to address this vulnerability. Users are encouraged to review the [McAfee FAQ](http://us.mcafee.com/root/support.asp?id=4320_faqs) and [McAfee advisory](http://images.mcafee.com/misc/McAfee_Security_Bulletin_05-march-17.pdf) on this issue and update their products accordingly. |
| --- |

### Vendor Information

361180
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23361180/) to view vendors.**
### [McAfee](#CRDY-6APQBS) Affected

Updated:  March 21, 2005

### Status

Affected

### Vendor Statement

McAfee has published updated versions of the Scan Engine (version 4400 -
released November 2004) and DAT file (version 4436- released March 1
2005) to address this vulnerability. Users are encouraged to review the
McAfee FAQ <<http://us.mcafee.com/root/support.asp?id=4320_faqs>>  and
McAfee advisory
<<http://images.mcafee.com/misc/McAfee_Security_Bulletin_05-march-17.pdf>>
on this issue and update their products accordingly.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

US-CERT has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://xforce.iss.net/xforce/alerts/id/190>
* <http://secunia.com/advisories/14628/>
* <http://www.securityfocus.com/bid/12832>
* <http://www.securitytracker.com/alerts/2005/Mar/1013463.html>
### Acknowledgements

The CERT/CC credits Alex Wheeler of the ISS X-Force with the discovery of this vulnerability.

This document was written by Chad R Dougherty based upon information provided by McAfee and ISS.

### Other Information

| **CVE IDs:** | [CVE-2005-0644](http://web.nvd.nist.gov/vuln/detail/CVE-2005-0644) |
| --- | --- |
| **Severity Metric:** | 22.32 |
| **Date Public:** | 2005-03-18 |
| **Date First Published:** | 2005-03-18 |
| **Date Last Updated:** | 2005-03-21 19:07 UTC |
| **Document Revision:** | 6 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from images.mcafee.com_647f7946_20250125_043345.html ===
Security Bulletin

March 17, 2005

McAfee Security Bulletin

Overview

McAfee is announcing to its’ customers who are operating on a previous version of the McAfee VirusScan
Engine (version 4320) are susceptible to a buffer overrun when scanning LHa files.

•  No action is required if your environment is currently running the 4400 Scan Engine (issued

November 2004) or the Virus Definition (DAT) version is 4436 (issued March 1, 2005) or higher

McAfee strongly encourages all McAfee customers to read the following bulletin and, if necessary, implement
the recommendations listed below as soon as possible.

The automatic downloading and installation of updates and upgrades as a default setting in VirusScan
assures the delivery of the latest product version to our customers. We urge all customers to verify that they
have installed and deployed the 4436 DAT [or higher] and/or the 4400 Scan Engine. If running an
earlier .DAT and the previous version of the McAfee VirusScan engine (4320), McAfee recommends that an
update is performed. As of the writing of this security bulletin, there are no known public cases of exploit
code that exist.

Summary of Vulnerabilities

CAN-2005-0643 - McAfee Engine Buffer Overflow when scanning LHa files

A vulnerability announcement in May 2004 prompted McAfee to inspect our technology to determine the
susceptibility to the potential exploit. This inspection determined that the 4320 version of the McAfee Scan
Engine was susceptible to a buffer overflow when scanning LHa files. An alteration to the configuration of the
Scan Engine issued with the 4357 DAT file (issued May 2004) was made to eliminate the vulnerability within
the 4320 Scan Engine.

Products affected:  Scan Engine 4320 – any McAfee point products still using the 4320 engine and DAT
version less than 4357.

CAN-2005-0644- Engine Buffer Overflow when scanning malformed LHa files

In February 2005, a variation of this vulnerability was reported to McAfee by ISS X-Force. It was found that
the 4320 version of the McAfee Scan Engine was susceptible to a buffer overflow when scanning malformed
LHa files. An alteration to the configuration of the Scan Engine issued (March 1, 2005) with the 4436 DAT file
was made to eliminate the vulnerability within the 4320 Scan Engine.  The McAfee 4400 engine (issued
November 2004) does not have this vulnerability.

Products affected:  Scan Engine v.4320 – any McAfee point products still using the 4320 engine and DAT
version less than 4436.

The following McAfee products and suites may include the vulnerable engine (4320).

McAfee Consumer Products:

−  McAfee InternetSecurity Suite
−  VirusScan (all versions)
−  VirusScan Professional

www.mcafee.com

Security Bulletin

2

McAfee SMB and Enterprise Products:

−  Active Mail Protection
−  Active Threat Protection
−  Active Virus Defense SMB Edition
−  Active VirusScan SMB Edition
−  GroupShield for Exchange
−  GroupShield for Exchange 5.5
−  GroupShield for Lotus Domino
−  GroupShield for Mail Servers with ePO
−  LinuxShield
−  Managed VirusScan
−  NetShield for Netware
−  PortalShield for Microsoft SharePoint
−  SecurityShield for Microsoft ISA Server
−  Virex
−  VirusScan ASaP
−  VirusScan Command Line
−  VirusScan® Enterprise 8.0i
−  VirusScan for NetApp
−  WebShield Appliances
−  WebShield SMTP

Recommendations

For McAfee Consumer Customers:

McAfee strongly recommends customers to download and apply the latest .DAT files and the latest
Scan Engine (v.4400). No action is required if the Scan Engine version is 4400 or the DAT version is
4436 (issued March 1 2005) or higher. Consumers can update their software by right-clicking on their
system tray icon (white M on Red background) and selecting “Updates”.  More information is available
at: http://ts.mcafeehelp.com/faq3.asp?docid=378097.

For McAfee SMB and Enterprise Customers:

To address the above vulnerabilities, McAfee strongly recommends customers to download and apply
the latest .DAT files and the latest Scan Engine (v.4400). No action is required if the Scan Engine
version is 4400 or the DAT version is 4436 (issued March 1 2005) or higher. We urge all customers to
verify that the 4436 DAT [or higher] and/or the 4400 Scan Engine have been installed and deployed.

These files are available at:

http://www.mcafeesecurity.com/us/downloads/updates/default.asp

Knowledge base article KB40234 also discusses this issue and is available at:

https://knowledgemap.nai.com/phpclient/homepage.aspx

Please note:   it is no longer necessary to log into Service Portal to search our Knowledge Base, just
click the ‘Knowledge’ link on the left menu.

www.mcafee.com

Security Bulletin

3

How do I check Engine & DAT Versions within Enterprise Products?

−  ePolicy Orchestrator Repositories - From the Management Console, click on Repository, Software

Repositories, Master.

−  GroupShield for Exchange - Open GUI, Product Versions are listed on opening screen.
−  GroupShield for Exchange 5.x - Open GUI, Click on Versions tab.

−  GroupShield for Lotus Domino - Open GUI, Product Versions are listed on opening screen.

−  LinuxShield - Open GUI, Product Versions are listed on opening screen.

−  Managed VirusScan - Right-mouse click on VirusScan in the systray, select about

−  Managed VirusScan Online Admin - From the admin login reporting page, Click View, Reports/All

Computers.  (note:  All version 3 users have the 4400 Engine)

−  NetShield for Netware - Right-mouse click on Shield in the systray, select about

−  PortalShield for Microsoft SharePoint - Open GUI, Product Versions are listed on opening screen.

−  ProtectionPilot Repositories - Click on Server, click on Repository Tab

−  SecurityShield for Microsoft ISA Server - Open GUI, Product Versions are listed on opening screen.

−  Virex 7.5 - From within Virex application, select about Virex from the Virex menu.

−  Virex 6.2 - Double-click on the green Virex emblem in the Control Panel.

−  VirusScan (all versions) - Right-mouse click on VirusScan in the systray, select about

−  VirusScan Professional - Right-mouse click on VirusScan in the systray, select about
−  VirusScan ASaP - Right-mouse click on VirusScan in the systray, select about

−  VirusScan Command Line - From a DOS Command Prompt, Run Scan.exe /version

−  VirusScan for NetApp - Right-mouse click on VirusScan in the systray, select about

−  VirusScan® Enterprise 8.0i - Right-mouse click on VirusScan in the systray, select about

−  WebShield Appliances - Select the System status page.

−  WebShield SMTP - Select the System status page.

Other References

Additional information on this issue may be found at: http://xforce.iss.net/xforce/alerts/id/190

Acknowledgements

McAfee, Inc. wishes to thank Alex Wheeler of the ISS X-Force for the discovery of these vulnerabilities and
for working with us to protect our customers.

McAfee, Inc.  3965 Freedom Circle, Santa Clara, CA 95054, 888.847.8766, www.mcafee.com

McAfee and/or other marks herein are registered trademarks or trademarks of McAfee, Inc. and/or its affiliates in the US and/or other
countries. The color red in connection with security is distinctive of McAfee brand products. All other registered and unregistered
trademarks herein are the sole property of their respective owners. © 2005 McAfee, Inc. All Rights Reserved.

www.mcafee.com


