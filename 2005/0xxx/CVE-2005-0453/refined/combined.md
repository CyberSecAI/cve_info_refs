=== Content from bugs.gentoo.org_0b4b6e30_20250126_115620.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 81776
www-servers/lighttpd: script exposure
Last modified: 2005-02-15 13:48:24 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=81776&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=81776&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 81776**](show_bug.cgi?id=81776)
- www-servers/lighttpd: script exposure

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
www-servers/lighttpd: script exposure

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High minor | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://article.gmane.org/gmane.comp.w...](http://article.gmane.org/gmane.comp.web.lighttpd/1171) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B3 [glsa] koon | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2005-02-12 12:40 UTC by Boris | | --- | --- | | Modified: | 2005-02-15 13:48 UTC ([History](show_activity.cgi?id=81776)) | | CC List: | 1 user (show)  web-apps | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=81776&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=81776&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Boris    2005-02-12 12:40:22 UTC  ``` From the lighttpd-announce-list (see URL):  ------------------------------------------------------------------ Dear users,  in lighttpd 1.3.7 and below it is possible to fetch the source files which should be handled by CGI or FastCGI applications.  - How to reproduce:    append a %00 to the filename:    <http://www.example.org/index.php%00>  - Description    Control-Sequences are not mapped out in buffer_urldecode() in buffer.c   which leeds to a \0 sequence in the filename while lighttpd ignores    is handles the %00 as part of the filename.  - Fix    1. upgrade to the latest version 1.3.10   2. apply the fixes referenced at <http://wiki.lighttpd.net/7.html#A12>   3. apply the attached fix  - affected versions    1.3.7 and below   - not affected   1.3.8 and above    1.3.7 and below if   - no CGI or FastCGI is used   - no CGI is used and FastCGI is running on a remote host ------------------------------------------------------------------  Reproducible: Always Steps to Reproduce: ```  [Comment 1](#c1)  Boris    2005-02-12 12:46:15 UTC  ``` Sorry, there is one thing I forgot to mention:  The license of the lighttpd-package has changed from QPL-1.0 to a BSD-style-Licence with version 1.3.5. This change should be reflected when bumping to a current version. ```  [Comment 2](#c2)  Sune Kloppenborg Jeppesen (RETIRED)   gentoo-dev  2005-02-12 12:50:58 UTC  ``` web-apps please bump.  <http://www.lighttpd.net/news/> ```  [Comment 3](#c3)  Aaron Walker (RETIRED)   gentoo-dev  2005-02-12 13:15:48 UTC  ``` I actually have a 1.3.10 ebuild I've been working on; I just need to integrate the spawn-fcgi init/conf scripts into lighttpd as it is now a part of lighttpd.  I'll see if I cannot get this finished today. ```  [Comment 4](#c4)  Andreas Korthaus    2005-02-13 07:19:46 UTC  ``` Have a look at 76575 - here I changed some things like that for 1.3.7 ```  [Comment 5](#c5)  Andreas Korthaus    2005-02-13 07:22:31 UTC  ``` see [http://bugs.gentoo.org/show_bug.cgi?id=76575](show_bug.cgi?id=76575 "RESOLVED FIXED - www-servers/lighttpd version bump to 1.3.7")#4 ```  [Comment 6](#c6)  Andreas Korthaus    2005-02-13 07:37:30 UTC  ``` argh, sorry, that's the comment I meant: [http://bugs.gentoo.org/show_bug.cgi?id=76575#c4](show_bug.cgi?id=76575#c4 "RESOLVED FIXED - www-servers/lighttpd version bump to 1.3.7") ```  [Comment 7](#c7)  Aaron Walker (RETIRED)   gentoo-dev  2005-02-14 03:39:29 UTC  ``` Committed. Sorry for not getting this done as soon as I said I would. ```  [Comment 8](#c8)  Sune Kloppenborg Jeppesen (RETIRED)   gentoo-dev  2005-02-14 04:03:08 UTC  ``` Thx Aaron.  This one is ready for GLSA. Security please vote. I tend to vote YES on this one. ```  [Comment 9](#c9)  Thierry Carrez (RETIRED)   gentoo-dev  2005-02-14 04:33:11 UTC  ``` Voting yes too. ```  [Comment 10](#c10)  Andreas Korthaus    2005-02-14 05:25:13 UTC  ``` I'm testing at the moment, some things I noticed in [http://www.gentoo.org/cgi-bin/viewcvs.cgi/*checkout*/www-servers/lighttpd/lighttpd-1.3.10.ebuild?rev=1.1&content-type=text/plain](http://www.gentoo.org/cgi-bin/viewcvs.cgi/%2Acheckout%2A/www-servers/lighttpd/lighttpd-1.3.10.ebuild?rev=1.1&content-type=text/plain)   - a lighttpd user & group is created, but I cannot find where they are put into lighttpd.conf, to replace the following lines :  #server.username            = "wwwrun" #server.groupname           = "wwwrun"  (replace "wwwrun" with "lighttpd" and remove #)  In my ebuild I used the following lines to do this:         sed -i -e 's:^#server.username.*:server.username = "lighttpd":1' ${D}/etc/lighttpd.conf         sed -i -e 's:^#server.groupname.*:server.groupname = "lighttpd":1' ${D}/etc/lighttpd.conf  But that's not nice, I think the better way would be to use lighttpd-1.1.8-gentoo.diff, perhaps change it to lighttpd-1.3.10-gentoo.diff (${P}-gentoo.diff).  an issue with: [http://www.gentoo.org/cgi-bin/viewcvs.cgi/*checkout*/www-servers/lighttpd/files/lighttpd-1.3.10-php.diff?rev=1.1&content-type=text/plain](http://www.gentoo.org/cgi-bin/viewcvs.cgi/%2Acheckout%2A/www-servers/lighttpd/files/lighttpd-1.3.10-php.diff?rev=1.1&content-type=text/plain)  in the following diff diff -urN lighttpd-1.3.10.orig/doc/lighttpd.1 lighttpd-1.3.10/doc/lighttpd.1  -/etc/lighttpd/lighttpd.conf +/etc/lighttpd.conf  is this change only necessary if used with php? Because as I understand this patch is conditional in lighttpd-1.3.10.ebuild:  use php && epatch ${FILESDIR}/${P}-php.diff  Perhaps the "lighttpd.1 diff" should be moved to ${FILESDIR}/${P}-gentoo.diff  ```  [Comment 11](#c11)  Andreas Korthaus    2005-02-14 05:29:09 UTC  ``` the lighttpd author also recommends using the following patches: <http://wiki.lighttpd.net/7.html#A14> ```  [Comment 12](#c12)  Aaron Walker (RETIRED)   gentoo-dev  2005-02-14 05:53:01 UTC  ``` Ok, there's a few things I need to fix but do not hinder the status of this bug:   - I forgot that the licensing has changed to BSD  - Yes, the default lighttpd.conf should contain the new change to lighttpd user/group  - Yes, the man page should be patched regardless of USE=php ; this is a bug I should've caught when porting the php patch to 1.3.10, so my mistake.  I'll release a -r1 asap, but like I said these are minor and have no affect on this bug. ```  [Comment 13](#c13)  Aaron Walker (RETIRED)   gentoo-dev  2005-02-14 06:50:41 UTC  ``` 1.3.10-r1 is in cvs. ```  [Comment 14](#c14)  Thierry Carrez (RETIRED)   gentoo-dev  2005-02-14 12:57:16 UTC  ``` Drafted ```  [Comment 15](#c15)  Thierry Carrez (RETIRED)   gentoo-dev  2005-02-15 13:48:24 UTC  ``` GLSA 200502-21 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=81776)
* - [XML](show_bug.cgi?ctype=xml&id=81776)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=81776)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=81776&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=81776&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=81776&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from security.gentoo.org_9b8dcc89_20250125_210241.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# lighttpd: Script source disclosure — GLSA **200502-21**

An attacker can trick lighttpd into revealing the source of scripts that
should be executed as CGI or FastCGI applications.

### Affected packages

| Package | **www-servers/lighttpd** on all architectures |
| --- | --- |
| Affected versions | < **1.3.10-r1** |
| Unaffected versions | >= **1.3.10-r1** |

### Background

lighttpd is a small-footprint, fast, compliant and very flexible
web-server which is optimized for high-performance environments.

### Description

lighttpd uses file extensions to determine which elements are programs
that should be executed and which are static pages that should be sent
as-is. By appending %00 to the filename, you can evade the extension
detection mechanism while still accessing the file.

### Impact

A remote attacker could send specific queries and access the source of
scripts that should have been executed as CGI or FastCGI applications.

### Workaround

There is no known workaround at this time.

### Resolution

All lighttpd users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-servers/lighttpd-1.3.10-r1"
```
### References

* [lighttpd-announce Advisory](https://article.gmane.org/gmane.comp.web.lighttpd/1171)
* [CVE-2005-0453](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0453)

**Release date**

February 15, 2005

**Latest revision**

May 22, 2006: 02

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [81776](https://bugs.gentoo.org/show_bug.cgi?id=81776)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


