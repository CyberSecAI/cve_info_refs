=== Content from www.gentoo.org_0b8a786b_20250125_162217.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# phpWebSite: Arbitrary PHP execution and path disclosure — GLSA **200503-04**

Remote attackers can upload and execute arbitrary PHP scripts, another flaw
reveals the full path of scripts.

### Affected packages

| Package | **www-apps/phpwebsite** on all architectures |
| --- | --- |
| Affected versions | < **0.10.0-r2** |
| Unaffected versions | >= **0.10.0-r2** |

### Background

phpWebSite provides a complete web site content management system.

### Description

NST discovered that, when submitting an announcement, uploaded files
aren't correctly checked for malicious code. They also found out that
phpWebSite is vulnerable to a path disclosure.

### Impact

A remote attacker can exploit this issue to upload files to a directory
within the web root. By calling the uploaded script the attacker could
then execute arbitrary PHP code with the rights of the web server. By
passing specially crafted requests to the search module, remote
attackers can also find out the full path of PHP scripts.

### Workaround

There is no known workaround at this time.

### Resolution

All phpWebSite users should upgrade to the latest available version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/phpwebsite-0.10.0-r2"
```
### References

* [Secunia Advisory SA14399](https://secunia.com/advisories/14399/)
* [phpWebSite announcement](http://phpwebsite.appstate.edu/index.php?module=announce&ANN_id=922&ANN_user_op=view)
* [CVE-2005-0565](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0565)
* [CVE-2005-0572](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0572)

**Release date**

March 01, 2005

**Latest revision**

May 22, 2006: 02

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [83297](https://bugs.gentoo.org/show_bug.cgi?id=83297)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.gentoo.org_4e2b41ae_20250126_101429.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 83297
www-apps/phpwebsite: Image Upload Vulnerability
Last modified: 2005-03-01 14:00:17 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=83297&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=83297&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 83297**](show_bug.cgi?id=83297)
- www-apps/phpwebsite: Image Upload Vulnerability

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
www-apps/phpwebsite: Image Upload Vulnerability

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | High critical | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://secunia.com/advisories/14399/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | A1 [glsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2005-02-25 06:40 UTC by Jean-François Brunette (RETIRED) | | --- | --- | | Modified: | 2005-03-01 14:00 UTC ([History](show_activity.cgi?id=83297)) | | CC List: | 2 users (show)  rizzo wendallc | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=83297&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=83297&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Jean-François Brunette (RETIRED)   gentoo-dev  2005-02-25 06:40:14 UTC  ``` Description: nst has reported a vulnerability in phpWebSite, which potentially can be exploited by malicious people to compromise a vulnerable system.  The vulnerability is caused due to an error in the uploading of images when submitting an announcement. This can be exploited to upload arbitrary PHP scripts to a directory inside the web root.  The vulnerability has been reported in version 0.10.0 and prior.  Solution: Edit the source code to ensure that the filenames of uploaded images are properly verified. ```  [Comment 1](#c1)  Thierry Carrez (RETIRED)   gentoo-dev  2005-02-25 08:16:10 UTC  ``` From Upstream @ <http://phpwebsite.appstate.edu/>  "This is a more serious issue than we thought. We recommend you disable your announcement module immediately. We are working on a fix." ```  [Comment 2](#c2)  Wendall Cada    2005-02-25 08:45:24 UTC  ``` If you are running phpWebSite. Please disable all user uploading of images. Any and all image uploading is vulnerable.  Wendall ```  [Comment 3](#c3)  Muti    2005-02-25 12:40:32 UTC  ``` An official patch is now available from: <http://phpwebsite.appstate.edu/downloads/security/phpws_image_secure_patch.tgz> ```  [Comment 4](#c4)  Don Seiler (RETIRED)   gentoo-dev  2005-02-25 13:06:43 UTC  ``` www-apps/phpwebsite-0.10.0-r1 is in portage, stable in x86.  Other arches please mark stable ASAP. ```  [Comment 5](#c5)  Jason Wever (RETIRED)   gentoo-dev  2005-02-26 14:47:25 UTC  ``` So I've been trying to test this out, but each time I setup phpwebsite and attempt to go the main URL, I get nothing in the web browser.  A search of the apache logs shows the following (about 2 errors per 1 request of url);  Allowed memory size of 8388608 bytes exhausted (tried to allocate 0 bytes) Allowed memory size of 8388608 bytes exhausted (tried to allocate 0 bytes)  Some quick googling didn't really show anything useful.  Anyone have any ideas? ```  [Comment 6](#c6)  Bryan Østergaard (RETIRED)   gentoo-dev  2005-02-27 03:32:11 UTC  ``` Stable on alpha. ```  [Comment 7](#c7)  Thierry Carrez (RETIRED)   gentoo-dev  2005-02-28 00:49:59 UTC  ``` weeve: maybe it's something similar to the problem described here : <http://www.squirrelmail.org/wiki/en_US/LowMemoryProblem>  ppc: please test and mark stable ASAP.  Setting to A since it's easily exploitable and victims can be searched with Google. ```  [Comment 8](#c8)  Don Seiler (RETIRED)   gentoo-dev  2005-02-28 07:52:01 UTC  ``` An additional patch was released, and I've added it on www-apps/phpwebsite-0.10.0-r2.  0.10.0-r1 is obsolete, all ARCHes please test -r2. ```  [Comment 9](#c9)  Wendall Cada    2005-02-28 08:49:52 UTC  ``` Jason,  phpWebSite is kindof a memory hog. This has been resolved for our future 1.0 release. For now, if you run alot of modules, you'll have to bump your memory limit up to say 10M or 12M  Wendall ```  [Comment 10](#c10)  Thierry Carrez (RETIRED)   gentoo-dev  2005-02-28 11:34:00 UTC  ``` rizzo: is the new patch a necessary patch for security, or for stability ? ```  [Comment 11](#c11)  Matthias Geerdsen (RETIRED)   gentoo-dev  2005-02-28 13:31:30 UTC  ``` This new patch fixes a different issue... see <<http://phpwebsite.appstate.edu/index.php?module=announce&ANN_id=922&ANN_user_op=view>>  The BugTraq mail they refer to seems to be  <<http://www.securityfocus.com/archive/1/391525/2005-02-25/2005-03-03/0>> I believe. ```  [Comment 12](#c12)  Michael Hanselmann (hansmi) (RETIRED)   gentoo-dev  2005-02-28 14:01:38 UTC  ``` Stable on ppc. ```  [Comment 13](#c13)  Jason Wever (RETIRED)   gentoo-dev  2005-02-28 18:52:55 UTC  ``` Somewhere between 12M and 20M was the magic number here.  Stable on SPARC. ```  [Comment 14](#c14)  Thierry Carrez (RETIRED)   gentoo-dev  2005-03-01 00:54:45 UTC  ``` alpha: please test and mark stable rizzo: please mark -r2 stable for x86 if you can ```  [Comment 15](#c15)  Bryan Østergaard (RETIRED)   gentoo-dev  2005-03-01 10:13:35 UTC  ``` Stable on alpha. ```  [Comment 16](#c16)  Thierry Carrez (RETIRED)   gentoo-dev  2005-03-01 10:21:32 UTC  ``` Marked x86-stable by rizzo, ready for GLSA ```  [Comment 17](#c17)  Thierry Carrez (RETIRED)   gentoo-dev  2005-03-01 14:00:17 UTC  ``` GLSA 200503-04 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=83297)
* - [XML](show_bug.cgi?ctype=xml&id=83297)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=83297)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=83297&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=83297&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=83297&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from marc.info_4a24b8b4_20250125_162216.html ===

```
[[prev in list](?l=bugtraq&m=110935119128406&w=2)] [[next in list](?l=bugtraq&m=110935267500395&w=2)] [[prev in thread](?l=bugtraq&m=110935119128406&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [phpWebSite 0.10.0 Full Path disclosure](?t=110935127100004&r=1&w=2)
From:       [HaCkZaTaN <hck_zatan () hotmail ! com>](?a=110935200300001&r=1&w=2)
Date:       [2005-02-25 6:52:48](?l=bugtraq&r=1&w=2&b=200502)
Message-ID: [20050225065248.9374.qmail () www ! securityfocus ! com](?i=20050225065248.9374.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=110935172116369&q=mbox) or [body](?l=bugtraq&m=110935172116369&q=raw)]

/*
--------------------------------------------------------
[N]eo [S]ecurity [T]eam [NST]® [ [ wWw.SoSvulnerable.NeT ] ]®
--------------------------------------------------------
Program:  phpWebSite 0.10.0
Homepage:  <http://phpwebsite.appstate.edu>
Vulnerable Versions: All
Risk: High!!
Impact: Full Path disclosure

      -==phpWebSite 0.10.0 Full Path disclosure==-
---------------------------------------------------------

- Description
---------------------------------------------------------
phpWebSite provides a complete web site content management
system. Web-based administration allows for easy maintenance
of interactive, community-driven web sites.

A remote attacker may exploit this condition to view full path
This vulnerability is reported to affect phpWebSite versions
up to an including version 0.10.0.

- Tested
---------------------------------------------------------
LocalHost!! and other phpWebSites

- Explotation
---------------------------------------------------------
index.php?module=search&SEA_search_op=search&SEA_search_module=[NST & SVL]

it'll come out something like:
Warning: search(/home/grgfidcd/public_html/ccToronto/mod/[NST /conf/search.php):
failed to open stream: No such file or directory in
/home/grgfidcd/public_html/ccToronto/mod/search/class/Search.php on line 51

Warning: search(/home/grgfidcd/public_html/ccToronto/mod/[NST /conf/search.php):
failed to open stream: No such file or directory in
/home/grgfidcd/public_html/ccToronto/mod/search/class/Search.php on line 51

Warning: search(): Failed opening '/home/grgfidcd/public_html/ccToronto/mod/[NST \
/conf/search.php' for inclusion \
                (include_path='.:/home/grgfidcd/public_html/ccToronto/lib/pear/') in
/home/grgfidcd/public_html/ccToronto/mod/search/class/Search.php on line 51

-----[ Start Vuln Code ] ------------------------------------

  function search() {
    if(!isset($_REQUEST['mod']) || !is_string($_REQUEST['mod'])) {
      $module = "all";
    } else {
      $module = $_REQUEST['mod'];
    }

    $this->lists = array();

    if(isset($_REQUEST['query'])) {
      $this->query = preg_replace("/[^\.A-Za-z0-9_-\s]/", "", $_REQUEST['query']);
    } else {
      return $this->results();
    }

-----[ Ends Vulns Code ] ------------------------------------

- Exploit
---------------------------------------------------------
Not Yet xD

- Solutions
--------------------------------------------------------
Not Yet

- References
--------------------------------------------------------
<http://neossecurity.net/Advisories/Advisory-05.txt>

- Credits
-------------------------------------------------
Discovered by HaCkZaTaN and LINUX <hck_zatan@hotmail.com> - <svsecurity@gmail.com>

[N]eo [S]ecurity [T]eam [NST]® - <http://neossecurity.net/>

[ [ wWw.SoSvulnerable.NeT ] ]® - <http://sosvulnerable.net/>

Got Questions? <http://sosvulnerable.net>  - <http://neossecurity.net/>

Irc.InfoGroup.cl #neosecurityteam
Irc.GigaChat.net #swc
- Greets
--------------------------------------------------------
           Paisterist
           T0wn3r
           LINUX
	   Heap
           Nitrous
           CrashCool
           eL_mEsIaS
           Makoki
           Infektion group
           And my Colombian people

	@@@@'''@@@@'@@@@@@@@@'@@@@@@@@@@@
	'@@@@@''@@'@@@''''''''@@''@@@''@@
	'@@'@@@@@@''@@@@@@@@@'''''@@@
	'@@'''@@@@'''''''''@@@''''@@@
	@@@@''''@@'@@@@@@@@@@''''@@@@@
*/

[[prev in list](?l=bugtraq&m=110935119128406&w=2)] [[next in list](?l=bugtraq&m=110935267500395&w=2)] [[prev in thread](?l=bugtraq&m=110935119128406&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


