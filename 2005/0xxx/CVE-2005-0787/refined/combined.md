=== Content from bugs.winehq.org_0a8b2f3b_20250125_024035.html ===


[![](https://dl.winehq.org/share/images/winehq_logo_glass_sm.png)](/)
[![WineHQ](https://dl.winehq.org/share/images/winehq_logo_text.png "WineHQ")](/)
Bug Tracking Database – Bug 2715

Search:

* [WineHQ](//www.winehq.org/)
* [Wiki](http://wiki.winehq.org/)
* [AppDB](//appdb.winehq.org/)
* [Bugzilla](//bugs.winehq.org/)
* [Forums](//forum.winehq.org/)

* Task Lists
* [Regressions](buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&bug_status=NEEDINFO&bug_status=STAGED&product=Wine&keywords=regression&columnlist=bug_severity,priority,bug_status,cf_regression_sha1sum,short_desc,changeddate&keywords_type=anywords)
* [With download](buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&bug_status=NEEDINFO&bug_status=STAGED&product=Wine&keywords=download&keywords_type=anywords)
* [With patch](buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&bug_status=NEEDINFO&bug_status=STAGED&product=Wine&keywords=patch&keywords_type=anywords)

* Bug Lists
* [Available](buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=REOPENED&cmdtype=doit&order=Bug+Number)
* [Assigned](buglist.cgi?bug_status=ASSIGNED)
* [NeedInfo](buglist.cgi?bug_status=NEEDINFO)
* [Staged](buglist.cgi?bug_status=STAGED)
* [Resolved](buglist.cgi?bug_status=RESOLVED)

| Bugzilla |  | Last modified: 2016-01-05 15:48:11 UTC |
| --- | --- | --- |

|  |
| --- |

* [Intro](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

   [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](http://www.bugzilla.org/docs/4.0/en/html/bug_page.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=2715&GoAheadAndLogIn=1)

  Remember

  [x]
* |
  [Forgot Password](show_bug.cgi?id=2715&GoAheadAndLogIn=1#forgot)
  Login:

  [x]
## Insecure file creation of "regxxxxxxx.tmp" in /tmp

*First*
*Last*
*Prev*
*Next*

*This bug is not in your last
search results.*

[**Bug 2715**](show_bug.cgi?id=2715) -
Insecure file creation of "regxxxxxxx.tmp" in /tmp

|  | |
| --- | --- |
| [Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.") | Insecure file creation of "regxxxxxxx.tmp" in /tmp |

| | [Status](page.cgi?id=fields.html#bug_status): | CLOSED FIXED | | --- | --- | |  | | | **AppDB**: | [Show Apps affected by this bug](//appdb.winehq.org/viewbugs.php?iBugId=2715) | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Wine | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Wine "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | -unknown | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 0.9-pre | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86 Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P1 critical | | [Target Milestone](page.cgi?id=fields.html#target_milestone): | --- | | [Assigned To](page.cgi?id=fields.html#assigned_to): | Mr. Bugs | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords](describekeywords.cgi): |  | | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=2715&hide_resolved=1) | | |  | | Reported: | 2005-02-12 10:19 UTC by Giovanni Delvecchio | | --- | --- | | Modified: | 2016-01-05 15:48 UTC ([History](show_activity.cgi?id=2715)) | | CC List: | 0 users | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Regression SHA1:](page.cgi?id=fields.html#cf_regression_sha1sum "SHA1 of the git commit that caused the regression.") |  | | | [Fixed by SHA1:](page.cgi?id=fields.html#cf_fixedby_sha1sum "SHA1 of the git commit that fixed the bug.") |  | | | [Distribution:](page.cgi?id=fields.html#cf_distribution "A custom Drop Down field in this installation of Bugzilla.") | --- | | | [Staged patchset:](page.cgi?id=fields.html#cf_staged_patchset "URL to patchset in staging") |  | | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Possible patch for misc/registry.c**](attachment.cgi?id=765 "View the content of the attachment") (554 bytes, patch)  [2005-02-14 07:47 UTC](#attach_765 "Go to the comment associated with the attachment"), Giovanni Delvecchio | [Details](attachment.cgi?id=765&action=edit) | [Diff](attachment.cgi?id=765&action=diff) | | [View All](attachment.cgi?bugid=2715&action=viewall)  [Add an attachment](attachment.cgi?bugid=2715&action=enter) (back traces, logs, proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=2715&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2715#c0)  Giovanni Delvecchio    2005-02-12 10:19:45 UTC  ``` When an application is runned, wine makes a dump of windows registry in /tmp with name regxxxxxxx.tmp .  regxxxxxxx.tmp is created with -rw-r--r-- permissions.  This could represent a security problem in a multi-user environment.  Indeed, any local user could access to windows registry's dump and get sensitive  information, like passwords or other private data.  A local attacker could use a script to check every X seconds the presence of a  regxxxxxxx.tmp and copy it in his home directory for a successive analysis.  I have made some tests to reproduce this bug, running several applications and i  noted that it's been possibile get information in  HKEY_CURRENT_USER\Software\Microsoft\Protected Storage System Provider   and ------------------------------------------------------------------------------- [Software\\Microsoft\\Internet Account Manager\\Accounts\\00000008] "Account Name"="libero.it" "Connection Type"=dword:00000003 "POP3 Server"="pop3.libero.it" "POP3 User Name"="xxxxxxx" "POP3 Password2"=hex:xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,\   xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,\   xx,xx,xx,xx,xx,xx,xx,xx,xx,xx "POP3 Prompt for Password"=dword:00000000 "SMTP Server"="mail.libero.it" "SMTP Display Name"="xxxxxx" "SMTP Email Address"="[xxxxxx@libero.it](/cdn-cgi/l/email-protection#4f373737373737696c797b7423262d2a3d2061263b)" "POP3 Skip Account"=dword:00000000 "POP3 Port"=dword:0000006e "SMTP User Name"="" "SMTP Password2"=hex:xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,\   xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,xx,\   xx,xx,xx,xx,xx,xx,xx,xx,xx,xx "SMTP Use Sicily"=dword:00000000 "SMTP Prompt for Password"=dword:00000000  -------------------------------------------------------------------------------  where there were outlook's passwords encrypted.  Note that also if they are encrypted, they could be imported on the windows  registry system of the attacker and so gain illegal access to victim's account.  I think that regxxxxxxx.tmp should be created with 0600 permissions.   Best regards,  Giovanni Delvecchio ``` [Comment 1](show_bug.cgi?id=2715#c1)  Giovanni Delvecchio    2005-02-14 05:54:38 UTC  ``` Note: Also, 20050211 release is affected .  The problem is in the function  _get_tmp_fn(FILE **) ( in  $WineRelease/misc/registry.c)   --------------------------------------------------------- static LPSTR _get_tmp_fn(FILE **f) {     LPSTR ret;     int tmp_fd,count;      ret = _xmalloc(50);     for (count = 0;;) {         sprintf(ret,"/tmp/reg%lx%04x.tmp",(long)getpid(),count++); -->     if ((tmp_fd = open(ret,O_CREAT | O_EXCL | O_WRONLY,0666)) != -1) break;         if (errno != EEXIST) {             ERR("Unexpected error while open() call: %s\n",strerror(errno));             free(ret);             *f = NULL;             return NULL;         }     } ---------------------------------------------------  When regxxxxxx.tmp is created by open()  0666 mode is used.  Since that default umask = 022 :  (0666) &~ (022)  = 0644 = -rw-r--r--   Solution:  Use .. open(ret,O_CREAT | O_EXCL | O_WRONLY,0600))..     Best Regard,  Giovanni Delvecchio ``` [Comment 2](show_bug.cgi?id=2715#c2)  Giovanni Delvecchio    2005-02-14 07:47:31 UTC  ``` Created [attachment 765](attachment.cgi?id=765&action=diff "Possible patch for misc/registry.c") [[details]](attachment.cgi?id=765&action=edit "Possible patch for misc/registry.c") Possible patch for misc/registry.c  donwload the patch file  in your wine sources directory and launch:  patch -p1 < wine-registry.patch ``` [Comment 3](show_bug.cgi?id=2715#c3)  Tony Lambregts    2005-02-14 14:04:43 UTC  ``` If you want this patch included in Wine you should submit it to [wine-patches@winehq.org](/cdn-cgi/l/email-protection#d5a2bcbbb0f8a5b4a1b6bdb0a6f3f6e3e1eea2bcbbb0bda4fbbaa7b2). Patches submitted here tend to bit rot.  ``` [Comment 4](show_bug.cgi?id=2715#c4)  Marcus Meissner    2005-03-17 11:29:02 UTC  ``` The misc/registry.c code is gone in CVS right after 20050310 release.    The server/registry.c code safes in the users ~/.wine/ directory, where  the other system.reg etc files have the same permissions ... make this  directory 0700 (or your homedir) if you do not want to read it.    Marking fixed. ;)  ``` [Comment 5](show_bug.cgi?id=2715#c5)  Tony Lambregts    2005-04-03 13:23:14 UTC  ``` Closing. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=2715)
* - [XML](show_bug.cgi?ctype=xml&id=2715)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=2715)
* - Top of page

*First*
*Last*
*Prev*
*Next*

*This bug is not in your last
search results.*

* + [Intro](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

     [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](http://www.bugzilla.org/docs/4.0/en/html/bug_page.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=2715&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=2715&GoAheadAndLogIn=1#forgot)
    Login:

    [x]

[Privacy Policy](https://wiki.winehq.org/WineHQ_Wiki%3APrivacy_policy)

If you have a privacy inquiry regarding this site, please write to [[email protected]](/cdn-cgi/l/email-protection#9ceceef5eafdffe5dcebf5f2f9f4edb2f3eefb)

Hosted By
[![CodeWeavers](https://dl.winehq.org/share/images/cw_logo_sm.png "CodeWeavers - Run Windows applications and games on Mac and Linux")](http://www.codeweavers.com/)



=== Content from www.zone-h.org_13db83a2_20250125_024135.html ===
-
