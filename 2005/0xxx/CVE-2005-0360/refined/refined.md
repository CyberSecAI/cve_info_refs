- **Root cause of vulnerability:** The Microsoft Log Sink Class ActiveX control, which is part of the Microsoft SharePoint Portal Server Core Objects Library (pkmcore.dll), is incorrectly marked as "safe for scripting" and "safe for initialization" via the IObjectSafety interface. This control has the ability to create files on the local file system.
- **Weaknesses/vulnerabilities present:** The primary weakness is the incorrect marking of the ActiveX control as safe, despite its capability to create and append to arbitrary files. This violates the principle that a control marked as "safe for scripting" should not perform actions that could harm the user's system, regardless of how it is manipulated.
- **Impact of exploitation:** An attacker can exploit this vulnerability to create or append to arbitrary files on the victim's system. This can lead to the execution of malicious code if the created files are crafted accordingly or placed in sensitive locations (e.g., Windows Startup folder)
- **Attack vectors:** The attack vector involves convincing a user to click on a link in a malicious HTML document (e.g., web page, HTML email). This action instantiates the vulnerable ActiveX control within the context of the user's web browser (Internet Explorer) and allows the attacker to exploit the vulnerability.
- **Required attacker capabilities/position:** The attacker needs to be able to host a malicious HTML document and convince a victim to access it via Internet Explorer. The attacker doesn't need any special privileges, as the malicious actions are carried out within the context of the user's permissions.