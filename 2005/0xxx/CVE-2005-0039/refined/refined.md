```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from the use of Cipher Block Chaining (CBC) mode encryption by the IPsec Encapsulating Security Payload (ESP) protocol in tunneling mode, specifically when confidentiality is used without proper integrity protection. CBC mode encryption has a known weakness that allows bit-flipping attacks.",
    "weaknesses": [
      "Use of CBC mode encryption without integrity protection",
      "Lack of proper integrity checks on inner (tunneled) packets",
         "Inadequate error handling that leaks information via ICMP messages"
    ],
    "impact": "An attacker can recover the plaintext of IPsec communications by modifying encrypted packets. This allows for automated plaintext recovery.",
    "attack_vectors": [
      "Man-in-the-middle interception and modification of IPsec traffic.",
      "Bit-flipping attacks on the encrypted payload of IPsec packets.",
      "Interception of ICMP error messages that reveal portions of the inner packet."
    ],
    "attacker_capabilities": "An attacker needs to be able to intercept and modify IPsec traffic between security gateways. For some attack scenarios, they also need to be able to intercept ICMP messages. The attacker does not need to be authenticated."
  },
    "additional_details": {
        "attacks": [
           {
             "name": "Destination Address Rewriting",
              "description": "The attacker modifies the destination IP address of the inner, encrypted packet using bit-flipping. The intermediate gateway then routes the packet to the modified destination."
           },
           {
             "name": "IP Options modification",
             "description": "The attacker modifies the header length and source address of the inner packet via bit-flipping on the outer payload. When the modified inner packet is processed, it causes an ICMP Parameter Problem message that includes parts of the inner packet's plaintext, which can then be intercepted."
           },
           {
             "name": "Protocol Field modification",
             "description": "The attacker modifies the protocol field and source address of the inner packet. This causes the processing system to generate an ICMP Protocol Unreachable message, which is sent back to the modified source with the plaintext payload that can be intercepted."
            }
         ],
        "vulnerable_configurations": "IPsec ESP in tunnel mode with confidentiality only, or with integrity protection provided by a higher-layer protocol (which can be vulnerable if not implemented correctly). Some configurations using AH to provide integrity protection can also be vulnerable if not done carefully." ,
        "mitigations": [
           "Configure ESP to use both confidentiality and integrity protection (recommended)",
           "Use the Authentication Header (AH) protocol alongside ESP for integrity protection.",
           "Restrict ICMP error reporting using network filters or firewalls."
         ],
      "affected_vendors": {
         "Cisco Systems Inc.": "Affected (vulnerable to attacks against IPsec in tunnel mode without authentication configured). Configuration of authentication in addition to confidentiality on IPsec tunnels will prohibit the attack.",
         "Check Point": "Not Affected",
         "F5 Networks": "Not Affected (BIG-IP and TrafficShield products do not support IPSec. FirePass supports only configurations with both confidentiality and integrity/authentication)",
         "IBM": "Not Affected (AIX Operating System is not vulnerable to the issues described, recommends using AH).",
         "Netfilter": "Not Affected (does not implement IPsec)",
         "Nortel Networks": "Not Affected (see advisory bulletin 2005005827)",
          "Wind River Systems Inc.":"Not Affected",
           "3Com": "Unknown",
          "AT&T": "Unknown",
          "Alcatel": "Unknown",
           "Apple Computer Inc.": "Unknown",
            "Aruba Networks": "Unknown",
           "Avaya": "Unknown",
           "Avici Systems Inc.":"Unknown",
           "Borderware": "Unknown",
           "Certicom": "Unknown",
            "Charlotte's Web Networks": "Unknown",
           "Chiaro Networks":"Unknown",
           "Clavister": "Unknown",
          "Computer Associates": "Unknown",
           "Connectiva":"Unknown",
           "Cray Inc.": "Unknown",
           "Data Connection":"Unknown",
           "Debian": "Unknown",
           "Dlink": "Unknown",
           "EMC Corporation":"Unknown",
           "Engarde": "Unknown",
          "Extreme Networks": "Unknown",
           "F-Secure": "Unknown",
           "Fortinet": "Unknown",
           "Foundry Networks Inc.": "Unknown",
           "FreeBSD": "Unknown",
           "FreeS/WAN": "Unknown",
           "Fujitsu": "Unknown",
           "Global Technology Associates":"Unknown",
          "Hewlett-Packard Company": "Unknown",
           "Hitachi": "Unknown",
           "Hyperchip":"Unknown",
          "Immunix": "Unknown",
          "Ingrian Networks": "Unknown",
          "Intel": "Unknown",
         "Internet Initiative Japan (IIJ)": "Unknown",
          "Internet Security Systems Inc.": "Unknown",
          "Intoto":"Unknown",
          "Juniper Networks":"Unknown (vulnerable in unconventional configurations, not default config)",
           "KAME Project": "Unknown",
          "Linksys":"Unknown",
          "Lucent Technologies": "Unknown",
          "Luminous":"Unknown",
          "MandrakeSoft":"Unknown",
           "Microsoft Corporation": "Unknown",
          "MontaVista Software":"Unknown",
         "Multi-Tech Systems Inc.":"Unknown",
          "Multinet":"Unknown",
         "NEC Corporation":"Unknown",
          "NIST": "Unknown",
         "NetBSD":"Unknown",
         "Network Appliance":"Unknown",
         "NextHop":"Unknown",
          "Nokia": "Unknown",
          "Novell":"Unknown",
         "OpenBSD":"Unknown",
          "Openwall GNU/*/Linux": "Unknown",
         "QNX":"Unknown",
         "Red Hat Inc.":"Unknown",
           "Redback Networks Inc.":"Unknown",
          "Riverstone Networks": "Unknown",
         "SCO Linux":"Unknown",
          "SCO Unix":"Unknown",
           "SGI": "Unknown",
         "SSH Communications Security":"Unknown",
           "SafeNet": "Unknown",
           "Secure Computing Corporation":"Unknown",
           "SecureWorks":"Unknown",
           "Sequent":"Unknown",
           "SonicWALL Inc.":"Unknown",
           "Sony Corporation": "Unknown",
           "Stonesoft":"Unknown",
           "SuSE Inc.": "Unknown",
           "Sun Microsystems Inc.":"Unknown",
           "Symantec Corporation":"Unknown",
            "TurboLinux":"Unknown",
           "Unisys": "Unknown",
            "WatchGuard":"Unknown",
             "ZyXEL":"Unknown",
           "eSoft":"Unknown"

        }
    }
}
```