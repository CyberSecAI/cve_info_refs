=== Content from marc.info_d5e71d89_20250125_141710.html ===

```
[[prev in list](?l=bugtraq&m=111160402418223&w=2)] [[next in list](?l=bugtraq&m=111160688402801&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [SIG^2 G-TEC] SurgeMail Webmail Attachment Upload and XSS
From:       [<chewkeong () security ! org ! sg>](?a=110054398000003&r=1&w=2)
Date:       [2005-03-23 11:21:11](?l=bugtraq&r=1&w=2&b=200503)
Message-ID: [20050323112111.7236.qmail () www ! securityfocus ! com](?i=20050323112111.7236.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=111159967417903&q=mbox) or [body](?l=bugtraq&m=111159967417903&q=raw)]

SIG^2 Vulnerability Research Advisory

SurgeMail Webmail Attachment Upload and XSS Vulnerabilities

by Tan Chew Keong
Release Date: 23 Mar 2005

ADVISORY URL
<http://www.security.org.sg/vuln/surgemail22g3.html>

SUMMARY

SurgeMail (<http://netwinsite.com/surgemail/>) is a next generation Mail Server - \
Combining features, performance and ease of use into a single integrated product. \
Ideal on Windows NT/2K, or UNIX (Linux, Solaris etc) and supports all the standard \
protocols IMAP, POP3, SMTP, SSL, ESMTP.

A vulnerability was found in SurgeMail's Webmail file attachment upload feature. This \
vulnerability may be exploited by a malicious Webmail user to upload files to certain \
locations on the server, obtain file listings of certain directories, and/or send \
certain files on the server to him/herself. Two XSS vulnerabilities were also found.  \

TESTED SYSTEM

SurgeMail Version 2.2g3 Windows on English Win2K SP4.

DETAILS

This advisory document two Webmail vulnerabilities found in SurgeMail server. The \
first is a file attachment upload vulnerability. This vulnerability may be exploited \
by a malicious Webmail user to upload files to certain locations on the server, \
obtain file listings of certain directories, and/or send certain files on the server \
to him/herself. The second is a Cross-Site Scripting (XSS) vulnerability.

1. File Attachment Upload Vulnerability.

SurgeMail allows a logon user to attach files when composing a new email via the \
Webmail interface. Uploaded file attachments are temporarily stored in the \
c:\surgemail\web_work\u_xx\xxxx@hostname@127_0_0_1\attach\SomeRandomNumber\ \
directory. In particular, the value of SomeRandomNumber is part of this POST request \
(attach_id parameter) and is under the attacker's control. The server will create the \
directory "SomeRandomNumber" if it does not exist. By using directory traversal \
characters, it is possible to cause the uploaded files to be written to other \
directories.

2. Cross-Site Scripting (XSS) Vulnerabilities.

A user is allowed to configure an email auto-reply message using the Webmail \
interface. This auto-reply message consist of a message subject and a message header. \
It is possible to inject javascript in both these fields. If the Webmail \
administrator views this user's auto-reply message settings, the injected javascript \
will be executed on his browser. This may be exploited by a malicious user to steal \
the Webmail administrator's cookies or to redirect the administrator's browser to \
malicious websites.

Another XSS vulnerability occurs when webmail.exe is displaying an error message in \
response to an invalid value in the page parameter. The error message also reveals \
the installation path.

PATCH

Upgrade to the latest version of SurgeMail (Version 3.0c2 or later).

DISCLOSURE TIMELINE

18 Mar 05 - Vulnerability Discovered.
19 Mar 05 - Vulnerability Verification.
19 Mar 05 - Initial Vendor Notification.
22 Mar 05 - Vendor replied with fixed version.
23 Mar 05 - Public Release.

GREETINGS

All guys at SIG^2 G-TEC Lab
<http://www.security.org.sg/webdocs/g-tec.html>

"IT Security...the Gathering. By enthusiasts for enthusiasts."

[[prev in list](?l=bugtraq&m=111160402418223&w=2)] [[next in list](?l=bugtraq&m=111160688402801&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
AddÂ aÂ list |
SponsoredÂ byÂ [KoreLogic](http://www.korelogic.com/)



=== Content from netwinsite.com_e3949a70_20250125_141713.html ===


[![](https://surgemail.com/wp-content/uploads/2019/11/robot_80.png)](https://surgemail.com/ "SurgeMail") Windows/Linux Mail Server Software

* [Home](https://surgemail.com/)
* [Search](https://surgemail.com/knowledge-base/)
* [Download](https://surgemail.com/download-surgemail/)
* [Pricing](https://surgemail.com/prices/)
* [Support](https://surgemail.com/support/)
  + [Submit Ticket](https://surgemail.com/submit-ticket-2/)
  + [My Tickets](https://surgemail.com/my-tickets/)

# Mail Server Software

## What is SurgeMail?

SurgeMail is a fully functional SMTP / IMAP / POP / Webmail server, you install it on your own private machine running Linux or Windows in minutes and have a complete corporate carrier class system. With spam handing, live mirroring, modern fastÂ  WebMail and SSL / Encryption features to rival any system in the world.

Read an independent reivew:Â <https://www.capterra.com/p/212751/Surgemail/>

## WebMail built in

![](https://surgemail.com/wp-content/uploads/2019/11/surgeweb-1024x611.png)

## Admin Interface

![](https://surgemail.com/wp-content/uploads/2019/11/admin-1.png)

Surgemail includes DNS handling, greylisting, spam filtering, virus filtering, free signed SSL certificates via Lets Encrypt. Modern security protocols such as SSL/TLS and identification methods SPF, DKIM are built into Surgemail to ensure high delivery rates.Â  Most importantly management features which detect common problems and alert you automatically or let you know what settings you need to add/change.

[Download](/download-surgemail/)

[Buy Now](https://netwinsite.com/cgi-bin/keycgi?cmd=buy_new&product=surgemail)

## Direct install on linux with 'two' commands...

**wget https://netwinsite.com/setup.sh
sudo bash setup.sh**

**And your Linux Mail Server will be running and ready for business.**

**To get your Windows Mail Server installed simply download and run the installer directly.**

## Show me a Demo / Test system?

We recommend you install the software now on your own system to see how it works. But if you wish you can try a demo (limited) system using this button.

[Build Demo](https://netwinsite.com/cgi-bin/keycgi?cmd=demo_form)

Wow! surgemail ROCKS!!! ðŸ™‚ I have setup surgemail as a bastion host for 5 of our primary domains. We tried every other mail server out there trying to find something that works and that could keep up with our mail throughput.
If you are looking for a reliable and FAST mail server, BUY SURGEMAIL!

[![](https://surgemail.com/wp-content/uploads/2019/11/robert.png)](http://www.tellurian.com)
[Robert Boyle](http://www.tellurian.com)
[Manager Tellurian](http://www.tellurian.com)

ALL the programmers, support people, accounting people, well the entire company is OUTSTANDING. If you are or were a US Marine you will know what that means!
I have NEVER had the responsiveness that NetWin provides! The technical support is the best I have ever worked with. They do NOT give up, they help you all the way! Even before the purchase!
[![](https://surgemail.com/wp-content/uploads/2019/11/jon.jpg)](https://www.linkedin.com/in/john-unglert-66a3a930)
[John Unglert](https://www.linkedin.com/in/john-unglert-66a3a930)
[CEO at Ix Technologies](https://www.linkedin.com/in/john-unglert-66a3a930)

Having been professionally involved in the information technology arena since the early mainframe days. Having spent a good portion of my career in software architecture and development. I can say without a doubt that SurgeMail are what software SHOULD be.
[![](https://surgemail.com/wp-content/uploads/2019/11/david.jpg)](http://www.advwebsys.com)
[David Camm](http://www.advwebsys.com)
[President AdvancedWeb](http://www.advwebsys.com)

### Features

* [WebMail - Fast modern Web interface built in](https://surgemail.com/surgeweb-webmail/)
* [Web Admin - GUI Admin interface](https://surgemail.com/knowledge-base/web-admin-interface/)
* [User self Admin - GUI User / Domain admin interface](https://surgemail.com/knowledge-base/user-domain-self-admin/)
* [Spam / Virus - Spam & Virus protection features](https://surgemail.com/spam-and-virus-protection/)
* [Migration - Easily migrate from existing mail systems](https://surgemail.com/knowledge-base/migration/)
* [Calendar - Caldav compatible plugin](https://surgemail.com/knowledge-base/caldav-plugin-install/)
* [Encryption - At Rest / Transit encryption features](https:///encryption-features/)
* [MirrorÂ  - Live backup](https://surgemail.com/knowledge-base/mirror-setup/)
* [Archives - Archiving system builtin](https://surgemail.com/knowledge-base/global-settings-g_legal/)

### Knowledge Base Categories

* [SurgeWeb](https://surgemail.com/article-categories/surgeweb/)
* [Spam](https://surgemail.com/article-categories/spam/)
* [SMTP](https://surgemail.com/article-categories/smtp/)
* [Settings](https://surgemail.com/article-categories/settings/)
* [Security](https://surgemail.com/article-categories/security/)
* [Management](https://surgemail.com/article-categories/management/)
* [Installation](https://surgemail.com/article-categories/install/)
* [IMAP](https://surgemail.com/article-categories/imap/)
* [Accounts](https://surgemail.com/article-categories/accounts/)

Â© Copyright 2024 NetWin Limited


