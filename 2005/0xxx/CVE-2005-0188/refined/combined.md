=== Content from marc.info_635c77a4_20250125_231220.html ===

```
[[prev in list](?l=bugtraq&m=110626383310742&w=2)] [[next in list](?l=bugtraq&m=110616221411579&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=110619893521213&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Multiple vulnerabilities in the AtHoc Toolbar (#NISR19012005c)](?t=110616378300001&r=1&w=2)
From:       ["NGSSoftware Insight Security Research" <nisr () nextgenss ! com>](?a=100449261000003&r=1&w=2)
Date:       [2005-01-19 16:52:23](?l=bugtraq&r=1&w=2&b=200501)
Message-ID: [010501c4fe47$4269f570$2100a8c0 () SIRIUS](?i=010501c4fe47$4269f570$2100a8c0%20()%20SIRIUS)
[Download RAW [message](?l=bugtraq&m=110616363415176&q=mbox) or [body](?l=bugtraq&m=110616363415176&q=raw)]

NGSSoftware Insight Security Research Advisory

Name: Multiple Vulnerabilities in the AtHoc Toolbar For MSIE
Systems Affected: AtHoc Toolbar for MSIE
Severity: High
Vendor URL: <http://www.athoc.com/site/products/toolbar.asp>
Author: Mark Litchfield [ mark@ngssoftware.com ]
        John Heasman [ john@ngssoftware.com ]
Date of Public Advisory: 19th January 2004
Advisory number: #NISR19012005c
Advisory URL: <http://www.ngssoftware.com/advisories/athoc-01full.txt>
Reference: <http://www.ngssoftware.com/advisories/athoc-01.txt>

Description
***********

Multiple vulnerabilities have been discovered in the AtHoc toolbar which
can allow remote code execution through Internet Explorer when browsing to
a specially crafted webpage. AtHoc sell a development suite which can
allow a vendor to use their technology to create custom toolbars for their
own clients.

Among the most renound of AtHoc's toolbar clients are:

eBay
Accenture
ThomasRegister
ThomasRegional
Juniper Networks
WiredNews
CarFax
Agile PLM

Details
*******

The AtHoc toolbar comes with ActiveX component which exports a number of
methods relating to the specifics of toolbar, such a skin settings,
whether a debug log is to be kept, and numerous other options relating to
customisation.

When attempting to provide an overly long 'skin name' to the SetSkin()
method exported by the control, a stack based buffer overflows,
overwriting a saved return address on the stack and eventually allowing
arbitrary code to be executed.

When the AtHoc toolbar is closed and re-started, a debug log is written
containing various pieces of information relating to the success of
certain operations which have been performed on the AtHoc toolbar during
the users browsing session. One of the operations which is logged, is the
setting of a 'base url', a value which is used by the toolbar when
constructing absolute urls for certain web related functionality. The
SetBaseURL() function is used to set the base url.

If the url provided to the function is not valid, the url is logged by the
toolbar in the debug log, which is stored in the root of the drive on
which the toolbar is installed. The code which writes the invalid base url
to the debug log is vulnerable to a format string attack which can
overwrite arbitrary dwords in memory with arbitrary values. It is possible
to overwrite saved return addresses, function pointers, string pointers
and more to easily gain control over the execution flow of the process,
thus allowing arbitrary code execution.

The vulnerable component is marked safe for scripting by default, thereby
allowing the dangerous functionality to be accessed with little user
interaction.

Fix Information
***************

AtHoc has fixed these vulnerabilities and has advised the various vendors
to update their toolbars to use the latest components. These fixed
toolbars can be downloaded from the vendors respective websites.

About NGSSoftware
*****************

NGSSoftware design, research and develop intelligent, advanced application
security assessment scanners. Based in the United Kingdom, NGSSoftware
have offices in the South of London and the East Coast of Scotland.
NGSSoftware's sister company NGSConsulting, offers best of breed security
consulting services, specialising in application, host and network
security assessments.

<http://www.ngssoftware.com/>

Telephone +44 208 401 0070
Fax +44 208 401 0076

enquiries@ngssoftware.com

[[prev in list](?l=bugtraq&m=110626383310742&w=2)] [[next in list](?l=bugtraq&m=110616221411579&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=110619893521213&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_cd5fdb0d_20250125_231220.html ===

```
[[prev in list](?l=bugtraq&m=109713382400457&w=2)] [[next in list](?l=bugtraq&m=109711281813364&w=2)] [[prev in thread](?l=ntbugtraq&m=109708519727189&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Patch available for high risk flaws in the AtHoc Toolbar](?t=109708525100004&r=1&w=2)
From:       ["NGSSoftware Insight Security Research" <nisr () nextgenss ! com>](?a=100449261000003&r=1&w=2)
Date:       [2004-10-06 16:55:11](?l=bugtraq&r=1&w=2&b=200410)
Message-ID: [20041006163651.6772615F55C () mail ! ngssoftware ! com](?i=20041006163651.6772615F55C%20()%20mail%20!%20ngssoftware%20!%20com)
[Download RAW [message](?l=bugtraq&m=109710974324742&q=mbox) or [body](?l=bugtraq&m=109710974324742&q=raw)]

Mark Litchfield and John Heasman of NGSSoftware have discovered two high
risk vulnerabilities in the AtHoc Toolbar. The AtHoc toolbar is a plugin for
Microsoft's Internet Explorer. The toolbar is redistributed to users of

eBay
Accenture
ThomasRegister
ThomasRegional
Juniper Networks
WiredNews
CarFax
Agile PLM

The flaws, that include a remotely exploitable buffer overflow and a format
string bug, have been fixed by AtHoc and an updated toolbar has been
distributed to the affected companies. Clients of any of the companies
listed above that have installed the toolbar should ensure that they
download the updated version.

NGSSoftware are going to withhold details about these flaws for three
months. Full details will be published on the 6th of January 2005. This
three month window will allow users of the toolbar the time needed to obtain
the updated version before the details are released to the general public.
This reflects NGSSoftware's new approach to responsible disclosure.

NGSSoftware Insight Security Research
<http://www.databasesecurity.com/>
<http://www.nextgenss.com/>
+44(0)208 401 0070

[[prev in list](?l=bugtraq&m=109713382400457&w=2)] [[next in list](?l=bugtraq&m=109711281813364&w=2)] [[prev in thread](?l=ntbugtraq&m=109708519727189&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


