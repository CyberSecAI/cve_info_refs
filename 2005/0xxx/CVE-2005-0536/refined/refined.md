- **Root cause of vulnerability**: Multiple vulnerabilities found in MediaWiki: cross-site scripting (XSS), cross-site request forgery (CSRF), and insufficient sanitization of input parameters in the image deletion code.
- **Weaknesses/vulnerabilities present**:
  - Cross-site scripting (XSS): Allows injection of malicious script code that will be executed in a user's browser session.
  - Cross-site request forgery (CSRF): Allows attackers to use JavaScript submitted forms to perform restricted actions on behalf of the user.
  - Insufficient input sanitization: Image deletion code does not properly sanitize input parameters, leading to directory traversal.
- **Impact of exploitation**:
    - XSS: Session hijacking and authentication cookie theft, malicious code execution within user's browser session
    - CSRF: Performing restricted actions by the attacker using a valid user session
    - Directory traversal via image deletion: Authenticated administrators could delete arbitrary files on the server.
- **Attack vectors**:
  - XSS: By tricking a user to load a carefully crafted URL.
  - CSRF: By using JavaScript submitted forms.
  - Directory traversal: Using a specially crafted input to the image deletion function.
- **Required attacker capabilities/position**:
  - XSS/CSRF: Requires the user to be tricked into loading a malicious URL or interacting with malicious content.
  - Directory traversal: Requires the attacker to be an authenticated administrator.