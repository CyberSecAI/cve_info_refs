=== Content from www.vuxml.org_652e9652_20250125_100308.html ===

[FreeBSD
VuXML: Documenting security issues in FreeBSD and the
FreeBSD Ports Collection](./)
# xshisen -- local buffer overflows

| | Affected packages | | | | | | --- | --- | --- | --- | --- | |  |  | [xshisen](pkg-xshisen.html) | < | 1.36\_1 | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

## Details

| VuXML ID | 56971fa6-641c-11d9-a097-000854d03344 |
| --- | --- |
| Discovery | 2005-01-11 |
| Entry | 2005-01-11 |
| Modified | 2005-01-19 |

Steve Kemp has found buffer overflows in the handling
of the command line flag -KCONV and the XSHISENLIB environment
variable. Ulf Härnhammer has detected an unbounded copy from
the GECOS field to a char array. All overflows can be exploited
to gain group games privileges.

## References

| CVE Name | CVE-2003-1053 |
| --- | --- |
| CVE Name | CVE-2005-0117 |
| URL | <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=213957> |
| URL | <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=289784> |

---

Copyright © 2003-2005 [Jacques Vidrine and contributors](contributors.html).

Please see the source of this document for full copyright
information.



=== Content from bugs.debian.org_55dea862_20250125_100307.html ===

# Debian Bug report logs - #289784 xshisen: buffer overflow when handling GECOS field

[![version graph](version.cgi?found=1.51-1-1;collapse=1;absolute=0;package=xshisen;height=2;width=2;fixed=xshisen%2F1.51-1-2)](version.cgi?fixed=xshisen%2F1.51-1-2;info=1;package=xshisen;collapse=1;absolute=0;found=1.51-1-1)

Package:
[xshisen](pkgreport.cgi?package=xshisen);
Maintainer for [xshisen](pkgreport.cgi?package=xshisen) is [Debian QA Group <packages@qa.debian.org>](pkgreport.cgi?maint=packages%40qa.debian.org); Source for [xshisen](pkgreport.cgi?package=xshisen) is [src:xshisen](pkgreport.cgi?src=xshisen) ([PTS](https://tracker.debian.org/pkg/xshisen), [buildd](https://buildd.debian.org/xshisen), [popcon](https://qa.debian.org/popcon.php?package=xshisen)).

Reported by: ["Ulf Harnhammar" <metaur@operamail.com>](pkgreport.cgi?submitter=metaur%40operamail.com)

Date: Tue, 11 Jan 2005 00:33:02 UTC

Severity: important

Tags: fixed, patch, security

Found in version 1.51-1-1

Fixed in version xshisen/1.51-1-2

**Done:** zakame@spunge.org (Zak B. Elep)

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=289784;mbox=yes), [status mbox](bugreport.cgi?bug=289784;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=289784;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Grzegorz Prokopski (Debian Developer) <gadek@debian.org>`:

`Bug#289784`; Package `xshisen`.
([full text](bugreport.cgi?bug=289784;msg=2), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `"Ulf Harnhammar" <metaur@operamail.com>`:

New Bug report received and forwarded. Copy sent to `Grzegorz Prokopski (Debian Developer) <gadek@debian.org>`.
([full text](bugreport.cgi?bug=289784;msg=4), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=289784;msg=5), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=metaur%40operamail.com)
From: "Ulf Harnhammar" <metaur@operamail.com>
To: submit@bugs.debian.org
Cc: masaoki@techfirm.co.jp, naddy@mips.inka.de
Subject: xshisen: buffer overflow when handling GECOS field
Date: Tue, 11 Jan 2005 01:18:00 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=289784;msg=5) (text/plain, inline)]
```
```
Subject: xshisen: buffer overflow when handling GECOS field
Package: xshisen
Version: 1.51-1-1
Severity: important
Tags: security patch

Hello,

I have found a buffer overflow in xshisen. It copies data from a user's GECOS field in
/etc/passwd to a char array. In the rather unlikely event where that GECOS field is
about 160 bytes long, the char array is overflowed which can be used to get a shell with
gid games. I have attached a patch that fixes this problem.

Here is a line from my /etc/passwd file (after wrapping it) that causes this bug:

metaur:x:1000:1000:UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU
UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU
UUUUU,,,:/home/metaur:/bin/bash

I have Cc'ed the upstream developer and Naddy who's involved with FreeBSD's Ports
Collection. They might also want to check out some earlier buffer overflows in xshisen
that Steve Kemp found in 2003:  <http://bugs.debian.org/213957>

// Ulf Harnhammar for the Debian Security Audit Project
   <http://www.debian.org/security/audit/>

-- System Information:
Debian Release: 3.1
  APT prefers testing
  APT policy: (500, 'testing')
Architecture: i386 (i686)
Kernel: Linux 2.6.8-1-686
Locale: LANG=en_US, LC_CTYPE=en_US (charmap=ISO-8859-1)

Versions of packages xshisen depends on:
ii  libc6                    2.3.2.ds1-20    GNU C Library: Shared libraries an
ii  libgcc1                  1:3.4.3-6       GCC support library
ii  libstdc++5               1:3.3.5-5       The GNU Standard C++ Library v3
ii  libxaw7                  4.3.0.dfsg.1-10 X Athena widget set library
ii  xlibs                    4.3.0.dfsg.1-10 X Keyboard Extension (XKB) configu

-- no debconf information

--
_____________________________________________________________
Web-based SMS services available at <http://www.operamail.com>.
From your mailbox to local or overseas cell phones.

Powered by Outblaze

```
```
[[xshisen.bufoflow.patch](bugreport.cgi?att=1;bug=289784;filename=xshisen.bufoflow.patch;msg=5) (application/octet-stream, attachment)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Grzegorz Prokopski (Debian Developer) <gadek@debian.org>`:

`Bug#289784`; Package `xshisen`.
([full text](bugreport.cgi?bug=289784;msg=7), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `Ulf Härnhammar <Ulf.Harnhammar.9485@student.uu.se>`:

Extra info received and forwarded to list. Copy sent to `Grzegorz Prokopski (Debian Developer) <gadek@debian.org>`.
([full text](bugreport.cgi?bug=289784;msg=9), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 289784@bugs.debian.org ([full text](bugreport.cgi?bug=289784;msg=10), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=Ulf.Harnhammar.9485%40student.uu.se)
From: Ulf Härnhammar <Ulf.Harnhammar.9485@student.uu.se>
To: Steve Kemp <steve@shellcode.org>
Cc: debian-audit@shellcode.org, 289784@bugs.debian.org
Subject: Re: [Debian-audit] xshisen (again)
Date: Wed, 12 Jan 2005 17:29:12 +0100
```
Quoting Steve Kemp <steve@shellcode.org>:

> > <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=289784>
>
>   That's an .. unlikely .. bug to occur in practise.  I guess only
>  root can modify the GECOS field.

No, you can use the chfn command to change all data in your own GECOS field
except your real name. The command checks the length of all data, so you
probably can't use it for this attack (it might be possible to enter the
maximum amount in each field and make it reach 160 bytes that way). There are
other systems that will let you edit your GECOS field, like webmin (I think)
and more.

It's not a really serious bug, but IMHO worth fixing.

--
Ulf Harnhammar
<http://www.advogato.org/person/metaur/>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Grzegorz Prokopski (Debian Developer) <gadek@debian.org>`:

`Bug#289784`; Package `xshisen`.
([full text](bugreport.cgi?bug=289784;msg=12), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent** to `"Grzegorz B. Prokopski" <gadek@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Grzegorz Prokopski (Debian Developer) <gadek@debian.org>`.
([full text](bugreport.cgi?bug=289784;msg=14), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 289784@bugs.debian.org ([full text](bugreport.cgi?bug=289784;msg=15), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=gadek%40debian.org)
From: "Grzegorz B. Prokopski" <gadek@debian.org>
To: Ulf Härnhammar <Ulf.Harnhammar.9485@student.uu.se>, 289784@bugs.debian.org
Cc: Steve Kemp <steve@shellcode.org>, debian-audit@shellcode.org
Subject: Re: Bug#289784: [Debian-audit] xshisen (again)
Date: Wed, 12 Jan 2005 14:00:46 -0500
```
On Wed, 2005-01-12 at 17:29 +0100, Ulf Härnhammar wrote:
> Quoting Steve Kemp <steve@shellcode.org>:
>
> > > <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=289784>
> >
> >   That's an .. unlikely .. bug to occur in practise.  I guess only
> >  root can modify the GECOS field.
>
> No, you can use the chfn command to change all data in your own GECOS field
> except your real name. The command checks the length of all data, so you
> probably can't use it for this attack (it might be possible to enter the
> maximum amount in each field and make it reach 160 bytes that way). There are
> other systems that will let you edit your GECOS field, like webmin (I think)
> and more.
>
> It's not a really serious bug, but IMHO worth fixing.

I do not have my new GPG key signed yet (sigh) so I am in no position to
perform an upload.  Could somebody please apply the fix and NMU?

Thanks,

				Grzegorz B. Prokopski

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Grzegorz Prokopski (Debian Developer) <gadek@debian.org>`:

`Bug#289784`; Package `xshisen`.
([full text](bugreport.cgi?bug=289784;msg=17), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent** to `Steve Kemp <steve@shellcode.org>`:

Extra info received and forwarded to list. Copy sent to `Grzegorz Prokopski (Debian Developer) <gadek@debian.org>`.
([full text](bugreport.cgi?bug=289784;msg=19), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 289784@bugs.debian.org ([full text](bugreport.cgi?bug=289784;msg=20), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=steve%40shellcode.org)
From: Steve Kemp <steve@shellcode.org>
To: "Grzegorz B. Prokopski" <gadek@debian.org>
Cc: Ulf H?rnhammar <Ulf.Harnhammar.9485@student.uu.se>,
289784@bugs.debian.org, Steve Kemp <steve@shellcode.org>,
debian-audit@shellcode.org
Subject: Re: Bug#289784: [Debian-audit] xshisen (again)
Date: Wed, 12 Jan 2005 19:02:20 +0000
```
On Wed, Jan 12, 2005 at 02:00:46PM -0500, Grzegorz B. Prokopski wrote:

> > >   That's an .. unlikely .. bug to occur in practise.  I guess only
> > >  root can modify the GECOS field.
> >
> > No, you can use the chfn command to change all data in your own GECOS field
> > except your real name. The command checks the length of all data, so you
> > probably can't use it for this attack (it might be possible to enter the
> > maximum amount in each field and make it reach 160 bytes that way). There are
> > other systems that will let you edit your GECOS field, like webmin (I think)
> > and more.
> >
> > It's not a really serious bug, but IMHO worth fixing.
>
> I do not have my new GPG key signed yet (sigh) so I am in no position to
> perform an upload.  Could somebody please apply the fix and NMU?

  I will do so tomorrow if nobody else beats me to it.

Steve
--

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Grzegorz Prokopski (Debian Developer) <gadek@debian.org>`:

`Bug#289784`; Package `xshisen`.
([full text](bugreport.cgi?bug=289784;msg=22), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent** to `Martin Schulze <joey@infodrom.org>`:

Extra info received and forwarded to list. Copy sent to `Grzegorz Prokopski (Debian Developer) <gadek@debian.org>`.
([full text](bugreport.cgi?bug=289784;msg=24), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 289784@bugs.debian.org ([full text](bugreport.cgi?bug=289784;msg=25), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=joey%40infodrom.org)
From: Martin Schulze <joey@infodrom.org>
To: 289784@bugs.debian.org
Subject: CAN-2005-0117 assigned to xshisen GECOS overflow
Date: Wed, 19 Jan 2005 09:12:54 +0100
```
======================================================
Candidate: CAN-2005-0117
URL: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-0117>
Reference: MISC:<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=289784>
Reference: CONFIRM:<http://www.vuxml.org/freebsd/56971fa6-641c-11d9-a097-000854d03344.html>

Buffer overflow in xshisen before 1.36 allows local users to execute
arbitrary code via a long GECOS field.

Please use this id in the changelog when you fix the problem.

Regards,

	Joey

--
Ten years and still binary compatible.  -- XFree86

Please always Cc to me when replying to me on the lists.

```

---

**Tags added: fixed**
Request was from `Joey Hess <joeyh@debian.org>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=289784;msg=27), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=27), [link](#26)).

---

**Reply sent** to `zakame@spunge.org (Zak B. Elep)`:

You have taken responsibility.
([full text](bugreport.cgi?bug=289784;msg=29), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=29), [link](#28)).

---

**Notification sent** to `"Ulf Harnhammar" <metaur@operamail.com>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=289784;msg=31), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=31), [link](#30)).

---

[Message #32](#32) received at 289784-close@bugs.debian.org ([full text](bugreport.cgi?bug=289784;msg=32), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=32), reply):

![](/cgi-bin/libravatar.cgi?email=zakame%40spunge.org)
From: zakame@spunge.org (Zak B. Elep)
To: 289784-close@bugs.debian.org
Subject: Bug#289784: fixed in xshisen 1.51-1-2
Date: Tue, 21 Feb 2006 07:17:10 -0800
```
Source: xshisen
Source-Version: 1.51-1-2

We believe that the bug you reported is fixed in the latest version of
xshisen, which is due to be installed in the Debian FTP archive:

xshisen_1.51-1-2.diff.gz
  to pool/main/x/xshisen/xshisen_1.51-1-2.diff.gz
xshisen_1.51-1-2.dsc
  to pool/main/x/xshisen/xshisen_1.51-1-2.dsc
xshisen_1.51-1-2_i386.deb
  to pool/main/x/xshisen/xshisen_1.51-1-2_i386.deb
xshisen_1.51-1.orig.tar.gz
  to pool/main/x/xshisen/xshisen_1.51-1.orig.tar.gz

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 289784@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Zak B. Elep <zakame@spunge.org> (supplier of updated xshisen package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Tue, 21 Feb 2006 22:35:26 +0800
Source: xshisen
Binary: xshisen
Architecture: source i386
Version: 1.51-1-2
Distribution: unstable
Urgency: high
Maintainer: Zak B. Elep <zakame@spunge.org>
Changed-By: Zak B. Elep <zakame@spunge.org>
Description:
 xshisen    - Shisen-sho puzzle game for X11
Closes: [213957](bugreport.cgi?bug=213957) [289784](bugreport.cgi?bug=289784) [291279](bugreport.cgi?bug=291279) [291613](bugreport.cgi?bug=291613) [292065](bugreport.cgi?bug=292065) [346854](bugreport.cgi?bug=346854)
Changes:
 xshisen (1.51-1-2) unstable; urgency=low
 .
   * New maintainer (as agreed with former maintainer; see
     <http://lists.debian.org/debian-devel/2006/02/msg00007.html>)
   * Fix strange source packaging problem (Closes: #[291279](bugreport.cgi?bug=291279))
   * debian/control:
     - Changed build system to CDBS + debhelper.
     - Bump Standards-Version.
     - Bump debhelper Build-Depends to (>= 5) ; updated compat too.
     - Slightly touch description; added homepage too.
   * debian/patches:
     - Added 10_oldfixes.patch .  Must sort the various hunks out soon.
       Acknowledging NMUs .
     - Added 11_manpage_fixes.patch to properly format C and ja manpages.
     - Added 20_autotools_update.patch .
   * debian/rules:
     - Remove extra Japanese manpages as suggested by Nicolas François.
       Remove app-defaults for these extra locales too.
   * debian/menu:
     - Properly quote menu entry.
 .
 xshisen (1.51-1-1.3) unstable; urgency=low
 .
   * Non-maintainer upload to do xlibs-dev transition.
   * Update debian/control to not build-depend on xlibs-dev anymore. (Closes:
     #[346854](bugreport.cgi?bug=346854))
   * Fix Makefile.in to reflect GNU make behaviour change regarding line
     continuations and whitespace.
 .
 xshisen (1.51-1-1.2) unstable; urgency=HIGH
 .
   * NMU (at maintainer's request).
   * Add NO_GLOBAL_HIGHSCORE define which crudely disables the support for
     a global score file.
   * Remove sgid bit. Closes: #[291613](bugreport.cgi?bug=291613), #[292065](bugreport.cgi?bug=292065)
   * Comment out code in postinst that set up /var/games/xshisen.scores,
     but for now, do not delete that file on upgrade.
   * Add README.Debian.
 .
 xshisen (1.51-1-1.1) unstable; urgency=HIGH
 .
   * NMU
   * Fix buffer overflow in handling of GECOS field (CAN-2005-0117)
     using patch from Ulf Harnhammar. Closes: #[289784](bugreport.cgi?bug=289784)
 .
 xshisen (1.51-1-1) unstable; urgency=high
 .
   * Non-maintainer upload with consent from Grzegorz.
   * Fix a locally exploitable buffer overflow allowing GID(games).
     (Closes: #[213957](bugreport.cgi?bug=213957))
Files:
 9bb81ea94342beafadfc0554cda517aa 660 games optional xshisen_1.51-1-2.dsc
 5f0ef1d7811401876de717fd6771fe47 85350 games optional xshisen_1.51-1.orig.tar.gz
 6f2400fcf46f8feecb2f25e2547e2951 79053 games optional xshisen_1.51-1-2.diff.gz
 51737af066b25119295ba5c8317ee375 61262 games optional xshisen_1.51-1-2_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (GNU/Linux)

iD8DBQFD+yumlAuUx1tI/64RAgQpAJ4+6/S5G1rOUtHbGbu6d3/BoGL1ewCfdXuT
oXQMYfMT/5MqMDvqwd6rfHM=
=mJ0A
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Tue, 26 Jun 2007 20:31:52 GMT) ([full text](bugreport.cgi?bug=289784;msg=34), [mbox](bugreport.cgi?bug=289784;mbox=yes;msg=34), [link](#33)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=289784).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 10:03:07 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


