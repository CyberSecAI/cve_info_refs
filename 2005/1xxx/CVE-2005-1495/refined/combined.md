=== Content from marc.info_c4863fd0_20250125_225457.html ===

```
[[prev in list](?l=bugtraq&m=111531609618182&w=2)] [[next in list](?l=bugtraq&m=111531740305049&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Oracle 9i / 10g Fine Grained Auditing Issue
From:       [Alexander Kornbrust <ak () red-database-security ! com>](?a=111472267600006&r=1&w=2)
Date:       [2005-05-05 10:58:19](?l=bugtraq&r=1&w=2&b=200505)
Message-ID: [20050505105819.25619.qmail () www ! securityfocus ! com](?i=20050505105819.25619.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=111531683824209&q=mbox) or [body](?l=bugtraq&m=111531683824209&q=raw)]

Red-Database-Security GmbH Oracle Security Advisory

Name               Oracle 9i / 10g Fine Grained Auditing Issue
Systems Affected   Oracle Database 9i / 10g
Severity           Medium Risk
Category           FGA Auditing disabled
Vendor URL         <http://www.oracle.com>
Author             Alexander Kornbrust (ak at red-database-security.com)
Date               03 May 2005  (V 1.00)

Description
###########
Fine grained audit (FGA) is disabled for all users if the user SYS runs a
SELECT statement on a FGA object.

This issue is not related to the Oracle Critical Patch Update 2005.

Workarounds
###########
Do not run SQL for FGA objects as user SYS.
Flush the shared pool (or restart the database) to activate auditing again.

More details including testcase available:
##########################################

<http://www.red-database-security.com/advisory/oracle-fine-grained-auditing-issue.html>

Patch Information
#################
This information has been public for months but Oracle never released a
security alert for this issue.

Applying patchset 10.1.0.4 is fixing this issue for Oracle 10g.
Oracle 9i is still vulnerable.

History:
########
17 February 2004	Oracle logged and published this bug in Metalink
                  (Bugid: 3450991)
28 March 2005     Oracle released patchset 10.1.0.4
                  (Information included in the patchset details)

About Red-Database-Security GmbH
#################################
Red-Database-Security GmbH is a specialist in Oracle Security.

<http://www.red-database-security.com>
[[prev in list](?l=bugtraq&m=111531609618182&w=2)] [[next in list](?l=bugtraq&m=111531740305049&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.red-database-security.com_dea7c91a_20250125_225458.html ===


[![](http://www.red-database-security.com/pictures/red_database_security_logo.jpg)](http://www.red-database-security.com)[![](http://red-database-security.com/pictures/teaser.jpg)](http://www.red-database-security.com/security_training/oracle_anti_hacker_training.html)

| Services [Oracle Audit / Hardening](http://www.red-database-security.com/services/audit.html) [Security Training](http://www.red-database-security.com/security_training/oracle_security_training.html) [Consulting](http://www.red-database-security.com/services/consulting.html)  Information [Oracle Security Blog](http://blog.red-database-security.com)  [Published Alerts](http://www.red-database-security.com/advisory/published_alerts.html)[RSS Published Alerts](http://www.red-database-security.com/advisory/published_alerts.xml) [Upcoming Alerts](http://www.red-database-security.com/advisory/upcoming_alerts.html)[RSS Published Alerts](http://www.red-database-security.com/advisory/published_alerts.xml) [Patch Information](http://www.red-database-security.com/whitepaper/oracle_patches.html) [Whitepaper](http://www.red-database-security.com/whitepaper/oracle_security_whitepaper.html) [Presentations](http://www.red-database-security.com/whitepaper/presentations.html) [Oracle Fact Sheets](http://www.red-database-security.com/whitepaper/fact_sheets.html) [Exploits](http://www.red-database-security.com/exploits/oracle_exploits.html) [Tutorials](http://www.red-database-security.com/tutorial/tutorials.html) [Videos](http://www.red-database-security.com/videos/oracle_videos.html)  [Scripts](http://www.red-database-security.com/scripts/oracle_security_scripts.html)  News & Events [Events](http://www.red-database-security.com/events/events.html) [News](http://www.red-database-security.com/news/rds_news.html)  Company [Contact](http://www.red-database-security.com/contact/contact.html) [People](http://www.red-database-security.com/people/people.html) [Partner](http://www.red-database-security.com/partner/partner.html) [Impressum](http://www.red-database-security.com/impressum/impressum.html) [Sitemap](http://www.red-database-security.com/sitemap/sitemap.html)    [Search](http://www.red-database-security.com/search/search.html)   | Search Red-Database-Security | | --- | | Oracle Fine Grained Auditing Issue in Oracle 9i / 10g  | **Name** | Oracle Fine Grained Auditing Issue in Oracle 9i / 10g | | --- | --- | | **Systems Affected** | Oracle Database 9i / 10g | | **Severity** | Medium Risk | | **Category** | Auditing disabled | | **Vendor URL** | <http://www.oracle.com/> | | **Author** | Alexander Kornbrust (ak at red-database-security.com) | | **Date** | 02 May 2005 (V 1.01) | | **US-CERT VU#** | 777773 |   Details Fine grained audit (FGA) does not work if the user SYS runs a SELECT statements. There are 2 issues. The SELECT statement issued by SYS is not audited. Once SYS selects the table all subsequent SELECTs by other users are NOT audited.  Testcase  **1. Create user and objects and add policy** connect /as sysdba grant dba to fga identified by fga; conn fga/fga create table emp as select \* from scott.emp; execute dbms\_fga.add\_policy(object\_schema=>'FGA', object\_name=>'EMP',policy\_name=>'FGA\_POLICY');  **2. Run SQL from fga user** conn fga/fga select count(\*) from fga.emp; select sql\_text,to\_char(timestamp,'HH24:MI:SS') time from sys.dba\_fga\_audit\_trail;  --> It will return 1 row.  **3. Run SQL from SYS user** conn /as sysdba select count(\*) from fga.emp; select sql\_text,to\_char(timestamp,'HH24:MI:SS') time from sys.dba\_fga\_audit\_trail;  --> It will return 1 row which was obtained by step 2.  A new row was not inserted.  **4. Run SQL from fga user again**  conn fga/fga select count(\*) from fga.emp; select sql\_text,to\_char(timestamp,'HH24:MI:SS') time from sys.dba\_fga\_audit\_trail;  --> It will return 1 row which was obtained by step 2.  A new row was not inserted again.  Patch Information Apply patchset 10.1.0.4. for Oracle 10g. This bug is not fixed in 9.2.0.6 with the latest patches from Oracle Critical Patch Update April 2005 applied.  History 17-feb-2004 Oracle logged and published this bug in Metalink (Bugid: 3450991) 28-mar-2005 Oracle release patchset 10.1.0.4 (for Linux) 05-may-2005 US CERT VU# added (V1.01)   © 2005 by Red-Database-Security GmbH - last update 04-nov-2005 | Oracle HTMLDB Oracle HTML DB is a rapid web application development tool for the Oracle database. Using only a web browser and limited programming experience, you can develop and deploy professional-looking applications that are both fast and secure. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |


