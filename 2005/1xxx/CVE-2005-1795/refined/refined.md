- **Root cause of vulnerability:** The `system()` function in the `filecopy()` function within `shared/misc.c` is used to execute the `ditto` command on macOS without proper sanitization of filenames.
- **Weaknesses/vulnerabilities present:** Improper input sanitization. Specifically, filenames are not checked or quoted for shell special characters before being passed to the `system()` function.
- **Impact of exploitation:** A local attacker can elevate their privileges to that of the user running the ClamAV process. By injecting shell commands into a filename, the attacker can execute arbitrary code with the privileges of the ClamAV process.
- **Attack vectors:** Local, a malicious file with a crafted filename is needed to trigger the vulnerable code. The ClamAV process must attempt to move the infected file.
- **Required attacker capabilities/position:** The attacker needs to be able to create a file with a crafted name on the local system. They also need to be able to trigger a ClamAV scan that will attempt to move the file.