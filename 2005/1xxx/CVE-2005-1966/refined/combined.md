=== Content from marc.info_a32dbdbc_20250125_230458.html ===

```
[[prev in list](?l=bugtraq&m=111869542619304&w=2)] [[next in list](?l=bugtraq&m=111868970709543&w=2)] [[prev in thread](?l=bugtraq&m=111835539312985&w=2)] [[next in thread](?l=bugtraq&m=111853173403645&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Re: Arbitrary code execution in eping plugin](?t=111835540000003&r=1&w=2)
From:       [Oliver Monneke <oliver () codersquad ! de>](?a=111868477000004&r=1&w=2)
Date:       [2005-06-10 20:35:41](?l=bugtraq&r=1&w=2&b=200506)
Message-ID: [42A9F99D.6040501 () codersquad ! de](?i=42A9F99D.6040501%20()%20codersquad%20!%20de)
[Download RAW [message](?l=bugtraq&m=111868460811287&q=mbox) or [body](?l=bugtraq&m=111868460811287&q=raw)]

Hello,

the problem is in function eping_validaddr() in functions.php where the
host is checked if it is valid as the name says...
But the only check is to see if it is a valid ip adress for eping, here
is the code:

--------------8<-----------------------------------------8<-------------------------------------
 function eping_validaddr($eping_hosttocheck)
{
If
(ereg("(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[[01]](#01)?[0-9][0-9]?)\ \
.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[[01]](#01)?[0-9][0-9]?)",  \
$eping_hosttocheck))  {
        return true;
    }
    else
    {
        return false;
    }
--------------8<-----------------------------------------8<-------------------------------------

I am sorry but I am a coder and my eyes are bleeding when looking at
stuff like that so here is my suggestion for replaceing the if-statement:
if(preg_match("/^[0-9]{2,3}?\.[0-9]{1,3}?\.[0-9]{1,3}?\.[0-9]{1,3}?$/",
$eping_hosttocheck))

So only IP-Adresses are allowed and no kind of code injection is possible.

And everyone who thinks 'will he ever stop writeing?' will be disappointed:
The same vulnerability also exists in the eTrace modul from E107. It
looks like the same Author of the ePing modul.
The only difference is the you have to search for 'etrace' instead of
'eping' in the files

Greetings from Germany
Oliver

--

use the force - treat the source
<http://codersquad.de>

[[prev in list](?l=bugtraq&m=111869542619304&w=2)] [[next in list](?l=bugtraq&m=111868970709543&w=2)] [[prev in thread](?l=bugtraq&m=111835539312985&w=2)] [[next in thread](?l=bugtraq&m=111853173403645&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


