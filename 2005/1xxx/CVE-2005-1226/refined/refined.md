The provided content details multiple vulnerabilities in Coppermine Photo Gallery 1.3.2, including SQL injection and plaintext password storage.

**A - SQL Injection**

*   **Root Cause:** The application takes data from a cookie, base64 decodes and unserializes it. The unserialized data, intended to be an array of integers ($FAVPICS), is then used to construct a SQL query without proper sanitization.
*   **Weakness:** Lack of input sanitization on cookie data before using it in a SQL query. Specifically, the `$FAVPICS` array elements are directly concatenated into a SQL `IN` clause without any checks.
*  **Impact:** Attackers can inject arbitrary SQL code, potentially allowing them to retrieve sensitive information from the database.
*   **Attack Vector:** Maliciously crafted cookie containing base64 encoded and serialized data with SQL injection payloads.
*   **Attacker Capabilities:** Ability to set a browser cookie and potentially a custom script or tool to craft the malicious cookie.

**B - Plaintext Passwords in Database**

*   **Root Cause:** User passwords are stored in the database in plaintext rather than hashed, exposing them in case of a database breach.
*   **Weakness:** Storage of sensitive user passwords in plaintext.
*   **Impact:**  If an attacker manages to exploit the SQL injection or gain unauthorized access to the database, they can easily retrieve and use administrator passwords, gaining admin privileges.
*   **Attack Vector:** Exploiting the SQL injection vulnerability (A) or gaining direct access to the database.
*   **Attacker Capabilities:** Ability to exploit SQL injection or gain database access.

**C - SQL Injection in "zipdownload.php"**

*  **Root Cause:** The zipdownload.php script also uses the unsanitized  $FAVPICS variable in SQL queries, similar to the primary vulnerability (A)
*   **Weakness:** Lack of input sanitization on cookie data, specifically $FAVPICS, when used to construct SQL queries within `zipdownload.php`.
*   **Impact:** If the zipdownload feature is enabled by an attacker with admin privileges (achieved by exploiting vulnerability B), they can exploit this secondary SQL injection vulnerability to download arbitrary files from the server, as filepaths are returned directly in the SQL result.
*   **Attack Vector:** Exploiting the initial SQL injection to gain admin access and then enabling the zipdownload feature, followed by exploiting the SQL injection in `zipdownload.php` using the same malicious cookie as vulnerability A.
*   **Attacker Capabilities:**  Ability to exploit the SQL injection vulnerability (A), and gain administrative privileges (B).

The advisory notes that the SQL injection in part A is "complicated to implement" and requires specialized tools but does not elaborate on the exact restrictions. The advisory also makes clear the zip download functionality is disabled by default but can be enabled by someone with admin privileges. This demonstrates a chain of exploitation:  SQL injection (A) leading to retrieval of plaintext passwords (B) which leads to admin access, enabling zipdownload functionality and ultimately leading to arbitrary file download (C).