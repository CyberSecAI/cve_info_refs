- **Root cause of vulnerability:** The `DiagCollectionControl.dll` ActiveX control in Musicmatch versions 10.00.2047 and earlier (and Yahoo versions 9.00.5059 and earlier) contains a "Safe for Scripting" interface with a method `StartDiagCollection`. This method allows an attacker to specify a file path via the `bstrSavePath` parameter.
- **Weaknesses/vulnerabilities present:** The vulnerability lies in the lack of proper validation of the `bstrSavePath` parameter, allowing an attacker to specify an arbitrary file path for writing, leading to an arbitrary file overwrite.
- **Impact of exploitation:** An attacker can overwrite any file on the user's system that the user has write access to. This could potentially overwrite critical system files, leading to denial of service or other malicious actions. The exploit could also be used to replace legitimate files with malicious ones.
- **Attack vectors:** The attack vector is through a specially crafted web page or HTML document that calls the vulnerable ActiveX control. The attacker would need to convince the user to open this page in a browser that has the vulnerable ActiveX control installed.
- **Required attacker capabilities/position:** The attacker needs to be able to host or distribute a malicious web page. The user must have Musicmatch installed with the vulnerable ActiveX control enabled, and must also have write permissions for the file being overwritten. The attacker also has to convince the user to visit their webpage.