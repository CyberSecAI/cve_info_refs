=== Content from bugs.gentoo.org_2906647c_20250125_234714.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 88537
www-proxy/junkbuster: configuration can be changed remotely when using single-threading
Last modified: 2005-04-13 08:50:52 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=88537&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=88537&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 88537**](show_bug.cgi?id=88537)
- www-proxy/junkbuster: configuration can be changed remotely when using single-threading

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
www-proxy/junkbuster: configuration can be changed remotely when using single...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://uregina.ca/~ranson1j/cgi-bin/s...](http://uregina.ca/~ranson1j/cgi-bin/show_referer.cgi) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B2? [glsa] jaervosz | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2005-04-09 19:44 UTC by euclid80 | | --- | --- | | Modified: | 2005-04-13 08:50 UTC ([History](show_activity.cgi?id=88537)) | | CC List: | 2 users (show)  net-proxy+disabled security-audit | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**patch for referrer bug**](attachment.cgi?id=55828 "View the content of the attachment") (diff,442 bytes, patch)  [2005-04-09 19:46 UTC](#attach_55828 "Go to the comment associated with the attachment"), euclid80 | *no flags* | [Details](attachment.cgi?id=55828&action=edit) | [Diff](attachment.cgi?id=55828&action=diff) | | [View All](attachment.cgi?bugid=88537&action=viewall)  [Add an attachment](attachment.cgi?bugid=88537&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=88537&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  euclid80    2005-04-09 19:44:13 UTC  ``` Regarding junkbuster-2.0.2-r2...  The function ij_untrusted_url() in filters.c clobbers the value of the global variable "referrer", which is set by the config file.  Now, when the "single-threaded" option has NOT been specified in the config file, the bug is harmless because this function is run in a child process.  However, if single-threading is enabled, all successive connections will use the new value of "referrer".  In particular, by sending a request for "<http://host/ij-untrusted-url?a?a?x>" to the proxy, one can install the value "x" in the referrer variable.   Reproducible: Always Steps to Reproduce: 1. request <http://host/ij-untrusted-url?a?a?x> through the proxy.  Actual Results:   Sets "referrer" global variable.  Expected Results:   Should use a local variable named "referrer". ```  [Comment 1](#c1)  euclid80    2005-04-09 19:46:42 UTC  ``` Created [attachment 55828](attachment.cgi?id=55828 "patch for referrer bug") [[details](attachment.cgi?id=55828&action=edit "patch for referrer bug"), [diff](attachment.cgi?id=55828&action=diff "patch for referrer bug")] patch for referrer bug ```  [Comment 2](#c2)  Thierry Carrez (RETIRED)   gentoo-dev  2005-04-10 07:49:12 UTC  ``` Can auditors have a look ? ```  [Comment 3](#c3)  Tavis Ormandy (RETIRED)   gentoo-dev  2005-04-10 11:38:21 UTC  ``` Confirmed. That's an interesting bug, a malicious site could override your referrer setting and allow it to be sent (if you were to enable single-threaded operation, for some reason).  it get's worse, there's some heap corruption happening in there due to the inconsistent use of the strsav() function that looks exploitable (single-threaded or not). looks like there are some other errors as well that need correcting.  Is there any reason to use junkbuster rather than privoxy? maybe we should consider abandoning junkbuster as it looks like upstream is inactive. ```  [Comment 4](#c4)  Sune Kloppenborg Jeppesen (RETIRED)   gentoo-dev  2005-04-12 00:03:06 UTC  ``` www-proxy please advise. ```  [Comment 5](#c5)  Alin Năstac (RETIRED)   gentoo-dev  2005-04-12 13:13:11 UTC  ``` fixed both issues in -r3 I've took the liberty to keep keywords unchanged and erase the old version. the new patch is Obviously Correct, tested on x86 by me and is definitely arch independent. ```  [Comment 6](#c6)  Sune Kloppenborg Jeppesen (RETIRED)   gentoo-dev  2005-04-12 13:25:18 UTC  ``` Thx Alin. This one is ready for GLSA. ```  [Comment 7](#c7)  Sune Kloppenborg Jeppesen (RETIRED)   gentoo-dev  2005-04-13 08:50:52 UTC  ``` GLSA 200504-11 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=88537)
* - [XML](show_bug.cgi?ctype=xml&id=88537)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=88537)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=88537&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=88537&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=88537&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.debian.org_457079dc_20250125_234716.html ===


---

[[Date Prev](msg00093.html)][[Date Next](msg00095.html)]
[[Thread Prev](msg00093.html)][[Thread Next](msg00095.html)]
[[Date Index](maillist.html#00094)]
[[Thread Index](threads.html#00094)]

# [SECURITY] [DSA 713-1] New junkbuster packages fix several vulnerabilities

---

* *To*: debian-security-announce@lists.debian.org (Debian Security Announcements)
* *Subject*: [SECURITY] [DSA 713-1] New junkbuster packages fix several vulnerabilities
* *From*: joey@infodrom.org (Martin Schulze)
* *Date*: Thu, 21 Apr 2005 16:35:32 +0200 (CEST)
* *Message-id*: <[[🔎]](/msgid-search/m1DOcmC-000oikC%40finlandia.Infodrom.North.DE) [m1DOcmC-000oikC@finlandia.Infodrom.North.DE](msg00094.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 713-1                     security@debian.org
<http://www.debian.org/security/>                             Martin Schulze
April 21st, 2005                        <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : junkbuster
Vulnerability  : several
Problem-Type   : remote
Debian-specific: no
CVE ID         : CAN-2005-1108 CAN-2005-1109

Several bugs have been found in junkbuster, a HTTP proxy and filter.
The Common Vulnerability and Exposures project identifies the
following vulnerabilities:

CAN-2005-1108

    James Ranson discovered that an attacker can modify the referrer
    setting with a carefully crafted URL by accidently overwriting a
    global variable.

CAN-2005-1109

    Tavis Ormandy from the Gentoo Security Team discovered several
    heap corruptions due to inconsistent use of an internal function
    that can crash the daemon or possibly lead to the execution of
    arbitrary code.

For the stable distribution (woody) these problems have been fixed in
version 2.0.2-0.2woody1.

The unstable distribution (sid) doesn't contain the junkbuster package
anymore.

We recommend that you upgrade your junkbuster package.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1.dsc>
      Size/MD5 checksum:      580 1cdd2e8d2e09436cb8e2bc33b5154507
    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1.diff.gz>
      Size/MD5 checksum:    35888 40990dc45ceffb0753f3f67a1a777a9f
    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2.orig.tar.gz>
      Size/MD5 checksum:   190501 87d96ac9fca6e9749f1b330fbc2e0e5c

  Alpha architecture:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1_alpha.deb>
      Size/MD5 checksum:   108972 9d4516bf66d0e8825cfa7f6835fa21b1

  ARM architecture:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1_arm.deb>
      Size/MD5 checksum:   104828 54d4c289fd14ff250a9146f7d816354b

  Intel IA-32 architecture:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1_i386.deb>
      Size/MD5 checksum:   103932 6629b6cc4364ff52575e30164c61f79c

  Intel IA-64 architecture:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1_ia64.deb>
      Size/MD5 checksum:   118322 087d9fac21f9cfbf663816a3b45a0588

  HP Precision architecture:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1_hppa.deb>
      Size/MD5 checksum:   108420 b794d097c59728246128ac3da1c4f4bd

  Motorola 680x0 architecture:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1_m68k.deb>
      Size/MD5 checksum:   101920 0e03c20861d536936500311a79678119

  Big endian MIPS architecture:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1_mips.deb>
      Size/MD5 checksum:   106996 e66b3dcce5d4797e9111b955b8ddbbb4

  Little endian MIPS architecture:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1_mipsel.deb>
      Size/MD5 checksum:   107078 d0a5c23e80800dc33b4fefd80a866416

  PowerPC architecture:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1_powerpc.deb>
      Size/MD5 checksum:   104740 98fbadd57996160f04581e88c8181cb1

  IBM S/390 architecture:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1_s390.deb>
      Size/MD5 checksum:   103856 c879b8597bdb25363fb934a2b31101cc

  Sun Sparc architecture:

    <http://security.debian.org/pool/updates/main/j/junkbuster/junkbuster_2.0.2-0.2woody1_sparc.deb>
      Size/MD5 checksum:   108180 39cf7dfaa41dc45c67e345e331116d85

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.0 (GNU/Linux)

iD8DBQFCZ7o0W5ql+IAeqTIRApP+AJoDjoiY3rXoIUQH1WiQo0y6PaZhQQCgrI1U
J9zV90yUXFW6Geb4ZG3VlEI=
=BfWJ
-----END PGP SIGNATURE-----

```

---



=== Content from www.gentoo.org_fa540da9_20250125_234716.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# JunkBuster: Multiple vulnerabilities — GLSA **200504-11**

JunkBuster is vulnerable to a heap corruption vulnerability, and under
certain configurations may allow an attacker to modify settings.

### Affected packages

| Package | **net-proxy/junkbuster** on all architectures |
| --- | --- |
| Affected versions | < **2.0.2-r3** |
| Unaffected versions | >= **2.0.2-r3** |

### Background

JunkBuster is a filtering HTTP proxy, designed to enhance privacy and
remove unwanted content.

### Description

James Ranson reported a vulnerability when JunkBuster is configured to
run in single-threaded mode, an attacker can modify the referrer
setting by getting a victim to request a specially crafted URL
(CAN-2005-1108). Tavis Ormandy of the Gentoo Linux Security Audit Team
identified a heap corruption issue in the filtering of URLs
(CAN-2005-1109).

### Impact

If JunkBuster has been configured to run in single-threaded mode, an
attacker can disable or modify the filtering of Referrer: HTTP headers,
potentially compromising the privacy of users. The heap corruption
vulnerability could crash or disrupt the operation of the proxy,
potentially executing arbitrary code.

### Workaround

There is no known workaround at this time.

### Resolution

All JunkBuster users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-proxy/junkbuster-2.0.2-r3"
```
### References

* [CAN-2005-1108](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-1108)
* [CAN-2005-1109](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-1109)

**Release date**

April 13, 2005

**Latest revision**

April 21, 2005: 02

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [88537](https://bugs.gentoo.org/show_bug.cgi?id=88537)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


