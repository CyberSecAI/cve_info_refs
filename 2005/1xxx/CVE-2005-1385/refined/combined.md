=== Content from marc.info_e74a3c78_20250124_215915.html ===

```
[[prev in list](?l=bugtraq&m=111472656017118&w=2)] [[next in list](?l=bugtraq&m=111479346119272&w=2)] [[prev in thread](?l=bugtraq&m=111473570624498&w=2)] [[next in thread](?l=bugtraq&m=111479346119272&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Re: Safari HTTPS Overflow](?t=111473581700005&r=1&w=2)
From:       [David Riley <oscar () the-rileys ! net>](?a=96409740500001&r=1&w=2)
Date:       [2005-04-29 2:19:26](?l=bugtraq&r=1&w=2&b=200504)
Message-ID: [6e23d876aab050f1ef6059d2d6342bc3 () the-rileys ! net](?i=6e23d876aab050f1ef6059d2d6342bc3%20()%20the-rileys%20!%20net)
[Download RAW [message](?l=bugtraq&m=111479299730011&q=mbox) or [body](?l=bugtraq&m=111479299730011&q=raw)]

I don't think this is an overflow.  According to gdb, the spin lock
from CFSocketEnableCallBacks is crashing.  Backtracing to the call of
CFSocketEnableCallBacks, I see that the two parameters (a CFSocket
pointer and a set of binary flags, respectively) are:

r3             0x0      0
r4             0x9      9

Thus CFSocketEnableCallBacks is being passed a NULL pointer (and, for
what it's worth, the flags are kCFSocketReadCallBack and
kCFSocketWriteCallBack).  Why it crashes in the spinlock, I'm not sure,
but I imagine it might have to do with gdb not behaving nicely with
threads.

In any case, since I don't see any registers getting overwritten with
either 0x41 or 0x61 (since Safari converts it to lowercase), I don't
really see an overflow.  It's a crash which you might want to report to
Apple, but it seems like it's probably just a case of dereferencing a
NULL pointer.

I think what's happening is that some handler somewhere for the URL is
seeing an overly large buffer and rejects it with a NULL pointer
somewhere for the socket which isn't checked for appropriately.

Thanks,
	David

[[prev in list](?l=bugtraq&m=111472656017118&w=2)] [[next in list](?l=bugtraq&m=111479346119272&w=2)] [[prev in thread](?l=bugtraq&m=111473570624498&w=2)] [[next in thread](?l=bugtraq&m=111479346119272&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_b35fe696_20250124_215914.html ===

```
[[prev in list](?l=bugtraq&m=111473333213561&w=2)] [[next in list](?l=bugtraq&m=111473416613212&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=111479299730011&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Safari HTTPS Overflow](?t=111473581700005&r=1&w=2)
From:       [Gilbert Verdian <gverdian () neoresearch ! org>](?a=109937943800001&r=1&w=2)
Date:       [2005-04-28 21:08:10](?l=bugtraq&r=1&w=2&b=200504)
Message-ID: [5857F6B3-C1DF-4694-BE0B-5D85F0BE4133 () neoresearch ! org](?i=5857F6B3-C1DF-4694-BE0B-5D85F0BE4133%20()%20neoresearch%20!%20org)
[Download RAW [message](?l=bugtraq&m=111473570624498&q=mbox) or [body](?l=bugtraq&m=111473570624498&q=raw)]

Found a bug in the latest Safari that comes with Panther 10.3.9 -
Safari 1.3 (v312), previous versions of Panther are also vulnerable.

The problem is with the URI input for HTTPS which causes Safari to
crash by inputting a large amount of A's i.e.

https://
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

Did a debug of the crash, but it kept crashing in a spin_lock while
reading from the text segment. Will post more details when have more
info on it.

Gilbert Verdian
neoresearch.org

[[prev in list](?l=bugtraq&m=111473333213561&w=2)] [[next in list](?l=bugtraq&m=111473416613212&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=111479299730011&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_d7c76f25_20250124_215915.html ===

```
[[prev in list](?l=bugtraq&m=111479299730011&w=2)] [[next in list](?l=bugtraq&m=111479252709372&w=2)] [[prev in thread](?l=bugtraq&m=111479299730011&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Re: Safari HTTPS Overflow](?t=111473581700005&r=1&w=2)
From:       [Braden Thomas <braden127 () myrealbox ! com>](?a=111479360800005&r=1&w=2)
Date:       [2005-04-29 2:29:14](?l=bugtraq&r=1&w=2&b=200504)
Message-ID: [e63865f36a2130bd3bc5e4c68a7c528d () myrealbox ! com](?i=e63865f36a2130bd3bc5e4c68a7c528d%20()%20myrealbox%20!%20com)
[Download RAW [message](?l=bugtraq&m=111479346119272&q=mbox) or [body](?l=bugtraq&m=111479346119272&q=raw)]

Gilbert 
	This appears to be an issue where Safari is calling
CFSocketEnableCallBacks on a null CFSocketRef.  Not an overflow.  An
overflow would require a buffer, somewhere, to have overflowed.  This
is not happening at all.  Just because a program crashes when you send
it a relatively long string does not define it as an overflow.  Look at
the crash report:

Exception:  EXC_BAD_ACCESS (0x0001)
Codes:      KERN_PROTECTION_FAILURE (0x0002) at 0x0000000c

	Also, did you notify Apple
(<https://bugreport.apple.com/cgi-bin/WebObjects/RadarWeb.woa>) of this
bug, or did you just figure they'd hear about it through the grapevine?

Braden Thomas

On Apr 28, 2005, at 2:08 PM, Gilbert Verdian wrote:

> Found a bug in the latest Safari that comes with Panther 10.3.9 -
> Safari 1.3 (v312), previous versions of Panther are also vulnerable.
>
> The problem is with the URI input for HTTPS which causes Safari to
> crash by inputting a large amount of A's i.e.
>
> https://
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
>
> Did a debug of the crash, but it kept crashing in a spin_lock while
> reading from the text segment. Will post more details when have more
> info on it.
>
> Gilbert Verdian
> neoresearch.org

[[prev in list](?l=bugtraq&m=111479299730011&w=2)] [[next in list](?l=bugtraq&m=111479252709372&w=2)] [[prev in thread](?l=bugtraq&m=111479299730011&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


