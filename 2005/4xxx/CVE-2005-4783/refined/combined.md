=== Content from cvsweb.netbsd.org_978887d9_20250125_022521.html ===


| [[BACK]](/bsdweb.cgi/src/sys/miscfs/kernfs/kernfs_vnops.c?f=h#rev1.111)**Return to [kernfs\_vnops.c](/bsdweb.cgi/src/sys/miscfs/kernfs/kernfs_vnops.c?f=h#rev1.111) CVS log** [TXT] | [DIR] **Up to [[cvs.NetBSD.org]](/bsdweb.cgi/?f=h#dirlist) / [src](/bsdweb.cgi/src/?f=h#dirlist) / [sys](/bsdweb.cgi/src/sys/?f=h#dirlist) / [miscfs](/bsdweb.cgi/src/sys/miscfs/?f=h#dirlist) / [kernfs](/bsdweb.cgi/src/sys/miscfs/kernfs/?f=h#dirlist)** |
| --- | --- |

| Please note that diffs are not public domain; they are subject to the copyright notices on the relevant files. |
| --- |

### Diff for /src/sys/miscfs/kernfs/kernfs\_vnops.c between versions 1.110 and 1.111

| [version 1.110](kernfs_vnops.c?f=h;rev=1.110), 2005/08/30 20:08:01 | [version 1.111](kernfs_vnops.c?f=h;rev=1.111), 2005/08/31 09:54:54 |
| --- | --- |
| **[Line 427](kernfs_vnops.c?f=h;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.110#l427)**  kernfs\_xread(kfs, off, bufp, len, wrlen) | **[Line 427](kernfs_vnops.c?f=h;content-type=text%2Fx-cvsweb-markup;ln=1;rev=1.111#l427)**  kernfs\_xread(kfs, off, bufp, len, wrlen) |
| \* message buffer header are corrupted, but that'll cause | \* message buffer header are corrupted, but that'll cause |
| \* the system to die anyway. | \* the system to die anyway. |
| \*/ | \*/ |
|  | if (off < 0) { |
|  | \*wrlen = 0; |
|  | return EINVAL; |
|  | } |
| if (off >= msgbufp->msg\_bufs) { | if (off >= msgbufp->msg\_bufs) { |
| \*wrlen = 0; | \*wrlen = 0; |
| return (0); | return (0); |

---

Diff format:

Colored
Long colored
Unified
Context
Side by side

| Removed from v.1.110 |  |
| --- | --- |
| changed lines | |
|  | Added in v.1.111 |

---

CVSweb <webmaster@jp.NetBSD.org>


=== Content from mail-index.netbsd.org_eeb87f47_20250125_022522.html ===

**Subject:** Announcing update 2.0.3 - source only

**To:** None *<netbsd-announce@netbsd.org>*

**From:** James Chacon *<jmc@netbsd.org>*

**List:** netbsd-announce

**Date:** 10/31/2005 09:52:13
```
The NetBSD Project is pleased to announce that update 2.0.3 of the NetBSD
operating system is now available as a source only update.

About NetBSD 2.0.3
------------------

NetBSD 2.0.3 is the third security/critical update of the NetBSD 2.0 release
branch. This represents a selected subset of fixes deemed critical in nature
for stability or security reasons.

All fixes in security/critical updates (ie, NetBSD 2.0.2, 2.0.3, etc)
are cumulative, so this latest update contains all such fixes since the
NetBSD 2.0 release.  These fixes will also appear in future
releases (NetBSD 2.1, 2.2, etc), together with other less-critical fixes
and feature enhancements.

Complete source for NetBSD 2.0.3 is available for download at many sites around
the world. A list of download sites providing FTP, AnonCVS, SUP, and other
services is provided at the end of this announcement; the latest list of
available download sites may also be found at:

<http://www.NetBSD.org/mirrors/>

About NetBSD
------------

The NetBSD operating system is a full-featured, open source, UNIX-like
operating system descended from the Berkeley Networking Release 2 (Net/2),
4.4BSD-Lite, and 4.4BSD-Lite2. NetBSD runs on 54 different system
architectures featuring 17 machine architectures across 17 distinct CPU
families, and is being ported to more.

NetBSD is a highly integrated system. In addition to its highly portable,
high performance kernel, NetBSD features a complete set of user utilities,
compilers for several languages, the X Window System, firewall software and
numerous other tools, all accompanied by full source code. The NetBSD
Packages Collection contains over 5000 packages and binary package releases
for a number of platforms are currently in progress.

More information on the goals of the NetBSD Project can be procured from the
NetBSD web site at:

<http://www.NetBSD.org/Goals/>

NetBSD is free. All of the code is under non-restrictive licenses, and may be
used without paying royalties to anyone. Free support services are available
via our mailing lists and web site. Commercial support is available from a
variety of sources; some are listed at:

<http://www.NetBSD.org/gallery/consultants.html>

More extensive information on NetBSD is available from the NetBSD web site:

<http://www.NetBSD.org/>

NetBSD is the work of a diverse group of people spread around the world. The
`Net' in our name is a tribute to the Internet, which enables us to
communicate and share code, and without which the project would not exist.

Major Changes Between 2.0.2 and 2.0.3
-----------------------------------

The detailed list of changes can be found in the CHANGES-2.0.3 files in the
top level doc directory of the NetBSD 2.0.3 source tree.

A summary list of changes is as follows:

     Kernel

     o   Drop the big lock in upcallret() on powerpc to prevent hangs with
         pthreads on SMP systems.

     o   Fix "sleep forever" issue raise on sparc64 systems.

     o   For powerpc don't enable interrupts while calling trap() if the trap-
         ping frame didn't have them enabled either. Prevents crashes on some
         G4 based systems.

     o   Prevent random panics on process exit where calls to knote_fdclose()
         were being done on incorrect file descriptors.

     o   Remove code assuming kernfs supports mmap as it does not.

     o   Prevent a panic where disk interrupts could be enabled while the
         ATACH_TH_RUN flag is still set.

     o   In pmap_enter(), preset the mod/ref bits based on the flags argument
         to avoid possible data loss.

     o   Make sure buffer sizes are initialized correctly even when the pause
         state is explicitly set. Avoids crashes on some audio hardware.

     o   Fix memory leak in uipc_usrreq calls.

     o   Make PCI cards work on NetBSD-mappc systems with a "Grackle" bridge.

     o   Avoids deadlocks in the alpha pmap code between pmap_activate() and
         it's use of sched_lock.

     o   Protect the ipsec ioctls from negative offsets to prevent panics in
         m_copydata().

     o   The maximum file size on MS-DOS filesystems is 4 GB - 1 byte, so
         don't bother trying to write files bigger than this. Just return
         EFBIG to caller, rather than panic()ing later.

     o   Range check calls correctly in freebsd compat code to prevent data
         corruption and possible crashes.

     o   Handle MMX faults as floating exceptions. Matlab full functional
         again.

     Networking

     o   Prevent panics where it was possible to end up with a negative RTT.

     o   When adding or deleting multicast addresses, only change the address
         filter if the interface is marked RUNNING.

     o   Fix the HPC1 transmit logic on sgimips which was previously not work-
         ing.

     o   Make sure to purge prefixes from the ND list or else panics can
         result.

     o   Avoid an optimization in m_pulldown to avoid a prepend to the next
         mbuf in the chain if the result would still not have all data conti-
         nous. Prevents panics under certain circumstances.

     o   Prevent a panic on sun3 where NULL could be de-referenced in the case
         of #if NBPFILTER == 0

     o   Fix a possible data/pool corruption in the icmp6 code where possibly
         free'd data is reused.

     File system

     o   Fix a silent truncation problem that could cause corruption with
         large FFSv1 file systems.

     o   In ext2 check that we are not the pagedaemon as getblk() can return
         NULL in this case.

     Security

     o   Fix buffer overflows in telnet(1) identified in CAN 2005-0468 and
         2005-0469.

     o   Make verified exec functional again by using UIO_SYSSPACE for NDINIT.

     o   Prevent possible buffer overruns in telnetd(8) by removing static
         local variables so its easier to correctly use strlcpy.

     o   Prevent buffer overflows in cvs(1) by updating to version 1.11.20 in
         response to CAN-2005-0753.

     o   IPsec-AH was always calculated using the same key in AES-XCBC-MAC.

     o   Return correct error on all zero length codes in libz.

     o   Prevent vulnerability in cvs(1) reported in SA16553.

     o   Simplify code in procfs to check for a negative uio_offset at the
         beginning and check for attempts to write to init sooner and in all
         cases.

     o   Don't allow negative offsets when reading the message buffer, because
         it can allow reading arbitrary kernel memory.

     o   Remove unsafe /tmp file creation for the file.0 target when using
         imake(1)

     o   Fix security hole in Xserver(1) reported in CAN-2005-2495.

     o   Fix openssl 2.0 rollback, CAN-2005-2969.

     System administration and user tools

     o   Install xdm scripts as executable so that xdm will function and not
         consume 100% cpu.

     o   In user(8) be consistent when deleting a non-existent group - tell if
         the group is non-existent.

     o   Correctly set LOGNAME in new environment when using su(1)

     o   In amd(8) embed machine and cpu architecture correctly from target
         host environment, not from build host.

     o   Fix bug in sh(1) on big endian systems where underflowing a buffer
         when evaluating output from a back tick substitution can cause a
         crash.

     Miscellaneous

     o   Update copyright to 2005.

     o   Update to tzdata2005n. Lots of fixes, including most recently the
         leap second at the end of 2005 and the U.S. DST changes taking effect
         in 2007.

     o   Add support for ffsv2 to amd64 boot floppies.

Please note that at the moment, sysinst will not assist you in installing
pre-built third-party binary packages or the pkgsrc system itself. See the
NetBSD packages collection documentation:

<http://www.NetBSD.org/Documentation/software/packages.html>

Acknowledgments
---------------

The NetBSD Foundation would like to thank all those who have contributed code,
hardware, documentation, funds, colocation for our servers, web pages and
other documentation, release engineering, and other resources over the years.
More information on the people who make NetBSD happen is available at:

<http://www.NetBSD.org/People/>

We would like to especially thank the University of California at Berkeley and
the GNU Project for particularly large subsets of code that we use. We would
also like to thank the Internet Software Consortium and the Helsinki
University of Technology for current colocation services.

About the NetBSD Foundation
---------------------------

The NetBSD Foundation was chartered in 1995, with the task of overseeing core
NetBSD project services, promoting the project within industry and the open
source community, and holding intellectual property rights on much of the
NetBSD code base. Day-to-day operations of the project are handled by
volunteers.

As a non-profit organisation with no commercial backing, The NetBSD
Foundation depends on donations from its users, and we would like to ask
you to consider making a donation to the NetBSD Foundation in support of
continuing production of our fine operating system.

Donations can be done via PayPal (paypal@NetBSD.org) and are fully
tax-deductible in the US.  If you would prefer not to use PayPal, or
would like to make other arrangements, please contact
<finance-exec@NetBSD.org>.

NetBSD mirror sites
-------------------

Please use a mirror site close to you.

    * FTP           - <http://www.NetBSD.org/mirrors/#ftp>
    * Anonymous CVS - <http://www.NetBSD.org/mirrors/#anoncvs>
    * SUP           - <http://www.NetBSD.org/mirrors/#sup>
    * CVSup         - <http://www.NetBSD.org/mirrors/#cvsup>

```


=== Content from cvsweb.netbsd.org_d2f0ecb0_20250125_022520.html ===

[![The NetBSD Project](/images/powered-by-NetBSD.png)](http://www.NetBSD.org/)
# CVS log for src/sys/miscfs/kernfs/kernfs\_vnops.c

[![[BACK]](/icons/back.gif)](./#kernfs_vnops.c) **Up to [[cvs.NetBSD.org]](/bsdweb.cgi/#dirlist) / [src](/bsdweb.cgi/src/#dirlist) / [sys](/bsdweb.cgi/src/sys/#dirlist) / [miscfs](/bsdweb.cgi/src/sys/miscfs/#dirlist) / [kernfs](/bsdweb.cgi/src/sys/miscfs/kernfs/#dirlist)**

[Request diff between arbitrary revisions](#diff)

---

Keyword substitution: kv

Default branch: MAIN

---

Revision **1.174**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.174;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.174;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.174;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.174) - [select for diffs](kernfs_vnops.c?r1=1.174#rev1.174)

*Sun Mar 27 17:10:56 2022 UTC* (2 years, 10 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [thorpej-ifq-base](./kernfs_vnops.c?only_with_tag=thorpej-ifq-base),
[thorpej-ifq](./kernfs_vnops.c?only_with_tag=thorpej-ifq),
[thorpej-altq-separation-base](./kernfs_vnops.c?only_with_tag=thorpej-altq-separation-base),
[thorpej-altq-separation](./kernfs_vnops.c?only_with_tag=thorpej-altq-separation),
[perseant-exfatfs-base-20240630](./kernfs_vnops.c?only_with_tag=perseant-exfatfs-base-20240630),
[perseant-exfatfs-base](./kernfs_vnops.c?only_with_tag=perseant-exfatfs-base),
[perseant-exfatfs](./kernfs_vnops.c?only_with_tag=perseant-exfatfs),
[netbsd-10-base](./kernfs_vnops.c?only_with_tag=netbsd-10-base),
[netbsd-10-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-10-1-RELEASE),
[netbsd-10-0-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-10-0-RELEASE),
[netbsd-10-0-RC6](./kernfs_vnops.c?only_with_tag=netbsd-10-0-RC6),
[netbsd-10-0-RC5](./kernfs_vnops.c?only_with_tag=netbsd-10-0-RC5),
[netbsd-10-0-RC4](./kernfs_vnops.c?only_with_tag=netbsd-10-0-RC4),
[netbsd-10-0-RC3](./kernfs_vnops.c?only_with_tag=netbsd-10-0-RC3),
[netbsd-10-0-RC2](./kernfs_vnops.c?only_with_tag=netbsd-10-0-RC2),
[netbsd-10-0-RC1](./kernfs_vnops.c?only_with_tag=netbsd-10-0-RC1),
[netbsd-10](./kernfs_vnops.c?only_with_tag=netbsd-10),
[bouyer-sunxi-drm-base](./kernfs_vnops.c?only_with_tag=bouyer-sunxi-drm-base),
[bouyer-sunxi-drm](./kernfs_vnops.c?only_with_tag=bouyer-sunxi-drm),
[HEAD](./kernfs_vnops.c?only_with_tag=HEAD)

Diff to: previous 1.173: [preferred](kernfs_vnops.c.diff?r1=1.173;r2=1.174), [colored](kernfs_vnops.c.diff?r1=1.173;r2=1.174;f=h)

Changes since revision 1.173: +4 -34
lines
```

dedup the eofs link/symlink methods

```

---

Revision **1.173**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.173;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.173;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.173;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.173) - [select for diffs](kernfs_vnops.c?r1=1.173#rev1.173)

*Sat Mar 12 17:36:14 2022 UTC* (2 years, 10 months ago) by *riastradh*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.172: [preferred](kernfs_vnops.c.diff?r1=1.172;r2=1.173), [colored](kernfs_vnops.c.diff?r1=1.172;r2=1.173;f=h)

Changes since revision 1.172: +3 -3
lines
```

kernfs: Just fail with EOPNOTSUPP, don't panic, on VOP_BMAP.

Reported-by: syzbot+870d2eb4b4c8904ac734@syzkaller.appspotmail.com

```

---

Revision **1.166.6.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.166.6.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.166.6.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.166.6.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.166.6.1) - [select for diffs](kernfs_vnops.c?r1=1.166.6.1#rev1.166.6.1)

*Sun Aug 1 22:42:40 2021 UTC* (3 years, 5 months ago) by *thorpej*

Branches: [thorpej-i2c-spi-conf](./kernfs_vnops.c?only_with_tag=thorpej-i2c-spi-conf)

Diff to: previous 1.166: [preferred](kernfs_vnops.c.diff?r1=1.166;r2=1.166.6.1), [colored](kernfs_vnops.c.diff?r1=1.166;r2=1.166.6.1;f=h); next MAIN 1.167: [preferred](kernfs_vnops.c.diff?r1=1.167;r2=1.166.6.1), [colored](kernfs_vnops.c.diff?r1=1.167;r2=1.166.6.1;f=h)

Changes since revision 1.166: +33 -76
lines
```

Sync with HEAD.

```

---

Revision **1.172**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.172;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.172;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.172;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.172) - [select for diffs](kernfs_vnops.c?r1=1.172#rev1.172)

*Mon Jul 19 01:33:53 2021 UTC* (3 years, 6 months ago) by *dholland*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [thorpej-i2c-spi-conf2-base](./kernfs_vnops.c?only_with_tag=thorpej-i2c-spi-conf2-base),
[thorpej-i2c-spi-conf2](./kernfs_vnops.c?only_with_tag=thorpej-i2c-spi-conf2),
[thorpej-i2c-spi-conf-base](./kernfs_vnops.c?only_with_tag=thorpej-i2c-spi-conf-base),
[thorpej-futex2-base](./kernfs_vnops.c?only_with_tag=thorpej-futex2-base),
[thorpej-futex2](./kernfs_vnops.c?only_with_tag=thorpej-futex2),
[thorpej-cfargs2-base](./kernfs_vnops.c?only_with_tag=thorpej-cfargs2-base),
[thorpej-cfargs2](./kernfs_vnops.c?only_with_tag=thorpej-cfargs2)

Diff to: previous 1.171: [preferred](kernfs_vnops.c.diff?r1=1.171;r2=1.172), [colored](kernfs_vnops.c.diff?r1=1.171;r2=1.172;f=h)

Changes since revision 1.171: +28 -49
lines
```

Abolish all the silly indirection macros for initializing vnode ops tables.

These are things of the form #define foofs_op genfs_op, or #define
foofs_op genfs_eopnotsupp, or similar. They serve no purpose besides
obfuscation, and have gotten cutpasted all over everywhere.

Part 3; cvs randomly didn't commit all the files the first time, still
hunting down the files it skipped.

```

---

Revision **1.171**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.171;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.171;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.171;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.171) - [select for diffs](kernfs_vnops.c?r1=1.171#rev1.171)

*Sun Jul 18 23:56:13 2021 UTC* (3 years, 6 months ago) by *dholland*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.170: [preferred](kernfs_vnops.c.diff?r1=1.170;r2=1.171), [colored](kernfs_vnops.c.diff?r1=1.170;r2=1.171;f=h)

Changes since revision 1.170: +3 -29
lines
```

Use macros for the canned parts of device and fifo vnode op tables.

Add GENFS_SPECOP_ENTRIES and GENFS_FIFOOP_ENTRIES macros that contain
the portion of the vnode ops table declaration that is
(conservatively) the same in every fs. Use these in every fs that
supports devices and/or fifos with separate ops tables.

Note that ptyfs works differently (it has one type of vnode with
open-coded dispatch to the specfs code, which I haven't changed in
this commit) and rump/librump/rumpvfs/rumpfs.c has an indirect dynamic
dispatch that already does more or less the same thing, which I also
haven't changed.

Also note that this anticipates a few bits in the next changeset here
and there, and adds missing but unreachable calls in some cases (e.g.
most fses weren't defining whiteout on devices and fifos, but it isn't
reachable there), and it changes parsepath on devices and fifos to
genfs_badop from genfs_parsepath (but it's not reachable there
either).

It appears that devices in kernfs were missing kqfilter, so it's
possible that if you try to use kqueue on /kern/rootdev that it'll
explode.

And finally note that the ops declaration tables aren't
order-dependent. (Other than vop_default_desc has to come first.)
Otherwise this wouldn't work.

```

---

Revision **1.160.4.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.160.4.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.160.4.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.160.4.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.160.4.3) - [select for diffs](kernfs_vnops.c?r1=1.160.4.3#rev1.160.4.3)

*Tue Jul 6 03:45:11 2021 UTC* (3 years, 6 months ago) by *martin*

Branches: [netbsd-9](./kernfs_vnops.c?only_with_tag=netbsd-9)

CVS tags: [netbsd-9-4-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-9-4-RELEASE),
[netbsd-9-3-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-9-3-RELEASE)

Diff to: previous 1.160.4.2: [preferred](kernfs_vnops.c.diff?r1=1.160.4.2;r2=1.160.4.3), [colored](kernfs_vnops.c.diff?r1=1.160.4.2;r2=1.160.4.3;f=h); branchpoint 1.160: [preferred](kernfs_vnops.c.diff?r1=1.160;r2=1.160.4.3), [colored](kernfs_vnops.c.diff?r1=1.160;r2=1.160.4.3;f=h); next MAIN 1.161: [preferred](kernfs_vnops.c.diff?r1=1.161;r2=1.160.4.3), [colored](kernfs_vnops.c.diff?r1=1.161;r2=1.160.4.3;f=h)

Changes since revision 1.160.4.2: +6 -4
lines
```

Pull up following revision(s) (requested by dholland in ticket #1318):

	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.169
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.170

Add missing VOP_KQFILTER to kernfs.

Not sure if lack of it can be used for local DoS or not, but best to
fix.

 -

Fix perms on /kern/{r,}rootdev.

```

---

Revision **1.170**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.170;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.170;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.170;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.170) - [select for diffs](kernfs_vnops.c?r1=1.170#rev1.170)

*Tue Jul 6 03:23:03 2021 UTC* (3 years, 6 months ago) by *dholland*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.169: [preferred](kernfs_vnops.c.diff?r1=1.169;r2=1.170), [colored](kernfs_vnops.c.diff?r1=1.169;r2=1.170;f=h)

Changes since revision 1.169: +4 -4
lines
```

Fix perms on /kern/{r,}rootdev.

```

---

Revision **1.169**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.169;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.169;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.169;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.169) - [select for diffs](kernfs_vnops.c?r1=1.169#rev1.169)

*Tue Jul 6 03:22:44 2021 UTC* (3 years, 6 months ago) by *dholland*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.168: [preferred](kernfs_vnops.c.diff?r1=1.168;r2=1.169), [colored](kernfs_vnops.c.diff?r1=1.168;r2=1.169;f=h)

Changes since revision 1.168: +4 -2
lines
```

Add missing VOP_KQFILTER to kernfs.

Not sure if lack of it can be used for local DoS or not, but best to
fix.

```

---

Revision **1.168**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.168;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.168;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.168;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.168) - [select for diffs](kernfs_vnops.c?r1=1.168#rev1.168)

*Tue Jun 29 22:34:08 2021 UTC* (3 years, 6 months ago) by *dholland*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.167: [preferred](kernfs_vnops.c.diff?r1=1.167;r2=1.168), [colored](kernfs_vnops.c.diff?r1=1.167;r2=1.168;f=h)

Changes since revision 1.167: +4 -2
lines
```

- Add a new vnode op: VOP_PARSEPATH.
 - Move namei_getcomponent to genfs_vnops.c and call it genfs_parsepath.
 - Add a parsepath entry to every vnode ops table.

VOP_PARSEPATH takes a directory vnode to be searched and a complete
following path and chooses how much of that path to consume. To begin
with, all parsepath calls are genfs_parsepath, which locates the first
'/' as always.

Note that the call doesn't take the whole struct componentname, only
the string. The other bits of struct componentname should not be
needed and there's no reason to cause potential complications by
exposing them.

```

---

Revision **1.167**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.167;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.167;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.167;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.167) - [select for diffs](kernfs_vnops.c?r1=1.167#rev1.167)

*Mon Jun 28 17:52:13 2021 UTC* (3 years, 6 months ago) by *chs*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.166: [preferred](kernfs_vnops.c.diff?r1=1.166;r2=1.167), [colored](kernfs_vnops.c.diff?r1=1.166;r2=1.167;f=h)

Changes since revision 1.166: +3 -3
lines
```

VOP_BMAP() may be called via ioctl(FIOGETBMAP) on any vnode that applications
can open.  change various pseudo-fs *_bmap methods return an error instead of
panic.

Reported-by: syzbot+8289a3eaf2ba60958c87@syzkaller.appspotmail.com

```

---

Revision **1.166**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.166;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.166;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.166;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.166) - [select for diffs](kernfs_vnops.c?r1=1.166#rev1.166)

*Sat Jun 27 17:29:19 2020 UTC* (4 years, 6 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [thorpej-futex-base](./kernfs_vnops.c?only_with_tag=thorpej-futex-base),
[thorpej-futex](./kernfs_vnops.c?only_with_tag=thorpej-futex),
[thorpej-cfargs-base](./kernfs_vnops.c?only_with_tag=thorpej-cfargs-base),
[thorpej-cfargs](./kernfs_vnops.c?only_with_tag=thorpej-cfargs),
[cjep\_sun2x-base1](./kernfs_vnops.c?only_with_tag=cjep_sun2x-base1),
[cjep\_sun2x-base](./kernfs_vnops.c?only_with_tag=cjep_sun2x-base),
[cjep\_sun2x](./kernfs_vnops.c?only_with_tag=cjep_sun2x),
[cjep\_staticlib\_x-base1](./kernfs_vnops.c?only_with_tag=cjep_staticlib_x-base1),
[cjep\_staticlib\_x-base](./kernfs_vnops.c?only_with_tag=cjep_staticlib_x-base),
[cjep\_staticlib\_x](./kernfs_vnops.c?only_with_tag=cjep_staticlib_x)

Branch point for: [thorpej-i2c-spi-conf](./kernfs_vnops.c?only_with_tag=thorpej-i2c-spi-conf)

Diff to: previous 1.165: [preferred](kernfs_vnops.c.diff?r1=1.165;r2=1.166), [colored](kernfs_vnops.c.diff?r1=1.165;r2=1.166;f=h)

Changes since revision 1.165: +3 -3
lines
```

Introduce genfs_pathconf() and use it for the default case in all filesystems.

```

---

Revision **1.165**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.165;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.165;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.165;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.165) - [select for diffs](kernfs_vnops.c?r1=1.165#rev1.165)

*Sat May 16 18:31:51 2020 UTC* (4 years, 8 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.164: [preferred](kernfs_vnops.c.diff?r1=1.164;r2=1.165), [colored](kernfs_vnops.c.diff?r1=1.164;r2=1.165;f=h)

Changes since revision 1.164: +8 -6
lines
```

Add ACL support for FFS. From FreeBSD.

```

---

Revision **1.159.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.159.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.159.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.159.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.159.2.2) - [select for diffs](kernfs_vnops.c?r1=1.159.2.2#rev1.159.2.2)

*Mon Apr 13 08:05:05 2020 UTC* (4 years, 9 months ago) by *martin*

Branches: [phil-wifi](./kernfs_vnops.c?only_with_tag=phil-wifi)

Diff to: previous 1.159.2.1: [preferred](kernfs_vnops.c.diff?r1=1.159.2.1;r2=1.159.2.2), [colored](kernfs_vnops.c.diff?r1=1.159.2.1;r2=1.159.2.2;f=h); branchpoint 1.159: [preferred](kernfs_vnops.c.diff?r1=1.159;r2=1.159.2.2), [colored](kernfs_vnops.c.diff?r1=1.159;r2=1.159.2.2;f=h); next MAIN 1.160: [preferred](kernfs_vnops.c.diff?r1=1.160;r2=1.159.2.2), [colored](kernfs_vnops.c.diff?r1=1.160;r2=1.159.2.2;f=h)

Changes since revision 1.159.2.1: +86 -22
lines
```

Mostly merge changes from HEAD upto 20200411

```

---

Revision **1.162.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.162.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.162.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.162.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.162.2.1) - [select for diffs](kernfs_vnops.c?r1=1.162.2.1#rev1.162.2.1)

*Sat Feb 29 20:21:04 2020 UTC* (4 years, 10 months ago) by *ad*

Branches: [ad-namecache](./kernfs_vnops.c?only_with_tag=ad-namecache)

Diff to: previous 1.162: [preferred](kernfs_vnops.c.diff?r1=1.162;r2=1.162.2.1), [colored](kernfs_vnops.c.diff?r1=1.162;r2=1.162.2.1;f=h); next MAIN 1.163: [preferred](kernfs_vnops.c.diff?r1=1.163;r2=1.162.2.1), [colored](kernfs_vnops.c.diff?r1=1.163;r2=1.162.2.1;f=h)

Changes since revision 1.162: +51 -21
lines
```

Sync with head.

```

---

Revision **1.164**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.164;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.164;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.164;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.164) - [select for diffs](kernfs_vnops.c?r1=1.164#rev1.164)

*Mon Feb 24 20:44:25 2020 UTC* (4 years, 11 months ago) by *ad*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [phil-wifi-20200421](./kernfs_vnops.c?only_with_tag=phil-wifi-20200421),
[phil-wifi-20200411](./kernfs_vnops.c?only_with_tag=phil-wifi-20200411),
[phil-wifi-20200406](./kernfs_vnops.c?only_with_tag=phil-wifi-20200406),
[is-mlppp-base](./kernfs_vnops.c?only_with_tag=is-mlppp-base),
[is-mlppp](./kernfs_vnops.c?only_with_tag=is-mlppp),
[bouyer-xenpvh-base2](./kernfs_vnops.c?only_with_tag=bouyer-xenpvh-base2),
[bouyer-xenpvh-base1](./kernfs_vnops.c?only_with_tag=bouyer-xenpvh-base1),
[bouyer-xenpvh-base](./kernfs_vnops.c?only_with_tag=bouyer-xenpvh-base),
[bouyer-xenpvh](./kernfs_vnops.c?only_with_tag=bouyer-xenpvh),
[ad-namecache-base3](./kernfs_vnops.c?only_with_tag=ad-namecache-base3)

Diff to: previous 1.163: [preferred](kernfs_vnops.c.diff?r1=1.163;r2=1.164), [colored](kernfs_vnops.c.diff?r1=1.163;r2=1.164;f=h)

Changes since revision 1.163: +3 -3
lines
```

v_interlock -> vmobjlock

```

---

Revision **1.160.4.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.160.4.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.160.4.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.160.4.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.160.4.2) - [select for diffs](kernfs_vnops.c?r1=1.160.4.2#rev1.160.4.2)

*Wed Feb 12 19:59:22 2020 UTC* (4 years, 11 months ago) by *martin*

Branches: [netbsd-9](./kernfs_vnops.c?only_with_tag=netbsd-9)

CVS tags: [netbsd-9-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-9-2-RELEASE),
[netbsd-9-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-9-1-RELEASE),
[netbsd-9-0-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-9-0-RELEASE)

Diff to: previous 1.160.4.1: [preferred](kernfs_vnops.c.diff?r1=1.160.4.1;r2=1.160.4.2), [colored](kernfs_vnops.c.diff?r1=1.160.4.1;r2=1.160.4.2;f=h); branchpoint 1.160: [preferred](kernfs_vnops.c.diff?r1=1.160;r2=1.160.4.2), [colored](kernfs_vnops.c.diff?r1=1.160;r2=1.160.4.2;f=h)

Changes since revision 1.160.4.1: +50 -20
lines
```

Pull up following revision(s) (requested by riastradh in ticket #702):

	sys/miscfs/kernfs/kernfs_vfsops.c: revision 1.98
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.163
	sys/miscfs/kernfs/kernfs.h: revision 1.43

Use specfs vnops for specnodes in kernfs.

While here, don't filter out rootdev and rrootdev merely because
they're not cached.

Fixes the elusive /kern/rootdev and /kern/rrootdev nodes, which only
appeared sometimes when they felt like it, and fixes operations on
/kern/rootdev and /kern/rrootdev always returning EOPNOTSUPP.

We didn't seem to have a single PR for these issues but the following
PRs are all relevant:

PR [bin/13564](http://gnats.NetBSD.org/13564)
PR [kern/38265](http://gnats.NetBSD.org/38265)
PR [kern/38778](http://gnats.NetBSD.org/38778)
PR [kern/45974](http://gnats.NetBSD.org/45974)

XXX pullup-9, pullup-8, pullup-7, pullup-6, pullup-5, pullup-4, pullup-3, p=
ullup-2, pullup-1.4T...

```

---

Revision **1.163**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.163;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.163;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.163;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.163) - [select for diffs](kernfs_vnops.c?r1=1.163#rev1.163)

*Tue Feb 4 04:19:24 2020 UTC* (4 years, 11 months ago) by *riastradh*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.162: [preferred](kernfs_vnops.c.diff?r1=1.162;r2=1.163), [colored](kernfs_vnops.c.diff?r1=1.162;r2=1.163;f=h)

Changes since revision 1.162: +50 -20
lines
```

Use specfs vnops for specnodes in kernfs.

While here, don't filter out rootdev and rrootdev merely because
they're not cached.

Fixes the elusive /kern/rootdev and /kern/rrootdev nodes, which only
appeared sometimes when they felt like it, and fixes operations on
/kern/rootdev and /kern/rrootdev always returning EOPNOTSUPP.

We didn't seem to have a single PR for these issues but the following
PRs are all relevant:

PR [bin/13564](http://gnats.NetBSD.org/13564)
PR [kern/38265](http://gnats.NetBSD.org/38265)
PR [kern/38778](http://gnats.NetBSD.org/38778)
PR [kern/45974](http://gnats.NetBSD.org/45974)

XXX pullup-9, pullup-8, pullup-7, pullup-6, pullup-5, pullup-4, pullup-3, pullup-2, pullup-1.4T...

```

---

Revision **1.162**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.162;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.162;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.162;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.162) - [select for diffs](kernfs_vnops.c?r1=1.162#rev1.162)

*Thu Jan 2 15:42:27 2020 UTC* (5 years ago) by *thorpej*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [ad-namecache-base2](./kernfs_vnops.c?only_with_tag=ad-namecache-base2),
[ad-namecache-base1](./kernfs_vnops.c?only_with_tag=ad-namecache-base1),
[ad-namecache-base](./kernfs_vnops.c?only_with_tag=ad-namecache-base)

Branch point for: [ad-namecache](./kernfs_vnops.c?only_with_tag=ad-namecache)

Diff to: previous 1.161: [preferred](kernfs_vnops.c.diff?r1=1.161;r2=1.162), [colored](kernfs_vnops.c.diff?r1=1.161;r2=1.162;f=h)

Changes since revision 1.161: +16 -4
lines
```

- Eliminate the global "boottime" variable, which was being accessed
  without any synchronization against changes by e.g. clock_settime().
- Replace with new getbinboottime() / getnanoboottime() / getmicroboottime()
  functions (naming mirrors that of other time access functions in kern_tc.c).
  It returns the (maybe-converted) value of timebasebin, which also tracks
  our estimate of when the system was booted (i.e. the legacy "boottime" was
  redundant).

XXX There needs to be a lockless synchronization mechanism for reading
timebasebin, but this is a problem in kern_tc.c that pre-existed these
"boottime" changes.  At least now the problem is centralized in one location.

```

---

Revision **1.160.4.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.160.4.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.160.4.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.160.4.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.160.4.1) - [select for diffs](kernfs_vnops.c?r1=1.160.4.1#rev1.160.4.1)

*Sun Sep 1 11:02:27 2019 UTC* (5 years, 4 months ago) by *martin*

Branches: [netbsd-9](./kernfs_vnops.c?only_with_tag=netbsd-9)

CVS tags: [netbsd-9-0-RC2](./kernfs_vnops.c?only_with_tag=netbsd-9-0-RC2),
[netbsd-9-0-RC1](./kernfs_vnops.c?only_with_tag=netbsd-9-0-RC1)

Diff to: previous 1.160: [preferred](kernfs_vnops.c.diff?r1=1.160;r2=1.160.4.1), [colored](kernfs_vnops.c.diff?r1=1.160;r2=1.160.4.1;f=h)

Changes since revision 1.160: +24 -2
lines
```

Pull up following revision(s) (requested by hannken in ticket #132):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.161
	sys/miscfs/procfs/procfs_vnops.c: revision 1.207
Add missing operation VOP_GETPAGES() returning EFAULT.
Without this operation posix_fadvise(..., POSIX_FADV_WILLNEED)
would leave the v_interlock held.
Observed by maxv@

```

---

Revision **1.158.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.158.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.158.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.158.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.158.2.1) - [select for diffs](kernfs_vnops.c?r1=1.158.2.1#rev1.158.2.1)

*Thu Aug 29 16:28:47 2019 UTC* (5 years, 4 months ago) by *martin*

Branches: [netbsd-8](./kernfs_vnops.c?only_with_tag=netbsd-8)

CVS tags: [netbsd-8-3-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-8-3-RELEASE),
[netbsd-8-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-8-2-RELEASE)

Diff to: previous 1.158: [preferred](kernfs_vnops.c.diff?r1=1.158;r2=1.158.2.1), [colored](kernfs_vnops.c.diff?r1=1.158;r2=1.158.2.1;f=h); next MAIN 1.159: [preferred](kernfs_vnops.c.diff?r1=1.159;r2=1.158.2.1), [colored](kernfs_vnops.c.diff?r1=1.159;r2=1.158.2.1;f=h)

Changes since revision 1.158: +24 -2
lines
```

Pull up following revision(s) (requested by hannken in ticket #1346):

	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.161
	sys/miscfs/procfs/procfs_vnops.c: revision 1.207

Add missing operation VOP_GETPAGES() returning EFAULT.

Without this operation posix_fadvise(..., POSIX_FADV_WILLNEED)
would leave the v_interlock held.

Observed by maxv@

```

---

Revision **1.154.6.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.154.6.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.154.6.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.154.6.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.154.6.1) - [select for diffs](kernfs_vnops.c?r1=1.154.6.1#rev1.154.6.1)

*Thu Aug 29 16:15:35 2019 UTC* (5 years, 4 months ago) by *martin*

Branches: [netbsd-7-0](./kernfs_vnops.c?only_with_tag=netbsd-7-0)

Diff to: previous 1.154: [preferred](kernfs_vnops.c.diff?r1=1.154;r2=1.154.6.1), [colored](kernfs_vnops.c.diff?r1=1.154;r2=1.154.6.1;f=h); next MAIN 1.155: [preferred](kernfs_vnops.c.diff?r1=1.155;r2=1.154.6.1), [colored](kernfs_vnops.c.diff?r1=1.155;r2=1.154.6.1;f=h)

Changes since revision 1.154: +24 -2
lines
```

Pull up following revision(s) (requested by hannken in ticket #1703):

	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.161
	sys/miscfs/procfs/procfs_vnops.c: revision 1.207

Add missing operation VOP_GETPAGES() returning EFAULT.

Without this operation posix_fadvise(..., POSIX_FADV_WILLNEED)
would leave the v_interlock held.

Observed by maxv@

```

---

Revision **1.154.10.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.154.10.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.154.10.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.154.10.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.154.10.1) - [select for diffs](kernfs_vnops.c?r1=1.154.10.1#rev1.154.10.1)

*Thu Aug 29 16:14:37 2019 UTC* (5 years, 4 months ago) by *martin*

Branches: [netbsd-7-1](./kernfs_vnops.c?only_with_tag=netbsd-7-1)

Diff to: previous 1.154: [preferred](kernfs_vnops.c.diff?r1=1.154;r2=1.154.10.1), [colored](kernfs_vnops.c.diff?r1=1.154;r2=1.154.10.1;f=h); next MAIN 1.155: [preferred](kernfs_vnops.c.diff?r1=1.155;r2=1.154.10.1), [colored](kernfs_vnops.c.diff?r1=1.155;r2=1.154.10.1;f=h)

Changes since revision 1.154: +24 -2
lines
```

Pull up following revision(s) (requested by hannken in ticket #1703):

	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.161
	sys/miscfs/procfs/procfs_vnops.c: revision 1.207

Add missing operation VOP_GETPAGES() returning EFAULT.

Without this operation posix_fadvise(..., POSIX_FADV_WILLNEED)
would leave the v_interlock held.

Observed by maxv@

```

---

Revision **1.154.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.154.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.154.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.154.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.154.2.1) - [select for diffs](kernfs_vnops.c?r1=1.154.2.1#rev1.154.2.1)

*Thu Aug 29 16:13:37 2019 UTC* (5 years, 4 months ago) by *martin*

Branches: [netbsd-7](./kernfs_vnops.c?only_with_tag=netbsd-7)

Diff to: previous 1.154: [preferred](kernfs_vnops.c.diff?r1=1.154;r2=1.154.2.1), [colored](kernfs_vnops.c.diff?r1=1.154;r2=1.154.2.1;f=h); next MAIN 1.155: [preferred](kernfs_vnops.c.diff?r1=1.155;r2=1.154.2.1), [colored](kernfs_vnops.c.diff?r1=1.155;r2=1.154.2.1;f=h)

Changes since revision 1.154: +24 -2
lines
```

Pull up following revision(s) (requested by hannken in ticket #1703):

	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.161
	sys/miscfs/procfs/procfs_vnops.c: revision 1.207

Add missing operation VOP_GETPAGES() returning EFAULT.

Without this operation posix_fadvise(..., POSIX_FADV_WILLNEED)
would leave the v_interlock held.

Observed by maxv@

```

---

Revision **1.161**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.161;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.161;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.161;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.161) - [select for diffs](kernfs_vnops.c?r1=1.161#rev1.161)

*Thu Aug 29 06:43:13 2019 UTC* (5 years, 4 months ago) by *hannken*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [phil-wifi-20191119](./kernfs_vnops.c?only_with_tag=phil-wifi-20191119)

Diff to: previous 1.160: [preferred](kernfs_vnops.c.diff?r1=1.160;r2=1.161), [colored](kernfs_vnops.c.diff?r1=1.160;r2=1.161;f=h)

Changes since revision 1.160: +24 -2
lines
```

Add missing operation VOP_GETPAGES() returning EFAULT.

Without this operation posix_fadvise(..., POSIX_FADV_WILLNEED)
would leave the v_interlock held.

Observed by maxv@

```

---

Revision **1.159.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.159.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.159.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.159.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.159.2.1) - [select for diffs](kernfs_vnops.c?r1=1.159.2.1#rev1.159.2.1)

*Mon Jun 10 22:09:05 2019 UTC* (5 years, 7 months ago) by *christos*

Branches: [phil-wifi](./kernfs_vnops.c?only_with_tag=phil-wifi)

Diff to: previous 1.159: [preferred](kernfs_vnops.c.diff?r1=1.159;r2=1.159.2.1), [colored](kernfs_vnops.c.diff?r1=1.159;r2=1.159.2.1;f=h)

Changes since revision 1.159: +7 -7
lines
```

Sync with HEAD

```

---

Revision **1.158.8.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.158.8.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.158.8.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.158.8.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.158.8.2) - [select for diffs](kernfs_vnops.c?r1=1.158.8.2#rev1.158.8.2)

*Thu Sep 6 06:56:43 2018 UTC* (6 years, 4 months ago) by *pgoyette*

Branches: [pgoyette-compat](./kernfs_vnops.c?only_with_tag=pgoyette-compat)

CVS tags: [pgoyette-compat-merge-20190127](./kernfs_vnops.c?only_with_tag=pgoyette-compat-merge-20190127)

Diff to: previous 1.158.8.1: [preferred](kernfs_vnops.c.diff?r1=1.158.8.1;r2=1.158.8.2), [colored](kernfs_vnops.c.diff?r1=1.158.8.1;r2=1.158.8.2;f=h); branchpoint 1.158: [preferred](kernfs_vnops.c.diff?r1=1.158;r2=1.158.8.2), [colored](kernfs_vnops.c.diff?r1=1.158;r2=1.158.8.2;f=h); next MAIN 1.159: [preferred](kernfs_vnops.c.diff?r1=1.159;r2=1.158.8.2), [colored](kernfs_vnops.c.diff?r1=1.159;r2=1.158.8.2;f=h)

Changes since revision 1.158.8.1: +7 -7
lines
```

Sync with HEAD

Resolve a couple of conflicts (result of the uimin/uimax changes)

```

---

Revision **1.160**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.160;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.160;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.160;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.160) - [select for diffs](kernfs_vnops.c?r1=1.160#rev1.160)

*Mon Sep 3 16:29:35 2018 UTC* (6 years, 4 months ago) by *riastradh*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [phil-wifi-20190609](./kernfs_vnops.c?only_with_tag=phil-wifi-20190609),
[pgoyette-compat-20190127](./kernfs_vnops.c?only_with_tag=pgoyette-compat-20190127),
[pgoyette-compat-20190118](./kernfs_vnops.c?only_with_tag=pgoyette-compat-20190118),
[pgoyette-compat-1226](./kernfs_vnops.c?only_with_tag=pgoyette-compat-1226),
[pgoyette-compat-1126](./kernfs_vnops.c?only_with_tag=pgoyette-compat-1126),
[pgoyette-compat-1020](./kernfs_vnops.c?only_with_tag=pgoyette-compat-1020),
[pgoyette-compat-0930](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0930),
[pgoyette-compat-0906](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0906),
[netbsd-9-base](./kernfs_vnops.c?only_with_tag=netbsd-9-base),
[isaki-audio2-base](./kernfs_vnops.c?only_with_tag=isaki-audio2-base),
[isaki-audio2](./kernfs_vnops.c?only_with_tag=isaki-audio2)

Branch point for: [netbsd-9](./kernfs_vnops.c?only_with_tag=netbsd-9)

Diff to: previous 1.159: [preferred](kernfs_vnops.c.diff?r1=1.159;r2=1.160), [colored](kernfs_vnops.c.diff?r1=1.159;r2=1.160;f=h)

Changes since revision 1.159: +7 -7
lines
```

Rename min/max -> uimin/uimax for better honesty.

These functions are defined on unsigned int.  The generic name
min/max should not silently truncate to 32 bits on 64-bit systems.
This is purely a name change -- no functional change intended.

HOWEVER!  Some subsystems have

	#define min(a, b)	((a) < (b) ? (a) : (b))
	#define max(a, b)	((a) > (b) ? (a) : (b))

even though our standard name for that is MIN/MAX.  Although these
may invite multiple evaluation bugs, these do _not_ cause integer
truncation.

To avoid `fixing' these cases, I first changed the name in libkern,
and then compile-tested every file where min/max occurred in order to
confirm that it failed -- and thus confirm that nothing shadowed
min/max -- before changing it.

I have left a handful of bootloaders that are too annoying to
compile-test, and some dead code:

cobalt ews4800mips hp300 hppa ia64 luna68k vax
acorn32/if_ie.c (not included in any kernels)
macppc/if_gm.c (superseded by [gem(4)](http://man.NetBSD.org/gem.4))

It should be easy to fix the fallout once identified -- this way of
doing things fails safe, and the goal here, after all, is to _avoid_
silent integer truncations, not introduce them.

Maybe one day we can reintroduce min/max as type-generic things that
never silently truncate.  But we should avoid doing that for a while,
so that existing code has a chance to be detected by the compiler for
conversion to uimin/uimax without changing the semantics until we can
properly audit it all.  (Who knows, maybe in some cases integer
truncation is actually intended!)

```

---

Revision **1.158.8.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.158.8.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.158.8.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.158.8.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.158.8.1) - [select for diffs](kernfs_vnops.c?r1=1.158.8.1#rev1.158.8.1)

*Sat Apr 7 04:12:19 2018 UTC* (6 years, 9 months ago) by *pgoyette*

Branches: [pgoyette-compat](./kernfs_vnops.c?only_with_tag=pgoyette-compat)

Diff to: previous 1.158: [preferred](kernfs_vnops.c.diff?r1=1.158;r2=1.158.8.1), [colored](kernfs_vnops.c.diff?r1=1.158;r2=1.158.8.1;f=h)

Changes since revision 1.158: +4 -5
lines
```

Sync with HEAD.  77 conflicts resolved - all of them $NetBSD$

```

---

Revision **1.159**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.159;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.159;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.159;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.159) - [select for diffs](kernfs_vnops.c?r1=1.159#rev1.159)

*Sat Mar 31 23:12:01 2018 UTC* (6 years, 9 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [phil-wifi-base](./kernfs_vnops.c?only_with_tag=phil-wifi-base),
[pgoyette-compat-0728](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0728),
[pgoyette-compat-0625](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0625),
[pgoyette-compat-0521](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0521),
[pgoyette-compat-0502](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0502),
[pgoyette-compat-0422](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0422),
[pgoyette-compat-0415](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0415),
[pgoyette-compat-0407](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0407)

Branch point for: [phil-wifi](./kernfs_vnops.c?only_with_tag=phil-wifi)

Diff to: previous 1.158: [preferred](kernfs_vnops.c.diff?r1=1.158;r2=1.159), [colored](kernfs_vnops.c.diff?r1=1.158;r2=1.159;f=h)

Changes since revision 1.158: +4 -5
lines
```

factor out some repeated code and simplify the logputchar function.

```

---

Revision **1.146.2.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.146.2.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.146.2.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.146.2.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.146.2.3) - [select for diffs](kernfs_vnops.c?r1=1.146.2.3#rev1.146.2.3)

*Sun Dec 3 11:38:47 2017 UTC* (7 years, 1 month ago) by *jdolecek*

Branches: [tls-maxphys](./kernfs_vnops.c?only_with_tag=tls-maxphys)

Diff to: previous 1.146.2.2: [preferred](kernfs_vnops.c.diff?r1=1.146.2.2;r2=1.146.2.3), [colored](kernfs_vnops.c.diff?r1=1.146.2.2;r2=1.146.2.3;f=h); branchpoint 1.146: [preferred](kernfs_vnops.c.diff?r1=1.146;r2=1.146.2.3), [colored](kernfs_vnops.c.diff?r1=1.146;r2=1.146.2.3;f=h); next MAIN 1.147: [preferred](kernfs_vnops.c.diff?r1=1.147;r2=1.146.2.3), [colored](kernfs_vnops.c.diff?r1=1.147;r2=1.146.2.3;f=h)

Changes since revision 1.146.2.2: +6 -7
lines
```

update from HEAD

```

---

Revision **1.154.4.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.154.4.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.154.4.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.154.4.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.154.4.3) - [select for diffs](kernfs_vnops.c?r1=1.154.4.3#rev1.154.4.3)

*Mon Aug 28 17:53:08 2017 UTC* (7 years, 4 months ago) by *skrll*

Branches: [nick-nhusb](./kernfs_vnops.c?only_with_tag=nick-nhusb)

Diff to: previous 1.154.4.2: [preferred](kernfs_vnops.c.diff?r1=1.154.4.2;r2=1.154.4.3), [colored](kernfs_vnops.c.diff?r1=1.154.4.2;r2=1.154.4.3;f=h); branchpoint 1.154: [preferred](kernfs_vnops.c.diff?r1=1.154;r2=1.154.4.3), [colored](kernfs_vnops.c.diff?r1=1.154;r2=1.154.4.3;f=h); next MAIN 1.155: [preferred](kernfs_vnops.c.diff?r1=1.155;r2=1.154.4.3), [colored](kernfs_vnops.c.diff?r1=1.155;r2=1.154.4.3;f=h)

Changes since revision 1.154.4.2: +7 -6
lines
```

Sync with HEAD

```

---

Revision **1.158**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.158;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.158;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.158;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.158) - [select for diffs](kernfs_vnops.c?r1=1.158#rev1.158)

*Fri May 26 14:21:01 2017 UTC* (7 years, 8 months ago) by *riastradh*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [tls-maxphys-base-20171202](./kernfs_vnops.c?only_with_tag=tls-maxphys-base-20171202),
[pgoyette-compat-base](./kernfs_vnops.c?only_with_tag=pgoyette-compat-base),
[pgoyette-compat-0330](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0330),
[pgoyette-compat-0322](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0322),
[pgoyette-compat-0315](./kernfs_vnops.c?only_with_tag=pgoyette-compat-0315),
[perseant-stdc-iso10646-base](./kernfs_vnops.c?only_with_tag=perseant-stdc-iso10646-base),
[perseant-stdc-iso10646](./kernfs_vnops.c?only_with_tag=perseant-stdc-iso10646),
[nick-nhusb-base-20170825](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20170825),
[netbsd-8-base](./kernfs_vnops.c?only_with_tag=netbsd-8-base),
[netbsd-8-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-8-1-RELEASE),
[netbsd-8-1-RC1](./kernfs_vnops.c?only_with_tag=netbsd-8-1-RC1),
[netbsd-8-0-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-8-0-RELEASE),
[netbsd-8-0-RC2](./kernfs_vnops.c?only_with_tag=netbsd-8-0-RC2),
[netbsd-8-0-RC1](./kernfs_vnops.c?only_with_tag=netbsd-8-0-RC1),
[matt-nb8-mediatek-base](./kernfs_vnops.c?only_with_tag=matt-nb8-mediatek-base),
[matt-nb8-mediatek](./kernfs_vnops.c?only_with_tag=matt-nb8-mediatek)

Branch point for: [pgoyette-compat](./kernfs_vnops.c?only_with_tag=pgoyette-compat),
[netbsd-8](./kernfs_vnops.c?only_with_tag=netbsd-8)

Diff to: previous 1.157: [preferred](kernfs_vnops.c.diff?r1=1.157;r2=1.158), [colored](kernfs_vnops.c.diff?r1=1.157;r2=1.158;f=h)

Changes since revision 1.157: +5 -3
lines
```

Make VOP_RECLAIM do the last unlock of the vnode.

VOP_RECLAIM naturally has exclusive access to the vnode, so having it
locked on entry is not strictly necessary -- but it means if there
are any final operations that must be done on the vnode, such as
ffs_update, requiring exclusive access to it, we can now kassert that
the vnode is locked in those operations.

We can't just have the caller release the last lock because some file
systems don't use genfs_lock, and require the vnode to remain valid
for VOP_UNLOCK to work, notably unionfs.

```

---

Revision **1.155.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.155.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.155.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.155.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.155.2.1) - [select for diffs](kernfs_vnops.c?r1=1.155.2.1#rev1.155.2.1)

*Wed Apr 26 02:53:27 2017 UTC* (7 years, 9 months ago) by *pgoyette*

Branches: [pgoyette-localcount](./kernfs_vnops.c?only_with_tag=pgoyette-localcount)

Diff to: previous 1.155: [preferred](kernfs_vnops.c.diff?r1=1.155;r2=1.155.2.1), [colored](kernfs_vnops.c.diff?r1=1.155;r2=1.155.2.1;f=h); next MAIN 1.156: [preferred](kernfs_vnops.c.diff?r1=1.156;r2=1.155.2.1), [colored](kernfs_vnops.c.diff?r1=1.156;r2=1.155.2.1;f=h)

Changes since revision 1.155: +4 -5
lines
```

Sync with HEAD

```

---

Revision **1.156.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.156.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.156.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.156.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.156.2.1) - [select for diffs](kernfs_vnops.c?r1=1.156.2.1#rev1.156.2.1)

*Fri Apr 21 16:54:03 2017 UTC* (7 years, 9 months ago) by *bouyer*

Branches: [bouyer-socketcan](./kernfs_vnops.c?only_with_tag=bouyer-socketcan)

Diff to: previous 1.156: [preferred](kernfs_vnops.c.diff?r1=1.156;r2=1.156.2.1), [colored](kernfs_vnops.c.diff?r1=1.156;r2=1.156.2.1;f=h); next MAIN 1.157: [preferred](kernfs_vnops.c.diff?r1=1.157;r2=1.156.2.1), [colored](kernfs_vnops.c.diff?r1=1.157;r2=1.156.2.1;f=h)

Changes since revision 1.156: +4 -5
lines
```

Sync with HEAD

```

---

Revision **1.157**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.157;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.157;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.157;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.157) - [select for diffs](kernfs_vnops.c?r1=1.157#rev1.157)

*Tue Apr 11 14:25:01 2017 UTC* (7 years, 9 months ago) by *riastradh*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [prg-localcount2-base3](./kernfs_vnops.c?only_with_tag=prg-localcount2-base3),
[prg-localcount2-base2](./kernfs_vnops.c?only_with_tag=prg-localcount2-base2),
[prg-localcount2-base1](./kernfs_vnops.c?only_with_tag=prg-localcount2-base1),
[prg-localcount2-base](./kernfs_vnops.c?only_with_tag=prg-localcount2-base),
[prg-localcount2](./kernfs_vnops.c?only_with_tag=prg-localcount2),
[pgoyette-localcount-20170426](./kernfs_vnops.c?only_with_tag=pgoyette-localcount-20170426),
[bouyer-socketcan-base1](./kernfs_vnops.c?only_with_tag=bouyer-socketcan-base1)

Diff to: previous 1.156: [preferred](kernfs_vnops.c.diff?r1=1.156;r2=1.157), [colored](kernfs_vnops.c.diff?r1=1.156;r2=1.157;f=h)

Changes since revision 1.156: +4 -5
lines
```

Make VOP_INACTIVE preserve vnode lock on return.

Discussed on tech-kern:
<https://mail-index.netbsd.org/tech-kern/2017/04/01/msg021751.html>

Ride 7.99.68, a bumpy bus of incremental vfs improvements!

```

---

Revision **1.154.4.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.154.4.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.154.4.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.154.4.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.154.4.2) - [select for diffs](kernfs_vnops.c?r1=1.154.4.2#rev1.154.4.2)

*Wed Oct 5 20:56:03 2016 UTC* (8 years, 3 months ago) by *skrll*

Branches: [nick-nhusb](./kernfs_vnops.c?only_with_tag=nick-nhusb)

Diff to: previous 1.154.4.1: [preferred](kernfs_vnops.c.diff?r1=1.154.4.1;r2=1.154.4.2), [colored](kernfs_vnops.c.diff?r1=1.154.4.1;r2=1.154.4.2;f=h); branchpoint 1.154: [preferred](kernfs_vnops.c.diff?r1=1.154;r2=1.154.4.2), [colored](kernfs_vnops.c.diff?r1=1.154;r2=1.154.4.2;f=h)

Changes since revision 1.154.4.1: +4 -5
lines
```

Sync with HEAD

```

---

Revision **1.144.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.144.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.144.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.144.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.144.2.2) - [select for diffs](kernfs_vnops.c?r1=1.144.2.2#rev1.144.2.2)

*Sat Sep 3 11:36:03 2016 UTC* (8 years, 4 months ago) by *bouyer*

Branches: [netbsd-6](./kernfs_vnops.c?only_with_tag=netbsd-6)

Diff to: previous 1.144.2.1: [preferred](kernfs_vnops.c.diff?r1=1.144.2.1;r2=1.144.2.2), [colored](kernfs_vnops.c.diff?r1=1.144.2.1;r2=1.144.2.2;f=h); branchpoint 1.144: [preferred](kernfs_vnops.c.diff?r1=1.144;r2=1.144.2.2), [colored](kernfs_vnops.c.diff?r1=1.144;r2=1.144.2.2;f=h); next MAIN 1.145: [preferred](kernfs_vnops.c.diff?r1=1.145;r2=1.144.2.2), [colored](kernfs_vnops.c.diff?r1=1.145;r2=1.144.2.2;f=h)

Changes since revision 1.144.2.1: +15 -10
lines
```

Revert ticket 1367, it causes a kernel panic in test lib/libc/gen/t_getcwd
as seen in e.g.
<http://www-soc.lip6.fr/~bouyer/NetBSD-tests/xen/netbsd-6/i386/201608291710Z_anita.txt>

lib/libc/gen/t_getcwd (206/500): 2 test cases
    getcwd_err: [0.006614s] Passed.
    getcwd_fts: uvm_fault(0xc0e221b0, 0, 1) -> 0xe
fatal page fault in supervisor mode
trap type 6 code 0 eip c023ba9f cs 9 eflags 10246 cr2 1c ilevel 0
panic: trap
cpu1: Begin traceback...
panic(c04616d0,cdcfb938,cdcfb938,c023ba9f,9,10246,1c,0,1c,0) at netbsd:panic+0x18
trap() at netbsd:trap+0xb51
--- trap (number 6) ---
kernfs_readdir(cdcfbc0c,1,c11ce0b4,c0439f60,c11ce0b4,cdcfbc58,c0cc0cc0,cdcfbc7c,0,0) at netbsd:kernfs_readdir+0x98f
VOP_READDIR(c11ce0b4,cdcfbc58,c0cc0cc0,cdcfbc7c,0,0,c19287e0,1,cdcfbc58,cdcfbc74) at netbsd:VOP_READDIR+0x68
vn_readdir(c14c3000,bb512000,0,1000,cdcfbcbc,c19287e0,0,0,c14c3000,0) at netbsd:vn_readdir+0xbd
sys___getdents30(c19287e0,cdcfbd00,cdcfbd28,186,bb516000,0,cdcfbd00,c1199bf4,2,bb7a4fe7) at netbsd:sys___getdents30+0x8c
syscall(cdcfbd48,bb6b00b3,ab,bf7f001f,bb6b001f,0,bb5010d0,bf7fe764,bb7c4be0,0) at netbsd:syscall+0xaa
cpu1: End traceback...

```

---

Revision **1.144.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.144.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.144.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.144.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.144.2.1) - [select for diffs](kernfs_vnops.c?r1=1.144.2.1#rev1.144.2.1)

*Sat Aug 27 13:13:31 2016 UTC* (8 years, 5 months ago) by *bouyer*

Branches: [netbsd-6](./kernfs_vnops.c?only_with_tag=netbsd-6)

Diff to: previous 1.144: [preferred](kernfs_vnops.c.diff?r1=1.144;r2=1.144.2.1), [colored](kernfs_vnops.c.diff?r1=1.144;r2=1.144.2.1;f=h)

Changes since revision 1.144: +10 -15
lines
```

Pull up following revision(s) (requested by is in ticket #1367):
        sys/miscfs/kernfs/kernfs_vnops.c: revision 1.151
>From Ilya Zykov: Unbreak kernfs which was broken by this commit

|Make the spec_node table implementation private to spec_vnops.c.
|To retrieve a spec_node, two new lookup functions (by device or by mount)
|are implemented.  Both return a referenced vnode, for an opened block device
|the opened vnode is returned so further diagnostic checks "vp == ... sd_bdevvp"
|will not fire.  Otherwise any vnode matching the criteria gets returned.
|No objections on tech-kern.

The effect was that ls /kernfs appeared empty in most cases.

```

---

Revision **1.156**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.156;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.156;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.156;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.156) - [select for diffs](kernfs_vnops.c?r1=1.156#rev1.156)

*Sat Aug 20 12:37:09 2016 UTC* (8 years, 5 months ago) by *hannken*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [pgoyette-localcount-20170320](./kernfs_vnops.c?only_with_tag=pgoyette-localcount-20170320),
[pgoyette-localcount-20170107](./kernfs_vnops.c?only_with_tag=pgoyette-localcount-20170107),
[pgoyette-localcount-20161104](./kernfs_vnops.c?only_with_tag=pgoyette-localcount-20161104),
[nick-nhusb-base-20170204](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20170204),
[nick-nhusb-base-20161204](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20161204),
[nick-nhusb-base-20161004](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20161004),
[localcount-20160914](./kernfs_vnops.c?only_with_tag=localcount-20160914),
[jdolecek-ncq-base](./kernfs_vnops.c?only_with_tag=jdolecek-ncq-base),
[jdolecek-ncq](./kernfs_vnops.c?only_with_tag=jdolecek-ncq),
[bouyer-socketcan-base](./kernfs_vnops.c?only_with_tag=bouyer-socketcan-base)

Branch point for: [bouyer-socketcan](./kernfs_vnops.c?only_with_tag=bouyer-socketcan)

Diff to: previous 1.155: [preferred](kernfs_vnops.c.diff?r1=1.155;r2=1.156), [colored](kernfs_vnops.c.diff?r1=1.155;r2=1.156;f=h)

Changes since revision 1.155: +2 -3
lines
```

Remove now obsolete operation vcache_remove().

Welcome to 7.99.36

```

---

Revision **1.154.4.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.154.4.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.154.4.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.154.4.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.154.4.1) - [select for diffs](kernfs_vnops.c?r1=1.154.4.1#rev1.154.4.1)

*Sat Jun 6 14:40:22 2015 UTC* (9 years, 7 months ago) by *skrll*

Branches: [nick-nhusb](./kernfs_vnops.c?only_with_tag=nick-nhusb)

Diff to: previous 1.154: [preferred](kernfs_vnops.c.diff?r1=1.154;r2=1.154.4.1), [colored](kernfs_vnops.c.diff?r1=1.154;r2=1.154.4.1;f=h)

Changes since revision 1.154: +3 -4
lines
```

Sync with HEAD

```

---

Revision **1.155**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.155;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.155;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.155;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.155) - [select for diffs](kernfs_vnops.c?r1=1.155#rev1.155)

*Mon Apr 20 23:03:08 2015 UTC* (9 years, 9 months ago) by *riastradh*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [pgoyette-localcount-base](./kernfs_vnops.c?only_with_tag=pgoyette-localcount-base),
[pgoyette-localcount-20160806](./kernfs_vnops.c?only_with_tag=pgoyette-localcount-20160806),
[pgoyette-localcount-20160726](./kernfs_vnops.c?only_with_tag=pgoyette-localcount-20160726),
[nick-nhusb-base-20160907](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20160907),
[nick-nhusb-base-20160529](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20160529),
[nick-nhusb-base-20160422](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20160422),
[nick-nhusb-base-20160319](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20160319),
[nick-nhusb-base-20151226](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20151226),
[nick-nhusb-base-20150921](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20150921),
[nick-nhusb-base-20150606](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20150606)

Branch point for: [pgoyette-localcount](./kernfs_vnops.c?only_with_tag=pgoyette-localcount)

Diff to: previous 1.154: [preferred](kernfs_vnops.c.diff?r1=1.154;r2=1.155), [colored](kernfs_vnops.c.diff?r1=1.154;r2=1.155;f=h)

Changes since revision 1.154: +3 -4
lines
```

Make VOP_LINK return directory still locked and referenced.

Ride 7.99.10 bump.

```

---

Revision **1.146.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.146.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.146.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.146.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.146.2.2) - [select for diffs](kernfs_vnops.c?r1=1.146.2.2#rev1.146.2.2)

*Wed Aug 20 00:04:31 2014 UTC* (10 years, 5 months ago) by *tls*

Branches: [tls-maxphys](./kernfs_vnops.c?only_with_tag=tls-maxphys)

Diff to: previous 1.146.2.1: [preferred](kernfs_vnops.c.diff?r1=1.146.2.1;r2=1.146.2.2), [colored](kernfs_vnops.c.diff?r1=1.146.2.1;r2=1.146.2.2;f=h); branchpoint 1.146: [preferred](kernfs_vnops.c.diff?r1=1.146;r2=1.146.2.2), [colored](kernfs_vnops.c.diff?r1=1.146;r2=1.146.2.2;f=h)

Changes since revision 1.146.2.1: +28 -24
lines
```

Rebase to HEAD as of a few days ago.

```

---

Revision **1.150.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.150.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.150.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.150.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.150.2.1) - [select for diffs](kernfs_vnops.c?r1=1.150.2.1#rev1.150.2.1)

*Sun Aug 10 06:56:05 2014 UTC* (10 years, 5 months ago) by *tls*

Branches: [tls-earlyentropy](./kernfs_vnops.c?only_with_tag=tls-earlyentropy)

Diff to: previous 1.150: [preferred](kernfs_vnops.c.diff?r1=1.150;r2=1.150.2.1), [colored](kernfs_vnops.c.diff?r1=1.150;r2=1.150.2.1;f=h); next MAIN 1.151: [preferred](kernfs_vnops.c.diff?r1=1.151;r2=1.150.2.1), [colored](kernfs_vnops.c.diff?r1=1.151;r2=1.150.2.1;f=h)

Changes since revision 1.150: +28 -26
lines
```

Rebase.

```

---

Revision **1.154**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.154;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.154;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.154;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.154) - [select for diffs](kernfs_vnops.c?r1=1.154#rev1.154)

*Fri Jul 25 08:20:52 2014 UTC* (10 years, 6 months ago) by *dholland*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [tls-maxphys-base](./kernfs_vnops.c?only_with_tag=tls-maxphys-base),
[tls-earlyentropy-base](./kernfs_vnops.c?only_with_tag=tls-earlyentropy-base),
[nick-nhusb-base-20150406](./kernfs_vnops.c?only_with_tag=nick-nhusb-base-20150406),
[nick-nhusb-base](./kernfs_vnops.c?only_with_tag=nick-nhusb-base),
[netbsd-7-nhusb-base-20170116](./kernfs_vnops.c?only_with_tag=netbsd-7-nhusb-base-20170116),
[netbsd-7-nhusb-base](./kernfs_vnops.c?only_with_tag=netbsd-7-nhusb-base),
[netbsd-7-nhusb](./kernfs_vnops.c?only_with_tag=netbsd-7-nhusb),
[netbsd-7-base](./kernfs_vnops.c?only_with_tag=netbsd-7-base),
[netbsd-7-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-7-2-RELEASE),
[netbsd-7-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-7-1-RELEASE),
[netbsd-7-1-RC2](./kernfs_vnops.c?only_with_tag=netbsd-7-1-RC2),
[netbsd-7-1-RC1](./kernfs_vnops.c?only_with_tag=netbsd-7-1-RC1),
[netbsd-7-1-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-7-1-2-RELEASE),
[netbsd-7-1-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-7-1-1-RELEASE),
[netbsd-7-0-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-7-0-RELEASE),
[netbsd-7-0-RC3](./kernfs_vnops.c?only_with_tag=netbsd-7-0-RC3),
[netbsd-7-0-RC2](./kernfs_vnops.c?only_with_tag=netbsd-7-0-RC2),
[netbsd-7-0-RC1](./kernfs_vnops.c?only_with_tag=netbsd-7-0-RC1),
[netbsd-7-0-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-7-0-2-RELEASE),
[netbsd-7-0-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-7-0-1-RELEASE)

Branch point for: [nick-nhusb](./kernfs_vnops.c?only_with_tag=nick-nhusb),
[netbsd-7-1](./kernfs_vnops.c?only_with_tag=netbsd-7-1),
[netbsd-7-0](./kernfs_vnops.c?only_with_tag=netbsd-7-0),
[netbsd-7](./kernfs_vnops.c?only_with_tag=netbsd-7)

Diff to: previous 1.153: [preferred](kernfs_vnops.c.diff?r1=1.153;r2=1.154), [colored](kernfs_vnops.c.diff?r1=1.153;r2=1.154;f=h)

Changes since revision 1.153: +4 -2
lines
```

Add VOP_FALLOCATE and VOP_FDISCARD to every vnode ops table I can
find.

The filesystem ones all call genfs_eopnotsupp - right now I am only
implementing the plumbing and we can implement fallocate and/or
fdiscard for files later.

The device ones call spec_fallocate (which is also genfs_eopnotsupp)
and spec_fdiscard, which dispatches to the device-level op.

The fifo ones all call vn_fifo_bypass, which also ends up being
EOPNOTSUPP.

```

---

Revision **1.153**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.153;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.153;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.153;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.153) - [select for diffs](kernfs_vnops.c?r1=1.153#rev1.153)

*Sun Jul 20 13:58:04 2014 UTC* (10 years, 6 months ago) by *hannken*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.152: [preferred](kernfs_vnops.c.diff?r1=1.152;r2=1.153), [colored](kernfs_vnops.c.diff?r1=1.152;r2=1.153;f=h)

Changes since revision 1.152: +16 -10
lines
```

Change kernfs from hashlist to vcache.

```

---

Revision **1.152**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.152;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.152;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.152;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.152) - [select for diffs](kernfs_vnops.c?r1=1.152#rev1.152)

*Thu Jul 17 08:21:34 2014 UTC* (10 years, 6 months ago) by *hannken*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.151: [preferred](kernfs_vnops.c.diff?r1=1.151;r2=1.152), [colored](kernfs_vnops.c.diff?r1=1.151;r2=1.152;f=h)

Changes since revision 1.151: +6 -7
lines
```

Finish KAME IPSEC removal:
- Remove field kfs_value, it is always zero. Compute the hash from kt_tag.
- Remove stray definitions kernfs_revoke_sa and kernfs_revoke_sp.

While here, remove kfs_type from allocvp(), it is always kt->kt_tag.

```

---

Revision **1.143.8.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.143.8.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.143.8.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.143.8.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.143.8.2) - [select for diffs](kernfs_vnops.c?r1=1.143.8.2#rev1.143.8.2)

*Thu May 22 11:41:05 2014 UTC* (10 years, 8 months ago) by *yamt*

Branches: [yamt-pagecache](./kernfs_vnops.c?only_with_tag=yamt-pagecache)

Diff to: previous 1.143.8.1: [preferred](kernfs_vnops.c.diff?r1=1.143.8.1;r2=1.143.8.2), [colored](kernfs_vnops.c.diff?r1=1.143.8.1;r2=1.143.8.2;f=h); branchpoint 1.143: [preferred](kernfs_vnops.c.diff?r1=1.143;r2=1.143.8.2), [colored](kernfs_vnops.c.diff?r1=1.143;r2=1.143.8.2;f=h); next MAIN 1.144: [preferred](kernfs_vnops.c.diff?r1=1.144;r2=1.143.8.2), [colored](kernfs_vnops.c.diff?r1=1.144;r2=1.143.8.2;f=h)

Changes since revision 1.143.8.1: +17 -20
lines
```

sync with head.

for a reference, the tree before this commit was tagged
as yamt-pagecache-tag8.

this commit was splitted into small chunks to avoid
a limitation of cvs.  ("Protocol error: too many arguments")

```

---

Revision **1.147.6.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.147.6.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.147.6.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.147.6.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.147.6.1) - [select for diffs](kernfs_vnops.c?r1=1.147.6.1#rev1.147.6.1)

*Sun May 18 17:46:09 2014 UTC* (10 years, 8 months ago) by *rmind*

Branches: [rmind-smpnet](./kernfs_vnops.c?only_with_tag=rmind-smpnet)

Diff to: previous 1.147: [preferred](kernfs_vnops.c.diff?r1=1.147;r2=1.147.6.1), [colored](kernfs_vnops.c.diff?r1=1.147;r2=1.147.6.1;f=h); next MAIN 1.148: [preferred](kernfs_vnops.c.diff?r1=1.148;r2=1.147.6.1), [colored](kernfs_vnops.c.diff?r1=1.148;r2=1.147.6.1;f=h)

Changes since revision 1.147: +16 -19
lines
```

sync with head

```

---

Revision **1.151**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.151;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.151;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.151;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.151) - [select for diffs](kernfs_vnops.c?r1=1.151#rev1.151)

*Tue Apr 8 17:56:10 2014 UTC* (10 years, 9 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-pagecache-base9](./kernfs_vnops.c?only_with_tag=yamt-pagecache-base9),
[rmind-smpnet-nbase](./kernfs_vnops.c?only_with_tag=rmind-smpnet-nbase),
[rmind-smpnet-base](./kernfs_vnops.c?only_with_tag=rmind-smpnet-base)

Diff to: previous 1.150: [preferred](kernfs_vnops.c.diff?r1=1.150;r2=1.151), [colored](kernfs_vnops.c.diff?r1=1.150;r2=1.151;f=h)

Changes since revision 1.150: +10 -15
lines
```

From Ilya Zykov: Unbreak kernfs which was broken by this commit

|Make the spec_node table implementation private to spec_vnops.c.
|To retrieve a spec_node, two new lookup functions (by device or by mount)
|are implemented.  Both return a referenced vnode, for an opened block device
|the opened vnode is returned so further diagnostic checks "vp == ... sd_bdevvp"
|will not fire.  Otherwise any vnode matching the criteria gets returned.
|No objections on tech-kern.

The effect was that ls /kernfs appeared empty in most cases.

```

---

Revision **1.150**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.150;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.150;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.150;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.150) - [select for diffs](kernfs_vnops.c?r1=1.150#rev1.150)

*Fri Feb 7 15:29:22 2014 UTC* (10 years, 11 months ago) by *hannken*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [riastradh-xf86-video-intel-2-7-1-pre-2-21-15](./kernfs_vnops.c?only_with_tag=riastradh-xf86-video-intel-2-7-1-pre-2-21-15),
[riastradh-drm2-base3](./kernfs_vnops.c?only_with_tag=riastradh-drm2-base3)

Branch point for: [tls-earlyentropy](./kernfs_vnops.c?only_with_tag=tls-earlyentropy)

Diff to: previous 1.149: [preferred](kernfs_vnops.c.diff?r1=1.149;r2=1.150), [colored](kernfs_vnops.c.diff?r1=1.149;r2=1.150;f=h)

Changes since revision 1.149: +7 -4
lines
```

Change vnode operation lookup to return the resulting vnode *vpp unlocked.
Change cache_lookup() to return an unlocked vnode.

Discussed on tech-kern@

Welcome to 6.99.31

```

---

Revision **1.149**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.149;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.149;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.149;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.149) - [select for diffs](kernfs_vnops.c?r1=1.149#rev1.149)

*Thu Jan 23 10:13:57 2014 UTC* (11 years ago) by *hannken*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.148: [preferred](kernfs_vnops.c.diff?r1=1.148;r2=1.149), [colored](kernfs_vnops.c.diff?r1=1.148;r2=1.149;f=h)

Changes since revision 1.148: +3 -3
lines
```

Change vnode operations create, mknod, mkdir and symlink to return
the resulting vnode *vpp unlocked.

Discussed on tech-kern@

Welcome to 6.99.30

```

---

Revision **1.148**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.148;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.148;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.148;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.148) - [select for diffs](kernfs_vnops.c?r1=1.148#rev1.148)

*Fri Jan 17 10:55:02 2014 UTC* (11 years ago) by *hannken*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.147: [preferred](kernfs_vnops.c.diff?r1=1.147;r2=1.148), [colored](kernfs_vnops.c.diff?r1=1.147;r2=1.148;f=h)

Changes since revision 1.147: +3 -4
lines
```

Change vnode operations create, mknod, mkdir and symlink to keep the
directory node dvp locked on return.

Discussed on tech-kern@

Welcome to 6.99.29

```

---

Revision **1.146.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.146.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.146.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.146.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.146.2.1) - [select for diffs](kernfs_vnops.c?r1=1.146.2.1#rev1.146.2.1)

*Sun Jun 23 06:20:24 2013 UTC* (11 years, 7 months ago) by *tls*

Branches: [tls-maxphys](./kernfs_vnops.c?only_with_tag=tls-maxphys)

Diff to: previous 1.146: [preferred](kernfs_vnops.c.diff?r1=1.146;r2=1.146.2.1), [colored](kernfs_vnops.c.diff?r1=1.146;r2=1.146.2.1;f=h)

Changes since revision 1.146: +3 -3
lines
```

resync from head

```

---

Revision **1.147**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.147;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.147;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.147;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.147) - [select for diffs](kernfs_vnops.c?r1=1.147#rev1.147)

*Mon Mar 18 19:35:44 2013 UTC* (11 years, 10 months ago) by *plunky*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [riastradh-drm2-base2](./kernfs_vnops.c?only_with_tag=riastradh-drm2-base2),
[riastradh-drm2-base1](./kernfs_vnops.c?only_with_tag=riastradh-drm2-base1),
[riastradh-drm2-base](./kernfs_vnops.c?only_with_tag=riastradh-drm2-base),
[riastradh-drm2](./kernfs_vnops.c?only_with_tag=riastradh-drm2),
[khorben-n900](./kernfs_vnops.c?only_with_tag=khorben-n900),
[agc-symver-base](./kernfs_vnops.c?only_with_tag=agc-symver-base),
[agc-symver](./kernfs_vnops.c?only_with_tag=agc-symver)

Branch point for: [rmind-smpnet](./kernfs_vnops.c?only_with_tag=rmind-smpnet)

Diff to: previous 1.146: [preferred](kernfs_vnops.c.diff?r1=1.146;r2=1.147), [colored](kernfs_vnops.c.diff?r1=1.146;r2=1.147;f=h)

Changes since revision 1.146: +3 -3
lines
```

C99 section 6.7.2.3 (Tags) Note 3 states that:

  A type specifier of the form

	enum identifier

  without an enumerator list shall only appear after the type it
  specifies is complete.

which means that we cannot pass an "enum vtype" argument to
kauth_access_action() without fully specifying the type first.
Unfortunately there is a complicated include file loop which
makes that difficult, so convert this minimal function into a
macro (and capitalize it).

(ok elad@)

```

---

Revision **1.143.8.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.143.8.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.143.8.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.143.8.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.143.8.1) - [select for diffs](kernfs_vnops.c?r1=1.143.8.1#rev1.143.8.1)

*Tue Apr 17 00:08:34 2012 UTC* (12 years, 9 months ago) by *yamt*

Branches: [yamt-pagecache](./kernfs_vnops.c?only_with_tag=yamt-pagecache)

CVS tags: [yamt-pagecache-tag8](./kernfs_vnops.c?only_with_tag=yamt-pagecache-tag8)

Diff to: previous 1.143: [preferred](kernfs_vnops.c.diff?r1=1.143;r2=1.143.8.1), [colored](kernfs_vnops.c.diff?r1=1.143;r2=1.143.8.1;f=h)

Changes since revision 1.143: +9 -401
lines
```

sync with head

```

---

Revision **1.143.12.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.143.12.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.143.12.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.143.12.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.143.12.2) - [select for diffs](kernfs_vnops.c?r1=1.143.12.2#rev1.143.12.2)

*Thu Apr 5 21:33:42 2012 UTC* (12 years, 9 months ago) by *mrg*

Branches: [jmcneill-usbmp](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp)

Diff to: previous 1.143.12.1: [preferred](kernfs_vnops.c.diff?r1=1.143.12.1;r2=1.143.12.2), [colored](kernfs_vnops.c.diff?r1=1.143.12.1;r2=1.143.12.2;f=h); branchpoint 1.143: [preferred](kernfs_vnops.c.diff?r1=1.143;r2=1.143.12.2), [colored](kernfs_vnops.c.diff?r1=1.143;r2=1.143.12.2;f=h); next MAIN 1.144: [preferred](kernfs_vnops.c.diff?r1=1.144;r2=1.143.12.2), [colored](kernfs_vnops.c.diff?r1=1.144;r2=1.143.12.2;f=h)

Changes since revision 1.143.12.1: +8 -400
lines
```

sync to latest -current.

```

---

Revision **1.146**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.146;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.146;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.146;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.146) - [select for diffs](kernfs_vnops.c?r1=1.146#rev1.146)

*Thu Mar 22 20:34:38 2012 UTC* (12 years, 10 months ago) by *drochner*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-pagecache-base8](./kernfs_vnops.c?only_with_tag=yamt-pagecache-base8),
[yamt-pagecache-base7](./kernfs_vnops.c?only_with_tag=yamt-pagecache-base7),
[yamt-pagecache-base6](./kernfs_vnops.c?only_with_tag=yamt-pagecache-base6),
[yamt-pagecache-base5](./kernfs_vnops.c?only_with_tag=yamt-pagecache-base5),
[yamt-pagecache-base4](./kernfs_vnops.c?only_with_tag=yamt-pagecache-base4),
[jmcneill-usbmp-base9](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp-base9),
[jmcneill-usbmp-base8](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp-base8),
[jmcneill-usbmp-base10](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp-base10)

Branch point for: [tls-maxphys](./kernfs_vnops.c?only_with_tag=tls-maxphys)

Diff to: previous 1.145: [preferred](kernfs_vnops.c.diff?r1=1.145;r2=1.146), [colored](kernfs_vnops.c.diff?r1=1.145;r2=1.146;f=h)

Changes since revision 1.145: +4 -378
lines
```

remove KAME IPSEC, replaced by FAST_IPSEC

```

---

Revision **1.145**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.145;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.145;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.145;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.145) - [select for diffs](kernfs_vnops.c?r1=1.145#rev1.145)

*Tue Mar 13 18:40:57 2012 UTC* (12 years, 10 months ago) by *elad*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.144: [preferred](kernfs_vnops.c.diff?r1=1.144;r2=1.145), [colored](kernfs_vnops.c.diff?r1=1.144;r2=1.145;f=h)

Changes since revision 1.144: +6 -24
lines
```

Replace the remaining KAUTH_GENERIC_ISSUSER authorization calls with
something meaningful. All relevant documentation has been updated or
written.

Most of these changes were brought up in the following messages:

    <http://mail-index.netbsd.org/tech-kern/2012/01/18/msg012490.html>
    <http://mail-index.netbsd.org/tech-kern/2012/01/19/msg012502.html>
    <http://mail-index.netbsd.org/tech-kern/2012/02/17/msg012728.html>

Thanks to christos, manu, njoly, and jmmv for input.

Huge thanks to pgoyette for spinning these changes through some build
cycles and ATF.

```

---

Revision **1.143.12.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.143.12.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.143.12.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.143.12.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.143.12.1) - [select for diffs](kernfs_vnops.c?r1=1.143.12.1#rev1.143.12.1)

*Sat Feb 18 07:35:36 2012 UTC* (12 years, 11 months ago) by *mrg*

Branches: [jmcneill-usbmp](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp)

Diff to: previous 1.143: [preferred](kernfs_vnops.c.diff?r1=1.143;r2=1.143.12.1), [colored](kernfs_vnops.c.diff?r1=1.143;r2=1.143.12.1;f=h)

Changes since revision 1.143: +3 -3
lines
```

merge to -current.

```

---

Revision **1.144**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.144;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.144;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.144;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.144) - [select for diffs](kernfs_vnops.c?r1=1.144#rev1.144)

*Mon Dec 12 19:11:22 2011 UTC* (13 years, 1 month ago) by *njoly*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [netbsd-6-base](./kernfs_vnops.c?only_with_tag=netbsd-6-base),
[netbsd-6-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-1-RELEASE),
[netbsd-6-1-RC4](./kernfs_vnops.c?only_with_tag=netbsd-6-1-RC4),
[netbsd-6-1-RC3](./kernfs_vnops.c?only_with_tag=netbsd-6-1-RC3),
[netbsd-6-1-RC2](./kernfs_vnops.c?only_with_tag=netbsd-6-1-RC2),
[netbsd-6-1-RC1](./kernfs_vnops.c?only_with_tag=netbsd-6-1-RC1),
[netbsd-6-1-5-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-1-5-RELEASE),
[netbsd-6-1-4-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-1-4-RELEASE),
[netbsd-6-1-3-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-1-3-RELEASE),
[netbsd-6-1-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-1-2-RELEASE),
[netbsd-6-1-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-1-1-RELEASE),
[netbsd-6-1](./kernfs_vnops.c?only_with_tag=netbsd-6-1),
[netbsd-6-0-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-0-RELEASE),
[netbsd-6-0-RC2](./kernfs_vnops.c?only_with_tag=netbsd-6-0-RC2),
[netbsd-6-0-RC1](./kernfs_vnops.c?only_with_tag=netbsd-6-0-RC1),
[netbsd-6-0-6-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-0-6-RELEASE),
[netbsd-6-0-5-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-0-5-RELEASE),
[netbsd-6-0-4-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-0-4-RELEASE),
[netbsd-6-0-3-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-0-3-RELEASE),
[netbsd-6-0-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-0-2-RELEASE),
[netbsd-6-0-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-6-0-1-RELEASE),
[netbsd-6-0](./kernfs_vnops.c?only_with_tag=netbsd-6-0),
[matt-nb6-plus-nbase](./kernfs_vnops.c?only_with_tag=matt-nb6-plus-nbase),
[matt-nb6-plus-base](./kernfs_vnops.c?only_with_tag=matt-nb6-plus-base),
[matt-nb6-plus](./kernfs_vnops.c?only_with_tag=matt-nb6-plus),
[jmcneill-usbmp-base7](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp-base7),
[jmcneill-usbmp-base6](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp-base6),
[jmcneill-usbmp-base5](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp-base5),
[jmcneill-usbmp-base4](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp-base4),
[jmcneill-usbmp-base3](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp-base3),
[jmcneill-usbmp-base2](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp-base2)

Branch point for: [netbsd-6](./kernfs_vnops.c?only_with_tag=netbsd-6)

Diff to: previous 1.143: [preferred](kernfs_vnops.c.diff?r1=1.143;r2=1.144), [colored](kernfs_vnops.c.diff?r1=1.143;r2=1.144;f=h)

Changes since revision 1.143: +3 -3
lines
```

Start making fs [read(2)](http://man.NetBSD.org/read.2) fail with EISDIR if the implementation does
not allow read on directories (kernfs, rumpfs, ptyfs and sysvbfs).
Adjust man page accordingly, and add a small corresponding vfs
testcase.

```

---

Revision **1.140.4.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.140.4.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.140.4.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.140.4.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.140.4.3) - [select for diffs](kernfs_vnops.c?r1=1.140.4.3#rev1.140.4.3)

*Sat Mar 5 20:55:31 2011 UTC* (13 years, 10 months ago) by *rmind*

Branches: [rmind-uvmplock](./kernfs_vnops.c?only_with_tag=rmind-uvmplock)

Diff to: previous 1.140.4.2: [preferred](kernfs_vnops.c.diff?r1=1.140.4.2;r2=1.140.4.3), [colored](kernfs_vnops.c.diff?r1=1.140.4.2;r2=1.140.4.3;f=h); branchpoint 1.140: [preferred](kernfs_vnops.c.diff?r1=1.140;r2=1.140.4.3), [colored](kernfs_vnops.c.diff?r1=1.140;r2=1.140.4.3;f=h); next MAIN 1.141: [preferred](kernfs_vnops.c.diff?r1=1.141;r2=1.140.4.3), [colored](kernfs_vnops.c.diff?r1=1.141;r2=1.140.4.3;f=h)

Changes since revision 1.140.4.2: +4 -2
lines
```

sync with head

```

---

Revision **1.140.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.140.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.140.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.140.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.140.2.2) - [select for diffs](kernfs_vnops.c?r1=1.140.2.2#rev1.140.2.2)

*Tue Aug 17 06:47:37 2010 UTC* (14 years, 5 months ago) by *uebayasi*

Branches: [uebayasi-xip](./kernfs_vnops.c?only_with_tag=uebayasi-xip)

Diff to: previous 1.140.2.1: [preferred](kernfs_vnops.c.diff?r1=1.140.2.1;r2=1.140.2.2), [colored](kernfs_vnops.c.diff?r1=1.140.2.1;r2=1.140.2.2;f=h); branchpoint 1.140: [preferred](kernfs_vnops.c.diff?r1=1.140;r2=1.140.2.2), [colored](kernfs_vnops.c.diff?r1=1.140;r2=1.140.2.2;f=h); next MAIN 1.141: [preferred](kernfs_vnops.c.diff?r1=1.141;r2=1.140.2.2), [colored](kernfs_vnops.c.diff?r1=1.141;r2=1.140.2.2;f=h)

Changes since revision 1.140.2.1: +3 -1
lines
```

Sync with HEAD.

```

---

Revision **1.134.12.4**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.134.12.4;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.134.12.4;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.134.12.4;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.134.12.4) - [select for diffs](kernfs_vnops.c?r1=1.134.12.4#rev1.134.12.4)

*Wed Aug 11 22:54:47 2010 UTC* (14 years, 5 months ago) by *yamt*

Branches: [yamt-nfs-mp](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp)

Diff to: previous 1.134.12.3: [preferred](kernfs_vnops.c.diff?r1=1.134.12.3;r2=1.134.12.4), [colored](kernfs_vnops.c.diff?r1=1.134.12.3;r2=1.134.12.4;f=h); branchpoint 1.134: [preferred](kernfs_vnops.c.diff?r1=1.134;r2=1.134.12.4), [colored](kernfs_vnops.c.diff?r1=1.134;r2=1.134.12.4;f=h); next MAIN 1.135: [preferred](kernfs_vnops.c.diff?r1=1.135;r2=1.134.12.4), [colored](kernfs_vnops.c.diff?r1=1.135;r2=1.134.12.4;f=h)

Changes since revision 1.134.12.3: +11 -3
lines
```

sync with head.

```

---

Revision **1.143**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.143;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.143;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.143;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.143) - [select for diffs](kernfs_vnops.c?r1=1.143#rev1.143)

*Wed Jul 21 09:06:38 2010 UTC* (14 years, 6 months ago) by *hannken*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-pagecache-base3](./kernfs_vnops.c?only_with_tag=yamt-pagecache-base3),
[yamt-pagecache-base2](./kernfs_vnops.c?only_with_tag=yamt-pagecache-base2),
[yamt-pagecache-base](./kernfs_vnops.c?only_with_tag=yamt-pagecache-base),
[yamt-nfs-mp-base11](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp-base11),
[yamt-nfs-mp-base10](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp-base10),
[uebayasi-xip-base4](./kernfs_vnops.c?only_with_tag=uebayasi-xip-base4),
[uebayasi-xip-base3](./kernfs_vnops.c?only_with_tag=uebayasi-xip-base3),
[uebayasi-xip-base2](./kernfs_vnops.c?only_with_tag=uebayasi-xip-base2),
[rmind-uvmplock-nbase](./kernfs_vnops.c?only_with_tag=rmind-uvmplock-nbase),
[rmind-uvmplock-base](./kernfs_vnops.c?only_with_tag=rmind-uvmplock-base),
[matt-mips64-premerge-20101231](./kernfs_vnops.c?only_with_tag=matt-mips64-premerge-20101231),
[jruoho-x86intr-base](./kernfs_vnops.c?only_with_tag=jruoho-x86intr-base),
[jruoho-x86intr](./kernfs_vnops.c?only_with_tag=jruoho-x86intr),
[jmcneill-usbmp-pre-base2](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp-pre-base2),
[jmcneill-usbmp-base](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp-base),
[jmcneill-audiomp3-base](./kernfs_vnops.c?only_with_tag=jmcneill-audiomp3-base),
[jmcneill-audiomp3](./kernfs_vnops.c?only_with_tag=jmcneill-audiomp3),
[cherry-xenmp-base](./kernfs_vnops.c?only_with_tag=cherry-xenmp-base),
[cherry-xenmp](./kernfs_vnops.c?only_with_tag=cherry-xenmp),
[bouyer-quota2-nbase](./kernfs_vnops.c?only_with_tag=bouyer-quota2-nbase),
[bouyer-quota2-base](./kernfs_vnops.c?only_with_tag=bouyer-quota2-base),
[bouyer-quota2](./kernfs_vnops.c?only_with_tag=bouyer-quota2)

Branch point for: [yamt-pagecache](./kernfs_vnops.c?only_with_tag=yamt-pagecache),
[jmcneill-usbmp](./kernfs_vnops.c?only_with_tag=jmcneill-usbmp)

Diff to: previous 1.142: [preferred](kernfs_vnops.c.diff?r1=1.142;r2=1.143), [colored](kernfs_vnops.c.diff?r1=1.142;r2=1.143;f=h)

Changes since revision 1.142: +4 -2
lines
```

Using vfinddev() leads to vnode races as it returns an unreferenced
vnode that may disappear before the caller has a chance to reference it.

Reference the vnode while the specfs cache is locked.

Welcome to 5.99.37.

No objections on tech-kern.

```

---

Revision **1.140.4.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.140.4.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.140.4.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.140.4.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.140.4.2) - [select for diffs](kernfs_vnops.c?r1=1.140.4.2#rev1.140.4.2)

*Sat Jul 3 01:19:57 2010 UTC* (14 years, 6 months ago) by *rmind*

Branches: [rmind-uvmplock](./kernfs_vnops.c?only_with_tag=rmind-uvmplock)

Diff to: previous 1.140.4.1: [preferred](kernfs_vnops.c.diff?r1=1.140.4.1;r2=1.140.4.2), [colored](kernfs_vnops.c.diff?r1=1.140.4.1;r2=1.140.4.2;f=h); branchpoint 1.140: [preferred](kernfs_vnops.c.diff?r1=1.140;r2=1.140.4.2), [colored](kernfs_vnops.c.diff?r1=1.140;r2=1.140.4.2;f=h)

Changes since revision 1.140.4.1: +3 -3
lines
```

sync with head

```

---

Revision **1.142**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.142;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.142;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.142;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.142) - [select for diffs](kernfs_vnops.c?r1=1.142#rev1.142)

*Thu Jun 24 13:03:16 2010 UTC* (14 years, 7 months ago) by *hannken*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.141: [preferred](kernfs_vnops.c.diff?r1=1.141;r2=1.142), [colored](kernfs_vnops.c.diff?r1=1.141;r2=1.142;f=h)

Changes since revision 1.141: +3 -3
lines
```

Clean up vnode lock operations pass 2:

VOP_UNLOCK(vp, flags) -> VOP_UNLOCK(vp): Remove the unneeded flags argument.

Welcome to 5.99.32.

Discussed on tech-kern.

```

---

Revision **1.140.4.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.140.4.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.140.4.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.140.4.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.140.4.1) - [select for diffs](kernfs_vnops.c?r1=1.140.4.1#rev1.140.4.1)

*Sun May 30 05:17:59 2010 UTC* (14 years, 8 months ago) by *rmind*

Branches: [rmind-uvmplock](./kernfs_vnops.c?only_with_tag=rmind-uvmplock)

Diff to: previous 1.140: [preferred](kernfs_vnops.c.diff?r1=1.140;r2=1.140.4.1), [colored](kernfs_vnops.c.diff?r1=1.140;r2=1.140.4.1;f=h)

Changes since revision 1.140: +8 -2
lines
```

sync with head

```

---

Revision **1.140.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.140.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.140.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.140.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.140.2.1) - [select for diffs](kernfs_vnops.c?r1=1.140.2.1#rev1.140.2.1)

*Fri Apr 30 14:44:15 2010 UTC* (14 years, 8 months ago) by *uebayasi*

Branches: [uebayasi-xip](./kernfs_vnops.c?only_with_tag=uebayasi-xip)

Diff to: previous 1.140: [preferred](kernfs_vnops.c.diff?r1=1.140;r2=1.140.2.1), [colored](kernfs_vnops.c.diff?r1=1.140;r2=1.140.2.1;f=h)

Changes since revision 1.140: +8 -2
lines
```

Sync with HEAD.

```

---

Revision **1.141**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.141;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.141;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.141;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.141) - [select for diffs](kernfs_vnops.c?r1=1.141#rev1.141)

*Wed Mar 31 01:27:05 2010 UTC* (14 years, 9 months ago) by *pooka*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [uebayasi-xip-base1](./kernfs_vnops.c?only_with_tag=uebayasi-xip-base1)

Diff to: previous 1.140: [preferred](kernfs_vnops.c.diff?r1=1.140;r2=1.141), [colored](kernfs_vnops.c.diff?r1=1.140;r2=1.141;f=h)

Changes since revision 1.140: +8 -2
lines
```

If msgbuf is not enabled, do not report the node in readdir.  That
way ls -l won't report funny errors because getattr for a readdir
result fails.

XXX: lookup for msgbuf still succeeds even if not enabled

```

---

Revision **1.134.12.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.134.12.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.134.12.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.134.12.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.134.12.3) - [select for diffs](kernfs_vnops.c?r1=1.134.12.3#rev1.134.12.3)

*Thu Mar 11 15:04:23 2010 UTC* (14 years, 10 months ago) by *yamt*

Branches: [yamt-nfs-mp](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp)

Diff to: previous 1.134.12.2: [preferred](kernfs_vnops.c.diff?r1=1.134.12.2;r2=1.134.12.3), [colored](kernfs_vnops.c.diff?r1=1.134.12.2;r2=1.134.12.3;f=h); branchpoint 1.134: [preferred](kernfs_vnops.c.diff?r1=1.134;r2=1.134.12.3), [colored](kernfs_vnops.c.diff?r1=1.134;r2=1.134.12.3;f=h)

Changes since revision 1.134.12.2: +4 -5
lines
```

sync with head

```

---

Revision **1.140**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.140;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.140;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.140;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.140) - [select for diffs](kernfs_vnops.c?r1=1.140#rev1.140)

*Fri Jan 22 22:46:00 2010 UTC* (15 years ago) by *njoly*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-nfs-mp-base9](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp-base9),
[uebayasi-xip-base](./kernfs_vnops.c?only_with_tag=uebayasi-xip-base)

Branch point for: [uebayasi-xip](./kernfs_vnops.c?only_with_tag=uebayasi-xip),
[rmind-uvmplock](./kernfs_vnops.c?only_with_tag=rmind-uvmplock)

Diff to: previous 1.139: [preferred](kernfs_vnops.c.diff?r1=1.139;r2=1.140), [colored](kernfs_vnops.c.diff?r1=1.139;r2=1.140;f=h)

Changes since revision 1.139: +2 -3
lines
```

Remove unneeded strlen() call in KFShostname case.

```

---

Revision **1.139**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.139;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.139;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.139;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.139) - [select for diffs](kernfs_vnops.c?r1=1.139#rev1.139)

*Fri Jan 8 11:35:11 2010 UTC* (15 years ago) by *pooka*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.138: [preferred](kernfs_vnops.c.diff?r1=1.138;r2=1.139), [colored](kernfs_vnops.c.diff?r1=1.138;r2=1.139;f=h)

Changes since revision 1.138: +4 -4
lines
```

The VATTR_NULL/VREF/VHOLD/HOLDRELE() macros lost their will to live
years ago when the kernel was modified to not alter ABI based on
DIAGNOSTIC, and now just call the respective function interfaces
(in lowercase).  Plenty of mix'n match upper/lowercase has creeped
into the tree since then.  Nuke the macros and convert all callsites
to lowercase.

no functional change

```

---

Revision **1.135.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.135.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.135.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.135.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.135.2.2) - [select for diffs](kernfs_vnops.c?r1=1.135.2.2#rev1.135.2.2)

*Thu Jul 23 23:32:46 2009 UTC* (15 years, 6 months ago) by *jym*

Branches: [jym-xensuspend](./kernfs_vnops.c?only_with_tag=jym-xensuspend)

Diff to: previous 1.135.2.1: [preferred](kernfs_vnops.c.diff?r1=1.135.2.1;r2=1.135.2.2), [colored](kernfs_vnops.c.diff?r1=1.135.2.1;r2=1.135.2.2;f=h); branchpoint 1.135: [preferred](kernfs_vnops.c.diff?r1=1.135;r2=1.135.2.2), [colored](kernfs_vnops.c.diff?r1=1.135;r2=1.135.2.2;f=h); next MAIN 1.136: [preferred](kernfs_vnops.c.diff?r1=1.136;r2=1.135.2.2), [colored](kernfs_vnops.c.diff?r1=1.136;r2=1.135.2.2;f=h)

Changes since revision 1.135.2.1: +24 -4
lines
```

Sync with HEAD.

```

---

Revision **1.134.12.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.134.12.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.134.12.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.134.12.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.134.12.2) - [select for diffs](kernfs_vnops.c?r1=1.134.12.2#rev1.134.12.2)

*Sat Jul 18 14:53:24 2009 UTC* (15 years, 6 months ago) by *yamt*

Branches: [yamt-nfs-mp](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp)

Diff to: previous 1.134.12.1: [preferred](kernfs_vnops.c.diff?r1=1.134.12.1;r2=1.134.12.2), [colored](kernfs_vnops.c.diff?r1=1.134.12.1;r2=1.134.12.2;f=h); branchpoint 1.134: [preferred](kernfs_vnops.c.diff?r1=1.134;r2=1.134.12.2), [colored](kernfs_vnops.c.diff?r1=1.134;r2=1.134.12.2;f=h)

Changes since revision 1.134.12.1: +24 -4
lines
```

sync with head.

```

---

Revision **1.138**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.138;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.138;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.138;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.138) - [select for diffs](kernfs_vnops.c?r1=1.138#rev1.138)

*Fri Jul 3 21:17:41 2009 UTC* (15 years, 6 months ago) by *elad*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-nfs-mp-base8](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp-base8),
[yamt-nfs-mp-base7](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp-base7),
[yamt-nfs-mp-base6](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp-base6),
[matt-premerge-20091211](./kernfs_vnops.c?only_with_tag=matt-premerge-20091211),
[jymxensuspend-base](./kernfs_vnops.c?only_with_tag=jymxensuspend-base),
[jym-xensuspend-nbase](./kernfs_vnops.c?only_with_tag=jym-xensuspend-nbase)

Diff to: previous 1.137: [preferred](kernfs_vnops.c.diff?r1=1.137;r2=1.138), [colored](kernfs_vnops.c.diff?r1=1.137;r2=1.138;f=h)

Changes since revision 1.137: +24 -4
lines
```

Where possible, extract the file-system's access() routine to two internal
functions: the first checking if the operation is possible (regardless of
permissions), the second checking file-system permissions, ACLs, etc.

Mailing list reference:

	<http://mail-index.netbsd.org/tech-kern/2009/06/21/msg005311.html>

```

---

Revision **1.137**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.137;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.137;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.137;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.137) - [select for diffs](kernfs_vnops.c?r1=1.137#rev1.137)

*Tue Jun 23 19:36:40 2009 UTC* (15 years, 7 months ago) by *elad*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.136: [preferred](kernfs_vnops.c.diff?r1=1.136;r2=1.137), [colored](kernfs_vnops.c.diff?r1=1.136;r2=1.137;f=h)

Changes since revision 1.136: +3 -3
lines
```

Move the implementation of vaccess() to genfs_can_access(), in line with
the other routines of the same spirit.

Adjust file-system code to use it.

Keep vaccess() for KPI compatibility and to keep element of least
surprise. A "diagnostic" message warning that vaccess() is deprecated will
be printed when it's used (obviously, only in DIAGNOSTIC kernels).

No objections on tech-kern@:

	<http://mail-index.netbsd.org/tech-kern/2009/06/21/msg005310.html>

```

---

Revision **1.135.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.135.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.135.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.135.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.135.2.1) - [select for diffs](kernfs_vnops.c?r1=1.135.2.1#rev1.135.2.1)

*Wed May 13 17:22:16 2009 UTC* (15 years, 8 months ago) by *jym*

Branches: [jym-xensuspend](./kernfs_vnops.c?only_with_tag=jym-xensuspend)

Diff to: previous 1.135: [preferred](kernfs_vnops.c.diff?r1=1.135;r2=1.135.2.1), [colored](kernfs_vnops.c.diff?r1=1.135;r2=1.135.2.1;f=h)

Changes since revision 1.135: +21 -46
lines
```

Sync with HEAD.

Commit is split, to avoid a "too many arguments" protocol error.

```

---

Revision **1.134.12.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.134.12.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.134.12.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.134.12.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.134.12.1) - [select for diffs](kernfs_vnops.c?r1=1.134.12.1#rev1.134.12.1)

*Mon May 4 08:14:04 2009 UTC* (15 years, 8 months ago) by *yamt*

Branches: [yamt-nfs-mp](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp)

Diff to: previous 1.134: [preferred](kernfs_vnops.c.diff?r1=1.134;r2=1.134.12.1), [colored](kernfs_vnops.c.diff?r1=1.134;r2=1.134.12.1;f=h)

Changes since revision 1.134: +43 -48
lines
```

sync with head.

```

---

Revision **1.134.20.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.134.20.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.134.20.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.134.20.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.134.20.2) - [select for diffs](kernfs_vnops.c?r1=1.134.20.2#rev1.134.20.2)

*Tue Apr 28 07:37:15 2009 UTC* (15 years, 9 months ago) by *skrll*

Branches: [nick-hppapmap](./kernfs_vnops.c?only_with_tag=nick-hppapmap)

Diff to: previous 1.134.20.1: [preferred](kernfs_vnops.c.diff?r1=1.134.20.1;r2=1.134.20.2), [colored](kernfs_vnops.c.diff?r1=1.134.20.1;r2=1.134.20.2;f=h); branchpoint 1.134: [preferred](kernfs_vnops.c.diff?r1=1.134;r2=1.134.20.2), [colored](kernfs_vnops.c.diff?r1=1.134;r2=1.134.20.2;f=h); next MAIN 1.135: [preferred](kernfs_vnops.c.diff?r1=1.135;r2=1.134.20.2), [colored](kernfs_vnops.c.diff?r1=1.135;r2=1.134.20.2;f=h)

Changes since revision 1.134.20.1: +21 -46
lines
```

Sync with HEAD.

```

---

Revision **1.136**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.136;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.136;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.136;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.136) - [select for diffs](kernfs_vnops.c?r1=1.136#rev1.136)

*Sat Mar 14 15:36:22 2009 UTC* (15 years, 10 months ago) by *dsl*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-nfs-mp-base5](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp-base5),
[yamt-nfs-mp-base4](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp-base4),
[yamt-nfs-mp-base3](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp-base3),
[nick-hppapmap-base4](./kernfs_vnops.c?only_with_tag=nick-hppapmap-base4),
[nick-hppapmap-base3](./kernfs_vnops.c?only_with_tag=nick-hppapmap-base3),
[nick-hppapmap-base](./kernfs_vnops.c?only_with_tag=nick-hppapmap-base),
[jym-xensuspend-base](./kernfs_vnops.c?only_with_tag=jym-xensuspend-base)

Diff to: previous 1.135: [preferred](kernfs_vnops.c.diff?r1=1.135;r2=1.136), [colored](kernfs_vnops.c.diff?r1=1.135;r2=1.136;f=h)

Changes since revision 1.135: +21 -46
lines
```

Change about 4500 of the K&R function definitions to ANSI ones.
There are still about 1600 left, but they have ',' or /* ... */
in the actual variable definitions - which my awk script doesn't handle.
There are also many that need () -> (void).
(The script does handle misordered arguments.)

```

---

Revision **1.134.20.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.134.20.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.134.20.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.134.20.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.134.20.1) - [select for diffs](kernfs_vnops.c?r1=1.134.20.1#rev1.134.20.1)

*Mon Jan 19 13:20:06 2009 UTC* (16 years ago) by *skrll*

Branches: [nick-hppapmap](./kernfs_vnops.c?only_with_tag=nick-hppapmap)

Diff to: previous 1.134: [preferred](kernfs_vnops.c.diff?r1=1.134;r2=1.134.20.1), [colored](kernfs_vnops.c.diff?r1=1.134;r2=1.134.20.1;f=h)

Changes since revision 1.134: +24 -4
lines
```

Sync with HEAD.

```

---

Revision **1.134.6.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.134.6.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.134.6.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.134.6.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.134.6.1) - [select for diffs](kernfs_vnops.c?r1=1.134.6.1#rev1.134.6.1)

*Sat Jan 17 13:29:27 2009 UTC* (16 years ago) by *mjf*

Branches: [mjf-devfs2](./kernfs_vnops.c?only_with_tag=mjf-devfs2)

Diff to: previous 1.134: [preferred](kernfs_vnops.c.diff?r1=1.134;r2=1.134.6.1), [colored](kernfs_vnops.c.diff?r1=1.134;r2=1.134.6.1;f=h); next MAIN 1.135: [preferred](kernfs_vnops.c.diff?r1=1.135;r2=1.134.6.1), [colored](kernfs_vnops.c.diff?r1=1.135;r2=1.134.6.1;f=h)

Changes since revision 1.134: +24 -4
lines
```

Sync with HEAD.

```

---

Revision **1.135**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.135;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.135;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.135;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.135) - [select for diffs](kernfs_vnops.c?r1=1.135#rev1.135)

*Sun Jan 11 02:45:53 2009 UTC* (16 years ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [nick-hppapmap-base2](./kernfs_vnops.c?only_with_tag=nick-hppapmap-base2),
[mjf-devfs2-base](./kernfs_vnops.c?only_with_tag=mjf-devfs2-base)

Branch point for: [jym-xensuspend](./kernfs_vnops.c?only_with_tag=jym-xensuspend)

Diff to: previous 1.134: [preferred](kernfs_vnops.c.diff?r1=1.134;r2=1.135), [colored](kernfs_vnops.c.diff?r1=1.134;r2=1.135;f=h)

Changes since revision 1.134: +24 -4
lines
```

merge christos-time_t

```

---

Revision **1.134.8.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.134.8.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.134.8.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.134.8.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.134.8.1) - [select for diffs](kernfs_vnops.c?r1=1.134.8.1#rev1.134.8.1)

*Sat Mar 29 20:47:01 2008 UTC* (16 years, 10 months ago) by *christos*

Branches: [christos-time\_t](./kernfs_vnops.c?only_with_tag=christos-time_t)

Diff to: previous 1.134: [preferred](kernfs_vnops.c.diff?r1=1.134;r2=1.134.8.1), [colored](kernfs_vnops.c.diff?r1=1.134;r2=1.134.8.1;f=h); next MAIN 1.135: [preferred](kernfs_vnops.c.diff?r1=1.135;r2=1.134.8.1), [colored](kernfs_vnops.c.diff?r1=1.135;r2=1.134.8.1;f=h)

Changes since revision 1.134: +5 -4
lines
```

Welcome to the time_t=long long dev_t=uint64_t branch.

```

---

Revision **1.132.26.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.132.26.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.132.26.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.132.26.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.132.26.2) - [select for diffs](kernfs_vnops.c?r1=1.132.26.2#rev1.132.26.2)

*Mon Feb 18 21:07:00 2008 UTC* (16 years, 11 months ago) by *mjf*

Branches: [mjf-devfs](./kernfs_vnops.c?only_with_tag=mjf-devfs)

Diff to: previous 1.132.26.1: [preferred](kernfs_vnops.c.diff?r1=1.132.26.1;r2=1.132.26.2), [colored](kernfs_vnops.c.diff?r1=1.132.26.1;r2=1.132.26.2;f=h); branchpoint 1.132: [preferred](kernfs_vnops.c.diff?r1=1.132;r2=1.132.26.2), [colored](kernfs_vnops.c.diff?r1=1.132;r2=1.132.26.2;f=h); next MAIN 1.133: [preferred](kernfs_vnops.c.diff?r1=1.133;r2=1.132.26.2), [colored](kernfs_vnops.c.diff?r1=1.133;r2=1.132.26.2;f=h)

Changes since revision 1.132.26.1: +7 -6
lines
```

Sync with HEAD.

```

---

Revision **1.109.2.4**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.109.2.4;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.109.2.4;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.109.2.4;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.109.2.4) - [select for diffs](kernfs_vnops.c?r1=1.109.2.4#rev1.109.2.4)

*Mon Jan 21 09:46:54 2008 UTC* (17 years ago) by *yamt*

Branches: [yamt-lazymbuf](./kernfs_vnops.c?only_with_tag=yamt-lazymbuf)

Diff to: previous 1.109.2.3: [preferred](kernfs_vnops.c.diff?r1=1.109.2.3;r2=1.109.2.4), [colored](kernfs_vnops.c.diff?r1=1.109.2.3;r2=1.109.2.4;f=h); next MAIN 1.110: [preferred](kernfs_vnops.c.diff?r1=1.110;r2=1.109.2.4), [colored](kernfs_vnops.c.diff?r1=1.110;r2=1.109.2.4;f=h)

Changes since revision 1.109.2.3: +7 -6
lines
```

sync with head

```

---

Revision **1.132.20.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.132.20.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.132.20.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.132.20.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.132.20.1) - [select for diffs](kernfs_vnops.c?r1=1.132.20.1#rev1.132.20.1)

*Wed Jan 9 01:57:03 2008 UTC* (17 years ago) by *matt*

Branches: [matt-armv6](./kernfs_vnops.c?only_with_tag=matt-armv6)

Diff to: previous 1.132: [preferred](kernfs_vnops.c.diff?r1=1.132;r2=1.132.20.1), [colored](kernfs_vnops.c.diff?r1=1.132;r2=1.132.20.1;f=h); next MAIN 1.133: [preferred](kernfs_vnops.c.diff?r1=1.133;r2=1.132.20.1), [colored](kernfs_vnops.c.diff?r1=1.133;r2=1.132.20.1;f=h)

Changes since revision 1.132: +9 -15
lines
```

sync with HEAD

```

---

Revision **1.133.6.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.133.6.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.133.6.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.133.6.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.133.6.1) - [select for diffs](kernfs_vnops.c?r1=1.133.6.1#rev1.133.6.1)

*Wed Jan 2 21:56:52 2008 UTC* (17 years ago) by *bouyer*

Branches: [bouyer-xeni386](./kernfs_vnops.c?only_with_tag=bouyer-xeni386)

CVS tags: [bouyer-xeni386-merge1](./kernfs_vnops.c?only_with_tag=bouyer-xeni386-merge1)

Diff to: previous 1.133: [preferred](kernfs_vnops.c.diff?r1=1.133;r2=1.133.6.1), [colored](kernfs_vnops.c.diff?r1=1.133;r2=1.133.6.1;f=h); next MAIN 1.134: [preferred](kernfs_vnops.c.diff?r1=1.134;r2=1.133.6.1), [colored](kernfs_vnops.c.diff?r1=1.134;r2=1.133.6.1;f=h)

Changes since revision 1.133: +7 -6
lines
```

Sync with HEAD

```

---

Revision **1.134**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.134;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.134;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.134;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.134) - [select for diffs](kernfs_vnops.c?r1=1.134#rev1.134)

*Wed Jan 2 11:49:00 2008 UTC* (17 years ago) by *ad*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-pf42-baseX](./kernfs_vnops.c?only_with_tag=yamt-pf42-baseX),
[yamt-pf42-base4](./kernfs_vnops.c?only_with_tag=yamt-pf42-base4),
[yamt-pf42-base3](./kernfs_vnops.c?only_with_tag=yamt-pf42-base3),
[yamt-pf42-base2](./kernfs_vnops.c?only_with_tag=yamt-pf42-base2),
[yamt-pf42-base](./kernfs_vnops.c?only_with_tag=yamt-pf42-base),
[yamt-pf42](./kernfs_vnops.c?only_with_tag=yamt-pf42),
[yamt-nfs-mp-base2](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp-base2),
[yamt-nfs-mp-base](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp-base),
[yamt-lazymbuf-base15](./kernfs_vnops.c?only_with_tag=yamt-lazymbuf-base15),
[yamt-lazymbuf-base14](./kernfs_vnops.c?only_with_tag=yamt-lazymbuf-base14),
[wrstuden-revivesa-base-4](./kernfs_vnops.c?only_with_tag=wrstuden-revivesa-base-4),
[wrstuden-revivesa-base-3](./kernfs_vnops.c?only_with_tag=wrstuden-revivesa-base-3),
[wrstuden-revivesa-base-2](./kernfs_vnops.c?only_with_tag=wrstuden-revivesa-base-2),
[wrstuden-revivesa-base-1](./kernfs_vnops.c?only_with_tag=wrstuden-revivesa-base-1),
[wrstuden-revivesa-base](./kernfs_vnops.c?only_with_tag=wrstuden-revivesa-base),
[wrstuden-revivesa](./kernfs_vnops.c?only_with_tag=wrstuden-revivesa),
[simonb-wapbl-nbase](./kernfs_vnops.c?only_with_tag=simonb-wapbl-nbase),
[simonb-wapbl-base](./kernfs_vnops.c?only_with_tag=simonb-wapbl-base),
[simonb-wapbl](./kernfs_vnops.c?only_with_tag=simonb-wapbl),
[nick-net80211-sync-base](./kernfs_vnops.c?only_with_tag=nick-net80211-sync-base),
[nick-net80211-sync](./kernfs_vnops.c?only_with_tag=nick-net80211-sync),
[netbsd-5-base](./kernfs_vnops.c?only_with_tag=netbsd-5-base),
[netbsd-5-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-2-RELEASE),
[netbsd-5-2-RC1](./kernfs_vnops.c?only_with_tag=netbsd-5-2-RC1),
[netbsd-5-2-3-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-2-3-RELEASE),
[netbsd-5-2-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-2-2-RELEASE),
[netbsd-5-2-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-2-1-RELEASE),
[netbsd-5-2](./kernfs_vnops.c?only_with_tag=netbsd-5-2),
[netbsd-5-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-1-RELEASE),
[netbsd-5-1-RC4](./kernfs_vnops.c?only_with_tag=netbsd-5-1-RC4),
[netbsd-5-1-RC3](./kernfs_vnops.c?only_with_tag=netbsd-5-1-RC3),
[netbsd-5-1-RC2](./kernfs_vnops.c?only_with_tag=netbsd-5-1-RC2),
[netbsd-5-1-RC1](./kernfs_vnops.c?only_with_tag=netbsd-5-1-RC1),
[netbsd-5-1-5-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-1-5-RELEASE),
[netbsd-5-1-4-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-1-4-RELEASE),
[netbsd-5-1-3-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-1-3-RELEASE),
[netbsd-5-1-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-1-2-RELEASE),
[netbsd-5-1-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-1-1-RELEASE),
[netbsd-5-1](./kernfs_vnops.c?only_with_tag=netbsd-5-1),
[netbsd-5-0-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-0-RELEASE),
[netbsd-5-0-RC4](./kernfs_vnops.c?only_with_tag=netbsd-5-0-RC4),
[netbsd-5-0-RC3](./kernfs_vnops.c?only_with_tag=netbsd-5-0-RC3),
[netbsd-5-0-RC2](./kernfs_vnops.c?only_with_tag=netbsd-5-0-RC2),
[netbsd-5-0-RC1](./kernfs_vnops.c?only_with_tag=netbsd-5-0-RC1),
[netbsd-5-0-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-0-2-RELEASE),
[netbsd-5-0-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-5-0-1-RELEASE),
[netbsd-5-0](./kernfs_vnops.c?only_with_tag=netbsd-5-0),
[netbsd-5](./kernfs_vnops.c?only_with_tag=netbsd-5),
[mjf-devfs-base](./kernfs_vnops.c?only_with_tag=mjf-devfs-base),
[matt-nb5-pq3-base](./kernfs_vnops.c?only_with_tag=matt-nb5-pq3-base),
[matt-nb5-pq3](./kernfs_vnops.c?only_with_tag=matt-nb5-pq3),
[matt-nb5-mips64-u2-k2-k4-k7-k8-k9](./kernfs_vnops.c?only_with_tag=matt-nb5-mips64-u2-k2-k4-k7-k8-k9),
[matt-nb5-mips64-u1-k1-k5](./kernfs_vnops.c?only_with_tag=matt-nb5-mips64-u1-k1-k5),
[matt-nb5-mips64-premerge-20101231](./kernfs_vnops.c?only_with_tag=matt-nb5-mips64-premerge-20101231),
[matt-nb5-mips64-premerge-20091211](./kernfs_vnops.c?only_with_tag=matt-nb5-mips64-premerge-20091211),
[matt-nb5-mips64-k15](./kernfs_vnops.c?only_with_tag=matt-nb5-mips64-k15),
[matt-nb5-mips64](./kernfs_vnops.c?only_with_tag=matt-nb5-mips64),
[matt-nb4-mips64-k7-u2a-k9b](./kernfs_vnops.c?only_with_tag=matt-nb4-mips64-k7-u2a-k9b),
[matt-mips64-base2](./kernfs_vnops.c?only_with_tag=matt-mips64-base2),
[matt-armv6-nbase](./kernfs_vnops.c?only_with_tag=matt-armv6-nbase),
[matt-armv6-base](./kernfs_vnops.c?only_with_tag=matt-armv6-base),
[keiichi-mipv6-nbase](./kernfs_vnops.c?only_with_tag=keiichi-mipv6-nbase),
[keiichi-mipv6-base](./kernfs_vnops.c?only_with_tag=keiichi-mipv6-base),
[keiichi-mipv6](./kernfs_vnops.c?only_with_tag=keiichi-mipv6),
[hpcarm-cleanup-nbase](./kernfs_vnops.c?only_with_tag=hpcarm-cleanup-nbase),
[hpcarm-cleanup-base](./kernfs_vnops.c?only_with_tag=hpcarm-cleanup-base),
[haad-nbase2](./kernfs_vnops.c?only_with_tag=haad-nbase2),
[haad-dm-base2](./kernfs_vnops.c?only_with_tag=haad-dm-base2),
[haad-dm-base1](./kernfs_vnops.c?only_with_tag=haad-dm-base1),
[haad-dm-base](./kernfs_vnops.c?only_with_tag=haad-dm-base),
[haad-dm](./kernfs_vnops.c?only_with_tag=haad-dm),
[christos-time\_t-nbase](./kernfs_vnops.c?only_with_tag=christos-time_t-nbase),
[christos-time\_t-base](./kernfs_vnops.c?only_with_tag=christos-time_t-base),
[bouyer-xeni386-nbase](./kernfs_vnops.c?only_with_tag=bouyer-xeni386-nbase),
[bouyer-xeni386-base](./kernfs_vnops.c?only_with_tag=bouyer-xeni386-base),
[ad-socklock-base1](./kernfs_vnops.c?only_with_tag=ad-socklock-base1),
[ad-audiomp2-base](./kernfs_vnops.c?only_with_tag=ad-audiomp2-base),
[ad-audiomp2](./kernfs_vnops.c?only_with_tag=ad-audiomp2)

Branch point for: [yamt-nfs-mp](./kernfs_vnops.c?only_with_tag=yamt-nfs-mp),
[nick-hppapmap](./kernfs_vnops.c?only_with_tag=nick-hppapmap),
[mjf-devfs2](./kernfs_vnops.c?only_with_tag=mjf-devfs2),
[christos-time\_t](./kernfs_vnops.c?only_with_tag=christos-time_t)

Diff to: previous 1.133: [preferred](kernfs_vnops.c.diff?r1=1.133;r2=1.134), [colored](kernfs_vnops.c.diff?r1=1.133;r2=1.134;f=h)

Changes since revision 1.133: +7 -6
lines
```

Merge vmlocking2 to head.

```

---

Revision **1.132.26.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.132.26.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.132.26.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.132.26.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.132.26.1) - [select for diffs](kernfs_vnops.c?r1=1.132.26.1#rev1.132.26.1)

*Sat Dec 8 18:21:01 2007 UTC* (17 years, 1 month ago) by *mjf*

Branches: [mjf-devfs](./kernfs_vnops.c?only_with_tag=mjf-devfs)

Diff to: previous 1.132: [preferred](kernfs_vnops.c.diff?r1=1.132;r2=1.132.26.1), [colored](kernfs_vnops.c.diff?r1=1.132;r2=1.132.26.1;f=h)

Changes since revision 1.132: +4 -11
lines
```

Sync with HEAD.

```

---

Revision **1.109.2.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.109.2.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.109.2.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.109.2.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.109.2.3) - [select for diffs](kernfs_vnops.c?r1=1.109.2.3#rev1.109.2.3)

*Fri Dec 7 17:34:06 2007 UTC* (17 years, 1 month ago) by *yamt*

Branches: [yamt-lazymbuf](./kernfs_vnops.c?only_with_tag=yamt-lazymbuf)

Diff to: previous 1.109.2.2: [preferred](kernfs_vnops.c.diff?r1=1.109.2.2;r2=1.109.2.3), [colored](kernfs_vnops.c.diff?r1=1.109.2.2;r2=1.109.2.3;f=h)

Changes since revision 1.109.2.2: +4 -11
lines
```

sync with head

```

---

Revision **1.133.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.133.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.133.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.133.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.133.2.1) - [select for diffs](kernfs_vnops.c?r1=1.133.2.1#rev1.133.2.1)

*Tue Dec 4 13:03:26 2007 UTC* (17 years, 1 month ago) by *ad*

Branches: [vmlocking2](./kernfs_vnops.c?only_with_tag=vmlocking2)

Diff to: previous 1.133: [preferred](kernfs_vnops.c.diff?r1=1.133;r2=1.133.2.1), [colored](kernfs_vnops.c.diff?r1=1.133;r2=1.133.2.1;f=h); next MAIN 1.134: [preferred](kernfs_vnops.c.diff?r1=1.134;r2=1.133.2.1), [colored](kernfs_vnops.c.diff?r1=1.134;r2=1.133.2.1;f=h)

Changes since revision 1.133: +7 -6
lines
```

Pull the vmlocking changes into a new branch.

```

---

Revision **1.132.18.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.132.18.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.132.18.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.132.18.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.132.18.1) - [select for diffs](kernfs_vnops.c?r1=1.132.18.1#rev1.132.18.1)

*Tue Nov 27 19:38:48 2007 UTC* (17 years, 2 months ago) by *joerg*

Branches: [jmcneill-pm](./kernfs_vnops.c?only_with_tag=jmcneill-pm)

Diff to: previous 1.132: [preferred](kernfs_vnops.c.diff?r1=1.132;r2=1.132.18.1), [colored](kernfs_vnops.c.diff?r1=1.132;r2=1.132.18.1;f=h); next MAIN 1.133: [preferred](kernfs_vnops.c.diff?r1=1.133;r2=1.132.18.1), [colored](kernfs_vnops.c.diff?r1=1.133;r2=1.132.18.1;f=h)

Changes since revision 1.132: +4 -11
lines
```

Sync with HEAD. amd64 Xen support needs testing.

```

---

Revision **1.133**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.133;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.133;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.133;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.133) - [select for diffs](kernfs_vnops.c?r1=1.133#rev1.133)

*Mon Nov 26 19:02:14 2007 UTC* (17 years, 2 months ago) by *pooka*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-kmem-base3](./kernfs_vnops.c?only_with_tag=yamt-kmem-base3),
[yamt-kmem-base2](./kernfs_vnops.c?only_with_tag=yamt-kmem-base2),
[yamt-kmem-base](./kernfs_vnops.c?only_with_tag=yamt-kmem-base),
[yamt-kmem](./kernfs_vnops.c?only_with_tag=yamt-kmem),
[vmlocking2-base3](./kernfs_vnops.c?only_with_tag=vmlocking2-base3),
[vmlocking2-base2](./kernfs_vnops.c?only_with_tag=vmlocking2-base2),
[vmlocking2-base1](./kernfs_vnops.c?only_with_tag=vmlocking2-base1),
[vmlocking-nbase](./kernfs_vnops.c?only_with_tag=vmlocking-nbase),
[reinoud-bufcleanup-nbase](./kernfs_vnops.c?only_with_tag=reinoud-bufcleanup-nbase),
[reinoud-bufcleanup-base](./kernfs_vnops.c?only_with_tag=reinoud-bufcleanup-base),
[jmcneill-pm-base](./kernfs_vnops.c?only_with_tag=jmcneill-pm-base),
[cube-autoconf-base](./kernfs_vnops.c?only_with_tag=cube-autoconf-base),
[cube-autoconf](./kernfs_vnops.c?only_with_tag=cube-autoconf)

Branch point for: [vmlocking2](./kernfs_vnops.c?only_with_tag=vmlocking2),
[bouyer-xeni386](./kernfs_vnops.c?only_with_tag=bouyer-xeni386)

Diff to: previous 1.132: [preferred](kernfs_vnops.c.diff?r1=1.132;r2=1.133), [colored](kernfs_vnops.c.diff?r1=1.132;r2=1.133;f=h)

Changes since revision 1.132: +4 -11
lines
```

Remove the "struct lwp *" argument from all VFS and VOP interfaces.
The general trend is to remove it from all kernel interfaces and
this is a start.  In case the calling lwp is desired, curlwp should
be used.

quick consensus on tech-kern

```

---

Revision **1.132.6.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.132.6.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.132.6.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.132.6.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.132.6.1) - [select for diffs](kernfs_vnops.c?r1=1.132.6.1#rev1.132.6.1)

*Sun Sep 16 19:04:35 2007 UTC* (17 years, 4 months ago) by *ad*

Branches: [vmlocking](./kernfs_vnops.c?only_with_tag=vmlocking)

Diff to: previous 1.132: [preferred](kernfs_vnops.c.diff?r1=1.132;r2=1.132.6.1), [colored](kernfs_vnops.c.diff?r1=1.132;r2=1.132.6.1;f=h); next MAIN 1.133: [preferred](kernfs_vnops.c.diff?r1=1.133;r2=1.132.6.1), [colored](kernfs_vnops.c.diff?r1=1.133;r2=1.132.6.1;f=h)

Changes since revision 1.132: +7 -6
lines
```

Checkpoint work in progress on the vnode lifecycle and reference counting
stuff. This makes it work properly without kernel_lock and fixes a few
quite old bugs. See vfs_subr.c 1.283.2.17 for details.

```

---

Revision **1.128.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.128.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.128.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.128.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.128.2.1) - [select for diffs](kernfs_vnops.c?r1=1.128.2.1#rev1.128.2.1)

*Sat Feb 17 23:27:49 2007 UTC* (17 years, 11 months ago) by *tron*

Branches: [netbsd-4](./kernfs_vnops.c?only_with_tag=netbsd-4)

CVS tags: [wrstuden-fixsa-newbase](./kernfs_vnops.c?only_with_tag=wrstuden-fixsa-newbase),
[wrstuden-fixsa-base-1](./kernfs_vnops.c?only_with_tag=wrstuden-fixsa-base-1),
[wrstuden-fixsa-base](./kernfs_vnops.c?only_with_tag=wrstuden-fixsa-base),
[wrstuden-fixsa](./kernfs_vnops.c?only_with_tag=wrstuden-fixsa),
[netbsd-4-0-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-4-0-RELEASE),
[netbsd-4-0-RC5](./kernfs_vnops.c?only_with_tag=netbsd-4-0-RC5),
[netbsd-4-0-RC4](./kernfs_vnops.c?only_with_tag=netbsd-4-0-RC4),
[netbsd-4-0-RC3](./kernfs_vnops.c?only_with_tag=netbsd-4-0-RC3),
[netbsd-4-0-RC2](./kernfs_vnops.c?only_with_tag=netbsd-4-0-RC2),
[netbsd-4-0-RC1](./kernfs_vnops.c?only_with_tag=netbsd-4-0-RC1),
[netbsd-4-0-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-4-0-1-RELEASE),
[netbsd-4-0](./kernfs_vnops.c?only_with_tag=netbsd-4-0),
[matt-nb4-arm-base](./kernfs_vnops.c?only_with_tag=matt-nb4-arm-base),
[matt-nb4-arm](./kernfs_vnops.c?only_with_tag=matt-nb4-arm)

Diff to: previous 1.128: [preferred](kernfs_vnops.c.diff?r1=1.128;r2=1.128.2.1), [colored](kernfs_vnops.c.diff?r1=1.128;r2=1.128.2.1;f=h); next MAIN 1.129: [preferred](kernfs_vnops.c.diff?r1=1.129;r2=1.128.2.1), [colored](kernfs_vnops.c.diff?r1=1.129;r2=1.128.2.1;f=h)

Changes since revision 1.128: +3 -17
lines
```

Apply patch (requested by chs in ticket #422):
- Fix various deadlock problems with nullfs and unionfs.
- Speed up path lookups by upto 25%.

```

---

Revision **1.125.4.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.125.4.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.125.4.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.125.4.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.125.4.2) - [select for diffs](kernfs_vnops.c?r1=1.125.4.2#rev1.125.4.2)

*Fri Jan 12 01:04:11 2007 UTC* (18 years ago) by *ad*

Branches: [newlock2](./kernfs_vnops.c?only_with_tag=newlock2)

Diff to: previous 1.125.4.1: [preferred](kernfs_vnops.c.diff?r1=1.125.4.1;r2=1.125.4.2), [colored](kernfs_vnops.c.diff?r1=1.125.4.1;r2=1.125.4.2;f=h); branchpoint 1.125: [preferred](kernfs_vnops.c.diff?r1=1.125;r2=1.125.4.2), [colored](kernfs_vnops.c.diff?r1=1.125;r2=1.125.4.2;f=h); next MAIN 1.126: [preferred](kernfs_vnops.c.diff?r1=1.126;r2=1.125.4.2), [colored](kernfs_vnops.c.diff?r1=1.126;r2=1.125.4.2;f=h)

Changes since revision 1.125.4.1: +4 -18
lines
```

Sync with head.

```

---

Revision **1.109.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.109.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.109.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.109.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.109.2.2) - [select for diffs](kernfs_vnops.c?r1=1.109.2.2#rev1.109.2.2)

*Sat Dec 30 20:50:17 2006 UTC* (18 years ago) by *yamt*

Branches: [yamt-lazymbuf](./kernfs_vnops.c?only_with_tag=yamt-lazymbuf)

Diff to: previous 1.109.2.1: [preferred](kernfs_vnops.c.diff?r1=1.109.2.1;r2=1.109.2.2), [colored](kernfs_vnops.c.diff?r1=1.109.2.1;r2=1.109.2.2;f=h)

Changes since revision 1.109.2.1: +47 -33
lines
```

sync with head.

```

---

Revision **1.132**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.132;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.132;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.132;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.132) - [select for diffs](kernfs_vnops.c?r1=1.132#rev1.132)

*Thu Dec 28 09:12:38 2006 UTC* (18 years, 1 month ago) by *elad*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-x86pmap-base4](./kernfs_vnops.c?only_with_tag=yamt-x86pmap-base4),
[yamt-x86pmap-base3](./kernfs_vnops.c?only_with_tag=yamt-x86pmap-base3),
[yamt-x86pmap-base2](./kernfs_vnops.c?only_with_tag=yamt-x86pmap-base2),
[yamt-x86pmap-base](./kernfs_vnops.c?only_with_tag=yamt-x86pmap-base),
[yamt-x86pmap](./kernfs_vnops.c?only_with_tag=yamt-x86pmap),
[yamt-idlelwp-base8](./kernfs_vnops.c?only_with_tag=yamt-idlelwp-base8),
[yamt-idlelwp](./kernfs_vnops.c?only_with_tag=yamt-idlelwp),
[vmlocking-base](./kernfs_vnops.c?only_with_tag=vmlocking-base),
[thorpej-atomic-base](./kernfs_vnops.c?only_with_tag=thorpej-atomic-base),
[thorpej-atomic](./kernfs_vnops.c?only_with_tag=thorpej-atomic),
[reinoud-bufcleanup](./kernfs_vnops.c?only_with_tag=reinoud-bufcleanup),
[post-newlock2-merge](./kernfs_vnops.c?only_with_tag=post-newlock2-merge),
[nick-csl-alignment-base5](./kernfs_vnops.c?only_with_tag=nick-csl-alignment-base5),
[nick-csl-alignment-base](./kernfs_vnops.c?only_with_tag=nick-csl-alignment-base),
[nick-csl-alignment](./kernfs_vnops.c?only_with_tag=nick-csl-alignment),
[newlock2-nbase](./kernfs_vnops.c?only_with_tag=newlock2-nbase),
[newlock2-base](./kernfs_vnops.c?only_with_tag=newlock2-base),
[mjf-ufs-trans-base](./kernfs_vnops.c?only_with_tag=mjf-ufs-trans-base),
[mjf-ufs-trans](./kernfs_vnops.c?only_with_tag=mjf-ufs-trans),
[matt-mips64-base](./kernfs_vnops.c?only_with_tag=matt-mips64-base),
[matt-mips64](./kernfs_vnops.c?only_with_tag=matt-mips64),
[matt-armv6-prevmlocking](./kernfs_vnops.c?only_with_tag=matt-armv6-prevmlocking),
[jmcneill-base](./kernfs_vnops.c?only_with_tag=jmcneill-base),
[hpcarm-cleanup](./kernfs_vnops.c?only_with_tag=hpcarm-cleanup),
[bouyer-xenamd64-base2](./kernfs_vnops.c?only_with_tag=bouyer-xenamd64-base2),
[bouyer-xenamd64-base](./kernfs_vnops.c?only_with_tag=bouyer-xenamd64-base),
[bouyer-xenamd64](./kernfs_vnops.c?only_with_tag=bouyer-xenamd64),
[ad-audiomp-base](./kernfs_vnops.c?only_with_tag=ad-audiomp-base),
[ad-audiomp](./kernfs_vnops.c?only_with_tag=ad-audiomp)

Branch point for: [vmlocking](./kernfs_vnops.c?only_with_tag=vmlocking),
[mjf-devfs](./kernfs_vnops.c?only_with_tag=mjf-devfs),
[matt-armv6](./kernfs_vnops.c?only_with_tag=matt-armv6),
[jmcneill-pm](./kernfs_vnops.c?only_with_tag=jmcneill-pm)

Diff to: previous 1.131: [preferred](kernfs_vnops.c.diff?r1=1.131;r2=1.132), [colored](kernfs_vnops.c.diff?r1=1.131;r2=1.132;f=h)

Changes since revision 1.131: +3 -3
lines
```

Revert bogus NULL check introduced in revision 1.96 that generated false
Coverity "bugs".

```

---

Revision **1.131**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.131;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.131;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.131;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.131) - [select for diffs](kernfs_vnops.c?r1=1.131#rev1.131)

*Thu Dec 28 05:51:56 2006 UTC* (18 years, 1 month ago) by *alc*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.130: [preferred](kernfs_vnops.c.diff?r1=1.130;r2=1.131), [colored](kernfs_vnops.c.diff?r1=1.130;r2=1.131;f=h)

Changes since revision 1.130: +2 -3
lines
```

revert previous, after inspection `kfs->kfs_kt' could really not be NULL here.

reported/requested by elad@

```

---

Revision **1.130**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.130;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.130;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.130;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.130) - [select for diffs](kernfs_vnops.c?r1=1.130#rev1.130)

*Tue Dec 26 00:01:48 2006 UTC* (18 years, 1 month ago) by *alc*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.129: [preferred](kernfs_vnops.c.diff?r1=1.129;r2=1.130), [colored](kernfs_vnops.c.diff?r1=1.129;r2=1.130;f=h)

Changes since revision 1.129: +3 -2
lines
```

CID-3855: check if 'kfs->kfs_kt != NULL' before dereferencing it

```

---

Revision **1.125.6.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.125.6.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.125.6.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.125.6.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.125.6.2) - [select for diffs](kernfs_vnops.c?r1=1.125.6.2#rev1.125.6.2)

*Sun Dec 10 07:18:59 2006 UTC* (18 years, 1 month ago) by *yamt*

Branches: [yamt-splraiseipl](./kernfs_vnops.c?only_with_tag=yamt-splraiseipl)

Diff to: previous 1.125.6.1: [preferred](kernfs_vnops.c.diff?r1=1.125.6.1;r2=1.125.6.2), [colored](kernfs_vnops.c.diff?r1=1.125.6.1;r2=1.125.6.2;f=h); branchpoint 1.125: [preferred](kernfs_vnops.c.diff?r1=1.125;r2=1.125.6.2), [colored](kernfs_vnops.c.diff?r1=1.125;r2=1.125.6.2;f=h); next MAIN 1.126: [preferred](kernfs_vnops.c.diff?r1=1.126;r2=1.125.6.2), [colored](kernfs_vnops.c.diff?r1=1.126;r2=1.125.6.2;f=h)

Changes since revision 1.125.6.1: +8 -21
lines
```

sync with head.

```

---

Revision **1.129**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.129;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.129;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.129;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.129) - [select for diffs](kernfs_vnops.c?r1=1.129#rev1.129)

*Sat Dec 9 16:11:52 2006 UTC* (18 years, 1 month ago) by *chs*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-splraiseipl-base5](./kernfs_vnops.c?only_with_tag=yamt-splraiseipl-base5),
[yamt-splraiseipl-base4](./kernfs_vnops.c?only_with_tag=yamt-splraiseipl-base4),
[yamt-splraiseipl-base3](./kernfs_vnops.c?only_with_tag=yamt-splraiseipl-base3)

Diff to: previous 1.128: [preferred](kernfs_vnops.c.diff?r1=1.128;r2=1.129), [colored](kernfs_vnops.c.diff?r1=1.128;r2=1.129;f=h)

Changes since revision 1.128: +3 -17
lines
```

a smorgasbord of improvements to vnode locking and path lookup:
 - LOCKPARENT is no longer relevant for lookup(), relookup() or VOP_LOOKUP().
   these now always return the parent vnode locked.  namei() works as before.
   lookup() and various other paths no longer acquire vnode locks in the
   wrong order via vrele().  fixes PR [32535](http://gnats.NetBSD.org/32535).
   as a nice side effect, path lookup is also up to 25% faster.
 - the above allows us to get rid of PDIRUNLOCK.
 - also get rid of WANTPARENT (just use LOCKPARENT and unlock it).
 - remove an assumption in layer_node_find() that all file systems implement
   a recursive VOP_LOCK() (unionfs doesn't).
 - require that all file systems supply vfs_vptofh and vfs_fhtovp routines.
   fill in eopnotsupp() for file systems that don't support being exported
   and remove the checks for NULL.  (layerfs calls these without checking.)
 - in union_lookup1(), don't change refcounts in the ISDOTDOT case, just
   adjust which vnode is locked.  fixes PR [33374](http://gnats.NetBSD.org/33374).
 - apply fixes for ufs_rename() from ufs_vnops.c rev. 1.61 to ext2fs_rename().

```

---

Revision **1.125.4.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.125.4.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.125.4.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.125.4.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.125.4.1) - [select for diffs](kernfs_vnops.c?r1=1.125.4.1#rev1.125.4.1)

*Sat Nov 18 21:39:28 2006 UTC* (18 years, 2 months ago) by *ad*

Branches: [newlock2](./kernfs_vnops.c?only_with_tag=newlock2)

Diff to: previous 1.125: [preferred](kernfs_vnops.c.diff?r1=1.125;r2=1.125.4.1), [colored](kernfs_vnops.c.diff?r1=1.125;r2=1.125.4.1;f=h)

Changes since revision 1.125: +7 -8
lines
```

Sync with head.

```

---

Revision **1.128**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.128;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.128;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.128;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.128) - [select for diffs](kernfs_vnops.c?r1=1.128#rev1.128)

*Thu Nov 16 01:33:38 2006 UTC* (18 years, 2 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [netbsd-4-base](./kernfs_vnops.c?only_with_tag=netbsd-4-base)

Branch point for: [netbsd-4](./kernfs_vnops.c?only_with_tag=netbsd-4)

Diff to: previous 1.127: [preferred](kernfs_vnops.c.diff?r1=1.127;r2=1.128), [colored](kernfs_vnops.c.diff?r1=1.127;r2=1.128;f=h)

Changes since revision 1.127: +4 -4
lines
```

__unused removal on arguments; approved by core.

```

---

Revision **1.127**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.127;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.127;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.127;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.127) - [select for diffs](kernfs_vnops.c?r1=1.127#rev1.127)

*Sat Nov 4 20:51:32 2006 UTC* (18 years, 2 months ago) by *jmmv*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.126: [preferred](kernfs_vnops.c.diff?r1=1.126;r2=1.127), [colored](kernfs_vnops.c.diff?r1=1.126;r2=1.127;f=h)

Changes since revision 1.126: +5 -4
lines
```

Use size_t in a couple of places as it makes more sense WRT the places
where the variables are later used.  From PR [kern/25277](http://gnats.NetBSD.org/25277) by Jeff Ito.

```

---

Revision **1.125.6.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.125.6.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.125.6.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.125.6.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.125.6.1) - [select for diffs](kernfs_vnops.c?r1=1.125.6.1#rev1.125.6.1)

*Sun Oct 22 06:07:23 2006 UTC* (18 years, 3 months ago) by *yamt*

Branches: [yamt-splraiseipl](./kernfs_vnops.c?only_with_tag=yamt-splraiseipl)

Diff to: previous 1.125: [preferred](kernfs_vnops.c.diff?r1=1.125;r2=1.125.6.1), [colored](kernfs_vnops.c.diff?r1=1.125;r2=1.125.6.1;f=h)

Changes since revision 1.125: +4 -6
lines
```

sync with head

```

---

Revision **1.126**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.126;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.126;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.126;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.126) - [select for diffs](kernfs_vnops.c?r1=1.126#rev1.126)

*Thu Oct 12 01:32:27 2006 UTC* (18 years, 3 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-splraiseipl-base2](./kernfs_vnops.c?only_with_tag=yamt-splraiseipl-base2)

Diff to: previous 1.125: [preferred](kernfs_vnops.c.diff?r1=1.125;r2=1.126), [colored](kernfs_vnops.c.diff?r1=1.125;r2=1.126;f=h)

Changes since revision 1.125: +4 -6
lines
```

- sprinkle __unused on function decls.
- fix a couple of unused bugs
- no more -Wno-unused for i386

```

---

Revision **1.116.4.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.116.4.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.116.4.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.116.4.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.116.4.1) - [select for diffs](kernfs_vnops.c?r1=1.116.4.1#rev1.116.4.1)

*Sat Sep 9 02:57:59 2006 UTC* (18 years, 4 months ago) by *rpaulo*

Branches: [rpaulo-netinet-merge-pcb](./kernfs_vnops.c?only_with_tag=rpaulo-netinet-merge-pcb)

Diff to: previous 1.116: [preferred](kernfs_vnops.c.diff?r1=1.116;r2=1.116.4.1), [colored](kernfs_vnops.c.diff?r1=1.116;r2=1.116.4.1;f=h); next MAIN 1.117: [preferred](kernfs_vnops.c.diff?r1=1.117;r2=1.116.4.1), [colored](kernfs_vnops.c.diff?r1=1.117;r2=1.116.4.1;f=h)

Changes since revision 1.116: +77 -32
lines
```

sync with head

```

---

Revision **1.121.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.121.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.121.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.121.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.121.2.1) - [select for diffs](kernfs_vnops.c?r1=1.121.2.1#rev1.121.2.1)

*Thu Jul 13 17:49:57 2006 UTC* (18 years, 6 months ago) by *gdamore*

Branches: [gdamore-uart](./kernfs_vnops.c?only_with_tag=gdamore-uart)

Diff to: previous 1.121: [preferred](kernfs_vnops.c.diff?r1=1.121;r2=1.121.2.1), [colored](kernfs_vnops.c.diff?r1=1.121;r2=1.121.2.1;f=h); next MAIN 1.122: [preferred](kernfs_vnops.c.diff?r1=1.122;r2=1.121.2.1), [colored](kernfs_vnops.c.diff?r1=1.122;r2=1.121.2.1;f=h)

Changes since revision 1.121: +40 -11
lines
```

Merge from HEAD.

```

---

Revision **1.117.2.4**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.117.2.4;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.117.2.4;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.117.2.4;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.117.2.4) - [select for diffs](kernfs_vnops.c?r1=1.117.2.4#rev1.117.2.4)

*Mon Jun 26 12:53:38 2006 UTC* (18 years, 7 months ago) by *yamt*

Branches: [yamt-pdpolicy](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy)

Diff to: previous 1.117.2.3: [preferred](kernfs_vnops.c.diff?r1=1.117.2.3;r2=1.117.2.4), [colored](kernfs_vnops.c.diff?r1=1.117.2.3;r2=1.117.2.4;f=h); branchpoint 1.117: [preferred](kernfs_vnops.c.diff?r1=1.117;r2=1.117.2.4), [colored](kernfs_vnops.c.diff?r1=1.117;r2=1.117.2.4;f=h); next MAIN 1.118: [preferred](kernfs_vnops.c.diff?r1=1.118;r2=1.117.2.4), [colored](kernfs_vnops.c.diff?r1=1.118;r2=1.117.2.4;f=h)

Changes since revision 1.117.2.3: +42 -18
lines
```

sync with head.

```

---

Revision **1.125**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.125;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.125;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.125;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.125) - [select for diffs](kernfs_vnops.c?r1=1.125#rev1.125)

*Fri Jun 23 20:54:21 2006 UTC* (18 years, 7 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-splraiseipl-base](./kernfs_vnops.c?only_with_tag=yamt-splraiseipl-base),
[yamt-pdpolicy-base9](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy-base9),
[yamt-pdpolicy-base8](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy-base8),
[yamt-pdpolicy-base7](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy-base7),
[yamt-pdpolicy-base6](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy-base6),
[rpaulo-netinet-merge-pcb-base](./kernfs_vnops.c?only_with_tag=rpaulo-netinet-merge-pcb-base),
[abandoned-netbsd-4-base](./kernfs_vnops.c?only_with_tag=abandoned-netbsd-4-base),
[abandoned-netbsd-4](./kernfs_vnops.c?only_with_tag=abandoned-netbsd-4)

Branch point for: [yamt-splraiseipl](./kernfs_vnops.c?only_with_tag=yamt-splraiseipl),
[newlock2](./kernfs_vnops.c?only_with_tag=newlock2)

Diff to: previous 1.124: [preferred](kernfs_vnops.c.diff?r1=1.124;r2=1.125), [colored](kernfs_vnops.c.diff?r1=1.124;r2=1.125;f=h)

Changes since revision 1.124: +8 -6
lines
```

remove useless genop

```

---

Revision **1.124**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.124;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.124;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.124;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.124) - [select for diffs](kernfs_vnops.c?r1=1.124#rev1.124)

*Fri Jun 23 20:30:11 2006 UTC* (18 years, 7 months ago) by *bouyer*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.123: [preferred](kernfs_vnops.c.diff?r1=1.123;r2=1.124), [colored](kernfs_vnops.c.diff?r1=1.123;r2=1.124;f=h)

Changes since revision 1.123: +34 -7
lines
```

For internal types call kernfs_default_xread() directly, as no entry in
the splay tree has been added for these types. Fix [kern/33797](http://gnats.NetBSD.org/33797) by
Geoff C. Wing.
While here also fix writes the same way (probably broken for 2 years),
and properly implement KERNFS_XREAD.
The IPsec code could probably be moved out now, and use kernfs_alloctype().

```

---

Revision **1.123**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.123;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.123;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.123;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.123) - [select for diffs](kernfs_vnops.c?r1=1.123#rev1.123)

*Fri Jun 23 16:26:59 2006 UTC* (18 years, 7 months ago) by *bouyer*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.122: [preferred](kernfs_vnops.c.diff?r1=1.122;r2=1.123), [colored](kernfs_vnops.c.diff?r1=1.122;r2=1.123;f=h)

Changes since revision 1.122: +22 -2
lines
```

Backout previous: of course the change
  "Allow optional /kern regular files to have custom read methods..."
works, it's used by Xen.

```

---

Revision **1.122**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.122;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.122;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.122;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.122) - [select for diffs](kernfs_vnops.c?r1=1.122#rev1.122)

*Fri Jun 23 14:59:40 2006 UTC* (18 years, 7 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.121: [preferred](kernfs_vnops.c.diff?r1=1.121;r2=1.122), [colored](kernfs_vnops.c.diff?r1=1.121;r2=1.122;f=h)

Changes since revision 1.121: +3 -23
lines
```

PR/[33797](http://gnats.NetBSD.org/33797): Geoff C. Wing: kernfs files are not supplying information
Roll back the change:
    'Allow optional /kern regular files to have custom read methods...'
which does not work.

```

---

Revision **1.109.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.109.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.109.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.109.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.109.2.1) - [select for diffs](kernfs_vnops.c?r1=1.109.2.1#rev1.109.2.1)

*Wed Jun 21 15:10:26 2006 UTC* (18 years, 7 months ago) by *yamt*

Branches: [yamt-lazymbuf](./kernfs_vnops.c?only_with_tag=yamt-lazymbuf)

Diff to: previous 1.109: [preferred](kernfs_vnops.c.diff?r1=1.109;r2=1.109.2.1), [colored](kernfs_vnops.c.diff?r1=1.109;r2=1.109.2.1;f=h)

Changes since revision 1.109: +77 -66
lines
```

sync with head.

```

---

Revision **1.120.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.120.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.120.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.120.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.120.2.1) - [select for diffs](kernfs_vnops.c?r1=1.120.2.1#rev1.120.2.1)

*Mon Jun 19 04:09:12 2006 UTC* (18 years, 7 months ago) by *chap*

Branches: [chap-midi](./kernfs_vnops.c?only_with_tag=chap-midi)

Diff to: previous 1.120: [preferred](kernfs_vnops.c.diff?r1=1.120;r2=1.120.2.1), [colored](kernfs_vnops.c.diff?r1=1.120;r2=1.120.2.1;f=h); next MAIN 1.121: [preferred](kernfs_vnops.c.diff?r1=1.121;r2=1.120.2.1), [colored](kernfs_vnops.c.diff?r1=1.121;r2=1.120.2.1;f=h)

Changes since revision 1.120: +4 -9
lines
```

Sync with head.

```

---

Revision **1.121**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.121;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.121;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.121;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.121) - [select for diffs](kernfs_vnops.c?r1=1.121#rev1.121)

*Wed Jun 7 22:33:41 2006 UTC* (18 years, 7 months ago) by *kardel*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [gdamore-uart-base](./kernfs_vnops.c?only_with_tag=gdamore-uart-base),
[chap-midi-nbase](./kernfs_vnops.c?only_with_tag=chap-midi-nbase),
[chap-midi-base](./kernfs_vnops.c?only_with_tag=chap-midi-base)

Branch point for: [gdamore-uart](./kernfs_vnops.c?only_with_tag=gdamore-uart)

Diff to: previous 1.120: [preferred](kernfs_vnops.c.diff?r1=1.120;r2=1.121), [colored](kernfs_vnops.c.diff?r1=1.120;r2=1.121;f=h)

Changes since revision 1.120: +4 -9
lines
```

merge FreeBSD timecounters from branch simonb-timecounters
- struct timeval time is gone
  time.tv_sec -> time_second
- struct timeval mono_time is gone
  mono_time.tv_sec -> time_uptime
- access to time via
	{get,}{micro,nano,bin}time()
	get* versions are fast but less precise
- support NTP nanokernel implementation (NTP API 4)
- further reading:
  Timecounter Paper: <http://phk.freebsd.dk/pubs/timecounter.pdf>
  NTP Nanokernel: <http://www.eecis.udel.edu/~mills/ntp/html/kern.html>

```

---

Revision **1.116.6.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.116.6.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.116.6.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.116.6.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.116.6.3) - [select for diffs](kernfs_vnops.c?r1=1.116.6.3#rev1.116.6.3)

*Thu Jun 1 22:38:29 2006 UTC* (18 years, 7 months ago) by *kardel*

Branches: [simonb-timecounters](./kernfs_vnops.c?only_with_tag=simonb-timecounters)

CVS tags: [simonb-timcounters-final](./kernfs_vnops.c?only_with_tag=simonb-timcounters-final)

Diff to: previous 1.116.6.2: [preferred](kernfs_vnops.c.diff?r1=1.116.6.2;r2=1.116.6.3), [colored](kernfs_vnops.c.diff?r1=1.116.6.2;r2=1.116.6.3;f=h); branchpoint 1.116: [preferred](kernfs_vnops.c.diff?r1=1.116;r2=1.116.6.3), [colored](kernfs_vnops.c.diff?r1=1.116;r2=1.116.6.3;f=h); next MAIN 1.117: [preferred](kernfs_vnops.c.diff?r1=1.117;r2=1.116.6.3), [colored](kernfs_vnops.c.diff?r1=1.117;r2=1.116.6.3;f=h)

Changes since revision 1.116.6.2: +12 -12
lines
```

Sync with head.

```

---

Revision **1.118.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.118.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.118.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.118.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.118.2.1) - [select for diffs](kernfs_vnops.c?r1=1.118.2.1#rev1.118.2.1)

*Wed May 24 15:50:43 2006 UTC* (18 years, 8 months ago) by *tron*

Branches: [peter-altq](./kernfs_vnops.c?only_with_tag=peter-altq)

Diff to: previous 1.118: [preferred](kernfs_vnops.c.diff?r1=1.118;r2=1.118.2.1), [colored](kernfs_vnops.c.diff?r1=1.118;r2=1.118.2.1;f=h); next MAIN 1.119: [preferred](kernfs_vnops.c.diff?r1=1.119;r2=1.118.2.1), [colored](kernfs_vnops.c.diff?r1=1.119;r2=1.118.2.1;f=h)

Changes since revision 1.118: +14 -14
lines
```

Merge 2006-05-24 NetBSD-current into the "peter-altq" branch.

```

---

Revision **1.117.2.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.117.2.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.117.2.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.117.2.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.117.2.3) - [select for diffs](kernfs_vnops.c?r1=1.117.2.3#rev1.117.2.3)

*Wed May 24 10:58:55 2006 UTC* (18 years, 8 months ago) by *yamt*

Branches: [yamt-pdpolicy](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy)

Diff to: previous 1.117.2.2: [preferred](kernfs_vnops.c.diff?r1=1.117.2.2;r2=1.117.2.3), [colored](kernfs_vnops.c.diff?r1=1.117.2.2;r2=1.117.2.3;f=h); branchpoint 1.117: [preferred](kernfs_vnops.c.diff?r1=1.117;r2=1.117.2.3), [colored](kernfs_vnops.c.diff?r1=1.117;r2=1.117.2.3;f=h)

Changes since revision 1.117.2.2: +12 -12
lines
```

sync with head.

```

---

Revision **1.120**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.120;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.120;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.120;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.120) - [select for diffs](kernfs_vnops.c?r1=1.120#rev1.120)

*Sun May 14 21:31:52 2006 UTC* (18 years, 8 months ago) by *elad*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-pdpolicy-base5](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy-base5),
[simonb-timecounters-base](./kernfs_vnops.c?only_with_tag=simonb-timecounters-base)

Branch point for: [chap-midi](./kernfs_vnops.c?only_with_tag=chap-midi)

Diff to: previous 1.119: [preferred](kernfs_vnops.c.diff?r1=1.119;r2=1.120), [colored](kernfs_vnops.c.diff?r1=1.119;r2=1.120;f=h)

Changes since revision 1.119: +12 -12
lines
```

integrate kauth.

```

---

Revision **1.116.6.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.116.6.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.116.6.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.116.6.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.116.6.2) - [select for diffs](kernfs_vnops.c?r1=1.116.6.2#rev1.116.6.2)

*Sat Apr 22 11:40:05 2006 UTC* (18 years, 9 months ago) by *simonb*

Branches: [simonb-timecounters](./kernfs_vnops.c?only_with_tag=simonb-timecounters)

Diff to: previous 1.116.6.1: [preferred](kernfs_vnops.c.diff?r1=1.116.6.1;r2=1.116.6.2), [colored](kernfs_vnops.c.diff?r1=1.116.6.1;r2=1.116.6.2;f=h); branchpoint 1.116: [preferred](kernfs_vnops.c.diff?r1=1.116;r2=1.116.6.2), [colored](kernfs_vnops.c.diff?r1=1.116;r2=1.116.6.2;f=h)

Changes since revision 1.116.6.1: +30 -9
lines
```

Sync with head.

```

---

Revision **1.117.4.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.117.4.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.117.4.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.117.4.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.117.4.2) - [select for diffs](kernfs_vnops.c?r1=1.117.4.2#rev1.117.4.2)

*Wed Apr 19 04:52:46 2006 UTC* (18 years, 9 months ago) by *elad*

Branches: [elad-kernelauth](./kernfs_vnops.c?only_with_tag=elad-kernelauth)

Diff to: previous 1.117.4.1: [preferred](kernfs_vnops.c.diff?r1=1.117.4.1;r2=1.117.4.2), [colored](kernfs_vnops.c.diff?r1=1.117.4.1;r2=1.117.4.2;f=h); branchpoint 1.117: [preferred](kernfs_vnops.c.diff?r1=1.117;r2=1.117.4.2), [colored](kernfs_vnops.c.diff?r1=1.117;r2=1.117.4.2;f=h); next MAIN 1.118: [preferred](kernfs_vnops.c.diff?r1=1.118;r2=1.117.4.2), [colored](kernfs_vnops.c.diff?r1=1.118;r2=1.117.4.2;f=h)

Changes since revision 1.117.4.1: +25 -5
lines
```

sync with head.

```

---

Revision **1.117.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.117.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.117.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.117.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.117.2.2) - [select for diffs](kernfs_vnops.c?r1=1.117.2.2#rev1.117.2.2)

*Tue Apr 11 11:55:48 2006 UTC* (18 years, 9 months ago) by *yamt*

Branches: [yamt-pdpolicy](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy)

Diff to: previous 1.117.2.1: [preferred](kernfs_vnops.c.diff?r1=1.117.2.1;r2=1.117.2.2), [colored](kernfs_vnops.c.diff?r1=1.117.2.1;r2=1.117.2.2;f=h); branchpoint 1.117: [preferred](kernfs_vnops.c.diff?r1=1.117;r2=1.117.2.2), [colored](kernfs_vnops.c.diff?r1=1.117;r2=1.117.2.2;f=h)

Changes since revision 1.117.2.1: +4 -4
lines
```

sync with head

```

---

Revision **1.119**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.119;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.119;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.119;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.119) - [select for diffs](kernfs_vnops.c?r1=1.119#rev1.119)

*Tue Apr 4 14:21:55 2006 UTC* (18 years, 9 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-pdpolicy-base4](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy-base4),
[elad-kernelauth-base](./kernfs_vnops.c?only_with_tag=elad-kernelauth-base)

Diff to: previous 1.118: [preferred](kernfs_vnops.c.diff?r1=1.118;r2=1.119), [colored](kernfs_vnops.c.diff?r1=1.118;r2=1.119;f=h)

Changes since revision 1.118: +4 -4
lines
```

Coverity CID 1087: Clarify NULL test.

```

---

Revision **1.117.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.117.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.117.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.117.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.117.2.1) - [select for diffs](kernfs_vnops.c?r1=1.117.2.1#rev1.117.2.1)

*Sat Apr 1 12:07:42 2006 UTC* (18 years, 9 months ago) by *yamt*

Branches: [yamt-pdpolicy](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy)

Diff to: previous 1.117: [preferred](kernfs_vnops.c.diff?r1=1.117;r2=1.117.2.1), [colored](kernfs_vnops.c.diff?r1=1.117;r2=1.117.2.1;f=h)

Changes since revision 1.117: +23 -3
lines
```

sync with head.

```

---

Revision **1.118**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.118;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.118;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.118;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.118) - [select for diffs](kernfs_vnops.c?r1=1.118#rev1.118)

*Tue Mar 14 20:47:52 2006 UTC* (18 years, 10 months ago) by *bouyer*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-pdpolicy-base3](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy-base3),
[peter-altq-base](./kernfs_vnops.c?only_with_tag=peter-altq-base)

Branch point for: [peter-altq](./kernfs_vnops.c?only_with_tag=peter-altq)

Diff to: previous 1.117: [preferred](kernfs_vnops.c.diff?r1=1.117;r2=1.118), [colored](kernfs_vnops.c.diff?r1=1.117;r2=1.118;f=h)

Changes since revision 1.117: +23 -3
lines
```

Allow optionnal /kern regular files to have custom read methods, the same
way writes are handled: Add KERNFS_XREAD and KERNFS_FILEOP_WRITE files
operations definitions to kfsfileop, a xread function pointer to
kernfs_fileop, rename kernfs_read to kernfs_default_xread and add a
kernfs_read calling kernfs_try_fileop(KERNFS_FILEOP_READ).

Proposed on tech-kern on Feb 18 2006.

```

---

Revision **1.117.4.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.117.4.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.117.4.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.117.4.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.117.4.1) - [select for diffs](kernfs_vnops.c?r1=1.117.4.1#rev1.117.4.1)

*Wed Mar 8 01:34:34 2006 UTC* (18 years, 10 months ago) by *elad*

Branches: [elad-kernelauth](./kernfs_vnops.c?only_with_tag=elad-kernelauth)

Diff to: previous 1.117: [preferred](kernfs_vnops.c.diff?r1=1.117;r2=1.117.4.1), [colored](kernfs_vnops.c.diff?r1=1.117;r2=1.117.4.1;f=h)

Changes since revision 1.117: +12 -12
lines
```

Adapt to kernel authorization KPI.

```

---

Revision **1.117**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.117;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.117;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.117;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.117) - [select for diffs](kernfs_vnops.c?r1=1.117#rev1.117)

*Wed Mar 1 12:38:32 2006 UTC* (18 years, 10 months ago) by *yamt*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-pdpolicy-base2](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy-base2),
[yamt-pdpolicy-base](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy-base)

Branch point for: [yamt-pdpolicy](./kernfs_vnops.c?only_with_tag=yamt-pdpolicy),
[elad-kernelauth](./kernfs_vnops.c?only_with_tag=elad-kernelauth)

Diff to: previous 1.116: [preferred](kernfs_vnops.c.diff?r1=1.116;r2=1.117), [colored](kernfs_vnops.c.diff?r1=1.116;r2=1.117;f=h)

Changes since revision 1.116: +7 -6
lines
```

merge yamt-uio_vmspace branch.

- use vmspace rather than proc or lwp where appropriate.
  the latter is more natural to specify an address space.
  (and less likely to be abused for random purposes.)
- fix a swdmover race.

```

---

Revision **1.116.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.116.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.116.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.116.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.116.2.1) - [select for diffs](kernfs_vnops.c?r1=1.116.2.1#rev1.116.2.1)

*Sun Feb 5 13:20:21 2006 UTC* (18 years, 11 months ago) by *yamt*

Branches: [yamt-uio\_vmspace](./kernfs_vnops.c?only_with_tag=yamt-uio_vmspace)

Diff to: previous 1.116: [preferred](kernfs_vnops.c.diff?r1=1.116;r2=1.116.2.1), [colored](kernfs_vnops.c.diff?r1=1.116;r2=1.116.2.1;f=h); next MAIN 1.117: [preferred](kernfs_vnops.c.diff?r1=1.117;r2=1.116.2.1), [colored](kernfs_vnops.c.diff?r1=1.117;r2=1.116.2.1;f=h)

Changes since revision 1.116: +7 -6
lines
```

adapt kernfs.

```

---

Revision **1.116.6.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.116.6.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.116.6.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.116.6.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.116.6.1) - [select for diffs](kernfs_vnops.c?r1=1.116.6.1#rev1.116.6.1)

*Sat Feb 4 14:12:49 2006 UTC* (18 years, 11 months ago) by *simonb*

Branches: [simonb-timecounters](./kernfs_vnops.c?only_with_tag=simonb-timecounters)

Diff to: previous 1.116: [preferred](kernfs_vnops.c.diff?r1=1.116;r2=1.116.6.1), [colored](kernfs_vnops.c.diff?r1=1.116;r2=1.116.6.1;f=h)

Changes since revision 1.116: +4 -9
lines
```

Adapt for timecounters: mostly use get*time() and use "time_second"
instead of "time.tv_sec".

```

---

Revision **1.116**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.116;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.116;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.116;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.116) - [select for diffs](kernfs_vnops.c?r1=1.116#rev1.116)

*Sat Dec 24 20:45:09 2005 UTC* (19 years, 1 month ago) by *perry*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-uio\_vmspace-base5](./kernfs_vnops.c?only_with_tag=yamt-uio_vmspace-base5)

Branch point for: [yamt-uio\_vmspace](./kernfs_vnops.c?only_with_tag=yamt-uio_vmspace),
[simonb-timecounters](./kernfs_vnops.c?only_with_tag=simonb-timecounters),
[rpaulo-netinet-merge-pcb](./kernfs_vnops.c?only_with_tag=rpaulo-netinet-merge-pcb)

Diff to: previous 1.115: [preferred](kernfs_vnops.c.diff?r1=1.115;r2=1.116), [colored](kernfs_vnops.c.diff?r1=1.115;r2=1.116;f=h)

Changes since revision 1.115: +3 -3
lines
```

Remove leading __ from __(const|inline|signed|volatile) -- it is obsolete.

```

---

Revision **1.115**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.115;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.115;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.115;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.115) - [select for diffs](kernfs_vnops.c?r1=1.115#rev1.115)

*Sun Dec 11 12:24:51 2005 UTC* (19 years, 1 month ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.114: [preferred](kernfs_vnops.c.diff?r1=1.114;r2=1.115), [colored](kernfs_vnops.c.diff?r1=1.114;r2=1.115;f=h)

Changes since revision 1.114: +11 -11
lines
```

merge ktrace-lwp.

```

---

Revision **1.88.2.10**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.88.2.10;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.88.2.10;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.88.2.10;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.88.2.10) - [select for diffs](kernfs_vnops.c?r1=1.88.2.10#rev1.88.2.10)

*Sun Dec 11 10:29:18 2005 UTC* (19 years, 1 month ago) by *christos*

Branches: [ktrace-lwp](./kernfs_vnops.c?only_with_tag=ktrace-lwp)

Diff to: previous 1.88.2.9: [preferred](kernfs_vnops.c.diff?r1=1.88.2.9;r2=1.88.2.10), [colored](kernfs_vnops.c.diff?r1=1.88.2.9;r2=1.88.2.10;f=h); next MAIN 1.89: [preferred](kernfs_vnops.c.diff?r1=1.89;r2=1.88.2.10), [colored](kernfs_vnops.c.diff?r1=1.89;r2=1.88.2.10;f=h)

Changes since revision 1.88.2.9: +5 -5
lines
```

Sync with head.

```

---

Revision **1.113.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.113.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.113.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.113.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.113.2.1) - [select for diffs](kernfs_vnops.c?r1=1.113.2.1#rev1.113.2.1)

*Tue Nov 29 21:23:29 2005 UTC* (19 years, 2 months ago) by *yamt*

Branches: [yamt-readahead](./kernfs_vnops.c?only_with_tag=yamt-readahead)

Diff to: previous 1.113: [preferred](kernfs_vnops.c.diff?r1=1.113;r2=1.113.2.1), [colored](kernfs_vnops.c.diff?r1=1.113;r2=1.113.2.1;f=h); next MAIN 1.114: [preferred](kernfs_vnops.c.diff?r1=1.114;r2=1.113.2.1), [colored](kernfs_vnops.c.diff?r1=1.114;r2=1.113.2.1;f=h)

Changes since revision 1.113: +5 -5
lines
```

sync with head.

```

---

Revision **1.79.10.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.79.10.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.79.10.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.79.10.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.79.10.3) - [select for diffs](kernfs_vnops.c?r1=1.79.10.3#rev1.79.10.3)

*Tue Nov 29 12:40:07 2005 UTC* (19 years, 2 months ago) by *tron*

Branches: [netbsd-1-6](./kernfs_vnops.c?only_with_tag=netbsd-1-6)

Diff to: previous 1.79.10.2: [preferred](kernfs_vnops.c.diff?r1=1.79.10.2;r2=1.79.10.3), [colored](kernfs_vnops.c.diff?r1=1.79.10.2;r2=1.79.10.3;f=h); branchpoint 1.79: [preferred](kernfs_vnops.c.diff?r1=1.79;r2=1.79.10.3), [colored](kernfs_vnops.c.diff?r1=1.79;r2=1.79.10.3;f=h); next MAIN 1.80: [preferred](kernfs_vnops.c.diff?r1=1.80;r2=1.79.10.3), [colored](kernfs_vnops.c.diff?r1=1.80;r2=1.79.10.3;f=h)

Changes since revision 1.79.10.2: +8 -4
lines
```

Pull up following revision(s) (requested by christos in ticket #5952):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.114 via patch
Fix 64 bit truncation problem reported by <http://www.securitylab.net>

```

---

Revision **1.98.2.7**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.7;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.7;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.7;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.7) - [select for diffs](kernfs_vnops.c?r1=1.98.2.7#rev1.98.2.7)

*Tue Nov 29 12:36:19 2005 UTC* (19 years, 2 months ago) by *tron*

Branches: [netbsd-2-0](./kernfs_vnops.c?only_with_tag=netbsd-2-0)

Diff to: previous 1.98.2.6: [preferred](kernfs_vnops.c.diff?r1=1.98.2.6;r2=1.98.2.7), [colored](kernfs_vnops.c.diff?r1=1.98.2.6;r2=1.98.2.7;f=h); branchpoint 1.98: [preferred](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.7), [colored](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.7;f=h); next MAIN 1.99: [preferred](kernfs_vnops.c.diff?r1=1.99;r2=1.98.2.7), [colored](kernfs_vnops.c.diff?r1=1.99;r2=1.98.2.7;f=h)

Changes since revision 1.98.2.6: +5 -5
lines
```

Pull up following revision(s) (requested by christos in ticket #10155):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.114 via patch
Fix 64 bit truncation problem reported by <http://www.securitylab.net>

```

---

Revision **1.98.2.3.2.3.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.3.2.3.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.3.2.3.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.3.2.3.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.3.2.3.2.1) - [select for diffs](kernfs_vnops.c?r1=1.98.2.3.2.3.2.1#rev1.98.2.3.2.3.2.1)

*Tue Nov 29 12:35:43 2005 UTC* (19 years, 2 months ago) by *tron*

Branches: [netbsd-2-1](./kernfs_vnops.c?only_with_tag=netbsd-2-1)

Diff to: previous 1.98.2.3.2.3: [preferred](kernfs_vnops.c.diff?r1=1.98.2.3.2.3;r2=1.98.2.3.2.3.2.1), [colored](kernfs_vnops.c.diff?r1=1.98.2.3.2.3;r2=1.98.2.3.2.3.2.1;f=h); next MAIN 1.98.2.3.2.4: [preferred](kernfs_vnops.c.diff?r1=1.98.2.3.2.4;r2=1.98.2.3.2.3.2.1), [colored](kernfs_vnops.c.diff?r1=1.98.2.3.2.4;r2=1.98.2.3.2.3.2.1;f=h)

Changes since revision 1.98.2.3.2.3: +5 -5
lines
```

Pull up following revision(s) (requested by christos in ticket #10155):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.114 via patch
Fix 64 bit truncation problem reported by <http://www.securitylab.net>

```

---

Revision **1.98.2.3.2.4**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.3.2.4;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.3.2.4;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.3.2.4;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.3.2.4) - [select for diffs](kernfs_vnops.c?r1=1.98.2.3.2.4#rev1.98.2.3.2.4)

*Tue Nov 29 12:34:37 2005 UTC* (19 years, 2 months ago) by *tron*

Branches: [netbsd-2](./kernfs_vnops.c?only_with_tag=netbsd-2)

Diff to: previous 1.98.2.3.2.3: [preferred](kernfs_vnops.c.diff?r1=1.98.2.3.2.3;r2=1.98.2.3.2.4), [colored](kernfs_vnops.c.diff?r1=1.98.2.3.2.3;r2=1.98.2.3.2.4;f=h); branchpoint 1.98.2.3: [preferred](kernfs_vnops.c.diff?r1=1.98.2.3;r2=1.98.2.3.2.4), [colored](kernfs_vnops.c.diff?r1=1.98.2.3;r2=1.98.2.3.2.4;f=h); next MAIN 1.98.2.4: [preferred](kernfs_vnops.c.diff?r1=1.98.2.4;r2=1.98.2.3.2.4), [colored](kernfs_vnops.c.diff?r1=1.98.2.4;r2=1.98.2.3.2.4;f=h)

Changes since revision 1.98.2.3.2.3: +5 -5
lines
```

Pull up following revision(s) (requested by christos in ticket #10155):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.114 via patch
Fix 64 bit truncation problem reported by <http://www.securitylab.net>

```

---

Revision **1.107.2.4**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.107.2.4;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.107.2.4;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.107.2.4;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.107.2.4) - [select for diffs](kernfs_vnops.c?r1=1.107.2.4#rev1.107.2.4)

*Thu Nov 24 22:11:11 2005 UTC* (19 years, 2 months ago) by *tron*

Branches: [netbsd-3](./kernfs_vnops.c?only_with_tag=netbsd-3)

CVS tags: [netbsd-3-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-3-1-RELEASE),
[netbsd-3-1-RC4](./kernfs_vnops.c?only_with_tag=netbsd-3-1-RC4),
[netbsd-3-1-RC3](./kernfs_vnops.c?only_with_tag=netbsd-3-1-RC3),
[netbsd-3-1-RC2](./kernfs_vnops.c?only_with_tag=netbsd-3-1-RC2),
[netbsd-3-1-RC1](./kernfs_vnops.c?only_with_tag=netbsd-3-1-RC1),
[netbsd-3-1-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-3-1-1-RELEASE),
[netbsd-3-1](./kernfs_vnops.c?only_with_tag=netbsd-3-1),
[netbsd-3-0-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-3-0-RELEASE),
[netbsd-3-0-RC6](./kernfs_vnops.c?only_with_tag=netbsd-3-0-RC6),
[netbsd-3-0-RC5](./kernfs_vnops.c?only_with_tag=netbsd-3-0-RC5),
[netbsd-3-0-RC4](./kernfs_vnops.c?only_with_tag=netbsd-3-0-RC4),
[netbsd-3-0-3-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-3-0-3-RELEASE),
[netbsd-3-0-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-3-0-2-RELEASE),
[netbsd-3-0-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-3-0-1-RELEASE),
[netbsd-3-0](./kernfs_vnops.c?only_with_tag=netbsd-3-0)

Diff to: previous 1.107.2.3: [preferred](kernfs_vnops.c.diff?r1=1.107.2.3;r2=1.107.2.4), [colored](kernfs_vnops.c.diff?r1=1.107.2.3;r2=1.107.2.4;f=h); branchpoint 1.107: [preferred](kernfs_vnops.c.diff?r1=1.107;r2=1.107.2.4), [colored](kernfs_vnops.c.diff?r1=1.107;r2=1.107.2.4;f=h); next MAIN 1.108: [preferred](kernfs_vnops.c.diff?r1=1.108;r2=1.107.2.4), [colored](kernfs_vnops.c.diff?r1=1.108;r2=1.107.2.4;f=h)

Changes since revision 1.107.2.3: +7 -7
lines
```

Pull up following revision(s) (requested by christos in ticket #992):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.114 via patch
Fix 64 bit truncation problem reported by <http://www.securitylab.net>

```

---

Revision **1.114**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.114;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.114;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.114;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.114) - [select for diffs](kernfs_vnops.c?r1=1.114#rev1.114)

*Wed Nov 23 22:00:32 2005 UTC* (19 years, 2 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-readahead-base3](./kernfs_vnops.c?only_with_tag=yamt-readahead-base3),
[ktrace-lwp-base](./kernfs_vnops.c?only_with_tag=ktrace-lwp-base)

Diff to: previous 1.113: [preferred](kernfs_vnops.c.diff?r1=1.113;r2=1.114), [colored](kernfs_vnops.c.diff?r1=1.113;r2=1.114;f=h)

Changes since revision 1.113: +5 -5
lines
```

Fix 64 bit truncation problem reported by <http://www.securitylab.net>

```

---

Revision **1.88.2.9**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.88.2.9;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.88.2.9;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.88.2.9;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.88.2.9) - [select for diffs](kernfs_vnops.c?r1=1.88.2.9#rev1.88.2.9)

*Thu Nov 10 14:10:25 2005 UTC* (19 years, 2 months ago) by *skrll*

Branches: [ktrace-lwp](./kernfs_vnops.c?only_with_tag=ktrace-lwp)

Diff to: previous 1.88.2.8: [preferred](kernfs_vnops.c.diff?r1=1.88.2.8;r2=1.88.2.9), [colored](kernfs_vnops.c.diff?r1=1.88.2.8;r2=1.88.2.9;f=h)

Changes since revision 1.88.2.8: +44 -68
lines
```

Sync with HEAD. Here we go again...

```

---

Revision **1.113**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.113;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.113;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.113;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.113) - [select for diffs](kernfs_vnops.c?r1=1.113#rev1.113)

*Wed Nov 2 12:38:59 2005 UTC* (19 years, 2 months ago) by *yamt*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-readahead-pervnode](./kernfs_vnops.c?only_with_tag=yamt-readahead-pervnode),
[yamt-readahead-perfile](./kernfs_vnops.c?only_with_tag=yamt-readahead-perfile),
[yamt-readahead-base2](./kernfs_vnops.c?only_with_tag=yamt-readahead-base2),
[yamt-readahead-base](./kernfs_vnops.c?only_with_tag=yamt-readahead-base)

Branch point for: [yamt-readahead](./kernfs_vnops.c?only_with_tag=yamt-readahead)

Diff to: previous 1.112: [preferred](kernfs_vnops.c.diff?r1=1.112;r2=1.113), [colored](kernfs_vnops.c.diff?r1=1.112;r2=1.113;f=h)

Changes since revision 1.112: +2 -12
lines
```

merge yamt-vop branch.  remove following VOPs.

	VOP_BLKATOFF
	VOP_VALLOC
	VOP_BALLOC
	VOP_REALLOCBLKS
	VOP_VFREE
	VOP_TRUNCATE
	VOP_UPDATE

```

---

Revision **1.112.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.112.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.112.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.112.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.112.2.1) - [select for diffs](kernfs_vnops.c?r1=1.112.2.1#rev1.112.2.1)

*Thu Oct 20 05:02:01 2005 UTC* (19 years, 3 months ago) by *yamt*

Branches: [yamt-vop](./kernfs_vnops.c?only_with_tag=yamt-vop)

Diff to: previous 1.112: [preferred](kernfs_vnops.c.diff?r1=1.112;r2=1.112.2.1), [colored](kernfs_vnops.c.diff?r1=1.112;r2=1.112.2.1;f=h); next MAIN 1.113: [preferred](kernfs_vnops.c.diff?r1=1.113;r2=1.112.2.1), [colored](kernfs_vnops.c.diff?r1=1.113;r2=1.112.2.1;f=h)

Changes since revision 1.112: +2 -12
lines
```

adapt kernfs.

```

---

Revision **1.98.2.6**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.6;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.6;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.6;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.6) - [select for diffs](kernfs_vnops.c?r1=1.98.2.6#rev1.98.2.6)

*Thu Sep 1 17:53:25 2005 UTC* (19 years, 4 months ago) by *riz*

Branches: [netbsd-2-0](./kernfs_vnops.c?only_with_tag=netbsd-2-0)

CVS tags: [netbsd-2-0-3-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-2-0-3-RELEASE)

Diff to: previous 1.98.2.5: [preferred](kernfs_vnops.c.diff?r1=1.98.2.5;r2=1.98.2.6), [colored](kernfs_vnops.c.diff?r1=1.98.2.5;r2=1.98.2.6;f=h); branchpoint 1.98: [preferred](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.6), [colored](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.6;f=h)

Changes since revision 1.98.2.5: +6 -6
lines
```

Pull up following revision(s) (requested by christos in ticket #5637):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.112
Also protect the ipsec ioctls from negative offsets to prevent panics
in m_copydata(). Pointed out by Karl Janmar. Move the negative offset
check from kernfs_xread() to kernfs_read().

```

---

Revision **1.98.2.3.2.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.3.2.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.3.2.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.3.2.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.3.2.3) - [select for diffs](kernfs_vnops.c?r1=1.98.2.3.2.3#rev1.98.2.3.2.3)

*Thu Sep 1 16:43:41 2005 UTC* (19 years, 4 months ago) by *riz*

Branches: [netbsd-2](./kernfs_vnops.c?only_with_tag=netbsd-2)

CVS tags: [netbsd-2-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-2-1-RELEASE),
[netbsd-2-1-RC6](./kernfs_vnops.c?only_with_tag=netbsd-2-1-RC6),
[netbsd-2-1-RC5](./kernfs_vnops.c?only_with_tag=netbsd-2-1-RC5),
[netbsd-2-1-RC4](./kernfs_vnops.c?only_with_tag=netbsd-2-1-RC4)

Branch point for: [netbsd-2-1](./kernfs_vnops.c?only_with_tag=netbsd-2-1)

Diff to: previous 1.98.2.3.2.2: [preferred](kernfs_vnops.c.diff?r1=1.98.2.3.2.2;r2=1.98.2.3.2.3), [colored](kernfs_vnops.c.diff?r1=1.98.2.3.2.2;r2=1.98.2.3.2.3;f=h); branchpoint 1.98.2.3: [preferred](kernfs_vnops.c.diff?r1=1.98.2.3;r2=1.98.2.3.2.3), [colored](kernfs_vnops.c.diff?r1=1.98.2.3;r2=1.98.2.3.2.3;f=h)

Changes since revision 1.98.2.3.2.2: +6 -6
lines
```

Pull up following revision(s) (requested by christos in ticket #5637):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.112
Also protect the ipsec ioctls from negative offsets to prevent panics
in m_copydata(). Pointed out by Karl Janmar. Move the negative offset
check from kernfs_xread() to kernfs_read().

```

---

Revision **1.107.2.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.107.2.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.107.2.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.107.2.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.107.2.3) - [select for diffs](kernfs_vnops.c?r1=1.107.2.3#rev1.107.2.3)

*Thu Sep 1 13:02:36 2005 UTC* (19 years, 4 months ago) by *tron*

Branches: [netbsd-3](./kernfs_vnops.c?only_with_tag=netbsd-3)

CVS tags: [netbsd-3-0-RC3](./kernfs_vnops.c?only_with_tag=netbsd-3-0-RC3),
[netbsd-3-0-RC2](./kernfs_vnops.c?only_with_tag=netbsd-3-0-RC2),
[netbsd-3-0-RC1](./kernfs_vnops.c?only_with_tag=netbsd-3-0-RC1)

Diff to: previous 1.107.2.2: [preferred](kernfs_vnops.c.diff?r1=1.107.2.2;r2=1.107.2.3), [colored](kernfs_vnops.c.diff?r1=1.107.2.2;r2=1.107.2.3;f=h); branchpoint 1.107: [preferred](kernfs_vnops.c.diff?r1=1.107;r2=1.107.2.3), [colored](kernfs_vnops.c.diff?r1=1.107;r2=1.107.2.3;f=h)

Changes since revision 1.107.2.2: +4 -4
lines
```

Pull up following revision(s) (requested by christos in ticket #728):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.112
Also protect the ipsec ioctls from negative offsets to prevent panics
in m_copydata(). Pointed out by Karl Janmar. Move the negative offset
check from kernfs_xread() to kernfs_read().

```

---

Revision **1.112**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.112;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.112;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.112;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.112) - [select for diffs](kernfs_vnops.c?r1=1.112#rev1.112)

*Thu Sep 1 06:25:26 2005 UTC* (19 years, 4 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-vop-base3](./kernfs_vnops.c?only_with_tag=yamt-vop-base3),
[yamt-vop-base2](./kernfs_vnops.c?only_with_tag=yamt-vop-base2),
[yamt-vop-base](./kernfs_vnops.c?only_with_tag=yamt-vop-base),
[thorpej-vnode-attr-base](./kernfs_vnops.c?only_with_tag=thorpej-vnode-attr-base),
[thorpej-vnode-attr](./kernfs_vnops.c?only_with_tag=thorpej-vnode-attr)

Branch point for: [yamt-vop](./kernfs_vnops.c?only_with_tag=yamt-vop)

Diff to: previous 1.111: [preferred](kernfs_vnops.c.diff?r1=1.111;r2=1.112), [colored](kernfs_vnops.c.diff?r1=1.111;r2=1.112;f=h)

Changes since revision 1.111: +6 -6
lines
```

Also protect the ipsec ioctls from negative offsets to prevent panics
in m_copydata(). Pointed out by Karl Janmar. Move the negative offset
check from kernfs_xread() to kernfs_read().

```

---

Revision **1.98.2.5**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.5;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.5;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.5;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.5) - [select for diffs](kernfs_vnops.c?r1=1.98.2.5#rev1.98.2.5)

*Wed Aug 31 13:29:11 2005 UTC* (19 years, 4 months ago) by *tron*

Branches: [netbsd-2-0](./kernfs_vnops.c?only_with_tag=netbsd-2-0)

Diff to: previous 1.98.2.4: [preferred](kernfs_vnops.c.diff?r1=1.98.2.4;r2=1.98.2.5), [colored](kernfs_vnops.c.diff?r1=1.98.2.4;r2=1.98.2.5;f=h); branchpoint 1.98: [preferred](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.5), [colored](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.5;f=h)

Changes since revision 1.98.2.4: +6 -2
lines
```

Pull up following revision(s) (requested by christos in ticket #5633):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.111
Don't allow negative offsets when reading the message buffer, because it
can allow reading arbitrary kernel memory.

```

---

Revision **1.98.2.3.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.3.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.3.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.3.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.3.2.2) - [select for diffs](kernfs_vnops.c?r1=1.98.2.3.2.2#rev1.98.2.3.2.2)

*Wed Aug 31 13:27:01 2005 UTC* (19 years, 4 months ago) by *tron*

Branches: [netbsd-2](./kernfs_vnops.c?only_with_tag=netbsd-2)

CVS tags: [netbsd-2-1-RC3](./kernfs_vnops.c?only_with_tag=netbsd-2-1-RC3)

Diff to: previous 1.98.2.3.2.1: [preferred](kernfs_vnops.c.diff?r1=1.98.2.3.2.1;r2=1.98.2.3.2.2), [colored](kernfs_vnops.c.diff?r1=1.98.2.3.2.1;r2=1.98.2.3.2.2;f=h); branchpoint 1.98.2.3: [preferred](kernfs_vnops.c.diff?r1=1.98.2.3;r2=1.98.2.3.2.2), [colored](kernfs_vnops.c.diff?r1=1.98.2.3;r2=1.98.2.3.2.2;f=h)

Changes since revision 1.98.2.3.2.1: +6 -2
lines
```

Pull up following revision(s) (requested by christos in ticket #5633):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.111
Don't allow negative offsets when reading the message buffer, because it
can allow reading arbitrary kernel memory.

```

---

Revision **1.107.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.107.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.107.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.107.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.107.2.2) - [select for diffs](kernfs_vnops.c?r1=1.107.2.2#rev1.107.2.2)

*Wed Aug 31 10:41:13 2005 UTC* (19 years, 4 months ago) by *tron*

Branches: [netbsd-3](./kernfs_vnops.c?only_with_tag=netbsd-3)

Diff to: previous 1.107.2.1: [preferred](kernfs_vnops.c.diff?r1=1.107.2.1;r2=1.107.2.2), [colored](kernfs_vnops.c.diff?r1=1.107.2.1;r2=1.107.2.2;f=h); branchpoint 1.107: [preferred](kernfs_vnops.c.diff?r1=1.107;r2=1.107.2.2), [colored](kernfs_vnops.c.diff?r1=1.107;r2=1.107.2.2;f=h)

Changes since revision 1.107.2.1: +4 -0
lines
```

Pull up following revision(s) (requested by christos in ticket #727):
	sys/miscfs/kernfs/kernfs_vnops.c: revision 1.111
Don't allow negative offsets when reading the message buffer, because it
can allow reading arbitrary kernel memory.

```

---

Revision **1.111**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.111;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.111;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.111;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.111) - [select for diffs](kernfs_vnops.c?r1=1.111#rev1.111)

*Wed Aug 31 09:54:54 2005 UTC* (19 years, 4 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.110: [preferred](kernfs_vnops.c.diff?r1=1.110;r2=1.111), [colored](kernfs_vnops.c.diff?r1=1.110;r2=1.111;f=h)

Changes since revision 1.110: +6 -2
lines
```

Don't allow negative offsets when reading the message buffer, because it
can allow reading arbitrary kernel memory.

```

---

Revision **1.110**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.110;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.110;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.110;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.110) - [select for diffs](kernfs_vnops.c?r1=1.110#rev1.110)

*Tue Aug 30 20:08:01 2005 UTC* (19 years, 5 months ago) by *xtraeme*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.109: [preferred](kernfs_vnops.c.diff?r1=1.109;r2=1.110), [colored](kernfs_vnops.c.diff?r1=1.109;r2=1.110;f=h)

Changes since revision 1.109: +22 -21
lines
```

Remove __P()

```

---

Revision **1.109**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.109;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.109;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.109;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.109) - [select for diffs](kernfs_vnops.c?r1=1.109#rev1.109)

*Sun May 29 21:55:33 2005 UTC* (19 years, 8 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Branch point for: [yamt-lazymbuf](./kernfs_vnops.c?only_with_tag=yamt-lazymbuf)

Diff to: previous 1.108: [preferred](kernfs_vnops.c.diff?r1=1.108;r2=1.109), [colored](kernfs_vnops.c.diff?r1=1.108;r2=1.109;f=h)

Changes since revision 1.108: +20 -20
lines
```

- sprinkle const
- avoid shadowed variables.

```

---

Revision **1.107.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.107.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.107.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.107.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.107.2.1) - [select for diffs](kernfs_vnops.c?r1=1.107.2.1#rev1.107.2.1)

*Sat May 28 12:39:05 2005 UTC* (19 years, 8 months ago) by *tron*

Branches: [netbsd-3](./kernfs_vnops.c?only_with_tag=netbsd-3)

Diff to: previous 1.107: [preferred](kernfs_vnops.c.diff?r1=1.107;r2=1.107.2.1), [colored](kernfs_vnops.c.diff?r1=1.107;r2=1.107.2.1;f=h)

Changes since revision 1.107: +2 -21
lines
```

Pull up revision 1.108 (requested by chs in ticket #329):
kernfs does not support mmap(), remove code that pretends that it does.

```

---

Revision **1.98.2.4**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.4;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.4;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.4;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.4) - [select for diffs](kernfs_vnops.c?r1=1.98.2.4#rev1.98.2.4)

*Tue May 24 19:50:39 2005 UTC* (19 years, 8 months ago) by *riz*

Branches: [netbsd-2-0](./kernfs_vnops.c?only_with_tag=netbsd-2-0)

Diff to: previous 1.98.2.3: [preferred](kernfs_vnops.c.diff?r1=1.98.2.3;r2=1.98.2.4), [colored](kernfs_vnops.c.diff?r1=1.98.2.3;r2=1.98.2.4;f=h); branchpoint 1.98: [preferred](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.4), [colored](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.4;f=h)

Changes since revision 1.98.2.3: +2 -21
lines
```

Pull up revision 1.108 (requested by chs in ticket #1540):
kernfs does not support mmap(), remove code that pretends that it does.

```

---

Revision **1.98.2.3.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.3.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.3.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.3.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.3.2.1) - [select for diffs](kernfs_vnops.c?r1=1.98.2.3.2.1#rev1.98.2.3.2.1)

*Tue May 24 19:50:34 2005 UTC* (19 years, 8 months ago) by *riz*

Branches: [netbsd-2](./kernfs_vnops.c?only_with_tag=netbsd-2)

CVS tags: [netbsd-2-1-RC2](./kernfs_vnops.c?only_with_tag=netbsd-2-1-RC2),
[netbsd-2-1-RC1](./kernfs_vnops.c?only_with_tag=netbsd-2-1-RC1)

Diff to: previous 1.98.2.3: [preferred](kernfs_vnops.c.diff?r1=1.98.2.3;r2=1.98.2.3.2.1), [colored](kernfs_vnops.c.diff?r1=1.98.2.3;r2=1.98.2.3.2.1;f=h)

Changes since revision 1.98.2.3: +2 -21
lines
```

Pull up revision 1.108 (requested by chs in ticket #1540):
kernfs does not support mmap(), remove code that pretends that it does.

```

---

Revision **1.108**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.108;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.108;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.108;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.108) - [select for diffs](kernfs_vnops.c?r1=1.108#rev1.108)

*Fri May 20 13:16:54 2005 UTC* (19 years, 8 months ago) by *chs*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.107: [preferred](kernfs_vnops.c.diff?r1=1.107;r2=1.108), [colored](kernfs_vnops.c.diff?r1=1.107;r2=1.108;f=h)

Changes since revision 1.107: +2 -21
lines
```

kernfs does not support mmap(), remove code that pretends that it does.

```

---

Revision **1.106.4.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.106.4.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.106.4.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.106.4.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.106.4.1) - [select for diffs](kernfs_vnops.c?r1=1.106.4.1#rev1.106.4.1)

*Fri Apr 29 11:29:30 2005 UTC* (19 years, 9 months ago) by *kent*

Branches: [kent-audio2](./kernfs_vnops.c?only_with_tag=kent-audio2)

Diff to: previous 1.106: [preferred](kernfs_vnops.c.diff?r1=1.106;r2=1.106.4.1), [colored](kernfs_vnops.c.diff?r1=1.106;r2=1.106.4.1;f=h); next MAIN 1.107: [preferred](kernfs_vnops.c.diff?r1=1.107;r2=1.106.4.1), [colored](kernfs_vnops.c.diff?r1=1.107;r2=1.106.4.1;f=h)

Changes since revision 1.106: +8 -8
lines
```

sync with -current

```

---

Revision **1.106.6.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.106.6.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.106.6.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.106.6.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.106.6.1) - [select for diffs](kernfs_vnops.c?r1=1.106.6.1#rev1.106.6.1)

*Sat Mar 19 08:36:30 2005 UTC* (19 years, 10 months ago) by *yamt*

Branches: [yamt-km](./kernfs_vnops.c?only_with_tag=yamt-km)

Diff to: previous 1.106: [preferred](kernfs_vnops.c.diff?r1=1.106;r2=1.106.6.1), [colored](kernfs_vnops.c.diff?r1=1.106;r2=1.106.6.1;f=h); next MAIN 1.107: [preferred](kernfs_vnops.c.diff?r1=1.107;r2=1.106.6.1), [colored](kernfs_vnops.c.diff?r1=1.107;r2=1.106.6.1;f=h)

Changes since revision 1.106: +8 -8
lines
```

sync with head.  xen and whitespace.  xen part is not finished.

```

---

Revision **1.88.2.8**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.88.2.8;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.88.2.8;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.88.2.8;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.88.2.8) - [select for diffs](kernfs_vnops.c?r1=1.88.2.8#rev1.88.2.8)

*Fri Mar 4 16:52:54 2005 UTC* (19 years, 10 months ago) by *skrll*

Branches: [ktrace-lwp](./kernfs_vnops.c?only_with_tag=ktrace-lwp)

Diff to: previous 1.88.2.7: [preferred](kernfs_vnops.c.diff?r1=1.88.2.7;r2=1.88.2.8), [colored](kernfs_vnops.c.diff?r1=1.88.2.7;r2=1.88.2.8;f=h)

Changes since revision 1.88.2.7: +8 -8
lines
```

Sync with HEAD.

Hi Perry!

```

---

Revision **1.107**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.107;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.107;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.107;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.107) - [select for diffs](kernfs_vnops.c?r1=1.107#rev1.107)

*Sat Feb 26 22:59:00 2005 UTC* (19 years, 11 months ago) by *perry*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-km-base4](./kernfs_vnops.c?only_with_tag=yamt-km-base4),
[yamt-km-base3](./kernfs_vnops.c?only_with_tag=yamt-km-base3),
[netbsd-3-base](./kernfs_vnops.c?only_with_tag=netbsd-3-base),
[kent-audio2-base](./kernfs_vnops.c?only_with_tag=kent-audio2-base)

Branch point for: [netbsd-3](./kernfs_vnops.c?only_with_tag=netbsd-3)

Diff to: previous 1.106: [preferred](kernfs_vnops.c.diff?r1=1.106;r2=1.107), [colored](kernfs_vnops.c.diff?r1=1.106;r2=1.107;f=h)

Changes since revision 1.106: +8 -8
lines
```

nuke trailing whitespace

```

---

Revision **1.88.2.7**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.88.2.7;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.88.2.7;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.88.2.7;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.88.2.7) - [select for diffs](kernfs_vnops.c?r1=1.88.2.7#rev1.88.2.7)

*Sun Oct 31 07:15:21 2004 UTC* (20 years, 2 months ago) by *skrll*

Branches: [ktrace-lwp](./kernfs_vnops.c?only_with_tag=ktrace-lwp)

Diff to: previous 1.88.2.6: [preferred](kernfs_vnops.c.diff?r1=1.88.2.6;r2=1.88.2.7), [colored](kernfs_vnops.c.diff?r1=1.88.2.6;r2=1.88.2.7;f=h)

Changes since revision 1.88.2.6: +2 -1
lines
```

Reduce diff to HEAD.

```

---

Revision **1.106**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.106;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.106;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.106;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.106) - [select for diffs](kernfs_vnops.c?r1=1.106#rev1.106)

*Wed Oct 27 06:55:53 2004 UTC* (20 years, 3 months ago) by *skrll*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [yamt-km-base2](./kernfs_vnops.c?only_with_tag=yamt-km-base2),
[yamt-km-base](./kernfs_vnops.c?only_with_tag=yamt-km-base),
[kent-audio1-beforemerge](./kernfs_vnops.c?only_with_tag=kent-audio1-beforemerge),
[kent-audio1-base](./kernfs_vnops.c?only_with_tag=kent-audio1-base),
[kent-audio1](./kernfs_vnops.c?only_with_tag=kent-audio1)

Branch point for: [yamt-km](./kernfs_vnops.c?only_with_tag=yamt-km),
[kent-audio2](./kernfs_vnops.c?only_with_tag=kent-audio2)

Diff to: previous 1.105: [preferred](kernfs_vnops.c.diff?r1=1.105;r2=1.106), [colored](kernfs_vnops.c.diff?r1=1.105;r2=1.106;f=h)

Changes since revision 1.105: +3 -3
lines
```

Backout previous.

```

---

Revision **1.105**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.105;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.105;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.105;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.105) - [select for diffs](kernfs_vnops.c?r1=1.105#rev1.105)

*Wed Oct 27 06:51:06 2004 UTC* (20 years, 3 months ago) by *skrll*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.104: [preferred](kernfs_vnops.c.diff?r1=1.104;r2=1.105), [colored](kernfs_vnops.c.diff?r1=1.104;r2=1.105;f=h)

Changes since revision 1.104: +3 -3
lines
```

Don't pass &proc0 in the UIO_SYSSPACE case it is not needed.

```

---

Revision **1.88.2.6**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.88.2.6;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.88.2.6;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.88.2.6;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.88.2.6) - [select for diffs](kernfs_vnops.c?r1=1.88.2.6#rev1.88.2.6)

*Wed Oct 27 06:48:24 2004 UTC* (20 years, 3 months ago) by *skrll*

Branches: [ktrace-lwp](./kernfs_vnops.c?only_with_tag=ktrace-lwp)

Diff to: previous 1.88.2.5: [preferred](kernfs_vnops.c.diff?r1=1.88.2.5;r2=1.88.2.6), [colored](kernfs_vnops.c.diff?r1=1.88.2.5;r2=1.88.2.6;f=h)

Changes since revision 1.88.2.5: +9 -9
lines
```

Fix various comments that describe the argument structures

```

---

Revision **1.88.2.5**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.88.2.5;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.88.2.5;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.88.2.5;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.88.2.5) - [select for diffs](kernfs_vnops.c?r1=1.88.2.5#rev1.88.2.5)

*Tue Sep 21 13:36:31 2004 UTC* (20 years, 4 months ago) by *skrll*

Branches: [ktrace-lwp](./kernfs_vnops.c?only_with_tag=ktrace-lwp)

Diff to: previous 1.88.2.4: [preferred](kernfs_vnops.c.diff?r1=1.88.2.4;r2=1.88.2.5), [colored](kernfs_vnops.c.diff?r1=1.88.2.4;r2=1.88.2.5;f=h)

Changes since revision 1.88.2.4: +3 -4
lines
```

Fix the sync with head I botched.

```

---

Revision **1.88.2.4**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.88.2.4;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.88.2.4;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.88.2.4;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.88.2.4) - [select for diffs](kernfs_vnops.c?r1=1.88.2.4#rev1.88.2.4)

*Sat Sep 18 14:54:15 2004 UTC* (20 years, 4 months ago) by *skrll*

Branches: [ktrace-lwp](./kernfs_vnops.c?only_with_tag=ktrace-lwp)

Diff to: previous 1.88.2.3: [preferred](kernfs_vnops.c.diff?r1=1.88.2.3;r2=1.88.2.4), [colored](kernfs_vnops.c.diff?r1=1.88.2.3;r2=1.88.2.4;f=h)

Changes since revision 1.88.2.3: +4 -3
lines
```

Sync with HEAD.

```

---

Revision **1.88.2.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.88.2.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.88.2.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.88.2.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.88.2.3) - [select for diffs](kernfs_vnops.c?r1=1.88.2.3#rev1.88.2.3)

*Tue Aug 24 17:57:40 2004 UTC* (20 years, 5 months ago) by *skrll*

Branches: [ktrace-lwp](./kernfs_vnops.c?only_with_tag=ktrace-lwp)

Diff to: previous 1.88.2.2: [preferred](kernfs_vnops.c.diff?r1=1.88.2.2;r2=1.88.2.3), [colored](kernfs_vnops.c.diff?r1=1.88.2.2;r2=1.88.2.3;f=h)

Changes since revision 1.88.2.2: +3 -3
lines
```

Undo part of the ktrace/lwp changes.  In particular:
* Remove the "lwp *" argument that was added to vget().  Turns out
  that nothing actually used it!
* Remove the "lwp *" arguments that were added to VFS_ROOT(), VFS_VGET(),
  and VFS_FHTOVP(); all they did was pass it to vget() (which, as noted
  above, didn't use it).
* Remove all of the "lwp *" arguments to internal functions that were added
  just to appease the above.

```

---

Revision **1.88.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.88.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.88.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.88.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.88.2.2) - [select for diffs](kernfs_vnops.c?r1=1.88.2.2#rev1.88.2.2)

*Tue Aug 3 10:54:06 2004 UTC* (20 years, 5 months ago) by *skrll*

Branches: [ktrace-lwp](./kernfs_vnops.c?only_with_tag=ktrace-lwp)

Diff to: previous 1.88.2.1: [preferred](kernfs_vnops.c.diff?r1=1.88.2.1;r2=1.88.2.2), [colored](kernfs_vnops.c.diff?r1=1.88.2.1;r2=1.88.2.2;f=h)

Changes since revision 1.88.2.1: +933 -214
lines
```

Sync with HEAD

```

---

Revision **1.98.2.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.3) - [select for diffs](kernfs_vnops.c?r1=1.98.2.3#rev1.98.2.3)

*Sat May 15 13:35:27 2004 UTC* (20 years, 8 months ago) by *tron*

Branches: [netbsd-2-0](./kernfs_vnops.c?only_with_tag=netbsd-2-0)

CVS tags: [netbsd-2-base](./kernfs_vnops.c?only_with_tag=netbsd-2-base),
[netbsd-2-0-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-2-0-RELEASE),
[netbsd-2-0-RC5](./kernfs_vnops.c?only_with_tag=netbsd-2-0-RC5),
[netbsd-2-0-RC4](./kernfs_vnops.c?only_with_tag=netbsd-2-0-RC4),
[netbsd-2-0-RC3](./kernfs_vnops.c?only_with_tag=netbsd-2-0-RC3),
[netbsd-2-0-RC2](./kernfs_vnops.c?only_with_tag=netbsd-2-0-RC2),
[netbsd-2-0-RC1](./kernfs_vnops.c?only_with_tag=netbsd-2-0-RC1),
[netbsd-2-0-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-2-0-2-RELEASE),
[netbsd-2-0-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-2-0-1-RELEASE)

Branch point for: [netbsd-2](./kernfs_vnops.c?only_with_tag=netbsd-2)

Diff to: previous 1.98.2.2: [preferred](kernfs_vnops.c.diff?r1=1.98.2.2;r2=1.98.2.3), [colored](kernfs_vnops.c.diff?r1=1.98.2.2;r2=1.98.2.3;f=h); branchpoint 1.98: [preferred](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.3), [colored](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.3;f=h)

Changes since revision 1.98.2.2: +4 -4
lines
```

Pull up revision 1.104 (requested by cl in ticket #326):
Workaround for gcc 2.95.3 failing to initialize structures
and/or unions inside structures using nested designators.
Should be reverted when gcc >=3.3.3 is ready for vax.

```

---

Revision **1.98.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.2) - [select for diffs](kernfs_vnops.c?r1=1.98.2.2#rev1.98.2.2)

*Sat May 15 13:33:40 2004 UTC* (20 years, 8 months ago) by *tron*

Branches: [netbsd-2-0](./kernfs_vnops.c?only_with_tag=netbsd-2-0)

Diff to: previous 1.98.2.1: [preferred](kernfs_vnops.c.diff?r1=1.98.2.1;r2=1.98.2.2), [colored](kernfs_vnops.c.diff?r1=1.98.2.1;r2=1.98.2.2;f=h); branchpoint 1.98: [preferred](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.2), [colored](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.2;f=h)

Changes since revision 1.98.2.1: +321 -20
lines
```

Pull up revision 1.102 (requested by cl in ticket #336):
Allow additional entries (files, subdirs) in kernfs.  Also allow
defining additional kfstypes and provide hooks to run arbitrary code
for any vnodeop on the additional types.

```

---

Revision **1.98.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98.2.1) - [select for diffs](kernfs_vnops.c?r1=1.98.2.1#rev1.98.2.1)

*Fri May 14 06:31:44 2004 UTC* (20 years, 8 months ago) by *jdc*

Branches: [netbsd-2-0](./kernfs_vnops.c?only_with_tag=netbsd-2-0)

Diff to: previous 1.98: [preferred](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.1), [colored](kernfs_vnops.c.diff?r1=1.98;r2=1.98.2.1;f=h)

Changes since revision 1.98: +93 -35
lines
```

Pull up revision 1.100 and 1.101 (requested by cl in ticket #322).

Find the right entry when doing lookup on dotdot in kern/ipsec subdirs.
Also remove some duplicate code.

Make lookup and readdir return the same inode number.  kernfs_readdir
now uses kernfs_allocvp to map from kernfs entry to inode number,
kernfs_allocvp is now the only place where entries are mapped to inode
numbers.  Also make KERNFS_FILENO not return random results for entries
not in kern_targets.

```

---

Revision **1.104**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.104;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.104;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.104;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.104) - [select for diffs](kernfs_vnops.c?r1=1.104#rev1.104)

*Thu May 13 15:44:04 2004 UTC* (20 years, 8 months ago) by *cl*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.103: [preferred](kernfs_vnops.c.diff?r1=1.103;r2=1.104), [colored](kernfs_vnops.c.diff?r1=1.103;r2=1.104;f=h)

Changes since revision 1.103: +4 -4
lines
```

Workaround for gcc 2.95.3 failing to initialize structures
and/or unions inside structures using nested designators.
Should be reverted when gcc >=3.3.3 is ready for vax.

```

---

Revision **1.103**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.103;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.103;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.103;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.103) - [select for diffs](kernfs_vnops.c?r1=1.103#rev1.103)

*Wed May 12 02:07:37 2004 UTC* (20 years, 8 months ago) by *jrf*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.102: [preferred](kernfs_vnops.c.diff?r1=1.102;r2=1.103), [colored](kernfs_vnops.c.diff?r1=1.102;r2=1.103;f=h)

Changes since revision 1.102: +3 -3
lines
```

caddr_t -> void * and removal of some more casts.

```

---

Revision **1.102**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.102;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.102;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.102;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.102) - [select for diffs](kernfs_vnops.c?r1=1.102#rev1.102)

*Fri May 7 15:33:17 2004 UTC* (20 years, 8 months ago) by *cl*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.101: [preferred](kernfs_vnops.c.diff?r1=1.101;r2=1.102), [colored](kernfs_vnops.c.diff?r1=1.101;r2=1.102;f=h)

Changes since revision 1.101: +321 -20
lines
```

Allow additional entries (files, subdirs) in kernfs.  Also allow
defining additional kfstypes and provide hooks to run arbitrary code
for any vnodeop on the additional types.

```

---

Revision **1.101**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.101;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.101;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.101;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.101) - [select for diffs](kernfs_vnops.c?r1=1.101#rev1.101)

*Fri May 7 15:06:15 2004 UTC* (20 years, 8 months ago) by *cl*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.100: [preferred](kernfs_vnops.c.diff?r1=1.100;r2=1.101), [colored](kernfs_vnops.c.diff?r1=1.100;r2=1.101;f=h)

Changes since revision 1.100: +77 -15
lines
```

Make lookup and readdir return the same inode number.  kernfs_readdir
now uses kernfs_allocvp to map from kernfs entry to inode number,
kernfs_allocvp is now the only place where entries are mapped to inode
numbers.  Also make KERNFS_FILENO not return random results for entries
not in kern_targets.

```

---

Revision **1.100**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.100;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.100;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.100;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.100) - [select for diffs](kernfs_vnops.c?r1=1.100#rev1.100)

*Fri May 7 14:56:48 2004 UTC* (20 years, 8 months ago) by *cl*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.99: [preferred](kernfs_vnops.c.diff?r1=1.99;r2=1.100), [colored](kernfs_vnops.c.diff?r1=1.99;r2=1.100;f=h)

Changes since revision 1.99: +18 -22
lines
```

Find the right entry when doing lookup on dotdot in kern/ipsec subdirs.
Also remove some duplicate code.

```

---

Revision **1.99**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.99;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.99;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.99;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.99) - [select for diffs](kernfs_vnops.c?r1=1.99#rev1.99)

*Thu Apr 29 16:10:55 2004 UTC* (20 years, 9 months ago) by *jrf*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.98: [preferred](kernfs_vnops.c.diff?r1=1.98;r2=1.99), [colored](kernfs_vnops.c.diff?r1=1.98;r2=1.99;f=h)

Changes since revision 1.98: +8 -8
lines
```

Removed remaining caddr_t casts we do not need in miscfs. Recompiled
kernel and ran for a day or so. There are still some caddr_t types in
the arguments of some calls, I will do those separately (later) as
they touch a lot more of the system.
Approved by christos@NetBSD.org.

```

---

Revision **1.98**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.98;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.98;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.98;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.98) - [select for diffs](kernfs_vnops.c?r1=1.98#rev1.98)

*Sat Sep 27 13:29:02 2003 UTC* (21 years, 4 months ago) by *darcy*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [netbsd-2-0-base](./kernfs_vnops.c?only_with_tag=netbsd-2-0-base)

Branch point for: [netbsd-2-0](./kernfs_vnops.c?only_with_tag=netbsd-2-0)

Diff to: previous 1.97: [preferred](kernfs_vnops.c.diff?r1=1.97;r2=1.98), [colored](kernfs_vnops.c.diff?r1=1.97;r2=1.98;f=h)

Changes since revision 1.97: +61 -61
lines
```

Changes as discussed with itojun on tech-kern.  I have modified the enums
to have KFS or PFS differentiators.  Further I have wrapped the enum in
procfs in "#ifdef _KERNEL" as it is done in kernfs.

To see the discussion go to <http://mail-index.NetBSD.org/tech-kern/2003/09/>
and look for "Mismatched enums in include files" in the list.

```

---

Revision **1.97**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.97;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.97;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.97;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.97) - [select for diffs](kernfs_vnops.c?r1=1.97#rev1.97)

*Fri Sep 26 03:08:18 2003 UTC* (21 years, 4 months ago) by *atatat*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.96: [preferred](kernfs_vnops.c.diff?r1=1.96;r2=1.97), [colored](kernfs_vnops.c.diff?r1=1.96;r2=1.97;f=h)

Changes since revision 1.96: +61 -61
lines
```

Make kernfs peacefully co-exist with procfs.

```

---

Revision **1.96**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.96;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.96;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.96;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.96) - [select for diffs](kernfs_vnops.c?r1=1.96#rev1.96)

*Wed Sep 10 10:22:45 2003 UTC* (21 years, 4 months ago) by *itojun*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.95: [preferred](kernfs_vnops.c.diff?r1=1.95;r2=1.96), [colored](kernfs_vnops.c.diff?r1=1.95;r2=1.96;f=h)

Changes since revision 1.95: +3 -3
lines
```

check before deref kfs_kt

```

---

Revision **1.95**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.95;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.95;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.95;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.95) - [select for diffs](kernfs_vnops.c?r1=1.95#rev1.95)

*Wed Sep 10 09:59:47 2003 UTC* (21 years, 4 months ago) by *dan*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.94: [preferred](kernfs_vnops.c.diff?r1=1.94;r2=1.95), [colored](kernfs_vnops.c.diff?r1=1.94;r2=1.95;f=h)

Changes since revision 1.94: +7 -3
lines
```

Make /kern/. have linkcount 2 in non-IPSEC case, 4 in IPSEC case.
Thanks to Valeriy E. Ushakov.

```

---

Revision **1.94**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.94;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.94;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.94;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.94) - [select for diffs](kernfs_vnops.c?r1=1.94#rev1.94)

*Wed Sep 10 03:56:33 2003 UTC* (21 years, 4 months ago) by *itojun*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.93: [preferred](kernfs_vnops.c.diff?r1=1.93;r2=1.94), [colored](kernfs_vnops.c.diff?r1=1.93;r2=1.94;f=h)

Changes since revision 1.93: +10 -2
lines
```

check if rootdev/rrootdev actually exists.

```

---

Revision **1.93**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.93;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.93;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.93;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.93) - [select for diffs](kernfs_vnops.c?r1=1.93#rev1.93)

*Wed Sep 10 03:24:38 2003 UTC* (21 years, 4 months ago) by *simonb*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.92: [preferred](kernfs_vnops.c.diff?r1=1.92;r2=1.93), [colored](kernfs_vnops.c.diff?r1=1.92;r2=1.93;f=h)

Changes since revision 1.92: +3 -3
lines
```

8 spaces is evil, convert to tab.

```

---

Revision **1.92**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.92;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.92;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.92;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.92) - [select for diffs](kernfs_vnops.c?r1=1.92#rev1.92)

*Wed Sep 10 00:45:22 2003 UTC* (21 years, 4 months ago) by *dan*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.91: [preferred](kernfs_vnops.c.diff?r1=1.91;r2=1.92), [colored](kernfs_vnops.c.diff?r1=1.91;r2=1.92;f=h)

Changes since revision 1.91: +10 -4
lines
```

Make vnode times on /kern/boottime be the boot time, not "now".

Handy because [ls(1)](http://man.NetBSD.org/ls.1) helpfully converts the time to human-readable
format when printing, and because shell tools like "test -nt" and
"find -newer" can be used against it.

"Inspired" by a discussion about removing lockfiles older than the
last reboot, and Al Crooks' handy observation that a close
approximation can be found with /var/run/dmesg.boot

While here, notice that a lot of the kernfs structures and naming
changed suddenly, and though it seems a clear improvement, there was no
mention in commit logs.

```

---

Revision **1.91**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.91;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.91;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.91;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.91) - [select for diffs](kernfs_vnops.c?r1=1.91#rev1.91)

*Mon Sep 8 10:54:14 2003 UTC* (21 years, 4 months ago) by *itojun*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.90: [preferred](kernfs_vnops.c.diff?r1=1.90;r2=1.91), [colored](kernfs_vnops.c.diff?r1=1.90;r2=1.91;f=h)

Changes since revision 1.90: +3 -5
lines
```

remove non-precise comment

```

---

Revision **1.90**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.90;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.90;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.90;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.90) - [select for diffs](kernfs_vnops.c?r1=1.90#rev1.90)

*Mon Sep 8 06:51:54 2003 UTC* (21 years, 4 months ago) by *itojun*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.89: [preferred](kernfs_vnops.c.diff?r1=1.89;r2=1.90), [colored](kernfs_vnops.c.diff?r1=1.89;r2=1.90;f=h)

Changes since revision 1.89: +552 -203
lines
```

add /kern/ipsecsa and /kern/ipsecsp, which can be inspected by [setkey(8)](http://man.NetBSD.org/setkey.8).
it allows easier access to ipsecsa/sp.  it works around problem where
setkey -D does not work with large number of ipsec SAs due to socket buffer
size.

```

---

Revision **1.89**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.89;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.89;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.89;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.89) - [select for diffs](kernfs_vnops.c?r1=1.89#rev1.89)

*Thu Aug 7 16:32:37 2003 UTC* (21 years, 5 months ago) by *agc*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.88: [preferred](kernfs_vnops.c.diff?r1=1.88;r2=1.89), [colored](kernfs_vnops.c.diff?r1=1.88;r2=1.89;f=h)

Changes since revision 1.88: +3 -7
lines
```

Move UCB-licensed code from 4-clause to 3-clause licence.

Patches provided by Joel Baker in PR [22364](http://gnats.NetBSD.org/22364), verified by myself.

```

---

Revision **1.88.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.88.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.88.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.88.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.88.2.1) - [select for diffs](kernfs_vnops.c?r1=1.88.2.1#rev1.88.2.1)

*Wed Jul 2 15:26:51 2003 UTC* (21 years, 6 months ago) by *darrenr*

Branches: [ktrace-lwp](./kernfs_vnops.c?only_with_tag=ktrace-lwp)

Diff to: previous 1.88: [preferred](kernfs_vnops.c.diff?r1=1.88;r2=1.88.2.1), [colored](kernfs_vnops.c.diff?r1=1.88;r2=1.88.2.1;f=h)

Changes since revision 1.88: +3 -3
lines
```

Apply the aborted ktrace-lwp changes to a specific branch.  This is just for
others to review, I'm concerned that patch fuziness may have resulted in some
errant code being generated but I'll look at that later by comparing the diff
from the base to the branch with the file I attempt to apply to it.  This will,
at the very least, put the changes in a better context for others to review
them and attempt to tinker with removing passing of 'struct lwp' through
the kernel.

```

---

Revision **1.88**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.88;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.88;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.88;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.88) - [select for diffs](kernfs_vnops.c?r1=1.88#rev1.88)

*Sun Jun 29 22:31:41 2003 UTC* (21 years, 7 months ago) by *fvdl*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Branch point for: [ktrace-lwp](./kernfs_vnops.c?only_with_tag=ktrace-lwp)

Diff to: previous 1.87: [preferred](kernfs_vnops.c.diff?r1=1.87;r2=1.88), [colored](kernfs_vnops.c.diff?r1=1.87;r2=1.88;f=h)

Changes since revision 1.87: +2 -2
lines
```

Back out the lwp/ktrace changes. They contained a lot of colateral damage,
and need to be examined and discussed more.

```

---

Revision **1.87**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.87;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.87;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.87;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.87) - [select for diffs](kernfs_vnops.c?r1=1.87#rev1.87)

*Sun Jun 29 18:43:33 2003 UTC* (21 years, 7 months ago) by *thorpej*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.86: [preferred](kernfs_vnops.c.diff?r1=1.86;r2=1.87), [colored](kernfs_vnops.c.diff?r1=1.86;r2=1.87;f=h)

Changes since revision 1.86: +3 -3
lines
```

Undo part of the ktrace/lwp changes.  In particular:
* Remove the "lwp *" argument that was added to vget().  Turns out
  that nothing actually used it!
* Remove the "lwp *" arguments that were added to VFS_ROOT(), VFS_VGET(),
  and VFS_FHTOVP(); all they did was pass it to vget() (which, as noted
  above, didn't use it).
* Remove all of the "lwp *" arguments to internal functions that were added
  just to appease the above.

```

---

Revision **1.86**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.86;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.86;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.86;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.86) - [select for diffs](kernfs_vnops.c?r1=1.86#rev1.86)

*Sat Jun 28 14:22:02 2003 UTC* (21 years, 7 months ago) by *darrenr*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.85: [preferred](kernfs_vnops.c.diff?r1=1.85;r2=1.86), [colored](kernfs_vnops.c.diff?r1=1.85;r2=1.86;f=h)

Changes since revision 1.85: +3 -3
lines
```

Pass lwp pointers throughtout the kernel, as required, so that the lwpid can
be inserted into ktrace records.  The general change has been to replace
"struct proc *" with "struct lwp *" in various function prototypes, pass
the lwp through and use l_proc to get the process pointer when needed.

Bump the kernel rev up to 1.6V

```

---

Revision **1.85**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.85;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.85;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.85;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.85) - [select for diffs](kernfs_vnops.c?r1=1.85#rev1.85)

*Thu Apr 10 21:53:33 2003 UTC* (21 years, 9 months ago) by *jdolecek*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.84: [preferred](kernfs_vnops.c.diff?r1=1.84;r2=1.85), [colored](kernfs_vnops.c.diff?r1=1.84;r2=1.85;f=h)

Changes since revision 1.84: +8 -8
lines
```

use former genfs_eopnotsupp_rele() as genfs_eopnotsupp(), so that vnodes
are vput()/vrele()d as necessary - some filesystems did use the wrong
one for some ops, and it's just safer to not take the chance

based on suggestion by Bill Studenmund

```

---

Revision **1.75.2.6**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.75.2.6;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.75.2.6;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.75.2.6;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.75.2.6) - [select for diffs](kernfs_vnops.c?r1=1.75.2.6#rev1.75.2.6)

*Fri Oct 18 02:45:04 2002 UTC* (22 years, 3 months ago) by *nathanw*

Branches: [nathanw\_sa](./kernfs_vnops.c?only_with_tag=nathanw_sa)

CVS tags: [nathanw\_sa\_end](./kernfs_vnops.c?only_with_tag=nathanw_sa_end)

Diff to: previous 1.75.2.5: [preferred](kernfs_vnops.c.diff?r1=1.75.2.5;r2=1.75.2.6), [colored](kernfs_vnops.c.diff?r1=1.75.2.5;r2=1.75.2.6;f=h); branchpoint 1.75: [preferred](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.6), [colored](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.6;f=h); next MAIN 1.76: [preferred](kernfs_vnops.c.diff?r1=1.76;r2=1.75.2.6), [colored](kernfs_vnops.c.diff?r1=1.76;r2=1.75.2.6;f=h)

Changes since revision 1.75.2.5: +9 -5
lines
```

Catch up to -current.

```

---

Revision **1.79.10.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.79.10.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.79.10.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.79.10.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.79.10.2) - [select for diffs](kernfs_vnops.c?r1=1.79.10.2#rev1.79.10.2)

*Mon Oct 14 00:06:29 2002 UTC* (22 years, 3 months ago) by *lukem*

Branches: [netbsd-1-6](./kernfs_vnops.c?only_with_tag=netbsd-1-6)

CVS tags: [netbsd-1-6-PATCH002-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-1-6-PATCH002-RELEASE),
[netbsd-1-6-PATCH002-RC4](./kernfs_vnops.c?only_with_tag=netbsd-1-6-PATCH002-RC4),
[netbsd-1-6-PATCH002-RC3](./kernfs_vnops.c?only_with_tag=netbsd-1-6-PATCH002-RC3),
[netbsd-1-6-PATCH002-RC2](./kernfs_vnops.c?only_with_tag=netbsd-1-6-PATCH002-RC2),
[netbsd-1-6-PATCH002-RC1](./kernfs_vnops.c?only_with_tag=netbsd-1-6-PATCH002-RC1),
[netbsd-1-6-PATCH002](./kernfs_vnops.c?only_with_tag=netbsd-1-6-PATCH002),
[netbsd-1-6-PATCH001-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-1-6-PATCH001-RELEASE),
[netbsd-1-6-PATCH001-RC3](./kernfs_vnops.c?only_with_tag=netbsd-1-6-PATCH001-RC3),
[netbsd-1-6-PATCH001-RC2](./kernfs_vnops.c?only_with_tag=netbsd-1-6-PATCH001-RC2),
[netbsd-1-6-PATCH001-RC1](./kernfs_vnops.c?only_with_tag=netbsd-1-6-PATCH001-RC1),
[netbsd-1-6-PATCH001](./kernfs_vnops.c?only_with_tag=netbsd-1-6-PATCH001)

Diff to: previous 1.79.10.1: [preferred](kernfs_vnops.c.diff?r1=1.79.10.1;r2=1.79.10.2), [colored](kernfs_vnops.c.diff?r1=1.79.10.1;r2=1.79.10.2;f=h); branchpoint 1.79: [preferred](kernfs_vnops.c.diff?r1=1.79;r2=1.79.10.2), [colored](kernfs_vnops.c.diff?r1=1.79;r2=1.79.10.2;f=h)

Changes since revision 1.79.10.1: +11 -7
lines
```

Pull up revision 1.84 (requested by jdolecek in ticket #911):
put back the while loop in kernfs_getattr() removed in rev 1.82; it's
necessary to get the whole file length e.g. for msgbuf
this fixes the '/kern/msgbuf & less' problem reported on port-i386
by Dave Tyson

```

---

Revision **1.84**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.84;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.84;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.84;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.84) - [select for diffs](kernfs_vnops.c?r1=1.84#rev1.84)

*Sat Oct 12 14:04:45 2002 UTC* (22 years, 3 months ago) by *jdolecek*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [nathanw\_sa\_before\_merge](./kernfs_vnops.c?only_with_tag=nathanw_sa_before_merge),
[nathanw\_sa\_base](./kernfs_vnops.c?only_with_tag=nathanw_sa_base),
[kqueue-beforemerge](./kernfs_vnops.c?only_with_tag=kqueue-beforemerge),
[kqueue-aftermerge](./kernfs_vnops.c?only_with_tag=kqueue-aftermerge),
[gmcgarry\_ucred\_base](./kernfs_vnops.c?only_with_tag=gmcgarry_ucred_base),
[gmcgarry\_ucred](./kernfs_vnops.c?only_with_tag=gmcgarry_ucred),
[gmcgarry\_ctxsw\_base](./kernfs_vnops.c?only_with_tag=gmcgarry_ctxsw_base),
[gmcgarry\_ctxsw](./kernfs_vnops.c?only_with_tag=gmcgarry_ctxsw),
[fvdl\_fs64\_base](./kernfs_vnops.c?only_with_tag=fvdl_fs64_base)

Diff to: previous 1.83: [preferred](kernfs_vnops.c.diff?r1=1.83;r2=1.84), [colored](kernfs_vnops.c.diff?r1=1.83;r2=1.84;f=h)

Changes since revision 1.83: +11 -7
lines
```

put back the while loop in kernfs_getattr() removed in rev 1.82; it's
necessary to get the whole file length e.g. for msgbuf

this fixes the '/kern/msgbuf & less' problem reported on port-i386
by Dave Tyson

```

---

Revision **1.76.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.76.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.76.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.76.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.76.2.2) - [select for diffs](kernfs_vnops.c?r1=1.76.2.2#rev1.76.2.2)

*Fri Sep 6 08:48:36 2002 UTC* (22 years, 4 months ago) by *jdolecek*

Branches: [kqueue](./kernfs_vnops.c?only_with_tag=kqueue)

Diff to: previous 1.76.2.1: [preferred](kernfs_vnops.c.diff?r1=1.76.2.1;r2=1.76.2.2), [colored](kernfs_vnops.c.diff?r1=1.76.2.1;r2=1.76.2.2;f=h); branchpoint 1.76: [preferred](kernfs_vnops.c.diff?r1=1.76;r2=1.76.2.2), [colored](kernfs_vnops.c.diff?r1=1.76;r2=1.76.2.2;f=h); next MAIN 1.77: [preferred](kernfs_vnops.c.diff?r1=1.77;r2=1.76.2.2), [colored](kernfs_vnops.c.diff?r1=1.77;r2=1.76.2.2;f=h)

Changes since revision 1.76.2.1: +41 -38
lines
```

sync kqueue branch with HEAD

```

---

Revision **1.79.8.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.79.8.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.79.8.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.79.8.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.79.8.3) - [select for diffs](kernfs_vnops.c?r1=1.79.8.3#rev1.79.8.3)

*Thu Aug 29 05:23:22 2002 UTC* (22 years, 5 months ago) by *gehenna*

Branches: [gehenna-devsw](./kernfs_vnops.c?only_with_tag=gehenna-devsw)

Diff to: previous 1.79.8.2: [preferred](kernfs_vnops.c.diff?r1=1.79.8.2;r2=1.79.8.3), [colored](kernfs_vnops.c.diff?r1=1.79.8.2;r2=1.79.8.3;f=h); branchpoint 1.79: [preferred](kernfs_vnops.c.diff?r1=1.79;r2=1.79.8.3), [colored](kernfs_vnops.c.diff?r1=1.79;r2=1.79.8.3;f=h); next MAIN 1.80: [preferred](kernfs_vnops.c.diff?r1=1.80;r2=1.79.8.3), [colored](kernfs_vnops.c.diff?r1=1.80;r2=1.79.8.3;f=h)

Changes since revision 1.79.8.2: +6 -6
lines
```

catch up with -current.

```

---

Revision **1.75.2.5**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.75.2.5;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.75.2.5;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.75.2.5;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.75.2.5) - [select for diffs](kernfs_vnops.c?r1=1.75.2.5#rev1.75.2.5)

*Tue Aug 13 02:20:09 2002 UTC* (22 years, 5 months ago) by *nathanw*

Branches: [nathanw\_sa](./kernfs_vnops.c?only_with_tag=nathanw_sa)

Diff to: previous 1.75.2.4: [preferred](kernfs_vnops.c.diff?r1=1.75.2.4;r2=1.75.2.5), [colored](kernfs_vnops.c.diff?r1=1.75.2.4;r2=1.75.2.5;f=h); branchpoint 1.75: [preferred](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.5), [colored](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.5;f=h)

Changes since revision 1.75.2.4: +4 -4
lines
```

Catch up to -current.

```

---

Revision **1.83**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.83;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.83;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.83;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.83) - [select for diffs](kernfs_vnops.c?r1=1.83#rev1.83)

*Sat Aug 3 04:52:44 2002 UTC* (22 years, 5 months ago) by *simonb*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [kqueue-base](./kernfs_vnops.c?only_with_tag=kqueue-base),
[gehenna-devsw-base](./kernfs_vnops.c?only_with_tag=gehenna-devsw-base)

Diff to: previous 1.82: [preferred](kernfs_vnops.c.diff?r1=1.82;r2=1.83), [colored](kernfs_vnops.c.diff?r1=1.82;r2=1.83;f=h)

Changes since revision 1.82: +6 -6
lines
```

Just use the "time" variable in the *_getattr functions instead of a call
to (the potentially expensive) microtime().

```

---

Revision **1.75.2.4**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.75.2.4;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.75.2.4;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.75.2.4;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.75.2.4) - [select for diffs](kernfs_vnops.c?r1=1.75.2.4#rev1.75.2.4)

*Thu Aug 1 02:46:31 2002 UTC* (22 years, 6 months ago) by *nathanw*

Branches: [nathanw\_sa](./kernfs_vnops.c?only_with_tag=nathanw_sa)

Diff to: previous 1.75.2.3: [preferred](kernfs_vnops.c.diff?r1=1.75.2.3;r2=1.75.2.4), [colored](kernfs_vnops.c.diff?r1=1.75.2.3;r2=1.75.2.4;f=h); branchpoint 1.75: [preferred](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.4), [colored](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.4;f=h)

Changes since revision 1.75.2.3: +39 -36
lines
```

Catch up to -current.

```

---

Revision **1.79.10.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.79.10.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.79.10.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.79.10.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.79.10.1) - [select for diffs](kernfs_vnops.c?r1=1.79.10.1#rev1.79.10.1)

*Sun Jul 21 00:52:37 2002 UTC* (22 years, 6 months ago) by *lukem*

Branches: [netbsd-1-6](./kernfs_vnops.c?only_with_tag=netbsd-1-6)

CVS tags: [netbsd-1-6-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-1-6-RELEASE),
[netbsd-1-6-RC3](./kernfs_vnops.c?only_with_tag=netbsd-1-6-RC3),
[netbsd-1-6-RC2](./kernfs_vnops.c?only_with_tag=netbsd-1-6-RC2),
[netbsd-1-6-RC1](./kernfs_vnops.c?only_with_tag=netbsd-1-6-RC1)

Diff to: previous 1.79: [preferred](kernfs_vnops.c.diff?r1=1.79;r2=1.79.10.1), [colored](kernfs_vnops.c.diff?r1=1.79;r2=1.79.10.1;f=h)

Changes since revision 1.79: +34 -33
lines
```

Pull up revision 1.82 (requested by jdolocek in ticket #526):
Properly detect error in kernfs_xread().
Fixes [kern/10278](http://gnats.NetBSD.org/10278) by IWAMOTO Toshihiro, though implemented different way.
While here, clean up some int vs. size_t confusion, make
kernfs_x{read|write}() static and g/c some #if 0 stuff.

```

---

Revision **1.79.8.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.79.8.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.79.8.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.79.8.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.79.8.2) - [select for diffs](kernfs_vnops.c?r1=1.79.8.2#rev1.79.8.2)

*Sat Jul 20 11:35:12 2002 UTC* (22 years, 6 months ago) by *gehenna*

Branches: [gehenna-devsw](./kernfs_vnops.c?only_with_tag=gehenna-devsw)

Diff to: previous 1.79.8.1: [preferred](kernfs_vnops.c.diff?r1=1.79.8.1;r2=1.79.8.2), [colored](kernfs_vnops.c.diff?r1=1.79.8.1;r2=1.79.8.2;f=h); branchpoint 1.79: [preferred](kernfs_vnops.c.diff?r1=1.79;r2=1.79.8.2), [colored](kernfs_vnops.c.diff?r1=1.79;r2=1.79.8.2;f=h)

Changes since revision 1.79.8.1: +34 -33
lines
```

catch up with -current.

```

---

Revision **1.82**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.82;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.82;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.82;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.82) - [select for diffs](kernfs_vnops.c?r1=1.82#rev1.82)

*Fri Jul 19 18:35:44 2002 UTC* (22 years, 6 months ago) by *jdolecek*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.81: [preferred](kernfs_vnops.c.diff?r1=1.81;r2=1.82), [colored](kernfs_vnops.c.diff?r1=1.81;r2=1.82;f=h)

Changes since revision 1.81: +34 -33
lines
```

Properly detect error in kernfs_xread().
Fixes [kern/10278](http://gnats.NetBSD.org/10278) by IWAMOTO Toshihiro, though implemented different way.

While here, clean up some int vs. size_t confusion, make
kernfs_x{read|write}() static and g/c some #if 0 stuff.

```

---

Revision **1.79.8.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.79.8.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.79.8.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.79.8.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.79.8.1) - [select for diffs](kernfs_vnops.c?r1=1.79.8.1#rev1.79.8.1)

*Mon Jul 15 10:36:45 2002 UTC* (22 years, 6 months ago) by *gehenna*

Branches: [gehenna-devsw](./kernfs_vnops.c?only_with_tag=gehenna-devsw)

Diff to: previous 1.79: [preferred](kernfs_vnops.c.diff?r1=1.79;r2=1.79.8.1), [colored](kernfs_vnops.c.diff?r1=1.79;r2=1.79.8.1;f=h)

Changes since revision 1.79: +7 -5
lines
```

catch up with -current.

```

---

Revision **1.81**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.81;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.81;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.81;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.81) - [select for diffs](kernfs_vnops.c?r1=1.81#rev1.81)

*Fri Jul 5 03:24:06 2002 UTC* (22 years, 6 months ago) by *lukem*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.80: [preferred](kernfs_vnops.c.diff?r1=1.80;r2=1.81), [colored](kernfs_vnops.c.diff?r1=1.80;r2=1.81;f=h)

Changes since revision 1.80: +7 -5
lines
```

be consistent about how va_[acm]time is set to the current time
(inspired by how procfs does it)

```

---

Revision **1.80**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.80;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.80;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.80;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.80) - [select for diffs](kernfs_vnops.c?r1=1.80#rev1.80)

*Fri Jul 5 02:02:00 2002 UTC* (22 years, 6 months ago) by *lukem*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.79: [preferred](kernfs_vnops.c.diff?r1=1.79;r2=1.80), [colored](kernfs_vnops.c.diff?r1=1.79;r2=1.80;f=h)

Changes since revision 1.79: +3 -3
lines
```

set vap->va_ctime to vap->va_atime (the current time),
rather than vap->va_ctime (which is a no-op).

```

---

Revision **1.76.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.76.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.76.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.76.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.76.2.1) - [select for diffs](kernfs_vnops.c?r1=1.76.2.1#rev1.76.2.1)

*Thu Jan 10 20:01:37 2002 UTC* (23 years ago) by *thorpej*

Branches: [kqueue](./kernfs_vnops.c?only_with_tag=kqueue)

Diff to: previous 1.76: [preferred](kernfs_vnops.c.diff?r1=1.76;r2=1.76.2.1), [colored](kernfs_vnops.c.diff?r1=1.76;r2=1.76.2.1;f=h)

Changes since revision 1.76: +6 -2
lines
```

Sync kqueue branch with -current.

```

---

Revision **1.75.2.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.75.2.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.75.2.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.75.2.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.75.2.3) - [select for diffs](kernfs_vnops.c?r1=1.75.2.3#rev1.75.2.3)

*Tue Jan 8 00:33:37 2002 UTC* (23 years ago) by *nathanw*

Branches: [nathanw\_sa](./kernfs_vnops.c?only_with_tag=nathanw_sa)

Diff to: previous 1.75.2.2: [preferred](kernfs_vnops.c.diff?r1=1.75.2.2;r2=1.75.2.3), [colored](kernfs_vnops.c.diff?r1=1.75.2.2;r2=1.75.2.3;f=h); branchpoint 1.75: [preferred](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.3), [colored](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.3;f=h)

Changes since revision 1.75.2.2: +4 -3
lines
```

Catch up to -current.

```

---

Revision **1.79**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.79;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.79;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.79;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.79) - [select for diffs](kernfs_vnops.c?r1=1.79#rev1.79)

*Thu Dec 6 04:27:42 2001 UTC* (23 years, 1 month ago) by *chs*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [newlock-base](./kernfs_vnops.c?only_with_tag=newlock-base),
[newlock](./kernfs_vnops.c?only_with_tag=newlock),
[netbsd-1-6-base](./kernfs_vnops.c?only_with_tag=netbsd-1-6-base),
[ifpoll-base](./kernfs_vnops.c?only_with_tag=ifpoll-base),
[eeh-devprop-base](./kernfs_vnops.c?only_with_tag=eeh-devprop-base),
[eeh-devprop](./kernfs_vnops.c?only_with_tag=eeh-devprop)

Branch point for: [netbsd-1-6](./kernfs_vnops.c?only_with_tag=netbsd-1-6),
[gehenna-devsw](./kernfs_vnops.c?only_with_tag=gehenna-devsw)

Diff to: previous 1.78: [preferred](kernfs_vnops.c.diff?r1=1.78;r2=1.79), [colored](kernfs_vnops.c.diff?r1=1.78;r2=1.79;f=h)

Changes since revision 1.78: +4 -2
lines
```

add a VOP_PUTPAGES method for all the filesystems that don't have pages,
just unlock the interlock.

```

---

Revision **1.78**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.78;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.78;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.78;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.78) - [select for diffs](kernfs_vnops.c?r1=1.78#rev1.78)

*Thu Nov 15 09:48:22 2001 UTC* (23 years, 2 months ago) by *lukem*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.77: [preferred](kernfs_vnops.c.diff?r1=1.77;r2=1.78), [colored](kernfs_vnops.c.diff?r1=1.77;r2=1.78;f=h)

Changes since revision 1.77: +2 -3
lines
```

don't need <sys/types.h> when including <sys/param.h>

```

---

Revision **1.75.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.75.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.75.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.75.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.75.2.2) - [select for diffs](kernfs_vnops.c?r1=1.75.2.2#rev1.75.2.2)

*Wed Nov 14 19:17:09 2001 UTC* (23 years, 2 months ago) by *nathanw*

Branches: [nathanw\_sa](./kernfs_vnops.c?only_with_tag=nathanw_sa)

Diff to: previous 1.75.2.1: [preferred](kernfs_vnops.c.diff?r1=1.75.2.1;r2=1.75.2.2), [colored](kernfs_vnops.c.diff?r1=1.75.2.1;r2=1.75.2.2;f=h); branchpoint 1.75: [preferred](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.2), [colored](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.2;f=h)

Changes since revision 1.75.2.1: +4 -1
lines
```

Catch up to -current.

```

---

Revision **1.76.6.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.76.6.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.76.6.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.76.6.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.76.6.1) - [select for diffs](kernfs_vnops.c?r1=1.76.6.1#rev1.76.6.1)

*Mon Nov 12 21:19:10 2001 UTC* (23 years, 2 months ago) by *thorpej*

Branches: [thorpej-mips-cache](./kernfs_vnops.c?only_with_tag=thorpej-mips-cache)

Diff to: previous 1.76: [preferred](kernfs_vnops.c.diff?r1=1.76;r2=1.76.6.1), [colored](kernfs_vnops.c.diff?r1=1.76;r2=1.76.6.1;f=h); next MAIN 1.77: [preferred](kernfs_vnops.c.diff?r1=1.77;r2=1.76.6.1), [colored](kernfs_vnops.c.diff?r1=1.77;r2=1.76.6.1;f=h)

Changes since revision 1.76: +4 -1
lines
```

Sync the thorpej-mips-cache branch with -current.

```

---

Revision **1.77**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.77;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.77;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.77;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.77) - [select for diffs](kernfs_vnops.c?r1=1.77#rev1.77)

*Sat Nov 10 13:33:42 2001 UTC* (23 years, 2 months ago) by *lukem*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [thorpej-mips-cache-base](./kernfs_vnops.c?only_with_tag=thorpej-mips-cache-base)

Diff to: previous 1.76: [preferred](kernfs_vnops.c.diff?r1=1.76;r2=1.77), [colored](kernfs_vnops.c.diff?r1=1.76;r2=1.77;f=h)

Changes since revision 1.76: +4 -1
lines
```

add RCSIDs

```

---

Revision **1.75.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.75.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.75.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.75.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.75.2.1) - [select for diffs](kernfs_vnops.c?r1=1.75.2.1#rev1.75.2.1)

*Thu Jun 21 20:07:37 2001 UTC* (23 years, 7 months ago) by *nathanw*

Branches: [nathanw\_sa](./kernfs_vnops.c?only_with_tag=nathanw_sa)

Diff to: previous 1.75: [preferred](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.1), [colored](kernfs_vnops.c.diff?r1=1.75;r2=1.75.2.1;f=h)

Changes since revision 1.75: +2 -4
lines
```

Catch up to -current.

```

---

Revision **1.76**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.76;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.76;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.76;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.76) - [select for diffs](kernfs_vnops.c?r1=1.76#rev1.76)

*Sun Jun 3 02:23:31 2001 UTC* (23 years, 7 months ago) by *chs*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [thorpej-devvp-base3](./kernfs_vnops.c?only_with_tag=thorpej-devvp-base3),
[thorpej-devvp-base2](./kernfs_vnops.c?only_with_tag=thorpej-devvp-base2),
[thorpej-devvp-base](./kernfs_vnops.c?only_with_tag=thorpej-devvp-base),
[thorpej-devvp](./kernfs_vnops.c?only_with_tag=thorpej-devvp),
[pre-chs-ubcperf](./kernfs_vnops.c?only_with_tag=pre-chs-ubcperf),
[post-chs-ubcperf](./kernfs_vnops.c?only_with_tag=post-chs-ubcperf)

Branch point for: [thorpej-mips-cache](./kernfs_vnops.c?only_with_tag=thorpej-mips-cache),
[kqueue](./kernfs_vnops.c?only_with_tag=kqueue)

Diff to: previous 1.75: [preferred](kernfs_vnops.c.diff?r1=1.75;r2=1.76), [colored](kernfs_vnops.c.diff?r1=1.75;r2=1.76;f=h)

Changes since revision 1.75: +2 -4
lines
```

let kernfs_mmap() use the default error method.

```

---

Revision **1.67.2.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.67.2.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.67.2.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.67.2.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.67.2.3) - [select for diffs](kernfs_vnops.c?r1=1.67.2.3#rev1.67.2.3)

*Mon Mar 12 13:31:45 2001 UTC* (23 years, 10 months ago) by *bouyer*

Branches: [thorpej\_scsipi](./kernfs_vnops.c?only_with_tag=thorpej_scsipi)

Diff to: previous 1.67.2.2: [preferred](kernfs_vnops.c.diff?r1=1.67.2.2;r2=1.67.2.3), [colored](kernfs_vnops.c.diff?r1=1.67.2.2;r2=1.67.2.3;f=h); branchpoint 1.67: [preferred](kernfs_vnops.c.diff?r1=1.67;r2=1.67.2.3), [colored](kernfs_vnops.c.diff?r1=1.67;r2=1.67.2.3;f=h); next MAIN 1.68: [preferred](kernfs_vnops.c.diff?r1=1.68;r2=1.67.2.3), [colored](kernfs_vnops.c.diff?r1=1.68;r2=1.67.2.3;f=h)

Changes since revision 1.67.2.2: +12 -12
lines
```

Sync with HEAD.

```

---

Revision **1.75**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.75;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.75;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.75;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.75) - [select for diffs](kernfs_vnops.c?r1=1.75#rev1.75)

*Wed Feb 21 21:39:54 2001 UTC* (23 years, 11 months ago) by *jdolecek*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [thorpej\_scsipi\_nbase](./kernfs_vnops.c?only_with_tag=thorpej_scsipi_nbase),
[thorpej\_scsipi\_beforemerge](./kernfs_vnops.c?only_with_tag=thorpej_scsipi_beforemerge),
[thorpej\_scsipi\_base](./kernfs_vnops.c?only_with_tag=thorpej_scsipi_base)

Branch point for: [nathanw\_sa](./kernfs_vnops.c?only_with_tag=nathanw_sa)

Diff to: previous 1.74: [preferred](kernfs_vnops.c.diff?r1=1.74;r2=1.75), [colored](kernfs_vnops.c.diff?r1=1.74;r2=1.75;f=h)

Changes since revision 1.74: +12 -12
lines
```

make some more constant arrays 'const'

```

---

Revision **1.67.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.67.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.67.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.67.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.67.2.2) - [select for diffs](kernfs_vnops.c?r1=1.67.2.2#rev1.67.2.2)

*Sun Feb 11 19:16:59 2001 UTC* (23 years, 11 months ago) by *bouyer*

Branches: [thorpej\_scsipi](./kernfs_vnops.c?only_with_tag=thorpej_scsipi)

Diff to: previous 1.67.2.1: [preferred](kernfs_vnops.c.diff?r1=1.67.2.1;r2=1.67.2.2), [colored](kernfs_vnops.c.diff?r1=1.67.2.1;r2=1.67.2.2;f=h); branchpoint 1.67: [preferred](kernfs_vnops.c.diff?r1=1.67;r2=1.67.2.2), [colored](kernfs_vnops.c.diff?r1=1.67;r2=1.67.2.2;f=h)

Changes since revision 1.67.2.1: +4 -4
lines
```

Sync with HEAD.

```

---

Revision **1.74**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.74;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.74;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.74;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.74) - [select for diffs](kernfs_vnops.c?r1=1.74#rev1.74)

*Sun Feb 4 10:20:00 2001 UTC* (23 years, 11 months ago) by *mrg*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.73: [preferred](kernfs_vnops.c.diff?r1=1.73;r2=1.74), [colored](kernfs_vnops.c.diff?r1=1.73;r2=1.74;f=h)

Changes since revision 1.73: +2 -2
lines
```

clean up some KERNFS_DIAGNOSTIC calls.

```

---

Revision **1.73**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.73;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.73;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.73;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.73) - [select for diffs](kernfs_vnops.c?r1=1.73#rev1.73)

*Sat Jan 27 12:28:35 2001 UTC* (24 years ago) by *jdolecek*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.72: [preferred](kernfs_vnops.c.diff?r1=1.72;r2=1.73), [colored](kernfs_vnops.c.diff?r1=1.72;r2=1.73;f=h)

Changes since revision 1.72: +2 -6
lines
```

Back previous out, it was right the way it was. Seems like I should
attend some basic arithmetic lessons to avoid such mistakes :-/

```

---

Revision **1.72**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.72;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.72;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.72;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.72) - [select for diffs](kernfs_vnops.c?r1=1.72#rev1.72)

*Sat Jan 27 11:42:41 2001 UTC* (24 years ago) by *jdolecek*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.71: [preferred](kernfs_vnops.c.diff?r1=1.71;r2=1.72), [colored](kernfs_vnops.c.diff?r1=1.71;r2=1.72;f=h)

Changes since revision 1.71: +6 -2
lines
```

fix 'physmem' - the actual value we want is ctob(physmem)

```

---

Revision **1.71**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.71;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.71;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.71;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.71) - [select for diffs](kernfs_vnops.c?r1=1.71#rev1.71)

*Mon Jan 22 12:17:38 2001 UTC* (24 years ago) by *jdolecek*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.70: [preferred](kernfs_vnops.c.diff?r1=1.70;r2=1.71), [colored](kernfs_vnops.c.diff?r1=1.70;r2=1.71;f=h)

Changes since revision 1.70: +3 -3
lines
```

make filesystem vnodeop, specop, fifoop and vnodeopv_* arrays const

```

---

Revision **1.67.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.67.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.67.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.67.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.67.2.1) - [select for diffs](kernfs_vnops.c?r1=1.67.2.1#rev1.67.2.1)

*Mon Nov 20 18:09:46 2000 UTC* (24 years, 2 months ago) by *bouyer*

Branches: [thorpej\_scsipi](./kernfs_vnops.c?only_with_tag=thorpej_scsipi)

Diff to: previous 1.67: [preferred](kernfs_vnops.c.diff?r1=1.67;r2=1.67.2.1), [colored](kernfs_vnops.c.diff?r1=1.67;r2=1.67.2.1;f=h)

Changes since revision 1.67: +9 -8
lines
```

Update thorpej_scsipi to -current as of a month ago

```

---

Revision **1.70**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.70;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.70;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.70;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.70) - [select for diffs](kernfs_vnops.c?r1=1.70#rev1.70)

*Thu Aug 3 03:41:18 2000 UTC* (24 years, 5 months ago) by *thorpej*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.69: [preferred](kernfs_vnops.c.diff?r1=1.69;r2=1.70), [colored](kernfs_vnops.c.diff?r1=1.69;r2=1.70;f=h)

Changes since revision 1.69: +3 -4
lines
```

MALLOC()/FREE() are not to be used for variable sized allocations.

```

---

Revision **1.67.12.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.67.12.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.67.12.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.67.12.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.67.12.1) - [select for diffs](kernfs_vnops.c?r1=1.67.12.1#rev1.67.12.1)

*Fri Jul 14 18:11:56 2000 UTC* (24 years, 6 months ago) by *thorpej*

Branches: [netbsd-1-5](./kernfs_vnops.c?only_with_tag=netbsd-1-5)

CVS tags: [netbsd-1-5-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-1-5-RELEASE),
[netbsd-1-5-PATCH003](./kernfs_vnops.c?only_with_tag=netbsd-1-5-PATCH003),
[netbsd-1-5-PATCH002](./kernfs_vnops.c?only_with_tag=netbsd-1-5-PATCH002),
[netbsd-1-5-PATCH001](./kernfs_vnops.c?only_with_tag=netbsd-1-5-PATCH001),
[netbsd-1-5-BETA2](./kernfs_vnops.c?only_with_tag=netbsd-1-5-BETA2),
[netbsd-1-5-BETA](./kernfs_vnops.c?only_with_tag=netbsd-1-5-BETA),
[netbsd-1-5-ALPHA2](./kernfs_vnops.c?only_with_tag=netbsd-1-5-ALPHA2)

Diff to: previous 1.67: [preferred](kernfs_vnops.c.diff?r1=1.67;r2=1.67.12.1), [colored](kernfs_vnops.c.diff?r1=1.67;r2=1.67.12.1;f=h); next MAIN 1.68: [preferred](kernfs_vnops.c.diff?r1=1.68;r2=1.67.12.1), [colored](kernfs_vnops.c.diff?r1=1.68;r2=1.67.12.1;f=h)

Changes since revision 1.67: +7 -3
lines
```

Update from trunk:
Sprinkle some const.

```

---

Revision **1.69**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.69;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.69;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.69;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.69) - [select for diffs](kernfs_vnops.c?r1=1.69#rev1.69)

*Fri Jul 14 07:21:50 2000 UTC* (24 years, 6 months ago) by *thorpej*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.68: [preferred](kernfs_vnops.c.diff?r1=1.68;r2=1.69), [colored](kernfs_vnops.c.diff?r1=1.68;r2=1.69;f=h)

Changes since revision 1.68: +7 -3
lines
```

Sprinkle some const.

```

---

Revision **1.68**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.68;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.68;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.68;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.68) - [select for diffs](kernfs_vnops.c?r1=1.68#rev1.68)

*Wed Jun 28 02:44:06 2000 UTC* (24 years, 7 months ago) by *mrg*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.67: [preferred](kernfs_vnops.c.diff?r1=1.67;r2=1.68), [colored](kernfs_vnops.c.diff?r1=1.67;r2=1.68;f=h)

Changes since revision 1.67: +1 -3
lines
```

<vm/vm.h> -> <uvm/uvm_extern.h>

```

---

Revision **1.67.8.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.67.8.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.67.8.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.67.8.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.67.8.1) - [select for diffs](kernfs_vnops.c?r1=1.67.8.1#rev1.67.8.1)

*Tue Dec 21 23:19:59 1999 UTC* (25 years, 1 month ago) by *wrstuden*

Branches: [wrstuden-devbsize](./kernfs_vnops.c?only_with_tag=wrstuden-devbsize)

Diff to: previous 1.67: [preferred](kernfs_vnops.c.diff?r1=1.67;r2=1.67.8.1), [colored](kernfs_vnops.c.diff?r1=1.67;r2=1.67.8.1;f=h); next MAIN 1.68: [preferred](kernfs_vnops.c.diff?r1=1.68;r2=1.67.8.1), [colored](kernfs_vnops.c.diff?r1=1.68;r2=1.67.8.1;f=h)

Changes since revision 1.67: +3 -3
lines
```

Initial commit of recent changes to make DEV_BSIZE go away.

Runs on i386, needs work on other arch's. Main kernel routines should be
fine, but a number of the stand programs need help.

cd, fd, ccd, wd, and sd have been updated. sd has been tested with non-512
byte block devices. vnd, raidframe, and lfs need work.

Non 2**n block support is automatic for LKM's and conditional for kernels
on "options NON_PO2_BLOCKS".

```

---

Revision **1.63.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.63.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.63.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.63.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.63.2.1) - [select for diffs](kernfs_vnops.c?r1=1.63.2.1#rev1.63.2.1)

*Sat Aug 28 23:24:13 1999 UTC* (25 years, 5 months ago) by *he*

Branches: [netbsd-1-4](./kernfs_vnops.c?only_with_tag=netbsd-1-4)

CVS tags: [netbsd-1-4-PATCH003](./kernfs_vnops.c?only_with_tag=netbsd-1-4-PATCH003),
[netbsd-1-4-PATCH002](./kernfs_vnops.c?only_with_tag=netbsd-1-4-PATCH002)

Diff to: previous 1.63: [preferred](kernfs_vnops.c.diff?r1=1.63;r2=1.63.2.1), [colored](kernfs_vnops.c.diff?r1=1.63;r2=1.63.2.1;f=h); next MAIN 1.64: [preferred](kernfs_vnops.c.diff?r1=1.64;r2=1.63.2.1), [colored](kernfs_vnops.c.diff?r1=1.64;r2=1.63.2.1;f=h)

Changes since revision 1.63: +6 -2
lines
```

Pull up revisions 1.66-1.67:
  Protect {fdesc,kernfs,procfs}_readdir against directory seeks
  with bogus offsets.  (sommerfeld)

```

---

Revision **1.67**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.67;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.67;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.67;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.67) - [select for diffs](kernfs_vnops.c?r1=1.67#rev1.67)

*Wed Aug 25 14:42:35 1999 UTC* (25 years, 5 months ago) by *sommerfeld*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [wrstuden-devbsize-base](./kernfs_vnops.c?only_with_tag=wrstuden-devbsize-base),
[wrstuden-devbsize-19991221](./kernfs_vnops.c?only_with_tag=wrstuden-devbsize-19991221),
[netbsd-1-5-base](./kernfs_vnops.c?only_with_tag=netbsd-1-5-base),
[minoura-xpg4dl-base](./kernfs_vnops.c?only_with_tag=minoura-xpg4dl-base),
[minoura-xpg4dl](./kernfs_vnops.c?only_with_tag=minoura-xpg4dl),
[fvdl-softdep-base](./kernfs_vnops.c?only_with_tag=fvdl-softdep-base),
[fvdl-softdep](./kernfs_vnops.c?only_with_tag=fvdl-softdep),
[comdex-fall-1999-base](./kernfs_vnops.c?only_with_tag=comdex-fall-1999-base),
[comdex-fall-1999](./kernfs_vnops.c?only_with_tag=comdex-fall-1999),
[chs-ubc2-newbase](./kernfs_vnops.c?only_with_tag=chs-ubc2-newbase)

Branch point for: [wrstuden-devbsize](./kernfs_vnops.c?only_with_tag=wrstuden-devbsize),
[thorpej\_scsipi](./kernfs_vnops.c?only_with_tag=thorpej_scsipi),
[netbsd-1-5](./kernfs_vnops.c?only_with_tag=netbsd-1-5)

Diff to: previous 1.66: [preferred](kernfs_vnops.c.diff?r1=1.66;r2=1.67), [colored](kernfs_vnops.c.diff?r1=1.66;r2=1.67;f=h)

Changes since revision 1.66: +2 -2
lines
```

Change variable used for directory offset from "int" to "off_t".
Overkill, but avoids a host of truncation problems.

```

---

Revision **1.66**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.66;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.66;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.66;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.66) - [select for diffs](kernfs_vnops.c?r1=1.66#rev1.66)

*Tue Aug 24 23:29:09 1999 UTC* (25 years, 5 months ago) by *sommerfeld*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.65: [preferred](kernfs_vnops.c.diff?r1=1.65;r2=1.66), [colored](kernfs_vnops.c.diff?r1=1.65;r2=1.66;f=h)

Changes since revision 1.65: +5 -1
lines
```

Fix PR[8270](http://gnats.NetBSD.org/8270):

Problem turned out to be due to improper handling of reads beyond EOF:
they should just return without error with the uio unchanged, and the
caller will recognize this as a zero-byte return (EOF).

The previous fix to protect directory reads against bogus uio_offset
values returned EINVAL, which broke mount -o union, which only
union'ed in the lower directory if the upper directory cleanly
returned EOF.

While we're here, protect kernfs as well.

```

---

Revision **1.65**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.65;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.65;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.65;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.65) - [select for diffs](kernfs_vnops.c?r1=1.65#rev1.65)

*Tue Aug 3 20:19:19 1999 UTC* (25 years, 5 months ago) by *wrstuden*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.64: [preferred](kernfs_vnops.c.diff?r1=1.64;r2=1.65), [colored](kernfs_vnops.c.diff?r1=1.64;r2=1.65;f=h)

Changes since revision 1.64: +3 -1
lines
```

Add support for [fcntl(2)](http://man.NetBSD.org/fcntl.2) to generate VOP_FCNTL calls. Any fcntl
call with F_FSCTL set and F_SETFL calls generate calls to a new
fileop fo_fcntl. Add genfs_fcntl() and soo_fcntl() which return 0
for F_SETFL and EOPNOTSUPP otherwise. Have all leaf filesystems
use genfs_fcntl().

Reviewed by: thorpej
Tested by: wrstuden

```

---

Revision **1.63.4.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.63.4.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.63.4.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.63.4.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.63.4.1) - [select for diffs](kernfs_vnops.c?r1=1.63.4.1#rev1.63.4.1)

*Mon Aug 2 22:27:51 1999 UTC* (25 years, 5 months ago) by *thorpej*

Branches: [chs-ubc2](./kernfs_vnops.c?only_with_tag=chs-ubc2)

Diff to: previous 1.63: [preferred](kernfs_vnops.c.diff?r1=1.63;r2=1.63.4.1), [colored](kernfs_vnops.c.diff?r1=1.63;r2=1.63.4.1;f=h); next MAIN 1.64: [preferred](kernfs_vnops.c.diff?r1=1.64;r2=1.63.4.1), [colored](kernfs_vnops.c.diff?r1=1.64;r2=1.63.4.1;f=h)

Changes since revision 1.63: +28 -17
lines
```

Update from trunk.

```

---

Revision **1.64**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.64;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.64;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.64;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.64) - [select for diffs](kernfs_vnops.c?r1=1.64#rev1.64)

*Thu Jul 8 01:26:27 1999 UTC* (25 years, 6 months ago) by *wrstuden*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [chs-ubc2-base](./kernfs_vnops.c?only_with_tag=chs-ubc2-base)

Diff to: previous 1.63: [preferred](kernfs_vnops.c.diff?r1=1.63;r2=1.64), [colored](kernfs_vnops.c.diff?r1=1.63;r2=1.64;f=h)

Changes since revision 1.63: +28 -17
lines
```

Bump osrelease to 1.4E. Add layerfs files, remove null_subr.c.

Update coda to new struct lock in struct vnode.

make fdescfs, kernfs, portalfs, and procfs actually lock their vnodes.
It's not that hard.

Make unionfs set v_vnlock = NULL so any overlayed fs will call its
VOP_LOCK.

```

---

Revision **1.63**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.63;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.63;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.63;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.63) - [select for diffs](kernfs_vnops.c?r1=1.63#rev1.63)

*Wed Mar 24 05:51:26 1999 UTC* (25 years, 10 months ago) by *mrg*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [netbsd-1-4-base](./kernfs_vnops.c?only_with_tag=netbsd-1-4-base),
[netbsd-1-4-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-1-4-RELEASE),
[netbsd-1-4-PATCH001](./kernfs_vnops.c?only_with_tag=netbsd-1-4-PATCH001),
[kame\_14\_19990705](./kernfs_vnops.c?only_with_tag=kame_14_19990705),
[kame\_14\_19990628](./kernfs_vnops.c?only_with_tag=kame_14_19990628),
[kame\_141\_19991130](./kernfs_vnops.c?only_with_tag=kame_141_19991130),
[kame](./kernfs_vnops.c?only_with_tag=kame)

Branch point for: [netbsd-1-4](./kernfs_vnops.c?only_with_tag=netbsd-1-4),
[chs-ubc2](./kernfs_vnops.c?only_with_tag=chs-ubc2)

Diff to: previous 1.62: [preferred](kernfs_vnops.c.diff?r1=1.62;r2=1.63), [colored](kernfs_vnops.c.diff?r1=1.62;r2=1.63;f=h)

Changes since revision 1.62: +2 -11
lines
```

completely remove Mach VM support.  all that is left is the all the
header files as UVM still uses (most of) these.

```

---

Revision **1.62**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.62;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.62;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.62;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.62) - [select for diffs](kernfs_vnops.c?r1=1.62#rev1.62)

*Thu Aug 13 10:06:33 1998 UTC* (26 years, 5 months ago) by *kleink*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [kenh-if-detach-base](./kernfs_vnops.c?only_with_tag=kenh-if-detach-base),
[kenh-if-detach](./kernfs_vnops.c?only_with_tag=kenh-if-detach),
[chs-ubc-base](./kernfs_vnops.c?only_with_tag=chs-ubc-base),
[chs-ubc](./kernfs_vnops.c?only_with_tag=chs-ubc)

Diff to: previous 1.61: [preferred](kernfs_vnops.c.diff?r1=1.61;r2=1.62), [colored](kernfs_vnops.c.diff?r1=1.61;r2=1.62;f=h)

Changes since revision 1.61: +2 -2
lines
```

Per POSIX, fail with EINVAL if advisory locking is attempted on a file type
that doesn't support it, rather than using a homegrown EBADF or EOPNOTSUPP.

```

---

Revision **1.61**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.61;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.61;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.61;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.61) - [select for diffs](kernfs_vnops.c?r1=1.61#rev1.61)

*Mon Aug 10 08:11:12 1998 UTC* (26 years, 5 months ago) by *matthias*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.60: [preferred](kernfs_vnops.c.diff?r1=1.60;r2=1.61), [colored](kernfs_vnops.c.diff?r1=1.60;r2=1.61;f=h)

Changes since revision 1.60: +2 -2
lines
```

create miscfs/genfs/genfs_vnops.c:genfs_enoioctl and make all the other
filesystems use it instead of a private version.

```

---

Revision **1.60**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.60;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.60;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.60;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.60) - [select for diffs](kernfs_vnops.c?r1=1.60#rev1.60)

*Sun Aug 9 20:51:08 1998 UTC* (26 years, 5 months ago) by *perry*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.59: [preferred](kernfs_vnops.c.diff?r1=1.59;r2=1.60), [colored](kernfs_vnops.c.diff?r1=1.59;r2=1.60;f=h)

Changes since revision 1.59: +8 -8
lines
```

bzero->memset, bcopy->memcpy, bcmp->memcmp

```

---

Revision **1.59**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.59;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.59;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.59;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.59) - [select for diffs](kernfs_vnops.c?r1=1.59#rev1.59)

*Mon Aug 3 14:19:59 1998 UTC* (26 years, 5 months ago) by *kleink*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.58: [preferred](kernfs_vnops.c.diff?r1=1.58;r2=1.59), [colored](kernfs_vnops.c.diff?r1=1.58;r2=1.59;f=h)

Changes since revision 1.58: +4 -1
lines
```

Recognize _PC_SYNC_IO.

```

---

Revision **1.58**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.58;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.58;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.58;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.58) - [select for diffs](kernfs_vnops.c?r1=1.58#rev1.58)

*Sun Mar 8 14:04:14 1998 UTC* (26 years, 10 months ago) by *mrg*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [eeh-paddr\_t-base](./kernfs_vnops.c?only_with_tag=eeh-paddr_t-base),
[eeh-paddr\_t](./kernfs_vnops.c?only_with_tag=eeh-paddr_t)

Diff to: previous 1.57: [preferred](kernfs_vnops.c.diff?r1=1.57;r2=1.58), [colored](kernfs_vnops.c.diff?r1=1.57;r2=1.58;f=h)

Changes since revision 1.57: +2 -2
lines
```

standardise options header includes.

```

---

Revision **1.57**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.57;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.57;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.57;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.57) - [select for diffs](kernfs_vnops.c?r1=1.57#rev1.57)

*Sun Mar 1 02:21:04 1998 UTC* (26 years, 11 months ago) by *fvdl*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.56: [preferred](kernfs_vnops.c.diff?r1=1.56;r2=1.57), [colored](kernfs_vnops.c.diff?r1=1.56;r2=1.57;f=h)

Changes since revision 1.56: +46 -16
lines
```

Merge with Lite2 + local changes

```

---

Revision **1.1.1.2** *(vendor branch)*: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.1.1.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.1.1.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.1.1.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.1.1.2) - [select for diffs](kernfs_vnops.c?r1=1.1.1.2#rev1.1.1.2)

*Sun Mar 1 02:13:17 1998 UTC* (26 years, 11 months ago) by *fvdl*

Branches: [netbsd](./kernfs_vnops.c?only_with_tag=netbsd),
[CSRG](./kernfs_vnops.c?only_with_tag=CSRG)

CVS tags: [lite-2](./kernfs_vnops.c?only_with_tag=lite-2)

Diff to: previous 1.1.1.1: [preferred](kernfs_vnops.c.diff?r1=1.1.1.1;r2=1.1.1.2), [colored](kernfs_vnops.c.diff?r1=1.1.1.1;r2=1.1.1.2;f=h)

Changes since revision 1.1.1.1: +192 -191
lines
```

Import 4.4BSD-Lite2

```

---

Revision **1.1.1.1** *(vendor branch)*: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.1.1.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.1.1.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.1.1.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.1.1.1) - [select for diffs](kernfs_vnops.c?r1=1.1.1.1#rev1.1.1.1)

*Sun Mar 1 02:09:58 1998 UTC* (26 years, 11 months ago) by *fvdl*

Branches: [netbsd](./kernfs_vnops.c?only_with_tag=netbsd),
[CSRG](./kernfs_vnops.c?only_with_tag=CSRG)

CVS tags: [lite-1](./kernfs_vnops.c?only_with_tag=lite-1),
[date-03-may-96](./kernfs_vnops.c?only_with_tag=date-03-may-96)

Diff to: previous 1.1: [preferred](kernfs_vnops.c.diff?r1=1.1;r2=1.1.1.1), [colored](kernfs_vnops.c.diff?r1=1.1;r2=1.1.1.1;f=h)

Changes since revision 1.1: +429 -313
lines
```

Import 4.4BSD-Lite for reference

```

---

Revision **1.56**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.56;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.56;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.56;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.56) - [select for diffs](kernfs_vnops.c?r1=1.56#rev1.56)

*Thu Feb 12 20:38:45 1998 UTC* (26 years, 11 months ago) by *thorpej*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.55: [preferred](kernfs_vnops.c.diff?r1=1.55;r2=1.56), [colored](kernfs_vnops.c.diff?r1=1.55;r2=1.56;f=h)

Changes since revision 1.55: +3 -1
lines
```

Don't include option headers if building an LKM.

```

---

Revision **1.55**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.55;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.55;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.55;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.55) - [select for diffs](kernfs_vnops.c?r1=1.55#rev1.55)

*Tue Feb 10 14:10:32 1998 UTC* (26 years, 11 months ago) by *mrg*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.54: [preferred](kernfs_vnops.c.diff?r1=1.54;r2=1.55), [colored](kernfs_vnops.c.diff?r1=1.54;r2=1.55;f=h)

Changes since revision 1.54: +3 -1
lines
```

- add defopt's for UVM, UVMHIST and PMAP_NEW.
- remove unnecessary UVMHIST_DECL's.

```

---

Revision **1.54**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.54;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.54;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.54;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.54) - [select for diffs](kernfs_vnops.c?r1=1.54#rev1.54)

*Thu Feb 5 08:00:12 1998 UTC* (26 years, 11 months ago) by *mrg*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.53: [preferred](kernfs_vnops.c.diff?r1=1.53;r2=1.54), [colored](kernfs_vnops.c.diff?r1=1.53;r2=1.54;f=h)

Changes since revision 1.53: +10 -1
lines
```

initial import of the new virtual memory system, UVM, into -current.

UVM was written by chuck cranor <chuck@maria.wustl.edu>, with some
minor portions derived from the old Mach code.  i provided some help
getting swap and paging working, and other bug fixes/ideas.  chuck
silvers <chuq@chuq.com> also provided some other fixes.

this is the rest of the MI portion changes.

this will be KNF'd shortly.  :-)

```

---

Revision **1.50.4.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.50.4.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.50.4.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.50.4.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.50.4.3) - [select for diffs](kernfs_vnops.c?r1=1.50.4.3#rev1.50.4.3)

*Tue Oct 14 10:28:27 1997 UTC* (27 years, 3 months ago) by *thorpej*

Branches: [marc-pcmcia](./kernfs_vnops.c?only_with_tag=marc-pcmcia)

Diff to: previous 1.50.4.2: [preferred](kernfs_vnops.c.diff?r1=1.50.4.2;r2=1.50.4.3), [colored](kernfs_vnops.c.diff?r1=1.50.4.2;r2=1.50.4.3;f=h); branchpoint 1.50: [preferred](kernfs_vnops.c.diff?r1=1.50;r2=1.50.4.3), [colored](kernfs_vnops.c.diff?r1=1.50;r2=1.50.4.3;f=h); next MAIN 1.51: [preferred](kernfs_vnops.c.diff?r1=1.51;r2=1.50.4.3), [colored](kernfs_vnops.c.diff?r1=1.51;r2=1.50.4.3;f=h)

Changes since revision 1.50.4.2: +3 -3
lines
```

Update marc-pcmcia branch from trunk.

```

---

Revision **1.53**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.53;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.53;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.53;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.53) - [select for diffs](kernfs_vnops.c?r1=1.53#rev1.53)

*Fri Oct 10 02:01:02 1997 UTC* (27 years, 3 months ago) by *fvdl*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [netbsd-1-3-base](./kernfs_vnops.c?only_with_tag=netbsd-1-3-base),
[netbsd-1-3-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-1-3-RELEASE),
[netbsd-1-3-PATCH003-CANDIDATE2](./kernfs_vnops.c?only_with_tag=netbsd-1-3-PATCH003-CANDIDATE2),
[netbsd-1-3-PATCH003-CANDIDATE1](./kernfs_vnops.c?only_with_tag=netbsd-1-3-PATCH003-CANDIDATE1),
[netbsd-1-3-PATCH003-CANDIDATE0](./kernfs_vnops.c?only_with_tag=netbsd-1-3-PATCH003-CANDIDATE0),
[netbsd-1-3-PATCH003](./kernfs_vnops.c?only_with_tag=netbsd-1-3-PATCH003),
[netbsd-1-3-PATCH002](./kernfs_vnops.c?only_with_tag=netbsd-1-3-PATCH002),
[netbsd-1-3-PATCH001](./kernfs_vnops.c?only_with_tag=netbsd-1-3-PATCH001),
[netbsd-1-3-BETA](./kernfs_vnops.c?only_with_tag=netbsd-1-3-BETA),
[netbsd-1-3](./kernfs_vnops.c?only_with_tag=netbsd-1-3),
[marc-pcmcia-base](./kernfs_vnops.c?only_with_tag=marc-pcmcia-base)

Diff to: previous 1.52: [preferred](kernfs_vnops.c.diff?r1=1.52;r2=1.53), [colored](kernfs_vnops.c.diff?r1=1.52;r2=1.53;f=h)

Changes since revision 1.52: +3 -3
lines
```

Bump last argument to VOP_READDIR to off_t (from u_long).

```

---

Revision **1.50.4.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.50.4.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.50.4.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.50.4.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.50.4.2) - [select for diffs](kernfs_vnops.c?r1=1.50.4.2#rev1.50.4.2)

*Mon Sep 22 06:33:57 1997 UTC* (27 years, 4 months ago) by *thorpej*

Branches: [marc-pcmcia](./kernfs_vnops.c?only_with_tag=marc-pcmcia)

Diff to: previous 1.50.4.1: [preferred](kernfs_vnops.c.diff?r1=1.50.4.1;r2=1.50.4.2), [colored](kernfs_vnops.c.diff?r1=1.50.4.1;r2=1.50.4.2;f=h); branchpoint 1.50: [preferred](kernfs_vnops.c.diff?r1=1.50;r2=1.50.4.2), [colored](kernfs_vnops.c.diff?r1=1.50;r2=1.50.4.2;f=h)

Changes since revision 1.50.4.1: +23 -6
lines
```

Update marc-pcmcia branch from trunk.

```

---

Revision **1.52**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.52;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.52;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.52;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.52) - [select for diffs](kernfs_vnops.c?r1=1.52#rev1.52)

*Fri Sep 19 19:14:20 1997 UTC* (27 years, 4 months ago) by *leo*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.51: [preferred](kernfs_vnops.c.diff?r1=1.51;r2=1.52), [colored](kernfs_vnops.c.diff?r1=1.51;r2=1.52;f=h)

Changes since revision 1.51: +23 -6
lines
```

Implement the kernel part of pr-1891. This allows for a more flexible sized
msgbuf. Note that old 'dmesg' and 'syslogd' binaries will continue running,
though old 'dmesg' binaries will output a few bytes of junk at the start of
the buffer, and will miss a few bytes at the end of the buffer.

```

---

Revision **1.50.4.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.50.4.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.50.4.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.50.4.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.50.4.1) - [select for diffs](kernfs_vnops.c?r1=1.50.4.1#rev1.50.4.1)

*Tue Sep 16 03:51:09 1997 UTC* (27 years, 4 months ago) by *thorpej*

Branches: [marc-pcmcia](./kernfs_vnops.c?only_with_tag=marc-pcmcia)

Diff to: previous 1.50: [preferred](kernfs_vnops.c.diff?r1=1.50;r2=1.50.4.1), [colored](kernfs_vnops.c.diff?r1=1.50;r2=1.50.4.1;f=h)

Changes since revision 1.50: +6 -6
lines
```

Update marc-pcmcia branch from trunk.

```

---

Revision **1.51**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.51;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.51;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.51;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.51) - [select for diffs](kernfs_vnops.c?r1=1.51#rev1.51)

*Wed Sep 10 13:44:21 1997 UTC* (27 years, 4 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.50: [preferred](kernfs_vnops.c.diff?r1=1.50;r2=1.51), [colored](kernfs_vnops.c.diff?r1=1.50;r2=1.51;f=h)

Changes since revision 1.50: +6 -6
lines
```

PR/[4098](http://gnats.NetBSD.org/4098): Alan Barrett: Fix diagnostic printf formatting.

```

---

Revision **1.50**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.50;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.50;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.50;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.50) - [select for diffs](kernfs_vnops.c?r1=1.50#rev1.50)

*Sat May 10 22:04:14 1997 UTC* (27 years, 8 months ago) by *pk*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [thorpej-signal-base](./kernfs_vnops.c?only_with_tag=thorpej-signal-base),
[thorpej-signal](./kernfs_vnops.c?only_with_tag=thorpej-signal),
[marc-pcmcia-bp](./kernfs_vnops.c?only_with_tag=marc-pcmcia-bp),
[bouyer-scsipi](./kernfs_vnops.c?only_with_tag=bouyer-scsipi)

Branch point for: [marc-pcmcia](./kernfs_vnops.c?only_with_tag=marc-pcmcia)

Diff to: previous 1.49: [preferred](kernfs_vnops.c.diff?r1=1.49;r2=1.50), [colored](kernfs_vnops.c.diff?r1=1.49;r2=1.50;f=h)

Changes since revision 1.49: +2 -18
lines
```

Move `struct kern_target' definition into kernfs.h

```

---

Revision **1.49**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.49;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.49;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.49;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.49) - [select for diffs](kernfs_vnops.c?r1=1.49#rev1.49)

*Thu May 8 16:20:17 1997 UTC* (27 years, 8 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.48: [preferred](kernfs_vnops.c.diff?r1=1.48;r2=1.49), [colored](kernfs_vnops.c.diff?r1=1.48;r2=1.49;f=h)

Changes since revision 1.48: +11 -4
lines
```

Pass the vnode type to vaccess(), and use it when checking VEXEC.  Make sure
that the mode bits passed to vaccess() and returned by foo_getattr() contain
only permission bits.

```

---

Revision **1.48**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.48;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.48;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.48;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.48) - [select for diffs](kernfs_vnops.c?r1=1.48#rev1.48)

*Fri Oct 25 21:58:00 1996 UTC* (28 years, 3 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [thorpej-setroot](./kernfs_vnops.c?only_with_tag=thorpej-setroot),
[mrg-vm-swap](./kernfs_vnops.c?only_with_tag=mrg-vm-swap),
[is-newarp-before-merge](./kernfs_vnops.c?only_with_tag=is-newarp-before-merge),
[is-newarp-base](./kernfs_vnops.c?only_with_tag=is-newarp-base),
[is-newarp](./kernfs_vnops.c?only_with_tag=is-newarp)

Diff to: previous 1.47: [preferred](kernfs_vnops.c.diff?r1=1.47;r2=1.48), [colored](kernfs_vnops.c.diff?r1=1.47;r2=1.48;f=h)

Changes since revision 1.47: +2 -2
lines
```

define path name string variables that we should not (and, thankfully, do
not) modify as 'const char *' rather 'char *'.

```

---

Revision **1.47**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.47;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.47;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.47;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.47) - [select for diffs](kernfs_vnops.c?r1=1.47#rev1.47)

*Sun Oct 13 02:21:31 1996 UTC* (28 years, 3 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.46: [preferred](kernfs_vnops.c.diff?r1=1.46;r2=1.47), [colored](kernfs_vnops.c.diff?r1=1.46;r2=1.47;f=h)

Changes since revision 1.46: +18 -18
lines
```

backout previous kprintf changes

```

---

Revision **1.46**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.46;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.46;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.46;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.46) - [select for diffs](kernfs_vnops.c?r1=1.46#rev1.46)

*Thu Oct 10 22:54:08 1996 UTC* (28 years, 3 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.45: [preferred](kernfs_vnops.c.diff?r1=1.45;r2=1.46), [colored](kernfs_vnops.c.diff?r1=1.45;r2=1.46;f=h)

Changes since revision 1.45: +18 -18
lines
```

printf -> kprintf, sprintf -> ksprintf

```

---

Revision **1.45**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.45;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.45;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.45;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.45) - [select for diffs](kernfs_vnops.c?r1=1.45#rev1.45)

*Sat Sep 7 12:41:14 1996 UTC* (28 years, 4 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.44: [preferred](kernfs_vnops.c.diff?r1=1.44;r2=1.45), [colored](kernfs_vnops.c.diff?r1=1.44;r2=1.45;f=h)

Changes since revision 1.44: +3 -3
lines
```

Implement [poll(2)](http://man.NetBSD.org/poll.2).

```

---

Revision **1.44**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.44;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.44;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.44;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.44) - [select for diffs](kernfs_vnops.c?r1=1.44#rev1.44)

*Sun Sep 1 23:48:12 1996 UTC* (28 years, 5 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.43: [preferred](kernfs_vnops.c.diff?r1=1.43;r2=1.44), [colored](kernfs_vnops.c.diff?r1=1.43;r2=1.44;f=h)

Changes since revision 1.43: +70 -128
lines
```

Add a set of generic file system operations that most file systems use.
Also, fix some time stamp bogosities.

```

---

Revision **1.43**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.43;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.43;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.43;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.43) - [select for diffs](kernfs_vnops.c?r1=1.43#rev1.43)

*Sat Mar 16 23:52:47 1996 UTC* (28 years, 10 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [netbsd-1-2-base](./kernfs_vnops.c?only_with_tag=netbsd-1-2-base),
[netbsd-1-2-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-1-2-RELEASE),
[netbsd-1-2-PATCH001](./kernfs_vnops.c?only_with_tag=netbsd-1-2-PATCH001),
[netbsd-1-2-BETA](./kernfs_vnops.c?only_with_tag=netbsd-1-2-BETA),
[netbsd-1-2](./kernfs_vnops.c?only_with_tag=netbsd-1-2)

Diff to: previous 1.42: [preferred](kernfs_vnops.c.diff?r1=1.42;r2=1.43), [colored](kernfs_vnops.c.diff?r1=1.42;r2=1.43;f=h)

Changes since revision 1.42: +3 -3
lines
```

Fix printf format follies.

```

---

Revision **1.42**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.42;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.42;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.42;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.42) - [select for diffs](kernfs_vnops.c?r1=1.42#rev1.42)

*Tue Feb 13 13:12:55 1996 UTC* (28 years, 11 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.41: [preferred](kernfs_vnops.c.diff?r1=1.41;r2=1.42), [colored](kernfs_vnops.c.diff?r1=1.41;r2=1.42;f=h)

Changes since revision 1.41: +3 -16
lines
```

GC *_nullop().  Minor nits.

```

---

Revision **1.41**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.41;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.41;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.41;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.41) - [select for diffs](kernfs_vnops.c?r1=1.41#rev1.41)

*Fri Feb 9 22:40:24 1996 UTC* (28 years, 11 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.40: [preferred](kernfs_vnops.c.diff?r1=1.40;r2=1.41), [colored](kernfs_vnops.c.diff?r1=1.40;r2=1.41;f=h)

Changes since revision 1.40: +183 -152
lines
```

miscfs prototype changes

```

---

Revision **1.40**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.40;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.40;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.40;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.40) - [select for diffs](kernfs_vnops.c?r1=1.40#rev1.40)

*Fri Feb 9 14:45:48 1996 UTC* (28 years, 11 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.39: [preferred](kernfs_vnops.c.diff?r1=1.39;r2=1.40), [colored](kernfs_vnops.c.diff?r1=1.39;r2=1.40;f=h)

Changes since revision 1.39: +44 -4
lines
```

Fix vop_link, vop_symlink, and vop_remove semantics in several ways:
* Change the argument names to vop_link so they actually make sense.
* Implement vop_link and vop_symlink for all file systems, so they do proper
  cleanup.
* Require the file system to decide whether or not linking and unlinking of
  directories is allowed, and disable it for all current file systems.

```

---

Revision **1.39**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.39;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.39;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.39;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.39) - [select for diffs](kernfs_vnops.c?r1=1.39#rev1.39)

*Mon Oct 9 14:25:02 1995 UTC* (29 years, 3 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [netbsd-1-1-base](./kernfs_vnops.c?only_with_tag=netbsd-1-1-base),
[netbsd-1-1-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-1-1-RELEASE),
[netbsd-1-1-PATCH001](./kernfs_vnops.c?only_with_tag=netbsd-1-1-PATCH001),
[netbsd-1-1](./kernfs_vnops.c?only_with_tag=netbsd-1-1)

Diff to: previous 1.38: [preferred](kernfs_vnops.c.diff?r1=1.38;r2=1.39), [colored](kernfs_vnops.c.diff?r1=1.38;r2=1.39;f=h)

Changes since revision 1.38: +2 -2
lines
```

Fix the inode calculation in kernfs_getattr().

```

---

Revision **1.38**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.38;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.38;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.38;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.38) - [select for diffs](kernfs_vnops.c?r1=1.38#rev1.38)

*Mon Oct 9 14:03:35 1995 UTC* (29 years, 3 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.37: [preferred](kernfs_vnops.c.diff?r1=1.37;r2=1.38), [colored](kernfs_vnops.c.diff?r1=1.37;r2=1.38;f=h)

Changes since revision 1.37: +5 -7
lines
```

Use the index number as the cookie, rather than multiplying by UIO_MX.

```

---

Revision **1.37**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.37;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.37;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.37;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.37) - [select for diffs](kernfs_vnops.c?r1=1.37#rev1.37)

*Mon Oct 9 11:18:59 1995 UTC* (29 years, 3 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.36: [preferred](kernfs_vnops.c.diff?r1=1.36;r2=1.37), [colored](kernfs_vnops.c.diff?r1=1.36;r2=1.37;f=h)

Changes since revision 1.36: +22 -29
lines
```

Add support for cookies, mostly from Greg Hudson.

```

---

Revision **1.36**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.36;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.36;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.36;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.36) - [select for diffs](kernfs_vnops.c?r1=1.36#rev1.36)

*Sat Apr 15 01:56:43 1995 UTC* (29 years, 9 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.35: [preferred](kernfs_vnops.c.diff?r1=1.35;r2=1.36), [colored](kernfs_vnops.c.diff?r1=1.35;r2=1.36;f=h)

Changes since revision 1.35: +4 -2
lines
```

fix timeval vs. timespec warnings

```

---

Revision **1.35**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.35;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.35;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.35;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.35) - [select for diffs](kernfs_vnops.c?r1=1.35#rev1.35)

*Fri Feb 3 16:18:46 1995 UTC* (29 years, 11 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.34: [preferred](kernfs_vnops.c.diff?r1=1.34;r2=1.35), [colored](kernfs_vnops.c.diff?r1=1.34;r2=1.35;f=h)

Changes since revision 1.34: +12 -12
lines
```

Return EROFS rather than ENOENT in many cases.  Also some cosmetic cleanup.

```

---

Revision **1.34**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.34;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.34;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.34;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.34) - [select for diffs](kernfs_vnops.c?r1=1.34#rev1.34)

*Tue Dec 27 19:11:17 1994 UTC* (30 years, 1 month ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.33: [preferred](kernfs_vnops.c.diff?r1=1.33;r2=1.34), [colored](kernfs_vnops.c.diff?r1=1.33;r2=1.34;f=h)

Changes since revision 1.33: +2 -2
lines
```

Format police.

```

---

Revision **1.33**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.33;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.33;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.33;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.33) - [select for diffs](kernfs_vnops.c?r1=1.33#rev1.33)

*Sat Dec 24 16:44:24 1994 UTC* (30 years, 1 month ago) by *ws*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.32: [preferred](kernfs_vnops.c.diff?r1=1.32;r2=1.33), [colored](kernfs_vnops.c.diff?r1=1.32;r2=1.33;f=h)

Changes since revision 1.32: +2 -34
lines
```

Implement and use a common access checking routine

```

---

Revision **1.32**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.32;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.32;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.32;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.32) - [select for diffs](kernfs_vnops.c?r1=1.32#rev1.32)

*Wed Dec 14 18:47:42 1994 UTC* (30 years, 1 month ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.31: [preferred](kernfs_vnops.c.diff?r1=1.31;r2=1.32), [colored](kernfs_vnops.c.diff?r1=1.31;r2=1.32;f=h)

Changes since revision 1.31: +1 -2
lines
```

Remove a_fp.

```

---

Revision **1.31**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.31;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.31;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.31;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.31) - [select for diffs](kernfs_vnops.c?r1=1.31#rev1.31)

*Thu Dec 1 10:16:53 1994 UTC* (30 years, 2 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.30: [preferred](kernfs_vnops.c.diff?r1=1.30;r2=1.31), [colored](kernfs_vnops.c.diff?r1=1.30;r2=1.31;f=h)

Changes since revision 1.30: +2 -1
lines
```

Make sure averunnable.fscale is filled before using it.

```

---

Revision **1.30**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.30;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.30;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.30;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.30) - [select for diffs](kernfs_vnops.c?r1=1.30#rev1.30)

*Mon Nov 14 06:06:24 1994 UTC* (30 years, 2 months ago) by *christos*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.29: [preferred](kernfs_vnops.c.diff?r1=1.29;r2=1.30), [colored](kernfs_vnops.c.diff?r1=1.29;r2=1.30;f=h)

Changes since revision 1.29: +2 -1
lines
```

fixed struct comment

```

---

Revision **1.29**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.29;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.29;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.29;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.29) - [select for diffs](kernfs_vnops.c?r1=1.29#rev1.29)

*Thu Oct 20 04:26:28 1994 UTC* (30 years, 3 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.28: [preferred](kernfs_vnops.c.diff?r1=1.28;r2=1.29), [colored](kernfs_vnops.c.diff?r1=1.28;r2=1.29;f=h)

Changes since revision 1.28: +2 -2
lines
```

update for new syscall args description mechanism

```

---

Revision **1.27.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.27.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.27.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.27.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.27.2.1) - [select for diffs](kernfs_vnops.c?r1=1.27.2.1#rev1.27.2.1)

*Fri Jul 22 01:14:06 1994 UTC* (30 years, 6 months ago) by *cgd*

Branches: [netbsd-1-0](./kernfs_vnops.c?only_with_tag=netbsd-1-0)

CVS tags: [netbsd-1-0-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-1-0-RELEASE),
[netbsd-1-0-PATCH1](./kernfs_vnops.c?only_with_tag=netbsd-1-0-PATCH1),
[netbsd-1-0-PATCH06](./kernfs_vnops.c?only_with_tag=netbsd-1-0-PATCH06),
[netbsd-1-0-PATCH05](./kernfs_vnops.c?only_with_tag=netbsd-1-0-PATCH05),
[netbsd-1-0-PATCH04](./kernfs_vnops.c?only_with_tag=netbsd-1-0-PATCH04),
[netbsd-1-0-PATCH03](./kernfs_vnops.c?only_with_tag=netbsd-1-0-PATCH03),
[netbsd-1-0-PATCH02](./kernfs_vnops.c?only_with_tag=netbsd-1-0-PATCH02),
[netbsd-1-0-PATCH0](./kernfs_vnops.c?only_with_tag=netbsd-1-0-PATCH0)

Diff to: previous 1.27: [preferred](kernfs_vnops.c.diff?r1=1.27;r2=1.27.2.1), [colored](kernfs_vnops.c.diff?r1=1.27;r2=1.27.2.1;f=h); next MAIN 1.28: [preferred](kernfs_vnops.c.diff?r1=1.28;r2=1.27.2.1), [colored](kernfs_vnops.c.diff?r1=1.28;r2=1.27.2.1;f=h)

Changes since revision 1.27: +63 -37
lines
```

from trunk.

```

---

Revision **1.28**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.28;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.28;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.28;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.28) - [select for diffs](kernfs_vnops.c?r1=1.28#rev1.28)

*Thu Jul 21 10:22:20 1994 UTC* (30 years, 6 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.27: [preferred](kernfs_vnops.c.diff?r1=1.27;r2=1.28), [colored](kernfs_vnops.c.diff?r1=1.27;r2=1.28;f=h)

Changes since revision 1.27: +63 -37
lines
```

Implement /kern/msgbuf.

```

---

Revision **1.27**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.27;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.27;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.27;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.27) - [select for diffs](kernfs_vnops.c?r1=1.27#rev1.27)

*Wed Jun 29 06:34:29 1994 UTC* (30 years, 7 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [netbsd-1-0-base](./kernfs_vnops.c?only_with_tag=netbsd-1-0-base)

Branch point for: [netbsd-1-0](./kernfs_vnops.c?only_with_tag=netbsd-1-0)

Diff to: previous 1.26: [preferred](kernfs_vnops.c.diff?r1=1.26;r2=1.27), [colored](kernfs_vnops.c.diff?r1=1.26;r2=1.27;f=h)

Changes since revision 1.26: +3 -2
lines
```

New RCS ID's, take two.  they're more aesthecially pleasant, and use 'NetBSD'

```

---

Revision **1.26**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.26;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.26;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.26;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.26) - [select for diffs](kernfs_vnops.c?r1=1.26#rev1.26)

*Wed Jun 15 22:54:43 1994 UTC* (30 years, 7 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.25: [preferred](kernfs_vnops.c.diff?r1=1.25;r2=1.26), [colored](kernfs_vnops.c.diff?r1=1.25;r2=1.26;f=h)

Changes since revision 1.25: +25 -11
lines
```

Minor update from JSP after merging my changes.

```

---

Revision **1.25**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.25;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.25;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.25;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.25) - [select for diffs](kernfs_vnops.c?r1=1.25#rev1.25)

*Wed Jun 15 17:52:32 1994 UTC* (30 years, 7 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.24: [preferred](kernfs_vnops.c.diff?r1=1.24;r2=1.25), [colored](kernfs_vnops.c.diff?r1=1.24;r2=1.25;f=h)

Changes since revision 1.24: +3 -1
lines
```

Deal with silly DIAGNOSTIC check.

```

---

Revision **1.24**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.24;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.24;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.24;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.24) - [select for diffs](kernfs_vnops.c?r1=1.24#rev1.24)

*Wed Jun 15 03:30:44 1994 UTC* (30 years, 7 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.23: [preferred](kernfs_vnops.c.diff?r1=1.23;r2=1.24), [colored](kernfs_vnops.c.diff?r1=1.23;r2=1.24;f=h)

Changes since revision 1.23: +5 -4
lines
```

Use vget() for devices.

```

---

Revision **1.23**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.23;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.23;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.23;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.23) - [select for diffs](kernfs_vnops.c?r1=1.23#rev1.23)

*Wed Jun 8 11:33:21 1994 UTC* (30 years, 7 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.22: [preferred](kernfs_vnops.c.diff?r1=1.22;r2=1.23), [colored](kernfs_vnops.c.diff?r1=1.22;r2=1.23;f=h)

Changes since revision 1.22: +412 -412
lines
```

Update to 4.4-Lite fs code, with local changes.

```

---

Revision **1.22**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.22;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.22;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.22;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.22) - [select for diffs](kernfs_vnops.c?r1=1.22#rev1.22)

*Tue May 17 06:59:17 1994 UTC* (30 years, 8 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.21: [preferred](kernfs_vnops.c.diff?r1=1.21;r2=1.22), [colored](kernfs_vnops.c.diff?r1=1.21;r2=1.22;f=h)

Changes since revision 1.21: +4 -3
lines
```

Really fix the file size problem.

```

---

Revision **1.21**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.21;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.21;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.21;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.21) - [select for diffs](kernfs_vnops.c?r1=1.21#rev1.21)

*Tue May 17 04:10:29 1994 UTC* (30 years, 8 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.20: [preferred](kernfs_vnops.c.diff?r1=1.20;r2=1.21), [colored](kernfs_vnops.c.diff?r1=1.20;r2=1.21;f=h)

Changes since revision 1.20: +2 -3
lines
```

actually set va_size!

```

---

Revision **1.20**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.20;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.20;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.20;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.20) - [select for diffs](kernfs_vnops.c?r1=1.20#rev1.20)

*Mon Feb 14 19:46:18 1994 UTC* (30 years, 11 months ago) by *ws*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.19: [preferred](kernfs_vnops.c.diff?r1=1.19;r2=1.20), [colored](kernfs_vnops.c.diff?r1=1.19;r2=1.20;f=h)

Changes since revision 1.19: +2 -1
lines
```

Add .. entry to /kern

```

---

Revision **1.19**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.19;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.19;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.19;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.19) - [select for diffs](kernfs_vnops.c?r1=1.19#rev1.19)

*Fri Feb 11 01:01:51 1994 UTC* (30 years, 11 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.18: [preferred](kernfs_vnops.c.diff?r1=1.18;r2=1.19), [colored](kernfs_vnops.c.diff?r1=1.18;r2=1.19;f=h)

Changes since revision 1.18: +2 -2
lines
```

don't give bogus return code from read()

```

---

Revision **1.18**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.18;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.18;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.18;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.18) - [select for diffs](kernfs_vnops.c?r1=1.18#rev1.18)

*Wed Feb 9 06:32:17 1994 UTC* (30 years, 11 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.17: [preferred](kernfs_vnops.c.diff?r1=1.17;r2=1.18), [colored](kernfs_vnops.c.diff?r1=1.17;r2=1.18;f=h)

Changes since revision 1.17: +4 -1
lines
```

don't panic if user does 'cat /kern', though result is dubious.

```

---

Revision **1.15.2.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.15.2.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.15.2.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.15.2.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.15.2.3) - [select for diffs](kernfs_vnops.c?r1=1.15.2.3#rev1.15.2.3)

*Thu Jan 6 15:08:17 1994 UTC* (31 years ago) by *pk*

Branches: [magnum](./kernfs_vnops.c?only_with_tag=magnum)

Diff to: previous 1.15.2.2: [preferred](kernfs_vnops.c.diff?r1=1.15.2.2;r2=1.15.2.3), [colored](kernfs_vnops.c.diff?r1=1.15.2.2;r2=1.15.2.3;f=h); branchpoint 1.15: [preferred](kernfs_vnops.c.diff?r1=1.15;r2=1.15.2.3), [colored](kernfs_vnops.c.diff?r1=1.15;r2=1.15.2.3;f=h); next MAIN 1.16: [preferred](kernfs_vnops.c.diff?r1=1.16;r2=1.15.2.3), [colored](kernfs_vnops.c.diff?r1=1.16;r2=1.15.2.3;f=h)

Changes since revision 1.15.2.2: +2 -2
lines
```

Re-instate EOPNOTSUPP

```

---

Revision **1.17**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.17;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.17;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.17;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.17) - [select for diffs](kernfs_vnops.c?r1=1.17#rev1.17)

*Wed Jan 5 11:05:12 1994 UTC* (31 years ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.16: [preferred](kernfs_vnops.c.diff?r1=1.16;r2=1.17), [colored](kernfs_vnops.c.diff?r1=1.16;r2=1.17;f=h)

Changes since revision 1.16: +169 -251
lines
```

update with latest kernfs file system from jsp@sequent.com

```

---

Revision **1.15.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.15.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.15.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.15.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.15.2.2) - [select for diffs](kernfs_vnops.c?r1=1.15.2.2#rev1.15.2.2)

*Tue Dec 28 16:35:19 1993 UTC* (31 years, 1 month ago) by *pk*

Branches: [magnum](./kernfs_vnops.c?only_with_tag=magnum)

Diff to: previous 1.15.2.1: [preferred](kernfs_vnops.c.diff?r1=1.15.2.1;r2=1.15.2.2), [colored](kernfs_vnops.c.diff?r1=1.15.2.1;r2=1.15.2.2;f=h); branchpoint 1.15: [preferred](kernfs_vnops.c.diff?r1=1.15;r2=1.15.2.2), [colored](kernfs_vnops.c.diff?r1=1.15;r2=1.15.2.2;f=h)

Changes since revision 1.15.2.1: +818 -0
lines
```

Use ENODEV rather then EOPNOTSUP for unsupported operations on non-socket devices

```

---

Revision **1.16**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.16;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.16;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.16;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.16) - [select for diffs](kernfs_vnops.c?r1=1.16#rev1.16)

*Wed Dec 22 13:14:10 1993 UTC* (31 years, 1 month ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.15: [preferred](kernfs_vnops.c.diff?r1=1.15;r2=1.16), [colored](kernfs_vnops.c.diff?r1=1.15;r2=1.16;f=h)

Changes since revision 1.15: +3 -2
lines
```

fix return type of vnode print routine

```

---

Revision **1.15.2.1**

*Mon Dec 20 12:39:12 1993 UTC* (31 years, 1 month ago) by *pk*

Branches: [magnum](./kernfs_vnops.c?only_with_tag=magnum)

***FILE REMOVED***

Changes since revision 1.15: +0 -818
lines
```

file kernfs_vnops.c was added on branch magnum on 1993-12-28 16:35:19 +0000

```

---

Revision **1.15**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.15;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.15;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.15;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.15) - [select for diffs](kernfs_vnops.c?r1=1.15#rev1.15)

*Mon Dec 20 12:39:12 1993 UTC* (31 years, 1 month ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [magnum-base](./kernfs_vnops.c?only_with_tag=magnum-base)

Branch point for: [magnum](./kernfs_vnops.c?only_with_tag=magnum)

Diff to: previous 1.14: [preferred](kernfs_vnops.c.diff?r1=1.14;r2=1.15), [colored](kernfs_vnops.c.diff?r1=1.14;r2=1.15;f=h)

Changes since revision 1.14: +16 -10
lines
```

pull load average and misc changes down from magnum

```

---

Revision **1.14**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.14;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.14;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.14;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.14) - [select for diffs](kernfs_vnops.c?r1=1.14#rev1.14)

*Sat Dec 18 03:56:12 1993 UTC* (31 years, 1 month ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.13: [preferred](kernfs_vnops.c.diff?r1=1.13;r2=1.14), [colored](kernfs_vnops.c.diff?r1=1.13;r2=1.14;f=h)

Changes since revision 1.13: +16 -15
lines
```

Canonicalize all #includes.

```

---

Revision **1.12.2.4**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.12.2.4;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.12.2.4;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.12.2.4;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.12.2.4) - [select for diffs](kernfs_vnops.c?r1=1.12.2.4#rev1.12.2.4)

*Mon Nov 29 16:03:22 1993 UTC* (31 years, 2 months ago) by *mycroft*

Diff to: previous 1.12.2.3: [preferred](kernfs_vnops.c.diff?r1=1.12.2.3;r2=1.12.2.4), [colored](kernfs_vnops.c.diff?r1=1.12.2.3;r2=1.12.2.4;f=h); next MAIN 1.13: [preferred](kernfs_vnops.c.diff?r1=1.13;r2=1.12.2.4), [colored](kernfs_vnops.c.diff?r1=1.13;r2=1.12.2.4;f=h)

Changes since revision 1.12.2.3: +13 -7
lines
```

Don't crash deferencing a null pointer if the raw root device was not found.

```

---

Revision **1.12.2.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.12.2.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.12.2.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.12.2.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.12.2.3) - [select for diffs](kernfs_vnops.c?r1=1.12.2.3#rev1.12.2.3)

*Sat Nov 20 01:57:41 1993 UTC* (31 years, 2 months ago) by *cgd*

Diff to: previous 1.12.2.2: [preferred](kernfs_vnops.c.diff?r1=1.12.2.2;r2=1.12.2.3), [colored](kernfs_vnops.c.diff?r1=1.12.2.2;r2=1.12.2.3;f=h)

Changes since revision 1.12.2.2: +7 -3
lines
```

update from trunk

```

---

Revision **1.13**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.13;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.13;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.13;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.13) - [select for diffs](kernfs_vnops.c?r1=1.13#rev1.13)

*Sat Nov 20 01:57:07 1993 UTC* (31 years, 2 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.12: [preferred](kernfs_vnops.c.diff?r1=1.12;r2=1.13), [colored](kernfs_vnops.c.diff?r1=1.12;r2=1.13;f=h)

Changes since revision 1.12: +7 -3
lines
```

#ifdef out /kern/root at theo's request

```

---

Revision **1.12.2.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.12.2.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.12.2.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.12.2.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.12.2.2) - [select for diffs](kernfs_vnops.c?r1=1.12.2.2#rev1.12.2.2)

*Sun Nov 14 22:34:55 1993 UTC* (31 years, 2 months ago) by *mycroft*

Diff to: previous 1.12.2.1: [preferred](kernfs_vnops.c.diff?r1=1.12.2.1;r2=1.12.2.2), [colored](kernfs_vnops.c.diff?r1=1.12.2.1;r2=1.12.2.2;f=h)

Changes since revision 1.12.2.1: +15 -15
lines
```

Canonicalize all #includes.

```

---

Revision **1.12.2.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.12.2.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.12.2.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.12.2.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.12.2.1) - [select for diffs](kernfs_vnops.c?r1=1.12.2.1#rev1.12.2.1)

*Fri Sep 24 08:52:49 1993 UTC* (31 years, 4 months ago) by *mycroft*

Diff to: previous 1.12: [preferred](kernfs_vnops.c.diff?r1=1.12;r2=1.12.2.1), [colored](kernfs_vnops.c.diff?r1=1.12;r2=1.12.2.1;f=h)

Changes since revision 1.12: +4 -4
lines
```

kernfs_vnops: averunnable changes.

```

---

Revision **1.12**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.12;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.12;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.12;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.12) - [select for diffs](kernfs_vnops.c?r1=1.12#rev1.12)

*Tue Sep 7 15:41:21 1993 UTC* (31 years, 4 months ago) by *ws*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.11: [preferred](kernfs_vnops.c.diff?r1=1.11;r2=1.12), [colored](kernfs_vnops.c.diff?r1=1.11;r2=1.12;f=h)

Changes since revision 1.11: +9 -3
lines
```

Changes to VFS readdir semantics
NFS changes for better cookie support
ISOFS changes for better Rockridge support and support for generation numbers

```

---

Revision **1.11**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.11;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.11;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.11;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.11) - [select for diffs](kernfs_vnops.c?r1=1.11#rev1.11)

*Mon Aug 2 23:00:57 1993 UTC* (31 years, 6 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.10: [preferred](kernfs_vnops.c.diff?r1=1.10;r2=1.11), [colored](kernfs_vnops.c.diff?r1=1.10;r2=1.11;f=h)

Changes since revision 1.10: +2 -1
lines
```

Make kernfs_print have a return type of void.

```

---

Revision **1.10**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.10;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.10;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.10;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.10) - [select for diffs](kernfs_vnops.c?r1=1.10#rev1.10)

*Mon Jun 7 05:25:25 1993 UTC* (31 years, 7 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [netbsd-0-9-patch-001](./kernfs_vnops.c?only_with_tag=netbsd-0-9-patch-001),
[netbsd-0-9-base](./kernfs_vnops.c?only_with_tag=netbsd-0-9-base),
[netbsd-0-9-RELEASE](./kernfs_vnops.c?only_with_tag=netbsd-0-9-RELEASE),
[netbsd-0-9-BETA](./kernfs_vnops.c?only_with_tag=netbsd-0-9-BETA),
[netbsd-0-9-ALPHA2](./kernfs_vnops.c?only_with_tag=netbsd-0-9-ALPHA2),
[netbsd-0-9-ALPHA](./kernfs_vnops.c?only_with_tag=netbsd-0-9-ALPHA),
[netbsd-0-9](./kernfs_vnops.c?only_with_tag=netbsd-0-9)

Diff to: previous 1.9: [preferred](kernfs_vnops.c.diff?r1=1.9;r2=1.10), [colored](kernfs_vnops.c.diff?r1=1.9;r2=1.10;f=h)

Changes since revision 1.9: +3 -3
lines
```

give various filesystems their own vnode types

```

---

Revision **1.9**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.9;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.9;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.9;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.9) - [select for diffs](kernfs_vnops.c?r1=1.9#rev1.9)

*Fri May 28 16:47:05 1993 UTC* (31 years, 8 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.8: [preferred](kernfs_vnops.c.diff?r1=1.8;r2=1.9), [colored](kernfs_vnops.c.diff?r1=1.8;r2=1.9;f=h)

Changes since revision 1.8: +191 -116
lines
```

add some more functionality: a setattr which supports chmod+chown+chgrp,
and the various support elsewhere to deal with it.

```

---

Revision **1.8**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.8;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.8;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.8;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.8) - [select for diffs](kernfs_vnops.c?r1=1.8#rev1.8)

*Fri May 28 14:12:17 1993 UTC* (31 years, 8 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.7: [preferred](kernfs_vnops.c.diff?r1=1.7;r2=1.8), [colored](kernfs_vnops.c.diff?r1=1.7;r2=1.8;f=h)

Changes since revision 1.7: +47 -6
lines
```

add kernfs_access function, to kill kernfs security hole

```

---

Revision **1.7**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.7;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.7;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.7;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.7) - [select for diffs](kernfs_vnops.c?r1=1.7#rev1.7)

*Thu May 20 04:01:31 1993 UTC* (31 years, 8 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.6: [preferred](kernfs_vnops.c.diff?r1=1.6;r2=1.7), [colored](kernfs_vnops.c.diff?r1=1.6;r2=1.7;f=h)

Changes since revision 1.6: +1 -1
lines
```

header cleanup

```

---

Revision **1.6**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.6;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.6;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.6;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.6) - [select for diffs](kernfs_vnops.c?r1=1.6#rev1.6)

*Tue Apr 27 10:06:10 1993 UTC* (31 years, 9 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.5: [preferred](kernfs_vnops.c.diff?r1=1.5;r2=1.6), [colored](kernfs_vnops.c.diff?r1=1.5;r2=1.6;f=h)

Changes since revision 1.5: +10 -4
lines
```

fix several off-by-one errors in hostname setting/reading

```

---

Revision **1.5**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.5;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.5;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.5;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.5) - [select for diffs](kernfs_vnops.c?r1=1.5#rev1.5)

*Tue Apr 27 07:21:37 1993 UTC* (31 years, 9 months ago) by *mycroft*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.4: [preferred](kernfs_vnops.c.diff?r1=1.4;r2=1.5), [colored](kernfs_vnops.c.diff?r1=1.4;r2=1.5;f=h)

Changes since revision 1.4: +2 -2
lines
```

Use EPERM when write permission is denied, not EBADF.

```

---

Revision **1.4**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.4;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.4;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.4;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.4) - [select for diffs](kernfs_vnops.c?r1=1.4#rev1.4)

*Sat Mar 27 00:37:11 1993 UTC* (31 years, 10 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

CVS tags: [netbsd-alpha-1](./kernfs_vnops.c?only_with_tag=netbsd-alpha-1),
[netbsd-0-8](./kernfs_vnops.c?only_with_tag=netbsd-0-8)

Diff to: previous 1.3: [preferred](kernfs_vnops.c.diff?r1=1.3;r2=1.4), [colored](kernfs_vnops.c.diff?r1=1.3;r2=1.4;f=h)

Changes since revision 1.3: +14 -1
lines
```

added ".." and support for "rrootdev"

```

---

Revision **1.3**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.3;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.3;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.3;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.3) - [select for diffs](kernfs_vnops.c?r1=1.3#rev1.3)

*Thu Mar 25 17:34:52 1993 UTC* (31 years, 10 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.2: [preferred](kernfs_vnops.c.diff?r1=1.2;r2=1.3), [colored](kernfs_vnops.c.diff?r1=1.2;r2=1.3;f=h)

Changes since revision 1.2: +2 -3
lines
```

fixed problem where you couldn't unmount after looking...

```

---

Revision **1.2**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.2;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.2;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.2;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.2) - [select for diffs](kernfs_vnops.c?r1=1.2#rev1.2)

*Thu Mar 25 06:00:24 1993 UTC* (31 years, 10 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)

Diff to: previous 1.1: [preferred](kernfs_vnops.c.diff?r1=1.1;r2=1.2), [colored](kernfs_vnops.c.diff?r1=1.1;r2=1.2;f=h)

Changes since revision 1.1: +28 -5
lines
```

changed copyright notice thanks to following statement:

Return-Path: jsp@compnews.co.uk
Received: from ben.uknet.ac.uk by postgres.Berkeley.EDU (5.61/1.29)
	id AA25983; Thu, 25 Mar 93 05:37:37 -0800
Received: from fennel.compnews.co.uk by ben.uknet.ac.uk via UKIP with SMTP (PP)
          id <g.05640-0@ben.uknet.ac.uk>; Thu, 25 Mar 1993 13:37:19 +0000
Received: from sage.compnews.co.uk by fennel.compnews.co.uk;
          Thu, 25 Mar 93 13:37:08 GMT
Message-Id: <28109.9303251337@sage.compnews.co.uk>
From: jsp@compnews.co.uk (Jan-Simon Pendry)
Date: Thu, 25 Mar 1993 13:37:05 +0100
In-Reply-To: cgd@postgres.berkeley.edu's message as of Mar 25, 5:32am.
Phone-Number-1: +44 430 432450
Phone-Number-2: +44 430 432480 x20
Fax-Number: +44 430 432022
X-Mailer: Mail User's Shell (7.2.5 10/14/92)
To: cgd@postgres.berkeley.edu
Subject: Re: fdesc/kernfs/etc code...

You may put this copyright message on the source code:

/*
 * Copyright (c) 1990, 1992 Jan-Simon Pendry
 * All rights reserved.
 *
 * This code is derived from software contributed to Berkeley by
 * Jan-Simon Pendry.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *      This product includes software developed by the University of
 *      California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 */

```

---

Revision **1.1**: [download](/bsdweb.cgi/~checkout~/src/sys/miscfs/kernfs/kernfs_vnops.c?rev=1.1;content-type=text%2Fx-csrc) - view: [text](kernfs_vnops.c?rev=1.1;content-type=text%2Fplain), [markup](kernfs_vnops.c?rev=1.1;content-type=text%2Fx-cvsweb-markup), [annotated](kernfs_vnops.c?annotate=1.1) - [select for diffs](kernfs_vnops.c?r1=1.1#rev1.1)

*Tue Mar 23 23:56:56 1993 UTC* (31 years, 10 months ago) by *cgd*

Branches: [MAIN](./kernfs_vnops.c?only_with_tag=MAIN)
```

files which implement the kern filesystem.  from Jan-Simon Pendry,
pendry@vangogh.cs.berkeley.edu

```

---

Diff request

This form allows you to request diffs between any two revisions of a file.
You may select a symbolic revision name using the selection box or you may
type in a numeric name using the type-in text box.

| Diffs between | Use Text Field yamt-x86pmap-base4 yamt-x86pmap-base3 yamt-x86pmap-base2 yamt-x86pmap-base yamt-x86pmap yamt-vop-base3 yamt-vop-base2 yamt-vop-base yamt-vop yamt-uio\_vmspace-base5 yamt-uio\_vmspace yamt-splraiseipl-base5 yamt-splraiseipl-base4 yamt-splraiseipl-base3 yamt-splraiseipl-base2 yamt-splraiseipl-base yamt-splraiseipl yamt-readahead-pervnode yamt-readahead-perfile yamt-readahead-base3 yamt-readahead-base2 yamt-readahead-base yamt-readahead yamt-pf42-baseX yamt-pf42-base4 yamt-pf42-base3 yamt-pf42-base2 yamt-pf42-base yamt-pf42 yamt-pdpolicy-base9 yamt-pdpolicy-base8 yamt-pdpolicy-base7 yamt-pdpolicy-base6 yamt-pdpolicy-base5 yamt-pdpolicy-base4 yamt-pdpolicy-base3 yamt-pdpolicy-base2 yamt-pdpolicy-base yamt-pdpolicy yamt-pagecache-tag8 yamt-pagecache-base9 yamt-pagecache-base8 yamt-pagecache-base7 yamt-pagecache-base6 yamt-pagecache-base5 yamt-pagecache-base4 yamt-pagecache-base3 yamt-pagecache-base2 yamt-pagecache-base yamt-pagecache yamt-nfs-mp-base9 yamt-nfs-mp-base8 yamt-nfs-mp-base7 yamt-nfs-mp-base6 yamt-nfs-mp-base5 yamt-nfs-mp-base4 yamt-nfs-mp-base3 yamt-nfs-mp-base2 yamt-nfs-mp-base11 yamt-nfs-mp-base10 yamt-nfs-mp-base yamt-nfs-mp yamt-lazymbuf-base15 yamt-lazymbuf-base14 yamt-lazymbuf yamt-kmem-base3 yamt-kmem-base2 yamt-kmem-base yamt-kmem yamt-km-base4 yamt-km-base3 yamt-km-base2 yamt-km-base yamt-km yamt-idlelwp-base8 yamt-idlelwp wrstuden-revivesa-base-4 wrstuden-revivesa-base-3 wrstuden-revivesa-base-2 wrstuden-revivesa-base-1 wrstuden-revivesa-base wrstuden-revivesa wrstuden-fixsa-newbase wrstuden-fixsa-base-1 wrstuden-fixsa-base wrstuden-fixsa wrstuden-devbsize-base wrstuden-devbsize-19991221 wrstuden-devbsize vmlocking2-base3 vmlocking2-base2 vmlocking2-base1 vmlocking2 vmlocking-nbase vmlocking-base vmlocking uebayasi-xip-base4 uebayasi-xip-base3 uebayasi-xip-base2 uebayasi-xip-base1 uebayasi-xip-base uebayasi-xip tls-maxphys-base-20171202 tls-maxphys-base tls-maxphys tls-earlyentropy-base tls-earlyentropy thorpej\_scsipi\_nbase thorpej\_scsipi\_beforemerge thorpej\_scsipi\_base thorpej\_scsipi thorpej-vnode-attr-base thorpej-vnode-attr thorpej-signal-base thorpej-signal thorpej-setroot thorpej-mips-cache-base thorpej-mips-cache thorpej-ifq-base thorpej-ifq thorpej-i2c-spi-conf2-base thorpej-i2c-spi-conf2 thorpej-i2c-spi-conf-base thorpej-i2c-spi-conf thorpej-futex2-base thorpej-futex2 thorpej-futex-base thorpej-futex thorpej-devvp-base3 thorpej-devvp-base2 thorpej-devvp-base thorpej-devvp thorpej-cfargs2-base thorpej-cfargs2 thorpej-cfargs-base thorpej-cfargs thorpej-atomic-base thorpej-atomic thorpej-altq-separation-base thorpej-altq-separation simonb-wapbl-nbase simonb-wapbl-base simonb-wapbl simonb-timecounters-base simonb-timecounters simonb-timcounters-final rpaulo-netinet-merge-pcb-base rpaulo-netinet-merge-pcb rmind-uvmplock-nbase rmind-uvmplock-base rmind-uvmplock rmind-smpnet-nbase rmind-smpnet-base rmind-smpnet riastradh-xf86-video-intel-2-7-1-pre-2-21-15 riastradh-drm2-base3 riastradh-drm2-base2 riastradh-drm2-base1 riastradh-drm2-base riastradh-drm2 reinoud-bufcleanup-nbase reinoud-bufcleanup-base reinoud-bufcleanup prg-localcount2-base3 prg-localcount2-base2 prg-localcount2-base1 prg-localcount2-base prg-localcount2 pre-chs-ubcperf post-newlock2-merge post-chs-ubcperf phil-wifi-base phil-wifi-20200421 phil-wifi-20200411 phil-wifi-20200406 phil-wifi-20191119 phil-wifi-20190609 phil-wifi pgoyette-localcount-base pgoyette-localcount-20170426 pgoyette-localcount-20170320 pgoyette-localcount-20170107 pgoyette-localcount-20161104 pgoyette-localcount-20160806 pgoyette-localcount-20160726 pgoyette-localcount pgoyette-compat-merge-20190127 pgoyette-compat-base pgoyette-compat-20190127 pgoyette-compat-20190118 pgoyette-compat-1226 pgoyette-compat-1126 pgoyette-compat-1020 pgoyette-compat-0930 pgoyette-compat-0906 pgoyette-compat-0728 pgoyette-compat-0625 pgoyette-compat-0521 pgoyette-compat-0502 pgoyette-compat-0422 pgoyette-compat-0415 pgoyette-compat-0407 pgoyette-compat-0330 pgoyette-compat-0322 pgoyette-compat-0315 pgoyette-compat peter-altq-base peter-altq perseant-stdc-iso10646-base perseant-stdc-iso10646 perseant-exfatfs-base-20240630 perseant-exfatfs-base perseant-exfatfs nick-nhusb-base-20170825 nick-nhusb-base-20170204 nick-nhusb-base-20161204 nick-nhusb-base-20161004 nick-nhusb-base-20160907 nick-nhusb-base-20160529 nick-nhusb-base-20160422 nick-nhusb-base-20160319 nick-nhusb-base-20151226 nick-nhusb-base-20150921 nick-nhusb-base-20150606 nick-nhusb-base-20150406 nick-nhusb-base nick-nhusb nick-net80211-sync-base nick-net80211-sync nick-hppapmap-base4 nick-hppapmap-base3 nick-hppapmap-base2 nick-hppapmap-base nick-hppapmap nick-csl-alignment-base5 nick-csl-alignment-base nick-csl-alignment newlock2-nbase newlock2-base newlock2 newlock-base newlock netbsd-alpha-1 netbsd-9-base netbsd-9-4-RELEASE netbsd-9-3-RELEASE netbsd-9-2-RELEASE netbsd-9-1-RELEASE netbsd-9-0-RELEASE netbsd-9-0-RC2 netbsd-9-0-RC1 netbsd-9 netbsd-8-base netbsd-8-3-RELEASE netbsd-8-2-RELEASE netbsd-8-1-RELEASE netbsd-8-1-RC1 netbsd-8-0-RELEASE netbsd-8-0-RC2 netbsd-8-0-RC1 netbsd-8 netbsd-7-nhusb-base-20170116 netbsd-7-nhusb-base netbsd-7-nhusb netbsd-7-base netbsd-7-2-RELEASE netbsd-7-1-RELEASE netbsd-7-1-RC2 netbsd-7-1-RC1 netbsd-7-1-2-RELEASE netbsd-7-1-1-RELEASE netbsd-7-1 netbsd-7-0-RELEASE netbsd-7-0-RC3 netbsd-7-0-RC2 netbsd-7-0-RC1 netbsd-7-0-2-RELEASE netbsd-7-0-1-RELEASE netbsd-7-0 netbsd-7 netbsd-6-base netbsd-6-1-RELEASE netbsd-6-1-RC4 netbsd-6-1-RC3 netbsd-6-1-RC2 netbsd-6-1-RC1 netbsd-6-1-5-RELEASE netbsd-6-1-4-RELEASE netbsd-6-1-3-RELEASE netbsd-6-1-2-RELEASE netbsd-6-1-1-RELEASE netbsd-6-1 netbsd-6-0-RELEASE netbsd-6-0-RC2 netbsd-6-0-RC1 netbsd-6-0-6-RELEASE netbsd-6-0-5-RELEASE netbsd-6-0-4-RELEASE netbsd-6-0-3-RELEASE netbsd-6-0-2-RELEASE netbsd-6-0-1-RELEASE netbsd-6-0 netbsd-6 netbsd-5-base netbsd-5-2-RELEASE netbsd-5-2-RC1 netbsd-5-2-3-RELEASE netbsd-5-2-2-RELEASE netbsd-5-2-1-RELEASE netbsd-5-2 netbsd-5-1-RELEASE netbsd-5-1-RC4 netbsd-5-1-RC3 netbsd-5-1-RC2 netbsd-5-1-RC1 netbsd-5-1-5-RELEASE netbsd-5-1-4-RELEASE netbsd-5-1-3-RELEASE netbsd-5-1-2-RELEASE netbsd-5-1-1-RELEASE netbsd-5-1 netbsd-5-0-RELEASE netbsd-5-0-RC4 netbsd-5-0-RC3 netbsd-5-0-RC2 netbsd-5-0-RC1 netbsd-5-0-2-RELEASE netbsd-5-0-1-RELEASE netbsd-5-0 netbsd-5 netbsd-4-base netbsd-4-0-RELEASE netbsd-4-0-RC5 netbsd-4-0-RC4 netbsd-4-0-RC3 netbsd-4-0-RC2 netbsd-4-0-RC1 netbsd-4-0-1-RELEASE netbsd-4-0 netbsd-4 netbsd-3-base netbsd-3-1-RELEASE netbsd-3-1-RC4 netbsd-3-1-RC3 netbsd-3-1-RC2 netbsd-3-1-RC1 netbsd-3-1-1-RELEASE netbsd-3-1 netbsd-3-0-RELEASE netbsd-3-0-RC6 netbsd-3-0-RC5 netbsd-3-0-RC4 netbsd-3-0-RC3 netbsd-3-0-RC2 netbsd-3-0-RC1 netbsd-3-0-3-RELEASE netbsd-3-0-2-RELEASE netbsd-3-0-1-RELEASE netbsd-3-0 netbsd-3 netbsd-2-base netbsd-2-1-RELEASE netbsd-2-1-RC6 netbsd-2-1-RC5 netbsd-2-1-RC4 netbsd-2-1-RC3 netbsd-2-1-RC2 netbsd-2-1-RC1 netbsd-2-1 netbsd-2-0-base netbsd-2-0-RELEASE netbsd-2-0-RC5 netbsd-2-0-RC4 netbsd-2-0-RC3 netbsd-2-0-RC2 netbsd-2-0-RC1 netbsd-2-0-3-RELEASE netbsd-2-0-2-RELEASE netbsd-2-0-1-RELEASE netbsd-2-0 netbsd-2 netbsd-10-base netbsd-10-1-RELEASE netbsd-10-0-RELEASE netbsd-10-0-RC6 netbsd-10-0-RC5 netbsd-10-0-RC4 netbsd-10-0-RC3 netbsd-10-0-RC2 netbsd-10-0-RC1 netbsd-10 netbsd-1-6-base netbsd-1-6-RELEASE netbsd-1-6-RC3 netbsd-1-6-RC2 netbsd-1-6-RC1 netbsd-1-6-PATCH002-RELEASE netbsd-1-6-PATCH002-RC4 netbsd-1-6-PATCH002-RC3 netbsd-1-6-PATCH002-RC2 netbsd-1-6-PATCH002-RC1 netbsd-1-6-PATCH002 netbsd-1-6-PATCH001-RELEASE netbsd-1-6-PATCH001-RC3 netbsd-1-6-PATCH001-RC2 netbsd-1-6-PATCH001-RC1 netbsd-1-6-PATCH001 netbsd-1-6 netbsd-1-5-base netbsd-1-5-RELEASE netbsd-1-5-PATCH003 netbsd-1-5-PATCH002 netbsd-1-5-PATCH001 netbsd-1-5-BETA2 netbsd-1-5-BETA netbsd-1-5-ALPHA2 netbsd-1-5 netbsd-1-4-base netbsd-1-4-RELEASE netbsd-1-4-PATCH003 netbsd-1-4-PATCH002 netbsd-1-4-PATCH001 netbsd-1-4 netbsd-1-3-base netbsd-1-3-RELEASE netbsd-1-3-PATCH003-CANDIDATE2 netbsd-1-3-PATCH003-CANDIDATE1 netbsd-1-3-PATCH003-CANDIDATE0 netbsd-1-3-PATCH003 netbsd-1-3-PATCH002 netbsd-1-3-PATCH001 netbsd-1-3-BETA netbsd-1-3 netbsd-1-2-base netbsd-1-2-RELEASE netbsd-1-2-PATCH001 netbsd-1-2-BETA netbsd-1-2 netbsd-1-1-base netbsd-1-1-RELEASE netbsd-1-1-PATCH001 netbsd-1-1 netbsd-1-0-base netbsd-1-0-RELEASE netbsd-1-0-PATCH1 netbsd-1-0-PATCH06 netbsd-1-0-PATCH05 netbsd-1-0-PATCH04 netbsd-1-0-PATCH03 netbsd-1-0-PATCH02 netbsd-1-0-PATCH0 netbsd-1-0 netbsd-0-9-patch-001 netbsd-0-9-base netbsd-0-9-RELEASE netbsd-0-9-BETA netbsd-0-9-ALPHA2 netbsd-0-9-ALPHA netbsd-0-9 netbsd-0-8 netbsd nathanw\_sa\_end nathanw\_sa\_before\_merge nathanw\_sa\_base nathanw\_sa mrg-vm-swap mjf-ufs-trans-base mjf-ufs-trans mjf-devfs2-base mjf-devfs2 mjf-devfs-base mjf-devfs minoura-xpg4dl-base minoura-xpg4dl matt-premerge-20091211 matt-nb8-mediatek-base matt-nb8-mediatek matt-nb6-plus-nbase matt-nb6-plus-base matt-nb6-plus matt-nb5-pq3-base matt-nb5-pq3 matt-nb5-mips64-u2-k2-k4-k7-k8-k9 matt-nb5-mips64-u1-k1-k5 matt-nb5-mips64-premerge-20101231 matt-nb5-mips64-premerge-20091211 matt-nb5-mips64-k15 matt-nb5-mips64 matt-nb4-mips64-k7-u2a-k9b matt-nb4-arm-base matt-nb4-arm matt-mips64-premerge-20101231 matt-mips64-base2 matt-mips64-base matt-mips64 matt-armv6-prevmlocking matt-armv6-nbase matt-armv6-base matt-armv6 marc-pcmcia-bp marc-pcmcia-base marc-pcmcia magnum-base magnum localcount-20160914 lite-2 lite-1 ktrace-lwp-base ktrace-lwp kqueue-beforemerge kqueue-base kqueue-aftermerge kqueue khorben-n900 kent-audio2-base kent-audio2 kent-audio1-beforemerge kent-audio1-base kent-audio1 kenh-if-detach-base kenh-if-detach keiichi-mipv6-nbase keiichi-mipv6-base keiichi-mipv6 kame\_14\_19990705 kame\_14\_19990628 kame\_141\_19991130 kame jymxensuspend-base jym-xensuspend-nbase jym-xensuspend-base jym-xensuspend jruoho-x86intr-base jruoho-x86intr jmcneill-usbmp-pre-base2 jmcneill-usbmp-base9 jmcneill-usbmp-base8 jmcneill-usbmp-base7 jmcneill-usbmp-base6 jmcneill-usbmp-base5 jmcneill-usbmp-base4 jmcneill-usbmp-base3 jmcneill-usbmp-base2 jmcneill-usbmp-base10 jmcneill-usbmp-base jmcneill-usbmp jmcneill-pm-base jmcneill-pm jmcneill-base jmcneill-audiomp3-base jmcneill-audiomp3 jdolecek-ncq-base jdolecek-ncq isaki-audio2-base isaki-audio2 is-newarp-before-merge is-newarp-base is-newarp is-mlppp-base is-mlppp ifpoll-base hpcarm-cleanup-nbase hpcarm-cleanup-base hpcarm-cleanup haad-nbase2 haad-dm-base2 haad-dm-base1 haad-dm-base haad-dm gmcgarry\_ucred\_base gmcgarry\_ucred gmcgarry\_ctxsw\_base gmcgarry\_ctxsw gehenna-devsw-base gehenna-devsw gdamore-uart-base gdamore-uart fvdl\_fs64\_base fvdl-softdep-base fvdl-softdep elad-kernelauth-base elad-kernelauth eeh-paddr\_t-base eeh-paddr\_t eeh-devprop-base eeh-devprop date-03-may-96 cube-autoconf-base cube-autoconf comdex-fall-1999-base comdex-fall-1999 cjep\_sun2x-base1 cjep\_sun2x-base cjep\_sun2x cjep\_staticlib\_x-base1 cjep\_staticlib\_x-base cjep\_staticlib\_x chs-ubc2-newbase chs-ubc2-base chs-ubc2 chs-ubc-base chs-ubc christos-time\_t-nbase christos-time\_t-base christos-time\_t cherry-xenmp-base cherry-xenmp chap-midi-nbase chap-midi-base chap-midi bouyer-xenpvh-base2 bouyer-xenpvh-base1 bouyer-xenpvh-base bouyer-xenpvh bouyer-xeni386-nbase bouyer-xeni386-merge1 bouyer-xeni386-base bouyer-xeni386 bouyer-xenamd64-base2 bouyer-xenamd64-base bouyer-xenamd64 bouyer-sunxi-drm-base bouyer-sunxi-drm bouyer-socketcan-base1 bouyer-socketcan-base bouyer-socketcan bouyer-scsipi bouyer-quota2-nbase bouyer-quota2-base bouyer-quota2 agc-symver-base agc-symver ad-socklock-base1 ad-namecache-base3 ad-namecache-base2 ad-namecache-base1 ad-namecache-base ad-namecache ad-audiomp2-base ad-audiomp2 ad-audiomp-base ad-audiomp abandoned-netbsd-4-base abandoned-netbsd-4 MAIN HEAD CSRG |  |
| --- | --- | --- |
| and | Use Text Field yamt-x86pmap-base4 yamt-x86pmap-base3 yamt-x86pmap-base2 yamt-x86pmap-base yamt-x86pmap yamt-vop-base3 yamt-vop-base2 yamt-vop-base yamt-vop yamt-uio\_vmspace-base5 yamt-uio\_vmspace yamt-splraiseipl-base5 yamt-splraiseipl-base4 yamt-splraiseipl-base3 yamt-splraiseipl-base2 yamt-splraiseipl-base yamt-splraiseipl yamt-readahead-pervnode yamt-readahead-perfile yamt-readahead-base3 yamt-readahead-base2 yamt-readahead-base yamt-readahead yamt-pf42-baseX yamt-pf42-base4 yamt-pf42-base3 yamt-pf42-base2 yamt-pf42-base yamt-pf42 yamt-pdpolicy-base9 yamt-pdpolicy-base8 yamt-pdpolicy-base7 yamt-pdpolicy-base6 yamt-pdpolicy-base5 yamt-pdpolicy-base4 yamt-pdpolicy-base3 yamt-pdpolicy-base2 yamt-pdpolicy-base yamt-pdpolicy yamt-pagecache-tag8 yamt-pagecache-base9 yamt-pagecache-base8 yamt-pagecache-base7 yamt-pagecache-base6 yamt-pagecache-base5 yamt-pagecache-base4 yamt-pagecache-base3 yamt-pagecache-base2 yamt-pagecache-base yamt-pagecache yamt-nfs-mp-base9 yamt-nfs-mp-base8 yamt-nfs-mp-base7 yamt-nfs-mp-base6 yamt-nfs-mp-base5 yamt-nfs-mp-base4 yamt-nfs-mp-base3 yamt-nfs-mp-base2 yamt-nfs-mp-base11 yamt-nfs-mp-base10 yamt-nfs-mp-base yamt-nfs-mp yamt-lazymbuf-base15 yamt-lazymbuf-base14 yamt-lazymbuf yamt-kmem-base3 yamt-kmem-base2 yamt-kmem-base yamt-kmem yamt-km-base4 yamt-km-base3 yamt-km-base2 yamt-km-base yamt-km yamt-idlelwp-base8 yamt-idlelwp wrstuden-revivesa-base-4 wrstuden-revivesa-base-3 wrstuden-revivesa-base-2 wrstuden-revivesa-base-1 wrstuden-revivesa-base wrstuden-revivesa wrstuden-fixsa-newbase wrstuden-fixsa-base-1 wrstuden-fixsa-base wrstuden-fixsa wrstuden-devbsize-base wrstuden-devbsize-19991221 wrstuden-devbsize vmlocking2-base3 vmlocking2-base2 vmlocking2-base1 vmlocking2 vmlocking-nbase vmlocking-base vmlocking uebayasi-xip-base4 uebayasi-xip-base3 uebayasi-xip-base2 uebayasi-xip-base1 uebayasi-xip-base uebayasi-xip tls-maxphys-base-20171202 tls-maxphys-base tls-maxphys tls-earlyentropy-base tls-earlyentropy thorpej\_scsipi\_nbase thorpej\_scsipi\_beforemerge thorpej\_scsipi\_base thorpej\_scsipi thorpej-vnode-attr-base thorpej-vnode-attr thorpej-signal-base thorpej-signal thorpej-setroot thorpej-mips-cache-base thorpej-mips-cache thorpej-ifq-base thorpej-ifq thorpej-i2c-spi-conf2-base thorpej-i2c-spi-conf2 thorpej-i2c-spi-conf-base thorpej-i2c-spi-conf thorpej-futex2-base thorpej-futex2 thorpej-futex-base thorpej-futex thorpej-devvp-base3 thorpej-devvp-base2 thorpej-devvp-base thorpej-devvp thorpej-cfargs2-base thorpej-cfargs2 thorpej-cfargs-base thorpej-cfargs thorpej-atomic-base thorpej-atomic thorpej-altq-separation-base thorpej-altq-separation simonb-wapbl-nbase simonb-wapbl-base simonb-wapbl simonb-timecounters-base simonb-timecounters simonb-timcounters-final rpaulo-netinet-merge-pcb-base rpaulo-netinet-merge-pcb rmind-uvmplock-nbase rmind-uvmplock-base rmind-uvmplock rmind-smpnet-nbase rmind-smpnet-base rmind-smpnet riastradh-xf86-video-intel-2-7-1-pre-2-21-15 riastradh-drm2-base3 riastradh-drm2-base2 riastradh-drm2-base1 riastradh-drm2-base riastradh-drm2 reinoud-bufcleanup-nbase reinoud-bufcleanup-base reinoud-bufcleanup prg-localcount2-base3 prg-localcount2-base2 prg-localcount2-base1 prg-localcount2-base prg-localcount2 pre-chs-ubcperf post-newlock2-merge post-chs-ubcperf phil-wifi-base phil-wifi-20200421 phil-wifi-20200411 phil-wifi-20200406 phil-wifi-20191119 phil-wifi-20190609 phil-wifi pgoyette-localcount-base pgoyette-localcount-20170426 pgoyette-localcount-20170320 pgoyette-localcount-20170107 pgoyette-localcount-20161104 pgoyette-localcount-20160806 pgoyette-localcount-20160726 pgoyette-localcount pgoyette-compat-merge-20190127 pgoyette-compat-base pgoyette-compat-20190127 pgoyette-compat-20190118 pgoyette-compat-1226 pgoyette-compat-1126 pgoyette-compat-1020 pgoyette-compat-0930 pgoyette-compat-0906 pgoyette-compat-0728 pgoyette-compat-0625 pgoyette-compat-0521 pgoyette-compat-0502 pgoyette-compat-0422 pgoyette-compat-0415 pgoyette-compat-0407 pgoyette-compat-0330 pgoyette-compat-0322 pgoyette-compat-0315 pgoyette-compat peter-altq-base peter-altq perseant-stdc-iso10646-base perseant-stdc-iso10646 perseant-exfatfs-base-20240630 perseant-exfatfs-base perseant-exfatfs nick-nhusb-base-20170825 nick-nhusb-base-20170204 nick-nhusb-base-20161204 nick-nhusb-base-20161004 nick-nhusb-base-20160907 nick-nhusb-base-20160529 nick-nhusb-base-20160422 nick-nhusb-base-20160319 nick-nhusb-base-20151226 nick-nhusb-base-20150921 nick-nhusb-base-20150606 nick-nhusb-base-20150406 nick-nhusb-base nick-nhusb nick-net80211-sync-base nick-net80211-sync nick-hppapmap-base4 nick-hppapmap-base3 nick-hppapmap-base2 nick-hppapmap-base nick-hppapmap nick-csl-alignment-base5 nick-csl-alignment-base nick-csl-alignment newlock2-nbase newlock2-base newlock2 newlock-base newlock netbsd-alpha-1 netbsd-9-base netbsd-9-4-RELEASE netbsd-9-3-RELEASE netbsd-9-2-RELEASE netbsd-9-1-RELEASE netbsd-9-0-RELEASE netbsd-9-0-RC2 netbsd-9-0-RC1 netbsd-9 netbsd-8-base netbsd-8-3-RELEASE netbsd-8-2-RELEASE netbsd-8-1-RELEASE netbsd-8-1-RC1 netbsd-8-0-RELEASE netbsd-8-0-RC2 netbsd-8-0-RC1 netbsd-8 netbsd-7-nhusb-base-20170116 netbsd-7-nhusb-base netbsd-7-nhusb netbsd-7-base netbsd-7-2-RELEASE netbsd-7-1-RELEASE netbsd-7-1-RC2 netbsd-7-1-RC1 netbsd-7-1-2-RELEASE netbsd-7-1-1-RELEASE netbsd-7-1 netbsd-7-0-RELEASE netbsd-7-0-RC3 netbsd-7-0-RC2 netbsd-7-0-RC1 netbsd-7-0-2-RELEASE netbsd-7-0-1-RELEASE netbsd-7-0 netbsd-7 netbsd-6-base netbsd-6-1-RELEASE netbsd-6-1-RC4 netbsd-6-1-RC3 netbsd-6-1-RC2 netbsd-6-1-RC1 netbsd-6-1-5-RELEASE netbsd-6-1-4-RELEASE netbsd-6-1-3-RELEASE netbsd-6-1-2-RELEASE netbsd-6-1-1-RELEASE netbsd-6-1 netbsd-6-0-RELEASE netbsd-6-0-RC2 netbsd-6-0-RC1 netbsd-6-0-6-RELEASE netbsd-6-0-5-RELEASE netbsd-6-0-4-RELEASE netbsd-6-0-3-RELEASE netbsd-6-0-2-RELEASE netbsd-6-0-1-RELEASE netbsd-6-0 netbsd-6 netbsd-5-base netbsd-5-2-RELEASE netbsd-5-2-RC1 netbsd-5-2-3-RELEASE netbsd-5-2-2-RELEASE netbsd-5-2-1-RELEASE netbsd-5-2 netbsd-5-1-RELEASE netbsd-5-1-RC4 netbsd-5-1-RC3 netbsd-5-1-RC2 netbsd-5-1-RC1 netbsd-5-1-5-RELEASE netbsd-5-1-4-RELEASE netbsd-5-1-3-RELEASE netbsd-5-1-2-RELEASE netbsd-5-1-1-RELEASE netbsd-5-1 netbsd-5-0-RELEASE netbsd-5-0-RC4 netbsd-5-0-RC3 netbsd-5-0-RC2 netbsd-5-0-RC1 netbsd-5-0-2-RELEASE netbsd-5-0-1-RELEASE netbsd-5-0 netbsd-5 netbsd-4-base netbsd-4-0-RELEASE netbsd-4-0-RC5 netbsd-4-0-RC4 netbsd-4-0-RC3 netbsd-4-0-RC2 netbsd-4-0-RC1 netbsd-4-0-1-RELEASE netbsd-4-0 netbsd-4 netbsd-3-base netbsd-3-1-RELEASE netbsd-3-1-RC4 netbsd-3-1-RC3 netbsd-3-1-RC2 netbsd-3-1-RC1 netbsd-3-1-1-RELEASE netbsd-3-1 netbsd-3-0-RELEASE netbsd-3-0-RC6 netbsd-3-0-RC5 netbsd-3-0-RC4 netbsd-3-0-RC3 netbsd-3-0-RC2 netbsd-3-0-RC1 netbsd-3-0-3-RELEASE netbsd-3-0-2-RELEASE netbsd-3-0-1-RELEASE netbsd-3-0 netbsd-3 netbsd-2-base netbsd-2-1-RELEASE netbsd-2-1-RC6 netbsd-2-1-RC5 netbsd-2-1-RC4 netbsd-2-1-RC3 netbsd-2-1-RC2 netbsd-2-1-RC1 netbsd-2-1 netbsd-2-0-base netbsd-2-0-RELEASE netbsd-2-0-RC5 netbsd-2-0-RC4 netbsd-2-0-RC3 netbsd-2-0-RC2 netbsd-2-0-RC1 netbsd-2-0-3-RELEASE netbsd-2-0-2-RELEASE netbsd-2-0-1-RELEASE netbsd-2-0 netbsd-2 netbsd-10-base netbsd-10-1-RELEASE netbsd-10-0-RELEASE netbsd-10-0-RC6 netbsd-10-0-RC5 netbsd-10-0-RC4 netbsd-10-0-RC3 netbsd-10-0-RC2 netbsd-10-0-RC1 netbsd-10 netbsd-1-6-base netbsd-1-6-RELEASE netbsd-1-6-RC3 netbsd-1-6-RC2 netbsd-1-6-RC1 netbsd-1-6-PATCH002-RELEASE netbsd-1-6-PATCH002-RC4 netbsd-1-6-PATCH002-RC3 netbsd-1-6-PATCH002-RC2 netbsd-1-6-PATCH002-RC1 netbsd-1-6-PATCH002 netbsd-1-6-PATCH001-RELEASE netbsd-1-6-PATCH001-RC3 netbsd-1-6-PATCH001-RC2 netbsd-1-6-PATCH001-RC1 netbsd-1-6-PATCH001 netbsd-1-6 netbsd-1-5-base netbsd-1-5-RELEASE netbsd-1-5-PATCH003 netbsd-1-5-PATCH002 netbsd-1-5-PATCH001 netbsd-1-5-BETA2 netbsd-1-5-BETA netbsd-1-5-ALPHA2 netbsd-1-5 netbsd-1-4-base netbsd-1-4-RELEASE netbsd-1-4-PATCH003 netbsd-1-4-PATCH002 netbsd-1-4-PATCH001 netbsd-1-4 netbsd-1-3-base netbsd-1-3-RELEASE netbsd-1-3-PATCH003-CANDIDATE2 netbsd-1-3-PATCH003-CANDIDATE1 netbsd-1-3-PATCH003-CANDIDATE0 netbsd-1-3-PATCH003 netbsd-1-3-PATCH002 netbsd-1-3-PATCH001 netbsd-1-3-BETA netbsd-1-3 netbsd-1-2-base netbsd-1-2-RELEASE netbsd-1-2-PATCH001 netbsd-1-2-BETA netbsd-1-2 netbsd-1-1-base netbsd-1-1-RELEASE netbsd-1-1-PATCH001 netbsd-1-1 netbsd-1-0-base netbsd-1-0-RELEASE netbsd-1-0-PATCH1 netbsd-1-0-PATCH06 netbsd-1-0-PATCH05 netbsd-1-0-PATCH04 netbsd-1-0-PATCH03 netbsd-1-0-PATCH02 netbsd-1-0-PATCH0 netbsd-1-0 netbsd-0-9-patch-001 netbsd-0-9-base netbsd-0-9-RELEASE netbsd-0-9-BETA netbsd-0-9-ALPHA2 netbsd-0-9-ALPHA netbsd-0-9 netbsd-0-8 netbsd nathanw\_sa\_end nathanw\_sa\_before\_merge nathanw\_sa\_base nathanw\_sa mrg-vm-swap mjf-ufs-trans-base mjf-ufs-trans mjf-devfs2-base mjf-devfs2 mjf-devfs-base mjf-devfs minoura-xpg4dl-base minoura-xpg4dl matt-premerge-20091211 matt-nb8-mediatek-base matt-nb8-mediatek matt-nb6-plus-nbase matt-nb6-plus-base matt-nb6-plus matt-nb5-pq3-base matt-nb5-pq3 matt-nb5-mips64-u2-k2-k4-k7-k8-k9 matt-nb5-mips64-u1-k1-k5 matt-nb5-mips64-premerge-20101231 matt-nb5-mips64-premerge-20091211 matt-nb5-mips64-k15 matt-nb5-mips64 matt-nb4-mips64-k7-u2a-k9b matt-nb4-arm-base matt-nb4-arm matt-mips64-premerge-20101231 matt-mips64-base2 matt-mips64-base matt-mips64 matt-armv6-prevmlocking matt-armv6-nbase matt-armv6-base matt-armv6 marc-pcmcia-bp marc-pcmcia-base marc-pcmcia magnum-base magnum localcount-20160914 lite-2 lite-1 ktrace-lwp-base ktrace-lwp kqueue-beforemerge kqueue-base kqueue-aftermerge kqueue khorben-n900 kent-audio2-base kent-audio2 kent-audio1-beforemerge kent-audio1-base kent-audio1 kenh-if-detach-base kenh-if-detach keiichi-mipv6-nbase keiichi-mipv6-base keiichi-mipv6 kame\_14\_19990705 kame\_14\_19990628 kame\_141\_19991130 kame jymxensuspend-base jym-xensuspend-nbase jym-xensuspend-base jym-xensuspend jruoho-x86intr-base jruoho-x86intr jmcneill-usbmp-pre-base2 jmcneill-usbmp-base9 jmcneill-usbmp-base8 jmcneill-usbmp-base7 jmcneill-usbmp-base6 jmcneill-usbmp-base5 jmcneill-usbmp-base4 jmcneill-usbmp-base3 jmcneill-usbmp-base2 jmcneill-usbmp-base10 jmcneill-usbmp-base jmcneill-usbmp jmcneill-pm-base jmcneill-pm jmcneill-base jmcneill-audiomp3-base jmcneill-audiomp3 jdolecek-ncq-base jdolecek-ncq isaki-audio2-base isaki-audio2 is-newarp-before-merge is-newarp-base is-newarp is-mlppp-base is-mlppp ifpoll-base hpcarm-cleanup-nbase hpcarm-cleanup-base hpcarm-cleanup haad-nbase2 haad-dm-base2 haad-dm-base1 haad-dm-base haad-dm gmcgarry\_ucred\_base gmcgarry\_ucred gmcgarry\_ctxsw\_base gmcgarry\_ctxsw gehenna-devsw-base gehenna-devsw gdamore-uart-base gdamore-uart fvdl\_fs64\_base fvdl-softdep-base fvdl-softdep elad-kernelauth-base elad-kernelauth eeh-paddr\_t-base eeh-paddr\_t eeh-devprop-base eeh-devprop date-03-may-96 cube-autoconf-base cube-autoconf comdex-fall-1999-base comdex-fall-1999 cjep\_sun2x-base1 cjep\_sun2x-base cjep\_sun2x cjep\_staticlib\_x-base1 cjep\_staticlib\_x-base cjep\_staticlib\_x chs-ubc2-newbase chs-ubc2-base chs-ubc2 chs-ubc-base chs-ubc christos-time\_t-nbase christos-time\_t-base christos-time\_t cherry-xenmp-base cherry-xenmp chap-midi-nbase chap-midi-base chap-midi bouyer-xenpvh-base2 bouyer-xenpvh-base1 bouyer-xenpvh-base bouyer-xenpvh bouyer-xeni386-nbase bouyer-xeni386-merge1 bouyer-xeni386-base bouyer-xeni386 bouyer-xenamd64-base2 bouyer-xenamd64-base bouyer-xenamd64 bouyer-sunxi-drm-base bouyer-sunxi-drm bouyer-socketcan-base1 bouyer-socketcan-base bouyer-socketcan bouyer-scsipi bouyer-quota2-nbase bouyer-quota2-base bouyer-quota2 agc-symver-base agc-symver ad-socklock-base1 ad-namecache-base3 ad-namecache-base2 ad-namecache-base1 ad-namecache-base ad-namecache ad-audiomp2-base ad-audiomp2 ad-audiomp-base ad-audiomp abandoned-netbsd-4-base abandoned-netbsd-4 MAIN HEAD CSRG |  |

Log view options

| Preferred diff type: | Colored Long colored Unified Context Side by side |  |
| --- | --- | --- |
| View only branch: | Show all branches yamt-x86pmap yamt-vop yamt-uio\_vmspace yamt-splraiseipl yamt-readahead yamt-pf42 yamt-pdpolicy yamt-pagecache yamt-nfs-mp yamt-lazymbuf yamt-kmem yamt-km yamt-idlelwp wrstuden-revivesa wrstuden-fixsa wrstuden-devbsize vmlocking2 vmlocking uebayasi-xip tls-maxphys tls-earlyentropy thorpej\_scsipi thorpej-vnode-attr thorpej-signal thorpej-setroot thorpej-mips-cache thorpej-ifq thorpej-i2c-spi-conf2 thorpej-i2c-spi-conf thorpej-futex2 thorpej-futex thorpej-devvp thorpej-cfargs2 thorpej-cfargs thorpej-atomic thorpej-altq-separation simonb-wapbl simonb-timecounters rpaulo-netinet-merge-pcb rmind-uvmplock rmind-smpnet riastradh-drm2 reinoud-bufcleanup prg-localcount2 phil-wifi pgoyette-localcount pgoyette-compat peter-altq perseant-stdc-iso10646 perseant-exfatfs nick-nhusb nick-net80211-sync nick-hppapmap nick-csl-alignment newlock2 newlock netbsd-9 netbsd-8 netbsd-7-nhusb netbsd-7-1 netbsd-7-0 netbsd-7 netbsd-6-1 netbsd-6-0 netbsd-6 netbsd-5-2 netbsd-5-1 netbsd-5-0 netbsd-5 netbsd-4-0 netbsd-4 netbsd-3-1 netbsd-3-0 netbsd-3 netbsd-2-1 netbsd-2-0 netbsd-2 netbsd-10 netbsd-1-6 netbsd-1-5 netbsd-1-4 netbsd-1-3 netbsd-1-2 netbsd-1-1 netbsd-1-0 netbsd-0-9 nathanw\_sa mrg-vm-swap mjf-ufs-trans mjf-devfs2 mjf-devfs minoura-xpg4dl matt-nb8-mediatek matt-nb6-plus matt-nb5-pq3 matt-nb5-mips64 matt-nb4-arm matt-mips64 matt-armv6 marc-pcmcia magnum ktrace-lwp kqueue khorben-n900 kent-audio2 kent-audio1 kenh-if-detach keiichi-mipv6 kame jym-xensuspend jruoho-x86intr jmcneill-usbmp jmcneill-pm jmcneill-audiomp3 jdolecek-ncq isaki-audio2 is-newarp is-mlppp hpcarm-cleanup haad-dm gmcgarry\_ucred gmcgarry\_ctxsw gehenna-devsw gdamore-uart fvdl-softdep elad-kernelauth eeh-paddr\_t eeh-devprop cube-autoconf comdex-fall-1999 cjep\_sun2x cjep\_staticlib\_x chs-ubc2 chs-ubc christos-time\_t cherry-xenmp chap-midi bouyer-xenpvh bouyer-xeni386 bouyer-xenamd64 bouyer-sunxi-drm bouyer-socketcan bouyer-scsipi bouyer-quota2 agc-symver ad-namecache ad-audiomp2 ad-audiomp abandoned-netbsd-4 MAIN |  |
| Sort log by: | Not sorted Commit date Revision |  |

---

CVSweb <webmaster@jp.NetBSD.org>

