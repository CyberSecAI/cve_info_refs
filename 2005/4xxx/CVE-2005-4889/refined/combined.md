=== Content from access.redhat.com_61b77640_20250126_043811.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.mandriva.com_b73bab5c_20250124_235433.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from bugzilla.redhat.com_03c62d5d_20250124_235434.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D125517)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D125517)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D125517)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 125517

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 125517**](show_bug.cgi?id=125517)
- [CVE-2005-4889](https://access.redhat.com/security/cve/CVE-2005-4889) rpm: Updates leave hardlinked copies untouched.

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2005-4889 rpm: Updates leave hardlinked copies untouched.

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED UPSTREAM | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | rpm | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 3 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Paul Nasrat | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Mike McLean | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [FC5Blocker](show_bug.cgi?id=150222 "CLOSED CURRENTRELEASE - FC5 Blocker Tracker") [CVE-2005-4889](show_bug.cgi?id=625756 "CLOSED ERRATA - CVE-2005-4889 rpm: fails to drop SUID/SGID bits on package removal") | | TreeView+ | [depends on](buglist.cgi?bug_id=125517&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=125517&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2004-06-08 13:57 UTC by Michael Schröder | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2010-08-20 11:23 UTC ([History](show_activity.cgi?id=125517)) | | [CC List:](page.cgi?id=fields.html#cclist) | 5 users (show)  jlieskov mattdm n3npq pmatilai vdanen | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2005-11-04 13:38:47 UTC | | | Type: | --- | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Proposed patch**](attachment.cgi?id=100965 "View the content of the attachment") (3.28 KB, patch)  [2004-06-08 13:57 UTC](#attach_100965 "Go to the comment associated with the attachment"), Michael Schröder | *no flags* | [Details](attachment.cgi?id=100965&action=edit) | [Diff](attachment.cgi?id=100965&action=diff) | | [**cvs diff**](attachment.cgi?id=419033 "View the content of the attachment") (1.98 KB, text/plain)  [2010-06-02 13:31 UTC](#attach_419033 "Go to the comment associated with the attachment"), Jeff Johnson | *no flags* | [Details](attachment.cgi?id=419033&action=edit) | | [View All](attachment.cgi?bugid=125517&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=125517#c0)  Michael Schröder    2004-06-08 13:57:07 UTC  ``` If a malicious creates a hardlink to a buggy s-bit program the  system is still compromised even after a fixed version has been  installed. The attached fix removes the s-bits from files that  get updated.   ```  [Comment 1](show_bug.cgi?id=125517#c1)  Michael Schröder    2004-06-08 13:57:40 UTC  ``` Created [attachment 100965](attachment.cgi?id=100965&action=diff "Proposed patch") [[details]](attachment.cgi?id=100965&action=edit "Proposed patch") Proposed patch   ```  [Comment 2](show_bug.cgi?id=125517#c2)  Matthew Miller    2005-04-26 16:37:56 UTC  ``` Fedora Core 2 is now maintained by the Fedora Legacy project for security updates only. If this problem is a security issue, please reopen and reassign to the Fedora Legacy product. If it is not a security issue and hasn't been resolved in the current FC3 updates or in the FC4 test release, reopen and change the version to match.   ```  [Comment 3](show_bug.cgi?id=125517#c3)  Michael Schröder    2005-04-26 16:48:43 UTC  ``` Hmm, good question. I leave it to your security group to decide if it's a  security issue or not. For now, I've changed the product to FC3.    ```  [Comment 4](show_bug.cgi?id=125517#c4)  Matthew Miller    2005-04-26 17:59:40 UTC  ``` Hmmm. I can see how that might be an issue. I'm going to clone this into Fedora Legacy as well as leaving in FC3. Thanks.   ```  [Comment 5](show_bug.cgi?id=125517#c5)  Paul Nasrat    2005-04-26 22:13:47 UTC  ``` Adding security group and flag - will look at thanks.   ```  [Comment 7](show_bug.cgi?id=125517#c7)  Jeff Johnson    2005-11-04 13:38:47 UTC  ``` This patch should probably be done in other ways, but is ok for what the patch does.  Patch added to rpm cvs, should be in rpm-4.4.3-0.35 when built.   ```  [Comment 8](show_bug.cgi?id=125517#c8)  Michael Schröder    2010-06-02 13:00:58 UTC  ``` (Argh, you didn't apply the chunk that removes the bits in the FSM_RENAME case! See [bug #598775](show_bug.cgi?id=598775 "CLOSED ERRATA - CVE-2010-2059 rpm: fails to drop SUID/SGID bits on package upgrade"))   ```  [Comment 9](show_bug.cgi?id=125517#c9)  Jeff Johnson    2010-06-02 13:31:35 UTC  ``` Created [attachment 419033](attachment.cgi?id=419033 "cvs diff") [[details]](attachment.cgi?id=419033&action=edit "cvs diff") cvs diff  Patch to FSM_RENAME case was applied on 15 Nov 2005 20:06:53 exactly as stated.   ```  [Comment 10](show_bug.cgi?id=125517#c10)  Michael Schröder    2010-06-02 14:22:33 UTC  ``` Hmm, must have been a different branch. I just see the commit by Paul done Apr 16 13:26:12 2007, which doesn't contain it. rpm-4.4.2.3 also doesn't contain the FSM_RENAME part. Anyway, what's done is done. I don't want to do any finger pointing.   ```  [Comment 11](show_bug.cgi?id=125517#c11)  Jeff Johnson    2010-06-02 14:29:25 UTC  ``` You chose to add the comment here with "you" attached.  And not a different branch, 4.4.2 (on which @rpm.org is based) != 4.4.3.   ```  [Comment 12](show_bug.cgi?id=125517#c12)  Michael Schröder    2010-06-04 09:49:17 UTC  ``` (Turns out that maybe I'm the one to blame. I seem to have dropped the chunk by accident when porting the patch from 4.1.1 to 4.4.2, and Paul took it from out version. Hard to tell after such a long time.)   ```  [Comment 13](show_bug.cgi?id=125517#c13)  Jeff Johnson    2010-06-04 12:54:07 UTC  ``` Yes its been a long time and removing setuid/setgid (and capabilities and acls and ...) is a tedious issue which (if deserving of a CVE firedrill) also means that this rpmbuild issue also needs a CVE (imho its a far more serious issue):      Name: tag with malicious syntax in spec files can be used to remove home directories:               Name: foo;~      can trick rpmbuild into removing home directories and worse.  Then there's %verifyscript that is run multiple times, and the flaw saving/restoring the chroot directory using embedded lua (also from you and incorrect).  So it goes ... *shrug* ... Have fun!   ```  [Comment 14](show_bug.cgi?id=125517#c14)  Vincent Danen    2010-06-14 19:52:56 UTC  ``` MITRE assigned the name [CVE-2005-4889](https://access.redhat.com/security/cve/CVE-2005-4889) to this issue.  Applying the alias here as per [bug #598775 comment #27](show_bug.cgi?id=598775#c27 "CLOSED ERRATA - CVE-2010-2059 rpm: fails to drop SUID/SGID bits on package upgrade").   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=125517&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_0d7af318_20250124_235436.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D598775)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D598775)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D598775)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 598775

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 598775**](show_bug.cgi?id=598775)
(CVE-2010-2059)
- [CVE-2010-2059](https://access.redhat.com/security/cve/CVE-2010-2059) rpm: fails to drop SUID/SGID bits on package upgrade

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2010-2059 rpm: fails to drop SUID/SGID bits on package upgrade

| | [Keywords](describekeywords.cgi): | Reopened  Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2010-2059 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [598832](show_bug.cgi?id=598832) [598934](show_bug.cgi?id=598934 "CLOSED ERRATA - rpm: Fails to remove the SUID/SGID bits on package upgrade [Fedora all]") [626707](show_bug.cgi?id=626707) [626708](show_bug.cgi?id=626708) [626709](show_bug.cgi?id=626709) [626710](show_bug.cgi?id=626710) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=598775&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=598775&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2010-06-02 02:37 UTC by Matt McCutchen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:36 UTC ([History](show_activity.cgi?id=598775)) | | [CC List:](page.cgi?id=fields.html#cclist) | 8 users (show)  ffesti jlieskov jnovy ksrot mls pinto.elia pmatilai vdanen | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Clones: | [598832](show_bug.cgi?id=598832)  ([view as bug list](buglist.cgi?bug_id=598832)) | | | Environment: |  | | | Last Closed: | 2012-02-14 13:57:11 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**SRPM for testing this bug**](attachment.cgi?id=418879 "View the content of the attachment") (2.14 KB, application/x-rpm)  [2010-06-02 02:37 UTC](#attach_418879 "Go to the comment associated with the attachment"), Matt McCutchen | *no flags* | [Details](attachment.cgi?id=418879&action=edit) | | [**SRPM reproducer, compatible also with older RHELs/Fedoras**](attachment.cgi?id=418968 "View the content of the attachment") (1.94 KB, application/x-rpm)  [2010-06-02 09:10 UTC](#attach_418968 "Go to the comment associated with the attachment"), Jindrich Novy | *no flags* | [Details](attachment.cgi?id=418968&action=edit) | | [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=598775&action=viewall&hide_obsolete=1) | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2010:0678](https://access.redhat.com/errata/RHSA-2010%3A0678) | 0 | normal | SHIPPED\_LIVE | Moderate: rpm security update | 2010-09-07 14:35:00 UTC | | Red Hat Product Errata | [RHSA-2010:0679](https://access.redhat.com/errata/RHSA-2010%3A0679) | 0 | normal | SHIPPED\_LIVE | Moderate: rpm security and bug fix update | 2010-09-07 14:32:33 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=598775#c0)  Matt McCutchen    2010-06-02 02:37:02 UTC  ``` Created [attachment 418879](attachment.cgi?id=418879 "SRPM for testing this bug") [[details]](attachment.cgi?id=418879&action=edit "SRPM for testing this bug") SRPM for testing this bug  Description of problem: When RPM replaces an executable, it does not clear the setuid and setgid bits of the old file.  Thus, if a user made a hard link to the old executable, he/she will still be able to run it with elevated privileges.  This is bad if it was replaced because it had a vulnerability.  The problem seems to occur only when executables are replaced, not when they are erased.  This is the same bug that was previously noted in dpkg: <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=225692>  Version-Release number of selected component (if applicable): rpm-4.8.0-14.fc13.x86_64  How reproducible: Always  Steps to Reproduce: 1. Rebuild the attached SRPM twice, once with -D 'rel 1' and once with -D 'rel 2'. 2. mkdir /tmp/rpm-setuid-test 3. rpm -i rpm-setuid-test-0-1.fc13.$(rpm -E '%{_build_arch}').rpm 4. ln /usr/bin/rpm-setuid-test /tmp/rpm-setuid-test/ 5. rpm -U rpm-setuid-test-0-2.fc13.$(rpm -E '%{_build_arch}').rpm 6. ls -l /tmp/rpm-setuid-test/rpm-setuid-test  Actual results: The old executable is setuid.  Expected results: The old executable is not setuid.   ```  [Comment 1](show_bug.cgi?id=598775#c1)  Panu Matilainen    2010-06-02 05:04:52 UTC  ``` Ah, good catch. Rpm does actually remove the SUID/SGID bits when removing packages, but not on upgrade. Will fix...   ```  [Comment 2](show_bug.cgi?id=598775#c2)  Panu Matilainen    2010-06-02 06:31:54 UTC  ``` Fixed upstream + building for rawhide now, updates to released versions to follow (AFAIK this affects every single released rpm version out there...)   ```  [Comment 3](show_bug.cgi?id=598775#c3)  Jan Lieskovsky    2010-06-02 08:44:04 UTC  ``` Upstream patch for the SUID/SGID bits removal part:   [1] <http://rpm.org/gitweb?p=rpm.git;a=commit;h=ca2d6b2b484f1501eafdde02e1688409340d2383>  Upstream patch for the POSIX file capabilities removal part:   [2] <http://rpm.org/gitweb?p=rpm.git;a=commitdiff;h=4d172a194addc49851e558ea390d3045894e3230>   ```  [Comment 5](show_bug.cgi?id=598775#c5)  Jindrich Novy    2010-06-02 09:10:04 UTC  ``` Created [attachment 418968](attachment.cgi?id=418968 "SRPM reproducer, compatible also with older RHELs/Fedoras") [[details]](attachment.cgi?id=418968&action=edit "SRPM reproducer, compatible also with older RHELs/Fedoras") SRPM reproducer, compatible also with older RHELs/Fedoras  This src.rpm is the same as the original one but recreated with md5 digests and gz payload so that it is installable even on older RHELs/Fedoras.   ```  [Comment 10](show_bug.cgi?id=598775#c10)  Jan Lieskovsky    2010-06-02 11:23:31 UTC  ``` Information about vulnerable package versions:    1, SUID/SGID bits removal part:     This issue affects the versions of the rpm package,     as shipped with Red Hat Enterprise Linux 3, 4, and 5.      This issue affects the versions of the rpm package,     as shipped with Fedora releases of 11, 12, and 13.    2, POSIX file capabilities removal part:     This issue DO not affect the versions of the rpm package,     as shipped with Red Hat Enterprise Linux 3, 4, and 5     (POSIX file capabilities were introduced starting      from v2.6.24 version of the Linux kernel).      This issue affects (in sense of vulnerable code part     presence) the versions of the rpm package, as shipped     with Fedora releases of 11, 12, and 13. Though the     file capability support is NOT used in these rpm     versions yet.   ```  [Comment 11](show_bug.cgi?id=598775#c11)  Jan Lieskovsky    2010-06-02 11:45:04 UTC  ``` CVE Request:   [1] <http://www.openwall.com/lists/oss-security/2010/06/02/2>   ```  [Comment 12](show_bug.cgi?id=598775#c12)  Michael Schröder    2010-06-02 13:03:40 UTC  ``` Sigh, my original patch from 2005 ([bug #125517](show_bug.cgi?id=125517 "CLOSED UPSTREAM - CVE-2005-4889 rpm: Updates leave hardlinked copies untouched.")) already had that change for the FSM_RENAME case, but the chunk somehow was lost when the patch was integrated...   ```  [Comment 13](show_bug.cgi?id=598775#c13)  Jan Lieskovsky    2010-06-04 08:34:45 UTC  ``` This is [CVE-2010-2059](https://access.redhat.com/security/cve/CVE-2010-2059).   ```  [Comment 14](show_bug.cgi?id=598775#c14)  Panu Matilainen    2010-06-04 08:45:32 UTC  ``` (In reply to [comment #12](show_bug.cgi?id=598775#c12)) > Sigh, my original patch from 2005 ([bug #125517](show_bug.cgi?id=125517 "CLOSED UPSTREAM - CVE-2005-4889 rpm: Updates leave hardlinked copies untouched.")) already had that change for the > FSM_RENAME case, but the chunk somehow was lost when the patch was > integrated...      I get access denied for [bug 125517](show_bug.cgi?id=125517 "CLOSED UPSTREAM - CVE-2005-4889 rpm: Updates leave hardlinked copies untouched.") for whatever reason... But regardless of where, how and when the chunk got lost, AFAICT there's no FSM_RENAME chunk in rpm-4.4.2 based OpenSUSE (sbitcheck.diff, which is probably the one that got applied to current rpm.org tree) and SLED versions (in rpm-4.4.2.diff). So you'll at least want to double-check the situation in your distros too.   ```  [Comment 15](show_bug.cgi?id=598775#c15)  Jan Lieskovsky    2010-06-04 09:19:50 UTC  ``` (In reply to [comment #14](show_bug.cgi?id=598775#c14)) > (In reply to [comment #12](show_bug.cgi?id=598775#c12)) > I get access denied for [bug 125517](show_bug.cgi?id=125517 "CLOSED UPSTREAM - CVE-2005-4889 rpm: Updates leave hardlinked copies untouched.") for whatever reason... But regardless of  Added you to that bug.  > where, how and when the chunk got lost, AFAICT there's no FSM_RENAME chunk in > rpm-4.4.2 based OpenSUSE (sbitcheck.diff, which is probably the one that got > applied to current rpm.org tree) and SLED versions (in rpm-4.4.2.diff). So > you'll at least want to double-check the situation in your distros too.   ```  [Comment 16](show_bug.cgi?id=598775#c16)  Panu Matilainen    2010-06-04 09:28:47 UTC  ``` (In reply to [comment #10](show_bug.cgi?id=598775#c10)) > Information about vulnerable package versions: > >   2, POSIX file capabilities removal part: >     This issue DO not affect the versions of the rpm package, >     as shipped with Red Hat Enterprise Linux 3, 4, and 5 >     (POSIX file capabilities were introduced starting >      from v2.6.24 version of the Linux kernel). >  >     This issue affects (in sense of vulnerable code part >     presence) the versions of the rpm package, as shipped >     with Fedora releases of 11, 12, and 13. Though the >     file capability support is NOT used in these rpm >     versions yet.      A slight correction/clarification: rpm in Fedora >= 11 comes with file capability packaging support enabled, but to my knowledge this feature is not /used/ by any packages in any distribution (Fedora or otherwise) yet.   Another twist is that the file capability support is a compile-time optional feature, and rpm will only be able to drop capabilities from hardlinks IFF capability support is enabled in rpm itself by --with-cap option to configure. Thus it's recommended that rpm is always built with --with-cap option on distributions with filesystem level support for POSIX file capabilities to enable rpm to drop capabilities potentially set by administrators/package scriptlets.   ```  [Comment 17](show_bug.cgi?id=598775#c17)  Michael Schröder    2010-06-04 09:42:12 UTC  ``` #14: Yes, all suse versions with have rpm >= 4.4.2.3 are vulnerable, too. The ones with 4.1.1 are not vulnerable, as they use the original patch.  I wonder why it's not in rpm-4.4.2.diff, I can't remember how I generated the diff. Maybe I didn't apply the hunk and Paul took the patch from our rpm-4.4.2 diff, so maybe I'm to blame for this mess.   ```  [Comment 18](show_bug.cgi?id=598775#c18)  Panu Matilainen    2010-06-04 11:06:01 UTC  ``` (In reply to [comment #17](show_bug.cgi?id=598775#c17)) > #14: Yes, all suse versions with have rpm >= 4.4.2.3 are vulnerable, too. The > ones with 4.1.1 are not vulnerable, as they use the original patch.  AFAICT not just rpm >= 4.4.2.3 but rpm >= 4.4.2.  > I wonder why it's not in rpm-4.4.2.diff, I can't remember how I generated the > diff. Maybe I didn't apply the hunk and Paul took the patch from our rpm-4.4.2 > diff, so maybe I'm to blame for this mess.      No fingerpointing intended. You reported the issue with a complete patch in bugzilla, at that point a wrong patch ending up in the rpm.org tree (years after the fact) is hardly your fault either.   ```  [Comment 21](show_bug.cgi?id=598775#c21)  Vincent Danen    2010-06-08 22:49:06 UTC  ``` See [bug #601955](show_bug.cgi?id=601955 "CLOSED ERRATA - CVE-2010-2198 rpm: fails to drop POSIX file capabilities on package upgrade or removal") for [CVE-2010-2198](https://access.redhat.com/security/cve/CVE-2010-2198) (rpm: fails to drop POSIX file capabilities/SELinux context information on package upgrade or removal)  See [bug #601956](show_bug.cgi?id=601956 "CLOSED NOTABUG - CVE-2010-2199 rpm: fails to drop POSIX ACLs on package upgrade or removal") for [CVE-2010-2199](https://access.redhat.com/security/cve/CVE-2010-2199) (rpm: fails to drop POSIX ACLs on package upgrade or removal)   ```  [Comment 22](show_bug.cgi?id=598775#c22)  Panu Matilainen    2010-06-09 09:10:25 UTC  ``` Err, this is getting rather mixed up.  The issues at hand are 1) RPM fails to drop SUID/SGID bits on package upgrade (and removal for rpm < 4.4.2.1) 2) RPM fails to drop POSIX file capabilities on package upgrade and removal, which is simply the more fine-grained analogue of case 1). This only affects systems with filesystem-level support for POSIX file capabilities.  IMO there's little point having separate CVE's for the cases but if we must ... at least lets get the descriptions straight. POSIX ACL's and SELinux contexts aren't involved as they dont have additional means to gain extra privileges through execution AFAICT.   ```  [Comment 23](show_bug.cgi?id=598775#c23)  Fedora Update System    2010-06-11 11:41:59 UTC  ``` rpm-4.8.1-1.fc13 has been submitted as an update for Fedora 13. <http://admin.fedoraproject.org/updates/rpm-4.8.1-1.fc13>   ```  [Comment 24](show_bug.cgi?id=598775#c24)  Fedora Update System    2010-06-11 12:35:17 UTC  ``` rpm-4.8.1-1.fc13 has been submitted as an update for Fedora 13. <http://admin.fedoraproject.org/updates/rpm-4.8.1-1.fc13>   ```  [Comment 25](show_bug.cgi?id=598775#c25)  Matt McCutchen    2010-06-11 20:11:26 UTC  ``` I realized that hard links are not the only way to retain access to an old executable.  The attacker can simply open it and later exec it via /proc/self/fd.  On some filesystems (in my testing, ext2 but not reiserfs), the attacker can even resurrect the file using linkat(2) with AT_SYMLINK_FOLLOW.  So, Panu, your commit 89be57ad9239c9ada0cba94a5003876b456d46bf is wrong; please revert it.   ```  [Comment 26](show_bug.cgi?id=598775#c26)  Vincent Danen    2010-06-12 01:28:56 UTC  ``` MITRE also assigned [CVE-2005-4889](https://access.redhat.com/security/cve/CVE-2005-4889) to this issue:  lib/fsm.c in RPM before 4.4.3 does not properly reset the metadata of an executable file during deletion of the file in an RPM package removal, which might allow local users to gain privileges by creating a hard link to a vulnerable (1) setuid or (2) setgid file, a related issue to [CVE-2010-2059](https://access.redhat.com/security/cve/CVE-2010-2059).  This is because [CVE-2010-2059](https://access.redhat.com/security/cve/CVE-2010-2059) specifically refers to RPM package upgrades, whereas [CVE-2005-4889](https://access.redhat.com/security/cve/CVE-2005-4889) specifically refers to RPM package removals (because SUSE had addressed the removal aspect previously, but not the upgrade aspect).   ```  [Comment 27](show_bug.cgi?id=598775#c27)  Matt McCutchen    2010-06-12 02:27:45 UTC  ``` The failure to clear set[ug]id bits on package removal ([CVE-2005-4889](https://access.redhat.com/security/cve/CVE-2005-4889)) was addressed a long time ago in [bug 125517](show_bug.cgi?id=125517 "CLOSED UPSTREAM - CVE-2005-4889 rpm: Updates leave hardlinked copies untouched.").  It is not within the scope of this bug.   ```  [Comment 28](show_bug.cgi?id=598775#c28)  Panu Matilainen    2010-06-14 07:53:15 UTC  ``` (In reply to [comment #25](show_bug.cgi?id=598775#c25)) > I realized that hard links are not the only way to retain access to an old > executable.  The attacker can simply open it and later exec it via > /proc/self/fd.  On some filesystems (in my testing, ext2 but not reiserfs), the > attacker can even resurrect the file using linkat(2) with AT_SYMLINK_FOLLOW.  > So, Panu, your commit 89be57ad9239c9ada0cba94a5003876b456d46bf is wrong; please > revert it.      Mm... open() requires read (or write, duh) permission on the file, which no program with SUID/SGID bits enabled should have. Sure the link count test could be removed, it's there only to avoid unnecessary work in the common case. This just raises the question: how far should rpm go babysitting packagers/admins? Disallow creating packages with SUID/SGID on readable/writable files? If an admin changes permissions of an executable to something "vulnerable", is it rpm's job to try and mop it under the carpet?   ```  [Comment 29](show_bug.cgi?id=598775#c29)  Matt McCutchen    2010-06-14 12:45:53 UTC  ``` (In reply to [comment #28](show_bug.cgi?id=598775#c28)) > (In reply to [comment #25](show_bug.cgi?id=598775#c25)) > > I realized that hard links are not the only way to retain access to an old > > executable.  The attacker can simply open it and later exec it via > > /proc/self/fd.  On some filesystems (in my testing, ext2 but not reiserfs), the > > attacker can even resurrect the file using linkat(2) with AT_SYMLINK_FOLLOW.  > > So, Panu, your commit 89be57ad9239c9ada0cba94a5003876b456d46bf is wrong; please > > revert it.     >  > Mm... open() requires read (or write, duh) permission on the file, which no > program with SUID/SGID bits enabled should have.  Where is that documented?  Feel free to file bugs on all the packages that don't comply:  $ find / -xdev -type f -perm /004 -perm +6000 -ls 2>/dev/null -rwsr-xr-x   1 root     root        32472 Feb 13 20:40 /bin/su -rwsr-xr-x   1 root     root        37864 Mar  5 03:58 /bin/ping -rwsr-xr-x   1 root     root        74680 May 19 07:50 /bin/mount -rwsr-xr-x   1 root     root        32504 Mar  5 03:58 /bin/ping6 -rwsr-xr-x   1 root     root        49280 May 19 07:50 /bin/umount -rwsr-xr-x   1 root     root        28744 Jun  8 01:13 /bin/fusermount -rwsr-xr-x   1 root     root        57728 Mar 19 02:56 /usr/bin/at -r-xr-sr-x   1 root     tty         11104 Apr 26 06:00 /usr/bin/wall -rwsr-sr-x   1 root     root        49416 Feb 19 03:42 /usr/bin/crontab -rwsr-xr-x   1 root     root        59440 Apr 28 09:34 /usr/bin/chage -rwxr-sr-x   1 root     tty         12024 May 19 07:50 /usr/bin/write [...]  > Sure the link count test could > be removed, it's there only to avoid unnecessary work in the common case.  Clearing the set[ug]id bits is conditioned on the executable being set[ug]id in the first place, which is not the common case, so the unnecessary work there should be minimal.  This concern applies more to file capabilities.   ```  [Comment 30](show_bug.cgi?id=598775#c30)  Fedora Update System    2010-06-30 10:43:37 UTC  ``` rpm-4.7.2-2.fc12 has been submitted as an update for Fedora 12. <http://admin.fedoraproject.org/updates/rpm-4.7.2-2.fc12>   ```  [Comment 31](show_bug.cgi?id=598775#c31)  Fedora Update System    2010-07-06 17:10:16 UTC  ``` rpm-4.7.2-2.fc12 has been pushed to the Fedora 12 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 32](show_bug.cgi?id=598775#c32)  Fedora Update System    2010-07-07 17:42:52 UTC  ``` rpm-4.8.1-2.fc13 has been pushed to the Fedora 13 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 33](show_bug.cgi?id=598775#c33)  Matt McCutchen    2010-08-14 07:21:02 UTC  ``` As per [bug 598934 comment #4](show_bug.cgi?id=598934#c4 "CLOSED ERRATA - rpm: Fails to remove the SUID/SGID bits on package upgrade [Fedora all]"), this is fixed in Fedora.   ```  [Comment 37](show_bug.cgi?id=598775#c37)  Matt McCutchen    2010-08-24 19:01:56 UTC  ``` Tomas, why did you change the "whiteboard" field to values that do not match <https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-2059> ?   ```  [Comment 38](show_bug.cgi?id=598775#c38)  Tomas Hoger    2010-08-25 08:23:02 UTC  ``` Whiteboard contains our score, it's not just a copy-n-paste of NVD one.  In this case, NVD score does not follow 3.1.1 #1 scoring guide guideline.   ```  [Comment 39](show_bug.cgi?id=598775#c39)  errata-xmlrpc    2010-09-07 14:32:38 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 5  Via RHSA-2010:0679 <https://rhn.redhat.com/errata/RHSA-2010-0679.html>   ```  [Comment 40](show_bug.cgi?id=598775#c40)  errata-xmlrpc    2010-09-07 14:35:23 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 4  Via RHSA-2010:0678 <https://rhn.redhat.com/errata/RHSA-2010-0678.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=598775&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from access.redhat.com_8f16b6d9_20250126_043811.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


