```
{
  "vulnerability_details": {
    "root_cause": "The rpm package manager does not properly reset the metadata of an executable file during package updates or removal when a file with setuid or setgid bits is replaced.",
    "weaknesses": [
      "The rpm package manager fails to remove setuid/setgid bits from old executable files during package updates, and in older versions during package removal.",
      "Failure to clear POSIX file capabilities on package upgrade and removal (more fine-grained version of setuid/setgid issue)."
    ],
    "impact": "Local users can gain elevated privileges by creating a hard link to a vulnerable setuid or setgid file. After an update, the hardlinked old file retains its setuid/setgid bits, enabling exploitation if the updated version addresses a vulnerability.",
    "attack_vectors": [
      "Creating hard links to vulnerable setuid/setgid executables before updates.",
      "Opening a vulnerable executable and later executing it via /proc/self/fd",
      "On some filesystems, using linkat(2) with AT_SYMLINK_FOLLOW to resurrect the old executable."
    ],
    "attacker_capabilities": "A local user is required to create a hard link to a setuid/setgid executable before an update is applied.",
        "more_details": "The issue was initially discovered in 2004 and a patch was proposed. However, during integration the patch was incomplete and did not correctly handle the FSM_RENAME case. The vulnerability was rediscovered in 2010 as an upgrade issue, and the original flaw was assigned CVE-2005-4889, while the upgrade issue was assigned CVE-2010-2059. The problem is exacerbated by the fact that setuid/setgid bits are not uncommon and are applied to readable/writable files, meaning that the attacker can easily exploit the vulnerability after a patch using the link method or using /proc/self/fd to access the old file. The root cause is that rpm did not properly remove s-bits during updates or in older versions during removals leaving a way to exploit updated software."
  }
}
```