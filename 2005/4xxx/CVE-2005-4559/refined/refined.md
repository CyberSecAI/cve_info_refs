```
{
  "vulnerability_details": [
    {
      "root_cause": "Improper initialization of variables and insufficient input validation within IceWarp Web Mail's PHP scripts.",
      "weaknesses": [
        "Use of 'register_globals' in PHP, allowing external manipulation of variables.",
        "Lack of sanitization of 'language' and 'lang_settings' variables in `/accounts/inc/include.php` and `/admin/inc/include.php`.",
        "Lack of validation of the 'lang' parameter in `/dir/include.html`.",
        "Insufficient input validation for the 'language' parameter in `/mail/settings.html`",
        "Improper handling of HTTP_USER_AGENT strings in `/mail/include.html`"
      ],
      "impact": "Remote code execution with SYSTEM privileges (without authentication or requiring valid logon), sensitive information disclosure, arbitrary file inclusion.",
      "attack_vectors": [
        "Directly accessing vulnerable scripts and manipulating parameters through HTTP requests.",
          "Using a non-standard user agent string to trigger a vulnerability within the `mail/include.html` script"
      ],
      "attacker_capabilities": "The attacker can be remote and does not necessarily need authentication for some of the exploitation vectors, and valid login credentials for others."
    },
        {
      "root_cause": "Multiple file inclusion vulnerabilities due to improper input validation and the use of the register_globals feature in PHP",
      "weaknesses": [
          "register_globals enabled in PHP",
          "Lack of proper input sanitization in `/accounts/inc/include.php` and `/admin/inc/include.php` with the variables 'language' and 'lang_settings'",
          "Lack of proper input sanitization in `/dir/include.html` for the 'lang' parameter",
           "Lack of proper input sanitization in `/mail/settings.html` for the 'language' parameter",
            "Improper handling of HTTP_USER_AGENT strings in `/mail/include.html` leading to improper initialization of `default_layout` and `layout_settings` variables"
        ],
      "impact": "Remote code execution (with system privileges), sensitive information disclosure, arbitrary file inclusion.",
      "attack_vectors": [
        "HTTP requests with specially crafted parameters to trigger file inclusion vulnerabilities in various PHP scripts, which results in arbitrary code execution or sensitive information disclosure."
      ],
     "attacker_capabilities": "An attacker can be remote and may or may not need valid login credentials based on the exploitation vector"
    }
  ]
}
```