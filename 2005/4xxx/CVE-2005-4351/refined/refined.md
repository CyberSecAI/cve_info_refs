- **Root cause of vulnerability:** The vulnerability lies in the ability to mask immutable files by mounting another filesystem over the directory containing the immutable file or by using mount --bind to replace the immutable file with another file.
- **Weaknesses/vulnerabilities present:** The core weakness is that the "immutable" flag only prevents permanent changes to a file's content but does not prevent masking of the file by mounting other filesystems. This circumvents the intended protection of securelevels by allowing replacement of critical system files at runtime.
- **Impact of exploitation:** An attacker can effectively replace arbitrary system files, including critical executables, with malicious versions. They can also intercept sensitive information like passwords by masking files associated with security level changes. This enables the creation of rootkits that can persist and hide on a compromised system.
- **Attack vectors:** The attack vector involves mounting a filesystem (e.g., NFS) or using the `mount --bind` command on an existing filesystem to mask immutable files.
- **Required attacker capabilities/position:** The attacker needs to have root privileges on the system to perform the mount operations. They also need to be able to create or access another filesystem to mount (e.g., an NFS share).