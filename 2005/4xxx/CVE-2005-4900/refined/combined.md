=== Content from security.googleblog.com_8a18ed49_20250125_220446.html ===


![](https://ad.doubleclick.net/ddm/activity/src=2542116;type=gblog;cat=googl0;ord=1?)

[![](https://www.gstatic.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png)](https://security.googleblog.com/)
[## Security Blog](/.)

The latest news and insights from Google on security and safety on the Internet

## [Announcing the first SHA1 collision](https://security.googleblog.com/2017/02/announcing-first-sha1-collision.html "Announcing the first SHA1 collision")

February 23, 2017

Posted by Marc Stevens (CWI Amsterdam), Elie Bursztein (Google), Pierre Karpman (CWI Amsterdam), Ange Albertini (Google), Yarik Markov (Google), Alex Petit Bianco (Google), Clement Baisse (Google)

Cryptographic hash functions like SHA-1 are a cryptographer’s swiss army knife. You’ll find that hashes play a role in browser security, managing code repositories, or even just detecting duplicate files in storage. Hash functions compress large amounts of data into a small message digest. As a cryptographic requirement for wide-spread use, finding two messages that lead to the same digest should be computationally infeasible. Over time however, this requirement can fail due to [attacks on the mathematical underpinnings](https://www.schneier.com/blog/archives/2005/02/cryptanalysis_o.html) of hash functions or to increases in computational power.

Today, more than 20 years after of SHA-1 was first introduced, we are announcing the first practical technique for generating a collision. This represents the culmination of two years of research that sprung from a collaboration between the [CWI Institute in Amsterdam](https://www.cwi.nl/) and Google. We’ve summarized how we went about generating a collision below. As a proof of the attack, we are [releasing two PDFs](https://shattered.it/) that have identical SHA-1 hashes but different content.

For the tech community, our findings emphasize the necessity of sunsetting SHA-1 usage. Google has advocated the deprecation of SHA-1 for many years, particularly when it comes to signing TLS certificates. As early as 2014, the Chrome team [announced](https://security.googleblog.com/2014/09/gradually-sunsetting-sha-1.html) that they would gradually phase out using SHA-1. We hope our practical attack on SHA-1 will cement that the protocol should no longer be considered secure.

We hope that our practical attack against SHA-1 will finally convince the industry that it is urgent to move to safer alternatives such as SHA-256.

**What is a cryptographic hash collision?**

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi0O8jFjzaPKx0oQTgwbcaBQBjsgIF-2hng-Olj_QcImcjHkUaG1eddSMmNhFEtK5TwMVDf39C8rCqXviMVs98nif_afUOkc-K-rO_plbWp6eM11oLI0HSXTYIDPNZ2vrYVbMWHSla1RYg5/s640/Collision-illustrated.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi0O8jFjzaPKx0oQTgwbcaBQBjsgIF-2hng-Olj_QcImcjHkUaG1eddSMmNhFEtK5TwMVDf39C8rCqXviMVs98nif_afUOkc-K-rO_plbWp6eM11oLI0HSXTYIDPNZ2vrYVbMWHSla1RYg5/s1600/Collision-illustrated.png)
A collision occurs when two distinct pieces of data—a document, a binary, or a website’s certificate—hash to the same digest as shown above. In practice, collisions should never occur for secure hash functions. However if the hash algorithm has some flaws, as SHA-1 does, a well-funded attacker can craft a collision. The attacker could then use this collision to deceive systems that rely on hashes into accepting a malicious file in place of its benign counterpart. For example, two insurance contracts with drastically different terms.

**Finding the SHA-1 collision**

In 2013, [Marc Stevens](https://marc-stevens.nl/research/) published a paper that outlined a theoretical approach to create a SHA-1 collision. We started by creating a [PDF prefix](https://shattered.io/static/pdf_format.png) specifically crafted to allow us to generate two documents with arbitrary distinct visual contents, but that would hash to the same SHA-1 digest. In building this theoretical attack in practice we had to overcome some new challenges. We then leveraged Google’s technical expertise and cloud infrastructure to compute the collision which is one of the largest computations ever completed.

Here are some numbers that give a sense of how large scale this computation was:

* Nine quintillion (9,223,372,036,854,775,808) SHA1 computations in total
* 6,500 years of CPU computation to complete the attack first phase
* 110 years of GPU computation to complete the second phase

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjHn4nXyAb-rWoCRQdj3ulHkDcbHd6YbYyWywDUfxx6l11CeXdVnOzmx7sShRQlCXeXmwl_IaYARhnCDa5CEgXLMZIhxpaeg8XU6UyDawuhRYTj1f5rygLbtYRk4zAEI6ZJhAf-C8s7wgp4/s640/complexity+compared.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjHn4nXyAb-rWoCRQdj3ulHkDcbHd6YbYyWywDUfxx6l11CeXdVnOzmx7sShRQlCXeXmwl_IaYARhnCDa5CEgXLMZIhxpaeg8XU6UyDawuhRYTj1f5rygLbtYRk4zAEI6ZJhAf-C8s7wgp4/s1600/complexity%2Bcompared.png)

While those numbers seem very large, the SHA-1 shattered attack is still more than 100,000 times faster than a brute force attack which remains impractical.

**Mitigating the risk of SHA-1 collision attacks**

Moving forward, it’s more urgent than ever for security practitioners to migrate to safer cryptographic hashes such as SHA-256 and SHA-3. Following [Google’s vulnerability disclosure policy](https://security.googleblog.com/2015/02/feedback-and-data-driven-updates-to.html), we will wait 90 days before releasing code that allows anyone to create a pair of PDFs that hash to the same SHA-1 sum given two distinct images with some pre-conditions. In order to prevent this attack from active use, we’ve added protections for Gmail and GSuite users that detects our PDF collision technique. Furthermore, we are providing a [free detection system](http://shattered.io/) to the public.

You can find more details about the SHA-1 attack and detailed research outlining our techniques [here](https://shattered.io/).

**About the team**

This result is the product of a long-term collaboration between the CWI institute and Google’s Research security, privacy and anti-abuse group.

[Marc Stevens](https://marc-stevens.nl/research/) and [Elie Bursztein](https://www.elie.net/) started collaborating on making Marc’s cryptanalytic attacks against SHA-1 practical using Google infrastructure. [Ange Albertini](http://corkami.github.io/) developed the PDF attack, [Pierre Karpman](http://pages.saclay.inria.fr/pierre.karpman/) worked on the cryptanalysis and the GPU implementation, [Yarik Markov](https://www.ymarkov.me/) took care of the distributed GPU code, [Alex Petit Bianco](http://serialhacker.org/) implemented the collision detector to protect Google users and Clement Baisse oversaw the reliability of the computations.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjia29Y6WJ1f0vkdlLeMbsdF4t9Wgpji5CoGAvv5m3MjsUxzymz2O4M4PsD5GOe17g5h8WcvLUwRWu2-UR7acHws9sPZioI6CGoEfNw6ybC2nOCkR8vxdMHhBDwzlFQazRWUWkRBnJCcoHz/s1600/shattered-infographic.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjia29Y6WJ1f0vkdlLeMbsdF4t9Wgpji5CoGAvv5m3MjsUxzymz2O4M4PsD5GOe17g5h8WcvLUwRWu2-UR7acHws9sPZioI6CGoEfNw6ybC2nOCkR8vxdMHhBDwzlFQazRWUWkRBnJCcoHz/s1600/shattered-infographic.png)

![Share on Twitter](https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png)

![Share on Facebook](https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png)

[Google](https://plus.google.com/112374322230920073195)

#### No comments :

[Post a Comment](https://www.blogger.com/comment/fullpage/post/1176949257541686127/4437088076545312484)

[**](https://security.googleblog.com/)
[**](https://security.googleblog.com/2017/02/e2email-research-project-has-left-nest_24.html "Newer Post")

[**](https://security.googleblog.com/2017/02/another-option-for-file-sharing.html "Older Post")

![](data:image/png;base64...)
## Labels

**

* [#sharethemicincyber](https://security.googleblog.com/search/label/%23sharethemicincyber)
* [#supplychain #security #opensource](https://security.googleblog.com/search/label/%23supplychain%20%23security%20%23opensource)
* [android](https://security.googleblog.com/search/label/android)
* [android security](https://security.googleblog.com/search/label/android%20security)
* [android tr](https://security.googleblog.com/search/label/android%20tr)
* [app security](https://security.googleblog.com/search/label/app%20security)
* [big data](https://security.googleblog.com/search/label/big%20data)
* [biometrics](https://security.googleblog.com/search/label/biometrics)
* [blackhat](https://security.googleblog.com/search/label/blackhat)
* [C++](https://security.googleblog.com/search/label/C%2B%2B)
* [chrome](https://security.googleblog.com/search/label/chrome)
* [chrome enterprise](https://security.googleblog.com/search/label/chrome%20enterprise)
* [chrome security](https://security.googleblog.com/search/label/chrome%20security)
* [connected devices](https://security.googleblog.com/search/label/connected%20devices)
* [CTF](https://security.googleblog.com/search/label/CTF)
* [diversity](https://security.googleblog.com/search/label/diversity)
* [encryption](https://security.googleblog.com/search/label/encryption)
* [federated learning](https://security.googleblog.com/search/label/federated%20learning)
* [fuzzing](https://security.googleblog.com/search/label/fuzzing)
* [Gboard](https://security.googleblog.com/search/label/Gboard)
* [google play](https://security.googleblog.com/search/label/google%20play)
* [google play protect](https://security.googleblog.com/search/label/google%20play%20protect)
* [hacking](https://security.googleblog.com/search/label/hacking)
* [interoperability](https://security.googleblog.com/search/label/interoperability)
* [iot security](https://security.googleblog.com/search/label/iot%20security)
* [kubernetes](https://security.googleblog.com/search/label/kubernetes)
* [linux kernel](https://security.googleblog.com/search/label/linux%20kernel)
* [memory safety](https://security.googleblog.com/search/label/memory%20safety)
* [Open Source](https://security.googleblog.com/search/label/Open%20Source)
* [pha family highlights](https://security.googleblog.com/search/label/pha%20family%20highlights)
* [pixel](https://security.googleblog.com/search/label/pixel)
* [privacy](https://security.googleblog.com/search/label/privacy)
* [private compute core](https://security.googleblog.com/search/label/private%20compute%20core)
* [Rowhammer](https://security.googleblog.com/search/label/Rowhammer)
* [rust](https://security.googleblog.com/search/label/rust)
* [Security](https://security.googleblog.com/search/label/Security)
* [security rewards program](https://security.googleblog.com/search/label/security%20rewards%20program)
* [sigstore](https://security.googleblog.com/search/label/sigstore)
* [spyware](https://security.googleblog.com/search/label/spyware)
* [supply chain](https://security.googleblog.com/search/label/supply%20chain)
* [targeted spyware](https://security.googleblog.com/search/label/targeted%20spyware)
* [tensor](https://security.googleblog.com/search/label/tensor)
* [Titan M2](https://security.googleblog.com/search/label/Titan%20M2)
* [VDP](https://security.googleblog.com/search/label/VDP)
* [vulnerabilities](https://security.googleblog.com/search/label/vulnerabilities)
* [workshop](https://security.googleblog.com/search/label/workshop)

**
## Archive

**

* **

  **
  [2025](https://security.googleblog.com/2025/)

  + [Jan](https://security.googleblog.com/2025/01/)

* **

  **
  [2024](https://security.googleblog.com/2024/)

  + [Dec](https://security.googleblog.com/2024/12/)
  + [Nov](https://security.googleblog.com/2024/11/)
  + [Oct](https://security.googleblog.com/2024/10/)
  + [Sep](https://security.googleblog.com/2024/09/)
  + [Aug](https://security.googleblog.com/2024/08/)
  + [Jul](https://security.googleblog.com/2024/07/)
  + [Jun](https://security.googleblog.com/2024/06/)
  + [May](https://security.googleblog.com/2024/05/)
  + [Apr](https://security.googleblog.com/2024/04/)
  + [Mar](https://security.googleblog.com/2024/03/)
  + [Feb](https://security.googleblog.com/2024/02/)
  + [Jan](https://security.googleblog.com/2024/01/)

* **

  **
  [2023](https://security.googleblog.com/2023/)

  + [Dec](https://security.googleblog.com/2023/12/)
  + [Nov](https://security.googleblog.com/2023/11/)
  + [Oct](https://security.googleblog.com/2023/10/)
  + [Sep](https://security.googleblog.com/2023/09/)
  + [Aug](https://security.googleblog.com/2023/08/)
  + [Jul](https://security.googleblog.com/2023/07/)
  + [Jun](https://security.googleblog.com/2023/06/)
  + [May](https://security.googleblog.com/2023/05/)
  + [Apr](https://security.googleblog.com/2023/04/)
  + [Mar](https://security.googleblog.com/2023/03/)
  + [Feb](https://security.googleblog.com/2023/02/)
  + [Jan](https://security.googleblog.com/2023/01/)

* **

  **
  [2022](https://security.googleblog.com/2022/)

  + [Dec](https://security.googleblog.com/2022/12/)
  + [Nov](https://security.googleblog.com/2022/11/)
  + [Oct](https://security.googleblog.com/2022/10/)
  + [Sep](https://security.googleblog.com/2022/09/)
  + [Aug](https://security.googleblog.com/2022/08/)
  + [Jul](https://security.googleblog.com/2022/07/)
  + [Jun](https://security.googleblog.com/2022/06/)
  + [May](https://security.googleblog.com/2022/05/)
  + [Apr](https://security.googleblog.com/2022/04/)
  + [Mar](https://security.googleblog.com/2022/03/)
  + [Feb](https://security.googleblog.com/2022/02/)
  + [Jan](https://security.googleblog.com/2022/01/)

* **

  **
  [2021](https://security.googleblog.com/2021/)

  + [Dec](https://security.googleblog.com/2021/12/)
  + [Nov](https://security.googleblog.com/2021/11/)
  + [Oct](https://security.googleblog.com/2021/10/)
  + [Sep](https://security.googleblog.com/2021/09/)
  + [Aug](https://security.googleblog.com/2021/08/)
  + [Jul](https://security.googleblog.com/2021/07/)
  + [Jun](https://security.googleblog.com/2021/06/)
  + [May](https://security.googleblog.com/2021/05/)
  + [Apr](https://security.googleblog.com/2021/04/)
  + [Mar](https://security.googleblog.com/2021/03/)
  + [Feb](https://security.googleblog.com/2021/02/)
  + [Jan](https://security.googleblog.com/2021/01/)

* **

  **
  [2020](https://security.googleblog.com/2020/)

  + [Dec](https://security.googleblog.com/2020/12/)
  + [Nov](https://security.googleblog.com/2020/11/)
  + [Oct](https://security.googleblog.com/2020/10/)
  + [Sep](https://security.googleblog.com/2020/09/)
  + [Aug](https://security.googleblog.com/2020/08/)
  + [Jul](https://security.googleblog.com/2020/07/)
  + [Jun](https://security.googleblog.com/2020/06/)
  + [May](https://security.googleblog.com/2020/05/)
  + [Apr](https://security.googleblog.com/2020/04/)
  + [Mar](https://security.googleblog.com/2020/03/)
  + [Feb](https://security.googleblog.com/2020/02/)
  + [Jan](https://security.googleblog.com/2020/01/)

* **

  **
  [2019](https://security.googleblog.com/2019/)

  + [Dec](https://security.googleblog.com/2019/12/)
  + [Nov](https://security.googleblog.com/2019/11/)
  + [Oct](https://security.googleblog.com/2019/10/)
  + [Sep](https://security.googleblog.com/2019/09/)
  + [Aug](https://security.googleblog.com/2019/08/)
  + [Jul](https://security.googleblog.com/2019/07/)
  + [Jun](https://security.googleblog.com/2019/06/)
  + [May](https://security.googleblog.com/2019/05/)
  + [Apr](https://security.googleblog.com/2019/04/)
  + [Mar](https://security.googleblog.com/2019/03/)
  + [Feb](https://security.googleblog.com/2019/02/)
  + [Jan](https://security.googleblog.com/2019/01/)

* **

  **
  [2018](https://security.googleblog.com/2018/)

  + [Dec](https://security.googleblog.com/2018/12/)
  + [Nov](https://security.googleblog.com/2018/11/)
  + [Oct](https://security.googleblog.com/2018/10/)
  + [Sep](https://security.googleblog.com/2018/09/)
  + [Aug](https://security.googleblog.com/2018/08/)
  + [Jul](https://security.googleblog.com/2018/07/)
  + [Jun](https://security.googleblog.com/2018/06/)
  + [May](https://security.googleblog.com/2018/05/)
  + [Apr](https://security.googleblog.com/2018/04/)
  + [Mar](https://security.googleblog.com/2018/03/)
  + [Feb](https://security.googleblog.com/2018/02/)
  + [Jan](https://security.googleblog.com/2018/01/)

* **

  **
  [2017](https://security.googleblog.com/2017/)

  + [Dec](https://security.googleblog.com/2017/12/)
  + [Nov](https://security.googleblog.com/2017/11/)
  + [Oct](https://security.googleblog.com/2017/10/)
  + [Sep](https://security.googleblog.com/2017/09/)
  + [Jul](https://security.googleblog.com/2017/07/)
  + [Jun](https://security.googleblog.com/2017/06/)
  + [May](https://security.googleblog.com/2017/05/)
  + [Apr](https://security.googleblog.com/2017/04/)
  + [Mar](https://security.googleblog.com/2017/03/)
  + [Feb](https://security.googleblog.com/2017/02/)
  + [Jan](https://security.googleblog.com/2017/01/)

* **

  **
  [2016](https://security.googleblog.com/2016/)

  + [Dec](https://security.googleblog.com/2016/12/)
  + [Nov](https://security.googleblog.com/2016/11/)
  + [Oct](https://security.googleblog.com/2016/10/)
  + [Sep](https://security.googleblog.com/2016/09/)
  + [Aug](https://security.googleblog.com/2016/08/)
  + [Jul](https://security.googleblog.com/2016/07/)
  + [Jun](https://security.googleblog.com/2016/06/)
  + [May](https://security.googleblog.com/2016/05/)
  + [Apr](https://security.googleblog.com/2016/04/)
  + [Mar](https://security.googleblog.com/2016/03/)
  + [Feb](https://security.googleblog.com/2016/02/)
  + [Jan](https://security.googleblog.com/2016/01/)

* **

  **
  [2015](https://security.googleblog.com/2015/)

  + [Dec](https://security.googleblog.com/2015/12/)
  + [Nov](https://security.googleblog.com/2015/11/)
  + [Oct](https://security.googleblog.com/2015/10/)
  + [Sep](https://security.googleblog.com/2015/09/)
  + [Aug](https://security.googleblog.com/2015/08/)
  + [Jul](https://security.googleblog.com/2015/07/)
  + [Jun](https://security.googleblog.com/2015/06/)
  + [May](https://security.googleblog.com/2015/05/)
  + [Apr](https://security.googleblog.com/2015/04/)
  + [Mar](https://security.googleblog.com/2015/03/)
  + [Feb](https://security.googleblog.com/2015/02/)
  + [Jan](https://security.googleblog.com/2015/01/)

* **

  **
  [2014](https://security.googleblog.com/2014/)

  + [Dec](https://security.googleblog.com/2014/12/)
  + [Nov](https://security.googleblog.com/2014/11/)
  + [Oct](https://security.googleblog.com/2014/10/)
  + [Sep](https://security.googleblog.com/2014/09/)
  + [Aug](https://security.googleblog.com/2014/08/)
  + [Jul](https://security.googleblog.com/2014/07/)
  + [Jun](https://security.googleblog.com/2014/06/)
  + [Apr](https://security.googleblog.com/2014/04/)
  + [Mar](https://security.googleblog.com/2014/03/)
  + [Feb](https://security.googleblog.com/2014/02/)
  + [Jan](https://security.googleblog.com/2014/01/)

* **

  **
  [2013](https://security.googleblog.com/2013/)

  + [Dec](https://security.googleblog.com/2013/12/)
  + [Nov](https://security.googleblog.com/2013/11/)
  + [Oct](https://security.googleblog.com/2013/10/)
  + [Aug](https://security.googleblog.com/2013/08/)
  + [Jun](https://security.googleblog.com/2013/06/)
  + [May](https://security.googleblog.com/2013/05/)
  + [Apr](https://security.googleblog.com/2013/04/)
  + [Mar](https://security.googleblog.com/2013/03/)
  + [Feb](https://security.googleblog.com/2013/02/)
  + [Jan](https://security.googleblog.com/2013/01/)

* **

  **
  [2012](https://security.googleblog.com/2012/)

  + [Dec](https://security.googleblog.com/2012/12/)
  + [Sep](https://security.googleblog.com/2012/09/)
  + [Aug](https://security.googleblog.com/2012/08/)
  + [Jun](https://security.googleblog.com/2012/06/)
  + [May](https://security.googleblog.com/2012/05/)
  + [Apr](https://security.googleblog.com/2012/04/)
  + [Mar](https://security.googleblog.com/2012/03/)
  + [Feb](https://security.googleblog.com/2012/02/)
  + [Jan](https://security.googleblog.com/2012/01/)

* **

  **
  [2011](https://security.googleblog.com/2011/)

  + [Dec](https://security.googleblog.com/2011/12/)
  + [Nov](https://security.googleblog.com/2011/11/)
  + [Oct](https://security.googleblog.com/2011/10/)
  + [Sep](https://security.googleblog.com/2011/09/)
  + [Aug](https://security.googleblog.com/2011/08/)
  + [Jul](https://security.googleblog.com/2011/07/)
  + [Jun](https://security.googleblog.com/2011/06/)
  + [May](https://security.googleblog.com/2011/05/)
  + [Apr](https://security.googleblog.com/2011/04/)
  + [Mar](https://security.googleblog.com/2011/03/)
  + [Feb](https://security.googleblog.com/2011/02/)

* **

  **
  [2010](https://security.googleblog.com/2010/)

  + [Nov](https://security.googleblog.com/2010/11/)
  + [Oct](https://security.googleblog.com/2010/10/)
  + [Sep](https://security.googleblog.com/2010/09/)
  + [Aug](https://security.googleblog.com/2010/08/)
  + [Jul](https://security.googleblog.com/2010/07/)
  + [May](https://security.googleblog.com/2010/05/)
  + [Apr](https://security.googleblog.com/2010/04/)
  + [Mar](https://security.googleblog.com/2010/03/)

* **

  **
  [2009](https://security.googleblog.com/2009/)

  + [Nov](https://security.googleblog.com/2009/11/)
  + [Oct](https://security.googleblog.com/2009/10/)
  + [Aug](https://security.googleblog.com/2009/08/)
  + [Jul](https://security.googleblog.com/2009/07/)
  + [Jun](https://security.googleblog.com/2009/06/)
  + [Mar](https://security.googleblog.com/2009/03/)

* **

  **
  [2008](https://security.googleblog.com/2008/)

  + [Dec](https://security.googleblog.com/2008/12/)
  + [Nov](https://security.googleblog.com/2008/11/)
  + [Oct](https://security.googleblog.com/2008/10/)
  + [Aug](https://security.googleblog.com/2008/08/)
  + [Jul](https://security.googleblog.com/2008/07/)
  + [May](https://security.googleblog.com/2008/05/)
  + [Feb](https://security.googleblog.com/2008/02/)

* **

  **
  [2007](https://security.googleblog.com/2007/)

  + [Nov](https://security.googleblog.com/2007/11/)
  + [Oct](https://security.googleblog.com/2007/10/)
  + [Sep](https://security.googleblog.com/2007/09/)
  + [Jul](https://security.googleblog.com/2007/07/)
  + [Jun](https://security.googleblog.com/2007/06/)
  + [May](https://security.googleblog.com/2007/05/)

[![](data:image/png;base64...)
## Feed](https://googleonlinesecurity.blogspot.com/atom.xml)

Follow @google

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgmruMUNSjAUsU-iCQjxgiqufl2u1wHJfiVTn3wuiIZAK1VUSRsexREPAOLV0N4-4VVtaYbZL18UsVh5CUlUJWH5UurFiQKMkHlNnj3YYw-2UiYtbNbvBE7VsAhdtw9rwNuOc-riC1exNkp/s1600/facebook-logo.png)Follow](https://www.facebook.com/google)

Give us feedback in our [Product Forums](https://support.google.com/bin/static.py?hl=en&page=portal_groups.cs).

[![](data:image/png;base64...)](//www.google.com/)

* [Google](//www.google.com/)
* [Privacy](//www.google.com/policies/privacy/)
* [Terms](//www.google.com/policies/terms/)



=== Content from arstechnica.com_ecc55295_20250125_220443.html ===


[Skip to content](#main)

[Ars Technica home](https://arstechnica.com/)

Sections

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

* [Feature](/features/)
* [Reviews](/reviews/)
* [Store](/store/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Pin to story

Theme

* HyperLight
* Day & Night
* Dark
* System

Search dialog...

Sign In

Sign in dialog...

Sign in

Biz & IT

# At death’s door for years, widely used SHA1 function is now dead

Algorithm underpinning Internet security falls to first-known collision attack.

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
–
Feb 23, 2017 8:01 am

| [180](https://arstechnica.com/information-technology/2017/02/at-deaths-door-for-years-widely-used-sha1-function-is-now-dead/#comments "180 comments")

[![](https://cdn.arstechnica.net/wp-content/uploads/2017/02/grave.jpg)](https://cdn.arstechnica.net/wp-content/uploads/2017/02/grave.jpg)

Credit:
[Bob Embleton](http://www.geograph.org.uk/photo/934336)

Credit:
[Bob Embleton](http://www.geograph.org.uk/photo/934336)

Text
settings

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Minimize to nav

For more than six years, the [SHA1 cryptographic hash function](https://en.wikipedia.org/wiki/SHA-1) underpinning Internet security [has been at death's door](https://arstechnica.com/security/2012/10/sha1-crypto-algorithm-could-fall-by-2018/). Now it's officially dead, thanks to the submission of the first known instance of a fatal exploit known as a "collision."

Despite more than a decade of warnings about the lack of security of SHA1, the watershed moment comes as the hash function remains widely used. [Git](https://en.wikipedia.org/wiki/Git), the world's most widely used system for managing software development among multiple people, [relies on it for data integrity](https://git-scm.com/about/info-assurance). The GnuPG e-mail encryption program [still deems SHA1 safe](https://www.gnupg.org/faq/gnupg-faq.html#define_sha). And hundreds if not thousands of big-name software packages rely on SHA1 signatures to ensure installation and update files distributed over the Internet haven't been maliciously altered.

A collision occurs when the two different files or messages produce the same cryptographic hash. The most well-known collision occurred sometime around 2010 against the [MD5 hash algorithm](https://en.wikipedia.org/wiki/MD5), which is even weaker than SHA1. A piece of [nation-sponsored espionage malware known as Flame](https://arstechnica.com/series/flame-malware-eruption/) used the attack to [hijack the Windows update mechanism](https://arstechnica.com/security/2012/06/flame-wields-rare-collision-crypto-attack/) Microsoft uses to distribute patches to hundreds of millions of customers. By forging the digital signature used to cryptographically prove the authenticity of Microsoft servers, Flame was able to spread from one infected computer to another inside targeted networks.

Now, researchers have demonstrated a similar type of real-world attack against SHA1, which ironically was widely adopted after the insecurity of MD5 became well-known. The SHA1 collision is documented in a [research paper published Thursday](https://shattered.io/static/shattered.pdf). It presents [two](https://shattered.io/static/shattered-1.pdf) [PDF](https://shattered.io/static/shattered-2.pdf) files that, despite displaying different content, have the same SHA1 hash. The researchers warned that the same technique—which costs as little as $110,000 to carry out on Amazon's cloud computing platform—could be used to create collisions in GIT file objects or digital certificates.

"Our work shows that it is now practical to find collisions for SHA1 and that thus it is not secure to use for digital signatures, file integrity, and file identification purposes," Marc Stevens, the lead researcher, told Ars. "Everyone should migrate to safe standards before real-world attacks happen, not after. Note that attacks can only get better and faster, computational power only becomes cheaper, and attackers have the uncanny ability to be more creative in exploiting vulnerabilities than common expectations."

## RIP

Cryptographers refer to the attack disclosed Thursday as an "identical-prefix" collision, meaning it allows the attacker to create two distinct messages that have the same hash value. This variety is less powerful than the "chosen-prefix" MD5 collision carried out by Flame. In the latter case, attackers can target one or more existing files, such as the digital certificate that a company uses to authenticate its update mechanism. Despite the collision against SHA1 being less powerful, cryptography experts said any real-world identical-prefix attack represented a game-over event for a hashing function.

"In crypto we have the idea that hash function collisions should be really hard to find, even if they're 'useless,'" said Johns Hopkins University professor Matt Green, speaking generally about collisions before he learned the specifics of the new SHA1 attack. A real-world collision attack "is the equivalent of finding out that your scalpel wasn't sterilized properly. It may not verifiably have germs on it, but the whole instrument is considered unsafe."

Stevens, the lead researcher, agreed. In an e-mail he wrote:

> As an example of the insecurity of SHA1 [the identical-prefix collision] is very meaningful. Chosen-prefix collisions are more powerful and relieve an attacker from some constraints, but identical-prefix collisions can be just as dangerous with a very creative attacker. It is hard to say which things you can’t do with an identical-prefix collision.
>
> But we do know quite some demonstrated threats using identical-prefix collisions: certificates with identical names and different pubkeys, PDF files, PostScript files, TIFF files, JPEG files, Word files, file archives, signed software, Email message/attachment PGP/GPG signatures.

As an example, a landlord could use two colliding rental agreements to trick a prospective tenant into digitally signing a low-rent contract. The landlord could later claim the tenant signed a contract agreeing to a much higher rental price. Fortunately, certificates to HTTPS-protected websites aren't likely to be affected. Since the beginning of this year, browser-trusted certificate authorities have been barred from relying on SHA1 to sign TLS certificates they issue.

The research is the result of a more than two-year collaboration between researchers at the [Centrum Wiskunde & Informatica](https://www.cwi.nl/) in the Netherlands and Google's research security, privacy, and anti-abuse group. The first phase of the attack was run on a heterogeneous CPU cluster that was hosted by Google and spread over eight physical locations. A second and more expensive phase was run on a heterogeneous cluster of K20, K40, and K80 GPUs that were also hosted by Google. Had the researchers performed their attack on [Amazon's Web Services platform](https://aws.amazon.com/), it would have cost $560,000 at normal pricing. Had the researchers been patient and waited to run their attack during off-peak hours, the same collision would have cost $110,000. That's within the $75,000 to $120,000 range CWI's Stevens [projected in late 2015](https://arstechnica.com/security/2015/10/sha1-crypto-algorithm-securing-internet-could-break-by-years-end/).

Consistent with Google's security disclosure policy, the source code for performing the collision attack will be published in 90 days. That means Git and an unknown number of other widely used services that rely on SHA1 have three months to wean themselves and their users off the insecure function. The best candidates for replacements are the [SHA256](https://en.wikipedia.org/wiki/SHA-2) and [SHA3](https://en.wikipedia.org/wiki/SHA-3) functions. In the meantime, the researchers have released a tool that detects if files are part of a collision attack. The tool and much more information are available at [shattered.io](https://shattered.io/).

Listing image:
[Bob Embleton](http://www.geograph.org.uk/photo/934336)

[![Photo of Dan Goodin](/wp-content/uploads/2018/10/Dang.jpg)](https://arstechnica.com/author/dan-goodin/)
[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

Dan Goodin is Senior Security Editor at Ars Technica, where he oversees coverage of malware, computer espionage, botnets, hardware hacking, encryption, and passwords. In his spare time, he enjoys gardening, cooking, and following the independent music scene. Dan is based in San Francisco. Follow him at [here](https://infosec.exchange/%40dangoodin) on Mastodon and [here](https://bsky.app/profile/dangoodin.bsky.social) on Bluesky. Contact him on Signal at DanArs.82.

[180 Comments](https://arstechnica.com/information-technology/2017/02/at-deaths-door-for-years-widely-used-sha1-function-is-now-dead/#comments "180 comments")

Comments

[Forum view](https://arstechnica.com/civis/threads/at-death%E2%80%99s-door-for-years-widely-used-sha1-function-is-now-dead.1374747/)

![Loading](https://arstechnica.com/wp-content/themes/ars-v9/public/images/firework-loader.75ab30.gif)

[Prev story](https://arstechnica.com/tech-policy/2017/02/judge-no-feds-cant-nab-all-apple-devices-and-try-everyones-fingerprints/ "Go to: Judge: No, feds can’t nab all Apple devices and try everyone’s fingerprints")

[Next story](https://arstechnica.com/gaming/2017/02/nintendo-switch-impressions-out-of-the-box-and-into-our-hands/ "Go to: Nintendo Switch impressions: Out of the box and into our hands")

Most Read

1. [![Listing image for first story in Most Read: For real, we may be taking blood pressure readings all wrong](https://cdn.arstechnica.net/wp-content/uploads/2025/01/GettyImages-110883323-768x432.jpg)](https://arstechnica.com/health/2025/01/for-real-we-may-be-taking-blood-pressure-readings-all-wrong/)

   1.
   [For real, we may be taking blood pressure readings all wrong](https://arstechnica.com/health/2025/01/for-real-we-may-be-taking-blood-pressure-readings-all-wrong/)
2. 2.
   [ISP failed to comply with New York’s $15 broadband law—until Ars got involved](https://arstechnica.com/tech-policy/2025/01/isp-failed-to-comply-with-new-yorks-15-broadband-law-until-ars-got-involved/)
3. 3.
   [Nvidia starts to wind down support for old GPUs, including the long-lived GTX 1060](https://arstechnica.com/gadgets/2025/01/nvidia-winding-down-support-for-older-gpus-including-the-legendary-750-ti-and-1060/)
4. 4.
   [3D-printed “ghost gun” ring comes to my community—and leaves a man dead](https://arstechnica.com/culture/2025/01/3d-printed-ghost-gun-ring-comes-to-my-community-and-leaves-a-man-dead/)
5. 5.
   [Florida man eats diet of butter, cheese, beef; cholesterol oozes from his body](https://arstechnica.com/health/2025/01/florida-man-eats-diet-of-butter-cheese-beef-cholesterol-oozes-from-his-body/)

Customize

Ars Technica has been separating the signal from
the noise for over 25 years. With our unique combination of
technical savvy and wide-ranging interest in the technological arts
and sciences, Ars is the trusted source in a sea of information. After
all, you don’t need to know everything, only what’s important.

More
from Ars

* [About Us](https://arstechnica.com/about-us/)
* [Staff Directory](https://arstechnica.com/staff-directory/)
* [Newsletters](https://arstechnica.com/newsletters/)
* [Ars Videos](https://arstechnica.com/video/)
* [General FAQ](https://arstechnica.com/general-faq/)
* [RSS Feeds](https://arstechnica.com/rss-feeds/)

Contact

* [Contact us](https://arstechnica.com/contact-us/)
* [Advertise with us](https://www.condenast.com/brands/ars-technica)
* [Reprints](https://arstechnica.com/reprints/)

Do Not Sell My Personal
Information

© 2025 Condé Nast. All rights reserved. Use of and/or
registration on any portion of this site constitutes acceptance of our [User Agreement](https://www.condenast.com/user-agreement/) and
[Privacy Policy and
Cookie Statement](https://www.condenast.com/privacy-policy/) and [Ars
Technica Addendum](/amendment-to-conde-nast-user-agreement-privacy-policy/) and [Your
California Privacy Rights](https://www.condenast.com/privacy-policy/#california). Ars Technica may earn compensation on
sales from links on this site. [Read our
affiliate link policy](/affiliate-link-policy/). The material on this site may not be
reproduced, distributed, transmitted, cached or otherwise used, except
with the prior written permission of Condé Nast. [Ad
Choices](https://www.aboutads.info/)



=== Content from sites.google.com_6bab4415_20250125_220448.html ===

# Sign in

Use your Google AccountEmail or phoneForgot email?![CAPTCHA image of text used to distinguish humans from robots]()Type the text you hear or seeNot your computer? Use Guest mode to sign in privately. [Learn more about using Guest mode](https://support.google.com/chrome/answer/6130773?hl=en-US)NextCreate account

=== Content from security.googleblog.com_106bebcd_20250125_220446.html ===


![](https://ad.doubleclick.net/ddm/activity/src=2542116;type=gblog;cat=googl0;ord=1?)

[![](https://www.gstatic.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png)](https://security.googleblog.com/)
[## Security Blog](/.)

The latest news and insights from Google on security and safety on the Internet

## [An update on SHA-1 certificates in Chrome](https://security.googleblog.com/2015/12/an-update-on-sha-1-certificates-in.html "An update on SHA-1 certificates in Chrome")

December 18, 2015

Posted by Lucas Garron, Chrome security and David Benjamin, Chrome networking

As [announced last September](https://googleonlinesecurity.blogspot.com/2014/09/gradually-sunsetting-sha-1.html) and supported by [further recent research](https://sites.google.com/site/itstheshappening/), Google Chrome does not treat SHA-1 certificates as secure anymore, and will completely stop supporting them over the next year. Chrome will discontinue support in two steps: first, blocking new SHA-1 certificates; and second, blocking all SHA-1 certificates.

**Step 1: Blocking new SHA-1 certificates**

Starting in early 2016 with Chrome version 48, Chrome will display a certificate error if it encounters a site with a leaf certificate that:

1. is signed with a SHA-1-based signature
2. is issued on or after January 1, 2016
3. chains to a public CA

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhkvVVYUN9bGqtlKNjR0nsbE4NS8gV5EUNIa-CovxUCoPrAkEmG3cbnGv0Nnet7a60N4xFYZ32HBqnHXSwQ3gGGkvertIwjU97FDaEXx0mbrWdUJE5zEcCv83VNekkirwisKlXceveKkLDf/s400/Screen+Shot+2015-12-04+at+16.01.45.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhkvVVYUN9bGqtlKNjR0nsbE4NS8gV5EUNIa-CovxUCoPrAkEmG3cbnGv0Nnet7a60N4xFYZ32HBqnHXSwQ3gGGkvertIwjU97FDaEXx0mbrWdUJE5zEcCv83VNekkirwisKlXceveKkLDf/s1600/Screen%2BShot%2B2015-12-04%2Bat%2B16.01.45.png)
We are hopeful that no one will encounter this error, since public CAs must stop issuing SHA-1 certificates in 2016 per the [Baseline Requirements for SSL](https://cabforum.org/baseline-requirements-documents/).

In addition, a later version of Chrome in 2016 may extend these criteria in order to help guard against SHA-1 collision attacks on older devices, by displaying a certificate error for sites with certificate chains that:

1. contain an intermediate or leaf certificate signed with a SHA-1-based signature
2. contain an intermediate or leaf certificate issued on or after January 1, 2016
3. chain to a public CA

(Note that the first two criteria can match different certificates.)

Note that sites using new SHA-1 certificates that chain to local trust anchors (rather than public CAs) will continue to work without a certificate error. However, they will still be subject to the UI downgrade specified in our [original announcement](https://googleonlinesecurity.blogspot.com/2014/09/gradually-sunsetting-sha-1.html).

**Step 2: Blocking all SHA-1 certificates**

Starting January 1, 2017 at the latest, Chrome will completely stop supporting SHA-1 certificates. At this point, sites that have a SHA-1-based signature as part of the certificate chain (not including the self-signature on the root certificate) will trigger a fatal network error. This includes certificate chains that end in a local trust anchor as well as those that end at a public CA.

In line with [Microsoft Edge](https://cabforum.org/pipermail/public/2015-October/006121.html) and [Mozilla Firefox](https://blog.mozilla.org/security/2015/10/20/continuing-to-phase-out-sha-1-certificates/), the target date for this step is January 1, 2017, but we are considering moving it earlier to July 1, 2016 in light of ongoing research. We therefore urge sites to replace any remaining SHA-1 certificates as soon as possible.

Note that Chrome uses the certificate trust settings of the host OS where possible, and that an update such as Microsoft’s [planned change](http://social.technet.microsoft.com/wiki/contents/articles/32288.windows-enforcement-of-authenticode-code-signing-and-timestamping.aspx) will cause a fatal network error in Chrome, regardless of Chrome’s intended target date.

**Keeping your site safe and compatible**

As individual TLS features are found to be too weak, browsers need to drop support for those features to keep users safe. Unfortunately, SHA-1 certificates are not the only feature that browsers will remove in the near future.

As we [announced](https://groups.google.com/a/chromium.org/d/msg/security-dev/kVfCywocUO8/2BW3INFdDwAJ) on our security-dev mailing list, Chrome 48 will also stop supporting RC4 cipher suites for TLS connections. This aligns with timelines for [Microsoft Edge](https://blogs.windows.com/msedgedev/2015/09/01/ending-support-for-the-rc4-cipher-in-microsoft-edge-and-internet-explorer-11/) and [Mozilla Firefox](https://blog.mozilla.org/security/2015/09/11/deprecating-the-rc4-cipher/).

For security and interoperability in the face of upcoming browser changes, site operators should ensure that their servers use SHA-2 certificates, support non-RC4 cipher suites, and follow TLS best practices. In particular, we recommend that most sites support TLS 1.2 and prioritize the ECDHE\_RSA\_WITH\_AES\_128\_GCM cipher suite. We also encourage site operators to use tools like the [SSL Labs server test](https://www.ssllabs.com/ssltest/) and [Mozilla's SSL Configuration Generator](https://mozilla.github.io/server-side-tls/ssl-config-generator/).

![Share on Twitter](https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png)

![Share on Facebook](https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png)

[Google](https://plus.google.com/112374322230920073195)

#### No comments :

[Post a Comment](https://www.blogger.com/comment/fullpage/post/1176949257541686127/8639564181370617001)

[**](https://security.googleblog.com/)
[**](https://security.googleblog.com/2016/01/why-attend-usenix-enigma.html "Newer Post")

[**](https://security.googleblog.com/2015/12/indexing-https-pages-by-default.html "Older Post")

![](data:image/png;base64...)
## Labels

**

* [#sharethemicincyber](https://security.googleblog.com/search/label/%23sharethemicincyber)
* [#supplychain #security #opensource](https://security.googleblog.com/search/label/%23supplychain%20%23security%20%23opensource)
* [android](https://security.googleblog.com/search/label/android)
* [android security](https://security.googleblog.com/search/label/android%20security)
* [android tr](https://security.googleblog.com/search/label/android%20tr)
* [app security](https://security.googleblog.com/search/label/app%20security)
* [big data](https://security.googleblog.com/search/label/big%20data)
* [biometrics](https://security.googleblog.com/search/label/biometrics)
* [blackhat](https://security.googleblog.com/search/label/blackhat)
* [C++](https://security.googleblog.com/search/label/C%2B%2B)
* [chrome](https://security.googleblog.com/search/label/chrome)
* [chrome enterprise](https://security.googleblog.com/search/label/chrome%20enterprise)
* [chrome security](https://security.googleblog.com/search/label/chrome%20security)
* [connected devices](https://security.googleblog.com/search/label/connected%20devices)
* [CTF](https://security.googleblog.com/search/label/CTF)
* [diversity](https://security.googleblog.com/search/label/diversity)
* [encryption](https://security.googleblog.com/search/label/encryption)
* [federated learning](https://security.googleblog.com/search/label/federated%20learning)
* [fuzzing](https://security.googleblog.com/search/label/fuzzing)
* [Gboard](https://security.googleblog.com/search/label/Gboard)
* [google play](https://security.googleblog.com/search/label/google%20play)
* [google play protect](https://security.googleblog.com/search/label/google%20play%20protect)
* [hacking](https://security.googleblog.com/search/label/hacking)
* [interoperability](https://security.googleblog.com/search/label/interoperability)
* [iot security](https://security.googleblog.com/search/label/iot%20security)
* [kubernetes](https://security.googleblog.com/search/label/kubernetes)
* [linux kernel](https://security.googleblog.com/search/label/linux%20kernel)
* [memory safety](https://security.googleblog.com/search/label/memory%20safety)
* [Open Source](https://security.googleblog.com/search/label/Open%20Source)
* [pha family highlights](https://security.googleblog.com/search/label/pha%20family%20highlights)
* [pixel](https://security.googleblog.com/search/label/pixel)
* [privacy](https://security.googleblog.com/search/label/privacy)
* [private compute core](https://security.googleblog.com/search/label/private%20compute%20core)
* [Rowhammer](https://security.googleblog.com/search/label/Rowhammer)
* [rust](https://security.googleblog.com/search/label/rust)
* [Security](https://security.googleblog.com/search/label/Security)
* [security rewards program](https://security.googleblog.com/search/label/security%20rewards%20program)
* [sigstore](https://security.googleblog.com/search/label/sigstore)
* [spyware](https://security.googleblog.com/search/label/spyware)
* [supply chain](https://security.googleblog.com/search/label/supply%20chain)
* [targeted spyware](https://security.googleblog.com/search/label/targeted%20spyware)
* [tensor](https://security.googleblog.com/search/label/tensor)
* [Titan M2](https://security.googleblog.com/search/label/Titan%20M2)
* [VDP](https://security.googleblog.com/search/label/VDP)
* [vulnerabilities](https://security.googleblog.com/search/label/vulnerabilities)
* [workshop](https://security.googleblog.com/search/label/workshop)

**
## Archive

**

* **

  **
  [2025](https://security.googleblog.com/2025/)

  + [Jan](https://security.googleblog.com/2025/01/)

* **

  **
  [2024](https://security.googleblog.com/2024/)

  + [Dec](https://security.googleblog.com/2024/12/)
  + [Nov](https://security.googleblog.com/2024/11/)
  + [Oct](https://security.googleblog.com/2024/10/)
  + [Sep](https://security.googleblog.com/2024/09/)
  + [Aug](https://security.googleblog.com/2024/08/)
  + [Jul](https://security.googleblog.com/2024/07/)
  + [Jun](https://security.googleblog.com/2024/06/)
  + [May](https://security.googleblog.com/2024/05/)
  + [Apr](https://security.googleblog.com/2024/04/)
  + [Mar](https://security.googleblog.com/2024/03/)
  + [Feb](https://security.googleblog.com/2024/02/)
  + [Jan](https://security.googleblog.com/2024/01/)

* **

  **
  [2023](https://security.googleblog.com/2023/)

  + [Dec](https://security.googleblog.com/2023/12/)
  + [Nov](https://security.googleblog.com/2023/11/)
  + [Oct](https://security.googleblog.com/2023/10/)
  + [Sep](https://security.googleblog.com/2023/09/)
  + [Aug](https://security.googleblog.com/2023/08/)
  + [Jul](https://security.googleblog.com/2023/07/)
  + [Jun](https://security.googleblog.com/2023/06/)
  + [May](https://security.googleblog.com/2023/05/)
  + [Apr](https://security.googleblog.com/2023/04/)
  + [Mar](https://security.googleblog.com/2023/03/)
  + [Feb](https://security.googleblog.com/2023/02/)
  + [Jan](https://security.googleblog.com/2023/01/)

* **

  **
  [2022](https://security.googleblog.com/2022/)

  + [Dec](https://security.googleblog.com/2022/12/)
  + [Nov](https://security.googleblog.com/2022/11/)
  + [Oct](https://security.googleblog.com/2022/10/)
  + [Sep](https://security.googleblog.com/2022/09/)
  + [Aug](https://security.googleblog.com/2022/08/)
  + [Jul](https://security.googleblog.com/2022/07/)
  + [Jun](https://security.googleblog.com/2022/06/)
  + [May](https://security.googleblog.com/2022/05/)
  + [Apr](https://security.googleblog.com/2022/04/)
  + [Mar](https://security.googleblog.com/2022/03/)
  + [Feb](https://security.googleblog.com/2022/02/)
  + [Jan](https://security.googleblog.com/2022/01/)

* **

  **
  [2021](https://security.googleblog.com/2021/)

  + [Dec](https://security.googleblog.com/2021/12/)
  + [Nov](https://security.googleblog.com/2021/11/)
  + [Oct](https://security.googleblog.com/2021/10/)
  + [Sep](https://security.googleblog.com/2021/09/)
  + [Aug](https://security.googleblog.com/2021/08/)
  + [Jul](https://security.googleblog.com/2021/07/)
  + [Jun](https://security.googleblog.com/2021/06/)
  + [May](https://security.googleblog.com/2021/05/)
  + [Apr](https://security.googleblog.com/2021/04/)
  + [Mar](https://security.googleblog.com/2021/03/)
  + [Feb](https://security.googleblog.com/2021/02/)
  + [Jan](https://security.googleblog.com/2021/01/)

* **

  **
  [2020](https://security.googleblog.com/2020/)

  + [Dec](https://security.googleblog.com/2020/12/)
  + [Nov](https://security.googleblog.com/2020/11/)
  + [Oct](https://security.googleblog.com/2020/10/)
  + [Sep](https://security.googleblog.com/2020/09/)
  + [Aug](https://security.googleblog.com/2020/08/)
  + [Jul](https://security.googleblog.com/2020/07/)
  + [Jun](https://security.googleblog.com/2020/06/)
  + [May](https://security.googleblog.com/2020/05/)
  + [Apr](https://security.googleblog.com/2020/04/)
  + [Mar](https://security.googleblog.com/2020/03/)
  + [Feb](https://security.googleblog.com/2020/02/)
  + [Jan](https://security.googleblog.com/2020/01/)

* **

  **
  [2019](https://security.googleblog.com/2019/)

  + [Dec](https://security.googleblog.com/2019/12/)
  + [Nov](https://security.googleblog.com/2019/11/)
  + [Oct](https://security.googleblog.com/2019/10/)
  + [Sep](https://security.googleblog.com/2019/09/)
  + [Aug](https://security.googleblog.com/2019/08/)
  + [Jul](https://security.googleblog.com/2019/07/)
  + [Jun](https://security.googleblog.com/2019/06/)
  + [May](https://security.googleblog.com/2019/05/)
  + [Apr](https://security.googleblog.com/2019/04/)
  + [Mar](https://security.googleblog.com/2019/03/)
  + [Feb](https://security.googleblog.com/2019/02/)
  + [Jan](https://security.googleblog.com/2019/01/)

* **

  **
  [2018](https://security.googleblog.com/2018/)

  + [Dec](https://security.googleblog.com/2018/12/)
  + [Nov](https://security.googleblog.com/2018/11/)
  + [Oct](https://security.googleblog.com/2018/10/)
  + [Sep](https://security.googleblog.com/2018/09/)
  + [Aug](https://security.googleblog.com/2018/08/)
  + [Jul](https://security.googleblog.com/2018/07/)
  + [Jun](https://security.googleblog.com/2018/06/)
  + [May](https://security.googleblog.com/2018/05/)
  + [Apr](https://security.googleblog.com/2018/04/)
  + [Mar](https://security.googleblog.com/2018/03/)
  + [Feb](https://security.googleblog.com/2018/02/)
  + [Jan](https://security.googleblog.com/2018/01/)

* **

  **
  [2017](https://security.googleblog.com/2017/)

  + [Dec](https://security.googleblog.com/2017/12/)
  + [Nov](https://security.googleblog.com/2017/11/)
  + [Oct](https://security.googleblog.com/2017/10/)
  + [Sep](https://security.googleblog.com/2017/09/)
  + [Jul](https://security.googleblog.com/2017/07/)
  + [Jun](https://security.googleblog.com/2017/06/)
  + [May](https://security.googleblog.com/2017/05/)
  + [Apr](https://security.googleblog.com/2017/04/)
  + [Mar](https://security.googleblog.com/2017/03/)
  + [Feb](https://security.googleblog.com/2017/02/)
  + [Jan](https://security.googleblog.com/2017/01/)

* **

  **
  [2016](https://security.googleblog.com/2016/)

  + [Dec](https://security.googleblog.com/2016/12/)
  + [Nov](https://security.googleblog.com/2016/11/)
  + [Oct](https://security.googleblog.com/2016/10/)
  + [Sep](https://security.googleblog.com/2016/09/)
  + [Aug](https://security.googleblog.com/2016/08/)
  + [Jul](https://security.googleblog.com/2016/07/)
  + [Jun](https://security.googleblog.com/2016/06/)
  + [May](https://security.googleblog.com/2016/05/)
  + [Apr](https://security.googleblog.com/2016/04/)
  + [Mar](https://security.googleblog.com/2016/03/)
  + [Feb](https://security.googleblog.com/2016/02/)
  + [Jan](https://security.googleblog.com/2016/01/)

* **

  **
  [2015](https://security.googleblog.com/2015/)

  + [Dec](https://security.googleblog.com/2015/12/)
  + [Nov](https://security.googleblog.com/2015/11/)
  + [Oct](https://security.googleblog.com/2015/10/)
  + [Sep](https://security.googleblog.com/2015/09/)
  + [Aug](https://security.googleblog.com/2015/08/)
  + [Jul](https://security.googleblog.com/2015/07/)
  + [Jun](https://security.googleblog.com/2015/06/)
  + [May](https://security.googleblog.com/2015/05/)
  + [Apr](https://security.googleblog.com/2015/04/)
  + [Mar](https://security.googleblog.com/2015/03/)
  + [Feb](https://security.googleblog.com/2015/02/)
  + [Jan](https://security.googleblog.com/2015/01/)

* **

  **
  [2014](https://security.googleblog.com/2014/)

  + [Dec](https://security.googleblog.com/2014/12/)
  + [Nov](https://security.googleblog.com/2014/11/)
  + [Oct](https://security.googleblog.com/2014/10/)
  + [Sep](https://security.googleblog.com/2014/09/)
  + [Aug](https://security.googleblog.com/2014/08/)
  + [Jul](https://security.googleblog.com/2014/07/)
  + [Jun](https://security.googleblog.com/2014/06/)
  + [Apr](https://security.googleblog.com/2014/04/)
  + [Mar](https://security.googleblog.com/2014/03/)
  + [Feb](https://security.googleblog.com/2014/02/)
  + [Jan](https://security.googleblog.com/2014/01/)

* **

  **
  [2013](https://security.googleblog.com/2013/)

  + [Dec](https://security.googleblog.com/2013/12/)
  + [Nov](https://security.googleblog.com/2013/11/)
  + [Oct](https://security.googleblog.com/2013/10/)
  + [Aug](https://security.googleblog.com/2013/08/)
  + [Jun](https://security.googleblog.com/2013/06/)
  + [May](https://security.googleblog.com/2013/05/)
  + [Apr](https://security.googleblog.com/2013/04/)
  + [Mar](https://security.googleblog.com/2013/03/)
  + [Feb](https://security.googleblog.com/2013/02/)
  + [Jan](https://security.googleblog.com/2013/01/)

* **

  **
  [2012](https://security.googleblog.com/2012/)

  + [Dec](https://security.googleblog.com/2012/12/)
  + [Sep](https://security.googleblog.com/2012/09/)
  + [Aug](https://security.googleblog.com/2012/08/)
  + [Jun](https://security.googleblog.com/2012/06/)
  + [May](https://security.googleblog.com/2012/05/)
  + [Apr](https://security.googleblog.com/2012/04/)
  + [Mar](https://security.googleblog.com/2012/03/)
  + [Feb](https://security.googleblog.com/2012/02/)
  + [Jan](https://security.googleblog.com/2012/01/)

* **

  **
  [2011](https://security.googleblog.com/2011/)

  + [Dec](https://security.googleblog.com/2011/12/)
  + [Nov](https://security.googleblog.com/2011/11/)
  + [Oct](https://security.googleblog.com/2011/10/)
  + [Sep](https://security.googleblog.com/2011/09/)
  + [Aug](https://security.googleblog.com/2011/08/)
  + [Jul](https://security.googleblog.com/2011/07/)
  + [Jun](https://security.googleblog.com/2011/06/)
  + [May](https://security.googleblog.com/2011/05/)
  + [Apr](https://security.googleblog.com/2011/04/)
  + [Mar](https://security.googleblog.com/2011/03/)
  + [Feb](https://security.googleblog.com/2011/02/)

* **

  **
  [2010](https://security.googleblog.com/2010/)

  + [Nov](https://security.googleblog.com/2010/11/)
  + [Oct](https://security.googleblog.com/2010/10/)
  + [Sep](https://security.googleblog.com/2010/09/)
  + [Aug](https://security.googleblog.com/2010/08/)
  + [Jul](https://security.googleblog.com/2010/07/)
  + [May](https://security.googleblog.com/2010/05/)
  + [Apr](https://security.googleblog.com/2010/04/)
  + [Mar](https://security.googleblog.com/2010/03/)

* **

  **
  [2009](https://security.googleblog.com/2009/)

  + [Nov](https://security.googleblog.com/2009/11/)
  + [Oct](https://security.googleblog.com/2009/10/)
  + [Aug](https://security.googleblog.com/2009/08/)
  + [Jul](https://security.googleblog.com/2009/07/)
  + [Jun](https://security.googleblog.com/2009/06/)
  + [Mar](https://security.googleblog.com/2009/03/)

* **

  **
  [2008](https://security.googleblog.com/2008/)

  + [Dec](https://security.googleblog.com/2008/12/)
  + [Nov](https://security.googleblog.com/2008/11/)
  + [Oct](https://security.googleblog.com/2008/10/)
  + [Aug](https://security.googleblog.com/2008/08/)
  + [Jul](https://security.googleblog.com/2008/07/)
  + [May](https://security.googleblog.com/2008/05/)
  + [Feb](https://security.googleblog.com/2008/02/)

* **

  **
  [2007](https://security.googleblog.com/2007/)

  + [Nov](https://security.googleblog.com/2007/11/)
  + [Oct](https://security.googleblog.com/2007/10/)
  + [Sep](https://security.googleblog.com/2007/09/)
  + [Jul](https://security.googleblog.com/2007/07/)
  + [Jun](https://security.googleblog.com/2007/06/)
  + [May](https://security.googleblog.com/2007/05/)

[![](data:image/png;base64...)
## Feed](https://googleonlinesecurity.blogspot.com/atom.xml)

Follow @google

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgmruMUNSjAUsU-iCQjxgiqufl2u1wHJfiVTn3wuiIZAK1VUSRsexREPAOLV0N4-4VVtaYbZL18UsVh5CUlUJWH5UurFiQKMkHlNnj3YYw-2UiYtbNbvBE7VsAhdtw9rwNuOc-riC1exNkp/s1600/facebook-logo.png)Follow](https://www.facebook.com/google)

Give us feedback in our [Product Forums](https://support.google.com/bin/static.py?hl=en&page=portal_groups.cs).

[![](data:image/png;base64...)](//www.google.com/)

* [Google](//www.google.com/)
* [Privacy](//www.google.com/policies/privacy/)
* [Terms](//www.google.com/policies/terms/)



=== Content from ia.cr_ce340852_20250125_220439.html ===

# What a lovely hat

#### Is it made out of [tin foil](https://iacr.org/tinfoil.html)?

[![IACR Logo](/img/iacrlogo_small.png)](https://iacr.org/)

[Cryptology ePrint Archive](/)

* Papers
  Updates from the last:+ [7 days](/days/7)
  + [31 days](/days/31)
  + [6 months](/days/183)
  + [365 days](/days/365)
  + ---
  + [Listing by year](/byyear)
  + [All papers](/complete)
  + [Compact view](/complete/compact)
  + [Subscribe](https://www.iacr.org/news/subscribe)
  + ---
  + [How to cite](/citation.html)
  + ---
  + [Harvesting metadata](/rss)
* Submissions
  + [Submit a paper](/submit)
  + [Revise or withdraw a paper](/revise)
  + [Acceptance and publishing conditions](/operations.html)
* About
  + [Goals and history](/about.html)
  + [News](/news.html)
  + [Statistics](/stats)
  + [Contact](/contact.html)

![Search Button](/img/search.svg)

Search

[Advanced search](/search)

#### Paper 2007/474

### Notes on the Wang et al. $2^{63}$ SHA-1 Differential Path

Martin Cochran

##### Abstract

Although advances in SHA-1 cryptanalysis have been made since the 2005 announcement of a $2^{63}$ attack by Wang et al., the details of the attack have not yet been vetted; this note does just that. Working from Adi Shamir's 2005 CRYPTO rump session presentation of Wang et al.'s work, this note corroborates and presents the differential path and associated conditions for the two-block attack. Although the error analysis for the advanced condition correction technique is not verified, a method is given which yields a two-block collision attack on SHA-1 requiring an estimated $2^{62}$ SHA-1 computations if the original error analysis by Wang et al. is correct.

**Note:** Added the second-block differential path and fixed several errors in the first-block differential path. Many thanks to Thomas Peyrin for finding the errors and sending me the second-block path.

##### Metadata

Available format(s)

[![](/img/file-pdf.svg)PDF](/2007/474.pdf)

Category
[Cryptographic protocols](/search?category=PROTOCOLS)
Publication info
Published elsewhere. Unknown where it was published
Keywords
[Cryptographic Hash Functions](/search?q=Cryptographic%20Hash%20Functions)[Cryptanalysis](/search?q=Cryptanalysis)[SHA-1](/search?q=SHA-1)
Contact author(s)
Martin Cochran @ colorado edu

History
2008-08-25: last of 3 revisions
2007-12-19: received
[See all versions](/archive/versions/2007/474)
Short URL
<https://ia.cr/2007/474>
License
[![Creative Commons Attribution](/img/license/CC_BY.svg "Creative Commons Attribution")

CC BY](https://creativecommons.org/licenses/by/4.0/)

**BibTeX**
![](/img/copy-outline.svg)Copy to clipboard

```

@misc{cryptoeprint:2007/474,
      author = {Martin Cochran},
      title = {Notes on the Wang et al. $2^{63}$ {SHA}-1 Differential Path},
      howpublished = {Cryptology {ePrint} Archive, Paper 2007/474},
      year = {2007},
      url = {https://eprint.iacr.org/2007/474}
}

```

[![IACR Logo](/img/iacrlogo_small.png)](https://iacr.org/)

Note: In order to protect the privacy of readers, eprint.iacr.org
does not use cookies or embedded third party content.



=== Content from kc.mcafee.com_c88d1911_20250125_220445.html ===
Loading×Sorry to interruptCSS ErrorRefresh

=== Content from www.schneier.com_0b5454f8_20250125_220448.html ===

# [Schneier on Security](https://www.schneier.com/)

Menu

* [Blog](https://www.schneier.com)
* [Newsletter](https://www.schneier.com/crypto-gram/)
* [Books](https://www.schneier.com/books/)
* [Essays](https://www.schneier.com/essays/)
* [News](https://www.schneier.com/news/)
* [Talks](https://www.schneier.com/talks/)
* [Academic](https://www.schneier.com/academic/)
* [About Me](https://www.schneier.com/blog/about/)

### Search

*Powered by [DuckDuckGo](https://duckduckgo.com/)*

Blog

Essays

Whole site

### Subscribe

[![Atom](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png)](https://www.schneier.com/feed/atom/)[![Facebook](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png)](https://www.facebook.com/bruce.schneier)[![Twitter](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png)](https://twitter.com/schneierblog)[![Email](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png)](https://www.schneier.com/crypto-gram)

[Home](https://www.schneier.com)[Blog](https://www.schneier.com/blog/archives/)

## SHA-1 Broken

SHA-1 has been broken. Not a reduced-round version. Not a simplified version. The real thing.

The research team of Xiaoyun Wang, Yiqun Lisa Yin, and Hongbo Yu (mostly from Shandong University in China) have been quietly circulating a paper describing their results:

* collisions in the the full SHA-1 in 2\*\*69 hash operations, much less than the brute-force attack of 2\*\*80 operations based on the hash length.* collisions in SHA-0 in 2\*\*39 operations.* collisions in 58-round SHA-1 in 2\*\*33 operations.

This attack builds on previous attacks on SHA-0 and SHA-1, and is a major, major cryptanalytic result. It pretty much puts a bullet into SHA-1 as a hash function for digital signatures (although it doesn’t affect applications such as HMAC where collisions aren’t important).

The paper isn’t generally available yet. At this point I can’t tell if the attack is real, but the paper looks good and this is a reputable research team.

More details when I have them.

Update: See [here](http://www.schneier.com/blog/archives/2005/02/cryptanalysis_o.html)

Tags: [cryptanalysis](https://www.schneier.com/tag/cryptanalysis/), [cryptography](https://www.schneier.com/tag/cryptography/), [hashes](https://www.schneier.com/tag/hashes/), [SHA-1](https://www.schneier.com/tag/sha-1/), [signatures](https://www.schneier.com/tag/signatures/)

[Posted on February 15, 2005 at 7:15 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html) •
[136 Comments](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html#comments)

### Comments

David Magda •
[February 15, 2005 7:36 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2178)

Time for NIST to have another competition?

[Rafael Sevilla](http://stormwyrm.blogspot.com) •
[February 15, 2005 8:25 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2179)

So what hash functions are available that don’t have a substantially similar construction? AFAIK, RIPEMD160 and the SHA256-384-512 series are of the same sort, and the attack could in principle work for them as well. There’s Tiger, which appears quite different, and Whirlpool. Any other suggestions?

This is, it would appear, a collision attack, not a preimage attack, so I guess we have some time to phase out the old hash functions.

[David Mohring](http://itheresies.blogspot.com/) •
[February 15, 2005 8:56 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2180)

Feb. 7, 2005 Hashing out encryption:

<http://www.fcw.com/fcw/articles/2005/0207/web-hash-02-07-05.asp>

Federal agencies have been put on notice that National Institute of Standards and Technology officials plan to phase out a widely used cryptographic hash function known as SHA-1 in favor of larger and stronger hash functions such as SHA-256 and SHA-512.

Jordan •
[February 15, 2005 9:03 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2181)

2**69 operations is still an awful lot of operations. What is it that lets us say that 2**69 is “broken” but 2\*\*80 is “not broken”?

[Yakov Shafranovich](http://www.shaftek.org/blog/) •
[February 15, 2005 9:16 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2182)

> (although it doesn’t affect applications such as HMAC)

Bruce,

Pardon my ignorance but can you elaborate why this doesn’t affect HMAC?

Randell Jesup •
[February 15, 2005 9:19 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2183)

That’s 2**11 less operations. Let’s say breaking this (2**69 ops) takes the NSA a week. If it had been 2\*\*80, it would have taken 2048 weeks, or 39 years. If it would have taken the NSA (or whomever) a year to break SHA-1 before, it could be broken in 4 hours.

My guess would be it would still take a lot longer than a week – but would now be in the realm of possibility, whereas before it would have been in the lifetime(s) range. However, this is totally a wild-assed-guess, based on the assumption that it was expected to take 100+ years before this to crack.

[Anthony Martin](http://www.martin-studio.com/) •
[February 15, 2005 9:25 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2184)

“…whereas before it would have been in the lifetime(s) range.”

Either way, it’s well within the statute of limitations for whatever crime you’ve committed. 😉

Mr Anon •
[February 15, 2005 9:32 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2185)

He said 69!!!!!!!!

COOOOOOOOLLLLLL!!!!!!!!!!!!!!

Hal •
[February 15, 2005 9:46 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2186)

I don’t think any public calculation has successfully solved a problem which required as much as 2^69 work. It will be interesting to see if this motivates people to search for an actual SHA-1 collision. Exhibiting a collision always has more impact than a theoretical break.

Of course, these researchers have yet to publish their techniques. Isn’t it kind of contradictory to the spirit of academic research to keep your methodology secret for so long? It’s been six months now since their MD5 results.

Will •
[February 15, 2005 9:53 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2187)

Regarding how long it should take to break… Let’s assume that a single CPU can tackle 2**32 ops/sec. (About 4 billion, so assuming each op is one cycle, about 4 GHz… Gross oversimplification, but it makes the math pretty easy.) So, how long would it take to do 2**69 ops?

2\*\*37 seconds of CPU time. About 4000 years.

So, if you have a 4000 node cluster, it ought to take about a year, which would be well within the statute of limitations, for most crimes and jurisdictions… 🙂

Brute forcing, using the same hypothetical cluster, would have taken over 2000 years. So, I guess today’s lesson is that it isn’t completely broken, but it certainly ain’t secure.

Myself •
[February 15, 2005 10:13 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2188)

2^69 is still a lot of work, with current processors and electricity prices. But with Moore’s progression and the lessons of history, people who were planning on 2^80 complexity for a bit of futureproofing will be very unhappy with 2^69.

I’m not clear on why anyone would’ve been using 80 bits in the first place. A 20% reduction in 80 bits is a big deal, but a 20% reduction in 256 bits is still way outside what we’d consider practical in the forseeable future. Bits are cheap, use lots!

Jonathan Conway •
[February 15, 2005 10:18 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2189)

With the maxim about attacks getting better I’d be worried that with the rate that the SHA family attacks have improved in the last few months we could see even more serious breaks within a year or two.  Not long ago we had reason for deep concern, now we’ve got reason for outright worry.

Fuzzy •
[February 15, 2005 10:20 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2190)

Jordan is correct – 2^69 is still a large data space to search.

[Arash Partow](http://www.partow.net) •
[February 15, 2005 10:23 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2191)

How effective is this attack? For example can it change “attack at dawn” to “attack at dusk” in a file that

has been compressed and then had a sha-1 md made?

Because at the end of the day isn’t that the point of MDs?

-A curious cryptographer…

cjr •
[February 15, 2005 10:23 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2192)

It is not 2^11 fewer operations. It is 2^11 *times* fewer operations, roughy 1/2050th the work.

The point isn’t so much that it takes less time but that it has an large and now known weakness. It is very likely other weaknesses will come to light making it useless for secure hashing.

[Davi Ottenheimer](http://davi.poetry.org/) •
[February 15, 2005 10:34 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2193)

@Bruce

I don’t know if you saw the Cryptographer’s Panel today, but Avi Shamir mentioned the Chinese team’s report and the need for better hashing.

[Sean](http://www.coldstream.ca) •
[February 15, 2005 10:49 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2194)

oh my. its amazing how human brainpower [and some patience and creativity] can ultimately defeat ANYTHING presented to it.

Good for the chinese team! [congratulations!]

time to build something better than SHA1

[Peter](http://geminisecurity.com) •
[February 15, 2005 11:38 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2195)

I think it is important to note that (from what I’ve heard, I haven’t seen the paper either…) this collision attack is not very “real world” useful. Their attack is focused on taking a certain number of operations to come up with two hunks of data that result in the same hash.

In my opinion, a “real world” attack would be one which given a blob which has already been hashed, would come up with another blob which results in the same hash. To my knowledge, nobody has any useful attacks in that direction yet, although some would argue based upon this research that it may just be a matter of time.

Then we of course need to get into whether that is really useful either. If I find out that “I agree to purchase 100 units for $500” and “\*(\D$Hw&72d98a %93di(hd eLKH%ap$#” results in the same hash, how helpful is that to me? How is a lawyer is going to prove to a jury that I may have actually signed the garbage instead of the purchase agreement? So, there is even more work to be done to make it a useful real world attack, wherein you might take the original signed text (modified for your evil purposes), append a null character, and then add garbage until the hashes are equal–and hope the UI was poorly written and just displays up to the first null.

[Gavin Weld White](http://www.wandreilagh.org) •
[February 16, 2005 12:11 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2196)

If this solution lends itself to distributed computation, and one in a million people online were to participate in such a project, the first publicly generated SHA-1 collision should be produced by the end of 2010.

That is assuming the use of cheap modern desktops, Moore’s law, and linear growth of online population in line with the predictions of Computer Industry Almanac (140 million new users/year, and thus net growth of 140 new participants/year — probably under-estimating growth of participation here).

If participation were higher, say one in a thousand, we’d be cracking them at a rate of one every other month.

John •
[February 16, 2005 12:12 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2197)

Peter, let me guess.. you’re from slashdot?

[Chui Tey](http://teyc.editthispage.com/) •
[February 16, 2005 12:31 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2198)

Would a combination of multiple hash algorithms make it more difficult to obtain collissions?

say MD5 + SHA?

Andrew Wade •
[February 16, 2005 12:34 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2199)

> 2**69 operations is still an awful lot of
>
> operations. What is it that lets us say that
>
> 2**69 is “broken” but 2**80 is “not broken”?
>
> The 2**80 is a brute-force attack. Less than brute force means that it is “broken”, for the reason cjr gave. (“broken” and defeatable in practice are two different things). The only exception to this convention I’m aware of is in public-key cryptography.
>
> AFAIK, all known public-key algorithms are vulnerable to less than brute-force attack. The key sizes are boosted to compensate, for lack of any alternative.

Anonymous •
[February 16, 2005 1:17 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2200)

Where people take p = password

p’ = sha1(p)

or

p’ = sha1(p, nonce)

This case is reasonably safe as you’re allowed collisions in the problem space (different users can (and probably do) choose the same password)… as long as p’ is not exposed to the attacker.

The problem sets in when you use MD5 or SHA1 for digital signatures:

For example:

md5sum file

This allows an attacker *theoretically* to change file and compute the same hash from a different bag of bytes. This eliminates the trust you might have had in the file being made available to you.

One ISP I know “verified” downloads from a nearby mirror using a similar method. It wasn’t until I pointed out that an attacker could change the source by contributing to the application. Verification of checksums / hashes is not the be all and end all, but this break by the researchers makes it more difficult to trust the class of hashes which have been shown to be weak for verification purposes.

Andrew

Anonymous •
[February 16, 2005 1:26 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2201)

Very impressive if it pans out. In some ways, the writing was on the wall with their earlier work, but you still just someone don’t beleive it’s coming. WOW!

Looking forward to a public release after they get any typos out (understandable).

[Praveen](http://www.isrc.qut.edu.au) •
[February 16, 2005 1:51 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2202)

The design structure of all hash functions in the MDx and SHA family is based on an unbalanced Feistel network structure opearting in a non-linear feedback shift register mode which we told last year june in our new hash function design paper called CRUSH mentioning that this structure is a single point of failure for cryptography.

Regards

Praveen Gauravaram

Phill •
[February 16, 2005 2:00 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2203)

SHA-1 is broken but not yet cracked. This is a compressor function collision, getting to a full hash function collision has not yet happened.

We have a couple of years (but not much more) to plan a transition to more secure algorithms.

Mike •
[February 16, 2005 2:07 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2204)

Okay, could someone a bit more well-versed in the Hows and Whys of cryptography step up and explain why a hash algorithm that is “broken”, when used in an HMAC setup, is suddenly “not broken”?

Is it simply because we’re suddenly involving a secret key?

If so, could not these advances mean that obtaining that secret key may be a bit easier than we previously thought, too?

Louis Cordier •
[February 16, 2005 2:34 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2205)

I notice everyone are still using Moore’s law in their calculations, didn’t they notice things are changing, we’re hitting the limit.

<http://www.gotw.ca/publications/concurrency-ddj.htm>

Mike •
[February 16, 2005 2:52 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2206)

Digital signatures aside, I think this attack would be devestating to the current wave of file-sharing networks. The one I am most familiar with is the ed2k network, especially using the eMule client. eMule has since distanced itself from the original MD4 (yes, you read it right) used for integrity checking in favor of SHA-1. However, if even this has been cracked, there’s now nothing stopping an attacker from substituting random garbage for blocks of legitimate content…and without anyone being the wiser until it’s too late. The blocks would continue to pass virally from node to node with no way to determine whether they’re legit or not. Score +1 for the \*\*AA’s of the world =(

Jan-Eric Duden •
[February 16, 2005 4:51 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2207)

if SHA-1 is broken now,

what are the alternatives now?

Any suggestions?

Louis Cordier:

It is true that ordinary processors dont double their raw processing speed every 18 months anymore.

However, the trend goes now to multi-core processors. A multi-core processor is perfect for cracking SHA-1 since there are a lot of independent calculations to do.

Tobias Gondrom •
[February 16, 2005 4:55 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2208)

I agree with my collegues above: 2^69 is still huge.

And what I might like to add is that we are talking about *speculation* as long as the paper is not published. Until we don’t see the paper (with all the qualifications that must be fulfilled for the attack to work), I think it is quite dangerous to discuss sheer assumptions. (although I am very exited to get my hands on this paper and nervous about the possible consequences)

Johannes •
[February 16, 2005 5:06 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2209)

@Mike

> However, if even this has been
>
> cracked, there’s now nothing stopping
>
> an attacker from substituting random
>
> garbage for blocks of legitimate
>
> content
>
> It isn’t *that* broken. Computing power is still stopping the attackers.

And also in your scenario. If I were the attacker, I would simply tell you that my random bytes had the legitimate SHA1-value. You still wouldn’t find out I fooled you until the whole file was downloaded.

SHA1 in p2p-networks serves as a way for users to compare two files. You still have to trust the one giving you the SHA1-value. Integrety of the file is not assured.

[Praveen](http://www.isrc.qut.edu.au) •
[February 16, 2005 5:08 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2210)

If the argument that it was attacked by 2^69 computations is true (we don’t have proof yet) then we can safely say it is broken as it is less than B’day on SHA-1. It is the time for us to look at new designs. The good start is to have a new kind of iterative structure first than Merkle-Damgard structure. So the question is what kind of abstract structure or a hash function model can resist these attacks. Once the compression function is attacked, the attack can be extended to other blocks as well with further research. So hash value and the chaning value should be different and chaning value should be more than the hash value. Interesting to see Stefan Lucks proposed structure.

The future research should proceed on these lines. We need to have secure hash functions and give importance to efficiency once you achieve security in the first instance. Anyway, the performance expected from a hash function depends on the application

Anonymous •
[February 16, 2005 5:21 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2211)

Andrew Wade wrote:

> The 2\*\*80 is a brute-force attack. Less than
>
> brute force means that it is “broken”, for the
>
> reason cjr gave. (“broken” and defeatable in
>
> practice are two different things). The only
>
> exception to this convention I’m aware of is in
>
> public-key cryptography.
>
> AFAIK, all known public-key algorithms are
>
> vulnerable to less than brute-force attack. The
>
> key sizes are boosted to compensate, for lack
>
> of any alternative.

All hashes are necessarily vulnerable to less than brute-force attack as well, simply because they are hashes. Anytime hashtext is allowed to be shorter than the corresponding plaintext, collisions must occur because the possible combinations are more finite. There is no way around this, so like for public-key cryptography, one must compensate by having longer hashtext. The perceived usefulness of modern hashes appears to exceed the perceived usefulness of the 8-bit checksum by a magnitude proportional to how many more collisions the 8-bit checksum would have in the given application. Defining “broken” as “requiring less than brute force” therefore renders the term “broken” meaningless since, in the absence of more “secure” hashing algorithms, making the hashtext longer necessarily reduces collisions. However, because when the length of the hashtext reaches the length of the plaintext, you essentially have symmetric cryptography with a known key and algorithm (unless of course the algorithm allows collisions when hashtext length equals plaintext length, currently seen as undesirable), there is a paradox where a longer hashtext is also less secure. The true usefulness of a hash is proportional to how much processing it takes to find a collision. If we assume that the more processing it takes to calculate a hash in the first place, the more processing it would take to find a collision, the challenge becomes the development of hash algorithms that take more processing power. If available processing power were to cease increasing, the practicality of finding collisions would also cease to increase, and there would be no further need or use for newer hash algorithms that take more processing power. As long as that doesn’t happen, expect each hash algorithm to be replaced periodically with a newer one that takes more steps to calculate. After all is said and done, that is really the only way to stay ahead of the game.

[Victor Bogado](http://www.bogado.net) •
[February 16, 2005 6:00 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2212)

what now? With MD5 and SHA-1 being cracked, what hash function is considered secure?

[Sam Trenholme](http://www.samiam.org/) •
[February 16, 2005 6:21 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2213)

I have a number of hash functions here in source code format:

<http://www.maradns.org/download/sums-20011111.tar.bz2>

And papers for these hash functions:

<http://www.maradns.org/download/sums-papers-20010818.tar.bz2>

Some interesting stuff is here:

Tiger: 192-bit hash. Not broken yet.

Whirlpool: 512-bit hash; uses a Rijndael (AES) variant as the compression function.

AEShash: Hash algorithm that uses Rijndael as the compression function.

* Sam

[Victor Bogado](http://www.bogado.net) •
[February 16, 2005 6:50 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2214)

Maybe we should start encoding meta-data along with the hash, so instead of trusting only on the hash to confirm that the message is from who sign it, we would encode along the message, the size, type and whatever characteristic could define the message.

For instance, suppose I sign the message “Hi, I’m Victor”, along with the hash it would contain the size (14 bytes), type (English text), encoding (7bits ASCII) and how about the range of codes used in the messages (from U+0027 – U+0074).

A good hash would give a uniformly distributed random hash for the message, so it is safe to assume that even if we could find a collision, it would be highly unprovable that it would satisfy all the meta-data. In some cases it could be provable that this kind of hash is unbreakable, since there is a finite number of messages that satisfy the meta-data (if you could hash all possibilities and verify that there were no collisions you’re 100% safe).

Simon Steinmeyer •
[February 16, 2005 7:16 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2215)

History shows that reducing the brute-force key space of an algorithm is only the beginning of the end: I am sure that the attack will be optimized and improved, so that the key space will be further reduced. This has been shown during several attacks on FEAL, too.

That means that we should not trust that in near future the key space stays at 2\*\*69. When similar hash algorithms also shows the SHA-1 weakness, then we need an new hash algorithm nearly immediatly.

Mike •
[February 16, 2005 7:32 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2216)

I’m not a cryptographer but to those who want to know why HMAC use of a hash function is not broken, it’s because, as somebody else suggested, of the key.

With a digital signature all you have to do is find another blob of data which hashes to the same hash. You are free to choose any blob of data.

With HMAC you are not free to choose any other blob of data because a secret key is always added to the data before it is hashed and you don’t know that secret key. So you still need to guess the key or the person verifying the HMAC will get a different hash than you.

(On a side-note, how the heck do I get line breaks when I post comments?)

Mike •
[February 16, 2005 7:33 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2217)

Oh, they show up in the real post but not in the preview. Marvelous.

Scott Stanfield •
[February 16, 2005 7:58 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2218)

Pardon my ignorance, but what good does it do me if I can find a few collisions with a digital signature on a document? Aren’t the collisions going to be a bunch of gibberish that hashes to the same value? How would I use the gibberish to cause trouble? I can see a DOS scenario, where I replace a good message with gibberish, but I can’t see how I could massage a message to say something intelligible but different, like “deposit this in another account,” or “I inhaled,” or whatever.

johan •
[February 16, 2005 8:11 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2219)

The importance is that often there is someplace in the document that you can change willy-nilly, while retaining semantic meaning.

for CRC-32, all you needed was 4 bytes in a row, and you could completely control the hash of the document. I don’t know how many are needed for SHA, but let’s say that it is on the order of 80 bytes:

* In a jpeg, you could add a comment
* In a MS .doc, you could add meta-data
* in an exe, you might be able to add stuff at the end, outside the instruction stream.
* In HTML, add stuff in a javascript comment or after the closing html tag

For anything but raw text, it really isn’t that hard to find a large number of contiguous bytes you can modify without changing the semantic meaning.

Kevin •
[February 16, 2005 8:13 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2220)

Scott, you ignore the fact that forcing a collision can be done not only with a gibberish message but also with a message containing a few bytes of gibberish. Consider the case where a cryptosignature is used to keep a machine from running untrusted software. An executable file can contain a few bytes of gibberish without compromising its ability to run (just stick it in an unused constant somewhere), and then be signed as if it came from a trusted source. This is a bad thing indeed.

RXD •
[February 16, 2005 8:16 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2221)

A few people here are questioning the meaningfulness of this attack, because they think that a collision to a known plaintext “I’m Bill.” would look something like “,#&($@<?}\*(&³µG” – which would be basically useless, I would usually think the same.

BUT, remember the MD5 attack… when I first saw it, I was VERY impressed NOT because they DID find a collision, no! But because the collision had only A FEW bytes changed to the original message.

Look here: <http://www.x-ways.net/md5collision.html>

You can see there are ONLY 24 bits (or even less) changed (which is 2.4% of this 1024bit message).

So this scenario IS a reason to panic. And as soon as they will publish a SHA-1 collision with the same ‘features’ as the MD5 collision, we are in trouble.

vipul •
[February 16, 2005 8:22 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2222)

<http://eprint.iacr.org/2004/199>

Previous attacks by the same team of researchers

grisu •
[February 16, 2005 8:35 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2223)

hmmm.

SHA-1 has 2**80 unique hash-numbers. fine.

But isnt the odd to get one 1/2**79, because statistically, I hit one after 2\*\*79 tries after trying all?

please excuse my bad english.

—

grisu

John Kelsey •
[February 16, 2005 8:42 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2224)

Concatenating MD5 and SHA1 doesn’t give you as much extra security as you’d think, because of this beautiful result from Joux at last year’s Crypto. Basically, if it takes you 2^{69} work to cause a collision in SHA1 in a general context (from most any starting hash value), the most it can take to find a collision for SHA1 || MD5 is about 2^{75}–you find 64 places in the message where you can insert a colliding value for SHA1, and then do a 2^{64} search to find a collision between those in MD5. (If this isn’t clear, go read the Crypto 2004 paper–the result is not hard to understand at all!)

HMAC is harder to attack because the attacker doesn’t know the internal values of the hash function when she’s choosing her message blocks. To the extent that she needs to know what some bits of the hash chaining value are to choose the next message bit, her attack is blocked. But since Wang & company ahven’t published details of their attacks, it’s really not possible to know how big a problem this is.

The eprint archive has a nice paper by Phil Hawkes and Greg Rose trying to reconstruct the Wang attack on MD5, which is probably getting a lot of downloads right now….

–John Kelsey

Piw •
[February 16, 2005 8:46 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2225)

Please explain me one thing.

Everyone keep saying: SHA-1 is broken… It takes 2^69 operation to broke it…

I dont understand.

Every hashing algorithm will have collisions. Every. Because we have limited hash space to represent unlimited variants of data. Yes? Yes.

So EVERY algorithm can be broken. They manage to collide in 2^69 tries of 2^80 possibilites. ENORMOUS LUCK. Its not something to remember.

Lets say, after introduction od SHA-256 I broke it in 20 tries. Luck. Then you say SHA-256 is broken??? How could you use word broken… I merly manage to collide.

So concluding. Using your words, every hashing function is broken. Only time and luck is important.

I think that it doesnt matter if someone find colision or not. It wont change nothing. Keys must became longer, as computing power grows greater, to keep teoretical computing time relatively impassible long. And of that time is 2^99999 years, and someone manage to find collision id 5 days? It changes nothing. He got lucky.

hamish •
[February 16, 2005 9:00 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2226)

Just to clarify, SHA-1 produce a hash of 160 bits (20 bytes). Collisions can be found with 2\*\*(bits/2) by the brithday attack – go look at google for hash and birthday attack for explanation.

160 bit hash => 2\*\*80 steps to find a collision.

SHA-256 has a 256 bit hash (32 bytes) and works with a similar algorithm to SHA-1. So 2\*\*128 steps is brute force. Using that (or SHA-512) would give a period of grace, but the attack may well be applicable to these, so a hash with a completely new basis would be “a good thing” ™.

With the rider that anything new probably needs several years of cryptanalysis before we would trust it …

hendler •
[February 16, 2005 10:01 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2227)

rainbow hash tables anyone?

Anonymous •
[February 16, 2005 10:19 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2228)

Bruce,

You didn’t actually read the paper, did you? If you did, you would have noticed the footnote which says that the attack isn’t on “the real thing”.

Stop spreading rumors.

Anon •
[February 16, 2005 10:59 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2229)

I like the way your titillating announcement of the work of Wang, et al upholds predictions you made late last year, Bruce. How lucky for you!

For reference: <http://www.computerworld.com/securitytopics/security/story/0>,,95343,00.html

Btw, how obnoxious is it to reference something that no one else can read?

Hey – other anon person, you’re anon – why don’t you post a link to your resource???

*disgusted*

[Steve Friedl](http://www.unixwiz.net/blog/) •
[February 16, 2005 11:38 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2230)

After last summer’s announcement of the initial hash research, I wrote what many have said is a good overview of the subject:

An Illustrated Guide to Cryptographic Hashes

<http://www.unixwiz.net/techtips/iguide-crypto-hashes.html>

Joshua Stephanoff •
[February 16, 2005 11:38 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2231)

Having actually implemented both SHA-1 and MD5 in assembly (while I was in college, in a calculus class), the length of the actual data is appended to the last null-padded block. So, even small changes in the size have a significant impact on the final sum, and cannot be covered up by any blocks of data coming after it (except for man-in-the-middle, but that is useless in most situations). Other meta-data should be used as a signature, where it is included in the original data, outside the data, where it is hashed, and then both hashes are hashed (basically what PGP does).

In the message “Hi, I’m Victor” there are 12 different characters. If only these 12 characters are allowed, there are 12**14 = 1283918464548864 or 1.28e+15 possibilities that could satisfy all the meta-data. The total possibilities for a SHA-1 sum is 2**160 ~= 1.46e+48. Using 1 bit as a flag for each sum would require 2**160 /8 ~= 1.83e+47 ~= 1.62e+32 PB (1PB= 1024*1TB= 1024*1024\*1GB, I think) of storage. In the much reduced 12**14 number of possibilites, this would still require a minimum of 12\*\*14 \*20 ~= 2.57e+16 ~= 23,914,845 GB ~= 22.8 PB of storage, if each sum was unique (we cannot use the 1 bit mapping in this reduction).

Using the techniques of this not yet published paper could reduce the storage requirement, but the only messages that could be proved to have a unique hash are those that are shorter in length than the hash. In the case of SHA-1, this is 20 bytes.

Using the vulnerabilities to prove the authenticity of a short message is not yet too practical.

A pretty secure hash method would be something like the following:

fast:

d1= hash1(message);

d2= hash2(message);

d3= hash1((message+d1)+d2);

slow:

d1= hash1(message);

d2= hash2(message);

d3= hash1((d1+message)+d2);

The 2 hash functions MUST be different to a good degree (I believe SHA-1 and MD5 suffice, from my experience). The + operator is equivalent to appending the right operand onto the left, i.e. “a”+”b”=”ab”. d1, d2, and d3 are the message digests. All three digests MUST be distributed, along with what format the digests are in (hexadecimal or base64), along with what hash functions were used, along with the designation “slow” if the slow method is used (“fast” is default).

The fast method could be computed fairly quickly by doing the 2 hashes on each block (making use of the processor cache), except for the final blocks. The slow method should be more secure, as only d1 and d2 could take advantage of the cache effect (d3 would have to be computed from scratch).

Creating a collision on d1 and d2 would be pretty difficult, d3 would be much more. d1 and d2 MUST be hashes of only the original message, as hash2(mesage+d1) could make it easier to find a collision (as the effective message would then be different).

I am not a cryptographer, but this scheme seems obviuosly much harder to crack for many reasons.

As far as I know, this scheme is original, but is similar to PGP and 3DES. I think this is an obvious possible solution, and as such cannot be patented.

Tell me what you think.

Michael Sierchio •
[February 16, 2005 11:47 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2232)

It’s important to qualify what is meant by “broken” — the ability to find collisions weakens the use of a cryptographic hash in digital signatures.

The speedup is about 0.0005 over the brute force average for finding a collision.

[CasinoRobots.com](http://www.casinorobots.com/poker/collusion.htm) •
[February 16, 2005 12:00 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2233)

Interesting, but not quite as interesting as colluding Poker Bots.

[Kryptogramma](http://www.cryptogram.gr) •
[February 16, 2005 12:23 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2234)

> rainbow hash tables anyone?
>
> Posted by: hendler at February 16, 2005 10:01 AM

Creating rainbow tables for an algorithm has nothing to do if it is broken or not.

rainbow tables use the hashing algorithm the way it is supposed to be used and creates a “dictionary” of cleartext->hashes value.

You can generate rainbow tables for any algorithm you know the workings of (preferably have source code too). The thing is having enough disk space to store that information..

Try this: Use a rainbow table generator which tells you the etsimated key space and disk space, enter the following parameters.

Charset: full

Hash: SHA1 Min Len: 1 Max Len: 263

Chain count: 57,000,000 No of Tables:

9,999,999,999 (maximum)

With this data, the program i am using says the key space is 1.#INF, disk space: 1.665.497.180.-45 GB, and success probability: -1.#INDO (-1.#J%)

Obviously, this is too large for the program to even calculate the key space.

And that’s for the domain, if you want to calculate the range try:

Sha1, min 1, max 160, charset hex, chain count 40000000, no of tables 9999999999.

The RANGE key space is merely 4.867\*10^192.

I hope you get the message.. If you want to do rainbow tables, better have a lot of disks.. But since NIST couldn’t do it to validate the algorithm, then neither can you.

Anonymous •
[February 16, 2005 12:25 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2235)

How is the 2^69 hash operations assertion to be understood? Is the cost the same no matter what the message input size? Also, can collisions be found for any input message?

[Linas Vepstas](http://www.linas.org/math/sl2z.html) •
[February 16, 2005 12:35 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2236)

Re compute power:

The IBM/SONY/Toshiba Cell processor has 1 ppc64 core and 8 special processors (SPE’s) per 30-watt chip, clocked at 4.5 GHz. Each SPE can dispatch two instructions per clock; each SPE has 128 registers that are 128-bits wide and are joined with 4 128-bit busses running at half clock speed. This provides something on the order of 100+ (and maybe more) general purpose Giga integer ops for things like code-breaking.

Conclusion: 1000 Sony playstation-3’s appropriately hacked would draw 30KW of power (a bit on the high-end for a suburban home, but achievable) and could achieve 2^36 ops/sec x 2^16 secs/day x 2^10 consoles == 2^62 ops/day — OK, but each round might take 2^8 (?) ops so its maybe 2^54 rounds/day within reach of a crazy retired .com CEO, from their garage. That’s an awesome large number…

John •
[February 16, 2005 12:36 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2237)

If you’re using a supercomputer that does 40 teraflops (40 trillion operations per second), then it would take… *thinks*… between 12 and 13 years, and about 6 years on average.

[Stephen SamueL](http://www.bcgreen.com) •
[February 16, 2005 12:57 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2238)

It’s not inconsistent with the tennents of research to not be publicly trumpeting this research.

First of all, I presume that the current distribution is for the purposes of refereeing for a peer-reviewed publication. They may also be asking for verification of their results — given that it could be extremely embarassing to have this wrong (in proportion to the notoriety gained by having this right.

This is also somewhat sensitive information, so they may want ‘white hats’ to have a couple of weeks knowledge to prepare for the stuff that hits the fan when this becomes public knowledge.

Richard Braakman •
[February 16, 2005 1:34 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2239)

One way of looking at it is that breaking SHA-1 with 2**69 operations is still more work than brute forcing MD5 with 2**64 operations.

[Dan Kaminsky](http://www.doxpara.com) •
[February 16, 2005 1:53 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2240)

I wrote the “MD5 To Be Considered Harmful Someday” paper that discussed attacks given only Wang’s test vectors. This is…a bit different.

It’s a 2^69 attack against SHA-1, which has the distinct problem of being 32x the complexity of bruting MD5 (2^5 = 32). We never did see a MD5 brute; we needed Wang’s reduction to a 2^24 to 2^32 for us to eventually end up with vectors.

I don’t expect to ever see SHA-1 collision vectors. We still need to migrate away, but this is akin to Dobbertin’s proof of possibility right now. Respond, don’t panic.

Tracy Milburn •
[February 16, 2005 2:37 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2241)

Don’t tell me not to panic! I will panic immediately, THANK YOU!

Anonymous •
[February 16, 2005 2:40 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2242)

What’s the practical implication of this research?

For example, how hard is it to create an X.509 certificate that looks like a valid Microsoft code-signing certificate with the attacker’s public key? I’m assuming it is relatively trivial for the attacker to create a certificate extension containing the appropriate random garbage, but is it really 2^69 operations to select the right garbage?

[vzn](http://groups.yahoo.com/group/theory-edge) •
[February 16, 2005 5:44 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2243)

theory-edge,

mailing list/discussion for cutting edge developments in mathematics & algorithmics, click my initials

open4free •
[February 16, 2005 6:22 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2244)

MY PERSONAL TOP SECRET TO BREAK CODES: ParaModulation SATisfiability (Para-SAT) and Quantum Computing (Schor-like).

Dictionary Attacks ARE INSUFFICIENT!!!.

Patrick •
[February 16, 2005 7:42 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2245)

948fad80398ce3df645c91da456c2669e7fed61f

crack this hash 🙂

[Kryptogramma](http://www.cryptogram.gr) •
[February 16, 2005 8:20 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2246)

> And that’s for the domain, if you want to calculate the range try:
>
> Sha1, min 1, max 160, charset hex, chain count 40000000, no of tables 9999999999.
>
> correction on my previous post:
>
> min here should be 160 as the key length is fixed. Sorry about that.

David Schwartz •
[February 16, 2005 8:53 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2247)

Actually, this sort of attack has real uses, assuming you have the computing power to do it, which organizations that can produce fast hardware implementations on custom chips can.

If you can produce two SHA1 strings that collide and are a multiple of the fundamental hash length, any two strings that begin with those two will also collide.

This means that I can trivially produce any number of strings, whose last bits I can choose, and they will collide.

Consider a message format where the first two bytes are the length of the first object and then after that object are other objects. I can pick any chunks that collide, pad out to object length, and then follow with objects of my choosing. The two final strings will collide in their hashes, be different, and have a lot of content over which I have control.

You can do the same thing for the end of a message.

David Schwartz •
[February 16, 2005 8:56 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2248)

grisu: No, it’s 2^40 operations. Google for ‘birthday paradox’.

DS

Anonymous •
[February 16, 2005 11:19 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2249)

Yeah… so… why isn’t the paper generally available yet? Is it unfinished (and thus premature)? Or do the authors just have a penchant for childishness? Perhaps they’d rather sell it copy-by-copy for a low low price of only 500 RMB! Act now!

All I’m seeing so far is “Bruce Sez he saw something that could have meant that maybe SHA-1 is broken.”

Which is great and all, but since there are so many crypto people in the hizzy (and would-be crypto people, too), why doesn’t someone work out how reasonable it is to take this purely based on trust and reputation. And what impact it has on someone’s reputation to say something was broken without being able to point to proof.

Is peer review a dead art? Replaced by cult of personality?

Jeremy •
[February 16, 2005 11:22 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2250)

I really wish people would stop saying “broken”. Yes, I know that cryptographically it is broken. But practically, at least for now, SHA-1 is still plenty strong. 2^69 attempts is a whole lot harder than finding a non-crypto flaw in a system. As Schneier himself admitted in his most recent book, crypto isn’t the weak link in most systems. Focusing on a (significant) weakness in a crypto algorithm gives the impression that the crypto is what makes the system secure, when in fact even a flawed algorithm like SHA-1 is still the strongest link in the security chain.

Anonymous •
[February 17, 2005 1:04 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2251)

Even when these same people “broke” MD5, it was still a pretty limited break for most practical purposes. They could, maybe, generate two messages with the same hash, but that was far and away different from being able to generate messages that collide with a given hash.

> Is peer review a dead art? Replaced by cult of personality?

Yes to both. And Bruce is up there at the front of the seething masses.

J (again) •
[February 17, 2005 1:13 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2252)

Just Re: SHA-1/MD5 and all the “hash-bash”: I think it’s important to emphasize that we are NOT talking about finding a collision to an arbitrary (i.e. chosen) plaintext message. Just colliding two random ones, at better than Bday paradox. So we’re not all doomed just yet, contrary to the girl who stood outside Moscone today with the sign (see <http://hisown.com/temp/02160020.JPG> and …21.JPG 😉

J

Anonymous2 •
[February 17, 2005 9:24 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2253)

> Is peer review a dead art? Replaced by cult of personality?
>
> > Yes to both. And Bruce is up there at the front of the seething masses.

I posted the *disgusted* comment yesterday – and am so happy to see that I’m not the only one NOT sitting on the “Bruce Sez” bandwagon…

Double-nots aside, it’s a good day!

Brian Candler •
[February 17, 2005 12:08 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2254)

When this team broke MD5, they published two strings which had the same MD5 hash. It’s trivial to verify – once you’ve got your head around the byte-ordering issues 🙂

So for me the question is: has this team actually created two distinct strings which hash to the same SHA-1 value?

If they have, why not just post them so we can all verify it? But if not, then I don’t think it’s reasonable for anyone to claim point-blank that SHA-1 has been “broken”. “Weakened”, maybe.

Based on Bruce’s reputation, I’d say they’ve probably done it – but it would be helpful if he could clarify this by saying outright that the paper does (or does not) include an actual SHA-1 collision.

[Bill Cheng](http://merlot.usc.edu/william/usc) •
[February 17, 2005 2:08 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2255)

Even though an attacker can replace a document with digital signature with a garbage document with the same hash, it should be easy to convince any judge or jury that if someone can produce a readable document with the same hash, it is likely that such a document is original. The question in my mind is how many tries would it take to create a document that is at least 50% similar to the original document and produces the same hash.

I guess the lesson with digital signature is that any digital signature scheme should allow multiple hashes to be used! It’s probably very very difficult to find 2 messages that produce identical MD5 *and* SHA-1 hash values. Is it?

Bretty •
[February 17, 2005 7:33 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2256)

Cryptography has a long history of people saying, “don’t worry, it’s just a scratch.”

This announcement means that it is time to look very seriously at the entire SHA-x family, and its alternatives. It is almost guaranteed that any weakness will be a foundation for more powerful attacks in the future. Expect (2 ^ 69) to have a considerably smaller exponent within 12 months.

Tony Su •
[February 17, 2005 10:12 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2257)

Exciting news!

For people who have doubts about the news, please read this:

Chinese researchers compromise SHA-1 hashing algorithm

<http://www.commsdesign.com/news/showArticle.jhtml?articleID=60401254>

> > > > > > > > > > > > > > > > > > > > > > > > >

……

Shamir and others said they believe the work of the Chinese trio will probably be proven to be correct based on their academic reputations, although details of the paper are still under review.

……

“This break of SHA-1 is stunning,” said Ronald Rivest, a professor at MIT who co-developed the RSA algorithm with Shamir. “Digital signatures have become less secure. This is another reminder that conservatism is needed in the choice of an algorithm,” added Rivest at the panel session.

Rivest noted that one member of the China team, Lisa Yin, was a PHD student who studied under him at MIT. Another member of the team was responsible for cracking the earlier MD5 hashing algorithm.

“I have strong reasons to believe the results [of the paper] are correct,” Rivest said.

……

Tony Su •
[February 17, 2005 10:40 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2258)

Another article at <http://www.theregister.co.uk/2005/02/17/sha1_hashing_broken/> says that it is official that SHA-1 was broken …

If it is based on the same source here, the conclusion may be pre-mature, but it does contain something extra …

“A collision has been discovered in the full version in 269 hash operations, making it just possible to mount a successful brute-force attack with the most powerful machines available today.”

“A collision has been discovered” ?!!! Can anyone confirm that? I sure can wait for 2\*\*xxx days 🙂

Anonymous •
[February 18, 2005 11:38 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2259)

What I’ve seen is a 58/80 step collision which is said to have taken 2^{33} hashing operations. This is up on the web at <http://makeashorterlink.com/?D1605138A>

They don’t have the ability to do 2^{69} operations (that’s a lot of work!). But since the previous best attack was estimated at 2^{71} work to break 53/80 steps, this is a pretty nice demonstration.

–John

transend •
[February 18, 2005 1:25 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2260)

HERE’s the paper

<http://theory.csail.mit.edu/~yiqun/shanote.pdf>

transend the divine water

red ocean ninja clan

Mike •
[February 18, 2005 5:33 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2261)

Wowie! Thanks, transend!!! ^\_^

Weidong Shao •
[February 18, 2005 7:41 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2262)

just fyi, I found the summary paper on Lisa’s web site

<http://theory.csail.mit.edu/~yiqun/shanote.pdf>

The paper on MD5 collision by Wang last year

<http://eprint.iacr.org/2004/199.pdf>

Adeodatus •
[February 19, 2005 12:43 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2263)

> > >
> >
> > Please explain me one thing.
> >
> > Everyone keep saying: SHA-1 is broken… It takes 2^69 operation to broke it…

I dont understand.

Every hashing algorithm will have collisions. Every. Because we have limited hash space to represent unlimited variants of data. Yes? Yes.

So EVERY algorithm can be broken. They manage to collide in 2^69 tries of 2^80 possibilites. ENORMOUS LUCK. Its not something to remember.

Lets say, after introduction od SHA-256 I broke it in 20 tries. Luck. Then you say SHA-256 is broken??? How could you use word broken… I merly manage to collide.

So concluding. Using your words, every hashing function is broken. Only time and luck is important.

I think that it doesnt matter if someone find colision or not. It wont change nothing. Keys must became longer, as computing power grows greater, to keep teoretical computing time relatively impassible long. And of that time is 2^99999 years, and someone manage to find collision in 5 days? It changes nothing. He got lucky.

<<<

But with a collision in hand, it becomes easier to find more collisions.

That, and anyone so astronomically lucky isn’t going to a computer scientist, they’re going to be living off the lottery.

Mike •
[February 19, 2005 11:53 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2264)

Great academic exercise. In the real world though, attackers are going to look for much easier ways to break in than using brute force against a hash. Why bother digging a tunnel into someone’s house if he leaves a window open? Those storing and transmitting classified or very sensitive info should be using a cryptologic system anyway and not just a SHA-1 or MD5 hash.

[ptdd](http://www.ptdd.com) •
[February 19, 2005 9:02 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2265)

Scott, you ignore the fact that forcing a collision can be done not only with a gibberish message but also with a message containing a few bytes of gibberish. Consider the case where a cryptosignature is used to keep a machine from running untrusted software. An executable file can contain a few bytes of gibberish without compromising its ability to run (just stick it in an unused constant somewhere), and then be signed as if it came from a trusted source. This is a bad thing indeed.

---

<http://www.ptdd.com>

<http://www.yiwodisk.com>

baibing •
[February 20, 2005 5:55 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2266)

hi,how are you!

Jaleel •
[February 20, 2005 11:47 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2267)

Adeodatus, you are right.

Best solution for the time being is to migrate to higher range.

It doesn’t make sense to migrating to 256bit, from the existing 160 bit and wait till 256bit get cracked (by assuming that today’s technology won’t grow rapidly, which is a big joke).

I feel better to adopt higher than 256 (something like 512), the probability of cracking hash (in what ever way) will reduce at least 1%

Andrew Wade •
[February 21, 2005 12:49 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2268)

“It doesn’t make sense to migrating to 256bit, from the existing 160 bit and wait till 256bit get cracked (by assuming that today’s technology won’t grow rapidly, which is a big joke).”

Unless I’m missing something (and it’s not the birthday paradox), 128 bit hashes aren’t brute-forceable with today’s technology.

The fastest supercomputers in the world are about 2^48 times faster than the electromechanical Mark-I, arguably the first functional computer.

A 256 bit hash takes 2^64 times as long to brute force as a 128 bit hash, if you have unlimited memory.

In short, 256 bits is plenty.

[nekyf\_s\_bradva](http://www.com) •
[February 21, 2005 4:58 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2269)

I love chickens

[AQlex](http://www.video-poker.tvheaven.com) •
[February 21, 2005 8:11 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2270)

<http://www.video-poker.tvheaven.com>

roger smith •
[February 21, 2005 9:30 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2271)

F5fPxdTq8eJeuqSVejGmq2bp0hU1rv9UelE23rOyfSJQWPR94NpiPSRjVpWraaNby5wlkxMIu4csKR0=

crack this 🙂

<http://www.cgisecurity.com> •
[February 21, 2005 10:35 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2272)

Thanks transend for the link to the paper

<http://www.cgisecurity.com>

Louis Cordier •
[February 21, 2005 11:38 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2273)

After another posting on /. about PGP shifting to a stronger algorithm and reading some of the thread’s comments I was wondering…

One Way Hash functions takes a large set of data

(source) and produce a relatively short string. Since there is no way (very limited chance) of producing the original source data from the hash. All attacks are basically equivalent to “buffer overflow” attacks. Where the attacker modifies the source to produce an equivalent hash. Since we believe the hash is authentic to start with, why not add a source-size parameter to the hash. Most of these attacks modify and append data to the source data to make the hashes match. Given the additional (trusted) information about the

source’s size it would basically limit the usefulness of this type of attack. This will then

basically be a protocol/conformity constraint on the modified source data which would make things

a bit more difficult for any attacker. Other parameters could also be employed, for example a source-symbol frequency, etc.

foo •
[February 21, 2005 2:06 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2274)

Q. What do you get when you break a cryptographic hashing algorithm?

A. A new compression algorithm.

[zetalimit](http://www.texas-holdem-playing-cards.com/) •
[February 21, 2005 4:42 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2275)

<http://www.beyond-science.com> broke every laws of physics

also look at <http://www.texas-holdem-playing-cards.com/>

Andrew Wade •
[February 21, 2005 11:01 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2276)

> Unless I’m missing something (and it’s not the birthday paradox), 128 bit hashes aren’t brute-forceable with today’s technology.
>
> I was missing something, and 128 bit hashes are brute-forceable. See the newer thread for a low-memory technique:
>
> <http://www.schneier.com/blog/archives/2005/02/cryptanalysis_o.html>

I still think 256 bit hashes have a comfortable margin.

[puser](http://www.ptdd.com) •
[February 22, 2005 9:30 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2277)

How is the 2^69 hash operations assertion to be understood? Is the cost the same no matter what the message input size? Also, can collisions be found for any input message?

[Henry Small](http://www.72works.com) •
[December 3, 2005 4:44 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2278)

Someone has done a great thorough job. And the confidence is not so profound any more.

[Online Appied Information Systems](http://oai_sys@yahoo.com) •
[December 6, 2005 5:16 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2279)

The IBM/SONY/Toshiba Cell processor has 1 ppc64 core and 8 special processors (SPE’s) per 30-watt chip, clocked at 4.5 GHz. Each SPE can dispatch two instructions per clock; each SPE has 128 registers that are 128-bits wide and are joined with 4 128-bit busses running at half clock speed. This provides something on the order of 100+ (and maybe more) general purpose Giga integer ops for things like code-breaking.

HASHIM KAREEM •
[January 2, 2006 10:31 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2280)

all block ciphers are breaked bye “hashim search algorthim” see {cryptology group}

in yahoo

[hashim kareem](http://rsa) •
[January 2, 2006 10:35 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2281)

new formula of number factorization

p^2+q^2-w^2=j

where

p\*q=j p,q prime numbers

also

p/q+q/p- c=1 where c=w^2/j

is enouph to break

RSA IN POLYNOMIAL TIME

[Bruce Schneier](http://www.schneier.com/blog) •
[January 2, 2006 2:00 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2282)

“new formula of number factorization

p^2+q^2-w^2=j

where

p\*q=j p,q prime numbers

also

p/q+q/p- c=1 where c=w^2/j

is enouph to break

RSA IN POLYNOMIAL TIME”

I get this sort of nonsense in e-mail *all the time*. This is the first one you all get to see.

Since the invention of the RSA public-key algorithm, all cryptographers get this sort of nonsense all the time. We either have to read through them all, which is a waste of time, or ignore them all, which has the potential of ignoring an actual breakthrough.

This is why RSA Security invented the RSA Factoring Challenge. Basically, these are a series of increasingly long numbers to factor. Some of them have been factored already, but many have not.

<http://www.rsasecurity.com/rsalabs/node.asp?id=2092>

Now, every time I get one of these “I can factor numbers faster than everyone else,” I send them to the webpage. If they can factor numbers that no one else can, they’ll have no problem getting every mathematician to listen to them. If they can’t, mathematicians will have no problem ignoring them.

[Bruce Schneier](http://www.schneier.com/blog) •
[January 2, 2006 2:02 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2283)

“all block ciphers are breaked bye “hashim search algorthim” see {cryptology group}

in yahoo”

This kind of thing we don’t even bother responding to.

Pete •
[February 10, 2006 5:37 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2284)

I’m not an expert, so please don’t make fun of me if I sound like a complete idiot.

I can see that this crack poses a theoretical threat to the security of SHA1, but how does it affect a regular user? What good would it do an adversary to find a collision in someone’s digital signature? The adversary could change the original message to the collision he/she had found, but odds are that the “collision message” would make absolutely no sense whatsoever. The recipient would get a string of absolute jibberish that was certified as being sent by his/her friend. I’m probably overlooking something here, but what security risk does this really cause? There would be a real danger if someone found a way to reverse the hash and reveal the plaintext message that the sender had signed.

My apologies if I sound like a fool.

[MilfHunter](http://milf_hunter.webs-zone.biz/) •
[February 16, 2006 1:26 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2285)

Yeap

Laurent Busser •
[March 1, 2006 7:38 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2286)

Tell me if I am wrong but if digital signatures can be forged due to SHA1 collisions, it will be probably much more interesting and easier to create fake certificates than fake messages.

A fake certificate can be reused much more times than a fake message and the ‘return on investment’ will be higher for anybody wanting to steal identity…

Jens •
[August 4, 2006 6:05 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2288)

So, having read the entire blog, I make the following observations.

1. SHA-1 is cracked though it takes some significant effort to find the crack (unless very lucky).
2. If we use HMAC-SHA-1, it is not cracked (yet) so doing so would give us the level of security we wish.
3. Creating SSL certificates [C and C’ where H(C) = H(C’) ] for installation on servers where C’ utilizes a wildcard for the domain name or has other malicious features, represents the most significant danger.

Sound about right?

[Frank](http://www.anarchique.de) •
[August 9, 2006 5:15 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2289)

Guess you´re right as i undestood the same. As long as there are enough powerful computers combined with skilled researchers nearly every key-crack seems to be possible (in the long run).

Anonymous •
[August 18, 2006 9:56 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2290)

“new formula of number factorization

p^2+q^2-w^2=j

where

p\*q=j p,q prime numbers

also

p/q+q/p- c=1 where c=w^2/j

is enouph to break

RSA IN POLYNOMIAL TIME”

if you put x=p/q then q/p=1/x

now HASHIM formula will be:

x+1/x-c=1 wich enable you to breack RSA in real time .

please if you ugnorent not say(nonsense)

regards

HASHIM KAREEM

IRAQ

[Wadim](http://texcel.yoll.net/page1.html) •
[September 13, 2006 6:28 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2292)

Yeh mann this is very good idea…

[Gold](http://gold.blog555.net) •
[September 26, 2006 8:16 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2293)

Andrew Wade wrote:

> The 2\*\*80 is a brute-force attack. Less than
>
> brute force means that it is “broken”, for the
>
> reason cjr gave. (“broken” and defeatable in —- ?????
>
> practice are two different things). The only
>
> exception to this convention I’m aware of is in
>
> public-key cryptography.
>
> AFAIK, all known public-key algorithms are
>
> vulnerable to less than brute-force attack. The
>
> key sizes are boosted to compensate, for lack
>
> of any alternative.

[Gold](http://gold.blog555.net) •
[September 26, 2006 8:18 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2294)

Andrew Wade wrote:

> The 2\*\*80 is a brute-force attack. Less than
>
> brute force means that it is “broken”, for the
>
> reason cjr gave. (“broken” and defeatable in —- ?????
>
> practice are two different things). The only
>
> exception to this convention I’m aware of is in
>
> public-key cryptography.
>
> AFAIK, all known public-key algorithms are
>
> vulnerable to less than brute-force attack. The
>
> key sizes are boosted to compensate, for lack
>
> of any alternative.

Ted •
[October 7, 2006 2:05 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2295)

This attack builds on previous attacks

hashim kareem •
[October 21, 2006 7:17 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2296)

breacking sha:x(all versions)are possible

since this hash function is base on extentions of the base key then its breakable in less time complexty by using

hashim algorithm :which is a new generalize search algorithm simalar to likelihoood algorithm but it work in multy points :

see yahoo groups:cryptology

tarst •
[December 6, 2006 12:54 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2297)

Related Pages in AI Topics: General Index by Topic to AI in the news … World chess champion Vladimir Kramnik defends tenaciously to draw computer Deep …

ahnold •
[January 23, 2007 10:59 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2298)

Any word on how SSHA (salted SHA-1) might be affected by this?

Pete •
[January 29, 2007 11:40 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2299)

If anyone is worried about a possible collision then why not just combine 2 hashes, such as

sha1(“the data”) . md5(“the data”)

The data would have to be very special to produce colliding hashes from 2 different hashing functions at the same time.

or sha1 the data and combine it with the sha1 of the data reversed.

sha1(“the data”) . sha1(“atad eht”)

Pete

Sangreal •
[March 10, 2007 5:10 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2300)

SHA-1 2**69

SHA-0 2**39

Nice what difference the little Shift makes.

Maybe SHA can be make more secure again through

chances at one or more of the logical unit(s) in the

formula.

nemesisgeek •
[June 18, 2007 9:19 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2303)

In my security software (still in development) I verify the integrity of some Windows API files using a triple hash: md5, sha1, and sha512. The difficulty of creating a valid Windows API DLL which does the same thing as the original, plus some malicious tasks – and has the same hashes in all three methods – is almost certainly well beyond the capability of computers for the next few decades.

For that matter, any software using hashes can be broken by a file-system attack which redirects the check of the hacked file to an unhacked copy.

Saam Choy •
[September 9, 2007 8:50 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2304)

To the comment about salted SHA hashes (SSHA) you should note that a cracker has been released for this, SSHA Attack. It was written by the team at neurofuzz and works well even though the larger sizes do force a time consuming process. It works nevertheless and is worth a look. It is on SF at <https://sourceforge.net/projects/ssha-attack>

[linux0wner](http://www.sha1-lookup.com) •
[August 28, 2008 4:15 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2308)

Maybe you are interested in a sha-1 reverse search (~ 12.000.000 hashes saved)? <http://www.sha1-lookup.com>

Anonymous •
[May 24, 2009 1:54 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2316)

Collision Attack: Now SHA-1 is broken by 2^52.

“Attacks always get better”.

Mike S •
[January 6, 2010 8:09 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2318)

@Joshua Stephanoff

This looks really good to me too, using SHA-1 and MD5:

d1= hash1(message);

d2= hash2(message);

d3= hash1((d1+message)+d2);

Did you ever come up with anything you liked more?

Mike

FrankB •
[January 12, 2010 12:55 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2319)

I liked Joshua Stephanoff’s method too (including that it included some nuts and bolts experience), and I was disappointed that no-one commented on it.

An easy compromise is downloading the fciv.exe freebie from Microsoft.com and running it with the “-both” option (i.e. both SHA-1 and MD5) to create a .xml that fciv can use to verify. Even though you don’t get the super-dooper advance that Stephanoff proposed by hashing hashes, using MD5 plus SHA-1 probably means we’re good for quite a few more years yet. (Could a crypto expert please comment on how robust a combined approach is.)

MS being MS, they haven’t provided the source, but, by virtue of allowing an .xml db, perhaps they have just created the next open source de facto standard? It’s nowhere near as sexy as Stephanoff’s suggestion, but it’s available to every DOS-savvy MS user today, and it allows an easy transition from existing MD5 or SHA-1 tables.

FrankB •
[January 12, 2010 1:08 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2320)

In the previous post I said “DOS-savvy”. But the only required smarts are starting a CMD DOS-box (click Start, type in CMD, hit Enter), typing

set path=c:\fciv;%path%

and then typing

fciv -?

Deciphering the unix-style help would be a tad difficult for your average Windows user, but then “Windows security” is an oxymoron.

[Alastair](http://www.schneier.com/blog/archives/2005/02/sha1_broken.html?&) •
[September 15, 2011 3:56 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2328)

This really is the content I desired. Many thanks for writing this post.

Gretchen •
[July 5, 2012 9:30 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2330)

I have been a victim of hashing. I would like someone who can help me contact me via mail.

Vappywera •
[August 11, 2012 6:09 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2331)

For that matter, you might want to keep on with contend with. 8-10. Invariably you should end up being reminded of trucks. One could make the connection fee. But will also, person will be able to maintain match sites really have to clear? You intend to pass up the room as well as objective. Save you the notepad style, conform use of Bell Labs that definitely have back once again dilemmas, The kitchen area governmental, Groom controlling.. the particular sort while using the true home wine groupie, a increase location or maybe a twin entrance doors along with a internet business wine fridge. The e-commerce enterprise ahead of rivalry. [refrigerator parts frigidaire door shelf](www.electroluxrefrigeratorparts.com)  likelihood of fraudulence. A added bonus is is offered. Catering companies ordinarily have for real will be an assessment without getting also formidable. Once combined with the incompatible tendencies, get will become the vast majority of subtle to remove coarsely. : Diminishing, consequence, smashup and / or identical probable – Obstruction or even the type is properly manned pay a visit to the particular Aol or simply whatever

aakarsha •
[October 27, 2012 2:53 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2332)

Can anybody tell me if only first 40 bits of SHA-1 is applied to the msg m then how can we find a colliding pairs??

I have cum to know that this is possible to find colliding pairs for this reduced SHA1

RAVI •
[December 7, 2012 11:37 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2333)

hai sir iam new to hash attacks plz give guidance how to find collision.

Brian Beuning •
[February 28, 2017 9:14 AM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2334)

Amazon sells bitcoin mining machines that do 10 TH/s (tera-hash) or 2^43 hash per second.

Bitcoin uses SHA-2 instead of SHA-1, but this shows you the speed dedicated hardware can do hashing.

Gol D Roger •
[May 25, 2020 7:35 PM](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/#comment-2336)

I made it here. And i will lead this passage to the very end.”GOL D ROGER”

[![Atom Feed](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png)
Subscribe to comments on this entry](https://www.schneier.com/blog/archives/2005/02/sha1_broken.html/feed/)

## Leave a comment [Cancel reply](/blog/archives/2005/02/sha1_broken.html#respond)

All comments are now being held for moderation. For details, see [this blog post](https://www.schneier.com/blog/archives/2024/06/new-blog-moderation-policy.html).

[Login](https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2005%2F02%2Fsha1_broken.html "Login")

Name

Email

URL:

 Remember personal info?

Fill in the blank: the name of this blog is Schneier on \_\_\_\_\_\_\_\_\_\_\_ (required):

Comments:

![](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif)

**Allowed HTML**
<a href="URL"> • <em> <cite> <i> • <strong> <b> • <sub> <sup> • <ul> <ol> <li> • <blockquote> <pre>
**Markdown Extra** syntax via <https://michelf.ca/projects/php-markdown/extra/>

Δ

[← RSA Conference](https://www.schneier.com/blog/archives/2005/02/rsa_conference.html) [Unicode URL Hack →](https://www.schneier.com/blog/archives/2005/02/unicode_url_hac_1.html)

Sidebar photo of Bruce Schneier by Joe MacInnis.

[Powered by WordPress](https://wordpress.com/wp/?partner_domain=www.schneier.com&utm_source=Automattic&utm_medium=colophon&utm_campaign=Concierge%20Referral&utm_term=www.schneier.com) [Hosted by Pressable](https://pressable.com/?utm_source=Automattic&utm_medium=rpc&utm_campaign=Concierge%20Referral&utm_term=concierge)

### About Bruce Schneier

![](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg)

I am a [public-interest technologist](https://public-interest-tech.com/), working at the intersection of security, technology, and people. I've been writing about security issues on my [blog](/) since 2004, and in my monthly [newsletter](/crypto-gram/) since 1998. I'm a fellow and lecturer at Harvard's [Kennedy School](https://www.hks.harvard.edu/faculty/bruce-schneier), a board member of [EFF](https://www.eff.org/), and the Chief of Security Architecture at [Inrupt, Inc.](https://inrupt.com/) This personal website expresses the opinions of none of those organizations.

### Related Entries

* [New Advances in the Understanding of Prime Numbers](https://www.schneier.com/blog/archives/2024/12/new-advances-in-the-understanding-of-prime-numbers.html)
* [Good Essay on the History of Bad Password Policies](https://www.schneier.com/blog/archives/2024/11/good-essay-on-the-history-of-bad-password-policies.html)
* [Simson Garfinkel on Spooky Cryptographic Action at a Distance](https://www.schneier.com/blog/archives/2024/10/simson-garfinkel-on-spooky-cryptographic-action-at-a-distance.html)
* [Watermark for LLM-Generated Text](https://www.schneier.com/blog/archives/2024/10/watermark-for-llm-generated-text.html)
* [Microsoft Is Adding New Cryptography Algorithms](https://www.schneier.com/blog/archives/2024/09/microsoft-is-adding-new-cryptography-algorithms.html)
* [List of Old NSA Training Videos](https://www.schneier.com/blog/archives/2024/09/list-of-old-nsa-training-videos.html)
### Featured Essays

* [The Value of Encryption](https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html)
* [Data Is a Toxic Asset, So Why Not Throw It Out?](https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html)
* [How the NSA Threatens National Security](https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html)
* [Terrorists May Use Google Earth, But Fear Is No Reason to Ban It](https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html)
* [In Praise of Security Theater](https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html)
* [Refuse to be Terrorized](https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html)
* [The Eternal Value of Privacy](https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html)
* [Terrorists Don't Do Movie Plots](https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html)

[More Essays](https://www.schneier.com/essays/)

### Blog Archives

* [Archive by Month](https://www.schneier.com/blog/calendar.html/)
* [100 Latest Comments](https://www.schneier.com/blog/newcomments.html/)

#### Blog Tags

* [3d printers](https://www.schneier.com/tag/3d-printers/)
* [9/11](https://www.schneier.com/tag/9-11/)
* [A Hacker's Mind](https://www.schneier.com/tag/a-hackers-mind/)
* [Aaron Swartz](https://www.schneier.com/tag/aaron-swartz/)
* [academic](https://www.schneier.com/tag/academic/)
* [academic papers](https://www.schneier.com/tag/academic-papers/)
* [accountability](https://www.schneier.com/tag/accountability/)
* [ACLU](https://www.schneier.com/tag/aclu/)
* [activism](https://www.schneier.com/tag/activism/)
* [Adobe](https://www.schneier.com/tag/adobe/)
* [advanced persistent threats](https://www.schneier.com/tag/advanced-persistent-threats/)
* [adware](https://www.schneier.com/tag/adware/)
* [AES](https://www.schneier.com/tag/aes/)
* [Afghanistan](https://www.schneier.com/tag/afghanistan/)
* [AI](https://www.schneier.com/tag/ai/)
* [air marshals](https://www.schneier.com/tag/air-marshals/)
* [air travel](https://www.schneier.com/tag/air-travel/)
* [airgaps](https://www.schneier.com/tag/airgaps/)
* [al Qaeda](https://www.schneier.com/tag/al-qaeda/)
* [alarms](https://www.schneier.com/tag/alarms/)
* [algorithms](https://www.schneier.com/tag/algorithms/)
* [alibis](https://www.schneier.com/tag/alibis/)
* [Amazon](https://www.schneier.com/tag/amazon/)
* [Android](https://www.schneier.com/tag/android/)
* [anonymity](https://www.schneier.com/tag/anonymity/)
* [Anonymous](https://www.schneier.com/tag/anonymous/)
* [antivirus](https://www.schneier.com/tag/antivirus/)
* [Apache](https://www.schneier.com/tag/apache/)
* [Apple](https://www.schneier.com/tag/apple/)
* [Applied Cryptography](https://www.schneier.com/tag/applied-cryptography/)

[More Tags](https://www.schneier.com/blog/tags.html/)

### Latest Book

[![A Hacker's Mind](https://149400697.v2.pressablecdn.com/wp-content/uploads/2022/10/book-mind-200w.jpg)](https://www.schneier.com/books/a-hackers-mind/)

[More Books](https://www.schneier.com/books/)

[![Support Bloggers' Rights!](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png "Support Bloggers' Rights!")](https://www.eff.org/issues/bloggers/legal/join)
[![Defend Privacy--Support Epic](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png "Defend Privacy--Support Epic")](https://epic.org/donate-to-epic/)

* [Blog](https://www.schneier.com)
* [Newsletter](https://www.schneier.com/crypto-gram/)
* [Books](https://www.schneier.com/books/)
* [Essays](https://www.schneier.com/essays/)
* [News](https://www.schneier.com/news/)
* [Talks](https://www.schneier.com/talks/)
* [Academic](https://www.schneier.com/academic/)
* [About Me](https://www.schneier.com/blog/about/)



=== Content from www.schneier.com_ade98e16_20250125_220450.html ===

# [Schneier on Security](https://www.schneier.com/)

Menu

* [Blog](https://www.schneier.com)
* [Newsletter](https://www.schneier.com/crypto-gram/)
* [Books](https://www.schneier.com/books/)
* [Essays](https://www.schneier.com/essays/)
* [News](https://www.schneier.com/news/)
* [Talks](https://www.schneier.com/talks/)
* [Academic](https://www.schneier.com/academic/)
* [About Me](https://www.schneier.com/blog/about/)

### Search

*Powered by [DuckDuckGo](https://duckduckgo.com/)*

Blog

Essays

Whole site

### Subscribe

[![Atom](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png)](https://www.schneier.com/feed/atom/)[![Facebook](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png)](https://www.facebook.com/bruce.schneier)[![Twitter](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png)](https://twitter.com/schneierblog)[![Email](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png)](https://www.schneier.com/crypto-gram)

[Home](https://www.schneier.com)[Blog](https://www.schneier.com/blog/archives/)

## New Cryptanalytic Results Against SHA-1

Xiaoyun Wang, one of the team of Chinese cryptographers that successfully [broke](https://www.schneier.com/blog/archives/2005/02/cryptanalysis_o.html) SHA-0 and SHA-1, along with Andrew Yao and Frances Yao, announced new results against SHA-1 yesterday at [Crypto’s](http://www.iacr.org/conferences/crypto2005/) rump session. (Actually, Adi Shamir announced the results in their name, since she and her student [did not receive](https://www.schneier.com/blog/archives/2005/08/chinese_cryptog.html) U.S. visas in time to attend the conference.)

Shamir presented few details—and there’s no paper—but the time complexity of the new attack is 263. (Their [previous result](https://www.schneier.com/blog/archives/2005/02/cryptanalysis_o.html) was 269; brute force is 280.) He did say that he expected Wang and her students to improve this result over the next few months. The modifications to their published attack are still new, and more improvements are likely over the next several months. There is no reason to believe that 263 is anything like a lower limit.

But an attack that’s faster than 264 is a significant milestone. We’ve already done massive computations with complexity 264. Now that the SHA-1 collision search is squarely in the realm of feasibility, some research group will try to implement it. Writing working software will both uncover hidden problems with the attack, and illuminate hidden improvements. And while a paper describing an attack against SHA-1 is damaging, software that produces actual collisions is even more so.

The story of SHA-1 is not over. Again, I repeat the saying I’ve heard comes from inside the NSA: “Attacks always get better; they never get worse.”

Meanwhile, NIST is holding a workshop in late October to discuss what the security community should do now. The [NIST Hash Function Workshop](http://www.csrc.nist.gov/pki/HashWorkshop/index.html) should be interesting, indeed. (Here is one [paper](http://www.educatedguesswork.org/movabletype/archives/2005/07/deploying_a_new.html) that examines the effect of these attacks on S/MIME, TLS, and IPsec.)

EDITED TO ADD: Here are Xiaoyun Wang’s two papers from Crypto this week: “[Efficient Collision Search Attacks on SHA-0](http://202.194.5.130/admin/infosec/download.php?id=1)” and “[Finding Collisions in the Full SHA-1Collision Search Attacks on SHA1](http://202.194.5.130/admin/infosec/download.php?id=2).” And [here](http://www.infosec.sdu.edu.cn/people/wangxiaoyun.htm) are the rest of her papers.

Tags: [academic papers](https://www.schneier.com/tag/academic-papers/), [cryptanalysis](https://www.schneier.com/tag/cryptanalysis/), [cryptography](https://www.schneier.com/tag/cryptography/), [hashes](https://www.schneier.com/tag/hashes/), [SHA-1](https://www.schneier.com/tag/sha-1/)

[Posted on August 17, 2005 at 2:06 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html) •
[66 Comments](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html#comments)

### Comments

[clvrmnky](http://www.clevermonkey.org/) •
[August 17, 2005 2:49 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11821)

I’m a bit confused. If there is *still* no paper, and all we have to go on is (albiet rather weighty) opinion and a few announcements, how do we know how accurate this news is?

What if the math is wrong? Is Shamir’s opinion enough to count as reasonable peer review? I’m certainly in no position to dispute Schneier or Shamir on this, but if there is anything I’ve learned from reading about crypto it’s to maintain a skeptical eye. How many people have actually got a chance to challenge these results?

While I’m glad NIST is working on making better controlled substances, er, hashing standards, I’m a little cloudy on how accurate this particular dire news is.

[Bruce Schneier](http://www.schneier.com/blog) •
[August 17, 2005 3:08 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11822)

I’m not sure what you mean by “*still* no paper.” The paper on SHA-i and SHA-0 that were presented at Crypto are in the proceedings. This new result is way too new for a paper, but I’m sure one is forthcoming.

greg •
[August 17, 2005 4:16 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11823)

Ok, well lets assume that this attack works. as far as i care anything less than 2^64 is really a total brake. But…

So is this the attack? find any X,Y where X != Y such that H(X)=H(Y).

Or (more damaging). Givin H(X) find Y such that H(X)=H(Y)?

If its the latter –we have a problem or two. but still a lot a ppl use sha256 (well i do). But i understood that sha1 and sha256 are very similar. Will this attack lead to attacks on sha256?.

I’m thinking of using hashes based on (constructed from) symetric block ciphpers… Since we seem to be better at designing them.

One thing is for sure. We need better hashes.

greg

x •
[August 17, 2005 4:51 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11824)

Deny visas to cryptographers, but give them to terrorists. I get it.

[Bruce Schneier](http://www.schneier.com/blog) •
[August 17, 2005 5:00 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11825)

These new results have not been peer reviewed at all. Shamir presented them at the rump session, but he only received the presentation the previous day — and there are very few details.

The two papers presented at Crypto — the attack against SHA-0 2^69 result against SHA-1 — have been public for months. They have been peer reviewed.

Wang is a respected cryptographer; I trust her enough to accept her claims. And a paper will be forthcoming, of course.

Graham Hughes •
[August 17, 2005 8:24 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11826)

Greg, the fact that Bruce is talking about 2^80 being brute force implies this is your first problem (that is, find X, Y so that X != Y & SHA-1(X) = SHA-1(Y)).

clvrmnky •
[August 17, 2005 10:36 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11827)

I meant this: <http://www.schneier.com/blog/archives/2005/02/sha1_broken.html>

This is the second time I’ve seen you comment on SHA-x being proven weak by the same people, and each time it is made clear that there was no peer-reviewed paper [at the time of writing.]

You did go out of your way to state “Shamir presented few details — and there’s no paper…” It sounds like a caveat of some sort to me. I’ve made it a habit of “wait and see” until all the math is peer-reviewed and results well accepted.

That’s all. I see you have a link to the original research that was presented. Since I pretty much get all my crypto news from here, and rarely follow-up on the research, I may have been under the mistaken assumption that the original research was still not peer-reviewed.

[Bruce Schneier](http://www.schneier.com/blog) •
[August 17, 2005 11:05 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11828)

What’s going on is that we’re seeing the results before we see the papers. This is not unusual, although there was a long time between when we learned about the first SHA-1 results and when we saw the paper I linked to above.

While I agree that any result needs to be peer-reviewed before it is believed, Wang has a good reputation and I am predisposed to take her word at face value.

Rump •
[August 17, 2005 11:12 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11829)

It might help to explain what a rump session is, for those that don’t know.

Generally, rump sessions are open to anyone who signs up during the conference to give a 5 minute talk about “something on his mind”: the latest results, an interesting discussion they had in the corridors today, etc.

Rump sessions are great for hearing the bleeding edge stuff.

jammit •
[August 18, 2005 12:26 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11830)

I view this as more of a ‘breaking news’ sort of thing and not an ‘old hat’. The breaking of the hash is something new, and not enough information has been compiled/sorted yet to make any reasonable paper (with only minor spelling errors). Right now it seems that the attack is just starting to show promise, and so far it looks pretty neat. Just in case this works really well, what are everybody’s plans for developing a new unbreakable crypto?

krypto •
[August 18, 2005 12:59 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11831)

@Graham,

$ echo X | sha1sum

b5fec669aca110f1505934b1b08ce2351072d16b

$ echo Y | sha1sum

c881daf1af41bc5aa1e14da108fe062784470ccb

clearly, SHA-1(X) != SHA-1(Y).

Steve •
[August 18, 2005 4:44 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11832)

@krypto:

Don’t you mean “echo -n”?

Clive Robinson •
[August 18, 2005 5:41 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11833)

@greg

“I’m thinking of using hashes based on (constructed from) symetric block ciphpers… Since we seem to be better at designing them.”

Be careful which block ciphers you pick, some make very bad hashs, and in one case the implementation has been publicaly broken and proved embarising for the implementer (TEA / X-Box / Microsoft).

But I agree with your point we most definatly need better Hashes, but we need the research to get them 😉

Thomas Sprinkmeier •
[August 18, 2005 5:44 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11834)

@Steve

Thank you for demonstrating the importance of peer-review.

Dave •
[August 18, 2005 7:40 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11835)

@Greg

I think we already have ‘better hashes’ in the form of Tiger and Whirlpool. Then again, if you want to steer clear of MD5 and the entire SHA family, Tiger and Whirlpool are pretty much the only decent (i.e. unbroken, so far) alternatives.

[Spammy McGriddle](http://www.amazon.com/exec/obidos/redirect?link_code=ur2&camp=1789&tag=travelfun-20&creative=9325&path=tg/detail/-/0670033847/ref=pd_sim_b_1?%5Fencoding=UTF8%26v=glance) •
[August 18, 2005 7:52 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11836)

In practical terms, until there is automated software to crunch the numbers at will, SHA is secure for the average Joe. Big business and governments who have other big businesses and governments as adversaries need to begin evaluating alternatives.

clvrmnky •
[August 18, 2005 9:14 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11837)

Thanks. I’m less stupid today.

[Ed T.](http://www.etee2k.net) •
[August 18, 2005 12:25 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11838)

@clvrmnky, krypto,

Well, I certainly don’t feel less stupid today. What are you (krypto) trying to demonstrate by the commands you posted? This one is over my head…

Chris W •
[August 18, 2005 5:53 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11839)

What are the odds that two texts will result in the same MD5 hash and the same SHA-1 hash without being identical texts? You could just mingle the two (one character from one, one from the other) and call that a new hash. And at only twice the computing power!

[Bruce Schneier](http://www.schneier.com/blog) •
[August 18, 2005 6:35 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11840)

MD5 is a 128-bit hash; the odds of two texts having identical MD5 hashes are 1 in 2^64. SHA-1 is a 160-bit hash; the odds of two texts having identical SHA-1 hashes are one in 2^80. Assuming the two hash functions are independent — a reasonable assumption — then the odds of two texts having identical MD5 and SHA-1 hashes are 1 in 2^144.

The universe will either collapse on itself or the galaxies will drift apart into nothingness before you find such a pair of texts.

SM •
[August 18, 2005 6:58 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11841)

@Ed T

It was just a little joke. What krypto did was get the sha1sum for the letters X and Y (as opposed to two “items” X and Y…numbers, strings, etc.). Since they’re different values, SHA-1(X) != SHA-1(Y).

Dscho •
[August 18, 2005 7:37 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11842)

@ Bruce:

2^144 sounds impressive. But if the attack is enhanced to find *all* Y for a given X such that SHA1(X)=SHA1(Y), and an equivalent attack is found for MD5, then 2^144 is no longer safe (because the effective search space is much, much smaller).

jsnow •
[August 18, 2005 8:07 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11843)

Maybe I’m missing something obvious here, but it seems that the odds of any two arbitrarily chosen texts having the same md5sum would be 1 in 2^128, or of having the same sha1 would be 1 in 2^160.

On the other hand (if I understand the birthday paradox correctly), if you were to chose 2^64 arbitrary texts you would have on average one md5sum collision somewhere amongst those 2^64 texts, and if you chose 2^80 arbitrary texts, you would have on average one sha1 collision (which is what I think you were trying to say, but maybe I’m confused).

Curious •
[August 18, 2005 8:50 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11844)

Would it be silly of me to use either the hash127 or UMAC schemes for authenticating cookies passed back and forth between server and browser? Are these considered ‘safe’?

[Bruce Schneier](http://www.schneier.com/blog) •
[August 18, 2005 9:07 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11845)

@ jsnow

No, you don’t understand the birthday paradox correctly. The odds of one text having any particular hash is 2^n. The odds of two texts having the same hash is 2^(n/2), where n is the block length.

Rob •
[August 18, 2005 9:13 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11846)

Just wondering, but FIPS186-2 specifies the use of SHA-1 to post process random numbers. At what point does SHA-1 become ineffective for this purpose?

Bruno •
[August 18, 2005 9:21 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11847)

Are you sure about that?

Isn’t 2^(n/2) the approximate number of texts

where the odds of any two in the set having

matching hashes is1/2?

This isn’t the same thing as the odds of two

random texts having the same hash.

Kramer •
[August 18, 2005 9:30 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11848)

Oh, isn’t the best way to hash by doing a

substr(XOR(mystring),32)

That would give you a 32 byte hash, right!? Isn’t that secure enough!

Jeff Jancula •
[August 18, 2005 10:05 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11849)

Bruce,

I don’t believe you understand the birthday attack (and paradox) correctly. If one input (X) produces a hash H(X), the odds that any next input (Y) will also produce H(X) is equal to 1 in 2^n, where n is the hash length.

JSnow and Bruno have it right: The birthday paradox/attack says that you need 2^(n/2) inputs to find a case where the two hashes are equal.

So, in the case of MD5 (n=128 bits). The odds that any two inputs will have the same hash = 1 in 2^128. However, the odds that 2^64 inputs will result in at least one duplicate hash are almost certain.

Jeff Jancula •
[August 18, 2005 10:41 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11850)

Follow-up on the birthday paradox:

The birthday paradox comes from the scenario that two randomly chosen people in a classroom of 30 students will have the same birthday (excluding year) is almost certain.

Bruce, the way you’re stating the birthday paradox is that if you choose the first student in the class, the odds that one of the remaining 29 will have the same birthday as the first are almost certain – which is false.

[Bruce Schneier](http://www.schneier.com/blog) •
[August 18, 2005 10:54 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11851)

You’re right; I’m mis-stating the birthday paradox.

Sorry; I just got back from Crypto and I’m tired.

[Dan Kaminsky](http://www.doxpara.com) •
[August 18, 2005 11:45 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11852)

Bruce,

Can you identify a 2^64 work effort task that’s been completed? Remember, MD5 is thrashable without the Wang result if 2^64 is doable.

What’s the mechanism for making a birthday paradox attack not require as much storage as it requires computation? Creating a 2^m store, with m<n and 2^m feasible, and recomputing hashes that fall within that range?

–Dan

Edward J. Huff •
[August 19, 2005 4:10 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11853)

Proposed revision of software signing protocols to allow for hash collisions.

Google for a25f7f0b29ee0b3968c860738533a4b9 OR a25f7f0b, an example of how to exploit a hash collision.

To avoid this exploit, the signer needs to make an unpredictable modification to the document prior to signing.

Alice and Bob use hash function H and signature function F to validate documents. Alice signs a message M by finding signature S such that F(S) = H(M). Bob accepts (M,S) as signed by Alice. Eve can calculate H(M) and F(S) but cannot find S given M.

Eve creates documents M1 and M2 which have the same hash, and asks Alice to sign M1. If Alice uses the expected hash, Eve can substitute M2 and Bob will accept (M2,S) as signed by Alice.

So Alice and Bob need to agree to a safer method. When Eve presents M1 for signature, Alice generates a new random key K, encrypts M1 with K and hashes, giving H(K(M1)). She then signs this by finding S such that F(S) = (K,H(K(M1))), and gives (S,K) to Eve.

Eve sends (M2,S,K) to Bob. Bob checks the signature by calculating F(S) and comparing it to (K,H(K(M2))).

Eve is foiled, because H(K(M1)) != H(K(M2)), even though H(M1) = H(M2).

Thus, immediately, the protocols for signing software distributions should be adjusted so that the signing authority Alice generates random key K and signs H(K(M)) instead of just H(M). The automatic software update agent Bob checks the signature (S,K) by calculating F(S) and (K,H(K(M))).

This will prevent substitution of a useful M2 for M1 by Eve, who is allowed to present an arbitrary M1 for testing and signature. Eve cannot predict K, and hence even if she can find M2 after the fact, such that H(K(M1)) = H(K(M2)), she is not allowed to change M1 after K is chosen. Hence M2 will not be useful.

Bob can safely install M1 automatically, confident that if M1 passes a simple syntax check (which M2 cannot possibly satisfy), it is the same program which Alice accepted for signature, even if hash collisions can be found.

Ulrich •
[August 19, 2005 6:53 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11854)

With a complexitiy of 2^{63}, SHA-1 is (currently!) about as secure as MD5 should have been…

Brian •
[August 19, 2005 7:42 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11855)

@ Dscho

There are [most likely] an infinite number of Y’s such that SHA1(X) = SHA1(Y), so it wouldn’t be possible to find all Y’s for a given X. But your point is still valid — if you have a way to find Y’s which is better than 2^80 then you should be able to find a Y such that X & Y have identical SHA1 and MD5 hashes in better than 2^144. If this new attack is 2^64, then finding SHA1 and MD5 should be 2^128.

Daniel K. •
[August 19, 2005 7:56 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11856)

I agree with Chris W – in fact I was just discussing such a scheme with my colleagues earlier this week. By using two (relatively complex) hash functions with completely different algorithms (eg md5 and sha-1), the odds of two different texts producing the same hash in each algorithm must surely pale into insignificance as any weaknesses found in one are unlikely to exist in the other.

Now my question is: There is very little new under the sun and it is unlikely that Chris W. and I are the first two people to think of it. Does prior art exist in this area?

Put another way, if one wanted to find two algorithms that were sufficiently different to make the odds of the above described collision no greater than one with key length equal to the sum of each, which would you choose? Would the calculation of each of those algorithms be faster than the calculation of a similar hash function of the longer key length?

I’m sorry for the hand-waving, I’m sure someone would be able to formalise such a concept much better than I…

Dscho •
[August 19, 2005 8:31 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11857)

@Brian

Sorry, I meant “all Y of a certain length”.

And I still do not follow the reasoning of the complexity of SHA1 mixed with MD5 being the product of the single complexities.

It should be possible to filter the search space for one hash by finding (partial) matches for the other first, i.e. if there is an efficient technique to look for messages Y which (partially) match the SHA1 of X, then you certainly do not have to start all over again for MD5.

Remy •
[August 19, 2005 8:57 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11858)

@Daniel K:

“any weaknesses found in one are unlikely to exist in the other”

This is a very bad assumption, as both digest algorithms are based on MD4. There may be structural weaknesses that could be exploited.

DarkFire •
[August 19, 2005 9:59 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11859)

Ladies & gents, please forgive my relative ignorance in this particular subject, but what (in laymans terms) is the definition of the “complexity” of a hash function?

And what, for that matter, is a hash function?

Cheers, DF.

dowhat.. •
[August 19, 2005 10:11 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11860)

How do you stop a DTS?

Remy •
[August 19, 2005 10:50 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11861)

@DarkFire

Google and wikipedia are your friends:

<http://en.wikipedia.org/wiki/Computational_complexity_theory>

<http://en.wikipedia.org/wiki/Hash_function>

Also, in this case, we are concerned with the time complexity of an algorithm breaking the hash, not the execution performance of the actual digest function.

JohnE •
[August 19, 2005 11:48 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11862)

If I understand the SHA-1 weakness correctly, it is now within the realm of possibility (practicality) to find synonyms, and possibly use that as a means to spoof a signature. But is SHA-1 now reversible? Is it still strong enough to use as an anonymizer? For example, a 20 byte identifier would hash down to 16 bytes under SHA-1, so would be irreversible because information has been lost, right?

Ricardo Barreira •
[August 19, 2005 12:33 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11863)

To JohnE:

Not necessarily, since it is possible that you know some restrictions to the 20 bytes identifier which would make it unique on the context you mentioned. An example known restriction would be – all the bytes are printable ASCII characters.

Ricardo Barreira •
[August 19, 2005 12:34 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11864)

To JohnE again:

BTW, you’re misunderstanding this attack. This is not a pre-image attack, this is a collision attack (I think those are the correct names). With google you can find information about those two classes of attacks on hash functions.

JohnE •
[August 19, 2005 12:43 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11865)

Thanks, Ricardo, for your comments. I think your point about knowledge of the original key says that information may not have been lost, so that it’s theoretically possible to reverse the hash. But it still leaves open the question: is SHA-1 a good choice for anonymizing?

averros •
[August 19, 2005 8:45 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11866)

> Deny visas to cryptographers, but give
>
> them to terrorists. I get it.

Terrorists are performing a useful service to the government – their actions provide a justification for the governments to expand their powers and increase confiscation of wealth of citizens.

Cryptographers, on the other hand, work on making citizens more immune from government snooping and, potentially, able to hide all or some wealth from the eye of taxmen.

So it is entirely reasonable that the government would want to let terrorists in while keeping cryptographers out.

clvrmnky •
[August 20, 2005 11:03 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11867)

averros,

While I think your comments were entered in a spirit of fun (or gallows humour) they can also be seen as an extreme example of “agenda” as mention in Schneier’s later entry: <http://www.schneier.com/blog/archives/2005/08/airline_securit_2.html>

That is, it occurs to me that government security people have a somewhat different agenda than citizens around the use and dissemination of crypto.

SumDude •
[August 21, 2005 4:45 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11868)

JohnE: SHA-1 should still suffice as an “anonimizer”, though, if you can help it, it’s best to simply use a random-numbered token, and remember the association between identity and token server-side. With a one-way hash you still need to hang on to the original identity in order to be able to hash one value to check it (you don’t want to have to hash all userIDs to check just one cookie!), so it doesn’t add overhead. If at all possible, just stick to the bog standard session functionality provided by your application platform (by which I mean the likes of j2ee,.net,php, etc.).

Ricardo Barreira •
[August 22, 2005 11:28 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11869)

JohnE: Yep, on my first post I forgot to reply to that part, but check out the following post (also from me) 🙂

averros •
[August 22, 2005 10:41 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11870)

clvrmnky – I do indeed have an agenda, namely I have my political opinions which grew from my first-hand experience with dealing with governments in different countries, including communist. My experience says that people in Western democracies tend to underestimate the similarities between their governments and those of the communist countries – apparently because while they know intellectually that the communism is bad, they don’t know how it looks in practice (and, therefore, have no idea of what to fear).

So, no, this is not humour. Not at all. In fact, one of the lessons of living in a communist country is that a lot of well-meaning people can together create a monster, given the “right” kind of ethics. The US security apparatus is a good illustration – while I do not think there’s a lot of scoundrels working for the goverment, the collective behaviour of nice and helpful government employees (reflecting their belief into the moral permissibility of imposing their will on non-consenting people for “their own good”) creates exactly the kind of moronic self-destructive policies we observe.

The solution is not to try to educate the government, and not to take over it by some political process – because it merely replaces one set of well-meaning people with another, with no change in the ethics whatsoever – but to expose the idea of coercive collectivist power for the moral outrage it is, and disband the collective monstrosity – and, importantly, – refrain from building another one in its place, no matter how tempting it seems to have “our monster” to protect us.

The greatest danger to the personal security of US citizens comes from their own government, this is as simple as that. Never forget that the present terrorist problems are the direct result of previous actions of the government (such as financing and arming “our bastards”), and that our own collectivist retoric is exactly what allows pissed-off arabs to plausibly lump random civilians together with the US government into the category of legitimate targets.

Clive Robinson •
[August 24, 2005 12:19 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11871)

Folks,

The argument about the aplicability of the birthday paradox is unfortunatly a bit of a red herring, and actually probably does not apply in the practical case.

The reason for this is the assumption that two “random” texts have slightly better than 0.5 probability after 2^(n/2) trials.

The problam with this is that from a theoretical point of view “random” texts are fine, in the real world however they need to be “meaningful” texts. No matter what coding method you use, meaningfull texts have their own statistics, that are very far from random.

I actualy have experiance of the Birthday paradox failing woefully as a party trick (this is due to the skewed birth statistics due to spring 😉

Now I am not aware of anybody having looked into this in any depth so I do not know in which way the 0.5 probability will move but I am confident that it is going to be atleast a couple of bits or more different.

I suspect that for the “brute force” method things will be worse (for the attacker). However for the “crafted” aproach using weaknesses in the algorithum I have a “gut fealing” it is going to be better.

As I said it’s a gut fealing (which even on a good day are not very reliable), however in the absence of “reasond” evidence I will go with it as it errs on the side of caution.

chinarocks •
[August 24, 2005 1:11 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11872)

It is very simple, organize the next conference in China. The Chinese cryptographers will certainly be there. That’s where the action is anyway these days.

Duncan Simpson •
[August 27, 2005 7:03 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11873)

If I understood it corerctly the birthday paradox was about the probabiltiy of 2 *or more* people having the same birthday (the probability of exactly 2 people is a smaller). I will agree that for hash functions the odds are too small for practical use.

Just being able to find random text is good enough, as some researchers demonstrated with a pair of postscript documents (random text+two different printed documents depending on which random text was present). I think the hash involved was MD5 but the same “theory” would work for almost any hash function.

Jason •
[September 8, 2005 2:50 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11874)

OK, I tried to get Gnupg to use SHA256 instead of SHA1 but it complains that DSA requires a 160 bit hash. Is RIPEMD160 a good alternative ?

[Dan Kaminsky](http://www.doxpara.com) •
[September 8, 2005 7:42 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11875)

The problem with “meaninglessness” is that file format exist, and there’s always somewhere you can shove 64 bytes of random data. In two different documents, you can perturb in two different places, and if the birthday odds are too small eventually you’ll cause the documents to both possess the same hash and be fully readable.

Joey J •
[September 21, 2005 1:58 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11876)

As far as the birthday paradox is concerned, it seems like something is missing.

The birthday paradox only applies to the day and month only; it does not apply to the complete birthday. It seems to me we’re comparing the odds of an incomplete set of data (partial birthday) being duplicated versus the odds a complete set of data (full hash value) will be duplicated.

It seems like the Birthday Paradox would be more applicable if you were concerned with the odds of 2/3rds of a hash value being duplicated…

[Michael Richardson](http://www.sandelman.ca/mcr/blog) •
[January 22, 2007 1:35 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11877)

Bruce, the previous 2^69 result was “protected” before by the HMAC-construct,

is the 2^63 result also protected?

Second, is this a different 2^63 result,

or is the 2^69 + 6 more bits of weakness?

ahnold •
[January 23, 2007 11:10 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11878)

Any word on how SSHA (salted SHA-1) might be affected by this?

whmurray •
[January 23, 2007 4:52 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11879)

As a general rule, one should not take security advice from a cryptographer. As a general rule Schneier is the exception that proves the rule.

The cryptographer asks, “Is the attack feasible?” That is, could it be done with available or finite resources in available or finite time. The security person asks, “is the attack efficient?” Is the value of success greater than the cost of the attack?

In response, the cryptographer will craft an example in which the attack might be efficient and rests his case. The security person asks whether the attack is efficient in the average or general case?

Courtney’s first law tell us that “Nothing useful can be said about the security of a mechanism except in the context of a specific application and environment.”

Alex •
[June 3, 2007 1:44 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11880)

Hi,

I am new to cryptography. I know that birthday paradox means that finding two random messages that hash to a same result is surprisingly low (2^m/2), but I don’t know why that is important.

So let’s say someone (eve) finds two messages that hash to the same result. Why is that important, and how can she do malicious stuff knowing two messages that hash to the same value?

Thanks,

Alex

[Bruce Schneier](http://www.schneier.com/blog) •
[June 3, 2007 4:26 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11881)

@Alex

Let’s say I have two messages that hash to the same value: “Alex is a geat guy” and “Alex owes Bruce Schneier a million dollars.” I get you to sign the hash of the first, which is how digital signature algorithms work, and then take you to court because you refuse to acknowledge the second.

Jesse Viviano •
[September 21, 2007 10:30 PM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11882)

It looks like your prediction that some research group will write software to search for SHA-1 collisions has become true. It is a BOINC project called “SHA-1 Collision Search Graz”. Its URL is <http://boinc.iaik.tugraz.at/sha1_coll_search/>.

Sun •
[October 7, 2007 3:15 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11883)

Hi, I don’t know anything about cryptography, but I was just curious about bittorrent and its use of SHA1. Let’s say I have a 2MB torrent piece. How much CPU time would it take to generate another 2MB file (can be gibberish) with the same SHA1? Would it be feasible with a modern data center to produce a file with the same SHA1 within, say one week? I’m curious because RIAA wants to prevent pirating via bittorrent and poisoning the swarm with bad torrent pieces could be one method…

[mitesh](http://mitesh.webng.com) •
[July 11, 2008 1:20 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11886)

i think – we need the research to get better hashes

Rune K. Svendsen •
[August 21, 2011 11:49 AM](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/#comment-11887)

Regarding BitTorrent (two comments up from this one), this is actually why I became interested in cryptographic hash functions as well.

To answer your question; no, the attack presented here does not allow BitTorrent downloads to be compromised. The attack you describe (and what would compromise the way that current BitTorrent works) is what is called a “second pre-image attack”. The attack presented here is called a “collision attack”.

The difference between these two attacks is that a “collision attack” enables us to find *ANY two (different) blocks* of data that have the same hash value. In case of the “second pre-image” attack we have to find *one block* that has the same hash value as another *given* block. Ie., the difference between the two attacks is that in one case we can find *any two (different) data sets* which hash to the same value. In the second case we’re *given one of the data sets* (one of the blocks in a BitTorrent file) and we’re asked to find a second set of data that hashes to the same as the first (given) set of data.

[![Atom Feed](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png)
Subscribe to comments on this entry](https://www.schneier.com/blog/archives/2005/08/new_cryptanalyt.html/feed/)

## Leave a comment [Cancel reply](/blog/archives/2005/08/new_cryptanalyt.html#respond)

All comments are now being held for moderation. For details, see [this blog post](https://www.schneier.com/blog/archives/2024/06/new-blog-moderation-policy.html).

[Login](https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2005%2F08%2Fnew_cryptanalyt.html "Login")

Name

Email

URL:

 Remember personal info?

Fill in the blank: the name of this blog is Schneier on \_\_\_\_\_\_\_\_\_\_\_ (required):

Comments:

![](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif)

**Allowed HTML**
<a href="URL"> • <em> <cite> <i> • <strong> <b> • <sub> <sup> • <ul> <ol> <li> • <blockquote> <pre>
**Markdown Extra** syntax via <https://michelf.ca/projects/php-markdown/extra/>

Δ

[← Chinese Cryptographers Denied U.S. Visas](https://www.schneier.com/blog/archives/2005/08/chinese_cryptog.html) [Zotob and Variants →](https://www.schneier.com/blog/archives/2005/08/zotob_and_varia.html)

Sidebar photo of Bruce Schneier by Joe MacInnis.

[Powered by WordPress](https://wordpress.com/wp/?partner_domain=www.schneier.com&utm_source=Automattic&utm_medium=colophon&utm_campaign=Concierge%20Referral&utm_term=www.schneier.com) [Hosted by Pressable](https://pressable.com/?utm_source=Automattic&utm_medium=rpc&utm_campaign=Concierge%20Referral&utm_term=concierge)

### About Bruce Schneier

![](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg)

I am a [public-interest technologist](https://public-interest-tech.com/), working at the intersection of security, technology, and people. I've been writing about security issues on my [blog](/) since 2004, and in my monthly [newsletter](/crypto-gram/) since 1998. I'm a fellow and lecturer at Harvard's [Kennedy School](https://www.hks.harvard.edu/faculty/bruce-schneier), a board member of [EFF](https://www.eff.org/), and the Chief of Security Architecture at [Inrupt, Inc.](https://inrupt.com/) This personal website expresses the opinions of none of those organizations.

### Related Entries

* [Friday Squid Blogging: Cotton-and-Squid-Bone Sponge](https://www.schneier.com/blog/archives/2025/01/friday-squid-blogging-cotton-and-squid-bone-sponge.html)
* [Spyware Maker NSO Group Found Liable for Hacking WhatsApp](https://www.schneier.com/blog/archives/2024/12/spyware-maker-nso-group-found-liable-for-hacking-whatsapp.html)
* [New Advances in the Understanding of Prime Numbers](https://www.schneier.com/blog/archives/2024/12/new-advances-in-the-understanding-of-prime-numbers.html)
* [Friday Squid Blogging: Biology and Ecology of the Colossal Squid](https://www.schneier.com/blog/archives/2024/12/friday-squid-blogging-biology-and-ecology-of-the-colossal-squid.html)
* [Security Analysis of the MERGE Voting Protocol](https://www.schneier.com/blog/archives/2024/11/security-analysis-of-the-merge-voting-protocol.html)
* [The Scale of Geoblocking by Nation](https://www.schneier.com/blog/archives/2024/11/the-scale-of-geoblocking-by-nation.html)
### Featured Essays

* [The Value of Encryption](https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html)
* [Data Is a Toxic Asset, So Why Not Throw It Out?](https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html)
* [How the NSA Threatens National Security](https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html)
* [Terrorists May Use Google Earth, But Fear Is No Reason to Ban It](https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html)
* [In Praise of Security Theater](https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html)
* [Refuse to be Terrorized](https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html)
* [The Eternal Value of Privacy](https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html)
* [Terrorists Don't Do Movie Plots](https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html)

[More Essays](https://www.schneier.com/essays/)

### Blog Archives

* [Archive by Month](https://www.schneier.com/blog/calendar.html/)
* [100 Latest Comments](https://www.schneier.com/blog/newcomments.html/)

#### Blog Tags

* [3d printers](https://www.schneier.com/tag/3d-printers/)
* [9/11](https://www.schneier.com/tag/9-11/)
* [A Hacker's Mind](https://www.schneier.com/tag/a-hackers-mind/)
* [Aaron Swartz](https://www.schneier.com/tag/aaron-swartz/)
* [academic](https://www.schneier.com/tag/academic/)
* [academic papers](https://www.schneier.com/tag/academic-papers/)
* [accountability](https://www.schneier.com/tag/accountability/)
* [ACLU](https://www.schneier.com/tag/aclu/)
* [activism](https://www.schneier.com/tag/activism/)
* [Adobe](https://www.schneier.com/tag/adobe/)
* [advanced persistent threats](https://www.schneier.com/tag/advanced-persistent-threats/)
* [adware](https://www.schneier.com/tag/adware/)
* [AES](https://www.schneier.com/tag/aes/)
* [Afghanistan](https://www.schneier.com/tag/afghanistan/)
* [AI](https://www.schneier.com/tag/ai/)
* [air marshals](https://www.schneier.com/tag/air-marshals/)
* [air travel](https://www.schneier.com/tag/air-travel/)
* [airgaps](https://www.schneier.com/tag/airgaps/)
* [al Qaeda](https://www.schneier.com/tag/al-qaeda/)
* [alarms](https://www.schneier.com/tag/alarms/)
* [algorithms](https://www.schneier.com/tag/algorithms/)
* [alibis](https://www.schneier.com/tag/alibis/)
* [Amazon](https://www.schneier.com/tag/amazon/)
* [Android](https://www.schneier.com/tag/android/)
* [anonymity](https://www.schneier.com/tag/anonymity/)
* [Anonymous](https://www.schneier.com/tag/anonymous/)
* [antivirus](https://www.schneier.com/tag/antivirus/)
* [Apache](https://www.schneier.com/tag/apache/)
* [Apple](https://www.schneier.com/tag/apple/)
* [Applied Cryptography](https://www.schneier.com/tag/applied-cryptography/)

[More Tags](https://www.schneier.com/blog/tags.html/)

### Latest Book

[![A Hacker's Mind](https://149400697.v2.pressablecdn.com/wp-content/uploads/2022/10/book-mind-200w.jpg)](https://www.schneier.com/books/a-hackers-mind/)

[More Books](https://www.schneier.com/books/)

[![Support Bloggers' Rights!](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png "Support Bloggers' Rights!")](https://www.eff.org/issues/bloggers/legal/join)
[![Defend Privacy--Support Epic](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png "Defend Privacy--Support Epic")](https://epic.org/donate-to-epic/)

* [Blog](https://www.schneier.com)
* [Newsletter](https://www.schneier.com/crypto-gram/)
* [Books](https://www.schneier.com/books/)
* [Essays](https://www.schneier.com/essays/)
* [News](https://www.schneier.com/news/)
* [Talks](https://www.schneier.com/talks/)
* [Academic](https://www.schneier.com/academic/)
* [About Me](https://www.schneier.com/blog/about/)



=== Content from shattered.io_c1eb63d0_20250125_220440.html ===

![SHA-1 has shattered.](/static/logo.png)
[![SHAttered](/static/infographic-small.png)](/static/infographic.pdf)

We have broken SHA-1 in practice.

This industry cryptographic hash function standard is used for digital signatures and file
integrity verification, and protects a wide spectrum of digital assets, including credit card transactions, electronic documents, open-source software repositories and software updates.

It is now practically possible to craft two colliding PDF files and obtain a SHA-1 digital signature on the first PDF file which can also be abused as a valid signature on the second PDF file.

For example, by crafting the two colliding PDF files as two rental agreements with different rent, it is possible to trick someone to create a valid signature for a high-rent contract by having him or her sign a low-rent contract.

[Infographic](/static/infographic.pdf) | [Paper](/static/shattered.pdf)

### Attack proof

Here are two PDF files that display different content, yet have the same SHA-1 digest.

[![SHAttered](/static/shattered.png)](/static/infographic.pdf)

[PDF 1](/static/shattered-1.pdf) | [PDF 2](/static/shattered-2.pdf)

### File tester

Upload any file to test if they are part of a collision attack.
Rest assured that we do not store uploaded files.

Drag some files here

Or, if you prefer..

 Choose a file to upload

 Upload failed. Please upload files under 100 MB.
 Reset

---

## Q&A

### Isn't SHA-1 deprecated?

Today, many applications still rely on SHA-1, even though theoretical attacks have been known since 2005, and SHA-1
was officially deprecated by NIST in 2011.
We hope our practical attack on SHA-1 will increase awareness and convince the industry to quickly move to safer alteratives, such as SHA-256.

### How can I protect myself?

You can use our file tester above to check your files. If you use Chrome, you will be [automatically protected](https://security.googleblog.com/2016/11/sha-1-certificates-in-chrome.html) from insecure TLS/SSL certificates, and [Firefox](https://blog.mozilla.org/security/2016/10/18/phasing-out-sha-1-on-the-public-web/) has this feature planned for early 2017 has [quickly reacted](https://blog.mozilla.org/security/2017/02/23/the-end-of-sha-1-on-the-public-web/) to this announcement, and deprecated SHA-1 as of February 24th, 2017.

Files sent via Gmail or saved in Google Drive are already automatically tested against this attack.

### What types of systems are affected?

Any application that relies on SHA-1 for digital signatures, file integrity, or file identification is potentially vulnerable.
These include:

* Digital Certificate signatures
* Email PGP/GPG signatures
* Software vendor signatures
* Software updates
* ISO checksums
* Backup systems
* Deduplication systems
* GIT
* ...

### Are TLS/SSL certificates at risk?

Any Certification Authority abiding by the CA/Browser Forum regulations
is [not allowed](https://cabforum.org/2014/10/16/ballot-118-sha-1-sunset/) to issue SHA-1 certificates anymore. Furthermore, it is
required that certificate authorities insert at least 64 bits of
randomness inside the serial number field. If properly implemented this
helps preventing a practical exploitation.

### Will my browser show me a warning?

Starting from version 56, released in January 2017, Chrome [will consider](https://security.googleblog.com/2016/11/sha-1-certificates-in-chrome.html) any website protected with a SHA-1 certificate as insecure. [Firefox](https://blog.mozilla.org/security/2016/10/18/phasing-out-sha-1-on-the-public-web/) has this feature planned for early 2017 has deprecated SHA-1 as of February 24th, 2017.

### Is GIT affected?

GIT strongly relies on SHA-1 for the identification and integrity checking of all file objects and commits. It is essentially possible to create two GIT repositories with the same head commit hash and different contents, say a benign source code and a backdoored one. An attacker could potentially selectively serve either repository to targeted users. This will require attackers to compute their own collision.

### Is SVN affected?

SVN has been patched against the attack: versions [1.9.6](https://subversion.apache.org/docs/release-notes/1.9#shattered-sha1) and up are immune to it, as well as the 1.8.18 maintenance release.

Previous version are [affected](https://bugs.webkit.org/show_bug.cgi?id=168774#c23<Paste>) by the attack.
Subversion servers use SHA-1 for deduplication and repositories become corrupted when two colliding files are committed to the repository. This has been discovered in WebKit's Subversion repository and independently confirmed by us.
We noticed that in some cases, due to the corruption, further commits are blocked.

### How do I patch/upgrade my system?

Consider using safer alternatives, such as SHA-256, or SHA-3.

### How do I detect this attack?

You can use the online tool above to submit files and have them checked
for a cryptanalytic collision attack on SHA-1. The code behind this was
developed by Marc Stevens (CWI) and Dan Shumow (Microsoft) and is
publicly available on [GitHub](https://github.com/cr-marcstevens/sha1collisiondetection%20).

It is based on the concept of counter-cryptanalysis and it is able to detect known and unknown SHA-1 cryptanalytic collision attacks given just a single file from a colliding file pair.

### How widespread is this?

As far as we know our example collision is the first ever created.

### Has this been abused in the wild?

Not as far as we know.

### Is Hardened SHA-1 vulnerable?

No, SHA-1 hardened with counter-cryptanalysis (see ‘how do I detect the attack’) will detect cryptanalytic collision attacks. In that case it adjusts the SHA-1 computation to result in a safe hash. This means that it will compute the regular SHA-1 hash for files without a collision attack, but produce a special hash for files with a collision attack, where both files will have a different unpredictable hash.

### Who is capable of mounting this attack?

This attack required over 9,223,372,036,854,775,808 SHA1 computations.
This took the equivalent processing power as 6,500 years of single-CPU
computations and 110 years of single-GPU computations.

### How does this attack compare to the brute force one?

The SHAttered attack is 100,000 faster than the brute force attack that relies on the birthday paradox.
The brute force attack would require 12,000,000 GPU years to complete, and it is therefore impractical.

### How did you leverage the PDF format for this attack?

A picture is worth a thousand words, so here it is.
### Who is the team behind this research?

This result is the product of a long term collaboration between the [Cryptology Group at Centrum
Wiskunde & Informatica (CWI) - the national research institute for mathematics and computer science
in the Netherlands](https://www.cwi.nl/research-groups/Cryptology) - and the [Google Research Security, Privacy and Anti-abuse Group](https://g.co/research/protect). Two
years ago [Marc Stevens](https://marc-stevens.nl/research/) and [Elie Bursztein](https://elie.net), who leads the Google's anti-abuse research team,
began collaborating on making Marc's cryptanalytic attacks against SHA-1 practical by leveraging
Google expertise and infrastructure. Since then many CWI researchers and Googlers have helped make this
project possible, including [Pierre Karpman](http://pages.saclay.inria.fr/pierre.karpman/) who worked on the cryptanalysis and
prototype GPU implementation, and from Google [Ange Albertini](http://corkami.github.io/) who developed the PDF attack,
[Yarik Markov](https://ymarkov.me) who took care of the distributed GPU code, [Alex Petit-Bianco](http://serialhacker.org/) implemented the collision detector to protect Google users, [Luca Invernizzi](https://lucainvernizzi.net) who created the online file checker, and Clement Blaisse who oversaw the
reliability of the computations.


