- **Root cause of vulnerability**: A canonicalization error in Microsoft Internet Information Server (IIS) 4.0 and 5.0. When processing specially crafted URLs requesting CGI scripts or files handled by ISAPI extensions, IIS incorrectly determines the file's location, leading to incorrect permissions being applied.
- **Weaknesses/vulnerabilities present**: The vulnerability lies in the way IIS handles URL canonicalization for CGI scripts and ISAPI extensions.  It incorrectly maps the file to a different folder in the parent directory chain, thus applying the permissions of the wrong directory.
- **Impact of exploitation**: A malicious user can gain additional privileges to affected files, such as the ability to read or execute them, if an ancestor folder in the file's path has more permissive settings.
- **Attack vectors**: By crafting a malformed URL requesting a CGI script or an ISAPI-mapped file, an attacker can trigger the canonicalization error. The malformation needs to be inserted at specific points in the URL to cause IIS to apply permissions from the desired parent folder.
- **Required attacker capabilities/position**:
  - The attacker needs to know the existence of a vulnerable file (CGI script or ISAPI-mapped file) located in a physical folder (where the logical folder structure mirrors the physical one on the server).
  - The attacker needs to be able to craft a specially malformed URL to exploit the vulnerability.
  - The attacker needs to target servers where the web folder structure mirrors the physical folder structure of the server.