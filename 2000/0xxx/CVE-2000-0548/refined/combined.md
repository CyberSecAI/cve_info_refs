=== Content from web.mit.edu_dc9e515a_20250124_194633.html ===
-----BEGIN PGP SIGNED MESSAGE-----
MULTIPLE DENIAL OF SERVICE VULNERABILITIES IN KRB4 KDC
2000-06-09
SUMMARY:
A buffer overrun capable of creating a denial of service exists in
implementations of Kerberos 4 KDC programs. This is IN ADDITION to
the krb\_rd\_req() vulnerability that was previously announced. Many
Kerberos 4 KDC implementations derived from MIT sources are believed
to be vulnerable.
Another denial of service vulnerability exists in the krb5-1.1.x KDC
implementations (and krb5-1.2-beta1, but not krb5-1.0.x) that can
cause the Kerberos 4 compatibility code to perform a double-free,
possibly resulting in a crash of the KDC process.
IMPACT:
A remote user may be able to cause the KDC to issue bogus tickets, or
to return an error of the form "principal unknown" for all principals,
necessitating a restart of the KDC to resume proper operation.
A remote user may also be able to cause a krb5-1.1.x KDC to experience
a segmentation violation or malloc pool corruption, causing the KDC
process to crash.
DETAILS:
A static buffer can be overrun by corrupt requests sent to a KDC
process. It is believed that this overrun does not lead to a root
compromise, but it can lead to a denial of service by corrupting
long-term state in the KDC process.
The krb5-1.1.x KDC contains in its Kerberos 4 compatibility mode some
code which tickles a memory management bug in the library. This can
result in a double-free of memory and corruption of the malloc pool,
possibly leading to a crash of the KDC. Whether or not a crash occurs
depends on the idiosyncrasies of the malloc implementation used.
VULNERABLE DISTRIBUTIONS:
Source distributions which may contain vulnerable code include:
MIT Kerberos 5 releases krb5-1.0.x, krb5-1.1, krb5-1.1.1
MIT Kerberos 4 patch 10, and probably earlier releases as well
KerbNet (Cygnus implementation of Kerberos 5)
Cygnus Network Security (CNS -- Cygnus implementation of
Kerberos 4)
KTH-krb4 before version 0.10
NON-VULNERABLE DISTRIBUTIONS:
Source distributions that are believed not to be vulnerable include:
KTH-krb4 -- version 0.10 and above
Heimdal (KTH implementation of Kerberos 5) -- any version
FIXES:
The best course of action is to patch your KDC. If you have not done
so already, install the patches to deal with the krb\_rd\_req()
vulnerability that was previously announced. Patches and the original
announcement may be found at:
http://web.mit.edu/kerberos/www/advisories/index.html
MIT will soon release krb5-1.2, which will have these changes
incorporated. The krb5-1.2-beta1 release does not have this fix,
though the upcoming krb5-1.2-beta2 release, tentatively scheduled for
the week of June 5, will. The two recent beta patch releases,
krb5-1.0.7-beta2 and krb5-1.1.2-beta1, which were intended to fix the
krb4 buffer overrun problems, have not been patched for this problem
yet.
The following patches for this bug will be posted to the
aforementioned security advisories web page once this announcement is
made public.
PATCHES AGAINST krb5-1.0.x:
These patches are against krb5-1.0.7-beta1, but will probably apply
cleanly against krb5-1.0.6 and earlier releases as well.
These patches also will be made available at:
http://web.mit.edu/kerberos/www/advisories/krb4kdc\_10x\_patch.txt
Index: kerberos\_v4.c
===================================================================
RCS file: /cvs/krbdev/krb5/src/kdc/kerberos\_v4.c,v
retrieving revision 5.56.4.3
diff -c -r5.56.4.3 kerberos\_v4.c
\*\*\* kerberos\_v4.c 1998/05/10 03:02:55 5.56.4.3
- --- kerberos\_v4.c 2000/05/19 19:38:17
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 173,183 \*\*\*\*
return(retval);
if (!\*local\_realm) { /\* local-realm name already set up \*/
- - /\* XXX assumes realm is null-terminated! \*/
lrealm = master\_princ->realm.data;
! if (strlen(lrealm) < sizeof(local\_realm))
! strcpy(local\_realm, lrealm);
! else
retval = KRB5\_CONFIG\_NOTENUFSPACE;
}
/\* convert client\_fulladdr to client\_sockaddr:
- --- 173,183 ----
return(retval);
if (!\*local\_realm) { /\* local-realm name already set up \*/
lrealm = master\_princ->realm.data;
! if (master\_princ->realm.length < sizeof(local\_realm)) {
! memcpy(local\_realm, lrealm, master\_princ->realm.length);
! local\_realm[master\_princ->realm.length] = '\0';
! } else
retval = KRB5\_CONFIG\_NOTENUFSPACE;
}
/\* convert client\_fulladdr to client\_sockaddr:
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 196,201 \*\*\*\*
- --- 196,202 ----
return KRB5KRB\_ERR\_FIELD\_TOOLONG;
}
v4\_pkt.length = pkt->length;
+ v4\_pkt.mbz = 0;
memcpy( v4\_pkt.dat, pkt->data, pkt->length);
kerberos\_v4( &client\_sockaddr, &v4\_pkt);
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 507,512 \*\*\*\*
- --- 508,516 ----
req\_act\_vno = req\_version;
+ /\* set these to point to something safe \*/
+ req\_name\_ptr = req\_inst\_ptr = req\_realm\_ptr = "";
+
/\* check packet version \*/
if (req\_version != KRB\_PROT\_VERSION) {
lt = klog(L\_KRB\_PERR,
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 574,580 \*\*\*\*
if ((i = check\_princ(req\_name\_ptr, req\_inst\_ptr, 0,
&a\_name\_data))) {
! kerb\_err\_reply(client, pkt, i, lt);
a\_name\_data.key\_low = a\_name\_data.key\_high = 0;
return;
}
- --- 578,584 ----
if ((i = check\_princ(req\_name\_ptr, req\_inst\_ptr, 0,
&a\_name\_data))) {
! kerb\_err\_reply(client, pkt, i, "check\_princ failed");
a\_name\_data.key\_low = a\_name\_data.key\_high = 0;
return;
}
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 586,592 \*\*\*\*
/\* this does all the checking \*/
if ((i = check\_princ(service, instance, lifetime,
&s\_name\_data))) {
! kerb\_err\_reply(client, pkt, i, lt);
a\_name\_data.key\_high = a\_name\_data.key\_low = 0;
s\_name\_data.key\_high = s\_name\_data.key\_low = 0;
return;
- --- 590,596 ----
/\* this does all the checking \*/
if ((i = check\_princ(service, instance, lifetime,
&s\_name\_data))) {
! kerb\_err\_reply(client, pkt, i, "check\_princ\_failed");
a\_name\_data.key\_high = a\_name\_data.key\_low = 0;
s\_name\_data.key\_high = s\_name\_data.key\_low = 0;
return;
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 664,681 \*\*\*\*
tk->length = 0;
k\_flags = 0; /\* various kerberos flags \*/
auth->length = 4 + strlen((char \*)pkt->dat + 3);
auth->length += (int) \*(pkt->dat + auth->length) +
(int) \*(pkt->dat + auth->length + 1) + 2;
memcpy(auth->dat, pkt->dat, auth->length);
strncpy(tktrlm, (char \*)auth->dat + 3, REALM\_SZ);
if (set\_tgtkey(tktrlm)) {
lt = klog(L\_ERR\_UNK,
"FAILED realm %s unknown. Host: %s ",
tktrlm, inet\_ntoa(client\_host));
! kerb\_err\_reply(client, pkt, kerno, lt);
return;
}
kerno = krb\_rd\_req(auth, "ktbtgt", tktrlm, client\_host.s\_addr,
- --- 668,706 ----
tk->length = 0;
k\_flags = 0; /\* various kerberos flags \*/
+ auth->mbz = 0; /\* pkt->mbz already zeroed \*/
auth->length = 4 + strlen((char \*)pkt->dat + 3);
+ if (auth->length + 1 > MAX\_KTXT\_LEN) {
+ lt = klog(L\_KRB\_PERR,
+ "APPL request with realm length too long from %s",
+ inet\_ntoa(client\_host));
+ kerb\_err\_reply(client, pkt, RD\_AP\_INCON,
+ "realm length too long");
+ return;
+ }
+
auth->length += (int) \*(pkt->dat + auth->length) +
(int) \*(pkt->dat + auth->length + 1) + 2;
+ if (auth->length > MAX\_KTXT\_LEN) {
+ lt = klog(L\_KRB\_PERR,
+ "APPL request with funky tkt or req\_id length from %s",
+ inet\_ntoa(client\_host));
+ kerb\_err\_reply(client, pkt, RD\_AP\_INCON,
+ "funky tkt or req\_id length");
+ return;
+ }
memcpy(auth->dat, pkt->dat, auth->length);
strncpy(tktrlm, (char \*)auth->dat + 3, REALM\_SZ);
+ tktrlm[REALM\_SZ-1] = '\0';
if (set\_tgtkey(tktrlm)) {
lt = klog(L\_ERR\_UNK,
"FAILED realm %s unknown. Host: %s ",
tktrlm, inet\_ntoa(client\_host));
! /\* no better error code \*/
! kerb\_err\_reply(client, pkt,
! KERB\_ERR\_PRINCIPAL\_UNKNOWN, lt);
return;
}
kerno = krb\_rd\_req(auth, "ktbtgt", tktrlm, client\_host.s\_addr,
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 720,726 \*\*\*\*
kerno = check\_princ(service, instance, req\_life,
&s\_name\_data);
if (kerno) {
! kerb\_err\_reply(client, pkt, kerno, lt);
return;
}
/\* Bound requested lifetime with service and user \*/
- --- 745,751 ----
kerno = check\_princ(service, instance, req\_life,
&s\_name\_data);
if (kerno) {
! kerb\_err\_reply(client, pkt, kerno, "check\_princ failed");
return;
}
/\* Bound requested lifetime with service and user \*/
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 844,850 \*\*\*\*
static char e\_msg[128];
strcpy(e\_msg, "\nKerberos error -- ");
! strcat(e\_msg, string);
cr\_err\_reply(e\_pkt, req\_name\_ptr, req\_inst\_ptr, req\_realm\_ptr,
req\_time\_ws, err, e\_msg);
krb4\_sendto(f, (char \*) e\_pkt->dat, e\_pkt->length, 0,
- --- 869,875 ----
static char e\_msg[128];
strcpy(e\_msg, "\nKerberos error -- ");
! strncat(e\_msg, string, sizeof(e\_msg) - 1 - 19);
cr\_err\_reply(e\_pkt, req\_name\_ptr, req\_inst\_ptr, req\_realm\_ptr,
req\_time\_ws, err, e\_msg);
krb4\_sendto(f, (char \*) e\_pkt->dat, e\_pkt->length, 0,
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 989,995 \*\*\*\*
kdb\_encrypt\_key(key, key, master\_key,
master\_key\_schedule, DECRYPT);
krb\_set\_key((char \*) key, 0);
! strcpy(lastrealm, r);
return (KSUCCESS);
}
- --- 1014,1021 ----
kdb\_encrypt\_key(key, key, master\_key,
master\_key\_schedule, DECRYPT);
krb\_set\_key((char \*) key, 0);
! strncpy(lastrealm, r, sizeof(lastrealm) - 1);
! lastrealm[sizeof(lastrealm) - 1] = '\0';
return (KSUCCESS);
}
PATCHES AGAINST krb5-1.1.1:
These patches should apply cleanly against krb5-1.2-beta1 as well.
These patches will also be made available at:
http://web.mit.edu/kerberos/www/advisories/krb4kdc\_111\_patch.txt
Index: krb5/src/kdc/kerberos\_v4.c
diff -c krb5/src/kdc/kerberos\_v4.c:5.65.2.2 krb5/src/kdc/kerberos\_v4.c:5.65.2.3
\*\*\* krb5/src/kdc/kerberos\_v4.c:5.65.2.2 Wed Sep 22 20:47:22 1999
- --- krb5/src/kdc/kerberos\_v4.c Mon Jun 5 13:58:34 2000
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 233,243 \*\*\*\*
return(retval);
if (!\*local\_realm) { /\* local-realm name already set up \*/
- - /\* XXX assumes realm is null-terminated! \*/
lrealm = master\_princ->realm.data;
! if (strlen(lrealm) < sizeof(local\_realm))
! strcpy(local\_realm, lrealm);
! else
retval = KRB5\_CONFIG\_NOTENUFSPACE;
}
/\* convert client\_fulladdr to client\_sockaddr:
- --- 233,243 ----
return(retval);
if (!\*local\_realm) { /\* local-realm name already set up \*/
lrealm = master\_princ->realm.data;
! if (master\_princ->realm.length < sizeof(local\_realm)) {
! memcpy(local\_realm, lrealm, master\_princ->realm.length);
! local\_realm[master\_princ->realm.length] = '\0';
! } else
retval = KRB5\_CONFIG\_NOTENUFSPACE;
}
/\* convert client\_fulladdr to client\_sockaddr:
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 256,261 \*\*\*\*
- --- 256,262 ----
return KRB5KRB\_ERR\_FIELD\_TOOLONG;
}
v4\_pkt.length = pkt->length;
+ v4\_pkt.mbz = 0;
memcpy( v4\_pkt.dat, pkt->data, pkt->length);
kerberos\_v4( &client\_sockaddr, &v4\_pkt);
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 293,299 \*\*\*\*
case L\_APPL\_REQ:
strcpy(log\_text, "PROCESS\_V4:");
vsprintf(log\_text+strlen(log\_text), format, pvar);
! krb5\_klog\_syslog(logpri, log\_text);
/\* ignore the other types... \*/
}
va\_end(pvar);
- --- 294,300 ----
case L\_APPL\_REQ:
strcpy(log\_text, "PROCESS\_V4:");
vsprintf(log\_text+strlen(log\_text), format, pvar);
! krb5\_klog\_syslog(logpri, "%s", log\_text);
/\* ignore the other types... \*/
}
va\_end(pvar);
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 622,627 \*\*\*\*
- --- 623,631 ----
req\_act\_vno = req\_version;
+ /\* set these to point to something safe \*/
+ req\_name\_ptr = req\_inst\_ptr = req\_realm\_ptr = "";
+
/\* check if disabled, but we tell client \*/
if (kdc\_v4 == KDC\_V4\_DISABLE) {
lt = klog(L\_KRB\_PERR,
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 700,706 \*\*\*\*
if ((i = check\_princ(req\_name\_ptr, req\_inst\_ptr, 0,
&a\_name\_data, &k5key, 0))) {
! kerb\_err\_reply(client, pkt, i, lt);
a\_name\_data.key\_low = a\_name\_data.key\_high = 0;
krb5\_free\_keyblock\_contents(kdc\_context, &k5key);
return;
- --- 704,710 ----
if ((i = check\_princ(req\_name\_ptr, req\_inst\_ptr, 0,
&a\_name\_data, &k5key, 0))) {
! kerb\_err\_reply(client, pkt, i, "check\_princ failed");
a\_name\_data.key\_low = a\_name\_data.key\_high = 0;
krb5\_free\_keyblock\_contents(kdc\_context, &k5key);
return;
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 715,721 \*\*\*\*
/\* this does all the checking \*/
if ((i = check\_princ(service, instance, lifetime,
&s\_name\_data, &k5key, 1))) {
! kerb\_err\_reply(client, pkt, i, lt);
a\_name\_data.key\_high = a\_name\_data.key\_low = 0;
s\_name\_data.key\_high = s\_name\_data.key\_low = 0;
krb5\_free\_keyblock\_contents(kdc\_context, &k5key);
- --- 719,725 ----
/\* this does all the checking \*/
if ((i = check\_princ(service, instance, lifetime,
&s\_name\_data, &k5key, 1))) {
! kerb\_err\_reply(client, pkt, i, "check\_princ failed");
a\_name\_data.key\_high = a\_name\_data.key\_low = 0;
s\_name\_data.key\_high = s\_name\_data.key\_low = 0;
krb5\_free\_keyblock\_contents(kdc\_context, &k5key);
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 806,824 \*\*\*\*
tk->length = 0;
k\_flags = 0; /\* various kerberos flags \*/
auth->length = 4 + strlen((char \*)pkt->dat + 3);
auth->length += (int) \*(pkt->dat + auth->length) +
(int) \*(pkt->dat + auth->length + 1) + 2;
memcpy(auth->dat, pkt->dat, auth->length);
strncpy(tktrlm, (char \*)auth->dat + 3, REALM\_SZ);
kvno = (krb5\_kvno)auth->dat[2];
if (set\_tgtkey(tktrlm, kvno)) {
lt = klog(L\_ERR\_UNK,
"FAILED set\_tgtkey realm %s, kvno %d. Host: %s ",
tktrlm, kvno, inet\_ntoa(client\_host));
! kerb\_err\_reply(client, pkt, kerno, lt);
return;
}
kerno = krb\_rd\_req(auth, "krbtgt", tktrlm, client\_host.s\_addr,
- --- 810,849 ----
tk->length = 0;
k\_flags = 0; /\* various kerberos flags \*/
+ auth->mbz = 0; /\* pkt->mbz already zeroed \*/
auth->length = 4 + strlen((char \*)pkt->dat + 3);
+ if (auth->length + 1 > MAX\_KTXT\_LEN) {
+ lt = klog(L\_KRB\_PERR,
+ "APPL request with realm length too long from %s",
+ inet\_ntoa(client\_host));
+ kerb\_err\_reply(client, pkt, RD\_AP\_INCON,
+ "realm length too long");
+ return;
+ }
+
auth->length += (int) \*(pkt->dat + auth->length) +
(int) \*(pkt->dat + auth->length + 1) + 2;
+ if (auth->length > MAX\_KTXT\_LEN) {
+ lt = klog(L\_KRB\_PERR,
+ "APPL request with funky tkt or req\_id length from %s",
+ inet\_ntoa(client\_host));
+ kerb\_err\_reply(client, pkt, RD\_AP\_INCON,
+ "funky tkt or req\_id length");
+ return;
+ }
memcpy(auth->dat, pkt->dat, auth->length);
strncpy(tktrlm, (char \*)auth->dat + 3, REALM\_SZ);
+ tktrlm[REALM\_SZ-1] = '\0';
kvno = (krb5\_kvno)auth->dat[2];
if (set\_tgtkey(tktrlm, kvno)) {
lt = klog(L\_ERR\_UNK,
"FAILED set\_tgtkey realm %s, kvno %d. Host: %s ",
tktrlm, kvno, inet\_ntoa(client\_host));
! /\* no better error code \*/
! kerb\_err\_reply(client, pkt,
! KERB\_ERR\_PRINCIPAL\_UNKNOWN, lt);
return;
}
kerno = krb\_rd\_req(auth, "krbtgt", tktrlm, client\_host.s\_addr,
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 863,869 \*\*\*\*
kerno = check\_princ(service, instance, req\_life,
&s\_name\_data, &k5key, 1);
if (kerno) {
! kerb\_err\_reply(client, pkt, kerno, lt);
s\_name\_data.key\_high = s\_name\_data.key\_low = 0;
krb5\_free\_keyblock\_contents(kdc\_context, &k5key);
return;
- --- 888,894 ----
kerno = check\_princ(service, instance, req\_life,
&s\_name\_data, &k5key, 1);
if (kerno) {
! kerb\_err\_reply(client, pkt, kerno, "check\_princ failed");
s\_name\_data.key\_high = s\_name\_data.key\_low = 0;
krb5\_free\_keyblock\_contents(kdc\_context, &k5key);
return;
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 968,974 \*\*\*\*
static char e\_msg[128];
strcpy(e\_msg, "\nKerberos error -- ");
! strcat(e\_msg, string);
cr\_err\_reply(e\_pkt, req\_name\_ptr, req\_inst\_ptr, req\_realm\_ptr,
req\_time\_ws, err, e\_msg);
krb4\_sendto(f, (char \*) e\_pkt->dat, e\_pkt->length, 0,
- --- 993,999 ----
static char e\_msg[128];
strcpy(e\_msg, "\nKerberos error -- ");
! strncat(e\_msg, string, sizeof(e\_msg) - 1 - 19);
cr\_err\_reply(e\_pkt, req\_name\_ptr, req\_inst\_ptr, req\_realm\_ptr,
req\_time\_ws, err, e\_msg);
krb4\_sendto(f, (char \*) e\_pkt->dat, e\_pkt->length, 0,
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 1127,1133 \*\*\*\*
if (!K4KDC\_ENCTYPE\_OK(k5key.enctype)) {
krb\_set\_key\_krb5(kdc\_context, &k5key);
! strcpy(lastrealm, r);
last\_kvno = kvno;
} else {
/\* unseal tgt key from master key \*/
- --- 1152,1159 ----
if (!K4KDC\_ENCTYPE\_OK(k5key.enctype)) {
krb\_set\_key\_krb5(kdc\_context, &k5key);
! strncpy(lastrealm, r, sizeof(lastrealm) - 1);
! lastrealm[sizeof(lastrealm) - 1] = '\0';
last\_kvno = kvno;
} else {
/\* unseal tgt key from master key \*/
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 1136,1142 \*\*\*\*
kdb\_encrypt\_key(key, key, master\_key,
master\_key\_schedule, DECRYPT);
krb\_set\_key((char \*) key, 0);
! strcpy(lastrealm, r);
last\_kvno = kvno;
}
krb5\_free\_keyblock\_contents(kdc\_context, &k5key);
- --- 1162,1169 ----
kdb\_encrypt\_key(key, key, master\_key,
master\_key\_schedule, DECRYPT);
krb\_set\_key((char \*) key, 0);
! strncpy(lastrealm, r, sizeof(lastrealm) - 1);
! lastrealm[sizeof(lastrealm) - 1] = '\0';
last\_kvno = kvno;
}
krb5\_free\_keyblock\_contents(kdc\_context, &k5key);
Index: krb5/src/lib/krb5/krb/kfree.c
diff -c krb5/src/lib/krb5/krb/kfree.c:5.3.4.1 krb5/src/lib/krb5/krb/kfree.c:5.3.4.2
\*\*\* krb5/src/lib/krb5/krb/kfree.c:5.3.4.1 Wed Sep 22 20:50:11 1999
- --- krb5/src/lib/krb5/krb/kfree.c Mon Jun 5 18:30:06 2000
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 36,42 \*\*\*\*
if (val->contents)
krb5\_xfree(val->contents);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 36,41 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 52,58 \*\*\*\*
krb5\_xfree(\*temp);
}
krb5\_xfree(val);
- - return;
}
- --- 51,56 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 64,70 \*\*\*\*
if (val->enc\_part.ciphertext.data)
krb5\_xfree(val->enc\_part.ciphertext.data);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 62,67 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 77,83 \*\*\*\*
if (val->authenticator.ciphertext.data)
krb5\_xfree(val->authenticator.ciphertext.data);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 74,79 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 88,94 \*\*\*\*
if (val->subkey)
krb5\_free\_keyblock(context, val->subkey);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 84,89 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 96,110 \*\*\*\*
krb5\_context context;
krb5\_authenticator FAR \*val;
{
! if (val->checksum)
krb5\_free\_checksum(context, val->checksum);
! if (val->client)
krb5\_free\_principal(context, val->client);
! if (val->subkey)
krb5\_free\_keyblock(context, val->subkey);
! if (val->authorization\_data)
! krb5\_free\_authdata(context, val->authorization\_data);
! return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 91,112 ----
krb5\_context context;
krb5\_authenticator FAR \*val;
{
! if (val->checksum) {
krb5\_free\_checksum(context, val->checksum);
! val->checksum = 0;
! }
! if (val->client) {
krb5\_free\_principal(context, val->client);
! val->client = 0;
! }
! if (val->subkey) {
krb5\_free\_keyblock(context, val->subkey);
! val->subkey = 0;
! }
! if (val->authorization\_data) {
! krb5\_free\_authdata(context, val->authorization\_data);
! val->authorization\_data = 0;
! }
}
KRB5\_DLLIMP void KRB5\_CALLCONV
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 120,126 \*\*\*\*
krb5\_xfree(\*temp);
}
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 122,127 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 128,143 \*\*\*\*
krb5\_context context;
krb5\_authenticator FAR \*val;
{
! if (val->checksum)
! krb5\_free\_checksum(context, val->checksum);
! if (val->client)
! krb5\_free\_principal(context, val->client);
! if (val->subkey)
! krb5\_free\_keyblock(context, val->subkey);
! if (val->authorization\_data)
! krb5\_free\_authdata(context, val->authorization\_data);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 129,136 ----
krb5\_context context;
krb5\_authenticator FAR \*val;
{
! krb5\_free\_authenticator\_contents(context, val);
krb5\_xfree(val);
}
KRB5\_DLLIMP void KRB5\_CALLCONV
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 145,154 \*\*\*\*
krb5\_context context;
register krb5\_checksum \*val;
{
! if (val->contents)
! krb5\_xfree(val->contents);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 138,145 ----
krb5\_context context;
register krb5\_checksum \*val;
{
! krb5\_free\_checksum\_contents(context, val);
krb5\_xfree(val);
}
KRB5\_DLLIMP void KRB5\_CALLCONV
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 156,164 \*\*\*\*
krb5\_context context;
register krb5\_checksum \*val;
{
! if (val->contents)
krb5\_xfree(val->contents);
! return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 147,156 ----
krb5\_context context;
register krb5\_checksum \*val;
{
! if (val->contents) {
krb5\_xfree(val->contents);
! val->contents = 0;
! }
}
KRB5\_DLLIMP void KRB5\_CALLCONV
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 171,177 \*\*\*\*
if (val->enc\_part.ciphertext.data)
krb5\_xfree(val->enc\_part.ciphertext.data);
krb5\_xfree(val);
- - return;
}
/\*
- --- 163,168 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 184,206 \*\*\*\*
krb5\_context context;
krb5\_creds FAR \*val;
{
! if (val->client)
krb5\_free\_principal(context, val->client);
! if (val->server)
krb5\_free\_principal(context, val->server);
if (val->keyblock.contents) {
memset((char \*)val->keyblock.contents, 0, val->keyblock.length);
krb5\_xfree(val->keyblock.contents);
}
! if (val->ticket.data)
krb5\_xfree(val->ticket.data);
! if (val->second\_ticket.data)
krb5\_xfree(val->second\_ticket.data);
! if (val->addresses)
krb5\_free\_addresses(context, val->addresses);
! if (val->authdata)
krb5\_free\_authdata(context, val->authdata);
! return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 175,209 ----
krb5\_context context;
krb5\_creds FAR \*val;
{
! if (val->client) {
krb5\_free\_principal(context, val->client);
! val->client = 0;
! }
! if (val->server) {
krb5\_free\_principal(context, val->server);
+ val->server = 0;
+ }
if (val->keyblock.contents) {
memset((char \*)val->keyblock.contents, 0, val->keyblock.length);
krb5\_xfree(val->keyblock.contents);
+ val->keyblock.contents = 0;
}
! if (val->ticket.data) {
krb5\_xfree(val->ticket.data);
! val->ticket.data = 0;
! }
! if (val->second\_ticket.data) {
krb5\_xfree(val->second\_ticket.data);
! val->second\_ticket.data = 0;
! }
! if (val->addresses) {
krb5\_free\_addresses(context, val->addresses);
! val->addresses = 0;
! }
! if (val->authdata) {
krb5\_free\_authdata(context, val->authdata);
! val->authdata = 0;
! }
}
KRB5\_DLLIMP void KRB5\_CALLCONV
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 210,219 \*\*\*\*
{
register krb5\_cred\_info \*\*temp;
! if (val->r\_address)
! krb5\_free\_address(context, val->r\_address);
! if (val->s\_address)
! krb5\_free\_address(context, val->s\_address);
if (val->ticket\_info) {
for (temp = val->ticket\_info; \*temp; temp++) {
- --- 213,226 ----
{
register krb5\_cred\_info \*\*temp;
! if (val->r\_address) {
! krb5\_free\_address(context, val->r\_address);
! val->r\_address = 0;
! }
! if (val->s\_address) {
! krb5\_free\_address(context, val->s\_address);
! val->s\_address = 0;
! }
if (val->ticket\_info) {
for (temp = val->ticket\_info; \*temp; temp++) {
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 228,235 \*\*\*\*
krb5\_xfree((\*temp));
}
krb5\_xfree(val->ticket\_info);
}
- - return;
}
- --- 235,242 ----
krb5\_xfree((\*temp));
}
krb5\_xfree(val->ticket\_info);
+ val->ticket\_info = 0;
}
}
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 240,246 \*\*\*\*
{
krb5\_free\_cred\_contents(context, val);
krb5\_xfree(val);
- - return;
}
- --- 247,252 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 252,258 \*\*\*\*
if (val->data)
krb5\_xfree(val->data);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 258,263 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 260,268 \*\*\*\*
krb5\_context context;
krb5\_data FAR \* val;
{
! if (val->data)
krb5\_xfree(val->data);
! return;
}
void krb5\_free\_etype\_info(context, info)
- --- 265,274 ----
krb5\_context context;
krb5\_data FAR \* val;
{
! if (val->data) {
krb5\_xfree(val->data);
! val->data = 0;
! }
}
void krb5\_free\_etype\_info(context, info)
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 294,300 \*\*\*\*
if (val->caddrs)
krb5\_free\_addresses(context, val->caddrs);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 300,305 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 313,319 \*\*\*\*
if (val->authorization\_data)
krb5\_free\_authdata(context, val->authorization\_data);
krb5\_xfree(val);
- - return;
}
- --- 318,323 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 331,337 \*\*\*\*
if (val->e\_data.data)
krb5\_xfree(val->e\_data.data);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 335,340 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 350,356 \*\*\*\*
if (val->enc\_part2)
krb5\_free\_enc\_kdc\_rep\_part(context, val->enc\_part2);
krb5\_xfree(val);
- - return;
}
- --- 353,358 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 376,382 \*\*\*\*
if (val->second\_ticket)
krb5\_free\_tickets(context, val->second\_ticket);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 378,383 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 387,394 \*\*\*\*
if (key->contents) {
memset(key->contents, 0, key->length);
krb5\_xfree(key->contents);
}
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 388,395 ----
if (key->contents) {
memset(key->contents, 0, key->length);
krb5\_xfree(key->contents);
+ key->contents = 0;
}
}
KRB5\_DLLIMP void KRB5\_CALLCONV
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 398,404 \*\*\*\*
{
krb5\_free\_keyblock\_contents(context, val);
krb5\_xfree(val);
- - return;
}
- --- 399,404 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 413,419 \*\*\*\*
for (temp = val; \*temp; temp++)
krb5\_xfree(\*temp);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 413,418 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 429,435 \*\*\*\*
krb5\_xfree(\*temp);
}
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 428,433 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 451,457 \*\*\*\*
if (val->realm.data)
krb5\_xfree(val->realm.data);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 449,454 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 462,468 \*\*\*\*
if (val->enc\_part.ciphertext.data)
krb5\_xfree(val->enc\_part.ciphertext.data);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 459,464 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 477,483 \*\*\*\*
if (val->s\_address)
krb5\_free\_address(context, val->s\_address);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 473,478 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 488,494 \*\*\*\*
if (val->element)
krb5\_free\_pwd\_sequences(context, val->element);
krb5\_xfree(val);
- - return;
}
- --- 483,488 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 497,507 \*\*\*\*
krb5\_context context;
passwd\_phrase\_element FAR \* FAR \*val;
{
! if ((\*val)->passwd)
krb5\_xfree((\*val)->passwd);
! if ((\*val)->phrase)
krb5\_xfree((\*val)->phrase);
! return;
}
- --- 491,504 ----
krb5\_context context;
passwd\_phrase\_element FAR \* FAR \*val;
{
! if ((\*val)->passwd) {
krb5\_xfree((\*val)->passwd);
! (\*val)->passwd = 0;
! }
! if ((\*val)->phrase) {
krb5\_xfree((\*val)->phrase);
! (\*val)->phrase = 0;
! }
}
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 519,525 \*\*\*\*
if (val->checksum)
krb5\_free\_checksum(context, val->checksum);
krb5\_xfree(val);
- - return;
}
- --- 516,521 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 535,541 \*\*\*\*
if (val->enc\_part2)
krb5\_free\_enc\_tkt\_part(context, val->enc\_part2);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 531,536 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 548,554 \*\*\*\*
for (temp = val; \*temp; temp++)
krb5\_free\_ticket(context, \*temp);
krb5\_xfree(val);
- - return;
}
- --- 543,548 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 573,579 \*\*\*\*
if (val->authenticator)
krb5\_free\_authenticator(context, val->authenticator);
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 567,572 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 583,589 \*\*\*\*
{
if (val)
krb5\_xfree(val);
- - return;
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 576,581 ----
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 612,619 \*\*\*\*
krb5\_free\_data\_contents(ctx, &sc->sam\_response\_prompt);
if (sc->sam\_pk\_for\_sad.data)
krb5\_free\_data\_contents(ctx, &sc->sam\_pk\_for\_sad);
! if (sc->sam\_cksum.contents)
krb5\_xfree(sc->sam\_cksum.contents);
}
KRB5\_DLLIMP void KRB5\_CALLCONV
- --- 604,613 ----
krb5\_free\_data\_contents(ctx, &sc->sam\_response\_prompt);
if (sc->sam\_pk\_for\_sad.data)
krb5\_free\_data\_contents(ctx, &sc->sam\_pk\_for\_sad);
! if (sc->sam\_cksum.contents) {
krb5\_xfree(sc->sam\_cksum.contents);
+ sc->sam\_cksum.contents = 0;
+ }
}
KRB5\_DLLIMP void KRB5\_CALLCONV
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 685,688 \*\*\*\*
return;
krb5\_xfree(pa\_enc\_ts);
}
- -
- --- 679,681 ----
FIXES FOR KTH-krb4:
If you are still running a version before 0.10, please upgrade to
1.0.1.
See the following URL for retrieving distributions:
http://www.pdc.kth.se/kth-krb/
PATCHES AGAINST CNS:
These patches compile but have not been tested. They will also be
made available at:
http://web.mit.edu/kerberos/www/advisories/krb4kdc\_cns\_patch.txt
\*\*\* kerberos.c.orig Sat Feb 24 05:43:44 1996
- --- kerberos.c Fri Jun 2 15:25:22 2000
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 358,363 \*\*\*\*
- --- 358,377 ----
}
+ static void str\_length\_check(str, max\_size)
+ char \*str;
+ int max\_size;
+ {
+ int i;
+ char \*cp;
+
+ for (i=0, cp = str; i < max\_size-1; i++, cp++) {
+ if (\*cp == 0)
+ return;
+ }
+ \*cp = 0;
+ }
+
kerberos(client, pkt)
struct sockaddr\_in \*client;
KTEXT pkt;
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 397,402 \*\*\*\*
- --- 411,419 ----
req\_act\_vno = req\_version;
+ /\* set these to point to something safe \*/
+ req\_name\_ptr = req\_inst\_ptr = req\_realm\_ptr = "";
+
/\* check packet version \*/
if (req\_version != KRB\_PROT\_VERSION) {
lt = klog(L\_KRB\_PERR,
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 435,442 \*\*\*\*
- --- 452,462 ----
/\* set up and correct for byte order and alignment \*/
req\_name\_ptr = (char \*) pkt\_a\_name(pkt);
+ str\_length\_check(req\_name\_ptr, ANAME\_SZ);
req\_inst\_ptr = (char \*) pkt\_a\_inst(pkt);
+ str\_length\_check(req\_inst\_ptr, INST\_SZ);
req\_realm\_ptr = (char \*) pkt\_a\_realm(pkt);
+ str\_length\_check(req\_realm\_ptr, REALM\_SZ);
memcpy(&req\_time\_ws, pkt\_time\_ws(pkt), sizeof(req\_time\_ws));
/\* time has to be diddled \*/
if (swap\_bytes) {
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 460,466 \*\*\*\*
if (i = check\_princ(req\_name\_ptr, req\_inst\_ptr, 0,
&a\_name\_data)) {
! kerb\_err\_reply(client, pkt, i, lt);
return;
}
tk->length = 0; /\* init \*/
- --- 480,487 ----
if (i = check\_princ(req\_name\_ptr, req\_inst\_ptr, 0,
&a\_name\_data)) {
! kerb\_err\_reply(client, pkt, i, "check\_princ failed");
! a\_name\_data.key\_low = a\_name\_data.key\_high = 0;
return;
}
tk->length = 0; /\* init \*/
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 471,477 \*\*\*\*
/\* this does all the checking \*/
if (i = check\_princ(service, instance, req\_life,
&s\_name\_data)) {
! kerb\_err\_reply(client, pkt, i, lt);
return;
}
- --- 492,500 ----
/\* this does all the checking \*/
if (i = check\_princ(service, instance, req\_life,
&s\_name\_data)) {
! kerb\_err\_reply(client, pkt, i, "check\_princ\_failed");
! a\_name\_data.key\_high = a\_name\_data.key\_low = 0;
! s\_name\_data.key\_high = s\_name\_data.key\_low = 0;
return;
}
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 627,638 \*\*\*\*
- --- 650,679 ----
k\_flags = 0; /\* various kerberos flags \*/
auth->length = 4 + strlen((char \*) pkt->dat + 3);
+ if (auth->length + 1 > MAX\_KTXT\_LEN) {
+ lt = klog(L\_KRB\_PERR,
+ "APPL request with realm length too long from %s",
+ inet\_ntoa(client\_host));
+ kerb\_err\_reply(client, pkt, RD\_AP\_INCON,
+ "realm length too long");
+ return;
+ }
+
auth->length += (int) \*(pkt->dat + auth->length) +
(int) \*(pkt->dat + auth->length + 1) + 2;
+ if (auth->length > MAX\_KTXT\_LEN) {
+ lt = klog(L\_KRB\_PERR,
+ "APPL request with funky tkt or req\_id length from %s",
+ inet\_ntoa(client\_host));
+ kerb\_err\_reply(client, pkt, RD\_AP\_INCON,
+ "funky tkt or req\_id length");
+ return;
+ }
memcpy(auth->dat, pkt->dat, auth->length);
strncpy(tktrlm, (char \*) auth->dat + 3, REALM\_SZ);
+ tktrlm[REALM\_SZ-1] = '\0';
if (set\_tgtkey(tktrlm)) {
lt = klog(L\_ERR\_UNK,
"FAILED realm %s unknown. Host: %s ",
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 680,686 \*\*\*\*
kerno = check\_princ(service, instance, req\_life,
&s\_name\_data);
if (kerno) {
! kerb\_err\_reply(client, pkt, kerno, lt);
return;
}
/\* Bound requested lifetime with service and user \*/
- --- 721,727 ----
kerno = check\_princ(service, instance, req\_life,
&s\_name\_data);
if (kerno) {
! kerb\_err\_reply(client, pkt, kerno, "check\_princ failed");
return;
}
/\* Bound requested lifetime with service and user \*/
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 804,810 \*\*\*\*
static char e\_msg[128];
strcpy(e\_msg, "\nKerberos error -- ");
! strcat(e\_msg, string);
cr\_err\_reply(e\_pkt, req\_name\_ptr, req\_inst\_ptr, req\_realm\_ptr,
req\_time\_ws, err, e\_msg);
sendto(f, e\_pkt->dat, e\_pkt->length, 0, (struct sockaddr \*) client,
- --- 845,851 ----
static char e\_msg[128];
strcpy(e\_msg, "\nKerberos error -- ");
! strncat(e\_msg, string, sizeof(e\_msg) - 1 - 19);
cr\_err\_reply(e\_pkt, req\_name\_ptr, req\_inst\_ptr, req\_realm\_ptr,
req\_time\_ws, err, e\_msg);
sendto(f, e\_pkt->dat, e\_pkt->length, 0, (struct sockaddr \*) client,
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 928,934 \*\*\*\*
kdb\_encrypt\_key(key, key, master\_key,
master\_key\_schedule, DECRYPT);
krb\_set\_key(key, 0);
! strcpy(lastrealm, r);
return (KSUCCESS);
}
- --- 969,976 ----
kdb\_encrypt\_key(key, key, master\_key,
master\_key\_schedule, DECRYPT);
krb\_set\_key(key, 0);
! strncpy(lastrealm, r, sizeof(lastrealm) - 1);
! lastrealm[sizeof(lastrealm) - 1] = '\0';
return (KSUCCESS);
}
PATCHES AGAINST MIT Kerberos 4 Patch 10:
Please note that these patches have not been tested in any way. Use
at your own risk. These patches will also be made available at:
http://web.mit.edu/kerberos/www/advisories/krb4kdc\_krb4p10\_patch.txt
\*\*\* kerberos.c.orig Fri Mar 1 01:34:09 1991
- --- kerberos.c Fri Jun 2 15:37:32 2000
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 318,323 \*\*\*\*
- --- 318,337 ----
}
+ static void str\_length\_check(str, max\_size)
+ char \*str;
+ int max\_size;
+ {
+ int i;
+ char \*cp;
+
+ for (i=0, cp = str; i < max\_size-1; i++, cp++) {
+ if (\*cp == 0)
+ return;
+ }
+ \*cp = 0;
+ }
+
kerberos(client, pkt)
struct sockaddr\_in \*client;
KTEXT pkt;
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 357,362 \*\*\*\*
- --- 371,379 ----
req\_act\_vno = req\_version;
+ /\* set these to point to something safe \*/
+ req\_name\_ptr = req\_inst\_ptr = req\_realm\_ptr = "";
+
/\* check packet version \*/
if (req\_version != KRB\_PROT\_VERSION) {
lt = klog(L\_KRB\_PERR,
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 392,399 \*\*\*\*
- --- 409,419 ----
/\* set up and correct for byte order and alignment \*/
req\_name\_ptr = (char \*) pkt\_a\_name(pkt);
+ str\_length\_check(req\_name\_ptr, ANAME\_SZ);
req\_inst\_ptr = (char \*) pkt\_a\_inst(pkt);
+ str\_length\_check(req\_inst\_ptr, INST\_SZ);
req\_realm\_ptr = (char \*) pkt\_a\_realm(pkt);
+ str\_length\_check(req\_realm\_ptr, REALM\_SZ);
bcopy(pkt\_time\_ws(pkt), &req\_time\_ws, sizeof(req\_time\_ws));
/\* time has to be diddled \*/
if (swap\_bytes) {
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 413,419 \*\*\*\*
if (i = check\_princ(req\_name\_ptr, req\_inst\_ptr, 0,
&a\_name\_data)) {
! kerb\_err\_reply(client, pkt, i, lt);
return;
}
tk->length = 0; /\* init \*/
- --- 433,440 ----
if (i = check\_princ(req\_name\_ptr, req\_inst\_ptr, 0,
&a\_name\_data)) {
! kerb\_err\_reply(client, pkt, i, "check\_princ failed");
! a\_name\_data.key\_low = a\_name\_data.key\_high = 0;
return;
}
tk->length = 0; /\* init \*/
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 424,430 \*\*\*\*
/\* this does all the checking \*/
if (i = check\_princ(service, instance, lifetime,
&s\_name\_data)) {
! kerb\_err\_reply(client, pkt, i, lt);
return;
}
/\* Bound requested lifetime with service and user \*/
- --- 445,453 ----
/\* this does all the checking \*/
if (i = check\_princ(service, instance, lifetime,
&s\_name\_data)) {
! kerb\_err\_reply(client, pkt, i, "check\_princ\_failed");
! a\_name\_data.key\_high = a\_name\_data.key\_low = 0;
! s\_name\_data.key\_high = s\_name\_data.key\_low = 0;
return;
}
/\* Bound requested lifetime with service and user \*/
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 497,508 \*\*\*\*
- --- 520,549 ----
k\_flags = 0; /\* various kerberos flags \*/
auth->length = 4 + strlen(pkt->dat + 3);
+ if (auth->length + 1 > MAX\_KTXT\_LEN) {
+ lt = klog(L\_KRB\_PERR,
+ "APPL request with realm length too long from %s",
+ inet\_ntoa(client\_host));
+ kerb\_err\_reply(client, pkt, RD\_AP\_INCON,
+ "realm length too long");
+ return;
+ }
+
auth->length += (int) \*(pkt->dat + auth->length) +
(int) \*(pkt->dat + auth->length + 1) + 2;
+ if (auth->length > MAX\_KTXT\_LEN) {
+ lt = klog(L\_KRB\_PERR,
+ "APPL request with funky tkt or req\_id length from %s",
+ inet\_ntoa(client\_host));
+ kerb\_err\_reply(client, pkt, RD\_AP\_INCON,
+ "funky tkt or req\_id length");
+ return;
+ }
bcopy(pkt->dat, auth->dat, auth->length);
strncpy(tktrlm, auth->dat + 3, REALM\_SZ);
+ tktrlm[REALM\_SZ-1] = '\0';
if (set\_tgtkey(tktrlm)) {
lt = klog(L\_ERR\_UNK,
"FAILED realm %s unknown. Host: %s ",
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 550,556 \*\*\*\*
kerno = check\_princ(service, instance, req\_life,
&s\_name\_data);
if (kerno) {
! kerb\_err\_reply(client, pkt, kerno, lt);
return;
}
/\* Bound requested lifetime with service and user \*/
- --- 591,597 ----
kerno = check\_princ(service, instance, req\_life,
&s\_name\_data);
if (kerno) {
! kerb\_err\_reply(client, pkt, kerno, "check\_princ failed");
return;
}
/\* Bound requested lifetime with service and user \*/
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 669,675 \*\*\*\*
static char e\_msg[128];
strcpy(e\_msg, "\nKerberos error -- ");
! strcat(e\_msg, string);
cr\_err\_reply(e\_pkt, req\_name\_ptr, req\_inst\_ptr, req\_realm\_ptr,
req\_time\_ws, err, e\_msg);
sendto(f, e\_pkt->dat, e\_pkt->length, 0, client, S\_AD\_SZ);
- --- 710,716 ----
static char e\_msg[128];
strcpy(e\_msg, "\nKerberos error -- ");
! strncat(e\_msg, string, sizeof(e\_msg) - 1 - 19);
cr\_err\_reply(e\_pkt, req\_name\_ptr, req\_inst\_ptr, req\_realm\_ptr,
req\_time\_ws, err, e\_msg);
sendto(f, e\_pkt->dat, e\_pkt->length, 0, client, S\_AD\_SZ);
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* 793,799 \*\*\*\*
kdb\_encrypt\_key(key, key, master\_key,
master\_key\_schedule, DECRYPT);
krb\_set\_key(key, 0);
! strcpy(lastrealm, r);
return (KSUCCESS);
}
- --- 834,841 ----
kdb\_encrypt\_key(key, key, master\_key,
master\_key\_schedule, DECRYPT);
krb\_set\_key(key, 0);
! strncpy(lastrealm, r, sizeof(lastrealm) - 1);
! lastrealm[sizeof(lastrealm) - 1] = '\0';
return (KSUCCESS);
}
ACKNOWLEDGEMENTS:
Thanks to Matt Power of MIT for assistance in debugging this
vulnerability.
Thanks to Assar Westerlund of SICS for information about KTH-krb4 and
Heimdal.
Thanks to Nalin Dahyabhai of Redhat for additional buffer paranoia
patches.
Thanks to Andrew Newman of Yale University for discovering the
double-free problem with the krb5-1.1.x KDC.
-----BEGIN PGP SIGNATURE-----
Version: 2.6.2
iQCVAwUBOUE+AabDgE/zdoE9AQEO3QQA1UAOcnx3tM/KYEVDpYuB0ZpGb4weQT0T
nubJKoywGcvxDZ4+F2yd/cQMehG9y0/rsb8iIJmXyeUZTF1ygerS6xvW03bUF2KM
l2sra2WeAdMK12H7J2B4Cxah3E96hhGHuZ32MYhsTUMxKH3sL7jJpfabHjwPYcY9
thdTpc1rP1U=
=WeXV
-----END PGP SIGNATURE-----


=== Content from www.cert.org_dcf6c37e_20250124_194635.html ===


search

icon-carat-right

cmu-wordmark

[Carnegie Mellon University](https://www.cmu.edu)

# [Software Engineering Institute](/)

##

1. [SEI](/)
2. [About](/about/)
3. [Divisions](/about/divisions/)
4. The CERT Division

## The CERT Division

The CERT Division is a leader in cybersecurity. We partner with government, industry, law enforcement, and academia to improve the security and resilience of computer systems and networks. We study problems that have widespread cybersecurity implications and develop advanced methods and tools to counter large-scale, sophisticated cyber threats.

* [Leadership](/about/divisions/cert/index.cfm#leadership)
* [What We Do](/about/divisions/cert/index.cfm#cert-division-what-we-do)
* [Careers in the CERT Division](/about/divisions/cert/index.cfm#careers)
* [Recent Vulnerabilities](/about/divisions/cert/index.cfm#CERTRecentlyPublishedVulnerabilityNotes)
* [Case Studies](/about/divisions/cert/index.cfm#case-studies)
* [History](/about/divisions/cert/index.cfm#history)

## Leadership

[![Gregory J. Touhill](/sei-images/images/Touhill_Greg_393_2023_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=314857)
#### [Gregory J. Touhill](/about/leadership/display.cfm?customel_datapageid_2623=314857)

Director, CERT Division

[![William Wilson](/sei-images/images/Wilson_William_324_200113_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=3871)
#### [William Wilson](/about/leadership/display.cfm?customel_datapageid_2623=3871)

Deputy Director, CERT Division

[![Chris Inacio](/sei-images/images/inacio-chris-96_2622.jpg)](/about/leadership/display.cfm?customel_datapageid_2623=494689)
#### [Chris Inacio](/about/leadership/display.cfm?customel_datapageid_2623=494689)

Chief Engineer, CERT Division

## What We Do

CERT experts are a diverse group of researchers, software engineers, security analysts, and digital intelligence specialists working together to research security vulnerabilities in software products, contribute to long-term changes in networked systems, and develop cutting-edge information and training to improve the practice of cybersecurity.

Our connection to the internationally known [Carnegie Mellon University](https://www.cmu.edu/) creates multidisciplinary collaboration opportunities and amplifies our research abilities.

#### Autonomy Security and Resilience

Develop and sustain security, resilience, and assurance best practices for the development, construction, and employment of machine learning systems.

#### [Cybersecurity Center Development](https://www.sei.cmu.edu/our-work/cybersecurity-center-development/index.cfm)

Develop measurable and repeatable practices to prepare CSIRTs and other operational security organizations.

#### [Cybersecurity Engineering](https://www.sei.cmu.edu/our-work/cybersecurity-engineering/index.cfm)

Develop methods for engineering mission-essential capabilities that balance security and resiliency with mission performance.

#### [Cyber Workforce Development](https://www.sei.cmu.edu/our-work/cyber-workforce-development/index.cfm)

Develop and maintain a well-equipped cyber workforce that is immediately able to support the cybersecurity needs of organizations.

#### [Enterprise Risk and Resilience Management](https://www.sei.cmu.edu/our-work/enterprise-risk-resilience-management/index.cfm)

Develop measurable practices and frameworks that enable organizations to measure and mitigate risks.

#### [Insider Threat](https://www.sei.cmu.edu/our-work/insider-threat/index.cfm)

Detect and mitigate the impact of insider threats and reduce their occurrence in organizations.

#### [Reverse Engineering for Malware Analysis](https://www.sei.cmu.edu/our-work/reverse-engineering-for-malware-analysis/index.cfm)

Develop tools and methods to identify and mitigate code that causes unintended effects in software systems.

#### [Situational Awareness](https://www.sei.cmu.edu/our-work/situational-awareness/index.cfm)

Analyze the cyber terrain as it evolves to characterize assets at risk, measure adversary activity, and prioritize responses to threat.

#### [Secure Development](https://www.sei.cmu.edu/our-work/secure-development/index.cfm)

Assess platforms through the analysis of source code to assure they adhere to security best practices.

#### [System and Platform Evaluation](https://www.sei.cmu.edu/our-work/projects/display.cfm?customel_datapageid_4050=21361)

Assess software, devices, systems, and platforms of unknown design or origin to find vulnerabilities and strategies for defending against possible attacks.

#### [Security Vulnerabilities](https://www.sei.cmu.edu/our-work/security-vulnerabilities/index.cfm)

Reduce exposure to known vulnerabilities in systems.

* ## Careers in the CERT Division

#### [Cyber Risk Intern](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cyber-Risk-Intern_2022294-1)

Pittsburgh, PA

#### [Senior Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Software-Engineer_2020922-1)

Pittsburgh, PA

#### [Associate Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Associate-Research-Scientist---Quantum_2021979)

Pittsburgh, PA

#### [Documentation Specialist and Content Strategist](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Documentation-Specialist-and-Content-Strategist_2022203-1)

Pittsburgh, PA

#### [Senior Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Communications-Engineer_2022179-1)

Pittsburgh, PA

#### [Senior AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-AI-Security-Researcher_2021569-1)

Pittsburgh, PA

#### [Technical Manager - Cybersecurity Assurance Team](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Technical-Manager---Cybersecurity-Assurance-Team_2022101-1)

2 Locations

#### [Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/System-Designer_2017276)

Pittsburgh, PA

#### [AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/AI-Security-Researcher_2020107)

Pittsburgh, PA

#### [Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Vulnerability-Researcher_2019726-1)

Pittsburgh, PA

#### [Senior Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Vulnerability-Researcher_2020002-1)

Pittsburgh, PA

#### [Assistant Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Assistant-Communications-Engineer_2021848-2)

Pittsburgh, PA

#### [Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Research-Scientist---Quantum_2021633-1)

Pittsburgh, PA

#### [Senior Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Research-Scientist---Quantum_2021632)

Pittsburgh, PA

#### [Cybersecurity Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cybersecurity-Engineer_2020646-1)

2 Locations

[SEE ALL SEI JOB OPENINGS](https://cmu.wd5.myworkdayjobs.com/en-US/SEI/)

## Recently Published Vulnerabilities

#### [VU#199397: Insecure Implementation of Tunneling Protocols (GRE/IPIP/4in6/6in4)](https://kb.cert.org/vuls/id/199397)

###### January 17, 2025

#### [VU#952657: Rsync contains six vulnerabilities](https://kb.cert.org/vuls/id/952657)

###### January 14, 2025

#### [VU#529659: Howyar Reloader UEFI bootloader vulnerable to unsigned software execution](https://kb.cert.org/vuls/id/529659)

###### January 14, 2025

[More Vulnerabilities](https://www.kb.cert.org/vuls)
[Report a Vulnerability](https://www.kb.cert.org/vuls/report/)

## Case Studies

[![Cyber Lightning Case Study](/sei-images/images/thumb_mid_thumb_cyber-lightning_380x380_1_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)
#### [Cyber Lightning Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

The SEI hosted Cyber Lightning, a three-day joint training exercise involving Air National Guard and Air Force Reserve units from western Pennsylvania and eastern Ohio.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

[![SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/sei-images/images/thumb_mid_thumb_crisis-simulation_380x380_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)
#### [SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

In SEI crisis simulation exercises, participants use scenarios that present fictitious malicious actors and environmental factors based on real-world events.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

[![USPS Case Study](/sei-images/images/thumb_standard_thumb_usps-improves-its-cybersecurity-and-resilience_260x260_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)
#### [USPS Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

The SEI teamed with the U.S. Postal Service to help it improve its cybersecurity and resilience and collaborated on a program to develop a strong cybersecurity workforce.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

## History

The CERT Division is the birthplace of cybersecurity. For nearly 30 years, the CERT Division of the SEI has partnered with government, industry, law enforcement, and academia to advance cybersecurity and improve the security and resilience of computer systems and networks.

Originally focused on incident response, we have expanded into cybersecurity areas such as network situational awareness, malicious code analysis, secure coding, resilience management, insider threats, digital investigations and intelligence, workforce development, DevOps, forensics, software assurance, vulnerability discovery and analysis, and risk management.

     ![The CERT Division - Barbara Fraser and Ed DeHart](/sei-images/images/about-divisions-cert-history-aside-144-2_2134.jpg "The CERT Division - Barbara Fraser and Ed DeHart")   Barbara Fraser and Ed DeHart, part of the SEI’s CERT/CC in the early 1990s

## Former Director Richard Pethia

[Richard Pethia](/about/leadership/display.cfm?customel_datapageid_2623=3545) was founding director of the SEI's CERT Division. Pethia, who served as director of CERT from 1988 to 2016, guided the organization through tremendous growth and change. Under Pethia's leadership, the unit expanded and evolved from the CERT Coordination Center—a small group focused on computer incident response—to a research organization of more than 200 professionals dedicated to solving problems with widespread cybersecurity implications.

[SEE FULL PROFILE](/about/leadership/display.cfm?customel_datapageid_2623=3545)

     ![Former Director Richard Pethia](/sei-images/images/about-divisions-cert-pethia-aside-144-2_2159.jpg "Former Director Richard Pethia")

## Related Links

* [CERT Podcast Series](http://www.cert.org/podcasts/index.cfm)
* [CERT/CC Blog Series](http://insights.sei.cmu.edu/cert)
* [Computer Security Incident Response Teams](/education-outreach/computer-security-incident-response-teams/index.cfm)

* [FloCon](https://resources.sei.cmu.edu/news-events/events/flocon)
* [Insider Threat Blog Series](https://insights.sei.cmu.edu/insider-threat)
* [Insider Threat Symposium](https://www.eventbrite.com/e/2017-cert-insider-threat-symposium-registration-31893497309)

* [NatCSIRT Meeting](https://resources.sei.cmu.edu/news-events/events/natcsirt/index.cfm)
* [Vulnerability Database](https://www.kb.cert.org/vuls)

[Report a Vulnerability to CERT/CC](https://www.kb.cert.org/vuls/report/)
[Subscribe to SEI Bulletin](/subscribe-to-sei-bulletin/)
[Request Permission to Use SEI Materials](/legal/request-permission-to-use-sei-material)

Carnegie Mellon University
 Software Engineering Institute
 4500 Fifth Avenue
 Pittsburgh, PA 15213-2612
 412-268-5800

 [  [Facebook](https://www.facebook.com/SEICMU/)  |  [Twitter](https://twitter.com/SEI_CMU)  |  [LinkedIn](https://www.linkedin.com/company/software-engineering-institute)  |  [YouTube](https://www.youtube.com/user/TheSEICMU)  |  [iTunes](https://itunes.apple.com/us/podcast/software-engineering-institute-sei-podcast-series/id566573552?mt=2)  ]

[Contact Us](/contact-us/)

 [  [Office Locations](/locations/index.cfm)  |  [Additional Sites Directory](/additional-sites-directory/index.cfm)  |  [Legal](/legal/index.cfm)  |  [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm)  |  [CMU Ethics Hotline](https://www.cmu.edu/hr/resources/ethics-hotline.html)  |  [www.sei.cmu.edu](/index.cfm)  ]

©2025 Carnegie Mellon University



=== Content from www.redhat.com_df1b23ab_20250124_194636.html ===

[Skip to content](#rhb-main-content)
## Featured links

* [![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)](https://www.redhat.com/en/summit)
* [Support](https://access.redhat.com/)
* [Documentation](https://docs.redhat.com/en)
* [Console](https://cloud.redhat.com/)
* [Developers](https://developers.redhat.com/)
* [Start a trial](/en/products/trials)
* All Red Hat
  + For customers
    - [Customer support](https://access.redhat.com/)
    - [Subscription management](https://access.redhat.com/management)
    - [Support cases](https://access.redhat.com/support/cases)
    - [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
    - [Find a partner](https://catalog.redhat.com/partners)
  + For partners
    - [Partner portal](https://connect.redhat.com/partner-admin/dashboard)
    - [Partner support](https://connect.redhat.com/en/support)
    - [Become a partner](https://connect.redhat.com/)
  + Try, buy, & sell
    - [Red Hat Marketplace](https://marketplace.redhat.com/en-us)
    - [Red Hat Store](https://www.redhat.com/en/store)
    - [Contact sales](/en/contact)
    - [Start a trial](/en/products/trials)
  + Learning resources
    - [Documentation](https://docs.redhat.com/en)
    - [Training and certification](/en/services/training-and-certification)
    - [Hybrid cloud learning hub](https://cloud.redhat.com/learn)
    - [Interactive labs](/en/interactive-labs)
    - [Learning community](https://learn.redhat.com/)
    - [Red Hat TV](https://tv.redhat.com)
  + Open source communities
    - [Global advocacy](https://access.redhat.com/accelerators)
    - [How we contribute](/en/about/our-community-contributions)
[Red Hat](/en)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* Explore more
### Platform products

* [Red Hat Enterprise LinuxA flexible, stable operating system to support hybrid cloud innovation.](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShiftA container platform to build, modernize, and deploy applications at scale.](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation PlatformNew versionA foundation for implementing enterprise-wide automation.](/en/technologies/management/ansible)
### Try & buy

* [Start a trialAssess a product with a no-cost trial.](/en/products/trials)
* [Buy onlineBuy select products and services in the Red Hat Store.](https://www.redhat.com/en/store)
* [Integrate with major cloud providersBuy Red Hat solutions using committed spend from providers, including:
  ![Cloud providers: Amazon Web Services, Microsoft Azure, and Google Cloud](https://www.redhat.com/rhdc/managed-files/cloud-providers-2x.png)](/en/partners/certified-cloud-and-service-providers)
### Featured

* [Red Hat Enterprise Linux AI](/en/technologies/linux-platforms/enterprise-linux/ai)
* [Red Hat OpenShift AI](/en/technologies/cloud-computing/openshift/openshift-ai)
* [Red Hat OpenShift Virtualization](/en/technologies/cloud-computing/openshift/virtualization)
* [Red Hat OpenShift Service on AWS](/en/technologies/cloud-computing/openshift/aws)
* [Microsoft Azure Red Hat OpenShift](/en/technologies/cloud-computing/openshift/azure)
[See all products](/en/technologies/all-products)

* [Application platformSimplify the way you build, deploy, manage, and secure apps across the hybrid cloud.](/en/solutions/application-platform)
* [Artificial intelligenceBuild, deploy, and monitor AI models and apps with Red Hat's open source platforms.](/en/solutions/ai)
* [Edge computingDeploy workloads closer to the source with security-focused edge technology.](/en/products/edge)

* [IT automationUnite disparate tech, teams, and environments with 1 comprehensive automation platform.](/en/solutions/it-automation)
* [Linux standardizationGet consistency across operating environments with an open, flexible infrastructure.](/en/solutions/linux-standardization)

* [SecurityDeliver software using trusted platforms and real-time security scanning and remediation.](/en/solutions/trusted-software-supply-chain)
* [VirtualizationModernize operations using a single platform for virtualized and containerized workloads.](/en/solutions/virtualization)
### By industry

* [Automotive](/en/solutions/automotive)
* [Financial services](/en/solutions/financial-services)
* [Healthcare](/en/solutions/healthcare)
* [Industrial sector](/en/solutions/industrial-sector)
* [Media and entertainment](/en/solutions/media-entertainment)
* [Public sector](/en/solutions/public-sector)
* [Telecommunications](/en/solutions/telecommunications)
[Explore solutions](/en/solutions)
### [Services](/en/services)

* [Consulting](/en/services/consulting)
* [Services for AI](/en/services/consulting/red-hat-consulting-for-ai)
* [Technical Account Management](/en/services/support/technical-account-management)
### [Training & certification](/en/services/training-and-certification)

* [All courses and exams](/en/services/training/all-courses-exams)
* [All certifications](/en/services/certifications)
* [Verify a certification](https://www.redhat.com/rhtapps/services/verify/)
* [Skills assessment](https://skills.ole.redhat.com)
* [Learning subscription](/en/services/training/learning-subscription)
* [Learning community](https://learn.redhat.com/)
* [Red Hat Academy](/en/services/training/red-hat-academy)
* [FAQs](/en/services/training-and-certification/faq)
* [Connect with learning experts](/en/services/training-and-certification/contact-us)
### Featured

* [Ansible Basics: Automation Technical Overview (No cost)](/en/services/training/do007-ansible-essentials-simplicity-automation-technical-overview)
* [Containers, Kubernetes and Red Hat OpenShift Technical Overview (No cost)](/en/services/training/do080-deploying-containerized-applications-technical-overview)
* [Red Hat Enterprise Linux Technical Overview (No cost)](/en/services/training/rh024-red-hat-linux-technical-overview)
* [Red Hat Certified System Administrator exam](/en/services/training/ex200-red-hat-certified-system-administrator-rhcsa-exam)
* [Red Hat System Administration I](/en/services/training/rh124-red-hat-system-administration-i)
[Explore services](/en/services)
### Topics

* [AI](/en/topics/ai)
* [Application modernization](/en/topics/application-modernization)
* [Automation](/en/topics/automation)
* [Cloud computing](/en/topics/cloud-computing)
* [Cloud-native applications](/en/topics/cloud-native-apps)
* [Containers](/en/topics/containers)
* [DevOps](/en/topics/devops)
* [Edge computing](/en/topics/edge-computing)
* [Linux](/en/topics/linux)
* [Virtualization](/en/topics/virtualization)
* [See all topics](/en/topics)
### Articles

* [What is InstructLab?](/en/topics/ai/what-is-instructlab)
* [What are cloud services?](/en/topics/cloud-computing/what-are-cloud-services)
* [What is edge computing?](/en/topics/edge-computing/what-is-edge-computing)
* [What is hybrid cloud?](/en/topics/cloud-computing/what-is-hybrid-cloud)
* [Why build a Red Hat cloud?](/en/topics/cloud-computing/why-choose-red-hat-cloud)
* [Cloud vs. edge](/en/topics/cloud-computing/cloud-vs-edge)
* [Red Hat OpenShift vs. Kubernetes](/en/technologies/cloud-computing/openshift/red-hat-openshift-kubernetes)
* [Learning Ansible basics](/en/topics/automation/learning-ansible-tutorial)
* [What is Linux?](/en/topics/linux/what-is-linux)
### More to explore

* [Blog](/en/blog)
* [Customer success stories](/en/success-stories)
* [Events and webinars](/en/events)
* [Newsroom](/en/about/newsroom)
* [Podcasts and video series](/en/red-hat-original-series)
* [Documentation](https://docs.redhat.com/en)
* [Resource library](/en/resources)
* [Training and certification](/en/services/training-and-certification)
[Explore resources](/en/resources)
### For customers

* [Our partners](/en/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
### For partners

* [Partner Connect](https://connect.redhat.com)
* [Become a partner](https://connect.redhat.com/en/benefits-of-being-a-partner)
* [Training](https://connect.redhat.com/en/training)
* [Support](https://connect.redhat.com/en/support)
* [Access the partner portal](https://connect.redhat.com/partner-admin/dashboard)
### About us

* [Our company](/en/about/company)
* [How we work](/en/about/our-culture)
* [Our social impact](/en/about/community-social-responsibility)
* [Development model](/en/about/development-model)
* [Subscription model](/en/about/value-of-Red-Hat)
* [Product support](/en/services/support)
### Open source

* [Open source commitments](/en/about/open-source)
* [How we contribute](/en/about/our-community-contributions)
* [Red Hat on GitHub](https://github.com/RedHatOfficial)
### Company details

* [Analyst relations](/en/about/analysts)
* [Blog](/en/blog)
* [Locations](/en/about/office-locations)
* [Newsroom](/en/about/newsroom)
[Explore Red Hat](/en/about)[Contact us](/en/contact)For customers

* [Customer support](https://access.redhat.com/)* [Subscription management](https://access.redhat.com/management)* [Support cases](https://access.redhat.com/support/cases)* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)* [Find a partner](https://catalog.redhat.com/partners)
For partners

* [Partner portal](https://connect.redhat.com/partner-admin/dashboard)* [Partner support](https://connect.redhat.com/en/support)* [Become a partner](https://connect.redhat.com/)
Try, buy, & sell

* [Red Hat Marketplace](https://marketplace.redhat.com/en-us)* [Red Hat Store](https://www.redhat.com/en/store)* [Contact sales](/en/contact)* [Start a trial](/en/products/trials)
Learning resources

* [Documentation](https://docs.redhat.com/en)* [Training and certification](/en/services/training-and-certification) * [Hybrid cloud learning hub](https://cloud.redhat.com/learn)* [Interactive labs](/en/interactive-labs)* [Learning community](https://learn.redhat.com/)* [Red Hat TV](https://tv.redhat.com)
Open source communities

* [Global advocacy](https://access.redhat.com/accelerators)* [How we contribute](/en/about/our-community-contributions)
For you
New
### Recommendations

As you browse redhat.com, we'll recommend resources you may like. For now, try these.

---

* [All Red Hat products](/en/technologies/all-products)
* [Tech topics](/en/topics)
* [Red Hat resources](/en/resources)
![close](https://static.redhat.com/libs/redhat/rh-iconfont/latest/svg/web-icon-close.svg)[![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)Red Hat Summit](https://www.redhat.com/en/summit)[Support](https://access.redhat.com/)[Documentation](https://docs.redhat.com/en)[Console](https://cloud.redhat.com/)[Developers](https://developers.redhat.com/)[Start a trial](/en/products/trials)[Contact](/en/contact)Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol[Contact us](/en/contact)
English
### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol![](/themes/custom/rh_base_ui/dist/img/talk-bubble.svg)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* [Contact us](/en/contact)

### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)

# Red Hat Support

## Go beyond support by engaging with our experts

Our teams collaborate with you to ensure you accomplish your goals with Red Hat solutions. The relationship we build with you is designed to provide you with the tools and resources you need to find success on your IT journey.

![](/rhdc/managed-files/support-header.svg)

## Configured for your success

We develop a holistic understanding of your experience as a customer by ensuring our support and engineering teams work together.

Our support team works hand in hand with the best engineers in the industry to quickly turn customer feedback into product improvements. This direct line of communication allows us to hone in on proactive fixes that can impact your bottom line.

### Quick links

* Search our [Knowledgebase](https://access.redhat.com/search/#/?q=&p=1&sort=relevant&scoped&documentKind=Knowledgebase)
* Find [product documentation](https://access.redhat.com/documentation/en-us/)
* Access the [product security center](https://access.redhat.com/security/)
* Connect with [our support team](https://access.redhat.com/support)
* Team up with a [technical account manager](/en/services/support/technical-account-management "Technical account management")
* Take advantage of [partner support](https://connect.redhat.com/en/support)

## Find the right level of support

We have different tiers of support designed to meet your unique needs.

|  | Self-support | Standard | Premium |
| --- | --- | --- | --- |
| Access to Red Hat products | checkmark | checkmark | checkmark |
| Access to our knowledgebase and tools in our award-winning Customer Portal | checkmark | checkmark | checkmark |
| Access to support engineers during standard business hours |  | checkmark | checkmark |
| Access to support engineers 24x7 for high-severity issues |  |  | checkmark |

We also feature specialized support options that can be tailored to the unique needs of companies of all sizes and industries. The Red Hat® [Enhanced Solution Support](/en/resources/enhanced-solution-support-datasheet "Red Hat Enhanced Solution Support: 24x7 engineering support") offering reduces downtime and boosts confidence through access to senior level engineers, as well as resolution and restoration SLAs—helping you stay up and running as you innovate, scale, and deploy. Our engineers help restore your operations quickly and accelerate the path to final resolution, identifying the root cause which helps protect against recurrences in the future. Enhanced Solution Support engineers, who are already familiar with your environment, will be there to assist with critical issues in production environments so that you can consistently deliver the cloud services your customers demand. This offering is available for Red Hat OpenShift® and Red Hat OpenStack® Platform customers.

### Personalized support

Connect with a technical adviser for collaborative planning and specialized guidance. Our Technical Account Managers help you streamline deployments, resolve issues, and shape your technology strategy to meet your toughest business challenges.

[Explore Technical Account Management](/en/services/support/technical-account-management)

## Award winners since 2011

We’ve evolved the traditional software subscription model, combining the best elements of our services to exceed customer expectations. The Association of Support Professionals has honored Red Hat’s Customer Portal as one of “The Top Ten Best Support Websites” for 13 years running.

[See why the Customer Portal keeps earning industry recognition](https://access.redhat.com/)

![Gold and green star with text ASP best support websites of 2023](/rhdc/managed-files/ASP-Award-Design.jpg)

## What they're saying

![BSE logo](/rhdc/managed-files/bse-logo-2.png)

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> We have found the support from Red Hat to be exemplary. Whenever we need anything from them, they have given it … Red Hat is now our backbone. Our business cannot run if Red Hat is not there.
>
> Ashishkumar Chauhan
>
> CEO, BSE

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> I like the fact that they really dig into things and then provide answers. As the single Linux guy, I kind of need that second admin next to me sometimes to say, "Hey, what about this?" and I am able to do that through the portal. I get my questions answered and trouble tickets resolved.
>
> Erik Widholm
>
> Sr. Enterprise Engineer

[Read more user reviews](/en/technologies/linux-platforms/enterprise-linux/user-reviews)

## Have questions?

[Contact Support team](https://access.redhat.com/support)

[Visit the Customer Portal](https://access.redhat.com/)

[![Red Hat logo](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](/en)[LinkedIn](https://www.linkedin.com/company/red-hat)[YouTube](https://www.youtube.com/user/RedHatVideos)[Facebook](https://www.facebook.com/redhatinc)[X](https://twitter.com/RedHat)
### Products

* [Red Hat Enterprise Linux](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShift](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation Platform](/en/technologies/management/ansible)
* [Cloud services](/en/technologies/cloud-computing/openshift/cloud-services)
* [See all products](/en/technologies/all-products)

### Tools

* [Training and certification](/en/services/training-and-certification)
* [My account](https://www.redhat.com/wapps/ugc/protected/personalInfo.html)
* [Customer support](https://access.redhat.com)
* [Developer resources](https://developers.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Red Hat value calculator](/en/solutions/value-calculator)
* [Documentation](https://docs.redhat.com/en)

### Try, buy, & sell

* [Product trial center](/en/products/trials)
* [Red Hat Marketplace](https://marketplace.redhat.com)
* [Red Hat Store](https://www.redhat.com/en/store)
* [Buy online (Japan)](https://www.redhat.com/en/about/japan-buy)
* [Console](https://cloud.redhat.com/)

### Communicate

* [Contact sales](/en/contact/sales)
* [Contact customer service](/en/contact/customer-service)
* [Contact training](/en/services/training-and-certification/contact-us)
* [Social](/en/about/social)

### About Red Hat

We’re the world’s leading provider of enterprise open source solutions—including Linux, cloud, container, and Kubernetes. We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.

### Select a language

![](https://static.redhat.com/libs/redhat/rh-iconfont/4/svg/web-icon-globe.svg)

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
### Red Hat legal and privacy links

* [About Red Hat](/en/about/company)
* [Jobs](/en/jobs)
* [Events](/en/events)
* [Locations](/en/about/office-locations)
* [Contact Red Hat](/en/contact)
* [Red Hat Blog](/en/blog)
* [Diversity, equity, and inclusion](/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](/en/about/privacy-policy)
* [Terms of use](/en/about/terms-use)
* [All policies and guidelines](/en/about/all-policies-guidelines)
* [Digital accessibility](/en/about/digital-accessibility)


