=== Content from marc.info_b0d20066_20250125_210016.html ===

```
[[prev in list](?l=ntbugtraq&m=94881732023125&w=2)] [[next in list](?l=ntbugtraq&m=94881904824737&w=2)] [prev in thread] [[next in thread](?l=firewall-wizards&m=94913961827376&w=2)]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    [Strange behaviour IIS and RegExp](?t=94885023200024&r=1&w=2)
From:       [valentijn <valentijn () my ! net>](?a=94881914000007&r=1&w=2)
Date:       [2000-01-21 15:08:28](?l=ntbugtraq&r=1&w=2&b=200001)
[Download RAW [message](?l=ntbugtraq&m=94881904724731&q=mbox) or [body](?l=ntbugtraq&m=94881904724731&q=raw)]

Hai there!

The issue:
Crashing IIS using ordinary vbscript in an ASP page. Using Regular
expressions one can filter eg the contents of an HTML page. In this case i
was planning to filter some words. But some servers crashed on a not valid
regular expression when i pressed F5 in VID.

<%
Set fso = createobject("scripting.filesystemobject")
        Checkfile = server.MapPath("\") & "\index\mypage.html"
        mystring = fso.OpenTextFile ((checkfile)).ReadAll

        set myregexp = new regexp

        myregexp.Global = TRUE
        myregexp.IgnoreCase = true
        ' Normal regular expresion
        'myregexp.Pattern = "[A-Z0-9\.\-\_\ ]+"
        ' A not valid expression
        myregexp.Pattern = ".*"
        set mymatches =myregexp.Execute (mystring)

        for each thing in mymatches
                Response.Write thing
        next
%>

Results:
Winnt 4.0 Ent. sp5 IIS: (In the browser) a trappable error occured _or_ no
data is returned aka: normal reaction on invalid expression
Winnt 4.0 Ent. sp6 IIS: Inetinfo.exe crashes without any notice
Winnt 4.0 Ent. sp6a IIS:  Inetinfo.exe dies eventlog message:

An object call caused an exception.
(IID: {51372AEF-CAE7-11CF-BE81-00AA00A2FA25})
(Method: 3)
(Microsoft Transaction Server Internals Information: File:
i:\viper\src\runtime\mtxex\activity.cpp, Line: 889)
(Exception: C0000005)
(Address: 0x780015cc)
MSVCRT!wcslen + 0x4
vbscript + 0x2E4FB
vbscript + 0x1603

Access violation? No doc's in MS support database regarding Regexp or
i:\viper\src\runtime

Can anyone reproduce this?

Regards,

Valentijn Siebrands
Iam@my.net

[[prev in list](?l=ntbugtraq&m=94881732023125&w=2)] [[next in list](?l=ntbugtraq&m=94881904824737&w=2)] [prev in thread] [[next in thread](?l=firewall-wizards&m=94913961827376&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


