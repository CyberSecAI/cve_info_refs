```
{
  "vulnerability_details": {
    "root_cause": "Firewalls and other systems that inspect FTP application layer traffic may not adequately maintain the state of FTP commands and responses.",
    "weaknesses": [
      "Inadequate state management of FTP commands and responses in firewalls.",
      "Vulnerable firewalls create dynamic rules without assuring that the PASV response string is part of a legitimate FTP connection.",
      "Some FTP servers do not pad 3-digit numbers within multi-line responses, exacerbating the problem."
    ],
    "impact": "A remote attacker can establish arbitrary TCP connections to FTP servers or clients located behind a vulnerable firewall, potentially exposing other network services to attack.",
    "attack_vectors": [
      "An attacker logs in to an FTP server behind a vulnerable firewall and issues a command that echoes its arguments back (e.g., NLST).",
      "The attacker includes a crafted PASV response string as the argument.",
      "The attacker spoofs the IP address and uses a separate TCP/IP stack to send specially crafted TCP packets to acknowledge the echoed response up to the start of the PASV response.",
       "If the FTP server's OS supports partial acknowledgement of TCP data segments, it will re-send the unacknowledged data, including the PASV response.",
        "The vulnerable firewall sees the PASV response and creates a rule allowing the client to connect to the specified port on the FTP server."
    ],
    "attacker_capabilities": "The attacker needs to log in to an FTP server behind a vulnerable firewall and have the ability to manipulate TCP packets."
  }
}
```