=== Content from docs.microsoft.com_297c194b_20250125_143914.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2000/ms00-052.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS00-052 - Critical

## Patch Available for 'Relative Shell Path' Vulnerability

Published: July 28, 2000

**Version:** 1.0

**Originally posted:** July 28, 2000

#### Summary

Microsoft has released a patch that eliminates a security vulnerability in MicrosoftÂ® Windows NTÂ® 4.0 and WindowsÂ® 2000. Under certain conditions, the vulnerability could enable a malicious user to cause code of his choice to run when another user subsequently logged onto the same machine.

**Affected Software:**

* Microsoft Windows NT 4.0 Workstation
* Microsoft Windows NT 4.0 Server
* Microsoft Windows NT 4.0 Server, Enterprise Edition
* Microsoft Windows NT 4.0 Server, Terminal Server Edition
* Microsoft Windows 2000 Professional
* Microsoft Windows 2000 Server
* Microsoft Windows 2000 Advanced Server

**Vulnerability Identifier:** [CVE-2000-0663](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2000-0663)

### General Information

## Technical details

**Technical description:**

The registry entry that specifies the Windows Shell executable (Explorer.exe) provides a relative, rather than absolute, path name. (As discussed in the FAQ, it does this because of legacy application compatibility concerns). Because of the circumstances in place at system startup time, the normal search order would cause any file named Explorer.exe in the %Systemdrive%\ directory to be loaded in place of the bona fide version. This could provide an opportunity for a malicious user to cause code of his choice to run when another user subsequently logged onto the same machine.

Under normal conditions, the malicious user could only exploit this vulnerability on machines that he could interactively log onto. As a result, workstations and terminal servers would be the machines primarily at risk. If standard security recommendations have been followed, normal users will not be given permission to interactively log onto security-critical machines such as domain controllers, print/file servers, ERP servers, web servers, and so forth.

## Frequently asked questions

**What's this bulletin about?**

Microsoft Security Bulletin [MS00-052](https://technet.microsoft.com/security/bulletin/ms00-052) announces the availability of a patch that eliminates a vulnerability in MicrosoftÂ® Windows NTÂ® 4.0 and WindowsÂ® 2000. Microsoft is committed to protecting customers' information,and is providing the bulletin to inform customers of the vulnerability and what they can do about it.

**What's the scope of the vulnerability?**

This vulnerability would enable a malicious user to substitute code of his choice for the normal Windows desktop on machines that he can [interactively log onto](https://technet.microsoft.com/security/bulletin/glossary). Such code would run automatically whenever a user subsequently logged onto the same machine, and could take any action the user had privileges to take on the machine.
Workstations and terminal servers would be the machines primarily affected by this vulnerability. If normal security precautions are followed, security-critical servers such as print and file server, domain controllers, ERP servers, and others will not allow normal users to interactively log onto them.

**What causes the vulnerability?**

The vulnerability results because the name of the executable that provides the Windows Shell functionality is specified by a relative, rather than absolute, path in the registry key that Windows consults during startup. If a bogus version of the Windows Shell were placed in a location that is ahead of the bona fide version in the search order, the bogus version would be loaded upon system startup.

**What's the Windows Shell?**

The Windows Shell is the familiar desktop that's used for interacting with Windows. During system startup, Windows NT 4.0 and Windows 2000 consult the "Shell" registry entry, HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell, to determine the name of the executable that should be loaded as the Shell. By default, this value specifies Explorer.exe.

**Is this a problem with Explorer.exe?**

No. The vulnerability has nothing to do with Explorer.exe per se. Instead, it results because the default value for the Shell registry entry specifies Explorer.exe via a relative rather than absolute path. That is, it's specified as "Explorer.exe" rather than "%systemroot%\Explorer.exe".

**Why is it a problem to specify Explorer.exe via a relative path name rather than an absolute one?**

The problem has to do with the search order that occurs when system startup is in process. Whenever a registry entry specifies the name of a code module, but does it using a relative path, Windows initiates a search process to find the code. The search order is as follows:

1. Search the current directory
2. If the code isn't found, search the directories specified in HKEY\_LOCAL\_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment\Path, in the order in which they are specified.
3. If the code isn't found, search the directories specified in HKEY\_CURRENT\_USER\Environment\Path, in the order in which they are specified.

The default settings for HKEY\_LOCAL\_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment\Path and HKEY\_CURRENT\_USER\Environment\Path are
"%SystemRoot%\System32;%SystemRoot %" and null, respectively. Because the current directory during system startup is %SystemDrive%\, the resulting search path would be:

1. %SystemDrive%\ (e.g., C:\)
2. %SystemRoot%\System32 (e.g., C:\WINNT\System32)
3. %SystemRoot% (e.g., C:\WINNT)

The vulnerability results because the default permissions on %SystemDrive%\ allow all interactive users to write to it. Thus, on a machine that boots from the C: drive, if a malicious user placed a bogus Explorer.exe into C:\, the search order would cause it, rather than the bona fide Explorer.exe, to be loaded and executed each time a user on the machine logged on.

**Why isn't Explorer.exe specified by an absolute path name in the Shell registry value?**

Under normal conditions, it would be. Microsoft has long recommended whenever a registry entry provides the location of an executable file, it should specify the file via an absolute path.
The reason this was not done in the particular case of the Shell registry value is because of compatibility concerns with legacy applications. Many applications, especially older ones, consult the Shell value during installation in order to determine the name of the shell in effect. Some of these applications are coded to handle only the case where a file name and extension are provided, and would stop working if an absolute path were included in the value. That's why, alone among Microsoft-provided registry values, the Shell value uses a relative path.

**What could a bogus Explorer.exe do?**

The code could do anything the user was authorized to do on the computer. If a user with few privileges logged on, the code might be able to do very little. On the other hand, if a user with significant privileges on the machine or on the domain logged onto it, the code might be able to cause significant harm. It's worth pointing out that standard security recommendations advise highly-privileged users such as domain administrators against using untrusted machines.

**Could the user prevent the bogus code from running?**

No. The Shell code is run as part of system startup, so the user would not have an opportunity to prevent it from running.

**Could this vulnerability be exploited accidentally?**

No. It would require a specific set of steps that are unlikely to be carried out by accident.

**Could this vulnerability exploited remotely?**

No. Under default conditions, this vulnerability could only be exploited if the malicious user had the ability to log onto the machine interactively, that is, log on at the keyboard. The only case in which this vulnerability could be remotely exploited would be one in which an administrator on the machine had shared the root directory of the machine to the malicious user, and given him write privileges to it.

**What machines are at greatest risk from this vulnerability?**

The most important point to keep in mind is that, as discussed above, the malicious user could only exploit this vulnerability on machines he could log onto interactively. As a result, machines that allow normal users to log on interactively, such as workstations and terminal servers, would be at greatest risk.
Standard security recommendations strongly militate against ever allowing normal users to interactively log onto security-critical machines like domain controllers, print/file servers, ERP servers, database servers and the like. If this guidance has been followed, these machines would not be at risk.

**Who should use the patch?**

Microsoft recommends that customers consider installing the patch on any machine that allows normal users to log on interactively, and on any machine on which the root directory is globally shared.

**What does the patch do?**

It isn't feasible to correct the situation by using an absolute path name in the "Shell" registry entry, because of the application compatibility concerns discussed above. The patch eliminates the vulnerability by introducing a special case into the startup code, that prepends %systemroot% before the value specified in the "Shell" entry.

**Where can I get the patch?**

The download location for the patch is provided in the "Patch Availability" section of the [security bulletin](https://technet.microsoft.com/security/bulletin/ms00-052).

**How do I use the patch?**

The Knowledge Base article [Q269049](https://support.microsoft.com/default.aspx?scid=kb;en-us;269049&sd;=tech) contains detailed instructions for applying the patch.

**How can I tell if I installed the patch correctly?**

The Knowledge Base article [Q269049](https://support.microsoft.com/default.aspx?scid=kb;en-us;269049&sd;=tech) provides a manifest of the files in the patch package. The easiest way to verify that you've installed the patch correctly is to verify that these files are present on your computer, and have the same sizes and creation dates as shown in the KB article.

**What is Microsoft doing about this issue?**

* Microsoft has delivered a patch that eliminates the vulnerability.
* Microsoft has provided a [security bulletin](https://technet.microsoft.com/security/bulletin/ms00-052)and this FAQ to provide customers with a detailed understanding of the vulnerability and the procedure to eliminate it.
* Microsoft has sent copies of the security bulletin to all subscribers to the [Microsoft Product Security Notification Service](https://technet.microsoft.com/security/bulletin/notify), a free e-mail service that customers can use to stay up to date with Microsoft security bulletins.
* Microsoft has issued a Knowledge Base article [Q269049](https://support.microsoft.com/default.aspx?scid=kb;en-us;269049&sd;=tech) explaining the vulnerability and procedure in more detail.

**Where can I learn more about best practices for security?**

The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) web site is the best to place to get information about Microsoft security.

**How do I get technical support on this issue?**

[Microsoft Product Support Services](https://support.microsoft.com/contactussupport/?ws=support) can provide assistance with this or any other product support issue.

## Patch availability

**Download locations for this patch**

* Microsoft Windows NT 4.0 Workstation, Windows NT 4.0 Server, and Windows NT 4.0 Server, Enterprise Edition:

  [https://www.microsoft.com/download/details.aspx?FamilyId=2055A234-6CFD-46ED-879B-F8A742EE1345&displaylang;=en](https://www.microsoft.com/download/details.aspx?familyid=2055a234-6cfd-46ed-879b-f8a742ee1345&displaylang;=en)
* Microsoft Windows NT 4.0 Server, Terminal Server Edition:

  [https://www.microsoft.com/download/details.aspx?FamilyId=17BEAB3E-6F3D-4B35-82E6-684AFD9AE529&displaylang;=en](https://www.microsoft.com/download/details.aspx?familyid=17beab3e-6f3d-4b35-82e6-684afd9ae529&displaylang;=en)
* Microsoft Windows 2000 Professional, Server, and Advanced Server: [https://www.microsoft.com/download/details.aspx?FamilyId=C9CB67CD-E52E-4937-A82A-9C8FC0B2D581&displaylang;=en](https://www.microsoft.com/download/details.aspx?familyid=c9cb67cd-e52e-4937-a82a-9c8fc0b2d581&displaylang;=en)

#### Additional information about this patch

**Installation platforms:** Please see the following references for more information related to this issue.

* Microsoft Knowledge Base (KB) article Q269049, [https:](https://)

#### Other information:

**Support:** This is a fully supported patch. Information on contacting Microsoft Product Support Services is available at </https:>[https:](https://).

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* July 28, 2000: Bulletin Created.

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.microsoft.com_081a2cb3_20250125_143914.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

# Microsoft Learn. Spark possibility.

Build skills that open doors. See all you can do with documentation, hands-on training, and certifications to help you get the most from Microsoft products.

Search

* ![](/en-us/media/home-and-directory/featured-training_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-training_dark.jpg?branch=live)

  Learn by doing

  Gain the skills you can apply to everyday situations through hands-on training personalized to your needs, at your own pace or with our global network of learning partners.

  [Take training](/en-us/training/)
* ![](/en-us/media/home-and-directory/featured-documentation_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-documentation_dark.jpg?branch=live)

  Find technical documentation

  Get tools and step-by-step guidance to help you get the most from Microsoft products such as Azure, Windows, Office, Dynamics, Power Apps, Teams, and more.

  [View documentation](docs/)
* ![](/en-us/media/home-and-directory/featured-cert_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-cert_dark.jpg?branch=live)

  Showcase your skills

  Advance in your career by completing challenges that demonstrate your expertise. Earn globally recognized and industry-endorsed certifications, and showcase them to your network.

  [Get certified](/en-us/certifications/)
* ![](/en-us/media/home-and-directory/featured-qna_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-qna_dark.jpg?branch=live)

  Ask questions and get help

  Connect with other learners and experts, ask and answer questions, share resources, and learn together.

  [Explore Q&A](/en-us/answers/products/)
* ![](/en-us/media/home-and-directory/featured-samples_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-samples_dark.jpg?branch=live)

  Try code samples

  Test out new capabilities in your own projects faster and easier with code samples that bring Microsoft technology to life.

  [See samples](/en-us/samples/browse/)
* ![](/en-us/media/home-and-directory/featured-shows_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-shows_dark.jpg?branch=live)

  See new ways to innovate

  Discover thousands of fun, authentic, and informative videos by Microsoft and community experts that help you and your team find inventive ways to use technology.

  [Watch shows](/en-us/shows/)

## Level up with Microsoft Learn

* 15%

  On average, certified employees earn 15 percent more than those without certification.

  [Why get certified?](/en-us/certifications/posts/microsoft-learn-why-get-certified)
* 61%

  Upon earning a certification, 61 percent of tech professionals say they earned a promotion.

  [2021 Pearson VUE Value of IT Certification](https://home.pearsonvue.com/voc)
* 90%

  Microsoft-certified developers are 90 percent more productive and nearly 60 percent more efficient.

  [Why get certified?](/en-us/certifications/posts/microsoft-learn-why-get-certified)

## Meet inspirational learners from the community

* ![Ricardo Lessa](/en-us/media/home-and-directory/avatar-Ricardo.jpg?branch=live)

  Ricardo Lessa

  Pre-sales engineer

  "I was able to believe again in the possibility of starting over, updating myself, and returning to the IT market."

  [Read Ricardo's story](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/certifications-can-spark-confidence-amidst-unexpected-changes/ba-p/2038069)
* ![Jacqueline Ye](/en-us/media/home-and-directory/avatar-Jacqueline.jpg?branch=live)

  Jacqueline Ye

  Product manager

  "I want others to know that with some hard work, dedication, and having an always be learning mindset, you can have a fullfilling career."

  [Read Jacqueline's story](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/how-microsoft-learn-advance-women-in-tech/ba-p/2038068)
* ![Charles-Henri Sauget](/en-us/media/home-and-directory/avatar-Charles-Henri.jpg?branch=live)

  Charles-Henri Sauget

  Data platform and technical leader

  "Certifications have really helped me earn my customer's trust as a consultant."

  [Read Charles-Henri's story](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/continue-staying-ahead-with-microsoft-certifications/ba-p/2038070)

![](/en-us/media/home-and-directory/section-testimonials_light.jpg?branch=live)
![](/en-us/media/home-and-directory/section-testimonials_dark.jpg?branch=live)

## Find additional resources

* [Startups](https://www.microsoft.com/startups?wt.mc_id=learn_startupmodule_webpage_cnl)

  Radically accelerate innovation with free access to industry-leading AI services, OpenAI credits, expert guidance, and the essential technology needed to build a startup through Microsoft for Startups Founders Hub.
* [Student Hub](/en-us/training/student-hub/)

  Learn technical skills to prepare you for your future. Find training, virtual events, and opportunities to connect with the Microsoft student developer community.
* [Educator Center](/en-us/training/educator-center/)

  Dive deep into learning with interactive lessons, earn professional development hours, acquire certifications and find programs that help meet your goals.
* [Microsoft Learn Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)

  Get the latest updates, articles, and news for learning content and events from the Microsoft Learn community.
* [Virtual Training Days](https://events.microsoft.com/mvtd)

  Take advantage of free Virtual Training Days, where participants of any skill level can build technical skills across a range of topics and technologies.
* [Microsoft Reactor](https://developer.microsoft.com/en-us/reactor/)

  Whether you're building your career or the next great idea, Microsoft Reactor connects you with the developers and startups that share your goals.

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


