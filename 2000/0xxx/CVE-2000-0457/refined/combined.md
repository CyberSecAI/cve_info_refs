=== Content from marc.info_964f6946_20250125_071504.html ===

```
[[prev in list](?l=bugtraq&m=95837936928300&w=2)] [[next in list](?l=bugtraq&m=95810463821517&w=2)] [[prev in thread](?l=ntbugtraq&m=95807737032066&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Alert: IIS ism.dll exposes file contents](?t=95807745800003&r=1&w=2)
From:       [Cerberus Security Team <CST () CERBERUS-INFOSEC ! CO ! UK>](?a=95309119100002&r=1&w=2)
Date:       [2000-05-11 17:27:20](?l=bugtraq&r=1&w=2&b=200005)
[Download RAW [message](?l=bugtraq&m=95810120719608&q=mbox) or [body](?l=bugtraq&m=95810120719608&q=raw)]

Cerberus Information Security Advisory (CISADV000327)
<http://www.cerberus-infosec.co.uk/advisories.html>

Released                   : 27th March 2000
Name                        : IIS ISM.DLL buffer truncation exposes files
Affected Systems       : Windows NT running IIS
Issue                          : Remote attackers can gain access to files'
contents
                                    they should not normally have access to.

Description
***********
The Cerberus Security Team has security flaw with Microsoft's Internet
Information Server 4 and 5 that allows attackers to obtain the contents of
files they should not be able to access. For example text based files (eg
.txt,.log and .ini) in the /scripts directory are not normally accessible
due to the virtual directory have only script and execute access. Using this
vulnerability it is possible to gain access to these files' contents.

Details
*******
By making a specially formed request to Internet Information Server it is
possible to obtain the contents of files. By making a request for the name
of the file and then appending around 230 + %20s (these represents spaces)
and then ".htr" this tricks Internet Information Server into thinking that
the client is requesting a ".htr" file. The .htr file extention is mapped to
the ISM.DLL ISAPI application and IIS redirects all requests for .htr
resources to this DLL.

ISM.DLL is then passed the name of the file to open and execute but before
doing this ISM.DLL truncates the buffer sent to it chopping off the .htr and
a few spaces and ends up opening the file we want to get the source of. The
contents are then returned.

This attack can only be launched once though, unless the web service is
stopped and restarted. If a .htr request has already been made to the
machine then this attack will fail. It will only work when ISM.DLL is loaded
into memory for the first time.

Solution:
*********
If you don't use the functionality provided for by ISM.DLL then it would be
best to unmap the .htr extention from ISM.DLL using the Internet Service
Manager MMC snap-in. Right click on the computer name and edit the Master
web properties. If this is not acceptable then a patch for this issue can be
obtained from Microsoft. Please see below. A check for this has been added
to Cerberus' security scanner, available from the website.

Vendor Status
*************
Microsoft were informed on the 16th of March about this issue and have
developed a patch available from
<http://www.microsoft.com/technet/security/bulletin/ms00-031.asp>

About Cerberus Information Security, Ltd
*****************************************
Cerberus Information Security, Ltd, a UK company, are specialists in
penetration testing and other security auditing services. They are the
developers of CIS (Cerberus' Internet security scanner) available for free
from their website: <http://www.cerberus-infosec.co.uk>

To ensure that the Cerberus Security Team remains one of the strongest
security audit teams available globally they continually research operating
system and popular service software vulnerabilites leading to the discovery
of "world first" issues. This not only keeps the team sharp but also helps
the industry and vendors as a whole ultimately protecting the end consumer.
As testimony to their ability and expertise one just has to look at exactly
how many major vulnerabilities have been discovered by the Cerberus Security
Team - over 70 to date, making them a clear leader of companies offering
such security services.

Founded in late 1999, by Mark and David Litchfield, Cerberus Information
Security, Ltd are located in London, UK but serves customers across the
World. For more information about Cerberus Information Security, Ltd please
visit their website or call on +44(0)208 395 4980.

Permission is hereby granted to copy or redistribute this advisory but only
in its entirety.

Copyright (C) 2000 by Cerberus Information Security, Ltd

[[prev in list](?l=bugtraq&m=95837936928300&w=2)] [[next in list](?l=bugtraq&m=95810463821517&w=2)] [[prev in thread](?l=ntbugtraq&m=95807737032066&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from docs.microsoft.com_da87f47f_20250125_071504.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2000/ms00-031.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS00-031 - Critical

## Patch Available for "Undelimited .HTR Request" and "File Fragment Reading via .HTR" Vulnerabilities

Published: May 10, 2000 | Updated: July 17, 2000

**Version:** 1.2

**Originally Posted:** May 10, 2000

**Updated:** July 17, 2000

#### Summary

Microsoft has released a patch that eliminates two security vulnerabilities in MicrosoftÂ® Internet Information Server. The vulnerabilities could, respectively, be used to slow an affected web server's response or to obtain the source code of certain types of files under very restricted conditions.

Frequently asked questions regarding this vulnerability and the patch can be found at [https://www.microsoft.com/technet/security/bulletin/fq00-031.mspx](https://technet.microsoft.com/security/bulletin/fq00-031)

### General Information

## Issue

This patch eliminates two security vulnerabilities that are unrelated except by virtue of the fact that both exist in the ISAPI extension that provides web-based password administration via .HTR scripts.

* The "Undelimited .HTR Request" vulnerability is a denial of service vulnerability. If a malicious user provided a password change request that was missing an expected delimiter, the algorithm would conduct an unbounded search. This would prevent it from servicing additional .HTR requests, and could also slow the overall response of the server.
* The ".HTR File Fragment Reading" vulnerability could allow fragments of certain types of files to be read by providing a malformed request that would cause the .HTR processing to be applied to them. However, the vulnerability could only be exploited under extremely restrictive conditions, and the most valuable data in the files would be the least likely to actually appear in the fragments sent to the user.

Neither of these vulnerabilities would allow data to be added, deleted or changed on the server, nor would they allow any administrative control on the server to be usurped. Although .HTR files are used to allow web-based password administration, neither of these vulnerabilities involve any weakness in password handling. Also, if security best practices have been followed, and unneeded script mappings have been removed, many customers will have removed the .HTR script mapping and thus be unaffected by either vulnerability.

**Affected Software Versions**

* Internet Information Server 4.0
* Internet Information Server 5.0

**Vulnerability Identifiers**

* Undelimited .HTR Request Vulnerability : [CVE-2000-0304](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2000-0304)
* .HTR File Fragment Reading Vulnerability : [CVE-2000-0457](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2000-0457)

## Patch Availability

**Download locations for this patch**

* The patches for this issue have been superseded by ones subsequently released as part of Microsoft Security Bulletin [MS01-004](https://technet.microsoft.com/security/bulletin/ms01-004).

#### More Information

Please see the following references for more information related to this issue.

* Frequently Asked Questions: Microsoft Security Bulletin MS00-031, [https://www.microsoft.com/technet/security/bulletin/fq00-031.mspx](https://technet.microsoft.com/security/bulletin/fq00-031)
* Microsoft Knowledge Base (KB) article 260838, A malformed request towards .HTR files denies other HTR requests and puts CPU at 100%, [https://support.microsoft.com/default.aspx?scid=kb;en-us;260838](https://support.microsoft.com/default.aspx?scid=kb;en-us;260838&sd;=tech)
* Microsoft Knowledge Base (KB) article 260069, Malformed HTR Request Returns Source Code for ASP Scripting Files, [https://support.microsoft.com/default.aspx?scid=kb;en-us;260069](https://support.microsoft.com/default.aspx?scid=kb;en-us;260069&sd;=tech)
* How to Change Windows NT Account Passwords Using Internet Information Server (IIS) 4.0, [https://support.microsoft.com/default.aspx?scid=kb;en-us;184619](https://support.microsoft.com/default.aspx?scid=kb;en-us;184619&sd;=tech)
* Microsoft TechNet Security web site, [https:](https://)

**Obtaining Support on this Issue**

This is a fully supported patch. Information on contacting Microsoft Technical Support is available at </https:>[https:](https://).

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) Internet Security Systems' [X-force](https://xforce.iss.net/), and David Litchfield of [Cerberus Information Security, Ltd](https://www.cerberus-infosec.co.uk/), for reporting these vulnerabilities to us, and working with us to protect customers.

**Revisions**

* May 10, 2000: Bulletin Created.
* June 16, 2000: Release ID for IIS 5.0 version of patch updated.
* July 17, 2000: Release IDs updated to reflect availability of a fix for these issues via a subsequently released patch.

THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND. MICROSOFT DISCLAIMS ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL, CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. SOME STATES DO NOT ALLOW THE EXCLUSION OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES SO THE FOREGOING LIMITATION MAY NOT APPLY.

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


