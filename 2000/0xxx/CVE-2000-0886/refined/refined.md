- **Root cause of vulnerability:** A flaw in how IIS parses file requests. Specifically, when IIS receives a request for an executable file (like .bat or .cmd), it passes the filename to the OS for processing. However, a malformed request can include not just the filename but also OS commands, which IIS would then pass to the OS for execution.

- **Weaknesses/vulnerabilities present:**
    - Improper input validation: IIS doesn't properly sanitize or validate file requests, allowing for OS commands to be injected in the request.
    - OS command injection: The vulnerability allows for the execution of arbitrary operating system commands on the server.

- **Impact of exploitation:**
    - Arbitrary code execution: Attackers could run OS commands with the privileges of the IIS anonymous user account (typically IUSR\_machinename), potentially causing widespread damage.
    - Data modification: Ability to modify web pages, add, change or delete files.
    - System compromise: Could potentially reformat hard drives, upload and run malicious code.
    - Privilege escalation: While not directly granting administrative control, this access could be used as a foothold to attempt further privilege escalation.

- **Attack vectors:**
    - Malicious file request: Sending specially crafted HTTP requests to the IIS web server, including a file name (.bat or .cmd) followed by OS commands.

- **Required attacker capabilities/position:**
    - Ability to send HTTP requests to the web server.
    - Knowledge of a valid .bat or .cmd file on the server.
    - Execute permissions on the targeted file.