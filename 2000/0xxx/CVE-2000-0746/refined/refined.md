- **Root cause of vulnerability**: The vulnerability arises from the fact that certain web services provided by IIS do not properly validate user inputs before using them in the generation of dynamic web pages.
- **Weaknesses/vulnerabilities present**: Cross-Site Scripting (XSS) vulnerabilities in IIS 4.0 and 5.0. Specifically, the vulnerability exists because user-supplied input is not properly sanitized/validated before being incorporated into dynamic web page output.
- **Impact of exploitation**: A malicious user can inject code (e.g., JavaScript) into a web page served by the vulnerable IIS server. This injected code will then execute within the context of a user's browser when they visit the page. This can potentially lead to the malicious user performing actions on the victim's computer using the permissions of the third-party trusted website. This also could be made persistent so that the malicious code runs every time the user visits the website.
- **Attack vectors**:
    - Luring a user to a malicious website.
    - The malicious website constructs a URL containing malicious script, which is then sent to the vulnerable web server (IIS).
    - The vulnerable server processes this crafted URL, blindly inserting the malicious script into a dynamic web page, which is then sent to the user's browser.
    - The user's browser executes the script from the context of the vulnerable website.
- **Required attacker capabilities/position**: An attacker needs the ability to create a malicious website and lure a victim into clicking a link that directs them to the vulnerable web server with malicious script injected into the request. They need to be able to craft URLs containing malicious scripts. The vulnerable web server must also be exposed to the attacker's crafted requests.