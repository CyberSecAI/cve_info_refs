- **Root cause of vulnerability**: A buffer overflow vulnerability exists in the `srv_paraminfo()` API, used by Extended Stored Procedures (XPs) in Microsoft SQL Server and MSDE, which does not perform proper bounds checking when copying input parameters to a buffer.
- **Weaknesses/vulnerabilities present**:  The vulnerability is a buffer overflow. The `srv_paraminfo()` API does not validate the size of the buffer provided by the calling XP, allowing a malicious user to provide a parameter larger than the allocated buffer leading to a buffer overflow condition.
- **Impact of exploitation**: A successful exploit could either cause a denial of service by crashing the SQL Server service or allow an attacker to execute arbitrary code on the database server with the privileges of the SQL Server service account. The impact is dependent on the level of access granted to the SQL Server service account and the attacker's ability to craft the overflow data.
- **Attack vectors**:
    - Direct attack on the SQL Server by authenticating and calling a vulnerable XP.
    - Indirect attack by compromising a web application that uses a vulnerable XP on a back-end database server.
- **Required attacker capabilities/position**:
    - For a direct attack, the attacker needs to authenticate to the SQL Server.
    - For an indirect attack, the attacker needs to compromise a web application and have knowledge of the database structure and the web application's functionality to craft specific inputs.
    - In either case, the attacker needs to identify a vulnerable XP and have knowledge of the XP to exploit the buffer overflow.