The provided content describes a vulnerability in Cisco PIX firewalls related to how they handle FTP PASV commands under a denial-of-service (DoS) attack.

**Root Cause:**
The root cause is a flaw in the Cisco PIX firewall's FTP fixup handling that, under heavy load of PASV commands, causes the firewall to leak the internal IP address of the server it is protecting. This occurs when the firewall is flooded with multiple PASV requests in a short period, causing a failure in its state handling and then disclosing internal IP address in response to subsequent PASV commands.

**Weaknesses/Vulnerabilities:**
- The vulnerability lies in the FTP fixup mechanism of the Cisco PIX firewall.
- The firewall fails to handle a large number of PASV commands correctly, causing it to leak internal IP addresses.

**Impact of Exploitation:**
- The primary impact is the disclosure of internal IP addresses, which can provide an attacker with valuable information about the network topology behind the firewall.
- This information can be used to plan further attacks against internal systems.

**Attack Vectors:**
- The attack vector is sending a flood of FTP PASV commands to the PIX firewall.
- The attached `pasvDOS.sh` script demonstrates how to send a large number of PASV commands to the FTP server.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to establish a connection to the external interface of the Cisco PIX firewall.
- The attacker needs to be able to send FTP commands to the firewall.
- The attacker can use `netcat` and a script to generate the attack.
- The attacker requires some trial and error to reproduce the attack reliably.

**Additional Details:**

- The vulnerability was tested on Cisco Secure PIX Firewall Version 5.2(2).
- The attacker used a shell script (`pasvDOS.sh`) and `netcat` to perform the attack.
- The issue can be mitigated by using the `fixup ftp strict 21` command, but this can cause incompatibility with some FTP clients.
- The debug logs of the FTP session show that the PIX initially returns the correct address, but after being flooded with PASV commands, it starts to reveal the real internal IP addresses.
- The issue doesn't reliably occur with every attempt and may require a specific sequence of events, including a reload of the PIX device and timing delays between attempts.