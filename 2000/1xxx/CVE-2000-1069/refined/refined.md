- **Root cause of vulnerability**: The `open` function in `Poll It v2.0` is vulnerable to a pipe attack because the filename argument `$poll_options` is not sanitized before being passed to the `open` function. This allows an attacker to inject shell commands. Additionally, the script is vulnerable to a password bypass due to improper variable handling.
- **Weaknesses/vulnerabilities present**:
    -  **Command injection via pipe**: The `open` function call `open(COPTIONS,"$poll_options");` allows an attacker to inject shell commands by controlling the `$poll_options` variable. This is because the filename argument is not sanitized before being passed to the `open` function.
    -  **Password bypass**: The script defines the `$admin_password` before calling the `ReadForm` function, which converts CGI variables to Perl variables. This means that an attacker can overwrite the internal `$admin_password` variable by passing a crafted URL with a new value for `$admin_password`.
    - **Information disclosure**: The script stores IP addresses of voters in a publicly accessible file, `pollit_files/ips.txt`.
- **Impact of exploitation**:
    -  **Command injection**: An attacker can execute arbitrary shell commands on the server.
    -  **Password bypass**: An attacker can gain access to the administrative functions of the script without knowing the correct password.
    -  **Information disclosure**: An attacker can view IP addresses of people who voted in the poll.
- **Attack vectors**:
    -  **Command injection**: The attacker crafts a URL with modified `poll_options` to include a pipe, `|`, followed by the desired command.
    -  **Password bypass**: The attacker crafts a URL with `admin_password` and `entered_password` set to the desired password to bypass authentication.
    - **Information disclosure**: The attacker accesses the file `pollit_files/ips.txt` directly through a web browser.
- **Required attacker capabilities/position**:
    -  The attacker needs to be able to send HTTP requests to the vulnerable web server.
    -  The attacker needs to have knowledge of the vulnerability in `Poll It v2.0`.