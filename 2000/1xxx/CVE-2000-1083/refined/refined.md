- **Root cause of vulnerability**: A buffer overflow vulnerability exists in the `srv_paraminfo()` API, used by extended stored procedures (XPs) in Microsoft SQL Server and MSDE. This API is used to parse input parameters for XPs. The API does not provide a mechanism for the XP to specify the buffer size when retrieving parameters, leading to a potential buffer overflow if the provided parameter is larger than the allocated buffer.
- **Weaknesses/vulnerabilities present**: A buffer overflow vulnerability exists due to the lack of buffer size checking in the `srv_paraminfo()` API when parsing parameters for extended stored procedures. Specifically, the `xp_showcolv` extended stored procedure does not properly validate the size of the input buffer when using srv_paraminfo(), leading to a potential buffer overflow if a sufficiently long parameter is passed.
- **Impact of exploitation**: A successful exploitation could lead to:
    - Denial of Service: By causing the SQL Server service to fail through a buffer overflow with random data.
    - Arbitrary Code Execution: By carefully crafting the overflow data, a malicious user could execute arbitrary code on the database server, with the privileges of the SQL Server service account.
- **Attack vectors**:
    - Direct attack: A malicious user could log onto the SQL Server directly and execute the vulnerable XP, providing a malformed parameter.
    - Indirect attack: A malicious user could attack a database server that served as a back-end to a web server, by providing carefully-chosen inputs to the web application that would in turn be passed to the vulnerable XP, and trigger the overflow in `srv_paraminfo()`. This attack requires knowledge of the web application and its interaction with the database.
- **Required attacker capabilities/position**:
    - To directly attack a SQL Server, the attacker must have the ability to authenticate to the SQL Server instance.
    - To indirectly attack via a web application, the attacker would require detailed knowledge of the web applicationâ€™s design, particularly how input parameters are passed through to the database server, and which extended stored procedures are used by the application. It is also beneficial for the attacker to already have a foothold on the web server, with user level access on the database server.