- **Root cause of vulnerability**: The `loadpage.cgi` script in AHG EZshopper does not properly validate the `<filename>` parameter, allowing an attacker to supply a directory name instead of a file name.
- **Weaknesses/vulnerabilities present**: Improper input validation. Specifically, the `loadpage.cgi` script fails to verify that the `<filename>` parameter points to a valid file and not a directory.
- **Impact of exploitation**: An attacker can obtain a file listing of EZshopper directories, potentially revealing sensitive files like user data, transaction information and .htaccess files. They can then use this list to access the content of arbitrary files within the EZshopper directory structure.
- **Attack vectors**: By sending crafted HTTP GET requests to the `loadpage.cgi` script with a directory name as the `<filename>` parameter, attackers can trigger the vulnerability.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the vulnerable `loadpage.cgi` script. No specific access to the server is required.