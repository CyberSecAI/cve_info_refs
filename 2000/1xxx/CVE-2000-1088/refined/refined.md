- **Root cause of vulnerability:** The `srv_paraminfo()` API, used by extended stored procedures (XPs) in SQL Server, has a flaw that can lead to a buffer overrun. The API does not validate the size of the buffer provided by the XP to store a parameter, potentially writing past the allocated memory if the parameter is larger than the buffer.
- **Weaknesses/vulnerabilities present:** Buffer overflow vulnerability in the `srv_paraminfo()` API, specifically when handling parameters passed to extended stored procedures.
- **Impact of exploitation:**
    -  Denial of Service (DoS): A malicious user could cause the SQL Server service to fail by overflowing the buffer with random data.
    -  Remote Code Execution (RCE): A malicious user could execute arbitrary code on the database server by carefully crafting the overflow data. The code would run in the security context of the SQL Server service account.
- **Attack vectors:**
    - Direct attack: Authenticated user on the SQL server calls an affected extended stored procedure (XP) with a long enough parameter to cause the buffer overflow.
    - Indirect attack: A compromised web server might provide input to a SQL server back-end that calls an affected XP with a long enough parameter, leading to exploitation. This is less likely as web applications rarely call XPs.
- **Required attacker capabilities/position:**
    - For direct attack: Requires valid authentication to the SQL Server.
    - For indirect attack:  Requires detailed knowledge of the web application's design, the SQL server backend, and a way to pass data that eventually reaches the vulnerable XP. In most cases, this vulnerability would be more easily exploitable by a malicious user who has already compromised a web server and has user-level access to the back-end SQL server.