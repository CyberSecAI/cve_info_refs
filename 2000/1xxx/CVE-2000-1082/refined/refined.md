- **Root cause of vulnerability**: The `srv_paraminfo()` API, used by Extended Stored Procedures (XPs) in Microsoft SQL Server and MSDE to parse input parameters, has a design flaw. It does not validate the size of the buffer provided by the XP to store the parameter, leading to a buffer overflow if the provided parameter is larger than the buffer.
- **Weaknesses/vulnerabilities present**: Buffer overflow in the `srv_paraminfo()` API due to lack of bounds checking on the buffer provided by XPs for parameter storage.
- **Impact of exploitation**:
    - Denial of Service (DoS): Overwriting the buffer with random data can crash the SQL Server service.
    - Remote Code Execution (RCE): Overwriting the buffer with carefully crafted data can allow an attacker to execute arbitrary code within the security context of the SQL Server service account.
- **Attack vectors**:
    - Direct attack: Authenticated SQL Server user calling an affected XP with a long parameter.
    - Indirect attack:  A malicious user could exploit a web server by providing long input parameters to the web application, which in turn calls an affected XP on the backend SQL server. This is less common.
- **Required attacker capabilities/position**:
    - To directly exploit, the attacker needs to be a SQL Server user with the ability to call extended stored procedures and have knowledge of which XP is affected.
    - To indirectly exploit through a web server, the attacker needs detailed knowledge of the web application's design and the specific parameters that are passed to the vulnerable XPs. In addition, the attacker may need to first gain access to the web server.