=== Content from bugzilla.mozilla.org_1c2ff841_20250124_120841.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/154030)
* [XML](/show_bug.cgi?ctype=xml&id=154030)

Closed
[Bug 154030](/show_bug.cgi?id=154030)

Opened 23 years ago
Closed 23 years ago

# HTML directory indexer doesn't html-escape url

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

HTML directory indexer doesn't html-escape url

## Categories

### (Core :: Security, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Security#Security)

Security
▾

Core :: Security
For non-crypto security bugs. Or use this general component if you know you have a Browser security bug, but not sure what component to use. Bug will be reviewed for proper component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla1.0.1

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: bbaetz, Assigned: bbaetz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/3ac0810ff2d431ec44f087f4fa2bf042?d=mm&size=40)  [bbaetz](/user_profile?user_id=29274)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/7df66616ae41bdee44b7fc50762dc156?d=mm&size=40)  [benc](/user_profile?user_id=16246)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3ac0810ff2d431ec44f087f4fa2bf042?d=mm&size=40)  [bbaetz](/user_profile?user_id=29274)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=40)  [dveditz](/user_profile?user_id=1689)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

5 people

## References

### ( URL )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[154029](/show_bug.cgi?id=154029 "VERIFIED DUPLICATE - HTML directory indexer doesn't html-escape url")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

ftp://ftp.mozilla.org/#%3C%2ftitle%3E...

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [FIXED ON TRUNK][FIXED ON BRANCH])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[FIXED ON TRUNK][FIXED ON BRANCH]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [patch](/attachment.cgi?id=89011)  [23 years ago](#c1)  [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)   1.86 KB, patch | dougt : [review+](#c2 "23 years ago")  jud : [superreview+](#c6 "23 years ago")  jud : [approval+](#c6 "23 years ago") | [Details](/attachment.cgi?id=89011&action=edit) | [Diff](/attachment.cgi?id=89011&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=154030&attachment=89011) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=154030#c0)• 23 years ago |
|  | |

As reported by ptrs-ejy@bp.iij4u.or.jp to the security group, the uri (which is
added to the page) isn't html escaped:
<quote>
+ Exploit code:
~~~~~~~~~~~~~~~~~
<a href="ftp://'FTPserver' or
'FTP+HTTPserver'/#%3C%2ftitle%3E%3Cscript%3Ealert(%22exploit%22);%3C%2fscript%3E">Exploit</a>
</quote>
(You need to add a valid ftp server in there)
Patch coming

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=154030#c1)• 23 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=89011&action=diff)
— [Details](attachment.cgi?id=89011&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=154030&attachment=89011)

This rearranges code a bit so that we don't leak while using the raw pointers
the escaping functions require (Also fixes an existing leak of |spec|, too)

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=154030#a630_29274)• 23 years ago |

Status: NEW → ASSIGNEDKeywords: [patch](/buglist.cgi?keywords=patch&resolution=---),
[review](/buglist.cgi?keywords=review&resolution=---)Target Milestone: --- → mozilla1.0.1

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=154030#c2)• 23 years ago |
|  | |

Comment on [attachment 89011](/attachment.cgi?id=89011 "patch") [[details]](/attachment.cgi?id=89011&action=edit "patch") [[diff]](/attachment.cgi?id=89011&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=154030&attachment=89011)
patch
r-dougt
[Attachment #89011](/attachment.cgi?id=89011&action=edit "patch") -
Flags: review+

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=154030#c3)• 23 years ago |
|  | |

\*\*\* [Bug 154029](/show_bug.cgi?id=154029 "VERIFIED DUPLICATE - HTML directory indexer doesn't html-escape url") has been marked as a duplicate of this bug. \*\*\*

|  | [Darin Fisher](/user_profile?user_id=20048) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=154030#c4)• 23 years ago |
|  | |

Comment on [attachment 89011](/attachment.cgi?id=89011 "patch") [[details]](/attachment.cgi?id=89011&action=edit "patch") [[diff]](/attachment.cgi?id=89011&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=154030&attachment=89011)
patch
>Index: nsIndexedToHTML.cpp
>+ char\* spec = nsCRT::strdup(titleUri.get());
>+ nsXPIDLString unEscapeSpec;
>+ rv = mTextToSubURI->UnEscapeAndConvert(encoding, spec,
>+ getter\_Copies(unEscapeSpec));
>+ nsCRT::free(spec);
why strdup? second param to UnEscapeAndConvert is |const char \*|, so
what's wrong with |titleUri.get()|?
justify/fix and sr=darin

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=154030#c5)• 23 years ago |
|  | |

darin: Historical reasons - that used to call nsUnescape.
Checked in with that change to the trunk; I'll mail drivers for the branch.Status: ASSIGNED → RESOLVEDClosed: 23 years agoKeywords: [approval](/buglist.cgi?keywords=approval&resolution=---),
[mozilla1.0.1](/buglist.cgi?keywords=mozilla1.0.1&resolution=---)Priority: -- → P1Resolution: --- → FIXEDWhiteboard: [FIXED ON TRUNK]

|  | [Judson Valeski](/user_profile?user_id=614) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=154030#c6)• 23 years ago |
|  | |

Comment on [attachment 89011](/attachment.cgi?id=89011 "patch") [[details]](/attachment.cgi?id=89011&action=edit "patch") [[diff]](/attachment.cgi?id=89011&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=154030&attachment=89011)
patch
adding darin's sr.
[Attachment #89011](/attachment.cgi?id=89011&action=edit "patch") -
Flags: superreview+
[Attachment #89011](/attachment.cgi?id=89011&action=edit "patch") -
Flags: approval+

|  | [Judson Valeski](/user_profile?user_id=614) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=154030#c7)• 23 years ago |
|  | |

please checkin to the 1.0.1 branch. once there, remove the "mozilla1.0.1+"
keyword and add the "fixed1.0.1" keyword.Keywords: [mozilla1.0.1](/buglist.cgi?keywords=mozilla1.0.1&resolution=---) → [mozilla1.0.1+](/buglist.cgi?keywords=mozilla1.0.1%2B&resolution=---)

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=154030#c8)• 23 years ago |
|  | |

Fixed on branch, too (after my checkin last night was backed out because the
tree was closed. Oops)Keywords: [mozilla1.0.1+](/buglist.cgi?keywords=mozilla1.0.1%2B&resolution=---) → [fixed1.0.1](/buglist.cgi?keywords=fixed1.0.1&resolution=---)Whiteboard: [FIXED ON TRUNK] → [FIXED ON TRUNK][FIXED ON BRANCH]

|  | [bsharma](/user_profile?user_id=4397) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=154030#c9)• 23 years ago |
|  | |

Verified on 2002-06-27-trunk and 2002-06-27-branch build on Win2K.
Above URL displays the direcrtory contents.Status: RESOLVED → VERIFIEDKeywords: [fixed1.0.1](/buglist.cgi?keywords=fixed1.0.1&resolution=---) → [verified1.0.1](/buglist.cgi?keywords=verified1.0.1&resolution=---)

|  | [benc](/user_profile?user_id=16246) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=154030#a577866_16246)• 23 years ago |

Component: Networking: FTP → Security: General

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=154030#a6302982_6444)• 22 years ago |

Group: security?
You need to [log in](/show_bug.cgi?id=154030&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


