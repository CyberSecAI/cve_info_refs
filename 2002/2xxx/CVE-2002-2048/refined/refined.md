The content relates to CVE-2002-2048.

**Root cause of vulnerability:**
The `pfinger` program contains a buffer overflow vulnerability due to the use of `sprintf` without proper bounds checking when constructing the query string.

**Weaknesses/vulnerabilities present:**
- **Buffer Overflow:** The `query` buffer, declared as `char query[100]`, is overflowed by the `sprintf` function. The `sprintf` function copies the username argument provided by the user into the `query` buffer, prepended with an optional "/W_" string. When the username is long, `sprintf` writes beyond the allocated space in the `query` buffer, leading to a buffer overflow.

**Impact of exploitation:**
- **Segmentation Fault:** The overflow causes a segmentation fault, resulting in a crash of the `pfinger` program.
- **Potential arbitrary code execution:** Although not explicitly demonstrated in the provided text, a buffer overflow vulnerability of this nature can be exploited to achieve arbitrary code execution if carefully crafted input is provided.

**Attack vectors:**
- **Command Line Argument:** The attacker provides an overly long username as a command-line argument to the `pfinger` program.

**Required attacker capabilities/position:**
- The attacker needs the ability to execute the `pfinger` program with a command line argument. No special privileges are explicitly mentioned to be required.