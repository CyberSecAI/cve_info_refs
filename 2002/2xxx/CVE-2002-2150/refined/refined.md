This document describes a vulnerability related to state-based firewalls and their susceptibility to denial-of-service attacks through session table exhaustion. While the document does not explicitly mention CVE-2002-2150, the vulnerability described here is likely the root cause of that CVE.

**Root Cause of Vulnerability:**
State-based firewalls use state tables to track network sessions. When new connection attempts are received, the firewall adds entries to this table. If an attacker can create new entries faster than the firewall can remove them, the table fills up, preventing new legitimate connections, resulting in a denial-of-service.

**Weaknesses/Vulnerabilities:**
- Inability to handle a high rate of new connection attempts, particularly those with spoofed source addresses.
- Finite size of the state table, allowing attackers to exhaust resources.
- Inefficient handling of connectionless protocols like UDP.
- Some firewalls do not validate layer 4 checksums which can be exploited.

**Impact of Exploitation:**
- Denial of service, preventing legitimate users from establishing new connections through the firewall.
- In some cases, the attacks can be performed with less traffic than the firewall's bandwidth capacity.

**Attack Vectors:**
- **TCP SYN Flood:** Attacker sends numerous SYN packets with forged IP source addresses, filling the state table with half-open connections.
- **UDP Flood:** Attacker sends large numbers of UDP packets with forged source IP addresses.
- **Crikey CRC Flood (C2 Flood):** Attacker sends packets with invalid transport layer checksums. Many firewalls will pass these, creating entries, while the destination discards them, preventing timeout and deletion of state entries.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send network packets to the targeted firewall.
- The attacker can be remote.
- The attacker needs the ability to spoof source IP addresses for certain attacks (SYN floods, UDP floods).