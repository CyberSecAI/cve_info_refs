=== Content from marc.info_5a4dc51a_20250125_062830.html ===

```
[[prev in list](?l=bugtraq&m=102812548015645&w=2)] [[next in list](?l=bugtraq&m=102817534104354&w=2)] [prev in thread] [[next in thread](?l=freebsd-announce&m=102811929008224&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [FreeBSD Security Advisory FreeBSD-SA-02:32.pppd](?t=102811812200006&r=1&w=2)
From:       [FreeBSD Security Advisories <security-advisories () freebsd ! org>](?a=96042017500002&r=1&w=2)
Date:       [2002-07-31 12:00:49](?l=bugtraq&r=1&w=2&b=200207)
[Download RAW [message](?l=bugtraq&m=102812546815606&q=mbox) or [body](?l=bugtraq&m=102812546815606&q=raw)]

-----BEGIN PGP SIGNED MESSAGE-----

=============================================================================
FreeBSD-SA-02:32.pppd                                       Security Advisory
                                                          The FreeBSD Project

Topic:          exploitable race condition in pppd

Category:       core
Module:         pppd
Announced:      2002-07-31
Credits:        Sebastian Krahmer <krahmer@suse.de>
Affects:        All releases of FreeBSD up to and including 4.6.1-RELEASE-p1
Corrected:      2002-07-30 03:50:40 UTC (RELENG_4)
                2002-07-30 19:15:52 UTC (RELENG_4_6)
                2002-07-30 19:16:46 UTC (RELENG_4_5)
                2002-07-30 19:17:27 UTC (RELENG_4_4)
FreeBSD only:   NO

I.   Background

FreeBSD ships with several implementations of the Point-to-Point
Protocol (PPP).  The pppd program is one of these implementations.  It
provides basic support for negotiating a link, while encapsulation is
done by driver code in the kernel.

II.  Problem Description

A race condition exists in the pppd program that may be exploited
in order to change the permissions of an arbitrary file.  The file
specified as the tty device is opened by pppd, and the permissions
are recorded.  If pppd fails to initialize the tty device in some way
(such as a failure of tcgetattr(3)), then pppd will then attempt to
restore the original permissions by calling chmod(2).  The call to
chmod(2) is subject to a symlink race, so that the permissions may
`restored' on some other file.

Note that the pppd program is installed set-user-ID to root, so that
any file's permissions may be changed in this fashion.

III. Impact

A malicious local user may exploit the race condition to acquire write
permissions to a critical system file, such as /etc/crontab, and
leverage the situation to acquire escalated privileges.

In FreeBSD 4.4-RELEASE and later, the local user must be in group
`dialer' in order to run pppd and attempt to exploit this race.

IV.  Workaround

Remove the set-user-ID bit from pppd by executing the following
command as root:

# chmod u-s /usr/sbin/pppd

V.   Solution

Do one of the following:

1) Upgrade your vulnerable system to 4.6-STABLE; or to the RELENG_4_6,
RELENG_4_5, or RELENG_4_4 security branch dated after the correction
date (4.6.1-RELEASE-p2, 4.5-RELEASE-p11, or 4.4-RELEASE-p18).

2) To patch your present system:

The following patch has been verified to apply to FreeBSD 4.4, 4.5,
and 4.6 systems.

a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.

# fetch ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-02:32/pppd.patch
# fetch ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-02:32/pppd.patch.asc

b) Execute the following commands as root:

# cd /usr/src
# patch < /path/to/patch
# cd /usr/src/usr.sbin/pppd
# make depend && make && make install

VI.  Correction details

The following list contains the revision numbers of each file that was
corrected in FreeBSD.

Path                                                             Revision
  Branch
- -------------------------------------------------------------------------
usr.sbin/pppd/main.c
  RELENG_4                                                       1.19.2.1
  RELENG_4_6                                                    1.19.10.1
  RELENG_4_5                                                     1.19.8.1
  RELENG_4_4                                                     1.19.6.1
sys/conf/newvers.sh
  RELENG_4_6                                                1.44.2.23.2.7
  RELENG_4_5                                               1.44.2.20.2.12
  RELENG_4_4                                               1.44.2.17.2.17
- -------------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.7 (FreeBSD)

iQCVAwUBPUfQ4VUuHi5z0oilAQGaYwP/djtLXxRveB2xDy54hACNSArKnfAbEwEP
PisB8Er2Zl4CmwnKx3BO8zWoV+nb7afcWGoy2eU14b/sXTLpInpx+823J8nP3BUK
bsUInanuFxX6LfSTbzjRT+8wxxXKO4oarPFfxfVis09ekjO+FqTtm2pAV13ug/+s
Wrb8IG4YYVA=
=tfMD
-----END PGP SIGNATURE-----
[[prev in list](?l=bugtraq&m=102812548015645&w=2)] [[next in list](?l=bugtraq&m=102817534104354&w=2)] [prev in thread] [[next in thread](?l=freebsd-announce&m=102811929008224&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.openbsd.org_fa9306c2_20250125_062901.html ===


OpenBSD 3.1 Errata

## [*Open***BSD**](index.html) 3.1 Errata

---

For errata on a certain release, click below:

[2.0](errata20.html),
[2.1](errata21.html),
[2.2](errata22.html),
[2.3](errata23.html),
[2.4](errata24.html),
[2.5](errata25.html),
[2.6](errata26.html),
[2.7](errata27.html),
[2.8](errata28.html),
[2.9](errata29.html),
[3.0](errata30.html),
[3.2](errata32.html),
[3.3](errata33.html),
[3.4](errata34.html),
[3.5](errata35.html),
[3.6](errata36.html),

[3.7](errata37.html),
[3.8](errata38.html),
[3.9](errata39.html),
[4.0](errata40.html),
[4.1](errata41.html),
[4.2](errata42.html),
[4.3](errata43.html),
[4.4](errata44.html),
[4.5](errata45.html),
[4.6](errata46.html),
[4.7](errata47.html),
[4.8](errata48.html),
[4.9](errata49.html),
[5.0](errata50.html),
[5.1](errata51.html),
[5.2](errata52.html),

[5.3](errata53.html),
[5.4](errata54.html),
[5.5](errata55.html),
[5.6](errata56.html),
[5.7](errata57.html),
[5.8](errata58.html),
[5.9](errata59.html),
[6.0](errata60.html),
[6.1](errata61.html),
[6.2](errata62.html),
[6.3](errata63.html),
[6.4](errata64.html),
[6.5](errata65.html),
[6.6](errata66.html),
[6.7](errata67.html),
[6.8](errata68.html),

[6.9](errata69.html),
[7.0](errata70.html),
[7.1](errata71.html),
[7.2](errata72.html),
[7.3](errata73.html),
[7.4](errata74.html),
[7.5](errata75.html),
[7.6](errata76.html).

---

Patches for the OpenBSD base system are distributed as unified diffs.
Each patch contains usage instructions.
All the following patches are also available in one
[tar.gz file](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1.tar.gz)
for convenience.

Patches for supported releases are also incorporated into the
[-stable branch](stable.html).

---

* **001: SECURITY FIX: April 22, 2002**
    *All architectures*

  A local user can gain super-user privileges due to a buffer overflow
  in [sshd(8)](https://man.openbsd.org/OpenBSD-3.1/sshd.8)
  if AFS has been configured on the system or if
  KerberosTgtPassing or AFSTokenPassing has been enabled
  in the sshd\_config file. Ticket and token passing is not enabled
  by default.

  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/001_sshafs.patch)

  * **002: SECURITY FIX: April 25, 2002**
      *All architectures*

    A bug in [sudo(8)](https://man.openbsd.org/OpenBSD-3.1/sudo.8) may allow an attacker to corrupt the heap by specifying a custom prompt.

    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/002_sudo.patch)

    * **003: SECURITY FIX: May 8, 2002**
        *All architectures*

      A race condition exists where an attacker could fill the file descriptor
      table and defeat the kernel's protection of fd slots 0, 1, and 2 for a
      setuid or setgid process.

      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/003_fdalloc2.patch)

      * **004: SECURITY FIX: May 22, 2002**
          *All architectures*

        Under certain conditions, on systems using YP with netgroups in the
        password database, it is possible that
        [sshd(8)](https://man.openbsd.org/OpenBSD-3.1/sshd.8)
        does ACL checks for the requested user name but uses the password
        database entry of a different user for authentication. This means
        that denied users might authenticate successfully while permitted
        users could be locked out.

        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/004_sshbsdauth.patch)

        * **005: SECURITY FIX: June 19, 2002**
            *All architectures*

          A buffer overflow can occur during the interpretation of chunked
          encoding in the http daemon, leading to possible remote crash or exploit.

          [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/005_httpd.patch)

          * **006: SECURITY FIX: June 24, 2002**
              *All architectures*

            All versions of OpenSSH's sshd between 2.3.1 and 3.3 contain an input validation
            error that can result in an integer overflow and privilege escalation.
            This problem is fixed in [OpenSSH
            3.4](https://www.openssh.com/openbsd.html), and a patch for the vulnerable releases is available as part of the
            [security advisory](https://www.openssh.com/txt/preauth.adv).

            * **007: SECURITY FIX: June 25, 2002**
                *All architectures*

              A potential buffer overflow in the DNS resolver has been found.

              [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/007_resolver.patch)

              * **008: SECURITY FIX: June 26, 2002**
                  *All architectures*

                A buffer overflow can occur in the .htaccess parsing code in mod\_ssl httpd
                module, leading to possible remote crash or exploit.

                [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/008_mod_ssl.patch)

                * **009: SECURITY FIX: June 27, 2002**
                    *All architectures*

                  The kernel would let any user [ktrace(2)](https://man.openbsd.org/OpenBSD-3.1/ktrace.2) set[ug]id processes.

                  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/009_ktrace.patch)

                  * **010: RELIABILITY FIX: July 5, 2002**
                      *All architectures*

                    Receiving IKE payloads out of sequence can cause
                    [isakmpd(8)](https://man.openbsd.org/OpenBSD-3.1/isakmpd.8) to crash.

                    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/010_isakmpd.patch)

                    This is the second version of the patch.

                    * **011: SECURITY FIX: July 29, 2002**
                        *All architectures*

                      A race condition exists in the
                      [pppd(8)](https://man.openbsd.org/OpenBSD-3.1/pppd.8)
                      daemon which may cause it to alter the file permissions of an arbitrary file.

                      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/011_pppd.patch)

                      * **012: SECURITY FIX: July 29, 2002**
                          *All architectures*

                        A buffer overflow can occur in the
                        [xdr\_array(3)](https://man.openbsd.org/OpenBSD-3.1/xdr_array.3)
                        RPC code, leading to possible remote crash.

                        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/012_xdr.patch)

                        This is the second version of the patch.

                        * **013: SECURITY FIX: July 30, 2002**
                            *All architectures*

                          Several remote buffer overflows can occur in the SSL2 server and SSL3 client of the
                          [ssl(8)](https://man.openbsd.org/OpenBSD-3.1/ssl.8)
                          library, as in the ASN.1 parser code in the
                          [crypto(3)](https://man.openbsd.org/OpenBSD-3.1/crypto.3)
                          library, all of them being potentially remotely exploitable.

                          [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/013_ssl.patch)

                          This is the second version of the patch.

                          * **014: SECURITY FIX: August 11, 2002**
                              *All architectures*

                            An insufficient boundary check in the
                            [select(2)](https://man.openbsd.org/OpenBSD-3.1/select.2)
                            system call allows an attacker to overwrite kernel memory and execute arbitrary
                            code in kernel context.

                            [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/014_scarg.patch)
                            For more details, see the [OpenBSD advisory](advisories/select.txt).

                            * **015: SECURITY FIX: October 2, 2002**
                                *All architectures*

                              Incorrect argument checking in the
                              [setitimer(2)](https://man.openbsd.org/OpenBSD-3.1/setitimer.2) system call may allow an attacker to write to kernel memory.

                              [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/015_kerntime.patch)

                              * **016: SECURITY FIX: October 21, 2002**
                                  *All architectures*

                                A buffer overflow can occur in the
                                [kadmind(8)](https://man.openbsd.org/OpenBSD-3.1/kadmind.8)
                                daemon, leading to possible remote crash or exploit.

                                [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/016_kadmin.patch)

                                * **017: SECURITY FIX: November 6, 2002**
                                    *All architectures*

                                  An attacker can bypass the restrictions imposed by sendmail's restricted shell,
                                  [smrsh(8)](https://man.openbsd.org/OpenBSD-3.1/smrsh.8),
                                  and execute arbitrary commands with the privileges of his own account.

                                  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/017_smrsh.patch)

                                  * **018: SECURITY FIX: November 6, 2002**
                                      *All architectures*

                                    Incorrect argument checking in the
                                    [getrlimit(2)](https://man.openbsd.org/OpenBSD-3.1/getrlimit.2)
                                    system call may allow an attacker to crash the kernel.

                                    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/018_kernresource.patch)

                                    * **019: SECURITY FIX: November 14, 2002**
                                        *All architectures*

                                      A buffer overflow in
                                      [named(8)](https://man.openbsd.org/OpenBSD-3.1/named.8)
                                      could allow an attacker to execute code with the privileges of named.
                                      On OpenBSD, named runs as a non-root user in a chrooted environment
                                      which mitigates the effects of this bug.

                                      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/019_named.patch)

                                      * **020: SECURITY FIX: January 20, 2003**
                                          *All architectures*

                                        A double free in
                                        [cvs(1)](https://man.openbsd.org/OpenBSD-3.1/cvs.1)
                                        could allow an attacker to execute code with the privileges of the
                                        user running cvs. This is only an issue when the cvs command is
                                        being run on a user's behalf as a different user. This means that,
                                        in most cases, the issue only exists for cvs configurations that use
                                        the *pserver* client/server connection method.

                                        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/020_cvs.patch)

                                        * **021: SECURITY FIX: February 23, 2003**
                                            *All architectures*

                                          In
                                          [ssl(8)](https://man.openbsd.org/OpenBSD-3.1/ssl.8) an information leak can occur via timing by performing a MAC computation
                                          even if incorrect block cipher padding has been found, this is a
                                          countermeasure. Also, check for negative sizes in memory allocation routines.

                                          [A source code patch exists which fixes these two issues](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/021_ssl.patch).

                                          * **022: SECURITY FIX: March 3, 2003**
                                              *All architectures*

                                            A buffer overflow in the envelope comments processing in
                                            [sendmail(8)](https://man.openbsd.org/OpenBSD-3.1/sendmail.8)
                                            may allow an attacker to gain root privileges.

                                            [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/022_sendmail.patch)

                                            * **023: SECURITY FIX: March 5, 2003**
                                                *All architectures*

                                              A fix for an
                                              [lprm(1)](https://man.openbsd.org/OpenBSD-3.1/lprm.1)
                                              bug made in 1996 contains an error that could lead to privilege escalation.

                                              [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/023_lprm.patch)

                                              * **024: SECURITY FIX: March 18, 2003**
                                                  *All architectures*

                                                Various SSL and TLS operations in OpenSSL are vulnerable to timing attacks.

                                                [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/024_blinding.patch)

                                                * **025: SECURITY FIX: March 19, 2003**
                                                    *All architectures*

                                                  OpenSSL is vulnerable to an extension of the "Bleichenbacher" attack designed
                                                  by Czech researchers Klima, Pokorny and Rosa.

                                                  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/025_kpr.patch)

                                                  * **026: SECURITY FIX: March 24, 2003**
                                                      *All architectures*

                                                    The cryptographic weaknesses in the Kerberos v4 protocol can be exploited
                                                    on Kerberos v5 as well.

                                                    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/026_kerberos.patch)

                                                    * **027: SECURITY FIX: March 31, 2003**
                                                        *All architectures*

                                                      A buffer overflow in the address parsing in
                                                      [sendmail(8)](https://man.openbsd.org/OpenBSD-3.1/sendmail.8)
                                                      may allow an attacker to gain root privileges.

                                                      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/027_sendmail.patch)

---


