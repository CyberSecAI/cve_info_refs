- **Root cause of vulnerability:** Aftpd crashes when any user, including anonymous users, executes the `cd ~` command.
- **Weaknesses/vulnerabilities present:**  A core dump vulnerability exists within the Aftpd daemon triggered by the `cd ~` command. Additionally, the daemon loads the password file into memory upon a failed login attempt, which is then accessible in the core dump.
- **Impact of exploitation:**  The core dump can expose sensitive information, such as encrypted passwords of users, when triggered after a failed login attempt followed by an anonymous login. The core dump can be downloaded from the server. This enables offline password cracking.
- **Attack vectors:** Sending the `cd ~` command to the vulnerable server via an FTP client.
- **Required attacker capabilities/position:**  An attacker must be able to connect to the FTP server and send commands. To retrieve the password hash, the attacker would need to first trigger a failed login attempt, then log in as anonymous before executing the `cd ~` command.