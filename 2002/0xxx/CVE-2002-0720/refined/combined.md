=== Content from docs.microsoft.com_21dadcca_20250124_214121.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-042.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS02-042 - Critical

## Flaw in Network Connection Manager Could Enable Privilege Elevation (Q326886)

Published: August 14, 2002

**Version:** 1.0

**Originally posted:** August 14, 2002

#### Summary

**Who should read this bulletin:**
Customers using MicrosoftÂ® WindowsÂ® 2000.

**Impact of vulnerability:**
Privilege elevation

**Maximum Severity Rating:**
Critical

**Recommendation:**
Administrators should apply the patch to immediately to machines that allow unprivileged users to log onto them interactively such as workstations and Terminal Servers

**Affected Software:**

* Microsoft Windows 2000

### General Information

## Technical details

**Technical description:**

The Network Connection Manager (NCM) provides a controlling mechanism for all network connections managed by a host system. Among the functions of the NCM is to call a handler routine whenever a network connection has been established.

By design, this handler routine should run in the security context of the user. However, a flaw could make it possible for an unprivileged user to cause the handler routine to run in the security context of LocalSystem, though a very complex process. An attacker who exploited this flaw could specify code of his or her choice as the handler, then establish a network connection in order to cause that code to be invoked by the NCM. The code would then run with full system privileges.

**Mitigating factors:**

* The vulnerability could only be exploited by an attacker who had the appropriate credentials to log onto an affected system interactively. Best practices suggests that unprivileged users not be allowed to interactively log onto business-critical servers. If this recommendation has been followed, machines such as domain controllers, ERP servers, print and file servers, database servers, and others would not be at risk from this vulnerability.

**Severity Rating:**

|  | Internet Servers | Intranet Servers | Client Systems |
| --- | --- | --- | --- |
| **Windows 2000** | Low | Critical | Critical |

The above [assessment](https://technet.microsoft.com/security/bulletin/rating) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.

**Vulnerability identifier:** [CAN-2002-0720](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0720)

**Tested Versions:**

Microsoft tested Windows XP, Windows 2000 and Windows NT 4.0 to assess whether they are affected by these vulnerabilities. Previous versions are no longer [supported](https://support.microsoft.com/directory/discontinue.asp), and may or may not be affected by these vulnerabilities.

## Frequently asked questions

**What's the scope of the vulnerability?**

This is a [privilege elevation](https://technet.microsoft.com/security/bulletin/glossary) vulnerability. An attacker who successfully exploited this vulnerability could gain complete control over the machine, thereby gaining the ability to take any desired action on the machine, such as adding, deleting, or modifying data on the system, creating or deleting user accounts, and adding accounts to the local administrators group.
The vulnerability could only be exploited by an attacker who had credentials to log onto the computer [interactively](https://technet.microsoft.com/security/bulletin/glossary). Best practices suggest that unprivileged users not be allowed to interactively log onto business-critical servers; if this guidance has been followed, such servers would not be at risk from this vulnerability.

**What causes the vulnerability?**

The vulnerability results because it is possible for an unprivileged user to configure the handler routine used by the Network Connection Manager (NCM) when a new network connection is established.

**What is the NCM?**

The NCM is a operating system component in Windows 2000 that provides a means of controlling a system's network connections, such as those seen in the Network and Dial-Up Connections folder. When a user makes a new net network connection, such as through the dial-up networking wizard, the NCM actually processes the request to make the connection.

**What's wrong with the NCM?**

Among the functions the NCM performs is to call a handler routine whenever a network connection is established. A default routine is provided as part of Windows 2000, but custom handlers also can be specified. By design, these handlers should run in the same security context as the user. However, it is possible for a user to cause a handler to run in the LocalSystem security context.

**Why does this pose a security vulnerability?**

When the NCM calls the handler routine, it confers upon it the privileges of the NCM itself - LocalSystem. This means that an unprivileged user who exploited the vulnerability would be able to make software of his or her choice run with System privileges on the system.

**What would this vulnerability enable an attacker to do?**

An attacker who successfully exploited the vulnerability would gain complete control over the system, and be able to take any desired action on it.

**How might an attacker exploit the vulnerability?**

The attacker would need the ability to log onto the system interactively, because the handler routine must reside on the local system and the needed configuration changes require local access as well. Once the attacker had installed the new handler routine, he or she would create a network connection in order to cause the NCM to call it. The result would be that the attacker's handler routine would run with full privileges on the system.

**What types of systems are chiefly at risk from the vulnerability?**

Any system running Windows 2000 is conceivably affected by the vulnerability, but it's likely that Windows 2000 workstations and terminal servers would be at greatest risk. This is because such systems typically are configured to allow unprivileged users to log onto them interactively. In contrast, unprivileged users are typically not allowed to log onto servers interactively, and in such cases these systems would be at less risk.

**How difficult would it be to exploit the vulnerability?**

Exploiting the vulnerability would be an extremely difficult task, requiring significant technical expertise.

**How was the vulnerability discovered?**

The vulnerability was discovered as part of a Microsoft security review.

**How does the patch address the vulnerability?**

The patch ensures that administrative privileges are required to specify a custom handler for the NCM.

## Patch availability

**Download locations for this patch**

* Microsoft Windows 2000:

  [https://www.microsoft.com/download/details.aspx?FamilyId=F4F66D56-E7CE-44C3-8B94-817EA8485DD1&displaylang;=en](https://www.microsoft.com/download/details.aspx?familyid=f4f66d56-e7ce-44c3-8b94-817ea8485dd1&displaylang;=en)

#### Additional information about this patch

**Installation platforms:**

This patch can be installed on systems running Windows 2000 [Service Pack 2](https://www.microsoft.com/windows2000/downloads/servicepacks/sp2/default.mspx) or [Service Pack 3](https://www.microsoft.com/windows2000/downloads/servicepacks/sp3/default.mspx).

**Inclusion in future service packs:**

The fix for this issue will be included in Windows 2000 Service Pack 4.

**Reboot needed:** Yes

**Patch can be uninstalled:** Yes

**Superseded patches:** None.

**Verifying patch installation:**

* To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP4\Q326886.
* To verify the individual files, use the date/time and version information provided in the following registry key:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP4\Q326886\Filelist

**Caveats:**

None

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site

#### Other information:

**Support:**

* Microsoft Knowledge Base article Q326886 discusses this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/?scid=fh;en-us;kbhowto) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 (August 14, 2002): Bulletin Created.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


