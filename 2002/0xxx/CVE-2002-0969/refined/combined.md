=== Content from marc.info_a18143b2_20250124_164844.html ===

```
[[prev in list](?l=bugtraq&m=103357160425708&w=2)] [[next in list](?l=bugtraq&m=103359690824103&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    wp-02-0003: MySQL Locally Exploitable Buffer Overflow
From:       [Matt Moore <matt () westpoint ! ltd ! uk>](?a=97298956600003&r=1&w=2)
Date:       [2002-10-02 15:47:59](?l=bugtraq&r=1&w=2&b=200210)
[Download RAW [message](?l=bugtraq&m=103358628011935&q=mbox) or [body](?l=bugtraq&m=103358628011935&q=raw)]

Westpoint Security Advisory

Title:             MySQL Locally Exploitable Buffer Overflow
Risk Rating:       Medium
Software:          mySQL Database v3.23.49-nt
Platforms:         Win32 (other platforms not tested)
Vendor URL:        [www.mysql.com](http://www.mysql.com)
Author:            Matt Moore <matt@westpoint.ltd.uk>
Date:              1st October 2002
Advisory ID#:      wp-02-0003
CVE#               CAN-2002-0969

Overview:
=========
The Win32 version of MySQL has a locally exploitable buffer overflow
condition which could allow an attacker to execute code in the context
of the SYSTEM account if MySQL is running as an NT Service (which is the
default).

Details:
========

MySQL reads a configuration file,'my.ini' from from either c:\my.ini or
c:\WINNT\my.ini . The default ACL's for c:\my.ini allow the 'Everyone'
group
Full Control.The ACL's for c:\winnt are slightly more restrictive, but do
allow members of the 'Power Users' NT Group write access.

By supplying an overly long string for the 'datadir' parameter in
my.ini, it is
possible to overflow a buffer in mysqld-nt.exe, overwriting EIP, and
hence executing
arbitrary code in the context of the SYSTEM account.

E.g.

Change the entry for 'datadir' from:

datadir=C:/mysql/data

to:

datadir=C:/AAAAAA...AAAA

and restart the mySQl service or reboot the machine.

Vendor Response:
================

Fixed in the 3.23.50 release of MySQL and MySQL 4.0.2

Patch Information:
==================

Upgrade to the latest version from [www.mysql.com](http://www.mysql.com)

This advisory is available online at:

[www.westpoint.ltd.uk/advisories/wp-02-0003.txt](http://www.westpoint.ltd.uk/advisories/wp-02-0003.txt)

[[prev in list](?l=bugtraq&m=103357160425708&w=2)] [[next in list](?l=bugtraq&m=103359690824103&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


