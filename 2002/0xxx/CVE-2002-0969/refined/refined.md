- **Root cause of vulnerability:** A buffer overflow in the Win32 version of MySQL when parsing the 'datadir' parameter from the configuration file 'my.ini'.
- **Weaknesses/vulnerabilities present:** Buffer overflow.
- **Impact of exploitation:** An attacker can execute arbitrary code in the context of the SYSTEM account if MySQL is running as an NT Service (which is the default).
- **Attack vectors:** By modifying the 'my.ini' configuration file, specifically the 'datadir' parameter, with an overly long string. This requires local access to the system.
- **Required attacker capabilities/position:** The attacker needs to have write access to the 'my.ini' file, which is typically located in 'c:\my.ini' or 'c:\WINNT\my.ini'. The default ACLs on 'c:\my.ini' allow 'Everyone' full control, while 'c:\winnt' allows members of the 'Power Users' group write access. The attacker also needs to be able to restart the MySQL service or reboot the machine to trigger the vulnerability.