- **Root cause of vulnerability:** The Trend Micro InterScan VirusWall HTTP proxy has a configuration option, enabled by default, to skip scanning content if the HTTP `Content-Length` header is zero.
- **Weaknesses/vulnerabilities present:** The proxy does not validate that the content length matches the actual content, thus allowing a malicious server to send a zero content-length header, followed by virus-infected content. The proxy skips scanning based solely on the header value, ignoring the actual content being sent.
- **Impact of exploitation:** Users behind the VirusWall proxy can unintentionally download virus-infected content from a malicious web server because the proxy does not scan the content.
- **Attack vectors:** A malicious web server sends a modified HTTP header with a `Content-Length` field set to 0, followed by the malicious content.
- **Required attacker capabilities/position:** The attacker needs to control a web server and be able to modify the HTTP headers it sends.