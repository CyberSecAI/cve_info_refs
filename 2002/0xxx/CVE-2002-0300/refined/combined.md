=== Content from marc.info_81961bfe_20250125_203639.html ===

```
[[prev in list](?l=bugtraq&m=101413694023361&w=2)] [[next in list](?l=bugtraq&m=101415489815820&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=101422432123898&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [gnujsp: dir- and script-disclosure](?t=101415824800001&r=1&w=2)
From:       [Thomas Springer <thomas.springer () tuev-sued ! de>](?a=101415806400001&r=1&w=2)
Date:       [2002-02-19 14:51:01](?l=bugtraq&r=1&w=2&b=200202)
[Download RAW [message](?l=bugtraq&m=101415804625292&q=mbox) or [body](?l=bugtraq&m=101415804625292&q=raw)]

---
mod:
for verifying this, ask your favourite google for sites running gnujsp, eg
+"/scripts/gnujsp/".
if you want to get a fix first - go for it, before you release this.
I tried to contact two sites running gnujsp asking for help with a fix -
but they didn't even bother to reply. I'm too busy for installing gnjusp
and doing further research myself.

tom
---

Most sites running apache/gnujsp are vulnerable to directorylisting,
scriptsource disclosure and httpd-restrictions bypass.

Requesting <http://site/servlets/gnujsp/>[dirname]/[file] on a site running
gnujsp, reveals directory-listing of any webdir including wwwroot, it also
reveals the script-source of certain (not all!) script-types, depending on
webserver-config.

Wrapping the url with /servlets/gnujsp/ bypasses
directory/file-restrictions in http.conf or .htaccess, files and
directory-structures can be displayed along with the .htaccess-file.

Very few sites running gnujsp seem to be partially or complete immune to
this behaviour, most are vulnerable.
The /servlets/gnujsp/ is easy to guess, it appears in many error-messages.

I don't know enough about gnujsp to provide a solution - but it seems to be
kind of a configuration flaw in standard-config of gnujsp.
I only tested on apache - maybe other servers with gnujsp installed are
vulnerable too.

I contacted the gnujsp-devolpers (according to the rather old AUTHORS-file)
at 02/15/2002 without any response so far.

Maybe someone else familiar with gnujsp could provide a solution.

Gruesse,

 Thomas Springer
 (IT Security)

TUEV Informatik Service
Westendstr. 199
80806 München
Tel. 089 5791-2069
thomas.springer@tuev-sued.de
(pgp-signed mail welcome)

[[prev in list](?l=bugtraq&m=101413694023361&w=2)] [[next in list](?l=bugtraq&m=101415489815820&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=101422432123898&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.debian.org_ef90775e_20250125_203641.html ===

[![Debian](./Pics/openlogo-50.png)](./ "Debian Home")

[Skip Quicknav](#content)

* [Blog](https://bits.debian.org/ "Bits from Debian")
* [Micronews](https://micronews.debian.org "Micronews from Debian")
* [Planet](https://planet.debian.org/ "The Planet of Debian")

# Debian

# The Community

## Debian is a Community of People!

### DC24 Group Photo

![DebConf23 Group Photo](Pics/debconf24_group_photo.jpg)

### MiniDebConf Berlin 2024

![Group photo of the MiniDebConf Berlin 2024](Pics/mini-dc24-berlin.jpg)

### MiniDebConf BrasÃ­lia 2023

![Group photo of the MiniDebConf BrasÃ­lia 2023](Pics/mini-dc23-brasilia.jpg)

### Screenshot Calamares Installer

![Screenshot from the Calamares installer](Pics/calamares-bookworm.png)

### Debian is like a Swiss Army Knife

![Debian is like a Swiss Army Knife](Pics/debian-swiss-knife-hands-1024x576.jpg)

### People have fun with Debian

![Debian people at Debconf18 in Hsinchu really having fun](Pics/debian-funny-people-1024x576.jpg)

[![](Pics/users.svg)](intro/people)

## [People](intro/people)

Who we are and what we do

[![](Pics/heartbeat.svg)](intro/philosophy)

## [Our Philosophy](intro/philosophy)

Why we do it, and how we do it

[![](Pics/user-plus.svg)](devel/join/)

## [Get Involved, Contribute](devel/join/)

How you can join us!

[![](Pics/list.svg)](intro/index#community)

## [More...](intro/index#community)

Additional information about the Debian community

# The Operating System

## Debian is a complete Free Operating System!

![Debian](Pics/debian-logo-1024x576.png)
[Download](https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/debian-12.9.0-amd64-netinst.iso)
[Other downloads](distrib)

[![](Pics/trophy.svg)](intro/why_debian)

## [Why Debian](intro/why_debian)

What makes Debian special

[![](Pics/life-ring.svg)](support)

## [User Support](support)

Getting help and documentation

[![](Pics/security.svg)](security/)

## [Security Updates](security/)

Debian Security Advisories (DSA)

[![](Pics/list.svg)](intro/index#software)

## [More...](intro/index#software)

Further links to downloads and software

---

# Project News

## News and Announcements about Debian

17January2025[The Debian Project mourns the loss of Steve Langasek (vorlon)](News/2025/20250117)
11January2025[Updated Debian 12: 12.9 released](News/2025/20250111)
19November2024[The Debian Project mourns the loss of JÃ©rÃ©my Bobbio (Lunar)](News/2024/20241119)
31August2024[Updated Debian 11: 11.11 released](News/2024/2024083102)
14August2024[Security support for Bullseye handed over to the LTS team](News/2024/20240814)

[All the news](News)
[RSS](News/news)

---

This page is also available in the following languages:
Select your language
català
dansk
Deutsch
español
français
Galego
Indonesia
Italiano
magyar
Nederlands
norsk (bokmål)
polski
Português
suomi
svenska
Tiếng Việt
Български (Bəlgarski)
Русский (Russkij)
українська (ukrajins'ka)
عربية (Arabiya)
中文(简)
中文(HK)
中文(繁)
한국어 (Korean)
Ελληνικά (Ellinika)
فارسی (Farsi)

How to set [the default document language](./intro/cn)

---

See our [contact page](./contact) to get in touch. Web site source code is [available](https://salsa.debian.org/webmaster-team/webwml).

Last Modified: Sat, Sep 16 13:09:56 UTC 2023

Last Built: Sun, Jan 19 23:26:10 UTC 2025

Copyright © 1997-2025 [SPI](https://www.spi-inc.org/) and others; See [license terms](./license)

Debian is a registered [trademark](./trademark) of Software in the Public Interest, Inc.



=== Content from marc.info_45bae41d_20250125_203640.html ===

```
[[prev in list](?l=bugtraq&m=101438631921749&w=2)] [[next in list](?l=bugtraq&m=101424606825564&w=2)] [[prev in thread](?l=bugtraq&m=101415804625292&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Re: gnujsp: dir- and script-disclosure](?t=101415824800001&r=1&w=2)
From:       [Stefan Gybas <gybas () trustsec ! de>](?a=101422433900002&r=1&w=2)
Date:       [2002-02-20 15:54:22](?l=bugtraq&r=1&w=2&b=200202)
[Download RAW [message](?l=bugtraq&m=101422432123898&q=mbox) or [body](?l=bugtraq&m=101422432123898&q=raw)]

On Tue, Feb 19, 2002 at 03:51:01PM +0100, Thomas Springer wrote:

> Requesting <http://site/servlets/gnujsp/>[dirname]/[file] on a site running
> gnujsp, reveals directory-listing of any webdir including wwwroot, it also
> reveals the script-source of certain (not all!) script-types, depending on
> webserver-config.

The actual hole is in JServ (a servlet engine for which GNUJSP was mainly
written) since it sets the servlet PathInfo to [dirname]/[file] in the
above example. The GNUJSP servlet then incorrectly assumes that the
request was made to "<http://site/>[dirname]/[file]".

> I don't know enough about gnujsp to provide a solution - but it seems to be
> kind of a configuration flaw in standard-config of gnujsp.

There's a "denyuri" configuration option for GNUJSP but this is not a
good fix since

1. The same GNUJSP servlet can be called with multiple URIs (e.g.
   /servlets/gnujsp and /servlet/gnujsp)

2. It does not seem to work with GNUJSP 1.0.0 and JServ at all when
   there are servlet aliases

A more secure solution is the attached patch for GNUJSP 1.0.0 and 1.0.1
which forbids all direct requests to the GNUJSP servlet. Only files which
are mapped to the GNUJSP servlet (in most cases *.jsp) can be accessed
then.

--
Stefan Gybas
trustsec IT solutions GmbH

[["gnujsp-1.0.0.patch" (text/plain)]](?l=bugtraq&m=101422432123898&q=p3)

diff -ur src.old/org/gjt/jsp/JspServlet.java src/org/gjt/jsp/JspServlet.java
--- src.old/org/gjt/jsp/JspServlet.java	Mon Oct 18 19:28:52 1999
+++ src/org/gjt/jsp/JspServlet.java	Wed Feb 20 16:09:27 2002
@@ -262,6 +262,12 @@
 	    */
 	}

+	// Security check: Deny the request if the path is appended to
+	// the servlet URI -- gybas@trustsec.de
+	if (request.getRequestURI().startsWith(request.getServletPath())) {
+	    response.sendError(HttpServletResponse.SC_BAD_REQUEST);
+	}
+
 	String jspURI  = requestToJspURI (request);
 	if ((denyURI != null) && (jspURI.startsWith(denyURI))) {
 	    response.sendError(HttpServletResponse.SC_UNAUTHORIZED);

[["gnujsp-1.0.1.patch" (text/plain)]](?l=bugtraq&m=101422432123898&q=p4)

Only in src: DIFF
diff -ur src.old/org/gjt/jsp/JspServlet.java src/org/gjt/jsp/JspServlet.java
--- src.old/org/gjt/jsp/JspServlet.java	Thu Oct  5 09:28:00 2000
+++ src/org/gjt/jsp/JspServlet.java	Wed Feb 20 16:41:16 2002
@@ -598,6 +598,12 @@
 			  String jspURI)
 	throws IOException, ServletException
     {
+	// Security check: Deny the request if the path is appended to
+	// the servlet URI -- gybas@trustsec.de
+	if (request.getRequestURI().startsWith(request.getServletPath())) {
+	    response.sendError(HttpServletResponse.SC_BAD_REQUEST);
+	}
+
 	// Deny requests beginning with denyURI, if specified.
 	if ((denyURI != null) && (jspURI.startsWith(denyURI))) {
 	    response.sendError(HttpServletResponse.SC_UNAUTHORIZED);

[[prev in list](?l=bugtraq&m=101438631921749&w=2)] [[next in list](?l=bugtraq&m=101424606825564&w=2)] [[prev in thread](?l=bugtraq&m=101415804625292&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


