The provided content is related to CVE-2002-0276.

**Root cause of vulnerability:**
- The vulnerability lies in the improper use of the `memcpy()` function within several of Ettercap's decoders (e.g., mysql, irc). Specifically, the size of the data being copied (`data_to_ettercap->datalen`) can exceed the buffer allocated to receive it (`collector`).

**Weaknesses/vulnerabilities present:**
- **Buffer Overflow:** The `memcpy` copies data from the network payload into a fixed-size buffer (`collector`) without proper bounds checking. If the payload size is larger than the buffer, a buffer overflow occurs.
- **Lack of Input Validation:** The application fails to validate the length of the received network payload against the allocated buffer size.

**Impact of exploitation:**
- **Remote Root Compromise:** By exploiting the buffer overflow, an attacker can overwrite memory, allowing them to execute arbitrary code with the privileges of the Ettercap process, which is typically run as root. This can lead to full system compromise.
- **Application Crash:** Even if code execution is not achieved, an attacker can cause a denial of service by crashing the Ettercap application.

**Attack vectors:**
- **Network-based:** The vulnerability is exploited by sending specially crafted network packets to the machine running Ettercap.
- **Specific interface types:** The vulnerability is triggered on network interfaces where the MTU (Maximum Transmission Unit) is greater than 2000. Common ethernet interfaces with MTU of 1500 are not exploitable due to lack of reassembly in ettercap. However, loopback interfaces with large MTUs (e.g., 16436) are vulnerable.
- **Targeted protocol packets:** The vulnerability is triggered by sending packets that target one of the vulnerable decoders (e.g., mysql, irc).

**Required attacker capabilities/position:**
- **Network access:** The attacker must be able to send network packets to the target system running Ettercap.
- **Crafted packets:** The attacker must be able to craft packets with a payload size exceeding the `MAX_DATA` buffer size (2000 bytes) after TCP/UDP header.
- **Knowledge of affected protocols:** Attacker must send packets with the vulnerable protocol that ettercap is trying to decode.

**Additional Details:**
- The vulnerability is specific to Linux versions of Ettercap because on BSD and MacOSX, Ettercap only works on Ethernet devices with a smaller MTU.
- The advisory provides a link to an exploit for the vulnerability (`ettercap-x.c`).
- An example exploit is provided that shows how to gain root access using the vulnerability in a loopback interface environment.