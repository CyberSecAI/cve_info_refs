=== Content from marc.info_d149a376_20250125_073919.html ===

```
[[prev in list](?l=bugtraq&m=101370874219511&w=2)] [[next in list](?l=bugtraq&m=101371697211714&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Add2it Mailman command execution
From:       ["b0iler _" <b0iler () hotmail ! com>](?a=101296763500001&r=1&w=2)
Date:       [2002-02-14 0:57:32](?l=bugtraq&r=1&w=2&b=200202)
[Download RAW [message](?l=bugtraq&m=101371994219708&q=mbox) or [body](?l=bugtraq&m=101371994219708&q=raw)]

#!/exploit/by/b0iler
#
#Add2it Mailman Free V1.73
#script url: <http://www.add2it.com/scripts/mailman-free.shtml>

The problem is that the script does not filter input well:

$command = $ENV{'QUERY_STRING'};
($list, $email) = split(/=/,$command);

and then the script makes an open() call based on input from the user:

open(LIST, "${path}data/lists/$list");

There is also open()s with > and >> which use $list
The way to exploit this to write to a file would be:

../../../../file=data@to.write

or for command execution:

../../../../bin/command|=blah@bleh.com

This exploit is for the free version of Add2it Mailman, but the same
vulnerability is probably valid for the paid for version.

Fix: filter meta characters and .. and use < << > >> with open()

Author was contacted on 1/30/02 and replied that day stating the problem
would be fixed in the next release.  Which should be out by the time of this
posting, although I haven't gotten any word about it's release yet.

-<http://b0iler.advknowledge.net>

_________________________________________________________________
MSN Photos is the easiest way to share and print your photos:
<http://photos.msn.com/support/worldwide.aspx>

[[prev in list](?l=bugtraq&m=101370874219511&w=2)] [[next in list](?l=bugtraq&m=101371697211714&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.add2it.com_b0166331_20250125_073921.html ===


|  | |
| --- | --- |

| [Add2it Marketing Software Scripts & Services](https://add2it.com) |
| --- |

| | **Saturday, January 25 2025** | | --- | |
| --- | --- |

| | **Add2it Mailman Free Script History**  [Features & Benefits](mailman-free.shtml#Features & Benefits) | [Testimonials](mailman-free-testimonials.shtml) | [Demo](../mmf/demo/index.pl) | [Order Form](order.php) | [Updates + Announcements](mailman-free-update.shtml) | [History](mailman-free-history.shtml) | [Support Forum](../cgi-bin/discus/show.cgi?10/10) | [Affiliate Program](../ref/index.shtml)  03/07/03 - Add2it Mailman Free 1.83  New features:   * No URL to Add2it.com in standard subscribe & unsubscribe email messages anymore.   Bugs fixed:   * Leading dot characters (.) in messages lines are now being replaced with a colon character (:) in order to prevent truncated messages on some server.  02/04/03 - Add2it Mailman Free 1.82  New feature:   * Improved display of online manual.   Bug fixed:   * Sending of a new password to the admins email address works now   again properly.  12/11/02 - Add2it Mailman Free 1.81  New features:   * Allows up to 10 lists with up to 5,000 subscriber total. * File logging routines   improved for additional security. * New login now   only needed after password got changed. Changing any other   script settings does not require a new login anymore.   Bug fixed:   * The email check   is now 100% RFC 822 compatible. Additionally the script does   now recognize invalid email addresses with more than one @-character, .-, -. or two dots (.) in a row. It also allows now e.g. .info email   addresses. * Bug fixed that didn't allow to save another preferred language   than English. * Bug fixed that allowed subscribers to subscribe without   firstname, lastname or fouth field, even if that field has been required for that list.  02/19/02 - Add2it Mailman Free 1.80  Security problem fixed:   * Now it is impossible to write to or execute files on a server that are outside the Add2it Mailman Free directory.   New features:   * When you enter the password page the focus will now be right away on the password field. * With admin.cgi?pass=<admin-password> you can skip the password check and enter the Admin Control Center right away. * Improved and shorter header area view of all outgoing messages. * New message line type can now be chosen to prevent send message problems on some servers. * Add2it Affiliate Program members can now customize all links in the script to show their own affiliate id. * Several script routines are now improved for higher processing speed.   Bugs fixed:   * Leading dot characters (.) in messages lines are now being replaced with a colon character (:) in order to prevent truncated messages on some server. * All quotation characters (") in first and last names are now being replaced with a single quotation characters (') in order to prevent error messages while sending messages on some server.  10/05/01 - Add2it Mailman Free 1.73  New feature:   * In the header area of outgoing emails are now additional information for the receiver.   There are information about:   -    the sender (all emails)   -    the receiver himself (all emails)   -    the list (not in unsubscribe messages and reports)   -   how to unsubscribe (not in unsubscribe messages and reports)      This changes have been necessary to protect Add2it from the improper use of Add2it Mailman Free through the sending of "SPAM" messages.      Using earlier versions of Add2it Mailman Free is hereby   not anymore permitted.   09/27/01 - Add2it Mailman Free 1.72  New features:   * When you enter the password page the focus will now be right away on the password field. * With admin.cgi?pass=<admin-password> you can skip the password check and enter the Admin Control Center right away. * The "X-Attention:" header will now show exact subscriber data.   Bugs fixed:   * In case you get an "Maybe you don't have access to this mail server or maybe the recipient email address is an invalid email address." error message while sending a message to a list, you can now choose to try to skip over the email address. * The "X-Attention:" header will now only be added when you send a message to a list.  08/13/01 - Add2it Mailman Free 1.71  Bugs fixed:   * Sending mail with a   SMTP server works now also with the CommuniTech.Net web host. * An bug has been removed   that caused an early interruption of the "Remove Subscriber"   routine in case that an illegal email address had been found.  07/25/01 - Add2it Mailman Free 1.70  New features:   * Interupted send message   as well as adding or removing lists of subscribers sessions can   now be continued at anytime. * In case the administrator   forgot the access password, the script can now email him or her   a new password. * The method of sending   messages as well as adding or removing lists of subscribers has   been improved. To prevent timeouts on some servers, the script works   now in blocks of time instead of blocks of subscribers.   Security problem fixed:   * On some servers it   was before possible to load the contiguration data. Now the administrator   password is saved encrypted.   Bug fixed:   * Now subscribers can   change their email address when selected by the administrator in   the list settings. * When a new list is created   the script saves now the correct "Added HTML" text. * If you send out a HTML   message the added ad does not use so much space anymore.  05/28/01 - Add2it Mailman Free 1.61  Bug fixed:   * Anywhere in the script   it is now not longer possible to advance into the next menu without   choosing a list.  05/24/01 - Add2it Mailman Free 1.60  New features:   * The   main menu of the Admin Control Center has been redone. Now there   are three section that are sorted by the frequency that they are   needed. * Orientation within the   script has been improved by adding the current edited list title   to the headers of all pages. * The status display   while sending messages, while adding and removing subscribers starts   now with "0 out of x". * Standard autoresponse   email messages have been added and the standard HTML answer pages   improved.   Bugs fixed:   * List titles can not   be given more than once anymore. Additionally it is no longer possible   to forget the list title. * Overwriting existing   subscriber entries is working properly now. * While adding subscribers,   manually as well as automatically, all characters that are not allowed   will now be automatically removed from the email address. * Deleting of several   banned email addresses works now properly. Additionally it is no   longer possible to save empty entries. * A wrong link within   the status display while sending messages, while adding and removing   subscribers has been corrected.  03/09/01 - Add2it Mailman Free 1.51  Bug fixed:   * A new and empty list   will not produce an error message anymore (file missing) when a   new subscribers tries to be added.  03/07/01 - Add2it Mailman Free 1.50  New features:   * Installation is now   much easier with the install.cgi script. It creates all sub-directories,   moves all files and sets on Unix systems all permissions automatically.      BTW: There are   now three language files for every language. * There are two tags that   can now be used within messages that are send, within autoresponses   as well as within the HTML response pages:   <list>     for the filename of the list and   <listtitle>  for the title of the list. * The administrator can   now choose to overwrite existing subscriber entries while adding   new subscribers manually. * If the administrator   does not choose to overwrite existing subscriber entries while adding   new subscribers manually, the script will now show in the results   which subscriber have been on the list already including old and   new data. * If somebody tries to   subscribe to a list and that email address is already on that list,   the script will give that person the possibility to change and save   the subscriber data. * The standard subscribe   and unsubscribe subject can now also include tags (<email>,   <fname>, <lname>,    <list>    and <listtitle>). * The "Get HTML" options   gives now more possibilities on how to use the script i.e. email   links.   Bug fixed:   * The admin name had not   been used in the header of messages that had been send out in the   last version of the script.  02/16/01 - Add2it Mailman Free 1.40  New features:   * The script can now   be used on Unix as well as NT servers. * You can now use tags   (<email>, <lname> or <misc1>)   within the "Save this if no first name is given" field of the setup   manager. Now, if no first name is given the script can either display   a text of your choice or automatically display for example the email   address, the last name or the misc field instead. * The "send a personalized   message" function shows now a summary after sending the message. * The script is now multilingual.   Both, users as well as the administrator, can switch now to their   preferred language while using the script.      So far I have language files in English and German. I am looking   for translations into Spanish, French, Italian and so on.      If you are interested to provide a translation of two small text   files (language.txt & language2.txt), please [email   me](../contact.shtml).      Please let me know the language that you want to translate into   and I will let you know if that language is still needed.   Security problem fixed:   * A small but important   security hole has been fixed. Now it is no longer possible for somebody   who can read the script source souce to enter the admin area without   a password.   Bug fixed:   * It is no longer possible   to use a space within the filename of a list. Now all spaces will   be converted into dashes.  01/07/01 - Add2it Mailman Free 1.32  New feature:   * The "View and edit   the source of a list" as well as the "Add subscribers to a list"   functions have been improved. It is no longer possible to mess up   a list by entering invalid data.  12/26/00 - Add2it Mailman Free 1.31  New features:   * With $maxao in the   admin.cgi file you can adjust now the maximum amount of manual subscription,   unsubscriptions or messages send at each run. In case that your   server stops early you can decrease the number. Recommended: 300 * The message box wraps   the text now virtually.   Bug fixed:   * The script now intercepts   if a wrong filename was entered when adding a new list.  12/12/00 - Add2it Mailman Free 1.30  New features:   * When you add or remove   lists of subscribers within the Admin Center as well as when you   send a message to a list the script keeps you informed about the   progress of the current process while it is working on it. * At the end of the adding   or removing process it now offers you additionally simple copy and   paste lists of that addresses that have been invalid, banned, not   on the list and / or already on the list. * Within the Admin Center   the script informs the administrator now about new versions of the   script, as soon as they become available. * The navigational system   within the Admin Center has been improved by adding "Return to the   last page" and "Return to the Admin Center Menu" links to all pages.  11/22/00 - Add2it Mailman Free 1.21  Bug fixed:   * The first time the   script will be called it will now show all texts properly.  10/26/00 - Add2it Mailman Free 1.20  New features:   * Language-Kit function   added. In order to change the language of all scripts to any other   language you just need to translate two simple text files: language.kit   (all texts for subscribers) and language2.kit (all texts for the   administrator).       Please [send me](../contact.shtml) all translated versions of both files for publication. * Within the admin menu   area all lists are now always sorted alphabetically.  10/08/00 - Add2it Mailman Free 1.10  Security problem fixed:   * Data files are now   protected from being read by other people than the administrator.   All subdirectories have to have file permission 766 (chmod 766).   Bugs fixed:   * List settings are now   shown correctly. * Required fields for   adding subscribers are now really enforced. * Adding several subscribers   at once works now correctly. * Get HTML shows now the   correct HTML code.   New features:   * Remove subscribers   function got changed to make it easier to be used. * When you send a personalized   message to a list the script will have no list choosen by default.   This will make it less likely that messages are being send to the   wrong list. * Within the settings   of this script you can now enter the default that will be saved   if no first name is given.  09/17/00 - Add2it Mailman Free 1.02  Bug fixed:   * The admin did never   receive a copy of the subscribe request.  09/15/00 - Add2it Mailman Free 1.01  Bug fixed:   * The first three options   in the "edit list options" section had always been displayed as   off.  09/15/00 - Add2it Mailman Free 1.00 has been released! [Features & Benefits](mailman-free.shtml#Features & Benefits) | [Testimonials](mailman-free-testimonials.shtml) | [Demo](../mmf/demo/index.pl) | [Order Form](order.php) | [Updates + Announcements](mailman-free-update.shtml) | [History](mailman-free-history.shtml) | [Support Forum](../cgi-bin/discus/show.cgi?10/10) | [Affiliate Program](../ref/index.shtml) | | --- | |
| --- | --- |
|  |

|  | |
| --- | --- |
| | • © Copyright 2000-2025 by [Add2it.com](https://add2it.com) Marketing Pty Ltd. All Rights Reserved. • | • [Contact Information](https://add2it.com/au/contact/)• | | --- | --- | | • [Add2it.com](https://add2it.com) Marketing Pty Ltd • [Frank Bauer](https://frankbauer.name) • P.O. Box 290 • Stanhope Gardens NSW 2768 • Australia • | | |  | | |


