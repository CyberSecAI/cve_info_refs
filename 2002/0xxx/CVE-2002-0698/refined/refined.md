- **Root cause of vulnerability:** An unchecked buffer exists in the Internet Mail Connector (IMC) of Microsoft Exchange Server 5.5 when responding to the SMTP EHLO command.
- **Weaknesses/vulnerabilities present:** Buffer overflow in the IMC when constructing the EHLO response. The IMC generates a response string that includes the FQDN of the Exchange server and the FQDN or IP address of the connecting server. If the combined length of these server identifiers exceeds a certain limit, a buffer overflow occurs.
- **Impact of exploitation:**
    -  If overwritten with random data: IMC service failure
    - If overwritten with attacker-controlled data: Arbitrary code execution in the security context of the IMC service (which runs as the Exchange 5.5 Service Account), potentially leading to complete control over the server.
- **Attack vectors:**
    - Attacker connects to a vulnerable Exchange 5.5 server via SMTP and sends an EHLO command.
    - The attacker needs to control or influence the reverse DNS lookup process to ensure the resolved FQDN of the attacker's server is long enough to cause the buffer overflow.
- **Required attacker capabilities/position:**
    - Ability to establish an SMTP connection to the vulnerable Exchange server.
    - Ability to influence or control the DNS server that the Exchange server uses for reverse DNS lookups, either by controlling the DNS server or by injecting a large FQDN record for the attacking server.