## Analysis of CVE-2002-0618

The provided content contains information about the **"Excel XSL Stylesheet Script Execution" vulnerability (CAN-2002-0618)**, which is addressed in Microsoft Security Bulletin MS02-031.

Here's a breakdown of the vulnerability based on the provided information:

**Root Cause:**

*   The vulnerability exists due to a flaw in how Excel handles XSL stylesheets within Excel workbooks under the Macro Security Model.
*   The Macro Security Model fails to correctly detect the presence of HTML scripting when contained within an Excel workbook that contains an XSL stylesheet.

**Vulnerability:**

*   **Weakness:** Improper handling of HTML scripting within XSL stylesheets in Excel workbooks.
*   **Vulnerability:** Failure of the Macro Security Model to detect and block the execution of such scripts.

**Impact of Exploitation:**

*   An attacker can execute HTML scripts as if they were run locally on the user's system (Local Computer zone).
*   Scripts can perform actions that the user is capable of, such as adding, changing, or deleting files, or changing security settings.

**Attack Vector:**

*   Attacker creates a malicious Excel workbook containing an XSL stylesheet with embedded HTML script.
*   The attacker entices the user to open the malicious workbook (e.g., via download or email attachment).
*   The user is prompted to apply the XSL stylesheet and must acknowledge it by clicking "yes" (non-default option).
*   The script within the XSL stylesheet executes with local computer zone privileges.

**Required Attacker Capabilities/Position:**

*   Ability to craft a malicious Excel workbook with an XSL stylesheet containing HTML script.
*   Ability to deliver the malicious file to the victim.
*   The attacker needs to convince the user to open the file and then to *explicitly* choose to apply the stylesheet (by clicking 'yes' on a prompt).

**Mitigating Factors:**

*   User interaction is *always* required. There's no automated attack possible.
*   Exploitation is dependent on the user choosing the non-default option to apply the XSL stylesheet.
*   Any restrictions on the user's ability to make changes to the system also limit the attacker's script.

**Patch Information:**

*   The patch ensures that the Macros Security Model is applied when Excel opens workbooks containing XSL stylesheets.
*   The specific result after applying the patch depends on the security setting of the Macro Security Model.

The advisory from guninski.com provides a proof-of-concept example. The file contains both XML and a stylesheet in one file.