=== Content from www.kb.cert.org_be845820_20250124_183630.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#314963

## OpenBSD kernel fails to properly check closed file descriptors "0-2" when running setuid program

#### Vulnerability Note VU#314963

Original Release Date: 2002-05-24 | Last Revised: 2002-12-12

---

### Overview

The OpenBSD kernel does not adequately check file descriptors 0-2 prior to exec()ing setuid binaries. Other OS kernels may be vulnerable as well.

### Description

| The OpenBSD kernel does not adequately check file descriptors 0-2 prior to exec()ing setuid binaries. As a result, an attacker may be able to gain elevated privileges. |
| --- |

### Impact

| A local attacker can gain root privileges. |
| --- |

### Solution

| Apply a patch from your vendor.  OpenBSD patches are available from:**OpenBSD Patch 026\_fdalloc2.patch:**ftp://ftp.openbsd.org/pub/OpenBSD/patches/2.9/common/026\_fdalloc2.patch**OpenBSD 3.0:**ftp://ftp.openbsd.org/pub/OpenBSD/patches/3.0/common/021\_fdalloc2.patch**OpenBSD 3.1:**ftp://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/003\_fdalloc2.patch |
| --- |

### Vendor Information

314963
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23314963/) to view vendors.**
### [OpenBSD](#IAFY-5A7N3Q) Affected

Updated:  May 16, 2002

### Status

Affected

### Vendor Statement

In July of 1998 the OpenBSD kernel was modified to populate file
descriptors 0-2 on exec for setuid (and setgid) processes. This
was done to defeat an attack on setuid programs that open files for
writing and also write to descriptors 0-2 (usually via stdin, stdout
or stderr).

The fix at that time didn't properly deal with the possibility that
the allocation of the dummy descriptors could fail due to a full
file descriptor table. It has come to our attention that there is
a winnable race condition when the file descriptor table is full,
allowing an fd 0-2 attack to succeed.

Credit for finding this goes to FozZy of Hackademy / Hackerz Voice.
Please see his advisory on bugtraq for more in-depth details.

The following patches are available:

OpenBSD-3.1:
ftp://ftp.openbsd.org/pub/OpenBSD/patches/3.1/common/003\_fdalloc2.patch

OpenBSD-3.0:
ftp://ftp.openbsd.org/pub/OpenBSD/patches/3.0/common/021\_fdalloc2.patch

OpenBSD-2.9:
ftp://ftp.openbsd.org/pub/OpenBSD/patches/2.9/common/026\_fdalloc2.patch

OpenBSD-current as well as the OpenBSD 2.9, 3.0 and 3.1 -stable
branches have already been patched.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [The SCO Group](#IAFY-5GRLRA) Affected

Notified:  May 09, 2002  Updated: December 12, 2002

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Title
=====

SCO Security Advisory:

UnixWare 7.1.1 Open UNIX 8.0.0 : closed file descriptor race vulnerability

Detail
======

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

SCO Security Advisory

Subject:UnixWare 7.1.1 Open UNIX 8.0.0 : closed file descriptor race vulnerability
Advisory number: CSSA-2002-SCO.43
Issue date: 2002 December 09
Cross reference:
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

1. Problem Description

 On current OpenBSD systems, any local user (being or not in
 the wheel group) can fill the kernel file descriptors table,
 leading to a denial of service. Because of a flaw in the way
 the kernel checks closed file descriptors 0-2 when running a
 setuid program, it is possible to combine these bugs and earn
 root access by winning a race condition.

 Since UnixWare does not have a global kernel file descriptors
 table (it has per-process dynamic file descriptors table), it
 is not prone to the denial of service attack and the race
 condition resulting in root exploit.

 The second problem, however, does exist - closing file
 descriptors 0, 1 and/or 2 before exec'ing a setuid program
 can make this program open files under these fds, which have
 special meanings for libc (stdin/out/err). Reading or writing
 to root-owned files can be made possible, since
 stdXX==opened\_file.

 The fix done for BSD is to check (in the kernel) before
 exec'ing a set[ug]id program if fd 0, 1 and 2 are closed, and
 if so redirect them to /dev/null. We have done the same fix
 for UnixWare.

 This fix will only kick in when an unprivileged process
 execs a set[ug]id program.

2. Vulnerable Supported Versions

SystemBinaries
----------------------------------------------------------------------
UnixWare 7.1.1 /etc/conf/pack.d/proc/Driver\_atup.o
/etc/conf/pack.d/proc/Driver\_mp.o

Open UNIX 8.0.0 /etc/conf/pack.d/proc/Driver\_atup.o
/etc/conf/pack.d/proc/Driver\_mp.o

3. Solution

The proper solution is to install the latest packages.

4. UnixWare 7.1.1

4.1 Location of Fixed Binaries

 ftp://ftp.sco.com/pub/updates/OpenUNIX/CSSA-2002-SCO.43

4.2 Verification

MD5 (erg712059.711.pkg.Z) = 1545beb0d12890de701e129de54bf7b6

md5 is available for download from
ftp://ftp.sco.com/pub/security/tools

4.3 Installing Fixed Binaries

\*\*\* NOTE: THE UW711M2 SUPPLEMENT MUST BE INSTALLED PRIOR TO
          APPLYING THIS UPDATE.

Upgrade the affected binaries with the following sequence:

Download erg712059.711.pkg.Z to the /var/spool/pkg directory

# uncompress /var/spool/pkg/erg712059.711.pkg.Z
# pkgadd -d /var/spool/pkg/erg712059.711.pkg

5. Open UNIX 8.0.0

5.1 Location of Fixed Binaries

 ftp://ftp.sco.com/pub/updates/OpenUNIX/CSSA-2002-SCO.43

5.2 Verification

MD5 (erg712059.ou8.pkg.Z) = 9291ab96576e48b55e981190480855ca

md5 is available for download from
ftp://ftp.sco.com/pub/security/tools

5.3 Installing Fixed Binaries

\*\*\* NOTE: THE OU800PK4 SUPPLEMENT MUST BE INSTALLED PRIOR TO
          APPLYING THIS UPDATE.

Upgrade the affected binaries with the following sequence:

Download erg712059.ou8.pkg.Z to the /var/spool/pkg directory

# uncompress /var/spool/pkg/erg712059.ou8.pkg.Z
# pkgadd -d /var/spool/pkg/erg712059.ou8.pkg

6. References

Specific references for this advisory:

 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0766>

SCO security resources:

 <http://www.sco.com/support/security/index.html>

This security fix closes SCO incidents sr865063, fz526562,
erg712059.

7. Disclaimer

SCO is not responsible for the misuse of any of the information
we provide on this website and/or through our security
advisories. Our advisories are a service to our customers
intended to promote secure installation and use of SCO
products.

8. Acknowledgements

FozZy <fozzy@dmpfrance.com>, et al. discovered and researched
this vulnerability.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Apple Computer Inc.](#IAFY-5A6JYW) Not Affected

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Not Affected

### Vendor Statement

Mac OS X does not contain this vulnerability.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Cray Inc.](#IAFY-5A6Q5W) Not Affected

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Not Affected

### Vendor Statement

Cray, Inc. is not vulnerable since the skey program is not supported in Unicos and Unicos/mk.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [FreeBSD](#IAFY-5A6NR3) Not Affected

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Not Affected

### Vendor Statement

We are not affected.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Hewlett-Packard Company](#IAFY-5A6NPZ) Not Affected

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Not Affected

### Vendor Statement

HP-UX is not vulnerable.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [IBM](#IAFY-5A6NQA) Not Affected

Notified:  May 09, 2002  Updated: May 16, 2002

### Status

Not Affected

### Vendor Statement

IBM's AIX operating system is not vulnerable.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [SGI](#IAFY-5A6Q43) Not Affected

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Not Affected

### Vendor Statement

IRIX is not vulnerable.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [BSDI](#IAFY-5A6KC9) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Cisco Systems Inc.](#IAFY-5A6QAU) Unknown

Notified:  May 10, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Compaq Computer Corporation](#IAFY-5A6NS6) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Data General](#IAFY-5A6QQN) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Debian](#IAFY-5A6NQV) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Fujitsu](#IAFY-59ZHVL) Unknown

Notified:  May 09, 2002  Updated: May 10, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Guardian Digital Inc.](#IAFY-5A6Q2U) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [MandrakeSoft](#IAFY-5A6Q7U) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [NEC Corporation](#IAFY-5A6Q2N) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [NetBSD](#IAFY-5A6Q4X) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Nortel Networks](#IAFY-5A4P8F) Unknown

Notified:  May 09, 2002  Updated: May 13, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Red Hat Inc.](#IAFY-59ZHW6) Unknown

Notified:  May 09, 2002  Updated: May 10, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [SSH Communications Security](#IAFY-5A6QTP) Unknown

Notified:  May 10, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Sequent](#IAFY-5A6NRB) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Sony Corporation](#IAFY-5A6JW9) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [SuSE Inc.](#IAFY-5A6Q79) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Sun Microsystems Inc.](#IAFY-5A6QQY) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Unisys](#IAFY-5A6Q48) Unknown

Notified:  May 09, 2002  Updated: May 15, 2002

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

View all 26 vendorsView less vendors

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.dmpfrance.com/fd_openbsd.c>
* <http://www.securityfocus.com/bid/4708>
* <http://www.openbsd.org/errata.html#fdalloc2>
* <http://www.openbsd.org/errata30.html#fdalloc2>
### Acknowledgements

This document was written by Ian A. Finlay.

### Other Information

| **CVE IDs:** | [None](http://web.nvd.nist.gov/vuln/detail/None) |
| --- | --- |
| **Severity Metric:** | 29.53 |
| **Date Public:** | 2002-05-09 |
| **Date First Published:** | 2002-05-24 |
| **Date Last Updated:** | 2002-12-12 16:00 UTC |
| **Document Revision:** | 26 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.openbsd.org_a41bb07d_20250124_183631.html ===


OpenBSD: Errata and Patches

## [*Open***BSD**](index.html) Errata and Patches

---

For OpenBSD patch branch information, please refer
[here](stable.html).

For errata on a certain release, click below:

[2.0](errata20.html),
[2.1](errata21.html),
[2.2](errata22.html),
[2.3](errata23.html),
[2.4](errata24.html),
[2.5](errata25.html),
[2.6](errata26.html),
[2.7](errata27.html),
[2.8](errata28.html),
[2.9](errata29.html),
[3.0](errata30.html),
[3.1](errata31.html),
[3.2](errata32.html),
[3.3](errata33.html),
[3.4](errata34.html),
[3.5](errata35.html),

[3.6](errata36.html),
[3.7](errata37.html),
[3.8](errata38.html),
[3.9](errata39.html),
[4.0](errata40.html),
[4.1](errata41.html),
[4.2](errata42.html),
[4.3](errata43.html),
[4.4](errata44.html),
[4.5](errata45.html),
[4.6](errata46.html),
[4.7](errata47.html),
[4.8](errata48.html),
[4.9](errata49.html),
[5.0](errata50.html),
[5.1](errata51.html),

[5.2](errata52.html),
[5.3](errata53.html),
[5.4](errata54.html),
[5.5](errata55.html),
[5.6](errata56.html),
[5.7](errata57.html),
[5.8](errata58.html),
[5.9](errata59.html),
[6.0](errata60.html),
[6.1](errata61.html),
[6.2](errata62.html),
[6.3](errata63.html),
[6.4](errata64.html),
[6.5](errata65.html),
[6.6](errata66.html),
[6.7](errata67.html),

[6.8](errata68.html),
[6.9](errata69.html),
[7.0](errata70.html),
[7.1](errata71.html),
[7.2](errata72.html),
[7.3](errata73.html),
[7.4](errata74.html),
[7.5](errata75.html),
[7.6](errata76.html).


