=== Content from www.kb.cert.org_6947c24d_20250125_222529.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#818939

## Microsoft Windows SQL Server allows arbitrary queries to be executed via "xp\_displayparamstmt" extended procedure

#### Vulnerability Note VU#818939

Original Release Date: 2002-08-16 | Last Revised: 2002-08-16

---

### Overview

MS SQL Server contains an extended stored procedure with inappropriate permission settings.

### Description

| Microsoft SQL Server 7.0 and Microsoft SQL Server 2000 contain an extended stored procedure, *xp\_displayparamstmt*, that permits an unprivileged user of a database to gain administrative access to the database. For more information, please see  <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-043.asp> and<http://www.ngssoftware.com/advisories/mssql-esppu.txt>This vulnerability was discovered David Litchfield of NGSSoftware. |
| --- |

### Impact

| An intruder can gain administrative access to a vulnerable SQL Server database. |
| --- |

### Solution

| Apply a patch as described in <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-043.asp>. |
| --- |

### Vendor Information

818939
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23818939/) to view vendors.**
### [Microsoft Corporation](#SVHN-5D3U4E) Affected

Updated:  August 16, 2002

### Status

Affected

### Vendor Statement

See <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-043.asp>

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.microsoft.com/technet/security/bulletin/MS02-043.asp>
* <http://www.ngssoftware.com/advisories/mssql-esppu.txt>
### Acknowledgements

Thanks to David Litchfield for reporting this vulnerability.

This document was written by Shawn V Hernan.

### Other Information

| **CVE IDs:** | [CVE-2002-0721](http://web.nvd.nist.gov/vuln/detail/CVE-2002-0721) |
| --- | --- |
| **Severity Metric:** | 12.66 |
| **Date Public:** | 2002-08-16 |
| **Date First Published:** | 2002-08-16 |
| **Date Last Updated:** | 2002-08-16 22:16 UTC |
| **Document Revision:** | 5 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.kb.cert.org_65f0c195_20250125_222530.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#939675

## Microsoft Windows SQL Server allows arbitrary queries to be executed via "xp\_printstatements" extended procedure

#### Vulnerability Note VU#939675

Original Release Date: 2002-08-16 | Last Revised: 2002-08-16

---

### Overview

MS SQL Server contains an extended stored procedure with inappropriate permission settings.

### Description

| Microsoft SQL Server 7.0 and Microsoft SQL Server 2000 contain an extended stored procedure, *xp\_printstatements*, that permits an unprivileged user of a database to gain administrative access to the database. For more information, please see  <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-043.asp> and<http://www.ngssoftware.com/advisories/mssql-esppu.txt>This vulnerability was discovered David Litchfield of NGSSoftware. |
| --- |

### Impact

| An intruder can gain administrative access to a vulnerable SQL Server database. |
| --- |

### Solution

| Apply a patch as described in <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-043.asp>. |
| --- |

### Vendor Information

939675
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23939675/) to view vendors.**
### [Microsoft Corporation](#SVHN-5D3U7P) Affected

Updated:  August 16, 2002

### Status

Affected

### Vendor Statement

See <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-043.asp>.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.microsoft.com/technet/security/bulletin/MS02-043.asp>
* <http://www.ngssoftware.com/advisories/mssql-esppu.txt>
### Acknowledgements

Thanks to David Litchfield for reporting this vulnerability.

This document was written by Shawn V Hernan.

### Other Information

| **CVE IDs:** | [CVE-2002-0721](http://web.nvd.nist.gov/vuln/detail/CVE-2002-0721) |
| --- | --- |
| **Severity Metric:** | 12.66 |
| **Date Public:** | 2002-08-16 |
| **Date First Published:** | 2002-08-16 |
| **Date Last Updated:** | 2002-08-16 22:21 UTC |
| **Document Revision:** | 5 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from marc.info_a2258f63_20250125_222527.html ===

```
[[prev in list](?l=bugtraq&m=102952455725765&w=2)] [[next in list](?l=bugtraq&m=102950473602963&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=102950792606475&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Microsoft SQL Server Extended Stored Procdure privilege upgrade vulnerabilities (#NISR15002002A)](?t=102950489500004&r=1&w=2)
From:       ["David Litchfield" <david () ngssoftware ! com>](?a=102270039200002&r=1&w=2)
Date:       [2002-08-16 3:11:16](?l=bugtraq&r=1&w=2&b=200208)
[Download RAW [message](?l=bugtraq&m=102950473002959&q=mbox) or [body](?l=bugtraq&m=102950473002959&q=raw)]

NGSSoftware Insight Security Research Advisory

Name: Extended Stored Procedure Privilege Upgrade
Systems: Microsoft SQL Server 2000 and 7
Severity: High Risk
Category: Privilege Escalation
Vendor URL: <http://www.microsoft.com/>
Author: David Litchfield (david@ngssoftware.com)
Advisory URL: <http://www.ngssoftware.com/advisories/mssql-esppu.txt>
Date: 15th August 2002
Advisory number: #NISR15002002A

Description
***********
Microsoft SQL Server 2000 and 7 extends functionality by using extended
stored procedures. Three particular extended stored procedures contain a
vulnerability that allow a low privileged user to run abritrary SQL queries
in the context of the
account running SQL Server.

Details
*******
SQL Server supports two forms of authentication. The first is where a user
uses an SQL login and password to authenticate and the second is through
Windows Authentication. Any user authenticated by Windows can "upgrade"
their privileges to that of the account running the SQL Server by using one
of three extended stored procedures. These stored procedures allow a user to
run an arbitrary SQL query. By exploiting this problem a low privileged user
will be able to run any stored procedure, extended or otherwise, and select
from, update or insert into any table in any database. That is by exploiting
these holes an attacker can fully compromise the database server and its
data. Whilst an SQL Login user can not directly exploit this vulnerability
they can do so indirectly by submitting a job to the SQL Agent. As this the
SQL Agent authenticates to the SQL Server and runs in the context of Windows
account these vulnerabilities can be exploited. Please see NGSSoftware alert
NISR15002002A (<http://www.ngssoftware.com/advisories/mssql-esppu.txt>) for
more details.

Fix Information
***************
NGSSoftware informed Microsoft of these issues in July. Microsoft has
produced a patch that resolves these issues. Please see

<http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/>
bulletin/MS02-043.asp

for more details.

For those SQL Server database administrators who are not able to patch
immediately NGSSoftware recommend that they remove public access to these
stored procedures. This will prevent low privileged users from accessing
these extended stored procedures.

xp_execresultset
xp_printstatements
xp_displayparamstmt

A check for this vulnerability has been added to Typhon II, NGSSoftware's
vulnerability assessment scanner, of which, more information is available
from the NGSSite, <http://www.ngssoftware.com/>.

[[prev in list](?l=bugtraq&m=102952455725765&w=2)] [[next in list](?l=bugtraq&m=102950473602963&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=102950792606475&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.kb.cert.org_e588a4b5_20250125_222528.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#399531

## Microsoft Windows SQL Server allows arbitrary queries to be executed via "xp\_execresultset" extended procedure

#### Vulnerability Note VU#399531

Original Release Date: 2002-08-16 | Last Revised: 2002-08-16

---

### Overview

MS SQL Server contains an extended stored procedure with inappropriate permission settings.

### Description

| Microsoft SQL Server 7.0 and Microsoft SQL Server 2000 contain an extended stored procedure, *xp\_execresultset*, that permits an unprivileged user of a database to gain administrative access to the database. For more information, please see  <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-043.asp> and<http://www.ngssoftware.com/advisories/mssql-esppu.txt>This vulnerability was discovered David Litchfield of NGSSoftware. |
| --- |

### Impact

| An intruder can gain administrative access to a vulnerable SQL Server database. |
| --- |

### Solution

| Apply a patch as described in <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-043.asp>. |
| --- |

### Vendor Information

399531
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23399531/) to view vendors.**
### [Microsoft Corporation](#SVHN-5D3U2R) Affected

Updated:  August 16, 2002

### Status

Affected

### Vendor Statement

See <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-043.asp>

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.microsoft.com/technet/security/bulletin/MS02-043.asp>
* <http://www.ngssoftware.com/advisories/mssql-esppu.txt>
### Acknowledgements

Thanks to David Litchfield of NGS Software for reporting this vulnerability.

This document was written by Shawn V Hernan.

### Other Information

| **CVE IDs:** | [CVE-2002-0721](http://web.nvd.nist.gov/vuln/detail/CVE-2002-0721) |
| --- | --- |
| **Severity Metric:** | 12.66 |
| **Date Public:** | 2002-08-16 |
| **Date First Published:** | 2002-08-16 |
| **Date Last Updated:** | 2002-08-16 22:14 UTC |
| **Document Revision:** | 4 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from docs.microsoft.com_b4dbb96b_20250125_222530.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-043.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS02-043 - Moderate

## Cumulative Patch for SQL Server (Q316333)

Published: August 14, 2002 | Updated: February 28, 2003

**Version:** 1.2

**Originally posted:** August 14, 2002

**Updated:** February 28, 2003

#### Summary

**Who should read this bulletin:**
System administrators using MicrosoftÂ® SQL Serverâ¢ 7.0 and 2000 and Microsoft Desktop Engine 1.0 and 2000.

**Impact of vulnerability:**
Elevation of privilege.

**Maximum Severity Rating:**
Moderate

**Recommendation:**
System administrators should apply the patch to affected systems.

**Note:** The patch released with this bulletin is effective in protecting SQL Server 2000 and MSDE 2000 against the "SQL Slammer" worm virus. However, this patch has been superseded by the patch released with [MS02-061](https://technet.microsoft.com/security/bulletin/ms02-061) which contains fixes for additional security vulnerabilities in these products. Microsoft recommends that SQL 2000 and MSDE 2000 customers apply the patch from [MS02-061](https://technet.microsoft.com/security/bulletin/ms02-061).

**Affected Software:**

* Microsoft SQL Server 7.0
* Microsoft Desktop Engine (MSDE) 1.0
* Microsoft SQL Server 2000
* Microsoft Desktop Engine (MSDE) 2000

### General Information

## Technical details

**Technical description:**

This security patch does not contain a patch from Microsoft Knowledge Base Article [317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) that is required to ensure normal operation of SQL Server 2000 and MSDE 2000. If you have applied this security patch to a SQL Server 2000 or MSDE 2000 installation prior to applying the hotfix from Microsoft Knowledge Patch article [317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748), you must answer "no" if and when prompted to overwrite files to ensure that you do not overwrite files from the security patch.

This is a cumulative patch that includes the functionality of all previously released patches for SQL Server 7.0 and SQL Server 2000. In addition, it eliminates a newly discovered vulnerability.

SQL Server 7.0 and SQL Server 2000 provide for extended stored procedures, which are external routines written in programming languages such as C or C#. These procedures appear as normal stored procedures to users and can be invoked and executed just like normal stored procedures. By default, SQL Server 7.0 and SQL Server 2000 ship with a number of extended stored procedures which are used for various helper functions.

Some of the Microsoft-provided extended stored procedures that have the ability to reconnect to the database as the SQL Server service account have a flaw in common - namely, they have weak permissions that can allow non-privileged users to execute them. Because these extended stored procedures can be made to run with administrator privileges on the database, it is thus possible for a non-privileged user to run stored procedures on the database with administrator privileges.

An attacker could exploit this vulnerability in one of two ways. The attacker could attempt to load and execute a database query that calls one of the affected extended store procedures. Alternately, if a web-site or other database front-end were configured to access and process arbitrary queries, it could be possible for the attacker to provide inputs that would cause the query to call one of the functions in question with the appropriate malformed parameters.

**Mitigating factors:**

* The effect of exploiting the vulnerability would depend on the specific configuration of the SQL Server service. SQL Server can be configured to run in a security context chosen by the administrator. By default, this context is as a domain user. If the rule of least privilege has been followed, it would minimize the amount of damage an attacker could achieve.
* The vector for exploiting this vulnerability could be blocked by following best practices. Specifically, untrusted users should not be able to load and execute queries of their choice on a database server. In addition, publicly accessible database queries should filter all inputs prior to processing.

**Severity Rating:**

|  | Internet Servers | Intranet Servers | Client Systems |
| --- | --- | --- | --- |
| **SQL Server 7.0 (Including MSDE 1.0)** | Moderate | Moderate | Moderate |
| **SQL Server 2000 (Including MSDE 2000)** | Moderate | Moderate | Moderate |

The above [assessment](https://technet.microsoft.com/security/bulletin/rating) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them. While the vulnerability can be used to run stored procedures as administrator, following best practices and limiting the ability to submit queries greatly mitigates the exposure to this vulnerability.

**Vulnerability identifier:** [CAN-2002-0721](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0721)

**Tested Versions:**

Microsoft tested SQL Server 7.0 and SQL Server 2000 to assess whether they are affected by this vulnerability. Previous versions are no longer supported and may or may not be affected by this vulnerability. While the vulnerability could potentially enable an attacker While the vulnerability could potentially allow an attacker to run code on the server, best practices should limit the ability to exploit the vulnerability and the damage that could be achieved by a successful attack.

## Frequently asked questions

**What is the correct order for installing this patch in conjunction with the hotfix discussed in** [**317748**](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748)**?**

This security patch does not contain a patch from Knowledge Base Article [317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) that is required to ensure normal operation of SQL Server 2000 and MSDE 2000. The correct order of installation is to install the [317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) patch and then this security patch. If you have applied this security patch to a SQL Server 2000 or MSDE 2000 installation prior to applying the hotfix from Knowledge Patch article [317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748), you must answer "no" if and when prompted to overwrite files to ensure that you do not overwrite files from the security patch.

**How do I check I've got this security patch installed?**

You should verify that the version of ssnetlib.dll in the \MSSQL\BINN folder for the instance you applied the patch for is: 2000.80.636.0
If the version of the ssnetlib.dll in the \MSSSQL\BINN folder is less than 2000.80.636.0, then you will need to re-apply the security patch. However Microsoft recommends that you apply the latest security patch as described in [MS02-061](https://technet.microsoft.com/security/bulletin/ms02-061) since this contains fixes for additional security vulnerabilities in these products.

**What vulnerabilities does this patch eliminate?**

This is a [privilege elevation](https://technet.microsoft.com/security/bulletin/glossary) vulnerability. It occurs in some of the Microsoft-provided extended stored procedures. An attacker who successfully exploited this vulnerability in one of the affected extended stored procedures would gain significant control over the database and possibly the server itself. In a worst case, the attacker could add, change or delete data in the database, as well as potentially being able to reconfigure the operating system, install new software, or reformat the hard drive. The scope of this vulnerability, however, would be significantly reduced if best practices were followed. Specifically:

* SQL Server can be configured to run in a security context in accordance with the rule of least privilege. By default, SQL Server runs in the security context of a domain user, a context with very limited privileges on the server. If this were done, it would have the effect of limiting the potential actions an attacker could take against the operating system in the event of a successful attack.
* In addition to successfully exploit this vulnerability, the attacker would need to be able to load and run a query of his construction on the server, or be able to pass information of their choosing into an existing query on the system. Best practices recommends against both of these practices.

**What causes the vulnerability?**

The vulnerability results because of weak permissions on some extended stored procedures that have the ability to reconnect to the database using the SQL Server.

**What are SQL Server extended stored procedures?**

Extended stored procedures provide the ability for database designers and administrators to create your their own customized external routines in a programming language such as C or C#. For all intents and purposes, extended stored procedures appear to users as normal stored procedures and are executed in the same way. Database queries can pass data to extended stored procedures which can return results and return status.
For instance, among the standard extended stored procedures included with SQL Server are ones that provide e-mail functions. For example:

* xp\_startmail, which starts a SQL Mail client session, and
* xp\_sendmail, which sends an e-mail or page.

**What do you mean when you say that these extended stored procedures can reconnect to the SQL Server as the Service Account?**

Typically (with a few exceptions), extended stored procedures run in the security context of the service account SQL server runs as. For example, if a user with limited privileges were to run an extended stored procedure, it would run with the same permissions as the service account.
Some of these extended stored procs can be made to connect back to SQL server by passing in a carefully crafted input as a parameter to the stored procs.
At that point, any actions that the extended stored procedure take against the database is in the context of the SQL Server Service Account, which might have high privileges on the database.

**What's wrong with the extended stored procedures?**

Some of the extended stored procedures provided by Microsoft have inappropriately weak permissions on them. As a result, it's possible for a non-privileged user to load and execute these extended stored procedures.

**What could this vulnerability enable an attacker to do?**

This vulnerability could enable an attacker to gain administrative control over SQL Server. As a result of this, the attacker could take any action on the database that an administrator could take. In addition depending on the configuration of the database server it could be possible for the attacker to take actions on the operating system that the SQL Server were capable of taking.

**How could an attacker exploit this vulnerability?**

There are several ways an attacker would try to exploit this vulnerability. The most direct attack vector would be for the attacker to construct a query that calls the affected extended stored procedures. However, to succeed at this, the server would have to be configured to allow an untrusted user to load and execute queries of their choice. Best practices strongly recommends against allowing untrusted users to load and run queries of their construction.

**Is there any other way an attacker would try to exploit this vulnerability?**

An attacker who couldn't directly load and execute a query might still be able to exploit the vulnerability if he could use a query that was already present on the system.
For example, if the database were part of a web-based search tool and one of the procedures in question were called by the web site, an attacker could attempt to construct a query that would exploit this vulnerability. However, constructing a query like this would require the attacker to possess intimate knowledge about the internals of a web site's search function.
If a site had implemented web-based queries without proper checking of inputs, however, it could be possible for an attacker to embed database commands-including a call to the affected function-within the database query parameters. This shows the importance of validating input parameters before passing them to the database server for processing.

**What does the patch do?**

The patch addresses the vulnerability by setting permissions on the extended stored procedures in questions such that only administrators can invoke them.

## Patch availability

**Download locations for this patch**

* Microsoft SQL Server 7.0

  [https://www.microsoft.com/Release.asp?ReleaseID=Q327068](https://support.microsoft.com/default.aspx?scid=kb;en-us;327068)
* Microsoft SQL Server 2000

  [https://www.microsoft.com/Release.asp?ReleaseID=Q316333](https://support.microsoft.com/default.aspx?scid=kb;en-us;316333&sd;=tech)

#### Additional information about this patch

**Installation platforms:**

* The SQL Server 7.0 patch can be installed on systems running SQL Server 7.0 [Service Pack 4](https://technet.microsoft.com/sqlserver/70/bb331719.aspx).
* The SQL Server 2000 patch can be installed on systems running SQL Server 2000 [Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=502c0d89-1308-4662-8f58-cec55ef1235b&displaylang;=en).

**Inclusion in future service packs:** The fix for this issue will be included in SQL Server 2000 Service Pack 3.

**Reboot needed:** No. The SQL Server service only needs to be restarted after applying the patch.

**Patch can be uninstalled:** Yes. The readme.txt describing the installation instructions also contains instructions on removing the patch.

**Superseded patches:**

**SQL Server 7.0 and MSDE 1.0:**

* This patch supersedes the one provided in Microsoft Security Bulletin [MS02-020](https://technet.microsoft.com/security/bulletin/ms02-020), which was itself a cumulative patch.

**SQL Server 2000 and MSDE 2000:**

* This patch supersedes the one provided in Microsoft Security Bulletin [MS02-038](https://technet.microsoft.com/security/bulletin/ms02-038), which was itself a cumulative patch, as well as [MS02-039](https://technet.microsoft.com/security/bulletin/ms02-039).

**Verifying patch installation:**

**SQL Server 7.0:**

* To ensure you have the fix installed properly, verify the individual files by consulting the date/time stamp of the files listed in the file manifest in Microsoft Knowledge Base article at [https://support.microsoft.com/support/misc/kblookup.asp?id=Q327068](https://support.microsoft.com/support/misc/kblookup.asp?id=q327068)

**SQL Server 2000:**

* To ensure you have the fix installed properly, verify the individual files by consulting the date/time stamp of the files listed in the file manifest in Microsoft Knowledge Base article at [https:](https://)

**Caveats:**

* This patch does not include the functionality of the Killpwd tool provided in Microsoft Security Bulletin [MS02-035](https://technet.microsoft.com/security/bulletin/ms02-035).
* The patch does not supersede any previously released patches for MDAC or OLAP under SQL Server 2000. At this writing, these patches include the ones discussed in:
  + Microsoft Security Bulletin [MS00-092](https://technet.microsoft.com/security/bulletin/ms00-092)
  + Microsoft Security Bulletin [MS01-041](https://technet.microsoft.com/security/bulletin/ms01-041)
  + Microsoft Security Bulletin [MS02-030](https://technet.microsoft.com/security/bulletin/ms02-030)
* The process for installing the patch varies somewhat depending on the specific configuration of the server. System administrators should ensure that they read the Readme.txt file in the patch package to ensure the patch is installed correctly.

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site

#### Other information:

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) Microsoft [https://www.microsoft.com/technet/security/bulletin/policy.mspx](https://technet.microsoft.com/security/bulletin/policy)the following people for working with us to protect customers:

* David Litchfield of [Next Generation Security Software Ltd.](https://www.nextgenss.com/) for reporting these issues.
* Chip Andrews of [www.sqlsecurity.com](https://www.sqlsecurity.com/) and Timothy Mullen for reporting additional information on these issues.

**Support:**

* Microsoft Knowledge Base article Q327068 and Q316333 discusses this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/?scid=fh;en-us;kbhowto) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 (August 14, 2002): Bulletin Created.
* V1.1 (January 31, 2003): Updated to advise of supercedence by MS02-061 and clarify installation order when Hotfix 317748 is applied in conjunction with this security patch.
* V1.2 (February 28, 2003): Updated "Additional information about this patch" section.

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


