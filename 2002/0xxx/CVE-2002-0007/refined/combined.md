=== Content from bugzilla.mozilla.org_bcf63f28_20250125_024353.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/54901)
* [XML](/show_bug.cgi?ctype=xml&id=54901)

Closed
[Bug 54901](/show_bug.cgi?id=54901)

Opened 24 years ago
Closed 23 years ago

# [security] LDAP Authentication should fail for empty passwords

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[security] LDAP Authentication should fail for empty passwords

## Categories

### (Bugzilla :: Bugzilla-General, defect, P1)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Bugzilla-General#Bugzilla-General)

Bugzilla-General
▾

Bugzilla :: Bugzilla-General
Anything that doesn't fit in the other components, or spans multiple components.
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Bugzilla-General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Bugzilla-General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Bugzilla-General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

blocker

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 2.16

## People

### (Reporter: crow, Assigned: jmrobins)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e6b9d31dcf2b2fd7bab3de6ca56be701?d=mm&size=40)  [jmrobins](/user_profile?user_id=12919)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/764bbf29f450de4d458a07140fb74a4f?d=mm&size=40)  [crow](/user_profile?user_id=20199)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

5 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | approval | ? |
| --- | --- | --- |
|  | approval5.0 | ? |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [David Crow's patch](/attachment.cgi?id=59251)  [23 years ago](#c7)  [Dave Miller [:justdave]](/user_profile?user_id=10297)   1.16 KB, patch | justdave : [review+](#c8 "23 years ago")  justdave : [review+](#c9 "23 years ago") | [Details](/attachment.cgi?id=59251&action=edit) | [Diff](/attachment.cgi?id=59251&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=54901&attachment=59251) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [David L. Crow](/user_profile?user_id=20199)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=54901#c0)• 24 years ago |
|  | |

When using LDAP and no password is specified in the login screen, the bind
is successful even if the user has a password. This is because and LDAP bind
with no password (regardless of the bindn value) will be treated as an anonymous
bind.
The Netscape SDK documentation at
<<http://docs.iplanet.com/docs/manuals/dirsdk/csdk30/writing.htm>>, states
Note that if you specify a DN but no password, your client will
bind to the server anonymously. If you want a NULL password to
be rejected as an incorrect password, you need to write code to
perform the check before you call the ldap\_simple\_bind() or
ldap\_simple\_bind\_s() function.
The following diff shows such a change to CGI.pl:
===================================================================
RCS file: /cvsroot/mozilla/webtools/bugzilla/CGI.pl,v
retrieving revision 1.73
diff -u -r1.73 CGI.pl
--- CGI.pl 2000/09/18 21:29:44 1.73
+++ CGI.pl 2000/10/02 16:18:27
@@ -719,6 +719,21 @@
exit;
}
+ # if no password was provided, then fail the authentication
+ # while it may be valid to not have an LDAP password, when you
+ # bind without a password (regardless of the binddn value), you
+ # will get an anonymous bind. I do not know of a way to determine
+ # whether a bind is anonymous or not without making changes to the
+ # LDAP access control settings
+ if ( ! $::FORM{"LDAP\_password"} ) {
+ print "Content-type: text/html\n\n";
+ PutHeader("Login Failed");
+ print "You did not provide a password.\n";
+ print "Please click <b>Back</b> and try again.\n";
+ PutFooter();
+ exit;
+ }
+
# We've got our anonymous bind; let's look up this user.
my $dnEntry =
$LDAPconn->search(Param("LDAPBaseDN"),"subtree","uid=".$::FORM{"LDAP\_login"});
if(!$dnEntry) {

|  | [Matthew Tuck [:CodeMachine]](/user_profile?user_id=4412) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=54901#a25477502_4412)• 24 years ago |

Keywords: [patch](/buglist.cgi?keywords=patch&resolution=---),
[review](/buglist.cgi?keywords=review&resolution=---)Target Milestone: --- → Bugzilla 2.16

|  | [Andreas Franke (gone)](/user_profile?user_id=13272) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=54901#c1)• 23 years ago |
|  | |

-> Bugzilla product, General component (LDAP, CGI.pl), reassigning.Assignee: tara → justdave

|  | [Andreas Franke (gone)](/user_profile?user_id=13272) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=54901#c2)• 23 years ago |
|  | |

Oops. Really changing product now.Component: Bugzilla → Bugzilla-GeneralProduct: Webtools → BugzillaVersion: other → unspecified

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=54901#c3)• 23 years ago |
|  | |

Reassigning to LDAP author. Please set this to 2.16 if you feel the patch is
useful and ready to go.
GervAssignee: justdave → jmrobinsTarget Milestone: Bugzilla 2.16 → Future

|  | [Matthew Tuck [:CodeMachine]](/user_profile?user_id=4412) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=54901#a32913157_4412)• 23 years ago |

Keywords: [patch](/buglist.cgi?keywords=patch&resolution=---),
[review](/buglist.cgi?keywords=review&resolution=---)

|  | [Joe Robins](/user_profile?user_id=12919)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=54901#c4)• 23 years ago |
|  | |

Sorry for the delay in reviewing this. The Job That Pays Me has been eating up
my time.
This looks good to me. I've tested it on my dev instance, and it works fine.
You can go ahead and put it in 2.16.
Target Milestone: Future → Bugzilla 2.16

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=54901#c5)• 23 years ago |
|  | |

We are currently trying to wrap up Bugzilla 2.16. We are now close enough to
release time that anything that wasn't already ranked at P1 isn't going to make
the cut. Thus this is being retargetted at 2.18. If you strongly disagree with
this retargetting, please comment, however, be aware that we only have about 2
weeks left to review and test anything at this point, and we intend to devote
this time to the remaining bugs that were designated as release blockers.Target Milestone: Bugzilla 2.16 → Bugzilla 2.18

|  | [Joe Robins](/user_profile?user_id=12919)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=54901#c6)• 23 years ago |
|  | |

This should probably be marked as higher priority than it is... It's actually a
major security issue. If you're using LDAP, this bug allows anyone to log into
your Bugzilla instance as any user solely by knowing the username, and not the
password. Personally, I consider this to be a giant gaping flaw in the
security, that should be dealt with as quickly as possible.
The patch below is simple, straightforward, and I've tested it on my instance.
It remedies this problem with minimal changes, so it should have no effects on
any other functionality. (One caveat: I've tested it on my system, but applied
the changes manually instead of using patch, because I've made a lot of other
changes to my version. I'm just assuming that the diff is legitimate w.r.t line
numbers, etc.)
I know it's late in the game to be pushing for this to be in 2.16, so if it's
too late, it's too late, but if it can get in there, it'd probably be a good
thing.

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=54901#a36315485_10297)• 23 years ago |

Severity: normal → blockerPriority: P3 → P1Summary: LDAP Authentication should fail for empty passwords → [security] LDAP Authentication should fail for empty passwordsTarget Milestone: Bugzilla 2.18 → Bugzilla 2.16

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=54901#c7)• 23 years ago |
|  | |

Attached patch

[David Crow's patch](attachment.cgi?id=59251&action=diff)
— [Details](attachment.cgi?id=59251&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=54901&attachment=59251)

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=54901#c8)• 23 years ago |
|  | |

Comment on [attachment 59251](/attachment.cgi?id=59251 "David Crow's patch") [[details]](/attachment.cgi?id=59251&action=edit "David Crow's patch") [[diff]](/attachment.cgi?id=59251&action=diff "David Crow's patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=54901&attachment=59251)
David Crow's patch
marking first-review on behalf of jmrobins
[Attachment #59251](/attachment.cgi?id=59251&action=edit "David Crow's patch") -
Attachment description: David Crowe's patch → David Crow's patch
[Attachment #59251](/attachment.cgi?id=59251&action=edit "David Crow's patch") -
Flags: review+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=54901#c9)• 23 years ago |
|  | |

Comment on [attachment 59251](/attachment.cgi?id=59251 "David Crow's patch") [[details]](/attachment.cgi?id=59251&action=edit "David Crow's patch") [[diff]](/attachment.cgi?id=59251&action=diff "David Crow's patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=54901&attachment=59251)
David Crow's patch
doesn't break the existing login stuff.
r= justdave
[Attachment #59251](/attachment.cgi?id=59251&action=edit "David Crow's patch") -
Flags: review+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=54901#c10)• 23 years ago |
|  | |

Checked in on the trunk:
/cvsroot/mozilla/webtools/bugzilla/CGI.pl,v <-- CGI.pl
new revision: 1.125; previous revision: 1.124
checked in on the 2.14.1 branch:
/cvsroot/mozilla/webtools/bugzilla/CGI.pl,v <-- CGI.pl
new revision: 1.100.2.1; previous revision: 1.100
Status: NEW → RESOLVEDClosed: 23 years agoResolution: --- → FIXED

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=54901#c11)• 23 years ago |
|  | |

Hmm, it seems the bulk change thinks I'm not changing anything if all I do is
add names to the CC list, so I guess I have to make a comment. Anyhow, adding
the representatives from the organizations we know of that support Bugzilla
distributions so they're aware of our upcoming security release

|  | [James A. Laska](/user_profile?user_id=36800) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=54901#c12)• 23 years ago |
|  | |

This code is now unnecesary. Simple change the userbind statement to the
following (see [bug#105504](/show_bug.cgi?id=105504 "RESOLVED INVALID - Bugzilla LDAP does not close connection (CGI::confirm_login())")):
# Now we attempt to bind as the specified user.
my $retcode = $LDAPconn->simpleAuth($userDN,$::FORM{"LDAP\_password"});
if ( ($::FORM{"LDAP\_password"} eq "") ||
($userDN eq "") ||
($retcode == 0) )
{
$LDAPconn->close();
print "Content-type: text/html\n\n";
PutHeader("Login Failed");
print "The username or password for <font
color=\"blue\">".$::FORM{"LDAP\_login"}."</font> was not found in the IBM <a
href=\"<http://w3.ibm.com/bluepages/>\">bluepages</a> directory.\n";
print "<br>Please click <b>Back</b> and try again.\n";
PutFooter();
exit;
}
This comes straight from the perLDAP examples. This will properly fail a login
attempt for a bad passwd/no passwd etc...

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=54901#a385388639_1)• 12 years ago |

QA Contact: matty\_is\_a\_geek → default-qa
You need to [log in](/show_bug.cgi?id=54901&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Dave Miller [:justdave]](/user_profile?user_id=10297)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


