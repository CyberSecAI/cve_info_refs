=== Content from marc.info_953f0502_20250125_152929.html ===

```
[[prev in list](?l=bugtraq&m=101675386114021&w=2)] [[next in list](?l=bugtraq&m=101683392632466&w=2)] [[prev in thread](?l=bugtraq&m=101674899907370&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [RE: [VulnWatch] NMRC Advisory - KeyManager Issue in ISS RealSecur](?t=101666662200004&r=1&w=2)
From:       ["Rouland, Chris (ISSAtlanta)" <CRouland () iss ! net>](?a=92839354700001&r=1&w=2)
Date:       [2002-03-21 21:38:22](?l=bugtraq&r=1&w=2&b=200203)
[Download RAW [message](?l=bugtraq&m=101675086010051&q=mbox) or [body](?l=bugtraq&m=101675086010051&q=raw)]

Mr. Hellnbak has not proven the exploit legitimate, but rather has
successfully tested a feature which allows for a fresh install to be easily
managed.

There is a feature called "allow first connection" on Nokia which allows for
the very first connection to be connected and get it's keys imported.  It
can be disabled by any customer who finds that scary, but most do not.  The
person setting up the box is always the first one to connect, and after that
only people with authentication keys can connect.  If the attacker had
supreme timing and connected in the interval that the software was installed
and before it was managed, the person who set this up in the first place
would get refused access and figure out what was happening.  The reason why
we added such a feature was to improve OOB with Nokia because there no easy
way to get the initial public keys installed.

If the feature is disabled OR if a legitimate administrator has simply
connected at least once, the errant "skank" entry will be useless.  At such
point, starscream_skank would be refused a connection to the issDaemon for
lack of public keys, that is unless they gain root or convince the real
administrator to push the pubkey on their behalf.

Also, we've had this impotent entry removed for months now.

It's unfortunate that some security professionals still do not take the time
to work through these issues with vendors through responsible vulnerability
disclosure.  In an asynchronous advisory from NMRC such as this,
disinformation like this causes a lot of confusion to the end user, who we
are all trying to protect.

-----Original Message-----
From: hellNbak [mailto:hellnbak@nmrc.org]
Sent: Thursday, March 21, 2002 1:00 PM
To: Rouland, Chris (ISSAtlanta)
Cc: nmrcfolk@nmrc.org; bugtraq@securityfocus.com; vulnwatch@vulnwatch.org;
focus-ids@securityfocus.com
Subject: RE: [VulnWatch] NMRC Advisory - KeyManager Issue in ISS RealSecur e
on Nokia Appliances

On Thu, 21 Mar 2002, Rouland, Chris (ISSAtlanta) wrote:
>
> Please confirm that you are able to exploit this, without root accesss
> to the IPSO box.

Chris, if I set up my own console, why would I need root access to the IPSO
box?  If I simply set my machine name to starscream and my user to skank I
am able to connect and push new keys generated by my console.

I am unsure why you would post that "NMRC is unable to confirm that this can
be exploited" without actually talking to me first.  I just tested it, a
second time, and yes, you can connect via the console and root access on the
Nokia box is not an issue.  The console connects to the control chanell and
allows me to push new keys down using the deployment wizard which then
allows me to set my new console as the "master controller" and gather
alerts, modify policied etc...
[[prev in list](?l=bugtraq&m=101675386114021&w=2)] [[next in list](?l=bugtraq&m=101683392632466&w=2)] [[prev in thread](?l=bugtraq&m=101674899907370&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_bbfc7b63_20250125_152928.html ===

```
[[prev in list](?l=bugtraq&m=101666459710887&w=2)] [[next in list](?l=bugtraq&m=101673073312092&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=101671786725079&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [NMRC Advisory - KeyManager Issue in ISS RealSecure on Nokia Appliances](?t=101666835000006&r=1&w=2)
From:       [hellNbak <hellnbak () nmrc ! org>](?a=99161532200001&r=1&w=2)
Date:       [2002-03-20 23:04:55](?l=bugtraq&r=1&w=2&b=200203)
[Download RAW [message](?l=bugtraq&m=101666833321138&q=mbox) or [body](?l=bugtraq&m=101666833321138&q=raw)]

_______________________________________________________________________________

                  I N F O R M A T I O N  A N A R C H Y  2 K 0 2
                           [www.nmrc.org/InfoAnarchy](http://www.nmrc.org/InfoAnarchy)

                        Nomad Mobile Research Centre
                              A D V I S O R Y
                               [www.nmrc.org](http://www.nmrc.org)
                        hellNBak (hellnbak@nmrc.org)
                                 19March2002
_______________________________________________________________________________

           Platforms : Nokia Appliances
         Application : RealSecure Network Intrusion Detection (NIDS)
                       Version 6.0
            Severity : Medium

Synopsis
--------

This advisory documents an issue when using RealSecure NIDS on Nokia
appliances.  It seems that during development, a test system named
"starscream" and test user "skank" was used as it was left behind in the
IPSO image in the ISS.ACCESS file as a KeyManager.

There is the potential that this information, depending on the
configuration of the NIDS, can be used to push new pubkey files to the
sensor, reconfigure or take control of the NIDS daemon and daemon
components.

Details
-------

When you install RealSecure on any platform a file named ISS.ACCESS is
created and used for various configuration settings including the
following lines;

--ISS Access 6.0--
[\];
[\Roles];
[\Roles\KeyAdministrator\];
[\Roles\KeyAdministrator\machinename_username\];
[\Roles\KeyAdministrato\starscream_skank\];
[\Roles\MasterStatusManager\];

The Roles\KeyAdministrator line is used to determine the machine name and
username of what ISS calls the KeyAdministrator. This user has the ability
to manage the keys used when communicating with the daemon.

This line is added during installation but the second line,
\startscream_skank is present in the IPSO as a "default". This does not
exist on any other platform or in the HIDS RealSecure product.

The vulnerability lies in the fact that as a KeyAdministrator, you
essentially can control the functions of the daemon including what events
it monitors for and how it alerts.  It is important to understand that
this is only possible if RealSecure is configured to rely on the console
system to push the necessary public keys to it, which is the default
method of installation.

If the Nokia Voyager web applet is used to install this IPSO you do not
have the option to turn on authentication.  Authentication in this case
means that the administrator must, via sneakernet or other secure channels
manually copy the necessary keys to the sensor.

Mitigating Factors
-------------------

The RealSecure NIDS sensor listens on two TCP ports, TCP-2998 is used to
control the daemon while TCP-901 is used to monitor events.  Obviously,
you do not want to allow these ports to pass through your firewall. In
an ideal situation, the NIDS sensor should have a shadow interface
enabled to monitor and only communicate back to the console via a private
mangement network that is not accessable by any other devices.

It is also a good idea to not allow the NIDS sensor to accept new public
keys directly from a console but only when copied manually to the system.

Tested configurations
---------------------

RealSecure 6.0 was tested, it is unknown if other versions are effected.
ISS is aware of the issue and has removed this line from version 6.5.

The version of Nokia software does not make a difference although this
does not exist on any other platform such as Windows NT, or Solaris.

Vendor Response
---------------

Thanks to Ring Zero for taking this one to the vendor for me.  Here is
a portion of the email received back from ISS.

---------- Forwarded message ----------
Date: Wed, 20 Mar 2002 12:22:05 -0500
From: "Lamb, Kris (ISS Atlanta)" <KLamb@iss.net>
To: 'Ring Zero' <ringzero@www.nmrc.org>
Subject: RE: Anomaly in RealSecure

<SNIP>

As far as the starscream_skank, that was a QA box from the product
development team that was accidentally left in the iss.access when IPSO
shipped. We have already addressed this with Support and all customers
have been notified to remove that entry. It was removed in IPSO 6.5.

<SNIP>

-----------------------------------------

Solution/Workaround
-------------------

If you are running RealSecure version 6.0 and below you need to simply
stop the NIDS daemon and edit the ISS.ACCESS file and remove the following
line:

[\Roles\KeyAdministrato\starscream_skank\];

If you installed the IPSO manually and turned on authentication you are
unaffected but should probably remove the line anyways.

Comments/Rants
--------------

No NMRC advisory, let alone one written by me would be complete without
some sort of rant so here it goes;

Responsible Disclosure and the IETF:  I applaud Chris Wysopal and Steve
Christey for their efforts in attempting to bring a standard to
vulnerability disclosure.  I may not have agreed with the entire document
but at least these two guys were willing to take input from the community
as a whole.  I hope the standard finds a home and eventually evolves to
something acceptable by the research community as a whole.  Trust me folks
-- we do not want government, or any vendor to do this for us.  Too bad
the IETF doesn't have the balls or brains to deal with this issue.

ISS:  While their products can use some improvement, especially when
attempting to implement it in a large mixed environment I am impressed
with the level of cooperation and support being offered by ISS.  I take
back most of the bad things I have ever said about you........  :-)

Greetz
------

Thanks to Ring Zero for bringing this issue to the attention of ISS.

Copyright
---------

This advisory is Copyright (c) 2002 NMRC - feel free to distribute it
without edits but fear us if you use this advisory in any type of
commercial endeavour.

To be posted on:  NMRC.ORG web site, VulnWatch, and Bugtraq

_______________________________________________________________________________

--
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

"I don't intend to offend, I offend with my intent"

hellNbak@nmrc.org
<http://www.nmrc.org/~hellnbak>

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

[[prev in list](?l=bugtraq&m=101666459710887&w=2)] [[next in list](?l=bugtraq&m=101673073312092&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=101671786725079&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


