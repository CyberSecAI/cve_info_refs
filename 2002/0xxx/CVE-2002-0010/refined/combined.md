=== Content from bugzilla.mozilla.org_991a9d72_20250125_164215.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/108821)
* [XML](/show_bug.cgi?ctype=xml&id=108821)

Closed
[Bug 108821](/show_bug.cgi?id=108821)

Opened 23 years ago
Closed 23 years ago

# [security] users with blessgroupset!= 0 can change any groupset

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[security] users with blessgroupset!= 0 can change any groupset

## Categories

### (Bugzilla :: User Accounts, defect, P1)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=User%20Accounts#User%20Accounts)

User Accounts
▾

Bugzilla :: User Accounts
Anything about managing a user account from the user's perspective. `userprefs.cgi`, saved queries, creating accounts, changing passwords, logging in, etc.
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=User%20Accounts&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=User%20Accounts&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=User%20Accounts)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.15

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

blocker

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 2.16

## People

### (Reporter: bbaetz, Assigned: bbaetz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/3ac0810ff2d431ec44f087f4fa2bf042?d=mm&size=40)  [bbaetz](/user_profile?user_id=29274)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3ac0810ff2d431ec44f087f4fa2bf042?d=mm&size=40)  [bbaetz](/user_profile?user_id=29274)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[103885](/show_bug.cgi?id=103885 "RESOLVED FIXED - upgrade bugzilla installation on bugzilla.mozilla.org")

Dependency [tree](/showdependencytree.cgi?id=108821&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=108821)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: applied to 2.14.1)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

applied to 2.14.1

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | approval | ? |
| --- | --- | --- |
|  | approval5.0 | ? |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 2 obsolete files)

| [Patch - run the form values through detaint\_natural()](/attachment.cgi?id=56883)  [23 years ago](#c1)  [Jacob Steenhagen](/user_profile?user_id=4897)   799 bytes, patch | jacob : [review-](#c2 "23 years ago") | [Details](/attachment.cgi?id=56883&action=edit) | [Diff](/attachment.cgi?id=56883&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=56883) |
| --- | --- | --- |
| [patch](/attachment.cgi?id=56938)  [23 years ago](#c5)  [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)   748 bytes, patch | jacob : [review+](#c7 "23 years ago")  myk : [review-](#c8 "23 years ago") | [Details](/attachment.cgi?id=56938&action=edit) | [Diff](/attachment.cgi?id=56938&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=56938) |
| [patch v3: combines the approaches of previous patches](/attachment.cgi?id=56979)  [23 years ago](#c9)  [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)   1.23 KB, patch | bbaetz : [review+](#c10 "23 years ago")  myk : [review+](#c11 "23 years ago") | [Details](/attachment.cgi?id=56979&action=edit) | [Diff](/attachment.cgi?id=56979&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=56979) |
| [Same patch, against version 2.14](/attachment.cgi?id=58205)  [23 years ago](#c13)  [Dave Miller [:justdave]](/user_profile?user_id=10297)   1.21 KB, patch |  | [Details](/attachment.cgi?id=58205&action=edit) | [Diff](/attachment.cgi?id=58205&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=58205) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=108821#c0)• 23 years ago |
|  | |

Simply change the value of one of the form elements in editusers.pl to something
like:
value="-$fudge+9223372036854775807"
You can find out the value to plug in for $fudge by entering a bogus value, and
looking at the sql error. Stuff may be on the right, too, so take that into account.
We don't validate the entries against the blessgroupset, and we just read in the
raw values anyway.

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108821#a92_29274)• 23 years ago |

Summary: users with blessgroupset!= 0 can change any groupset → [security] users with blessgroupset!= 0 can change any groupset

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108821#a939_27300)• 23 years ago |

Blocks: [103885](/show_bug.cgi?id=103885 "RESOLVED FIXED - upgrade bugzilla installation on bugzilla.mozilla.org")

|  | [Matthew Tuck [:CodeMachine]](/user_profile?user_id=4412) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108821#a5536_4412)• 23 years ago |

Priority: -- → P1Target Milestone: --- → Bugzilla 2.16

|  | [Jacob Steenhagen](/user_profile?user_id=4897) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=108821#c1)• 23 years ago |
|  | |

Attached patch

[Patch - run the form values through detaint\_natural()](attachment.cgi?id=56883&action=diff) (obsolete)
— [Details](attachment.cgi?id=56883&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=56883)

|  | [Jacob Steenhagen](/user_profile?user_id=4897) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=108821#c2)• 23 years ago |
|  | |

Comment on [attachment 56883](/attachment.cgi?id=56883 "Patch - run the form values through detaint_natural()") [[details]](/attachment.cgi?id=56883&action=edit "Patch - run the form values through detaint_natural()") [[diff]](/attachment.cgi?id=56883&action=diff "Patch - run the form values through detaint_natural()") [[review]](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=56883)
Patch - run the form values through detaint\_natural()
I just realized my patch wasn't as good as I thought it was 'cause you can still just do
the math yourself and put that in the value :(
[Attachment #56883](/attachment.cgi?id=56883&action=edit "Patch - run the form values through detaint_natural()") -
Flags: review-

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=108821#c3)• 23 years ago |
|  | |

whats the % $opblessgroupset stuff for?. It looks like we're taking away
anything we have the privs to set, and then adding anything. Can that just be
redone as:
SendSQL("UPDATE profiles
SET groupset =
groupset - (groupset & $opblessgroupset) + ($groupset &
$opblessgroupset)
WHERE login\_name=" . SqlQuote($userold));
SendSQL("UPDATE profiles
SET groupset =
groupset - (groupset & $opblessgroupset) + $groupset
WHERE login\_name=" . SqlQuote($userold));
instead?
You don't have to protect blessgroupset - only people with editusers can change
that. Of course, maybe we should only allow people with editusers to change hte
blessgroupset for stuff they have the blessgroupset for. Thats a policy
decision, and another bug, though. Currently editusers lets you set teh
blessgroupset to anything you want, which then lets you set the groupset to
whatever you want. This bug won't fix that.

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=108821#c4)• 23 years ago |
|  | |

Ok, patch coming up. I didn't use detaint\_natural for the reasons Jake mentioned.
Note that this doesn't stop the fact that, at present, editusers == admin access.
Assignee: myk → bbaetz

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=108821#c5)• 23 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=56938&action=diff) (obsolete)
— [Details](attachment.cgi?id=56938&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=56938)

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=108821#c6)• 23 years ago |
|  | |

Actually, I'll skip filing a bug on edit users being too broad, and wait to see
what happens when the groups stuff lands. Presumably only admins will be able to
set the isadmin bit. I'd like for editusers to only allow the user to change the
blessgroupset on groups for which they have a bless groupset. This would mean
changing the admin's blessgroupset in checksetup, but is probably easier when
groups stuff lands.Status: NEW → ASSIGNED

|  | [Jacob Steenhagen](/user_profile?user_id=4897) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=108821#c7)• 23 years ago |
|  | |

Comment on [attachment 56938](/attachment.cgi?id=56938 "patch") [[details]](/attachment.cgi?id=56938&action=edit "patch") [[diff]](/attachment.cgi?id=56938&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=56938)
patch
I don't know groupsets all that well, but I applied this patch and couldn't get the exploit
(or variations of it) to work, but I still could use it the way it's supposed to be used...
r=jake
[Attachment #56938](/attachment.cgi?id=56938&action=edit "patch") -
Flags: review+

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=108821#c8)• 23 years ago |
|  | |

Comment on [attachment 56938](/attachment.cgi?id=56938 "patch") [[details]](/attachment.cgi?id=56938&action=edit "patch") [[diff]](/attachment.cgi?id=56938&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=56938)
patch
>Index: editusers.cgi
>===================================================================
>RCS file: /cvsroot/mozilla/webtools/bugzilla/editusers.cgi,v
>retrieving revision 1.28
>diff -u -r1.28 editusers.cgi
>--- editusers.cgi 2001/10/26 18:35:04 1.28
>+++ editusers.cgi 2001/11/07 21:57:18
>@@ -767,7 +767,8 @@
> } else {
> SendSQL("UPDATE profiles
> SET groupset =
>- groupset - (groupset & $opblessgroupset) + $groupset
>+ groupset - (groupset & $opblessgroupset) +
>+ (($groupset) & $opblessgroupset)
> WHERE login\_name=" . SqlQuote($userold));
>
> # I'm paranoid that someone who I give the ability to bless people
Hacking the form so one of the bit\_ fields contains the value
"9223372036854775807)) , realname = ((1" still works with the latest patch.
These patches should be combined together to make sure all are really bits.
[Attachment #56938](/attachment.cgi?id=56938&action=edit "patch") -
Flags: review-

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=108821#c9)• 23 years ago |
|  | |

Attached patch

[patch v3: combines the approaches of previous patches](attachment.cgi?id=56979&action=diff)
— [Details](attachment.cgi?id=56979&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=56979)

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=108821#c10)• 23 years ago |
|  | |

Comment on [attachment 56979](/attachment.cgi?id=56979 "patch v3: combines the approaches of previous patches") [[details]](/attachment.cgi?id=56979&action=edit "patch v3: combines the approaches of previous patches") [[diff]](/attachment.cgi?id=56979&action=diff "patch v3: combines the approaches of previous patches") [[review]](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=56979)
patch v3: combines the approaches of previous patches
r=bbaetz.
Between us all we have two reviews on this, I think...
[Attachment #56979](/attachment.cgi?id=56979&action=edit "patch v3: combines the approaches of previous patches") -
Flags: review+

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=108821#c11)• 23 years ago |
|  | |

Comment on [attachment 56979](/attachment.cgi?id=56979 "patch v3: combines the approaches of previous patches") [[details]](/attachment.cgi?id=56979&action=edit "patch v3: combines the approaches of previous patches") [[diff]](/attachment.cgi?id=56979&action=diff "patch v3: combines the approaches of previous patches") [[review]](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=56979)
patch v3: combines the approaches of previous patches
Agreed, since my patch is just the combination of your two, and I'll second r=myk each of yours.
[Attachment #56979](/attachment.cgi?id=56979&action=edit "patch v3: combines the approaches of previous patches") -
Flags: review+

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=108821#c12)• 23 years ago |
|  | |

Checking in editusers.cgi;
/cvsroot/mozilla/webtools/bugzilla/editusers.cgi,v <-- editusers.cgi
new revision: 1.29; previous revision: 1.28
done
Status: ASSIGNED → RESOLVEDClosed: 23 years agoResolution: --- → FIXED

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=108821#c13)• 23 years ago |
|  | |

Attached patch

[Same patch, against version 2.14](attachment.cgi?id=58205&action=diff)
— [Details](attachment.cgi?id=58205&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108821&attachment=58205)

The removal of tabs threw off 'patch'. This attachment applies cleanly to
2.14.
[Attachment #56883](/attachment.cgi?id=56883&action=edit "Patch - run the form values through detaint_natural()") -
Attachment is obsolete: true
[Attachment #56938](/attachment.cgi?id=56938&action=edit "patch") -
Attachment is obsolete: true

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=108821#c14)• 23 years ago |
|  | |

[Attachment 58205](/attachment.cgi?id=58205 "Same patch, against version 2.14") [[details]](/attachment.cgi?id=58205&action=edit "Same patch, against version 2.14") [[diff]](/attachment.cgi?id=58205&action=diff "Same patch, against version 2.14"):
/cvsroot/mozilla/webtools/bugzilla/editusers.cgi,v <-- editusers.cgi
new revision: 1.23.2.1; previous revision: 1.23
Whiteboard: applied to 2.14.1

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=108821#c15)• 23 years ago |
|  | |

Hmm, it seems the bulk change thinks I'm not changing anything if all I do is
add names to the CC list, so I guess I have to make a comment. Anyhow, adding
the representatives from the organizations we know of that support Bugzilla
distributions so they're aware of our upcoming security release

|  | [Mike Shaver (:shaver emeritus)](/user_profile?user_id=422) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=108821#c16)• 23 years ago |
|  | |

Opening security bugs for which fixes have appeared in official bugzilla
release. As per justdave and his posse.Group: security?

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108821#a350772513_1)• 12 years ago |

QA Contact: matty\_is\_a\_geek → default-qa
You need to [log in](/show_bug.cgi?id=108821&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jacob Steenhagen](/user_profile?user_id=4897)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_422756bf_20250125_164218.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/109679)
* [XML](/show_bug.cgi?ctype=xml&id=109679)

Closed
[Bug 109679](/show_bug.cgi?id=109679)

Opened 23 years ago
Closed 23 years ago

# [security] fieldx-x-x values not validated

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[security] fieldx-x-x values not validated

## Categories

### (Bugzilla :: Query/Bug List, defect, P1)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Query%2FBug%20List#Query%2FBug%20List)

Query/Bug List
▾

Bugzilla :: Query/Bug List
Anything to do with searching for bugs and viewing the buglists. `query.cgi` and `buglist.cgi`
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Query%2FBug%20List&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Query%2FBug%20List&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Query%2FBug%20List)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.15

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

blocker

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 2.16

## People

### (Reporter: bbaetz, Assigned: endico)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f28841fc7184f71e364a61ab6b9e9798?d=mm&size=40)  [endico](/user_profile?user_id=4415)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3ac0810ff2d431ec44f087f4fa2bf042?d=mm&size=40)  [bbaetz](/user_profile?user_id=29274)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

### ( [URL](http://bugzilla.mozilla.org/buglist.cgi?field0-0-0=bugs.bug_id=106544)%20OR%20(bugs.reporter=map_reporter.userid%20AND%20bugs.assigned_to=map_assigned_to.userid%20AND%20bugs.bug_id&type0-0-0=equals&value0-0-0=106544 "http://bugzilla.mozilla.org/buglist.cgi?field0-0-0=bugs.bug_id=106544)%20OR%20(bugs.reporter=map_reporter.userid%20AND%20bugs.assigned_to=map_assigned_to.userid%20AND%20bugs.bug_id&type0-0-0=equals&value0-0-0=106544") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[bugzilla.mozilla.org/buglist.cgi?fiel...](http://bugzilla.mozilla.org/buglist.cgi?field0-0-0=bugs.bug_id=106544)%20OR%20(bugs.reporter=map_reporter.userid%20AND%20bugs.assigned_to=map_assigned_to.userid%20AND%20bugs.bug_id&type0-0-0=equals&value0-0-0=106544 "http://bugzilla.mozilla.org/buglist.cgi?field0-0-0=bugs.bug_id=106544)%20OR%20(bugs.reporter=map_reporter.userid%20AND%20bugs.assigned_to=map_assigned_to.userid%20AND%20bugs.bug_id&type0-0-0=equals&value0-0-0=106544")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: included in 2.14.1)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

included in 2.14.1

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | approval | ? |
| --- | --- | --- |
|  | approval5.0 | ? |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 6 obsolete files)

| [Patch v1](/attachment.cgi?id=61015)  [23 years ago](#c5)  [Dave Miller [:justdave]](/user_profile?user_id=10297)   2.17 KB, patch |  | [Details](/attachment.cgi?id=61015&action=edit) | [Diff](/attachment.cgi?id=61015&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61015) |
| --- | --- | --- |
| [Patch v2](/attachment.cgi?id=61048)  [23 years ago](#c8)  [Dave Miller [:justdave]](/user_profile?user_id=10297)   2.13 KB, patch | dkl : [review+](#c9 "23 years ago")  bbaetz : [review-](#c11 "23 years ago") | [Details](/attachment.cgi?id=61048&action=edit) | [Diff](/attachment.cgi?id=61048&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61048) |
| [Patch v3](/attachment.cgi?id=61699)  [23 years ago](#c14)  [Dave Miller [:justdave]](/user_profile?user_id=10297)   2.48 KB, patch |  | [Details](/attachment.cgi?id=61699&action=edit) | [Diff](/attachment.cgi?id=61699&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61699) |
| [Patch v4](/attachment.cgi?id=61700)  [23 years ago](#c15)  [Dave Miller [:justdave]](/user_profile?user_id=10297)   2.48 KB, patch | timeless : [review+](#c17 "23 years ago")  dkl : [review-](#c21 "23 years ago") | [Details](/attachment.cgi?id=61700&action=edit) | [Diff](/attachment.cgi?id=61700&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61700) |
| [Patch v5](/attachment.cgi?id=61915)  [23 years ago](#c18)  [Dave Miller [:justdave]](/user_profile?user_id=10297)   1.55 KB, patch | timeless : [review+](#c19 "23 years ago")  dkl : [review-](#c20 "23 years ago") | [Details](/attachment.cgi?id=61915&action=edit) | [Diff](/attachment.cgi?id=61915&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61915) |
| [Patch v6](/attachment.cgi?id=61925)  [23 years ago](#c22)  [Dave Miller [:justdave]](/user_profile?user_id=10297)   2.08 KB, patch |  | [Details](/attachment.cgi?id=61925&action=edit) | [Diff](/attachment.cgi?id=61925&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61925) |
| [Patch v7](/attachment.cgi?id=61926)  [23 years ago](#c23)  [Dave Miller [:justdave]](/user_profile?user_id=10297)   2.09 KB, patch | dkl : [review+](#c29 "23 years ago")  gerv : [review+](#c32 "23 years ago") | [Details](/attachment.cgi?id=61926&action=edit) | [Diff](/attachment.cgi?id=61926&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61926) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=109679#c0)• 23 years ago |
|  | |

I found this while enabling taint mode.
The above url will show you the summary of the test security group bug on bmo.
Not sure how to fix this - we can't sqlquote it, because its a field name. Maybe
check for a lack of spaces?

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=109679#c1)• 23 years ago |
|  | |

could look them up in the fieldid table to make sure they exist first before
adding them to the query.

|  | [Jacob Steenhagen](/user_profile?user_id=4897) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=109679#c2)• 23 years ago |
|  | |

I don't think all possible fields exist in the fielddefs table, do they? How do
we build this list in query.cgi? We can just validate the field name using the
same (or similar) code (moving it to globals if needed).
Of course if it's built using the fielddefs table, then that's obviously the
right answer :) Off to look at some code...

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=109679#c3)• 23 years ago |
|  | |

I tihnk it is, but that will be really really slow (although we could read them
into a hash at the beginning, I guess).
Checking for spaces doesn't work, because "Days since bug changed" uses an sql
expression. Yuck.

|  | [Matthew Tuck [:CodeMachine]](/user_profile?user_id=4412) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=109679#a32489_4412)• 23 years ago |

Priority: -- → P1Target Milestone: --- → Bugzilla 2.16

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=109679#c4)• 23 years ago |
|  | |

the field list in the popup is generated from the fielddefs table. Just
validate it against that when it comes back. No, fielddefs isn't necessarily
complete, but if it's not in fielddefs (with 1 or 2 obvious exceptions) it won't
be in the field popup in the boolean chart, either.

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=109679#c5)• 23 years ago |
|  | |

Attached patch

[Patch v1](attachment.cgi?id=61015&action=diff) (obsolete)
— [Details](attachment.cgi?id=61015&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61015)

Not the ideal fix, but it's a quick hack, and it does seal up the security
hole...

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=109679#c6)• 23 years ago |
|  | |

Comment on [attachment 61015](/attachment.cgi?id=61015 "Patch v1") [[details]](/attachment.cgi?id=61015&action=edit "Patch v1") [[diff]](/attachment.cgi?id=61015&action=diff "Patch v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61015)
Patch v1
This is, well...
Are you going to apply to the trunk?
>+ # get a list of field names to verify against
>+ my @chartfields;
>+ push(@chartfields, "noop");
>+ SendSQL("SELECT name FROM fielddefs ORDER BY sortkey");
>+ while (MoreSQLData()) {
>+ my ($name) = FetchSQLData();
>+ push(@chartfields, $name);
>+ }
Why ORDER BY? IF you want to, you could ORDER BY name, and then do a binary
search below, but I don't
know if its worth it.
>
> $row = 0;
> for ($chart=-1 ;
> $chart < 0 || exists $F{"field$chart-0-0"} ;
>- $chart++) {
>+ $chart++)
>+ {
(random brace changes)
I'll test later

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=109679#c7)• 23 years ago |
|  | |

You're right, the ORDER BY isn't necessary. I copied the SQL from the code that
creates that popup menu to begin with, it used it, but that's probably so the
items in the popup menu would be in the right order when displayed on the page.
The brace changes were just because I was touching a block of code, so I made
the whole block comply with the style guidelines.
Yes, it was intended for checkin both on 2.14.1 and the trunk.

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=109679#c8)• 23 years ago |
|  | |

Attached patch

[Patch v2](attachment.cgi?id=61048&action=diff) (obsolete)
— [Details](attachment.cgi?id=61048&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61048)

Cleaner code. Hashes the legal values instead of using an array. This way you
can simple check if it exists instead of having to grep for it.
[Attachment #61015](/attachment.cgi?id=61015&action=edit "Patch v1") -
Attachment is obsolete: true

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=109679#c9)• 23 years ago |
|  | |

Comment on [attachment 61048](/attachment.cgi?id=61048 "Patch v2") [[details]](/attachment.cgi?id=61048&action=edit "Patch v2") [[diff]](/attachment.cgi?id=61048&action=diff "Patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61048)
Patch v2
Looks good. Verified that self-made SQL cannot be inserted into query string
without generating an error.
r=dkl
[Attachment #61048](/attachment.cgi?id=61048&action=edit "Patch v2") -
Flags: review+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=109679#c10)• 23 years ago |
|  | |

Hmm, it seems the bulk change thinks I'm not changing anything if all I do is
add names to the CC list, so I guess I have to make a comment. Anyhow, adding
the representatives from the organizations we know of that support Bugzilla
distributions so they're aware of our upcoming security release

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=109679#c11)• 23 years ago |
|  | |

Comment on [attachment 61048](/attachment.cgi?id=61048 "Patch v2") [[details]](/attachment.cgi?id=61048&action=edit "Patch v2") [[diff]](/attachment.cgi?id=61048&action=diff "Patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61048)
Patch v2
Just to mentiuon what we discussed on irc: this doesn't work with commetn
seraches, because either long\_desc or longdesc is valid, and the fielddefs
table only contains longdesc. You probably need to manually push that.
[Attachment #61048](/attachment.cgi?id=61048&action=edit "Patch v2") -
Flags: review-

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=109679#c12)• 23 years ago |
|  | |

You tried everything else, so that's the only "exception" one?

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=109679#c13)• 23 years ago |
|  | |

I tried most stuff, but obviously I didn't try every possible combination. I did
browse the source code, so I think so. I think we should get this (and the
others) on b.m.o asap, and see who complains, then release in a couple of days.
Add a comment to the error which says "please report your query ASAP to
#mozwebtools", or something.
About 30 seconds would have been enough for the comment one :)

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=109679#c14)• 23 years ago |
|  | |

Attached patch

[Patch v3](attachment.cgi?id=61699&action=diff) (obsolete)
— [Details](attachment.cgi?id=61699&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61699)

Adds the long\_desc field to the valid list. Also adds a comment in the error
to mail the buglist url to us if they didn't do it on purpose.
[Attachment #61048](/attachment.cgi?id=61048&action=edit "Patch v2") -
Attachment is obsolete: true

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=109679#c15)• 23 years ago |
|  | |

Attached patch

[Patch v4](attachment.cgi?id=61700&action=diff) (obsolete)
— [Details](attachment.cgi?id=61700&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61700)

fixes stupid syntax error....
[Attachment #61699](/attachment.cgi?id=61699&action=edit "Patch v3") -
Attachment is obsolete: true

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=109679#c16)• 23 years ago |
|  | |

For the record, a review on this patch doesn't necessarily mean this is the best
way to do this.... this is a security fix that we need to get out ASAP. A
positive review on this patch needs only indicate the following things:
1) Most importantly, that it seals the security hole
2) It doesn't break any existing functionality
If the above two are accomplished, I will check this in as-is, rather that
trying to do it in a "better" way. We can fix it correctly for 2.16 or 2.18.
But we need to get the 2.14.1 update out ASAP.

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=109679#c17)• 23 years ago |
|  | |

Comment on [attachment 61700](/attachment.cgi?id=61700 "Patch v4") [[details]](/attachment.cgi?id=61700&action=edit "Patch v4") [[diff]](/attachment.cgi?id=61700&action=diff "Patch v4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61700)
Patch v4
r=timeless, with the following caveat: branches should receive the minimalist
safe changes to solve the problem. This excludes generic style assertions (as
is the case here) unless the old style is actually risky (this is not the
case).
[Attachment #61700](/attachment.cgi?id=61700&action=edit "Patch v4") -
Flags: review+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=109679#c18)• 23 years ago |
|  | |

Attached patch

[Patch v5](attachment.cgi?id=61915&action=diff) (obsolete)
— [Details](attachment.cgi?id=61915&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61915)

Revised patch, same as v4, but intended for the 2.14.1 branch only. v4 can
still be applied to the trunk. Only difference is the lack of brace changes.
I agree with timeless, shouldn't make style changes on a security-only update
to an existing release.

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=109679#c19)• 23 years ago |
|  | |

Comment on [attachment 61915](/attachment.cgi?id=61915 "Patch v5") [[details]](/attachment.cgi?id=61915&action=edit "Patch v5") [[diff]](/attachment.cgi?id=61915&action=diff "Patch v5") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61915)
Patch v5
:-)
r=timeless
[Attachment #61915](/attachment.cgi?id=61915&action=edit "Patch v5") -
Flags: review+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=109679#c20)• 23 years ago |
|  | |

Comment on [attachment 61915](/attachment.cgi?id=61915 "Patch v5") [[details]](/attachment.cgi?id=61915&action=edit "Patch v5") [[diff]](/attachment.cgi?id=61915&action=diff "Patch v5") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61915)
Patch v5
The v5 patch generates an error for me on both TRUNK and the 2.14.1 branch.
Internal error: Can't use longdescnames\_.login\_name as a field name. If you
think you're getting this in error, please copy the entire URL out of the
address bar at the top of your browser window and email it to
&lt;109679@bugzilla.org&gt; at /var/www/bugzilla/mozilla-2.14.1/buglist.cgi
line 727.
<http://bugzilla.redhat.com/mozilla-2.14.1/buglist.cgi?bug_status=NEW&bug_status>
=ASSIGNED&bug\_status=REOPENED&email1=dkl%40redhat.com&emailtype1=substring&emai
lassigned\_to1=1&emailreporter1=1&emailcc1=1&emaillongdesc1=1&email2=&emailtype2
=substring&emailreporter2=1&bugidtype=include&bug\_id=&changedin=&votes=&chfield
from=&chfieldto=Now&chfieldvalue=&product=TestProduct&short\_desc=&short\_desc\_ty
pe=allwordssubstr&long\_desc=&long\_desc\_type=allwordssubstr&bug\_file\_loc=&bug\_fi
le\_loc\_type=allwordssubstr&field0-0-0=noop&type0-0-0=noop&value0-0-0=&cmdtype=d
oit&newqueryname=&order=Reuse+same+sort+as+last+time
[Attachment #61915](/attachment.cgi?id=61915&action=edit "Patch v5") -
Flags: review-

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=109679#c21)• 23 years ago |
|  | |

Comment on [attachment 61700](/attachment.cgi?id=61700 "Patch v4") [[details]](/attachment.cgi?id=61700&action=edit "Patch v4") [[diff]](/attachment.cgi?id=61700&action=diff "Patch v4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61700)
Patch v4
Generates error message similar to one from the v5 of this patch.
[Attachment #61700](/attachment.cgi?id=61700&action=edit "Patch v4") -
Flags: review-

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=109679#c22)• 23 years ago |
|  | |

Attached patch

[Patch v6](attachment.cgi?id=61925&action=diff) (obsolete)
— [Details](attachment.cgi?id=61925&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61925)

OK, change in design here... we're finding too many conflicts with internal
values... and we don't need to keep adding the internal values to the list of
things that are okay... the trick is that we only need to validate the values
passed from the query form, not the internally generated values. All of the
internally generated stuff is shoved into chart #-1 in the form hash before the
form hash is processed for chart values. So when we're doing our validation,
we'll just blindly accept anything in chart #-1. To guarantee the user didn't
stuff something in chart #-1 on us, anything in chart #-1 is deleted before we
stuff the internally generated stuff in it.
[Attachment #61700](/attachment.cgi?id=61700&action=edit "Patch v4") -
Attachment is obsolete: true
[Attachment #61915](/attachment.cgi?id=61915&action=edit "Patch v5") -
Attachment is obsolete: true

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=109679#c23)• 23 years ago |
|  | |

Attached patch

[Patch v7](attachment.cgi?id=61926&action=diff)
— [Details](attachment.cgi?id=61926&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61926)

Fix brainless typo
[Attachment #61925](/attachment.cgi?id=61925&action=edit "Patch v6") -
Attachment is obsolete: true

|  | [Jacob Steenhagen](/user_profile?user_id=4897) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=109679#c24)• 23 years ago |
|  | |

Comment on [attachment 61926](/attachment.cgi?id=61926 "Patch v7") [[details]](/attachment.cgi?id=61926&action=edit "Patch v7") [[diff]](/attachment.cgi?id=61926&action=diff "Patch v7") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61926)
Patch v7
>Index: buglist.cgi
...
>+ die "Internal error: $errstr" if $chart < 0;
>+ return Error($errstr);
I'm assuming the reason we die if $chart < 0 otherwise we "return Error()" is
that the HTML header is incomplete when we're called the first time, but has
been sent by the time this loop is run the second time. Perhaps a comment
stating this (or the real reason if I'm off base :) would be a good idea...
[Attachment #61926](/attachment.cgi?id=61926&action=edit "Patch v7") -
Flags: review-

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=109679#c25)• 23 years ago |
|  | |

The new patch checks out fine on both BUGZILLA-2\_14\_1-BRANCH and TRUNK
for me. I will check back to see if there is a new one with the suggested change by
Jake soon and wait til then to check off as reviewed.

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=109679#c26)• 23 years ago |
|  | |

Jake: I have no idea why it's using 'die' there. I copied existing
error-spewing code from elsewhere within the chart matrix, assuming anything
that errors out of the chart should error the same way. I wasn't trying to
change that with this patch.

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=109679#c27)• 23 years ago |
|  | |

Look to the patches for [bug 103778](/show_bug.cgi?id=103778 "RESOLVED FIXED - templatize buglist.cgi") to see how I reimplemented the error code in
the new buglist.cgi.

|  | [Jacob Steenhagen](/user_profile?user_id=4897) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=109679#c28)• 23 years ago |
|  | |

Comment on [attachment 61926](/attachment.cgi?id=61926 "Patch v7") [[details]](/attachment.cgi?id=61926&action=edit "Patch v7") [[diff]](/attachment.cgi?id=61926&action=diff "Patch v7") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61926)
Patch v7
Given the explination about why the error handling code that, I'll recind my
needs-work. Still haven't tested it, so I can't give it an r=...

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=109679#c29)• 23 years ago |
|  | |

Comment on [attachment 61926](/attachment.cgi?id=61926 "Patch v7") [[details]](/attachment.cgi?id=61926&action=edit "Patch v7") [[diff]](/attachment.cgi?id=61926&action=diff "Patch v7") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61926)
Patch v7
Tested fine for functionality on both HEAD and the 2.14.1 branch.
r=dkl
[Attachment #61926](/attachment.cgi?id=61926&action=edit "Patch v7") -
Flags: review+

|  | [Zach Lipton [:zach]](/user_profile?user_id=15368) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=109679#c30)• 23 years ago |
|  | |

Comment on [attachment 61926](/attachment.cgi?id=61926 "Patch v7") [[details]](/attachment.cgi?id=61926&action=edit "Patch v7") [[diff]](/attachment.cgi?id=61926&action=diff "Patch v7") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61926)
Patch v7
removing needs-work as per Jake's comments
[Attachment #61926](/attachment.cgi?id=61926&action=edit "Patch v7") -
Flags: review-

|  | [Jacob Steenhagen](/user_profile?user_id=4897) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=109679#c31)• 23 years ago |
|  | |

I really did intend to check that box :)

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=109679#c32)• 23 years ago |
|  | |

Comment on [attachment 61926](/attachment.cgi?id=61926 "Patch v7") [[details]](/attachment.cgi?id=61926&action=edit "Patch v7") [[diff]](/attachment.cgi?id=61926&action=diff "Patch v7") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109679&attachment=61926)
Patch v7
r=gerv. This seems fine to me.
Gerv
[Attachment #61926](/attachment.cgi?id=61926&action=edit "Patch v7") -
Flags: review+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=109679#c33)• 23 years ago |
|  | |

checked in on the 2.14.1 branch:
/cvsroot/mozilla/webtools/bugzilla/buglist.cgi,v <-- buglist.cgi
new revision: 1.139.2.2; previous revision: 1.139.2.1
and on the trunk:
/cvsroot/mozilla/webtools/bugzilla/buglist.cgi,v <-- buglist.cgi
new revision: 1.155; previous revision: 1.154
Status: NEW → RESOLVEDClosed: 23 years agoResolution: --- → FIXED

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=109679#a5707669_10297)• 23 years ago |

Whiteboard: included in 2.14.1

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Reporter |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=109679#c34)• 23 years ago |
|  | |

2.14.1 is out; opening up fixed security bugGroup: security?

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=109679#a350361711_1)• 12 years ago |

QA Contact: matty\_is\_a\_geek → default-qa
You need to [log in](/show_bug.cgi?id=109679&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Dave Miller [:justdave]](/user_profile?user_id=10297)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_881e697a_20250125_164219.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/109690)
* [XML](/show_bug.cgi?ctype=xml&id=109690)

Closed
[Bug 109690](/show_bug.cgi?id=109690)

Opened 23 years ago
Closed 23 years ago

# [security] longlist.cgi doesn't check that $bug is valid

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[security] longlist.cgi doesn't check that $bug is valid

## Categories

### (Bugzilla :: Query/Bug List, defect, P1)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Query%2FBug%20List#Query%2FBug%20List)

Query/Bug List
▾

Bugzilla :: Query/Bug List
Anything to do with searching for bugs and viewing the buglists. `query.cgi` and `buglist.cgi`
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Query%2FBug%20List&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Query%2FBug%20List&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Query%2FBug%20List)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.15

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

blocker

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 2.16

## People

### (Reporter: bbaetz, Assigned: bbaetz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/3ac0810ff2d431ec44f087f4fa2bf042?d=mm&size=40)  [bbaetz](/user_profile?user_id=29274)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3ac0810ff2d431ec44f087f4fa2bf042?d=mm&size=40)  [bbaetz](/user_profile?user_id=29274)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### ( [URL](http://bugzilla.mozilla.org/long_list.cgi?buglist=106544%20OR%20(assign.userid%20=%20bugs.assigned_to%20and%20report.userid%20=%20bugs.reporter%20AND%20bugs.bug_id=106544) "http://bugzilla.mozilla.org/long_list.cgi?buglist=106544%20OR%20(assign.userid%20=%20bugs.assigned_to%20and%20report.userid%20=%20bugs.reporter%20AND%20bugs.bug_id=106544)") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[bugzilla.mozilla.org/long\_list.cgi?bu...](http://bugzilla.mozilla.org/long_list.cgi?buglist=106544%20OR%20(assign.userid%20=%20bugs.assigned_to%20and%20report.userid%20=%20bugs.reporter%20AND%20bugs.bug_id=106544) "http://bugzilla.mozilla.org/long_list.cgi?buglist=106544%20OR%20(assign.userid%20=%20bugs.assigned_to%20and%20report.userid%20=%20bugs.reporter%20AND%20bugs.bug_id=106544)")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: applied to 2.14.1)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

applied to 2.14.1

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | approval | ? |
| --- | --- | --- |
|  | approval5.0 | ? |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [obvious patch](/attachment.cgi?id=57448)  [23 years ago](#c1)  [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)   582 bytes, patch | justdave : [review+](#c2 "23 years ago")  gerv : [review+](#c3 "23 years ago") | [Details](/attachment.cgi?id=57448&action=edit) | [Diff](/attachment.cgi?id=57448&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57448) |
| --- | --- | --- |
| [fix style nits](/attachment.cgi?id=57450)  [23 years ago](#c4)  [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)   581 bytes, patch | justdave : [review-](#c6 "23 years ago") | [Details](/attachment.cgi?id=57450&action=edit) | [Diff](/attachment.cgi?id=57450&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57450) |
| [oops](/attachment.cgi?id=57451)  [23 years ago](#c8)  [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)   617 bytes, patch | justdave : [review+](#c10 "23 years ago")  gerv : [review+](#c11 "23 years ago") | [Details](/attachment.cgi?id=57451&action=edit) | [Diff](/attachment.cgi?id=57451&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57451) |
| [Combination of the previous two patches, applies cleanly to 2.14](/attachment.cgi?id=58206)  [23 years ago](#c14)  [Dave Miller [:justdave]](/user_profile?user_id=10297)   549 bytes, patch |  | [Details](/attachment.cgi?id=58206&action=edit) | [Diff](/attachment.cgi?id=58206&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=58206) |
| [patch that works on post-2.14, pre-tip versions](/attachment.cgi?id=61779)  [23 years ago](#c17)  [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)   619 bytes, patch |  | [Details](/attachment.cgi?id=61779&action=edit) | [Diff](/attachment.cgi?id=61779&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=61779) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=109690#c0)• 23 years ago |
|  | |

See above url, again made more complicated to avoid stalling bmo. This one comes
very close to giving up the comments, too, but fails the attachments table
lookup with an invalid column id. You can get arround that by adding something
like 1<2, but then you get every single comment in the db. You don't want that :)
patch coming

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=109690#c1)• 23 years ago |
|  | |

Attached patch

[obvious patch](attachment.cgi?id=57448&action=diff) (obsolete)
— [Details](attachment.cgi?id=57448&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57448)

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=109690#c2)• 23 years ago |
|  | |

Comment on [attachment 57448](/attachment.cgi?id=57448 "obvious patch") [[details]](/attachment.cgi?id=57448&action=edit "obvious patch") [[diff]](/attachment.cgi?id=57448&action=diff "obvious patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57448)
obvious patch
r= justdave
[Attachment #57448](/attachment.cgi?id=57448&action=edit "obvious patch") -
Flags: review+

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=109690#c3)• 23 years ago |
|  | |

Comment on [attachment 57448](/attachment.cgi?id=57448 "obvious patch") [[details]](/attachment.cgi?id=57448&action=edit "obvious patch") [[diff]](/attachment.cgi?id=57448&action=diff "obvious patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57448)
obvious patch
r=gerv, under duress. I still think it should be
detaint\_natural($bug) || next;
Gerv
[Attachment #57448](/attachment.cgi?id=57448&action=edit "obvious patch") -
Flags: review+

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=109690#c4)• 23 years ago |
|  | |

Attached patch

[fix style nits](attachment.cgi?id=57450&action=diff)
— [Details](attachment.cgi?id=57450&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57450)

[Attachment #57448](/attachment.cgi?id=57448&action=edit "obvious patch") -
Attachment is obsolete: true

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=109690#c5)• 23 years ago |
|  | |

...and checked inStatus: NEW → RESOLVEDClosed: 23 years agoResolution: --- → FIXED

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=109690#c6)• 23 years ago |
|  | |

Comment on [attachment 57450](/attachment.cgi?id=57450 "fix style nits") [[details]](/attachment.cgi?id=57450&action=edit "fix style nits") [[diff]](/attachment.cgi?id=57450&action=diff "fix style nits") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57450)
fix style nits
uhhh... That just doesn't look right. (should be either "if" or "||", not
both, shouldn't it?
[Attachment #57450](/attachment.cgi?id=57450&action=edit "fix style nits") -
Flags: review-

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=109690#c7)• 23 years ago |
|  | |

back it out, it's brokenStatus: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=109690#c8)• 23 years ago |
|  | |

Attached patch

[oops](attachment.cgi?id=57451&action=diff)
— [Details](attachment.cgi?id=57451&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57451)

[Attachment #57450](/attachment.cgi?id=57450&action=edit "fix style nits") -
Attachment is obsolete: true

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=109690#c9)• 23 years ago |
|  | |

Ladies and Gentlemen....
this is why ANY change to a patch (even if the reviewers already said they'd
approve it if you made that change) needs to be reviewed over again before it
gets checked in.
Please don't check in revised patches without posting to the bug first.

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=109690#c10)• 23 years ago |
|  | |

Comment on [attachment 57451](/attachment.cgi?id=57451 "oops") [[details]](/attachment.cgi?id=57451&action=edit "oops") [[diff]](/attachment.cgi?id=57451&action=diff "oops") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57451)
oops
r= justdave
[Attachment #57451](/attachment.cgi?id=57451&action=edit "oops") -
Flags: review+

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=109690#c11)• 23 years ago |
|  | |

Comment on [attachment 57451](/attachment.cgi?id=57451 "oops") [[details]](/attachment.cgi?id=57451&action=edit "oops") [[diff]](/attachment.cgi?id=57451&action=diff "oops") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57451)
oops
r=gerv.
Gerv
[Attachment #57451](/attachment.cgi?id=57451&action=edit "oops") -
Flags: review+

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=109690#c12)• 23 years ago |
|  | |

It was a one line patch, how could it go wrong?
Oops.Status: REOPENED → RESOLVEDClosed: 23 years ago → 23 years agoResolution: --- → FIXED

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=109690#c13)• 23 years ago |
|  | |

Comment on [attachment 57450](/attachment.cgi?id=57450 "fix style nits") [[details]](/attachment.cgi?id=57450&action=edit "fix style nits") [[diff]](/attachment.cgi?id=57450&action=diff "fix style nits") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=57450)
fix style nits
removing the obsolete flag on this patch, because it still has to be applied
before the next patch here to have a complete patch.
[Attachment #57450](/attachment.cgi?id=57450&action=edit "fix style nits") -
Attachment is obsolete: false

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=109690#c14)• 23 years ago |
|  | |

Attached patch

[Combination of the previous two patches, applies cleanly to 2.14](attachment.cgi?id=58206&action=diff)
— [Details](attachment.cgi?id=58206&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=58206)

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=109690#a444592_10297)• 23 years ago |

Whiteboard: applied to 2.14.1

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=109690#c15)• 23 years ago |
|  | |

[Attachment 58206](/attachment.cgi?id=58206 "Combination of the previous two patches, applies cleanly to 2.14") [[details]](/attachment.cgi?id=58206&action=edit "Combination of the previous two patches, applies cleanly to 2.14") [[diff]](/attachment.cgi?id=58206&action=diff "Combination of the previous two patches, applies cleanly to 2.14") checked into 2.14.1 branch:
/cvsroot/mozilla/webtools/bugzilla/long\_list.cgi,v <-- long\_list.cgi
new revision: 1.15.2.1; previous revision: 1.15

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=109690#a444667_10297)• 23 years ago |

Priority: -- → P1Target Milestone: --- → Bugzilla 2.16

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=109690#c16)• 23 years ago |
|  | |

Hmm, it seems the bulk change thinks I'm not changing anything if all I do is
add names to the CC list, so I guess I have to make a comment. Anyhow, adding
the representatives from the organizations we know of that support Bugzilla
distributions so they're aware of our upcoming security release

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=109690#c17)• 23 years ago |
|  | |

Attached patch

[patch that works on post-2.14, pre-tip versions](attachment.cgi?id=61779&action=diff)
— [Details](attachment.cgi?id=61779&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=61779)

Try this patch if [attachment 58206](/attachment.cgi?id=58206 "Combination of the previous two patches, applies cleanly to 2.14") [[details]](/attachment.cgi?id=58206&action=edit "Combination of the previous two patches, applies cleanly to 2.14") [[diff]](/attachment.cgi?id=58206&action=diff "Combination of the previous two patches, applies cleanly to 2.14") [[review]](/page.cgi?id=splinter.html&ignore=&bug=109690&attachment=58206) does not work for you. I used it to upgrade
b.m.o. with the fix, since b.m.o. was running a version with nearby changes
that caused the other patch to be rejected.
Incidentally, why doesn't this code use ValidateBugID? This situation is
exactly what that function was designed for, and it would provide a sensible
error message if someone entered an invalid bug ID, even if that ID was a
number.

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=109690#c18)• 23 years ago |
|  | |

The current code ignored bugs which didn't exist; we wanted to keep teh same
behaviour.

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=109690#c19)• 23 years ago |
|  | |

Are there common cases in which users pass a combination of valid and invalid
bug IDs to long\_list.cgi and expect Bugzilla to selectively return information
about only the valid ones? If so, that \*might\* be a reason to try to maintain
the old behavior.
Otherwise, there's no reason to maintain behavior that was an accident of our
failure to validate, and instead of failing silently we should do the normal
thing when a validation check fails, which is to display a message to the user
about it.

|  | [Mike Shaver (:shaver emeritus)](/user_profile?user_id=422) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=109690#c20)• 23 years ago |
|  | |

Opening security bugs for which fixes have appeared in official bugzilla
release. As per justdave and his posse.Group: security?

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=109690#c21)• 23 years ago |
|  | |

Looks like we're doing a 2.14.2 after all.
------------- begin forwarded message --------------
Date: Sun, 6 Jan 2002 12:34:01 +0100 (CET)
From: funkysh <funkysh@sm.pl>
To: <bugtraq@securityfocus.com>
Subject: Inproper input validation in Bugzilla <=2.14 - exploit
Since advisory and patched version is already released, here goes
description of vulnerabilities I discovered in Bugzilla almost year
ago.
1. Creating files on remote server.
-----------------------------------
Nothing spectacular, but this vulnerability may allow us easily
(at least when using Bugzilla with MySQL) to create files on
remote server in some cases, using MySQL's INTO OUTFILE.
long\_list.cgi:
my $generic\_query = "
select
bugs.bug\_id,
...
from bugs,profiles ...
where assign.userid = ... and";
$::FORM{'buglist'} = "" unless exists $::FORM{'buglist'};
foreach my $bug (split(/:/, $::FORM{'buglist'})) {
SendSQL("$generic\_query bugs.bug\_id = $bug");
[..]
As we can see $::FORM{'buglist'} (submitted by user) isn't quoted here,
also script doesn't check if bug\_id is numeric value. So we are able to
add extra SQL command into $generic\_query.
ok, let's try.. after login we request:
<http://site/bugzilla/long_list.cgi?buglist=1%20INTO%20OUTFILE%20%27/tmp/pussycat%27>
We are lucky, if everything works, we'll see only little message:
"Full Text Bug Listing", so we then know file is created. If any problem
occur script will happily inform us.
[funkysh@note] $ ls -l /tmp/pussycat
-rw-rw-rw- 1 mysql mysql 118 Jan 13 20:41 /tmp/pussycat
This may be serious problem if i.e. remote server running PHP,
and we have any writable dir inside DOCUMENT\_ROOT reachable from
outside, we can create some evil php script. (Bugzilla by default creates
directory 'data' with permissions sets to 777 afair, it is also not a
problem to find out real path.)
Btw. this one seems to be still unpatched in 2.14.1.
[remainder of message about existing exploits we fixed omitted]
------------- end of forwarded message --------------
I can reproduce this on both the 2.14.1 release and on the tip. This is NOT fixed.Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=109690#c22)• 23 years ago |
|  | |

I can only reproduce this on the tip if I comment out line 76:
detaint\_natural($bug) || next;
In both cases I get the same HTML response, but /tmp/pussycat only gets created
when that line is commented out, so this problem is, in fact, fixed. 2.14.1 has
the same validation code as the tip, so this problem should also be fixed on it,
but I have not tested that.

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=109690#c23)• 23 years ago |
|  | |

Tested on Bugzilla 2.14.1 installation. With vanilla installation,
/tmp/pussycat does not get created when I attempt to exploit this bug. If I
comment out line 76 of bug\_list.cgi, however, that file does get created. This
bug is fixed.Status: REOPENED → RESOLVEDClosed: 23 years ago → 23 years agoResolution: --- → FIXED

|  | [David D. Kilzer (ddk)](/user_profile?user_id=33620) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=109690#c24)• 23 years ago |
|  | |

I can not reproduce this on my CVS-tip unless I comment out the
one-line fix. I have not tested this on a local 2.14.1 install,
though.

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=109690#c25)• 23 years ago |
|  | |

Verified. I tested on both 2.14.1 release version and the cvs tip on local
installs and I'm unable to reproduce without removing the patch from this bug.
We could probably use a nicer message when there's no bugs to display, but
"that's another bug"Status: RESOLVED → VERIFIED

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=109690#a350350590_1)• 12 years ago |

QA Contact: matty\_is\_a\_geek → default-qa
You need to [log in](/show_bug.cgi?id=109690&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_93d3d22b_20250125_164216.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/108822)
* [XML](/show_bug.cgi?ctype=xml&id=108822)

Closed
[Bug 108822](/show_bug.cgi?id=108822)

Opened 23 years ago
Closed 23 years ago

# [security] Any user can change their groupset!

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[security] Any user can change their groupset!

## Categories

### (Bugzilla :: User Accounts, defect, P1)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=User%20Accounts#User%20Accounts)

User Accounts
▾

Bugzilla :: User Accounts
Anything about managing a user account from the user's perspective. `userprefs.cgi`, saved queries, creating accounts, changing passwords, logging in, etc.
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=User%20Accounts&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=User%20Accounts&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=User%20Accounts)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.15

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

blocker

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 2.16

## People

### (Reporter: bbaetz, Assigned: jacob)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/920fc2566882f43ca3192aee8238a0d9?d=mm&size=40)  [jacob](/user_profile?user_id=4897)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3ac0810ff2d431ec44f087f4fa2bf042?d=mm&size=40)  [bbaetz](/user_profile?user_id=29274)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[103885](/show_bug.cgi?id=103885 "RESOLVED FIXED - upgrade bugzilla installation on bugzilla.mozilla.org")

Dependency [tree](/showdependencytree.cgi?id=108822&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=108822)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: applied to 2.14.1)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

applied to 2.14.1

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | approval | ? |
| --- | --- | --- |
|  | approval5.0 | ? |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [patch](/attachment.cgi?id=56879)  [23 years ago](#c1)  [Jacob Steenhagen](/user_profile?user_id=4897)   647 bytes, patch | bbaetz : [review+](#c3 "23 years ago")  myk : [review+](#c4 "23 years ago") | [Details](/attachment.cgi?id=56879&action=edit) | [Diff](/attachment.cgi?id=56879&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108822&attachment=56879) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=108822#c0)• 23 years ago |
|  | |

userprefs.cgi has:
SendSQL("UPDATE profiles SET mybugslink = '" . $::FORM{'mybugslink'} .
"' WHERE userid = $userid");
playing with the mybugslink value on the form lets you do:
value="1', groupset='9223372036854775807"
It needs to be sqlescaped.

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108822#a663_27300)• 23 years ago |

Blocks: [103885](/show_bug.cgi?id=103885 "RESOLVED FIXED - upgrade bugzilla installation on bugzilla.mozilla.org")

|  | [Matthew Tuck [:CodeMachine]](/user_profile?user_id=4412) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108822#a5127_4412)• 23 years ago |

Priority: -- → P1Target Milestone: --- → Bugzilla 2.16

|  | [Jacob Steenhagen](/user_profile?user_id=4897)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=108822#c1)• 23 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=56879&action=diff)
— [Details](attachment.cgi?id=56879&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108822&attachment=56879)

|  | [Jacob Steenhagen](/user_profile?user_id=4897)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=108822#c2)• 23 years ago |
|  | |

Yuck, that's nasty. Once we get everything running in taint mode, it that'll be
a lot harder to do (because we'd have to validate it before we could pass it off
to the SQL server [running it through SqlQuote counts as validation]).Assignee: myk → jake

|  | [Jacob Steenhagen](/user_profile?user_id=4897)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108822#a24945_4897)• 23 years ago |

Status: NEW → ASSIGNEDKeywords: [patch](/buglist.cgi?keywords=patch&resolution=---),
[review](/buglist.cgi?keywords=review&resolution=---)

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=108822#c3)• 23 years ago |
|  | |

Comment on [attachment 56879](/attachment.cgi?id=56879 "patch") [[details]](/attachment.cgi?id=56879&action=edit "patch") [[diff]](/attachment.cgi?id=56879&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=108822&attachment=56879)
patch
r=bbaetz. My exploit no longer works
Should we validate that its 0 or 1? The code only cares about 0 or !0.
[Attachment #56879](/attachment.cgi?id=56879&action=edit "patch") -
Flags: review+

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=108822#c4)• 23 years ago |
|  | |

Comment on [attachment 56879](/attachment.cgi?id=56879 "patch") [[details]](/attachment.cgi?id=56879&action=edit "patch") [[diff]](/attachment.cgi?id=56879&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=108822&attachment=56879)
patch
works. r=myk
[Attachment #56879](/attachment.cgi?id=56879&action=edit "patch") -
Flags: review+

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=108822#c5)• 23 years ago |
|  | |

Checking in userprefs.cgi;
/cvsroot/mozilla/webtools/bugzilla/userprefs.cgi,v <-- userprefs.cgi
new revision: 1.24; previous revision: 1.23
done

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=108822#c6)• 23 years ago |
|  | |

The patch has been checked in, so resolving fixed.Status: ASSIGNED → RESOLVEDClosed: 23 years agoResolution: --- → FIXED

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=108822#c7)• 23 years ago |
|  | |

test mail after bz update.

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=108822#c8)• 23 years ago |
|  | |

This patch applied to the 2.14.1 branch with no changes.
/cvsroot/mozilla/webtools/bugzilla/userprefs.cgi,v <-- userprefs.cgi
new revision: 1.20.2.1; previous revision: 1.20
Whiteboard: applied to 2.14.1

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=108822#c9)• 23 years ago |
|  | |

Hmm, it seems the bulk change thinks I'm not changing anything if all I do is
add names to the CC list, so I guess I have to make a comment. Anyhow, adding
the representatives from the organizations we know of that support Bugzilla
distributions so they're aware of our upcoming security release

|  | [Mike Shaver (:shaver emeritus)](/user_profile?user_id=422) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=108822#c10)• 23 years ago |
|  | |

Opening security bugs for which fixes have appeared in official bugzilla
release. As per justdave and his posse.Group: security?

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108822#a350772237_1)• 12 years ago |

QA Contact: matty\_is\_a\_geek → default-qa
You need to [log in](/show_bug.cgi?id=108822&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jacob Steenhagen](/user_profile?user_id=4897)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_1bc1a35b_20250125_164213.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/108812)
* [XML](/show_bug.cgi?ctype=xml&id=108812)

Closed
[Bug 108812](/show_bug.cgi?id=108812)

Opened 23 years ago
Closed 23 years ago

# [security] We allow the user to send arbitary SQL!!!!!

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[security] We allow the user to send arbitary SQL!!!!!

## Categories

### (Bugzilla :: Query/Bug List, defect, P1)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Query%2FBug%20List#Query%2FBug%20List)

Query/Bug List
▾

Bugzilla :: Query/Bug List
Anything to do with searching for bugs and viewing the buglists. `query.cgi` and `buglist.cgi`
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Query%2FBug%20List&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Query%2FBug%20List&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Query%2FBug%20List)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.15

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

blocker

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 2.16

## People

### (Reporter: bbaetz, Assigned: jacob)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/920fc2566882f43ca3192aee8238a0d9?d=mm&size=40)  [jacob](/user_profile?user_id=4897)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3ac0810ff2d431ec44f087f4fa2bf042?d=mm&size=40)  [bbaetz](/user_profile?user_id=29274)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### ( [URL](http://bugzilla.mozilla.org/buglist.cgi?sql=1%3E2)%20OR%20(bugs.bug_id=106544%20AND%20bugs.reporter=map_reporter.userid%20AND%20bugs.assigned_to=map_assigned_to.userid "http://bugzilla.mozilla.org/buglist.cgi?sql=1%3E2)%20OR%20(bugs.bug_id=106544%20AND%20bugs.reporter=map_reporter.userid%20AND%20bugs.assigned_to=map_assigned_to.userid") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[103885](/show_bug.cgi?id=103885 "RESOLVED FIXED - upgrade bugzilla installation on bugzilla.mozilla.org")

Dependency [tree](/showdependencytree.cgi?id=108812&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=108812)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[bugzilla.mozilla.org/buglist.cgi?sql=...](http://bugzilla.mozilla.org/buglist.cgi?sql=1%3E2)%20OR%20(bugs.bug_id=106544%20AND%20bugs.reporter=map_reporter.userid%20AND%20bugs.assigned_to=map_assigned_to.userid "http://bugzilla.mozilla.org/buglist.cgi?sql=1%3E2)%20OR%20(bugs.bug_id=106544%20AND%20bugs.reporter=map_reporter.userid%20AND%20bugs.assigned_to=map_assigned_to.userid")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: applied to 2.14.1)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

applied to 2.14.1

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | approval | ? |
| --- | --- | --- |
|  | approval5.0 | ? |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [patch](/attachment.cgi?id=56877)  [23 years ago](#c3)  [Jacob Steenhagen](/user_profile?user_id=4897)   1.08 KB, patch | bbaetz : [review+](#c5 "23 years ago")  myk : [review+](#c6 "23 years ago") | [Details](/attachment.cgi?id=56877&action=edit) | [Diff](/attachment.cgi?id=56877&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108812&attachment=56877) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=108812#c0)• 23 years ago |
|  | |

So, buglist.cgi has an sql paramater. And, as long as that doen't contain a
semicolon, we send it. Oops.
The above url will allow you to see the title of a test security group bug. Its
more complicated than it looks -
bugzilla.mozilla.org/buglist.cgi?sql=1%3E2)%20OR%20(bugs.bug\_id=106544 (%3E is
>, and %20 is space) would work as well, except that then we join the users
table cubed then, without conditions, and that takes a long long long long long
time on bmo.
This was presumably added for advanced query support, or something. Lets kill
it. Its a huge hole, and even if we someone patch it up it sitll makes me nervous.
This turned up another bug, which I discovered over the weekend - my
SelectVisible stuff does "WHERE (security conditions) AND other stuff" rather
than "WHERE (security conditions) AND (other stuff)". That wouldn't have helped
in this case, though, because the extra bracketing could have been easily
removed. Fixing that may be interesting, since the where clause isn't the end -
we have to search for HAVING/GROUP BY in the rest of the where, while still
letting people search for bugs containing the word having. I have no idea how to
do that. I was vaguely aware of this when I wrote the support, but all places
which use that code use AND. If someone can tell me how to fix it, I will.

|  | [Matthew Tuck [:CodeMachine]](/user_profile?user_id=4412) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=108812#c1)• 23 years ago |
|  | |

OK, options here appear to be one or more of:
1. Commenting it out and giving appropriate end-of-the-world warnings. I'm
hesitant to remove it as someone might have a use for it and have a closed
installation.
2. Properly parsing the SQL condition to ensure it is valdi. A bracket matching
algorithm would work out if the bracket count went below 1, however GROUP BY
does sound like it's another exploit.
3. Restricting usage of this parameter to some appropriate trusted group.

|  | [Matthew Tuck [:CodeMachine]](/user_profile?user_id=4412) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=108812#c2)• 23 years ago |
|  | |

s/warnings/Perl comments/

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108812#a5400_27300)• 23 years ago |

Blocks: [103885](/show_bug.cgi?id=103885 "RESOLVED FIXED - upgrade bugzilla installation on bugzilla.mozilla.org")

|  | [Matthew Tuck [:CodeMachine]](/user_profile?user_id=4412) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108812#a9667_4412)• 23 years ago |

Priority: -- → P1Target Milestone: --- → Bugzilla 2.16

|  | [Jacob Steenhagen](/user_profile?user_id=4897)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=108812#c3)• 23 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=56877&action=diff)
— [Details](attachment.cgi?id=56877&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=108812&attachment=56877)

|  | [Jacob Steenhagen](/user_profile?user_id=4897)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=108812#c4)• 23 years ago |
|  | |

My personal preference would be to just yank the code altogether. However, I
instead followed Matthew's reccomendation and commented it out w/a prepended
warning (perl comment).Assignee: endico → jake

|  | [Jacob Steenhagen](/user_profile?user_id=4897)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108812#a29367_4897)• 23 years ago |

Status: NEW → ASSIGNEDKeywords: [patch](/buglist.cgi?keywords=patch&resolution=---),
[review](/buglist.cgi?keywords=review&resolution=---)

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=108812#c5)• 23 years ago |
|  | |

Comment on [attachment 56877](/attachment.cgi?id=56877 "patch") [[details]](/attachment.cgi?id=56877&action=edit "patch") [[diff]](/attachment.cgi?id=56877&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=108812&attachment=56877)
patch
r=bbaetz for either this patch or one which just deletes it.
[Attachment #56877](/attachment.cgi?id=56877&action=edit "patch") -
Flags: review+

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=108812#c6)• 23 years ago |
|  | |

Comment on [attachment 56877](/attachment.cgi?id=56877 "patch") [[details]](/attachment.cgi?id=56877&action=edit "patch") [[diff]](/attachment.cgi?id=56877&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=108812&attachment=56877)
patch
It works. r=myk
[Attachment #56877](/attachment.cgi?id=56877&action=edit "patch") -
Flags: review+

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=108812#c7)• 23 years ago |
|  | |

Checking in buglist.cgi;
/cvsroot/mozilla/webtools/bugzilla/buglist.cgi,v <-- buglist.cgi
new revision: 1.153; previous revision: 1.152
done
Status: ASSIGNED → RESOLVEDClosed: 23 years agoResolution: --- → FIXED

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=108812#c8)• 23 years ago |
|  | |

This applied to the 2.14.1 branch with no changes.
/cvsroot/mozilla/webtools/bugzilla/buglist.cgi,v <-- buglist.cgi
new revision: 1.139.2.1; previous revision: 1.139
Whiteboard: applied to 2.14.1

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=108812#c9)• 23 years ago |
|  | |

Hmm, it seems the bulk change thinks I'm not changing anything if all I do is
add names to the CC list, so I guess I have to make a comment. Anyhow, adding
the representatives from the organizations we know of that support Bugzilla
distributions so they're aware of our upcoming security release

|  | [Mike Shaver (:shaver emeritus)](/user_profile?user_id=422) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=108812#c10)• 23 years ago |
|  | |

Opening security bugs for which fixes have appeared in official bugzilla
release. As per justdave and his posse.Group: security?

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=108812#a350776629_1)• 12 years ago |

QA Contact: matty\_is\_a\_geek → default-qa
You need to [log in](/show_bug.cgi?id=108812&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jacob Steenhagen](/user_profile?user_id=4897)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


