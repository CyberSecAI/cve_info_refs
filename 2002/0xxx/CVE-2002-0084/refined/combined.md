=== Content from www.kb.cert.org_28aff333_20250125_060632.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#161931

## Sun Solaris cachefsd vulnerable to stack overflow in fscache\_setup() function

#### Vulnerability Note VU#161931

Original Release Date: 2002-05-09 | Last Revised: 2002-05-13

---

### Overview

Sun's NFS/RPC cachefs daemon (cachefsd) is shipped and installed by default with Sun Solaris 2.5.1, 2.6, 7, and 8 (SPARC and Intel architectures). Cachefsd caches requests for operations on remote file systems mounted via the use of NFS protocol. An exploitable stack overflow exists in cachefsd that could permit a local attacker to execute arbitrary code with the privileges of the cachefsd, typically root.

### Description

| After creating a local file on the system, an attacker can exploit a stack overflow in cachefsd to execute arbitrary code with the privileges of the cachefsd process, typically root. Sun Microsystems has released a [Sun Alert Notification](http://sunsolve.Sun.COM/pub-cgi/retrieve.pl?doc=fsalert%2F44309) that addresses this issue as well as the issue described in [VU#635811](http://www.kb.cert.org/vuls/id/635811).  The Australian Computer Emergency Response Team has also issued an advisory related to incident activity exploiting cachefsd:   <http://www.auscert.org.au/Information/Advisories/advisory/AA-2002.01.txt> The eSecurityOnline team has also published a report on this vulnerability:  <http://www.eSecurityOnline.com/advisories/eSO4198.asp> This issue is also being referenced as [CAN-2002-0084](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0084):  <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0084> |
| --- |

### Impact

| An attacker can execute code with the privileges of the cachefsd process, typically root. |
| --- |

### Solution

| The CERT/CC is currently unaware of patches for this problem. |
| --- |

| According to the [Sun Alert Notification](http://sunsolve.Sun.COM/pub-cgi/retrieve.pl?doc=fsalert%2F44309) a workaround is as follows:  *Comment out cachefsd in /etc/inetd.conf as shown below:*  *#100235/1 tli rpc/tcp wait root /usr/lib/fs/cachefs/cachefsd cachefsd*  *Once the line is commented out either:*  *- reboot, or* *- send a HUP signal to inetd(1M) and kill existing cachefsd processes, for example,* *on Solaris 2.5.1 and 2.6 do the following:* *$ kill -HUP <PID of inetd>* *$ kill <PIDs of any cachefsd processes>* *Solaris 7 and 8 do the following:* *$ pkill -HUP inetd* *$ pkill cachefsd*  *The possible side effects of the workaround are:*  *- for systems not using cachefs:* *There is no impact.* *- for systems using cachefs:* *Only a "disconnected" operation is known to be affected by*  *disabling cachefsd. This feature is rarely used outside of AutoClient.* *Mounts and unmounts should still succeed though an error message*  *may be seen, "mount -F cachefs: cachefsd is not running".* *There is no performance impact.* *- for systems using AutoClient:* *The impact is unknown. Again, only "disconnected" mode is likely*  *to be affected.* |
| --- |

### Vendor Information

161931
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23161931/) to view vendors.**
### [Sun](#JARL-59YNL2) Affected

Updated:  May 09, 2002

### Status

Affected

### Vendor Statement

See the [Sun Alert Notification](http://sunsolve.Sun.COM/pub-cgi/retrieve.pl?doc=fsalert%2F44309) which addresses this issue.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Cray](#JARL-5A4KHK) Not Affected

Updated:  May 13, 2002

### Status

Not Affected

### Vendor Statement

Cray, Inc. is not vulnerable since cachefs is not supported under Unicos and Unicos/mk.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.auscert.org.au/Information/Advisories/advisory/AA-2002.01.txt>
* <http://www.eSecurityOnline.com/advisories/eSO4198.asp>
* <http://www.securityfocus.com/bid/4631>
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0084>
### Acknowledgements

Our thanks to AusCERT, eSecurityOnline, and the Sun Security Coordination Team, as well as Mark Dowd and Stephen James of IT Audit & Consulting for their analysis and reports about this vulnerability.

This document was written by Jason Rafail.

### Other Information

| **CVE IDs:** | [CVE-2002-0084](http://web.nvd.nist.gov/vuln/detail/CVE-2002-0084) |
| --- | --- |
| **Severity Metric:** | 22.84 |
| **Date Public:** | 2002-04-30 |
| **Date First Published:** | 2002-05-09 |
| **Date Last Updated:** | 2002-05-13 20:34 UTC |
| **Document Revision:** | 12 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


