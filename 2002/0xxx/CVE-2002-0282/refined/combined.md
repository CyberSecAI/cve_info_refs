=== Content from marc.info_bd60af1f_20250125_210851.html ===

```
[[prev in list](?l=bugtraq&m=101379217032525&w=2)] [[next in list](?l=bugtraq&m=101392705807305&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [ARL02-A02] DCP-Portal Root Path Disclosure Vulnerability
From:       [Ahmet Sabri ALPER <s_alper () hotmail ! com>](?a=101224154900001&r=1&w=2)
Date:       [2002-02-15 14:04:58](?l=bugtraq&r=1&w=2&b=200202)
[Download RAW [message](?l=bugtraq&m=101379160830631&q=mbox) or [body](?l=bugtraq&m=101379160830631&q=raw)]

+/--------\------- ALPER Research Labs   -----/--------/+
+/---------\------  Security Advisory    ----/---------/+
+/----------\-----    ID: ARL02-A02      ---/----------/+
+/-----------\---- salper@olympos.org    --/-----------/+

Advisory Information
--------------------
Name               : DCP-Portal Root Path Disclosure
Vulnerability
Software Package   : DCP-Portal
Vendor Homepage    : <http://www.dcp-portal.com>
Vulnerable Versions: v4.2, v4.1 final, v4.0 final, v3.7
and probably all
                     previous versions.
Platforms          : Linux
Vulnerability Type : Design Error
Vendor Contacted   : 09/02/2002 (no reply)
Prior Problems     : N/A
Current Version    : 4.2 (vulnerable)

Summary
-------
DCP-Portal is a content management system with
advanced features like
web-based update, link, file, member management,
poll, calendar, etc.
Its main features include an admin panel to manage
the entire site, a
smart HTML editor to add news, content, and
annoucements, the ability
for members to submit news/content and write
reviews, and much more.
It's an open-source project, which is also supported
by FreshMeat.

A vulnerability exists in Dcp-Portal, which could allow
any remote
user to view the full path to the web root.

Details
-------
If a user submits a HTTP request for
the "add_user.php", the system
will return an error page containing the path to the
web root.
The remote attacker may potentially use the
disclosed information to
aid in further attacks against the host running the
vulnerable software.

Example:
<http://www.dcp-portal_host.com.tr/add_user.php>
This would return;
"Warning: Cannot add header information - headers
already sent by (output
started at /home/usr/www.dcp-
portal_host/htdocs/add_user.php:11) in
/home/usr/www.dcp-
portal_host/htdocs/add_user.php on line 16"

Solution
--------
Suggested Solution:
Cut the lines 10-11 on add_user.php, and paste them
at line 20.
Vendor did not care to reply or was unreachable.

Credits
-------
Discovered on 09, February, 2002 by Ahmet Sabri
ALPER salper@olympos.org
Ahmet Sabri ALPER is the System Security Editor of
PCLIFE Magazine.

Olympos Turkish Security Portal:
<http://www.olympos.org>

References
----------
Product Web Page: <http://www.dcp-portal.com>

[[prev in list](?l=bugtraq&m=101379217032525&w=2)] [[next in list](?l=bugtraq&m=101392705807305&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_c204db31_20250125_210852.html ===

```
[[prev in list](?l=bugtraq&m=101494441307652&w=2)] [[next in list](?l=bugtraq&m=101495041519745&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [ARL02-A04] DCP-Portal System Information Path Disclosure
From:       [Ahmet Sabri ALPER <s_alper () hotmail ! com>](?a=101224154900001&r=1&w=2)
Date:       [2002-02-28 13:42:44](?l=bugtraq&r=1&w=2&b=200202)
[Download RAW [message](?l=bugtraq&m=101494497608620&q=mbox) or [body](?l=bugtraq&m=101494497608620&q=raw)]

+/--------\------- ALPER Research Labs   -----/--------/+
+/---------\------  Security Advisory    ----/---------/+
+/----------\-----    ID: ARL02-A04      ---/----------/+
+/-----------\---- salper@olympos.org    --/-----------/+

Advisory Information
--------------------
Name               : DCP-Portal System Information
                     Path Disclosure Vulnerability
Software Package   : DCP-Portal
Vendor Homepage    : <http://www.dcp-portal.com>
Vulnerable Versions: v4.5, v4.2, v4.1 final, v4.0 final,
v3.7
                     and v3.6
Platforms          : Linux
Vulnerability Type : Input Validation Error
Vendor Contacted   : 18/02/2002
Prior Problems     : BugTraq ID: 4113 & 4112
Current Version    : 4.5.1 (immune)

Summary
-------
DCP-Portal is a content management system with
advanced features like web-based update, link,
file, member management, poll, calendar, etc.
Its main features include an admin panel to
manage the entire site, a smart HTML editor
to add news, content, and annoucements, the
ability for members to submit news/content
and write reviews, and much more.
It's an open-source project, which is also
supported by FreshMeat.

A vulnerability exists in Dcp-Portal, which could
allow any remote user to view the full path to
the web root.

Details
-------
The new_language function carries out the selection
of the requested language file.
Currently, DCP-Portal supports 5 languages
including;
Turkish, English, French, Portuguese and Spanish.

If any user submits a maliciously crafted HTTP
request
this will enable a remote user to reveal the absolute
path to the web root and also more information about
the system might be revealed.
This issue may be exploited by requesting an invalid
language selection.

Example:
[http://dcp-portal_site/contents.php?](http://dcp-portal_site/contents.php)
new_language=elvish&mode=select
[http://dcp-portal_site/categories.php?](http://dcp-portal_site/categories.php)
new_language=elvish&mode=select
[http://dcp-portal_site/files.php?](http://dcp-portal_site/files.php)
new_language=elvish&mode=select
...
Where Elvish is a non-existing language file.

Solution
--------
The vendor verified the vulnerability in all given
versions.
After a 10 day period, he fixed all the bugs stated and
released a new version "v4.5.1" which is immune.
It can be downloaded from:
[http://www.dcp-portal.com/files.php?](http://www.dcp-portal.com/files.php)
action=viewcat&fcat_id=1

The workaround below was suggested by me:
Add control codes to the new_language function.
Eg:
if (exists ($requested_language)) {
# correct carry on
}
else {
die ("Invalid language request!");
}

Credits
-------
Discovered on 18, February, 2002
by Ahmet Sabri ALPER
salper@olympos.org
Ahmet Sabri ALPER is the
System Security Editor of PCLIFE Magazine.

References
----------
Product Web Page: <http://www.dcp-portal.com>
Olympos Turkish Security Portal:
<http://www.olympos.org>
[[prev in list](?l=bugtraq&m=101494441307652&w=2)] [[next in list](?l=bugtraq&m=101495041519745&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


