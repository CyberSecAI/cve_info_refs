=== Content from marc.info_f0e2ac0f_20250125_075608.html ===

```
[[prev in list](?l=bugtraq&m=101424947801895&w=2)] [[next in list](?l=bugtraq&m=101424225814604&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=101430810813853&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Symantec Enterprise Firewall (SEF) SMTP proxy inconsistencies](?t=101424321200002&r=1&w=2)
From:       ["Martin O'Neal" <BugTraq () corsaire ! com>](?a=98576610200003&r=1&w=2)
Date:       [2002-02-20 21:04:28](?l=bugtraq&r=1&w=2&b=200202)
[Download RAW [message](?l=bugtraq&m=101424307617060&q=mbox) or [body](?l=bugtraq&m=101424307617060&q=raw)]

-- Corsaire Limited Security Advisory --

Title: Symantec Enterprise Firewall (SEF) SMTP proxy inconsistencies
Date: 18.01.02
Application: Symantec Enterprise Firewall (SEF) 6.5.x
Environment: WinNT, Win2000
Author: Martin O'Neal [martin.oneal@corsaire.com]
Audience: General distribution

-- Scope --

The aim of this document is to clearly define some issues related to
a some SMTP proxy inconsistencies within the Symantec Enterprise
Firewall (SEF) environment as provided by Symantec [[1]](#1).

-- History --

Vendor notified: 18.01.02
Document released: 21.02.02

-- Overview --

The SEF firewall product uses an application proxy strategy to provide
enhanced security features for a variety of common protocols. For the
SMTP proxy, part of this additional functionality allows the firewall
to restrict the sender / recipient domains and to hide internal
infrastructure information from external recipients.

However, when the firewall is configured to provide network address
translation (NAT) to an SMTP connection (effectively hiding the internal
server behind a publicly routable address), this might not always be
conducted as desired.

-- Analysis --

The SMTP proxy works by analysing the SMTP format and optionally rewriting
some of the headers to achieve the desired aim.

When an inbound or outbound SMTP connection is NATed to an address other
than the one assigned to the physical firewall interface, then the SMTP
proxy still uses the physical interface name and address within the SMTP
protocol exchange.

This has two potential issues:

The first issue is that there is now a potential information leak;
additional information is contained within the SMTP protocol exchange that
could aid an attacker in analysing the firewall configuration.

The second issue is that any receiving / sending host that is configured
to enforce strict checks on the SMTP protocol exchange, might not accept
the connection due to the inconsistencies in the fields.

-- Proof of concept --

To reproduce this issue, place an SMTP host on an internal interface of the
SEF firewall. Create a rule that allows inbound and outbound traffic to this

host, then create an address translation and redirection entry that maps
SMTP connections to and from an external address other than the physical
interface address.

smtp address (internal)                1.1.1.1 (twist.dance.org)
firewall address (external physical)   2.2.2.2 (waltz.dance.org)
firewall address (external SMTP NAT)   2.2.2.254 (foxtrot.dance.org)
firewall name                          tango
firewall domain                        dance.org

redirect                               2.2.2.254 -> 1.1.1.1 (for SMTP only)
NAT                                    1.1.1.1 -> any (use 2.2.2.254)
NAT                                    any -> 1.1.1.1 (use client address)
rule                                   1.1.1.1 -> any (for SMTP only)
rule                                   any -> 1.1.1.1 (for SMTP only)

For inbound connections to 2.2.2.254:
-> 220 tango.dance.org Generic SMTP handler

For outbound connections from 2.2.2.254:
<- 220 ...
-> HELO waltz.dance.org
<- 250 ... talking to foxtrot.dance.org ([2.2.2.254])

-- Recommendations --

The SMTP proxy behaviour should be revised to resolve the information
within the protocol exchange to the correct host / address combination.

-- References --

[[1]](#-1) <http://enterprisesecurity.symantec.com/products/products.cfm?ProductID>
    =47&PID=9674250&EID=0

-- Revision --

a. Initial release.

Copyright 2002 Corsaire Limited. All rights reserved.

-----------------------------------------------------------------------------------------------------------------------

CONFIDENTIALITY:  This e-mail and any files transmitted with it are
confidential and intended solely for the use of the recipient(s) only.
Any review, retransmission, dissemination or other use of, or taking
any action in reliance upon this information by persons or entities
other than the intended recipient(s) is prohibited.  If you have
received this e-mail in error please notify the sender immediately
and destroy the material whether stored on a computer or otherwise.
-----------------------------------------------------------------------------------------------------------------------

DISCLAIMER:  Any views or opinions presented within this e-mail are
solely those of the author and do not necessarily represent those
of Corsaire Limited, unless otherwise specifically stated.
-----------------------------------------------------------------------------------------------------------------------

Corsaire Limited, 3 Tannery House, Tannery Lane, Send, Surrey, GU23 7EF
Telephone: +44(0)1483-226000  Email:info@corsaire.com

This footnote confirms that this e-mail message has been swept by
MIMEsweeper for the presence of computer viruses.

[[prev in list](?l=bugtraq&m=101424947801895&w=2)] [[next in list](?l=bugtraq&m=101424225814604&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=101430810813853&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_73adbbf2_20250125_075608.html ===

```
[[prev in list](?l=bugtraq&m=101432986921623&w=2)] [[next in list](?l=bugtraq&m=101430770412350&w=2)] [[prev in thread](?l=bugtraq&m=101424307617060&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Symantec Enterprise Firewall (SEF) SMTP proxy inconsistencies](?t=101424321200002&r=1&w=2)
From:       ["Sym Security" <symsecurity () symantec ! com>](?a=99000412200001&r=1&w=2)
Date:       [2002-02-21 14:08:27](?l=bugtraq&r=1&w=2&b=200202)
[Download RAW [message](?l=bugtraq&m=101430810813853&q=mbox) or [body](?l=bugtraq&m=101430810813853&q=raw)]

On 02/20/2002, Martin O'Neal of Corsaire Ltd. posted:

-- Corsaire Limited Security Advisory --

Title: Symantec Enterprise Firewall (SEF) SMTP proxy inconsistencies
Date: 18.01.02
Application: Symantec Enterprise Firewall (SEF) 6.5.x
Environment: WinNT, Win2000
Author: Martin O'Neal [martin.oneal@corsaire.com]
Audience: General distribution

-- Scope --

The aim of this document is to clearly define some issues related to
a some SMTP proxy inconsistencies within the Symantec Enterprise
Firewall (SEF) environment as provided by Symantec [[1]](#1).

-- History --

Vendor notified: 18.01.02
Document released: 21.02.02

-- Overview --

The SEF firewall product uses an application proxy strategy to provide
enhanced security features for a variety of common protocols. For the
SMTP proxy, part of this additional functionality allows the firewall
to restrict the sender / recipient domains and to hide internal
infrastructure information from external recipients.

However, when the firewall is configured to provide network address
translation (NAT) to an SMTP connection (effectively hiding the internal
server behind a publicly routable address), this might not always be
conducted as desired.

---------------------------snip-

Symantec Security Response Advisory

15 February, 2002
Symantec Enterprise Firewall SMTP Proxy Issues

Reference
Corsaire Limited Security Advisory 020118-001a.txt

Risk Impact
Low

Affected Components
Symantec Enterprise Firewall versions 6.5.x and 7.0

Overview
Corsaire Limited has discovered two low-risk issues with Symantec
Enterprise Firewall. The first is a potential information leak in the
Symantec Enterprise Firewall Simple Mail Transfer Protocol (SMTP) proxy
environment that could provide inappropriate information on the firewall
configuration. The second is that inconsistencies in the SMTP protocol
exchange could cause a connection to be denied.

Details
Corsaire Limited notified Symantec Corporation of some issues in the way
the Symantec Enterprise Firewall SMTP proxy worked with network address
translation (NAT). These issues could cause some undesirable results.

Symantec Enterprise Firewall uses application proxies to provide enhanced
security. Uses of this feature include restricting the sender/recipient
domains and hiding internal infrastructure information from external users.
Corsaire Limited discovered that when Symantec Enterprise Firewall is
configured to provide NAT to an SMTP connection, the function to hide the
internal server address by mapping it to an external public address is not
performed in a completely desirable manner.

The Symantec Enterprise Firewall SMTP proxy should analyze the SMTP format
and dynamically change the IP address as well as edit the required IP
header. Corsaire Limited's research demonstrated that when the inbound or
outbound SMTP connection was translated to an address other than the
address assigned to the physical firewall interface, the SMTP proxy
continued to use the name and address of the physical interface in the SMTP
protocol exchange.

There are two low-risk issues with the way Symantec Enterprise Firewall is
handling the SMTP proxy interface. First, there is a potential information
leak. Information is included in the SMTP protocol exchange that could,
possibly, aid a malicious intruder in analyzing the firewall configuration.
Second, a receiving/transmitting host that is configured to enforce strict
checks on the SMTP protocol exchange may not accept the connection due to
inconsistencies in the field. This could result in the nondelivery or
bouncing of mail messages.

Symantec Response
Symantec has verified the issues discovered by Corsaire Limited and
developed a fix that will be included with the near-future release of
Symantec Enterprise Firewall version 8.0. Until then, use the following
workarounds to address these issues:

* Configure Symantec Enterprise Firewall to use the same name for the
firewall name and the firewall external interface name. This workaround
results in consistent names for SMTP replies.
* If NAT is not needed, use the SMTP wizard included with Symantec
Enterprise Firewall to set up rules and redirects for all inbound and
outbound SMTP traffic.

Credit
Symantec takes the security of its products very seriously. Symantec
appreciates the coordination of Martin O'Neal and Corsaire Limited in
identifying and providing technical details of potential areas of concern
so it can quickly address the issue. Anyone with information on security
issues with Symantec products should contact symsecurity@symantec.com.

This advisory can be viewed at
<http://securityresponse.symantec.com/avcenter/security/Content/2002.02.20.html>

Copyright (c) 2001 by Symantec Corp.
Permission to redistribute this Advisory electronically is granted as long
as it is not edited in any way unless authorized by Symantec Security
Response. Reprinting the whole or part of this Advisory in a medium other
than electronically requires permission from Sym Security@symantec.com.

Disclaimer
The information in the advisory is believed to be accurate at the time of
printing based on currently available information. Use of the information
constitutes acceptance for use in an AS IS condition. There are no
warranties with regard to this information. Neither the author nor the
publisher accepts any liability for any direct, indirect or consequential
loss or damage arising from use of, or reliance on this information.

Symantec, Symantec Security Response, Symantec product names and Sym
Security are Registered Trademarks of Symantec Corp. and/or affiliated
companies in the United States and other countries. All other registered
and unregistered trademarks represented in this document are the sole
property of their respective companies/owners.

Symantec Security Response
symsecurity@symantec.com
<http://securityresponse.symantec.com>

[[prev in list](?l=bugtraq&m=101432986921623&w=2)] [[next in list](?l=bugtraq&m=101430770412350&w=2)] [[prev in thread](?l=bugtraq&m=101424307617060&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


