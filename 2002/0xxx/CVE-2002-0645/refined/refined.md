- **Root cause of vulnerability:** SQL injection vulnerability exists in two stored procedures related to database replication in Microsoft SQL Server 2000. The stored procedures do not properly validate input before using it in SQL queries.
- **Weaknesses/vulnerabilities present:** SQL injection, improper input validation.
- **Impact of exploitation:** If the SQL Server Agent Proxy account is enabled, an attacker could execute arbitrary SQL or operating system commands on the server.
- **Attack vectors:** An attacker needs to be able to execute the vulnerable stored procedures. One stored procedure requires db_owner privileges. The other, due to a permissions error, can be executed by any user who can log onto the server interactively. Exploitation requires the SQL Server Agent Proxy account to be enabled.
- **Required attacker capabilities/position:** The attacker must be able to log into the SQL server. For one of the stored procedures, the attacker needs to have either database administrator privileges or membership in the db_owner role. For the other, any interactive user can execute it. Exploitation requires that the SQL Server Agent Proxy account has been enabled by a server administrator.