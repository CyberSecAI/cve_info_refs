- **Root cause of vulnerability:** A flaw in the implementation of SMB Signing in Windows 2000 and Windows XP allows an attacker to silently downgrade the SMB Signing settings by modifying the session negotiation data. This causes the systems to send unsigned data even if the signing policy requires it.
- **Weaknesses/vulnerabilities present:** Improper handling of SMB signing negotiation data. Specifically, a malformed negotiation could lead the system to drop the signing requirement.
- **Impact of exploitation:** An attacker can disable SMB signing, allowing them to monitor and modify SMB data without detection. The most serious case involves modifying group policy information being disseminated from a Windows 2000 domain controller, potentially leading to privilege escalation (e.g., adding users to the local Administrators group) or arbitrary code execution.
- **Attack vectors:** The attacker needs to be able to intercept and modify network traffic between a client and a server during the SMB session negotiation phase. This requires a position on the same network segment as one of the two SMB participants.
- **Required attacker capabilities/position:** Requires the attacker to have significant network access, typically being on the same network segment as one of the participants in the SMB session and be able to monitor and modify the SMB session negotiation data in real time.