=== Content from marc.info_2cdbe5c1_20250124_161700.html ===

```
[[prev in list](?l=bugtraq&m=103480656632418&w=2)] [[next in list](?l=bugtraq&m=103481357106573&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Apache 1.3.26
From:       [David Wagner <daw () cs ! berkeley ! edu>](?a=90366099500019&r=1&w=2)
Date:       [2002-10-16 22:32:26](?l=bugtraq&r=1&w=2&b=200210)
[Download RAW [message](?l=bugtraq&m=103480856102007&q=mbox) or [body](?l=bugtraq&m=103480856102007&q=raw)]

I recently did a very brief (and non-exhaustive) security audit of
Apache 1.3.26, and noticed some small potential bugs in some of the
helper programs that come with the distribution.

Apache maintainers have been notified, and the most serious of these
bugs have been fixed in 1.3.27.  I'm sending this primarily to document
for the record what vulnerabilities existed and were fixed.  This audit
can be found on Sardonix at <https://sardonix.org/audit/apache-45.html>

Also, I noticed a few suspicious code fragments, which weren't fixed
in 1.3.27.  For the most part, their security consequences looked
less dire, or minimal.  I'll describe these as well for completeness.
Can anyone else take a look at these and see if I overlooked anything?

1. Buffer overrun in support/ab.c:read_connection()
  char buffer[8192];
  char servername[1024];
  static void read_connection(struct connection * c) {
      ...
      r = ab_read(c->fd, buffer, sizeof(buffer));
      ...
                char *p, *q;
                p = strstr(c->cbuff, "Server:");
                q = servername;
                if (p) {
                    p += 8;
                    while (*p > 32)
                        *q++ = *p++;
                }
                *q = 0;
Impact: Anyone using ab to connect to a malicious server may be vulnerable
Fixed in 1.3.27: <http://www.apacheweek.com/features/security-13>

2. Race condition in support/htpasswd.c:main()
      tempfilename = tmpnam(tname_buf);
      ftemp = fopen(tempfilename, "w+");
      ...
      copy_file(ftemp, fpw);
Impact: any local user can read, modify contents of Apache password file,
if she exploits this bug when an administrator runs htpasswd
Not fixed in 1.3.27

3. Race condition in support/htdigest.c:main()
      tn = tmpnam(NULL);
      if (!(tfp = fopen(tn, "w"))) ...
      ...
      sprintf(command, "cp %s %s", tn, argv[[1]](#1));
      system(command);
Impact: any local user can read, modify contents of Apache password file,
if she exploits this bug when an administrator runs htdigest
Not fixed in 1.3.27

4. Also, totally bogus call to system() in support/htdigest.c:main()
  (see above)
Impact: probably none, but htdigest shouldn't be called from CGI scripts, etc.
Not fixed in 1.3.27

5. Buffer overruns in support/htdigest.c:main()
There are many, but here's one:
  #define MAX_STRING_LEN 256
  int main(int argc, char *argv[]) {
      char user[MAX_STRING_LEN];
      strcpy(user, argv[[3]](#3));
Impact: probably none, but htdigest shouldn't be called from CGI scripts, etc.
Not fixed in 1.3.27

6. strncat() used incorrectly in support/ab.c:main()
  char cookie[1024];
  int main(int argc, char **argv) {
    while ((c = getopt(argc, argv, "..."))) {
    switch (c) {
    case 'C':
      strncat(cookie, "Cookie: ", sizeof(cookie));
      strncat(cookie, optarg, sizeof(cookie));
      strncat(cookie, "\r\n", sizeof(cookie));
      break;
Also, -A, -P, and -H are broken as well.
Impact: probably none, but ab shouldn't be called from CGI scripts, etc.
Fixed in 1.3.27: <http://www.apacheweek.com/features/security-13>

Acknowledgements: This audit was aided by RATS.  Thanks to the RATS authors!
[[prev in list](?l=bugtraq&m=103480656632418&w=2)] [[next in list](?l=bugtraq&m=103481357106573&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


