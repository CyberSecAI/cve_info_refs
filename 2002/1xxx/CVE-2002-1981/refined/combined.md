=== Content from seclists.org_5c963fb4_20250125_024715.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](8)
[By Date](date.html#9)
[![Next](/images/right-icon-16x16.png)](10)

[![Previous](/images/left-icon-16x16.png)](8)
[By Thread](index.html#9)
[![Next](/images/right-icon-16x16.png)](10)

![](/shared/images/nst-icons.svg#search)

# Microsoft SQL Server Stored procedures [sp\_MSSetServerPropertiesn and sp\_MSsetalertinfo] (#NISR03092002A)

---

*From*: "NGSSoftware Insight Security Research" <nisr () nextgenss com>

*Date*: Mon, 2 Sep 2002 20:07:33 +0100

---

```
NGSSoftware Insight Security Research Advisory

Name: sp_MSSetServerPropertiesn and sp_MSsetalertinfo
Systems: Microsoft SQL Server 2000
Severity: Low Risk
Category: Configuration
Vendor URL: <http://www.microsoft.com/>
Author: David Litchfield (david () ngssoftware com)
Advisory URL:
<http://www.ngssoftware.com/advisories/mssql-sp_MSSetServerProperties.txt>
Date: 3rd September 2002
Advisory number: #NISR03092002A

Details
*******
sp_MSSetServerProperties is a stored procedure for internal use.
sp_MSSetServerProperties calls xp_instance_regwrite to change whether SQL
Server starts up automatically or manually and as the 'public' role can
execute this stored procedure, by default, it means that low privileged
users can modify this. This is a low risk issue. It does not allow an
attacker to compromise the server or data but may be used in conjunction
with another attack. For example an attacker may not want SQL Server to
restart on server reboot if they set a shell listening on TCP port 1433.

The sp_MSsetalertinfo stored procedure can be execute by the public role and
allows low privileged users to modify alert information such as the e-mail
address where alerts should be sent to.

Fix Information
***************
NGSSoftware alerted Microsoft to these problems on the 22nd of August. SQL
Server administrators are advised to disallow the 'public' role from
executing these stored procedure using the following Transact SQL.

use master
go
drop execute on [sp_MSSetServerProperties] to [public]
go
drop execute on [sp_MSsetalertinfo] to [public]
go

A check and fix for these problems have been added to NGSSQUirreL, an SQL
Server security management tool, of which more information is available from
the NGSSite: <http://www.nextgenss.com/>.

```

---

[![Previous](/images/left-icon-16x16.png)](8)
[By Date](date.html#9)
[![Next](/images/right-icon-16x16.png)](10)

[![Previous](/images/left-icon-16x16.png)](8)
[By Thread](index.html#9)
[![Next](/images/right-icon-16x16.png)](10)

### Current thread:

* **Microsoft SQL Server Stored procedures [sp\_MSSetServerPropertiesn and sp\_MSsetalertinfo] (#NISR03092002A)** *NGSSoftware Insight Security Research (Sep 02)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


