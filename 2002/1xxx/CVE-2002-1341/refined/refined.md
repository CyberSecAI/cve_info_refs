```
=:=:=::=:=:=::=:=:=::=:=:=::=:=:=::=:=:=::=:=:=::=
topic: SquirrelMail v1.2.9 XSS bugs
product: SquirrelMail v1.2.9
vendor: [www.squirrelmail.org](http://www.squirrelmail.org)
risk: low
date: 12/3/2k2
discovered by: euronymous /F0KP /HACKRU Team
advisory url: <http://f0kp.iplus.ru/bz/008.txt>
=:=:=::=:=:=::=:=:=::=:=:=::=:=:=::=:=:=::=:=:=::=

description
-----------
when reading some email you can to insert the scripting code..
read_body.php dont make filtering users input in `mailbox' and
`passed_id' variables. btw, today has released v1.2.10. im dont
know if this version contains this xss.

sample attack
-------------
<http://hostname/src/read_body.php?mailbox=>
%3Cscript%3Ealert(document.cookie)%3C%2Fscript%3E&passed_id=
%3Cscript%3Ealert(document.cookie)%3C%2Fscript%3E&
startMessage=1&show_more=0

[it must be in a single string]

not URL-encoded string working fine also.
```

- **Root cause of vulnerability**: The `read_body.php` script in SquirrelMail v1.2.9 does not properly filter user-supplied input in the `mailbox` and `passed_id` variables.
- **Weaknesses/vulnerabilities present**: Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation**: An attacker can inject arbitrary scripting code into the page, potentially leading to session hijacking, cookie theft, or other malicious activities.
- **Attack vectors**: By crafting a malicious URL with injected JavaScript code in the `mailbox` and `passed_id` parameters, an attacker can trigger the vulnerability when a user views an email.
- **Required attacker capabilities/position**: The attacker needs to be able to craft a URL that includes the malicious script, and the user needs to visit that URL through email or other means.