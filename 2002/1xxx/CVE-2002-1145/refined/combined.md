=== Content from www.nextgenss.com_d904680f_20250124_210737.html ===

[Click here to enter](http://www.nextgenss.com/advisories/mssql-webtasks.txt?fp=-3)



=== Content from www.cisco.com_e7002991_20250124_210705.html ===


* [Skip to main content](#fw-c-content)
* [Skip to search](#fw-c-header__button--search)
* [Skip to footer](#fw-c-footer)

[Cisco.com Worldwide](https://www.cisco.com "Cisco.com Worldwide")
### Products and Services

Close

### Solutions

Close

### Support

Close

### Learn

Close

### Partners

Close

[Trials and demos](/site/us/en/products/trials-demos.html?linkclickid=hdr-mainnav-trialsdemos)

[How to buy](https://www.cisco.com/c/en/us/buy.html?linkclickid=hdr-utilnav-howtobuy)

Partners

EN US

Profile

[Log in](/content/cdc/login.html?referer=)

[Trials and demos](/site/us/en/products/trials-demos.html?linkclickid=hdr-mainnav-trialsdemos)

Search

MENU
CLOSE

[How to buy](https://www.cisco.com/c/en/us/buy.html?linkclickid=hdr-utilnav-howtobuy)

Partners

Profile

[Log in](/content/cdc/login.html?referer=)

EN US

Close

Close

Close

Close

Close

![](/content/dam/cisco-cdc/site/images/heroes/homepage/hp-hero-cisco-3200x1066.jpg)

# Celebrating 40 years of innovation

Here's to 40 years of empowering humanity through technology. The best is yet to come.

[Celebrate with us](/site/us/en/about/purpose/fy24-report/index.html)

[![](/content/dam/cisco-cdc/site/core/quicktasks/icon_downloads.svg)

Downloads](https://software.cisco.com/download/home)

[![](/content/dam/cisco-cdc/site/core/quicktasks/icon_certifications.svg)

Certifications](/site/us/en/learn/training-certifications/certifications/index.html)

[![](/content/dam/cisco-cdc/site/core/quicktasks/icon_design-guides.svg)

Cisco Validated](https://www.cisco.com/c/en/us/solutions/cisco-validated.html)

[![](/content/dam/cisco-cdc/site/core/quicktasks/icon_training.svg)

Training](/site/us/en/learn/training-certifications/training/index.html)

[![](/content/dam/cisco-cdc/site/core/quicktasks/icon_community.svg)

Community](https://community.cisco.com/)

[![](/content/dam/cisco-cdc/site/core/quicktasks/icon_support.svg)

Support](https://www.cisco.com/c/en/us/support/index.html)

## Latest products and innovations across Cisco

![](/content/dam/cisco-cdc/site/images/photography/homepage/homepage-featured-story-wifi7-gray2-1200x675-v2.jpg)

### Cisco wireless

Discover intelligent, secure, assured Wi-Fi from Cisco for future-proofed workplaces.

[Explore Wi-Fi 7](/site/us/en/products/networking/wireless/index.html)

![](/content/dam/cisco-cdc/site/images/photography/homepage/hp-featured-ai-defense-990x507.jpg)

### Introducing Cisco AI Defense

Cisco AI Defense safeguards the development and usage of AI applications so that enterprises can advance their AI initiatives with confidence.

[Explore AI Defense](/site/us/en/products/security/ai-defense/index.html)

![](/content/dam/cisco-cdc/site/images/photography/homepage/hp-featured-hyperfabric-1200x675.jpg)

### Cisco Nexus Hyperfabric

Simply design, build, and manage network fabrics anywhere.

[Explore Cisco Nexus Hyperfabric](/site/us/en/products/networking/data-center-networking/nexus-hyperfabric/index.html#tabs-35d568e0ff-item-194f491212-tab)

## Our technology

[![Cisco Catalyst 9300 Series Switches](/content/dam/cisco-cdc/site/images/photography/homepage/hp-tile-networking-276x155.jpg)

Networking](/site/us/en/products/networking/index.html)

[![Splunk Observability UI on a monitor](/content/dam/cisco-cdc/site/images/photography/homepage/hp-tile-observability-276x155.jpg)

Observability](https://www.splunk.com/en_us/products/observability.html)

[![Stack of Cisco Secure Firewalls](/content/dam/cisco-cdc/site/images/photography/homepage/hp-tile-security-276x155.jpg)

Security](/site/us/en/products/security/index.html)

[![Cisco Desk Mini](/content/dam/cisco-cdc/site/images/photography/homepage/hp-tile-collaboration-276x155.jpg)

Collaboration](https://www.cisco.com/c/en/us/solutions/collaboration/index.html)

[![Cisco UCS C245 M8 Rack Server](/content/dam/cisco-cdc/site/images/photography/homepage/hp-tile-computing-276x155.jpg)

Computing](/site/us/en/products/computing/index.html)

[![Laptop screen with Cisco AI Assistant](/content/dam/cisco-cdc/site/images/photography/homepage/hp-tile-ai-276x155.jpg)

AI](/site/us/en/solutions/artificial-intelligence/index.html)

![](/content/dam/cisco-cdc/site/images/photography/homepage/hp-supporting-story1-hypershield-1176x662.jpg)

## Secure the AI-scale data center

Segment your workloads, protect against vulnerabilities, and address your fundamental cybersecurity challenges with Cisco Hypershield, a groundbreaking, new AI-native architecture.

[Explore Cisco Hypershield](/site/us/en/products/security/hypershield/index.html)

![](/content/dam/cisco-cdc/site/images/photography/homepage/homepage-supporting-story3-800G-1176x660.jpg)

## New Cisco Nexus 9000 Series switches

The rise of AI and machine learning is fueling data center expansion—fast. Compact, high-density 800GE connectivity is your building block for a highly scalable infrastructure.

[Discover 800G switches](/site/us/en/products/networking/cloud-networking-switches/400g-switches/index.html)

## Inside Cisco

* [More news](https://newsroom.cisco.com/c/r/newsroom/en/us/index.html)
* [More events](https://www.cisco.com/c/en/us/training-events/events.html)

---

Analyst report

### Forrester names Cisco a Leader in Enterprise Firewall Solutions

[Get Forrester Wave™](https://www.cisco.com/c/en/us/products/security/firewalls/forrester-wave-enterprise-firewall-solutions.html)

Partner

### Cisco unveils new Cisco 360 Partner Program

[Get more details](/site/us/en/partners/cisco-partner-program/cisco-360/index.html)

Report

### Cisco 2024 AI Readiness Index

[Get the report](https://www.cisco.com/c/m/en_us/solutions/ai/readiness-index.html)

Press release

### Cisco announces new Webex AI Agent and AI solutions

[Read press release](https://newsroom.cisco.com/c/r/newsroom/en/us/a/y2024/m10/cisco-announces-new-webex-ai-agent-and-ai-solutions-for-the-contact-center-to-transform-customer-experiences.html)

Webinar

### Unified Defense: The Power of Cisco and Splunk

[Register for webinar](https://webinars.cisco.com/emea/unified-defense-cisco-splunk?enableLocalTime=true)

Press release

### Cisco introduces intelligent, secure and assured Wi-Fi 7

[Read press release](https://newsroom.cisco.com/c/r/newsroom/en/us/a/y2024/m11/cisco-introduces-intelligent-secure-and-assured-wi-fi-7.html)

* [More news](https://newsroom.cisco.com/c/r/newsroom/en/us/index.html)
* [More events](https://www.cisco.com/c/en/us/training-events/events.html)

Hello, how can I help?

### Quick Links

* [About Cisco](https://www.cisco.com/c/en/us/about.html)
* [Contact Us](/site/us/en/about/contact-cisco/index.html?linkclickid=ftr-contactus)
* [Careers](https://www.cisco.com/c/en/us/about/careers.html)
* [Connect with a partner](/site/us/en/partners/connect-with-a-partner/index.html)

---

### Resources and Legal

* [Feedback](https://ciscocx.qualtrics.com/jfe/form/SV_bwrmeoKrBHYxOyW?Ref=/c/en/us/index.html)
* [Help](https://www.cisco.com/c/en/us/about/help.html)
* [Terms & Conditions](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
* [Privacy](https://www.cisco.com/c/en/us/about/legal/privacy-full.html)
* [Cookies / Do not sell or share my personal data](#cookies)
* [Accessibility](https://www.cisco.com/c/en/us/about/accessibility.html)
* [Trademarks](https://www.cisco.com/c/en/us/about/legal/trademarks.html)
* [Supply Chain Transparency](https://www.cisco.com/c/dam/en_us/about/supply-chain/cisco-modern-slavery-statement.pdf)
* [Newsroom](https://newsroom.cisco.com/c/r/newsroom/en/us/index.html)
* [Sitemap](https://www.cisco.com/c/en/us/about/sitemap.html)

---

© Cisco Systems, Inc.



=== Content from docs.microsoft.com_b76be866_20250124_210738.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-061.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS02-061 - Critical

## Elevation of Privilege in SQL Server Web Tasks (Q316333)

Published: October 16, 2002 | Updated: February 28, 2003

**Version:** 2.4

**Originally posted:** October 16, 2002

**Updated:** February 28, 2003

#### Summary

**Who should read this bulletin:**
System administrators using MicrosoftÂ® SQL Serverâ¢ 7.0, SQL Server 2000, Microsoft Data Engine (MSDE) 1.0, and Microsoft Desktop Engine (MSDE) 2000.

**Impact of vulnerability:**
Elevation of privilege

**Maximum Severity Rating:**
Critical

**Recommendation:**
System administrators should apply the patch to affected systems.

**Affected Software:**

* Microsoft SQL Server 7.0
* Microsoft Data Engine (MSDE) 1.0
* Microsoft SQL Server 2000
* Microsoft Desktop Engine (MSDE) 2000 (see the FAQ for a list of products that include MSDE 2000)

### General Information

## Technical details

**Technical description:**

Microsoft originally released this bulletin and patch on October 16, 2002 to correct a security vulnerability in a SQL Server stored procedure. The patch was and still is effective in eliminating the security vulnerability, and includes the fix for the vulnerability exploited by the "Slammer" worm virus (**Note:** Slammer affects only SQL Server 2000 and MSDE 2000). However, while the patch was fully effective in eliminating the security vulnerability, in October, 2002, it was found to interfere with SQL Server operations under some circumstances. As a result, on October 30, 2002, an additional non-security hotfix [(317748)](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) was required to ensure normal operations of SQL Server.

In order to simplify the process by which customers update their systems, Microsoft has now re-released the patch for SQL Server 2000. The patch for SQL Server 2000 was re-released to help customers patch their systems in response to the "Slammer" worm virus. The re-released patch integrates the original security patch released with this bulletin and the hotfix discussed in Microsoft Knowledge Base article [317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) that was released to ensure the correct operation of SQL Server. The re-release has been packaged with a new SQL Server patch installer. The installer eliminates the need for system administrators to copy SQL Server files onto their systems manually. The only changes that Microsoft has made to this patch were to incorporate the hotfix discussed in Microsoft Knowledge Base article [317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) into the re-released patch and to package the patch with an installer.

Customers who have not already applied the patch originally released with this bulletin should apply the re-released patch. Customers who have already applied to their SQL 2000 systems both the original security patch and hotfix [317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) do not need to apply this re-released patch - the original patches are effective in ensuring correct operation of SQL Server and in protecting SQL Server systems (including protection from the Slammer worm). Customers who have applied only the original version of this patch should consider applying the hotfix discussed in Microsoft Knowledge Base article [317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748), subject to the caveat discussed in the FAQ and caveats sections below.

The original version of this bulletin released a cumulative patch that included the functionality of all previously released patches for SQL Server 7.0, SQL Server 2000, Microsoft Data Engine (MSDE) 1.0, and Microsoft Desktop Engine (MSDE) 2000. The original patch also eliminated one newly discovered vulnerability in a SQL Server stored procedure.

SQL Server 7.0 and SQL Server 2000 provide stored procedures which are collections of Transact-SQL statements stored under a name and processed as a group. One stored procedure, an extended stored procedure and weak permissions on a table combine to allow a low privileged user the ability to run, delete, insert or update web tasks.

An attacker who is able to authenticate to a SQL server could delete, insert or update all the web tasks created by other users. In addition, the attacker could run already created web tasks in the context of the creator of the web task. This typically runs in the context of the SQL Server Agent service account.

**Mitigating factors:**

* It is necessary to be an authenticated user of the SQL Server.
* Exploiting this vulnerability could allow the attacker to escalate privileges to the level of the SQL Server service account. By default, the service runs with the privileges of a domain user, rather than with system privileges.
* Web tasks have to exist in the first place.

**Severity Rating:**

|  |  |
| --- | --- |
| **SQL Server 7.0 (Including MSDE 1.0)** | Critical |
| **SQL Server 2000 (Including MSDE 2000)** | Critical |

The above [assessment](https://go.microsoft.com/fwlink/?linkid=21140) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them. This issue received a critical rating because an authenticated user could connect to a SQL Server and insert, delete or update web tasks. When this bulletin was re-released in January 2003, the severity rating was changed to reflect the new Microsoft Security Bulletin Severity Rating System.

**Vulnerability identifier:** [CAN-2002-1145](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1145)

**Tested Versions:**

Microsoft tested SQL Server 7.0 and SQL Server 2000 (and their associated versions of MSDE) to assess whether they are affected by these vulnerabilities. Previous versions are no longer [supported](https://support.microsoft.com/directory/discontinue.asp), and may or may not be affected by these vulnerabilities.

## Frequently asked questions

**Microsoft has re-released the SQL 2000 patch since it was first released. What are the changes in the re-released patch?**

The SQL 2000 patch has been changed in two ways:

1. The patch has been incorporated into a self installing package - the original patch did not use an installer.
2. The re-released patch includes a fix for a problem unrelated to security that could under some circumstances interfere with normal operation of SQL Server This problem is discussed in Microsoft Knowledge Base article [Q317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748). The fix for this problem has been included in this re-released patch to remove the requirement for administrators to install the hotfix from Knowledge Base Article [Q317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) separately.

**I have already applied the original SQL 2000 patch. Do I need the re-released patch?**

No - the original patch is fully effective in correcting security vulnerabilities, including the vulnerability exploited by the "Slammer" worm virus. However, you may need to install the hotfix from Knowledge Base article [Q317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) that corrects a problem which may affect the normal operation of SQL Server. For information on this issue please review Microsoft Knowledge Base article [Q317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748).

**Are there any issues I should be aware when applying the hotfix described by Microsoft Knowledge Base article Q317748?**

Yes - if you install the hotfix discussed in Microsoft Knowledge Base article [Q317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) AFTER you have installed the original patch released with this security bulletin, a dialog box will ask whether you want to overwrite existing files. You must answer "No" to ensure that you do not overwrite files contained in the security patch.

**I thought that the SQL Server 2000 patch in Microsoft Security Bulletin** [**MS02-039**](https://technet.microsoft.com/security/bulletin/ms02-039) **corrected the vulnerability being exploited by the "slammer" virus. Why is Microsoft recommending that this patch be applied?**

This patch is the most recent SQL cumulative security patch available for SQL Server 2000 and it contains a number of other critical security fixes as well as the fix for the vulnerability exploited by the "slammer" virus.

**How do I tell if I have MSDE or SQL Server 2000 installed on my system?**

Go to "Start" then "Search" and search the local system for the file "sqlservr.exe". If this file is present on your system, then you have MSDE or SQL Server installed. Next right click on this file and select "properties" then "product version". If the product version is between 8.00.0194 and 8.00.0533, you are running SQL Server 2000 or MSDE 2000. In this case, you must install SQL Server SP2 before you install this patch.
If the product version is between 8.00.0534 and 8.00.0636, you are running SQL Server 2000 or MSDE 2000 and need to install the patch discussed by this bulletin. You can also address this issue by installing Service Pack 3a.

**Where can I obtain the latest Service Pack for either SQL Server 2000 or MSDE?**

You may download the latest and most comprehensive update here: [https:](https://)

**What do I need to do to make sure that my MSDE installation is updated?**

That depends on what product you are using with MSDE. If you are using MSDE with any of the products listed above except Application Center 2000, you need to ensure you have first installed MSDE 2000 [Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=75672496-af8e-40dc-853e-ad2c9fe96882&displaylang;=en) since this security patch requires Service Pack 2 to be installed. Once you have installed MSDE 2000 Service Pack 2 you need to install the SQL Server 2000 patch.
If you are running Microsoft Application Center 2000, you need to install a version of MSDE Service Pack 2 which is specifically intended to be used with Application Center. This service pack is available at:
[https://download.microsoft.com/download/AppCenter2000/MSDESP2/QFE813058.exe](https://download.microsoft.com/download/appcenter2000/msdesp2/qfe813058.exe).
Once you have installed the Application Center version of MSDE Service Pack 2, you should install the SQL Server 2000 security patch. More information on the Application Center specific version on MSDE 2000 Service Pack 2 is available in Microsoft Knowledge Base article [Q813115](https://support.microsoft.com/default.aspx?scid=kb;en-us;813115).

**I've already applied SQL Server 2000 Service Pack 3a or MSDE 2000 Service Pack 3a. Am I still at risk from the Slammer Worm Virus?**

No. All of the changes included in the re-released bulletin are included in SQL Server 2000 Service Pack 3a and MSDE 2000 Service Pack 3a.

**Why did you only re-release this patch for SQL Server 2000?**

The release of the "Slammer" worm virus made it especially critical for SQL Server 2000 customers to deploy this patch. The patch was repackaged with the new SQL Server installer in order to assist customers in this process.

**Where can I find out more about the "Slammer" worm?**

More information about the "Slammer" worm is available at: </https:>[https:](https://)

**What's the scope of the new vulnerability that this cumulative patch addresses?**

This is an [elevation of privilege](https://technet.microsoft.com/security/bulletin/glossary) vulnerability that occurs in a Microsoft-provided stored procedure, one extended stored procedure and weak permissions on a table. It is possible for an attacker to execute a SQL Server stored procedure that would run web tasks. Since anyone who could authenticate to the SQL Server could run this stored procedure, it is possible for an attacker to run previously stored web tasks in the context of the person who created them, thereby potentially elevating his or her privileges. Normally, only SQL Server administrators or database operators should be able to run stored procedures.
An attacker would first have to be able to authenticate to the SQL Server, and even then the attacker could not create new web tasks. Also, the database to which the attacker is authenticating must support the use of web tasks.

**What is a stored procedure?**

A stored procedure is a precompiled collection of Transact-SQL statements stored under a name and processed as a group. SQL Server supplies stored procedures for managing SQL Server and displaying information about databases and users. SQL Server-supplied stored procedures are called system stored procedures.
When a developer creates an application with SQL Server, the Transact-SQL programming language is the primary programming interface between the developer's applications and the SQL Server database. There are two methods available for storing and executing the programs when using the Transact-SQL programs. You can store the programs locally and create applications that send the commands to SQL Server and process the results, or a developer can store the programs as stored procedures in SQL Server and create applications that execute the stored procedures and process the results.
Stored procedures in SQL Server are similar to procedures in other programming languages in that they can:

* Accept input parameters and return multiple values in the form of output parameters to the calling procedure or batch.
* Contain programming statements that perform operations in the database, including calling other procedures.
* Return a status value to a calling procedure or batch to indicate success or failure (and the reason for failure).

**What are SQL Server extended stored procedures?**

Extended stored procedures provide the ability for database designers and administrators to create your their own customized external routines in a programming language such as C or C#. For all intents and purposes, extended stored procedures appear to users as normal stored procedures and are executed in the same way. Database queries can pass data to extended stored procedures which can return results and return status. For instance, among the standard extended stored procedures included with SQL Server are ones that provide e-mail functions. For example:

* xp\_startmail, which starts a SQL Mail client session, and
* xp\_sendmail, which sends an e-mail or page.

**What is a web task?**

Web tasks create a task that produces an HTML document containing data returned by executed queries. In other words, a web developer might create an asp page which needs data from a SQL Server. The asp page would send a web request to the SQL Server to create an http file containing queried data that the asp page can later pick up.

**What do web tasks and stored procedures have to do with one another?**

The ability to create web tasks is a system stored procedure.

**What causes the vulnerability?**

There is a flaw in the stored procedure to run web tasks where it is possible for a low privileged user to run that stored procedure. In addition, there are weak permissions on the web tasks table that together with the stored procedure could allow an attacker to run, delete or update a web task.

**What's wrong with the stored procedure to run web tasks?**

There is a flaw in the way SQL Server handles permissions.

**What could this vulnerability enable an attacker to do?**

An attacker could seek to exploit this vulnerability by logging in to a SQL Server and then run the stored procedure for web tasks. An attacker might first query for web tasks and then use the stored procedure to run them. It is also possible for the attacker to delete, update or insert new web tasks in order to escalate privileges.

**How could an attacker exploit this vulnerability?**

An attacker could seek to exploit this vulnerability by logging in to a SQL server and then run the stored procedure. Attacker may query for web tasks first then use the stored procedure to run them. Or delete or update the web tasks or insert new ones in order to potentially escalate privileges.

**What does the patch do?**

The patch eliminates the vulnerability by putting proper permissions on the stored procedure for running web tasks. The patch also locks down permissions on the table that stores information about web tasks.

**I'm not sure whether my SQL Server 2000 system has had the original patch or the new patch installed. How do I check to be sure that my system is protected?**

There are two things to check:

1. If you have installed a version of this patch that protects your SQL 2000 system from security vulnerabilities the product version number of the file ssnetlog.dll should be 8.00.679
2. If you have also applied the hotfix that corrects the issue described in Microsoft Knowledge Base article Q317748 - either by applying the re-released patch or by installing the original patch in combination with the hotfix from Knowledge Base article Q317748 - the product version numbers of ssmslpcn.dll and dbmslpcn.dll should be 8.00.568

## Patch availability

**Download locations for this patch**

Since this bulletin was originally published, Microsoft has made available an re-released patch for SQL 2000 that is packaged with an installer. Details are discussed above in the FAQ.

**The re-released SQL 2000 patch is available at the following location:**

* </https:>[https:](https://)

**The original patches are available at:**

* Microsoft SQL Server 7.0:

  </https:>[https:](https://)
* Microsoft SQL Server 2000:

  </https:>[https:](https://)

#### Additional information about this patch

**Installation platforms: Installation platforms:**

* The SQL Server 7.0 patch can be installed on systems running SQL Server 7.0 [Service Pack 4](https://technet.microsoft.com/sqlserver/70/bb331719.aspx).
* The SQL Server 2000 patch can be installed on systems running SQL Server 2000 [Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=502c0d89-1308-4662-8f58-cec55ef1235b&displaylang;=en)

**Inclusion in future service packs:**

The fix for this issue will be included in SQL Server 2000 Service Pack 3a.

**Reboot needed:** No. However, it might be necessary to restart the SQL Server service.

**Patch can be uninstalled:**

* Original Patch Released October 16, 2002: No
* Updated Patch Released January 26, 2003: This patch can be uninstalled by performing the steps in Knowledge Base Article [Q330391](https://support.microsoft.com/default.aspx?scid=kb;en-us;330391).

**Superseded patches:** This patch supersedes the one provided in Microsoft Security Bulletin [MS02-056](https://technet.microsoft.com/security/bulletin/ms02-056) which was itself a cumulative patch.

**Verifying patch installation:**

* SQL Server 7.0:

  To ensure you have the fix installed properly, verify the individual files by consulting the date/time stamp of the files listed in the file manifest in Microsoft Knowledge Base article at </https:>[https:](https://)
* SQL Server 2000:

  To ensure you have the fix installed properly, verify the individual files by consulting the date/time stamp of the files listed in the file manifest in Microsoft Knowledge Base article at </https:>[https:](https://)

**Caveats:**

* If you are running Microsoft Windows NT Server 4.0 Service Pack 6, you must apply the hotfix that is described in [Q258437](https://support.microsoft.com/default.aspx?scid=kb;en-us;q258437&) before applying this patch. Q258437 is now available for public download. See the Knowledge base article for more information.
* This patch does not include the functionality of the Killpwd tool provided in Microsoft Security Bulletin MS02-035.
* The patch does not supersede any previously released patches for MDAC or OLAP under SQL Server 2000. At this writing, these patches include the ones discussed in:

  + Microsoft Security Bulletin[MS00-092](https://technet.microsoft.com/security/bulletin/ms00-092)
  + Microsoft Security Bulletin[MS01-041](https://technet.microsoft.com/security/bulletin/ms01-041)
  + Microsoft Security Bulletin[MS02-030](https://technet.microsoft.com/security/bulletin/ms02-030)
* The process for installing the patch varies somewhat depending on the specific configuration of the server. System administrators should ensure that they read the Readme.txt file in the patch package to ensure the patch is installed correctly.
* The original patch for SQL Server 2000 and MSDE 2000 does not contain a hotfix from Knowledge Base Article [Q317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) that was subsequently discovered to be required to ensure normal operation of SQL Server 2000. The re-released security patch includes this additional patch. If you have applied the original security patch and then apply the hotfix from Knowledge Patch article [Q317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748) you must answer "no" if and when prompted to overwrite files to ensure that you do not overwrite files from the original security patch.

  The updated SQL 2000 and MSDE 2000 patch includes the hotfix from Knowledge Base Article [Q317748](https://support.microsoft.com/default.aspx?scid=kb;en-us;317748).

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site

#### Other information:

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) David Litchfield of [Next Generation Security Software Ltd.](https://www.nextgenss.com/) for reporting this issue to us and working with us to protect customers. We would also like to thank Martin Rakhmanoff (jimmers@yandex.ru) for contributing to the investigation.

**Support:**

* Microsoft Knowledge Base article Q316333 discusses this issue. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/?scid=fh;en-us;kbhowto) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 (October 16, 2002): Bulletin Created.
* V1.1 (January 21, 2003): Updated to clarify superseded patches information.
* V2.0 (January 26, 2003): Updated to provide information about revised patch that uses installer technology
* V2.1 (January 26, 2003): Updated file and version number information in the Frequently Asked Questions section.
* V2.2 (January 27, 2003): Added download locations for MSDE Service Packs, and link to MSDE applications page to the Frequently Asked Questions section.
* V2.3 (January 28, 2003): Added uninstall instructions for the re-released patch to the Additional Information section.
* V2.4 (February 28, 2003): Modified "Additional Information about this Patch" section to correct superseded patches.

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from marc.info_87e0a2a0_20250124_210703.html ===

```
[[prev in list](?l=ntbugtraq&m=103485994809399&w=2)] [[next in list](?l=ntbugtraq&m=103486284412590&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=103487044122900&w=2)]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    [Microsoft SQL Server Webtasks privilege upgrade (#NISR17102002)](?t=103486369800001&r=1&w=2)
From:       [David Litchfield <david () NGSSOFTWARE ! COM>](?a=102662993800002&r=1&w=2)
Date:       [2002-10-17 13:23:54](?l=ntbugtraq&r=1&w=2&b=200210)
[Download RAW [message](?l=ntbugtraq&m=103486356413404&q=mbox) or [body](?l=ntbugtraq&m=103486356413404&q=raw)]

NGSSoftware Insight Security Research Advisory

Name: Microsoft SQL Server Webtasks privilege elevation
Systems: Microsoft SQL Server 2000 and 7
Severity: High Risk
Vendor URL: <http://www.microsoft.com/>
Author: David Litchfield (david@ngssoftware.com)
Advisory URL: <http://www.ngssoftware.com/advisories/mssql-webtasks.txt>
Date: 17th October 2002
Advisory number: #NISR17102002

Description
***********
Using a number of flaws in the webtask functionality of Microsoft SQL Server
an attacker may gain control of the database by elevating their privileges.

Details
*******
The xp_runwebtask stored procedure fails to set permissions properly when
executed and runs with the privileges of the SQL Server. xp_runwebtask can
be executed by 'PUBLIC'.

The permissions of the table that stores webtasks, namely
msdb.dbo.mswebtasks, are set loosely allowing 'PUBLIC' to INSERT, UPDATE,
DELETE and SELECT.

By updating a webtask owned by the database owner and then running it
through xp_runwebtask an attacker may elevate their privileges. In terms of
exploitation an attacker may choose to run OS commands or add themselves to
the SYSADMIN group.

Fix Information
***************
NGSSoftware alerted Microsoft to these problems on the 23rd of August.
Microsoft has released a patch that addresses these issues. For more details
please see

<http://www.microsoft.com/technet/treeview/?url=/technet/security/bulletin/MS>
02-061.asp

A check and fix for these problems already exists in NGSSQuirreL, an
advanced SQL Server security management tool, of which more information
is available from the NGSSite: <http://www.nextgenss.com/>.
[[prev in list](?l=ntbugtraq&m=103485994809399&w=2)] [[next in list](?l=ntbugtraq&m=103486284412590&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=103487044122900&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


