```
{
  "Root cause of vulnerability": "Firewalls that perform stateful inspection of FTP traffic may not adequately maintain the state of FTP commands and responses. Some firewalls create dynamic rules based on PASV responses without assuring that the response string is part of a legitimate FTP connection.",
  "Weaknesses/vulnerabilities present": "The vulnerability lies in the firewall's inadequate state management of FTP connections. Specifically, it incorrectly parses the PASV response from an FTP server, creating dynamic rules that allow unauthorized TCP connections. The vulnerability is exacerbated by FTP servers that don't properly pad 3-digit numbers in multi-line responses, making it harder for firewalls to recognize legitimate status codes.",
  "Impact of exploitation": "A remote attacker can establish arbitrary TCP connections to FTP servers or clients located behind a vulnerable firewall, potentially exposing other network services to attacks.",
  "Attack vectors": "An attacker can exploit this vulnerability by logging into an FTP server behind a vulnerable firewall and issuing a command that echoes the argument of the command back to the attacker. By crafting the argument to include a PASV response, the attacker can manipulate the firewall into creating a dynamic rule allowing inbound connections to an arbitrary port on the FTP server. This can be done using partial TCP acknowledgement to retransmit the PASV response, or by other means such as using a URL with a padded FTP command or by using other FTP commands (STAT) to echo PORT commands or PASV responses.",
  "Required attacker capabilities/position": "The attacker needs to be able to log in to an FTP server that is located behind a vulnerable firewall and needs to have the ability to craft TCP packets. Additionally, the attacker needs a separate TCP/IP stack (like libnet and libpcap) to spoof IP addresses and send specially crafted TCP packets."
}
```