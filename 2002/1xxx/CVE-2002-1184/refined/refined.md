- **Root cause of vulnerability:** The vulnerability stems from the combination of default permissions on the system root folder (typically C:\) in Windows 2000, which grant "Everyone" Full access, and the way Windows searches for programs. Specifically, when a program is invoked without an absolute path, Windows searches the current folder and then the folders specified in the %PATH% environment variable. In certain scenarios, the system root can become the current folder, making it the first location Windows searches for an executable.
- **Weaknesses/vulnerabilities present:** The primary vulnerability lies in the overly permissive default access control list (ACL) on the system root directory, allowing any user to write files, coupled with the Windows program search mechanism. This allows an attacker to place a malicious executable in the system root.
- **Impact of exploitation:** An attacker could place a Trojan horse program in the system root that would execute with the privileges of a subsequent user who inadvertently runs it. The malicious program would have the ability to take any actions the user could take, including running other programs, altering data, or potentially reformatting the hard drive.
- **Attack vectors:** The attack vector requires the attacker to first gain interactive logon access to the vulnerable system. The attacker would then create a malicious program, name it the same as a commonly used system program, and place it in the system root folder. This exploit leverages the search path mechanisms that are used by windows to execute programs when a full path is not provided.
- **Required attacker capabilities/position:** The attacker needs the ability to log on to the system interactively, and knowledge of programs that are likely to be invoked by other users, or the ability to socially engineer the users into running a program. The attack could be carried out using a logon script or convincing the user to run a program via "Start | Run", Task Manager, etc.