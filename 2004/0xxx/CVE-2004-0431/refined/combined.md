=== Content from marc.info_63384a13_20250125_192057.html ===

```
[[prev in list](?l=ntbugtraq&m=108344460525179&w=2)] [[next in list](?l=ntbugtraq&m=108359620108234&w=2)] [[prev in thread](?l=bugtraq&m=108360110618389&w=2)] [next in thread]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    [EEYE: Apple QuickTime (QuickTime.qts) Heap Overflow](?t=108356486100001&r=1&w=2)
From:       [Marc Maiffret <mmaiffret () EEYE ! COM>](?a=107650984500003&r=1&w=2)
Date:       [2004-05-02 13:41:43](?l=ntbugtraq&r=1&w=2&b=200405)
Message-ID: [7BE3FADD73E3734AA95BCA7AE4802F30574669 () hermes ! eCompany ! gov](?i=7BE3FADD73E3734AA95BCA7AE4802F30574669%20()%20hermes%20!%20eCompany%20!%20gov)
[Download RAW [message](?l=ntbugtraq&m=108356485013237&q=mbox) or [body](?l=ntbugtraq&m=108356485013237&q=raw)]

Apple QuickTime (QuickTime.qts) Heap Overflow

Release Date:
May 02, 2004

Date Reported:
February 18, 2004

Severity:
High (Code Execution)

Vendor:
Apple

Systems Affected:
Apple QuickTime 6.5
Apple iTunes 4.2.0.72

Description:
The Apple QuickTime media player is used for playing, interacting with
or viewing video, audio, VR or graphics files.  Many popular web
browsers, media players, and other applications use their libraries to
play various QuickTime movie formats through their applications.

eEye Digital Security has discovered a critical vulnerability in
QuickTime Player. The vulnerability allows a remote attacker to reliably
overwrite heap memory with user-controlled data and execute arbitrary
code within the SYSTEM context.

This specific flaw exists within the QuickTime.qts file which many
applications access QuickTime's functionality through.  By specially
crafting atoms within a movie file, a direct heap overwrite is
triggered, and reliable code execution is then possible.

Technical Details:
The code in QuickTime.qts responsible for copying Sample-to-Chunk table
entries from the 'stsc' atom data in a QuickTime-format movie into an
array allocated on the heap.  According to developer.apple.com, the
format of the Sample-to-Chunk atom is as follows:

  Offset  Type    Description
  ------- ------- --------------------------------
  0000h   DWORD   atom size
  0004h   DWORD   atom type tag ('stsc')
  0008h   BYTE    version
  0009h   BYTE[[3]](#3) flags
  000Ch   DWORD   number of entries
  0010h   ...     sample-to-chunk table data

The heap block intended to hold the sample-to-chunk table data is
allocated with a size equal to (number_of_entries + 2) * 16.  By
supplying the "number of entries" field with the value 0x0FFFFFFE or
greater, an absolutely classic integer overflow results that causes an
insufficiently-sized heap block to be allocated, resulting in an equally
classic complete heap memory overwrite.

It is difficult to express just how textbook this vulnerability scenario
really is.  Successful exploitation of the vulnerability is
self-evident, and therefore no further discussion is warranted.  It is
our sincere hope that the vendor will make an earnest effort to increase
the maturity of its security response capabilities, so that researchers
will be encouraged to continue to work with them amicably on future
security issues. Apple is doing a disservice to its customers by
incorrectly labeling this vulnerability as a "crash bug" rather than
stating correctly that attackers can compromise systems running the
affected Apple software.

References:
QuickTime: QuickTime File Format
<http://developer.apple.com/documentation/QuickTime/QTFF/index.html>

Vendor Status:
Apple has released a patch for this vulnerability. The patch is
available via the Updates section of the affected applications.

This vulnerability has been assigned the CVE identifier CAN-2004-0431.

Credit:
Karl Lynn

Additional Research:
Derek Soeder

Greetings:
Riley Hassell, Fuzen, Cubby, the ladies in the band MudBath, Zoe bird,
Michelle L., and of course the entire staff at eEye.

Copyright (c) 1998-2004 eEye Digital Security Permission is hereby
granted for the redistribution of this alert electronically. It is not
to be edited in any way without express consent of eEye. If you wish to
reprint the whole or any part of this alert in any other medium
excluding electronic medium, please email alert@eEye.com for permission.

Disclaimer
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties with regard to this information. In no event shall the
author be liable for any damages whatsoever arising out of or in
connection with the use or spread of this information. Any use of this
information is at the user's own risk.

Feedback
Please send suggestions, updates, and comments to:

eEye Digital Security
<http://www.eEye.com>
info@eEye.com

-----
Earn up to 10 credit course hours toward the TruSecure ICSA Practitioner (TICSA) \
Credential and receive a TICSA exam coupon by attending the Infosecurity Canada 2004 \
conference.  Featured speaker, Marcus J. Ranum, TruSecure inventor of the proxy \
firewall will present on June 3 at 11:30 AM.  Visit <<https://ticsa.trusecure.com>>  \
for certification details and <<http://www.infosecuritycanada.com>>  for conference \
                information.  Become TICSA certified and see what happens!
-----

[[prev in list](?l=ntbugtraq&m=108344460525179&w=2)] [[next in list](?l=ntbugtraq&m=108359620108234&w=2)] [[prev in thread](?l=bugtraq&m=108360110618389&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_e20f2fbe_20250125_192054.html ===

```
[[prev in list](?l=bugtraq&m=108360001130312&w=2)] [[next in list](?l=bugtraq&m=108359942705829&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=108356485013237&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [EEYE: Apple QuickTime (QuickTime.qts) Heap Overflow](?t=108356486100001&r=1&w=2)
From:       ["Marc Maiffret" <mmaiffret () eeye ! com>](?a=106877971000009&r=1&w=2)
Date:       [2004-05-02 13:41:23](?l=bugtraq&r=1&w=2&b=200405)
Message-ID: [7BE3FADD73E3734AA95BCA7AE4802F30574668 () hermes ! eCompany ! gov](?i=7BE3FADD73E3734AA95BCA7AE4802F30574668%20()%20hermes%20!%20eCompany%20!%20gov)
[Download RAW [message](?l=bugtraq&m=108360110618389&q=mbox) or [body](?l=bugtraq&m=108360110618389&q=raw)]

Apple QuickTime (QuickTime.qts) Heap Overflow

Release Date:
May 02, 2004

Date Reported:
February 18, 2004

Severity:
High (Code Execution)

Vendor:
Apple

Systems Affected:
Apple QuickTime 6.5
Apple iTunes 4.2.0.72

Description:
The Apple QuickTime media player is used for playing, interacting with
or viewing video, audio, VR or graphics files.  Many popular web
browsers, media players, and other applications use their libraries to
play various QuickTime movie formats through their applications.

eEye Digital Security has discovered a critical vulnerability in
QuickTime Player. The vulnerability allows a remote attacker to reliably
overwrite heap memory with user-controlled data and execute arbitrary
code within the SYSTEM context.

This specific flaw exists within the QuickTime.qts file which many
applications access QuickTime's functionality through.  By specially
crafting atoms within a movie file, a direct heap overwrite is
triggered, and reliable code execution is then possible.

Technical Details:
The code in QuickTime.qts responsible for copying Sample-to-Chunk table
entries from the 'stsc' atom data in a QuickTime-format movie into an
array allocated on the heap.  According to developer.apple.com, the
format of the Sample-to-Chunk atom is as follows:

  Offset  Type    Description
  ------- ------- --------------------------------
  0000h   DWORD   atom size
  0004h   DWORD   atom type tag ('stsc')
  0008h   BYTE    version
  0009h   BYTE[[3]](#3) flags
  000Ch   DWORD   number of entries
  0010h   ...     sample-to-chunk table data

The heap block intended to hold the sample-to-chunk table data is
allocated with a size equal to (number_of_entries + 2) * 16.  By
supplying the "number of entries" field with the value 0x0FFFFFFE or
greater, an absolutely classic integer overflow results that causes an
insufficiently-sized heap block to be allocated, resulting in an equally
classic complete heap memory overwrite.

It is difficult to express just how textbook this vulnerability scenario
really is.  Successful exploitation of the vulnerability is
self-evident, and therefore no further discussion is warranted.  It is
our sincere hope that the vendor will make an earnest effort to increase
the maturity of its security response capabilities, so that researchers
will be encouraged to continue to work with them amicably on future
security issues. Apple is doing a disservice to its customers by
incorrectly labeling this vulnerability as a "crash bug" rather than
stating correctly that attackers can compromise systems running the
affected Apple software.

References:
QuickTime: QuickTime File Format
<http://developer.apple.com/documentation/QuickTime/QTFF/index.html>

Vendor Status:
Apple has released a patch for this vulnerability. The patch is
available via the Updates section of the affected applications.

This vulnerability has been assigned the CVE identifier CAN-2004-0431.

Credit:
Karl Lynn

Additional Research:
Derek Soeder

Greetings:
Riley Hassell, Fuzen, Cubby, the ladies in the band MudBath, Zoe bird,
Michelle L., and of course the entire staff at eEye.

Copyright (c) 1998-2004 eEye Digital Security Permission is hereby
granted for the redistribution of this alert electronically. It is not
to be edited in any way without express consent of eEye. If you wish to
reprint the whole or any part of this alert in any other medium
excluding electronic medium, please email alert@eEye.com for permission.

Disclaimer
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties with regard to this information. In no event shall the
author be liable for any damages whatsoever arising out of or in
connection with the use or spread of this information. Any use of this
information is at the user's own risk.

Feedback
Please send suggestions, updates, and comments to:

eEye Digital Security
<http://www.eEye.com>
info@eEye.com

[[prev in list](?l=bugtraq&m=108360001130312&w=2)] [[next in list](?l=bugtraq&m=108359942705829&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=108356485013237&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.kb.cert.org_74dabda7_20250125_192058.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#782958

## Apple QuickTime contains an integer overflow in the "QuickTime.qts" extension

#### Vulnerability Note VU#782958

Original Release Date: 2004-05-03 | Last Revised: 2004-05-04

---

### Overview

Apple QuickTime contains an integer overflow vulnerability in the "QuickTime.qts" extension, which could result in arbitrary code execution.

### Description

| Apple's [QuickTime Player](http://www.apple.com/quicktime/) is a player that allow users to view local and remote audio/video content. Other applications, such as web browsers, that wish to utilize QuickTime functionality must use the QuickTime extension (QuickTime.qts) component. This component contains an integer overflow vulnerability in the routine responsible for copying Sample-to-Chunk table entries into an array.  According to the [QuickTime File Format specification](http://developer.apple.com/documentation/QuickTime/QTFF/index.html), a Sample-to-Chunk atom contains a 4-byte "number of entries" field specifying the count of entries in the sample-to-chunk-table. If the "number of entries" field contains an overly large value, an integer overflow could occur, which could allow an attacker to overwrite portions of heap memory.For more information on QuickTime atoms, please refer to Apple's [QuickTime File Format specification](http://developer.apple.com/documentation/QuickTime/QTFF/index.html). |
| --- |

### Impact

| By convincing a user to execute a specially crafted QuickTime file, an attacker could cause QuickTime to crash or potentially execute arbitrary code. |
| --- |

### Solution

| **Upgrade**Upgrade to [QuickTime version 6.5.1](http://www.apple.com/quicktime/download/). |
| --- |

### Vendor Information

782958
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23782958/) to view vendors.**
### [Apple Computer Inc.](#DMOA-5YMNX6) Affected

Updated:  May 03, 2004

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

This vulnerability has been addressed in [QuickTime version 6.5.1](http://www.apple.com/quicktime/download/).

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.eeye.com/html/Research/Advisories/AD20040502.html>
* <http://secunia.com/advisories/11071/>
* <http://www.securitytracker.com/alerts/2004/Apr/1010010.html>
* <http://www.securiteam.com/windowsntfocus/5NP020KCVU.html>
* <http://developer.apple.com/documentation/QuickTime/QTFF/index.html>
### Acknowledgements

This vulnerability was reported by eEye Digital Security.

This document was written by Damon Morda.

### Other Information

| **CVE IDs:** | [CVE-2004-0431](http://web.nvd.nist.gov/vuln/detail/CVE-2004-0431) |
| --- | --- |
| **Severity Metric:** | 27.00 |
| **Date Public:** | 2004-02-18 |
| **Date First Published:** | 2004-05-03 |
| **Date Last Updated:** | 2004-05-04 18:29 UTC |
| **Document Revision:** | 22 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


