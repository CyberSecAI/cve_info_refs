=== Content from www.mozilla.org_07243e61_20250125_020831.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security
* Known Vulnerabilities

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Known Vulnerabilities in Mozilla Products

The links below list security vulnerabilities known to affect
particular versions of Mozilla products and instructions on what users
can do to protect themselves. The lists will be added to when new security
problems are found. For a complete list not sorted by product or version
please see the [Mozilla Foundation Security Advisories](/en-US/security/advisories/).

Please read
[Mozilla.org's security bug policy](/en-US/about/governance/policies/security-group/bugs/) for information on how we handle
security bugs. If you have found a security problem which is not on this
list and has not already been filed as a bug in
[Bugzilla](https://bugzilla.mozilla.org/query.cgi),
or if you find errors or inconsistencies in this list, please
mail us.
If needed our PGP key can be found on the main
[security](/en-US/security/#pgpkey) page.

## Product Advisories

* [Firefox](/en-US/security/known-vulnerabilities/firefox/)
* [Firefox ESR](/en-US/security/known-vulnerabilities/firefox-esr/)
* [Firefox for iOS](/en-US/security/known-vulnerabilities/firefox-for-ios/)
* [Firefox OS](/en-US/security/known-vulnerabilities/firefox-os/)
* [Mozilla VPN](/en-US/security/known-vulnerabilities/mozilla-vpn/)
* [Thunderbird](/en-US/security/known-vulnerabilities/thunderbird/)
* [Thunderbird ESR](/en-US/security/known-vulnerabilities/thunderbird-esr/)
* [SeaMonkey](/en-US/security/known-vulnerabilities/seamonkey/)

## Advisories for older products

### Firefox

* [Firefox 3.6](/en-US/security/known-vulnerabilities/firefox-3.6/)
* [Firefox 3.5](/en-US/security/known-vulnerabilities/firefox-3.5/)
* [Firefox 3.0](/en-US/security/known-vulnerabilities/firefox-3.0/)
* [Firefox 2.0](/en-US/security/known-vulnerabilities/firefox-2.0/)
* [Firefox 1.5](/en-US/security/known-vulnerabilities/firefox-1.5/)
* [Firefox 1.0](/en-US/security/known-vulnerabilities/firefox-1.0/)

### Thunderbird

* [Thunderbird 3.1](/en-US/security/known-vulnerabilities/thunderbird-3.1/)
* [Thunderbird 3.0](/en-US/security/known-vulnerabilities/thunderbird-3.0/)
* [Thunderbird 2.0](/en-US/security/known-vulnerabilities/thunderbird-2.0/)
* [Thunderbird 1.5](/en-US/security/known-vulnerabilities/thunderbird-1.5/)
* [Thunderbird 1.0](/en-US/security/known-vulnerabilities/thunderbird-1.0/)

### SeaMonkey

* [SeaMonkey 2.0](/en-US/security/known-vulnerabilities/seamonkey-2.0/)
* [SeaMonkey 1.1](/en-US/security/known-vulnerabilities/seamonkey-1.1/)
* [SeaMonkey 1.0](/en-US/security/known-vulnerabilities/seamonkey-1.0/)

### Older

* [Mozilla Suite 1.7](/en-US/security/known-vulnerabilities/mozilla-suite/)
* [Older vulnerabilities](/en-US/security/known-vulnerabilities/older-vulnerabilities/)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_b6da5311_20250125_020829.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla, Firefox, Thunderbird, Epiphany: New releases fix vulnerabilities — GLSA **200409-26**

New releases of Mozilla, Epiphany, Mozilla Thunderbird, and Mozilla Firefox
fix several vulnerabilities, including the remote execution of arbitrary
code.

### Affected packages

| Package | **www-client/mozilla** on all architectures |
| --- | --- |
| Affected versions | < **1.7.3** |
| Unaffected versions | >= **1.7.3** |

| Package | **www-client/mozilla-firefox** on all architectures |
| --- | --- |
| Affected versions | < **1.0\_pre** |
| Unaffected versions | >= **1.0\_pre** |

| Package | **mail-client/mozilla-thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **0.8** |
| Unaffected versions | >= **0.8** |

| Package | **www-client/mozilla-bin** on all architectures |
| --- | --- |
| Affected versions | < **1.7.3** |
| Unaffected versions | >= **1.7.3** |

| Package | **www-client/mozilla-firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **1.0\_pre** |
| Unaffected versions | >= **1.0\_pre** |

| Package | **mail-client/mozilla-thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **0.8** |
| Unaffected versions | >= **0.8** |

| Package | **www-client/epiphany** on all architectures |
| --- | --- |
| Affected versions | < **1.2.9-r1** |
| Unaffected versions | >= **1.2.9-r1** |

### Background

Mozilla is a popular web browser that includes a mail and newsreader.
Epiphany is a web browser that uses Gecko, the Mozilla rendering
engine. Mozilla Firefox and Mozilla Thunderbird are respectively the
next-generation browser and mail client from the Mozilla project.

### Description

Mozilla-based products are vulnerable to multiple security issues.
Firstly routines handling the display of BMP images and VCards contain
an integer overflow and a stack buffer overrun. Specific pages with
long links, when sent using the "Send Page" function, and links with
non-ASCII hostnames could both cause heap buffer overruns.

Several issues were found and fixed in JavaScript rights handling:
untrusted script code could read and write to the clipboard, signed
scripts could build confusing grant privileges dialog boxes, and when
dragged onto trusted frames or windows, JavaScript links could access
information and rights of the target frame or window. Finally,
Mozilla-based mail clients (Mozilla and Mozilla Thunderbird) are
vulnerable to a heap overflow caused by invalid POP3 mail server
responses.

### Impact

An attacker might be able to run arbitrary code with the rights of the
user running the software by enticing the user to perform one of the
following actions: view a specially-crafted BMP image or VCard, use the
"Send Page" function on a malicious page, follow links with malicious
hostnames, drag multiple JavaScript links in a row to another window,
or connect to an untrusted POP3 mail server. An attacker could also use
a malicious page with JavaScript to disclose clipboard contents or
abuse previously-given privileges to request XPI installation
privileges through a confusing dialog.

### Workaround

There is no known workaround covering all vulnerabilities.

### Resolution

All users should upgrade to the latest stable version:

```
 # emerge sync

 # emerge -pv your-version
 # emerge your-version
```
### References

* [Mozilla Security Advisory](https://www.mozilla.org/projects/security/known-vulnerabilities.html#mozilla1.7.3)
* [US-CERT Security Alert TA04-261A](https://www.us-cert.gov/cas/techalerts/TA04-261A.html)
* [CVE-2004-0902](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0902)
* [CVE-2004-0903](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0903)
* [CVE-2004-0904](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0904)
* [CVE-2004-0905](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0905)
* [CVE-2004-0906](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0906)
* [CVE-2004-0907](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0907)
* [CVE-2004-0908](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0908)
* [CVE-2004-0909](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0909)

**Release date**

September 20, 2004

**Latest revision**

December 30, 2007: 03

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [63996](https://bugs.gentoo.org/show_bug.cgi?id=63996)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_3ea56a2b_20250125_020721.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/245066)
* [XML](/show_bug.cgi?ctype=xml&id=245066)

Closed
[Bug 245066](/show_bug.cgi?id=245066)

Opened 21 years ago
Closed 20 years ago

# [internal] nsPop3Protocol.cpp, back out fix for [bug #157644](/show_bug.cgi?id=157644 "VERIFIED FIXED - Malicious pop3 server can write to arbitrary memory"), since david has fixed the problem another way ([bug #229374](/show_bug.cgi?id=229374 "RESOLVED FIXED - more to do for bug #157644..."))

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[internal] nsPop3Protocol.cpp, back out fix for bug #157644, since david has fixed the problem another way (bug #229374)

## Categories

### (MailNews Core :: Networking: POP, defect)

[Product:](/describecomponents.cgi?product=MailNews%20Core)

MailNews Core
▾

MailNews Core
Mail and news components common to Thunderbird and SeaMonkey
[See Open Bugs in This Product](/buglist.cgi?product=MailNews%20Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=MailNews%20Core)
Watch This Product

[Component:](/describecomponents.cgi?product=MailNews%20Core&component=Networking%3A%20POP#Networking%3A%20POP)

Networking: POP
▾

MailNews Core :: Networking: POP
Problems with receiving mail when your mail account is set up for POP. This component should be chosen if you've verified that the receiving problem is specific to POP protocol. Deleting messages to the trash folder would also fall into this component.
[See Open Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Networking%3A%20POP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Networking%3A%20POP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=MailNews%20Core&component=Networking%3A%20POP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Windows XP

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (Not tracked)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| relnote-thunderbird |  | --- |
| seamonkey2.53 | --- | --- |
| seamonkey2.57esr | --- | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |
| thunderbird136 | --- | --- |

## People

### (Reporter: sspitzer, Assigned: Bienvenu)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/3ef34b760c21ba06cfeca469dde938fb?d=mm&size=40)  [Bienvenu](/user_profile?user_id=4410)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/30bea03e99e03d3de54f7653bdb4e023?d=mm&size=40)  [sspitzer](/user_profile?user_id=1193)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[157644](/show_bug.cgi?id=157644 "VERIFIED FIXED - Malicious pop3 server can write to arbitrary memory"), [226669](/show_bug.cgi?id=226669 "RESOLVED FIXED - Thunderbird tries to download nonexisting messages with POP3"), [229374](/show_bug.cgi?id=229374 "RESOLVED FIXED - more to do for bug #157644...")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[sbb+](/show_bug.cgi?id=256197 "RESOLVED WORKSFORME - Security Bug Bounty: awarded")

Dependency [tree](/showdependencytree.cgi?id=245066&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=245066)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: fixed-aviary1.0, fixed1.7.3, Whiteboard: [sg:fix])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---),
[fixed1.7.3](/buglist.cgi?keywords=fixed1.7.3&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:fix]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [chofmann](/user_profile?user_id=2687) | [blocking1.7.5](#c0 "20 years ago") | + |
| --- | --- | --- |
| [chofmann](/user_profile?user_id=2687) | blocking1.7.5 | + |
| --- | --- | --- |
| [chofmann](/user_profile?user_id=2687) | [blocking-aviary1.0PR](#a6906829_2687 "20 years ago") | + |
| --- | --- | --- |
| [chofmann](/user_profile?user_id=2687) | blocking-aviary1.0PR | + |
| --- | --- | --- |
| [asa](/user_profile?user_id=5003) | [blocking1.8a3](#a6907604_5003 "20 years ago") | - |
| --- | --- | --- |
| [asa](/user_profile?user_id=5003) | blocking1.8a3 | - |
| --- | --- | --- |
|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [proposed fix](/attachment.cgi?id=156344)  [20 years ago](#c1)  [David :Bienvenu](/user_profile?user_id=4410)   1.84 KB, patch | sspitzer : [review+](#c2 "20 years ago")  mscott : [superreview+](#a6883284_93208 "20 years ago") | [Details](/attachment.cgi?id=156344&action=edit) | [Diff](/attachment.cgi?id=156344&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=245066&attachment=156344) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [(not reading, please use seth@sspitzer.org instead)](/user_profile?user_id=1193)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=245066#c0)• 21 years ago |
|  | |

[internal] nsPop3Protocol.cpp, back out fix for [bug #157644](/show_bug.cgi?id=157644 "VERIFIED FIXED - Malicious pop3 server can write to arbitrary memory"), since david has
fixed the problem another way ([bug #229374](/show_bug.cgi?id=229374 "RESOLVED FIXED - more to do for bug #157644..."))
nsPop3Protocol.cpp

|  | [David :Bienvenu](/user_profile?user_id=4410)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=245066#c1)• 20 years ago |
|  | |

Attached patch

[proposed fix](attachment.cgi?id=156344&action=diff)
— [Details](attachment.cgi?id=156344&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=245066&attachment=156344)

back out previous fix.

|  | [David :Bienvenu](/user_profile?user_id=4410)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a6880343_4410)• 20 years ago |

Assignee: sspitzer → bienvenuStatus: NEW → ASSIGNED

|  | [David :Bienvenu](/user_profile?user_id=4410)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a6880382_4410)• 20 years ago |

[Attachment #156344](/attachment.cgi?id=156344&action=edit "proposed fix") -
Flags: superreview?(mscott)
[Attachment #156344](/attachment.cgi?id=156344&action=edit "proposed fix") -
Flags: review?(sspitzer)

|  | [Scott MacGregor](/user_profile?user_id=93208) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a6883284_93208)• 20 years ago |

[Attachment #156344](/attachment.cgi?id=156344&action=edit "proposed fix") -
Flags: superreview?(mscott) → superreview+

|  | [(not reading, please use seth@sspitzer.org instead)](/user_profile?user_id=1193)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=245066#c2)• 20 years ago |
|  | |

Comment on [attachment 156344](/attachment.cgi?id=156344 "proposed fix") [[details]](/attachment.cgi?id=156344&action=edit "proposed fix") [[diff]](/attachment.cgi?id=156344&action=diff "proposed fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=245066&attachment=156344)
proposed fix
r/a=sspitzer
[Attachment #156344](/attachment.cgi?id=156344&action=edit "proposed fix") -
Flags: review?(sspitzer) → review+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=245066#c3)• 20 years ago |
|  | |

Temporarily marking security sensitive, nominating blocking, and pasting in the
full research into this problem we received.
--------------------------------------------------------------
Security Audit of Mozilla's POP3 client protocol (August 2004)
by Gael Delalleau <gael.delalleau+moz@m4x.org>
--------------------------------------------------------------
Overview
--------
This report presents the results of a security audit of a part
of the Mozilla 1.7.2 C++ source code tree.
This security audit was done during my free time as another attempt
to promote and participate to the Mozilla Security Bug Bounty
Program (<http://www.mozilla.org/security/bug-bounty.html>).
Several bugs (with the same origin) were found, leading to memory
corruption by writing outside the bounds of a buffer allocated on the
heap. They could potentially be exploited to run arbitrary code on the
system of the user, by a rogue POP3 server, or by any attacker being
able to hijack the TCP connexion to the POP3 server (this includes
computers on the local network).
Source code file audited
------------------------
mozilla/mailnews/local/src/nsPop3Protocol.cpp
Technical Details
-----------------
Bad days for nsPop3Protocol.cpp... The size of the msg\_info buffer is
not tracked correctly in this code, which causes various bugs.
\* Line 859 in nsPop3Protocol::FreeMsgInfo(), called from the class
destructor, the cleanup loop goes iterates from 0 to
m\_pop3ConData->number\_of\_messages. However the msg\_info buffer can
have a smaller length: a rogue POP3 server could make msg\_info have
an arbitrary lower length ranging from kLargeNumberOfMessages to
m\_pop3ConData->number\_of\_messages.
Proof:
- msg\_info is allocated here:
1793 m\_pop3ConData->msg\_info = (Pop3MsgInfo \*)
1794 PR\_CALLOC(sizeof(Pop3MsgInfo) \*
1795 (m\_pop3ConData->number\_of\_messages < kLargeNumberOfMessages ?
m\_pop3ConData->number\_of\_messages : kLargeNumberOfMessages));
- msg\_info can grow here:
1858 if (msg\_num >= kLargeNumberOfMessages && msg\_num <
m\_pop3ConData->number\_of\_messages)
1859 {
1860 m\_pop3ConData->msg\_info = (Pop3MsgInfo \*) //allocate space for
next entry
1861 PR\_REALLOC(m\_pop3ConData->msg\_info, sizeof(Pop3MsgInfo) \*
(msg\_num + 1));
Thus, in FreeMsgInfo, the loop will step out from the msg\_info
buffer... It means we do calls to free() on pointers stored on the
heap after the msg\_info buffer (line 859), then we set those pointers
to NULL (line 860).
851 nsPop3Protocol::FreeMsgInfo()
852 {
853 int i;
854 if (m\_pop3ConData->msg\_info)
855 {
856 for (i=0 ; i<m\_pop3ConData->number\_of\_messages ; i++)
857 {
858 if (m\_pop3ConData->msg\_info[i].uidl)
859 PR\_Free(m\_pop3ConData->msg\_info[i].uidl);
860 m\_pop3ConData->msg\_info[i].uidl = nsnull;
861 }
862 PR\_Free(m\_pop3ConData->msg\_info);
863 m\_pop3ConData->msg\_info = nsnull;
864 }
865 }
Consequences:
- DoS (crash of the client)
- arbitrary code execution might be possible, depending on the OS and
the heap layout (not investigated, but think "double free" etc.).
\* In nsPop3Protocol::GetXtndXlstMsgid() a rogue POP3 server can
provide a msg\_num higher than the maximum index of msg\_info, because
there is no check on the real size of msg\_info. Thus we can
overwrite "arbitrary" addresses in memory with a pointer to uidl
(line 2192).
2179 msg\_num = atol(token);
2180 if(msg\_num <= m\_pop3ConData->number\_of\_messages && msg\_num > 0)
2181 {
2183 char \*uidl = nsCRT::strtok(newStr, " ", &newStr);/\* not really a uidl
but a unique token -km \*/
2185 if (!uidl)
2190 uidl = "";
2192 m\_pop3ConData->msg\_info[msg\_num-1].uidl = PL\_strdup(uidl);
Consequences:
By overwriting (function) pointers on the heap or in other writable
memory areas within reach, it is likely we can achieve arbitrary code
execution.
\* There is the same problem in nsPop3Protocol::GetUidlList (see
description of the bug in nsPop3Protocol::GetXtndXlstMsgid).
\* in nsPop3Protocol::GetList at line 1856, we can overwrite any
address within reach with 4 arbitrary bytes. This is because the
growth of the msg\_info buffer happens too late, at line 1860.
(Moreover, the msg\_info buffer can grow and then shrink at a later
time, thus loosing data which was previously stored.)
1850 msg\_num = atol(token);
1851
1852 if(msg\_num <= m\_pop3ConData->number\_of\_messages && msg\_num > 0)
1853 {
1854 token = nsCRT::strtok(newStr, " ", &newStr);
1855 if (token)
1856 m\_pop3ConData->msg\_info[msg\_num-1].size = atol(token);
1857
1858 if (msg\_num >= kLargeNumberOfMessages && msg\_num <
m\_pop3ConData->number\_of\_messages)
1859 {
1860 m\_pop3ConData->msg\_info = (Pop3MsgInfo \*) //allocate space for
next entry
1861 PR\_REALLOC(m\_pop3ConData->msg\_info, sizeof(Pop3MsgInfo) \*
(msg\_num + 1));
Consequences:
By overwriting data, control structures or function pointers on the
heap or in other writable memory areas within reach, it is likely we
can achieve arbitrary code execution.
Example of a bogus POP3 session
-------------------------------
+OK
AUTH
-ERR
CAPA
-ERR
USER \*\*\*\*\*\*
+OK
PASS \*\*\*\*\*\*
+OK
STAT
+OK 262670336 77777
LIST
+OK
1 77
2 77
262670336 77777
<< Mozilla crashes here >>
Conclusion
----------
I reckon these bugs were introduced by an improper fix of the first
POP3 security issue reported in 2002 by zen-parse. Another fix was
applied earlier this year but even though the initial issue has been
patched, it seems the "new" issues were missed.
- Cheers -
Gael DelalleauGroup: securityFlags: blocking1.8a3?Flags: blocking1.7.3?Flags: blocking-aviary1.0PR?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=245066#c4)• 20 years ago |
|  | |

This patch fixes the first DOS (at the cost of going back to potentially
allocating an obscene amount of memory, a DOS in its own right).
The serious issue of using the server-supplied msg\_num as an index (multiple
places) was fixed on the trunk in [bug 226669](/show_bug.cgi?id=226669 "RESOLVED FIXED - Thunderbird tries to download nonexisting messages with POP3"). That fix needs to land on the 1.7
branch. According to the bug it has been landed on the Aviary branch.

|  | [chris hofmann](/user_profile?user_id=2687) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a6906829_2687)• 20 years ago |

Flags: blocking1.8a3?Flags: blocking1.8a3+Flags: blocking1.7.3?Flags: blocking1.7.3+Flags: blocking-aviary1.0PR?Flags: blocking-aviary1.0PR+

|  | [David :Bienvenu](/user_profile?user_id=4410)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=245066#c5)• 20 years ago |
|  | |

fixed all three placesStatus: ASSIGNED → RESOLVEDClosed: 20 years agoKeywords: [fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---),
[fixed1.7](/buglist.cgi?keywords=fixed1.7&resolution=---)Resolution: --- → FIXED

|  | [Asa Dotzler [:asa]](/user_profile?user_id=5003) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a6907604_5003)• 20 years ago |

Flags: blocking1.8a3+ → blocking1.8a3-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a7071999_1689)• 20 years ago |

Blocks: [sbb?](/show_bug.cgi?id=256195 "RESOLVED WORKSFORME - Security Bug Bounty: nominated")

|  | [David :Bienvenu](/user_profile?user_id=4410)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=245066#c6)• 20 years ago |
|  | |

adding Christian...

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a7669984_1689)• 20 years ago |

Depends on: [226669](/show_bug.cgi?id=226669 "RESOLVED FIXED - Thunderbird tries to download nonexisting messages with POP3")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=245066#c7)• 20 years ago |
|  | |

fix landed on 1.7.2 branchKeywords: [fixed1.7](/buglist.cgi?keywords=fixed1.7&resolution=---) → [fixed1.7.3](/buglist.cgi?keywords=fixed1.7.3&resolution=---)Whiteboard: [sg:fix] fixed1.7.2+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a9284408_1689)• 20 years ago |

Group: securityWhiteboard: [sg:fix] fixed1.7.2+ → [sg:fix] fixed1.7.3

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a9327235_1689)• 20 years ago |

Blocks: [sbb+](/show_bug.cgi?id=256197 "RESOLVED WORKSFORME - Security Bug Bounty: awarded")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a9327348_1689)• 20 years ago |

No longer blocks: [sbb?](/show_bug.cgi?id=256195 "RESOLVED WORKSFORME - Security Bug Bounty: nominated")

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a15296424_27300)• 20 years ago |

Product: MailNews → Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a17966206_1689)• 20 years ago |

Keywords: [fixed1.7.5](/buglist.cgi?keywords=fixed1.7.5&resolution=---) → [fixed1.7.3](/buglist.cgi?keywords=fixed1.7.3&resolution=---)Whiteboard: [sg:fix] fixed1.7.3 → [sg:fix]

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=245066#a146771470_1)• 16 years ago |

Product: Core → MailNews Core
You need to [log in](/show_bug.cgi?id=245066&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [David :Bienvenu](/user_profile?user_id=4410)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_7ae0458b_20250126_051405.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security
* Known Vulnerabilities

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Known Vulnerabilities in Mozilla Products

The links below list security vulnerabilities known to affect
particular versions of Mozilla products and instructions on what users
can do to protect themselves. The lists will be added to when new security
problems are found. For a complete list not sorted by product or version
please see the [Mozilla Foundation Security Advisories](/en-US/security/advisories/).

Please read
[Mozilla.org's security bug policy](/en-US/about/governance/policies/security-group/bugs/) for information on how we handle
security bugs. If you have found a security problem which is not on this
list and has not already been filed as a bug in
[Bugzilla](https://bugzilla.mozilla.org/query.cgi),
or if you find errors or inconsistencies in this list, please
mail us.
If needed our PGP key can be found on the main
[security](/en-US/security/#pgpkey) page.

## Product Advisories

* [Firefox](/en-US/security/known-vulnerabilities/firefox/)
* [Firefox ESR](/en-US/security/known-vulnerabilities/firefox-esr/)
* [Firefox for iOS](/en-US/security/known-vulnerabilities/firefox-for-ios/)
* [Firefox OS](/en-US/security/known-vulnerabilities/firefox-os/)
* [Mozilla VPN](/en-US/security/known-vulnerabilities/mozilla-vpn/)
* [Thunderbird](/en-US/security/known-vulnerabilities/thunderbird/)
* [Thunderbird ESR](/en-US/security/known-vulnerabilities/thunderbird-esr/)
* [SeaMonkey](/en-US/security/known-vulnerabilities/seamonkey/)

## Advisories for older products

### Firefox

* [Firefox 3.6](/en-US/security/known-vulnerabilities/firefox-3.6/)
* [Firefox 3.5](/en-US/security/known-vulnerabilities/firefox-3.5/)
* [Firefox 3.0](/en-US/security/known-vulnerabilities/firefox-3.0/)
* [Firefox 2.0](/en-US/security/known-vulnerabilities/firefox-2.0/)
* [Firefox 1.5](/en-US/security/known-vulnerabilities/firefox-1.5/)
* [Firefox 1.0](/en-US/security/known-vulnerabilities/firefox-1.0/)

### Thunderbird

* [Thunderbird 3.1](/en-US/security/known-vulnerabilities/thunderbird-3.1/)
* [Thunderbird 3.0](/en-US/security/known-vulnerabilities/thunderbird-3.0/)
* [Thunderbird 2.0](/en-US/security/known-vulnerabilities/thunderbird-2.0/)
* [Thunderbird 1.5](/en-US/security/known-vulnerabilities/thunderbird-1.5/)
* [Thunderbird 1.0](/en-US/security/known-vulnerabilities/thunderbird-1.0/)

### SeaMonkey

* [SeaMonkey 2.0](/en-US/security/known-vulnerabilities/seamonkey-2.0/)
* [SeaMonkey 1.1](/en-US/security/known-vulnerabilities/seamonkey-1.1/)
* [SeaMonkey 1.0](/en-US/security/known-vulnerabilities/seamonkey-1.0/)

### Older

* [Mozilla Suite 1.7](/en-US/security/known-vulnerabilities/mozilla-suite/)
* [Older vulnerabilities](/en-US/security/known-vulnerabilities/older-vulnerabilities/)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from marc.info_4288f16a_20250125_020827.html ===

```
[[prev in list](?l=bugtraq&m=109889281711636&w=2)] [[next in list](?l=bugtraq&m=109892527321706&w=2)] [[prev in thread](?l=fedora-legacy-announce&m=109889271930515&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [[FLSA-2004:2089] Updated mozilla packages fix security vulnerabilities](?t=109889278700001&r=1&w=2)
From:       [Dominic Hargreaves <dom () earth ! li>](?a=102492850100003&r=1&w=2)
Date:       [2004-10-27 9:17:53](?l=bugtraq&r=1&w=2&b=200410)
Message-ID: [20041027091751.GA28216 () home ! thedom ! org](?i=20041027091751.GA28216%20()%20home%20!%20thedom%20!%20org)
[Download RAW [message](?l=bugtraq&m=109900315219363&q=mbox) or [body](?l=bugtraq&m=109900315219363&q=raw)]

-----------------------------------------------------------------------
               Fedora Legacy Update Advisory

Synopsis:          Updated mozilla resolves security vulnerabilities
Advisory ID:       FLSA:2089
Issue date:        2004-10-27
Product:           Red Hat Linux
Product:           Fedora Core
Keywords:          Security
Cross references:  <https://bugzilla.fedora.us/show_bug.cgi?id=2089>
CVE Names:         CAN-2003-0564, CAN-2004-0191, CAN-2003-0594,
                   CAN-2004-0722, CAN-2004-0597, CAN-2004-0599,
                   CAN-2004-0757, CAN-2004-0758, CAN-2004-0759,
                   CAN-2004-0760, CAN-2004-0718, CAN-2004-0761,
                   CAN-2004-0762, CAN-2004-0763, CAN-2004-0764,
                   CAN-2004-0765, CAN-2004-0905, CAN-2004-0904,
                   CAN-2004-0903, CAN-2004-0908, CAN-2004-0902
-----------------------------------------------------------------------

-----------------------------------------------------------------------
1. Topic:

Updated mozilla, galeon and epiphany packages that fix multiple
vulnerabilities are now available.

Mozilla is an open-source Web browser, designed for standards
compliance, performance, and portability.

2. Relevant releases/architectures:

Red Hat Linux 7.3 - i386
Red Hat Linux 9 - i386
Fedora Core 1 - i386

3. Problem description:

Note that some of these issues have already been fixed in Redhat 9 and
Fedora Core 1. Please refer to previous advisories for details.

NISCC testing of implementations of the S/MIME protocol uncovered a number
of bugs in NSS versions prior to 3.9. The parsing of unexpected ASN.1
constructs within S/MIME data could cause Mozilla to crash or consume large
amounts of memory. A remote attacker could potentially trigger these bugs
by sending a carefully-crafted S/MIME message to a victim. The Common
Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
CAN-2003-0564 to this issue.

Andreas Sandblad discovered a cross-site scripting issue that affects
various versions of Mozilla. When linking to a new page it is still
possible to interact with the old page before the new page has been
successfully loaded. Any Javascript events will be invoked in the context
of the new page, making cross-site scripting possible if the different
pages belong to different domains. The Common Vulnerabilities and
Exposures project (cve.mitre.org) has assigned the name CAN-2004-0191 to
this issue.

Flaws have been found in the cookie path handling between a number of Web
browsers and servers. The HTTP cookie standard allows a Web server
supplying a cookie to a client to specify a subset of URLs on the origin
server to which the cookie applies. Web servers such as Apache do not
filter returned cookies and assume that the client will only send back
cookies for requests that fall within the server-supplied subset of URLs.
However, by supplying URLs that use path traversal (/../) and character
encoding, it is possible to fool many browsers into sending a cookie to a
path outside of the originally-specified subset. The Common
Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
CAN-2003-0594 to this issue.

Zen Parse reported improper input validation to the SOAPParameter object
constructor leading to an integer overflow and controllable heap
corruption. Malicious JavaScript could be written to utilize this flaw and
could allow arbitrary code execution. The Common Vulnerabilities and
Exposures project (cve.mitre.org) has assigned the name CAN-2004-0722 to
this issue.

During a source code audit, Chris Evans discovered a buffer overflow and
integer overflows which affect the libpng code inside Mozilla. An attacker
could create a carefully crafted PNG file in such a way that it would cause
Mozilla to crash or execute arbitrary code when the image was viewed.
(CAN-2004-0597, CAN-2004-0599)

Zen Parse reported a flaw in the POP3 capability. A malicious POP3 server
could send a carefully crafted response that would cause a heap overflow
and potentially allow execution of arbitrary code as the user running
Mozilla. (CAN-2004-0757)

Marcel Boesch found a flaw that allows a CA certificate to be imported with
a DN the same as that of the built-in CA root certificates, which can cause
a denial of service to SSL pages, as the malicious certificate is treated
as invalid. (CAN-2004-0758)

Met - Martin Hassman reported a flaw in Mozilla that could allow malicious
Javascript code to upload local files from a users machine without
requiring confirmation. (CAN-2004-0759)

Mindlock Security reported a flaw in ftp URI handling. By using a NULL
character (%00) in a ftp URI, Mozilla can be confused into opening a
resource as a different MIME type. (CAN-2004-0760)

Mozilla does not properly prevent a frame in one domain from injecting
content into a frame that belongs to another domain, which facilitates
website spoofing and other attacks, also known as the frame injection
vulnerability. (CAN-2004-0718)

Tolga Tarhan reported a flaw that can allow a malicious webpage to use a
redirect sequence to spoof the security lock icon that makes a webpage
appear to be encrypted. (CAN-2004-0761)

Jesse Ruderman reported a security issue that affects a number of browsers
including Mozilla that could allow malicious websites to install arbitrary
extensions by using interactive events to manipulate the XPInstall Security
dialog box. (CAN-2004-0762)

Emmanouel Kellinis discovered a caching flaw in Mozilla which allows
malicious websites to spoof certificates of trusted websites via
redirects and Javascript that uses the "onunload" method. (CAN-2004-0763)

Mozilla allowed malicious websites to hijack the user interface via the
"chrome" flag and XML User Interface Language (XUL) files. (CAN-2004-0764)

The cert_TestHostName function in Mozilla only checks the hostname portion
of a certificate when the hostname portion of the URI is not a fully
qualified domain name (FQDN). This flaw could be used for spoofing if an
attacker had control of machines on a default DNS search path. (CAN-2004-0765)

Jesse Ruderman discovered a cross-domain scripting bug in Mozilla. If
a user is tricked into dragging a javascript link into another frame or
page, it becomes possible for an attacker to steal or modify sensitive
information from that site. Additionally, if a user is tricked into
dragging two links in sequence to another window (not frame), it is
possible for the attacker to execute arbitrary commands. The Common
Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
CAN-2004-0905 to this issue.

Gael Delalleau discovered an integer overflow which affects the BMP
handling code inside Mozilla. An attacker could create a carefully crafted
BMP file in such a way that it would cause Mozilla to crash or execute
arbitrary code when the image is viewed. The Common Vulnerabilities and
Exposures project (cve.mitre.org) has assigned the name CAN-2004-0904 to
this issue.

Georgi Guninski discovered a stack-based buffer overflow in the vCard
display routines. An attacker could create a carefully crafted vCard file
in such a way that it would cause Mozilla to crash or execute arbitrary
code when viewed. The Common Vulnerabilities and Exposures project
(cve.mitre.org) has assigned the name CAN-2004-0903 to this issue.

Wladimir Palant discovered a flaw in the way javascript interacts with
the clipboard. It is possible that an attacker could use malicious
javascript code to steal sensitive data which has been copied into the
clipboard. The Common Vulnerabilities and Exposures project
(cve.mitre.org) has assigned the name CAN-2004-0908 to this issue.

Georgi Guninski discovered a heap based buffer overflow in the "Send
Page" feature. It is possible that an attacker could construct a link in
such a way that a user attempting to forward it could result in a crash or
arbitrary code execution. The Common Vulnerabilities and Exposures project
(cve.mitre.org) has assigned the name CAN-2004-0902 to this issue.

4. Solution:

Before applying this update, make sure all previously released errata
relevant to your system have been applied.

To update all RPMs for your particular architecture, run:

rpm -Fvh [filenames]

where [filenames] is a list of the RPMs you wish to upgrade.  Only those
RPMs which are currently installed will be updated.  Those RPMs which are
not installed but included in the list will not be updated.  Note that you
can also use wildcards (*.rpm) if your current directory *only* contains
the desired RPMs.

Please note that this update is also available via yum and apt.  Many
people find this an easier way to apply updates.  To use yum issue:

yum update

or to use apt:

apt-get update; apt-get upgrade

This will start an interactive process that will result in the appropriate
RPMs being upgraded on your system.  This assumes that you have yum or
apt-get configured for obtaining Fedora Legacy content. Please visit
<http://www.fedoralegacy.org/docs/> for directions on how to configure yum
and apt-get.

5. Bug IDs fixed:

<http://bugzilla.fedora.us> - 1532 - Mozilla 1.4.2 fixes various vulns
<http://bugzilla.fedora.us> - 1834 - Mozilla < 1.4.3 multiple flaws
<http://bugzilla.fedora.us> - 2089 - Mozilla < 1.7.3 multiple flaws

6. RPMs required:

Red Hat Linux 7.3:

SRPM:
<http://download.fedoralegacy.org/redhat/7.3/updates/SRPMS/mozilla-1.4.3-0.7.1.legacy.src.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/SRPMS/galeon-1.2.13-0.7.1.legacy.src.rpm>

i386:
<http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-chat-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-devel-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-dom-inspector-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-js-debugger-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-mail-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-nspr-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-nspr-devel-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-nss-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-nss-devel-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/galeon-1.2.13-0.7.1.legacy.i386.rpm>

Red Hat Linux 9:

SRPM:
<http://download.fedoralegacy.org/redhat/9/updates/SRPMS/mozilla-1.4.3-0.9.1.legacy.src.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/SRPMS/galeon-1.2.13-0.9.2.legacy.src.rpm>

i386:
<http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-chat-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-devel-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-dom-inspector-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-js-debugger-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-mail-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-nspr-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-nspr-devel-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-nss-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-nss-devel-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/galeon-1.2.13-0.9.2.legacy.i386.rpm>

Fedora Core 1:

SRPM:

<http://download.fedoralegacy.org/fedora/1/updates/SRPMS/mozilla-1.4.3-1.fc1.1.legacy.src.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/SRPMS/epiphany-1.0.4-2.4.legacy.src.rpm>

i386:
<http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-chat-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-devel-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-dom-inspector-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-js-debugger-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-mail-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-nspr-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-nspr-devel-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-nss-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-nss-devel-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/epiphany-1.0.4-2.4.legacy.i386.rpm>

7. Verification:

SHA1 sum                                 Package Name
---------------------------------------------------------------------------

8b26049e02b8ba752151edbbda3a7ac13550f419  \
redhat/7.3/updates/SRPMS/mozilla-1.4.3-0.7.1.legacy.src.rpm \
d21e84f5b3d17317424b521fe5bb6a1771187532  \
redhat/7.3/updates/SRPMS/galeon-1.2.13-0.7.1.legacy.src.rpm \
367a2c8360f0e8f984a63da7e3e6ccadc692341c  \
redhat/7.3/updates/i386/mozilla-1.4.3-0.7.1.legacy.i386.rpm \
3675dc6ec08f513dca4a56b5c26b2632d1d9081e  \
redhat/7.3/updates/i386/mozilla-chat-1.4.3-0.7.1.legacy.i386.rpm \
7765e5bf8d219a2337396b65e6983c79a44c9d7b  \
redhat/7.3/updates/i386/mozilla-devel-1.4.3-0.7.1.legacy.i386.rpm \
5e363fe99cbad7745de8e93b2420e7281a08c038  \
redhat/7.3/updates/i386/mozilla-dom-inspector-1.4.3-0.7.1.legacy.i386.rpm \
cffefef5b6b67d5e40a4f988503982af9a4cb49b  \
redhat/7.3/updates/i386/mozilla-js-debugger-1.4.3-0.7.1.legacy.i386.rpm \
e6d7563bf90f5f6bd4246e2b07097d37ac18e256  \
redhat/7.3/updates/i386/mozilla-mail-1.4.3-0.7.1.legacy.i386.rpm \
e04ab6de0904386e881541234a8604e6283fbd00  \
redhat/7.3/updates/i386/mozilla-nspr-1.4.3-0.7.1.legacy.i386.rpm \
a333e23e084b9d59488db7451b991b3775d3c774  \
redhat/7.3/updates/i386/mozilla-nspr-devel-1.4.3-0.7.1.legacy.i386.rpm \
0611c836e192bed899e30c261e17736c4a5a1b78  \
redhat/7.3/updates/i386/mozilla-nss-1.4.3-0.7.1.legacy.i386.rpm \
04789c2b7516018e0fdbae8c0c24edba98a373b7  \
redhat/7.3/updates/i386/mozilla-nss-devel-1.4.3-0.7.1.legacy.i386.rpm \
14287024fbe57fc555c5e8fa2736d2a708ae2dc6  \
redhat/7.3/updates/i386/galeon-1.2.13-0.7.1.legacy.i386.rpm

4cba85b2190de4bbd96505a0433cad388e3a2e26  \
redhat/9/updates/SRPMS/mozilla-1.4.3-0.9.1.legacy.src.rpm \
f5cf30105dbec5d0f24270e418141ba556df7db0  \
redhat/9/updates/SRPMS/galeon-1.2.13-0.9.2.legacy.src.rpm \
5623fba5418718a38eb47a334866833d5705f809  \
redhat/9/updates/i386/mozilla-1.4.3-0.9.1.legacy.i386.rpm \
17a567dc4151929cd998fa145631a939edb658ea  \
redhat/9/updates/i386/mozilla-chat-1.4.3-0.9.1.legacy.i386.rpm \
c94427f671fc72f3198c3947feb1a55e14cb285f  \
redhat/9/updates/i386/mozilla-devel-1.4.3-0.9.1.legacy.i386.rpm \
a11eecf474c891edcc64dcb07e85ffef0af17b42  \
redhat/9/updates/i386/mozilla-dom-inspector-1.4.3-0.9.1.legacy.i386.rpm \
eff086a513ad6a62c64e0f5875c8407e706360ed  \
redhat/9/updates/i386/mozilla-js-debugger-1.4.3-0.9.1.legacy.i386.rpm \
f11ac30cfc4ef65c0670c381f47b69a342e4db22  \
redhat/9/updates/i386/mozilla-mail-1.4.3-0.9.1.legacy.i386.rpm \
1b69070ca96ef10c60ce7fdb115b730bdf17a5ca  \
redhat/9/updates/i386/mozilla-nspr-1.4.3-0.9.1.legacy.i386.rpm \
aa8c04f0b2d3cefed5222c2940240ecfc3780315  \
redhat/9/updates/i386/mozilla-nspr-devel-1.4.3-0.9.1.legacy.i386.rpm \
5cf1c268091e7b88732e8efa58d48cf225e70800  \
redhat/9/updates/i386/mozilla-nss-1.4.3-0.9.1.legacy.i386.rpm \
6911b2dc76ef48c309c425bd2b8d620941b5c023  \
redhat/9/updates/i386/mozilla-nss-devel-1.4.3-0.9.1.legacy.i386.rpm \
d99fb9b15188b9d58ad67051cd3e3468ac02681c  \
redhat/9/updates/i386/galeon-1.2.13-0.9.2.legacy.i386.rpm

861196199b25fe56d2f2d990c4eb74fad537a643  \
fedora/1/updates/SRPMS/mozilla-1.4.3-1.fc1.1.legacy.src.rpm \
8dd0c2479974060a9b4c64e7fb7bb7bfe08bfca0  \
fedora/1/updates/SRPMS/epiphany-1.0.4-2.4.legacy.src.rpm \
346049a0d8835253ee9f97249b0ac834cb664bfc  \
fedora/1/updates/i386/mozilla-1.4.3-1.fc1.1.legacy.i386.rpm \
4898da95488b5fbb6962613c383f42faaf5ff4ba  \
fedora/1/updates/i386/mozilla-chat-1.4.3-1.fc1.1.legacy.i386.rpm \
edc0eeeaf12cc95c4838375c61140c0a12df423b  \
fedora/1/updates/i386/mozilla-devel-1.4.3-1.fc1.1.legacy.i386.rpm \
871e5ea09920d2844acd74188202c5f99b177bc9  \
fedora/1/updates/i386/mozilla-dom-inspector-1.4.3-1.fc1.1.legacy.i386.rpm \
75d8796d1e902fa56fc8665850a7027d189bd809  \
fedora/1/updates/i386/mozilla-js-debugger-1.4.3-1.fc1.1.legacy.i386.rpm \
08a55541cc0062892b4ae7e11f12ea041dfdc5c2  \
fedora/1/updates/i386/mozilla-mail-1.4.3-1.fc1.1.legacy.i386.rpm \
a00c8f63b2ac924794e533582adecd979ca5aebb  \
fedora/1/updates/i386/mozilla-nspr-1.4.3-1.fc1.1.legacy.i386.rpm \
a3e31f50a30ce3bb9d280bbcd0a941c2910534bd  \
fedora/1/updates/i386/mozilla-nspr-devel-1.4.3-1.fc1.1.legacy.i386.rpm \
df50478720c9430b1e9edbcd96323db6bf15c48b  \
fedora/1/updates/i386/mozilla-nss-1.4.3-1.fc1.1.legacy.i386.rpm \
ebefb845a937bca2c0655f5dd6d43bdf9759a871  \
fedora/1/updates/i386/mozilla-nss-devel-1.4.3-1.fc1.1.legacy.i386.rpm \
5885ec55134e6bffe7be6e0ec527b668e1f8b262  \
fedora/1/updates/i386/epiphany-1.0.4-2.4.legacy.i386.rpm

These packages are GPG signed by Fedora Legacy for security.  Our key is
available from <http://www.fedoralegacy> org/about/security.php

You can verify each package with the following command:

    rpm --checksig -v <filename>

If you only wish to verify that each package has not been corrupted or
tampered with, examine only the sha1sum with the following command:

    sha1sum <filename>

8. References:

<https://rhn.redhat.com/errata/RHSA-2004-110.html>
<https://rhn.redhat.com/errata/RHSA-2004-383.html>
<https://rhn.redhat.com/errata/RHSA-2004-486.html>

9. Contact:

The Fedora Legacy security contact is <secnotice@fedoralegacy.org>. More
project details at <http://www.fedoralegacy.org>

---------------------------------------------------------------------

[["signature.asc" (application/pgp-signature)]](?l=bugtraq&m=109900315219363&q=p3)

[[prev in list](?l=bugtraq&m=109889281711636&w=2)] [[next in list](?l=bugtraq&m=109892527321706&w=2)] [[prev in thread](?l=fedora-legacy-announce&m=109889271930515&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_a2a55f75_20250125_020756.html ===

```
[[prev in list](?l=bugtraq&m=109701230714407&w=2)] [[next in list](?l=bugtraq&m=109702737720795&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [security bulletin]SSRT4826 rev.0 Mozilla Application Suite for HP Tru64 UNIX Multiple Potential Sec
From:       ["Boren, Rich (SSRT)" <rich.boren () hp ! com>](?a=108403821000004&r=1&w=2)
Date:       [2004-10-05 4:46:59](?l=bugtraq&r=1&w=2&b=200410)
Message-ID: [0575B1F095782C48A1FC464F30C79E4D08120F09 () CXOEXC12 ! AMERICAS ! CPQCORP ! NET](?i=0575B1F095782C48A1FC464F30C79E4D08120F09%20()%20CXOEXC12%20!%20AMERICAS%20!%20CPQCORP%20!%20NET)
[Download RAW [message](?l=bugtraq&m=109698896104418&q=mbox) or [body](?l=bugtraq&m=109698896104418&q=raw)]

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

HP SECURITY BULLETIN

HPSBTU01081     REVISION: 0

SSRT4826 rev.0 Mozilla Application Suite for HP Tru64 UNIX
               Multiple Potential Security Vulnerabilities

NOTICE:
There are no restrictions for distribution of this Bulletin
provided that it remains complete and intact.

The information in this Security bulletin should be acted upon
as soon as possible.

INITIAL RELEASE:
29 September 2004

POTENTIAL SECURITY IMPACT:
 Potential vulnerabilities exist that could result in multiple
 local and remote exploits

SOURCE:
HEWLETT-PACKARD COMPANY
HP Software Security Response Team

REFERENCES:
US-CERT VU#651928, US-CERT VU#847200, US-CERT VU#460528,
US-CERT VU#808216, US-CERT VU#113192, US-CERT VU#327560,
US-CERT VU#125776, US-CERT VU#414240,

VULNERABILITY SUMMARY:
 Potential vulnerabilities exist that could result in
    o Remote execution of arbitrary code
    o Remote unauthorized ability to access data contained on a
      victim's clipboard
    o Remote unauthorized ability to install and run software on
      a vulnerable system
    o Local unauthorized file access

SUPPORTED SOFTWARE VERSIONS*:  ONLY impacted versions are listed.
    Mozilla Application Suite for HP Tru64 UNIX versions earlier
    than 1.7.3.

BACKGROUND:
    HP has corrected these potential vulnerabilities by releasing
    the kit identified in the resolution section below.

    For a listing of all HP Tru64 UNIX security patch kits please
    see the following web site:
      <http://h30097.www3.hp.com/unix/security-download.html>

RESOLUTION:
    The potential vulnerabilities have been corrected in the
    following Mozilla version:
    Mozilla Application Suite for HP Tru64 UNIX V1.7.3
    The Mozilla Application Suite for HP Tru64 UNIX is provided
    for use on the supported base levels of HP Tru64 UNIX 5.1A and
    5.1B. Supported versions are:
        HP Tru64 UNIX 5.1B PK4 (BL25)
        HP Tru64 UNIX 5.1B PK3 (BL24)
        HP Tru64 UNIX 5.1A PK6 (BL24)
    V1.7.3 web kits can be downloaded from the following sites:
    The Mozilla site:
       <http://www.mozilla.org/releases/>
    The download site for HP Tru64 UNIX internet and networking
    software:
       <http://h30097.www3.hp.com/internet/download.htm>

BULLETIN REVISION HISTORY:
INITIAL RELEASE:

29 September 2004

* The software product category that this Security Bulletin
  relates to is represented by the 5th and 6th characters of the
  Bulletin number: GN=General, MA=Management Agents,
  MI=Misc. 3rd party, MP=HP-MPE/iX, NS=HP NonStop Servers,
  OV=HP OpenVMS, PI=HP Printing & Imaging, ST=HP Storage,
  TU=HP Tru64 UNIX, TL=Trusted Linux, UX=HP-UX, VV=Virtual Vault

SUPPORT: For further information, contact HP Services support
         channel.

SUBSCRIBE: To initiate a subscription to receive future HP
Security Bulletins via Email:
<http://h30046.www3.hp.com/driverAlertProfile.php?regioncode>
=NA&langcode=USENG&jumpid=in_SC-GEN__driverITRC&topiccode=ITRC
On the web page:
Driver and Support Alerts/Notifications Sign-up: Product Selection
Under Step1: your products
1. Select product category:
   - a minimum of servers must be selected.
2. Select product family or search:
   - a minimum of one product must be selected.
3. Add a product:
   - a minimum of one product must be added.
In Step 2: your operating system(s)
   - check ALL operating systems for which alerts are required.
Complete the form and Save.

To update an existing subscription:
<http://h30046.www3.hp.com/subSignIn.php>
Log in on the web page Subscriber's choice for Business: sign-in.
On the Web page: Subscriber's Choice: your profile summary
- - use Edit Profile to update appropriate sections.

Note: In addition to the individual alerts/notifications for the
selected operating systems/products, subscribers will
automatically receive one copy of alerts for non-operating system
categories (i.e., a subscriber who signs up for all six operating
system alerts will only receive one copy of all the non-operating
system alerts).

REPORT: To report a potential security vulnerability with any HP
supported product, send Email to: security-alert@hp.com. It is
strongly recommended that security related information being
communicated to HP be encrypted using PGP, especially exploit
information. To obtain the security-alert PGP key please send an
e-mail message to security-alert@hp.com with the Subject of
'get key' (no quotes).

System management and security procedures must be reviewed
frequently to maintain system integrity. HP is continually
reviewing and enhancing the security features of software products
to provide customers with current secure solutions.

"HP is broadly distributing this Security Bulletin in order to
bring to the attention of users of the affected HP products the
important security information contained in this Bulletin. HP
recommends that all users determine the applicability of this
information to their individual situations and take appropriate
action. HP does not warrant that this information is necessarily
accurate or complete for all user situations and, consequently,
HP will not be responsible for any damages resulting from user's
use or disregard of the information provided in this Bulletin.
To the extent permitted by law, HP disclaims all warranties,
either express or implied, including the warranties of
merchantability and fitness for a particular purpose, title
and non-infringement."

(c)Copyright 2004 Hewlett-Packard Development Company, L.P.
Hewlett-Packard Company shall not be liable for technical or
editorial errors or omissions contained herein. The information
provided is provided "as is" without warranty of any kind. To the
extent permitted by law, neither HP or its affiliates,
subcontractors or suppliers will be liable for incidental, special
or consequential damages including downtime cost; lost profits;
damages relating to the procurement of substitute products or
services; or damages for loss of data, or software restoration.
The information in this document is subject to change without
notice. Hewlett-Packard Company and the names of Hewlett-Packard
products referenced herein are trademarks of Hewlett-Packard
Company in the United States and other countries. Other product
and company names mentioned herein may be trademarks of their
respective owners.

-----BEGIN PGP SIGNATURE-----
Version: PGP 8.0.2

iQA/AwUBQVv17OAfOvwtKn1ZEQJOigCglCBYpXiErSj4FJQOO38xWXsqjoUAn0M7
Eca0AZDUc71IBGvERYO/dFpR
=oZBd
-----END PGP SIGNATURE-----

[[prev in list](?l=bugtraq&m=109701230714407&w=2)] [[next in list](?l=bugtraq&m=109702737720795&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from bugzilla.mozilla.org_a5db71e6_20250125_020725.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/258005)
* [XML](/show_bug.cgi?ctype=xml&id=258005)

Closed
[Bug 258005](/show_bug.cgi?id=258005)

Opened 20 years ago
Closed 20 years ago

# heap overflows triggered by "send page"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

heap overflows triggered by "send page"

## Categories

### (MailNews Core :: Security, defect)

[Product:](/describecomponents.cgi?product=MailNews%20Core)

MailNews Core
▾

MailNews Core
Mail and news components common to Thunderbird and SeaMonkey
[See Open Bugs in This Product](/buglist.cgi?product=MailNews%20Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=MailNews%20Core)
Watch This Product

[Component:](/describecomponents.cgi?product=MailNews%20Core&component=Security#Security)

Security
▾

MailNews Core :: Security
This component covers all bugs that relate to use of cryptography, S/MIME, and SSL issues for MailNews. Or, use this
component if you have a MailNews security bug.
[See Open Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=MailNews%20Core&component=Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

## Tracking

### (Not tracked)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| relnote-thunderbird |  | --- |
| seamonkey2.53 | --- | --- |
| seamonkey2.57esr | --- | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |
| thunderbird136 | --- | --- |

## People

### (Reporter: guninski, Assigned: mscott)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/81927006e32b6874ba18489885babf50?d=mm&size=40)  [mscott](/user_profile?user_id=93208)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/eb49beecdde375e0927ad6ebd7302ec1?d=mm&size=40)  [guninski](/user_profile?user_id=23768)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[sbb+](/show_bug.cgi?id=256197 "RESOLVED WORKSFORME - Security Bug Bounty: awarded")

Dependency [tree](/showdependencytree.cgi?id=258005&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=258005)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: fixed-aviary1.0, fixed1.7.5, Whiteboard: [sg:fix] fixed1.7.3)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---),
[fixed1.7.5](/buglist.cgi?keywords=fixed1.7.5&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:fix] fixed1.7.3

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [chofmann](/user_profile?user_id=2687) | [blocking1.7.5](#c0 "20 years ago") | + |
| --- | --- | --- |
| [chofmann](/user_profile?user_id=2687) | blocking1.7.5 | + |
| --- | --- | --- |
| [chofmann](/user_profile?user_id=2687) | [blocking-aviary1.0PR](#a15262_2687 "20 years ago") | + |
| --- | --- | --- |
| [chofmann](/user_profile?user_id=2687) | blocking-aviary1.0PR | + |
| --- | --- | --- |
|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [/cgi-bin/long2.pl](/attachment.cgi?id=157874)  [20 years ago](#c1)  [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)   132 bytes, application/x-perl |  | [Details](/attachment.cgi?id=157874&action=edit) |
| --- | --- | --- |
| [/cgi-bin/long.pl](/attachment.cgi?id=157875)  [20 years ago](#c2)  [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)   136 bytes, text/plain |  | [Details](/attachment.cgi?id=157875&action=edit) |
| [html testcase - click on the link, choose "send page", email it](/attachment.cgi?id=157933)  [20 years ago](#c4)  [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)   4.02 KB, text/html |  | [Details](/attachment.cgi?id=157933&action=edit) |
| [Proposed patch - changes PL\_strcpy with nsCAutoString](/attachment.cgi?id=157934)  [20 years ago](#c5)  [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)   8.13 KB, patch |  | [Details](/attachment.cgi?id=157934&action=edit) | [Diff](/attachment.cgi?id=157934&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=258005&attachment=157934) |
| [updated version of the fix](/attachment.cgi?id=158152)  [20 years ago](#c6)  [Scott MacGregor](/user_profile?user_id=93208)   8.40 KB, patch | Bienvenu : [superreview+](#a300112_4410 "20 years ago") | [Details](/attachment.cgi?id=158152&action=edit) | [Diff](/attachment.cgi?id=158152&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=258005&attachment=158152) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=258005#c0)• 20 years ago |
|  | |

User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.6) Gecko/20040115
Build Identifier: Mozilla/5.0
there are heap based buffer overflows triggered by "send page" and then sending
the email. the overflow is at least in 1.7 and nightly from 3.sep.
the fucked code is in
nsMsgCompUtils.cpp
mime\_generate\_attachment\_headers
one of the overflows is triggered by:
if (\*s == ' ')
PUSH\_STRING("%20");
one char consumes 3 bytes of memory, while only 2 are allocated.
to reproduce try to send as page "data:text/html;,A\_LOT\_OF\_SPACES.
the other buffer overflow is triggered by sending long http urls containing ' ',
not clear which code fucks it.
btw, the macro PUSH\_STRING is quite unsafe and i suggest it checks whether there
is enough space left.
Reproducible: Always
Steps to Reproduce:
will attach testcases.
Actual Results:
the heap is fucked up
Expected Results:
the heap is not fucked up

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=258005#c1)• 20 years ago |
|  | |

Attached file
[/cgi-bin/long2.pl](attachment.cgi?id=157874)
— [Details](attachment.cgi?id=157874&action=edit)

put in cgi-bin, access it, click on the link then choose "send page" and send
the email.

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=258005#c2)• 20 years ago |
|  | |

Attached file
[/cgi-bin/long.pl](attachment.cgi?id=157875)
— [Details](attachment.cgi?id=157875&action=edit)

put in cgi-bin, access it, put web server on localhost:1234 which should serve
anything, send the page as email.

|  | [chris hofmann](/user_profile?user_id=2687) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a15262_2687)• 20 years ago |

Flags: blocking1.7.x+Flags: blocking-aviary1.0PR+

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=258005#c3)• 20 years ago |
|  | |

mscott, can you take a look?
/beAssignee: sspitzer → mscottStatus: UNCONFIRMED → NEWEver confirmed: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a59311_1689)• 20 years ago |

Blocks: [sbb?](/show_bug.cgi?id=256195 "RESOLVED WORKSFORME - Security Bug Bounty: nominated")Whiteboard: [sg:fix]

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=258005#c4)• 20 years ago |
|  | |

Attached file
[html testcase - click on the link, choose "send page", email it](attachment.cgi?id=157933)
— [Details](attachment.cgi?id=157933&action=edit)

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=258005#c5)• 20 years ago |
|  | |

Attached patch

[Proposed patch - changes PL\_strcpy with nsCAutoString](attachment.cgi?id=157934&action=diff) (obsolete)
— [Details](attachment.cgi?id=157934&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=258005&attachment=157934)

[bug 257314](/show_bug.cgi?id=257314 "VERIFIED FIXED - stack based buffer overflow with vcards when previewing email message") was fixed by changing PL\_strcpy with nsCAutoString, so this patch
does the same.
the risk from regression is low, the performance hit is minimal.
the only potential problem may be memory leak in this:
return PL\_strdup(buf.get());
couldn't find the definition of nsCAutoString

|  | [Scott MacGregor](/user_profile?user_id=93208)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=258005#c6)• 20 years ago |
|  | |

Attached patch

[updated version of the fix](attachment.cgi?id=158152&action=diff)
— [Details](attachment.cgi?id=158152&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=258005&attachment=158152)

I took Georgi's original patch and did the following:
1) removed the tabs
2) changed the nsCAutoString to an nsCString
3) I also did a review on the code to make sure each .Append call had the same
arguments as the old push string call.
4) Note that many (but not all!) of these changes are inside of a
GENERATE\_CONTENT\_BASE ifdef which we don't defined during the build so some of
it isn't actually executed.
There are still more cases of PUSH\_STRING that could probably be converted over
to using the string APIs in this file.

|  | [Scott MacGregor](/user_profile?user_id=93208)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a294081_93208)• 20 years ago |

[Attachment #157934](/attachment.cgi?id=157934&action=edit "Proposed patch - changes PL_strcpy with nsCAutoString") -
Attachment is obsolete: true

|  | [Scott MacGregor](/user_profile?user_id=93208)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=258005#c7)• 20 years ago |
|  | |

Comment on [attachment 158152](/attachment.cgi?id=158152 "updated version of the fix") [[details]](/attachment.cgi?id=158152&action=edit "updated version of the fix") [[diff]](/attachment.cgi?id=158152&action=diff "updated version of the fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=258005&attachment=158152)
updated version of the fix
See:
<http://bugzilla.mozilla.org/show_bug.cgi?id=258005#c6>
for details
[Attachment #158152](/attachment.cgi?id=158152&action=edit "updated version of the fix") -
Flags: superreview?(bienvenu)

|  | [chris hofmann](/user_profile?user_id=2687) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a295405_2687)• 20 years ago |

Whiteboard: [sg:fix] → [sg:fix] [have patch] need review bienvenu

|  | [David :Bienvenu](/user_profile?user_id=4410) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a300112_4410)• 20 years ago |

[Attachment #158152](/attachment.cgi?id=158152&action=edit "updated version of the fix") -
Flags: superreview?(bienvenu) → superreview+

|  | [Scott MacGregor](/user_profile?user_id=93208)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=258005#c8)• 20 years ago |
|  | |

fixed on the aviary 1.0 branch and the trunk. We should probably let this bake
for a couple days before landing for 1.7.x?Status: NEW → RESOLVEDClosed: 20 years agoKeywords: [fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---)Resolution: --- → FIXED

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=258005#c9)• 20 years ago |
|  | |

+ nsCString buf("");
no need for the "" argument, strings are empty by default

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=258005#c10)• 20 years ago |
|  | |

If the string-expanding PUSH\_STRING("%20") is inside the ifdef, then the buffer
overrun must be somewhere else. Does this really fix it?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=258005#c11)• 20 years ago |
|  | |

Checked "updated version" into the 1.7.2 branch
Fixes the html testcase linked above, can't test the cgi-bin testcases right now.
I'm concerned similar PUSH\_STRING() problems lurk in mime\_generate\_headers:
> /\* Add a bunch of slop for the static parts of the headers. \*/
> /\* size += 2048; \*/
> size += 2560;
If the "slop" had to be increased once there's no guarantee we haven't added new
headers since. Or that it was even right to begin with.

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=258005#c12)• 20 years ago |
|  | |

dveditz: i agree that other occurences of PUSH\_STRING should be fixed also in
the same simple way.
per your previous comment, i believe the c++ stuff fixes the overflow in both
testcases as evidence suggests.
btw, are there any docs which explain the methods and usage of basic NS\* classes?

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=258005#c13)• 20 years ago |
|  | |

> are there any docs which explain the methods and usage of basic NS\* classes?
For nsString
<<http://www.mozilla.org/projects/xpcom/string-quickref.html>>
<<http://www.mozilla.org/projects/xpcom/string-guide.html>>
but they may be outdated and incomplete.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a419695_1689)• 20 years ago |

Whiteboard: [sg:fix] [have patch] need review bienvenu → [sg:fix] fixed1.7.2+, needed-1.7.x

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=258005#c14)• 20 years ago |
|  | |

at least that second link is pretty up-to-date.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a858661_1689)• 20 years ago |

Group: securityWhiteboard: [sg:fix] fixed1.7.2+, needed-1.7.x → [sg:fix] fixed1.7.3, needed-1.7.x

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a901622_1689)• 20 years ago |

Blocks: [sbb+](/show_bug.cgi?id=256197 "RESOLVED WORKSFORME - Security Bug Bounty: awarded")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a901735_1689)• 20 years ago |

No longer blocks: [sbb?](/show_bug.cgi?id=256195 "RESOLVED WORKSFORME - Security Bug Bounty: nominated")

|  | [Oliver Klee](/user_profile?user_id=18593) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a1143183_18593)• 20 years ago |

Summary: heap overflows triggerd by "send page" → heap overflows triggered by "send page"

|  | [Robin Lu](/user_profile?user_id=53791) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=258005#c15)• 20 years ago |
|  | |

(In reply to [comment #11](/show_bug.cgi?id=258005#c11 "VERIFIED FIXED - heap overflows triggered by \"send page\""))
> Checked "updated version" into the 1.7.2 branch
>
I found this patch is not in 1.7 branch. Is there anything wrong?

|  | [Robin Lu](/user_profile?user_id=53791) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=258005#c16)• 20 years ago |
|  | |

I found this patch is in MOZILLA\_1\_7\_3\_RELEASE branch but not in
MOZILLA\_1\_7\_BRANCH. Should we check it into MOZILLA\_1\_7\_BRANCH so that we can
have it in mozilla 1.7.4 and later?

|  | [Mike Kaply [:mkaply]](/user_profile?user_id=7313) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=258005#c17)• 20 years ago |
|  | |

Yes, please put this on the 1.7 branch.

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a6870811_27300)• 20 years ago |

Product: MailNews → Core

|  | [OstGote!](/user_profile?user_id=51898) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=258005#c18)• 20 years ago |
|  | |

It is still not on the MOZILLA\_1\_7\_BRANCH for 1.7.5.

|  | [Mike Kaply [:mkaply]](/user_profile?user_id=7313) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a8822891_7313)• 20 years ago |

Keywords: [fixed1.7.5](/buglist.cgi?keywords=fixed1.7.5&resolution=---)Whiteboard: [sg:fix] fixed1.7.3, needed-1.7.x → [sg:fix] fixed1.7.3

|  | [Marcia Knous [:marcia]](/user_profile?user_id=8519) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=258005#c19)• 20 years ago |
|  | |

Both Tracy and I tested the html testcase using 1.75 Windows 20041216 - I tested
using 1.75 Mac 20041216-09. verifying fixed after discussion with dveditz.Status: RESOLVED → VERIFIED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=258005#c20)• 20 years ago |
|  | |

(note: fix checked into 1.7 branch by mkaply on 12/15)

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=258005#a123201406_1)• 16 years ago |

Product: Core → MailNews Core
You need to [log in](/show_bug.cgi?id=258005&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_ae3bb662_20250125_020719.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/226669)
* [XML](/show_bug.cgi?ctype=xml&id=226669)

Closed
[Bug 226669](/show_bug.cgi?id=226669)

Opened 21 years ago
Closed 21 years ago

# Thunderbird tries to download nonexisting messages with POP3

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Thunderbird tries to download nonexisting messages with POP3

## Categories

### (MailNews Core :: Networking: POP, defect)

[Product:](/describecomponents.cgi?product=MailNews%20Core)

MailNews Core
▾

MailNews Core
Mail and news components common to Thunderbird and SeaMonkey
[See Open Bugs in This Product](/buglist.cgi?product=MailNews%20Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=MailNews%20Core)
Watch This Product

[Component:](/describecomponents.cgi?product=MailNews%20Core&component=Networking%3A%20POP#Networking%3A%20POP)

Networking: POP
▾

MailNews Core :: Networking: POP
Problems with receiving mail when your mail account is set up for POP. This component should be chosen if you've verified that the receiving problem is specific to POP protocol. Deleting messages to the trash folder would also fall into this component.
[See Open Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Networking%3A%20POP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Networking%3A%20POP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=MailNews%20Core&component=Networking%3A%20POP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (Not tracked)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| relnote-thunderbird |  | --- |
| seamonkey2.53 | --- | --- |
| seamonkey2.57esr | --- | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |
| thunderbird136 | --- | --- |

## People

### (Reporter: tim.kosse, Assigned: ch.ey)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/bf1bcc6bb5ae141ffc17e081ae099287?d=mm&size=40)  [ch.ey](/user_profile?user_id=31357)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/c9f854f78af38b7f8ce17cefbcdf74a9?d=mm&size=40)  [esther](/user_profile?user_id=4114)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/53b519d7e2bc1865fe027a7264b4b822?d=mm&size=40)  [tim.kosse](/user_profile?user_id=120241)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

5 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[237131](/show_bug.cgi?id=237131 "RESOLVED WORKSFORME - popstate.dat cleared after unexpected response from server"), [245066](/show_bug.cgi?id=245066 "RESOLVED FIXED - [internal] nsPop3Protocol.cpp, back out fix for bug #157644, since david has fixed the problem another way (bug #229374)")

Dependency [tree](/showdependencytree.cgi?id=226669&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=226669)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[230294](/show_bug.cgi?id=230294 "VERIFIED DUPLICATE - MailNews tries to download messages with nonexistent numbers (ignores list of numbers provided by server) thus completely fails to download any new mail")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: fixed-aviary1.0, fixed1.7.3, Whiteboard: [sg:fix])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---),
[fixed1.7.3](/buglist.cgi?keywords=fixed1.7.3&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:fix]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [blocking1.7.5](#c0 "20 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.7.5 | + |
| --- | --- | --- |
|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [example patch](/attachment.cgi?id=143729)  [21 years ago](#c8)  [Christian Eyrich](/user_profile?user_id=31357)   6.19 KB, patch |  | [Details](/attachment.cgi?id=143729&action=edit) | [Diff](/attachment.cgi?id=143729&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=226669&attachment=143729) |
| --- | --- | --- |
| [patch v2](/attachment.cgi?id=143785)  [21 years ago](#c9)  [Christian Eyrich](/user_profile?user_id=31357)   8.53 KB, patch | mscott : [review+](#a9752407_93208 "21 years ago")  Bienvenu : [superreview+](#c10 "21 years ago")  dveditz : [approval1.7.5+](#c0 "20 years ago") | [Details](/attachment.cgi?id=143785&action=edit) | [Diff](/attachment.cgi?id=143785&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=226669&attachment=143785) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Tim Kosse](/user_profile?user_id=120241)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=226669#c0)• 21 years ago |
|  | |

User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322)
Build Identifier: Mozilla Tunderbird 0.4a (20031119)
I'm using a small pop3 proxy which scans my incoming mail headers and deletes
spam directly on the server.
However if I try to get my mail using Thunderbird over my proxy, it always
fails, I get an "-ERR message is deleted" response from the server.
Thunderbird correctly sends LIST and UIDL to the server. My proxy did already
delete some messages, so that they aren't included in the response to LIST/UIDL
anymore.
Example (message with index 2 has been deleted):
UIDL
+OK mailbox has 2 messages (23612 octets)
1 4dc74a92bfa4d7s8
3 613d71dfdc905ee0
The next thing Thunderbird does is to retrieve the mails with the UIDs it
doesn't know yet. The problem is that Thunderbird also sends a RETR 2 command,
which fails.
I could think of the following reasons for this bug:
- Thunderbird does not correctly parse the output of LIST/UIDL
- the internal UID list does not get initialized properly (no UID for mail with
index 2 received -> 0 or random data as UID)
- Thunderbird tries to download messages with 0 UIDs (in case the internal UID
list gets zero-initialized)
I've tested the Win32 build of Mozilla Tunderbird 0.4a (20031119)
Reproducible: Always
Steps to Reproduce:
I've been redirected to BugZilla, the original report can be found here:
<http://forums.mozillazine.org/viewtopic.php?p=274792#274792>

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=226669#c1)• 21 years ago |
|  | |

Oh, that's a problem, yes.
We imply that we're the only one doing something with the mails in the current
session. Therefore we take line one as message one, line two as message two a.s.o.
But that's not true if a proxy deletes messages in the same session. RFC clearly
says "Note that messages marked as deleted are not listed."
I guess we have to include the message number in the Pop3MsgInfo struct and not
take index x for message x. That would be easy, but accessing the infos for a
message would be complicated (loop with m\_pop3ConData->msg\_info[i].msgnum ==
msg\_num instead of msg\_info[msg\_num]).
David, any other idea?Status: UNCONFIRMED → NEWEver confirmed: trueOS: Windows XP → AllHardware: PC → All

|  | [David :Bienvenu](/user_profile?user_id=4410) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=226669#c2)• 21 years ago |
|  | |

If that turns out to be painful, we could just leave (initialized) holes in the
msginfo struct and ignore them when we iterate over it. I'd have to look at the
code more closely.Assignee: sspitzer → bienvenu

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=226669#c3)• 21 years ago |
|  | |

The problem with these holes is, that with say highest message number 20 we'd
need 20 entries in m\_pop3ConData->msg\_info. But we don't know about the number
needed before the complete listing.
Currently we use number\_of\_messages filled by the STAT answer in GetStat() - but
"Note that messages marked as deleted are not counted in either total."
So we'd either could always allocate kLargeNumberOfMessages entries. Or issue
the LIST command to just look at the last message number, allocate it and then
issue LIST again to use it like now. Both not satisfying.

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=226669#c4)• 21 years ago |
|  | |

\*\*\* [Bug 230294](/show_bug.cgi?id=230294 "VERIFIED DUPLICATE - MailNews tries to download messages with nonexistent numbers (ignores list of numbers provided by server) thus completely fails to download any new mail") has been marked as a duplicate of this bug. \*\*\*

|  | [David :Bienvenu](/user_profile?user_id=4410) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=226669#a9332782_4410)• 21 years ago |

Blocks: [237131](/show_bug.cgi?id=237131 "RESOLVED WORKSFORME - popstate.dat cleared after unexpected response from server")

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=226669#c5)• 21 years ago |
|  | |

David, I think it's better you're doing this. I don't get what you mean with
"level of indirection" and have no own idea to fix the problem from my [comment #1](/show_bug.cgi?id=226669#c1 "RESOLVED FIXED - Thunderbird tries to download nonexisting messages with POP3").

|  | [David :Bienvenu](/user_profile?user_id=4410) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=226669#c6)• 21 years ago |
|  | |

by level of indirection, I just meant what you described in commment 1, but
that's probably not a good way of describing it. I'll look and see how hard it
will be. Someone to help test this is going to be important, since I don't have
access to a server that has this behaviour.

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=226669#c7)• 21 years ago |
|  | |

Ah, ok, so you meant the "looping-thing". Well, it should be quite easy - and
quite ugly. But as I wrote, I don't know better way.
I can test it with my Perl script that I always use - send it to you if you like.

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=226669#c8)• 21 years ago |
|  | |

Attached patch

[example patch](attachment.cgi?id=143729&action=diff) (obsolete)
— [Details](attachment.cgi?id=143729&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=226669&attachment=143729)

This is the patch like I'd do it.
Instead
for(i = 0; m\_pop3ConData->msg\_info[i].msgnum != msg\_num && i <=
m\_pop3ConData->number\_of\_messages; i++)
;
m\_pop3ConData->msg\_info[i].uidl = PL\_strdup(uidl);
we could simply do
m\_pop3ConData->msg\_info[m\_listpos - 1].uidl = PL\_strdup(uidl);
Required for this is that we can be sure the order and number in the UIDL and
XTND responses is the same as in the LIST response. And I don't if we really
can.

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=226669#c9)• 21 years ago |
|  | |

Attached patch

[patch v2](attachment.cgi?id=143785&action=diff)
— [Details](attachment.cgi?id=143785&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=226669&attachment=143785)

Ups, in the first patch I forgot the changed header file.
Two additional changes are in this patch:
1. If LIST, XTND or UIDL lists fewer entries than STAT reported
m\_pop3ConData->number\_of\_messages is limited to the new maximum.
2. m\_pop3ConData->msg\_info[m\_listpos - 1].msgnum == msg\_num is tried first and
taken if true. If not, the loop searching for the right index to msg\_num is
entered. I think that's best of both worlds (fast & paranoid).

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=226669#a9470839_31357)• 21 years ago |

[Attachment #143729](/attachment.cgi?id=143729&action=edit "example patch") -
Attachment is obsolete: true

|  | [David :Bienvenu](/user_profile?user_id=4410) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=226669#c10)• 21 years ago |
|  | |

Comment on [attachment 143785](/attachment.cgi?id=143785 "patch v2") [[details]](/attachment.cgi?id=143785&action=edit "patch v2") [[diff]](/attachment.cgi?id=143785&action=diff "patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=226669&attachment=143785)
patch v2
looks good to me
[Attachment #143785](/attachment.cgi?id=143785&action=edit "patch v2") -
Flags: superreview+

|  | [David :Bienvenu](/user_profile?user_id=4410) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=226669#c11)• 21 years ago |
|  | |

Comment on [attachment 143785](/attachment.cgi?id=143785 "patch v2") [[details]](/attachment.cgi?id=143785&action=edit "patch v2") [[diff]](/attachment.cgi?id=143785&action=diff "patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=226669&attachment=143785)
patch v2
requesting mscott review.
[Attachment #143785](/attachment.cgi?id=143785&action=edit "patch v2") -
Flags: review?(mscott)

|  | [David :Bienvenu](/user_profile?user_id=4410) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=226669#c12)• 21 years ago |
|  | |

re 1.7b and 1.7, I'd like to get it in but I'm not sure how risky it is. It's
supposed to fix a couple bugs in our handling of pop3 servers doing the wrong
thing - I'm not sure how many other users are experiencing this. I can try
running with this patch.

|  | [Scott MacGregor](/user_profile?user_id=93208) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=226669#a9752407_93208)• 21 years ago |

[Attachment #143785](/attachment.cgi?id=143785&action=edit "patch v2") -
Flags: review?(mscott) → review+

|  | [:aceman](/user_profile?user_id=97012) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=226669#c13)• 21 years ago |
|  | |

I would test it too, if it would be a matter of replacing some .dll, otherwise I
have to wait for 1.7... And the server may get fixed by that time (because it
does these things only for several days).

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=226669#c14)• 21 years ago |
|  | |

Maybe that's another bug, but since it's about getting the right UIDL and could
be changed in the same patch.
Our XTND XLST response parser is broken. Someone commented out
char \*eatMessageIdToken = nsCRT::strtok(newStr, " ", &newStr);
in GetXtndXlstMsgid() sometime in the past.
So if we get a response
1 Message-ID: <3117E4DC.2699@netscape.com>
we'll extract "Message-ID:" as UIDL ...
Reactivating the aboe line would fix this problem.

|  | [David :Bienvenu](/user_profile?user_id=4410) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=226669#c15)• 21 years ago |
|  | |

Christian, that line was commented out in the very first version of Mozilla,
which means it was commented out in the pre-mozilla source code. Unfortunately,
that means I can't tell why it was commented out since that history is lost. I'm
not saying that means uncommenting it out is wrong; just that it's been this way
for 5 years at least.

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=226669#c16)• 21 years ago |
|  | |

Ah, ok. I know that XTND XLST is unlikely to be supported by a server and maybe
the feature has never been used. But I think if we offer a command, it should work.

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=226669#c17)• 21 years ago |
|  | |

David, did you evaluate the risk of this patch yet? If ok, we should ask for
approval.

|  | [David :Bienvenu](/user_profile?user_id=4410) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=226669#c18)• 21 years ago |
|  | |

fix checked in, thx, Christian!Status: NEW → RESOLVEDClosed: 21 years agoResolution: --- → FIXED

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=226669#c19)• 21 years ago |
|  | |

Reopen to change assignee.Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=226669#a12945436_31357)• 21 years ago |

Assignee: bienvenu → ch.eyStatus: REOPENED → NEW

|  | [Christian Eyrich](/user_profile?user_id=31357)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=226669#a12945463_31357)• 21 years ago |

Status: NEW → RESOLVEDClosed: 21 years ago → 21 years agoResolution: --- → FIXED

|  | [David :Bienvenu](/user_profile?user_id=4410) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=226669#a17958346_4410)• 21 years ago |

Whiteboard: fixed-aviary1.0

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=226669#c20)• 20 years ago |
|  | |

Blocking 1.7.3Flags: blocking1.7.3+Whiteboard: fixed-aviary1.0 → [sg:fix] fixed-aviary1.0, needed1.7

|  | [:aceman](/user_profile?user_id=97012) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=226669#c21)• 20 years ago |
|  | |

Is this in 1.7.0? I have tried it and I see no difference to 1.5. I was
currently hit the bug.

|  | [David :Bienvenu](/user_profile?user_id=4410) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=226669#c22)• 20 years ago |
|  | |

I don't think this was checked into 1.7...

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=226669#c23)• 20 years ago |
|  | |

This has not landed on the 1.7 branch; it should.Keywords: [fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---)Whiteboard: [sg:fix] fixed-aviary1.0, needed1.7 → [sg:fix] needed1.7

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=226669#c24)• 20 years ago |
|  | |

Comment on [attachment 143785](/attachment.cgi?id=143785 "patch v2") [[details]](/attachment.cgi?id=143785&action=edit "patch v2") [[diff]](/attachment.cgi?id=143785&action=diff "patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=226669&attachment=143785)
patch v2
a=dveditz for drivers
[Attachment #143785](/attachment.cgi?id=143785&action=edit "patch v2") -
Flags: approval1.7.3+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=226669#a23841795_1689)• 20 years ago |

Blocks: [245066](/show_bug.cgi?id=245066 "RESOLVED FIXED - [internal] nsPop3Protocol.cpp, back out fix for bug #157644, since david has fixed the problem another way (bug #229374)")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=226669#c25)• 20 years ago |
|  | |

Fix checked in to 1.7 and 1.7.2 branchesKeywords: [fixed1.7.3](/buglist.cgi?keywords=fixed1.7.3&resolution=---)Whiteboard: [sg:fix] needed1.7 → [sg:fix] fixed1.7.2+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=226669#a25456262_1689)• 20 years ago |

Whiteboard: [sg:fix] fixed1.7.2+ → [sg:fix] fixed1.7.3

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=226669#a31468235_27300)• 20 years ago |

Product: MailNews → Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=226669#a34137915_1689)• 20 years ago |

Keywords: [fixed1.7.5](/buglist.cgi?keywords=fixed1.7.5&resolution=---) → [fixed1.7.3](/buglist.cgi?keywords=fixed1.7.3&resolution=---)Whiteboard: [sg:fix] fixed1.7.3 → [sg:fix]

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=226669#a162943281_1)• 16 years ago |

Product: Core → MailNews Core
You need to [log in](/show_bug.cgi?id=226669&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Christian Eyrich](/user_profile?user_id=31357)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_d7f0930c_20250125_020723.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/256316)
* [XML](/show_bug.cgi?ctype=xml&id=256316)

Closed
[Bug 256316](/show_bug.cgi?id=256316)

Opened 20 years ago
Closed 20 years ago

# non-ascii char in URL lead to heap overrun

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

non-ascii char in URL lead to heap overrun

## Categories

### (Core :: Networking, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking#Networking)

Networking
▾

Core :: Networking
For bugs in Mozilla's modular networking library (aka "Netlib" or "Necko".) The networking library supplies the software interface that Mozilla uses to access physical transports (e.g. the Internet and local drives), perform URL resolutions, and handle a variety of networking protocols.

Examples of appropriate bugs: URLs with backslash not fetched; URLs starting with a single slash turn into http:///; Cannot access authenticated FTP site.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: dveditz, Assigned: darin.moz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/ace1cc2d025e30490cb83b98bd47a94a?d=mm&size=40)  [darin.moz](/user_profile?user_id=20048)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/7df66616ae41bdee44b7fc50762dc156?d=mm&size=40)  [benc](/user_profile?user_id=16246)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=40)  [dveditz](/user_profile?user_id=1689)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[sbb+](/show_bug.cgi?id=256197 "RESOLVED WORKSFORME - Security Bug Bounty: awarded")

Dependency [tree](/showdependencytree.cgi?id=256316&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=256316)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: fixed-aviary1.0, fixed1.7.3, Whiteboard: [sg:fix])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---),
[fixed1.7.3](/buglist.cgi?keywords=fixed1.7.3&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:fix]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [brendan](/user_profile?user_id=1214) | [blocking1.7.5](#c0 "20 years ago") | + |
| --- | --- | --- |
| [brendan](/user_profile?user_id=1214) | blocking1.7.5 | + |
| --- | --- | --- |
| [brendan](/user_profile?user_id=1214) | [blocking-aviary1.0PR](#c6 "20 years ago") | + |
| --- | --- | --- |
| [brendan](/user_profile?user_id=1214) | blocking-aviary1.0PR | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [v1 patch](/attachment.cgi?id=156918)  [20 years ago](#c4)  [Darin Fisher](/user_profile?user_id=20048)   1.05 KB, patch | dveditz : [review+](#c8 "20 years ago")  dveditz : [superreview+](#c8 "20 years ago")  chofmann : [approval-aviary+](#c13 "20 years ago")  chofmann : [approval1.7.5+](#c0 "20 years ago") | [Details](/attachment.cgi?id=156918&action=edit) | [Diff](/attachment.cgi?id=156918&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=256316&attachment=156918) |
| --- | --- | --- |
| [PoC of exploitable heap overflow](/attachment.cgi?id=157348)  [20 years ago](#c17)  [Gaël Delalleau](/user_profile?user_id=151061)   1014 bytes, text/html |  | [Details](/attachment.cgi?id=157348&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=256316#c0)• 20 years ago |
|  | |

The SBB FAQ says :
"However as a special exception we will also consider paying rewards
for bugs found in the most recent releases from designated stable
branches (e.g., from the Mozilla 1.7 branch after 1.8 is released) if
the bugs are not present in the most recent version but were never
recognized and fixed as security bugs."
So I thought you would be interested to know about bugs that were
fixed as standard bugs, but which are actually critical security
bugs.
So I investigated some reported Mozilla crashes and actually found
something very interesting in [bug #254671](/show_bug.cgi?id=254671 "RESOLVED DUPLICATE - crash if click illegal HTTP hyper-link").
After some hours spent in finding the actual cause of the bug, and
finding that it is exploitable, I realised the bug has been discussed
and (should have been) fixed in [bug #250900](/show_bug.cgi?id=250900 "RESOLVED FIXED - nsIBrowserHistory corrupts URI strings [was: crash when a long malformed URL is entered in the Location Bar [@js_CloneFunctionObject]]"). So I am not going to give
detailed technical details about the bug, you can see the discussion
there.
This bug has a very critical security impact which has been missed by
Mozilla developpers. Here is the reason why:
- put a non-ascii character in a long hostname in an url. Ex:
<http://AAAAAAAAAAAAAAèAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA>
- the UTF8 conversion of the hostname is called and fails, but returns
a SUCCESS error code. So the variable approxLen is incremented by
0 instead of strlen(mHost) (this is the bug)
- a buffer is allocated with length approxLen + 32 (which is
too short)
- then mHost is copied into this buffer --> BUFFER OVERFLOW ON THE HEAP
WITH ARBITRARY DATA SUPPLIED IN THE HOSTNAME BY THE ATTACKER
The bug exists on Mozilla 1.7.2 (Linux and Windows), at least
in the version I downloaded from your website 10 days ago.
I verified that on Windows systems, the bug leads to MOV [EAX], ECX
where we control EAX and ECX (0x41414141), which is the common
situation in exploitable heap overflows.
I think all OSes are vulnerable, and that this bug can be exploited
when viewing a website or when clicking on a link in an email.
Cheers
Gael Delalleau

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=256316#c1)• 20 years ago |
|  | |

(this was received Wed, 18 Aug 2004 06:35:44 -0700 (PDT))Blocks: [sbb?](/show_bug.cgi?id=256195 "RESOLVED WORKSFORME - Security Bug Bounty: nominated")Flags: blocking1.7.3?Flags: blocking-aviary1.0PR?Whiteboard: [sg:fix]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=256316#c2)• 20 years ago |
|  | |

The root cause was identified as a buffer overflow by Mats Palmgren in [bug
250900 comment 13](/show_bug.cgi?id=250900#c13 "RESOLVED FIXED - nsIBrowserHistory corrupts URI strings [was: crash when a long malformed URL is entered in the Location Bar [@js_CloneFunctionObject]]"), but Mats' patch was rejected by Darin and ultimately not
addressed in the final patch.
Why?

|  | [Darin Fisher](/user_profile?user_id=20048)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=256316#c3)• 20 years ago |
|  | |

In a nutshell, the function in question expects a UTF-8 string. If it is given
garbage that is not UTF-8, then it should not be expected to work. The eventual
patch for [bug 250900](/show_bug.cgi?id=250900 "RESOLVED FIXED - nsIBrowserHistory corrupts URI strings [was: crash when a long malformed URL is entered in the Location Bar [@js_CloneFunctionObject]]") fixes the callsite to ensure that UTF-8 is always passed.
That patch should be ported to the 1.7 and aviary branches.
That said, I am not against adding some protective measures to either
nsStandardURL or the IDN code. I would prefer to have the IDN code generate a
proper error code in this case. It may also be wise to fix XPConnect so that it
ensures that any data passed through |string| is ASCII. This problem will
continue to come up so long as XPConnect allows non-zero 8-th bit when passing
data through |string| parameters.

|  | [Darin Fisher](/user_profile?user_id=20048)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=256316#c4)• 20 years ago |
|  | |

Attached patch

[v1 patch](attachment.cgi?id=156918&action=diff)
— [Details](attachment.cgi?id=156918&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=256316&attachment=156918)

This patch adds a sanity check for the input argument to
nsIDNService::Normalize.
I don't think this bug should qualify for a bug bounty since the bug would be
fixed by landing the trunk patch on the stable branches. That simply has not
happened yet, and AFAIK there has not been a next release of the stable
branches since 1.8a3 was released. I think the text in the bug bounty FAQ
needs to be revised to clarify how this situation should be handled.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=256316#c5)• 20 years ago |
|  | |

I could only once get a crash with registers that approximated my data, and in
that case it was 0x61616161 which I think was crashing on data from a previous
run (which lowercased the URL). I got a couple other crashes with random
registers that didn't look controlled, and mostly noticed nothing at all.
Would be nice to fix the overrun (especially since the trunk fix didn't protect
against other misusers of nsStandardURL), but I'm not convinced this is exploitable.
Gael: have a better PoC for this?

|  | [Darin Fisher](/user_profile?user_id=20048)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=256316#a356998_20048)• 20 years ago |

[Attachment #156918](/attachment.cgi?id=156918&action=edit "v1 patch") -
Flags: review?(dveditz)

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=256316#c6)• 20 years ago |
|  | |

Plusing bug for 1.7.x and aviary 1.0 -- darin, please request approvals once you
have review. Also, what bug tracks the XPConnect failure to restrict string to
7-bit chars in all cases?
/beFlags: blocking1.7.3?Flags: blocking1.7.3+Flags: blocking-aviary1.0PR?Flags: blocking-aviary1.0PR+

|  | [chris hofmann](/user_profile?user_id=2687) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=256316#a368560_2687)• 20 years ago |

Whiteboard: [sg:fix] → [have patch] [sg:fix]

|  | [Darin Fisher](/user_profile?user_id=20048)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=256316#c7)• 20 years ago |
|  | |

> what bug tracks the XPConnect failure to restrict string to
> 7-bit chars in all cases?
[bug 256785](/show_bug.cgi?id=256785 "RESOLVED INACTIVE - conversion from unicode to |string| should be stricter")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=256316#c8)• 20 years ago |
|  | |

Comment on [attachment 156918](/attachment.cgi?id=156918 "v1 patch") [[details]](/attachment.cgi?id=156918&action=edit "v1 patch") [[diff]](/attachment.cgi?id=156918&action=diff "v1 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=256316&attachment=156918)
v1 patch
r=dveditz
sr=bryner with the comment that NS\_ENSURE\_TRUE() would be better than
NS\_ENSURE\_ARG()
[Attachment #156918](/attachment.cgi?id=156918&action=edit "v1 patch") -
Flags: superreview+
[Attachment #156918](/attachment.cgi?id=156918&action=edit "v1 patch") -
Flags: review?(dveditz)
[Attachment #156918](/attachment.cgi?id=156918&action=edit "v1 patch") -
Flags: review+

|  | [Gaël Delalleau](/user_profile?user_id=151061) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=256316#c9)• 20 years ago |
|  | |

\* About exploitability: I had an URL which always crashes the Mozilla 1.7.2 browser with my data in the usual exploitable spot in ntdll.dll on WinXP SP1, each time I ran it. I am currently on vacations (writing
this comment from my PDA), so I'll be able to provide this PoC only after sunday. I need to double check if the data is filtered in some way, though.
[Anyway, even with a <8 bytes buffer overflow on the heap, with filtered data (only ascii lowercase for instance) it is usually possible to exploit certain OSes. Heap corruption is sometimes very difficult to exploit reliably, but not impossible.]
\* About the Security Bug Bounty: I don't really care about getting a bounty or not for this bug, as long as the decision is consistent with your policy as explained in the FAQ.
I think you may need to improve the FAQ to tell with more details for which bugs you want to award a bounty. Here are some examples the FAQ should address:
- what if I find a security bug in the latest CVS version, but in a line someone just wrote and commited? Maybe 2 days later someone would have noticed the bug and it would never make its way in the public release. Maybe not.
- what if I find a security bug in the current version available on the website, but the bug has been reported in Bugzilla (and maybe even fixed in the CVS) but not as a security bug?
I guess some of the cons of not knowing about the security impact of a bug are: the fix may not be included in the next stable release, the QA testing doesn't focus on security so some holes may stay open, third party sofware based on Mozilla are left vulnerable because they don't backport non-security fixes, the attack is not included in IDS and antivirus/filtering software, the users are not aware of this exploit so they can't keep an eye open for the attack, etc.
Now do you want to give a bounty for this kind of information... that's up to you guys.
So, could you please update this FAQ so that security researchers can focus on what the Mozilla Fundation really needs.

|  | [Darin Fisher](/user_profile?user_id=20048)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=256316#c10)• 20 years ago |
|  | |

Comment on [attachment 156918](/attachment.cgi?id=156918 "v1 patch") [[details]](/attachment.cgi?id=156918&action=edit "v1 patch") [[diff]](/attachment.cgi?id=156918&action=diff "v1 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=256316&attachment=156918)
v1 patch
Requesting approval to land this change on the branches.
[Attachment #156918](/attachment.cgi?id=156918&action=edit "v1 patch") -
Flags: approval1.7.3?
[Attachment #156918](/attachment.cgi?id=156918&action=edit "v1 patch") -
Flags: approval-aviary?

|  | [Darin Fisher](/user_profile?user_id=20048)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=256316#c11)• 20 years ago |
|  | |

> sr=bryner with the comment that NS\_ENSURE\_TRUE() would be better than
> NS\_ENSURE\_ARG()
I can switch to NS\_ENSURE\_TRUE, I guess. NS\_ENSURE\_ARG made sense to me since I
am validating an input argument. Maybe NS\_ENSURE\_TRUE with NS\_ERROR\_UNEXPECTED
would be better? I could do that, sure.

|  | [Darin Fisher](/user_profile?user_id=20048)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=256316#c12)• 20 years ago |
|  | |

fixed-on-trunkStatus: NEW → ASSIGNED

|  | [chris hofmann](/user_profile?user_id=2687) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=256316#c13)• 20 years ago |
|  | |

Comment on [attachment 156918](/attachment.cgi?id=156918 "v1 patch") [[details]](/attachment.cgi?id=156918&action=edit "v1 patch") [[diff]](/attachment.cgi?id=156918&action=diff "v1 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=256316&attachment=156918)
v1 patch
a=chofmann for the branches
[Attachment #156918](/attachment.cgi?id=156918&action=edit "v1 patch") -
Flags: approval1.7.3?
[Attachment #156918](/attachment.cgi?id=156918&action=edit "v1 patch") -
Flags: approval1.7.3+
[Attachment #156918](/attachment.cgi?id=156918&action=edit "v1 patch") -
Flags: approval-aviary?
[Attachment #156918](/attachment.cgi?id=156918&action=edit "v1 patch") -
Flags: approval-aviary+

|  | [Darin Fisher](/user_profile?user_id=20048)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=256316#c14)• 20 years ago |
|  | |

fixed1.7.3, fixed-aviary1.0
marking FIXEDStatus: ASSIGNED → RESOLVEDClosed: 20 years agoKeywords: [fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---),
[fixed1.7.3](/buglist.cgi?keywords=fixed1.7.3&resolution=---)Resolution: --- → FIXED

|  | [Darin Fisher](/user_profile?user_id=20048)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=256316#c15)• 20 years ago |
|  | |

Gaël: As for my comments about the Bug Bounty, you should know that I don't
speak for the Mozilla Foundation. I was simply giving my opinion. I was/am
somewhat confused about how this situation should be handled. That said, I
greatly appreciate you bringing to light the potential security concerns of this
bug.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=256316#c16)• 20 years ago |
|  | |

Fixed on 1.7.2 branchWhiteboard: [have patch] [sg:fix] → [sg:fix] fixed1.7.2+

|  | [Gaël Delalleau](/user_profile?user_id=151061) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=256316#c17)• 20 years ago |
|  | |

Attached file
[PoC of exploitable heap overflow](attachment.cgi?id=157348)
— [Details](attachment.cgi?id=157348&action=edit)

Hi,
This overflow is indeed exploitable. The data supplied by the
attacker is converted to lowercase, but this is not much of a
problem because most non-alpha characters are unmodified.
For instance we can write to addresses in the 0x7FFDxxxx range,
which are commonly used in heap overflow exploits to take
control of the EIP register. (For an overview of these concepts
I suggest reading the slides of the presentation Daniel Litchfield
gave at Black Hat Windows 2004)
Check the attachment for more details and a few PoC links.
For better results, start a new Mozilla 1.7.2 process, open the .htm
file from a local copy stored on your hard disk, and click on the
links. Don't complain too loudly if you get random crashes, this is only
a PoC for a specific system setup (as described in the .htm file) to
prove that the bug is exploitable, but this is not a working exploit,
and I am not using any technique to make exploitation more reliable.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=256316#a2138085_1689)• 20 years ago |

Group: securityWhiteboard: [sg:fix] fixed1.7.2+ → [sg:fix] fixed1.7.3

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=256316#a2181001_1689)• 20 years ago |

Blocks: [sbb+](/show_bug.cgi?id=256197 "RESOLVED WORKSFORME - Security Bug Bounty: awarded")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=256316#a2181114_1689)• 20 years ago |

No longer blocks: [sbb?](/show_bug.cgi?id=256195 "RESOLVED WORKSFORME - Security Bug Bounty: nominated")

|  | [pozouille](/user_profile?user_id=172334) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=256316#c18)• 20 years ago |
|  | |

(In reply to [comment #17](/show_bug.cgi?id=256316#c17 "RESOLVED FIXED - non-ascii char in URL lead to heap overrun"))
Hello may be you will see this, on my computer :)
Alert of intrusion, Black Ice PC Protection
[Unauthorized Access Attempt] This looks for links with nonascii characters
embedded within them. These links could trigger a buffer overflow on some
versions of Mozilla.
Time, Event, Intruder, Count
30/11/2004 00:29:24, HTTP\_Mozilla\_Nonascii\_URL\_BO, sd285.sivit.org, 12=Count
How to remove this vulnerability Jump to the top of this document
For Firefox:
Upgrade to the latest version (1.0PR or later), available from the Mozilla Web
site. See References.
---------------------------------------------------------------------
install.log of Firefox
Start Log: 24/11/2004 - 14:35:52
System Info:
OS Type: NT51
Major Version: 5
Minor Version: 1
Build Number: 2600
Extra String: Service Pack 2
Total Physical Memory: 261616KB
Total Available Physical Memory: 121692KB
Product Info:
Install mode: Normal
Company name: Mozilla
Product name (external): Mozilla Firefox
Product name (internal): Mozilla Firefox
Uninstall Filename: UninstallFirefox.exe
UserAgent: 1.0 (fr-FR)
Alternate search path:
Components corrupted (startup):
none
ة
Destination Path:
Main: C:\Program Files\Mozilla Firefox
SubPath:
Firefox 1.7.5: 2004110812
May be is just The Version of my firefox, but this is 1.0

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=256316#a10820131_1689)• 20 years ago |

Keywords: [fixed1.7.5](/buglist.cgi?keywords=fixed1.7.5&resolution=---) → [fixed1.7.3](/buglist.cgi?keywords=fixed1.7.3&resolution=---)Whiteboard: [sg:fix] fixed1.7.3 → [sg:fix]
You need to [log in](/show_bug.cgi?id=256316&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Darin Fisher](/user_profile?user_id=20048)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


