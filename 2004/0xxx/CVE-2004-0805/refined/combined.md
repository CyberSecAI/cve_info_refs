=== Content from www.debian.org_0a6e0a61_20250124_115528.html ===


---

[[Date Prev](msg00170.html)][[Date Next](msg00172.html)]
[[Thread Prev](msg00170.html)][[Thread Next](msg00172.html)]
[[Date Index](maillist.html#00171)]
[[Thread Index](threads.html#00171)]

# [SECURITY] [DSA 564-1] New mpg123 packages fix arbitrary code exceution

---

* *To*: debian-security-announce@lists.debian.org (Debian Security Announcements)
* *Subject*: [SECURITY] [DSA 564-1] New mpg123 packages fix arbitrary code exceution
* *From*: joey@infodrom.org (Martin Schulze)
* *Date*: Wed, 13 Oct 2004 15:00:34 +0200 (CEST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/m1CHik6-000om6C%40finlandia.Infodrom.North.DE)Â [m1CHik6-000om6C@finlandia.Infodrom.North.DE](msg00171.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 564-1                     security@debian.org
<http://www.debian.org/security/>                             Martin Schulze
October 13th, 2004                      <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : mpg123
Vulnerability  : missing user input sanitising
Problem-Type   : remote
Debian-specific: no
CVE ID         : CAN-2004-0805
License        : non-free

Davide Del Vecchio discovered a vulnerability mpg123, a popular (but
non-free) MPEG layer 1/2/3 audio player.  A malicious MPEG layer 2/3
file could cause the header checks in mpg123 to fail, which could in
turn allow arbitrary code to be executed with the privileges of the
user running mpg123.

For the stable distribution (woody) this problem has been fixed in
version 0.59r-13woody3.

For the unstable distribution (sid) this problem has been fixed in
version 0.59r-16.

We recommend that you upgrade your mpg123 package.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody3.dsc>
      Size/MD5 checksum:      748 77cb64c82c3c07b3c418b4cdb3c7a54e
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody3.diff.gz>
      Size/MD5 checksum:    24192 aae8ca014d465adf9e714e5faef260d0
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r.orig.tar.gz>
      Size/MD5 checksum:   159028 95df59ad1651dd2346d49fafc83747e7

  Alpha architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody3_alpha.deb>
      Size/MD5 checksum:    94482 9ad504920153d01a12d4c7c46e22e73f
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-esd_0.59r-13woody3_alpha.deb>
      Size/MD5 checksum:    94472 2c10a1a915a181c03c814e47785aa695

  ARM architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody3_arm.deb>
      Size/MD5 checksum:    89640 90f1770883e8ead46b951325648ef4be

  Intel IA-32 architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody3_i386.deb>
      Size/MD5 checksum:    81516 bc22febb3dd0bc2967cd850b2827838c
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-esd_0.59r-13woody3_i386.deb>
      Size/MD5 checksum:    81468 4adec8c74c7132a38a1c304ea8ca66d2
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-nas_0.59r-13woody3_i386.deb>
      Size/MD5 checksum:    83502 72463077c7c4238f7ed6e5e1ac5eaeaa
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-oss-3dnow_0.59r-13woody3_i386.deb>
      Size/MD5 checksum:    81186 b4bc8699d4f58657033e0f79c87c652a
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-oss-i486_0.59r-13woody3_i386.deb>
      Size/MD5 checksum:    87740 67f686c50d87051ebacc8a5840f11ca2

  HP Precision architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody3_hppa.deb>
      Size/MD5 checksum:    97336 5c32e4be18d105d6af3ce2f199d27419

  Motorola 680x0 architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody3_m68k.deb>
      Size/MD5 checksum:    75894 a65575a7b5bdf578b13d585036d8276a

  PowerPC architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody3_powerpc.deb>
      Size/MD5 checksum:    88480 4e5d970a0a42cf9a9dd33b6590d33beb
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-esd_0.59r-13woody3_powerpc.deb>
      Size/MD5 checksum:    88406 7289b77111d94d2ed2362739939dd9eb

  Sun Sparc architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody3_sparc.deb>
      Size/MD5 checksum:    88650 9549821e52d23b808acd2702ba139ae0

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)

iD8DBQFBbSbxW5ql+IAeqTIRAsL+AJ98kPs9PAPNl6Q56pOo1NQYTkM1kwCfaa41
kuIY7LAJhBZ7i6huy6M+SlY=
=8mF+
-----END PGP SIGNATURE-----

```

---



=== Content from www.alighieri.org_16113237_20250124_115527.html ===
=======================================================
mpg123-0.59r buffer overflow vulnerability
=======================================================
Davide Del Vecchio Adv#10
Discovered in: 16/08/2003
Date: 06/09/2003
Version affected: mpg123-0.59r and maybe mpg123-0.59s
CVE: CAN-2004-0805
Tested and verified on Linux debian SID and OpenBSD.
The same vulnerable code is also present in the development
version 0.59s, but new and unrelated header checks have prevented the
test case for 0.59r from crashing this version as well. A more
carefully crafted file might hit the vulnerability on 0.59s as well.
It should affect almost every OS with mpg123 package installed.
Description:
mpg123 reads one or more files (or standard input if Â‘Â‘-Â’Â’
is specified) or URLs and plays them on the audio device
(default) or outputs them to stdout.
The problem:
A malicious formatted mp3/2 causes mpg123 to fail header checks,
this may allow arbitrary code to be executed with the privilege
of the user trying to play the mp3. For more informations read
and understand the patch.
Solution:
Author has been contacted with no answer. A patch has been provided
by Daniel Kobras, the Debian mpg123 package mantainer. The patch is
attached at the end of this document.
Credits:
Davide Del Vecchio would like to thank all the people supporting him
and his research, at Telecom Italia S2OC - Security Services Operation Center;
especially Roberto Barbieri "sirius", Marcelo Borges "formica", Matteo Cantoni "goony",
Demetrio Milea and Joy Gian Luigi Savioli.
Daniel Kobras for his help.
I love yellow cats.
Disclaimer:
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition.
There are NO warranties with regard to this information. In no event shall
the author be liable for any damages whatsoever arising out of or in
connection with the use or spread of this information. Any use of this
information is at the user's own risk.
^^^^^^^^
Please send suggestions, updates, and comments to:
Davide Del Vecchio "Dante Alighieri" - dante at alighieri dot org
http://www.alighieri.org http://www.bluejack.it http://www.ezln.it
---[snip]---
Index: layer2.c
===================================================================
RCS file: /home/kobras/cvsroot/debian/mpg123/layer2.c,v
retrieving revision 1.1.1.1
diff -u -r1.1.1.1 layer2.c
--- layer2.c 1999/02/10 12:13:06 1.1.1.1
+++ layer2.c 2004/09/02 21:43:58
@@ -265,6 +265,11 @@
fr->jsbound = (fr->mode == MPG\_MD\_JOINT\_STEREO) ?
(fr->mode\_ext<<2)+4 : fr->II\_sblimit;
+ if (fr->jsbound > fr->II\_sblimit) {
+ fprintf(stderr, "Truncating stereo boundary to sideband limit.\n");
+ fr->jsbound=fr->II\_sblimit;
+ }
+
if(stereo == 1 || single == 3)
single = 0;

=== Content from www.gentoo.org_0e776195_20250124_115528.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# mpg123: Buffer overflow vulnerability â€” GLSA **200409-20**

mpg123 decoding routines contain a buffer overflow bug that might
lead to arbitrary code execution.

### Affected packages

| Package | **media-sound/mpg123** on all architectures |
| --- | --- |
| Affected versions | <= **0.59s-r3** |
| Unaffected versions | >= **0.59s-r4** |

### Background

mpg123 is a MPEG Audio Player.

### Description

mpg123 contains a buffer overflow in the code that handles layer2
decoding of media files.

### Impact

An attacker can possibly exploit this bug with a specially-crafted mp3 or mp2 file
to execute arbitrary code with the permissions of the user running mpg123.

### Workaround

There is no known workaround at this time.

### Resolution

All mpg123 users should upgrade to the latest version:

```
 # emerge sync

 # emerge -pv ">=media-sound/mpg123-0.59s-r4"
 # emerge ">=media-sound/mpg123-0.59s-r4"
```
### References

* [BugTraq Announcement](http://www.securityfocus.com/archive/1/374433/2004-09-05/2004-09-11/0)
* [CAN-2004-0805](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0805)

**Release date**

September 16, 2004

**Latest revision**

September 16, 2004: 01

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [63079](https://bugs.gentoo.org/show_bug.cgi?id=63079)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**


