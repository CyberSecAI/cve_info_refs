=== Content from bugs.gentoo.org_479f8a22_20250126_051510.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 54590
net-ftp/pure-ftpd-1.0.19 fixes DoS when max connections is reached
Last modified: 2011-10-30 22:39:41 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=54590&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=54590&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 54590**](show_bug.cgi?id=54590)
- net-ftp/pure-ftpd-1.0.19 fixes DoS when max connections is reached

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
net-ftp/pure-ftpd-1.0.19 fixes DoS when max connections is reached

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High minor | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://scriptkitchen.com/pureftpd/pur...](http://scriptkitchen.com/pureftpd/pure-ml1.txt) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B3 [glsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2004-06-20 20:46 UTC by Jeremy Kitchen | | --- | --- | | Modified: | 2011-10-30 22:39 UTC ([History](show_activity.cgi?id=54590)) | | CC List: | 3 users (show)  chriswhite grandmasterlinux ppc | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=54590&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=54590&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Jeremy Kitchen    2004-06-20 20:46:34 UTC  ``` as shown in the following two emails to the pure-ftpd mailing list (list@pureftpd.org), there is a denial of service attack possible against pureftpd.  <http://scriptkitchen.com/pureftpd/pure-ml1.txt> <http://scriptkitchen.com/pureftpd/pure-ml2.txt>  (Sorry, I don't know of any mailing list archives that have this, these are from  my server)  Fix: upgrade to 1.0.19.  I'd submit a patch, but there were quite a few changes between the two versions, and I'm not sure which one(s) is(are) applicable.  I don't think this happens in inetd mode (not confirmed), but since gentoo's pure-ftpd uses daemon mode, it applies here.  Not sure if this is the entire thing, but assuming based on what the ChangeLog says, this is a patch that should encompass the change (for backporting purposes, etc)  <http://scriptkitchen.com/pureftpd/pure-ftpd-glsa.patch> I applied it against my pure-ftpd 1.0.18 source with patch -p1, and it built properly and was functional.  Reproducible: Always Steps to Reproduce: ```  [Comment 1](#c1)  Jeremy Kitchen    2004-06-20 20:54:06 UTC  ``` err... duh.  Sorry, I switched gears mid-post and decided to submit a patch, but didn't change the "I'd submit a patch" part.  my bad :) ```  [Comment 2](#c2)  solar (RETIRED)   gentoo-dev  2004-06-20 21:26:04 UTC  ``` raker,  I could not get this one to bump local with the USE=ldap flag or apply the patch.  Not sure if others are having (will have) that problem or not. ```  [Comment 3](#c3)  solar (RETIRED)   gentoo-dev  2004-06-22 13:53:23 UTC  ``` No response from maintainer within the initial 48 hrs, so I'm adding what I have to portage as is. (pure-ftpd-1.0.18-r1.ebuild) KEYWORDS="~x86 ~ppc ~sparc ~alpha ~hppa ~amd64 ~ia64"  QA problems with ldap flag can be handled by another team. ```  [Comment 4](#c4)  Bryan Østergaard (RETIRED)   gentoo-dev  2004-06-23 13:43:41 UTC  ``` Compiled fine on alpha with USE=ldap. Marked stable. ```  [Comment 5](#c5)  Jason Wever (RETIRED)   gentoo-dev  2004-06-23 20:13:53 UTC  ``` Stable on sparc cause we're cool like that :) ```  [Comment 6](#c6)  Thierry Carrez (RETIRED)   gentoo-dev  2004-06-24 14:23:30 UTC  ``` Missing x86, ppc, hppa, ia64 stable on 1.0.18-r1. Removing amd64 as their stable is not needed on this one. ```  [Comment 7](#c7)  SpanKY   gentoo-dev  2004-06-24 16:11:49 UTC  ``` marked x86/hppa stable ```  [Comment 8](#c8)  Aron Griffis (RETIRED)   gentoo-dev  2004-06-24 16:25:01 UTC  ``` all set on ia64 ```  [Comment 9](#c9)  Michael Hanselmann (hansmi) (RETIRED)   gentoo-dev  2004-07-04 10:53:27 UTC  ``` Stable on ppc. ```  [Comment 10](#c10)  Thierry Carrez (RETIRED)   gentoo-dev  2004-07-04 12:47:33 UTC  ``` GLSA 200407-04 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=54590)
* - [XML](show_bug.cgi?ctype=xml&id=54590)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=54590)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=54590&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=54590&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=54590&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.gentoo.org_87de8ce9_20250125_020934.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Pure-FTPd: Potential DoS when maximum connections is reached — GLSA **200407-04**

Pure-FTPd contains a bug potentially allowing a Denial of Service attack
when the maximum number of connections is reached.

### Affected packages

| Package | **net-ftp/pure-ftpd** on all architectures |
| --- | --- |
| Affected versions | <= **1.0.18** |
| Unaffected versions | >= **1.0.18-r1** |

### Background

Pure-FTPd is a fast, production-quality and standards-compliant FTP
server.

### Description

Pure-FTPd contains a bug in the accept\_client function handling the
setup of new connections.

### Impact

When the maximum number of connections is reached an attacker could
exploit this vulnerability to perform a Denial of Service attack.

### Workaround

There is no known workaround at this time. All users are encouraged to
upgrade to the latest available version.

### Resolution

All Pure-FTPd users should upgrade to the latest stable version:

```
 # emerge sync

 # emerge -pv ">=net-ftp/pure-ftpd-1.0.18-r1"
 # emerge ">=net-ftp/pure-ftpd-1.0.18-r1"
```
### References

* [Pure-FTPd website](http://www.pureftpd.org)
* [CVE-2004-0656](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0656)

**Release date**

July 04, 2004

**Latest revision**

May 22, 2006: 02

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [54590](https://bugs.gentoo.org/show_bug.cgi?id=54590)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.pureftpd.org_7308e06e_20250125_020936.html ===

Pure-FTPd

* [Home](/)

* [Pure-FTPd Documentation](/project/pure-ftpd/doc/)
* [Downloading Pure-FTPd](/project/pure-ftpd/download/)
* [Latest news](/project/pure-ftpd/news/)
* [Support](/project/pure-ftpd/support/)

### More

* [Git repository](https://github.com/jedisct1/pure-ftpd/)
* [More software](https://github.com/jedisct1/)
* [DNSCrypt](https://dnscrypt.info)
* [Libhydrogen](https://libhydrogen.org)
* [Libsodium](https://libsodium.org)
* [IP to ASN](https://iptoasn.com)
* [Author's Instagram](https://instagram.com/pretty_simple_images)
* [Author's Twitter](https://twitter.com/jedisct1)
* [Author's blog](https://00f.net)
* [Photography services](http://prettysimpleimages.com)

---

* Clear History

[Download](https://download.pureftpd.org/pub/pure-ftpd/releases/)
[Star](https://github.com/jedisct1/pure-ftpd)
[Fork](https://github.com/jedisct1/pure-ftpd/fork)

Built with  from [Grav](https://getgrav.org)
and [Hugo](https://gohugo.io/)

navigation
# Pure-FTPd

Pure-FTPd is a free (BSD), secure, production-quality and
standard-conformant FTP server. It doesn’t provide useless bells and
whistles, but focuses on efficiency and ease of use. It provides
simple answers to common needs, plus unique useful features for
personal users as well as hosting providers.

![Pure-FTPd, a secure FTP daemon](images/pure-ftpd.png)

## Security first

Pure-FTPd is actively supported, and it was always designed with
security in mind, and the code is always re-audited as new kind of
vulnerabilities are discussed.

The server can run with privilege separation for paranoid security. It
can even run 100% non-root, with its built-in chroot() emulation and
virtual accounts.

Transmission of cleartext passwords and commands can be avoided :
Pure-FTPd has optional support for an SSL/TLS encryption layer using
the OpenSSL library.

## Pure-FTPd works on your server

The same source code compiles and runs on Linux, MacOS, OpenBSD,
NetBSD, DragonflyBSD, FreeBSD, Solaris and derivatives, Tru64, Irix,
HPUX and AIX.

Pre-built binary packages are available for virtually all operating
supported systems.

## Pure-FTPd speaks your language

All server messages are translated in English, German, Romanian,
French, Polish, Spanish, Danish, Dutch, Italian, Brazilian Portuguese,
Slovak, Korean, Swedish, Norwegian, Russian, Traditional Chinese,
Simplified Chinese, Czech, Turkish, Hungarian and Catalan.

It helps your customers understand diagnostics, even when english
isnât their native language.

Messages are in independant files and they can be easily translated to
new languages, or customized.

Transparent conversion of client to filesystem charsets is
implemented, with UTF-8 support.

## An excellent choice for newbies

Beginners can install a Pure-FTPd server in 5 minutes. It can be as
simple as installing the package, typing `pure-ftpd &` andâ¦ thatâs
all. You already have a running server, and clients can start to
connect.

Thereâs no need to review any long and complex configuration file,
where possible mistakes could have security and reliability
implications. Pure-FTPd uses simple command-line switches to enable
the features you need.

You can limit the number of simultaneous users, limit their bandwidth
to avoid starving connection, hide system files (`chroot`), have
upload/download ratios, and moderate new uploads. Custom messages can
be displayed at login-time (even changing fortune files) and when an
user enters a new directory. Also, to avoid your disks being filled
up, you can define a maximal percentage, and new uploads will be
disallowed once this percentage is reached.

The FXP (server-to-server) protocol is implemented. It can be
available for everyone, or only for authenticated users.

Kiddies are using common brute-forcing tools that are trying to
discover hidden directories. Pure-FTPd provides a protection against
this. Anonymous access is secure by default. For instance, users canât
access dot-files (`.bash_history`, `.rhosts`, â¦) unless you explicitly
enable this.

And to watch whoâs doing what, the `pure-ftpwho` command shows a table
with currently active sessions, how much bandwidth is taken by every
user, what files they are uploading or downloading, where they are
coming from, etc.

## High flexibility for ISPs and hosting services

* System accounts can immediately have FTP access. Authentication via PAM modules is also supported. Accounts below an uid (e.g. `< 500` for daemon accounts) can be disallowed.
* All accounts can be easily chrooted by default. For easy administration, a âtrustedâ group with no `chroot` can be defined.
* FTP accounts can be distinct from system accounts, stored in an independant database. Multiple accounts can share the same system id. A built-in indexing database allows very fast lookups. It is sucessfully running with over 1.5 million accounts on the same server. System accounts can be copied to virtual FTP accounts, so that users can have different passwords for shell access and FTP access.
* LDAP authentication is also fully supported. Pure-FTPd was successfully tested with OpenLDAP and iPlanet Directory Server. It uses standard `posixAccounts` classes.
* Built-in secure cryptographic hashes can be used with any LDAP server, even those that are lacking support for these hashes.
* User info can also be centralized in MySQL databases, with or without transactions. All queries are fully customizable, and requests can be built with user names, remote client addresses, local IP addresses and ports. That way, complex hosting rules can be easily implemented, even with multiple virtual servers on the same host, and multiple virtual domains with many users.
* Multiple authentication methods can be chained in any order. For instance, SQL accounts, LDAP directories and system accounts can be used at the same time.
* Custom authentication methods can easily be added. Pure-FTPd supports external authentication modules, and writing a new backend can be as simple as a few lines of shell script.
* Pure-FTPd supports a virtual quota system : accounts can have individual quota (max number of files, max total size) even when they share the same system uid.
* Bandwidth throttling is supported, with distinct settings for upload and download.
* Every user can be assigned individual quota, ratio and bandwidth.
* Every user can be allowed to connect only from a specific range on IP address, or only to its own virtual host.
* Every user can be individually restricted to his home directory or not.
* Every user can be allowed to connect only during configured time-ranges (e.g. only during business hours).
* An anti-warez system prevents users from trading if they found a public-writeable directory. Files owned by the anonymous ftp users canât be downloaded (sysadmin has to moderate them by changing their ownership) . Also, ftp users canât create directories by default to hide files.
* Any external shell script can be called after a successful upload. Virus scanners and database archiveal can easily be set up.
* A maximum concurrent connection from the same IP address can be enforced to avoid bandwidth starvation and denial-of-service attacks.
* Downloads can be disallowed if the system load is too high.
* Directory listings list a parametrable max number of files. Recursive listings are fully supported, with a parametrable maximal depth. So you can provide recursive search to your users without providing any simple denial-of-service.
* The pure-ftpwho command provides real-time reports of whoâs doing what on the FTP server, including bandwidth usage. The result can be a full web page, and the program can also work like a standard CGI program, compatible with any web server. XML and text reports are also available, as well as a compact and easily parsable format for shell scripts.
* Log files are accurate, and they use standard syslog facilities. Additional Apache-like (`CLF`) log files can be produced. They are compatible with all web-statistic software. An extended format called `Stats` is also implemented, and works with advanced third-party FTP statistic software like FTPStats and ModLogAn. FTPStats provides detailed per-user statistics.
* Home directories can be created on-demand. This is especially useful with LDAP and SQL backends : just insert a row in the database, and the account is ready to go. No need to create any directory for that user : it will be automatically created the first time he will log in.
* Multiple virtual FTP servers can be hosted on the same computer, with an independant trusted IP for administration.
* Access to dot-files can be restricted, so that users canât read/write `.ssh` directories, `.bash_history` files, `.rhosts` files, etc.
* Safe permissions are enforced on users home directories. Customers canât disable their accounts by mistake with an insecure âchmod 0 /â command. The âchmodâ command can also be totally disabled.
* Multiple Pure-FTPd servers with different settings can run on the same host without any conflict.
* Pure-FTPd can act as private FTP server and disallow all anonymous connections regardless of the âftpâ system account. With another switch, the server can be anonymous-only, and refuse connections to all shell accounts.
* Symbolic links can be followed when users are chrooted, even when they are pointing out of the chroot jail. This unique feature makes shared content easy to set up.
* Directory aliases can be enabled, to provide shortcuts to common directories.
* Uploads are truely atomic. Web servers will not serve partial images nor broken PHP scripts when the files are being uploaded, even when content is being updated.

## Compatibility with existing specifications, clients and servers

Pure-FTPd has one of the most complete implementation of the FTP protocol specifications. It includes the protocol basics, plus modern extensions like MLST/MLSD (extensible and mirror-safe directory listings).

RFC conformance is great, but in the real-life, there are a lot of buggy clients. Itâs why Pure-FTPd has also workarounds for some versions of popular Windows clients that totally violates the FTP protocol. Pure-FTPd also works with broken home-made clients that donât properly terminate lines.

So if your current setup works with another FTP server, you can safely move to Pure-FTPd without breaking anything or receiving customers complaints: things will work as before for them, and the migration will be transparent.

IPv6 is fully supported. EPSV/EPRT IPv6 protocol extensions are implemented, and every configuration option and logging feature works with IPv4 and IPv6 as well.

Pure-FTPd is the first daemon to implement `ESTA` and `ESTP`. These two commands ensures FTP data connection assurance, in order to increase the protocol-level security.

Firewalling is easy: Pure-FTPd can restrict the port range for passive connections, force the announced IP for masquerading gateways, or disable passive connections to deal with broken port forwarders.


