- **Root cause of vulnerability**: The payShield SPP library, when performing a check on HSM responsiveness, incorrectly returns `Status_OK` for the original command, regardless of the actual status code returned by the HSM. This occurs during an internal health check performed every three minutes.
- **Weaknesses/vulnerabilities present**: The primary vulnerability is that the SPP library masks legitimate error codes with `Status_OK`. This can lead to false-positive verifications, for example a failed PIN verification attempt might be reported as successful.
- **Impact of exploitation**: Exploitation could lead to a bypass of security checks, such as PIN verification, if an attacker is able to flood the application with invalid requests. The attacker may not be able to immediately obtain a valid result, but eventually, within a three minute window, one request would return an OK status, even though it should have failed. This is a time-based vulnerability, so repeated attempts are necessary to take advantage.
- **Attack vectors**: The attack vector is through the payShield SPP library interface by sending a command to the library. The attacker needs to have sole access to the payShield application and needs to send a high volume of requests.
- **Required attacker capabilities/position**: The attacker requires the ability to send commands to the payShield application and flood it with requests. The attacker does not need to be local, but has to have control over the application to call the affected function of the SPP library.