=== Content from www.kb.cert.org_dd3d662c_20250125_091720.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#395670

## FreeBSD fails to limit number of TCP segments held in reassembly queue

#### Vulnerability Note VU#395670

Original Release Date: 2004-03-04 | Last Revised: 2004-03-04

---

### Overview

FreeBSD fails to limit the number of TCP segments held in a reassembly queue which could allow an attacker to exhaust all available memory buffers (mbufs) on the destination system resulting in a denial-of-service condition.

### Description

| The Transmission Control Protocol ([TCP](http://www.ietf.org/rfc/rfc793.txt)) is part of the TCP/IP protocol suite and designed to provide reliable and connection-oriented service. In order to provide reliable service, TCP is designed to process packets that are delivered out of order so that these packets can later be re-assembled to create the entire TCP segment. There is a vulnerability in the way FreeBSD handles out-of-sequence TCP segments. When network packets making up a TCP segment are received out-of-sequence, these packets are held in a reassembly queue on the destination system so that they can be re-ordered and re-assembled. By sending a large number of out-of-sequence TCP packets, an unauthenticated, remote attacker could exhaust all memory buffers (mbufs) on the destination system resulting in a denial-of-service condition. |
| --- |

### Impact

| An unauthenticated, remote attacker could exhaust all memory buffers (mbufs) on the destination system resulting in a denial-of-service condition. |
| --- |

### Solution

| **Upgrade**  According to FreeBSD:*Upgrade to the FreeBSD stable branch (4-STABLE) or to the RELENG\_5\_2, RELENG\_4\_9, or RELENG\_4\_8 security branch dated after the correction date.***Apply Patch**According to FreeBSD:*The following patch has been verified to apply to FreeBSD 4.x and 5.xsystems.a) Download the relevant patch from the location below, and verify thedetached PGP signature using your PGP utility.[FreeBSD 5.2]# fetch* *ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-04:04/tcp52.patch**# fetch* *ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-04:04/tcp52.patch.asc**[FreeBSD 4.8, 4.9]# fetch* *ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-04:04/tcp47.patch**# fetch* *ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-04:04/tcp47.patch.asc**b) Apply the patch.# cd /usr/src# patch < /path/to/patchc) Recompile your kernel as described in<URL:**<http://www.freebsd.org/handbook/kernelconfig.html>**> and reboot thesystem.* |
| --- |

### Vendor Information

395670
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23395670/) to view vendors.**
### [FreeBSD](#DMOA-5WRQWD) Affected

Updated:  March 04, 2004

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Please refer to the FreeBSD Advisory.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* ftp://ftp.freebsd.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-04:04.tcp.asc
* <http://www.idefense.com/application/poi/display?id=78&type=vulnerabilities>
* <https://ialert.idefense.com/KODetails.jhtml?irId=207650>
* <http://www.ietf.org/rfc/rfc793.txt>
### Acknowledgements

This vulnerability was reported by iDEFENSE.

This document was written by Damon Morda.

### Other Information

| **CVE IDs:** | [CVE-2004-0171](http://web.nvd.nist.gov/vuln/detail/CVE-2004-0171) |
| --- | --- |
| **Severity Metric:** | 6.83 |
| **Date Public:** | 2004-02-18 |
| **Date First Published:** | 2004-03-04 |
| **Date Last Updated:** | 2004-03-04 20:08 UTC |
| **Document Revision:** | 26 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


