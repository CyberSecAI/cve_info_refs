Based on the provided content, here's an analysis of CVE-2004-0866:

**Root Cause of Vulnerability:**

The vulnerability stems from how Internet Explorer (and other browsers) handle the `domain` attribute of cookies. Specifically, the issue lies in the browser's insufficient validation of the domain attribute, allowing a malicious website to set a cookie with a broad domain scope that could affect other legitimate sites.

**Weaknesses/Vulnerabilities Present:**

*   **Cross-Domain Cookie Injection:** The core weakness is the ability to inject a cookie into a domain other than the one the user is currently visiting. This occurs when a website sets a cookie with a `domain` attribute that is too broad. For example, `attacker.ltd.uk` setting a cookie with `domain=.ltd.uk`. This vulnerability affects Internet Explorer, Konqueror, and Mozilla.
*   **Insufficient Domain Validation:** Browsers did not strictly enforce the rules for the domain attribute, failing to properly validate the number of dots or the top-level domain.
*   **Lack of strict checking on 2nd level domains:** Internet Explorer did provide some additional protection, by preventing domains with the form `xx.yy` or `x.yy` and also domains of the form `(com|net|mil|org|gov|edu|int).yy` but these were not enough to prevent the vulnerability on all domains, e.g., `.ltd.uk`.

**Impact of Exploitation:**

*   **Session Fixation:** By injecting a cookie, an attacker can fix the user's session ID. When the user subsequently logs into a legitimate site within the compromised domain, they will use the session ID known to the attacker.
*   **Account Compromise:** The attacker, possessing a valid session ID, gains access to the user's account.

**Attack Vectors:**

*   **Enticing user to visit attacker's site:** The attacker needs to lure a user to visit their website, which sets the malicious cookie via a HTTP request.
*   **Cross-site scripting:** An attacker might be able to achieve the same result via XSS vulnerability.

**Required Attacker Capabilities/Position:**

*   **Control of a Domain:** The attacker needs control of a domain that can set a cookie with the vulnerable domain scope (e.g., `attacker.ltd.uk`).
*   **Social Engineering:** The attacker must be able to persuade the user to visit the attacker's website.
*   **No network interception needed:** The cross domain cookie injection does not rely on network interception of traffic.
*   **Session ID knowledge** Attacker must have a way of knowing what the victim's session ID is after the malicious cookie has been injected.

**Additional details:**

The advisory also discusses a "Cross Security Boundary Cookie Injection" vulnerability (CAN-2004-0869 for IE), which involves an attacker intercepting a non-SSL request and injecting a session cookie before the user accesses the site via HTTPS. This issue, although related, is distinct from the primary cross-domain cookie injection flaw of CVE-2004-0866.
The document also mentions that the described vulnerability had been a known issue for some time, and was already being exploited in the wild.