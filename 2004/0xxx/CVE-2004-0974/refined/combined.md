=== Content from www.gentoo.org_374f0b39_20250124_230917.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Netatalk: Insecure tempfile handling in etc2ps.sh — GLSA **200410-25**

The etc2ps.sh script, included in the Netatalk package, is vulnerable to
symlink attacks, potentially allowing a local user to overwrite arbitrary
files with the rights of the user running the utility.

### Affected packages

| Package | **net-fs/netatalk** on all architectures |
| --- | --- |
| Affected versions | < **1.6.4-r1** |
| Unaffected versions | >= **1.6.4-r1** |

### Background

Netatalk is a kernel level implementation of the AppleTalk Protocol Suite,
which allows Unix hosts to act as file, print, and time servers for Apple
computers. It includes several script utilities, including etc2ps.sh.

### Description

The etc2ps.sh script creates temporary files in world-writeable directories
with predictable names.

### Impact

A local attacker could create symbolic links in the temporary files
directory, pointing to a valid file somewhere on the filesystem. When
etc2ps.sh is executed, this would result in the file being overwritten with
the rights of the user running the utility, which could be the root user.

### Workaround

There is no known workaround at this time.

### Resolution

All Netatalk users should upgrade to the latest version:

```
 # emerge sync

 # emerge -pv ">=net-fs/netatalk-1.6.4-r1"
 # emerge ">=net-fs/netatalk-1.6.4-r1"
```
### References

* [CAN-2004-0974](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0974)

**Release date**

October 25, 2004

**Latest revision**

October 25, 2004: 01

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [66370](https://bugs.gentoo.org/show_bug.cgi?id=66370)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


