=== Content from www.kb.cert.org_a5b87448_20250125_081157.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#336446

## OpenCA libCheckSignature function fails to properly verify the signature of certificates

#### Vulnerability Note VU#336446

Original Release Date: 2004-01-19 | Last Revised: 2004-01-22

---

### Overview

OpenCA may accept a signature from a certificate if the certificate's chain is trusted by the chain directory of OpenCA.

### Description

| The [OpenCA PKI Development Project](http://www.openca.org/openca/) is a Certification Authority. A vulnerability exists in the way the libCheckSignature function compares the certificate in the database and the certificate of the signer.  From the OpenCA Security Advisory:*The comparison of the certificate in the database and the certificate of the signer was only performed on base of the serial of the certificate. The design of the function can cause the acceptance**of a signature if the chain of the signature can create a trust relationship to the chain directory of OpenCA and a certificate with a matching serial exists in the used PKI.*See the [OpenCA Security Advisory](http://www.openca.org/news/CAN-2004-0004.txt) for further details. |
| --- |

### Impact

| OpenCA may accept the signature of a certificate if the certificate's chain is trusted by the chain directory of OpenCA. This could allow a certificate from another PKI to authorize operations on the used PKI. |
| --- |

### Solution

| **Upgrade**OpenCA version [0.9.1.7](http://www.openca.org/openca/download-releases.shtml) has been released to address this vulnerability.**Apply Patch**OpenCA has supplied a [patch](http://www.openca.org/news/CAN-2004-0004.txt) which resolves this issue. |
| --- |

### Vendor Information

336446
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23336446/) to view vendors.**
### [OpenCA](#DMOA-5VCMMM) Affected

Updated:  January 19, 2004

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.openca.org/>
* <http://www.openca.org/news/CAN-2004-0004.txt>
* <http://www.secunia.com/advisories/10664/>
### Acknowledgements

Thanks to OpenCA for the information contained in their security advisory. OpenCA credits Alexandru Matei for discovering this vulnerability.

This document was written by Damon Morda.

### Other Information

| **CVE IDs:** | [CVE-2004-0004](http://web.nvd.nist.gov/vuln/detail/CVE-2004-0004) |
| --- | --- |
| **Severity Metric:** | 1.69 |
| **Date Public:** | 2004-01-16 |
| **Date First Published:** | 2004-01-19 |
| **Date Last Updated:** | 2004-01-22 18:45 UTC |
| **Document Revision:** | 16 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from marc.info_6edf884c_20250125_081157.html ===

```
[[prev in list](?l=bugtraq&m=107427391901775&w=2)] [[next in list](?l=bugtraq&m=107427294432694&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [OpenCA Advisory] Vulnerability in signature verification
From:       [Michael Bell <michael.bell () cms ! hu-berlin ! de>](?a=105280788500001&r=1&w=2)
Date:       [2004-01-16 15:04:49](?l=bugtraq&r=1&w=2&b=200401)
Message-ID: [4007FD91.4020003 () cms ! hu-berlin ! de](?i=4007FD91.4020003%20()%20cms%20!%20hu-berlin%20!%20de)
[Download RAW [message](?l=bugtraq&m=107427313700554&q=mbox) or [body](?l=bugtraq&m=107427313700554&q=raw)]

OpenCA Security Advisory [16 January 2004]

Vulnerability in signature validation
=====================================

A flaw in OpenCA before version 0.9.1.7 could cause OpenCA to accept a
signature from a certificate if the certificate's chain is trusted by
the chain directory of OpenCA. This means that a certificate from
another PKI can authorize operations on the used PKI if the chain of the
used signature certifcate can establish a trust relationship to the
actually used PKI.

Alexandru Matei found the bug during a source code verification.
Alexandru Matei and Michael Bell of the OpenCA core team fixed the
problem for OpenCA 0.9.1 and the CVS HEAD.

Vulnerability
-----------------

OpenCA has a library for common crypto operations - crypto-utils.lib.
This library includes a function to check a signature
(libCheckSignature). The function load the used signature certificate
from OpenCA's database and finally ensures that the used signature
certificate is identical with the certificate in the database.

The comparison of the certificate in the database and the certificate
of the signer was only performed on base of the serial of the
certificate. The design of the function can cause the acceptance
of a signature if the chain of the signature can create a
trustrelationship to the chain directory of OpenCA and a certificate
with a matching serial exists in the used PKI.

Who is affected?
------------------

All version of OpenCA including 0.9.1.6. A security risk is present for
people who are using digital signatures to secure approved requests
or role based access control (RBAC).

Recommendations
-----------------

Upgrade to 0.9.1.7 and use newer snapshots than
openca-SNAP-20040114.tar.gz. You can fix the problem by yourself too
with the included patch. The original file which we used to create
the diff is from OpenCA 0.9.1.6.

-----BEGIN PATCH-----
--- src/common/lib/functions/crypto-utils.lib   2004-01-15
12:10:45.000000000 +0100
+++ src/common/lib/functions/crypto-utils.lib.new       2004-01-15
12:10:06.000000000 +0100
@@ -201,7 +201,7 @@
                                                "__ERRVAL__",
$OpenCA::X509::errval);
                         return undef;
                 }
-               last if ( $tmpCert->getSerial() eq $sigCert->getSerial() );
+               last if ( $tmpCert->getPEM() eq $sigCert->getPEM() );
                 $sigCert = undef;
         }

-----END PATCH-----

References
------------

The Common Vulnerabilities and Exposures project (cve.mitre.org) has
assigned the name CAN-2004-0004 to this issue.

<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0004>

URL for this Security Advisory:
<http://www.openca.org/news/CAN-2004-0004.txt>

[[prev in list](?l=bugtraq&m=107427391901775&w=2)] [[next in list](?l=bugtraq&m=107427294432694&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


