=== Content from security.gentoo.org_51590dc4_20250125_071259.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# PHP setting leaks from .htaccess files on virtual hosts — GLSA **200402-01**

If the server configuration "php.ini" file has
"register\_globals = on" and a request is made to one virtual host
(which has "php\_admin\_flag register\_globals off") and the next
request is sent to the another virtual host (which does not have the
setting) global variables may leak and may be used to exploit the
site.

### Affected packages

| Package | **dev-php/mod\_php** on all architectures |
| --- | --- |
| Affected versions | < **4.3.4-r4** |
| Unaffected versions | >= **4.3.4-r4** |

### Background

PHP is a widely-used general-purpose scripting language that is
especially suited for Web development and can be embedded into HTML.

### Description

If the server configuration "php.ini" file has
"register\_globals = on" and a request is made to one virtual host
(which has "php\_admin\_flag register\_globals off") and the next
request is sent to the another virtual host (which does not have the
setting) through the same apache child, the setting will persist.

### Impact

Depending on the server and site, an attacker may be able to exploit
global variables to gain access to reserved areas, such as MySQL passwords,
or this vulnerability may simply cause a lack of functionality. As a
result, users are urged to upgrade their PHP installations.

Gentoo ships PHP with "register\_globals" set to "off"
by default.

This issue affects both servers running Apache 1.x and servers running
Apache 2.x.

### Workaround

No immediate workaround is available; a software upgrade is required.

### Resolution

All users are recommended to upgrade their PHP installation to 4.3.4-r4:

```
 # emerge sync
 # emerge -pv ">=dev-php/mod_php-4.3.4-r4"
 # emerge ">=dev-php/mod_php-4.3.4-r4"
```
### References

* [Corresponding PHP bug](https://bugs.php.net/bug.php?id=25753)

**Release date**

February 07, 2004

**Latest revision**

February 07, 2004: 01

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [39952](https://bugs.gentoo.org/show_bug.cgi?id=39952)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


