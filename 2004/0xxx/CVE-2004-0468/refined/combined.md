=== Content from www.jpcert.or.jp_cb35ff74_20250124_123002.html ===
-----BEGIN PGP SIGNED MESSAGE-----
各位
JPCERT-AT-2004-0009
JPCERT/CC
2004-06-30
<<< JPCERT/CC Alert 2004-06-30 >>>
Juniper JUNOS PFE の IPv6 処理にメモリリークの脆弱性
Juniper JUNOS Packet Forwarding Engine (PFE) IPv6 memory leak
http://www.jpcert.or.jp/at/2004/at040009.txt
I. 概要
Juniper JUNOS Packet Forwarding Engine (PFE) には、ある特定の IPv6
パケットを受信するとメモリリークを起こす脆弱性があります。結果として、
JUNOS が稼動しているルータがサービス運用妨害 (DoS) 攻撃を受ける可能性
があります。
この問題は、Juniper が提供する修正済みの JUNOS に更新することで解決
します。
US-CERT Vulnerability Note VU#658859
Juniper JUNOS Packet Forwarding Engine (PFE) IPv6 memory leak
http://www.kb.cert.org/vuls/id/658859
Juniper Networks PSN-2004-06-009
https://www.juniper.net/alerts/viewalert.jsp?txtAlertNumber=PSN-2004-06-009&actionBtn=Search
(正規登録ユーザのみアクセス可)
II. 対象
2004年2月24日以降にリリースされた全ての JUNOS PFE で、IPv6 パケット
の処理を有効にしている Juniper ルータ。
なお、JUNOS PFE (特に IPv6 の処理部分) は、他のコード (FreeBSD など)
から移植されたものではないので、この問題は JUNOS PFE のみに影響すると
考えられます。
III. 影響
遠隔から第三者が、複数の IPv6 パケットを対象となる Juniper ルータに
送信することで、Juniper ルータは再起動を繰り返します。結果として、サー
ビス運用妨害 (DoS) 攻撃につながります。
IV. 対処方法
2004年6月21日以降にビルドされた JUNOS では、この問題が修正されていま
す。対象となる製品を使用している場合は、JUNOS を修正済みのものに更新す
ることを強くお勧めします。
また、もし IPv6 を使用していない場合は、IPv6 の処理を無効にすること
をご検討ください。
Juniper Networks PSN-2004-06-009
https://www.juniper.net/alerts/viewalert.jsp?txtAlertNumber=PSN-2004-06-009&actionBtn=Search
(正規登録ユーザのみアクセス可)
Requesting Support from Juniper Networks Technical Assistance Center
http://www.juniper.net/support/requesting-support.html
V. 補足
2004年6月29日 (日本時間) 現在、この問題を使った攻撃が実際に行なわれ
ているとの報告はありません。
VI. お知らせ
JPCERT/CC は本件について、米国の CSIRT である CERT/CC とのパートナー
シップのもと、国内外関連組織とのコーディネーションを行いました。
CERT/CC の詳細につきましては以下の URL をご覧ください。
CERT/CC
http://www.cert.org/
今回の件につきまして当方まで提供いただける情報がございましたら、ご連
絡ください。
\_\_\_\_\_\_\_\_\_\_
改訂履歴
2004-06-30 初版
======================================================================
JPCERT コーディネーションセンター (JPCERT/CC)
TEL: 03-3518-4600 FAX: 03-3518-4602
http://www.jpcert.or.jp/
-----BEGIN PGP SIGNATURE-----
Version: 2.6.3ia
Charset: noconv
iQCVAwUBQOIJUYx1ay4slNTtAQHLBgP+Losf4BJsb7KvgQCcypZLVFpsUSf5opwn
ES45iYcjaAbERAH3LgYqzANPCJOkWufzbGYaMNtH8gGURcMlErXe+wGXoovhS0oN
4Dzg8eLz7zfgsWlT9Bcy4NO7A6wQBbkK0pFwyMCJ8VGV0Qc51zwx74NOe0LYydlN
VCEfKinjxwI=
=0Xx+
-----END PGP SIGNATURE-----


=== Content from www.kb.cert.org_b4903be1_20250124_123003.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#658859

## Juniper JUNOS Packet Forwarding Engine (PFE) IPv6 memory leak

#### Vulnerability Note VU#658859

Original Release Date: 2004-06-30 | Last Revised: 2004-06-30

---

### Overview

The Juniper JUNOS Packet Forwarding Engine (PFE) leaks memory when certain IPv6 packets are submitted for processing. If an attacker submits multiple packets to a vulnerable router running IPv6-enabled PFE, the router can be repeatedly rebooted, essentially creating a denial of service for the router.

### Description

| Juniper routers running JUNOS use a Packet Forwarding Engine (PFE) to forward network packets to specified destinations. A memory leak has been found in all JUNOS PFEs released after February 24, 2004. This leak can be triggered under certain specific conditions, which may lead to memory exhaustion on vulnerable JUNOS routers. After memory exhaustion occurs, the system will reboot and resume normal operation. However, repeated attacks may cause vulnerable systems to repeatedly reboot, essentially creating a denial of service.  This issue is thought to affect only the JUNOS PFE. The JUNOS Packet Forwarding Engine (specifically, the IPv6 branch) is not derived from other code (i.e., FreeBSD). |
| --- |

### Impact

| A remote, unauthenticated attacker may cause a Juniper router to repeatedly reboot when multiple IPv6 packets are processed by the JUNOS of a vulnerable system. This would create a denial of service for the router. |
| --- |

### Solution

| Users registered at Juniper's support site should visit <https://www.juniper.net/alerts/viewalert.jsp?txtAlertNumber=PSN-2004-06-009&actionBtn=Search> |
| --- |

| Disable IPv6 processing in the Packet Forwarding Engine. |
| --- |

### Vendor Information

658859
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23658859/) to view vendors.**
### [Juniper Networks](#JSHA-6253CC) Affected

Updated:  June 20, 2004

### Status

Affected

### Vendor Statement

For registered Juniper customers, please see: <https://www.juniper.net/alerts/viewalert.jsp?txtAlertNumber=PSN-2004-06-009&actionBtn=Search>

Number          PSN-2004-06-009
Title   Remotely exploitable ICMPv6 denial-of-service (DoS) attack
(CERT/CC VU#658859)
Products Affected       All Juniper Networks M-series and T-series routing
platforms with IPv6 enabled.
# Platforms Affected    JUNOS 6.x
# Security
Revision Number         1

PSN Issue
When an incoming IPv6 packet requires the router to generate an
ICMPv6 response, the response might not be generated and the buffer
containing the original packet might not be released. Eventually the
Packet Forwarding Engine CPU might exhaust its packet memory and
reboot. This problem exists in all JUNOS Release 6.x software built
on or after February 24, 2004 running on M-series and T-series
routing platforms, and is tracked as PR/48386.

Solution
The JUNOS software has been modified to release the memory occupied
by the original IPv6 packets.

Solution Implementation
All JUNOS software built on or after June 21, 2004 includes the
corrected code. Customers running in an IPv6 environment are strongly
encouraged to upgrade their software to incorporate this correction.
Contact Juniper Networks Technical Assistance Center for availability
and download instructions.

Risk Level - High

Risk Assessment
This remotely exploitable Denial of Service attack vector exists in
all Juniper Networks M-series and T-series routing platforms on which
IPv6 is enabled.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

CERT/CC is tracking this issue as VU#658859. CERT/CC has been notified by Juniper that they are tracking this issue under PR/48386. Please contact the Juniper Technical Assistance Center (JTAC) for more information:

+ <http://www.juniper.net/support/requesting-support.html>
+ mailto:support@juniper.net
+ +1-888-314-JTAC (within the United States, Canada, or Mexico)
+ +1-408-745-9500 (from other countries)

  If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Cisco Systems Inc.](#JSHA-6265VM) Not Affected

Updated:  June 20, 2004

### Status

Not Affected

### Vendor Statement

Not Vulnerable

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <https://www.juniper.net/alerts/viewalert.jsp?txtAlertNumber=PSN-2004-06-009&actionBtn=Search>
* <http://www.juniper.net/support/requesting-support.html>
* <http://www.jpcert.or.jp/at/2004/at040009.txt>
### Acknowledgements

Thanks to Juniper Networks for contributing to this document.

This document was written by Jeffrey S. Havrilla.

### Other Information

| **CVE IDs:** | [CVE-2004-0468](http://web.nvd.nist.gov/vuln/detail/CVE-2004-0468) |
| --- | --- |
| **Severity Metric:** | 15.54 |
| **Date Public:** | 2004-06-29 |
| **Date First Published:** | 2004-06-30 |
| **Date Last Updated:** | 2004-06-30 00:56 UTC |
| **Document Revision:** | 18 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.kb.cert.org_c8e5629a_20250124_123003.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#658859

## Juniper JUNOS Packet Forwarding Engine (PFE) IPv6 memory leak

#### Vulnerability Note VU#658859

Original Release Date: 2004-06-30 | Last Revised: 2004-06-30

---

### Overview

The Juniper JUNOS Packet Forwarding Engine (PFE) leaks memory when certain IPv6 packets are submitted for processing. If an attacker submits multiple packets to a vulnerable router running IPv6-enabled PFE, the router can be repeatedly rebooted, essentially creating a denial of service for the router.

### Description

| Juniper routers running JUNOS use a Packet Forwarding Engine (PFE) to forward network packets to specified destinations. A memory leak has been found in all JUNOS PFEs released after February 24, 2004. This leak can be triggered under certain specific conditions, which may lead to memory exhaustion on vulnerable JUNOS routers. After memory exhaustion occurs, the system will reboot and resume normal operation. However, repeated attacks may cause vulnerable systems to repeatedly reboot, essentially creating a denial of service.  This issue is thought to affect only the JUNOS PFE. The JUNOS Packet Forwarding Engine (specifically, the IPv6 branch) is not derived from other code (i.e., FreeBSD). |
| --- |

### Impact

| A remote, unauthenticated attacker may cause a Juniper router to repeatedly reboot when multiple IPv6 packets are processed by the JUNOS of a vulnerable system. This would create a denial of service for the router. |
| --- |

### Solution

| Users registered at Juniper's support site should visit <https://www.juniper.net/alerts/viewalert.jsp?txtAlertNumber=PSN-2004-06-009&actionBtn=Search> |
| --- |

| Disable IPv6 processing in the Packet Forwarding Engine. |
| --- |

### Vendor Information

658859
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23658859/) to view vendors.**
### [Juniper Networks](#JSHA-6253CC) Affected

Updated:  June 20, 2004

### Status

Affected

### Vendor Statement

For registered Juniper customers, please see: <https://www.juniper.net/alerts/viewalert.jsp?txtAlertNumber=PSN-2004-06-009&actionBtn=Search>

Number          PSN-2004-06-009
Title   Remotely exploitable ICMPv6 denial-of-service (DoS) attack
(CERT/CC VU#658859)
Products Affected       All Juniper Networks M-series and T-series routing
platforms with IPv6 enabled.
# Platforms Affected    JUNOS 6.x
# Security
Revision Number         1

PSN Issue
When an incoming IPv6 packet requires the router to generate an
ICMPv6 response, the response might not be generated and the buffer
containing the original packet might not be released. Eventually the
Packet Forwarding Engine CPU might exhaust its packet memory and
reboot. This problem exists in all JUNOS Release 6.x software built
on or after February 24, 2004 running on M-series and T-series
routing platforms, and is tracked as PR/48386.

Solution
The JUNOS software has been modified to release the memory occupied
by the original IPv6 packets.

Solution Implementation
All JUNOS software built on or after June 21, 2004 includes the
corrected code. Customers running in an IPv6 environment are strongly
encouraged to upgrade their software to incorporate this correction.
Contact Juniper Networks Technical Assistance Center for availability
and download instructions.

Risk Level - High

Risk Assessment
This remotely exploitable Denial of Service attack vector exists in
all Juniper Networks M-series and T-series routing platforms on which
IPv6 is enabled.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

CERT/CC is tracking this issue as VU#658859. CERT/CC has been notified by Juniper that they are tracking this issue under PR/48386. Please contact the Juniper Technical Assistance Center (JTAC) for more information:

+ <http://www.juniper.net/support/requesting-support.html>
+ mailto:support@juniper.net
+ +1-888-314-JTAC (within the United States, Canada, or Mexico)
+ +1-408-745-9500 (from other countries)

  If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Cisco Systems Inc.](#JSHA-6265VM) Not Affected

Updated:  June 20, 2004

### Status

Not Affected

### Vendor Statement

Not Vulnerable

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <https://www.juniper.net/alerts/viewalert.jsp?txtAlertNumber=PSN-2004-06-009&actionBtn=Search>
* <http://www.juniper.net/support/requesting-support.html>
* <http://www.jpcert.or.jp/at/2004/at040009.txt>
### Acknowledgements

Thanks to Juniper Networks for contributing to this document.

This document was written by Jeffrey S. Havrilla.

### Other Information

| **CVE IDs:** | [CVE-2004-0468](http://web.nvd.nist.gov/vuln/detail/CVE-2004-0468) |
| --- | --- |
| **Severity Metric:** | 15.54 |
| **Date Public:** | 2004-06-29 |
| **Date First Published:** | 2004-06-30 |
| **Date Last Updated:** | 2004-06-30 00:56 UTC |
| **Document Revision:** | 18 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


