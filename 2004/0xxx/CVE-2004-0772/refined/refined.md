```
{
  "CVE-2004-0772": {
    "Description": "The MIT Kerberos krb524d daemon does not securely deallocate heap memory when handling an error condition, resulting in a double-free vulnerability. An unauthenticated, remote attacker could execute arbitrary code on a system running krb524d, which in many cases is also a Kerberos Distribution Center (KDC). The compromise of a KDC system can lead to the compromise of an entire Kerberos realm. An attacker may also be able to cause a denial of service on a system running krb524d.",
    "Root cause": "The krb524d daemon, when handling a cross-realm ticket conversion, frees the v5tkt->enc_part2 buffer but does not null the pointer. Subsequently, the do_connection() function calls krb5_free_ticket(), leading to a double-free vulnerability.",
    "Vulnerabilities": [
      "Double-free vulnerability"
    ],
    "Impact": "An unauthenticated remote attacker can execute arbitrary code on a system running krb524d. This could lead to the compromise of an entire Kerberos realm if the system is also a KDC. A denial of service is also possible.",
    "Attack vectors": [
      "Remote, over the network."
    ],
    "Required attacker capabilities": [
      "An attacker needs to send a malicious cross-realm ticket to the krb524d daemon."
    ],
        "Affected Software": [
      "krb524d program from krb5-1.2.8 and later.",
      "krb524d in earlier releases if patched to disable krb4 cross-realm functionality."
        ],
        "More Info": "The vulnerability is triggered during the conversion of a cross-realm ticket where if handle_classic_v4() denies the conversion, v5tkt->enc_part2 is freed but not nulled."
  }
}
```