=== Content from www.vuxml.org_ddd1e4fd_20250124_214841.html ===

[FreeBSD
VuXML: Documenting security issues in FreeBSD and the
FreeBSD Ports Collection](./)
# tnftpd -- remotely exploitable vulnerability

| | Affected packages | | | | | | --- | --- | --- | --- | --- | |  |  | [tnftpd](pkg-tnftpd.html) | < | 20040810 | | 0 | <= | [lukemftpd](pkg-lukemftpd.html) | |  |  | [FreeBSD](pkg-FreeBSD.html) | <= | 4.7 | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

## Details

| VuXML ID | c4b025bb-f05d-11d8-9837-000c41e2cdad |
| --- | --- |
| Discovery | 2004-08-17 |
| Entry | 2004-08-17 |
| Modified | 2016-08-11 |

lukemftpd(8) is an enhanced BSD FTP server produced
within the NetBSD project. The sources for lukemftpd are
shipped with some versions of FreeBSD, however it is not
built or installed by default. The build system option
WANT\_LUKEMFTPD must be set to build and install lukemftpd.
[**NOTE**: An exception is FreeBSD 4.7-RELEASE,
wherein lukemftpd was installed, but not enabled, by
default.]

Przemyslaw Frasunek discovered several vulnerabilities
in lukemftpd arising from races in the out-of-band signal
handling code used to implement the ABOR command. As a
result of these races, the internal state of the FTP server
may be manipulated in unexpected ways.

A remote attacker may be able to cause FTP commands to
be executed with the privileges of the running lukemftpd
process. This may be a low-privilege `ftp' user if the `-r'
command line option is specified, or it may be superuser
privileges if `-r' is \*not\* specified.

## References

| Bugtraq ID | [10967](http://www.securityfocus.com/bid/10967) |
| --- | --- |
| CVE Name | CVE-2004-0794 |
| Message | [412239E7.1070807@freebsd.lublin.pl](http://lists.netsys.com/pipermail/full-disclosure/2004-August/025418.html) |
| URL | ftp://ftp.netbsd.org/pub/NetBSD/security/advisories/NetBSD-SA2004-009.txt.asc |
| URL | <http://cvsweb.netbsd.org/bsdweb.cgi/src/libexec/ftpd/ftpd.c#rev1.158> |

---

Copyright Â© 2003-2005 [Jacques Vidrine and contributors](contributors.html).

Please see the source of this document for full copyright
information.



=== Content from www.debian.org_392ed7d6_20250124_214840.html ===


---

[[Date Prev](msg00155.html)][[Date Next](msg00154.html)]
[[Thread Prev](msg00155.html)][[Thread Next](msg00154.html)]
[[Date Index](maillist.html#00156)]
[[Thread Index](threads.html#00156)]

# [SECURITY] [DSA 551-1] New lukemftpd packages fix arbitrary code execution

---

* *To*: debian-security-announce@lists.debian.org (Debian Security Announcements)
* *Subject*: [SECURITY] [DSA 551-1] New lukemftpd packages fix arbitrary code execution
* *From*: joey@infodrom.org (Martin Schulze)
* *Date*: Tue, 21 Sep 2004 16:30:02 +0200 (CEST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/m1C9lec-000ptwC%40finlandia.Infodrom.North.DE)Â [m1C9lec-000ptwC@finlandia.Infodrom.North.DE](msg00156.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 551-1                     security@debian.org
<http://www.debian.org/security/>                             Martin Schulze
September 21st, 2004                    <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : lukemftpd
Vulnerability  : incorrect internal variable handling
Problem-Type   : remote
Debian-specific: no
CVE ID         : CAN-2004-0794

Przemyslaw Frasunek discovered a vulnerability in tnftpd or lukemftpd
respectively, the enhanced ftp daemon from NetBSD.  An attacker could
utilise this to execute arbitrary code on the server.

For the stable distribution (woody) this problem has been fixed in
version 1.1-1woody2.

For the unstable distribution (sid) this problem has been fixed in
version 1.1-2.2.

We recommend that you upgrade your lukemftpd package.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2.dsc>
      Size/MD5 checksum:      607 06103d9e3c0203ac9683b6d85b0648e8
    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2.diff.gz>
      Size/MD5 checksum:    21428 31c9f38076478a9efca1fb6af1e4da91
    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1.orig.tar.gz>
      Size/MD5 checksum:   162161 66286f1cc17988964c6e224e196c7b94

  Alpha architecture:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2_alpha.deb>
      Size/MD5 checksum:    87198 8a02a98d0a2896249462e30aa990c823

  ARM architecture:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2_arm.deb>
      Size/MD5 checksum:    75226 b61e81a3e2ec0a523bd2022766b63597

  Intel IA-32 architecture:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2_i386.deb>
      Size/MD5 checksum:    70458 a2c736d42b10f7c711f8275b0ab4aa81

  Intel IA-64 architecture:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2_ia64.deb>
      Size/MD5 checksum:   103980 eab48b110d0d2890f0c0e69bbe774a13

  HP Precision architecture:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2_hppa.deb>
      Size/MD5 checksum:    81882 12578b2f1d100a2feda3183548c257ac

  Motorola 680x0 architecture:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2_m68k.deb>
      Size/MD5 checksum:    67132 219fb21073fd97ed01e9726258a9817f

  Big endian MIPS architecture:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2_mips.deb>
      Size/MD5 checksum:    79572 6b0f8dcb732f6fde37ca532ac085ad67

  Little endian MIPS architecture:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2_mipsel.deb>
      Size/MD5 checksum:    79464 714e022877fa3c8349956f89a84b721f

  PowerPC architecture:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2_powerpc.deb>
      Size/MD5 checksum:    75426 0556b5925eb57b3d40cbff7352e3fc0d

  IBM S/390 architecture:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2_s390.deb>
      Size/MD5 checksum:    75448 7d43eff77fb5a4ac0c71b50864438465

  Sun Sparc architecture:

    <http://security.debian.org/pool/updates/main/l/lukemftpd/lukemftpd_1.1-1woody2_sparc.deb>
      Size/MD5 checksum:    77976 67ec7f91ad6e30ac60f1e54b51cb476b

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)

iD8DBQFBUDrpW5ql+IAeqTIRAshbAJ48X3VVUL0bE6puGSOHdeOQTleDagCdFSQP
XBBa79Hde4bWQQJXxcHCXgk=
=jgtG
-----END PGP SIGNATURE-----

```

---


