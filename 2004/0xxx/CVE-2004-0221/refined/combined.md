=== Content from www.openbsd.org_ba0de324_20250124_195943.html ===


OpenBSD: Errata and Patches

## [*Open***BSD**](index.html) Errata and Patches

---

For OpenBSD patch branch information, please refer
[here](stable.html).

For errata on a certain release, click below:

[2.0](errata20.html),
[2.1](errata21.html),
[2.2](errata22.html),
[2.3](errata23.html),
[2.4](errata24.html),
[2.5](errata25.html),
[2.6](errata26.html),
[2.7](errata27.html),
[2.8](errata28.html),
[2.9](errata29.html),
[3.0](errata30.html),
[3.1](errata31.html),
[3.2](errata32.html),
[3.3](errata33.html),
[3.4](errata34.html),
[3.5](errata35.html),

[3.6](errata36.html),
[3.7](errata37.html),
[3.8](errata38.html),
[3.9](errata39.html),
[4.0](errata40.html),
[4.1](errata41.html),
[4.2](errata42.html),
[4.3](errata43.html),
[4.4](errata44.html),
[4.5](errata45.html),
[4.6](errata46.html),
[4.7](errata47.html),
[4.8](errata48.html),
[4.9](errata49.html),
[5.0](errata50.html),
[5.1](errata51.html),

[5.2](errata52.html),
[5.3](errata53.html),
[5.4](errata54.html),
[5.5](errata55.html),
[5.6](errata56.html),
[5.7](errata57.html),
[5.8](errata58.html),
[5.9](errata59.html),
[6.0](errata60.html),
[6.1](errata61.html),
[6.2](errata62.html),
[6.3](errata63.html),
[6.4](errata64.html),
[6.5](errata65.html),
[6.6](errata66.html),
[6.7](errata67.html),

[6.8](errata68.html),
[6.9](errata69.html),
[7.0](errata70.html),
[7.1](errata71.html),
[7.2](errata72.html),
[7.3](errata73.html),
[7.4](errata74.html),
[7.5](errata75.html),
[7.6](errata76.html).



=== Content from www.kb.cert.org_de6ead7d_20250124_195943.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#524497

## isakmpd crashes when handling ISAKMP packets with malformed "Delete Payload"

#### Vulnerability Note VU#524497

Original Release Date: 2004-08-27 | Last Revised: 2004-08-27

---

### Overview

A vulnerability exists in the isakmpd that could allow a remote attacker to cause a denial of service.

### Description

| The OpenBSD [isakmpd](http://www.openbsd.org/cgi-bin/man.cgi?query=isakmpd&apropos=0&sektion=0&manpath=OpenBSD+Current&arch=i386&format=html) establishes security associations for encrypted and authenticated (IPsec) network traffic. It implements the Internet Security Association and Key Management Protocol [(ISAKMP)](http://www.ietf.org/rfc/rfc2408.txt) and Internet Key Exchange [(IKE)](http://www.ietf.org/rfc/rfc2409.txt) protocol. The ISAKMP standard specifies:  The Delete Payload contains a protocol-specific security association identifier that the sender has removed from its security association database and is, therefore, no longer valid. [...] It is possible to send multiple Security Parameter Index(es) (SPIs) in a Delete payload [...]To this end, the format of the "Delete Payload" contains a "# of SPIs" field, specified as two octets. A flaw exists in the way that isakmpd handles malformed ISAKMP packets specifying an overly large number of SPIs for deletion. Such malformed packets could cause isakmpd to read out of bounds and crash. |
| --- |

### Impact

| A remote attacker could cause the isakmpd service to crash. Subsequent IPsec-enabled communications may be disrupted as a result. |
| --- |

### Solution

| **Apply a patch from the vendor**Patches have been released to address this issue. Please see the Systems Affected section of this document for more details. |
| --- |

### Vendor Information

524497
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23524497/) to view vendors.**
### [OpenBSD](#CRDY-642S44) Affected

Updated:  August 20, 2004

### Status

Affected

### Vendor Statement

Several bugs have been found in the ISAKMP daemon which can lead to memory
leaks and a remote denial of service condition. An attacker can craft
malformed payloads that can cause the isakmpd(8) process to stop
processing requests.

The problem is fixed in -current, 3.4-stable and 3.3-stable.

Patches are available at:

  ftp://ftp.openbsd.org/pub/OpenBSD/patches/3.4/common/015\_isakmpd2.patch
  ftp://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/020\_isakmpd2.patch

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

### Acknowledgements

This vulnerability was discovered by Rapid7 using their Striker test suite.

This document was written by Chad R Dougherty based on information published in Rapid7 Advisory R7-0018.

### Other Information

| **CVE IDs:** | [CVE-2004-0221](http://web.nvd.nist.gov/vuln/detail/CVE-2004-0221) |
| --- | --- |
| **Severity Metric:** | 1.69 |
| **Date Public:** | 2004-03-19 |
| **Date First Published:** | 2004-08-27 |
| **Date Last Updated:** | 2004-08-27 13:26 UTC |
| **Document Revision:** | 11 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


