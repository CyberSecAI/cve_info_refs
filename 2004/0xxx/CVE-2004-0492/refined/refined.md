```
{
  "CVE-2004-0492": {
    "description": "Apache Web Server contains a buffer overflow vulnerability in the mod_proxy module that may allow a remote attacker to execute arbitrary code or launch a denial of service (DoS) attack.",
    "vulnerability_details": {
      "root_cause": "The vulnerability is located in the file `proxy_util.c` within the `mod_proxy` module. The `ap_bread` function is called with a size argument calculated as `len - total_bytes_rcvd`, where `len` comes from the `Content-Length` header. If a malicious server sends a negative `Content-Length` header, this calculation can result in a negative size being passed to `ap_bread`. This leads to a heap-based buffer overflow in `memcpy` when `ap_bread` calls `memcpy` internally.",
      "weaknesses": [
        "Buffer Overflow",
        "Improper Input Validation",
	"Heap-based overflow"
      ],
      "impact": "A remote attacker could potentially execute arbitrary code with the privileges of an Apache child process or cause a denial-of-service (DoS) by crashing the Apache server. While Red Hat states that they believe arbitrary code execution is not possible on their platform, other systems could be vulnerable to code execution.",
      "attack_vector": "A remote attacker needs to convince an Apache server with `mod_proxy` enabled to connect to a malicious server. The malicious server will then return an invalid (negative) Content-Length header, triggering the buffer overflow.",
      "attacker_capabilities": "The attacker needs to control a server that an Apache server with `mod_proxy` enabled will connect to as a proxy. The attacker also needs to be able to return an HTTP response with a negative Content-Length header."
    },
        "affected_versions": [
            "Apache versions prior to and including 1.3.31-r2",
	    "Apache httpd 1.3.25 to 1.3.31 inclusive"
        ],
    "patch": "The vulnerability was fixed in Apache httpd 1.3.32-dev. Patches were backported for older versions as well, like 1.3.27 on Red Hat systems."
  }
}
```