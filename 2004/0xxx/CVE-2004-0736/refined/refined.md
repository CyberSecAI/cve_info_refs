- **Root cause of vulnerability**: Multiple vulnerabilities exist in the `/modules/Search/index.php` file of PhpNuke due to insufficient input sanitization and handling of user-supplied parameters.
- **Weaknesses/vulnerabilities present**:
    - **Full path disclosure:** Inputting specific characters (e.g., "**" or "+") into the search field triggers PHP errors, revealing the full server path.
    - **Cross-site scripting (XSS):** Several user-supplied variables (`$sid`, `$max`, `$sel1`-`$sel5`, `$match`, `$mod1`-`$mod3`) are not properly sanitized, allowing injection of arbitrary JavaScript code.
    - **SQL Injection:** 
        - A non-critical SQL injection vulnerability is present through the `$min` variable, which is directly used in the SQL query after `ORDER BY/LIMIT` keywords. This is exploitable in MySQL versions 4.1+.
        - A critical SQL injection vulnerability exists because the `$categ` variable is not initialized when the `$category` variable has a negative value. This allows an attacker to inject arbitrary SQL code via the `$categ` parameter.
- **Impact of exploitation**:
    - **Full path disclosure:** Reveals the server's file system structure, which can aid attackers in further exploits.
    - **XSS:** Allows attackers to execute malicious JavaScript code in the context of the user's browser, potentially leading to session hijacking, data theft, or phishing attacks.
    - **SQL Injection:**
        - The non-critical SQL injection could lead to information disclosure in MySQL 4.1+.
        - The critical SQL injection allows the attacker to directly query the database and potentially access sensitive data (e.g. usernames, passwords).
- **Attack vectors**:
    - **Full path disclosure:** Sending a GET request to the search page with specific characters in the search field.
    - **XSS:** Sending a GET request to the search page with crafted values for the vulnerable variables (`sid`, `max`, etc.).
    - **SQL Injection:** Sending a GET request to the search page with crafted values for the `category` and `categ` parameters.
- **Required attacker capabilities/position**:
    - The attacker needs to be able to send HTTP requests to the vulnerable PhpNuke instance.
    - No specific user authentication is required. The vulnerabilities are directly accessible through the search page.