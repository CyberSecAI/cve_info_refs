```
{
  "cve": "CVE-2004-0642",
  "relevant_content": [
    {
      "source": "www.debian.org_0cc804bd_20250124_224502.html",
      "vulnerability": "A double-free error may allow unauthenticated remote attackers to execute arbitrary code on KDC or clients."
    },
    {
      "source": "www.kb.cert.org_f3299191_20250124_224505.html",
      "vulnerability": "The MIT Kerberos 5 library does not securely deallocate heap memory when decoding ASN.1 structures, resulting in double-free vulnerabilities. An unauthenticated, remote attacker could execute arbitrary code on a KDC server, which could compromise an entire Kerberos realm. An attacker may also be able to execute arbitrary code on Kerberos clients, or cause a denial of service on KDCs or clients.",
      "root_cause": "ASN.1 decoder functions and their callers do not use a consistent set of memory management conventions. The decoders free memory on error conditions but do not null the corresponding pointers, leading to double-free issues when calling functions attempt to free the same memory again.",
       "impact": "An unauthenticated, remote attacker could execute arbitrary code on a KDC server, potentially gaining control of the entire Kerberos realm. An attacker may also be able to execute arbitrary code on Kerberos clients or cause a denial of service on KDCs or clients.",
      "attack_vectors": "Remote, unauthenticated exploitation is possible on the KDC server. An attacker impersonating a legitimate KDC or application server can also exploit clients. ",
        "required_attacker_capabilities": "Ability to send crafted ASN.1 messages to the KDC or Kerberos clients."
    },
    {
      "source": "web.mit.edu_20366c41_20250124_224500.html",
      "vulnerability": "The MIT Kerberos 5 implementation's Key Distribution Center (KDC) program contains a double-free vulnerability that potentially allows a remote attacker to execute arbitrary code. Additionally, double-free vulnerabilities exist in MIT Kerberos 5 library code, making client programs and application servers vulnerable.",
      "root_cause": "ASN.1 decoder functions free memory on error conditions but do not null corresponding pointers. The calling functions have error handling code that frees memory allocated by the ASN.1 decoders if pointers are non-null. This can cause double-free vulnerabilities.",
      "impact": "A remote unauthenticated attacker can potentially execute arbitrary code on a KDC host compromising entire kerberos realm. A remote attacker can also potentially execute arbitrary code on a client while authenticating with a KDC or application server. Vulnerable services can also be exploited by an authenticated attacker.",
      "affected_software": "KDC software and client code from all releases of MIT Kerberos 5 up to and including krb5-1.3.4, and applications calling the krb5_rd_cred() function in releases prior to krb5-1.3.2"
    },
        {
      "source": "marc.info_e7f7feb2_20250124_224458.html",
      "vulnerability": "Multiple double-free issues in the KDC and libraries, leading to potential arbitrary code execution. Also a denial of service vulnerability in the ASN.1 decoder.",
         "impact": "Arbitrary code execution and denial of service",
      "affected_packages": "kerberos <= 1.3.4-20040730 (OpenPKG CURRENT), kerberos <= 1.3.4-2.1.0 (OpenPKG 2.1), kerberos <= 1.3.1-2.0.1 (OpenPKG 2.0)"
    },
    {
      "source": "www.gentoo.org_bc8a23c7_20250124_224504.html",
      "vulnerability": "MIT krb5 contains several double-free vulnerabilities, potentially allowing the execution of arbitrary code, as well as a denial of service vulnerability.",
      "root_cause": "Double-free vulnerabilities in the Key Distribution Center (KDC) and the MIT krb5 library, and a denial of service vulnerability in the ASN.1 decoder.",
      "impact": "Arbitrary code execution on KDC hosts, hosts running krb524d, or vulnerable services, potentially compromising the entire Kerberos realm. An attacker impersonating a legitimate KDC or application server can potentially execute arbitrary code on authenticating clients. Denial of service can be caused for a KDC, application server, or clients.",
       "affected_packages": "app-crypt/mit-krb5 < 1.3.4"
    },
     {
      "source": "rhn.redhat.com_2c7cd5c5_20250124_224500.html",
       "vulnerability": "Several double-free bugs were found in the Kerberos 5 KDC and libraries. A remote attacker could potentially exploit these flaws to execute arbitrary code.",
        "impact": "Remote arbitrary code execution",
      "affected_products": "Red Hat Enterprise Linux Server 3, Workstation 3, Desktop 3 and Red Hat Enterprise Linux for IBM z Systems 3 and for Power, big endian 3"
    }
  ]
}
```