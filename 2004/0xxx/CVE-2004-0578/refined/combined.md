=== Content from marc.info_600e55c0_20250125_002630.html ===

```
[[prev in list](?l=full-disclosure&m=108872452405974&w=2)] [[next in list](?l=full-disclosure&m=108872468831175&w=2)] [[prev in thread](?l=full-disclosure&m=108803297324626&w=2)] [[next in thread](?l=full-disclosure&m=108933702428037&w=2)]
List:       [full-disclosure](?l=full-disclosure&r=1&w=2)
Subject:    [[Full-Disclosure] iDEFENSE Security Advisory 07.01.04: WinGate Information Disclosure](?t=102965278800043&r=1&w=2)
From:       [idlabs-advisories () idefense ! com](?a=107789811800005&r=1&w=2)
Date:       [2004-07-01 20:29:45](?l=full-disclosure&r=1&w=2&b=200407)
Message-ID: [FB24803D1DF2A34FA59FC157B77C970502D6858A () idserv04 ! idef ! com](?i=FB24803D1DF2A34FA59FC157B77C970502D6858A%20()%20idserv04%20!%20idef%20!%20com)
[Download RAW [message](?l=full-disclosure&m=108872788123695&q=mbox) or [body](?l=full-disclosure&m=108872788123695&q=raw)]

WinGate Information Disclosure Vulnerability

iDEFENSE Security Advisory 07.01.04
[www.idefense.com/application/poi/display?id=113&type=vulnerabilities](http://www.idefense.com/application/poi/display?id=113&type=vulnerabilities)
July 01, 2004

I. BACKGROUND

WinGate is an Internet sharing and proxy application that allows for
monitoring and remote administration. More information is available at
<http://www.wingate.com/product-wingate.php>

II. DESCRIPTION

Remote exploitation of an input validation vulnerability in Qbik WinGate
allows attackers to retrieve arbitrary system files.

WinGate authenticates proxy users via a Java applet served through a
built-in web server. The following request causes the server to retrieve
a file from its root directory which is equivalent to the install
directory:

    <http://wingate.example.com/wingate-internal/filename>

It is possible to retrieve arbitrary files outside the context of the
root directory by preceding the path with an extra slash in the case of
WinGate 5 and two extra slashes in the case of WinGate 6. For example:

    <http://wingate5.example.com/wingate-internal//path>
    <http://wingate6.example.com/wingate-internal///path>

III. ANALYSIS

Successful exploitation allows unauthenticated remote attackers to
retrieve the contents of arbitrary files. WinGate, by default, runs
under the context of localsystem allowing for the retrieval of backup
Windows SAM files.

IV. DETECTION

iDEFENSE has confirmed that WinGate version 5.2.3 build 901 and version
6.0 beta 2 build 942 are vulnerable. Version 5.0.5 is also reported as
vulnerable. It is suspected that earlier versions are vulnerable as
well.

V. WORKAROUND

Disable the WWW Proxy server.

VI. VENDOR RESPONSE

"In general people don't bind their WWW Proxy to external interfaces, so

this exploit is generally not available from the internet.  However it
does seem to bypass local LAN security."

WinGate beta 3 (build 959) addresses the vulnerabilities and is
available for download at:

<http://www.wingate.com/download.php>

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
names CAN-2004-0577 and CAN-2004-0578 to these issues. This is a
candidate for inclusion in the CVE list (<http://cve.mitre.org>), which
standardizes names for security problems.

VIII. DISCLOSURE TIMELINE

09/27/03   Exploit acquired by iDEFENSE
06/04/04   Initial vendor notification
06/10/04   Secondary vendor notification
06/21/04   iDEFENSE clients notified
06/23/04   Initial vendor response
07/01/04   Public Disclosure

IX. CREDIT

An anonymous contributor is credited with discovering this
vulnerability.

Get paid for vulnerability research
<http://www.idefense.com/poi/teams/vcp.jsp>

X. LEGAL NOTICES

Copyright (c) 2004 iDEFENSE, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDEFENSE. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@idefense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.netsys.com/full-disclosure-charter.html>
[[prev in list](?l=full-disclosure&m=108872452405974&w=2)] [[next in list](?l=full-disclosure&m=108872468831175&w=2)] [[prev in thread](?l=full-disclosure&m=108803297324626&w=2)] [[next in thread](?l=full-disclosure&m=108933702428037&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


