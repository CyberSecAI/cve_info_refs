## CVE-2004-0549

The provided documents describe a vulnerability related to **CVE-2004-0549**, a navigation method cross-domain vulnerability in Microsoft Internet Explorer.

Here's a breakdown of the vulnerability based on the provided information:

**Root Cause:**

*   The vulnerability stems from how Internet Explorer handles navigation methods and validates the security context of a frame that has been redirected by a web server. Specifically, IE is vulnerable to a cross-domain violation involving a race condition, frames, and possibly the `execScript` method.

**Vulnerability:**

*   **Cross-Domain Security Model Violation:** Internet Explorer's cross-domain security model is intended to prevent browser frames from different sources from interfering with each other. This vulnerability allows an attacker to bypass this security model.
*   **HTTP Redirection:** A web server can respond to an HTTP request with a 300-series status code, redirecting the request to a different URL. The vulnerability occurs when a delayed 300 response specifies a URL pointing to a local resource (Local Machine Zone).
*   **Modal Dialogs:** The `showModalDialog` method creates a modal dialog box that retains input focus. The vulnerability arises because, after an HTTP redirect, a modal dialog box called from the frame before the redirect returns a cached reference to the frame's *original* domain. IE then incorrectly uses this cached domain to determine the security domain of the modal dialog.
*   **Script Execution in Local Machine Zone:** By redirecting to a local resource, controlling the timing of the redirect, and setting the frame's location to a `javascript:` protocol URL, an attacker can execute script within the security context of the Local Machine Zone.

**Impact:**

*   **Remote Code Execution:** An attacker who successfully exploits this vulnerability can execute arbitrary code with the privileges of the user running Internet Explorer.
*   **Complete System Control:** If the user is logged in with administrative privileges, the attacker could gain complete control of the affected system, including installing programs, viewing/changing/deleting data, and creating new accounts with full privileges.

**Attack Vector:**

*   **Web-Based Attack:** An attacker would host a malicious web page designed to exploit the vulnerability.
*   **HTML Email:** An attacker could create a malicious HTML email.
*   **User Interaction:** The attacker needs to entice the user to visit the malicious web page or view the HTML email. This could be achieved by tricking the user into clicking a link.

**Attacker Capabilities:**

*   Ability to host a web server or send HTML emails.
*   Knowledge of how to craft malicious web pages or HTML emails that exploit the vulnerability.
*   Ability to control the timing of HTTP redirects.

**Affected Systems:**

*   Microsoft Internet Explorer 5.5 SP2 and 6, particularly on older operating systems such as Windows 98, ME, NT 4.0, 2000, and XP.
*   Any program that hosts the WebBrowser ActiveX control or uses the IE HTML rendering engine (MSHTML) may be affected.
*   Internet Explorer 6 for Windows Server 2003 (including 64-bit Edition) is considered to have *Moderate* severity due to the Enhanced Security Configuration.