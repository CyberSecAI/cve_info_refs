```
{
  "vulnerability": {
    "root_cause": "The `sprintf` function in `lhext.c` is used without proper bounds checking when extracting files from a LHa archive.",
    "weaknesses": [
      "Buffer Overflow",
      "Lack of input validation"
    ],
    "impact": "An attacker can cause a buffer overflow and potentially execute arbitrary code by providing a crafted command line argument or archive with overly long directory paths.",
    "attack_vectors": [
      "Crafted command line arguments",
      "Crafted LHa archive files"
    ],
    "required_attacker_capabilities": "An attacker needs to be able to provide a crafted LHa archive or a crafted command line argument to trigger the overflow. This could be done locally or remotely if the application is processing external input. "
  },
  "additional_details": "The vulnerability occurs in the `extract_one` function within the `lhext.c` file. The code uses `sprintf` to construct a file path by concatenating the `extract_directory` and filename `q`. If the combined length exceeds the buffer `name`, a buffer overflow occurs. The size of `name` is 257 bytes and the size of `q` is 256 bytes, if `extract_directory` is also long, this overflow may occur. The fix uses `snprintf` and `strncpy` to prevent overflowing the buffer."
}
```