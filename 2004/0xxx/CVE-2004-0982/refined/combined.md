=== Content from www.debian.org_4c561abc_20250126_003725.html ===


---

[[Date Prev](msg00186.html)][[Date Next](msg00188.html)]
[[Thread Prev](msg00186.html)][[Thread Next](msg00188.html)]
[[Date Index](maillist.html#00187)]
[[Thread Index](threads.html#00187)]

# [SECURITY] [DSA 578-1] New mpg123 packages fix arbitrary code execution

---

* *To*: debian-security-announce@lists.debian.org (Debian Security Announcements)
* *Subject*: [SECURITY] [DSA 578-1] New mpg123 packages fix arbitrary code execution
* *From*: joey@infodrom.org (Martin Schulze)
* *Date*: Mon, 1 Nov 2004 14:33:16 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/m1COcJA-000pwZC%40finlandia.Infodrom.North.DE)Â [m1COcJA-000pwZC@finlandia.Infodrom.North.DE](msg00187.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 578-1                     security@debian.org
<http://www.debian.org/security/>                             Martin Schulze
November 1st, 2004                      <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : mpg123
Vulnerability  : buffer overflow
Problem-Type   : remote
Debian-specific: no
CVE ID         : CAN-2004-0982

Carlos Barros has discovered a buffer overflow in the HTTP
authentication routine of mpg123, a popular (but non-free) MPEG layer
1/2/3 audio player.  If a user opened a malicious playlist or URL, an
attacker might execute arbitrary code with the rights of the calling
user.

For the stable distribution (woody) this problem has been fixed in
version 0.59r-13woody4.

For the unstable distribution (sid) this problem has been fixed in
version 0.59r-17.

We recommend that you upgrade your mpg123 package.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody4.dsc>
      Size/MD5 checksum:      748 386de2941605795a833ccdddf200f26b
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody4.diff.gz>
      Size/MD5 checksum:    24568 bf98712baa4bb429768762ea9c20404a
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r.orig.tar.gz>
      Size/MD5 checksum:   159028 95df59ad1651dd2346d49fafc83747e7

  Alpha architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody4_alpha.deb>
      Size/MD5 checksum:    94630 18738b85cf26807ea4d29b1c82767d63
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-esd_0.59r-13woody4_alpha.deb>
      Size/MD5 checksum:    94590 f550ba5af79ae1bf5f8024178c391e0c

  ARM architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody4_arm.deb>
      Size/MD5 checksum:    89708 6b5bc7522cf6e91c7ec21662f8809bc3

  Intel IA-32 architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody4_i386.deb>
      Size/MD5 checksum:    81688 9c5fb2322632dc72d64e18ec404abad8
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-esd_0.59r-13woody4_i386.deb>
      Size/MD5 checksum:    81642 a06e8185f9b0da320ab46c348e55be5a
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-nas_0.59r-13woody4_i386.deb>
      Size/MD5 checksum:    83626 a00b78f948d8967ec23cb2874847f638
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-oss-3dnow_0.59r-13woody4_i386.deb>
      Size/MD5 checksum:    81334 204b7db5b537d81741f04dee9bf80a40
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-oss-i486_0.59r-13woody4_i386.deb>
      Size/MD5 checksum:    87940 0c9d0b30b8a832f30de5cc3d29c321b0

  HP Precision architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody4_hppa.deb>
      Size/MD5 checksum:    97516 428e9dd2c7805424976c82f7aa37e54b

  Motorola 680x0 architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody4_m68k.deb>
      Size/MD5 checksum:    75998 b08ad56ec624c0f8a3624596cef423ea

  PowerPC architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody4_powerpc.deb>
      Size/MD5 checksum:    88528 442b5e1d2462121fcfb1c4eda82429f3
    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123-esd_0.59r-13woody4_powerpc.deb>
      Size/MD5 checksum:    88448 d885597a3cb24ae2d92309def283ab5b

  Sun Sparc architecture:

    <http://security.debian.org/pool/updates/non-free/m/mpg123/mpg123_0.59r-13woody4_sparc.deb>
      Size/MD5 checksum:    88776 b905ba3b69cc2196cc9d84ddefb9b16b

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)

iD8DBQFBhjsbW5ql+IAeqTIRApHrAJ4m83ekW9Gm+H/Ke4sp+RMASjwjbwCfYUU1
ro+9qiQHpADqYb3mbusTkg8=
=YBAn
-----END PGP SIGNATURE-----

```

---



=== Content from marc.info_a6366cb3_20250126_003724.html ===

```
[[prev in list](?l=bugtraq&m=109831588200065&w=2)] [[next in list](?l=bugtraq&m=109830296130857&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    mpg123 "getauthfromurl" buffer overflow
From:       [Carlos Barros <barros () barrossecurity ! com>](?a=109834812600010&r=1&w=2)
Date:       [2004-10-20 3:19:42](?l=bugtraq&r=1&w=2&b=200410)
Message-ID: [200410200119.42801.barros () barrossecurity ! com](?i=200410200119.42801.barros%20()%20barrossecurity%20!%20com)
[Download RAW [message](?l=bugtraq&m=109834486312407&q=mbox) or [body](?l=bugtraq&m=109834486312407&q=raw)]

                      *******************************
                      * Security Advisory #01, 2004 *
                      *******************************
             Carlos Barros <barros [at] barrossecurity d0t com>
                          [www.barrossecurity.com](http://www.barrossecurity.com)
******************************************************************************

Title: mpg123 buffer overflows

Vulnerable package(s):
 * mpg123-pre0.59s;
 * mpg123-0.59r.

Date: 08/10/2004

Legal notice:

This Advisory is Copyright (c) 2004 Carlos Barros.
Permission is granted for the redistribution of this alert electronically. It
may not be edited in any way without the express written consent of the
author.

Disclaimer:

The information in the advisory is believed to be accurate at the time of
publishing based on currently available information. Use of the information
constitutes acceptance for use in an AS IS condition. There are no warranties
with regard to this information. Neither the author nor the publisher accepts
any liability for any direct, indirect, or consequential loss or damage
arising from use of, or reliance on, this information.

Introduction:

mpg123 is a real time MPEG Audio Player for Layer 1,2 and Layer3. It can be
downloaded at: [www.mpg123.de](http://www.mpg123.de)

Vulnerability details:

mpg123 is prone to a buffer overflow in the function getauthfromURL.

// httpget.c, line 114
int getauthfromURL(char *url,char *auth)
{
  char *pos;

  *auth = 0;

  if (!(strncmp(url, "http://", 7)))
    url += 7;

  if( (pos = strchr(url,'@')) ) {
    int i;
    for(i=0;i<pos-url;i++) {
      if( url[i] == '/' )
         return 0;
    }
    strncpy(auth,url,pos-url);  <-- HERE
    auth[pos-url] = 0;
    strcpy(url,pos+1);
    return 1;
  }
  return 0;
}

This function is called by http_open(), line 225 from httpget.c, and passes
"purl" and "httpauth1" as parameters. purl is a dinamic allocated variable
and httpauth1 is a static (global) var with a fixed length of 256. As you
can see, getauthfromURL function copies the purl string, until a @, into
httpauth1 without checking the length. I was not able to exploit this vuln
successfull to execute arbitraty code (too lazy), but I think it is not
impossible. httpauth1 can overwrite some useful address and it is appended
into a dinamic allocated variable (request) after a base64 encoding,
overflowing this var too.

if (strlen(httpauth1) || httpauth) {
  char buf[1023];
  strcat (request,"Authorization: Basic ");
  if(strlen(httpauth1))
    encode64(httpauth1,buf);
  else
    encode64(httpauth,buf);
  strcat (request,buf); <-- HERE
  strcat (request,"\r\n");
}

This vulnerability can be trigged locally via
 mpg123 -@ <http://AAAAAAAAAAAAAA...AAAAA@www.somesite.com/somefile.xxx>,
or remotely via crafted playlist with some file formatted as shown above.

There is another buffer overflow in the function http_open. At line 245 of
httpget.c,the prgName variable (mpg123 filename) is appended into the request
variable.

  sprintf (request + strlen(request),
     " HTTP/1.0\r\nUser-Agent: %s/%s\r\n",
     prgName, prgVersion);

The length of this variable is not checked, so, one can create a
specially crafted symlink to overflow the request variable. It is not a
serious bug cause it can be only exploited locally and mpg123 is not SUID by
default.

Timeline:

02/10/2004: Vulnerability detected.
10/10/2004: Vendor contacted. No response.
20/10/2004: Public available

******************************************************************************
[[prev in list](?l=bugtraq&m=109831588200065&w=2)] [[next in list](?l=bugtraq&m=109830296130857&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
AddÂ aÂ list |
SponsoredÂ byÂ [KoreLogic](http://www.korelogic.com/)



=== Content from bugs.gentoo.org_4f4b4c17_20250126_130932.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla â€“ BugÂ 683
Need support for alternative URIs in SRC\_URI
Last modified: 2011-10-30 22:21:53 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)â€“[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [NewÂ Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=683&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=683&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**BugÂ 683**](show_bug.cgi?id=683)
- Need support for alternative URIs in SRC\_URI

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Need support for alternative URIs in SRC\_URI

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Portage Development | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Portage Development "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Unclassified ([show other bugs](buglist.cgi?component=Unclassified&product=Portage%20Development&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86 Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High enhancement | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Daniel Robbins (RETIRED) | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2002-02-13 10:32 UTC by Arcady Genkin | | --- | --- | | Modified: | 2011-10-30 22:21 UTC ([History](show_activity.cgi?id=683)) | | CC List: | 0 users | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=683&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=683&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Arcady Genkin    2002-02-13 10:32:04 UTC  ``` The ebuild files should allow specifying multiple mirrors for pulling the sources.  For example, in the case of net-mail/tmda, the software maintainer usually keeps only the latest release in foo.bar/releases/.  As soon as the next release comes out, the previous one is moved into foo.bar/old/.  This means that until the .ebuild is updated for the new release, it will contain an invalid URI for the sources.  Given that currently SRC_URI treats a list of URIs as multiple files, that need to be downloaded to build the package, implementing this feature would not be too easy.  As as starting point, I propose adding optional alternate URIs in variables SRC_URI[1-9].  This will limit the number of supported backups to 9, but I think that this is *way* more than enough. ```  [Comment 1](#c1)  Daniel Robbins (RETIRED)   gentoo-dev  2002-02-13 15:31:14 UTC  ``` Can't you just list *both* possible URIs in SRC_URI?  The downloader should try them both in succession. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=683)
* -Â [XML](show_bug.cgi?ctype=xml&id=683)
* -Â [Clone This Bug](enter_bug.cgi?cloned_bug_id=683)
* -Â [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=683&product=Portage%20Development)
* -Â Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)â€“[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [NewÂ Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=683&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=683&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.gentoo.org_1044666b_20250126_003726.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# mpg123: Buffer overflow vulnerabilities â€” GLSA **200410-27**

Buffer overflow vulnerabilities have been found in mpg123 which could lead
to execution of arbitrary code.

### Affected packages

| Package | **media-sound/mpg123** on all architectures |
| --- | --- |
| Affected versions | < **0.59s-r5** |
| Unaffected versions | >= **0.59s-r5** |

### Background

mpg123 is a MPEG Audio Player.

### Description

Buffer overflow vulnerabilities in the getauthfromURL() and http\_open()
functions have been reported by Carlos Barros. Additionally, the Gentoo
Linux Sound Team fixed additional boundary checks which were found to
be lacking.

### Impact

By enticing a user to open a malicious playlist or URL or making use of
a specially-crafted symlink, an attacker could possibly execute
arbitrary code with the rights of the user running mpg123.

### Workaround

There is no known workaround at this time.

### Resolution

All mpg123 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-sound/mpg123-0.59s-r5"
```
### References

* [Security Advisory by Carlos Barros](http://www.barrossecurity.com/advisories/mpg123_getauthfromurl_bof_advisory.txt)
* [CVE-2004-0982](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0982)

**Release date**

October 27, 2004

**Latest revision**

May 22, 2006: 02

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [68343](https://bugs.gentoo.org/show_bug.cgi?id=68343)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**


