=== Content from www.kb.cert.org_1bdcf8e2_20250124_144047.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#873334

## Check Point ISAKMP vulnerable to buffer overflow via Certificate Request

#### Vulnerability Note VU#873334

Original Release Date: 2004-02-05 | Last Revised: 2004-02-12

---

### Overview

A buffer overflow vulnerability exists in the Internet Security Association and Key Management Protocol (ISAKMP) implementation used in Check Point VPN-1, SecuRemote, and SecureClient products. An unauthenticated, remote attacker could execute arbitrary code with the privileges of the ISAKMP process, typically root or SYSTEM.

### Description

| ISAKMP ([RFC 2408](http://www.ietf.org/rfc/rfc2408.txt)) defines a framework for authentication, key management, and the negotiation of Security Associations (SAs). The Internet Key Exchange protocol (IKE, [RFC 2049](http://www.ietf.org/rfc/rfc2409.txt)) operates within the framework of ISAKMP and uses parts of Oakley ([RFC 2412](http://www.ietf.org/rfc/rfc2412.txt)) and SKEME to negotiate and provide cryptographic key exchange for ISAKMP SAs. ISAKMP/IKE is commonly used by IPSec-based virtual private networks (VPNs).  The ISAKMP implementation used in the Check Point VPN server (VPN-1) and clients (SecuRemote, SecureClient) does not adequately validate Certificate Request payloads. As a result, a specially crafted ISAKMP packet could overflow a static memory buffer, writing arbitrary data on the stack. |
| --- |

### Impact

| An attacker who is able to send a UDP packet to the ISAKMP service (500/udp) could execute arbitrary code with the privileges of the VPN process, typically root or SYSTEM. No authentication is required to exploit this vulnerability. |
| --- |

### Solution

| **Upgrade**This issue is resolved in Firewall-1/VPN-1 versions NG FP2 (released in April 2002) and 4.1 SP6 (June 2002). For further information, please see the Check Point [ISAKMP Alert](http://www.checkpoint.com/techsupport/alerts/41_isakmp.html). |
| --- |

| **Check Point workarounds**The Check Point [ISAKMP Alert](http://www.checkpoint.com/techsupport/alerts/41_isakmp.html) provides the following advice for customers who are unable to upgrade:*Customers using affected releases, who are not able to upgrade at this time, can confirm that they are not affected by running "fw checklic encryption" for a false return.**Customers using affected releases, who have a VPN encryption license should disable the VPN encryption and confirm that there are no Objects with ISAKMP checked.**Customers who are running an earlier version of VPN-1/FireWall-1 4.1 SP5a and prior, and cannot upgrade should contact Check Point Technical Services for assistance.***Block or Restrict Access**Block or restrict access to the ISAKMP service (500/udp) from untrusted networks such as the Internet. This will disable IKE and ISAKMP functionality (authentication, key exchange, SA negotiation) which is likely to disable most VPN services. Depending on service requirements, it may be possible to operate VPN connections without IKE/ISAKMP by using static SAs and pre-shared keys. Note also that in most cases it is trivial for an attacker to spoof the source of a UDP packet. |
| --- |

### Vendor Information

873334
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23873334/) to view vendors.**
### [Check Point](#AAMN-5VVUCQ) Affected

Notified:  February 05, 2004  Updated: February 09, 2004

### Status

Affected

### Vendor Statement

The reported issue does not exist in recent versions of VPN-1/FireWall-1 Next Generation (NG) FP2 and later, including all versions of Next Generation Application Intelligence (NG AI). Nor does this issue exist in VPN-1/FireWall-1 4.1 SP6. The issue was also fixed in the same versions of our VPN client products, SecureClient and SecuRemote.

This issue was fixed during 2002 for all our product lines. There is a very small number of customers that are still using versions prior to 4.1 SP6 and NG prior to FP2; The number of them that use VPN is significantly smaller, hence the vulnerability applies to a very small number of existing deployments.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://xforce.iss.net/xforce/alerts/id/163>
* <http://www.checkpoint.com/techsupport/alerts/41_isakmp.html>
* <http://www.checkpoint.com/corporate/iss.html>
* <http://www.ietf.org/html.charters/ipsec-charter.html>
* <http://www.ietf.org/rfc/rfc2408.txt>
* <http://www.ietf.org/rfc/rfc2409.txt>
* <http://www.ietf.org/rfc/rfc2412.txt>
* <http://www.research.ibm.com/security/skeme.ps>
* <http://www.secunia.com/advisories/10795/>
### Acknowledgements

This vulnerability was reported by Internet Security Systems (ISS).

This document was written by Art Manion.

### Other Information

| **CVE IDs:** | [CVE-2004-0040](http://web.nvd.nist.gov/vuln/detail/CVE-2004-0040) |
| --- | --- |
| **Severity Metric:** | 5.20 |
| **Date Public:** | 2004-02-04 |
| **Date First Published:** | 2004-02-05 |
| **Date Last Updated:** | 2004-02-12 16:51 UTC |
| **Document Revision:** | 35 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


