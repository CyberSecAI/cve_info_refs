=== Content from marc.info_0d600a48_20250124_232354.html ===

```
[[prev in list](?l=bugtraq&m=110297515500671&w=2)] [[next in list](?l=bugtraq&m=110297310503541&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    iDEFENSE Security Advisory 12.13.04 - Multiple Vendor xzgv PRF Parsing Integer Overflow Vulnerabilit
From:       ["customer service mailbox" <customerservice () idefense ! com>](?a=109267942000001&r=1&w=2)
Date:       [2004-12-13 18:30:57](?l=bugtraq&r=1&w=2&b=200412)
Message-ID: [1CE07882ECEE894CA2D5A89B8DEBC4010A2DDA () porgy ! admin ! idefense ! com](?i=1CE07882ECEE894CA2D5A89B8DEBC4010A2DDA%20()%20porgy%20!%20admin%20!%20idefense%20!%20com)
[Download RAW [message](?l=bugtraq&m=110297198402077&q=mbox) or [body](?l=bugtraq&m=110297198402077&q=raw)]

Multiple Vendor xzgv PRF Parsing Integer Overflow Vulnerability

iDEFENSE Security Advisory 12.13.04
<http://www.idefense.com/application/poi/display?id=160&type=vulnerabilit>
ies
December 13, 2004

I. BACKGROUND

xzgv is a picture viewer for X, with a thumbnail-based file selector. It

uses GTK+ and Imlib 1.x. Most file formats are supported, and the
thumbnails used are compatible with xv, zgv and the Gimp.

II. DESCRIPTION

Remote exploitation of an integer overflow vulnerability in various
vendors' implementations of the read_prf_file method in the xzgv program

could allow for arbitrary code execution. The vulnerability specifically

exists due to an integer overflow while allocating memory for an image
file. The vulnerable code is as follows:

xzgv-0.8/src/readprf.c:
if((*theimageptr=malloc(width*height*3))==NULL)
[...]

The values width and height are integers that are ultimately supplied by

the image file. With certain values for height and width set in an image

file, not enough memory is allocated due to an integer overflow. The
underallocated memory is later written to, causing heap corruption and
possible arbitrary code execution with the privileges of the user
viewing the image file.

III. ANALYSIS

Exploitation allows attackers to gain the privileges of the user viewing

the image file. If a user can be convinced to view a malicious file,
this vulnerability can be exploited remotely.

IV. DETECTION

The following vendors have confirmed the availability of susceptible
xzgv packages within their respective operating system distributions:
	SuSE
	Debian
	Gentoo
	FreeBSD

V. WORKAROUND

Only accept image files from trusted sources. Use a different image
viewer program to view untrusted images.

VI. VENDOR RESPONSE

The vulnerability has been addressed in the following patch:

<http://rus.members.beeb.net/xzgv-0.8-integer-overflow-fix.diff>

VII. CVE INFORMATION

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CAN-2004-0994 to this issue. This is a candidate for inclusion
in the CVE list (<http://cve.mitre.org>), which standardizes names for
security problems.

VIII. DISCLOSURE TIMELINE

11/05/2004  Initial vendor notification
12/10/2004  Secondary vendor notification
12/10/2004  Initial vendor response
12/13/2004  Coordinated public disclosure

IX. CREDIT

Infamous41md is credited with this discovery.

Get paid for vulnerability research
<http://www.idefense.com/poi/teams/vcp.jsp>

X. LEGAL NOTICES

Copyright (c) 2004 iDEFENSE, Inc.

Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without the express
written consent of iDEFENSE. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email customerservice@idefense.com for permission.

Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.

[[prev in list](?l=bugtraq&m=110297515500671&w=2)] [[next in list](?l=bugtraq&m=110297310503541&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
AddÂ aÂ list |
SponsoredÂ byÂ [KoreLogic](http://www.korelogic.com/)



=== Content from www.debian.org_5023e68d_20250124_232355.html ===


---

[[Date Prev](msg00222.html)][[Date Next](msg00224.html)]
[[Thread Prev](msg00222.html)][[Thread Next](msg00224.html)]
[[Date Index](maillist.html#00223)]
[[Thread Index](threads.html#00223)]

# [SECURITY] [DSA 614-1] New xzgv packages fix arbitrary code execution

---

* *To*: debian-security-announce@lists.debian.org (Debian Security Announcements)
* *Subject*: [SECURITY] [DSA 614-1] New xzgv packages fix arbitrary code execution
* *From*: joey@infodrom.org (Martin Schulze)
* *Date*: Tue, 21 Dec 2004 12:52:10 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/m1CgiYk-000onCC%40finlandia.Infodrom.North.DE)Â [m1CgiYk-000onCC@finlandia.Infodrom.North.DE](msg00223.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 614-1                     security@debian.org
<http://www.debian.org/security/>                             Martin Schulze
December 21st, 2004                     <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : xzgv
Vulnerability  : integer overflows
Problem-Type   : remote
Debian-specific: no
CVE ID         : CAN-2004-0994

Luke "infamous41md" discoverd multiple vulnerabilities in xzgv, a
picture viewer for X11 with a thumbnail-based selector.  Remote
exploitation of an integer overflow vulnerability could allow the
execution of arbitrary code.

For the stable distribution (woody) these problems have been fixed in
version 0.7-6woody2.

For the unstable distribution (sid) these problems have been fixed in
version 0.8-3.

We recommend that you upgrade your xzgv package immediately.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2.dsc>
      Size/MD5 checksum:      579 27ae6cedb8409d1a61250227194a6b18
    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2.diff.gz>
      Size/MD5 checksum:     6782 fc970417371b3fab54b0cee4bc9ad695
    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7.orig.tar.gz>
      Size/MD5 checksum:   296814 9a376cc01cf486a2a8901fbc8b040d29

  Alpha architecture:

    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2_alpha.deb>
      Size/MD5 checksum:   199532 b3ac4de63867a36dd018ed530f0d10f7

  ARM architecture:

    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2_arm.deb>
      Size/MD5 checksum:   187026 299e911e0b72e2ec50a4e2fe483631fd

  Intel IA-32 architecture:

    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2_i386.deb>
      Size/MD5 checksum:   185198 8daddd8cd55896f09bd34a962d506480

  Intel IA-64 architecture:

    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2_ia64.deb>
      Size/MD5 checksum:   219706 d06e18a31733ed58a8f0515d98ae36dd

  HP Precision architecture:

    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2_hppa.deb>
      Size/MD5 checksum:   195394 de8fb62bad56ed7b39d14242b82f501d

  Motorola 680x0 architecture:

    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2_m68k.deb>
      Size/MD5 checksum:   181580 32bb51323358c9592bcb7a9a6254d378

  Big endian MIPS architecture:

    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2_mips.deb>
      Size/MD5 checksum:   188456 b9db5a09c63151dd48a8c10670828527

  Little endian MIPS architecture:

    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2_mipsel.deb>
      Size/MD5 checksum:   187458 6db543152183971188c0f02b2f06f5e6

  PowerPC architecture:

    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2_powerpc.deb>
      Size/MD5 checksum:   189504 c2df06701aef5409b88d342ef826335d

  IBM S/390 architecture:

    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2_s390.deb>
      Size/MD5 checksum:   188976 530d93c6ca5132b42d64ca60c9fab9b0

  Sun Sparc architecture:
    <http://security.debian.org/pool/updates/main/x/xzgv/xzgv_0.7-6woody2_sparc.deb>
      Size/MD5 checksum:   188952 9f5fefef2a5581e77cf94b9ad4e9f042

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)

iD4DBQFByA5qW5ql+IAeqTIRAm5EAJsFoyMc9uRjsIfX1C+SotlXJa0rsgCYwRBK
pXhM8ykoH9rwR9jnp+vGjQ==
=E6yk
-----END PGP SIGNATURE-----

```

---


