=== Content from www.redhat.com_a9c030f8_20250125_200801.html ===

[Skip to content](#rhb-main-content)
## Featured links

* [![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)](https://www.redhat.com/en/summit)
* [Support](https://access.redhat.com/)
* [Documentation](https://docs.redhat.com/en)
* [Console](https://cloud.redhat.com/)
* [Developers](https://developers.redhat.com/)
* [Start a trial](/en/products/trials)
* All Red Hat
  + For customers
    - [Customer support](https://access.redhat.com/)
    - [Subscription management](https://access.redhat.com/management)
    - [Support cases](https://access.redhat.com/support/cases)
    - [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
    - [Find a partner](https://catalog.redhat.com/partners)
  + For partners
    - [Partner portal](https://connect.redhat.com/partner-admin/dashboard)
    - [Partner support](https://connect.redhat.com/en/support)
    - [Become a partner](https://connect.redhat.com/)
  + Try, buy, & sell
    - [Red Hat Marketplace](https://marketplace.redhat.com/en-us)
    - [Red Hat Store](https://www.redhat.com/en/store)
    - [Contact sales](/en/contact)
    - [Start a trial](/en/products/trials)
  + Learning resources
    - [Documentation](https://docs.redhat.com/en)
    - [Training and certification](/en/services/training-and-certification)
    - [Hybrid cloud learning hub](https://cloud.redhat.com/learn)
    - [Interactive labs](/en/interactive-labs)
    - [Learning community](https://learn.redhat.com/)
    - [Red Hat TV](https://tv.redhat.com)
  + Open source communities
    - [Global advocacy](https://access.redhat.com/accelerators)
    - [How we contribute](/en/about/our-community-contributions)
[Red Hat](/en)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* Explore more
### Platform products

* [Red Hat Enterprise LinuxA flexible, stable operating system to support hybrid cloud innovation.](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShiftA container platform to build, modernize, and deploy applications at scale.](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation PlatformNew versionA foundation for implementing enterprise-wide automation.](/en/technologies/management/ansible)
### Try & buy

* [Start a trialAssess a product with a no-cost trial.](/en/products/trials)
* [Buy onlineBuy select products and services in the Red Hat Store.](https://www.redhat.com/en/store)
* [Integrate with major cloud providersBuy Red Hat solutions using committed spend from providers, including:
  ![Cloud providers: Amazon Web Services, Microsoft Azure, and Google Cloud](https://www.redhat.com/rhdc/managed-files/cloud-providers-2x.png)](/en/partners/certified-cloud-and-service-providers)
### Featured

* [Red Hat Enterprise Linux AI](/en/technologies/linux-platforms/enterprise-linux/ai)
* [Red Hat OpenShift AI](/en/technologies/cloud-computing/openshift/openshift-ai)
* [Red Hat OpenShift Virtualization](/en/technologies/cloud-computing/openshift/virtualization)
* [Red Hat OpenShift Service on AWS](/en/technologies/cloud-computing/openshift/aws)
* [Microsoft Azure Red Hat OpenShift](/en/technologies/cloud-computing/openshift/azure)
[See all products](/en/technologies/all-products)

* [Application platformSimplify the way you build, deploy, manage, and secure apps across the hybrid cloud.](/en/solutions/application-platform)
* [Artificial intelligenceBuild, deploy, and monitor AI models and apps with Red Hat's open source platforms.](/en/solutions/ai)
* [Edge computingDeploy workloads closer to the source with security-focused edge technology.](/en/products/edge)

* [IT automationUnite disparate tech, teams, and environments with 1 comprehensive automation platform.](/en/solutions/it-automation)
* [Linux standardizationGet consistency across operating environments with an open, flexible infrastructure.](/en/solutions/linux-standardization)

* [SecurityDeliver software using trusted platforms and real-time security scanning and remediation.](/en/solutions/trusted-software-supply-chain)
* [VirtualizationModernize operations using a single platform for virtualized and containerized workloads.](/en/solutions/virtualization)
### By industry

* [Automotive](/en/solutions/automotive)
* [Financial services](/en/solutions/financial-services)
* [Healthcare](/en/solutions/healthcare)
* [Industrial sector](/en/solutions/industrial-sector)
* [Media and entertainment](/en/solutions/media-entertainment)
* [Public sector](/en/solutions/public-sector)
* [Telecommunications](/en/solutions/telecommunications)
[Explore solutions](/en/solutions)
### [Services](/en/services)

* [Consulting](/en/services/consulting)
* [Services for AI](/en/services/consulting/red-hat-consulting-for-ai)
* [Technical Account Management](/en/services/support/technical-account-management)
### [Training & certification](/en/services/training-and-certification)

* [All courses and exams](/en/services/training/all-courses-exams)
* [All certifications](/en/services/certifications)
* [Verify a certification](https://www.redhat.com/rhtapps/services/verify/)
* [Skills assessment](https://skills.ole.redhat.com)
* [Learning subscription](/en/services/training/learning-subscription)
* [Learning community](https://learn.redhat.com/)
* [Red Hat Academy](/en/services/training/red-hat-academy)
* [FAQs](/en/services/training-and-certification/faq)
* [Connect with learning experts](/en/services/training-and-certification/contact-us)
### Featured

* [Ansible Basics: Automation Technical Overview (No cost)](/en/services/training/do007-ansible-essentials-simplicity-automation-technical-overview)
* [Containers, Kubernetes and Red Hat OpenShift Technical Overview (No cost)](/en/services/training/do080-deploying-containerized-applications-technical-overview)
* [Red Hat Enterprise Linux Technical Overview (No cost)](/en/services/training/rh024-red-hat-linux-technical-overview)
* [Red Hat Certified System Administrator exam](/en/services/training/ex200-red-hat-certified-system-administrator-rhcsa-exam)
* [Red Hat System Administration I](/en/services/training/rh124-red-hat-system-administration-i)
[Explore services](/en/services)
### Topics

* [AI](/en/topics/ai)
* [Application modernization](/en/topics/application-modernization)
* [Automation](/en/topics/automation)
* [Cloud computing](/en/topics/cloud-computing)
* [Cloud-native applications](/en/topics/cloud-native-apps)
* [Containers](/en/topics/containers)
* [DevOps](/en/topics/devops)
* [Edge computing](/en/topics/edge-computing)
* [Linux](/en/topics/linux)
* [Virtualization](/en/topics/virtualization)
* [See all topics](/en/topics)
### Articles

* [What is InstructLab?](/en/topics/ai/what-is-instructlab)
* [What are cloud services?](/en/topics/cloud-computing/what-are-cloud-services)
* [What is edge computing?](/en/topics/edge-computing/what-is-edge-computing)
* [What is hybrid cloud?](/en/topics/cloud-computing/what-is-hybrid-cloud)
* [Why build a Red Hat cloud?](/en/topics/cloud-computing/why-choose-red-hat-cloud)
* [Cloud vs. edge](/en/topics/cloud-computing/cloud-vs-edge)
* [Red Hat OpenShift vs. Kubernetes](/en/technologies/cloud-computing/openshift/red-hat-openshift-kubernetes)
* [Learning Ansible basics](/en/topics/automation/learning-ansible-tutorial)
* [What is Linux?](/en/topics/linux/what-is-linux)
### More to explore

* [Blog](/en/blog)
* [Customer success stories](/en/success-stories)
* [Events and webinars](/en/events)
* [Newsroom](/en/about/newsroom)
* [Podcasts and video series](/en/red-hat-original-series)
* [Documentation](https://docs.redhat.com/en)
* [Resource library](/en/resources)
* [Training and certification](/en/services/training-and-certification)
[Explore resources](/en/resources)
### For customers

* [Our partners](/en/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
### For partners

* [Partner Connect](https://connect.redhat.com)
* [Become a partner](https://connect.redhat.com/en/benefits-of-being-a-partner)
* [Training](https://connect.redhat.com/en/training)
* [Support](https://connect.redhat.com/en/support)
* [Access the partner portal](https://connect.redhat.com/partner-admin/dashboard)
### About us

* [Our company](/en/about/company)
* [How we work](/en/about/our-culture)
* [Our social impact](/en/about/community-social-responsibility)
* [Development model](/en/about/development-model)
* [Subscription model](/en/about/value-of-Red-Hat)
* [Product support](/en/services/support)
### Open source

* [Open source commitments](/en/about/open-source)
* [How we contribute](/en/about/our-community-contributions)
* [Red Hat on GitHub](https://github.com/RedHatOfficial)
### Company details

* [Analyst relations](/en/about/analysts)
* [Blog](/en/blog)
* [Locations](/en/about/office-locations)
* [Newsroom](/en/about/newsroom)
[Explore Red Hat](/en/about)[Contact us](/en/contact)For customers

* [Customer support](https://access.redhat.com/)* [Subscription management](https://access.redhat.com/management)* [Support cases](https://access.redhat.com/support/cases)* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)* [Find a partner](https://catalog.redhat.com/partners)
For partners

* [Partner portal](https://connect.redhat.com/partner-admin/dashboard)* [Partner support](https://connect.redhat.com/en/support)* [Become a partner](https://connect.redhat.com/)
Try, buy, & sell

* [Red Hat Marketplace](https://marketplace.redhat.com/en-us)* [Red Hat Store](https://www.redhat.com/en/store)* [Contact sales](/en/contact)* [Start a trial](/en/products/trials)
Learning resources

* [Documentation](https://docs.redhat.com/en)* [Training and certification](/en/services/training-and-certification) * [Hybrid cloud learning hub](https://cloud.redhat.com/learn)* [Interactive labs](/en/interactive-labs)* [Learning community](https://learn.redhat.com/)* [Red Hat TV](https://tv.redhat.com)
Open source communities

* [Global advocacy](https://access.redhat.com/accelerators)* [How we contribute](/en/about/our-community-contributions)
For you
New
### Recommendations

As you browse redhat.com, we'll recommend resources you may like. For now, try these.

---

* [All Red Hat products](/en/technologies/all-products)
* [Tech topics](/en/topics)
* [Red Hat resources](/en/resources)
![close](https://static.redhat.com/libs/redhat/rh-iconfont/latest/svg/web-icon-close.svg)[![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)Red Hat Summit](https://www.redhat.com/en/summit)[Support](https://access.redhat.com/)[Documentation](https://docs.redhat.com/en)[Console](https://cloud.redhat.com/)[Developers](https://developers.redhat.com/)[Start a trial](/en/products/trials)[Contact](/en/contact)Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol[Contact us](/en/contact)
English
### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol![](/themes/custom/rh_base_ui/dist/img/talk-bubble.svg)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* [Contact us](/en/contact)

### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)

# Red Hat Support

## Go beyond support by engaging with our experts

Our teams collaborate with you to ensure you accomplish your goals with Red Hat solutions. The relationship we build with you is designed to provide you with the tools and resources you need to find success on your IT journey.

![](/rhdc/managed-files/support-header.svg)

## Configured for your success

We develop a holistic understanding of your experience as a customer by ensuring our support and engineering teams work together.

Our support team works hand in hand with the best engineers in the industry to quickly turn customer feedback into product improvements. This direct line of communication allows us to hone in on proactive fixes that can impact your bottom line.

### Quick links

* Search our [Knowledgebase](https://access.redhat.com/search/#/?q=&p=1&sort=relevant&scoped&documentKind=Knowledgebase)
* Find [product documentation](https://access.redhat.com/documentation/en-us/)
* Access the [product security center](https://access.redhat.com/security/)
* Connect with [our support team](https://access.redhat.com/support)
* Team up with a [technical account manager](/en/services/support/technical-account-management "Technical account management")
* Take advantage of [partner support](https://connect.redhat.com/en/support)

## Find the right level of support

We have different tiers of support designed to meet your unique needs.

|  | Self-support | Standard | Premium |
| --- | --- | --- | --- |
| Access to Red Hat products | checkmark | checkmark | checkmark |
| Access to our knowledgebase and tools in our award-winning Customer Portal | checkmark | checkmark | checkmark |
| Access to support engineers during standard business hours |  | checkmark | checkmark |
| Access to support engineers 24x7 for high-severity issues |  |  | checkmark |

We also feature specialized support options that can be tailored to the unique needs of companies of all sizes and industries. The Red Hat® [Enhanced Solution Support](/en/resources/enhanced-solution-support-datasheet "Red Hat Enhanced Solution Support: 24x7 engineering support") offering reduces downtime and boosts confidence through access to senior level engineers, as well as resolution and restoration SLAs—helping you stay up and running as you innovate, scale, and deploy. Our engineers help restore your operations quickly and accelerate the path to final resolution, identifying the root cause which helps protect against recurrences in the future. Enhanced Solution Support engineers, who are already familiar with your environment, will be there to assist with critical issues in production environments so that you can consistently deliver the cloud services your customers demand. This offering is available for Red Hat OpenShift® and Red Hat OpenStack® Platform customers.

### Personalized support

Connect with a technical adviser for collaborative planning and specialized guidance. Our Technical Account Managers help you streamline deployments, resolve issues, and shape your technology strategy to meet your toughest business challenges.

[Explore Technical Account Management](/en/services/support/technical-account-management)

## Award winners since 2011

We’ve evolved the traditional software subscription model, combining the best elements of our services to exceed customer expectations. The Association of Support Professionals has honored Red Hat’s Customer Portal as one of “The Top Ten Best Support Websites” for 13 years running.

[See why the Customer Portal keeps earning industry recognition](https://access.redhat.com/)

![Gold and green star with text ASP best support websites of 2023](/rhdc/managed-files/ASP-Award-Design.jpg)

## What they're saying

![BSE logo](/rhdc/managed-files/bse-logo-2.png)

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> We have found the support from Red Hat to be exemplary. Whenever we need anything from them, they have given it … Red Hat is now our backbone. Our business cannot run if Red Hat is not there.
>
> Ashishkumar Chauhan
>
> CEO, BSE

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> I like the fact that they really dig into things and then provide answers. As the single Linux guy, I kind of need that second admin next to me sometimes to say, "Hey, what about this?" and I am able to do that through the portal. I get my questions answered and trouble tickets resolved.
>
> Erik Widholm
>
> Sr. Enterprise Engineer

[Read more user reviews](/en/technologies/linux-platforms/enterprise-linux/user-reviews)

## Have questions?

[Contact Support team](https://access.redhat.com/support)

[Visit the Customer Portal](https://access.redhat.com/)

[![Red Hat logo](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](/en)[LinkedIn](https://www.linkedin.com/company/red-hat)[YouTube](https://www.youtube.com/user/RedHatVideos)[Facebook](https://www.facebook.com/redhatinc)[X](https://twitter.com/RedHat)
### Products

* [Red Hat Enterprise Linux](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShift](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation Platform](/en/technologies/management/ansible)
* [Cloud services](/en/technologies/cloud-computing/openshift/cloud-services)
* [See all products](/en/technologies/all-products)

### Tools

* [Training and certification](/en/services/training-and-certification)
* [My account](https://www.redhat.com/wapps/ugc/protected/personalInfo.html)
* [Customer support](https://access.redhat.com)
* [Developer resources](https://developers.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Red Hat value calculator](/en/solutions/value-calculator)
* [Documentation](https://docs.redhat.com/en)

### Try, buy, & sell

* [Product trial center](/en/products/trials)
* [Red Hat Marketplace](https://marketplace.redhat.com)
* [Red Hat Store](https://www.redhat.com/en/store)
* [Buy online (Japan)](https://www.redhat.com/en/about/japan-buy)
* [Console](https://cloud.redhat.com/)

### Communicate

* [Contact sales](/en/contact/sales)
* [Contact customer service](/en/contact/customer-service)
* [Contact training](/en/services/training-and-certification/contact-us)
* [Social](/en/about/social)

### About Red Hat

We’re the world’s leading provider of enterprise open source solutions—including Linux, cloud, container, and Kubernetes. We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.

### Select a language

![](https://static.redhat.com/libs/redhat/rh-iconfont/4/svg/web-icon-globe.svg)

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
### Red Hat legal and privacy links

* [About Red Hat](/en/about/company)
* [Jobs](/en/jobs)
* [Events](/en/events)
* [Locations](/en/about/office-locations)
* [Contact Red Hat](/en/contact)
* [Red Hat Blog](/en/blog)
* [Diversity, equity, and inclusion](/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](/en/about/privacy-policy)
* [Terms of use](/en/about/terms-use)
* [All policies and guidelines](/en/about/all-policies-guidelines)
* [Digital accessibility](/en/about/digital-accessibility)



=== Content from bugzilla.mozilla.org_7cb1706b_20250125_200757.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/250906)
* [XML](/show_bug.cgi?ctype=xml&id=250906)

Open
[Bug 250906](/show_bug.cgi?id=250906)

Opened 21 years ago
Updated 1 year ago

# null (%00) in filename fakes extension (ftp, file)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

null (%00) in filename fakes extension (ftp, file)

## Categories

### (Core :: Networking: File, defect, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking%3A%20File#Networking%3A%20File)

Networking: File
▾

Core :: Networking: File
For bugs in Mozilla's File IO code. This component deals with File specific issues like writing to disk, reading local files, etc Related problems with file:// protocol may also be addressed here.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20File&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20File&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking%3A%20File)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

1.0 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Windows 2000

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

NEW

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

NEW

---

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mindwarper, Assigned: jesup)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/2d31829db429a43aa739366e03291ef4?d=mm&size=40)  [mindwarper](/user_profile?user_id=146513)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

24 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2007-3285](/show_bug.cgi?id=383478 "RESOLVED FIXED - File type confusion vulnerability due to null bytes in URL (encoded as %00)")

## Details

### (4 keywords, Whiteboard: [necko-triaged])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---),
[fixed1.4.3](/buglist.cgi?keywords=fixed1.4.3&resolution=---),
[fixed1.7.2](/buglist.cgi?keywords=fixed1.7.2&resolution=---),
[fixed1.7.5](/buglist.cgi?keywords=fixed1.7.5&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-triaged]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

2

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [Patch for suspicious file URLs](/attachment.cgi?id=153078)  [21 years ago](#c4)  [Pavel Kankovsky](/user_profile?user_id=146917)   1.31 KB, patch |  | [Details](/attachment.cgi?id=153078&action=edit) | [Diff](/attachment.cgi?id=153078&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=153078) |
| --- | --- | --- |
| [Prevent loading of ftp:// URI's with %00 in the path](/attachment.cgi?id=153100)  [21 years ago](#c7)  [Johnny Stenback (:jst)](/user_profile?user_id=12352)   1.43 KB, patch |  | [Details](/attachment.cgi?id=153100&action=edit) | [Diff](/attachment.cgi?id=153100&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=153100) |
| [Prevent creation of ftp: URI's with nulls in them](/attachment.cgi?id=154673)  [20 years ago](#c14)  [Johnny Stenback (:jst)](/user_profile?user_id=12352)   3.61 KB, patch | bzbarsky : [review+](#c18 "20 years ago")  darin.moz : [superreview+](#c15 "20 years ago")  asa : [approval-aviary+](#c23 "20 years ago")  asa : [approval1.7.5+](#c0 "20 years ago") | [Details](/attachment.cgi?id=154673&action=edit) | [Diff](/attachment.cgi?id=154673&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=154673) |
| [FTP patch for 1.4 branch](/attachment.cgi?id=154726)  [20 years ago](#c22)  [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335)   2.56 KB, patch | caillon : [approval1.4.3+](#c24 "20 years ago") | [Details](/attachment.cgi?id=154726&action=edit) | [Diff](/attachment.cgi?id=154726&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=154726) |
| [Patch that prevents null(%00) and addresses windows specific issues in file url](/attachment.cgi?id=725268)  [12 years ago](#c39)  [Shriram (irc: Mavericks)](/user_profile?user_id=336645)   6.12 KB, patch | jduell.mcbugs : [feedback+](#c40 "12 years ago") | [Details](/attachment.cgi?id=725268&action=edit) | [Diff](/attachment.cgi?id=725268&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=725268) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Mindwarper](/user_profile?user_id=146513)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=250906#c0)• 21 years ago |
|  | |

User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:1.7) Gecko/20040707 Firefox/0.9.2
Build Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:1.7) Gecko/20040707 Firefox/0.9.2
The first bug is that firefox stores the cache data in a known location.
This location depends partially on the OS, but in windows 2000 the path look as
following: C:\Documents and Settings\Administrator\Application
Data\Mozilla\Firefox\Profiles\default.nop\Cache.
There are 3 files in this directory that have known names, \_CACHE\_001\_,
\_CACHE\_002\_, and \_CACHE\_003\_.
The second bug is the famous NULL bug. By submiting the following URI
"file://C:\Documents and Settings\Administrator\Application
Data\Mozilla\Firefox\Profiles\default.nop\Cache\\_CACHE\_001\_" we cause firefox to
pop up a download window, but since we want to cause firefox to execute the
javascript code inside one of the CACHE files we can just do the following:
"file://C:\Documents and Settings\Administrator\Application
Data\Mozilla\Firefox\Profiles\default.nop\Cache\\_CACHE\_001\_%00.txt"
or
"file://C:\Documents and Settings\Administrator\Application
Data\Mozilla\Firefox\Profiles\default.nop\Cache\\_CACHE\_001\_%00.html"
Firefox thinks that we are calling a html/text file, yet it still only open the
cache file without the .html.
The combination of these 2 bugs could lead to the following situations:
If someone finds a way to redirect a user in Internet Zone to a file://
location, it is possible to execute code on a victim in Local Zone and thus
compromising the victims computer.
If the attacker can make a user visit his website (to store the malicious code
in one of the cache files) and then make him go to one of the 2 urls shown
above, the attacker can take over the victims computer.
I hope you take this seriously, it's not as bad as the Internet Explorer
vulnerabilities, but it's close.
- Mindwarper
- mindwarper@mlsecurity.com
- <http://www.mlsecurity.com>
Reproducible: Always
Steps to Reproduce:
Clearly explained in Details Section.
Actual Results:
I was able to execute javascript in local zone.
Expected Results:
Software should create an unkown path to the cache directory, and ignore %00
when reading local files.

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=250906#c1)• 21 years ago |
|  | |

openning bug since it was disclosed by the reporterGroup: security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=250906#c2)• 21 years ago |
|  | |

deleting useless URL (it's not required, please only fill in if it's useful as a
testcase or similar).
The profile directory name contains three random characters. Guessing them would
not be as trivial as you suggest.
Web content is not allowed to open file:/// urls
"local" files don't have any special powers that web content doesn't have,
except the ability to open other file:/// urls
The fixed-name cache files contain random bits of different files, it would be
extremely hard to get your specific attack file to come up first against a
random victim.
The null-in-filename bug definitely needs to be fixed, but I don't see how it's
exploitable on its own. It's also not firefox-specific: reassigningAssignee: firefox → dougtURL: <http://www.NoURLNeeded.com>Component: General → XPCOMProduct: Firefox → BrowserQA Contact: firefox.generalVersion: unspecified → 1.0 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=250906#a165902_1689)• 21 years ago |

Flags: blocking1.8a2?Flags: blocking1.7.2?Flags: blocking-aviary1.0?Summary: 2 Security Vulnerabilities, one is known path location, and the other is fake file extention → null in filename fakes extension

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=250906#a165917_1689)• 21 years ago |

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Mindwarper](/user_profile?user_id=146513)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=250906#c3)• 21 years ago |
|  | |

This vulnerability also appears in other protocols that are not http. For
example, you can easily tell the difference between the following two results:
ftp://ftp.gnu.org/welcome.msg
and
ftp://ftp.gnu.org/welcome.msg%00.html
Also while testing this I found out that when requesting user:pass@domain
through firefox, firefox does not hash or hide the pass field, instead it leaves
it in plain text allowing anyone with access to the computer to view other
users's ftp user/pass.

|  | [Pavel Kankovsky](/user_profile?user_id=146917) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=250906#c4)• 21 years ago |
|  | |

Attached patch

[Patch for suspicious file URLs](attachment.cgi?id=153078&action=diff)
— [Details](attachment.cgi?id=153078&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=153078)

This patch makes unix versions of Mozilla refuse file URLs generating
suspicious filenames:
- including a null character (from %00)
- including /../ or trailing /.. (from /..%2f, /.%2e etc--URL parsing does not
grok these encoded sequences)
- not starting with a slash (including empty filenames)
Cases #2 and #3 are not known to have any dangerous consequences (and #3 should
never happen) but we all know the rule: better safe than sorry.
I do not dare to write a similar piece of code for Windows because their
interpretation of filenames is too magical for me (see canonical\_filename() in
Apache). Other platforms may need other specific checks.

|  | [Pavel Kankovsky](/user_profile?user_id=146917) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=250906#c5)• 21 years ago |
|  | |

I've just observed a really odd side-effect of %00 in a file URL: I've got a
text file called /blah/blah (no extension). file:///blah/blah is displayed as
text/plain but file:///blah/blah%00 (still no extension) is displayed as text/html!

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=250906#c6)• 21 years ago |
|  | |

That patch isn't enough. And I'd argue it's the wrong approach. We should fix
the problem at/before the call to NS\_UnescapeURL not after it's munged the string.
Windows goes through net\_GetFileFromURLSpec (nsurlhelperwin.cpp)
for people playing along at home:
> necko.dll!net\_GetFileFromURLSpec(const nsACString & aURL={...}, nsIFile \* \*
result=0x00ed24cc) Line 133 C++
necko.dll!nsStandardURL::GetFile(nsIFile \* \* result=0x0012fe40) Line 2223 C++
necko.dll!nsFileChannel::GetClonedFile(nsIFile \* \* result=0x0012fe5c) Line 84 C++
necko.dll!nsFileChannel::EnsureStream() Line 99 C++
necko.dll!nsFileChannel::AsyncOpen(nsIStreamListener \* listener=0x00eb7870,
nsISupports \* ctx=0x00ed2930) Line 455 C++
TestProtocols.exe!StartLoadingURL(const char \* aUrlString=0x00364928) Line
685 + 0xf C++
TestProtocols.exe!main(int argc=0x00000003, char \* \* argv=0x003648d8) Line
835 + 0x7 C++
TestProtocols.exe!mainCRTStartup() Line 400 + 0xe C
kernel32.dll!GetCurrentDirectoryW() + 0x44
TestProtocols.exe -verbose "file:///R:/testxpc.html%00.foo"

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=250906#c7)• 21 years ago |
|  | |

Attached patch

[Prevent loading of ftp:// URI's with %00 in the path](attachment.cgi?id=153100&action=diff)
— [Details](attachment.cgi?id=153100&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=153100)

There's also code that checks for \n and \r when creating FTP URL objects (in
nsFtpProtocolHandler::NewURI), but it does that w/o unescaping them. Should we
unescape there too, and check for embedded nulls there as well?

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=250906#c8)• 21 years ago |
|  | |

+ // test for bad stuff: missing leading /, nulls, /../
Why does / or /../ matter in a file url?

|  | [Pavel Kankovsky](/user_profile?user_id=146917) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=250906#c9)• 21 years ago |
|  | |

> We should fix the problem at/before the call
> to NS\_UnescapeURL not after it's munged the string.
Checking after NS\_UnescapeURL (or any transformation in general) is good because
it no bad things can reappear during the transformation. (Look at the infamous
IIS "Unicode bug": they checked URI before the last transformation from UTF-8 to
ASCII and that transformation (due to sloppy coding accepting illegal UTF-8
sequences, indeed) was able to introduce bad things that should have already
been dealt with (/../)).
It might make some sense to do these checks at the end of NS\_UnescapeURL.
Unfortunately, there are two problems:
- there are different policies for different protocols/platforms (POSIX
filesystem API cannot handle \0, Win32 filesystem API should be protected from
\0 as well as magical device names (\*) or god knows what else, FTP cannot handle
\r and \n and \0),
- the interface of (most variants of) NS\_UnescapeURL cannot report any errors to
the caller,
(\*) Try this on a Windows machine: <img src="con.png">
BTW: A comment in nsEscape.h reads "Expands URL escape sequences... beware
embedded null bytes!" Very funny...
> Prevent loading of ftp:// URI's with %00 in the path...
The code in netwerk/protocol/ftp is quite messy IMHO. The check in
nsFtpProtocolHandler::NewURI is (almost) pointless as it checks the URI before
it is unescaped (see above). Moreover, usernames and passwords and should be
checked for nulls too (to make things worse, they are checked for \r and \n in
UCS-2 form before they are converted to ASCII with AppendWithConversion()...it
appears untranslateable chars are converted to a rather bening '.' but it is
still ugly).
> Why does / or /../ matter in a file url?
It is "a \*missing\* leading / or ..." Anyway, such things should never appear in
the resulting filename. This is a proactive measure. E.g. one day, someone might
decide to divide file:-URL namespace into multiple mutually untrusting domains
or something similar and such a check will stop attempts to fool Mozilla with
things like /.%2e/. (Hmm...I guess it might make sense to forbid /./ as well.)

|  | [Darin Fisher](/user_profile?user_id=20048) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=250906#c10)• 21 years ago |
|  | |

jst: what about other control characters. maybe we want to pass esc\_SkipControl
to NS\_UnescapeURL? or if we know that everything needs to be unescape for FTP,
then maybe we want to verify that the resulting string does not contain any
control characters?

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=250906#c11)• 21 years ago |
|  | |

(In reply to [comment #10](/show_bug.cgi?id=250906#c10 "NEW - null (%00) in filename fakes extension (ftp, file)"))
> jst: what about other control characters. maybe we want to pass esc\_SkipControl
> to NS\_UnescapeURL? or if we know that everything needs to be unescape for FTP,
> then maybe we want to verify that the resulting string does not contain any
> control characters?
Darin, I guess the question is do we want to skip control characters, or flag
URIs with such characters as invalid and refuse to do anything with them? I'd
vote for the latter.

|  | [Darin Fisher](/user_profile?user_id=20048) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=250906#c12)• 21 years ago |
|  | |

Yeah, you make a good point. Rejecting these URLs is probably best.Flags: blocking1.8a2?

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=250906#c13)• 20 years ago |
|  | |

Any update on this bug? It would be nice if we could get a fix in soonish here...

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=250906#a1548998_15661)• 20 years ago |

Summary: null in filename fakes extension → null (%00) in filename fakes extension (ftp, file)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=250906#c14)• 20 years ago |
|  | |

Attached patch

[Prevent creation of ftp: URI's with nulls in them](attachment.cgi?id=154673&action=diff)
— [Details](attachment.cgi?id=154673&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=154673)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=250906#a1551578_12352)• 20 years ago |

[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: superreview?(darin)
[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: review?(bzbarsky)

|  | [Darin Fisher](/user_profile?user_id=20048) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=250906#c15)• 20 years ago |
|  | |

Comment on [attachment 154673](/attachment.cgi?id=154673 "Prevent creation of ftp: URI's with nulls in them") [[details]](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") [[diff]](/attachment.cgi?id=154673&action=diff "Prevent creation of ftp: URI's with nulls in them") [[review]](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=154673)
Prevent creation of ftp: URI's with nulls in them
>Index: netwerk/protocol/ftp/src/nsFtpProtocolHandler.cpp
> nsFtpProtocolHandler::NewURI(const nsACString &aSpec,
...
>+ char\* fwdPtr = spec.BeginWriting();
nit: |char \*fwdPtr|
sr=darin
[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: superreview?(darin) → superreview+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=250906#c16)• 20 years ago |
|  | |

Aren't we unescaping twice now?
Also, why just ftp? Isn't this a problem in general?

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=250906#c17)• 20 years ago |
|  | |

For the record, IE cuts an FTP URL at the %00 mark, and we'll refuse to
recognize it as a valid URL (i.e. a link with a bad FTP URL in it won't show up
as a link, and won't be clickable). \*I\* doubt that would affect any real usage.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=250906#c18)• 20 years ago |
|  | |

Comment on [attachment 154673](/attachment.cgi?id=154673 "Prevent creation of ftp: URI's with nulls in them") [[details]](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") [[diff]](/attachment.cgi?id=154673&action=diff "Prevent creation of ftp: URI's with nulls in them") [[review]](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=154673)
Prevent creation of ftp: URI's with nulls in them
r=bzbarsky
(For the curious, the answers are:
1) Yes, but we unescape on a copy the first time and don't use it thereafter.
2) For other protocols (eg HTTP), %00 is valid in a URI.)
[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: review?(bzbarsky) → review+

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=250906#c19)• 20 years ago |
|  | |

I do think that file: has the same problem (that's why I put it into the summary
:) )

|  | [Brodie](/user_profile?user_id=62584) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=250906#c20)• 20 years ago |
|  | |

> Win32 filesystem API should be protected from
> \0 as well as magical device names (\*)
>
> (\*) Try this on a Windows machine: <img src="con.png">
If anyone wants to do the magical device name protection, there is some code for
it at:
<http://lxr.mozilla.org/mozilla/source/widget/src/windows/nsDataObj.cpp#507>
At [bug 103468 comment #36](/show_bug.cgi?id=103468#c36 "RESOLVED FIXED - Mozilla creates .url files with zero byte at end, confusing IE (Internet shortcut)") I did some testing for control characters in filenames
and found that Windows seems to protect itself from them.

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=250906#c21)• 20 years ago |
|  | |

ftp: fix checked in on the trunk.

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=250906#a1582800_12352)• 20 years ago |

[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: approval1.7.2?
[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: approval1.4.3?
[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: approval-aviary?

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=250906#c22)• 20 years ago |
|  | |

Attached patch

[FTP patch for 1.4 branch](attachment.cgi?id=154726&action=diff)
— [Details](attachment.cgi?id=154726&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=154726)

|  | [Asa Dotzler [:asa]](/user_profile?user_id=5003) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=250906#c23)• 20 years ago |
|  | |

Comment on [attachment 154673](/attachment.cgi?id=154673 "Prevent creation of ftp: URI's with nulls in them") [[details]](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") [[diff]](/attachment.cgi?id=154673&action=diff "Prevent creation of ftp: URI's with nulls in them") [[review]](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=154673)
Prevent creation of ftp: URI's with nulls in them
a=asa for the 1.7.2 mini-branch and the aviary branch.
[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: approval1.7.3?
[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: approval1.7.3+
[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: approval-aviary?
[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: approval-aviary+

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=250906#c24)• 20 years ago |
|  | |

Comment on [attachment 154726](/attachment.cgi?id=154726 "FTP patch for 1.4 branch") [[details]](/attachment.cgi?id=154726&action=edit "FTP patch for 1.4 branch") [[diff]](/attachment.cgi?id=154726&action=diff "FTP patch for 1.4 branch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=154726)
FTP patch for 1.4 branch
a=blizzard for 1.4
[Attachment #154726](/attachment.cgi?id=154726&action=edit "FTP patch for 1.4 branch ") -
Flags: approval1.4.3+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=250906#c25)• 20 years ago |
|  | |

ftp: fix landed on all sorts of branches (aviary, 1.7, 1.7.2)Keywords: [fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---),
[fixed1.7.2](/buglist.cgi?keywords=fixed1.7.2&resolution=---),
[fixed1.7.3](/buglist.cgi?keywords=fixed1.7.3&resolution=---)

|  | [Tracy Walker [:tracy]](/user_profile?user_id=18566) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=250906#c26)• 20 years ago |
|  | |

Can someone supply a testcase with details of expected behavior.
I just ran this:
"file://C:\Documents and Settings\Administrator\Application
Data\Mozilla\Firefox\Profiles\default.nop\Cache\\_CACHE\_001\_%00.html"
It launched a testcase from another security bug that I had just verified.
Should that have happened?Whiteboard: testcase wanted

|  | [Mark Cox](/user_profile?user_id=149980) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=250906#c27)• 20 years ago |
|  | |

Note: The Common Vulnerabilities and Exposures project (cve.mitre.org) has
assigned the name [CAN-2004-0760](https://www.cve.org/CVERecord?id=CAN-2004-0760) to this issue.

|  | [Pavel Kankovsky](/user_profile?user_id=146917) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=250906#c28)• 20 years ago |
|  | |

(In reply to [comment #26](/show_bug.cgi?id=250906#c26 "NEW - null (%00) in filename fakes extension (ftp, file)"))
> It launched a testcase from another security bug that I had just verified.
> Should that have happened?
It should have. Sort of. This is the "expected" wrong behaviour: it interprets
the cache file as HTML and runs whatever JS it finds there.
A simpler and more deterministic test is as follows:
1. create evil.txt containing the following text
<html><body onload="alert('Gotcha!')"></body></html>
2. open file://.../evil.txt
it will display the text, ok
3. open file://.../evil.txt%00.html
if a "Gotcha!" alert pops up then you have a problem

|  | [OstGote!](/user_profile?user_id=51898) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=250906#c29)• 20 years ago |
|  | |

(In reply to [comment #28](/show_bug.cgi?id=250906#c28 "NEW - null (%00) in filename fakes extension (ftp, file)"))
> 3. open file://.../evil.txt%00.html
> if a "Gotcha!" alert pops up then you have a problem
No alert, only display of file://.../evil.txt. But that is the error. If [comment
18](/show_bug.cgi?id=250906#c18 "NEW - null (%00) in filename fakes extension (ftp, file)") states that a file URL with %00 in it is valid, I EXPECT that I get a file
not found error for file://.../evil.txt%00.html because that file doesn't exist
(or are not allowed due to file system restrictions) and I don't want Mozilla to
fix up that url internally to file://.../evil.txt and display the content
without changing the (valid) URL in the address bar.

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=250906#c30)• 20 years ago |
|  | |

(In reply to [comment #28](/show_bug.cgi?id=250906#c28 "NEW - null (%00) in filename fakes extension (ftp, file)"))
> It should have. Sort of. This is the "expected" wrong behaviour: it interprets
> the cache file as HTML and runs whatever JS it finds there.
note that the patch here does not fix file:
> 3. open file://.../evil.txt%00.html
> if a "Gotcha!" alert pops up then you have a problem
for some definition of "problem", since the only issue is that the url shown in
the urlbar does not quite match the content.
(In reply to [comment #29](/show_bug.cgi?id=250906#c29 "NEW - null (%00) in filename fakes extension (ftp, file)"))
> I don't want Mozilla to
> fix up that url internally to file://.../evil.txt and display the content
> without changing the (valid) URL in the address bar.
that "fixup" is not done intentionally, it's a side-effect of how this code
stores strings and does unescaping, I'm sure.

|  | [Tracy Walker [:tracy]](/user_profile?user_id=18566) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=250906#c31)• 20 years ago |
|  | |

from the following:
A simpler and more deterministic test is as follows:
1. create evil.txt containing the following text
<html><body onload="alert('Gotcha!')"></body></html>
2. open file://.../evil.txt
it will display the text, ok
---yes, opens the text file as is---
3. open file://.../evil.txt%00.html
if a "Gotcha!" alert pops up then you have a problem
---a file not found error message. no file type conversion---

|  | [Tracy Walker [:tracy]](/user_profile?user_id=18566) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=250906#c32)• 20 years ago |
|  | |

On Linux, I am seeing this on Firefox 0.9+ from today(0804) and the latest
Firefox 0.9.3 bits.
Mac and Windows 0.9+ builds looked good.

|  | [Tracy Walker [:tracy]](/user_profile?user_id=18566) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=250906#c33)• 20 years ago |
|  | |

just tested with the ftp test in [comment #3](/show_bug.cgi?id=250906#c3 "NEW - null (%00) in filename fakes extension (ftp, file)") and this passed on linux ff 0.9.3

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=250906#c34)• 20 years ago |
|  | |

(In reply to [comment #32](/show_bug.cgi?id=250906#c32 "NEW - null (%00) in filename fakes extension (ftp, file)"))
Note: your test is for file URIs (how did this bug morph?). Anyway, the word
from jst is (transcribed from #developers on IRC):
Jul 29 22:14:20 <caillon> jst, yt?
Jul 29 22:17:18 <jst> caillon: y
Jul 29 22:18:19 <caillon> jst, is 250906 ready for landing?
Jul 29 22:18:41 <caillon> jst, ([comment 19](/show_bug.cgi?id=250906#c19 "NEW - null (%00) in filename fakes extension (ftp, file)") and 20 seem to say no...)
Jul 29 22:21:06 <jst> caillon: Yeah, the ftp: part of that bug is ready... we
kinda don't care about file: for now, since you can't link to that from web
content anyways
Jul 29 22:21:21 <jst> caillon: that part should of course be fixed too, at
some point
Jul 29 22:21:38 <caillon> jst, ok that's what i thought.
Jul 29 22:21:46 <caillon> jst, i just wanted to make sure before i started
backporting it

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=250906#a2080297_32335)• 20 years ago |

Keywords: [fixed1.4.3](/buglist.cgi?keywords=fixed1.4.3&resolution=---)

|  | [Asa Dotzler [:asa]](/user_profile?user_id=5003) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=250906#a2714208_5003)• 20 years ago |

Flags: blocking1.7.3?Flags: blocking-aviary1.0?

|  | [Asa Dotzler [:asa]](/user_profile?user_id=5003) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=250906#a3290374_5003)• 20 years ago |

[Attachment #154673](/attachment.cgi?id=154673&action=edit "Prevent creation of ftp: URI's with nulls in them") -
Flags: approval1.4.3?

|  | [Zarco Zwier](/user_profile?user_id=54957) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=250906#c35)• 20 years ago |
|  | |

The NULL bug is still present in Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;
rv:1.7.5) Gecko/20041107 Firefox/1.0
This is a security bug, so why has it been fixed, you guys?
I think %00 should be omitted in every URL, unless there's a legitemate use for it.
Just my 2 euro cents

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=250906#a58672047_103593)• 19 years ago |

QA Contact: xpcom

|  | [Doug Turner (:dougt)](/user_profile?user_id=302291) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=250906#c36)• 17 years ago |
|  | |

mass reassigning to nobody.Assignee: dougt → nobody

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=250906#c37)• 12 years ago |
|  | |

Mavericks, are you interested in taking a crack at this bug? It's not clear to me what part was fixed and what's left.

|  | [Shriram (irc: Mavericks)](/user_profile?user_id=336645) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=250906#c38)• 12 years ago |
|  | |

Tested as per [comment #28](/show_bug.cgi?id=250906#c28 "NEW - null (%00) in filename fakes extension (ftp, file)") on FF 18.0.2 on Win Vista Basic(x86)
file://<path>.txt shows text file as is
file://<path>.txt%00.html does nothing

|  | [Shriram (irc: Mavericks)](/user_profile?user_id=336645) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=250906#c39)• 12 years ago |
|  | |

Attached patch

[Patch that prevents null(%00) and addresses windows specific issues in file url](attachment.cgi?id=725268&action=diff)
— [Details](attachment.cgi?id=725268&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=725268)

Builds on top of Pavel's patch 153078
Compiles and pending testing.
Some testcases are at <http://www-archive.mozilla.org/quality/networking/testing/filetests.html> and few more mentioned in [comment #20](/show_bug.cgi?id=250906#c20 "NEW - null (%00) in filename fakes extension (ftp, file)")
[Attachment #725268](/attachment.cgi?id=725268&action=edit "Patch that prevents null(%00) and addresses windows specific issues in file url") -
Flags: review?(benjamin)

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=250906#a274044302_7044)• 12 years ago |

[Attachment #725268](/attachment.cgi?id=725268&action=edit "Patch that prevents null(%00) and addresses windows specific issues in file url") -
Flags: review?(benjamin) → review?(jduell.mcbugs)

|  | [Jason Duell](/user_profile?user_id=334931) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=250906#c40)• 12 years ago |
|  | |

Comment on [attachment 725268](/attachment.cgi?id=725268 "Patch that prevents null(%00) and addresses windows specific issues in file url") [[details]](/attachment.cgi?id=725268&action=edit "Patch that prevents null(%00) and addresses windows specific issues in file url") [[diff]](/attachment.cgi?id=725268&action=diff "Patch that prevents null(%00) and addresses windows specific issues in file url") [[review]](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=725268)
Patch that prevents null(%00) and addresses windows specific issues in file url
Review of [attachment 725268](/attachment.cgi?id=725268 "Patch that prevents null(%00) and addresses windows specific issues in file url") [[details]](/attachment.cgi?id=725268&action=edit "Patch that prevents null(%00) and addresses windows specific issues in file url") [[diff]](/attachment.cgi?id=725268&action=diff "Patch that prevents null(%00) and addresses windows specific issues in file url") [[review]](/page.cgi?id=splinter.html&ignore=&bug=250906&attachment=725268):
-----------------------------------------------------------------
Mostly seems good, though it seems we're only fixing checking for "." and ".." here, not %00? I'm also not the right reviewer for the forbidden name stuff.
Given that this bug already has patches that landed in 2004 in Firefox 0.9 :) we should definitely move this new patch into a new bug (please CC me on it). You also need a test--an xpcshell test shouldn't be too hard to write, and it looks like netwerk/test/unit/test\_bug396389.js has the basic infrastructure.
::: netwerk/base/src/nsURLHelperUnix.cpp
@@ +82,5 @@
> + // test for bad stuff: missing leading /, /../, /./
> + nsACString::const\_iterator iter, end;
> + path.BeginReading(iter), path.EndReading(end);
> + int slashdotdot = 0;
> + if (iter == end || \*iter != '/') return NS\_ERROR\_MALFORMED\_URI;
put return statements on a new line.
@@ +85,5 @@
> + int slashdotdot = 0;
> + if (iter == end || \*iter != '/') return NS\_ERROR\_MALFORMED\_URI;
> + for (; iter != end; ++iter) {
> + if (\*iter == '/') {
> + if (slashdotdot == 3 || slashdotdot == 2) return NS\_ERROR\_MALFORMED\_URI;
Why do we allow slashdotdot == 1 here, too--is it important to allow "//"?
@@ +89,5 @@
> + if (slashdotdot == 3 || slashdotdot == 2) return NS\_ERROR\_MALFORMED\_URI;
> + slashdotdot = 1;
> + }
> + else if (\*iter == '.') {
> + if (slashdotdot > 0 && slashdotdot <= 3) ++slashdotdot;
I assume that clamping slashdotdot to 4 here and checking only for 2 or 3 above is so that you only fail for "." and "..", but allow "..." and "....", etc to be valid filenames? If true leave a comment saying that.
@@ +93,5 @@
> + if (slashdotdot > 0 && slashdotdot <= 3) ++slashdotdot;
> + }
> + else slashdotdot = 0;
> + }
> + //check for /. , /.., etc as filenames comprising of periods only are not allowed
Your code appear to allow names of 3 periods or more, so comment wrong?
::: netwerk/base/src/nsURLHelperWin.cpp
@@ +94,5 @@
> }
>
> NS\_UnescapeURL(path);
> +
> + // check for %00
Does this patch in fact check for %00? It seems to be checking mostly for "." and "..", the forbiddenChars checks are only on windows, and even there I don't see '\00' listed as a forbidden char.
@@ +114,5 @@
> + else if (\*iter == '.') {
> + if (slashdotdot > 0 && slashdotdot <= 3) ++slashdotdot;
> + }
> + else {
> + if ( forbiddenChars.FindChar(\*iter) != -1 ) return NS\_ERROR\_MALFORMED\_URI;
So the 20 lines or so of code here are common across unix/windows except for this check of forbiddenChars. It seems like you could just always check forbiddenChars (the list evaluates to empty on Unix, but it ought to work fine?) and stick this code in some common central location.
@@ +126,5 @@
> + // check for \con or \con.xyz
> + // CLOCK$ as filename or CLOCK$.txt's allowed on Win Vista
> + // XXX move it to proper location for reuse
> + static const char\* forbiddenNames[] = {
> + "COM1", "COM2", "COM3", "COM4", "COM5", "COM6", "COM7", "COM8","COM9", "LPT1", "LPT2", "LPT3", "LPT4", "LPT5", "LPT6", "LPT7","LPT8", "LPT9", "CON", "PRN", "AUX", "NUL" }; //"CLOCK$"
I'm not the right person to know if this magic list is correct. Not sure who the right reviewer is, either--sorry. Ask bsmedberg?
[Attachment #725268](/attachment.cgi?id=725268&action=edit "Patch that prevents null(%00) and addresses windows specific issues in file url") -
Flags: review?(jduell.mcbugs) → feedback+

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=250906#c41)• 2 years ago |
|  | |

In the process of [migrating remaining bugs to the new severity system](https://bugzilla.mozilla.org/show_bug.cgi?id=1789259), the severity for this bug cannot be automatically determined. Please retriage this bug using the [new severity system](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity).

Severity: critical → --

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=250906#c42)• 2 years ago |
|  | |

We don't support FTP anymore, so moving this to Networking: File - not sure if this is still an issue or not.

Component: XPCOM → Networking: File

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=250906#a587681525_505624)• 2 years ago |

Severity: -- → S3Priority: -- → P3Whiteboard: testcase wanted → testcase wanted [necko-triaged]

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=250906#c43)• 1 year ago |
|  | |

The %00 issue appears to have been fixed; testing per [comment 28](/show_bug.cgi?id=250906#c28 "NEW - null (%00) in filename fakes extension (ftp, file)") does not generate an alert.

That said, we could land an updated version of this patch. Question: should it guard against trying create a file: URL that ends in /. or /.. ? If you try to open those, you'll fail anyways.

Ditto with the checks for restricted characters and special names on Windows (CON, COM0, LPT1, etc) - do we want to restrict the ability to create a file: URL to those? Does it actually gain anything?

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=250906#c44)• 1 year ago |
|  | |

%00 was fixed in [bug 383478](/show_bug.cgi?id=383478 "RESOLVED FIXED - File type confusion vulnerability due to null bytes in URL (encoded as %00)")

Assignee: nobody → rjesupSee Also: → [CVE-2007-3285](/show_bug.cgi?id=383478 "RESOLVED FIXED - File type confusion vulnerability due to null bytes in URL (encoded as %00)")Whiteboard: testcase wanted [necko-triaged] → [necko-triaged]
You need to [log in](/show_bug.cgi?id=250906&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Pavel Kankovsky](/user_profile?user_id=146917)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from marc.info_4288f16a_20250125_200759.html ===

```
[[prev in list](?l=bugtraq&m=109889281711636&w=2)] [[next in list](?l=bugtraq&m=109892527321706&w=2)] [[prev in thread](?l=fedora-legacy-announce&m=109889271930515&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [[FLSA-2004:2089] Updated mozilla packages fix security vulnerabilities](?t=109889278700001&r=1&w=2)
From:       [Dominic Hargreaves <dom () earth ! li>](?a=102492850100003&r=1&w=2)
Date:       [2004-10-27 9:17:53](?l=bugtraq&r=1&w=2&b=200410)
Message-ID: [20041027091751.GA28216 () home ! thedom ! org](?i=20041027091751.GA28216%20()%20home%20!%20thedom%20!%20org)
[Download RAW [message](?l=bugtraq&m=109900315219363&q=mbox) or [body](?l=bugtraq&m=109900315219363&q=raw)]

-----------------------------------------------------------------------
               Fedora Legacy Update Advisory

Synopsis:          Updated mozilla resolves security vulnerabilities
Advisory ID:       FLSA:2089
Issue date:        2004-10-27
Product:           Red Hat Linux
Product:           Fedora Core
Keywords:          Security
Cross references:  <https://bugzilla.fedora.us/show_bug.cgi?id=2089>
CVE Names:         CAN-2003-0564, CAN-2004-0191, CAN-2003-0594,
                   CAN-2004-0722, CAN-2004-0597, CAN-2004-0599,
                   CAN-2004-0757, CAN-2004-0758, CAN-2004-0759,
                   CAN-2004-0760, CAN-2004-0718, CAN-2004-0761,
                   CAN-2004-0762, CAN-2004-0763, CAN-2004-0764,
                   CAN-2004-0765, CAN-2004-0905, CAN-2004-0904,
                   CAN-2004-0903, CAN-2004-0908, CAN-2004-0902
-----------------------------------------------------------------------

-----------------------------------------------------------------------
1. Topic:

Updated mozilla, galeon and epiphany packages that fix multiple
vulnerabilities are now available.

Mozilla is an open-source Web browser, designed for standards
compliance, performance, and portability.

2. Relevant releases/architectures:

Red Hat Linux 7.3 - i386
Red Hat Linux 9 - i386
Fedora Core 1 - i386

3. Problem description:

Note that some of these issues have already been fixed in Redhat 9 and
Fedora Core 1. Please refer to previous advisories for details.

NISCC testing of implementations of the S/MIME protocol uncovered a number
of bugs in NSS versions prior to 3.9. The parsing of unexpected ASN.1
constructs within S/MIME data could cause Mozilla to crash or consume large
amounts of memory. A remote attacker could potentially trigger these bugs
by sending a carefully-crafted S/MIME message to a victim. The Common
Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
CAN-2003-0564 to this issue.

Andreas Sandblad discovered a cross-site scripting issue that affects
various versions of Mozilla. When linking to a new page it is still
possible to interact with the old page before the new page has been
successfully loaded. Any Javascript events will be invoked in the context
of the new page, making cross-site scripting possible if the different
pages belong to different domains. The Common Vulnerabilities and
Exposures project (cve.mitre.org) has assigned the name CAN-2004-0191 to
this issue.

Flaws have been found in the cookie path handling between a number of Web
browsers and servers. The HTTP cookie standard allows a Web server
supplying a cookie to a client to specify a subset of URLs on the origin
server to which the cookie applies. Web servers such as Apache do not
filter returned cookies and assume that the client will only send back
cookies for requests that fall within the server-supplied subset of URLs.
However, by supplying URLs that use path traversal (/../) and character
encoding, it is possible to fool many browsers into sending a cookie to a
path outside of the originally-specified subset. The Common
Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
CAN-2003-0594 to this issue.

Zen Parse reported improper input validation to the SOAPParameter object
constructor leading to an integer overflow and controllable heap
corruption. Malicious JavaScript could be written to utilize this flaw and
could allow arbitrary code execution. The Common Vulnerabilities and
Exposures project (cve.mitre.org) has assigned the name CAN-2004-0722 to
this issue.

During a source code audit, Chris Evans discovered a buffer overflow and
integer overflows which affect the libpng code inside Mozilla. An attacker
could create a carefully crafted PNG file in such a way that it would cause
Mozilla to crash or execute arbitrary code when the image was viewed.
(CAN-2004-0597, CAN-2004-0599)

Zen Parse reported a flaw in the POP3 capability. A malicious POP3 server
could send a carefully crafted response that would cause a heap overflow
and potentially allow execution of arbitrary code as the user running
Mozilla. (CAN-2004-0757)

Marcel Boesch found a flaw that allows a CA certificate to be imported with
a DN the same as that of the built-in CA root certificates, which can cause
a denial of service to SSL pages, as the malicious certificate is treated
as invalid. (CAN-2004-0758)

Met - Martin Hassman reported a flaw in Mozilla that could allow malicious
Javascript code to upload local files from a users machine without
requiring confirmation. (CAN-2004-0759)

Mindlock Security reported a flaw in ftp URI handling. By using a NULL
character (%00) in a ftp URI, Mozilla can be confused into opening a
resource as a different MIME type. (CAN-2004-0760)

Mozilla does not properly prevent a frame in one domain from injecting
content into a frame that belongs to another domain, which facilitates
website spoofing and other attacks, also known as the frame injection
vulnerability. (CAN-2004-0718)

Tolga Tarhan reported a flaw that can allow a malicious webpage to use a
redirect sequence to spoof the security lock icon that makes a webpage
appear to be encrypted. (CAN-2004-0761)

Jesse Ruderman reported a security issue that affects a number of browsers
including Mozilla that could allow malicious websites to install arbitrary
extensions by using interactive events to manipulate the XPInstall Security
dialog box. (CAN-2004-0762)

Emmanouel Kellinis discovered a caching flaw in Mozilla which allows
malicious websites to spoof certificates of trusted websites via
redirects and Javascript that uses the "onunload" method. (CAN-2004-0763)

Mozilla allowed malicious websites to hijack the user interface via the
"chrome" flag and XML User Interface Language (XUL) files. (CAN-2004-0764)

The cert_TestHostName function in Mozilla only checks the hostname portion
of a certificate when the hostname portion of the URI is not a fully
qualified domain name (FQDN). This flaw could be used for spoofing if an
attacker had control of machines on a default DNS search path. (CAN-2004-0765)

Jesse Ruderman discovered a cross-domain scripting bug in Mozilla. If
a user is tricked into dragging a javascript link into another frame or
page, it becomes possible for an attacker to steal or modify sensitive
information from that site. Additionally, if a user is tricked into
dragging two links in sequence to another window (not frame), it is
possible for the attacker to execute arbitrary commands. The Common
Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
CAN-2004-0905 to this issue.

Gael Delalleau discovered an integer overflow which affects the BMP
handling code inside Mozilla. An attacker could create a carefully crafted
BMP file in such a way that it would cause Mozilla to crash or execute
arbitrary code when the image is viewed. The Common Vulnerabilities and
Exposures project (cve.mitre.org) has assigned the name CAN-2004-0904 to
this issue.

Georgi Guninski discovered a stack-based buffer overflow in the vCard
display routines. An attacker could create a carefully crafted vCard file
in such a way that it would cause Mozilla to crash or execute arbitrary
code when viewed. The Common Vulnerabilities and Exposures project
(cve.mitre.org) has assigned the name CAN-2004-0903 to this issue.

Wladimir Palant discovered a flaw in the way javascript interacts with
the clipboard. It is possible that an attacker could use malicious
javascript code to steal sensitive data which has been copied into the
clipboard. The Common Vulnerabilities and Exposures project
(cve.mitre.org) has assigned the name CAN-2004-0908 to this issue.

Georgi Guninski discovered a heap based buffer overflow in the "Send
Page" feature. It is possible that an attacker could construct a link in
such a way that a user attempting to forward it could result in a crash or
arbitrary code execution. The Common Vulnerabilities and Exposures project
(cve.mitre.org) has assigned the name CAN-2004-0902 to this issue.

4. Solution:

Before applying this update, make sure all previously released errata
relevant to your system have been applied.

To update all RPMs for your particular architecture, run:

rpm -Fvh [filenames]

where [filenames] is a list of the RPMs you wish to upgrade.  Only those
RPMs which are currently installed will be updated.  Those RPMs which are
not installed but included in the list will not be updated.  Note that you
can also use wildcards (*.rpm) if your current directory *only* contains
the desired RPMs.

Please note that this update is also available via yum and apt.  Many
people find this an easier way to apply updates.  To use yum issue:

yum update

or to use apt:

apt-get update; apt-get upgrade

This will start an interactive process that will result in the appropriate
RPMs being upgraded on your system.  This assumes that you have yum or
apt-get configured for obtaining Fedora Legacy content. Please visit
<http://www.fedoralegacy.org/docs/> for directions on how to configure yum
and apt-get.

5. Bug IDs fixed:

<http://bugzilla.fedora.us> - 1532 - Mozilla 1.4.2 fixes various vulns
<http://bugzilla.fedora.us> - 1834 - Mozilla < 1.4.3 multiple flaws
<http://bugzilla.fedora.us> - 2089 - Mozilla < 1.7.3 multiple flaws

6. RPMs required:

Red Hat Linux 7.3:

SRPM:
<http://download.fedoralegacy.org/redhat/7.3/updates/SRPMS/mozilla-1.4.3-0.7.1.legacy.src.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/SRPMS/galeon-1.2.13-0.7.1.legacy.src.rpm>

i386:
<http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-chat-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-devel-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-dom-inspector-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-js-debugger-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-mail-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-nspr-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-nspr-devel-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-nss-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/mozilla-nss-devel-1.4.3-0.7.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/7.3/updates/i386/galeon-1.2.13-0.7.1.legacy.i386.rpm>

Red Hat Linux 9:

SRPM:
<http://download.fedoralegacy.org/redhat/9/updates/SRPMS/mozilla-1.4.3-0.9.1.legacy.src.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/SRPMS/galeon-1.2.13-0.9.2.legacy.src.rpm>

i386:
<http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-chat-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-devel-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-dom-inspector-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-js-debugger-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-mail-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-nspr-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-nspr-devel-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-nss-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/mozilla-nss-devel-1.4.3-0.9.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/redhat/9/updates/i386/galeon-1.2.13-0.9.2.legacy.i386.rpm>

Fedora Core 1:

SRPM:

<http://download.fedoralegacy.org/fedora/1/updates/SRPMS/mozilla-1.4.3-1.fc1.1.legacy.src.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/SRPMS/epiphany-1.0.4-2.4.legacy.src.rpm>

i386:
<http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-chat-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-devel-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-dom-inspector-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-js-debugger-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-mail-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-nspr-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-nspr-devel-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-nss-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/mozilla-nss-devel-1.4.3-1.fc1.1.legacy.i386.rpm>
 <http://download.fedoralegacy.org/fedora/1/updates/i386/epiphany-1.0.4-2.4.legacy.i386.rpm>

7. Verification:

SHA1 sum                                 Package Name
---------------------------------------------------------------------------

8b26049e02b8ba752151edbbda3a7ac13550f419  \
redhat/7.3/updates/SRPMS/mozilla-1.4.3-0.7.1.legacy.src.rpm \
d21e84f5b3d17317424b521fe5bb6a1771187532  \
redhat/7.3/updates/SRPMS/galeon-1.2.13-0.7.1.legacy.src.rpm \
367a2c8360f0e8f984a63da7e3e6ccadc692341c  \
redhat/7.3/updates/i386/mozilla-1.4.3-0.7.1.legacy.i386.rpm \
3675dc6ec08f513dca4a56b5c26b2632d1d9081e  \
redhat/7.3/updates/i386/mozilla-chat-1.4.3-0.7.1.legacy.i386.rpm \
7765e5bf8d219a2337396b65e6983c79a44c9d7b  \
redhat/7.3/updates/i386/mozilla-devel-1.4.3-0.7.1.legacy.i386.rpm \
5e363fe99cbad7745de8e93b2420e7281a08c038  \
redhat/7.3/updates/i386/mozilla-dom-inspector-1.4.3-0.7.1.legacy.i386.rpm \
cffefef5b6b67d5e40a4f988503982af9a4cb49b  \
redhat/7.3/updates/i386/mozilla-js-debugger-1.4.3-0.7.1.legacy.i386.rpm \
e6d7563bf90f5f6bd4246e2b07097d37ac18e256  \
redhat/7.3/updates/i386/mozilla-mail-1.4.3-0.7.1.legacy.i386.rpm \
e04ab6de0904386e881541234a8604e6283fbd00  \
redhat/7.3/updates/i386/mozilla-nspr-1.4.3-0.7.1.legacy.i386.rpm \
a333e23e084b9d59488db7451b991b3775d3c774  \
redhat/7.3/updates/i386/mozilla-nspr-devel-1.4.3-0.7.1.legacy.i386.rpm \
0611c836e192bed899e30c261e17736c4a5a1b78  \
redhat/7.3/updates/i386/mozilla-nss-1.4.3-0.7.1.legacy.i386.rpm \
04789c2b7516018e0fdbae8c0c24edba98a373b7  \
redhat/7.3/updates/i386/mozilla-nss-devel-1.4.3-0.7.1.legacy.i386.rpm \
14287024fbe57fc555c5e8fa2736d2a708ae2dc6  \
redhat/7.3/updates/i386/galeon-1.2.13-0.7.1.legacy.i386.rpm

4cba85b2190de4bbd96505a0433cad388e3a2e26  \
redhat/9/updates/SRPMS/mozilla-1.4.3-0.9.1.legacy.src.rpm \
f5cf30105dbec5d0f24270e418141ba556df7db0  \
redhat/9/updates/SRPMS/galeon-1.2.13-0.9.2.legacy.src.rpm \
5623fba5418718a38eb47a334866833d5705f809  \
redhat/9/updates/i386/mozilla-1.4.3-0.9.1.legacy.i386.rpm \
17a567dc4151929cd998fa145631a939edb658ea  \
redhat/9/updates/i386/mozilla-chat-1.4.3-0.9.1.legacy.i386.rpm \
c94427f671fc72f3198c3947feb1a55e14cb285f  \
redhat/9/updates/i386/mozilla-devel-1.4.3-0.9.1.legacy.i386.rpm \
a11eecf474c891edcc64dcb07e85ffef0af17b42  \
redhat/9/updates/i386/mozilla-dom-inspector-1.4.3-0.9.1.legacy.i386.rpm \
eff086a513ad6a62c64e0f5875c8407e706360ed  \
redhat/9/updates/i386/mozilla-js-debugger-1.4.3-0.9.1.legacy.i386.rpm \
f11ac30cfc4ef65c0670c381f47b69a342e4db22  \
redhat/9/updates/i386/mozilla-mail-1.4.3-0.9.1.legacy.i386.rpm \
1b69070ca96ef10c60ce7fdb115b730bdf17a5ca  \
redhat/9/updates/i386/mozilla-nspr-1.4.3-0.9.1.legacy.i386.rpm \
aa8c04f0b2d3cefed5222c2940240ecfc3780315  \
redhat/9/updates/i386/mozilla-nspr-devel-1.4.3-0.9.1.legacy.i386.rpm \
5cf1c268091e7b88732e8efa58d48cf225e70800  \
redhat/9/updates/i386/mozilla-nss-1.4.3-0.9.1.legacy.i386.rpm \
6911b2dc76ef48c309c425bd2b8d620941b5c023  \
redhat/9/updates/i386/mozilla-nss-devel-1.4.3-0.9.1.legacy.i386.rpm \
d99fb9b15188b9d58ad67051cd3e3468ac02681c  \
redhat/9/updates/i386/galeon-1.2.13-0.9.2.legacy.i386.rpm

861196199b25fe56d2f2d990c4eb74fad537a643  \
fedora/1/updates/SRPMS/mozilla-1.4.3-1.fc1.1.legacy.src.rpm \
8dd0c2479974060a9b4c64e7fb7bb7bfe08bfca0  \
fedora/1/updates/SRPMS/epiphany-1.0.4-2.4.legacy.src.rpm \
346049a0d8835253ee9f97249b0ac834cb664bfc  \
fedora/1/updates/i386/mozilla-1.4.3-1.fc1.1.legacy.i386.rpm \
4898da95488b5fbb6962613c383f42faaf5ff4ba  \
fedora/1/updates/i386/mozilla-chat-1.4.3-1.fc1.1.legacy.i386.rpm \
edc0eeeaf12cc95c4838375c61140c0a12df423b  \
fedora/1/updates/i386/mozilla-devel-1.4.3-1.fc1.1.legacy.i386.rpm \
871e5ea09920d2844acd74188202c5f99b177bc9  \
fedora/1/updates/i386/mozilla-dom-inspector-1.4.3-1.fc1.1.legacy.i386.rpm \
75d8796d1e902fa56fc8665850a7027d189bd809  \
fedora/1/updates/i386/mozilla-js-debugger-1.4.3-1.fc1.1.legacy.i386.rpm \
08a55541cc0062892b4ae7e11f12ea041dfdc5c2  \
fedora/1/updates/i386/mozilla-mail-1.4.3-1.fc1.1.legacy.i386.rpm \
a00c8f63b2ac924794e533582adecd979ca5aebb  \
fedora/1/updates/i386/mozilla-nspr-1.4.3-1.fc1.1.legacy.i386.rpm \
a3e31f50a30ce3bb9d280bbcd0a941c2910534bd  \
fedora/1/updates/i386/mozilla-nspr-devel-1.4.3-1.fc1.1.legacy.i386.rpm \
df50478720c9430b1e9edbcd96323db6bf15c48b  \
fedora/1/updates/i386/mozilla-nss-1.4.3-1.fc1.1.legacy.i386.rpm \
ebefb845a937bca2c0655f5dd6d43bdf9759a871  \
fedora/1/updates/i386/mozilla-nss-devel-1.4.3-1.fc1.1.legacy.i386.rpm \
5885ec55134e6bffe7be6e0ec527b668e1f8b262  \
fedora/1/updates/i386/epiphany-1.0.4-2.4.legacy.i386.rpm

These packages are GPG signed by Fedora Legacy for security.  Our key is
available from <http://www.fedoralegacy> org/about/security.php

You can verify each package with the following command:

    rpm --checksig -v <filename>

If you only wish to verify that each package has not been corrupted or
tampered with, examine only the sha1sum with the following command:

    sha1sum <filename>

8. References:

<https://rhn.redhat.com/errata/RHSA-2004-110.html>
<https://rhn.redhat.com/errata/RHSA-2004-383.html>
<https://rhn.redhat.com/errata/RHSA-2004-486.html>

9. Contact:

The Fedora Legacy security contact is <secnotice@fedoralegacy.org>. More
project details at <http://www.fedoralegacy.org>

---------------------------------------------------------------------

[["signature.asc" (application/pgp-signature)]](?l=bugtraq&m=109900315219363&q=p3)

[[prev in list](?l=bugtraq&m=109889281711636&w=2)] [[next in list](?l=bugtraq&m=109892527321706&w=2)] [[prev in thread](?l=fedora-legacy-announce&m=109889271930515&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


