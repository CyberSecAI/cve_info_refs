Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2004-0244

**Root Cause of Vulnerability:**
- The vulnerability lies in the way Cisco 6000/6500/7600 series systems with Multilayer Switch Feature Card 2 (MSFC2) process layer 2 frames. Specifically, the system fails to properly handle layer 2 frames that are inconsistent with the length of the encapsulated layer 3 packet.

**Weaknesses/Vulnerabilities Present:**
- Improper handling of layer 2 frames with mismatched layer 3 packet lengths.
- Software processing flaw in layer 2 frame handling.

**Impact of Exploitation:**
- Denial-of-service (DoS).
- System freeze or reset, requiring manual reset to restore functionality.

**Attack Vectors:**
- Sending a specially crafted layer 2 frame with inconsistent length compared to the encapsulated layer 3 packet.
- Network-based attack by sending the malicious frame.

**Required Attacker Capabilities/Position:**
- Ability to craft and send network packets to the target system.
- Network connectivity to the vulnerable Cisco devices.

**Affected Systems:**
- Cisco 6000/6500/7600 series systems with MSFC2 and a FlexWAN or OSM module.
- Cisco 6000/6500/7600 series systems with MSFC2 running 12.1(8b)E14 even without a FlexWAN or OSM module.
- Affects both native and hybrid code configurations (Hybrid: CatOS on Supervisor Engine, Cisco IOS on MSFC. Native: Single IOS image on both).

**Unaffected Systems:**
- Cisco 6000/6500/7600 series systems with a Supervisor 720 are not affected.