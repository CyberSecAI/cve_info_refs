The provided content describes a vulnerability in `formmail.php`, which allows for arbitrary file uploads.

**Root cause of vulnerability:**
- The `formmail.php` script attempts to check the HTTP Referer to prevent unauthorized access but has a flaw allowing it to be bypassed. The script extracts the domain name from the Referer header using `explode("/",getenv("HTTP_REFERER"))`, taking the third element. If the referer is a simple URI without a path it will fail.  There is also a fallback `$_SERVER['HTTP_REFERER']` that will be parsed if `getenv("HTTP_REFERER")` fails, but this too is susceptible to bypass via a crafted URL.
- The file upload functionality does not adequately sanitize filenames and allows uploading files to a directory specified by the user via the `path_to_file` parameter. This also allows overwriting existing files or creating new files at the chosen location

**Weaknesses/vulnerabilities present:**
1.  **Referer Check Bypass**: The referer check is flawed and can be bypassed using methods described. If the referer header is not set or if the domain name of the referer is not in the approved list it will be considered an "unauthorized domain" and the function will exit. If no referers are configured it will always return true.
2. **Arbitrary File Upload**:  The script allows a user to specify the upload directory (`path_to_file`). This combined with a bypass of the referer check makes arbitrary file uploads possible.
3.  **Lack of Filename Sanitization**: The script doesn't properly sanitize uploaded filenames, which may allow for filename manipulation. The script does check if a file already exists at the provided path and if so adds a random number to the name.

**Impact of exploitation:**
- An attacker can upload arbitrary files, including potentially malicious scripts, to the server. This can lead to various forms of attacks:
   - Remote code execution (if the uploaded file is a script and can be executed)
   - Website defacement
   - Data theft
   - Denial of service (if the uploaded file is large)

**Attack vectors:**
- The attacker needs to craft a malicious form that submits a file to the `formmail.php` script while bypassing the Referer check. This can be done through a cross-site scripting vulnerability or via direct crafting of the HTTP request.

**Required attacker capabilities/position:**
- The attacker needs to be able to craft a malicious HTTP request, or be able to inject a malicious payload into a vulnerable page.
- The attacker does not need to be on the same network as the server.
- Knowledge of the `formmail.php` script location and parameters is required.

This report provides more detail than the official CVE description, detailing the root cause of the vulnerability, the flawed referer check, and the ability to control the upload location.