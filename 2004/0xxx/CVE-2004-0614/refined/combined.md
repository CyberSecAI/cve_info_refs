=== Content from marc.info_4a5efcd3_20250125_172902.html ===

```
[[prev in list](?l=bugtraq&m=108786444608208&w=2)] [[next in list](?l=bugtraq&m=108786396622284&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Multiple osTicket exploits!
From:       [Guy Pearce <dt_student () hotmail ! com>](?a=108786807200001&r=1&w=2)
Date:       [2004-06-21 5:01:22](?l=bugtraq&r=1&w=2&b=200406)
Message-ID: [20040621050122.5785.qmail () www ! securityfocus ! com](?i=20040621050122.5785.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=108786779500957&q=mbox) or [body](?l=bugtraq&m=108786779500957&q=raw)]

ATTENTION ALL SITES USING OSTICKET. PLEASE DISABLE UPLOADS.

June 17 2004. Multiple Problems with osTicket

Software Data:

OSTICKET, <http://www.osticket.com/>
"Need to test the system before you install? Then try our demo version of the latest \
release of osTicket. DEMO DISABLED"

Note: When a software group will not run their own program, you know it's not safe \
for you to run.

Problem:

CPanel and other webservers display directory listings of the /osticket/attachments \
folder. The documents here are private and often financial in nature.

Solution:

Disable directory listing, change osTicket upload code.

Details:

First look at a site using osticket
[www.example.com/osticket/](http://www.example.com/osticket/)

Create a new ticket and upload a file with ticket.

Visit
[www.example.com/osticket/attachments/](http://www.example.com/osticket/attachments/)

Now you see your uploaded file here. If you uploaded a PHP document containing

<?PHP
echo "<form action = ''><input type = 'text' name = 'cmd' value = '$cmd' size = \
'75'><BR>"; if (!$cmd)die;
system($cmd);
?>

You can now run commands on the server by clicking the script.

There's more:

The os ticket software limits the size of uploads by a "hidden" field in the submit \
form. A user can modify this and upload a file of ANY size possibly leading the site \
to be shut down if it has webspace or traffic limitations.

Extra:

About 2/3 of sites using the osTicket software do not have directory listings turned \
on. For the determined hacker they are not safe. When a file is uploaded, it is \
renamed ######_filename where # is a random number. Because there are no ip \
restrictions on number of tickets a user could upload the PHP script say 100 times \
then use another script to randomly guess numbers followed by _name. Then in a MAX of \
10k tries they will have hacked the server. This means that the other 2/3 of sites \
are hackable, just over a longer period of time.

I am sorry to all the servers that were hacked to discover this exploit. (funny joke)

Other:

Cpanel includes osticket. osticket is free. Sites can be found on google with the \
following url, changed around depending on what you want. \
<http://www.google.com./search?q=%22Main%22+%22Help%22+%22Support+Ticket+System%22+php+attachment&hl=en&lr=&ie=UTF-8&start=10&sa=N>
 osTicket requires sql and these exploits lead to the database login info being \
shown.

Greets: Jack, the general, [www.wehack.com](http://www.wehack.com)

~`TOBY`~

UPDATE JUNE 21ST

ITS NOT RANDOM NUMBERS ITS THE TICKET NUMBER YOU ARE GIVEN! ALL SERVERS ARE \
VULNERABLE

[[prev in list](?l=bugtraq&m=108786444608208&w=2)] [[next in list](?l=bugtraq&m=108786396622284&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


