Based on the provided content, here's an analysis of CVE-2004-0987:

**Root Cause of Vulnerability:**
- The vulnerability is a stack buffer overflow in the `process_menu()` function of yardradius.
- This occurs when copying the menu name from the `PW_STATE` attribute to the `menu_name` buffer using `strcpy`. The size of the input is not checked against the buffer's size, leading to a buffer overflow.

**Weaknesses/Vulnerabilities Present:**
- Stack-based buffer overflow
- Lack of input validation on the size of the menu name before copying it to a fixed-size buffer.
- Use of `strcpy`, which is known to be unsafe due to lack of bounds checking, instead of `strncpy`

**Impact of Exploitation:**
- Arbitrary code execution as root.

**Attack Vectors:**
- The vulnerability can be exploited remotely by sending a specially crafted RADIUS request with an overly long menu name in the `PW_STATE` attribute.
- No knowledge of the shared secret is required to trigger the vulnerability.

**Required Attacker Capabilities/Position:**
- The attacker must be able to send RADIUS requests to the vulnerable yardradius server.
- No special privileges on the server are needed.
- The attacker must be able to craft a specific RADIUS request.

**Additional Details:**

- The vulnerability is similar to one previously found in other RADIUS server implementations (CAN-2001-0534).
- A patch was created that replaces `strcpy` with `strncpy` and adds a null terminator to prevent the overflow.
- The fix was applied in version 1.0.20-2woody1 for the stable distribution and 1.0.20-15 for the unstable distribution.