=== Content from www.debian.org_9003cd38_20250125_084339.html ===


---

[[Date Prev](msg00207.html)][[Date Next](msg00209.html)]
[[Thread Prev](msg00207.html)][[Thread Next](msg00209.html)]
[[Date Index](maillist.html#00208)]
[[Thread Index](threads.html#00208)]

# [SECURITY] [DSA 598-1] New yardradius packages fix arbitrary code execution

---

* *To*: debian-security-announce@lists.debian.org (Debian Security Announcements)
* *Subject*: [SECURITY] [DSA 598-1] New yardradius packages fix arbitrary code execution
* *From*: joey@infodrom.org (Martin Schulze)
* *Date*: Thu, 25 Nov 2004 14:46:07 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/m1CXJwl-000okMC%40finlandia.Infodrom.North.DE)Â [m1CXJwl-000okMC@finlandia.Infodrom.North.DE](msg00208.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 598-1                     security@debian.org
<http://www.debian.org/security/>                             Martin Schulze
November 25th, 2004                     <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : yardradius
Vulnerability  : buffer overflow
Problem-Type   : remote
Debian-specific: no
CVE ID         : CAN-2004-0987
Debian Bug     : 278384

Max Vozeler noticed that yardradius, the YARD radius authentication
and accounting server, contained a stack overflow similar to the one
from radiusd which is referenced as CAN-2001-0534.  This could lead to
the execution of arbitrary code as root.

For the stable distribution (woody) this problem has been fixed in
version 1.0.20-2woody1.

For the unstable distribution (sid) this problem has been fixed in
version 1.0.20-15.

We recommend that you upgrade your yardradius package immediately.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.0 alias woody
- --------------------------------

  Source archives:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1.dsc>
      Size/MD5 checksum:      630 3aa3c2019a9a5114e0f531fe808e93b3
    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1.diff.gz>
      Size/MD5 checksum:     6768 f3643f6f13de7280c19e4c7df503ea11
    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20.orig.tar.gz>
      Size/MD5 checksum:   399573 787b1f8784c67cab2702839db6644b9b

  Alpha architecture:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1_alpha.deb>
      Size/MD5 checksum:   350220 e0274a5766e8c3d18800c06282727df1

  ARM architecture:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1_arm.deb>
      Size/MD5 checksum:   301448 06828b440337022ae6b1855fbae31f82

  Intel IA-32 architecture:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1_i386.deb>
      Size/MD5 checksum:   295412 4f56c4fdeca63b85808065b4f3e27a7f

  Intel IA-64 architecture:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1_ia64.deb>
      Size/MD5 checksum:   370222 36703ed2eed705e8e1a3397a3d88d427

  HP Precision architecture:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1_hppa.deb>
      Size/MD5 checksum:   312196 59888ec88aa91f6cf58dda032df8a5b5

  Motorola 680x0 architecture:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1_m68k.deb>
      Size/MD5 checksum:   289912 55788e327ca665e7ab889e82b8dec833

  Big endian MIPS architecture:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1_mips.deb>
      Size/MD5 checksum:   326438 6e7d29dd1ad61bffef233c031fe7e73c

  Little endian MIPS architecture:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1_mipsel.deb>
      Size/MD5 checksum:   327300 4a0a6d0009d271f458d2c7b87ea1a9f2

  PowerPC architecture:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1_powerpc.deb>
      Size/MD5 checksum:   302024 69d8d6a7d65e1dbd006309420926cb94

  IBM S/390 architecture:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1_s390.deb>
      Size/MD5 checksum:   298984 0551ab5072e14b3eeb81e23c3a4658df

  Sun Sparc architecture:

    <http://security.debian.org/pool/updates/main/y/yardradius/yardradius_1.0.20-2woody1_sparc.deb>
      Size/MD5 checksum:   325768 2edb916d3d3dda25e8919b32ba3e96ba

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)

iD8DBQFBpeIeW5ql+IAeqTIRAscOAJ0fC7lG+G5AI+KfRRZQWRBYTRThEwCgiEed
A/9d82Y3IM+zHtYA5Pn2Oyk=
=ctuq
-----END PGP SIGNATURE-----

```

---



=== Content from bugs.debian.org_58e22a0b_20250125_084337.html ===

# Debian Bug report logs - #278384 yardradius: security vulnerability still present in stable

[![version graph](version.cgi?height=2;width=2;collapse=1;package=yardradius;found=1.0.20-2;absolute=0)](version.cgi?package=yardradius;collapse=1;info=1;absolute=0;found=1.0.20-2)

Package:
[yardradius](pkgreport.cgi?package=yardradius);
Maintainer for [yardradius](pkgreport.cgi?package=yardradius) is [(unknown)](pkgreport.cgi?maint=);

Reported by: [Max Vozeler <max@hinterhof.net>](pkgreport.cgi?submitter=max%40hinterhof.net)

Date: Tue, 26 Oct 2004 14:48:05 UTC

Severity: *grave*

Tags: patch, security, woody

Found in version 1.0.20-2

**Done:** Max Vozeler <max@hinterhof.net>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=278384;mbox=yes), [status mbox](bugreport.cgi?bug=278384;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=278384;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Francesco Paolo Lovergine <frankie@debian.org>`:

`Bug#278384`; Package `yardradius`.
([full text](bugreport.cgi?bug=278384;msg=2), [mbox](bugreport.cgi?bug=278384;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Max Vozeler <max@hinterhof.net>`:

New Bug report received and forwarded. Copy sent to `Francesco Paolo Lovergine <frankie@debian.org>`.
([full text](bugreport.cgi?bug=278384;msg=4), [mbox](bugreport.cgi?bug=278384;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=278384;msg=5), [mbox](bugreport.cgi?bug=278384;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=max%40hinterhof.net)
From: Max Vozeler <max@hinterhof.net>
To: submit@bugs.debian.org
Subject: yardradius: security vulnerability still present in stable
Date: Tue, 26 Oct 2004 16:35:25 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=278384;msg=5) (text/plain, inline)]
```
```
Package: yardradius
Version: 1.0.20-2
Severity: grave
Tags: woody security patch

Hi,

yardradius in stable is still vulnerable to an exploitable stack
overflow in process_menu() that is already fixed in testing/unstable
version 1.0.20-15.

Attaching the patch below that I sent to Francesco and the Security
Team.

Cheers,
Max

--
308E81E7B97963BCA0E6ED889D5BD511B7CDA2DC

```
```
[[yardradius-secupdate.diff](bugreport.cgi?att=1;bug=278384;filename=yardradius-secupdate.diff;msg=5) (text/plain, inline)]
```
```
diff -ru yardradius-1.0.20/debian/changelog yardradius-1.0.20-secupdate/debian/changelog
--- yardradius-1.0.20/debian/changelog	Mon Sep  6 18:05:59 2004
+++ yardradius-1.0.20-secupdate/debian/changelog	Thu Oct 14 13:14:58 2004
@@ -1,3 +1,12 @@
+yardradius (1.0.20-2.1) stable-security; urgency=high
+
+  * [SECURITY] This update fixes a stack overflow in process_menu()
+    that could be exploited without knowledge of the shared secret.
+    A similar vulnerability existed and was fixed in other radiusd
+    implementations as part of CAN-2001-0534.
+
+ -- Security Team <XXX>  Thu, 14 Oct 2004 13:09:54 +0200
+
 yardradius (1.0.20-2) unstable; urgency=low

   * Added german, russian and italian templates for debconf.
diff -ru yardradius-1.0.20/src/menu.c yardradius-1.0.20-secupdate/src/menu.c
--- yardradius-1.0.20/src/menu.c	Mon Dec  4 10:25:45 2000
+++ yardradius-1.0.20-secupdate/src/menu.c	Thu Oct 14 13:06:57 2004
@@ -112,7 +112,8 @@
 	if((attr = get_attribute(authreq->request, PW_STATE)) !=
 		(VALUE_PAIR *)NULL && strncmp(attr->strvalue, "MENU=", 5) == 0){

-		strcpy(menu_name, &attr->strvalue[5]);
+		strncpy(menu_name, &attr->strvalue[5], sizeof(menu_name)-1);
+		menu_name[sizeof(menu_name)-1] = '\0';

 		/* The menu input is in the Password Field */
 		attr = get_attribute(authreq->request, PW_PASSWORD);

```

---

**Reply sent** to `Max Vozeler <max@hinterhof.net>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=278384;msg=7), [mbox](bugreport.cgi?bug=278384;mbox=yes;msg=7), [link](#6)).

---

**Notification sent** to `Max Vozeler <max@hinterhof.net>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=278384;msg=9), [mbox](bugreport.cgi?bug=278384;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 278384-done@bugs.debian.org ([full text](bugreport.cgi?bug=278384;msg=10), [mbox](bugreport.cgi?bug=278384;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=max%40hinterhof.net)
From: Max Vozeler <max@hinterhof.net>
To: 278384-done@bugs.debian.org
Subject: Re: Bug#278384: vulnerability fixed
Date: Fri, 3 Dec 2004 17:22:04 +0100
```
Just to confirm, this bug is fixed with the recent security update for
stable (DSA-598-1).

Cheers,
Max

--
308E81E7B97963BCA0E6ED889D5BD511B7CDA2DC

```

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=278384).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 08:43:37 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


