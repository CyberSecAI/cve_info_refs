=== Content from bugzilla.mozilla.org_1f2f054f_20250125_132358.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/252638)
* [XML](/show_bug.cgi?ctype=xml&id=252638)

Closed
[Bug 252638](/show_bug.cgi?id=252638)

Opened 21 years ago
Closed 20 years ago

# Form param hacking allows unprivileged users to remove bug's keywords

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Form param hacking allows unprivileged users to remove bug's keywords

## Categories

### (Bugzilla :: Creating/Changing Bugs, defect)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Creating%2FChanging%20Bugs#Creating%2FChanging%20Bugs)

Creating/Changing Bugs
▾

Bugzilla :: Creating/Changing Bugs
Creating, changing, and viewing bugs. `enter_bug.cgi, post_bug.cgi, show_bug.cgi, process_bug.cgi`
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Creating%2FChanging%20Bugs&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Creating%2FChanging%20Bugs&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Creating%2FChanging%20Bugs)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 2.16

## People

### (Reporter: clklein, Assigned: myk)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c8a27f1c79d0e7fafc8faa2c5ab6df3a?d=mm&size=40)  [myk](/user_profile?user_id=27300)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/23d0d4c04bc8671d216787a77d236d31?d=mm&size=40)  [clklein](/user_profile?user_id=142888)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

1 person

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [fixed in 2.16.7] [fixed in 2.18rc3] [fixed in 2.19.1])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[fixed in 2.16.7] [fixed in 2.18rc3] [fixed in 2.19.1]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [justdave](/user_profile?user_id=10297) | [approval](#c19 "20 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.18](#c19 "20 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.18 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [blocking2.18](#c3 "20 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | blocking2.18 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.16](#c19 "20 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.16 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [blocking2.16.7](#c3 "20 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | blocking2.16.7 | + |
| --- | --- | --- |
|  | approval5.0 | ? |
| --- | --- | --- |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 3 obsolete files)

| [patch v1: fixes problem?](/attachment.cgi?id=158934)  [20 years ago](#c7)  [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)   2.06 KB, patch |  | [Details](/attachment.cgi?id=158934&action=edit) | [Diff](/attachment.cgi?id=158934&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=158934) |
| --- | --- | --- |
| [patch v2: a better and more precise fix](/attachment.cgi?id=159050)  [20 years ago](#c8)  [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)   1.92 KB, patch | gerv : [review+](#c11 "20 years ago") | [Details](/attachment.cgi?id=159050&action=edit) | [Diff](/attachment.cgi?id=159050&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159050) |
| [patch v2 for 2.16](/attachment.cgi?id=159534)  [20 years ago](#c14)  [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)   1.75 KB, patch |  | [Details](/attachment.cgi?id=159534&action=edit) | [Diff](/attachment.cgi?id=159534&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159534) |
| [patch v3 (2.16): a more appropriate ordering of conditions for special check](/attachment.cgi?id=159536)  [20 years ago](#c15)  [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)   1.75 KB, patch | gerv : [review+](#a5241480_9911 "20 years ago") | [Details](/attachment.cgi?id=159536&action=edit) | [Diff](/attachment.cgi?id=159536&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159536) |
| [patch v3 (tip): a more appropriate ordering of conditions for special check](/attachment.cgi?id=159537)  [20 years ago](#c16)  [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)   1.96 KB, patch | gerv : [review+](#a5241653_9911 "20 years ago") | [Details](/attachment.cgi?id=159537&action=edit) | [Diff](/attachment.cgi?id=159537&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159537) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Casey Klein](/user_profile?user_id=142888)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=252638#c0)• 21 years ago |
|  | |

User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.6) Gecko/20040615 Firefox/0.8
Build Identifier: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.6) Gecko/20040615 Firefox/0.8
By tweaking the form parameters to process\_bug.cgi, it is possible for a user
with no permission bits (including reporter or assignee status) to remove the
keywords from a bug. process\_bug.cgi diffs the current value of each field from
@::log\_columns against the corresponding form parameter, and if the field is
being modified, determines if the user is allowed to change that field.
This works in most cases but ignores the effect of the 'keywordaction' field,
which may instruct the script to delete the specified keywords. This field is
only displayed on the "change multiple bugs" form, which requires edit-bugs
privs, but the parameter is still accessible by all users. URLs such as the
following allow any logged in user to delete any bug's keywords:
/process\_bug.cgi?id\_<bug\_id\_to\_change>=on&dontchange=--do\_not\_change--&product=--do\_not\_change--&keywords=<bug's\_current\_keywords>&keywordaction=delete&knob=none&component=--do\_not\_change--&version=<bug's\_current\_version>
Reproducible: Always
Steps to Reproduce:
1. Log in
2. Use above URL
Actual Results:
Keywords were deleted
Expected Results:
ThrowUserError("illegal\_change",...

|  | [Casey Klein](/user_profile?user_id=142888)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=252638#c1)• 20 years ago |
|  | |

The following parameter set also allows any user to delete a bug's keywords:
?process\_bug=id\_<bug\_id\_to\_change>=on&dontchange=--do\_not\_change--&product=--do\_not\_change--&keywordaction=makeexact&knob=none&component=--do\_not\_change--&version=<bug's\_current\_version>
Because $::FORM{'keywords'} does not exists() above, the script doesn't make
sure the user has the proper privileges.

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=252638#c2)• 20 years ago |
|  | |

I haven't confirmed this problem, and apologies if it has been discussed on IRC
or elsewhere, but 2 questions:
1) Should this be made a security issue until confirmed?
2) If confirmed, should it block 2.18?Flags: blocking2.18?

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=252638#c3)• 20 years ago |
|  | |

This is worth fixing in 2.16 if it's actually happening. Anyone had a chance to
test on landfill yet? (I can add privs if anyone needs them for testing)Flags: blocking2.18?Flags: blocking2.18+Flags: blocking2.16.7+Target Milestone: --- → Bugzilla 2.16

|  | [Casey Klein](/user_profile?user_id=142888)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=252638#c4)• 20 years ago |
|  | |

For the record, we're not even attempting to enforce any permissions on the CC
or dependency fields (according to the comment header above CheckCanChangeField()).

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=252638#c5)• 20 years ago |
|  | |

Confirmed on both 2.18rc3 and 2.16.5.
Marking security-sensitive; we normally mark permissions problems as such, don't
we? Dave: uncheck if you disagree.
Casey: would you agree that a fix would be to have an additional list of fields
to check as well as @::log\_columns? It could contain keywordaction to start
with, and any others we find.
Gerv
Group: webtools-securityStatus: UNCONFIRMED → NEWEver confirmed: true

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=252638#c6)• 20 years ago |
|  | |

Probably the best thing to do in this case is to specifically make the keywords
check run regardless of whether $new matches $old if keywordaction is set to
something other than donotchange...
Testing keywordaction itself probably wouldn't give us much, and would require
an additional test for keywords in CheckCanChangeField is somewhere were to
write keywords rules.

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=252638#c7)• 20 years ago |
|  | |

Attached patch

[patch v1: fixes problem?](attachment.cgi?id=158934&action=diff) (obsolete)
— [Details](attachment.cgi?id=158934&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=158934)

Here's a patch that should fix both problems. For the problem in [comment 0](/show_bug.cgi?id=252638#c0 "RESOLVED FIXED - Form param hacking allows unprivileged users to remove bug's keywords"), it
bypasses new==old checks when the keyword action isn't "makeexact" so that
CheckCanChangeField computes permissions for the "add" and "delete" keyword
actions (of which probably only the "delete" keyword action is dangerous).
For the problem in [comment 1](/show_bug.cgi?id=252638#c1 "RESOLVED FIXED - Form param hacking allows unprivileged users to remove bug's keywords"), it conditionally processes keyword changes only
if the "keywords" form field exists instead of unconditionally processing them
no matter what. This is consistent with CheckCanChangeField, which only checks
permissions for form fields that exist.
I haven't tested the patch yet. Also, passing $keywordaction to
CheckCanChangeField is hacky, so suggestions for improving that are welcome.

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a4697109_27300)• 20 years ago |

Whiteboard: patch awaiting testing and review

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=252638#c8)• 20 years ago |
|  | |

Attached patch

[patch v2: a better and more precise fix](attachment.cgi?id=159050&action=diff) (obsolete)
— [Details](attachment.cgi?id=159050&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159050)

This patch avoids hacky passing of $keywordaction and does a special check for
the case in question. I also added a simple conditional to set $keywordaction
to the default if it isn't one of the acceptable values, since otherwise the
CGI accepts any value for that field, which could cause problems.
[Attachment #158934](/attachment.cgi?id=158934&action=edit "patch v1: fixes problem?") -
Attachment is obsolete: true

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=252638#c9)• 20 years ago |
|  | |

Comment on [attachment 159050](/attachment.cgi?id=159050 "patch v2: a better and more precise fix") [[details]](/attachment.cgi?id=159050&action=edit "patch v2: a better and more precise fix") [[diff]](/attachment.cgi?id=159050&action=diff "patch v2: a better and more precise fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159050)
patch v2: a better and more precise fix
Gerv, how does this look?
[Attachment #159050](/attachment.cgi?id=159050&action=edit "patch v2: a better and more precise fix") -
Flags: review?(gerv)

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a4783512_27300)• 20 years ago |

Whiteboard: patch awaiting testing and review → patch awaiting review

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=252638#c10)• 20 years ago |
|  | |

Note that a more robust solution would be to do all the adding/deleting before
we reach CheckCanChangeField so that by the time we authorize the change we have
an exact string to which the keywords are being set and don't have to make a
funky CheckCanChangeField call for this special case.
That's more robust because it uses CheckCanChangeField exactly as intended and
doesn't special case this known vulnerability while potentially overlooking some
unknown vulnerability that may be lurking out there. It's also significantly
more and riskier work. So I suggest we go with the immediate fix for the known
vulnerability, at least for 2.18, and plan to do the more robust fix down the road.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=252638#c11)• 20 years ago |
|  | |

Comment on [attachment 159050](/attachment.cgi?id=159050 "patch v2: a better and more precise fix") [[details]](/attachment.cgi?id=159050&action=edit "patch v2: a better and more precise fix") [[diff]](/attachment.cgi?id=159050&action=diff "patch v2: a better and more precise fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159050)
patch v2: a better and more precise fix
r=gerv. Looks good.
Gerv
[Attachment #159050](/attachment.cgi?id=159050&action=edit "patch v2: a better and more precise fix") -
Flags: review?(gerv) → review+

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=252638#c12)• 20 years ago |
|  | |

Comment on [attachment 159050](/attachment.cgi?id=159050 "patch v2: a better and more precise fix") [[details]](/attachment.cgi?id=159050&action=edit "patch v2: a better and more precise fix") [[diff]](/attachment.cgi?id=159050&action=diff "patch v2: a better and more precise fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159050)
patch v2: a better and more precise fix
r=gerv. Looks good.
Gerv

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=252638#c13)• 20 years ago |
|  | |

This patch doesn't apply cleanly to the 2.16 branch, and merging it doesn't
appear to be exactly straightforward... anyone care to cook up something like
this for 2.16?Flags: approval?Flags: approval2.18?Whiteboard: patch awaiting review → [wanted for 2.16.7] [ready for 2.18rc3] [ready for 2.19.1]

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=252638#c14)• 20 years ago |
|  | |

Attached patch

[patch v2 for 2.16](attachment.cgi?id=159534&action=diff) (obsolete)
— [Details](attachment.cgi?id=159534&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159534)

Here's a patch that applies to 2.16. CheckCanChangeField generates the error
message on 2.16 instead of just passing back a boolean value, so we can't just
pass it two unequal values and then generate an appropriate error message when
it returns. Instead, we have to send it the actual values to check, so I send
back the current keywords as the old value and an empty string as the new
value.
This makes the error message harder to read (because it tells you that you
tried to change the keywords from some value to an almost invisible space), but
it plugs the security hole, doesn't open up a new one (as it could if we were
to pass "no keywords" as the new value and an installation had "no" and
"keywords" keywords), and the error message is the same as the generic field
checking code generates for all fields.
Note that I avoid running the special check if the user selected the "delete"
keyword action but didn't enter any keywords to delete. We shouldn't error out
in that case since the user isn't actually deleting any keywords. I'll add
this to my tip patch as well.

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=252638#c15)• 20 years ago |
|  | |

Attached patch

[patch v3 (2.16): a more appropriate ordering of conditions for special check](attachment.cgi?id=159536&action=diff)
— [Details](attachment.cgi?id=159536&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159536)

This patch checks for the existence of the form field before checking to see if
there's anything in the keywordlist. I could probably drop the former check,
since the latter assumes it, but let's not assume.

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a5215515_27300)• 20 years ago |

[Attachment #159534](/attachment.cgi?id=159534&action=edit "patch v2 for 2.16") -
Attachment is obsolete: true

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=252638#c16)• 20 years ago |
|  | |

Attached patch

[patch v3 (tip): a more appropriate ordering of conditions for special check](attachment.cgi?id=159537&action=diff)
— [Details](attachment.cgi?id=159537&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159537)

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a5215620_27300)• 20 years ago |

[Attachment #159050](/attachment.cgi?id=159050&action=edit "patch v2: a better and more precise fix") -
Attachment is obsolete: true

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a5215653_27300)• 20 years ago |

[Attachment #159536](/attachment.cgi?id=159536&action=edit "patch v3 (2.16): a more appropriate ordering of conditions for special check") -
Attachment description: patch v3: a more appropriate ordering of conditions for special check → patch v3 (2.16): a more appropriate ordering of conditions for special check

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=252638#c17)• 20 years ago |
|  | |

Comment on [attachment 159537](/attachment.cgi?id=159537 "patch v3 (tip): a more appropriate ordering of conditions for special check") [[details]](/attachment.cgi?id=159537&action=edit "patch v3 (tip): a more appropriate ordering of conditions for special check") [[diff]](/attachment.cgi?id=159537&action=diff "patch v3 (tip): a more appropriate ordering of conditions for special check") [[review]](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159537)
patch v3 (tip): a more appropriate ordering of conditions for special check
Gerv, could you review this one-line addition to the patch you previously
reviewed? See [comment 15](/show_bug.cgi?id=252638#c15 "RESOLVED FIXED - Form param hacking allows unprivileged users to remove bug's keywords") and the last paragraph in [comment 14](/show_bug.cgi?id=252638#c14 "RESOLVED FIXED - Form param hacking allows unprivileged users to remove bug's keywords") for the details
on the change.
[Attachment #159537](/attachment.cgi?id=159537&action=edit "patch v3 (tip): a more appropriate ordering of conditions for special check") -
Flags: review?(gerv)

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=252638#c18)• 20 years ago |
|  | |

Comment on [attachment 159536](/attachment.cgi?id=159536 "patch v3 (2.16): a more appropriate ordering of conditions for special check") [[details]](/attachment.cgi?id=159536&action=edit "patch v3 (2.16): a more appropriate ordering of conditions for special check") [[diff]](/attachment.cgi?id=159536&action=diff "patch v3 (2.16): a more appropriate ordering of conditions for special check") [[review]](/page.cgi?id=splinter.html&ignore=&bug=252638&attachment=159536)
patch v3 (2.16): a more appropriate ordering of conditions for special check
Gerv, can you review this version of the patch for 2.16? Changes from the tip
version are minor and detailed in [comment 14](/show_bug.cgi?id=252638#c14 "RESOLVED FIXED - Form param hacking allows unprivileged users to remove bug's keywords").
[Attachment #159536](/attachment.cgi?id=159536&action=edit "patch v3 (2.16): a more appropriate ordering of conditions for special check") -
Flags: review?(gerv)

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a5216083_27300)• 20 years ago |

Whiteboard: [wanted for 2.16.7] [ready for 2.18rc3] [ready for 2.19.1] → [awaiting review for 2.16.7] [ready for 2.18rc3] [ready for 2.19.1]

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a5241480_9911)• 20 years ago |

[Attachment #159536](/attachment.cgi?id=159536&action=edit "patch v3 (2.16): a more appropriate ordering of conditions for special check") -
Flags: review?(gerv) → review+

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a5241544_9911)• 20 years ago |

[Attachment #159537](/attachment.cgi?id=159537&action=edit "patch v3 (tip): a more appropriate ordering of conditions for special check") -
Flags: review?(gerv) → review+

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a5241652_9911)• 20 years ago |

[Attachment #159537](/attachment.cgi?id=159537&action=edit "patch v3 (tip): a more appropriate ordering of conditions for special check") -
Flags: review+ → review?(gerv)

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a5241653_9911)• 20 years ago |

[Attachment #159537](/attachment.cgi?id=159537&action=edit "patch v3 (tip): a more appropriate ordering of conditions for special check") -
Flags: review?(gerv) → review+

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a5281501_27300)• 20 years ago |

Flags: approval2.16?Whiteboard: [awaiting review for 2.16.7] [ready for 2.18rc3] [ready for 2.19.1] → [ready for 2.16.7] [ready for 2.18rc3] [ready for 2.19.1]

|  | [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a5466116_27300)• 20 years ago |

Blocks: [261303](/show_bug.cgi?id=261303 "RESOLVED WORKSFORME - add/delete keywords before checking user's authorization to change field")

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=252638#c19)• 20 years ago |
|  | |

Checked in on trunk:
Checking in process\_bug.cgi;
/cvsroot/mozilla/webtools/bugzilla/process\_bug.cgi,v <-- process\_bug.cgi
new revision: 1.215; previous revision: 1.214
done
and 2.18 branch:
Checking in process\_bug.cgi;
/cvsroot/mozilla/webtools/bugzilla/process\_bug.cgi,v <-- process\_bug.cgi
new revision: 1.205.2.5; previous revision: 1.205.2.4
done
and 2.16 branch:
Checking in process\_bug.cgi;
/cvsroot/mozilla/webtools/bugzilla/process\_bug.cgi,v <-- process\_bug.cgi
new revision: 1.125.2.11; previous revision: 1.125.2.10
done
Status: NEW → RESOLVEDClosed: 20 years agoFlags: approval?Flags: approval2.18?Flags: approval2.18+Flags: approval2.16?Flags: approval2.16+Flags: approval+Resolution: --- → FIXEDWhiteboard: [ready for 2.16.7] [ready for 2.18rc3] [ready for 2.19.1] → [fixed in 2.16.7] [fixed in 2.18rc3] [fixed in 2.19.1]

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=252638#c20)• 20 years ago |
|  | |

advisory has posted, clearing security flagGroup: webtools-security

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a8188919_10297)• 20 years ago |

No longer blocks: [261303](/show_bug.cgi?id=261303 "RESOLVED WORKSFORME - add/delete keywords before checking user's authorization to change field")

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=252638#a265376769_1)• 12 years ago |

QA Contact: matty\_is\_a\_geek → default-qa
You need to [log in](/show_bug.cgi?id=252638&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Myk Melez [:myk] [@mykmelez]](/user_profile?user_id=27300)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from marc.info_3f063847_20250125_132356.html ===

```
[[prev in list](?l=bugtraq&m=109874007329345&w=2)] [[next in list](?l=bugtraq&m=109874696719847&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [BUGZILLA] Vulnerabilities in Bugzilla 2.16.6 and 2.18rc2
From:       [David Miller <justdave () bugzilla ! org>](?a=106784495000001&r=1&w=2)
Date:       [2004-10-25 11:08:47](?l=bugtraq&r=1&w=2&b=200410)
Message-ID: [417CDEBF.80506 () bugzilla ! org](?i=417CDEBF.80506%20()%20bugzilla%20!%20org)
[Download RAW [message](?l=bugtraq&m=109872095201238&q=mbox) or [body](?l=bugtraq&m=109872095201238&q=raw)]

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Bugzilla Security Advisory
October 24, 2004

Summary
=======

Bugzilla is a Web-based bug-tracking system, used by a large number of
software projects.

This advisory covers three security bugs that have recently been
discovered and fixed in the Bugzilla code: In the stable 2.16 releases,
it is possible to make a specific change to a bug without permissions;
and in the 2.18 release candidate, there are information leaks with
private attachments and comments.  We are not aware of any occasions
where any of these vulnerabilities have been exploited.

All Bugzilla installations are advised to upgrade to the latest stable
version of Bugzilla, 2.16.7, or to the current 2.18 release candidates,
2.18rc3, which were released today.

Development snapshots and version 2.18 release candidates prior to
version 2.18rc3 are also affected, so if you are using a development
snapshot or 2.18 release candidate, you should obtain a newer one
(2.18rc3) or use CVS to update.

Vulnerability Details
=====================

Issue 1
- -------
Class:       Unauthorized Bug Change
Versions:    2.9 through 2.18rc2 and 2.19(from cvs)
Description: It is possible to send a carefully crafted HTTP POST
~             message to process_bug.cgi which will remove keywords from
~             a bug even if you don't have permissions to edit all bug
~             fields (the "editbugs" permission).  Such changes are
~             reported in "bug changed" email notifications, so they are
~             easily detected and reversed if someone abuses it.
Reference:   <https://bugzilla.mozilla.org/show_bug.cgi?id=252638>

Issue 2
- -------
Class:       Information Leak
Versions:    2.17.1 through 2.18rc2 and 2.19(from cvs) (2.16-based
~             releases and earlier are not affected)
Description: Exporting a bug to XML exposes user comments and attachment
~             summaries which are marked as private to users who are not
~             members of the group allowed to see private comments and
~             attachments.  XML export is not exposed in the user
~             interface, but is available to anyone who knows the correct
~             URL to invoke it.  This only affects sites that use the
~             'insidergroup' feature.
Reference:   <https://bugzilla.mozilla.org/show_bug.cgi?id=263780>

Issue 3
- -------
Class:       Information Leak
Versions:    2.17.1 through 2.18rc2 and 2.19(from cvs) (2.16-based
~             releases and earlier are not affected)
Description: Changes to the metadata (filename, description, mime type,
~             review flags) on attachments which were flagged as private
~             get displayed to users who are not members of the group
~             allowed to see private attachments when viewing the bug
~             activity log and when receiving bug change notification
~             mails.  This only affects sites that use the 'insidergroup'
~             feature.
References:  <https://bugzilla.mozilla.org/show_bug.cgi?id=250605>
~             <https://bugzilla.mozilla.org/show_bug.cgi?id=253544>

Vulnerability Solutions
=======================

The fixes for all of the security bugs mentioned in this advisory are
included in the 2.16.7 and 2.18rc3 releases, and in the 2.19.1
development snapshot.  Upgrading to these releases will protect
installations from possible exploits of these issues.

Full release downloads, patches to upgrade Bugzilla to 2.16.7 from
previous 2.16.x versions, and CVS upgrade instructions are available at:
~  <http://www.bugzilla.org/download/>

Specific patches for each of the individual issues can be found on the
corresponding bug reports for each issue, at the URL given in the
reference for that issue in the list above.

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix
these situations:

Michael Whitfield
Joel Peshkin
Casey Klein
Myk Melez

General information about the Bugzilla bug-tracking system can be found
at <http://www.bugzilla.org/>

Comments and follow-ups can be directed to the
netscape.public.mozilla.webtools newsgroup or the mozilla-webtools
mailing list; <http://www.bugzilla.org/support/> has directions for
accessing these forums.

- -30-

- --
Dave Miller      Project Leader, Bugzilla Bug Tracking System
<http://www.justdave.net/>             <http://www.bugzilla.org/>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.2 (Darwin)
Comment: Using GnuPG with Thunderbird - <http://enigmail.mozdev.org>

iD8DBQFBfN6/0YeDAOcbS44RAvirAJ99cbiFQj9uuF3XjZWRHqQMZDlebgCghu7D
htGWOrR2hzC2mh52Z2iXjwU=
=IYxd
-----END PGP SIGNATURE-----
[[prev in list](?l=bugtraq&m=109874007329345&w=2)] [[next in list](?l=bugtraq&m=109874696719847&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


