## CVE-2004-1080

The provided content contains information about CVE-2004-1080.

### Vulnerability Description
The vulnerability is a remote code execution vulnerability present in the Microsoft Windows Internet Naming Service (WINS) due to how it handles association context validation.

### Root Cause
The vulnerability occurs due to insufficient validation of the association context data structure in the WINS replication protocol. A specially crafted replication packet sent to a vulnerable WINS server can cause a heap-based buffer overflow by writing arbitrary data to WINS server process memory.

### Affected Systems
The vulnerability affects the following Microsoft Windows versions:
*   Microsoft Windows NT 4.0 Server
*   Microsoft Windows NT Server 4.0 Terminal Server Edition
*   Windows 2000 Server
*   Windows Server 2003

Windows 2000 Professional, Windows XP and Windows Millennium Edition (ME) are not affected.

### Impact
A remote, unauthenticated attacker can exploit this vulnerability to:
*   Execute arbitrary code with SYSTEM privileges.
*   Cause a denial-of-service (DoS) condition.

### Attack Vector
An attacker can exploit this vulnerability by sending a specially crafted network packet to a vulnerable WINS server via TCP port 42.

### Required Attacker Capabilities
The attacker needs to be able to send network packets to a WINS server.

### Mitigation
*   Apply the patch provided in Microsoft Security Bulletin MS04-045.
*   Block TCP and UDP port 42 at the firewall.
*   Use IPSec to secure traffic between WINS server replication partners.
*   Remove the WINS service if it is not needed.