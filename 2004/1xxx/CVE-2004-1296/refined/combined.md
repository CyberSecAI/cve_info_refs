=== Content from bugs.debian.org_11d31e24_20250124_220206.html ===

# Debian Bug report logs - #286372 eqn2graph: Vulnerable to symlink attack through temporary file

[![version graph](version.cgi?found=1.18.1.1-3;absolute=0;collapse=1;width=2;fixed=groff%2F1.18.1.1-5;height=2;package=groff)](version.cgi?found=1.18.1.1-3;package=groff;collapse=1;absolute=0;fixed=groff%2F1.18.1.1-5;info=1)

Package:
[groff](pkgreport.cgi?package=groff);
Maintainer for [groff](pkgreport.cgi?package=groff) is [Colin Watson <cjwatson@debian.org>](pkgreport.cgi?maint=cjwatson%40debian.org); Source for [groff](pkgreport.cgi?package=groff) is [src:groff](pkgreport.cgi?src=groff) ([PTS](https://tracker.debian.org/pkg/groff), [buildd](https://buildd.debian.org/groff), [popcon](https://qa.debian.org/popcon.php?package=groff)).

Reported by: [Javier Fernández-Sanguino Peña <jfs@computer.org>](pkgreport.cgi?submitter=jfs%40computer.org)

Date: Sun, 19 Dec 2004 22:33:03 UTC

Severity: *grave*

Tags: security

Found in version 1.18.1.1-3

Fixed in version groff/1.18.1.1-5

**Done:** Steve Langasek <vorlon@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=286372;mbox=yes), [status mbox](bugreport.cgi?bug=286372;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=286372;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Colin Watson <cjwatson@debian.org>`:

`Bug#286372`; Package `groff`.
([full text](bugreport.cgi?bug=286372;msg=2), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Javier Fernández-Sanguino Peña <jfs@computer.org>`:

New Bug report received and forwarded. Copy sent to `Colin Watson <cjwatson@debian.org>`.
([full text](bugreport.cgi?bug=286372;msg=4), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=286372;msg=5), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=jfs%40computer.org)
From: Javier Fernández-Sanguino Peña <jfs@computer.org>
To: submit@bugs.debian.org
Subject: eqn2graph: Vulnerable to symlink attack through temporary file
Date: Sun, 19 Dec 2004 23:19:53 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=286372;msg=5) (text/plain, inline)]
```
```
Package: groff
Version: 1.18.1.1-3
Priority: important
Tags: security

The eqn2graph script does not protect itself from temporary filename
attacks since it creates file in an insecure manner (the process PID
is not suffient to avoid and attack) and does not check
if the temporary file it uses exists before using them.

The attached patch fixes this behaviour.

Regards

Javier

PS: I initially reported this to the security team back in June,
but have not found time to follow up on this issue until today.
Security team, please check
Resent-Message-ID: <20040624124521.GA10101@dat.etsit.upm.es>

```
```
[[eqn2graph.diff](bugreport.cgi?att=1;bug=286372;filename=eqn2graph.diff;msg=5) (text/plain, attachment)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#286372`; Package `groff`.
([full text](bugreport.cgi?bug=286372;msg=7), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `Colin Watson <cjwatson@debian.org>`:

Extra info received and forwarded to list.
([full text](bugreport.cgi?bug=286372;msg=9), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 286372@bugs.debian.org ([full text](bugreport.cgi?bug=286372;msg=10), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=cjwatson%40debian.org)
From: Colin Watson <cjwatson@debian.org>
To: Javier Fernández-Sanguino Peña <jfs@computer.org>,
286371@bugs.debian.org, 286372@bugs.debian.org
Subject: Re: Bug#286371: pic2graph: Vulnerable to symlink attack through temporary file
Date: Mon, 20 Dec 2004 15:20:40 +0000
```
On Sun, Dec 19, 2004 at 11:18:13PM +0100, Javier Fernández-Sanguino Peña wrote:
> Package: groff
> Version: 1.18.1.1-3
> Priority: important
> Tags: security
>
> The pic2graph script does not protect itself from temporary filename
> attacks since it creates file in an insecure manner (the process PID
> is not suffient to avoid and attack) and does not check
> if the temporary file it uses exists before using them.
>
> The attached patch fixes this behaviour.

Thanks. This and #286372 were both fixed upstream a while back in a
somewhat more elaborate way, so I'm taking their patch.

> PS: I initially reported this to the security team back in June,
> but have not found time to follow up on this issue until today.
> Security team, please check
> Resent-Message-ID: <20040624124521.GA10101@dat.etsit.upm.es>

groff in stable didn't have either pic2graph or eqn2graph; they were new
features in 1.18. The security team (as opposed to the nascent
secure-testing team) is therefore unlikely to be interested.

Cheers,

--
Colin Watson                                       [cjwatson@debian.org]

```

---

**Severity set to `grave'.**
Request was from `Colin Watson <cjwatson@debian.org>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=286372;msg=12), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=12), [link](#11)).

---

**Reply sent** to `Colin Watson <cjwatson@debian.org>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=286372;msg=14), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=14), [link](#13)).

---

**Notification sent** to `Javier Fernández-Sanguino Peña <jfs@computer.org>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=286372;msg=16), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 286372-close@bugs.debian.org ([full text](bugreport.cgi?bug=286372;msg=17), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=cjwatson%40debian.org)
From: Colin Watson <cjwatson@debian.org>
To: 286372-close@bugs.debian.org
Subject: Bug#286372: fixed in groff 1.18.1.1-5
Date: Mon, 20 Dec 2004 10:32:47 -0500
```
Source: groff
Source-Version: 1.18.1.1-5

We believe that the bug you reported is fixed in the latest version of
groff, which is due to be installed in the Debian FTP archive:

groff-base_1.18.1.1-5_powerpc.deb
  to pool/main/g/groff/groff-base_1.18.1.1-5_powerpc.deb
groff_1.18.1.1-5.diff.gz
  to pool/main/g/groff/groff_1.18.1.1-5.diff.gz
groff_1.18.1.1-5.dsc
  to pool/main/g/groff/groff_1.18.1.1-5.dsc
groff_1.18.1.1-5_powerpc.deb
  to pool/main/g/groff/groff_1.18.1.1-5_powerpc.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 286372@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Colin Watson <cjwatson@debian.org> (supplier of updated groff package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Mon, 20 Dec 2004 14:26:25 +0000
Source: groff
Binary: groff-base groff
Architecture: source powerpc
Version: 1.18.1.1-5
Distribution: unstable
Urgency: high
Maintainer: Colin Watson <cjwatson@debian.org>
Changed-By: Colin Watson <cjwatson@debian.org>
Description:
 groff      - GNU troff text-formatting system
 groff-base - GNU troff text-formatting system (base system components)
Closes: [286371](bugreport.cgi?bug=286371) [286372](bugreport.cgi?bug=286372)
Changes:
 groff (1.18.1.1-5) unstable; urgency=high
 .
   * Upstream fix for temporary file handling vulnerability in pic2graph
     (closes: #[286371](bugreport.cgi?bug=286371)).
   * Upstream fix for temporary file handling vulnerability in eqn2graph
     (closes: #[286372](bugreport.cgi?bug=286372)).
Files:
 41ffe57c38bcc172195021b3900a4d38 761 text important groff_1.18.1.1-5.dsc
 60e74aa726e7f84b544bb901ab6985ac 126657 text important groff_1.18.1.1-5.diff.gz
 e19a659582671c3bb1ee22b693231c31 867968 text important groff-base_1.18.1.1-5_powerpc.deb
 67ca52267606bca4d4a31b2ae0796a4c 1885614 text optional groff_1.18.1.1-5_powerpc.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)
Comment: Colin Watson <cjwatson@debian.org> -- Debian developer

iD8DBQFBxur19t0zAhD6TNERAnheAJwLzyQZtJnMWgUee44fB/afjrH4ngCcC+f2
LZVzkn+0gYduSq4tFGpOQA0=
=XSoM
-----END PGP SIGNATURE-----

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Colin Watson <cjwatson@debian.org>`:

`Bug#286372`; Package `groff`.
([full text](bugreport.cgi?bug=286372;msg=19), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=19), [link](#18)).

---

**Acknowledgement sent** to `Javier Fernández-Sanguino Peña <jfs@computer.org>`:

Extra info received and forwarded to list. Copy sent to `Colin Watson <cjwatson@debian.org>`.
([full text](bugreport.cgi?bug=286372;msg=21), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=21), [link](#20)).

---

[Message #22](#22) received at 286372@bugs.debian.org ([full text](bugreport.cgi?bug=286372;msg=22), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=22), reply):

![](/cgi-bin/libravatar.cgi?email=jfs%40computer.org)
From: Javier Fernández-Sanguino Peña <jfs@computer.org>
To: Colin Watson <cjwatson@debian.org>
Cc: 286371@bugs.debian.org, 286372@bugs.debian.org
Subject: Re: Bug#286371: pic2graph: Vulnerable to symlink attack through temporary file
Date: Mon, 20 Dec 2004 19:48:26 +0100
```
On Mon, Dec 20, 2004 at 03:20:40PM +0000, Colin Watson wrote:
> > The attached patch fixes this behaviour.
>
> Thanks. This and #286372 were both fixed upstream a while back in a
> somewhat more elaborate way, so I'm taking their patch.

No problem. I just wanted to get those out of my "PENDING" queue. I believe
I checked the latest sources in Debian but might system might not have been
fully up to date, sorry.

> > PS: I initially reported this to the security team back in June,
> > but have not found time to follow up on this issue until today.
> > Security team, please check
> > Resent-Message-ID: <20040624124521.GA10101@dat.etsit.upm.es>
>
> groff in stable didn't have either pic2graph or eqn2graph; they were new
> features in 1.18. The security team (as opposed to the nascent
> secure-testing team) is therefore unlikely to be interested.

Actually, some of the scripts with insecure temporary handling were present
in stable but the fact is that these vulnerabilities were not deemed
sufficient for a DSA, and the Security Team asked me to follow up on the
BTS since there was no need to coordinate with other security teams or
produce a DSA. I've actually haven't made an effort to review whether some
of the bugs I've opened are present in stable. <shrug>

Regards

Javier

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Colin Watson <cjwatson@debian.org>`:

`Bug#286372`; Package `groff`.
([full text](bugreport.cgi?bug=286372;msg=24), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=24), [link](#23)).

---

**Acknowledgement sent** to `Martin Schulze <joey@infodrom.org>`:

Extra info received and forwarded to list. Copy sent to `Colin Watson <cjwatson@debian.org>`.
([full text](bugreport.cgi?bug=286372;msg=26), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=26), [link](#25)).

---

[Message #27](#27) received at 286372@bugs.debian.org ([full text](bugreport.cgi?bug=286372;msg=27), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=27), reply):

![](/cgi-bin/libravatar.cgi?email=joey%40infodrom.org)
From: Martin Schulze <joey@infodrom.org>
To: 286371@bugs.debian.org, 286372@bugs.debian.org
Subject: Use CAN-2004-1296
Date: Wed, 22 Dec 2004 12:23:41 +0100
```
Please use CAN-2004-1296 when you refer to this vulnerability, i.e. in
the changelog of fixed packages.

Regards,

	Joey

--
All language designers are arrogant.  Goes with the territory...
	-- Larry Wall

Please always Cc to me when replying to me on the lists.

```

---

**Bug reopened, originator not changed.**
Request was from `Adrian Bunk <bunk@stusta.de>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=286372;msg=29), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=29), [link](#28)).

---

**Tags added: sarge**
Request was from `Adrian Bunk <bunk@stusta.de>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=286372;msg=31), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=31), [link](#30)).

---

**Tags removed: sarge**
Request was from `Steve Langasek <vorlon@debian.org>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=286372;msg=33), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=33), [link](#32)).

---

**Reply sent** to `Steve Langasek <vorlon@debian.org>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=286372;msg=35), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=35), [link](#34)).

---

**Notification sent** to `Javier Fernández-Sanguino Peña <jfs@computer.org>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=286372;msg=37), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 286372-done@bugs.debian.org ([full text](bugreport.cgi?bug=286372;msg=38), [mbox](bugreport.cgi?bug=286372;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=vorlon%40debian.org)
From: Steve Langasek <vorlon@debian.org>
To: 286371-done@bugs.debian.org, 286372-done@bugs.debian.org
Subject: groff update has reached testing
Date: Mon, 3 Jan 2005 21:36:38 -0800
```
[[Message part 1](bugreport.cgi?att=0;bug=286372;msg=38) (text/plain, inline)]
```
```
tags 286371 -sarge
tags 286372 -sarge
thanks

The version of groff that is purported to fix these bugs has reached
testing, therefore I believe they can be closed.

Thanks,
--
Steve Langasek
postmodern programmer

```
```
[[signature.asc](bugreport.cgi?att=1;bug=286372;filename=signature.asc;msg=38) (application/pgp-signature, inline)]
```

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=286372).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 22:02:04 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from marc.info_ce571328_20250124_220210.html ===

```
[[prev in list](?l=bugtraq&m=110357383530569&w=2)] [[next in list](?l=bugtraq&m=110357966801704&w=2)] [[prev in thread](?l=ubuntu-security-announce&m=139113797021613&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [[USN-43-1] groff utility vulnerabilities](?t=110358226700001&r=1&w=2)
From:       [Martin Pitt <martin.pitt () canonical ! com>](?a=109531671800003&r=1&w=2)
Date:       [2004-12-20 18:23:20](?l=bugtraq&r=1&w=2&b=200412)
Message-ID: [20041220182320.GA13682 () box79162 ! elkhouse ! de](?i=20041220182320.GA13682%20()%20box79162%20!%20elkhouse%20!%20de)
[Download RAW [message](?l=bugtraq&m=110358225615424&q=mbox) or [body](?l=bugtraq&m=110358225615424&q=raw)]

===========================================================
Ubuntu Security Notice USN-43-1		  December 20, 2004
groff vulnerabilities
<http://bugs.debian.org/286371>,
<http://bugs.debian.org/286372>
===========================================================

A security issue affects the following Ubuntu releases:

Ubuntu 4.10 (Warty Warthog)

The following packages are affected:

groff

The problem can be corrected by upgrading the affected package to
version 1.18.1.1-1ubuntu0.2. In general, a standard system upgrade is
sufficient to effect the necessary changes.

Details follow:

Javier Fernández-Sanguino Peña discovered that the auxiliary scripts
"eqn2graph" and "pic2graph" created temporary files in an insecure
way, which allowed exploitation of a race condition to create or
overwrite files with the privileges of the user invoking the program.

  Source archives:

    <http://security.ubuntu.com/ubuntu/pool/main/g/groff/groff_1.18.1.1-1ubuntu0.2.diff.gz>
      Size/MD5:   122991 0d247788b6e83f87718c996f0fd05e41
    <http://security.ubuntu.com/ubuntu/pool/main/g/groff/groff_1.18.1.1-1ubuntu0.2.dsc>
      Size/MD5:      715 92ca1b33ea0907aa6d4eda3db4930c51
    <http://security.ubuntu.com/ubuntu/pool/main/g/groff/groff_1.18.1.1.orig.tar.gz>
      Size/MD5:  2260623 511dbd64b67548c99805f1521f82cc5e

  amd64 architecture (Athlon64, Opteron, EM64T Xeon)

    <http://security.ubuntu.com/ubuntu/pool/main/g/groff/groff-base_1.18.1.1-1ubuntu0.2_amd64.deb>
      Size/MD5:   856342 920534f39127c7216e62b1122fbe3c18
    <http://security.ubuntu.com/ubuntu/pool/main/g/groff/groff_1.18.1.1-1ubuntu0.2_amd64.deb>
      Size/MD5:  1890064 f012658b3b6a9aaf9151dd9aa34cc3d1

  i386 architecture (x86 compatible Intel/AMD)

    <http://security.ubuntu.com/ubuntu/pool/main/g/groff/groff-base_1.18.1.1-1ubuntu0.2_i386.deb>
      Size/MD5:   807612 52dc8a36fd9838ff546a2b09e48f6b12
    <http://security.ubuntu.com/ubuntu/pool/main/g/groff/groff_1.18.1.1-1ubuntu0.2_i386.deb>
      Size/MD5:  1843076 677a86c7457eed2880100c122bcc75fd

  powerpc architecture (Apple Macintosh G3/G4/G5)

    <http://security.ubuntu.com/ubuntu/pool/main/g/groff/groff-base_1.18.1.1-1ubuntu0.2_powerpc.deb>
      Size/MD5:   860678 b2a2a921dcdbb0acc520c7de969a5104
    <http://security.ubuntu.com/ubuntu/pool/main/g/groff/groff_1.18.1.1-1ubuntu0.2_powerpc.deb>
      Size/MD5:  1885062 e97f22decb7cc85fb32d76bc29f6d89a

[["signature.asc" (application/pgp-signature)]](?l=bugtraq&m=110358225615424&q=p3)

[[prev in list](?l=bugtraq&m=110357383530569&w=2)] [[next in list](?l=bugtraq&m=110357966801704&w=2)] [[prev in thread](?l=ubuntu-security-announce&m=139113797021613&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from bugs.debian.org_554e20e8_20250124_220201.html ===

# Debian Bug report logs - #286371 pic2graph: Vulnerable to symlink attack through temporary file

[![version graph](version.cgi?height=2;absolute=0;fixed=groff%2F1.18.1.1-5;package=groff;width=2;found=1.18.1.1-3;collapse=1)](version.cgi?found=1.18.1.1-3;collapse=1;info=1;absolute=0;package=groff;fixed=groff%2F1.18.1.1-5)

Package:
[groff](pkgreport.cgi?package=groff);
Maintainer for [groff](pkgreport.cgi?package=groff) is [Colin Watson <cjwatson@debian.org>](pkgreport.cgi?maint=cjwatson%40debian.org); Source for [groff](pkgreport.cgi?package=groff) is [src:groff](pkgreport.cgi?src=groff) ([PTS](https://tracker.debian.org/pkg/groff), [buildd](https://buildd.debian.org/groff), [popcon](https://qa.debian.org/popcon.php?package=groff)).

Reported by: [Javier Fernández-Sanguino Peña <jfs@computer.org>](pkgreport.cgi?submitter=jfs%40computer.org)

Date: Sun, 19 Dec 2004 22:33:02 UTC

Severity: *grave*

Tags: security

Found in version 1.18.1.1-3

Fixed in version groff/1.18.1.1-5

**Done:** Steve Langasek <vorlon@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=286371;mbox=yes), [status mbox](bugreport.cgi?bug=286371;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=286371;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Colin Watson <cjwatson@debian.org>`:

`Bug#286371`; Package `groff`.
([full text](bugreport.cgi?bug=286371;msg=2), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Javier Fernández-Sanguino Peña <jfs@computer.org>`:

New Bug report received and forwarded. Copy sent to `Colin Watson <cjwatson@debian.org>`.
([full text](bugreport.cgi?bug=286371;msg=4), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=286371;msg=5), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=jfs%40computer.org)
From: Javier Fernández-Sanguino Peña <jfs@computer.org>
To: submit@bugs.debian.org
Subject: pic2graph: Vulnerable to symlink attack through temporary file
Date: Sun, 19 Dec 2004 23:18:13 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=286371;msg=5) (text/plain, inline)]
```
```
Package: groff
Version: 1.18.1.1-3
Priority: important
Tags: security

The pic2graph script does not protect itself from temporary filename
attacks since it creates file in an insecure manner (the process PID
is not suffient to avoid and attack) and does not check
if the temporary file it uses exists before using them.

The attached patch fixes this behaviour.

Regards

Javier

PS: I initially reported this to the security team back in June,
but have not found time to follow up on this issue until today.
Security team, please check
Resent-Message-ID: <20040624124521.GA10101@dat.etsit.upm.es>

```
```
[[pic2graph.diff](bugreport.cgi?att=1;bug=286371;filename=pic2graph.diff;msg=5) (text/plain, attachment)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#286371`; Package `groff`.
([full text](bugreport.cgi?bug=286371;msg=7), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `Colin Watson <cjwatson@debian.org>`:

Extra info received and forwarded to list.
([full text](bugreport.cgi?bug=286371;msg=9), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 286371@bugs.debian.org ([full text](bugreport.cgi?bug=286371;msg=10), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=cjwatson%40debian.org)
From: Colin Watson <cjwatson@debian.org>
To: Javier Fernández-Sanguino Peña <jfs@computer.org>,
286371@bugs.debian.org, 286372@bugs.debian.org
Subject: Re: Bug#286371: pic2graph: Vulnerable to symlink attack through temporary file
Date: Mon, 20 Dec 2004 15:20:40 +0000
```
On Sun, Dec 19, 2004 at 11:18:13PM +0100, Javier Fernández-Sanguino Peña wrote:
> Package: groff
> Version: 1.18.1.1-3
> Priority: important
> Tags: security
>
> The pic2graph script does not protect itself from temporary filename
> attacks since it creates file in an insecure manner (the process PID
> is not suffient to avoid and attack) and does not check
> if the temporary file it uses exists before using them.
>
> The attached patch fixes this behaviour.

Thanks. This and #286372 were both fixed upstream a while back in a
somewhat more elaborate way, so I'm taking their patch.

> PS: I initially reported this to the security team back in June,
> but have not found time to follow up on this issue until today.
> Security team, please check
> Resent-Message-ID: <20040624124521.GA10101@dat.etsit.upm.es>

groff in stable didn't have either pic2graph or eqn2graph; they were new
features in 1.18. The security team (as opposed to the nascent
secure-testing team) is therefore unlikely to be interested.

Cheers,

--
Colin Watson                                       [cjwatson@debian.org]

```

---

**Severity set to `grave'.**
Request was from `Colin Watson <cjwatson@debian.org>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=286371;msg=12), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=12), [link](#11)).

---

**Reply sent** to `Colin Watson <cjwatson@debian.org>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=286371;msg=14), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=14), [link](#13)).

---

**Notification sent** to `Javier Fernández-Sanguino Peña <jfs@computer.org>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=286371;msg=16), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 286371-close@bugs.debian.org ([full text](bugreport.cgi?bug=286371;msg=17), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=cjwatson%40debian.org)
From: Colin Watson <cjwatson@debian.org>
To: 286371-close@bugs.debian.org
Subject: Bug#286371: fixed in groff 1.18.1.1-5
Date: Mon, 20 Dec 2004 10:32:47 -0500
```
Source: groff
Source-Version: 1.18.1.1-5

We believe that the bug you reported is fixed in the latest version of
groff, which is due to be installed in the Debian FTP archive:

groff-base_1.18.1.1-5_powerpc.deb
  to pool/main/g/groff/groff-base_1.18.1.1-5_powerpc.deb
groff_1.18.1.1-5.diff.gz
  to pool/main/g/groff/groff_1.18.1.1-5.diff.gz
groff_1.18.1.1-5.dsc
  to pool/main/g/groff/groff_1.18.1.1-5.dsc
groff_1.18.1.1-5_powerpc.deb
  to pool/main/g/groff/groff_1.18.1.1-5_powerpc.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 286371@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Colin Watson <cjwatson@debian.org> (supplier of updated groff package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Mon, 20 Dec 2004 14:26:25 +0000
Source: groff
Binary: groff-base groff
Architecture: source powerpc
Version: 1.18.1.1-5
Distribution: unstable
Urgency: high
Maintainer: Colin Watson <cjwatson@debian.org>
Changed-By: Colin Watson <cjwatson@debian.org>
Description:
 groff      - GNU troff text-formatting system
 groff-base - GNU troff text-formatting system (base system components)
Closes: [286371](bugreport.cgi?bug=286371) [286372](bugreport.cgi?bug=286372)
Changes:
 groff (1.18.1.1-5) unstable; urgency=high
 .
   * Upstream fix for temporary file handling vulnerability in pic2graph
     (closes: #[286371](bugreport.cgi?bug=286371)).
   * Upstream fix for temporary file handling vulnerability in eqn2graph
     (closes: #[286372](bugreport.cgi?bug=286372)).
Files:
 41ffe57c38bcc172195021b3900a4d38 761 text important groff_1.18.1.1-5.dsc
 60e74aa726e7f84b544bb901ab6985ac 126657 text important groff_1.18.1.1-5.diff.gz
 e19a659582671c3bb1ee22b693231c31 867968 text important groff-base_1.18.1.1-5_powerpc.deb
 67ca52267606bca4d4a31b2ae0796a4c 1885614 text optional groff_1.18.1.1-5_powerpc.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)
Comment: Colin Watson <cjwatson@debian.org> -- Debian developer

iD8DBQFBxur19t0zAhD6TNERAnheAJwLzyQZtJnMWgUee44fB/afjrH4ngCcC+f2
LZVzkn+0gYduSq4tFGpOQA0=
=XSoM
-----END PGP SIGNATURE-----

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Colin Watson <cjwatson@debian.org>`:

`Bug#286371`; Package `groff`.
([full text](bugreport.cgi?bug=286371;msg=19), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=19), [link](#18)).

---

**Acknowledgement sent** to `Javier Fernández-Sanguino Peña <jfs@computer.org>`:

Extra info received and forwarded to list. Copy sent to `Colin Watson <cjwatson@debian.org>`.
([full text](bugreport.cgi?bug=286371;msg=21), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=21), [link](#20)).

---

[Message #22](#22) received at 286371@bugs.debian.org ([full text](bugreport.cgi?bug=286371;msg=22), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=22), reply):

![](/cgi-bin/libravatar.cgi?email=jfs%40computer.org)
From: Javier Fernández-Sanguino Peña <jfs@computer.org>
To: Colin Watson <cjwatson@debian.org>
Cc: 286371@bugs.debian.org, 286372@bugs.debian.org
Subject: Re: Bug#286371: pic2graph: Vulnerable to symlink attack through temporary file
Date: Mon, 20 Dec 2004 19:48:26 +0100
```
On Mon, Dec 20, 2004 at 03:20:40PM +0000, Colin Watson wrote:
> > The attached patch fixes this behaviour.
>
> Thanks. This and #286372 were both fixed upstream a while back in a
> somewhat more elaborate way, so I'm taking their patch.

No problem. I just wanted to get those out of my "PENDING" queue. I believe
I checked the latest sources in Debian but might system might not have been
fully up to date, sorry.

> > PS: I initially reported this to the security team back in June,
> > but have not found time to follow up on this issue until today.
> > Security team, please check
> > Resent-Message-ID: <20040624124521.GA10101@dat.etsit.upm.es>
>
> groff in stable didn't have either pic2graph or eqn2graph; they were new
> features in 1.18. The security team (as opposed to the nascent
> secure-testing team) is therefore unlikely to be interested.

Actually, some of the scripts with insecure temporary handling were present
in stable but the fact is that these vulnerabilities were not deemed
sufficient for a DSA, and the Security Team asked me to follow up on the
BTS since there was no need to coordinate with other security teams or
produce a DSA. I've actually haven't made an effort to review whether some
of the bugs I've opened are present in stable. <shrug>

Regards

Javier

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Colin Watson <cjwatson@debian.org>`:

`Bug#286371`; Package `groff`.
([full text](bugreport.cgi?bug=286371;msg=24), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=24), [link](#23)).

---

**Acknowledgement sent** to `Martin Schulze <joey@infodrom.org>`:

Extra info received and forwarded to list. Copy sent to `Colin Watson <cjwatson@debian.org>`.
([full text](bugreport.cgi?bug=286371;msg=26), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=26), [link](#25)).

---

[Message #27](#27) received at 286371@bugs.debian.org ([full text](bugreport.cgi?bug=286371;msg=27), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=27), reply):

![](/cgi-bin/libravatar.cgi?email=joey%40infodrom.org)
From: Martin Schulze <joey@infodrom.org>
To: 286371@bugs.debian.org, 286372@bugs.debian.org
Subject: Use CAN-2004-1296
Date: Wed, 22 Dec 2004 12:23:41 +0100
```
Please use CAN-2004-1296 when you refer to this vulnerability, i.e. in
the changelog of fixed packages.

Regards,

	Joey

--
All language designers are arrogant.  Goes with the territory...
	-- Larry Wall

Please always Cc to me when replying to me on the lists.

```

---

**Bug reopened, originator not changed.**
Request was from `Adrian Bunk <bunk@stusta.de>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=286371;msg=29), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=29), [link](#28)).

---

**Tags added: sarge**
Request was from `Adrian Bunk <bunk@stusta.de>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=286371;msg=31), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=31), [link](#30)).

---

**Tags removed: sarge**
Request was from `Steve Langasek <vorlon@debian.org>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=286371;msg=33), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=33), [link](#32)).

---

**Reply sent** to `Steve Langasek <vorlon@debian.org>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=286371;msg=35), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=35), [link](#34)).

---

**Notification sent** to `Javier Fernández-Sanguino Peña <jfs@computer.org>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=286371;msg=37), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 286371-done@bugs.debian.org ([full text](bugreport.cgi?bug=286371;msg=38), [mbox](bugreport.cgi?bug=286371;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=vorlon%40debian.org)
From: Steve Langasek <vorlon@debian.org>
To: 286371-done@bugs.debian.org, 286372-done@bugs.debian.org
Subject: groff update has reached testing
Date: Mon, 3 Jan 2005 21:36:38 -0800
```
[[Message part 1](bugreport.cgi?att=0;bug=286371;msg=38) (text/plain, inline)]
```
```
tags 286371 -sarge
tags 286372 -sarge
thanks

The version of groff that is purported to fix these bugs has reached
testing, therefore I believe they can be closed.

Thanks,
--
Steve Langasek
postmodern programmer

```
```
[[signature.asc](bugreport.cgi?att=1;bug=286371;filename=signature.asc;msg=38) (application/pgp-signature, inline)]
```

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=286371).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 22:02:00 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from wwwnew.mandriva.com_f555504d_20250124_220213.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us


