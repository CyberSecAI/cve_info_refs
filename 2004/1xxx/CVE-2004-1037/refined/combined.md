=== Content from security.gentoo.org_67605a77_20250124_215420.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# TWiki: Arbitrary command execution — GLSA **200411-33**

A bug in the TWiki search function allows an attacker to execute arbitrary
commands with the permissions of the user running TWiki.

### Affected packages

| Package | **www-apps/twiki** on all architectures |
| --- | --- |
| Affected versions | < **20040902** |
| Unaffected versions | >= **20040902** < **20000000** |

### Background

TWiki is a Web-based groupware tool based around the concept of wiki
pages that can be edited by anybody with a Web browser.

### Description

The TWiki search function, which uses a shell command executed via the
Perl backtick operator, does not properly escape shell metacharacters
in the user-provided search string.

### Impact

An attacker can insert malicious commands into a search request,
allowing the execution of arbitrary commands with the privileges of the
user running TWiki (usually the Web server user).

### Workaround

There is no known workaround at this time.

### Resolution

All TWiki users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/twiki-20040902"
```
### References

* [TWiki Security Alert](http://twiki.org/cgi-bin/view/Codev/SecurityAlertExecuteCommandsWithSearch)
* [CAN-2004-1037](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-1037)

**Release date**

November 24, 2004

**Latest revision**

September 08, 2006: 02

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [71035](https://bugs.gentoo.org/show_bug.cgi?id=71035)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from marc.info_edf20a27_20250124_215420.html ===

```
[[prev in list](?l=bugtraq&m=110037283803560&w=2)] [[next in list](?l=bugtraq&m=110037781321226&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    TWiki search function allows arbitrary shell command execution
From:       [Hans Ulrich Niedermann <hun () bawue ! de>](?a=110030851600003&r=1&w=2)
Date:       [2004-11-12 23:30:02](?l=bugtraq&r=1&w=2&b=200411)
Message-ID: [86zn1mhchx.fsf () n-dimensional ! de](?i=86zn1mhchx.fsf%20()%20n-dimensional%20!%20de)
[Download RAW [message](?l=bugtraq&m=110037207516456&q=mbox) or [body](?l=bugtraq&m=110037207516456&q=raw)]

VULNERABLE SOFTWARE VERSIONS

TWiki <http://twiki.org/>

- TWiki 20030201 (e.g. Debian Sarge)
- probably later versions

- Subversion repository at
  <<http://ntwiki.ethermage.net:8181/svn/twiki/trunk>>
  at least until revision 3224 (including)

ATTACK VECTORS

HTTP GET requests towards the Wiki server (typically port 80/TCP).
Usually, no prior authentication is necessary.

Possibly also HTTP POST, but this is untested.

IMPACT

An attacker is able to execute arbitrary shell commands with the
privileges of the TWiki process.

DETAILS

The TWiki search function uses a user supplied search string to
compose a command line executed by the Perl backtick (``) operator.

The search string is not checked properly for shell metacharacters
and is thus vulnerable to search string containing quotes and shell
commands.

An example search string would be:

doesnotexist1'; (uname -a; id) | sed 's/\(.*\)/__BEGIN__\1__END__.txt/'; fgrep -i -l -- 'doesnotexist2

If access to the Wiki is not restricted by other means, attackers can
use the search function without prior authentication.

As indicated in the source code, the software authors were aware that
the way they worked around Perl's taint check is insecure. Users of
TWiki should reconsider if the software can meet their security
requirements, given such gross negligence.

COUNTERMEASURES

  - Hotfix (see patch at end of advisory)
    The hotfix is known to prevent the current attacks, but it might
    not be a complete fix.
  - Filter access to the web server.
  - Use the web server software to restrict access to the web pages
    served by TWiki.
  - Rewrite the TWiki code to correctly check user supplied strings.
  - Rewrite the TWiki code to use Perl code to open and scan the files
    instead of running commands in the shell.

AUTHORS AND CREDITS

  Markus Goetz, Joerg Hoh, Michael Holzt, Florian Laws,
  Hans Ulrich Niedermann, Andreas Thienemann, Peter Thoeny,
  Florian Weimer contributed to this advisory.

HOTFIX

--- twiki/lib/TWiki/Search.pm.orig	2004-11-12 20:16:56.000000000 +0100
+++ twiki/lib/TWiki/Search.pm	2004-11-12 20:36:21.000000000 +0100
@@ -135,6 +135,11 @@
     my $tempVal = "";
     my $tmpl = "";
     my $topicCount = 0; # JohnTalintyre
+
+    # Hotfix for search string shell code insertion vulnerability
+    $theSearchVal =~ s/[^A-Za-z0-9+\-_]//g; # only accept known-good chars
+    $theSearchVal = substr($theSearchVal, 0, 100); # limit string to reasonable length
+
     my $originalSearch = $theSearchVal;
     my $renameTopic;
     my $renameWeb = "";

VULNERABILITY TIMELINE

  early October 2004   earliest confirmed attack

  2004-11-12           forensics revealed exploit
                       vendor contact
                       vendor responded, with less conservative hotfix

  2004-11-13           uncoordinated emergency disclosure
[[prev in list](?l=bugtraq&m=110037283803560&w=2)] [[next in list](?l=bugtraq&m=110037781321226&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from distro.conectiva.com.br_c2e5c284_20250124_215418.html ===

[Pular para o conteúdo](#main)

Sem resultados

* [Contato](https://conectiva.com.br/contato/)
* [Home](https://conectiva.com.br/)
* [Política Privacidade](https://conectiva.com.br/politica-privacidade/)
* [Sobre](https://conectiva.com.br/sobre/)

[![Conectiva](data:image/svg+xml...)](https://conectiva.com.br/)
[Conectiva](https://conectiva.com.br/)

* [Contato](https://conectiva.com.br/contato/)
* [Home](https://conectiva.com.br/)
* [Política Privacidade](https://conectiva.com.br/politica-privacidade/)
* [Sobre](https://conectiva.com.br/sobre/)

Pesquisar

[![Conectiva](data:image/svg+xml...)](https://conectiva.com.br/)
[Conectiva](https://conectiva.com.br/)

Menu

# Home

## Conectando consumidores aos melhores produtos

Diariamente conectamos centenas consumidores a marcas, gerando a melhor experiencia de compra online.

Learn More

Learn More

## Conheças nossos números

Conheça um pouco mais sobre os número do Conectiva, e como tenos ajudado milhares de consumidoes tomrem a melhore decisão de compra.

### 300+

Analises de Produtos

### 20K+

Clientes Ajudados

### 6K+

Feedbacks Positivos

## Categorias mais queridas

Os produtos dessas categorias são as mais queridos por nossos leitores, com os melhores feedbacks das nossas analises.

![](data:image/svg+xml...)
### Outros

Diversas análises para lhe ajuda na decisão de compra.

Todos as análises

![](data:image/svg+xml...)
### Áudio e Vídeo

Análises de equipamentos de áudio e vídeo para o seu lar.

Todos as análises

![](data:image/svg+xml...)
### Informática

As melhores análises dos principais equipamentos de T.I.

[Todos as análises](https://conectiva.com.br/informatica/)

![](data:image/svg+xml...)
### Video Game

As melhores análises de vídeo games e periféricos em português.

[Todas as análise](https://conectiva.com.br/video-game/)

![](data:image/svg+xml...)
### Cameras

Lorem ipsum dolor consectetur adipiscing elit sed do eiusmod.

Todos as análises

![](data:image/svg+xml...)
### Cameras de Ação

Lorem ipsum dolor consectetur adipiscing elit sed do eiusmod.

Todos as análises

![](data:image/svg+xml...)
### Celular

Os melhores celulares e tablets de diversas marcas e modelos.

[Todas as análises](https://conectiva.com.br/celular/)

![](data:image/svg+xml...)
### Software

Análises descomplicadas dos melhores softwares do mercado.

[Todos as análises](https://conectiva.com.br/software/)

## Acompanhe o Conectiva nas redes socias

Fique atualizado e tenha as melhores analises de compras, seguindo o Conectiva nas redes sociais, e recebendo nossas analises em primeira mão.

Facebook

Twitter

Pinterest

Subscribe to our weekly newsletter

## Analises mais populares

Essas são algumas das nossas analises mais populares entre nossos leitores, como os melhores feedbacks.

Sem resultados

Rating: 4.8/5
********** 4.8/5

## Esse é a câmera de ação custo benefício

Separamos os 10 melhores produtos dessa categoria para você escolher qual mais lhe agrada.

Análise Completa

![](data:image/svg+xml...)

### Confira todas as análises feitas por nossos profissionais

Análise Completa

Copyright © 2025 - WordPress Theme by Creative Themes


