The provided content relates to **CVE-2004-1998**.

**Root cause of vulnerability:**
The root cause is the lack of proper sanitization of user-supplied variables in PhpNuke versions 6.x to 7.2, which leads to multiple vulnerabilities including Full Path Disclosure, Cross-Site Scripting (XSS), and SQL Injection.

**Weaknesses/vulnerabilities present:**
*   **Full Path Disclosure (A):** The `show` variable is not sanitized and triggers PHP error messages, revealing the full path to the script.
*   **Cross-Site Scripting (XSS) (B):** Unsanitized user-submitted variables `ttitle` and `sid` allow injection of malicious JavaScript code.
*   **SQL Injection (C):** The `orderby` variable allows non-critical SQL injection, and a critical SQL injection vulnerability exists through unsanitized `sid` variable in a SQL query.

**Impact of exploitation:**
*   **Full Path Disclosure:** Provides attackers with sensitive system information, including the full path to the web application.
*   **Cross-Site Scripting (XSS):** Allows for cookie stealing, account hijacking, and ID spoofing.
*   **SQL Injection:** Enables attackers to potentially read sensitive information from the database, including admin usernames and password hashes, allowing for complete compromise of the web application.

**Attack vectors:**
The vulnerabilities are exploited through HTTP requests by manipulating the following GET parameters:
*   `show` for Full Path Disclosure.
*   `ttitle` and `sid` for XSS.
*    `orderby` for non-critical SQL Injection and `sid` for critical SQL Injection.

**Required attacker capabilities/position:**
The attacker only needs to be able to send HTTP requests to the vulnerable PhpNuke instance. No authentication or special privileges are required to exploit these vulnerabilities.