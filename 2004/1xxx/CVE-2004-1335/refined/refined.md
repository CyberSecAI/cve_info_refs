```
{
  "cveId": "CVE-2004-1335",
  "date": "2004-12-15",
  "description": "A memory leak in the ip_options_get() function may lead to denial of service.",
  "vulnerability": {
    "rootCause": "The `ip_options_get` function allocates memory using `kmalloc()` but overwrites the previously allocated pointer in a loop without freeing the old memory, leading to memory exhaustion.",
    "weaknesses": [
      "Memory Leak",
      "Improper Resource Management"
    ],
    "impact": "Denial of Service due to memory exhaustion.",
    "attackVectors": [
      "Local",
      "Network (Indirect via `ip_cmsg_send`)"
     ],
    "requiredCapabilities": [
      "Local user able to send a crafted message via socket"
    ],
     "details": "The vulnerability occurs when `ip_cmsg_send` calls `ip_options_get` multiple times. In `ip_options_get`, memory is allocated using `kmalloc`, but the allocated pointer is overwritten in the loop without freeing the previously allocated memory. This causes a memory leak and can lead to denial of service."
  }
}
```