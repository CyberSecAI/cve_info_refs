=== Content from marc.info_0ca62e9d_20250125_152445.html ===

```
[[prev in list](?l=bugtraq&m=110461358930103&w=2)] [[next in list](?l=bugtraq&m=110442922426790&w=2)] [[prev in thread](?l=bugtraq&m=110425409614735&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Re: Multiple Vulnerabilities in Moodle](?t=110425424000001&r=1&w=2)
From:       [Martin Dougiamas <martin () moodle ! com>](?a=109008497300004&r=1&w=2)
Date:       [2004-12-30 15:25:07](?l=bugtraq&r=1&w=2&b=200412)
Message-ID: [20041230152507.8231.qmail () www ! securityfocus ! com](?i=20041230152507.8231.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=110444531816566&q=mbox) or [body](?l=bugtraq&m=110444531816566&q=raw)]

In-Reply-To: <20041227194544.6255.qmail@www.securityfocus.com>

>Session File Disclosure vulnerability is patched in version 1.4.3.
>Cross Site Scripting vulnerability will be patched probably in
>version 1.5.

In fact both of these were fixed in 1.4.3 (the currently available release).
[[prev in list](?l=bugtraq&m=110461358930103&w=2)] [[next in list](?l=bugtraq&m=110442922426790&w=2)] [[prev in thread](?l=bugtraq&m=110425409614735&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_65cb25ba_20250125_152445.html ===

```
[[prev in list](?l=bugtraq&m=110425875504586&w=2)] [[next in list](?l=bugtraq&m=110425417924361&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=110444531816566&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Multiple Vulnerabilities in Moodle](?t=110425424000001&r=1&w=2)
From:       [Bartek Nowotarski <silence10 () wp ! pl>](?a=108335044500002&r=1&w=2)
Date:       [2004-12-27 19:45:44](?l=bugtraq&r=1&w=2&b=200412)
Message-ID: [20041227194544.6255.qmail () www ! securityfocus ! com](?i=20041227194544.6255.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=110425409614735&q=mbox) or [body](?l=bugtraq&m=110425409614735&q=raw)]

+------------------------------------------------------------------------------+
|                                                                              |
|               Multiple Vulnerabilities in Moodle                             |
|               ==================================                             |
|                                                                              |
|                                                 Author:    Bartek Nowotarski |
|                                                 Published:        2004-12-27 |
+------------------------------------------------------------------------------+

[[01]](#-01) General information
~~~~~~~~~~~~~~~~~~~~~~~~

  ] Document author:       Bartek Nowotarski (silence)  [
  ] Location:              Trzebinia, Poland            [
  ] E-mail:                silence10 wp pl              [
  ] Site:                  silence 0 pl                 [

  ] Application:           Moodle                       [
  ] Versions vulnerable:   <= 1.4.2                     [

[[02]](#-02) Introduction
~~~~~~~~~~~~~~~~~

`Moodle is a course management system (CMS) - a software package designed to
help educators create quality online courses. Such e-learning systems are
sometimes also called Learning Management Systems (LMS) or Virtual Learning
Environments (VLE).` /www.moodle.org
It has over 1000 *register* sites in 75 countries.

Project home site: <http://www.moodle.org>

[[03]](#-03) Vulnerabilities
~~~~~~~~~~~~~~~~~~~~

Two vulnerabilities have been found in Moodle CMS:

  a) ] Type: Cross Site Scripting      [
     ] File: /mod/forum/view.php       [

     ] Description:                    [

       It is a well-known fact that all user-dependant variables should be
       checked for inaccurate values. The variable $search in view.php is
       not.

       54> $buttontext = forum_print_search_form($course, $search, true,
         >                                                             "plain");

     ] Proof of concept:               [

       The following request will alert values of logged user cookies:

       > <http://localhost/moodle/mod/forum/view.php?id=1&search=moodle%22%3E>
       > %3Cscript%3Ealert(document.cookie)%3C/script%3E

       Where id variable should be existing course ID.

  b) ] Type: Session File Disclosure   [
     ] File: file.php                  [

     ] Description:                    [

       All files containing session data are saved in `moodledata` dir, which
       should be invisible from web. But it is possible to gain access to them:

       45> $pathname = "$CFG->dataroot$pathinfo";

       $pathinfo is checked by function detect_munged_arguments() and allows
       one use of `..` to skip to parent directory. We can use it to skip to
       `moodledata` folder itself and then read files form `sess`.
       To obtain session ID we can use cross site scripting vulnerability.

     ] Proof od concept:               [

       The following request will disclosure session file:

       > <http://localhost/moodle/file.php?file=/1/../sessions/>
       > sess_6ac3b47ee23c6aa55896f4cd68af9622

       Where:
         - `1` after "?file=/" is existing course ID,
         - `6ac3b47ee23c6aa55896f4cd68af9622` is session ID

[[04]](#-04) Solution
~~~~~~~~~~~~~

Session File Disclosure vulnerability is patched in version 1.4.3.
Cross Site Scripting vulnerability will be patched probably in
version 1.5.

[[05]](#-05) Timeline
~~~~~~~~~~~~~

  ] 2004-12-09 [ Session File Disclosure vulnerability (b) discovered
  ] 2004-12-10 [ Cross Site Scripting vulnerability (a) discovered
  ] 2004-12-13 [ Vendor informed
  ] 2004-12-14 [ Session File Disclosure vulnerability (b) patched
  ] 2004-12-27 [ Advisory published

[[06]](#-06) Credits
~~~~~~~~~~~~

Vulnerabilities discovered by Bartek Nowotarski.

--EOF--
[[prev in list](?l=bugtraq&m=110425875504586&w=2)] [[next in list](?l=bugtraq&m=110425417924361&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=110444531816566&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


