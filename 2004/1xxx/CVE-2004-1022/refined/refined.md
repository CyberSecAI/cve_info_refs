The provided content is related to CVE-2004-1022.

**Root Cause:**
The Kerio WinRoute Firewall (KWF), Kerio ServerFirewall (KSF) and Kerio MailServer (KMS) user credential database system uses symmetric encryption to protect passwords, but the encryption key is hardcoded within the program logic.

**Weaknesses/Vulnerabilities:**
- Insecure storage of credentials due to weak symmetric encryption.
- Use of a universal, hardcoded secret key for encryption.

**Impact of Exploitation:**
- An attacker with access to the configuration files (containing encrypted password database) can reverse the encryption and obtain cleartext passwords.
- This can lead to unauthorized access to the systems protected by the software, including potentially firewalls and mail servers.
- It allows attackers to steal identities and break access control measures.
- An attacker with an already compromised system could leverage this to gain further access.

**Attack Vectors:**
- Direct access to the configuration files of the affected Kerio products (KWF, KSF, KMS).
- Insider threat on shared environments where multiple technical staff have access.
- Secondary attack vector after a system has already been compromised.

**Required Attacker Capabilities/Position:**
- Access to the configuration files of the affected software.
- Ability to execute a program or script to decrypt the password database by utilizing the hardcoded key, though the details of this program are not explicitly detailed.