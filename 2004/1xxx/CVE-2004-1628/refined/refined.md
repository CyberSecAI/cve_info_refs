Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause of Vulnerability:**
- A format string vulnerability exists in the `log_msg` function within the `rssh` application. This function is used to log messages via syslog. The vulnerability occurs because the function directly passes a user-controlled string to `vsnprintf` and then `syslog` without proper sanitization.

**Weaknesses/Vulnerabilities Present:**
- **Format String Vulnerability:** The `log_msg` function uses a format string, controlled by the user, as the format argument to `vsnprintf` and `syslog`. This allows an attacker to potentially read from or write to arbitrary memory locations.

**Impact of Exploitation:**
- **Arbitrary Code Execution:** By crafting a malicious format string, a remote, authenticated user can execute arbitrary code with the privileges of the user account running `rssh`. This effectively bypasses the restrictions imposed by `rssh`, which is designed to limit user access to specific commands.
- **Privilege Escalation (Potentially):** On some older systems with broken `setuid()` implementations, a root compromise *might* be possible if `rssh` is configured to use a chroot jail. This involves the `rssh_chroot_helper` binary, which is setuid root. However, the primary attack vector allows bypassing of rssh restrictions and arbitrary code execution within the user's context.
- **Circumvention of rssh Restrictions:** The format string vulnerability allows users to execute arbitrary commands, circumventing the intended restrictions of the `rssh` restricted shell.

**Attack Vectors:**
- **Remote:** The vulnerability is remotely exploitable via SSH.
- **Authenticated User:** The attacker must have valid credentials to log in via SSH and access the restricted rssh shell.
- **Malicious Input:** The attack is triggered by providing a malicious format string as a command to `rssh`.

**Required Attacker Capabilities/Position:**
- **Remote Network Access:** The attacker needs to be able to connect to the target server via SSH.
- **Valid User Credentials:** The attacker must have valid credentials for an account that is configured to use `rssh` as its shell.
- **Knowledge of Format String Vulnerabilities:** The attacker needs to understand how to craft a format string payload.

**Additional Notes:**
- The vulnerability is present in `rssh` versions prior to 2.2.2.
- The vulnerability affects both the `rssh` and `rssh_chroot_helper` binaries but the privilege escalation aspect is unlikely on modern systems.
- The fix involves sanitizing the log message before passing it to `syslog` by using `syslog((facility | level), "%s", format_temp);` rather than `syslog((facility | level), format_temp);`.
- The vulnerability was discovered by Florian Schilhabel.