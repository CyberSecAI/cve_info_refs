=== Content from www.gentoo.org_32c49e82_20250125_133617.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# rssh: Format string vulnerability — GLSA **200410-28**

rssh is vulnerable to a format string vulnerability that allows arbitrary
execution of code with the rights of the connected user, thereby bypassing
rssh restrictions.

### Affected packages

| Package | **app-shells/rssh** on all architectures |
| --- | --- |
| Affected versions | < **2.2.2** |
| Unaffected versions | >= **2.2.2** |

### Background

rssh is a restricted shell, allowing only a few commands like scp or
sftp. It is often used as a complement to OpenSSH to provide limited
access to users.

### Description

Florian Schilhabel from the Gentoo Linux Security Audit Team found a
format string vulnerability in rssh syslogging of failed commands.

### Impact

Using a malicious command, it may be possible for a remote
authenticated user to execute arbitrary code on the target machine with
user rights, effectively bypassing any restriction of rssh.

### Workaround

There is no known workaround at this time.

### Resolution

All rssh users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-shells/rssh-2.2.2"
```
### References

* [rssh security announcement](http://www.pizzashack.org/rssh/security.shtml)
* [CVE-2004-1628](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1628)

**Release date**

October 27, 2004

**Latest revision**

May 22, 2006: 02

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [66988](https://bugs.gentoo.org/show_bug.cgi?id=66988)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from secunia.com_112e071e_20250125_133616.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from bugs.gentoo.org_fafab6fd_20250126_090156.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 66988
app-shells/rssh formatstring vulnerability
Last modified: 2011-10-30 22:38:30 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=66988&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=66988&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 66988**](show_bug.cgi?id=66988)
- app-shells/rssh formatstring vulnerability

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
app-shells/rssh formatstring vulnerability

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | High major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://rssh.sourceforge.net/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B2 [glsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2004-10-10 09:31 UTC by Florian Schilhabel (RETIRED) | | --- | --- | | Modified: | 2011-10-30 22:38 UTC ([History](show_activity.cgi?id=66988)) | | CC List: | 0 users | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=66988&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=66988&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Florian Schilhabel (RETIRED)   gentoo-dev  2004-10-10 09:31:31 UTC  ``` Program: rssh Homepage: <http://rssh.sourceforge.net/> Vulnerable Versions: current version v2.2.1; others not tested Risk: High Impact: remote formatstring vulnerability / remote root Author contacted: yes (10/10/2004)  Introduction  I have discovered a remote exploitable formatstring bug in rssh.  description:  rssh is a restricted shell for use with OpenSSH, allowing only scp and/or sftp. For example, if you have a server which you only want to allow users to copy files off of via scp, without providing shell access, you can use rssh to do that. For a list of platforms on which rssh is known to work, see the Platform Support Page.  --- login procedure; client view --- [flo@leela][tmp:exec](~) $ ssh john@192.168.1.14 sftp %s%s%s%s john@192.168.1.14's password:  This account is restricted by rssh. Allowed commands: sftp cvs rdist  If you believe this is in error, please contact your system administrator.  [flo@leela][tmp:exec](~) $ -- end client view ---  -- login procedure; server view -- Oct  9 23:19:28 superman rssh[30932]: allowing sftp to all users Oct  9 23:19:28 superman rssh[30932]: allowing cvs to all users Oct  9 23:19:28 superman rssh[30932]: allowing rdist to all users Oct  9 23:19:28 superman rssh[30932]: setting umask to 022 Oct  9 23:19:28 superman rssh[30932]: user john attempted to log in with a shell Oct  9 23:20:17 superman rssh[30995]: allowing sftp to all users Oct  9 23:20:17 superman rssh[30995]: allowing cvs to all users Oct  9 23:20:17 superman rssh[30995]: allowing rdist to all users Oct  9 23:20:17 superman rssh[30995]: setting umask to 022 Oct  9 23:20:17 superman rssh[30995]: user john attempted to execute forbidden commands Oct  9 23:20:17 superman rssh[30995]: command: sftp command: %s^] ```  [Comment 1](#c1)  Florian Schilhabel (RETIRED)   gentoo-dev  2004-10-10 09:31:31 UTC  ``` Program: rssh Homepage: <http://rssh.sourceforge.net/> Vulnerable Versions: current version v2.2.1; others not tested Risk: High Impact: remote formatstring vulnerability / remote root Author contacted: yes (10/10/2004)  Introduction  I have discovered a remote exploitable formatstring bug in rssh.  description:  rssh is a restricted shell for use with OpenSSH, allowing only scp and/or sftp. For example, if you have a server which you only want to allow users to copy files off of via scp, without providing shell access, you can use rssh to do that. For a list of platforms on which rssh is known to work, see the Platform Support Page.  --- login procedure; client view --- [flo@leela][tmp:exec](~) $ ssh john@192.168.1.14 sftp %s%s%s%s john@192.168.1.14's password:  This account is restricted by rssh. Allowed commands: sftp cvs rdist  If you believe this is in error, please contact your system administrator.  [flo@leela][tmp:exec](~) $ -- end client view ---  -- login procedure; server view -- Oct  9 23:19:28 superman rssh[30932]: allowing sftp to all users Oct  9 23:19:28 superman rssh[30932]: allowing cvs to all users Oct  9 23:19:28 superman rssh[30932]: allowing rdist to all users Oct  9 23:19:28 superman rssh[30932]: setting umask to 022 Oct  9 23:19:28 superman rssh[30932]: user john attempted to log in with a shell Oct  9 23:20:17 superman rssh[30995]: allowing sftp to all users Oct  9 23:20:17 superman rssh[30995]: allowing cvs to all users Oct  9 23:20:17 superman rssh[30995]: allowing rdist to all users Oct  9 23:20:17 superman rssh[30995]: setting umask to 022 Oct  9 23:20:17 superman rssh[30995]: user john attempted to execute forbidden commands Oct  9 23:20:17 superman rssh[30995]: command: sftp command: %s^]ÿÿ¿^Hü^D^H V^A@Pà^D^HUà^D^H÷^Cvðÿ^E@àN^L@ t^G@0% @ðw^D@V\211^D^Hðõ^G@@è^L@\206\211^D^HÐþ^F@Ð9^H@ \222^D@ <^E@À;^H@\200ð^L@ -- end server view --  remote attacker controls formatstring; remote exploitation possible...  -- code log.c --  void log_msg( char *msg, ... ) {  [snip] 	 	retc = vsnprintf( format_temp, length, msg, arglist );  	/*  	 * Check retc to make sure it fit account for differences in libc 	 * versions (grumble)...  Per C99, retc is # of chars that WOULD have 	 * been copied if format_temp was large enough, so make the buffer 	 * that size. 	 */ 	if ( retc > length ){  		if ( (format_temp = (char *)realloc( format_temp, retc + 1 ))  				== NULL ){ 			syslog(LOG_ERR,  				"Could not allocate mem in log_msg(), log.c"); 			exit(1); 		} 		vsnprintf( format_temp, retc + 1, msg, arglist ); 	} 	 [snip]  	syslog((facility | level), format_temp); } -- end code format.c --  -- patch --  --- ./rssh-2.2.1/log.c  2003-02-13 07:21:58.000000000 +0100 +++ ./rssh-2.2.1_new/log.c      2004-10-10 18:04:29.399286160 +0200 @@ -188,6 +188,6 @@          /* clean up arglist and log the string */         va_end( arglist ); -       syslog((facility | level), format_temp); +       syslog((facility | level), "%s", format_temp);  }   -- end patch --  aditionally, the impact is much higher: look at this code:  --  rssh_chroot_helper.c -- [snip] 	/* make sure we can change directory to the user's dir */ 	if ( chdir(argv[3]) == -1 ){ 		log_msg("could not cd to user's home dir: %s", argv[3]); 		if ( chdir("/") ) 			ch_fatal_syscall("chdir()", "/", strerror(errno)); 	} [snip] --  end rssh_chroot_helper.c --  -rwsr-xr-x  1 root 12148 Oct  9 21:36 /usr/lib/misc/rssh_chroot_helper  -- demonstration -- $ ./rssh_chroot_helper AAAA`perl -e 'print "%x"x60'` BB CC DD  -- syslog:  Oct 10 18:03:13 leela rssh_chroot_helper[12299]: stat() failed, 804910cbffff5143804b080a3bffff614040012280bffff5288048a05804910c80491babffff7be4011fae7040012280bffff5b88048c8680491babffff7be4011fae7040034c544012e374880400392e240034c544012e30843bffff5b84000a34044012e624400cb7d040028000400cb7d54003eae034012e6244400371b94002fe444012e30804012e624bffff5e84000a34004012e3084012e3080bffff5e84003e8805bffff614bffff62c804885004000a340: No such file or directory  -- end syslog  note, however, that at this point rssh_chroot_helper has already dropped root privileges, so a shellcode must do a call to setreuid (which is not a real problem).  in fact, successful exploitation of this bug leads to a remote root compromise of the affected machine  best regards florian [rootshell] ```  [Comment 2](#c2)  Florian Schilhabel (RETIRED)   gentoo-dev  2004-10-10 10:29:56 UTC  ``` hi again, after reading the code more in-deep, i found, that  rssh_chroot_helper drops privileges with setuid() therefore it is impossible to re-gain root privileges with this bug. nevertheless, the remote vulnerability still exists...  author has responded and will publish an updated version in about a week.  best regards  ```  [Comment 3](#c3)  Florian Schilhabel (RETIRED)   gentoo-dev  2004-10-10 10:36:19 UTC  ``` ah, one more: the call to log_msg happens before the suid_helper drops privileges. therefore my first advice is true... sorry for spamming ;-)  regards florian  better think before writing... ;-)  ```  [Comment 4](#c4)  Thierry Carrez (RETIRED)   gentoo-dev  2004-10-10 10:45:46 UTC  ``` OK, we'll just keep the remote arbitrary code execution with user rights (rssh bypass). Waiting for upstream.  Note that we might want to coordinate this one between vendor-sec, upstream and us. ```  [Comment 5](#c5)  Florian Schilhabel (RETIRED)   gentoo-dev  2004-10-10 11:40:48 UTC  ``` agreed, after discussion with koon. at least also affected are  debian testing  debian unstable  if other distributions ship rssh? i don't know...  regards florian   ```  [Comment 6](#c6)  Kurt Lieber (RETIRED)   gentoo-dev  2004-10-11 05:12:47 UTC  ``` florian -- I'd like to send this info on to vendor-sec to make them aware of the issue.  Can you confirm the following:  * everything you stated in your original bug report is still accurate (esp. the part about the remote root compromise).  If it's no longer accurate, can you please post a follow-up comment that contains *complete* accurate details?  I need something I can literally copy and paste into an email to vendor-sec.  If it *is* a remote root compromise, any chance you can post an example exploit? * the author has confirmed that this is a real bug  Thanks. ```  [Comment 7](#c7)  Florian Schilhabel (RETIRED)   gentoo-dev  2004-10-11 07:59:59 UTC  ``` hi, as i already told koon: this is _not_ a remote root compromise bug. rssh is used as an replacement shell, to restrict ssh users to special commands: scp, sftp, csv, rdist and rsync  first: the affected function in log.c:  void log_msg( char *msg, ... ) {  	char    *format_temp; 	va_list arglist; 	int     length;        /* length of msg */ 	int     retc;          /* return code */  	/*  	 * make a guess how big the message will be -- initially we'll allow 	 * 50 characters for formatting variable args 	 */ 	length = 50 + strlen( msg ); 	if ( (format_temp = (char *)malloc( length )) == NULL){ 		syslog(LOG_ERR, "Could not allocate mem in log_msg(), log.c"); 		exit(1); 	} 	memset( format_temp, 0, length );  	/* try to print msg to buffer, until we succeed or fail conclusively */ 	va_start( arglist, msg ); 	retc = vsnprintf( format_temp, length, msg, arglist );  	/*  	 * Check retc to make sure it fit account for differences in libc 	 * versions (grumble)...  Per C99, retc is # of chars that WOULD have 	 * been copied if format_temp was large enough, so make the buffer 	 * that size. 	 */ 	if ( retc > length ){  		if ( (format_temp = (char *)realloc( format_temp, retc + 1 ))  				== NULL ){ 			syslog(LOG_ERR,  				"Could not allocate mem in log_msg(), log.c"); 			exit(1); 		} 		vsnprintf( format_temp, retc + 1, msg, arglist ); 	} 	/* if retc == -1, we must be compiled under pre-C99 libc */ 	while ( retc == -1 ){ 		length += 50; 		if ( (format_temp = (char *)realloc( format_temp, length ))  		        == NULL ){ 			syslog(LOG_ERR, 				"Could not allocate mem in log_msg(), log.c"); 			exit(1); 		}	 		memset( format_temp, 0, length ); 		retc = vsnprintf( format_temp, length, msg, arglist ); 	}  	/* clean up arglist and log the string */ 	va_end( arglist ); 	syslog((facility | level), format_temp); }  as you see, the string given to syslog() is clearly an format string bug. this function is called from two binaries, making them both vulnerable: rssh and rssh_chroot_helper. notice, that rssh_chroot_helper is suid root... if a user gives an 'forbidden command', this command is logged via syslog. (the affected function...) at this point, an attacker is able to completely break out of chroot() and gain a full shell with the privileges of an regular user. that means, a full circumvention of rssh. having a closer look at rssh_chroot_helper.c, i noticed, that if  -- snip --	 if ( stat(argv[1], &s) == -1 ) 		ch_fatal_syscall("stat()", argv[1], strerror(errno)); -- snip --  the stat() fails, a message is logged via the affected function. fortunately, ch_fatal_syscall() drops privileges with setuid() before calling the affected function; according to man setuid() there is no way to re-establish root-privileges for a program after doing this. if the author would have called seteuid() instead, then this would be root compromise...  -- snip -- void ch_fatal_syscall( char *func, char *arg, char *strerr ) {  	/* drop privileges */ 	if ( !geteuid() ) setuid(getuid()); 	ch_start_logging();  	/* log error */ 	log_msg("%s failed, %s: %s", func, arg, strerr); 	log_close(); 	exit(1); } -- snip --  and this is, what i first overlooked...  so the affected function is clearly called as the user who is calling this binary.  what remains is the remote exploitability of this bug. after a successful authentication via ssh(!!!), sshd calls users shell. (given in /etc/passwd) if the command given to rssh is malicious (a formatstring) the user can gain a full shell with this.  2nd: the author has already replied and confirmed the existence of this bug. author will release an updated package within one week.  rgrd: example exploit: do you want me to write a real exploit for this issue? ;-)  best regards florian [rootshell]  ```  [Comment 8](#c8)  Thierry Carrez (RETIRED)   gentoo-dev  2004-10-20 01:11:46 UTC  ``` Was vendor-sec contacted about this ? ```  [Comment 9](#c9)  Kurt Lieber (RETIRED)   gentoo-dev  2004-10-20 04:31:08 UTC  ``` yes, but I can't coordinate a release date until I have a patch to provide them as well.  Florian -- any word from the author?  Would he be willing to give us the patch ahead of time so I can coordinate w/ vendor-sec on this issue and give them a chance to prepare new packages? ```  [Comment 10](#c10)  Matthias Geerdsen (RETIRED)   gentoo-dev  2004-10-24 09:09:29 UTC  ``` <http://www.pizzashack.org/rssh/security.shtml>  Oct 23, 2004  Florian Schilhabel has identified a format string bug which can allow an attacker to run arbitrary code from an account configured to use rssh. In general the risk is low, as in most cases the user can only compromise their own account. The risk is mittigated by the fact that before this bug can be exploited, the user must log in successfully through ssh. This means that either the user is known, or that the system is already compromised.  However, on some older systems with broken implementations of the setuid() family of functions, a root compromise may be possible with certain configurations of rssh. Specifically, if rssh is configured to use a chroot jail, it will exec() rssh_chroot_helper, which must be setuid root in order to call chroot(). Normally, rssh_chroot_helper calls setuid(getuid()) and drops privileges before any of the logging functions are called, making a root compromise impossible on most systems. However, some older systems which handle saved UIDs improperly may be vulnerable to a root compromise. Linux in particular is not vulnerable to this, nor should modern POSIX-compliant Unix variants be. POSIX defines that the setuid() system call will set all UIDs (UID, saved UID, and effective UID) the specified UID if it is called with root privileges. Therefore in general, a root compromise is not possible, and I am not specifically aware of any systems on which one is possible.  The 2.2.2 release of rssh fixes this string format vulnerability. I have also gone over the code to make sure that no other such vulnerabilities exist. In addition to fixing this problem, rssh contains some new code to help identify certain problems for debugging problems when rssh fails. Additional logging of error conditions is performed.  ```  [Comment 11](#c11)  Thierry Carrez (RETIRED)   gentoo-dev  2004-10-25 00:32:26 UTC  ``` Apparently author won't provide the patch... and prefers to release advisory on its own. I propose to open this since it's now public. Florian, please confirm.  vapier || max : please bump rssh to 2.2.2... ```  [Comment 12](#c12)  SpanKY   gentoo-dev  2004-10-25 05:32:46 UTC  ``` ebuild updated and moved to stable for all  just needs GLSA now ```  [Comment 13](#c13)  Thierry Carrez (RETIRED)   gentoo-dev  2004-10-25 06:30:14 UTC  ``` vapier: bad boy, you opened it without reporter consent.  I refrain from calling a global developer vote to revoke you since it was probably OK to open it :)   ```  [Comment 14](#c14)  Florian Schilhabel (RETIRED)   gentoo-dev  2004-10-25 07:29:19 UTC  ``` hi, yes, bug is public now (author released advisory... ;-) ) thanks for your work  best regards florian  ```  [Comment 15](#c15)  Thierry Carrez (RETIRED)   gentoo-dev  2004-10-27 08:29:57 UTC  ``` GLSA 200410-28 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=66988)
* - [XML](show_bug.cgi?ctype=xml&id=66988)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=66988)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=66988&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=66988&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=66988&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.pizzashack.org_a070bf98_20250125_133618.html ===


| pizzashack.org - home of pizzacode | rssh homepage |
| --- | --- |

| | rssh | | [rssh home](index.shtml) | | [Japanese translation](http://www.sdri.co.jp/rssh/index.html.ja) | | [security](security.shtml) | | [platforms](platforms.shtml) | | [FAQ](faq.shtml) | | [mailing list](http://lists.sourceforge.net/lists/listinfo/rssh-discuss) | | [download](downloads.shtml) | | [future development](future.shtml) | |  | | about pizzashack.org | | [home](/) | | [history](/history.shtml) | |  | | projects | | [rssh](/rssh/) | | [netutils](http://sourceforge.net/projects/netutils) | | [mutt patches](/mutt/) | | [pipcalc](/pipcalc/) | | [admedit](http://sourceforge.net/projects/admedit) | |  | | contact | | [contact Info](/contact.shtml) | |  | | Introduction **`rssh`** is (or was) a restricted shell for use with [OpenSSH](http://www.openssh.com), allowing only `scp` and/or `sftp`, rdist, rsync, and cvs.  Sadly RSSH died a horrible death in 2019 when it became clear that providing restricted access to arbitrary programs is nearly impossible, particularly without being extremely expert in all of the programs involved (including sshd and all of the applications you wish to restrict). This proved to be an unmanageable task, and support for RSSH ended with unpatched (and I believe unpatchable) security issues, not entirely the fault of RSSH itself.  *Note:* All archives of RSSH source have been removed from the site. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | --- |
| --- | --- |
|  | [SourceForge Logo](http://sourceforge.net) |



=== Content from marc.info_279f6892_20250125_133615.html ===

```
[[prev in list](?l=bugtraq&m=109856073027753&w=2)] [[next in list](?l=bugtraq&m=109855895702903&w=2)] [[prev in thread](?l=openssh-unix-dev&m=109852360205671&w=2)] [[next in thread](?l=openssh-unix-dev&m=109856085300840&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [rssh: pizzacode security alert](?t=109852367300003&r=1&w=2)
From:       [Derek Martin <code () pizzashack ! org>](?a=104148899300002&r=1&w=2)
Date:       [2004-10-23 8:48:29](?l=bugtraq&r=1&w=2&b=200410)
Message-ID: [20041023084829.GA16819 () sophic ! org](?i=20041023084829.GA16819%20()%20sophic%20!%20org)
[Download RAW [message](?l=bugtraq&m=109855982425122&q=mbox) or [body](?l=bugtraq&m=109855982425122&q=raw)]

PIZZACODE SECURITY ALERT

program:	rssh
risk:		low[*]
problem:	string format vulnerability in log.c
details:

rssh is a restricted shell for use with OpenSSH, allowing only scp
and/or sftp. For example, if you have a server which you only want to
allow users to copy files off of via scp, without providing shell
access, you can use rssh to do that.  Additioanlly, running rsync,
rdist, and cvs are supported, and access can be configured on a
per-user basis using a simple text-based configuration file.  The rssh
homepage is here:

  <http://www.pizzashack.org/rssh/>

Florian Schilhabel has identified a format string bug which can allow
an attacker to run arbitrary code from an account configured to use
rssh.  [*]In general the risk is low, as in most cases the user can
only compromise their own account.  The risk is mittigated by the fact
that before this bug can be exploited, the user must log in
successfully through ssh.  This means that either the user is known to
the system (and therefore the administrators), or that the system is
probably already compromised.

However, on some older systems with broken implementations of the
setuid() family of functions, a root compromise may be possible with
certain configurations of rssh.  Specifically, if rssh is configured
to use a chroot jail, it will exec() rssh_chroot_helper, which must be
setuid root in order to call chroot().  Normally, rssh_chroot_helper
calls setuid(getuid()) and drops privileges before any of the logging
functions are called, making a root compromise impossible on most
systems.  However, some older systems which handle saved UIDs
improperly may be vulnerable to a root compromise.  Linux in
particular is not vulnerable to this, nor should modern
POSIX-compliant Unix variants be.  POSIX defines that the setuid()
system call will set all UIDs (UID, saved UID, and effective UID) the
specified UID if it is called with root privileges.  Therefore in
general, a root compromise is not possible, and I am not specifically
aware of any systems on which one is possible.

The 2.2.2 release of rssh fixes this string format vulnerability.  I
have also gone over the code to make sure that no other such
vulnerabilities exist.  In addition to fixing this problem, rssh
contains some new code to help identify certain problems for debugging
problems when rssh fails.  Additional logging of error conditions is
performed.

--
Derek D. Martin
<http://www.pizzashack.org/>
GPG Key ID: 0x81CFE75D

[[Attachment #3 (application/pgp-signature)]](?l=bugtraq&m=109855982425122&q=p3)

[[prev in list](?l=bugtraq&m=109856073027753&w=2)] [[next in list](?l=bugtraq&m=109855895702903&w=2)] [[prev in thread](?l=openssh-unix-dev&m=109852360205671&w=2)] [[next in thread](?l=openssh-unix-dev&m=109856085300840&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


