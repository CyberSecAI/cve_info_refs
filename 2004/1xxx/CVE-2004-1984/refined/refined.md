```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2004-1984",
      "source": "www.waraxe.us_003c581b_20250125_235509.html",
      "details": "This document refers to the advisory waraxe-2004-SA#026 which details multiple vulnerabilities in Coppermine Photo Gallery for PhpNuke."
    },
    {
      "cve_id": "CVE-2004-1984",
      "source": "marc.info_f8b18ed1_20250125_235502.html",
      "details": {
        "root_cause": "Multiple vulnerabilities exist due to insecure coding practices in Coppermine Photo Gallery 1.2.2b and 1.2.0 RC4 versions.",
        "weaknesses": [
          "**A. Full Path Disclosure:** Lack of direct access protection in scripts leads to PHP error messages revealing the full server path.",
          "**B. Cross-Site Scripting (XSS):**  The `menu.inc.php` script does not properly sanitize user-controlled input (`CPG_URL`), allowing for XSS attacks by injecting malicious scripts via the `CPG_URL` parameter.",
          "**C. Arbitrary Directory Browsing:**  By manipulating the `startdir` parameter in `modules.php`, an attacker can browse the server's directory structure.",
          "**D. Arbitrary Shell Command Execution:**  The `picmgmtbatch.inc.php` script uses the `exec()` function with insufficiently sanitized configuration variables (`impath`, `jpeg_qual`, etc.), allowing attackers with admin rights to inject and execute arbitrary shell commands.",
           "**E. Remote File Inclusion:** Insecure use of include paths allows remote file inclusion, enabling attackers to execute arbitrary PHP code."
        ],
        "impact": "Full path disclosure can assist attackers in crafting further attacks. XSS can lead to cookie theft and other browser-based attacks. Arbitrary directory browsing exposes sensitive information. Remote command execution can lead to complete server compromise, including database information exposure and remote shell access. Remote file inclusion can enable arbitrary code parsing and shell command injection, leading to a full system compromise.",
        "attack_vectors": [
           "Direct access to unprotected scripts for path disclosure.",
          "Crafting malicious URLs to inject XSS code via the `CPG_URL` parameter.",
          "Manipulating the `startdir` parameter in `modules.php` for directory browsing.",
          "Exploiting configuration settings in the admin panel to inject shell commands.",
          "Manipulating include paths to include remote files via `CPG_M_DIR` and `THEME_DIR` parameters."
        ],
          "required_attacker_capabilities": [
           "For path disclosure, no special capabilities are required.",
            "For XSS, the ability to craft a malicious URL.",
            "For directory browsing, ability to manipulate URL parameters.",
            "For arbitrary shell command execution, admin privileges in phpNuke.",
             "For remote file inclusion, ability to craft malicious URLs and host a malicious PHP script."
          ]
      }
    }
  ]
}
```