- **Root cause of vulnerability**: The `extcompose` script in the metamail package does not check if the output filename specified by the user is a symlink before writing to it.
- **Weaknesses/vulnerabilities present**: The script blindly writes output to the specified file using "echo >> file" commands without any checks. This allows for a symlink vulnerability and a race condition.
- **Impact of exploitation**: An attacker can overwrite arbitrary files with the privileges of the user invoking the `extcompose` script. This can lead to corruption of files, and in theory, privilege escalation if `extcompose` is run by a privileged user like root.
- **Attack vectors**: An attacker creates a symbolic link with the same name as the output file that the user will specify when running `extcompose`. When the user runs the script, the output is redirected to the attacker's target file through the symlink.
- **Required attacker capabilities/position**: The attacker needs to know the filename that the user will specify when running the script. This may occur if the attacker can observe the user entering the command. Additionally, the attacker needs to be able to create symlinks on the file system where the user will be executing the vulnerable script.