```text
Relevant to CVE-2004-1162.
Vulnerability: rssh and scponly are restricted shells that do not properly filter command-line options passed to certain programs (scp, rsync, rdist, unison). This allows a remote authenticated user to bypass the restricted shell and execute arbitrary commands on the target machine.

Root cause: The vulnerability exists because rssh and scponly do not filter command-line options that can be used to execute any command on the target host. Specifically, options like `-e` in `rsync`, `-S` in `scp`, `-P` in `rdist`, and `-rshcmd` or `-sshcmd` in `unison` can be abused to specify an arbitrary program to execute.

Attack vector: A remote, authenticated user can exploit this vulnerability by using a malicious command with a vulnerable program (e.g., `scp -S /tmp/command.sh localhost:/dev/null /tmp`). This allows them to execute any command or upload and execute any file on the target machine with user rights, effectively bypassing the restricted shell.

Impact of exploitation: Successful exploitation allows a remote authenticated user to bypass the restricted shell and execute arbitrary commands on the target machine with the privileges of the restricted user.

Affected versions:
- rssh: All versions <= 2.2.2
- scponly: All versions < 4.0
```