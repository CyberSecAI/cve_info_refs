=== Content from marc.info_b8c1a308_20250124_222357.html ===

```
[[prev in list](?l=bugtraq&m=110572551917990&w=2)] [[next in list](?l=bugtraq&m=110581738004054&w=2)] [[prev in thread](?l=rssh-discuss&m=130461356623963&w=2)] [[next in thread](?l=openssh-unix-dev&m=110581478513189&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Re: rssh and scponly arbitrary command execution](?t=110202048800003&r=1&w=2)
From:       [Derek Martin <code () pizzashack ! org>](?a=104148899300002&r=1&w=2)
Date:       [2005-01-15 5:24:26](?l=bugtraq&r=1&w=2&b=200501)
Message-ID: [20050115052426.GG8855 () sophic ! org](?i=20050115052426.GG8855%20()%20sophic%20!%20org)
[Download RAW [message](?l=bugtraq&m=110581113814623&q=mbox) or [body](?l=bugtraq&m=110581113814623&q=raw)]

I just released rssh version 2.2.3 to fix the problem detailed below.
I haven't had time to update my website yet, and my Internet acess is
quite limited these days (hence the terse announcement), so I probably
won't get to that for a while.  However, rssh 2.2.3 is available from
the sourceforge.net site:

  <http://sourceforge.net/projects/rssh>

All users of rssh should update to the latest release.  The rssh
homepage is here:

  <http://www.pizzashack.org/rssh>

Sorry for the slow response; I've had other priorities lately.

DM

On Thu, Dec 02, 2004 at 01:51:43PM +0000, Jason Wies wrote:
> Vulnerable applications:
>
>         rssh
>                 All versions
>                 All operating systems
>         scponly
>                 All versions
>                 All operating systems
>
> Not vulnerable:
>
> Discussion:
>
> rssh and scponly are restricted shells that are designed to allow execution
> only of certain preset programs.  Both are used to grant a user the ability
> to transfer files to and from a remote host without granting full shell
> access.  Due to the fact that most of the preset programs offer options that
> execute other programs, arbitrary command execution on the remote host is
> possible.
>
> rssh allows any of five predefined programs to be executed on the remote
> host depending on the configuration.  Those that are known to be vulnerable
> in combination with the techniques described in this posting are marked with
> an asterisk.
> - scp*
> - sftp-server
> - cvs
> - rdist*
> - rsync*
>
> scponly allows a number of predefined programs to be executed on the remote
> host depending on compile-time options.  Those that are known to be
> vulnerable when used with scponly:
> - scp
> - rsync
> - unison (*untested)
>
> The program execution options that these programs offer:
>
> rdist -P <program>
> rsync -e <program>
> scp -S <program>
> unison -rshcmd <program>
> unison -sshcmd <program>
>
> These options allow the user to specify the location of the shell to use
> when connecting to the remote host.  No restriction is placed on what
> programs may be specified by these options, and rssh and scponly do not
> filter these options out.  The end result is that although a user may be
> restricted by rssh or scponly to running e.g. only /usr/bin/scp, they can
> in fact execute any program using /usr/bin/scp -S <program>.
>
> The problem is compounded when you recognize that the main use of rssh and
> scponly is to allow file transfers, which in turn allows a malicious user to
> transfer and execute entire custom scripts on the remote machine.
>
> rssh with sftp-server does not appear to be vulnerable.  rssh with cvs is
> also not vulnerable using these techniques.  However, it is quite probable
> that a malicious user could check out a carefully crafted CVS repository and
> execute arbitrary commands using CVS's hooks interface.
>
> Examples:
>
>         ssh restricteduser@remotehost 'rsync -e "touch /tmp/example --" localhost:/dev/null /tmp'
>
>         scp command.sh restricteduser@remotehost:/tmp/command.sh
>         ssh restricteduser@remotehost 'scp -S /tmp/command.sh localhost:/dev/null /tmp'
>
> Solution:
>
> There are no workarounds for this problem.
>
> I have talked with the author of rssh, Derek Martin.  He is currently
> indisposed for an indefinite period of time due to changing countries and
> having no permanent home at the present moment.  Moreover he has other
> priorities and has lost interest in maintaining the program.  He has offered
> to assist anyone who would like to take over maintainership of rssh, but he
> does not intend to provide a fix for the current problem.  Given this fact,
> I would strongly recommend against using rssh at this time.
>
> The author of scponly, Joe Boyle, has prepared a new release, version 4.0,
> that addresses the current problem.
>
> Distributor updates have been coordinated with this posting and should be
> available soon.
>
> I think the long-term solution for those needing a highly secure restricted
> shell is to allow granular configuration by administrators of which options
> and arguments, if any, are allowed to be specified for which programs.  In
> the most restricted case entire command lines would be stored on the remote
> host and the client would be allowed only to select from the list of
> available command lines.  I'm not aware of any software that offers these
> capabilities today.
>
> References:
>         <http://www.pizzashack.org/rssh/index.shtml>
>         <http://www.sublimation.org/scponly/>
>
>
> -------------------------------------------------------
> SF email is sponsored by - The IT Product Guide
> Read honest & candid reviews on hundreds of IT Products from real users.
> Discover which products truly live up to the hype. Start reading now.
> <http://productguide.itmanagersjournal.com/>
> _______________________________________________
> rssh-discuss mailing list
> rssh-discuss@lists.sourceforge.net
> <https://lists.sourceforge.net/lists/listinfo/rssh-discuss>

--
Derek D. Martin
<http://www.pizzashack.org/>
GPG Key ID: 0x81CFE75D

[[Attachment #3 (application/pgp-signature)]](?l=bugtraq&m=110581113814623&q=p3)

[[prev in list](?l=bugtraq&m=110572551917990&w=2)] [[next in list](?l=bugtraq&m=110581738004054&w=2)] [[prev in thread](?l=rssh-discuss&m=130461356623963&w=2)] [[next in thread](?l=openssh-unix-dev&m=110581478513189&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.gentoo.org_6f40ae74_20250124_222358.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# rssh, scponly: Unrestricted command execution — GLSA **200412-01**

rssh and scponly do not filter command-line options that can be exploited
to execute any command, thereby allowing a remote user to completely bypass
the restricted shell.

### Affected packages

| Package | **net-misc/scponly** on all architectures |
| --- | --- |
| Affected versions | < **4.0** |
| Unaffected versions | >= **4.0** |

| Package | **app-shells/rssh** on all architectures |
| --- | --- |
| Affected versions | <= **2.2.2** |
| Unaffected versions | >= **2.2.3** |

### Background

rssh and scponly are two restricted shells, allowing only a few
predefined commands. They are often used as a complement to OpenSSH to
provide access to remote users without providing any remote execution
privileges.

### Description

Jason Wies discovered that when receiving an authorized command from an
authorized user, rssh and scponly do not filter command-line options
that can be used to execute any command on the target host.

### Impact

Using a malicious command, it is possible for a remote authenticated
user to execute any command (or upload and execute any file) on the
target machine with user rights, effectively bypassing any restriction
of scponly or rssh.

### Workaround

There is no known workaround at this time.

### Resolution

All scponly users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-misc/scponly-4.0"
```

All rssh users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-shells/rssh/rssh-2.2.3"
```
### References

* [BugTraq Posting](http://www.securityfocus.com/archive/1/383046/2004-11-30/2004-12-06/0)
* [CVE-2004-1161](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1161)
* [CVE-2004-1162](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1162)

**Release date**

December 03, 2004

**Latest revision**

May 22, 2006: 03

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [72815](https://bugs.gentoo.org/show_bug.cgi?id=72815)
* [72816](https://bugs.gentoo.org/show_bug.cgi?id=72816)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from marc.info_c1bd16dc_20250124_222356.html ===

```
[[prev in list](?l=bugtraq&m=110204322712852&w=2)] [[next in list](?l=bugtraq&m=110200971917165&w=2)] [prev in thread] [[next in thread](?l=rssh-discuss&m=130461356623955&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [rssh and scponly arbitrary command execution](?t=110202048800003&r=1&w=2)
From:       [Jason Wies <jason () xc ! net>](?a=99895008900003&r=1&w=2)
Date:       [2004-12-02 13:51:43](?l=bugtraq&r=1&w=2&b=200412)
Message-ID: [20041202135143.GA7105 () xc ! net](?i=20041202135143.GA7105%20()%20xc%20!%20net)
[Download RAW [message](?l=bugtraq&m=110202047507273&q=mbox) or [body](?l=bugtraq&m=110202047507273&q=raw)]

Vulnerable applications:

        rssh
                All versions
                All operating systems
        scponly
                All versions
                All operating systems

Not vulnerable:

Discussion:

rssh and scponly are restricted shells that are designed to allow execution
only of certain preset programs.  Both are used to grant a user the ability
to transfer files to and from a remote host without granting full shell
access.  Due to the fact that most of the preset programs offer options that
execute other programs, arbitrary command execution on the remote host is
possible.

rssh allows any of five predefined programs to be executed on the remote
host depending on the configuration.  Those that are known to be vulnerable
in combination with the techniques described in this posting are marked with
an asterisk.
- scp*
- sftp-server
- cvs
- rdist*
- rsync*

scponly allows a number of predefined programs to be executed on the remote
host depending on compile-time options.  Those that are known to be
vulnerable when used with scponly:
- scp
- rsync
- unison (*untested)

The program execution options that these programs offer:

rdist -P <program>
rsync -e <program>
scp -S <program>
unison -rshcmd <program>
unison -sshcmd <program>

These options allow the user to specify the location of the shell to use
when connecting to the remote host.  No restriction is placed on what
programs may be specified by these options, and rssh and scponly do not
filter these options out.  The end result is that although a user may be
restricted by rssh or scponly to running e.g. only /usr/bin/scp, they can
in fact execute any program using /usr/bin/scp -S <program>.

The problem is compounded when you recognize that the main use of rssh and
scponly is to allow file transfers, which in turn allows a malicious user to
transfer and execute entire custom scripts on the remote machine.

rssh with sftp-server does not appear to be vulnerable.  rssh with cvs is
also not vulnerable using these techniques.  However, it is quite probable
that a malicious user could check out a carefully crafted CVS repository and
execute arbitrary commands using CVS's hooks interface.

Examples:

        ssh restricteduser@remotehost 'rsync -e "touch /tmp/example --" localhost:/dev/null /tmp'

        scp command.sh restricteduser@remotehost:/tmp/command.sh
        ssh restricteduser@remotehost 'scp -S /tmp/command.sh localhost:/dev/null /tmp'

Solution:

There are no workarounds for this problem.

I have talked with the author of rssh, Derek Martin.  He is currently
indisposed for an indefinite period of time due to changing countries and
having no permanent home at the present moment.  Moreover he has other
priorities and has lost interest in maintaining the program.  He has offered
to assist anyone who would like to take over maintainership of rssh, but he
does not intend to provide a fix for the current problem.  Given this fact,
I would strongly recommend against using rssh at this time.

The author of scponly, Joe Boyle, has prepared a new release, version 4.0,
that addresses the current problem.

Distributor updates have been coordinated with this posting and should be
available soon.

I think the long-term solution for those needing a highly secure restricted
shell is to allow granular configuration by administrators of which options
and arguments, if any, are allowed to be specified for which programs.  In
the most restricted case entire command lines would be stored on the remote
host and the client would be allowed only to select from the list of
available command lines.  I'm not aware of any software that offers these
capabilities today.

References:
        <http://www.pizzashack.org/rssh/index.shtml>
        <http://www.sublimation.org/scponly/>
[[prev in list](?l=bugtraq&m=110204322712852&w=2)] [[next in list](?l=bugtraq&m=110200971917165&w=2)] [prev in thread] [[next in thread](?l=rssh-discuss&m=130461356623955&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


