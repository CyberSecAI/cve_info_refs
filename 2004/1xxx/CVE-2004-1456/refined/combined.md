=== Content from www.kb.cert.org_3804c79a_20250126_004034.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#770816

## CVSTrac fails to properly sanitize input passed to "filediff"

#### Vulnerability Note VU#770816

Original Release Date: 2004-08-23 | Last Revised: 2004-08-23

---

### Overview

CVSTrac fails to check the validity of input passed to the "rcsinfo" parameter of "filediff." This allows execution of arbitrary commands on the server.

### Description

| [CVSTrac](http://www.cvstrac.org/) is a web-based bug and patch set tracking system for use with CVS. CVSTrac 1.1.3 and earlier fail to properly sanitize input to the "rcsinfo" parameter of the "filediff" command. By passing specially crafted arguments to the "rcsinfo" parameter, a remote attacker can execute arbitrary commands on the server. |
| --- |

### Impact

| A remote authenticated user who has the permissions to check in CVS files can run arbitrary shell commands on the server with the privileges of the CVSTrac process. By default, anonymous users cannot access the vulnerable "filediff" method. |
| --- |

### Solution

| This issue is resolved in [CVSTrac version 1.1.4](http://www.cvstrac.org/cvstrac/wiki?p=DownloadCvstrac) or see the "Systems Affected" section for vendor-specific resolutions. |
| --- |

### Vendor Information

770816
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23770816/) to view vendors.**
### [CVSTrac](#WDON-63WU3E) Affected

Notified:  August 16, 2004  Updated: August 23, 2004

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

This issue is resolved in [CVSTrac version 1.1.4](http://www.cvstrac.org/cvstrac/wiki?p=DownloadCvstrac).

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [OpenPKG](#WDON-63WU9Q) Affected

Updated:  August 16, 2004

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Please see [OpenPKG-SA-2004.036](http://www.openpkg.org/security/OpenPKG-SA-2004.036-cvstrac.html).

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.securityfocus.com/bid/10878>
* <http://secunia.com/advisories/12090/>
* <http://www.cvstrac.org/cvstrac/tktview?tn=339>
* <http://www.cvstrac.org/cvstrac/chngview?cn=316>
* <http://securitytracker.com/alerts/2004/Aug/1010880.html>
* <http://securitytracker.com/alerts/2004/Aug/1010892.html>
* <http://www.osvdb.org/8373>
* <http://xforce.iss.net/xforce/xfdb/16929>
### Acknowledgements

Thanks to Richard Ngo for reporting this vulnerability.

This document was written by Will Dormann.

### Other Information

| **CVE IDs:** | [None](http://web.nvd.nist.gov/vuln/detail/None) |
| --- | --- |
| **Severity Metric:** | 16.88 |
| **Date Public:** | 2004-08-09 |
| **Date First Published:** | 2004-08-23 |
| **Date Last Updated:** | 2004-08-23 17:50 UTC |
| **Document Revision:** | 12 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.cvstrac.org_ec8c9170_20250126_004031.html ===

# cvstrac - Check-in [316]

[Not logged in](login?nxp=/cvstrac/chngview%3Fcn%3D316 "Log in")

* [Honeypot](honeypot)
* [Browse](dir)
* [Help](wiki?p=CvstracCheckin)
* [Home](index)
* [Login](login)
* [Reports](reportlist)
* [Search](search?c=1&f=1)
* [Ticket](tktnew)
* [Timeline](timeline)
* [Wiki](wiki)

* [Patchset](patchset?cn=316)
* [Tagging/Branching](taghints?cn=316)

| Check-in Number: | 316 |  |
| --- | --- | --- |
| Date: | 2004-Aug-06 16:00:16 (local) 2004-Aug-06 16:00:16 (UTC) |
| User: | drh |
| Branch: |  |
| Comment: | Fix for security vulnerability. Ticket [#339](tktview?tn=339 "remote command execution vulnerability"). | |
| Tickets: | | [#339](tktview?tn=339 "remote command execution vulnerability") |  | remote command execution vulnerability | | --- | --- | --- | | |
| Inspections: |  | |
| Check-ins: |  | |
| Files: | | [cvstrac/setup.c](rlog?f=cvstrac/setup.c) | [1.38](fileview?f=cvstrac/setup.c&v=1.38) [->](filediff?f=cvstrac/setup.c&v1=1.38&v2=1.39) [1.39](fileview?f=cvstrac/setup.c&v=1.39) | 6 inserted, 5 deleted | | --- | --- | --- | | [cvstrac/timeline.c](rlog?f=cvstrac/timeline.c) | [1.78](fileview?f=cvstrac/timeline.c&v=1.78) [->](filediff?f=cvstrac/timeline.c&v1=1.78&v2=1.79) [1.79](fileview?f=cvstrac/timeline.c&v=1.79) | 13 inserted, 2 deleted | | |

---

---

[CVSTrac version 2.0.1](about)



=== Content from marc.info_a837d119_20250126_004030.html ===

```
[[prev in list](?l=bugtraq&m=109173242726479&w=2)] [[next in list](?l=bugtraq&m=109173210708969&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=109182273403357&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [CVStrac Remote Arbitrary Code Execution exploit](?t=109173373400001&r=1&w=2)
From:       [Richard Ngo <rtngo () yahoo ! com>](?a=109173359700006&r=1&w=2)
Date:       [2004-08-05 17:57:09](?l=bugtraq&r=1&w=2&b=200408)
Message-ID: [20040805175709.6995.qmail () web50508 ! mail ! yahoo ! com](?i=20040805175709.6995.qmail%20()%20web50508%20!%20mail%20!%20yahoo%20!%20com)
[Download RAW [message](?l=bugtraq&m=109173359428253&q=mbox) or [body](?l=bugtraq&m=109173359428253&q=raw)]

Hi, Im Richard Ngo, this is the first time i report an
exploit and found a remote exploit that could allow
arbitrary code execution in CVStrac.

sample exploit

filediff?f=CVSROOT/rcsinfo&v1=1.1&v2=1.2;w;

All versions vulnerable. I have not contacted
cvstrac.org since i cant find their email address.
Please give me credit for the exploit and *please dont
release the exploit code to the public* for other
websites security. Maybe just create an advisory.
Thank you.

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around
<http://mail.yahoo.com>
[[prev in list](?l=bugtraq&m=109173242726479&w=2)] [[next in list](?l=bugtraq&m=109173210708969&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=109182273403357&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.cvstrac.org_52192c2f_20250126_004032.html ===

# cvstrac - Ticket #339

[Not logged in](login?nxp=/cvstrac/tktview%3Ftn%3D339 "Log in")

* [Honeypot](honeypot)
* [Browse](dir)
* [Help](wiki?p=CvstracTicket)
* [Home](index)
* [Login](login)
* [Reports](reportlist)
* [Search](search?t=1)
* [Ticket](tktnew)
* [Timeline](timeline)
* [Wiki](wiki)

* [Attach](attach_add?tn=339)
* [Edit](tktedit?tn=339)
* [History](tkthistory?tn=339)

## Ticket #339: remote command execution vulnerability

> The following message just arrived on Bugtraq:
>
>
> ```
>
> CVStrac Remote Arbitrary Code Execution exploit
>  Date: 2004-08-05 13:57
>  From: Richard Ngo <rtngo@yahoo.com>
>  To: vulndb@securityfocus.com
>  CC: bugtraq@securityfocus.com
>
> Hi, Im Richard Ngo, this is the first time i report an
> exploit and found a remote exploit that could allow
> arbitrary code execution in CVStrac.
>
> sample exploit
>
> filediff?f=CVSROOT/rcsinfo&v1=1.1&v2=1.2;w;
>
> All versions vulnerable. I have not contacted
> cvstrac.org since i cant find their email address.
> Please give me credit for the exploit and *please dont
> release the exploit code to the public* for other
> websites security. Maybe just create an advisory.
> Thank you.
>
> ```
> I imagine this is largely moot in chrooted mode. Just for fun I whipped up a quick patch. The core of the vulnerability is that cvstrac doesn't verify that tags/revisions are sane.
>
> c.

[[Append remarks](tktappend?tn=339)]
### Remarks:

> *2007-Aug-02 14:07:23 by anonymous:*
>
> this change (or a similar one) is causing a problem such that ticket remarks (and description, probably, too) are not able to be passed to the notify script if they include single quotes. I fixed this, in house, by hacking the quotable\_strings() function to replace single quotes with back-ticks. Another fix would have been to simply send the ticket number to the notify script and query the db, directly, but then I'd have to do my own wiki->html transformations.
>
>
>
> ---
>
>
> *2007-Aug-02 15:07:34 by cpb:*
>
> Converting to backticks is certainly an option. I suggested just that in [#705](tktview?tn=705 "Change notification eats fields with quotes instead of substituting."), to switch `quotable_string` to `sqlite3_mprintf("%q",s);`. I personally don't use ticket notification scripts, and since nobody else had any comments... <shrug>
>
> Two other options which are also practical:
>
>
>
> 1. like wiki program markup, where we feed the block of text into STDIN of the script- like external tools, where we dump things into temporary files and unlink the files after the script runs
>
> Any of the three is feasible, or more than one. Changing `quotable_string` deletes more code than it adds, though, so I'd definitely have to claim that as a preference.

[[Append remarks](tktappend?tn=339)]
### Properties:

> | Type: | **code** |  | Version: | **1.1.13** |
> | --- | --- | --- | --- | --- |
> | Status: | **fixed** |  | Created: | **2004-Aug-06 01:49** |
> | Severity: | **1** |  | Last Change: | **2007-Aug-02 15:07** |
> | Priority: | **1** |  | Subsystem: | **cvstrac** |
> | Assigned To: | **drh** |  | Derived From: |  |
> | Creator: | **anonymous** |

### Related Check-ins:

| 2004-Aug-18 00:11 |  | Check-in [[319]](chngview?cn=319): Add additional checks of user-supplied parameters in order to help prevent future vulnerabilities similar to ticket [#339](tktview?tn=339 "remote command execution vulnerability"). (By drh) |
| --- | --- | --- |
| 2004-Aug-06 16:00 |  | Check-in [[316]](chngview?cn=316): Fix for security vulnerability. Ticket [#339](tktview?tn=339 "remote command execution vulnerability"). (By drh) |

### Attachments:

> * [bad\_revisions.patch](attach_get/35/bad_revisions.patch)
>   1907 bytes added by anonymous on 2004-Aug-06 01:51:33 UTC.

[CVSTrac version 2.0.1](about)


