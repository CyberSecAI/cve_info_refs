=== Content from www1.mplayerhq.hu_e6919304_20250124_215758.html ===
--- MPlayer-1.0pre5/libmpdemux/asf\_mmst\_streaming.c 2004-07-02 22:36:50.000000000 +0200
+++ MPlayer-1.0pre5try2/libmpdemux/asf\_mmst\_streaming.c 2004-12-15 21:32:03.000000000 +0100
@@ -42,6 +42,7 @@
#include "network.h"
#define BUF\_SIZE 102400
+#define HDR\_BUF\_SIZE 8192
typedef struct
{
@@ -216,6 +217,11 @@
// printf ("asf header packet detected, len=%d\n", packet\_len);
+ if (packet\_len < 0 || packet\_len > HDR\_BUF\_SIZE - header\_len) {
+ mp\_msg(MSGT\_NETWORK, MSGL\_FATAL, "Invalid header size, giving up\n");
+ return 0;
+ }
+
if (!get\_data (s, &header[header\_len], packet\_len)) {
printf ("header data read failed\n");
return 0;
@@ -250,6 +256,12 @@
packet\_len = get\_32 ((unsigned char\*)&packet\_len, 0) + 4;
// printf ("command packet detected, len=%d\n", packet\_len);
+
+ if (packet\_len < 0 || packet\_len > BUF\_SIZE) {
+ mp\_msg(MSGT\_NETWORK, MSGL\_FATAL,
+ "Invalid rtsp packet size, giving up\n");
+ return 0;
+ }
if (!get\_data (s, data, packet\_len)) {
printf ("command data read failed\n");
@@ -361,6 +373,12 @@
// printf ("asf media packet detected, len=%d\n", packet\_len);
+ if (packet\_len < 0 || packet\_len > BUF\_SIZE) {
+ mp\_msg(MSGT\_NETWORK, MSGL\_FATAL,
+ "Invalid rtsp packet size, giving up\n");
+ return 0;
+ }
+
if (!get\_data (s, data, packet\_len)) {
printf ("media data read failed\n");
return 0;
@@ -380,6 +398,12 @@
packet\_len = get\_32 ((unsigned char\*)&packet\_len, 0) + 4;
+ if (packet\_len < 0 || packet\_len > BUF\_SIZE) {
+ mp\_msg(MSGT\_NETWORK, MSGL\_FATAL,
+ "Invalid rtsp packet size, giving up\n");
+ return 0;
+ }
+
if (!get\_data (s, data, packet\_len)) {
printf ("command data read failed\n");
return 0;
@@ -464,7 +488,7 @@
{
char str[1024];
char data[BUF\_SIZE];
- uint8\_t asf\_header[8192];
+ uint8\_t asf\_header[HDR\_BUF\_SIZE];
int asf\_header\_len;
int len, i, packet\_length;
char \*path, \*unescpath;


=== Content from www.mandriva.com_7c640528_20250124_215757.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us


