=== Content from bugzilla.mozilla.org_a01eb8a1_20250125_094147.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/206859)
* [XML](/show_bug.cgi?ctype=xml&id=206859)

Closed
[Bug 206859](/show_bug.cgi?id=206859)

Opened 22 years ago
Closed 21 years ago

# can drag text into file upload control

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

can drag text into file upload control

## Categories

### (Core :: Security, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Security#Security)

Security
▾

Core :: Security
For non-crypto security bugs. Or use this general component if you know you have a Browser security bug, but not sure what component to use. Bug will be reviewed for proper component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

major

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jruderman, Assigned: john)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f2819cd9c715383fea7c039b2fd68e8c?d=mm&size=40)  [john](/user_profile?user_id=9757)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/7b3a9b12c0c36c3037c0807e02425dec?d=mm&size=40)  [carosendahl](/user_profile?user_id=48213)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=40)  [jruderman](/user_profile?user_id=11608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=40)  [dveditz](/user_profile?user_id=1689)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1839555](/show_bug.cgi?id=1839555 "RESOLVED FIXED - Get rid of `nsIFormController::AllowDrop`")

## Details

### (Keywords: csectype-spoof, fixed1.4.3, sec-high)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[fixed1.4.3](/buglist.cgi?keywords=fixed1.4.3&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Demo: "drag the smiley into the box"](/attachment.cgi?id=124058)  [22 years ago](#c1)  [Jesse Ruderman](/user_profile?user_id=11608)   1.46 KB, text/html |  | [Details](/attachment.cgi?id=124058&action=edit) |
| --- | --- | --- |
| [Don't allow dropping into file inputs.](/attachment.cgi?id=137698)  [21 years ago](#c12)  [Johnny Stenback (:jst)](/user_profile?user_id=12352)   6.73 KB, patch | caillon : [review+](#c13 "21 years ago")  bryner : [superreview+](#a20614616_15991 "21 years ago")  caillon : [approval1.4.3+](#c20 "21 years ago")  chofmann : [approval1.7a+](#c16 "21 years ago") | [Details](/attachment.cgi?id=137698&action=edit) | [Diff](/attachment.cgi?id=137698&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206859&attachment=137698) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=206859#c0)• 22 years ago |
|  | |

Mozilla allows dragging text into file upload controls. See the testcase for
how this can be abused.
Suggested fix: allow dragging text into normal text fields but not into file
upload controls. (This is what IE for Windows does.)
See also:
[bug 50660](/show_bug.cgi?id=50660 "RESOLVED FIXED - [FILE]Drag and drop for file upload form control") Should be able to drag FILES to the file upload control
[bug 57770](/show_bug.cgi?id=57770 "RESOLVED DUPLICATE - Using styles, clipboard to confuse text entry into file upload control") Using styles, clipboard to confuse text entry into file upload control

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=206859#c1)• 22 years ago |
|  | |

Attached file
[Demo: "drag the smiley into the box"](attachment.cgi?id=124058)
— [Details](attachment.cgi?id=124058&action=edit)

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206859#a56812_11608)• 22 years ago |

Flags: blocking1.4?

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=206859#c2)• 22 years ago |
|  | |

Probably internet exploder does not allow dragging into upload because IIRC
there was an exploit with only clicking which "emulated" dragging into file upload.

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=206859#c3)• 22 years ago |
|  | |

Even if Mozilla doesn't have a bug that can turn a click into a drag, I think
this should be fixed.

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=206859#c4)• 22 years ago |
|  | |

Over to jkeiser. I'd realy like to see this fix get into 1.4.Assignee: mstoltz → jkeiserKeywords: [nsbeta1](/buglist.cgi?keywords=nsbeta1&resolution=---)

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=206859#c5)• 22 years ago |
|  | |

I suggest a long term solution to file upload attacks - a warning that a file is
being uploaded (probably also a warning not to turn off the first warning).
This will stop also unknown file upload attacks.
Uploading files does not seem often used, so probably it won't be very annoying.

|  | [John Keiser (jkeiser)](/user_profile?user_id=9757)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=206859#c6)• 22 years ago |
|  | |

This seems reasonable. One can drag into the browse box anyway, and that can't
be obscured.Status: NEW → ASSIGNED

|  | [Mitchell Stoltz (not reading bugmail)](/user_profile?user_id=6444) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=206859#c7)• 22 years ago |
|  | |

John, we think this is dangerous. Can we consider disallowing the dragging?

|  | [Samir Gehani](/user_profile?user_id=4115) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=206859#c8)• 22 years ago |
|  | |

adt: nsbeta1-Keywords: [nsbeta1](/buglist.cgi?keywords=nsbeta1&resolution=---) → [nsbeta1-](/buglist.cgi?keywords=nsbeta1-&resolution=---)

|  | [Asa Dotzler [:asa]](/user_profile?user_id=5003) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=206859#c9)• 21 years ago |
|  | |

mozilla1.4 shipped. unsetting blocking1.4 request.Flags: blocking1.4?

|  | [chris hofmann](/user_profile?user_id=2687) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=206859#c10)• 21 years ago |
|  | |

john, still have cycles to look at this?

|  | [chris hofmann](/user_profile?user_id=2687) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=206859#c11)• 21 years ago |
|  | |

adding jst to cc list

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=206859#c12)• 21 years ago |
|  | |

Attached patch

[Don't allow dropping into file inputs.](attachment.cgi?id=137698&action=diff)
— [Details](attachment.cgi?id=137698&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206859&attachment=137698)

This fixes this bug, but I'm not sure I got this in the right place. I made the
plain text data transfer code prevent dropping into form controls that don't
allow it, but is that enough? It is for this case, but can others think of
other cases that this might not cover?

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206859#a18141094_12352)• 21 years ago |

[Attachment #137698](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") -
Flags: superreview?(hjtoi-bugzilla)
[Attachment #137698](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") -
Flags: review?(caillon)

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206859#a19251267_11608)• 21 years ago |

Flags: blocking1.7a?

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=206859#c13)• 21 years ago |
|  | |

Comment on [attachment 137698](/attachment.cgi?id=137698 "Don't allow dropping into file inputs.") [[details]](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") [[diff]](/attachment.cgi?id=137698&action=diff "Don't allow dropping into file inputs.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206859&attachment=137698)
Don't allow dropping into file inputs.
I'm wondering if we can avoid getting this far altogether (when we get a drop
event in a form control which doesn't allow dropping, I think we should be able
to avoid even calling the editor methods). If you want to land this, though,
r=caillon since this route is also fine. One other thing I'd ask is whether we
want to also consider adding a similar check to nsHTMLDataTransfer.cpp in case
someone wants to disable dropping in their implementation for HTML widgets?
[Attachment #137698](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") -
Flags: review?(caillon) → review+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=206859#c14)• 21 years ago |
|  | |

Comment on [attachment 137698](/attachment.cgi?id=137698 "Don't allow dropping into file inputs.") [[details]](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") [[diff]](/attachment.cgi?id=137698&action=diff "Don't allow dropping into file inputs.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206859&attachment=137698)
Don't allow dropping into file inputs.
I'm kinda leaning towards leaving the code where I originally put it, though
I'm not opposed to finding another place for it, but for now I think I'd prefer
to leave it. And I'm having a hard time imagining a situation where we'd have a
HTML widget form control that doesn't allow dropping into. So I'm going to
leave this as is unless I hear convinsing arguments for moving this check.
[Attachment #137698](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") -
Flags: superreview?(hjtoi-bugzilla) → superreview?(bryner)

|  | [Brian Ryner (not reading)](/user_profile?user_id=15991) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206859#a20614616_15991)• 21 years ago |

[Attachment #137698](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") -
Flags: superreview?(bryner) → superreview+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=206859#c15)• 21 years ago |
|  | |

Comment on [attachment 137698](/attachment.cgi?id=137698 "Don't allow dropping into file inputs.") [[details]](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") [[diff]](/attachment.cgi?id=137698&action=diff "Don't allow dropping into file inputs.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206859&attachment=137698)
Don't allow dropping into file inputs.
Duh, forgot to land this last night. It's a security problem, so I'd vote for
taking this for 1.7a.
[Attachment #137698](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") -
Flags: approval1.7a?

|  | [chris hofmann](/user_profile?user_id=2687) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=206859#c16)• 21 years ago |
|  | |

Comment on [attachment 137698](/attachment.cgi?id=137698 "Don't allow dropping into file inputs.") [[details]](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") [[diff]](/attachment.cgi?id=137698&action=diff "Don't allow dropping into file inputs.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206859&attachment=137698)
Don't allow dropping into file inputs.
a=chofmann for 1.7a
[Attachment #137698](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") -
Flags: approval1.7a? → approval1.7a+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=206859#c17)• 21 years ago |
|  | |

Fixed.Status: ASSIGNED → RESOLVEDClosed: 21 years agoResolution: --- → FIXED

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206859#a22855253_15661)• 21 years ago |

Flags: blocking1.7a?

|  | [Tracy Walker [:tracy]](/user_profile?user_id=18566) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=206859#c18)• 21 years ago |
|  | |

verified with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7b)
Gecko/20040421Status: RESOLVED → VERIFIED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=206859#c19)• 21 years ago |
|  | |

Adding Jon Granrose to CC list to help round up QA resources for verification

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=206859#c20)• 21 years ago |
|  | |

Comment on [attachment 137698](/attachment.cgi?id=137698 "Don't allow dropping into file inputs.") [[details]](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") [[diff]](/attachment.cgi?id=137698&action=diff "Don't allow dropping into file inputs.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206859&attachment=137698)
Don't allow dropping into file inputs.
a=blizzard for 1.4.3
[Attachment #137698](/attachment.cgi?id=137698&action=edit "Don't allow dropping into file inputs.") -
Flags: approval1.4.3+

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=206859#c21)• 21 years ago |
|  | |

Fixed on the 1.4 branchKeywords: [fixed1.4.3](/buglist.cgi?keywords=fixed1.4.3&resolution=---)OS: Windows XP → All

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206859#a36642809_1689)• 21 years ago |

Whiteboard: [sg:fix]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=206859#c22)• 21 years ago |
|  | |

Removing security-sensitive flag for bugs on the known-vulnerabilities listGroup: security

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206859#a317145761_11608)• 12 years ago |

Keywords: [csec-spoof](/buglist.cgi?keywords=csec-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)Whiteboard: [sg:fix]

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206859#a633639814_34283)• 2 years ago |

See Also: → [1839555](/show_bug.cgi?id=1839555 "RESOLVED FIXED - Get rid of `nsIFormController::AllowDrop`")
You need to [log in](/show_bug.cgi?id=206859&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jesse Ruderman](/user_profile?user_id=11608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


