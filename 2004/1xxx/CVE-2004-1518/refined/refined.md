Based on the provided content, here's an analysis of the SQL injection vulnerability in Phorum 5.0.12 and older versions:

**Root cause of vulnerability:**
- The vulnerability stems from the lack of sanitization of user-supplied input (`$thread` variable) before using it in an SQL query within the `phorum_db_get_message()` function. The value for `$thread` can come from `$_POST["thread"]`, `$PHORUM["args"][1]`, `$_GET` or `$_COOKIE` arrays if not set using the former two.

**Weaknesses/vulnerabilities present:**
- **SQL Injection:** The `$message_id` parameter is directly incorporated into the SQL query without proper sanitization or escaping. This allows an attacker to inject arbitrary SQL code. The vulnerable query is:
   ```sql
   select {$PHORUM['message_table']}.* from {$PHORUM['message_table']} where $forum_id_check message_id=$message_id
   ```
- **Unsanitized user input:** The code directly uses data from POST, GET, or cookie variables without sanitizing it, making it vulnerable to injection attacks.

**Impact of exploitation:**
- **Data Breach:** Attackers can use SQL injection to extract sensitive information from the database, including usernames, passwords (md5 hashes), and other private data.
- **Privilege Escalation:** By crafting specific SQL injection payloads, attackers can potentially access data from other users or gain elevated privileges.
- **Data Modification:** Attackers could modify or delete data.
- **Arbitrary Code Execution:**  In some MySQL configurations and versions, SQL injection could potentially lead to arbitrary code execution on the server.

**Attack vectors:**
- **HTTP GET Request:**  An attacker can send a specially crafted GET request to the `follow.php` script with a malicious `thread` parameter. For example:
  ```
  http://localhost/phorum5012/follow.php?forum_id=1&thread=malicious_sql
  ```
   or
  ```
  http://localhost/phorum5012/follow.php?forum_id=1&,f00=bar,1=malicious_sql
  ```
- **HTTP POST Request:** An attacker can also send a malicious SQL payload through a POST request with a crafted `thread` parameter.
- **HTTP Cookie:** An attacker can manipulate the cookie to inject the malicious SQL code using the variable `$thread`.

**Required attacker capabilities/position:**
- **Logged-in user:** The attacker needs to be a logged-in user to exploit the vulnerability. This is explicitly stated in the advisory.
- **Web Browser:** The attacker needs a web browser or a tool to make HTTP requests.
- **Knowledge of SQL and database structure:** The attacker needs some knowledge of SQL to craft malicious payloads.

**Additional notes:**

*   The provided exploit example demonstrates how to extract admin usernames and password hashes by using the UNION ALL SELECT statement, targeting MySQL versions that support this functionality.
* The vulnerability affects all Phorum 5.0.x versions up to and including 5.0.12 and has been fixed in version 5.0.13.