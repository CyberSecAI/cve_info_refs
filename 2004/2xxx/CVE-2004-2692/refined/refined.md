```
{
  "vulnerability_details": [
    {
      "Root cause": "The `php-exec-dir` patch for PHP did not properly escape shell metacharacters when executing commands via the backtick operator.",
      "Weaknesses": [
        "Improper input sanitization",
        "Insufficient escaping of shell metacharacters"
       ],
      "Impact": "Arbitrary command execution outside the intended `exec_dir` restriction.",
      "Attack vectors": "By prepending characters like '|' or '&' followed by a space to the beginning of the command executed with backticks.",
      "Required attacker capabilities": "Ability to execute PHP code using the backtick operator on a server with the vulnerable patch."
    },
        {
      "Root cause": "A bug in versions 5.4.0 - 5.4.4 of the patch caused some functions (file_exists, is_executable etc.) to return false unless the tested files were placed in the directory defined in the exec_dir directive.",
      "Weaknesses": [
        "Incorrect implementation of the patch which limited the scope of file related functions."
       ],
       "Impact": "Some functions (file_exists, is_executable etc.) to return false unless these tested files were placed in directory defined in the exec_dir directive.",
      "Attack vectors": "N/A",
       "Required attacker capabilities": "N/A"
    },
    {
          "Root cause": "The `proc_open()` function was not respecting the `exec_dir` restriction",
      "Weaknesses": [
        "The `proc_open()` function was not implementing the `exec_dir` check correctly"
       ],
      "Impact": "Arbitrary command execution outside the intended `exec_dir` restriction via the `proc_open()` function.",
       "Attack vectors": "By calling the `proc_open()` function with a command outside the allowed directory.",
      "Required attacker capabilities": "Ability to execute PHP code on a server with the vulnerable patch."
    },
    {
          "Root cause": "A bug where disabling `exec_dir` via `php_admin_value exec_dir none` would instead try to run binaries as if they were in the root directory of the filesystem",
      "Weaknesses": [
        "Incorrect implementation of the `none` disable option."
       ],
      "Impact": "Execution of commands from the root file system despite attempts to disable `exec_dir`",
       "Attack vectors": "By using `php_admin_value exec_dir none` to disable the functionality, which instead bypasses the intended restriction.",
      "Required attacker capabilities": "Ability to configure the `php_admin_value` option."
    }
  ]
}
```