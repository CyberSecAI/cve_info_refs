```
{
  "vulnerability_details": {
    "root_cause": "The NetBSD and FreeBSD systrace implementations lacked a superuser check when restoring user ID after a system call with elevated permissions. The syscall handling is split into enter and exit parts. The superuser check was missing in the exit code, because flags were cleared in the enter procedure. By manipulating the flags and causing a kernel error during argument copying, the exit procedure could be tricked into restoring the process permissions to savedugid values, resulting in superuser privileges.",
    "weaknesses": [
      "Missing superuser privilege check during user ID restoration in systrace.",
      "Incorrect handling of system call arguments resulting in skipping system call execution but calling trace_exit function"
    ],
    "impact": "Local users with access to the systrace device can gain root privileges.",
    "attack_vectors": "Local access via the systrace device. The attacker attaches to a child process, sends a privilege elevation answer to a system call result message, and causes a kernel error during system call argument copying.  This triggers the trace_exit() routine to restore the process permissions to savedugid values, granting root privileges.",
    "required_capabilities": "Local user with access to the systrace device. The attacker needs to be able to attach to a child process and manipulate the system call arguments to cause an error during copying into kernel space. Assembly language knowledge is mentioned as helpful to achieve this."
  }
}
```