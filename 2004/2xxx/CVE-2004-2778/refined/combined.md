=== Content from www.openwall.com_9e883d08_20250125_021722.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20398bb624f64da8b11f520c02b57cc7@imshyb01.MITRE.ORG>
Date: Sat, 28 Jan 2017 17:12:19 -0500
From: <cve-assign@...re.org>
To: <piotr.karbowski@...il.com>
CC: <cve-assign@...re.org>, <oss-security@...ts.openwall.com>
Subject: Re: Gentoo: order of installed packages may result in vary directories permissions, leading to crontab not requiring cron group membership as example.

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> [] On one system after installing set of packages, the
> /var/spool/cron ended up being cron:root 755
> ...
> <https://bugs.gentoo.org/show_bug.cgi?id=607430>
> <https://bugs.gentoo.org/show_bug.cgi?id=607426>
>
> <https://bugs.gentoo.org/show_bug.cgi?id=396153>
> <https://bugs.gentoo.org/show_bug.cgi?id=141619>
> <https://bugs.gentoo.org/show_bug.cgi?id=58611>

Use CVE-2004-2778.

This CVE is for the general issue that permissions can end up weaker
than intended because of the state of the filesystem at the time an
ebuild is installed. (It is not exclusively a CVE about directories
for cron.) As mentioned in the 607430 description, "it's not clear to
me whether Portage should provide a solution to that, or the ebuilds
authors should make sure to always depends, in case of touching
cronbase directories, on the cronbase package, to ensure that it's
installed prior to installing them." In other words, it is conceivable
that this could be considered a documentation problem, if the final
decision is that each ebuild author needs to be responsible for
letting the "correct" entity determine the appropriate permissions.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJYjRbyAAoJEHb/MwWLVhi2E34P+waV8WI6umzx8yqTW76C32ti
332tDNFVAtD2w1gsdwJeFhO6LiQ9tF71FplmF9OEhGyIcg5o0AGh+EdvL+dYDP6i
gX4d5p6XFIHtWe4WfIa5DJXtT0lB8pI2PRy9lXsVK9C8asOueBkNLnHy2zB/+dXL
VCX1z1wzpcDysIUivlnI4spwWxbS65Zm2DHpUxhs7vCz9nAFSPstu/FnKWLKFe1d
fhNayuRvb0f3zUAaJwDzDJ2yoIui550eiJ+6TmUlhY8jCkOuxNGdD7hwpURG/1Wi
TvrCzH1YYJgHnCz8QT6WB5SrbQfYsZmLnB+SbQwbJNDKbL8+kaHbwl/lRY8hphsC
PW+oP8QBOh902JtREOqMBtSlReozvJEGC0yNtS6V9Dysu5vmn5nK+YkW4KHbAHCv
6ZSRDBZKr53UKBoaOqEoKxoDNgMGpYB4l2p6Cjp9a3eEXVR7Py4u/A1flVVD/pAi
SXFhSi0IKAuk1BqFf6g1KlbVpXaec7cPRrnGOToXpYcGKw1A9H1sNmnxVDYhXRqH
zW1V9hhTxhn+7zTuGhRtd0AfCYKsmBWOppGvyhDyo2HW3Fepp9UzTS5EqcqjYwf2
+45CObb2v77ZTsNDRi8YWZ79ABa3DnvYWSRJR9kB/kxTDBX2WaaamrEVH6omr/uJ
ZW3voevSL9UA648rf/OQ
=mgyN
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.gentoo.org_7b6615e5_20250126_051813.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 396153
persistent administrative override of file and directory permissions (like dpkg-statoverride)
Last modified: 2024-04-22 16:15:35 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=396153&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=396153&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 396153**](show_bug.cgi?id=396153)
- persistent administrative override of file and directory permissions (like dpkg-statoverride)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
persistent administrative override of file and directory permissions (like dp...

| | [Status](page.cgi?id=fields.html#bug_status): | CONFIRMED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Hosted Projects | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Hosted Projects "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | PMS/EAPI ([show other bugs](buglist.cgi?component=PMS%2FEAPI&product=Gentoo%20Hosted%20Projects&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Package Manager Specification | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://www.debian.org/doc/debian-poli...](http://www.debian.org/doc/debian-policy/ch-files.html#s10.9.1) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | Duplicates (2): | [141619](show_bug.cgi?id=141619 "RESOLVED DUPLICATE - [PATCH] portage keeps directory permissions but updates file permissions on merge") [151778](show_bug.cgi?id=151778 "RESOLVED DUPLICATE - [PATCH] More advanced suidctl Portage feature")  ([view as bug list](buglist.cgi?bug_id=141619,151778)) | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [193766](show_bug.cgi?id=193766 "IN_PROGRESS - [TRACKER] sys-apps/portage file metadata handling for install and uninstall / merge and unmerge") | |  | Show dependency [tree](showdependencytree.cgi?id=396153&hide_resolved=1) | |  | | Reported: | 2011-12-27 01:23 UTC by Zac Medico | | --- | --- | | Modified: | 2024-04-22 16:15 UTC ([History](show_activity.cgi?id=396153)) | | CC List: | 4 users (show)  blueness gabifalk mk mrueg | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * [607430](show_bug.cgi?id=607430 "RESOLVED DUPLICATE - Gentoo: order of installed packages may result in vary directories permissions, leading to crontab not requiring cron group membership as example.") * [654138](show_bug.cgi?id=654138 "CONFIRMED - sys-apps/portage: add FEATURES=overwrite-dir-perms option to make fperms calls overwrite existing directory permissions for purposes of automation") | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=396153&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=396153&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Zac Medico   gentoo-dev  2011-12-27 01:23:20 UTC  ``` Package managers should allow administrators to override permissions of files in a way that persists through upgrades. For example, this can be accomplished using an approach similar to Debian's dpkg-statoverride tool. ```  [Comment 1](#c1)  Zac Medico   gentoo-dev  2011-12-27 01:24:45 UTC  ``` *** [Bug 141619](show_bug.cgi?id=141619 "RESOLVED DUPLICATE - [PATCH] portage keeps directory permissions but updates file permissions on merge") has been marked as a duplicate of this bug. *** ```  [Comment 2](#c2)  Zac Medico   gentoo-dev  2011-12-27 01:30:02 UTC  ``` *** [Bug 151778](show_bug.cgi?id=151778 "RESOLVED DUPLICATE - [PATCH] More advanced suidctl Portage feature") has been marked as a duplicate of this bug. *** ```  [Comment 3](#c3)  Maxim Kammerer    2012-07-08 21:21:21 UTC  ``` I think that this bug's importance should be raised. Consider, for instance, net-misc/tor:      pkg_setup() {         enewgroup tor         enewuser tor -1 -1 /var/lib/tor tor     }      src_install() {         ...         fperms 750 /var/lib/tor         fowners tor:tor /var/lib/tor         ...     }  The intent is clearly that /var/lib/tor is only readable by user "tor". However:      drwxr-xr-x 2 tor root 88 Jun 16 01:07 /var/lib/tor  Specifically for net-misc/tor, this is not a serious issue (Tor daemon apparently sets umask to 077 for new files and directories), but it might be for other packages. I had to resolve to, e.g.:      pkg_setup() {         enewgroup i2p         enewuser  i2p -1 -1 /var/lib/i2p i2p         rmdir /var/lib/i2p 2>/dev/null || :     }  in order to enforce directory permissions for a similar package. ```  [Comment 4](#c4)  SpanKY   gentoo-dev  2012-07-21 17:26:36 UTC  ``` (In reply to [comment #3](show_bug.cgi?id=396153#c3))  i don't really understand your example.  if /var/lib/tor doesn't exist, then when the dir gets merged, it'll start with 750 perms.  how did it get 755 ?  also, be aware that you cannot rely on the tree state that an ebuild sets up in /var/{lib,cache,run} since that might get removed manually by an admin.  so init.d scripts have to use `checkpath` to make sure they're available. ```  [Comment 5](#c5)  Maxim Kammerer    2012-07-21 18:20:20 UTC  ``` (In reply to [comment #4](show_bug.cgi?id=396153#c4)) > i don't really understand your example.  if /var/lib/tor doesn't exist, then > when the dir gets merged, it'll start with 750 perms.  how did it get 755 ?  But /var/lib/tor already exists before src_install() -- it is created by enewuser in pkg_setup().  > also, be aware that you cannot rely on the tree state that an ebuild sets up > in /var/{lib,cache,run} since that might get removed manually by an admin.  > so init.d scripts have to use `checkpath` to make sure they're available.  I am aware of /var/run (filed a few bugs for [bug #332633](show_bug.cgi?id=332633 "CONFIRMED - [tracker] packages that keepdir /var/{run,lock}") myself), and /var/cache case is kind of obvious, but /var/lib? It seems to me that if one starts arbitrary removing stuff in /var/lib in Gentoo, the system will break... ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=396153)
* - [XML](show_bug.cgi?ctype=xml&id=396153)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=396153)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=396153&product=Gentoo%20Hosted%20Projects)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=396153&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=396153&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.gentoo.org_cef627bc_20250125_021725.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 607430
Gentoo: order of installed packages may result in vary directories permissions, leading to crontab not requiring cron group membership as example.
Last modified: 2018-04-26 17:07:49 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=607430&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=607430&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 607430**](show_bug.cgi?id=607430)
- Gentoo: order of installed packages may result in vary directories permissions, leading to crontab not requiring cron group membership as example.

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Gentoo: order of installed packages may result in vary directories permission...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED DUPLICATE of [bug 607426](show_bug.cgi?id=607426 "CONFIRMED - sys-process/cronbase: wrong permissions on dirs lets any user to use cron.") | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Auditing ([show other bugs](buglist.cgi?component=Auditing&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security Audit Team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://www.openwall.com/lists/oss-sec...](http://www.openwall.com/lists/oss-security/2017/01/28/3) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-01-27 22:15 UTC by Kristian Fiskerstrand (RETIRED) | | --- | --- | | Modified: | 2018-04-26 17:07 UTC ([History](show_activity.cgi?id=607430)) | | CC List: | 3 users (show)  dev-portage nobrowser slashbeast | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * [396153](show_bug.cgi?id=396153 "CONFIRMED - persistent administrative override of file and directory permissions (like dpkg-statoverride)") * [141619](show_bug.cgi?id=141619 "RESOLVED DUPLICATE - [PATCH] portage keeps directory permissions but updates file permissions on merge") * [58611](show_bug.cgi?id=58611 "RESOLVED WONTFIX - portage.py(mergeme) failes to change permission/ownership of a directory ${ROOT}/dir if ${IMAGE}/dir has different ownership/permissions.") * [654138](show_bug.cgi?id=654138 "CONFIRMED - sys-apps/portage: add FEATURES=overwrite-dir-perms option to make fperms calls overwrite existing directory permissions for purposes of automation") | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=607430&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=607430&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Kristian Fiskerstrand (RETIRED)   gentoo-dev  2017-01-27 22:15:07 UTC  ``` The following message was posted on oss-sec ML:""" Hi,  The packages in Gentoo often utilizes Portage's functions like keepdir to create a directories, with specified permissions. One of the examples is 'cronbase', which the only purpose is to setup /etc/cron.{hourly,daily,weekly,monthly} and /var/spool/cron.  The /var/spool/cron is meant to have root:cron 750, which makes the crontab usable only for the users that are members of cron group.  As for the /etc/cron.{hourly,daily,weekly,monthly} they're meant to be root:root 750.  If, for instance, a mlocate package will be installed before cronbase, due to installing /etc/cron.daily/mlocate, the /etc/cron.daily will end up with 755 permissions. After than when crontab package is installed, due to usage of portage's keepdir function, the directory in temporary directory will be installed as root:cron 750, but during the merge process to rootfs no directory permissions will be merged, leaving the /etc/cron.daily as 755.  On one system after installing set of packages, the /var/spool/cron ended up being cron:root 755, which results in possibility for any local user to actually create the crontabs (including system users like nginx, mysql, and so on).  The way a (directory) ownership and permissions are handled in Gentoo seems to be flawed, it's not clear to me whatever Portage should provided a soluton to that, or the ebuilds authors should make sure to always depends, in case of touching cronbase directories, on the cronbase package, to ensure that it's installed prior to installing them. Nonetheless I do believe this issue is worth CVE.  -- Piotr.  """  Is there any comment from the portage team on this? ```  [Comment 1](#c1)  Zac Medico   gentoo-dev  2017-01-27 22:32:11 UTC  ``` (In reply to Kristian Fiskerstrand from [comment #0](show_bug.cgi?id=607430#c0)) > The way a (directory) ownership and permissions are handled in Gentoo seems > to be flawed,  Yeah it's [bug 141619](show_bug.cgi?id=141619 "RESOLVED DUPLICATE - [PATCH] portage keeps directory permissions but updates file permissions on merge"), and there's a proposal for resolving conflicts in [bug 396153](show_bug.cgi?id=396153 "CONFIRMED - persistent administrative override of file and directory permissions (like dpkg-statoverride)").  > it's not clear to me whatever Portage should provided a > soluton to that, or the ebuilds authors should make sure to always depends, > in case of touching cronbase directories, on the cronbase package, to ensure > that it's installed prior to installing them. Nonetheless I do believe this > issue is worth CVE. >  > -- Piotr.  > """ >  > Is there any comment from the portage team on this?  An alternative to the dependency-based approach would be for cronbase to force the permissions in pkg_postinst. ```  [Comment 2](#c2)  Piotr Karbowski (RETIRED)   gentoo-dev  2017-01-27 23:08:17 UTC  ``` In regard to cron directories, yes. But I suspect they may be some other packages out there that suffer from the same thing.  Did you ever considered a mechanism, similar to the dpkg-statoverrride, that would allow packages to register particular permissions for files/directories to enforce permissions, so even if a package merges with, for example, 755, portage would force it to 750?  I think this is something that could be done even on bashrc level with post_pkg_postinst hook to adjust the on-rootfs permissions as well as do the same on pre_pkg_merge to adjust them in $D, so in case that they don't exist on rootfs, they would be merged with the globally enforced permissions. ```  [Comment 3](#c3)  Mike Gilbert   gentoo-dev  2017-01-28 05:14:38 UTC  ``` This is a duplicate of [bug 607426](show_bug.cgi?id=607426 "CONFIRMED - sys-process/cronbase: wrong permissions on dirs lets any user to use cron."). ```  [Comment 4](#c4)  Kristian Fiskerstrand (RETIRED)   gentoo-dev  2017-01-28 12:25:48 UTC  ```   *** This bug has been marked as a duplicate of [bug 607426](show_bug.cgi?id=607426 "CONFIRMED - sys-process/cronbase: wrong permissions on dirs lets any user to use cron.") *** ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=607430)
* - [XML](show_bug.cgi?ctype=xml&id=607430)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=607430)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=607430&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=607430&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=607430&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.gentoo.org_e1332325_20250126_051811.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 141619
[PATCH] portage keeps directory permissions but updates file permissions on merge
Last modified: 2024-04-18 17:50:30 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=141619&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=141619&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 141619**](show_bug.cgi?id=141619)
- [PATCH] portage keeps directory permissions but updates file permissions on merge

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
[PATCH] portage keeps directory permissions but updates file permissions on m...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED DUPLICATE of [bug 396153](show_bug.cgi?id=396153 "CONFIRMED - persistent administrative override of file and directory permissions (like dpkg-statoverride)") | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Linux | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Linux "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Eclasses ([show other bugs](buglist.cgi?component=Eclasses&product=Gentoo%20Linux&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Portage team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | Duplicates (9): | [140250](show_bug.cgi?id=140250 "RESOLVED DUPLICATE - dev-util/subversion-1.3.1: doc directories not readable") [172576](show_bug.cgi?id=172576 "RESOLVED DUPLICATE - net-mail/dovecot should preserve permissions of deliver") [174916](show_bug.cgi?id=174916 "RESOLVED DUPLICATE - portage-merge: apply permission changes to directories") [182983](show_bug.cgi?id=182983 "RESOLVED DUPLICATE - vixie-cron gives permission denied for regular users") [193728](show_bug.cgi?id=193728 "RESOLVED DUPLICATE - sys-process/cronbase appears to create directory with wrong owner and permissions") [199197](show_bug.cgi?id=199197 "RESOLVED DUPLICATE - kbluetooth or k3b installs files in /usr/share/mimelnk, but makes /usr/share/mimelnk readable only to root") [395961](show_bug.cgi?id=395961 "RESOLVED DUPLICATE - sys-apps/portage: specifying home directory ownership/permissions for system accounts is useless") [421533](show_bug.cgi?id=421533 "RESOLVED DUPLICATE - =sys-apps/portage-2.2.0_alpha110: fowners doesn't work from src_install() for existing directories") [601508](show_bug.cgi?id=601508 "RESOLVED DUPLICATE - portage do not update directory mode when merging")  ([view as bug list](buglist.cgi?bug_id=140250,172576,174916,182983,193728,199197,395961,421533,601508)) | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [193766](show_bug.cgi?id=193766 "IN_PROGRESS - [TRACKER] sys-apps/portage file metadata handling for install and uninstall / merge and unmerge") [238335](show_bug.cgi?id=238335 "RESOLVED FIXED - sys-process/at-3.1.10.2 permissions problems") [929017](show_bug.cgi?id=929017 "RESOLVED FIXED - net-wireless/bluez: Ebuild creates /etc/bluetooth with 0755, but bluetooth.service wants 0555.") | |  | Show dependency [tree](showdependencytree.cgi?id=141619&hide_resolved=1) | |  | | Reported: | 2006-07-24 12:50 UTC by Jakub Moc (RETIRED) | | --- | --- | | Modified: | 2024-04-18 17:50 UTC ([History](show_activity.cgi?id=141619)) | | CC List: | 13 users (show)  clabbe.montjoie csbugreg ftobin leho marduk Martin.vGagern mk pva ssuominen throw\_away\_2002 toralf whissi wschlich | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * [607430](show_bug.cgi?id=607430 "RESOLVED DUPLICATE - Gentoo: order of installed packages may result in vary directories permissions, leading to crontab not requiring cron group membership as example.") * [654138](show_bug.cgi?id=654138 "CONFIRMED - sys-apps/portage: add FEATURES=overwrite-dir-perms option to make fperms calls overwrite existing directory permissions for purposes of automation") | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**implement FEATURES=merge-dir-perms and enable in make.globals**](attachment.cgi?id=140656 "View the content of the attachment") (merge\_dir\_perms.patch,2.17 KB, patch)  [2008-01-11 02:38 UTC](#attach_140656 "Go to the comment associated with the attachment"), Zac Medico | [Details](attachment.cgi?id=140656&action=edit) | [Diff](attachment.cgi?id=140656&action=diff) | | [View All](attachment.cgi?bugid=141619&action=viewall)  [Add an attachment](attachment.cgi?bugid=141619&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=141619&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Jakub Moc (RETIRED)   gentoo-dev  2006-07-24 12:50:07 UTC  ``` A sample ebuild stub to reproduce:  <snip> # Copyright 1999-2006 Gentoo Foundation # Distributed under the terms of the GNU General Public License v2 # $Header: $   inherit eutils   DESCRIPTION="MIMEDefang is a mail filtering framework for sendmail" HOMEPAGE="<http://www.mimedefang.org/>" SRC_URI="" LICENSE="GPL-2" SLOT="0" KEYWORDS="~x86" DEPEND="" RDEPEND="${DEPEND}"   pkg_setup() {         enewgroup defang         enewuser defang -1 -1 /var/spool/MIMEDefang defang }   src_install() {         keepdir /var/spool/{MIMEDefang,MD-Quarantine}         chmod 0775 ${D}/var/spool/MIMEDefang         chmod 0755 ${D}/var/spool/MD-Quarantine         chown defang:defang ${D}/var/spool/{MIMEDefang,MD-Quarantine} } </snip>  1/ User doesn't exist + first emerge  # ls -ld /var/spool/{MIMEDefang,MD-Quarantine} drwxr-xr-x 2 defang defang 96 2006-07-24 21:32 /var/spool/MD-Quarantine drwxr-xr-x 2 defang root   96 2006-07-24 21:32 /var/spool/MIMEDefang  2/ User does exist + re-emerge  # ls -ld /var/spool/{MIMEDefang,MD-Quarantine} drwxr-xr-x 2 defang defang 96 2006-07-24 21:33 /var/spool/MD-Quarantine drwxr-xr-x 2 defang root   96 2006-07-24 21:33 /var/spool/MIMEDefang  Still broken.  3/ User does exist + unmerge and emerge  # ls -ld /var/spool/{MIMEDefang,MD-Quarantine} drwxr-xr-x 2 defang defang 96 2006-07-24 21:34 /var/spool/MD-Quarantine drwxrwxr-x 2 defang defang 96 2006-07-24 21:34 /var/spool/MIMEDefang  That's what it should be like for the first time!  4/ unmerge + userdel -f defang + emerge   # ls -ld /var/spool/{MIMEDefang,MD-Quarantine} drwxr-xr-x 2 defang defang 96 2006-07-24 21:33 /var/spool/MD-Quarantine drwxr-xr-x 2 defang root   96 2006-07-24 21:33 /var/spool/MIMEDefang  Busted again. ```  [Comment 1](#c1)  Jakub Moc (RETIRED)   gentoo-dev  2006-07-24 12:50:52 UTC  ``` Portage 2.1.1_pre3-r4 (default-linux/x86/2006.0, gcc-4.1.1, glibc-2.4-r3, 2.6.17-gentoo-r3 i686) ================================================================= System uname: 2.6.17-gentoo-r3 i686 AMD Athlon(tm) XP 1600+ Gentoo Base System version 1.12.1 ccache version 2.4 [enabled] app-admin/eselect-compiler: [Not Present] dev-lang/python:     2.4.3-r1 dev-python/pycrypto: 2.0.1-r5 dev-util/ccache:     2.4-r2 dev-util/confcache:  0.4.2-r1 sys-apps/sandbox:    1.2.18.1 sys-devel/autoconf:  2.13, 2.60 sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2 sys-devel/binutils:  2.16.1-r2, 2.16.93, 2.17, 2.17.50.0.2, 2.17.50.0.3 sys-devel/gcc-config: 1.3.13-r3 sys-devel/libtool:   1.5.22 virtual/os-headers:  2.6.11-r5 ACCEPT_KEYWORDS="x86 ~x86" AUTOCLEAN="yes" CBUILD="i686-pc-linux-gnu" CFLAGS="-march=athlon-xp -O2 -pipe -fomit-frame-pointer -fforce-addr -ftree-vectorize" CHOST="i686-pc-linux-gnu" CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config" CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/splash /etc/terminfo" CXXFLAGS="-march=athlon-xp -O2 -pipe -fomit-frame-pointer -fforce-addr -ftree-vectorize" DISTDIR="/usr/portage/distfiles" EMERGE_DEFAULT_OPTS="--alphabetical" FEATURES="autoconfig ccache collision-protect confcache distlocks metadata-transfer parallel-fetch sandbox sfperms splitdebug strict userfetch userpriv usersandbox" GENTOO_MIRRORS="ftp://ftp.sh.cvut.cz/MIRRORS/gentoo/gentoo ftp://ftp.fi.muni.cz/pub/linux/gentoo/" LANG="en_US.UTF-8" LDFLAGS="-Wl,-O1 -Wl,--sort-common" LINGUAS="cs en" MAKEOPTS="-j2" PKGDIR="/usr/portage/packages" PORTAGE_RSYNC_EXTRA_OPTS="--progress" PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'" PORTAGE_TMPDIR="/var/tmp" PORTDIR="/usr/portage" PORTDIR_OVERLAY="/usr/local/portage /mnt/nfs/overlays/vmware" SYNC="rsync://rsync.gentoo.org/gentoo-portage" USE="x86 3dnow 3dnowext 7zip X X509 a52 aac acl acpi alsa apm asf audiofile bash-completion berkdb bluetooth bzip2 caps cddb cdparanoia cdr chroot cli crypt cscope css cups curl curlwrappers dbx dga dlloader dri dts dv dvd dvdr dvdread encode ethereal exif expat fam fbcon ffmpeg fftw firefox flac flash flatfile foomaticdb gdbm gif glibc-omitfp glut gmp gpm gstreamer iconv icq idn imagemagick imap imlib inifile ipv6 irda jack javascript jbig joystick jpeg jpeg2k kdeenablefinal kdehiddenvisibility lcms libcaca libg++ libsamplerate libwww lirc lm_sensors logrotate mad maildir matroska mikmod mime mmap mmx mng mp3 mpeg musepack musicbrainz ncurses nls nodrm nptl nptlonly nsplugin nvidia offensive ogg openal opengl pam pcre pdf perl png ppds python qt3 quicktime readline real reflection samba sdl session sftplogging skey sndfile speex spell spl sse ssl svg symlink tcpd theora threads tiff truetype udev unicode urandom usb v4l v4l2 vcd vorbis win32codecs wmf x264 xine xinerama xinetd xml xml2 xmlrpc xorg xosd xpm xv xvid xvmc zlib elibc_glibc input_devices_joystick input_devices_keyboard input_devices_mouse input_devices_evdev kernel_linux linguas_cs linguas_en lirc_devices_cph06x userland_GNU video_cards_fbdev video_cards_nv video_cards_nvidia video_cards_v4l video_cards_vesa video_cards_vmware" Unset:  CTARGET, INSTALL_MASK, LC_ALL  ```  [Comment 2](#c2)  Marius Mauch (RETIRED)   gentoo-dev  2006-07-24 13:51:38 UTC  ``` <genone> jakub: what are the perms in ${D}? <genone> jakub: also when you say "first emerge", are you _sure_ the dirs didn't exist previously? <jakub> genone: it does... enewuser creates it <genone> ignore enewuser <jakub> well then yeah, I'm pretty damn sure it doesn't, I've re-checked about 10 times while pulling my hair here <genone> "it" == ? <jakub> well, the dir that should be 775 user:group and is 755 user:root instead <jakub> no way to do that unless the user and group already exist <jakub> ie., exist _before_ emerge <jakub> genone: in ${D} it's correct, but doesn't get merged w/ those perms <genone> ok, so if I'm understanding this right useradd (called by enewuser) creates the dir in ${ROOT} with wrong perms/ownership <jakub> genone: there's no way to specify such thing in enewuser <genone> and portage doesn't change ownership/perms of existing files in ${ROOT] at merge time <jakub> yup <genone> the second is by design <jakub> genone: uhm? <genone> uhm what? <jakub> also, s/files/dirs/ - there are no files involved here <genone> dirs are files <jakub> well, by design doesn't seem to be very good here, because you get broken ebuild * genone is too lazy to type {dirs,files,fifos,devs,...} <genone> jakub: you'd rather break peoples systems? <jakub> shrug, broken how exactly? it permissions set in ebuild break the system, they are not probably sane... <jakub> whatever, any solution here? <genone> postinst <genone> or get spanky to fix enewuser to not create the dir in ${ROOT} <jakub> chown it in postinst? <jakub> well, then I don't exactly see the difference from changing the design, can break the system equally <genone> well, take it up on -dev if you want that to get changed <jakub> heh, not sure if that's the best place :=) usually doesn't get very productive <jakub> so, how viable is to change the eclass? <genone> ask Spanky ```  [Comment 3](#c3)  Jakub Moc (RETIRED)   gentoo-dev  2006-07-24 14:06:37 UTC  ``` Uhm, reopening this and sending vapier's way... Two solutions I see here:  - let people specify the owner and permissions for homedir in enewuser call - create the homedir in ${D} instead of ${ROOT}  (Or, obviously let portage change the perms on merge but that's not exactly what portage folks like...) ```  [Comment 4](#c4)  Marius Mauch (RETIRED)   gentoo-dev  2006-07-24 14:22:23 UTC  ``` (In reply to [comment #3](show_bug.cgi?id=141619#c3)) > (Or, obviously let portage change the perms on merge but that's not exactly > what portage folks like...)  Ehm, I'm not attached to the behavior in one way or the other, but if this should get changed it needs the support from the community, not just yours.  ```  [Comment 5](#c5)  SpanKY   gentoo-dev  2006-07-30 21:27:14 UTC  ``` i see this as being a dupe of this thread: <http://article.gmane.org/gmane.linux.gentoo.portage.devel/2182> ```  [Comment 6](#c6)  Vlastimil Babka (Caster) (RETIRED)   gentoo-dev  2006-10-16 01:53:31 UTC  ``` (In reply to [comment #5](show_bug.cgi?id=141619#c5)) > i see this as being a dupe of this thread: > <http://article.gmane.org/gmane.linux.gentoo.portage.devel/2182>  Or [bug 58611](show_bug.cgi?id=58611 "RESOLVED WONTFIX - portage.py(mergeme) failes to change permission/ownership of a directory ${ROOT}/dir if ${IMAGE}/dir has different ownership/permissions.").  ```  [Comment 7](#c7)  Marius Mauch (RETIRED)   gentoo-dev  2007-01-11 10:15:48 UTC  ``` Did we ever get to a conclusion here? ```  [Comment 8](#c8)  Jakub Moc (RETIRED)   gentoo-dev  2007-02-11 23:04:51 UTC  ``` (In reply to [comment #7](show_bug.cgi?id=141619#c7)) > Did we ever get to a conclusion here?  No. :( The worst thing is the inconsistent behaviour, it's confusing and produces pretty inexplicable bugs.   ```  [Comment 9](#c9)  Marius Mauch (RETIRED)   gentoo-dev  2007-04-03 21:32:31 UTC  ``` *** [Bug 172576](show_bug.cgi?id=172576 "RESOLVED DUPLICATE - net-mail/dovecot should preserve permissions of deliver") has been marked as a duplicate of this bug. *** ```  [Comment 10](#c10)  Marius Mauch (RETIRED)   gentoo-dev  2007-04-17 17:37:17 UTC  ``` *** [Bug 174916](show_bug.cgi?id=174916 "RESOLVED DUPLICATE - portage-merge: apply permission changes to directories") has been marked as a duplicate of this bug. *** ```  [Comment 11](#c11)  Martin von Gagern    2007-04-17 19:39:35 UTC  ``` (In reply to [comment #10](show_bug.cgi?id=141619#c10)) > *** [Bug 174916](show_bug.cgi?id=174916 "RESOLVED DUPLICATE - portage-merge: apply permission changes to directories") has been marked as a duplicate of this bug. ***  OK, the above mentioned bug was in the first place about a specific ebuild, openmotif, and its possible need to fix the mistakes of a previous revision. I guess this might already be fixed by postinst, without breaking much.  As this thing was duped here, I'll give you my thoughts on the general issue. From the admin perspective I'd like to differentiate between directories owned exclusively by some package, and directories created in image to represent shared structures. So if foo-0.ebuild decides to make directory /var/lib/foo group writable, there might be a good reason for this, while doing the same for /var/lib is probably a bad idea.  I would not want permissions for existing directories merged unconditionally, because it could overwrite modifications the admin made on purpose. However, if an ebuild chooses to change some permissions from the way they were before, there should be a way to do so. Something like this: src_postinst {   echmod 755 775 /var/lib/foo } to say that permissions on /var/lib/foo should be changed to 775 if they had been 755 (the old default) before. This is still not perfect, because when the admin chooses to revert these changes, his modifications get overwritten the next time this package is upgraded. But to solve that issue, we would need some information about the version the ebuild currently being emerged is going to replace. Say "change mode if upgrading from Version <1.0" or something similar.  It might also be nice to carry some mode information from the install phase into the merge or postinst phase. Then the install phase could say "let the newly installed versions of /var/lib/foo [recursively] override those already there", and there would be no need to specify the modes in the ebuild itself. I guess this could best be solved by some postinst script that is part of the package, created during install by some eclass function, will be merged with the rest, then run automatically, and deleted afterwards.  I have no idea how all this might cooperate with portage, and if this would work equally well for ownership. On the other hand, I would think this a feasible approach for files as well, not only dirs. Maybe there should be some FEATURE or other tool for ebuild writers that complains if a file in image does not agree with wat is currently installed, so that forgotten changes will be noticed. ```  [Comment 12](#c12)  Martin von Gagern    2007-06-05 14:23:41 UTC  ``` Found two new instances today: /usr/include/gnome-xml from dev-libs/libxml and /usr/include/lqt from media-libs/libquicktime had no execute bit set. Deleting dirs and remerging ebuilds solved the issue. Don't know where this came from.  Could we ewarn about differences between present permissions and the permissions from the ebuild? That would be one step towards solving the problem, and should be better than what's there right now. ```  [Comment 13](#c13)  Jakub Moc (RETIRED)   gentoo-dev  2007-06-15 09:43:51 UTC  ``` *** [Bug 140250](show_bug.cgi?id=140250 "RESOLVED DUPLICATE - dev-util/subversion-1.3.1: doc directories not readable") has been marked as a duplicate of this bug. *** ```  [Comment 14](#c14)  Jakub Moc (RETIRED)   gentoo-dev  2007-06-23 17:00:42 UTC  ``` *** [Bug 182983](show_bug.cgi?id=182983 "RESOLVED DUPLICATE - vixie-cron gives permission denied for regular users") has been marked as a duplicate of this bug. *** ```  [Comment 15](#c15)  Jakub Moc (RETIRED)   gentoo-dev  2007-09-25 10:34:45 UTC  ``` *** [Bug 193728](show_bug.cgi?id=193728 "RESOLVED DUPLICATE - sys-process/cronbase appears to create directory with wrong owner and permissions") has been marked as a duplicate of this bug. *** ```  [Comment 16](#c16)  Jakub Moc (RETIRED)   gentoo-dev  2007-12-05 11:00:56 UTC  ``` *** [Bug 199197](show_bug.cgi?id=199197 "RESOLVED DUPLICATE - kbluetooth or k3b installs files in /usr/share/mimelnk, but makes /usr/share/mimelnk readable only to root") has been marked as a duplicate of this bug. *** ```  [Comment 17](#c17)  Jakub Moc (RETIRED)   gentoo-dev  2008-01-03 22:38:55 UTC  ``` (In reply to [comment #11](show_bug.cgi?id=141619#c11)) > I would not want permissions for existing directories merged unconditionally, > because it could overwrite modifications the admin made on purpose.  You already get these overwritten w/ tons of ebuilds b/c people keep working around this portage bug via doing chmod/chown in unsandboxed phases. We really should move somewhere with this as this feature serves no real purpose but adding hacks to ebuilds.  ```  [Comment 18](#c18)  Marius Mauch (RETIRED)   gentoo-dev  2008-01-11 01:33:50 UTC  ``` I think the real solution here would be to store the permissions/ownership in the installed package database and only preserve them if modified after installation to satisfy both use cases. But I'd rather want to include that in a general vdb redesign rather than adding yet another file (as extending CONTENTS isn't an option) ```  [Comment 19](#c19)  Zac Medico   gentoo-dev  2008-01-11 02:38:05 UTC  ``` Created [attachment 140656](attachment.cgi?id=140656 "implement FEATURES=merge-dir-perms and enable in make.globals") [[details](attachment.cgi?id=140656&action=edit "implement FEATURES=merge-dir-perms and enable in make.globals"), [diff](attachment.cgi?id=140656&action=diff "implement FEATURES=merge-dir-perms and enable in make.globals")] implement FEATURES=merge-dir-perms and enable in make.globals  With this patch, the average user who doesn't want to control directory permissions themselves will have permissions merged from ${D}. Users who want to manage directory permissions themselves can add FEATURES="-merge-dir-perms" to /etc/make.conf. ```  [Comment 20](#c20)  Marius Mauch (RETIRED)   gentoo-dev  2008-01-11 03:22:12 UTC  ``` I strongly dislike that hack, as it doesn't really help anyone, devs still have to work around the issue in postinst for older versions and users without that setting, and it really shouldn't be a optional thing anyway (and do I have to repeat that I don't want to bloat FEATURES with cornercase stuff?) ```  [Comment 21](#c21)  Zac Medico   gentoo-dev  2008-01-11 03:37:35 UTC  ``` (In reply to [comment #18](show_bug.cgi?id=141619#c18)) > I think the real solution here would be to store the permissions/ownership in > the installed package database and only preserve them if modified after > installation to satisfy both use cases.  What about multiple packages that install the same directory with different permissions? Whose permissions win? ```  [Comment 22](#c22)  Marius Mauch (RETIRED)   gentoo-dev  2008-01-11 04:01:37 UTC  ``` The vdb redesign would likely contain a central database about file objects, so the last one would win. But that shouldn't happen, as two packages trying to install the same dir with conflicting permissions would be detected with a central db. ```  [Comment 23](#c23)  Peter Volkov (RETIRED)   gentoo-dev  2008-01-11 10:17:48 UTC  ``` (In reply to [comment #21](show_bug.cgi?id=141619#c21)) > What about multiple packages that install the same directory with different > permissions? Whose permissions win?  This is ordinary collision and should be reported and fixed by maintainers of said packages.  From the user point of view I think portage should keep permissions developer assigned (actually overrided default permissions), and there is no need to completely disable permission control mechanism (like -merge-dir-perms do). But user should have some way to override permissions. I do not know what is the best way to go but at least two possible solutions exist:  1. Either some user defined permission db (may be file with "file perm" entries and recursion mark for directories) 2. Or add portage FEATURE which keeps modified by user permissions and show a warning that permissions were changed.  Variant 2. may be does not work right now as we have many packages which set permissions in pkg_postinst and will warn even if user want such different permissions. And yes central db simplify things and is necessary in any case.  ```  [Comment 24](#c24)  Marius Mauch (RETIRED)   gentoo-dev  2008-01-12 03:43:00 UTC  ``` (In reply to [comment #23](show_bug.cgi?id=141619#c23)) > (In reply to [comment #21](show_bug.cgi?id=141619#c21)) > > What about multiple packages that install the same directory with different > > permissions? Whose permissions win? >  > This is ordinary collision and should be reported and fixed by maintainers of > said packages.  Well, multiple packages installing the same dir isn't a collision, only the different permissions would be and that's something we can't really detect atm without reference data.  > From the user point of view I think portage should keep permissions developer > assigned (actually overrided default permissions), and there is no need to > completely disable permission control mechanism (like -merge-dir-perms do). > But user should have some way to override permissions. I do not know what is > the best way to go but at least two possible solutions exist: >  > 1. Either some user defined permission db (may be file with "file perm" > entries and recursion mark for directories) > 2. Or add portage FEATURE which keeps modified by user permissions and show a > warning that permissions were changed. >  > Variant 2. may be does not work right now as we have many packages which set > permissions in pkg_postinst and will warn even if user want such different > permissions. And yes central db simplify things and is necessary in any case.  As said, IMO the best way is to track which permissions were set when a directory was merged, and on upgrades only preserve the current permissions if they differ from the saved state (keeping track of permissions has other benefits as well). On top of that a config file to specify wanted permissions could also be implemented, but I don't think that's really needed if we respect manual modifications to ownership/permissions. ```  [Comment 25](#c25)  Zac Medico   gentoo-dev  2011-03-11 00:53:40 UTC  ``` (In reply to [comment #24](show_bug.cgi?id=141619#c24)) > On top of that a config file to specify wanted permissions > could also be implemented, but I don't think that's really needed if we respect > manual modifications to ownership/permissions.  To use Debian as an example, they have a dpkg-statoverride command that's used to configure (or query) these kinds of permission overrides. ```  [Comment 26](#c26)  Zac Medico   gentoo-dev  2011-12-26 22:51:58 UTC  ``` *** [Bug 395961](show_bug.cgi?id=395961 "RESOLVED DUPLICATE - sys-apps/portage: specifying home directory ownership/permissions for system accounts is useless") has been marked as a duplicate of this bug. *** ```  [Comment 27](#c27)  Zac Medico   gentoo-dev  2011-12-27 01:24:45 UTC  ```   *** This bug has been marked as a duplicate of [bug 396153](show_bug.cgi?id=396153 "CONFIRMED - persistent administrative override of file and directory permissions (like dpkg-statoverride)") *** ```  [Comment 28](#c28)  Zac Medico   gentoo-dev  2012-06-17 15:26:46 UTC  ``` *** [Bug 421533](show_bug.cgi?id=421533 "RESOLVED DUPLICATE - =sys-apps/portage-2.2.0_alpha110: fowners doesn't work from src_install() for existing directories") has been marked as a duplicate of this bug. *** ```  [Comment 29](#c29)  Zac Medico   gentoo-dev  2016-12-03 20:31:03 UTC  ``` *** [Bug 601508](show_bug.cgi?id=601508 "RESOLVED DUPLICATE - portage do not update directory mode when merging") has been marked as a duplicate of this bug. *** ```  [Comment 30](#c30)  Zac Medico   gentoo-dev  2018-10-09 17:01:50 UTC  ``` [Bug 396153](show_bug.cgi?id=396153 "CONFIRMED - persistent administrative override of file and directory permissions (like dpkg-statoverride)") proposes a PMS extension that will allow users to persistently override directory permissions when necessary.  Also, I'm planning a FEATURES=overwrite-dir-perms setting, see [bug 654138](show_bug.cgi?id=654138 "CONFIRMED - sys-apps/portage: add FEATURES=overwrite-dir-perms option to make fperms calls overwrite existing directory permissions for purposes of automation"). ```  [Comment 31](#c31)  Zac Medico   gentoo-dev  2018-10-09 17:03:07 UTC  ``` *** [Bug 668158](show_bug.cgi?id=668158 "CONFIRMED - ownership of directories will get lost on first merge for newly created user/groups") has been marked as a duplicate of this bug. *** ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=141619)
* - [XML](show_bug.cgi?ctype=xml&id=141619)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=141619)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=141619&product=Gentoo%20Linux)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=141619&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=141619&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.gentoo.org_8cd350b0_20250125_021725.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 607426
sys-process/cronbase: wrong permissions on dirs lets any user to use cron.
Last modified: 2023-08-30 17:48:54 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=607426&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=607426&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 607426**](show_bug.cgi?id=607426)
- sys-process/cronbase: wrong permissions on dirs lets any user to use cron.

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
sys-process/cronbase: wrong permissions on dirs lets any user to use cron.

| | [Status](page.cgi?id=fields.html#bug_status): | CONFIRMED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Linux | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Linux "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Current packages ([show other bugs](buglist.cgi?component=Current%20packages&product=Gentoo%20Linux&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo's Team for Core System packages | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | Duplicates (2): | [605816](show_bug.cgi?id=605816 "RESOLVED DUPLICATE - sys-process/vixie-cron: crontab does not require user to be part of cron group.") [607430](show_bug.cgi?id=607430 "RESOLVED DUPLICATE - Gentoo: order of installed packages may result in vary directories permissions, leading to crontab not requiring cron group membership as example.")  ([view as bug list](buglist.cgi?bug_id=605816,607430)) | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-01-27 21:11 UTC by Piotr Karbowski (RETIRED) | | --- | --- | | Modified: | 2023-08-30 17:48 UTC ([History](show_activity.cgi?id=607426)) | | CC List: | 6 users (show)  cron-bugs+disabled maintainer-needed nobrowser security slashbeast zmedico | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * [913346](show_bug.cgi?id=913346 "RESOLVED FIXED - acct-user/cron should set ACCT_USER_HOME_OWNER and ACCT_USER_HOME_PERMS") | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=607426&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=607426&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Piotr Karbowski (RETIRED)   gentoo-dev  2017-01-27 21:11:27 UTC  ``` cronbase that installs /var/spool/cron sets up the wrong permissions there. Although ebuild seems to attempt to make it root:cron 750, the directory /var/spool/cron (and /etc/cron.*) is installed as cron:root 755, which allows any system user to setup crontabs, regardless of the cron group membership. On a gentoo system installed two years ago, the permissions are root:cron 750.      diropts -m0750     keepdir /etc/cron.{hourly,daily,weekly,monthly}      keepdir /var/spool/cron/lastrun     diropts -m0750 -o root -g cron     keepdir /var/spool/cron  Maybe the diropts does not works as ebuild author intended, or maybe there is a bug in portage. Nonetheless, I'd consider it as a major security issue.  sys-apps/portage-2.3.3 sys-process/cronbase-0.3.7-r6 ```  [Comment 1](#c1)  Piotr Karbowski (RETIRED)   gentoo-dev  2017-01-27 21:20:42 UTC  ``` So, it seems that if the dirs exist (because for example, vixie-cron was installed before, or anything has been added into /etc/cron.daily, the keedir of cronbase will not adjust permissions. Meaning if one emerges other packages prior to cronbase, the system is vulnerable. ```  [Comment 2](#c2)  Piotr Karbowski (RETIRED)   gentoo-dev  2017-01-27 21:42:12 UTC  ``` as portage does not copy permissions on dirs from $D during merging to rootfs (which seems resonable) shouldn't everything that installs anything in /var/spool/cron and /etc/cron.* depends on cronbase, to make sure it is installed (and permissions are set) prior to installing own files there? ```  [Comment 3](#c3)  Zac Medico   gentoo-dev  2017-01-27 21:51:09 UTC  ``` The directory permissions come from the first package to install the directory, due to [bug 141619](show_bug.cgi?id=141619 "RESOLVED DUPLICATE - [PATCH] portage keeps directory permissions but updates file permissions on merge"). ```  [Comment 4](#c4)  Mike Gilbert   gentoo-dev  2017-01-28 05:04:34 UTC  ``` *** [Bug 605816](show_bug.cgi?id=605816 "RESOLVED DUPLICATE - sys-process/vixie-cron: crontab does not require user to be part of cron group.") has been marked as a duplicate of this bug. *** ```  [Comment 5](#c5)  Kristian Fiskerstrand (RETIRED)   gentoo-dev  2017-01-28 12:25:48 UTC  ``` *** [Bug 607430](show_bug.cgi?id=607430 "RESOLVED DUPLICATE - Gentoo: order of installed packages may result in vary directories permissions, leading to crontab not requiring cron group membership as example.") has been marked as a duplicate of this bug. *** ```  [Comment 6](#c6)  Piotr Karbowski (RETIRED)   gentoo-dev  2017-01-28 19:15:07 UTC  ``` I do not think a status unconfirmed is right one.  Anyhow. I've found what does make the /var/spool/cron be cron:root 755.  When merging cronbase for the first time the cron user is created with home set to /var/spool/cron.   >>> Emerging (1 of 1) sys-process/cronbase-0.3.7-r6::gentoo openpty failed: 'out of pty devices'  * Adding group 'cron' to your system ...  *  - Groupid: 16  * Adding user 'cron' to your system ...  *  - Userid: 16  *  - Shell: /sbin/nologin  *  - Home: /var/spool/cron  *  - Groups: cron  *  - GECOS: added by portage for cronbase  *  - Creating /var/spool/cron in /  And then the ebuild have the keepdir with right right permissions, but since the /var/spool/cron will exist before it gets to the keepdir, nothing is really applied. ```  [Comment 7](#c7)  Zac Medico   gentoo-dev  2017-01-29 19:31:12 UTC  ``` In cronbase-0.3.3.ebuild we had chown/chmod in pkg_postinst, which we don't have in later versions:  <https://gitweb.gentoo.org/repo/gentoo.git/tree/sys-process/cronbase/cronbase-0.3.3.ebuild?id=ca727c9567a7ac4023ade8cce10e26a6376c2cae> ```  [Comment 8](#c8)  Zac Medico   gentoo-dev  2017-01-29 19:38:51 UTC  ``` The pkg_postinst was dropped by vapier in the version bump to 0.3.4:  <https://sources.gentoo.org/cgi-bin/viewvc.cgi/gentoo-x86/sys-process/cronbase/cronbase-0.3.4.ebuild?revision=1.1&view=markup> ```  [Comment 9](#c9)  Ian Zimmerman    2018-01-11 21:10:20 UTC  ``` I think I understand the problem with /var/spool/cron being 755.  But I have a much harder time with /etc/cron.*.  Can someone explain what problem is solved by setting them to 750?  Other than the cronjobs there just being readable by everyone - which is a good thing, IMO, just like a world readable /etc/passwd is.  If there is an exceptionally badly written job that contains secret info one can always just set the job itself to mode 700, or not? ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=607426)
* - [XML](show_bug.cgi?ctype=xml&id=607426)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=607426)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=607426&product=Gentoo%20Linux)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=607426&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=607426&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.gentoo.org_06c55c1c_20250126_051812.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 58611
portage.py(mergeme) failes to change permission/ownership of a directory ${ROOT}/dir if ${IMAGE}/dir has different ownership/permissions.
Last modified: 2017-01-27 22:30:36 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=58611&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=58611&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 58611**](show_bug.cgi?id=58611)
- portage.py(mergeme) failes to change permission/ownership of a directory ${ROOT}/dir if ${IMAGE}/dir has different ownership/permissions.

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
portage.py(mergeme) failes to change permission/ownership of a directory ${RO...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED WONTFIX | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Portage Development | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Portage Development "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Core ([show other bugs](buglist.cgi?component=Core&product=Portage%20Development&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | High normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Portage team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2004-07-27 18:38 UTC by Daniel Black (RETIRED) | | --- | --- | | Modified: | 2017-01-27 22:30 UTC ([History](show_activity.cgi?id=58611)) | | CC List: | 0 users | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * [607430](show_bug.cgi?id=607430 "RESOLVED DUPLICATE - Gentoo: order of installed packages may result in vary directories permissions, leading to crontab not requiring cron group membership as example.") | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=58611&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=58611&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Daniel Black (RETIRED)   gentoo-dev  2004-07-27 18:38:42 UTC  ``` portage.py(line 6581 (current cvs))  If a user has a dir: drwxr-xr-x  2 root root 4096 Jul 28 10:02 /var/spool/wwwoffle/prevtime4 and an ebuild creates a dir: drwxr-xr-x  2 wwwoffle wwwoffle 4096 Jul 28 10:02 /var/tmp/portage/wwwoffle-2.8b/image/var/spool/wwwoffle/prevtime4  The merging of the ebuild fails to change the ownership, group and permissions of the destination directory.  wwwoffle-2.8b works around this with a evil pkg_postinst. ```  [Comment 1](#c1)  Nicholas Jones (RETIRED)   gentoo-dev  2004-07-31 19:10:18 UTC  ``` I don't think this is something portage can legitimately do. Portage shouldn't modify your directory permissions. ```  [Comment 2](#c2)  Daniel Black (RETIRED)   gentoo-dev  2004-08-01 16:15:32 UTC  ``` More food for reconsideration:  A version bumped ebuild will not be able to change the permissions on a directory even if the directory was created by a previous ebuild with different ownership/permissions? This introduces an inconsistency with the way portage handles directories different from files. If an ebuild creates a file, and the file exists in the ${ROOT} directory, it will be overwriten regardless of its permissions/ownership. How is a directory different?  So to legitimately update the directory you would need to emerge -C the previous version and reemerge the update to get the correct permissions directories? If a security fix requires a permission/ownership change on a directory, is a "emerge security" going to be able to fix it (without using pkg_postinst? ```  [Comment 3](#c3)  SpanKY   gentoo-dev  2004-08-10 19:34:47 UTC  ``` the permissions shouldnt get changed by an incoming ebuild ... the problem is that, how is portage to know which permissions are the correct set ?  some users like to tweak permissions on their dirs; they'd get pissed if portage kept turning around and resetting them on them ...  so yes, the only real way to work around bum initial permissions is to have pkg_postinst do it up for you :/ ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=58611)
* - [XML](show_bug.cgi?ctype=xml&id=58611)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=58611)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=58611&product=Portage%20Development)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=58611&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=58611&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


