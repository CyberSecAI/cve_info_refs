=== Content from bugzilla.mozilla.org_bcd9399a_20250125_083841.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/259708)
* [XML](/show_bug.cgi?ctype=xml&id=259708)

Closed
[Bug 259708](/show_bug.cgi?id=259708)

Opened 20 years ago
Closed 20 years ago

# Trying to save file from data: protocol wipes every file in target directory not marked read-only

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Trying to save file from data: protocol wipes every file in target directory not marked read-only

## Categories

### (Toolkit :: Downloads API, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Downloads%20API#Downloads%20API)

Downloads API
▾

Toolkit :: Downloads API
For issues relating to the process of downloading files to disk, including for example progress calculation and timing, folder choice, file naming, and file system access.
Does NOT cover:
- The user interface (see Firefox :: Downloads Panel)
- Networking issues (see Core :: Networking)
- Choosing the handler application (see Firefox :: File Handling)
- Saving complete web pages (see Firefox :: File Handling)
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Downloads%20API&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Downloads%20API&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Downloads%20API)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: WeirdAl, Assigned: bugs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f73806d864c30106831b0a33cfbb763c?d=mm&size=40)  [bugs](/user_profile?user_id=5566)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/8db5d15d9f81c460d5715ebf89a23455?d=mm&size=40)  [ali](/user_profile?user_id=96067)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ed534650c7c16943efed8542c0be3374?d=mm&size=40)  [WeirdAl](/user_profile?user_id=16665)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=40)  [mak](/user_profile?user_id=240353)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[259890](/show_bug.cgi?id=259890 "RESOLVED FIXED - don't call Remove(PR_TRUE) to delete a file"), [262478](/show_bug.cgi?id=262478 "RESOLVED FIXED - Firefox allows websites to delete arbitrary data in the user's temp dir")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[248511](/show_bug.cgi?id=248511 "RESOLVED FIXED - update Known Vulnerabilities page for 2004 releases"), [sbb+](/show_bug.cgi?id=256197 "RESOLVED WORKSFORME - Security Bug Bounty: awarded")

Dependency [tree](/showdependencytree.cgi?id=259708&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=259708)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: dataloss, fixed-aviary1.0, testcase, Whiteboard: [sg:fix])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[dataloss](/buglist.cgi?keywords=dataloss&resolution=---),
[fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:fix]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

1

Bug Flags:

| [bugzilla](/user_profile?user_id=13548) | [blocking-aviary1.0](#a2455_13548 "20 years ago") | + |
| --- | --- | --- |
| [bugzilla](/user_profile?user_id=13548) | blocking-aviary1.0 | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [Testcase HTML page](/attachment.cgi?id=159051)  [20 years ago](#c1)  [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)   2.38 KB, text/html |  | [Details](/attachment.cgi?id=159051&action=edit) |
| --- | --- | --- |
| [Ported patch](/attachment.cgi?id=160030)  [20 years ago](#c11)  [Chris Thomas (CTho) [formerly cst@andrew.cmu.edu cst@yecc.com]](/user_profile?user_id=48814)   1.01 KB, patch |  | [Details](/attachment.cgi?id=160030&action=edit) | [Diff](/attachment.cgi?id=160030&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=259708&attachment=160030) |
| [patch](/attachment.cgi?id=160553)  [20 years ago](#c21)  [Ben Goodger (use ben at mozilla dot org for email)](/user_profile?user_id=5566)   4.61 KB, patch | shaver : [review+](#c23 "20 years ago") | [Details](/attachment.cgi?id=160553&action=edit) | [Diff](/attachment.cgi?id=160553&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=259708&attachment=160553) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=259708#c0)• 20 years ago |
|  | |

Testcase coming up in a few minutes.
Mozilla/5.0 (Windows; U; Win98; rv:1.7.3) Gecko/20040913 Firefox/0.10
Basically, I had written an article for my blog (not yet posted) whereby a short
script would convert a textarea's contents into a data: URI for saving.
So with a content-type of application/octet-stream, Firefox would try to save
it. Unfortunately, it would never go beyond the "Starting" phase of the "download".
When you hit cancel, bye-bye directory's contents, except for the first file.
Repeated testcase in Mozilla 1.8a3: did NOT see the same results. Example
worked perfectly.

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=259708#c1)• 20 years ago |
|  | |

Attached file
[Testcase HTML page](attachment.cgi?id=159051)
— [Details](attachment.cgi?id=159051&action=edit)

Steps to reproduce:
(1) Tools, Options, Downloads. Set the directory to a brand-new one.
(2) In said download directory, manually create three or four new files,
perhaps a directory or two.
(3) Open attachment, scroll to bottom and click "Save File" button.
(4) Mozilla Firefox asks you whether you want to open the file or save it...
choose "Save to disk".
(5) Download Manager appears with "Starting" message for Downloads directory
(this is probably NOT what should happen. It should show an actual file being
downloaded.)
(6) Hit Cancel link in Download Manager.
Expected result: Download cancels safely.
Actual result: All but one file in your downloads directory are completely
gone, unrecoverable.
Reproducible: Always

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=259708#c2)• 20 years ago |
|  | |

blocking1.0? because of traumatic dataloss. Yes, it's a rare scenario, but it's
very evil.Flags: blocking-aviary1.0?

|  | [Blake Ross](/user_profile?user_id=13548) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a2455_13548)• 20 years ago |

Flags: blocking-aviary1.0? → blocking-aviary1.0+

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=259708#c3)• 20 years ago |
|  | |

Further testing shows the only reason any file in the target directory survived
-- for that matter, the target directory itself -- is because said file was
marked read-only.Summary: Trying to save file from data: protocol wipes every file in target directory except first one → Trying to save file from data: protocol wipes every file in target directory not marked read-only

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=259708#c4)• 20 years ago |
|  | |

Sounds like some of the (forked) front-end code is making silly assumptions
about the ability to get a non-empty filename off a URI.
Since it's forked, I happen to not really care.

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=259708#c5)• 20 years ago |
|  | |

I've tracked the problem back to
<http://lxr.mozilla.org/aviarybranch/source/uriloader/exthandler/nsExternalHelperAppService.cpp>
. I think it unusual that we don't get a file picker to find out the preferred
filename for this file.

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=259708#c6)• 20 years ago |
|  | |

whoa, what exactly in that file does this?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=259708#c7)• 20 years ago |
|  | |

I'm betting that the temp file is being set to the directory (by the Firefox
download manager breakage) and then that PR\_TRUE in the delete that you fixed on
trunk recently kicks in.

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=259708#c8)• 20 years ago |
|  | |

nsExternalAppHandler::InitializeDownload is suspicious, insomuch as it is the
only code which refers to an aDownload object.
For that matter, I should clarify that it very well could be
nsDownloadManager.cpp . I thought nsExternalAppHandler was responsible because
I didn't see it specify or request a filename right away.

|  | [Darin Fisher](/user_profile?user_id=20048) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=259708#c9)• 20 years ago |
|  | |

(In reply to [comment #7](/show_bug.cgi?id=259708#c7 "RESOLVED FIXED - Trying to save file from data: protocol wipes every file in target directory not marked read-only"))
> I'm betting that the temp file is being set to the directory (by the Firefox
> download manager breakage) and then that PR\_TRUE in the delete that you fixed on
> trunk recently kicks in.
we should make sure that the patch for [bug 259890](/show_bug.cgi?id=259890 "RESOLVED FIXED - don't call Remove(PR_TRUE) to delete a file") lands on the aviary and 1.7
branches.

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=259708#c10)• 20 years ago |
|  | |

:( Note [bug 259890 comment 7](/show_bug.cgi?id=259890#c7 "RESOLVED FIXED - don't call Remove(PR_TRUE) to delete a file"). The patch for Mozilla trunk will not apply to
Firefox 1.0 branch.

|  | [Chris Thomas (CTho) [formerly cst@andrew.cmu.edu cst@yecc.com]](/user_profile?user_id=48814) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=259708#c11)• 20 years ago |
|  | |

Attached patch

[Ported patch](attachment.cgi?id=160030&action=diff) (obsolete)
— [Details](attachment.cgi?id=160030&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=259708&attachment=160030)

Untested, cargo-cult.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=259708#c12)• 20 years ago |
|  | |

Comment on [attachment 160030](/attachment.cgi?id=160030 "Ported patch") [[details]](/attachment.cgi?id=160030&action=edit "Ported patch") [[diff]](/attachment.cgi?id=160030&action=diff "Ported patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=259708&attachment=160030)
Ported patch
r+sr=bzbarsky
[Attachment #160030](/attachment.cgi?id=160030&action=edit "Ported patch") -
Flags: superreview+
[Attachment #160030](/attachment.cgi?id=160030&action=edit "Ported patch") -
Flags: review+

|  | [Chris Thomas (CTho) [formerly cst@andrew.cmu.edu cst@yecc.com]](/user_profile?user_id=48814) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a782795_48814)• 20 years ago |

Assignee: bugs → cst

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a782854_16665)• 20 years ago |

[Attachment #160030](/attachment.cgi?id=160030&action=edit "Ported patch") -
Flags: approval-aviary?

|  | [Chris Thomas (CTho) [formerly cst@andrew.cmu.edu cst@yecc.com]](/user_profile?user_id=48814) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a783016_48814)• 20 years ago |

Depends on: [259890](/show_bug.cgi?id=259890 "RESOLVED FIXED - don't call Remove(PR_TRUE) to delete a file")

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=259708#c13)• 20 years ago |
|  | |

Comment on [attachment 160030](/attachment.cgi?id=160030 "Ported patch") [[details]](/attachment.cgi?id=160030&action=edit "Ported patch") [[diff]](/attachment.cgi?id=160030&action=diff "Ported patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=259708&attachment=160030)
Ported patch
Actually, clearing reviews. This patch is on the wrong bug. It may well fix
this bug (in that the directory will no longer be wiped), but even with it in
you won't be able to save...
[Attachment #160030](/attachment.cgi?id=160030&action=edit "Ported patch") -
Flags: superreview+
[Attachment #160030](/attachment.cgi?id=160030&action=edit "Ported patch") -
Flags: review+
[Attachment #160030](/attachment.cgi?id=160030&action=edit "Ported patch") -
Flags: approval-aviary?

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=259708#c14)• 20 years ago |
|  | |

Comment on [attachment 160030](/attachment.cgi?id=160030 "Ported patch") [[details]](/attachment.cgi?id=160030&action=edit "Ported patch") [[diff]](/attachment.cgi?id=160030&action=diff "Ported patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=259708&attachment=160030)
Ported patch
obsoleting, as this is being covered by [bug 259890](/show_bug.cgi?id=259890 "RESOLVED FIXED - don't call Remove(PR_TRUE) to delete a file")
[Attachment #160030](/attachment.cgi?id=160030&action=edit "Ported patch") -
Attachment is obsolete: true

|  | [Vladimir Vukicevic [:vlad] [:vladv] (needinfo me, slow to respond)](/user_profile?user_id=24534) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=259708#c15)• 20 years ago |
|  | |

I just committed the patch for 259890, which might also fix this -- can someone
confirm that it does with tomorrow's nightly, and resolve this if so?

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=259708#c16)• 20 years ago |
|  | |

Mozilla/5.0 (Windows; U; Win98; en-US; rv:1.7.3) Gecko/20040925 Firefox/0.10
is still showing this bug!
ftp://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/sweetlou-0.9/Firefox-win32.zip
dated 9/25/04 2:35:00 PM

|  | [Chris Thomas (CTho) [formerly cst@andrew.cmu.edu cst@yecc.com]](/user_profile?user_id=48814) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=259708#c17)• 20 years ago |
|  | |

Oh, I wasn't doing the right steps to reproduce the bug. I can reproduce it
with my PR1.0 build, but my aviary-1.0 nightly with my patch isn't failing to
download - it downloads successfully and it's so fast I can't hit cancel.

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=259708#c18)• 20 years ago |
|  | |

confirmed, this bug is still present in 09/25 builds. :-(

|  | [Chris Thomas (CTho) [formerly cst@andrew.cmu.edu cst@yecc.com]](/user_profile?user_id=48814) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a1169616_48814)• 20 years ago |

Assignee: cst → bugs

|  | [Ben Goodger (use ben at mozilla dot org for email)](/user_profile?user_id=5566)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=259708#c19)• 20 years ago |
|  | |

Asa suggested this become a security-sensitive bug due to possible side-effects.Group: securityStatus: NEW → ASSIGNED

|  | [Asa Dotzler [:asa]](/user_profile?user_id=5003) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=259708#c20)• 20 years ago |
|  | |

Tracy, can you try to figure out when this was first introduced and which
products/releases it impacts?

|  | [Ben Goodger (use ben at mozilla dot org for email)](/user_profile?user_id=5566)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=259708#c21)• 20 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=160553&action=diff)
— [Details](attachment.cgi?id=160553&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=259708&attachment=160553)

patch

|  | [Tracy Walker [:tracy]](/user_profile?user_id=18566) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=259708#c22)• 20 years ago |
|  | |

This bug affects releases at least back to Firefox 0.8
I can't reproduce this on Mozilla builds. Tested 1.8a4 and 1.7
On Firefox 0.8 and 0.9 I didn't have to cancel the download. It was too fast
to cancel anyhow. But the folder I selected to download to was overwritten by
the downloaded testfile (it kept the Folder name).
Mozilla builds installed the file into the selected Folder without data loss.

|  | [Mike Shaver (:shaver emeritus)](/user_profile?user_id=422) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=259708#c23)• 20 years ago |
|  | |

Comment on [attachment 160553](/attachment.cgi?id=160553 "patch") [[details]](/attachment.cgi?id=160553&action=edit "patch") [[diff]](/attachment.cgi?id=160553&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=259708&attachment=160553)
patch
r=shaver.
[Attachment #160553](/attachment.cgi?id=160553&action=edit "patch") -
Flags: review+

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=259708#c24)• 20 years ago |
|  | |

For the record, though I may be too late, I was able to reproduce this bug also
on Linux with a debug-built Firefox.OS: Windows 98 → All

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=259708#c25)• 20 years ago |
|  | |

The patch does fix this bug, but I get an exception running my testcase:
\*\*\* exception in validateLeafName: [Exception... "Component returned failure
code: 0x80520001 (NS\_ERROR\_FILE\_UNRECOGNIZED\_PATH) [nsILocalFile.append]"
nsresult: "0x80520001 (NS\_ERROR\_FILE\_UNRECOGNIZED\_PATH)" location: "JS frame ::
file:///home/ajvincent/mozilla/dist/bin/components/nsHelperAppDlg.js ::
anonymous :: line 211" data: no]

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=259708#c26)• 20 years ago |
|  | |

fixed Mozilla/5.0 (Windows; U; Win98; en-US; rv:1.7.3) Gecko/20040929 Firefox/0.10
as of a sweetlou build timestamped 2004092917
We pass the testcase, and I can file a separate (non-blocking-aviary) bug for
fixing the download manager (or our help dialog) to get a filepicker so we save
the file properly.
Question, though: are there any other protocols which can force a pseudo-download?
I'm leaving this bug as ASSIGNED, in case there are such protocols or resolving
as FIXED would open this bug to the public. Until I am assured of such, I think
I should not file the spinoff bug for getting the filepicker.

|  | [Tracy Walker [:tracy]](/user_profile?user_id=18566) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=259708#c27)• 20 years ago |
|  | |

Verified fixed on Windows branch build 2004-09-30-08-0.9
fyi: I also tried some various scenarios with sending, saving and opening the
file on the Thunderbird branch and had no data loss.

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a1273513_16665)• 20 years ago |

Status: ASSIGNED → RESOLVEDClosed: 20 years agoResolution: --- → FIXED

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=259708#c28)• 20 years ago |
|  | |

Given that this bug is fixed, as tested by myself and Tracy Walker, could we
please re-expose this bug to the public? I'd like to be able to talk about it
again.

|  | [Asa Dotzler [:asa]](/user_profile?user_id=5003) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=259708#c29)• 20 years ago |
|  | |

Alex, we're hustling to get a Firefox update in place, both an xpi patch and a
full 0.10.1 build. If all goes well, we'll be shipping that tomorrow. I'd like
to keep this closed until then. Is that OK with you?

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=259708#c30)• 20 years ago |
|  | |

Fine. :) I'm just writing out some analysis of the bug's process now for
posting to my blog.

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=259708#c31)• 20 years ago |
|  | |

Comment on [attachment 160553](/attachment.cgi?id=160553 "patch") [[details]](/attachment.cgi?id=160553&action=edit "patch") [[diff]](/attachment.cgi?id=160553&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=259708&attachment=160553)
patch
ok, so this patch cathes an exception and modifies the filename if it finds
one. (I do think "unnamed" should be localizable, btw).
but wouldn't a better fix be \_not\_ to recursively delete something that is
supposed to be a single file? it seems to me like there must be a remove(true)
somewhere that would better be a remove(false).

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=259708#c32)• 20 years ago |
|  | |

Isn't the recursive delete what you fixed in [bug 259890](/show_bug.cgi?id=259890 "RESOLVED FIXED - don't call Remove(PR_TRUE) to delete a file")? Or did that turn out to
be unrelated?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a1344355_1689)• 20 years ago |

Blocks: [sbb?](/show_bug.cgi?id=256195 "RESOLVED WORKSFORME - Security Bug Bounty: nominated")

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=259708#c33)• 20 years ago |
|  | |

dveditz: [comment 18](/show_bug.cgi?id=259708#c18 "RESOLVED FIXED - Trying to save file from data: protocol wipes every file in target directory not marked read-only") said that the patch there did not fix this bug; so it seems
unrelated

|  | [Chris Thomas (CTho) [formerly cst@andrew.cmu.edu cst@yecc.com]](/user_profile?user_id=48814) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=259708#c34)• 20 years ago |
|  | |

Isn't the cause of the problem more likely to be the Remove(PR\_TRUE) here?
<http://lxr.mozilla.org/aviarybranch/source/toolkit/components/downloads/src/nsDownloadManager.cpp#566>
That checks if the file exists, and if it does, recursively deletes it.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a1348399_20209)• 20 years ago |

Depends on: [262478](/show_bug.cgi?id=262478 "RESOLVED FIXED - Firefox allows websites to delete arbitrary data in the user's temp dir")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=259708#c35)• 20 years ago |
|  | |

We would like to leave this bug security-sensitive for a couple of days after
the patch release to give people a chance to protect themselve before leaking
exploit details.Whiteboard: [sg:fix] please don't remove security flag before Monday Oct 4

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=259708#c36)• 20 years ago |
|  | |

(In reply to [comment #31](/show_bug.cgi?id=259708#c31 "RESOLVED FIXED - Trying to save file from data: protocol wipes every file in target directory not marked read-only"))
> but wouldn't a better fix be \_not\_ to recursively delete something that is
> supposed to be a single file? it seems to me like there must be a remove(true)
> somewhere that would better be a remove(false).
ok, fixed by
<http://bonsai.mozilla.org/cvsview2.cgi?diff_mode=context&whitespace_mode=show&subdir=mozilla/toolkit/mozapps/downloads/content&command=DIFF_FRAMESET&file=downloads.js&rev1=1.28&rev2=1.29&root=/cvsroot>
(checked in as part of [bug 262478](/show_bug.cgi?id=262478 "RESOLVED FIXED - Firefox allows websites to delete arbitrary data in the user's temp dir"))

|  | [Asa Dotzler [:asa]](/user_profile?user_id=5003) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a1609753_5003)• 20 years ago |

Keywords: [fixed-aviary1.0](/buglist.cgi?keywords=fixed-aviary1.0&resolution=---)

|  | [Mike Shaver (:shaver emeritus)](/user_profile?user_id=422) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=259708#c37)• 20 years ago |
|  | |

Opening bug at reporter's request.Group: security

|  | [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)  Reporter |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=259708#c38)• 20 years ago |
|  | |

I filed [bug 262949](/show_bug.cgi?id=262949 "RESOLVED INCOMPLETE - DM should ask for a filename if one isn't provided") per [comment 31](/show_bug.cgi?id=259708#c31 "RESOLVED FIXED - Trying to save file from data: protocol wipes every file in target directory not marked read-only") of this bug, to see if we can get a better
filename than "unnamed".

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a1710382_1689)• 20 years ago |

Whiteboard: [sg:fix] please don't remove security flag before Monday Oct 4 → [sg:fix]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a1793826_1689)• 20 years ago |

Blocks: [sbb+](/show_bug.cgi?id=256197 "RESOLVED WORKSFORME - Security Bug Bounty: awarded")
No longer blocks: [sbb?](/show_bug.cgi?id=256195 "RESOLVED WORKSFORME - Security Bug Bounty: nominated")

|  | [nivoside](/user_profile?user_id=80586) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a9735889_80586)• 20 years ago |

Blocks: [248511](/show_bug.cgi?id=248511 "RESOLVED FIXED - update Known Vulnerabilities page for 2004 releases")

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=259708#a122201395_1)• 16 years ago |

Product: Firefox → Toolkit
You need to [log in](/show_bug.cgi?id=259708&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Alex Vincent [:WeirdAl]](/user_profile?user_id=16665)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_0f57a843_20250125_083839.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

# Older Vulnerabilities in Mozilla Products

This page archives security announcements made for older versions of
Mozilla projects. Please see the active [Known Vulnerabilities](/en-US/security/known-vulnerabilities/) page for more recent security advisories.

* [Fixed in Firefox Preview Release update (0.10.1)](#firefox0.10.1)
* [Fixed in Firefox Preview Release, Mozilla 1.7.3, Thunderbird
  0.8](#mozilla1.7.3)
* [Fixed in Mozilla 1.7.2/Firefox 0.9.3/Thunderbird 0.7.3](#mozilla1.7.2)
* [Fixed in Mozilla 1.7.1/Firefox 0.9.2/Thunderbird 0.7.2](#mozilla1.7.1)
* [Fixed in Mozilla 1.7/Firefox 0.9/Thunderbird 0.7](#mozilla1.7)
* [Fixed in Mozilla 1.6](#mozilla1.6)
* [November 2003 Update](#nov-2003)
* [July 2003 Update](#jul-2003)
* [February 2003 Update](#feb-2003)
* [Updates up to December 2002](#dec-2002)

### Fixed in Firefox Preview Release update (0.10.1)

| # | Title | Severity / Risk | Type | Description | Reported by | Date Fixed |
| --- | --- | --- | --- | --- | --- | --- |
| 94 | Downloading link deletes files | high / high | dataloss | Firefox simplifies the task of saving files by automatically using a filename based on the original link. A specific link format triggers a bug in this feature and can cause the deletion of files in the download directory. An attacker would need to convince a victim to click the "Save" button to download a file from their site. **Workaround:** Cancel unexpected file save prompts and any from untrusted sites. When saving files, right-click on the link and select "Save link as" from the context menu. | Alex Vincent | *2004-09-29* |

### Fixed in Firefox Preview Release, Mozilla 1.7.3, Thunderbird 0.8

| # | Title | Severity / Risk | Type | Description | Reported by | Date Fixed |
| --- | --- | --- | --- | --- | --- | --- |
| 93 | "Send page" heap overrun ([258005](https://bugzilla.mozilla.org/show_bug.cgi?id=258005)) | critical / moderate | remote execution | The "send page" function can overrun the heap on very long links. With compelling content that people will want to forward to all their friends and the right link this could be used to execute arbitrary code. | Georgi Guninski | *2004-09-07* |
| 92 | javascript clipboard access ([257523](https://bugzilla.mozilla.org/show_bug.cgi?id=257523)) | moderate / high | clipboard leak | Untrusted javascript code can read and write to the clipboard, stealing any sensitive data the user might have copied. **Workaround:** disable javascript | Wladimir Palant | *2004-09-01* |
| 91 | Privilege request confusion ([253942](https://bugzilla.mozilla.org/show_bug.cgi?id=253942)) | critical / low | remote execution | Signed scripts requesting enhanced abilities could construct the request in a way that led to a confusing grant dialog, possibly fooling the user into thinking the privilege requested was inconsequential while actually obtaining explicit permission to run and install software. **Workaround:** Never grant enhanced abilities of any kind to untrusted web pages. | Jesse Ruderman | *2004-09-01* |
| 90 | Buffer overflow when displaying VCard ([257314](https://bugzilla.mozilla.org/show_bug.cgi?id=257314)) | critical / high | remote execution | A stack buffer overrun in VCard display routines could be exploited to run arbitrary code supplied by the attacker. **Workaround:** Disable in-line display of attachments, don't open VCard attachments. | Georgi Guninski | *2004-08-30* |
| 89 | BMP integer overflow ([255067](https://bugzilla.mozilla.org/show_bug.cgi?id=255067)) | critical / high | heap overrun | extremely wide BMP images trigger an integer overflow, leading to heap overruns that are potentially exploitable to run arbitrary code. **Workaround:** Disable images. | Gael Delalleau | *2004-08-27* |
| 88 | javascript: link dragging ([250862](https://bugzilla.mozilla.org/show_bug.cgi?id=250862)) | critical / moderate | cross-domain scripting, possibly remote execution | javascript; links dragged onto another frame or page allows an attacker to steal or modify sensitive information from other sites. The user could be convinced to drag obscurred links in the context of a game or even a fake scrollbar. If the user could be convinced to drag two links in sequence into a separate window (not frame) the attacker would be able to run arbitrary programs. | Jesse Ruderman | *2004-08-26* |
| 87 | non-ascii hostname heap overrun ([256316](https://bugzilla.mozilla.org/show_bug.cgi?id=256316)) | critical / high | remote execution | A link with a non-ascii hostname can cause a heap buffer overrun that could potentially be exploited to run arbitrary programs. | Mats Palmgren, Gael Delalleau | *2004-08-24* |
| 86 | Malicious POP3 server III ([245066](https://bugzilla.mozilla.org/show_bug.cgi?id=245066), [226669](https://bugzilla.mozilla.org/show_bug.cgi?id=226669)) | critical / moderate | remote execution | Responses from a malicious POP3 mail server can trigger heap overruns that can be exploited to run arbitrary code. | Gael Delalleau | *2004-08-17* |
| 85 | Wrong file permissions after installing on Linux ([231083](https://bugzilla.mozilla.org/show_bug.cgi?id=231083), [235781](https://bugzilla.mozilla.org/show_bug.cgi?id=235781)) | moderate / low | local exploit | The Linux installers could create files world readable and writable, allowing another local user to replace them with malicious versions. **Workaround:** chmod the installed files | Daniel Koukola, Andrew Schultz | *2004-08-16* |
| 84 | Wrong file permissions in linux archive ([254303](https://bugzilla.mozilla.org/show_bug.cgi?id=254303)) | moderate / low | local exploit | File permissions and owner were set wrong in the Linux install .tar.gz archives. If unpacked with an option to ignore the user's umask setting (or with a permissive umask) the resulting files could be secretly replaced with malicious versions by any other user on the system. **Workaround:** chmod and chown the files after unpacking. | Harald Milz | *2004-08-16* |

### Fixed in Mozilla 1.7.2/Firefox 0.9.3/Thunderbird 0.7.3

| # | Title | Severity / Risk | Type | Description | Reported by | Date Fixed |
| --- | --- | --- | --- | --- | --- | --- |
| 83 | buffer and integer overflows in libpng ([251381](https://bugzilla.mozilla.org/show_bug.cgi?id=251381)) | critical / high | remote execution | Multiple flaws in libpng were announced, the worst of which could lead to remote code execution via buffer overflow. [CAN-2004-0597](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0597), [CAN-2004-0598](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0598), [CAN-2004-0599](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0599) | Chris Evans | *2004-08-03* |
| 82 | lock icon and certificate spoof with onunload document.write ([253121](https://bugzilla.mozilla.org/show_bug.cgi?id=253121)) | moderate / moderate | spoof | The lock icon and certificate from a previous secure site can persist if a page is re-written using an onunload handler. Combined with redirects this could be used to spoof secure sites. The location bar, if shown, displays the true URL. [CAN-2004-0763](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0763) | Emmanouel Kellinis | *2004-07-27* |
| 81 | Malicious certificates can permanently break HTTPS/SSL ([249004](https://bugzilla.mozilla.org/show_bug.cgi?id=249004)) | critical / high | persistent DOS | Malicious email certificates could mask built-in Certificate Authority (CA) certificates. Once imported anything signed by the masked CA would not validate, which could be used to permanently block all SSL (https:) sites with certs issued by that CA. [CAN-2004-0758](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0758) | Marcel Boesch | *2004-07-27* |

### Fixed in Mozilla 1.7.1/Firefox 0.9.2/Thunderbird 0.7.2

| # | Title | Severity / Risk | Type | Description | Reported by | Date Fixed |
| --- | --- | --- | --- | --- | --- | --- |
| 80 | Windows shell: protocol handler ([250180](https://bugzilla.mozilla.org/show_bug.cgi?id=250180)) | critical / high | remote execution | shell: URLs were passed to windows for handling which could result in launching programs. This could theoretically be combined with an unpatched exploit in some default windows filetype handler to run arbitrary code | Keith McCanless | *2004-07-07* |

### Fixed in Mozilla 1.7/Firefox 0.9/Thunderbird 0.7

| # | Title | Severity / Risk | Type | Description | Reported by | Date Fixed |
| --- | --- | --- | --- | --- | --- | --- |
| 79 | Spoof contents of framed site ([246448](https://bugzilla.mozilla.org/show_bug.cgi?id=246448)) | moderate / moderate | spoof | The contents of a frames within a document could be replaced by an attacker with a reference to that window, while leaving the address in the location bar. On a secure site the lock icon would change to broken, but otherwise it could be a successful spoof. | Jesse Ruderman | *2004-06-16* |
| 78 | security dialog popup ([162020](https://bugzilla.mozilla.org/show_bug.cgi?id=162020)) | critical / high | remote code execution | An attacker who could lure users into clicking in particular places, or typing specific text, could cause a security permission or software installation dialog to pop up under the user's mouse click, clicking on the grant (or install) button. | Jesse Ruderman | *2004-06-05* |
| 77 | Untrusted content displayed with "chrome" flag ([244965](https://bugzilla.mozilla.org/show_bug.cgi?id=244965)) | moderate / low | spoof | Untrusted web content can open windows with the "chrome" style. This suppresses the normal browser frame and makes spoofed dialogs easy (such as the master password dialog). Affects Mozilla 1.6 through 1.7rc2. | James Ross | *2004-06-02* |
| 76 | POP3 mail server heap overrun ([229374](https://bugzilla.mozilla.org/show_bug.cgi?id=229374)) | critical / low | heap overrun | A variant of bug 157644 (see #27 below), malicious POP server could overwrite memory and execute arbitrary code. | zen parse | *2004-05-29* |
| 75 | Mac remote code execution via help: and disk: ([243699](https://bugzilla.mozilla.org/show_bug.cgi?id=243699)) | critical / high | remote code execution | lixlpixel reported vulnerabilities in the help: and disk: URI schemes in some versions of Mac OS X. Web content could access those schemes through Mozilla. **Workaround:** install the latest OS patches. | Mike Calmus | *2004-05-17* |
| 74 | PNG out-of-bounds read ([242915](https://bugzilla.mozilla.org/show_bug.cgi?id=242915)) | minor / low | DOS | The libpng project announced a bug that could be exploited as a denial of service attack. See [CAN-2004-0421](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0421) | Glenn Randers-Pehrson | *2004-05-07* |
| 73 | automatic file upload ([241924](https://bugzilla.mozilla.org/show_bug.cgi?id=241924)) | high / moderate | file access | Regression in Mozilla 1.7-beta only: file upload control value can be pre-filled using document.write() and innerHTML, allowing attacker to programmatically submit the form and capture a file at a known location. **Workaround:** disable Javascript | Met - Martin Hassman | *2004-04-28* |
| 72 | SSL Certificate Spoof ([240053](https://bugzilla.mozilla.org/show_bug.cgi?id=240053)) | high / high | spoof | A malicious page can use redirects to turn on the SSL lock icon and appear secure. This could be used to further phishing scams. | Tolga Tarhan | *2004-04-10* |
| 71 | Stealing secure HTTP Auth passwords via DNS spoof ([226278](https://bugzilla.mozilla.org/show_bug.cgi?id=226278)) | high / low | password theft | HTTP auth passwords were cached by site and port but did not store whether the protocol used was secure (SSL) or not. An attacker who could spoof your DNS could wait until you authenticate to a secure site then redirect a later connection to that site and port during that session to a non-SSL machine under their control, thus stealing the secure password. | Christopher Nebergall | *2004-04-07* |
| 70 | non-FQDN cert name matching is insecure ([234058](https://bugzilla.mozilla.org/show_bug.cgi?id=234058)) | minor / low | spoof | A non-FQDN URI hostname can match part of a cert name w/out a warning dialog. Could be used for spoofing if an attacker had control of machines on your default DNS search path. | Tim Dierks | *2004-04-07* |
| 69 | remote access to local files through Liveconnect ([239122](https://bugzilla.mozilla.org/show_bug.cgi?id=239122)) | high / high | remote reading | Mozilla 1.7beta allowed remote web pages to read local files in known locations using Liveconnect (requires Java; 1.7alpha and earlier are safe) | Darin Fisher | *2004-04-05* |
| 68 | redefine focus()/blur() on another window ([86028](https://bugzilla.mozilla.org/show_bug.cgi?id=86028)) | minor / low | DOS | Attacker can replace some functions on windows he opened. Replaced functions run in the attacker's domain so can't steal data, but could interfere with the operation of the other window. | Jesse Ruderman | *2004-03-25* |
| 67 | SOAPParameter overflow ([236618](https://bugzilla.mozilla.org/show_bug.cgi?id=236618)) | critical / high | remote code execution | An integer overflow passing a large js array to the SOAPParameter constructor results in a controlled overwriting of the heap, which can be exploited to run arbitary code of the attacker's choice. **Workaround:** disable Javascript | zen parse / iDEFENSE | *2004-03-08* |
| 66 | drag into file upload control ([206859](https://bugzilla.mozilla.org/show_bug.cgi?id=206859)) | high / low | file access | A clever attacker might be able to trick a user into dragging disguised text into an obscured file upload control, resulting in the capture of a user's file at a known location. | Jesse Ruderman | *2004-02-11* |

### Fixed in Mozilla 1.6

| # | Title | Severity / Risk | Type | Description | Reported by | Date Fixed |
| --- | --- | --- | --- | --- | --- | --- |
| 65 | %00 status bar spoof ([228176](https://bugzilla.mozilla.org/show_bug.cgi?id=228176)) | minor / low | spoof | %00 in an href truncates the status bar display when you mouse over the link. This could be used to further phishing scams in mail where Javascript is disabled and the status bar might be trusted more than in normal web content. | [Secunia](http://secunia.com/advisories/10419/) | *2004-01-06* |
| 64 | Cross-domain exploit on zombie document with event handlers ([227417](https://bugzilla.mozilla.org/show_bug.cgi?id=227417)) | moderate / low | same-origin violation | During page transition it was possible to run event handlers from the old page in the context of the new page. This has been demonstrated to allow cookie stealing, and potentially any sensitive account information displayed by the new site. | [Andreas Sandblad](http://www.sandblad.com/security/advisories/) | *2003-12-03* |

### November 2003 Update

| # | Type | Fixed | Milestones Affected | Severity | Description | Bug Number(s) | Workarounds | Date Fixed |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 63 | heap overflow | 1.5 1.4.2 | through 1.4 | Run arbitrary code | Malicious PPM image can cause a heap overrun, possibly allowing execution of arbitrary code | [220721](https://bugzilla.mozilla.org/show_bug.cgi?id=220721) | Disable images | *2003-12-16* |
| 62 | JavaScript | 1.5, 1.4.1 | M1 to 1.4 | Run arbitrary code | Script.prototype.freeze/thaw could allow an attacker to run arbitrary code your computer. | [221526](https://bugzilla.mozilla.org/show_bug.cgi?id=221526) | Disable JavaScript | *2003-10-07* |
| 61 | Running Executables | 1.5 1.4.2 | M1 to 1.4.1 | \*.hta files could be executed on Windows | \*.hta files were not treated as executable, and could be used to gain full access to a user's system | [220257](https://bugzilla.mozilla.org/show_bug.cgi?id=220257) | Don't open \*.hta or application/hta files | *2003-09-29* |
| 60 | Networking | 1.5 1.4.2 | M1 to 1.4.1 | Reading passwords | A malicious website could gain access to a user's authentication credentials to a proxy server. | [220122](https://bugzilla.mozilla.org/show_bug.cgi?id=220122) | None | *2003-09-24* |
| 59 | JavaScript | firebird 0.7 | Firebird 0.6 | Run arbitrary code | A website could gain chrome privileges by overriding the setter of a property on an HTML link, if the user could be convinced to click on it. | [217195](https://bugzilla.mozilla.org/show_bug.cgi?id=217195) | Disable JavaScript | *2003-09-23* |
| 58 | Mail | 1.5 | M1 to 1.4 | Storing passwords on disk | POP3 account passwords are saved to disk even when the user explicitly requests them not to be. | [217625](https://bugzilla.mozilla.org/show_bug.cgi?id=217625) | Disable Password Manager | 2003-08-28 |
| 57 | Cookies | 1.5 1.4.1 | M1 to 1.4 | Read cookies set by another path | By requesting a cookie with a path containing the escape sequence "%2E%2E", a malicious web site would be able to read cookies from different paths. | [213012](https://bugzilla.mozilla.org/show_bug.cgi?id=213012) | Disable Cookies | *2003-07-28* |
| 56 | JavaScript | 1.4 | M1 to 1.3 | Determine whether a variable exists on a different domain | Cross-domain variable detection is possible using scopes (eval, with) | [158049](https://bugzilla.mozilla.org/show_bug.cgi?id=158049) | Disable JavaScript | *2003-06-02* |
| 55 | JavaScript | 1.4 | M1 to 1.3 | Cross-domain scripting | Executing custom setters or getters on a different domain is possible. | [92773](https://bugzilla.mozilla.org/show_bug.cgi?id=92773) | Disable JavaScript | *2003-03-06* |
| 54 | DOM | 1.4 | M1 to 1.3 | Determine whether a URL was visited | A website can use history.goURL to determine whether a URL was previously visited | [163549](https://bugzilla.mozilla.org/show_bug.cgi?id=163549) | Disable JavaScript | *2003-02-25* |
| 53 | Cookies | 1.3 | M1 to 1.2 | Read cookies set by another path | Cookies set to path "abc" were able to be read by a page with path "abcd" | [155114](https://bugzilla.mozilla.org/show_bug.cgi?id=155114) | Disable Cookies | *2002-08-11* |

### July 2003 Update

| # | Type | Milestones Affected | Severity | Description | Bug Number(s) | Workarounds | Date Fixed |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 52 | DOM | M1 to 1.3 | Read local JavaScript files | XUL script can read local JavaScript files | [180748](https://bugzilla.mozilla.org/show_bug.cgi?id=180748) | Disable JavaScript | *2003-06-02* |
| 51 | DOM | M1 to 1.3 | Executing arbitrary JavaScript on a page | IMG tags can be misused to load and run arbitrary JavaScript on a page | [195201](https://bugzilla.mozilla.org/show_bug.cgi?id=195201) | Disable JavaScript | *2003-05-29* |
| 50 | XBL | M1 to 1.3 | Read local files | A bug in XBL handling, and the feature that external applications create files with known names in well-known locations can be exploited to read local files | [200691](https://bugzilla.mozilla.org/show_bug.cgi?id=200691) | Disable JavaScript | *2003-05-01* |
| 49 | DOM | M1 to 1.3 | Read data from third-party site | document.domain can be set improperly to gain access to third-party site | [204682](https://bugzilla.mozilla.org/show_bug.cgi?id=204682) | Disable JavaScript | *2003-05-09* |
| 48 | DOM | M1 to 1.3 | Track URLs as they are visited | javascript: URL return values are converted to strings without security checks | [202994](https://bugzilla.mozilla.org/show_bug.cgi?id=202994) | Disable JavaScript | *2003-05-02* |
| 47 | XUL | M1 to 1.3 | Reading XML files from known locations | XUL overlays can be loaded from third-party sites | [159450](https://bugzilla.mozilla.org/show_bug.cgi?id=159450) | None | *2003-05-02* |
| 46 | Spoofing | M1 to 1.3 | Reading passwords | HTTP authentication password prompt could be confused for the mail server password prompt | [51631](https://bugzilla.mozilla.org/show_bug.cgi?id=51631) | Memorize the real mail server password prompt and do not enter your password if the dialog is not exactly the same | *2003-04-25* |
| 45 | Buffer Overrun | M1 to 1.3 | Run arbitrary code | Reading a maliciously crafted email could cause an exploitable buffer overrun | [202546](https://bugzilla.mozilla.org/show_bug.cgi?id=202546) | None | *2003-04-25* |
| 44 | Buffer Overrun | M1 to 1.3 | Run arbitrary code | Reading a maliciously crafted email could cause an exploitable buffer overrun | [201547](https://bugzilla.mozilla.org/show_bug.cgi?id=201547) | None | *2003-04-23* |
| 43 | DOM | M1 to 1.3 | Read data from third-party sites | Clicking a javascript: links as a page is loading can cause the JavaScript to execute with wrong privileges which can enable reading data from third-party sites | [201839](https://bugzilla.mozilla.org/show_bug.cgi?id=201839) | Disable JavaScript | *2003-04-18* |
| 42 | DOM | M1 to 1.3 | Read data from third-party sites | It's possible to read small amounts of data from pages from other hosts using the find() command; extremely slow and difficult in practice | [118657](https://bugzilla.mozilla.org/show_bug.cgi?id=118657) | Disable JavaScript | *2003-04-18* |
| 41 | DOM | M1 to 1.3 | Read data from third-party sites | A malicious script can steal data from third-party sites using event handlers | [201132](https://bugzilla.mozilla.org/show_bug.cgi?id=201132) | Disable JavaScript | *2003-04-17* |
| 40 | Java | M1 to 1.3 | Read local files | When Sun JRE is installed on the system, Java applets can read local files | [59767](https://bugzilla.mozilla.org/show_bug.cgi?id=59767) | Disable Java | *2003-04-03* |
| 39 | Buffer Overrun | M1 to 1.3 | Run arbitrary code | When Sun JRE 1.4.1 and earlier is installed on the system it may be possible to cause an exploitable buffer overrun calling from JavaScript into Java | [183092](https://bugzilla.mozilla.org/show_bug.cgi?id=183092) | Disable Java | *2003-03-31* |
| 38 | DOM | M1 to 1.3 | Reading limited data from 3rd-party websites | Getters/setters on script-defined properties in third-party pages can be read by scripts which allows limited data stealing | [92773](https://bugzilla.mozilla.org/show_bug.cgi?id=92773) | Disable JavaScript | *2003-03-06* |
| 37 | IRC/Mail | 0.8 to 1.2 | Make user send faked mail without knowing | The IRC protocol could be used to trick an SMTP server into sending mail in the user's name; works only if Chatzilla installed | [190532](https://bugzilla.mozilla.org/show_bug.cgi?id=190532) | None | *2003-02-04* |
| 36 | Spoofing | M1 to 1.2 | URLbar can display incorrect address | The HTTP 305 redirect command could be used by an attacker to spoof other sites' pages; only works when browsing through a proxy | [187996](https://bugzilla.mozilla.org/show_bug.cgi?id=187996) | Do not use proxy, or Check the Page Info dialog and lock icon before entering sensitive data on a web page | *2003-01-28* |
| 35 | Configurable Security Policies | M1 to 1.2 | Optional Configurable Security Policies can be bypassed | Using a username section in URL it is possible to bypass the user-created, optional configurable security policies | [189799](https://bugzilla.mozilla.org/show_bug.cgi?id=189799) | Do not add or change configurable security policies; the defaults are safe | *2003-01-24* |
| 34 | Spoofing | M1 to 1.0.1/1.2 | URLbar can display incorrect address | XUL can be used to make the URL bar display an incorrect address | [171274](https://bugzilla.mozilla.org/show_bug.cgi?id=171274) | Check the Page Info dialog and lock icon before entering sensitive data on a web page | *2003-01-10* |
| 33 | Networking | M1 to 1.2 | On some platforms use old cached data | Some non-tier1 platforms (BeOS) do not truncate cache files properly which could result in a page that is a mix of old and new, which could result in unwanted purchases | [162588](https://bugzilla.mozilla.org/show_bug.cgi?id=162588) | Clear cache before going to a page you have visited before | *2002-12-18* |
| 32 | XSLT | 0.8 to 1.2 | Reading XSLT files from known locations within a firewall | An XML file can load an XSLT stylesheet from a different host | [165532](https://bugzilla.mozilla.org/show_bug.cgi?id=165532) | Disable XSLT | *2002-12-03* |
| 31 | DOM | M1 to 1.0.1/1.1 | Arbitrarily modify or read another document | A script that calls document.write while another page is loading can steal data from a third-party site | [91043](https://bugzilla.mozilla.org/show_bug.cgi?id=91043) | Disable JavaScript | *2002-11-14* |

### February 2003 Update

| # | Type | Milestones Affected | Severity | Description | Bug Number(s) | Workarounds | Date Fixed |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 30 | Mail | M1 to 1.2 | Run arbitrary code | Upon receiving a malicious email message, double-clicking an attachment could allow an attacker to run arbitrary code. | [191817](https://bugzilla.mozilla.org/show_bug.cgi?id=191817) | Do not open attachments from untrusted sources | *2003-02-06* |
| 29 | Networking | 0.9.1 to 1.2 | Reading files from known locations within a firewall | By sending a "305 Redirect" message in response to a request, a malicious Web server can read files from within a firewall. | [187996](https://bugzilla.mozilla.org/show_bug.cgi?id=187996) | None | *2003-01-28* |
| 28 | Networking | M1 to 1.2 | Run arbitrary code | Following a link to a maliciously crafted .jar archive file could allow an attacker to run arbitrary code. | [164695](https://bugzilla.mozilla.org/show_bug.cgi?id=164695) | None | *2002-10-30* |
| 27 | Mail | M1 to 1.2 | Run arbitrary code | Connecting to a maliciously modified POP3 mail server could allow an attacker to run arbitrary code your computer. | [157644](https://bugzilla.mozilla.org/show_bug.cgi?id=157644) | Do not connect to untrusted POP3 mail servers | *2002-10-21* |
| 26 | Spoofing | 0.9.9 to 1.2 | Mistaking a malicious website for a legitimate one | wyciwyg:// URLs may be used to "spoof" the URL bar, causing it to display an incorrect URL | [159659](https://bugzilla.mozilla.org/show_bug.cgi?id=159659) | Check the Page Info dialog and lock icon before entering sensitive data on a web page | *2002-09-20* |

### Updates up to December 2002

| # | Type | Milestones Affected | Severity | Description | Bug Number(s) | Workarounds | Date Fixed |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | DOM | Through 1.0 RC1 | Local File Read | If a user visits a web site maintained by a hostile attacker, the attacker's web site can cause Mozilla to be redirected to a local file (or files) on the user's system in a way that allows the attacker to read file contents. | [141061](https://bugzilla.mozilla.org/show_bug.cgi?id=141061) | Disable JavaScript | 1-May-2002 |
| 2 | DOM | Through 0.9.5 | Read User Input (keystrokes) | If a user visits a web site maintained by a hostile attacker, the attacker's page can eavesdrop on keyboard events occurring in other windows. | [18553](https://bugzilla.mozilla.org/show_bug.cgi?id=18553) | Disable JavaScript | 4-Oct-2001 |
| 3 | Cookies | Through 1.0.1 | Read cookies set by another site | Various attacks involving the insertion of illegal characters into cookie data can cause other cookies set by a legitimate server to be sent to an attacker's server. Some of these attacks work only when browsing through a proxy server. | [104495](https://bugzilla.mozilla.org/show_bug.cgi?id=104495), [146094](https://bugzilla.mozilla.org/show_bug.cgi?id=146094) | Disable Cookies | 22-May-2002 |
| 4 | Script Insertion | Through 1.0.1 | Run arbitrary code | Various attacks involving the introduction of malicious scripts into dialogs that display information about the current page. When scripts from thes pages are inserted into dialogs, the scripts run with full system privileges. | [143420](https://bugzilla.mozilla.org/show_bug.cgi?id=143420), [144704](https://bugzilla.mozilla.org/show_bug.cgi?id=144704), [149777](https://bugzilla.mozilla.org/show_bug.cgi?id=149777), [123383](https://bugzilla.mozilla.org/show_bug.cgi?id=123383) | Do not click on "javascript:" links in dialogs, or bookmark them | 21-May-2002 |
| 5 | DOM | Through 0.9.5 | Modify browser settings | A malicious Web page can create key events which are interpreted by the browser as menu commands. | [108104](https://bugzilla.mozilla.org/show_bug.cgi?id=108104) | Disable JavaScript | 11-Mar-2002 |
| 6 | Networking | Through 1.0.1 | Modify or delete mail | A malicious Web page or mail message can contain an imap:// URL which can be used to issue arbitrary commands to an IMAP mail server | [127702](https://bugzilla.mozilla.org/show_bug.cgi?id=127702) | Disable JavaScript and do not click on imap: links | 20-May-2002 |
| 7 | Buffer Overrun | Through 1.0.1 | Run arbitrary code | Attaching a specially formatted file to a message can cause an exploitable buffer overrun | [140133](https://bugzilla.mozilla.org/show_bug.cgi?id=140133) | Do not attach files of unknown content to mail/news messages | 25-Apr-2002 |
| 8 | Networking | Through 1.0.1 | Denial of Access to Mail Account | Downloading a malicious email message can cause all future POP message downloads to fail, effectively denying access to a POP mail account until the malicious message ie removed by other means. | [144228](https://bugzilla.mozilla.org/show_bug.cgi?id=144228) | Do not use POP mail | 5-Jun-2002 |
| 9 | Buffer Overrun | Through 1.0.1 | Run arbitrary code | Viewing several types of malformed image files from a malicious web page could cause exploitable heap corruption | [155222](https://bugzilla.mozilla.org/show_bug.cgi?id=155222), [157989](https://bugzilla.mozilla.org/show_bug.cgi?id=157989) | Turn off images | 10-Jul-2002 |
| 10 | DOM | Through 1.0.1 | Modify arbitrary files | Viewing a malicious page could cause an install operation to occur when the space bar is pressed. | [161721](https://bugzilla.mozilla.org/show_bug.cgi?id=161721) | Disable JavaScript | 8-Aug-2002 |
| 11 | DOM | Through 1.0.2, 1.2 | Tracking of browsing | A malicious page can determine the URL of the page visited after it | [145579](https://bugzilla.mozilla.org/show_bug.cgi?id=145579) | Disable JavaScript | 17-Sep-2002 |
| 12 | DOM | Through 1.0.1 | Reading data from 3rd-party websites | A malicious page can read data from a third-party webpage (perhaps inside a firewall) using the XMLSerializer interface | [147754](https://bugzilla.mozilla.org/show_bug.cgi?id=147754) | Disable JavaScript | 14-Jun-2002 |
| 13 | DOM | 0.9.6 to 1.0.1/1.2 | Reading data from 3rd-party websites | A malicious page can read data from a third-party webpage using the DOM TreeWalker interface | [156452](https://bugzilla.mozilla.org/show_bug.cgi?id=156452) | Disable JavaScript | 1-Aug-2002 |
| 14 | DOM | 0.9.5 to 1.0.1/1.2 | Reading data from 3rd-party websites | A malicious page can read data from a third-party webpage (perhaps inside a firewall) using the XMLSerializer interface | [169982](https://bugzilla.mozilla.org/show_bug.cgi?id=169982) [147754](https://bugzilla.mozilla.org/show_bug.cgi?id=147754) | Disable JavaScript | 30-Sep-2002 |
| 15 | Networking | M17 to 1.0.1/1.2 | Deleting local files / run arbitrary code | Visiting a malicious URL with the vbscript: or vnd: protocol exposes Windows security problems and could be used to run arbitrary code. | [161357](https://bugzilla.mozilla.org/show_bug.cgi?id=161357), [163648](https://bugzilla.mozilla.org/show_bug.cgi?id=163648) | Disable JavaScript, do not visit vbscript: or vnd: URLs from untrusted sources | 10-Oct-2002 |
| 16 | Networking | 0.9.7 to 1.0.1/1.2 | Minor - saving sensitive data locally | A webpage created by a document.write command in a script on a secure page is stored in the browser cache even though the original page is not. This could cause private information to be saved on the local disk (the information is not accessible by a third party on the network) | [151478](https://bugzilla.mozilla.org/show_bug.cgi?id=151478) | Disable JavaScript | 21-Oct-2002 |
| 17 | DOM | M1 to 1.0.1/1.2 | Reading data from 3rd-party websites | A malicious Java applet can read data from a third-party webpage | [168316](https://bugzilla.mozilla.org/show_bug.cgi?id=168316) | Disable Java | 29-Oct-2002 |
| 18 | Networking | M1 to 1.0.1/1.2 | Reading passwords | "Princeton Attack" DNS spoofing can be used to steal passwords. The exploit requires many preconditions and is probably impractical for real use. | [162520](https://bugzilla.mozilla.org/show_bug.cgi?id=162520) | Do not store passwords | 30-Oct-2002 |
| 19 | Spoofing | M1 to 1.0.1/1.2 | Incorrect URL in URL bar | A malicious page can display a misleading URL in the browser URL bar | [171274](https://bugzilla.mozilla.org/show_bug.cgi?id=171274) | None | 4-Nov-2002 |
| 20 | DOM | 0.9.7 to 1.0.1/1.2 | Reading data from 3rd-party websites | A mailcious page can insert scripts or other content into a 3rd-party page and read or modify information. | [91043](https://bugzilla.mozilla.org/show_bug.cgi?id=91043) | Disable JavaScript | 14-Nov-2002 |
| 21 | XSLT | 0.9.1 to 1.0.1/1.2 | Reading XML files from 3rd party sites | A malicious page can read XML data from third-party websites using the XSLT processor | [113351](https://bugzilla.mozilla.org/show_bug.cgi?id=113351) | Disable JavaScript | 14-Jun-2002 |
| 22 | Password Mgr | M1 to 1.0.1/1.2 | Reading passwords | A malicious page can use a specially crafted javascript: URL to steal passwords the user has stored for other sites | [159484](https://bugzilla.mozilla.org/show_bug.cgi?id=159484) | Disable JavaScript | 30-Jul-2002 |
| 23 | DOM/Forms | M1 to 1.0.1/1.2 | Reading local files from known locations | Using a specially crafted form element name, a malicious page can set the value of a file upload form control, causing a file to be uploaded from the user's disk. | [162409](https://bugzilla.mozilla.org/show_bug.cgi?id=162409) | Disable JavaScript | 14-Aug-2002 |
| 24 | DOM/Forms | M1 to 1.0.1/1.2 | Reading local files from known locations | Using a specially crafted event object, a malicious page can set the value of a file upload form control, causing a file to be uploaded from the user's disk. | [164086](https://bugzilla.mozilla.org/show_bug.cgi?id=164086), [164023](https://bugzilla.mozilla.org/show_bug.cgi?id=164023), [163598](https://bugzilla.mozilla.org/show_bug.cgi?id=163598) | Disable JavaScript | 28-Aug-2002 |
| 25 | HTML | M1 to 1.0.1/1.2 | Loss of browser preferences | A malicious page can corrupt the Mozilla preferences file, causing user settings to be lost | [143459](https://bugzilla.mozilla.org/show_bug.cgi?id=143459) | None | 13-Sep-2002 |

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


