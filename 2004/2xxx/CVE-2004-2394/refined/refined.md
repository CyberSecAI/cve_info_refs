```
{
  "vulnerability": {
    "root_cause": "Multiple issues found during code review of the passwd program.",
    "weaknesses": [
      "Off-by-one error when processing stdin input leading to out-of-bounds write, specifically in the case of --stdin.",
      "Unchecked return code of the `read` function which can lead to writing to out-of-bounds memory on error.",
	    "Unchecked return code of `pam_start` function.",
      "Minor memory leaks."
    ],
    "impact": "Potential for program crash and/or undefined behavior due to out-of-bounds writes and memory leaks.",
    "attack_vectors": [
      "Specially crafted input via --stdin."
    ],
     "required_capabilities": "Ability to execute the passwd program, with the --stdin option or any input that results in calling the vulnerable read function, and ability to craft input that triggers the off-by-one error."
  }
}
```