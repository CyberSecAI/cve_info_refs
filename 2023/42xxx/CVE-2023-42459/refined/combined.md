=== Content from github.com_ba1f7c9e_20250115_095543.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fissues%2F3207)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fissues%2F3207)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=eProsima%2FFast-DDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eProsima](/eProsima)
/
**[Fast-DDS](/eProsima/Fast-DDS)**
Public

* [Notifications](/login?return_to=%2FeProsima%2FFast-DDS) You must be signed in to change notification settings
* [Fork
  791](/login?return_to=%2FeProsima%2FFast-DDS)
* [Star
   2.3k](/login?return_to=%2FeProsima%2FFast-DDS)

* [Code](/eProsima/Fast-DDS)
* [Issues
  53](/eProsima/Fast-DDS/issues)
* [Pull requests
  76](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects
  0](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

Additional navigation options

* [Code](/eProsima/Fast-DDS)
* [Issues](/eProsima/Fast-DDS/issues)
* [Pull requests](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FeProsima%2FFast-DDS%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FeProsima%2FFast-DDS%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [16784] Malformed DATA submessage leads to bad-free during SPDP #3207

Closed

1 task done

[squizz617](/squizz617) opened this issue
Jan 11, 2023
· 2 comments
 · Fixed by [#3824](https://github.com/eProsima/Fast-DDS/pull/3824)

Closed

1 task done

# [[16784] Malformed DATA submessage leads to bad-free during SPDP](#top) #3207

[squizz617](/squizz617) opened this issue
Jan 11, 2023
· 2 comments
 · Fixed by [#3824](https://github.com/eProsima/Fast-DDS/pull/3824)

Labels
[bug](/eProsima/Fast-DDS/labels/bug)
Issue to report a bug

## Comments

[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=80&v=4)](/squizz617)

Copy link

Contributor

### **[squizz617](/squizz617)** commented [Jan 11, 2023](#issue-1529646213)

| Is there an already existing issue for this?  * I have searched the existing issues  Expected behavior Malformed submessages should be handled properly. Current behavior  * Compiled with gcc 9.4.0:  ``` $ ./DDSHelloWorldExample publisher Starting  Publisher running 10 samples. free(): invalid pointer [1]    2257088 abort      ./DDSHelloWorldExample publisher  ```  * Compiled with ASAN + afl-clang-fast:  ``` $ ./DDSHelloWorldExample publisher  Starting  Publisher running 10 samples. ================================================================= 2023-01-11 14:43:46.492 [RTPS_MSG_IN Warning] (ID:140251965019904) Serialized Payload value invalid or larger than maximum allowed size(28160/0) -> Function proc_Submsg_Data ==2252002==ERROR: AddressSanitizer: attempting free on address which was not malloc()-ed: 0x63100001482c in thread T3     #0 0x4aa3d2 in free (/home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x4aa3d2)     #1 0x7f8efa4a5529 in eprosima::fastrtps::rtps::SerializedPayload_t::empty() /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/include/fastdds/rtps/common/SerializedPayload.h:158:13     #2 0x7f8efa4a5529 in eprosima::fastrtps::rtps::SerializedPayload_t::~SerializedPayload_t() /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/include/fastdds/rtps/common/SerializedPayload.h:92:15     #3 0x7f8efa4a5529 in eprosima::fastrtps::rtps::CacheChange_t::~CacheChange_t() /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/include/fastdds/rtps/common/CacheChange.h:184:5     #4 0x7f8efa59fb20 in eprosima::fastrtps::rtps::MessageReceiver::proc_Submsg_Data(eprosima::fastrtps::rtps::CDRMessage_t*, eprosima::fastrtps::rtps::SubmessageHeader_t*) const /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/messages/MessageReceiver.cpp:857:1     #5 0x7f8efa5994cf in eprosima::fastrtps::rtps::MessageReceiver::processCDRMsg(eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastrtps::rtps::CDRMessage_t*) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/messages/MessageReceiver.cpp:419:29     #6 0x7f8efa5d52e0 in eprosima::fastrtps::rtps::ReceiverResource::OnDataReceived(unsigned char const*, unsigned int, eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastrtps::rtps::Locator_t const&) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/network/ReceiverResource.cpp:132:14     #7 0x7f8efa85ac74 in eprosima::fastdds::rtps::UDPChannelResource::perform_listen_operation(eprosima::fastrtps::rtps::Locator_t) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/transport/UDPChannelResource.cpp:70:33     #8 0x7f8efa860bdf in void std::__invoke_impl<void, void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t>(std::__invoke_memfun_deref, void (eprosima::fastdds::rtps::UDPChannelResource::*&&)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*&&, eprosima::fastrtps::rtps::Locator_t&&) /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/invoke.h:73:14     #9 0x7f8efa860bdf in std::__invoke_result<void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t>::type std::__invoke<void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t>(void (eprosima::fastdds::rtps::UDPChannelResource::*&&)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*&&, eprosima::fastrtps::rtps::Locator_t&&) /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/invoke.h:95:14     #10 0x7f8efa860bdf in void std::thread::_Invoker<std::tuple<void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t> >::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/thread:244:13     #11 0x7f8efa860bdf in std::thread::_Invoker<std::tuple<void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t> >::operator()() /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/thread:251:11     #12 0x7f8efa860bdf in std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t> > >::_M_run() /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/thread:195:13     #13 0x7f8ef980cde3  (/lib/x86_64-linux-gnu/libstdc++.so.6+0xd6de3)     #14 0x7f8ef9cb2608 in start_thread /build/glibc-SzIz7B/glibc-2.31/nptl/pthread_create.c:477:8     #15 0x7f8ef94f7132 in clone /build/glibc-SzIz7B/glibc-2.31/misc/../sysdeps/unix/sysv/linux/x86_64/clone.S:95  0x63100001482c is located 44 bytes inside of 65500-byte region [0x631000014800,0x6310000247dc) allocated by thread T0 here:     #0 0x4aa63d in malloc (/home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x4aa63d)     #1 0x7f8efa859706 in eprosima::fastrtps::rtps::CDRMessage_t::CDRMessage_t(unsigned int) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/include/fastdds/rtps/common/CDRMessage_t.h:79:30     #2 0x7f8efa859706 in eprosima::fastdds::rtps::ChannelResource::ChannelResource(unsigned int) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/transport/ChannelResource.cpp:45:7  Thread T3 created by T0 here:     #0 0x49499c in pthread_create (/home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x49499c)     #1 0x7f8ef980d0a8 in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/lib/x86_64-linux-gnu/libstdc++.so.6+0xd70a8)     #2 0x7f8efa91a964 in eprosima::fastdds::rtps::UDPTransportInterface::CreateInputChannelResource(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, eprosima::fastrtps::rtps::Locator_t const&, bool, unsigned int, eprosima::fastdds::rtps::TransportReceiverInterface*) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/transport/UDPTransportInterface.cpp:233:50     #3 0x7f8efa920142 in eprosima::fastdds::rtps::UDPTransportInterface::OpenAndBindInputSockets(eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastdds::rtps::TransportReceiverInterface*, bool, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/transport/UDPTransportInterface.cpp:207:34     #4 0x7f8efa8b53cd in eprosima::fastdds::rtps::UDPv4Transport::OpenInputChannel(eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastdds::rtps::TransportReceiverInterface*, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/transport/UDPv4Transport.cpp:327:19     #5 0x7f8efa5d3d86 in eprosima::fastrtps::rtps::ReceiverResource::ReceiverResource(eprosima::fastdds::rtps::TransportInterface&, eprosima::fastrtps::rtps::Locator_t const&, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/network/ReceiverResource.cpp:43:24     #6 0x7f8efa5ca610 in eprosima::fastrtps::rtps::NetworkFactory::BuildReceiverResources(eprosima::fastrtps::rtps::Locator_t&, std::vector<std::shared_ptr<eprosima::fastrtps::rtps::ReceiverResource>, std::allocator<std::shared_ptr<eprosima::fastrtps::rtps::ReceiverResource> > >&, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/network/NetworkFactory.cpp:74:25     #7 0x7f8efa5e1516 in eprosima::fastrtps::rtps::RTPSParticipantImpl::createReceiverResources(eprosima::fastdds::rtps::LocatorList&, bool, bool) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/participant/RTPSParticipantImpl.cpp:1680:38     #8 0x7f8efa5db29a in eprosima::fastrtps::rtps::RTPSParticipantImpl::RTPSParticipantImpl(unsigned int, eprosima::fastrtps::rtps::RTPSParticipantAttributes const&, eprosima::fastrtps::rtps::GuidPrefix_t const&, eprosima::fastrtps::rtps::GuidPrefix_t const&, eprosima::fastrtps::rtps::RTPSParticipant*, eprosima::fastrtps::rtps::RTPSParticipantListener*) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/participant/RTPSParticipantImpl.cpp:354:5     #9 0x7f8efa5e3c53 in eprosima::fastrtps::rtps::RTPSParticipantImpl::RTPSParticipantImpl(unsigned int, eprosima::fastrtps::rtps::RTPSParticipantAttributes const&, eprosima::fastrtps::rtps::GuidPrefix_t const&, eprosima::fastrtps::rtps::RTPSParticipant*, eprosima::fastrtps::rtps::RTPSParticipantListener*) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/rtps/participant/RTPSParticipantImpl.cpp:449:7     #10 0x7f8efa7f1b8a in eprosima::fastdds::dds::DomainParticipantImpl::enable() /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/fastdds/domain/DomainParticipantImpl.cpp:268:16     #11 0x7f8efb07cf80 in eprosima::fastdds::statistics::dds::DomainParticipantImpl::enable() /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/statistics/fastdds/domain/DomainParticipantImpl.cpp:253:52     #12 0x7f8efa82c8d7 in eprosima::fastdds::dds::DomainParticipant::enable() /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/src/cpp/fastdds/domain/DomainParticipant.cpp:110:36     #13 0x4e3b08 in HelloWorldPublisher::init(bool) /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/examples/cpp/dds/HelloWorldExample/HelloWorldPublisher.cpp:66:29     #14 0x514bd6 in main /home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/examples/cpp/dds/HelloWorldExample/HelloWorld_main.cpp:309:23     #15 0x7f8ef93fc082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16  SUMMARY: AddressSanitizer: bad-free (/home/seulbae/ddssecurity/targets/fastdds-290-afl/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x4aa3d2) in free ==2252002==ABORTING  ``` Steps to reproduce  1. Run `DDSHelloWorldExample`. Publisher/subscriber doesn't matter as the bug is in the discovery layer.  ``` $ cd path/to/fastdds_colcon_workspace/ $ source install/setup.sh $ cd src/fastrtps/examples/cpp/dds/HelloWorldExample $ ./DDSHelloWorldExample publisher  ```  2. Send the following RTPS submessage to a relevant discovery recipient, e.g., `239.255.0.1:7400`.  ``` 0000  45 00 00 4C 00 01 40 00 40 11 D9 92 80 3D F0 CF  E..L..@.@....=..                                                                                                                        0010  EF FF 00 01 05 39 1C E8 00 38 BC EC 52 54 50 53  .....9...8..RTPS                                                                                                                        0020  02 04 01 0F 01 03 02 42 AC 11 00 02 45 E5 E2 FD  .......B....E...                                                                                                                        0030  15 17 18 00 00 00 10 92 00 00 00 00 00 01 00 C2  ................                                                                                                                        0040  00 00 00 00 02 00 00 00 01 00 00 00              ............  ```  This packet is also available in the attached pcap down below. The Data Submessage begins at offset 0x30.  Scapy dissector for rtps interprets the submessage as:  ``` ###[ RTPS Message ]###             \submessages\             |###[ RTPS DATA (0x15) ]###              |  submessageId= 0x15             |  submessageFlags= 0x17             |  octetsToNextHeader= 24             |  extraFlags= 0x0             |  octetsToInlineQoS= 37392             |  readerEntityIdKey= 0x0             |  readerEntityIdKind= 0x0             |  writerEntityIdKey= 0x100             |  writerEntityIdKind= 0xc2             |  writerSeqNumHi= 0             |  writerSeqNumLow= 2             |  \inlineQoS \             |   |###[ Inline QoS ]###              |   |  \parameters\             |   |  \sentinel  \             |   |   |###[ PID_SENTINEL ]###              |   |   |  parameterId= 0x1             |   |   |  parameterLength= 0             |   |   |  parameterData= ''             |  data      = ''  ```  The same bug can be triggered by sending the same Data submessage with `octetsToNextHeader = 0` instead of `24`.   3. `DDSHelloWorldExample` crashes. Please refer to the ASAN error message posted in the "Current behavior" section.  Fast DDS version/commit Found on commit [0ee59f6](https://github.com/eProsima/Fast-DDS/commit/0ee59f6b5f9b745b6db9f8b5e2d4f5dca52a0e83). Also tested on v2.9.0 ([4c55488](https://github.com/eProsima/Fast-DDS/commit/4c55488d6225283b2e2114438a1bd726411876e7)). Platform/Architecture Ubuntu Focal 20.04 amd64 Transport layer Default configuration, UDPv4 & SHM Additional context *No response* XML configuration file *No response* Relevant log output *No response* Network traffic capture PCAP: [fastdds-bad\_free.zip](https://github.com/eProsima/Fast-DDS/files/10395658/fastdds-bad_free.zip) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617)
[squizz617](/squizz617)
added
the
[triage](/eProsima/Fast-DDS/labels/triage)
Issue pending classification
label
[Jan 11, 2023](#event-8205202605)

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)
[MiguelCompany](/MiguelCompany)
changed the title
~~Malformed DATA submessage leads to bad-free during SPDP~~
[16784] Malformed DATA submessage leads to bad-free during SPDP
[Jan 12, 2023](#event-8209680786)

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=80&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)

Copy link

Member

### **[MiguelCompany](/MiguelCompany)** commented [Jan 12, 2023](#issuecomment-1380114500)

| [@squizz617](https://github.com/squizz617) Thanks for the report. With all the provided details, I think we should be able to create a regression test. |
| --- |

All reactions

Sorry, something went wrong.

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)
[MiguelCompany](/MiguelCompany)
added
[bug](/eProsima/Fast-DDS/labels/bug)
Issue to report a bug
and removed
[triage](/eProsima/Fast-DDS/labels/triage)
Issue pending classification
labels
[Jan 12, 2023](#event-8209872711)

[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=80&v=4)](/squizz617)

Copy link

Contributor

Author

### **[squizz617](/squizz617)** commented [May 19, 2023](#issuecomment-1554515992)

| Hi [@MiguelCompany](https://github.com/MiguelCompany), have you had any chance to look into this? It's been quite a while since this report was made, and I would like to request a CVE ID for this. Thank you. |
| --- |

All reactions

Sorry, something went wrong.

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)
[MiguelCompany](/MiguelCompany)
mentioned this issue
[Sep 1, 2023](#ref-pullrequest-1877032118)

[[19416] Fix bad-free when receiving malformed DATA submessage
#3824](/eProsima/Fast-DDS/pull/3824)
 Merged

10 tasks

[![@EduPonz](https://avatars.githubusercontent.com/u/7962388?s=40&u=70f8a6767c2b33a873154533a83860f2eadcda40&v=4)](/EduPonz)
[EduPonz](/EduPonz)
closed this as [completed](/eProsima/Fast-DDS/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#3824](/eProsima/Fast-DDS/pull/3824)
[Sep 20, 2023](#event-10418575734)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fissues%2F3207)

Assignees

No one assigned

Labels

[bug](/eProsima/Fast-DDS/labels/bug)
Issue to report a bug

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [[19416] Fix bad-free when receiving malformed DATA submessage](/eProsima/Fast-DDS/pull/3824)
 [eProsima/Fast-DDS](/eProsima/Fast-DDS)

2 participants

[![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=52&v=4)](/squizz617) [![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=52&v=4)](/MiguelCompany)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.debian.org_bc213362_20250115_095545.html ===


---

[[Date Prev](msg00263.html)][[Date Next](msg00265.html)]
[[Thread Prev](msg00263.html)][[Thread Next](msg00265.html)]
[[Date Index](maillist.html#00264)]
[[Thread Index](threads.html#00264)]

# [SECURITY] [DSA 5568-1] fastdds security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5568-1] fastdds security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Mon, 27 Nov 2023 19:20:37 +0000
* *Message-id*: <[[🔎]](/msgid-search/ZWTsBcZQpG8V1xy2%40seger.debian.org) [ZWTsBcZQpG8V1xy2@seger.debian.org](msg00264.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5568-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
November 27, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : fastdds
CVE ID         : CVE-2023-42459
Debian Bug     : 1054163

It was discovered that incorrect memory management in Fast DDS, a C++
implementation of the DDS (Data Distribution Service) might result in
denial of service.

The oldstable distribution (bullseye) is not affected.

For the stable distribution (bookworm), this problem has been fixed in
version 2.9.1+ds-1+deb12u2.

We recommend that you upgrade your fastdds packages.

For the detailed security status of fastdds please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/fastdds>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmVk6wsACgkQEMKTtsN8
Tja2FRAAqpa1Zek52KcYiyQSucpEe6ZLajVfzKeGKvieFrfcf491GDYno3sQhF5w
2uWRyZ3I1OjJk9uuFWj4ql2IwNs3nudefqR8OCEQk4oSZfnWBX4UWTMiuCncE1+g
YobKkoWlGDGjpS36lT/GX+L9nfq46ERgZYPqQJjLb6xU+vJzGMo29LVGVDliF4VX
5n7DZlVbnAWb+swXPp0sIIV/F5EPpdgbygisPSAVynCxF4eFqxQfiCOpkXkBdzKF
27RSsJQJggfDaXiz11t8zkhWWJQU3pDyrRn79NfkyXc0IPNH4q2C0+vQZ4bHQLFD
8NuoQqZ5Olqx9Z742z8+jXWpphP7nvEcEhItNFnZNE3EBqJ8T8Aum1NWC4vRSQIR
8G/Ii9pd8dU7yTBGNbTSqyM8yTzMu4oEuvT309YVC4q3E2P51ZwUpgr7edPZRsXy
+T8DgzVGgyB+iSVhxmmlUK0encc9O3JfVb0a8mCfM2DUSICJCTkXPYpZB5N4En57
g8P/AF2u74Rq/y/SFwoJAZyE789wXDQOLTZJSQBmFbCSL+mLNe/8W8ZAl75TS2fE
2YulahAVceLuy64TLXnOGNHmUiWFeoSY7Ad/NSQyjpCssPP7VcC5sJC94YgEsFey
2/0mf72nviY4cT5K7D8f2cVnTR74Tc4ICVxbe2SMect/x8IRP/E=
=eh2N
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_e4400fc4_20250115_095544.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fpull%2F3824)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fpull%2F3824)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=eProsima%2FFast-DDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eProsima](/eProsima)
/
**[Fast-DDS](/eProsima/Fast-DDS)**
Public

* [Notifications](/login?return_to=%2FeProsima%2FFast-DDS) You must be signed in to change notification settings
* [Fork
  791](/login?return_to=%2FeProsima%2FFast-DDS)
* [Star
   2.3k](/login?return_to=%2FeProsima%2FFast-DDS)

* [Code](/eProsima/Fast-DDS)
* [Issues
  53](/eProsima/Fast-DDS/issues)
* [Pull requests
  76](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects
  0](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

Additional navigation options

* [Code](/eProsima/Fast-DDS)
* [Issues](/eProsima/Fast-DDS/issues)
* [Pull requests](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FeProsima%2FFast-DDS%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FeProsima%2FFast-DDS%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [19416] Fix bad-free when receiving malformed DATA submessage #3824

 Merged

[EduPonz](/EduPonz)
merged 9 commits into
[master](/eProsima/Fast-DDS/tree/master "eProsima/Fast-DDS:master")
from
[bugfix/16784](/eProsima/Fast-DDS/tree/bugfix/16784 "eProsima/Fast-DDS:bugfix/16784")

Sep 20, 2023

 Merged

# [[19416] Fix bad-free when receiving malformed DATA submessage](#top) #3824

[EduPonz](/EduPonz)
merged 9 commits into
[master](/eProsima/Fast-DDS/tree/master "eProsima/Fast-DDS:master")
from
[bugfix/16784](/eProsima/Fast-DDS/tree/bugfix/16784 "eProsima/Fast-DDS:bugfix/16784")

Sep 20, 2023

+203

−5

[Conversation
13](/eProsima/Fast-DDS/pull/3824)
[Commits
9](/eProsima/Fast-DDS/pull/3824/commits)
[Checks
0](/eProsima/Fast-DDS/pull/3824/checks)
[Files changed
6](/eProsima/Fast-DDS/pull/3824/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=60&v=4)](/MiguelCompany)

Copy link

Member

### @MiguelCompany **[MiguelCompany](/MiguelCompany)** commented [Sep 1, 2023](#issue-1877032118) • edited by EduPonz Loading

## Description

This PR:

* Adds a custom transport that enables injecting arbitrary RTPS datagrams
* Adds a black-box test that reads RTPS datagrams from binary files and injects them using the new transport
* Adds a regression datagram for [[16784] Malformed DATA submessage leads to bad-free during SPDP #3207](https://github.com/eProsima/Fast-DDS/issues/3207)
* Fixes [[16784] Malformed DATA submessage leads to bad-free during SPDP #3207](https://github.com/eProsima/Fast-DDS/issues/3207)

[@Mergifyio](https://github.com/Mergifyio) backport 2.11.x 2.10.x 2.6.x

## Contributor Checklist

* Commit messages follow the project guidelines.
* The code follows the style guidelines of this project.
* Tests that thoroughly check the new feature have been added/Regression tests checking the bug and its fix have been added; the added tests pass locally
* **N/A** Any new/modified methods have been properly documented using Doxygen.
* Changes are ABI compatible.
* Changes are API compatible.
* **N/A** New feature has been added to the `versions.md` file (if applicable).
* **N/A** New feature has been documented/Current behavior is correctly described in the documentation.
* Applicable backports have been included in the description.

## Reviewer Checklist

* The PR has a milestone assigned.
* Check contributor checklist is correct.
* Check CI results: changes do not issue any warning.
* Check CI results: failing tests are unrelated with the changes.

Sorry, something went wrong.

All reactions

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)
[MiguelCompany](/MiguelCompany)
added this to the [v2.12.0](/eProsima/Fast-DDS/milestone/50) milestone
[Sep 1, 2023](#event-10254928732)

 [![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)
[MiguelCompany](/MiguelCompany)
[force-pushed](/eProsima/Fast-DDS/compare/57b6423c1e992025d1e35d8aef84082d402c6b18..143f69f898e3a8c3449ab57f4d1c7cd12c6bc204)
the
bugfix/16784

branch
from
[`57b6423`](/eProsima/Fast-DDS/commit/57b6423c1e992025d1e35d8aef84082d402c6b18) to
[`143f69f`](/eProsima/Fast-DDS/commit/143f69f898e3a8c3449ab57f4d1c7cd12c6bc204)  [Compare](/eProsima/Fast-DDS/compare/57b6423c1e992025d1e35d8aef84082d402c6b18..143f69f898e3a8c3449ab57f4d1c7cd12c6bc204)
[September 1, 2023 09:07](#event-10255012157)

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=80&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)

Copy link

Member

Author

### **[MiguelCompany](/MiguelCompany)** commented [Sep 1, 2023](#issuecomment-1702423612)

| [@richiprosima](https://github.com/richiprosima) Please test this |
| --- |

All reactions

Sorry, something went wrong.

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=80&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)

Copy link

Member

Author

### **[MiguelCompany](/MiguelCompany)** commented [Sep 2, 2023](#issuecomment-1703811667)

| [@richiprosima](https://github.com/richiprosima) Please test mac |
| --- |

All reactions

Sorry, something went wrong.

 [![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)
[MiguelCompany](/MiguelCompany)
[force-pushed](/eProsima/Fast-DDS/compare/0c5c6d21221a73e5fae206c32227148cf72415c1..b1b5384d0523d3156f71c775bd754df936cf9ea4)
the
bugfix/16784

branch
from
[`0c5c6d2`](/eProsima/Fast-DDS/commit/0c5c6d21221a73e5fae206c32227148cf72415c1) to
[`b1b5384`](/eProsima/Fast-DDS/commit/b1b5384d0523d3156f71c775bd754df936cf9ea4)  [Compare](/eProsima/Fast-DDS/compare/0c5c6d21221a73e5fae206c32227148cf72415c1..b1b5384d0523d3156f71c775bd754df936cf9ea4)
[September 4, 2023 06:42](#event-10270035442)

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=80&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)

Copy link

Member

Author

### **[MiguelCompany](/MiguelCompany)** commented [Sep 4, 2023](#issuecomment-1704708094)

| [@richiprosima](https://github.com/richiprosima) Please test this |
| --- |

All reactions

Sorry, something went wrong.

[![EduPonz](https://avatars.githubusercontent.com/u/7962388?s=60&v=4)](/EduPonz)

**[EduPonz](/EduPonz)**
suggested changes
[Sep 19, 2023](#pullrequestreview-1632863545)

 [View reviewed changes](/eProsima/Fast-DDS/pull/3824/files)

Copy link

### @EduPonz **[EduPonz](/EduPonz)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

A much needed tool indeed!

Just a some NITs.

Sorry, something went wrong.

All reactions

[test/blackbox/common/BlackboxTestsTransportUDP.cpp](/eProsima/Fast-DDS/pull/3824/files#diff-f6f447b60e72b9b44d77465d8173bafa383538761f7b27636b0a698c731abade)
Outdated

Show resolved

Hide resolved

[test/blackbox/common/DatagramInjectionTransport.hpp](/eProsima/Fast-DDS/pull/3824/files#diff-1751231ec7f565f01bfa99b9a753d34b732d6edebb4ca76f216885bf91230919)
Outdated

Show resolved

Hide resolved

[src/cpp/rtps/messages/MessageReceiver.cpp](/eProsima/Fast-DDS/pull/3824/files#diff-436a2b64d403d10fdfa858b783b6c7b1a264b7b1ef68f7c19e207f21c0c8f2ed)

Show resolved

Hide resolved

 [MiguelCompany](/MiguelCompany)
added 9 commits
[September 19, 2023 13:13](#commits-pushed-8b3bd39)

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&v=4)](/MiguelCompany)

`[Refs #16784. Added basic custom chaining transport.](/eProsima/Fast-DDS/pull/3824/commits/8b3bd3997f27a6b0cdd760ed1519349299c68ec2 "Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>")`
 …

`[8b3bd39](/eProsima/Fast-DDS/pull/3824/commits/8b3bd3997f27a6b0cdd760ed1519349299c68ec2)`

```
Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
```

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&v=4)](/MiguelCompany)

`[Refs #16784. Use custom transport to get list of receiver interfaces.](/eProsima/Fast-DDS/pull/3824/commits/960c3d69ed7e52b2bca7dfcaf942990b8cd37f78 "Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>")`
 …

`[960c3d6](/eProsima/Fast-DDS/pull/3824/commits/960c3d69ed7e52b2bca7dfcaf942990b8cd37f78)`

```
Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
```

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&v=4)](/MiguelCompany)

`[Refs #16784. Added regression file.](/eProsima/Fast-DDS/pull/3824/commits/15a25277ecd3f496ecabbedfb19da405ecc2833f "Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>")`
 …

`[15a2527](/eProsima/Fast-DDS/pull/3824/commits/15a25277ecd3f496ecabbedfb19da405ecc2833f)`

```
Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
```

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&v=4)](/MiguelCompany)

`[Refs #16784. Processing regression files.](/eProsima/Fast-DDS/pull/3824/commits/1481a81c76ffba2baefd43767e79b095bdcb9287 "Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>")`
 …

`[1481a81](/eProsima/Fast-DDS/pull/3824/commits/1481a81c76ffba2baefd43767e79b095bdcb9287)`

```
Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
```

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&v=4)](/MiguelCompany)

`[Refs #16784. Separation of transport and descriptor.](/eProsima/Fast-DDS/pull/3824/commits/2b783bda06abf77904a5dac749c1f743f719f98f "Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>")`
 …

`[2b783bd](/eProsima/Fast-DDS/pull/3824/commits/2b783bda06abf77904a5dac749c1f743f719f98f)`

```
Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
```

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&v=4)](/MiguelCompany)

`[Refs #16784. Small refactor.](/eProsima/Fast-DDS/pull/3824/commits/ee76c49369436221fa710f89285545934f2a37a9 "Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>")`
 …

`[ee76c49](/eProsima/Fast-DDS/pull/3824/commits/ee76c49369436221fa710f89285545934f2a37a9)`

```
Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
```

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&v=4)](/MiguelCompany)

`[Refs #16784. Fix issue.](/eProsima/Fast-DDS/pull/3824/commits/6fdbe790fe814c8799860bf896742bae58b7bf35 "Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>")`
 …

`[6fdbe79](/eProsima/Fast-DDS/pull/3824/commits/6fdbe790fe814c8799860bf896742bae58b7bf35)`

```
Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
```

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&v=4)](/MiguelCompany)

`[Refs #19416. Fix build error in Mac.](/eProsima/Fast-DDS/pull/3824/commits/ee95b877caf08e2e3e4b373ab5dba6ac4bcfcb2b "Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>")`
 …

`[ee95b87](/eProsima/Fast-DDS/pull/3824/commits/ee95b877caf08e2e3e4b373ab5dba6ac4bcfcb2b)`

```
Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
```

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&v=4)](/MiguelCompany)

`[Refs #19416. Fix include order.](/eProsima/Fast-DDS/pull/3824/commits/34f764b94648ac77574fa94ea17e5d496461b263 "Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>")`
 …

`[34f764b](/eProsima/Fast-DDS/pull/3824/commits/34f764b94648ac77574fa94ea17e5d496461b263)`

```
Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
```

 [![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)
[MiguelCompany](/MiguelCompany)
[force-pushed](/eProsima/Fast-DDS/compare/f9e5499cb9a07939be4435126ad7c4c2f35d7ac9..34f764b94648ac77574fa94ea17e5d496461b263)
the
bugfix/16784

branch
from
[`f9e5499`](/eProsima/Fast-DDS/commit/f9e5499cb9a07939be4435126ad7c4c2f35d7ac9) to
[`34f764b`](/eProsima/Fast-DDS/commit/34f764b94648ac77574fa94ea17e5d496461b263)  [Compare](/eProsima/Fast-DDS/compare/f9e5499cb9a07939be4435126ad7c4c2f35d7ac9..34f764b94648ac77574fa94ea17e5d496461b263)
[September 19, 2023 11:14](#event-10409130848)

[![EduPonz](https://avatars.githubusercontent.com/u/7962388?s=60&v=4)](/EduPonz)

**[EduPonz](/EduPonz)**
approved these changes
[Sep 19, 2023](#pullrequestreview-1633125712)

 [View reviewed changes](/eProsima/Fast-DDS/pull/3824/files/34f764b94648ac77574fa94ea17e5d496461b263)

[![@EduPonz](https://avatars.githubusercontent.com/u/7962388?s=80&u=70f8a6767c2b33a873154533a83860f2eadcda40&v=4)](/EduPonz)

Copy link

### **[EduPonz](/EduPonz)** commented [Sep 19, 2023](#issuecomment-1725401333)

| [@richiprosima](https://github.com/richiprosima) please test this |
| --- |

All reactions

Sorry, something went wrong.

[![@EduPonz](https://avatars.githubusercontent.com/u/7962388?s=40&u=70f8a6767c2b33a873154533a83860f2eadcda40&v=4)](/EduPonz)
[EduPonz](/EduPonz)
merged commit [`47fe5d7`](/eProsima/Fast-DDS/commit/47fe5d7636769706fcf71bf7d183c34c64837e37)
into
master

[Sep 20, 2023](https://github.com/eProsima/Fast-DDS/pull/3824#event-10418575501)

 [![@EduPonz](https://avatars.githubusercontent.com/u/7962388?s=40&u=70f8a6767c2b33a873154533a83860f2eadcda40&v=4)](/EduPonz)
[EduPonz](/EduPonz)
deleted the
bugfix/16784

branch
[September 20, 2023 06:31](#event-10418575701)

[![@EduPonz](https://avatars.githubusercontent.com/u/7962388?s=80&u=70f8a6767c2b33a873154533a83860f2eadcda40&v=4)](/EduPonz)

Copy link

### **[EduPonz](/EduPonz)** commented [Sep 20, 2023](#issuecomment-1727083512)

| [@Mergifyio](https://github.com/Mergifyio) backport 2.11.x 2.10.x 2.6.x |
| --- |

 👍
1
 mergify[bot] reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@mergify](https://avatars.githubusercontent.com/in/10562?s=80&v=4)](/apps/mergify)

Copy link

Contributor

### **[mergify](/apps/mergify) bot** commented [Sep 20, 2023](#issuecomment-1727083624) • edited Loading

| backport 2.11.x 2.10.x 2.6.x ✅ Backports have been created  * [#3860 [19416] Fix bad-free when receiving malformed DATA submessage (backport #3824)](https://github.com/eProsima/Fast-DDS/pull/3860) has been created for branch `2.11.x` * [#3861 [19416] Fix bad-free when receiving malformed DATA submessage (backport #3824)](https://github.com/eProsima/Fast-DDS/pull/3861) has been created for branch `2.10.x` * [#3862 [19416] Fix bad-free when receiving malformed DATA submessage (backport #3824)](https://github.com/eProsima/Fast-DDS/pull/3862) has been created for branch `2.6.x` but encountered conflicts |
| --- |

All reactions

Sorry, something went wrong.

[mergify](/apps/mergify) bot
pushed a commit
that referenced
this pull request
[Sep 20, 2023](#ref-commit-ce1b7fe)
[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany) [![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify)

`[Fix bad-free when receiving malformed DATA submessage (](/eProsima/Fast-DDS/commit/ce1b7fe693795611d28972aa209ed50f30d7842c "Fix bad-free when receiving malformed DATA submessage (#3824)

* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit 47fe5d7636769706fcf71bf7d183c34c64837e37)")[#3824](https://github.com/eProsima/Fast-DDS/pull/3824)[)](/eProsima/Fast-DDS/commit/ce1b7fe693795611d28972aa209ed50f30d7842c "Fix bad-free when receiving malformed DATA submessage (#3824)

* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit 47fe5d7636769706fcf71bf7d183c34c64837e37)")`
…

`[ce1b7fe](/eProsima/Fast-DDS/commit/ce1b7fe693795611d28972aa209ed50f30d7842c)`

```
* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit [47fe5d7](https://github.com/eProsima/Fast-DDS/commit/47fe5d7636769706fcf71bf7d183c34c64837e37))
```

[![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/apps/mergify)
[mergify](/apps/mergify)
bot
mentioned this pull request
[Sep 20, 2023](#ref-pullrequest-1904296649)

[[19416] Fix bad-free when receiving malformed DATA submessage (backport #3824)
#3860](/eProsima/Fast-DDS/pull/3860)
 Merged

[mergify](/apps/mergify) bot
pushed a commit
that referenced
this pull request
[Sep 20, 2023](#ref-commit-ede98de)
[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany) [![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify)

`[Fix bad-free when receiving malformed DATA submessage (](/eProsima/Fast-DDS/commit/ede98deb659d84b74695efc0ffecc4031e521885 "Fix bad-free when receiving malformed DATA submessage (#3824)

* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit 47fe5d7636769706fcf71bf7d183c34c64837e37)")[#3824](https://github.com/eProsima/Fast-DDS/pull/3824)[)](/eProsima/Fast-DDS/commit/ede98deb659d84b74695efc0ffecc4031e521885 "Fix bad-free when receiving malformed DATA submessage (#3824)

* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit 47fe5d7636769706fcf71bf7d183c34c64837e37)")`
…

`[ede98de](/eProsima/Fast-DDS/commit/ede98deb659d84b74695efc0ffecc4031e521885)`

```
* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit [47fe5d7](https://github.com/eProsima/Fast-DDS/commit/47fe5d7636769706fcf71bf7d183c34c64837e37))
```

[![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/apps/mergify)
[mergify](/apps/mergify)
bot
mentioned this pull request
[Sep 20, 2023](#ref-pullrequest-1904296706)

[[19416] Fix bad-free when receiving malformed DATA submessage (backport #3824)
#3861](/eProsima/Fast-DDS/pull/3861)
 Merged

[mergify](/apps/mergify) bot
pushed a commit
that referenced
this pull request
[Sep 20, 2023](#ref-commit-e6abae9)
[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany) [![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify)

`[Fix bad-free when receiving malformed DATA submessage (](/eProsima/Fast-DDS/commit/e6abae92f7e353b6aeca89fdc364fd3e0be3a7b7 "Fix bad-free when receiving malformed DATA submessage (#3824)

* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit 47fe5d7636769706fcf71bf7d183c34c64837e37)

# Conflicts:
#	src/cpp/rtps/messages/MessageReceiver.cpp
#	test/blackbox/CMakeLists.txt")[#3824](https://github.com/eProsima/Fast-DDS/pull/3824)[)](/eProsima/Fast-DDS/commit/e6abae92f7e353b6aeca89fdc364fd3e0be3a7b7 "Fix bad-free when receiving malformed DATA submessage (#3824)

* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit 47fe5d7636769706fcf71bf7d183c34c64837e37)

# Conflicts:
#	src/cpp/rtps/messages/MessageReceiver.cpp
#	test/blackbox/CMakeLists.txt")`
…

`[e6abae9](/eProsima/Fast-DDS/commit/e6abae92f7e353b6aeca89fdc364fd3e0be3a7b7)`

```
* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit [47fe5d7](https://github.com/eProsima/Fast-DDS/commit/47fe5d7636769706fcf71bf7d183c34c64837e37))

# Conflicts:
#	src/cpp/rtps/messages/MessageReceiver.cpp
#	test/blackbox/CMakeLists.txt
```

[![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/apps/mergify)
[mergify](/apps/mergify)
bot
mentioned this pull request
[Sep 20, 2023](#ref-pullrequest-1904297009)

[[19416] Fix bad-free when receiving malformed DATA submessage (backport #3824)
#3862](/eProsima/Fast-DDS/pull/3862)
 Merged

[MiguelCompany](/MiguelCompany)
added a commit
that referenced
this pull request
[Sep 21, 2023](#ref-commit-ce414c8)
[![@mergify](https://avatars.githubusercontent.com/in/10562?s=40&v=4)](/marketplace/mergify) [![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=40&u=ce8c3186cb89acbd67321779ec0265209da35c6c&v=4)](/MiguelCompany)

`[Fix bad-free when receiving malformed DATA submessage (](/eProsima/Fast-DDS/commit/ce414c849214ce0b9751dcd696d008d019ca8be0 "Fix bad-free when receiving malformed DATA submessage (#3862)

* Fix bad-free when receiving malformed DATA submessage (#3824)

* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit 47fe5d7636769706fcf71bf7d183c34c64837e37)

# Conflicts:
#	src/cpp/rtps/messages/MessageReceiver.cpp
#	test/blackbox/CMakeLists.txt

* Fixed conflicts

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
Co-authored-by: Miguel Company <miguelcompany@eprosima.com>")[#3862](https://github.com/eProsima/Fast-DDS/pull/3862)[)](/eProsima/Fast-DDS/commit/ce414c849214ce0b9751dcd696d008d019ca8be0 "Fix bad-free when receiving malformed DATA submessage (#3862)

* Fix bad-free when receiving malformed DATA submessage (#3824)

* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit 47fe5d7636769706fcf71bf7d183c34c64837e37)

# Conflicts:
#	src/cpp/rtps/messages/MessageReceiver.cpp
#	test/blackbox/CMakeLists.txt

* Fixed conflicts

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
Co-authored-by: Miguel Company <miguelcompany@eprosima.com>")`
…

`[ce414c8](/eProsima/Fast-DDS/commit/ce414c849214ce0b9751dcd696d008d019ca8be0)`

```
* Fix bad-free when receiving malformed DATA submessage ([#3824](https://github.com/eProsima/Fast-DDS/pull/3824))

* Refs #16784. Added basic custom chaining transport.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Use custom transport to get list of receiver interfaces.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Added regression file.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Processing regression files.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Separation of transport and descriptor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Small refactor.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #16784. Fix issue.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix build error in Mac.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

* Refs #19416. Fix include order.

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
(cherry picked from commit [47fe5d7](https://github.com/eProsima/Fast-DDS/commit/47fe5d7636769706fcf71bf7d183c34c64837e37))

# Conflicts:
#	src/cpp/rtps/messages/MessageReceiver.cpp
#	test/blackbox/CMakeLists.txt

* Fixed conflicts

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>

---------

Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>
Co-authored-by: Miguel Company <miguelcompany@eprosima.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fpull%2F3824)

Reviewers

[![@EduPonz](https://avatars.githubusercontent.com/u/7962388?s=40&v=4)](/EduPonz) [EduPonz](/EduPonz)

EduPonz approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**v2.12.0**](/eProsima/Fast-DDS/milestone/50 "v2.12.0")

Development

Successfully merging this pull request may close these issues.

 [[16784] Malformed DATA submessage leads to bad-free during SPDP](https://github.com/eProsima/Fast-DDS/issues/3207)

2 participants

[![@MiguelCompany](https://avatars.githubusercontent.com/u/36661117?s=52&v=4)](/MiguelCompany) [![@EduPonz](https://avatars.githubusercontent.com/u/7962388?s=52&v=4)](/EduPonz)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b06a980d_20250115_095545.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fsecurity%2Fadvisories%2FGHSA-gq8g-fj58-22gm)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FeProsima%2FFast-DDS%2Fsecurity%2Fadvisories%2FGHSA-gq8g-fj58-22gm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=eProsima%2FFast-DDS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eProsima](/eProsima)
/
**[Fast-DDS](/eProsima/Fast-DDS)**
Public

* [Notifications](/login?return_to=%2FeProsima%2FFast-DDS) You must be signed in to change notification settings
* [Fork
  791](/login?return_to=%2FeProsima%2FFast-DDS)
* [Star
   2.3k](/login?return_to=%2FeProsima%2FFast-DDS)

* [Code](/eProsima/Fast-DDS)
* [Issues
  53](/eProsima/Fast-DDS/issues)
* [Pull requests
  76](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects
  0](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

Additional navigation options

* [Code](/eProsima/Fast-DDS)
* [Issues](/eProsima/Fast-DDS/issues)
* [Pull requests](/eProsima/Fast-DDS/pulls)
* [Discussions](/eProsima/Fast-DDS/discussions)
* [Actions](/eProsima/Fast-DDS/actions)
* [Projects](/eProsima/Fast-DDS/projects)
* [Security](/eProsima/Fast-DDS/security)
* [Insights](/eProsima/Fast-DDS/pulse)

# Malformed DATA submessage leads to bad-free error

High

[MiguelCompany](/MiguelCompany)
published
GHSA-gq8g-fj58-22gm
Oct 16, 2023

## Package

Fast-DDS

## Affected versions

<= 2.11.1

## Patched versions

2.12.0 / 2.11.3 / 2.10.3 / 2.6.7

## Description

### Summary

This was initially found in v2.9.0 and reported as issue [#3207](https://github.com/eProsima/Fast-DDS/issues/3207). The issue is still persistent in v2.11.1.

### Details

When the following DATA submessage is sent to a discovery locator, it triggers ASan's bad-free error:

```
0000   15 17 18 00 00 00 10 92 00 00 00 00 00 01 00 c2
0010   00 00 00 00 02 00 00 00 01 00 00 00

```

The `octetsToInlineQoS` field is malformed (0x9210), which normally is 16.

In `proc_Submsg_Data()`, `ch.serializedPayload.data = nullptr;` triggers ASan:

```
In file: /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/messages/MessageReceiver.cpp
   882     {
   883         payload_pool->release_payload(ch);
   884     }
   885
   886     //TODO(Ricardo) If an exception is thrown (ex, by fastcdr), these lines are not executed -> segmentation fault
 ► 887     ch.serializedPayload.data = nullptr;
   888     ch.inline_qos.data = nullptr;
   889
   890     EPROSIMA_LOG_INFO(RTPS_MSG_IN, IDSTRING "Sub Message DATA processed");
   891     return true;
   892 }

```

ASan report:

```
    #0 0x4db152 in free (/home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x4db152)
    #1 0x54c125 in eprosima::fastrtps::rtps::SerializedPayload_t::empty() (/home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x54c125)
    #2 0x54b46c in eprosima::fastrtps::rtps::SerializedPayload_t::~SerializedPayload_t() (/home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x54b46c)
    #3 0x7ffff5f5daca in eprosima::fastrtps::rtps::CacheChange_t::~CacheChange_t() /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/include/fastdds/rtps/common/CacheChange.h:184:5
    #4 0x7ffff6111e01 in eprosima::fastrtps::rtps::MessageReceiver::proc_Submsg_Data(eprosima::fastrtps::rtps::CDRMessage_t*, eprosima::fastrtps::rtps::SubmessageHeader_t*, eprosima::fastrtps::rtps::EntityId_t&) const /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/messages/MessageReceiver.cpp:892:1
    #5 0x7ffff61003b8 in eprosima::fastrtps::rtps::MessageReceiver::processCDRMsg(eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastrtps::rtps::CDRMessage_t*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/messages/MessageReceiver.cpp:439:33
    #6 0x7ffff61769b6 in eprosima::fastrtps::rtps::ReceiverResource::OnDataReceived(unsigned char const*, unsigned int, eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastrtps::rtps::Locator_t const&) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/network/ReceiverResource.cpp:134:14
    #7 0x7ffff65c1773 in eprosima::fastdds::rtps::UDPChannelResource::perform_listen_operation(eprosima::fastrtps::rtps::Locator_t) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/transport/UDPChannelResource.cpp:70:33
    #8 0x7ffff65cc2dd in void std::__invoke_impl<void, void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t>(std::__invoke_memfun_deref, void (eprosima::fastdds::rtps::UDPChannelResource::*&&)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*&&, eprosima::fastrtps::rtps::Locator_t&&) /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/invoke.h:73:14
    #9 0x7ffff65cbeca in std::__invoke_result<void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t>::type std::__invoke<void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t>(void (eprosima::fastdds::rtps::UDPChannelResource::*&&)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*&&, eprosima::fastrtps::rtps::Locator_t&&) /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/invoke.h:95:14
    #10 0x7ffff65cbe3a in void std::thread::_Invoker<std::tuple<void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t> >::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/thread:244:13
    #11 0x7ffff65cbda4 in std::thread::_Invoker<std::tuple<void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t> >::operator()() /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/thread:251:11
    #12 0x7ffff65cb6b8 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (eprosima::fastdds::rtps::UDPChannelResource::*)(eprosima::fastrtps::rtps::Locator_t), eprosima::fastdds::rtps::UDPChannelResource*, eprosima::fastrtps::rtps::Locator_t> > >::_M_run() /usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/thread:195:13
    #13 0x7ffff473edf3  (/lib/x86_64-linux-gnu/libstdc++.so.6+0xd6df3)
    #14 0x7ffff4be4608 in start_thread /build/glibc-SzIz7B/glibc-2.31/nptl/pthread_create.c:477:8
    #15 0x7ffff4429132 in clone /build/glibc-SzIz7B/glibc-2.31/misc/../sysdeps/unix/sysv/linux/x86_64/clone.S:95

0x63100002882c is located 44 bytes inside of 65500-byte region [0x631000028800,0x6310000387dc)
allocated by thread T0 here:
    #0 0x4db3bd in malloc (/home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x4db3bd)
    #1 0x7ffff60e7b43 in eprosima::fastrtps::rtps::CDRMessage_t::CDRMessage_t(unsigned int) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/include/fastdds/rtps/common/CDRMessage_t.h:79:30
    #2 0x7ffff65bff63 in eprosima::fastdds::rtps::ChannelResource::ChannelResource(unsigned int) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/transport/ChannelResource.cpp:45:7
    #3 0x7ffff65c0dd7 in eprosima::fastdds::rtps::UDPChannelResource::UDPChannelResource(eprosima::fastdds::rtps::UDPTransportInterface*, asio::basic_datagram_socket<asio::ip::udp>&, unsigned int, eprosima::fastrtps::rtps::Locator_t const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, eprosima::fastdds::rtps::TransportReceiverInterface*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/transport/UDPChannelResource.cpp:35:7
    #4 0x7ffff6700393 in eprosima::fastdds::rtps::UDPTransportInterface::CreateInputChannelResource(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, eprosima::fastrtps::rtps::Locator_t const&, bool, unsigned int, eprosima::fastdds::rtps::TransportReceiverInterface*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/transport/UDPTransportInterface.cpp:233:50
    #5 0x7ffff6705a83 in eprosima::fastdds::rtps::UDPTransportInterface::OpenAndBindInputSockets(eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastdds::rtps::TransportReceiverInterface*, bool, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/transport/UDPTransportInterface.cpp:207:34
    #6 0x7ffff66500a9 in eprosima::fastdds::rtps::UDPv4Transport::OpenInputChannel(eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastdds::rtps::TransportReceiverInterface*, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/transport/UDPv4Transport.cpp:328:19
    #7 0x7ffff61748eb in eprosima::fastrtps::rtps::ReceiverResource::ReceiverResource(eprosima::fastdds::rtps::TransportInterface&, eprosima::fastrtps::rtps::Locator_t const&, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/network/ReceiverResource.cpp:45:24
    #8 0x7ffff6162155 in eprosima::fastrtps::rtps::NetworkFactory::BuildReceiverResources(eprosima::fastrtps::rtps::Locator_t&, std::vector<std::shared_ptr<eprosima::fastrtps::rtps::ReceiverResource>, std::allocator<std::shared_ptr<eprosima::fastrtps::rtps::ReceiverResource> > >&, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/network/NetworkFactory.cpp:74:25
    #9 0x7ffff618910a in eprosima::fastrtps::rtps::RTPSParticipantImpl::createReceiverResources(eprosima::fastdds::rtps::LocatorList&, bool, bool) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/participant/RTPSParticipantImpl.cpp:1701:38
    #10 0x7ffff6181598 in eprosima::fastrtps::rtps::RTPSParticipantImpl::RTPSParticipantImpl(unsigned int, eprosima::fastrtps::rtps::RTPSParticipantAttributes const&, eprosima::fastrtps::rtps::GuidPrefix_t const&, eprosima::fastrtps::rtps::GuidPrefix_t const&, eprosima::fastrtps::rtps::RTPSParticipant*, eprosima::fastrtps::rtps::RTPSParticipantListener*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/participant/RTPSParticipantImpl.cpp:357:5
    #11 0x7ffff618aba9 in eprosima::fastrtps::rtps::RTPSParticipantImpl::RTPSParticipantImpl(unsigned int, eprosima::fastrtps::rtps::RTPSParticipantAttributes const&, eprosima::fastrtps::rtps::GuidPrefix_t const&, eprosima::fastrtps::rtps::RTPSParticipant*, eprosima::fastrtps::rtps::RTPSParticipantListener*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/participant/RTPSParticipantImpl.cpp:450:7
    #12 0x7ffff6219ace in eprosima::fastrtps::rtps::RTPSDomainImpl::createParticipant(unsigned int, bool, eprosima::fastrtps::rtps::RTPSParticipantAttributes const&, eprosima::fastrtps::rtps::RTPSParticipantListener*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/RTPSDomain.cpp:199:21
    #13 0x7ffff621bd07 in eprosima::fastrtps::rtps::RTPSDomain::createParticipant(unsigned int, bool, eprosima::fastrtps::rtps::RTPSParticipantAttributes const&, eprosima::fastrtps::rtps::RTPSParticipantListener*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/RTPSDomain.cpp:88:12
    #14 0x7ffff64e91eb in eprosima::fastdds::dds::DomainParticipantImpl::enable() /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/fastdds/domain/DomainParticipantImpl.cpp:277:16
    #15 0x7ffff6569195 in eprosima::fastdds::dds::DomainParticipant::enable() /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/fastdds/domain/DomainParticipant.cpp:110:36
    #16 0x7ffff64bad1a in eprosima::fastdds::dds::DomainParticipantFactory::create_participant(unsigned int, eprosima::fastdds::dds::DomainParticipantQos const&, eprosima::fastdds::dds::DomainParticipantListener*, eprosima::fastdds::dds::StatusMask const&) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/fastdds/domain/DomainParticipantFactory.cpp:189:55
    #17 0x56c9cc in HelloWorldSubscriber::init(bool) (/home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x56c9cc)
    #18 0x574de1 in main (/home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x574de1)
    #19 0x7ffff432e082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16

Thread T4 created by T0 here:
    #0 0x4c571c in pthread_create (/home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x4c571c)
    #1 0x7ffff473f0c9 in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/lib/x86_64-linux-gnu/libstdc++.so.6+0xd70c9)
    #2 0x7ffff65c0f99 in eprosima::fastdds::rtps::UDPChannelResource::UDPChannelResource(eprosima::fastdds::rtps::UDPTransportInterface*, asio::basic_datagram_socket<asio::ip::udp>&, unsigned int, eprosima::fastrtps::rtps::Locator_t const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, eprosima::fastdds::rtps::TransportReceiverInterface*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/transport/UDPChannelResource.cpp:42:12
    #3 0x7ffff6700393 in eprosima::fastdds::rtps::UDPTransportInterface::CreateInputChannelResource(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, eprosima::fastrtps::rtps::Locator_t const&, bool, unsigned int, eprosima::fastdds::rtps::TransportReceiverInterface*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/transport/UDPTransportInterface.cpp:233:50
    #4 0x7ffff6705a83 in eprosima::fastdds::rtps::UDPTransportInterface::OpenAndBindInputSockets(eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastdds::rtps::TransportReceiverInterface*, bool, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/transport/UDPTransportInterface.cpp:207:34
    #5 0x7ffff66500a9 in eprosima::fastdds::rtps::UDPv4Transport::OpenInputChannel(eprosima::fastrtps::rtps::Locator_t const&, eprosima::fastdds::rtps::TransportReceiverInterface*, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/transport/UDPv4Transport.cpp:328:19
    #6 0x7ffff61748eb in eprosima::fastrtps::rtps::ReceiverResource::ReceiverResource(eprosima::fastdds::rtps::TransportInterface&, eprosima::fastrtps::rtps::Locator_t const&, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/network/ReceiverResource.cpp:45:24
    #7 0x7ffff6162155 in eprosima::fastrtps::rtps::NetworkFactory::BuildReceiverResources(eprosima::fastrtps::rtps::Locator_t&, std::vector<std::shared_ptr<eprosima::fastrtps::rtps::ReceiverResource>, std::allocator<std::shared_ptr<eprosima::fastrtps::rtps::ReceiverResource> > >&, unsigned int) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/network/NetworkFactory.cpp:74:25
    #8 0x7ffff618910a in eprosima::fastrtps::rtps::RTPSParticipantImpl::createReceiverResources(eprosima::fastdds::rtps::LocatorList&, bool, bool) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/participant/RTPSParticipantImpl.cpp:1701:38
    #9 0x7ffff6181598 in eprosima::fastrtps::rtps::RTPSParticipantImpl::RTPSParticipantImpl(unsigned int, eprosima::fastrtps::rtps::RTPSParticipantAttributes const&, eprosima::fastrtps::rtps::GuidPrefix_t const&, eprosima::fastrtps::rtps::GuidPrefix_t const&, eprosima::fastrtps::rtps::RTPSParticipant*, eprosima::fastrtps::rtps::RTPSParticipantListener*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/participant/RTPSParticipantImpl.cpp:357:5
    #10 0x7ffff618aba9 in eprosima::fastrtps::rtps::RTPSParticipantImpl::RTPSParticipantImpl(unsigned int, eprosima::fastrtps::rtps::RTPSParticipantAttributes const&, eprosima::fastrtps::rtps::GuidPrefix_t const&, eprosima::fastrtps::rtps::RTPSParticipant*, eprosima::fastrtps::rtps::RTPSParticipantListener*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/participant/RTPSParticipantImpl.cpp:450:7
    #11 0x7ffff6219ace in eprosima::fastrtps::rtps::RTPSDomainImpl::createParticipant(unsigned int, bool, eprosima::fastrtps::rtps::RTPSParticipantAttributes const&, eprosima::fastrtps::rtps::RTPSParticipantListener*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/RTPSDomain.cpp:199:21
    #12 0x7ffff621bd07 in eprosima::fastrtps::rtps::RTPSDomain::createParticipant(unsigned int, bool, eprosima::fastrtps::rtps::RTPSParticipantAttributes const&, eprosima::fastrtps::rtps::RTPSParticipantListener*) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/rtps/RTPSDomain.cpp:88:12
    #13 0x7ffff64e91eb in eprosima::fastdds::dds::DomainParticipantImpl::enable() /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/fastdds/domain/DomainParticipantImpl.cpp:277:16
    #14 0x7ffff6569195 in eprosima::fastdds::dds::DomainParticipant::enable() /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/fastdds/domain/DomainParticipant.cpp:110:36
    #15 0x7ffff64bad1a in eprosima::fastdds::dds::DomainParticipantFactory::create_participant(unsigned int, eprosima::fastdds::dds::DomainParticipantQos const&, eprosima::fastdds::dds::DomainParticipantListener*, eprosima::fastdds::dds::StatusMask const&) /home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/src/cpp/fastdds/domain/DomainParticipantFactory.cpp:189:55
    #16 0x56c9cc in HelloWorldSubscriber::init(bool) (/home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x56c9cc)
    #17 0x574de1 in main (/home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x574de1)
    #18 0x7ffff432e082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16

SUMMARY: AddressSanitizer: bad-free (/home/seulbae/ddssecurity/targets/fastdds-master/src/fastrtps/examples/cpp/dds/HelloWorldExample/DDSHelloWorldExample+0x4db152) in free
==2597607==ABORTING

```
### PoC

Run any fastdds process on domain 0.

Send the DATA submessage above to 127.0.0.1:7400.

### Impact

This can remotely crash any Fast-DDS process.

As `free()`'s ptr is controlled, this vulnerability can potentially be exploited to do double free attacks or UAF.

### Severity

High

8.6

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H

### CVE ID

CVE-2023-42459

### Weaknesses

[CWE-415](/advisories?query=cwe%3A415) [CWE-416](/advisories?query=cwe%3A416) [CWE-590](/advisories?query=cwe%3A590)

### Credits

* [![@squizz617](https://avatars.githubusercontent.com/u/10861633?s=40&v=4)](/squizz617)
  [squizz617](/squizz617)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


