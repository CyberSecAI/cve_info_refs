=== Content from github.com_3a1f32f1_20250115_095139.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkyverno%2Fkyverno%2Fcommit%2F80d139bb5d1d9d7e907abe851b97dc73821a5be2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkyverno%2Fkyverno%2Fcommit%2F80d139bb5d1d9d7e907abe851b97dc73821a5be2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=kyverno%2Fkyverno)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kyverno](/kyverno)
/
**[kyverno](/kyverno/kyverno)**
Public

* [Notifications](/login?return_to=%2Fkyverno%2Fkyverno) You must be signed in to change notification settings
* [Fork
  918](/login?return_to=%2Fkyverno%2Fkyverno)
* [Star
   5.9k](/login?return_to=%2Fkyverno%2Fkyverno)

* [Code](/kyverno/kyverno)
* [Issues
  278](/kyverno/kyverno/issues)
* [Pull requests
  55](/kyverno/kyverno/pulls)
* [Discussions](/kyverno/kyverno/discussions)
* [Actions](/kyverno/kyverno/actions)
* [Projects
  2](/kyverno/kyverno/projects)
* [Wiki](/kyverno/kyverno/wiki)
* [Security](/kyverno/kyverno/security)
* [Insights](/kyverno/kyverno/pulse)

Additional navigation options

* [Code](/kyverno/kyverno)
* [Issues](/kyverno/kyverno/issues)
* [Pull requests](/kyverno/kyverno/pulls)
* [Discussions](/kyverno/kyverno/discussions)
* [Actions](/kyverno/kyverno/actions)
* [Projects](/kyverno/kyverno/projects)
* [Wiki](/kyverno/kyverno/wiki)
* [Security](/kyverno/kyverno/security)
* [Insights](/kyverno/kyverno/pulse)

## Commit

[Permalink](/kyverno/kyverno/commit/80d139bb5d1d9d7e907abe851b97dc73821a5be2)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Added `fetchAttestations` method to notaryV2 implimentation ([#6800](https://github.com/kyverno/kyverno/pull/6800))

[Browse files](/kyverno/kyverno/tree/80d139bb5d1d9d7e907abe851b97dc73821a5be2)
Browse the repository at this point in the history

```
* moved to oras

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* linting error fix

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* added error checking

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* fixed errors

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* added final build

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* added predicate fetching

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* added checks in statements

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* removed continuous checking if predicate is found

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* renamed notaryv2 to notary

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* changed notaryv2 to notary

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* run codegen all

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* changes

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* commented cert

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* added variable support to certs

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* renamed notaryV2 to notary

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* deprecated predicate types

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* disallow keys and keyless under attestors if type is set to notary

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* gcr crane implementation init

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* added changes

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* types

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* using remote puller and pusher

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* implemented notation repository interface

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* updated notary implementation and fixed errors

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* removed oras

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* kuttl test init

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* added image verify test

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* check image attestation notary

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* added readme

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* added tests for extract statements

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* fix: remove status from policy webhooks ([#6939](https://github.com/kyverno/kyverno/pull/6939))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* feat: split chart values in readme per component ([#6936](https://github.com/kyverno/kyverno/pull/6936))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>
Co-authored-by: shuting <shuting@nirmata.com>

* fix: incorrect json patch validation ([#6941](https://github.com/kyverno/kyverno/pull/6941))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* feat: add verbosity level in helm chart values ([#6940](https://github.com/kyverno/kyverno/pull/6940))

* feat: add verbosity level in helm chart values

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* codegen

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix: match on ephemeral containers ([#6963](https://github.com/kyverno/kyverno/pull/6963))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix: refine event permissions in default roles ([#6957](https://github.com/kyverno/kyverno/pull/6957))

* remove the event delete permission

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* add '- events.k8s.io/v1'

Signed-off-by: ShutingZhao <shuting@nirmata.com>

---------

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* Add kuttl test for ephemeral containers ([#6966](https://github.com/kyverno/kyverno/pull/6966))

* Move Sam to Emeritus status

Signed-off-by: Chip Zoller <chipzoller@gmail.com>

* add kuttl test for ephemeral containers

Signed-off-by: Chip Zoller <chipzoller@gmail.com>

---------

Signed-off-by: Chip Zoller <chipzoller@gmail.com>

* refactor: restructure cli test command ([#6942](https://github.com/kyverno/kyverno/pull/6942))

* refactor: restructure cli test command

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* feat: add credential helpers flags ([#6974](https://github.com/kyverno/kyverno/pull/6974))

* feat: add credential helpers flags

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* chore(deps): bump aquasecurity/trivy-action from 0.9.2 to 0.10.0 ([#6976](https://github.com/kyverno/kyverno/pull/6976))

Bumps [aquasecurity/trivy-action](<https://github.com/aquasecurity/trivy-action>) from 0.9.2 to 0.10.0.
- [Release notes](<https://github.com/aquasecurity/trivy-action/releases>)
- [Commits]([aquasecurity/trivy-action@1f0aa58...e5f4313](https://github.com/aquasecurity/trivy-action/compare/1f0aa582c8c8f5f7639610d6d38baddfea4fdcee...e5f43133f6e8736992c9f3c1b3296e24b37e17f2))

---
updated-dependencies:
- dependency-name: aquasecurity/trivy-action
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Support for Context vars in cleanup ([#6084](https://github.com/kyverno/kyverno/pull/6084))

* Added Context in CleanupPolicySpec

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added context.go file with loadVariable()

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added loadAPIData() in context.go and called from handlers.go

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added conditionals for not supported context variables

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Reverted versions in CRDs

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Reverted CRDs to v0.11.1

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Imported fmt in handlers.go

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added Context in CleanupPolicySpec

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added context.go file with loadVariable()

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added loadAPIData() in context.go and called from handlers.go

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added conditionals for not supported context variables

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Reverted versions in CRDs

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Reverted CRDs to v0.11.1

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Imported fmt in handlers.go

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Removed duplicate import

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* make verify-codegen

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Updated kuttl test

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Fixed kuttl failure

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* moved policy check to validation

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Reused functions

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added kuttl test

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added more configMap

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* removed unecessary check

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* auto codegen

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* updated codegen

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Renamed ApplyJMESPath() to applyJMESPath()

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

---------

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>
Co-authored-by: shuting <shuting@nirmata.com>
Co-authored-by: Chip Zoller <chipzoller@gmail.com>
Co-authored-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* chore(deps): bump actions/setup-python from 4.5.0 to 4.6.0 ([#6981](https://github.com/kyverno/kyverno/pull/6981))

Bumps [actions/setup-python](<https://github.com/actions/setup-python>) from 4.5.0 to 4.6.0.
- [Release notes](<https://github.com/actions/setup-python/releases>)
- [Commits]([actions/setup-python@d27e3f3...57ded4d](https://github.com/actions/setup-python/compare/d27e3f3d7c64b4bbf8e4abfb9b63b83e846e0435...57ded4d7d5e986d7296eab16560982c6dd7c923b))

---
updated-dependencies:
- dependency-name: actions/setup-python
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* chore(deps): bump codecov/codecov-action from 3.1.2 to 3.1.3 ([#6982](https://github.com/kyverno/kyverno/pull/6982))

Bumps [codecov/codecov-action](<https://github.com/codecov/codecov-action>) from 3.1.2 to 3.1.3.
- [Release notes](<https://github.com/codecov/codecov-action/releases>)
- [Changelog](<https://github.com/codecov/codecov-action/blob/main/CHANGELOG.md>)
- [Commits]([codecov/codecov-action@40a12dc...894ff02](https://github.com/codecov/codecov-action/compare/40a12dcee2df644d47232dde008099a3e9e4f865...894ff025c7b54547a9a2a1e9f228beae737ad3c2))

---
updated-dependencies:
- dependency-name: codecov/codecov-action
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* fix background variables validation ([#6978](https://github.com/kyverno/kyverno/pull/6978))

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* chore: restrict default permissions ([#6972](https://github.com/kyverno/kyverno/pull/6972))

* restrict admission permissions

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* restrict background  permissions

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* update install.yaml

Signed-off-by: ShutingZhao <shuting@nirmata.com>

---------

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* kuttl README ([#6984](https://github.com/kyverno/kyverno/pull/6984))

* Added Context in CleanupPolicySpec

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added context.go file with loadVariable()

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added loadAPIData() in context.go and called from handlers.go

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added conditionals for not supported context variables

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Reverted versions in CRDs

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Reverted CRDs to v0.11.1

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Imported fmt in handlers.go

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added Context in CleanupPolicySpec

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added context.go file with loadVariable()

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added loadAPIData() in context.go and called from handlers.go

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added conditionals for not supported context variables

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Reverted versions in CRDs

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Reverted CRDs to v0.11.1

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Imported fmt in handlers.go

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Removed duplicate import

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* make verify-codegen

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Updated kuttl test

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Fixed kuttl failure

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* moved policy check to validation

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Reused functions

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added kuttl test

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added more configMap

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* removed unecessary check

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* auto codegen

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* updated codegen

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Renamed ApplyJMESPath() to applyJMESPath()

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

* Added Readme in context-cleanup-pod

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>

---------

Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>
Co-authored-by: shuting <shuting@nirmata.com>
Co-authored-by: Chip Zoller <chipzoller@gmail.com>
Co-authored-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* chore(deps): bump github/codeql-action from 2.2.12 to 2.3.0 ([#6989](https://github.com/kyverno/kyverno/pull/6989))

Bumps [github/codeql-action](<https://github.com/github/codeql-action>) from 2.2.12 to 2.3.0.
- [Release notes](<https://github.com/github/codeql-action/releases>)
- [Changelog](<https://github.com/github/codeql-action/blob/main/CHANGELOG.md>)
- [Commits]([github/codeql-action@7df0ce3...b2c19fb](https://github.com/github/codeql-action/compare/7df0ce34898d659f95c0c4a09eaa8d4e32ee64db...b2c19fb9a2a485599ccf4ed5d65527d94bc57226))

---
updated-dependencies:
- dependency-name: github/codeql-action
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* chore(deps): bump github.com/notaryproject/notation-core-go ([#6987](https://github.com/kyverno/kyverno/pull/6987))

Bumps [github.com/notaryproject/notation-core-go](<https://github.com/notaryproject/notation-core-go>) from 1.0.0-rc.2 to 1.0.0-rc.3.
- [Release notes](<https://github.com/notaryproject/notation-core-go/releases>)
- [Commits]([notaryproject/notation-core-go@v1.0.0-rc.2...v1.0.0-rc.3](https://github.com/notaryproject/notation-core-go/compare/v1.0.0-rc.2...v1.0.0-rc.3))

---
updated-dependencies:
- dependency-name: github.com/notaryproject/notation-core-go
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* feat: new access checks for background policies ([#6970](https://github.com/kyverno/kyverno/pull/6970))

* switch to use sar for access checks

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* fix unit tests

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* update helm config

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* fix username

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* update msg

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* fix sa name

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* update install.yaml

Signed-off-by: ShutingZhao <shuting@nirmata.com>

---------

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* chore: bump kind image to 1.27.1 ([#6993](https://github.com/kyverno/kyverno/pull/6993))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* feat: bump k8s deps to 1.27 ([#6868](https://github.com/kyverno/kyverno/pull/6868))

* feat: bump k8s deps to 1.27

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* bump k8s 1.27.1

Signed-off-by: ShutingZhao <shuting@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>
Signed-off-by: ShutingZhao <shuting@nirmata.com>
Co-authored-by: ShutingZhao <shuting@nirmata.com>

* fix: disable autogen in foreach mutation with json patches ([#6996](https://github.com/kyverno/kyverno/pull/6996))

* fix: disable autogen in foreach mutation with json patches

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* kuttl

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix: add server ip config to cleanup controller ([#6999](https://github.com/kyverno/kyverno/pull/6999))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* feat: add features section in helm values ([#6935](https://github.com/kyverno/kyverno/pull/6935))

* feat: add features section in helm values

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* configs

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* overrides

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* feat: add reports cleanup jobs to prevent outage ([#6960](https://github.com/kyverno/kyverno/pull/6960))

* feat: add reports cleanup jobs to prevent outage

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* security cotnext

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>
Co-authored-by: shuting <shuting@nirmata.com>

* feat: add registry credential helpers feature ([#7002](https://github.com/kyverno/kyverno/pull/7002))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* feat: improve instrumented clients ([#7006](https://github.com/kyverno/kyverno/pull/7006))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix: record configmap resource version to not reload when version didn't change ([#7007](https://github.com/kyverno/kyverno/pull/7007))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* chore(deps): bump sigstore/cosign-installer from 3.0.2 to 3.0.3 ([#7012](https://github.com/kyverno/kyverno/pull/7012))

Bumps [sigstore/cosign-installer](<https://github.com/sigstore/cosign-installer>) from 3.0.2 to 3.0.3.
- [Release notes](<https://github.com/sigstore/cosign-installer/releases>)
- [Commits]([sigstore/cosign-installer@9e9de22...204a51a](https://github.com/sigstore/cosign-installer/compare/9e9de2292db7abb3f51b7f4808d98f0d347a8919...204a51a57a74d190b284a0ce69b44bc37201f343))

---
updated-dependencies:
- dependency-name: sigstore/cosign-installer
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* Add Red Hat ACM to the Adopters list ([#7016](https://github.com/kyverno/kyverno/pull/7016))

Red Hat ACM is useful for distributed kyverno policies across a
managed fleet of clusters.  Adding to adopters file with a link that
describes details of using the ACM policy generator with Kyverno.

Signed-off-by: Gus Parvin <gparvin@redhat.com>

* fix: helm template with metricsRefreshInterval ([#7019](https://github.com/kyverno/kyverno/pull/7019))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* add support for Kubernetes API server POST ([#6948](https://github.com/kyverno/kyverno/pull/6948))

* allow POST for Kubernetes API calls

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* add kuttl tests

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* fmt and undo local changes

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* fix codegen and unit test

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* fix unit test

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* fix tests and extends docs

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

---------

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* feat: update built-in resource schemas ([#7014](https://github.com/kyverno/kyverno/pull/7014))

* feat: update built-in resource schemas

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix unit test

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* chore: use github.com/evanphx/json-patch/v5 ([#7015](https://github.com/kyverno/kyverno/pull/7015))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* chore(deps): bump github/codeql-action from 2.3.0 to 2.3.1 ([#7025](https://github.com/kyverno/kyverno/pull/7025))

Bumps [github/codeql-action](<https://github.com/github/codeql-action>) from 2.3.0 to 2.3.1.
- [Release notes](<https://github.com/github/codeql-action/releases>)
- [Changelog](<https://github.com/github/codeql-action/blob/main/CHANGELOG.md>)
- [Commits]([github/codeql-action@b2c19fb...8662eab](https://github.com/github/codeql-action/compare/b2c19fb9a2a485599ccf4ed5d65527d94bc57226...8662eabe0e9f338a07350b7fd050732745f93848))

---
updated-dependencies:
- dependency-name: github/codeql-action
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* add DE-CIX as adopter of kyverno ([#7027](https://github.com/kyverno/kyverno/pull/7027))

Signed-off-by: Raul Garcia Sanchez <info@raulgarcia.de>

* refactor: engine patchers ([#7030](https://github.com/kyverno/kyverno/pull/7030))

* refactor: engine patchers

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* chore(deps): bump github/codeql-action from 2.3.1 to 2.3.2 ([#7033](https://github.com/kyverno/kyverno/pull/7033))

Bumps [github/codeql-action](<https://github.com/github/codeql-action>) from 2.3.1 to 2.3.2.
- [Release notes](<https://github.com/github/codeql-action/releases>)
- [Changelog](<https://github.com/github/codeql-action/blob/main/CHANGELOG.md>)
- [Commits]([github/codeql-action@8662eab...f3feb00](https://github.com/github/codeql-action/compare/8662eabe0e9f338a07350b7fd050732745f93848...f3feb00acb00f31a6f60280e6ace9ca31d91c76a))

---
updated-dependencies:
- dependency-name: github/codeql-action
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* add Saxo Bank and Velux as adopters ([#7036](https://github.com/kyverno/kyverno/pull/7036))

Signed-off-by: Chip Zoller <chipzoller@gmail.com>

* update development doc ([#7037](https://github.com/kyverno/kyverno/pull/7037))

Signed-off-by: Mariam Fahmy <mariamfahmy66@gmail.com>

* fix: generate policy validation to prevent endless loop ([#7026](https://github.com/kyverno/kyverno/pull/7026))

* refactor policy validation

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* add loop check for generate

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* add kuttl tests

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* linter fixes

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* linter fixes

Signed-off-by: ShutingZhao <shuting@nirmata.com>

---------

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* fix: remove deletionTimestamp checks ([#7039](https://github.com/kyverno/kyverno/pull/7039))

* remove deletionTimestamp check

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* remove deletionTimestamp check

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* add back source check

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* remove deletionTimestamp check

Signed-off-by: ShutingZhao <shuting@nirmata.com>

---------

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* chore(deps): bump k8s.io/klog/v2 from 2.90.1 to 2.100.1 ([#7055](https://github.com/kyverno/kyverno/pull/7055))

Bumps [k8s.io/klog/v2](<https://github.com/kubernetes/klog>) from 2.90.1 to 2.100.1.
- [Release notes](<https://github.com/kubernetes/klog/releases>)
- [Changelog](<https://github.com/kubernetes/klog/blob/main/RELEASE.md>)
- [Commits]([kubernetes/klog@v2.90.1...v2.100.1](https://github.com/kubernetes/klog/compare/v2.90.1...v2.100.1))

---
updated-dependencies:
- dependency-name: k8s.io/klog/v2
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* fix: add background scan interval log ([#7065](https://github.com/kyverno/kyverno/pull/7065))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix: flaky github action ([#7068](https://github.com/kyverno/kyverno/pull/7068))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* refactor: engine response policy ([#7063](https://github.com/kyverno/kyverno/pull/7063))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* feat: add opt-in setting to deploy v3 chart ([#7066](https://github.com/kyverno/kyverno/pull/7066))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* require generate.apiVersion ([#7080](https://github.com/kyverno/kyverno/pull/7080))

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* fix: remove excluded groups from matching ([#7083](https://github.com/kyverno/kyverno/pull/7083))

* fix: remove excluded groups from matching

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* feat: add config inclusions support ([#7082](https://github.com/kyverno/kyverno/pull/7082))

* feat: add config inclusions support

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* tests

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* chore: add makefile target for kwok ([#7097](https://github.com/kyverno/kyverno/pull/7097))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* chore(deps): bump github/codeql-action from 2.3.2 to 2.3.3 ([#7099](https://github.com/kyverno/kyverno/pull/7099))

Bumps [github/codeql-action](<https://github.com/github/codeql-action>) from 2.3.2 to 2.3.3.
- [Release notes](<https://github.com/github/codeql-action/releases>)
- [Changelog](<https://github.com/github/codeql-action/blob/main/CHANGELOG.md>)
- [Commits]([github/codeql-action@f3feb00...29b1f65](https://github.com/github/codeql-action/compare/f3feb00acb00f31a6f60280e6ace9ca31d91c76a...29b1f65c5e92e24fe6b6647da1eaabe529cec70f))

---
updated-dependencies:
- dependency-name: github/codeql-action
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* validate target resource scope & namespace settings ([#7098](https://github.com/kyverno/kyverno/pull/7098))

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* fix: mutation code ([#7095](https://github.com/kyverno/kyverno/pull/7095))

* fix: mutation code

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* kuttl tests

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

---------

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* lazy loading of context vars ([#7071](https://github.com/kyverno/kyverno/pull/7071))

* lazy loading of context vars

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* gofumpt

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* add kuttl tests

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

---------

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* [Feature] Add kuttl tests with policy exceptions disabled ([#7117](https://github.com/kyverno/kyverno/pull/7117))

* added tests

Signed-off-by: Ved Ratan <vedratan8@gmail.com>

* removed redundant code

Signed-off-by: Ved Ratan <vedratan8@gmail.com>

* fix

Signed-off-by: Ved Ratan <vedratan8@gmail.com>

* fix

Signed-off-by: Ved Ratan <vedratan8@gmail.com>

* typo fix and README changes

Signed-off-by: Ved Ratan <vedratan8@gmail.com>

* fix

Signed-off-by: Ved Ratan <vedratan8@gmail.com>

---------

Signed-off-by: Ved Ratan <vedratan8@gmail.com>

* Conditions message ([#7113](https://github.com/kyverno/kyverno/pull/7113))

* add message to conditions

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* add tests

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* extend tests

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

---------

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* chore(deps): bump zgosalvez/github-actions-ensure-sha-pinned-actions ([#7123](https://github.com/kyverno/kyverno/pull/7123))

Bumps [zgosalvez/github-actions-ensure-sha-pinned-actions](<https://github.com/zgosalvez/github-actions-ensure-sha-pinned-actions>) from 2.1.2 to 2.1.3.
- [Release notes](<https://github.com/zgosalvez/github-actions-ensure-sha-pinned-actions/releases>)
- [Commits]([zgosalvez/github-actions-ensure-sha-pinned-actions@21991ce...555a30d](https://github.com/zgosalvez/github-actions-ensure-sha-pinned-actions/compare/21991cec25093947ff3f62e4c223df0260c39944...555a30da2656b4a7cf47b107800bef097723363e))

---
updated-dependencies:
- dependency-name: zgosalvez/github-actions-ensure-sha-pinned-actions
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: shuting <shuting@nirmata.com>

* chore(deps): bump sigs.k8s.io/kustomize/kyaml from 0.14.1 to 0.14.2 ([#7121](https://github.com/kyverno/kyverno/pull/7121))

Bumps [sigs.k8s.io/kustomize/kyaml](<https://github.com/kubernetes-sigs/kustomize>) from 0.14.1 to 0.14.2.
- [Release notes](<https://github.com/kubernetes-sigs/kustomize/releases>)
- [Commits]([kubernetes-sigs/kustomize@kyaml/v0.14.1...kyaml/v0.14.2](https://github.com/kubernetes-sigs/kustomize/compare/kyaml/v0.14.1...kyaml/v0.14.2))

---
updated-dependencies:
- dependency-name: sigs.k8s.io/kustomize/kyaml
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: shuting <shuting@nirmata.com>

* chore(deps): bump oras.land/oras-go/v2 from 2.0.2 to 2.1.0 ([#7102](https://github.com/kyverno/kyverno/pull/7102))

Bumps [oras.land/oras-go/v2](<https://github.com/oras-project/oras-go>) from 2.0.2 to 2.1.0.
- [Release notes](<https://github.com/oras-project/oras-go/releases>)
- [Commits]([oras-project/oras-go@v2.0.2...v2.1.0](https://github.com/oras-project/oras-go/compare/v2.0.2...v2.1.0))

---
updated-dependencies:
- dependency-name: oras.land/oras-go/v2
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: shuting <shuting@nirmata.com>

* add condition msg to v2beta1 ([#7126](https://github.com/kyverno/kyverno/pull/7126))

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* feat: print container flags and their values ([#7127](https://github.com/kyverno/kyverno/pull/7127))

* add condition msg to v2beta1

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* print flags settings

Signed-off-by: ShutingZhao <shuting@nirmata.com>

---------

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* remove the container flag genWorker from the admission controller ([#7132](https://github.com/kyverno/kyverno/pull/7132))

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* chore(deps): bump google.golang.org/grpc from 1.54.0 to 1.55.0 ([#7103](https://github.com/kyverno/kyverno/pull/7103))

Bumps [google.golang.org/grpc](<https://github.com/grpc/grpc-go>) from 1.54.0 to 1.55.0.
- [Release notes](<https://github.com/grpc/grpc-go/releases>)
- [Commits]([grpc/grpc-go@v1.54.0...v1.55.0](https://github.com/grpc/grpc-go/compare/v1.54.0...v1.55.0))

---
updated-dependencies:
- dependency-name: google.golang.org/grpc
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* remove the duplicate entry ([#7125](https://github.com/kyverno/kyverno/pull/7125))

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* chore(deps): bump sigs.k8s.io/kustomize/api from 0.13.2 to 0.13.3 ([#7120](https://github.com/kyverno/kyverno/pull/7120))

Bumps [sigs.k8s.io/kustomize/api](<https://github.com/kubernetes-sigs/kustomize>) from 0.13.2 to 0.13.3.
- [Release notes](<https://github.com/kubernetes-sigs/kustomize/releases>)
- [Commits]([kubernetes-sigs/kustomize@api/v0.13.2...api/v0.13.3](https://github.com/kubernetes-sigs/kustomize/compare/api/v0.13.2...api/v0.13.3))

---
updated-dependencies:
- dependency-name: sigs.k8s.io/kustomize/api
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: shuting <shuting@nirmata.com>

* fixed error

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* undo mistake

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* go mod conflict fix

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* changes from review

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* NIT

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* updated image

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* updated checks

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* fixed verifying wrong ref

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* updated cert in tests

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* added warning when predicate type is used

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* fix: panic for policy variable validation ([#7079](https://github.com/kyverno/kyverno/pull/7079))

* fix panic

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* check errors

Signed-off-by: ShutingZhao <shuting@nirmata.com>

---------

Signed-off-by: ShutingZhao <shuting@nirmata.com>
Co-authored-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix: remove policy-reporter from dev lab ([#7196](https://github.com/kyverno/kyverno/pull/7196))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix: cleanup controller metrics name ([#7198](https://github.com/kyverno/kyverno/pull/7198))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix: http request metrics ([#7197](https://github.com/kyverno/kyverno/pull/7197))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* remove unused code ([#7203](https://github.com/kyverno/kyverno/pull/7203))

Signed-off-by: Jim Bugwadia <jim@nirmata.com>

* handle Deny rules where conditions eval to true ([#7204](https://github.com/kyverno/kyverno/pull/7204))

Signed-off-by: Jim Bugwadia <jim@nirmata.com>
Co-authored-by: shuting <shuting@nirmata.com>

* [Bug] Enforce message wrong ([#7208](https://github.com/kyverno/kyverno/pull/7208))

* fix

Signed-off-by: Ved Ratan <vedratan8@gmail.com>

* fixed tests

Signed-off-by: Ved Ratan <vedratan8@gmail.com>

---------

Signed-off-by: Ved Ratan <vedratan8@gmail.com>

* chore(deps): bump codecov/codecov-action from 3.1.3 to 3.1.4 ([#7207](https://github.com/kyverno/kyverno/pull/7207))

Bumps [codecov/codecov-action](<https://github.com/codecov/codecov-action>) from 3.1.3 to 3.1.4.
- [Release notes](<https://github.com/codecov/codecov-action/releases>)
- [Changelog](<https://github.com/codecov/codecov-action/blob/main/CHANGELOG.md>)
- [Commits]([codecov/codecov-action@894ff02...eaaf4be](https://github.com/codecov/codecov-action/compare/894ff025c7b54547a9a2a1e9f228beae737ad3c2...eaaf4bedf32dbdc6b720b63067d99c4d77d6047d))

---
updated-dependencies:
- dependency-name: codecov/codecov-action
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* chore(deps): bump sigstore/cosign-installer from 3.0.3 to 3.0.4 ([#7215](https://github.com/kyverno/kyverno/pull/7215))

Bumps [sigstore/cosign-installer](<https://github.com/sigstore/cosign-installer>) from 3.0.3 to 3.0.4.
- [Release notes](<https://github.com/sigstore/cosign-installer/releases>)
- [Commits]([sigstore/cosign-installer@204a51a...03d0fec](https://github.com/sigstore/cosign-installer/compare/204a51a57a74d190b284a0ce69b44bc37201f343...03d0fecf172873164a163bbc64bed0f3bf114ed7))

---
updated-dependencies:
- dependency-name: sigstore/cosign-installer
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* fix: panic in reports controller ([#7220](https://github.com/kyverno/kyverno/pull/7220))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix: mutate existing auth check ([#7219](https://github.com/kyverno/kyverno/pull/7219))

* fix auth check when using variables in ns

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* add kuttl tests

Signed-off-by: ShutingZhao <shuting@nirmata.com>

---------

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* fix: do not exclude kube-system service accounts by default ([#7225](https://github.com/kyverno/kyverno/pull/7225))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* docs: add reports system design doc ([#6949](https://github.com/kyverno/kyverno/pull/6949))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* chore(deps): bump k8s.io/apimachinery from 0.27.1 to 0.27.2 ([#7227](https://github.com/kyverno/kyverno/pull/7227))

Bumps [k8s.io/apimachinery](<https://github.com/kubernetes/apimachinery>) from 0.27.1 to 0.27.2.
- [Commits]([kubernetes/apimachinery@v0.27.1...v0.27.2](https://github.com/kubernetes/apimachinery/compare/v0.27.1...v0.27.2))

---
updated-dependencies:
- dependency-name: k8s.io/apimachinery
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: shuting <shuting@nirmata.com>

* chore(deps): bump k8s.io/cli-runtime from 0.27.1 to 0.27.2 ([#7228](https://github.com/kyverno/kyverno/pull/7228))

Bumps [k8s.io/cli-runtime](<https://github.com/kubernetes/cli-runtime>) from 0.27.1 to 0.27.2.
- [Commits]([kubernetes/cli-runtime@v0.27.1...v0.27.2](https://github.com/kubernetes/cli-runtime/compare/v0.27.1...v0.27.2))

---
updated-dependencies:
- dependency-name: k8s.io/cli-runtime
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* chore(deps): bump sigstore/cosign-installer from 3.0.4 to 3.0.5 ([#7229](https://github.com/kyverno/kyverno/pull/7229))

Bumps [sigstore/cosign-installer](<https://github.com/sigstore/cosign-installer>) from 3.0.4 to 3.0.5.
- [Release notes](<https://github.com/sigstore/cosign-installer/releases>)
- [Commits]([sigstore/cosign-installer@03d0fec...dd6b2e2](https://github.com/sigstore/cosign-installer/compare/03d0fecf172873164a163bbc64bed0f3bf114ed7...dd6b2e2b610a11fd73dd187a43d57cc1394e35f9))

---
updated-dependencies:
- dependency-name: sigstore/cosign-installer
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* chore(deps): bump k8s.io/pod-security-admission from 0.27.1 to 0.27.2 ([#7232](https://github.com/kyverno/kyverno/pull/7232))

Bumps [k8s.io/pod-security-admission](<https://github.com/kubernetes/pod-security-admission>) from 0.27.1 to 0.27.2.
- [Commits]([kubernetes/pod-security-admission@v0.27.1...v0.27.2](https://github.com/kubernetes/pod-security-admission/compare/v0.27.1...v0.27.2))

---
updated-dependencies:
- dependency-name: k8s.io/pod-security-admission
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* fix: match logic misbehave ([#7218](https://github.com/kyverno/kyverno/pull/7218))

* add rule name in ur for mutate existing

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* fix match logic

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* linter fixes

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* fix the match logic to only apply to the new object, unless it's a delete request

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* fix unit tests

Signed-off-by: ShutingZhao <shuting@nirmata.com>

---------

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* chore(deps): bump github.com/stretchr/testify from 1.8.2 to 1.8.3 ([#7240](https://github.com/kyverno/kyverno/pull/7240))

Bumps [github.com/stretchr/testify](<https://github.com/stretchr/testify>) from 1.8.2 to 1.8.3.
- [Release notes](<https://github.com/stretchr/testify/releases>)
- [Commits]([stretchr/testify@v1.8.2...v1.8.3](https://github.com/stretchr/testify/compare/v1.8.2...v1.8.3))

---
updated-dependencies:
- dependency-name: github.com/stretchr/testify
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* chore(deps): bump github.com/onsi/gomega from 1.27.6 to 1.27.7 ([#7239](https://github.com/kyverno/kyverno/pull/7239))

Bumps [github.com/onsi/gomega](<https://github.com/onsi/gomega>) from 1.27.6 to 1.27.7.
- [Release notes](<https://github.com/onsi/gomega/releases>)
- [Changelog](<https://github.com/onsi/gomega/blob/master/CHANGELOG.md>)
- [Commits]([onsi/gomega@v1.27.6...v1.27.7](https://github.com/onsi/gomega/compare/v1.27.6...v1.27.7))

---
updated-dependencies:
- dependency-name: github.com/onsi/gomega
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* chore(deps): bump k8s.io/kube-aggregator from 0.27.1 to 0.27.2 ([#7241](https://github.com/kyverno/kyverno/pull/7241))

Bumps [k8s.io/kube-aggregator](<https://github.com/kubernetes/kube-aggregator>) from 0.27.1 to 0.27.2.
- [Commits]([kubernetes/kube-aggregator@v0.27.1...v0.27.2](https://github.com/kubernetes/kube-aggregator/compare/v0.27.1...v0.27.2))

---
updated-dependencies:
- dependency-name: k8s.io/kube-aggregator
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* chore(deps): bump k8s.io/apiextensions-apiserver from 0.27.1 to 0.27.2 ([#7242](https://github.com/kyverno/kyverno/pull/7242))

Bumps [k8s.io/apiextensions-apiserver](<https://github.com/kubernetes/apiextensions-apiserver>) from 0.27.1 to 0.27.2.
- [Release notes](<https://github.com/kubernetes/apiextensions-apiserver/releases>)
- [Commits]([kubernetes/apiextensions-apiserver@v0.27.1...v0.27.2](https://github.com/kubernetes/apiextensions-apiserver/compare/v0.27.1...v0.27.2))

---
updated-dependencies:
- dependency-name: k8s.io/apiextensions-apiserver
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* updated kuttl tests

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* fixed mistake in assert

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* quote image in error ([#7259](https://github.com/kyverno/kyverno/pull/7259))

Signed-off-by: bakito <github@bakito.ch>

* fix: auto update webhooks not configuring fail endpoint ([#7261](https://github.com/kyverno/kyverno/pull/7261))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* fix latest version check ([#7263](https://github.com/kyverno/kyverno/pull/7263))

Signed-off-by: ShutingZhao <shuting@nirmata.com>

* chore(deps): bump svenstaro/upload-release-action from 2.5.0 to 2.6.0 ([#7270](https://github.com/kyverno/kyverno/pull/7270))

Bumps [svenstaro/upload-release-action](<https://github.com/svenstaro/upload-release-action>) from 2.5.0 to 2.6.0.
- [Release notes](<https://github.com/svenstaro/upload-release-action/releases>)
- [Changelog](<https://github.com/svenstaro/upload-release-action/blob/master/CHANGELOG.md>)
- [Commits]([svenstaro/upload-release-action@7319e47...58d5258](https://github.com/svenstaro/upload-release-action/compare/7319e4733ec7a184d739a6f412c40ffc339b69c7...58d525808845e4c8ff229ea1d5d7c496504a79bc))

---
updated-dependencies:
- dependency-name: svenstaro/upload-release-action
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* chore(deps): bump sigs.k8s.io/controller-runtime from 0.14.6 to 0.15.0 ([#7272](https://github.com/kyverno/kyverno/pull/7272))

Bumps [sigs.k8s.io/controller-runtime](<https://github.com/kubernetes-sigs/controller-runtime>) from 0.14.6 to 0.15.0.
- [Release notes](<https://github.com/kubernetes-sigs/controller-runtime/releases>)
- [Changelog](<https://github.com/kubernetes-sigs/controller-runtime/blob/main/RELEASE.md>)
- [Commits]([kubernetes-sigs/controller-runtime@v0.14.6...v0.15.0](https://github.com/kubernetes-sigs/controller-runtime/compare/v0.14.6...v0.15.0))

---
updated-dependencies:
- dependency-name: sigs.k8s.io/controller-runtime
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* feat: add yaml util to check empty document ([#7276](https://github.com/kyverno/kyverno/pull/7276))

Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>

* chore(deps): bump github.com/go-git/go-git/v5 from 5.6.1 to 5.7.0 ([#7274](https://github.com/kyverno/kyverno/pull/7274))

Bumps [github.com/go-git/go-git/v5](<https://github.com/go-git/go-git>) from 5.6.1 to 5.7.0.
- [Release notes](<https://github.com/go-git/go-git/releases>)
- [Commits]([go-git/go-git@v5.6.1...v5.7.0](https://github.com/go-git/go-git/compare/v5.6.1...v5.7.0))

---
updated-dependencies:
- dependency-name: github.com/go-git/go-git/v5
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>

* fixed api version in kuttl tests

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* updated kuttl tests

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* go sum update

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* updated admission controller assert

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* updated image

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* removed admission controller changes

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* go mod fix

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

---------

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>
Signed-off-by: Jim Bugwadia <jim@nirmata.com>
Signed-off-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>
Signed-off-by: ShutingZhao <shuting@nirmata.com>
Signed-off-by: Chip Zoller <chipzoller@gmail.com>
Signed-off-by: dependabot[bot] <support@github.com>
Signed-off-by: MdSahil-oss <Mohdssahil1@gmail.com>
Signed-off-by: Gus Parvin <gparvin@redhat.com>
Signed-off-by: Raul Garcia Sanchez <info@raulgarcia.de>
Signed-off-by: Mariam Fahmy <mariamfahmy66@gmail.com>
Signed-off-by: Ved Ratan <vedratan8@gmail.com>
Signed-off-by: bakito <github@bakito.ch>
Co-authored-by: Jim Bugwadia <jim@nirmata.com>
Co-authored-by: Charles-Edouard Brétéché <charles.edouard@nirmata.com>
Co-authored-by: shuting <shuting@nirmata.com>
Co-authored-by: Chip Zoller <chipzoller@gmail.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Md Sahil <85174511+MdSahil-oss@users.noreply.github.com>
Co-authored-by: Gus Parvin <gparvin@redhat.com>
Co-authored-by: Raúl Garcia Sanchez <info@raulgarcia.de>
Co-authored-by: Mariam Fahmy <55502281+MariamFahmy98@users.noreply.github.com>
Co-authored-by: Ved Ratan <82467006+VedRatan@users.noreply.github.com>
Co-authored-by: Marc Brugger <github@bakito.ch>
```

* Loading branch information

[![@vishal-chdhry](https://avatars.githubusercontent.com/u/72007651?s=40&v=4)](/vishal-chdhry) [![@JimBugwadia](https://avatars.githubusercontent.com/u/5489990?s=40&v=4)](/JimBugwadia)
[![@eddycharly](https://avatars.githubusercontent.com/u/47974576?s=40&v=4)](/eddycharly) [![@realshuting](https://avatars.githubusercontent.com/u/25727662?s=40&v=4)](/realshuting) [![@chipzoller](https://avatars.githubusercontent.com/u/29008123?s=40&v=4)](/chipzoller) [![@dependabot](https://avatars.githubusercontent.com/in/29110?s=40&v=4)](/apps/dependabot) [![@MdSahil-oss](https://avatars.githubusercontent.com/u/85174511?s=40&v=4)](/MdSahil-oss) [![@gparvin](https://avatars.githubusercontent.com/u/16925714?s=40&v=4)](/gparvin) [![@rgarcia89](https://avatars.githubusercontent.com/u/4134730?s=40&v=4)](/rgarcia89) [![@MariamFahmy98](https://avatars.githubusercontent.com/u/55502281?s=40&v=4)](/MariamFahmy98) [![@VedRatan](https://avatars.githubusercontent.com/u/82467006?s=40&v=4)](/VedRatan) [![@bakito](https://avatars.githubusercontent.com/u/2733215?s=40&v=4)](/bakito)

12 people

authored
Jun 1, 2023

1 parent
[d9359b7](/kyverno/kyverno/commit/d9359b7896309a883004c484562d4399ef8c242d)

commit 80d139b

 Show file tree

 Hide file tree

Showing
**37 changed files**
with
**1,235 additions**
and
**429 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* api/kyverno

  + v1

    - api/kyverno/v1/image\_verification\_types.go
      [image\_verification\_types.go](#diff-1fddc4e1393ac2e8bc54a080c1f43e856f9918aec60ae21697a6753cb5e25a6f)
  + v2beta1

    - api/kyverno/v2beta1/image\_verification\_types.go
      [image\_verification\_types.go](#diff-0cb9b4dd9af38932704743d2c1ea0c63bb66f120916014774b710510fd0db7e2)
* charts/kyverno/templates/crds

  + charts/kyverno/templates/crds/crds.yaml
    [crds.yaml](#diff-ecced6446ed62f16bed9f8d030f158600d440cc03a1e40368040884b8cd747e2)
* config

  + crds

    - config/crds/kyverno.io\_clusterpolicies.yaml
      [kyverno.io\_clusterpolicies.yaml](#diff-6200fb7d37ca6e8d2d67e43a3c6ee13925fb7cb7d5c5033cb118deda6a8a92a5)
    - config/crds/kyverno.io\_policies.yaml
      [kyverno.io\_policies.yaml](#diff-867aff378a538405203a18d4491f89ea68a88cf5a14bf2a23886afa1b5df95c4)
  + config/install-latest-testing.yaml
    [install-latest-testing.yaml](#diff-99de4270e7c84c401b489f2044869ac835a55eb7dfe72df026e32c08dd56295e)
* docs/user/crd

  + docs/user/crd/index.html
    [index.html](#diff-3710673fe2fe8004050562402b05ad25336c4cc8c3cdffd1bce11b5825a2a923)
* go.mod
  [go.mod](#diff-33ef32bf6c23acb95f5902d7097b7a1d5128ca061167ec0716715b0b9eeaa5f6)
* go.sum
  [go.sum](#diff-3295df7234525439d778f1b282d146a4f1ff6b415248aaac074e8042d9f42d63)
* pkg

  + cosign

    - pkg/cosign/cosign.go
      [cosign.go](#diff-19f451f34e955fe33fac7e12f3099cc5eb3b05252fc467109736696b3e971265)
  + engine

    - api

      * pkg/engine/api/context.go
        [context.go](#diff-a9633b387fbac99f6113eb05f216397cfad58a9a0b6d174f030a2c5d9ba1f534)
    - handlers/mutation

      * pkg/engine/handlers/mutation/mutate\_image.go
        [mutate\_image.go](#diff-c1946aa1e99d55d5b675fb809fb48a4b00bc7e0e0a3fa9dd122f0d7aa49d952a)
    - internal

      * pkg/engine/internal/imageverifier.go
        [imageverifier.go](#diff-4e334a7b5c4dc63f280d7a0e49015d54a381c6445fdc4db8065cc9c9d330e255)
  + images

    - pkg/images/verifier.go
      [verifier.go](#diff-cbd767f0d28f6bbf2d16fcc1a83d165fed213f030f0bc813c0f9e599d5e42743)
  + notary

    - pkg/notary/notary.go
      [notary.go](#diff-8da9134d5a9233fc2370b7fa5b98c0af29d35e241e82e5f38b194ca62baed15f)
    - pkg/notary/notary\_test.go
      [notary\_test.go](#diff-1629a8b1c649d02e53c435f5d1de029f5bab8c1f57dccd3ec65a86d34b0780f2)
    - pkg/notary/registry.go
      [registry.go](#diff-ed1f49f87387050093780e523af8095a2a7a4e9f18040a8607ca0429078e7a62)
    - pkg/notary/repository.go
      [repository.go](#diff-b104961b2a67897fb927fe9b7aa77d93e839c0492bb3a522acc27196a67d3461)
    - pkg/notary/truststore.go
      [truststore.go](#diff-92b4773f942586c72518ab8168d9672d0d01859d6b9a0282856430acbb3357b6)
  + notaryv2

    - pkg/notaryv2/notaryv2.go
      [notaryv2.go](#diff-bdd342a72d48cf895eb589f97fb7be599d755ca67b8b12c6289808a720b81093)
    - pkg/notaryv2/registry.go
      [registry.go](#diff-4e21014239be6fbc9afe51d5cc6a63b40569e457d4c3ec1adb981de4a152a532)
  + validation/policy

    - pkg/validation/policy/validate.go
      [validate.go](#diff-66e2d511769cf3024f31cf5300cf38f1582f22ac4896452b8c63c57de8933f00)
* test/conformance/kuttl

  + flags/standard/emit-events

    - test/conformance/kuttl/flags/standard/emit-events/admission-controller-assert.yaml
      [admission-controller-assert.yaml](#diff-b15b5b84ffb85780d6544acd0301cfd3f7fc9bed47cb4823bca8bde31681dcc7)
  + verifyImages/clusterpolicy/standard

    - notary-attestation-verification

      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-attestation-verification/01-policy.yaml
        [01-policy.yaml](#diff-4b8675e5b4d7d8760e069069c0758c45ddb11ea8302aa594dca2fd0805391681)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-attestation-verification/02-resource.yaml
        [02-resource.yaml](#diff-3524c9d145bf0285152f100422033220dd555c332a224e47472b472122ff9451)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-attestation-verification/README.md
        [README.md](#diff-d1048d4fb69c5abe98d185841148b250e8c0d9085057b56ce7e85e9d53f2fe13)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-attestation-verification/pod-assert.yaml
        [pod-assert.yaml](#diff-957ef68c98ea5d75ea834bf5ef6724cf4d63d17068589048fcb4421e330ffdf7)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-attestation-verification/pod.yaml
        [pod.yaml](#diff-00bdf5326d8b43fc6e1649ddf1b638f8dc43aa29ba109e859dfa7d7d000c4479)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-attestation-verification/policy-ready.yaml
        [policy-ready.yaml](#diff-e31e2b5588e36badc5f2012da030db1cd52fcc899d536677170f50d01dd8939e)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-attestation-verification/policy.yaml
        [policy.yaml](#diff-c44b5f8311238ebd3cae8965f48aaf52caa914129e72fa290ecbc01f45bef957)
    - notary-image-verification

      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-image-verification/01-policy.yaml
        [01-policy.yaml](#diff-bebb92ed57d35159bc3db0340e16fbdd4d2b123962486597413692be9f3fa985)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-image-verification/02-resource.yaml
        [02-resource.yaml](#diff-2102b2f77af73ebf38736c033089749c690a5eda2fb957b76eadec4b7eeb5774)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-image-verification/README.md
        [README.md](#diff-dfe93f37d4d9090127dc25210b3abc58de0fe944b26f4c2aafe204ddc1360e8d)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-image-verification/pod-assert.yaml
        [pod-assert.yaml](#diff-11ba064165f639affb92e3043b777970d23e71862b3265ca8df4b7f19cd41412)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-image-verification/pod.yaml
        [pod.yaml](#diff-6e402acb15d8cd9871633d172814e3e32fdd83557fecc771c608395283c5af62)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-image-verification/policy-ready.yaml
        [policy-ready.yaml](#diff-a6e1f39df1e589f5f75e913108200a6ef7311b5bca9a2283377b5ee42aafa12f)
      * test/conformance/kuttl/verifyImages/clusterpolicy/standard/notary-image-verification/policy.yaml
        [policy.yaml](#diff-a59ee29508f614b8707973ec11fc784b10d26f00752c22617fab3aca08c93c63)

## There are no files selected for viewing

28 changes: 23 additions & 5 deletions

28
[api/kyverno/v1/image\_verification\_types.go](#diff-1fddc4e1393ac2e8bc54a080c1f43e856f9918aec60ae21697a6753cb5e25a6f "api/kyverno/v1/image_verification_types.go")

Show comments

[View file](/kyverno/kyverno/blob/80d139bb5d1d9d7e907abe851b97dc73821a5be2/api/kyverno/v1/image_verification_types.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,21 +9,21 @@ import ( |
|  |  | ) |
|  |  |  |
|  |  | // ImageVerificationType selects the type of verification algorithm |
|  |  | // +kubebuilder:validation:Enum=Cosign;NotaryV2 |
|  |  | // +kubebuilder:validation:Enum=Cosign;Notary |
|  |  | // +kubebuilder:default=Cosign |
|  |  | type ImageVerificationType string |
|  |  |  |
|  |  | const ( |
|  |  | Cosign  ImageVerificationType = "Cosign" |
|  |  | NotaryV2 ImageVerificationType = "NotaryV2" |
|  |  | Cosign ImageVerificationType = "Cosign" |
|  |  | Notary ImageVerificationType = "Notary" |
|  |  | ) |
|  |  |  |
|  |  | // ImageVerification validates that images that match the specified pattern |
|  |  | // are signed with the supplied public key. Once the image is verified it is |
|  |  | // mutated to include the SHA digest retrieved during the registration. |
|  |  | type ImageVerification struct { |
|  |  | // Type specifies the method of signature validation. The allowed options |
|  |  | // are Cosign and NotaryV2. By default Cosign is used if a type is not specified. |
|  |  | // are Cosign and Notary. By default Cosign is used if a type is not specified. |
|  |  | // +kubebuilder:validation:Optional |
|  |  | Type ImageVerificationType `json:"type,omitempty" yaml:"type,omitempty"` |
|  |  |  |
| Expand Down  Expand Up | | @@ -236,9 +236,14 @@ type CTLog struct { |
|  |  | // OCI registry and decodes them into a list of Statements. |
|  |  | type Attestation struct { |
|  |  | // PredicateType defines the type of Predicate contained within the Statement. |
|  |  | // +kubebuilder:validation:Required |
|  |  | // Deprecated in favour of 'Type', to be removed soon |
|  |  | // +kubebuilder:validation:Optional |
|  |  | PredicateType string `json:"predicateType" yaml:"predicateType"` |
|  |  |  |
|  |  | // Type defines the type of attestation contained within the Statement. |
|  |  | // +kubebuilder:validation:Optional |
|  |  | Type string `json:"type" yaml:"type"` |
|  |  |  |
|  |  | // Attestors specify the required attestors (i.e. authorities) |
|  |  | // +kubebuilder:validation:Optional |
|  |  | Attestors []AttestorSet `json:"attestors" yaml:"attestors"` |
| Expand Down  Expand Up | | @@ -281,6 +286,19 @@ func (iv \*ImageVerification) Validate(isAuditFailureAction bool, path \*field.Pat |
|  |  | errs = append(errs, attestorErrors...) |
|  |  | } |
|  |  |  |
|  |  | if iv.Type == Notary { |
|  |  | for \_, attestorSet := range iv.Attestors { |
|  |  | for \_, attestor := range attestorSet.Entries { |
|  |  | if attestor.Keyless != nil { |
|  |  | errs = append(errs, field.Invalid(attestorsPath, iv, "Keyless field is not allowed for type notary")) |
|  |  | } |
|  |  | if attestor.Keys != nil { |
|  |  | errs = append(errs, field.Invalid(attestorsPath, iv, "Keys field is not allowed for type notary")) |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return errs |
|  |  | } |
|  |  |  |
| Expand Down | |  |

21 changes: 17 additions & 4 deletions

21
[api/kyverno/v2beta1/image\_verification\_types.go](#diff-0cb9b4dd9af38932704743d2c1ea0c63bb66f120916014774b710510fd0db7e2 "api/kyverno/v2beta1/image_verification_types.go")

Show comments

[View file](/kyverno/kyverno/blob/80d139bb5d1d9d7e907abe851b97dc73821a5be2/api/kyverno/v2beta1/image_verification_types.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,21 +6,21 @@ import ( |
|  |  | ) |
|  |  |  |
|  |  | // ImageVerificationType selects the type of verification algorithm |
|  |  | // +kubebuilder:validation:Enum=Cosign;NotaryV2 |
|  |  | // +kubebuilder:validation:Enum=Cosign;Notary |
|  |  | // +kubebuilder:default=Cosign |
|  |  | type ImageVerificationType string |
|  |  |  |
|  |  | const ( |
|  |  | Cosign  ImageVerificationType = "Cosign" |
|  |  | NotaryV2 ImageVerificationType = "NotaryV2" |
|  |  | Cosign ImageVerificationType = "Cosign" |
|  |  | Notary ImageVerificationType = "Notary" |
|  |  | ) |
|  |  |  |
|  |  | // ImageVerification validates that images that match the specified pattern |
|  |  | // are signed with the supplied public key. Once the image is verified it is |
|  |  | // mutated to include the SHA digest retrieved during the registration. |
|  |  | type ImageVerification struct { |
|  |  | // Type specifies the method of signature validation. The allowed options |
|  |  | // are Cosign and NotaryV2. By default Cosign is used if a type is not specified. |
|  |  | // are Cosign and Notary. By default Cosign is used if a type is not specified. |
|  |  | // +kubebuilder:validation:Optional |
|  |  | Type ImageVerificationType `json:"type,omitempty" yaml:"type,omitempty"` |
|  |  |  |
| Expand Down  Expand Up | | @@ -86,5 +86,18 @@ func (iv \*ImageVerification) Validate(isAuditFailureAction bool, path \*field.Pat |
|  |  | errs = append(errs, attestorErrors...) |
|  |  | } |
|  |  |  |
|  |  | if iv.Type == Notary { |
|  |  | for \_, attestorSet := range iv.Attestors { |
|  |  | for \_, attestor := range attestorSet.Entries { |
|  |  | if attestor.Keyless != nil { |
|  |  | errs = append(errs, field.Invalid(attestorsPath, iv, "Keyless field is not allowed for type notary")) |
|  |  | } |
|  |  | if attestor.Keys != nil { |
|  |  | errs = append(errs, field.Invalid(attestorsPath, iv, "Keys field is not allowed for type notary")) |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return errs |
|  |  | } |

92 changes: 60 additions & 32 deletions

92
[charts/kyverno/templates/crds/crds.yaml](#diff-ecced6446ed62f16bed9f8d030f158600d440cc03a1e40368040884b8cd747e2 "charts/kyverno/templates/crds/crds.yaml")

Show comments

[View file](/kyverno/kyverno/blob/80d139bb5d1d9d7e907abe851b97dc73821a5be2/charts/kyverno/templates/crds/crds.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7248,10 +7248,13 @@ spec: |
|  |  | type: array |
|  |  | predicateType: |
|  |  | description: PredicateType defines the type of Predicate |
|  |  | contained within the Statement. Deprecated in |
|  |  | favour of 'Type', to be removed soon |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type defines the type of attestation |
|  |  | contained within the Statement. |
|  |  | type: string |
|  |  | required: |
|  |  | - predicateType |
|  |  | type: object |
|  |  | type: array |
|  |  | attestors: |
| Expand Down  Expand Up | | @@ -7499,11 +7502,11 @@ spec: |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type specifies the method of signature validation. |
|  |  | The allowed options are Cosign and NotaryV2. By default |
|  |  | The allowed options are Cosign and Notary. By default |
|  |  | Cosign is used if a type is not specified. |
|  |  | enum: |
|  |  | - Cosign |
|  |  | - NotaryV2 |
|  |  | - Notary |
|  |  | type: string |
|  |  | verifyDigest: |
|  |  | default: true |
| Expand Down  Expand Up | | @@ -11153,9 +11156,13 @@ spec: |
|  |  | predicateType: |
|  |  | description: PredicateType defines the type |
|  |  | of Predicate contained within the Statement. |
|  |  | Deprecated in favour of 'Type', to be removed |
|  |  | soon |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type defines the type of attestation |
|  |  | contained within the Statement. |
|  |  | type: string |
|  |  | required: |
|  |  | - predicateType |
|  |  | type: object |
|  |  | type: array |
|  |  | attestors: |
| Expand Down  Expand Up | | @@ -11412,11 +11419,11 @@ spec: |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type specifies the method of signature |
|  |  | validation. The allowed options are Cosign and NotaryV2. |
|  |  | validation. The allowed options are Cosign and Notary. |
|  |  | By default Cosign is used if a type is not specified. |
|  |  | enum: |
|  |  | - Cosign |
|  |  | - NotaryV2 |
|  |  | - Notary |
|  |  | type: string |
|  |  | verifyDigest: |
|  |  | default: true |
| Expand Down  Expand Up | | @@ -14748,10 +14755,13 @@ spec: |
|  |  | type: array |
|  |  | predicateType: |
|  |  | description: PredicateType defines the type of Predicate |
|  |  | contained within the Statement. Deprecated in |
|  |  | favour of 'Type', to be removed soon |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type defines the type of attestation |
|  |  | contained within the Statement. |
|  |  | type: string |
|  |  | required: |
|  |  | - predicateType |
|  |  | type: object |
|  |  | type: array |
|  |  | attestors: |
| Expand Down  Expand Up | | @@ -14974,11 +14984,11 @@ spec: |
|  |  | type: boolean |
|  |  | type: |
|  |  | description: Type specifies the method of signature validation. |
|  |  | The allowed options are Cosign and NotaryV2. By default |
|  |  | The allowed options are Cosign and Notary. By default |
|  |  | Cosign is used if a type is not specified. |
|  |  | enum: |
|  |  | - Cosign |
|  |  | - NotaryV2 |
|  |  | - Notary |
|  |  | type: string |
|  |  | verifyDigest: |
|  |  | default: true |
| Expand Down  Expand Up | | @@ -18628,9 +18638,13 @@ spec: |
|  |  | predicateType: |
|  |  | description: PredicateType defines the type |
|  |  | of Predicate contained within the Statement. |
|  |  | Deprecated in favour of 'Type', to be removed |
|  |  | soon |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type defines the type of attestation |
|  |  | contained within the Statement. |
|  |  | type: string |
|  |  | required: |
|  |  | - predicateType |
|  |  | type: object |
|  |  | type: array |
|  |  | attestors: |
| Expand Down  Expand Up | | @@ -18887,11 +18901,11 @@ spec: |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type specifies the method of signature |
|  |  | validation. The allowed options are Cosign and NotaryV2. |
|  |  | validation. The allowed options are Cosign and Notary. |
|  |  | By default Cosign is used if a type is not specified. |
|  |  | enum: |
|  |  | - Cosign |
|  |  | - NotaryV2 |
|  |  | - Notary |
|  |  | type: string |
|  |  | verifyDigest: |
|  |  | default: true |
| Expand Down  Expand Up | | @@ -22509,10 +22523,13 @@ spec: |
|  |  | type: array |
|  |  | predicateType: |
|  |  | description: PredicateType defines the type of Predicate |
|  |  | contained within the Statement. Deprecated in |
|  |  | favour of 'Type', to be removed soon |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type defines the type of attestation |
|  |  | contained within the Statement. |
|  |  | type: string |
|  |  | required: |
|  |  | - predicateType |
|  |  | type: object |
|  |  | type: array |
|  |  | attestors: |
| Expand Down  Expand Up | | @@ -22760,11 +22777,11 @@ spec: |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type specifies the method of signature validation. |
|  |  | The allowed options are Cosign and NotaryV2. By default |
|  |  | The allowed options are Cosign and Notary. By default |
|  |  | Cosign is used if a type is not specified. |
|  |  | enum: |
|  |  | - Cosign |
|  |  | - NotaryV2 |
|  |  | - Notary |
|  |  | type: string |
|  |  | verifyDigest: |
|  |  | default: true |
| Expand Down  Expand Up | | @@ -26415,9 +26432,13 @@ spec: |
|  |  | predicateType: |
|  |  | description: PredicateType defines the type |
|  |  | of Predicate contained within the Statement. |
|  |  | Deprecated in favour of 'Type', to be removed |
|  |  | soon |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type defines the type of attestation |
|  |  | contained within the Statement. |
|  |  | type: string |
|  |  | required: |
|  |  | - predicateType |
|  |  | type: object |
|  |  | type: array |
|  |  | attestors: |
| Expand Down  Expand Up | | @@ -26674,11 +26695,11 @@ spec: |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type specifies the method of signature |
|  |  | validation. The allowed options are Cosign and NotaryV2. |
|  |  | validation. The allowed options are Cosign and Notary. |
|  |  | By default Cosign is used if a type is not specified. |
|  |  | enum: |
|  |  | - Cosign |
|  |  | - NotaryV2 |
|  |  | - Notary |
|  |  | type: string |
|  |  | verifyDigest: |
|  |  | default: true |
| Expand Down  Expand Up | | @@ -30011,10 +30032,13 @@ spec: |
|  |  | type: array |
|  |  | predicateType: |
|  |  | description: PredicateType defines the type of Predicate |
|  |  | contained within the Statement. Deprecated in |
|  |  | favour of 'Type', to be removed soon |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type defines the type of attestation |
|  |  | contained within the Statement. |
|  |  | type: string |
|  |  | required: |
|  |  | - predicateType |
|  |  | type: object |
|  |  | type: array |
|  |  | attestors: |
| Expand Down  Expand Up | | @@ -30237,11 +30261,11 @@ spec: |
|  |  | type: boolean |
|  |  | type: |
|  |  | description: Type specifies the method of signature validation. |
|  |  | The allowed options are Cosign and NotaryV2. By default |
|  |  | The allowed options are Cosign and Notary. By default |
|  |  | Cosign is used if a type is not specified. |
|  |  | enum: |
|  |  | - Cosign |
|  |  | - NotaryV2 |
|  |  | - Notary |
|  |  | type: string |
|  |  | verifyDigest: |
|  |  | default: true |
| Expand Down  Expand Up | | @@ -33891,9 +33915,13 @@ spec: |
|  |  | predicateType: |
|  |  | description: PredicateType defines the type |
|  |  | of Predicate contained within the Statement. |
|  |  | Deprecated in favour of 'Type', to be removed |
|  |  | soon |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type defines the type of attestation |
|  |  | contained within the Statement. |
|  |  | type: string |
|  |  | required: |
|  |  | - predicateType |
|  |  | type: object |
|  |  | type: array |
|  |  | attestors: |
| Expand Down  Expand Up | | @@ -34150,11 +34178,11 @@ spec: |
|  |  | type: string |
|  |  | type: |
|  |  | description: Type specifies the method of signature |
|  |  | validation. The allowed options are Cosign and NotaryV2. |
|  |  | validation. The allowed options are Cosign and Notary. |
|  |  | By default Cosign is used if a type is not specified. |
|  |  | enum: |
|  |  | - Cosign |
|  |  | - NotaryV2 |
|  |  | - Notary |
|  |  | type: string |
|  |  | verifyDigest: |
|  |  | default: true |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `80d139b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkyverno%2Fkyverno%2Fcommit%2F80d139bb5d1d9d7e907abe851b97dc73821a5be2) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_72418428_20250115_095140.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkyverno%2Fkyverno%2Fcommit%2Ffec2992e3f9fcd6b9c62267522c09b182e7df73b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkyverno%2Fkyverno%2Fcommit%2Ffec2992e3f9fcd6b9c62267522c09b182e7df73b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=kyverno%2Fkyverno)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kyverno](/kyverno)
/
**[kyverno](/kyverno/kyverno)**
Public

* [Notifications](/login?return_to=%2Fkyverno%2Fkyverno) You must be signed in to change notification settings
* [Fork
  918](/login?return_to=%2Fkyverno%2Fkyverno)
* [Star
   5.9k](/login?return_to=%2Fkyverno%2Fkyverno)

* [Code](/kyverno/kyverno)
* [Issues
  278](/kyverno/kyverno/issues)
* [Pull requests
  55](/kyverno/kyverno/pulls)
* [Discussions](/kyverno/kyverno/discussions)
* [Actions](/kyverno/kyverno/actions)
* [Projects
  2](/kyverno/kyverno/projects)
* [Wiki](/kyverno/kyverno/wiki)
* [Security](/kyverno/kyverno/security)
* [Insights](/kyverno/kyverno/pulse)

Additional navigation options

* [Code](/kyverno/kyverno)
* [Issues](/kyverno/kyverno/issues)
* [Pull requests](/kyverno/kyverno/pulls)
* [Discussions](/kyverno/kyverno/discussions)
* [Actions](/kyverno/kyverno/actions)
* [Projects](/kyverno/kyverno/projects)
* [Wiki](/kyverno/kyverno/wiki)
* [Security](/kyverno/kyverno/security)
* [Insights](/kyverno/kyverno/pulse)

## Commit

[Permalink](/kyverno/kyverno/commit/fec2992e3f9fcd6b9c62267522c09b182e7df73b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: address vulnerability issues in notary implementations ([#8428](https://github.com/kyverno/kyverno/pull/8428))

[Browse files](/kyverno/kyverno/tree/fec2992e3f9fcd6b9c62267522c09b182e7df73b)
Browse the repository at this point in the history

```
* fix: set max limit on referrers count

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* feat: add limit to max size of payload

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* feat: add max count limit on listsignatures

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

* feat: add max signature size limit in FetchSignatureBlob

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>

---------

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>
Co-authored-by: shuting <shuting@nirmata.com>
```

* Loading branch information

[![@vishal-chdhry](https://avatars.githubusercontent.com/u/72007651?s=40&v=4)](/vishal-chdhry) [![@realshuting](https://avatars.githubusercontent.com/u/25727662?s=40&v=4)](/realshuting)

[vishal-chdhry](/kyverno/kyverno/commits?author=vishal-chdhry "View all commits by vishal-chdhry")
and
[realshuting](/kyverno/kyverno/commits?author=realshuting "View all commits by realshuting")
authored
Sep 18, 2023

1 parent
[cef9a7a](/kyverno/kyverno/commit/cef9a7a3d00aab33004769c818422949c03d2521)

commit fec2992

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**25 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* pkg/notary

  + pkg/notary/notary.go
    [notary.go](#diff-8da9134d5a9233fc2370b7fa5b98c0af29d35e241e82e5f38b194ca62baed15f)
  + pkg/notary/repository.go
    [repository.go](#diff-b104961b2a67897fb927fe9b7aa77d93e839c0492bb3a522acc27196a67d3461)

## There are no files selected for viewing

15 changes: 15 additions & 0 deletions

15
[pkg/notary/notary.go](#diff-8da9134d5a9233fc2370b7fa5b98c0af29d35e241e82e5f38b194ca62baed15f "pkg/notary/notary.go")

Show comments

[View file](/kyverno/kyverno/blob/fec2992e3f9fcd6b9c62267522c09b182e7df73b/pkg/notary/notary.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,6 +24,11 @@ import ( |
|  |  | "go.uber.org/multierr" |
|  |  | ) |
|  |  |  |
|  |  | var ( |
|  |  | maxReferrersCount = 50 |
|  |  | maxPayloadSize = 10 \* 1000 \* 1000 // 10 MB |
|  |  | ) |
|  |  |  |
|  |  | func NewVerifier() images.ImageVerifier { |
|  |  | return &notaryVerifier{ |
|  |  | log: logging.WithName("Notary"), |
| Expand Down  Expand Up | | @@ -162,6 +167,11 @@ func (v \*notaryVerifier) FetchAttestations(ctx context.Context, opts images.Opti |
|  |  | return nil, err |
|  |  | } |
|  |  |  |
|  |  | // See: https://github.com/kyverno/kyverno/security/advisories/GHSA-9g37-h7p2-2c6r |
|  |  | if len(referrersDescs.Manifests) > maxReferrersCount { |
|  |  | return nil, fmt.Errorf("failed to fetch referrers: to many referrers found, max limit is %d", maxReferrersCount) |
|  |  | } |
|  |  |  |
|  |  | v.log.V(4).Info("fetched referrers", "referrers", referrersDescs) |
|  |  |  |
|  |  | var statements []map[string]interface{} |
| Expand Down  Expand Up | | @@ -308,6 +318,11 @@ func extractStatement(ctx context.Context, repoRef name.Reference, desc v1.Descr |
|  |  | } |
|  |  | predicateDesc := manifest.Layers[0] |
|  |  |  |
|  |  | // See: https://github.com/kyverno/kyverno/security/advisories/GHSA-wc3x-5rfv-hh5v |
|  |  | if predicateDesc.Size > int64(maxPayloadSize) { |
|  |  | return nil, fmt.Errorf("payload size is too large, max size is %d: %+v", maxPayloadSize, predicateDesc) |
|  |  | } |
|  |  |  |
|  |  | layer, err := gcrremote.Layer(ref.Context().Digest(predicateDesc.Digest.String()), remoteOpts...) |
|  |  | if err != nil { |
|  |  | return nil, err |
| Expand Down | |  |

10 changes: 10 additions & 0 deletions

10
[pkg/notary/repository.go](#diff-b104961b2a67897fb927fe9b7aa77d93e839c0492bb3a522acc27196a67d3461 "pkg/notary/repository.go")

Show comments

[View file](/kyverno/kyverno/blob/fec2992e3f9fcd6b9c62267522c09b182e7df73b/pkg/notary/repository.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -50,6 +50,11 @@ func (c \*repositoryClient) ListSignatures(ctx context.Context, desc ocispec.Desc |
|  |  | return err |
|  |  | } |
|  |  |  |
|  |  | // See: https://github.com/kyverno/kyverno/security/advisories/GHSA-hjpv-68f4-2262 |
|  |  | if len(referrersDescs.Manifests) > maxReferrersCount { |
|  |  | return fmt.Errorf("failed to fetch referrers: to many referrers found, max limit is %d", maxReferrersCount) |
|  |  | } |
|  |  |  |
|  |  | descList := []ocispec.Descriptor{} |
|  |  | for \_, d := range referrersDescs.Manifests { |
|  |  | if d.ArtifactType == notationregistry.ArtifactTypeNotation { |
| Expand Down  Expand Up | | @@ -81,6 +86,11 @@ func (c \*repositoryClient) FetchSignatureBlob(ctx context.Context, desc ocispec. |
|  |  | } |
|  |  | manifestDesc := manifest.Layers[0] |
|  |  |  |
|  |  | // See: https://github.com/kyverno/kyverno/security/advisories/GHSA-4mp4-46gq-hv3r |
|  |  | if manifestDesc.Size > int64(maxPayloadSize) { |
|  |  | return nil, ocispec.Descriptor{}, fmt.Errorf("payload size is too large, max size is %d: %+v", maxPayloadSize, manifestDesc) |
|  |  | } |
|  |  |  |
|  |  | signatureBlobRef, err := name.ParseReference(c.getReferenceFromDescriptor(manifestDesc)) |
|  |  | if err != nil { |
|  |  | return nil, ocispec.Descriptor{}, err |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `fec2992`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkyverno%2Fkyverno%2Fcommit%2Ffec2992e3f9fcd6b9c62267522c09b182e7df73b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0113c6c5_20250115_095141.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkyverno%2Fkyverno%2Fpull%2F8428)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkyverno%2Fkyverno%2Fpull%2F8428)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=kyverno%2Fkyverno)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kyverno](/kyverno)
/
**[kyverno](/kyverno/kyverno)**
Public

* [Notifications](/login?return_to=%2Fkyverno%2Fkyverno) You must be signed in to change notification settings
* [Fork
  918](/login?return_to=%2Fkyverno%2Fkyverno)
* [Star
   5.9k](/login?return_to=%2Fkyverno%2Fkyverno)

* [Code](/kyverno/kyverno)
* [Issues
  278](/kyverno/kyverno/issues)
* [Pull requests
  55](/kyverno/kyverno/pulls)
* [Discussions](/kyverno/kyverno/discussions)
* [Actions](/kyverno/kyverno/actions)
* [Projects
  2](/kyverno/kyverno/projects)
* [Wiki](/kyverno/kyverno/wiki)
* [Security](/kyverno/kyverno/security)
* [Insights](/kyverno/kyverno/pulse)

Additional navigation options

* [Code](/kyverno/kyverno)
* [Issues](/kyverno/kyverno/issues)
* [Pull requests](/kyverno/kyverno/pulls)
* [Discussions](/kyverno/kyverno/discussions)
* [Actions](/kyverno/kyverno/actions)
* [Projects](/kyverno/kyverno/projects)
* [Wiki](/kyverno/kyverno/wiki)
* [Security](/kyverno/kyverno/security)
* [Insights](/kyverno/kyverno/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fkyverno%2Fkyverno%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fkyverno%2Fkyverno%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Check payload counts and limits for image verification data returned from registries #8428

 Merged

[realshuting](/realshuting)
merged 6 commits into
[kyverno:main](/kyverno/kyverno/tree/main "kyverno/kyverno:main")
from
[vishal-chdhry:image-verify-vulnurabilities-fix](/vishal-chdhry/kyverno/tree/image-verify-vulnurabilities-fix "vishal-chdhry/kyverno:image-verify-vulnurabilities-fix")

Sep 18, 2023

 Merged

# [Check payload counts and limits for image verification data returned from registries](#top) #8428

[realshuting](/realshuting)
merged 6 commits into
[kyverno:main](/kyverno/kyverno/tree/main "kyverno/kyverno:main")
from
[vishal-chdhry:image-verify-vulnurabilities-fix](/vishal-chdhry/kyverno/tree/image-verify-vulnurabilities-fix "vishal-chdhry/kyverno:image-verify-vulnurabilities-fix")

Sep 18, 2023

[Conversation
1](/kyverno/kyverno/pull/8428)
[Commits
6](/kyverno/kyverno/pull/8428/commits)
[Checks
0](/kyverno/kyverno/pull/8428/checks)
[Files changed](/kyverno/kyverno/pull/8428/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![vishal-chdhry](https://avatars.githubusercontent.com/u/72007651?s=60&v=4)](/vishal-chdhry)

Copy link

Member

### @vishal-chdhry **[vishal-chdhry](/vishal-chdhry)** commented [Sep 17, 2023](#issue-1899732812) • edited by JimBugwadia Loading

## Explanation

Add image registry payload sizing and count limits for signatures and attestations.

Sorry, something went wrong.

All reactions

 [vishal-chdhry](/vishal-chdhry)
added 4 commits
[September 17, 2023 15:24](#commits-pushed-e857e76)

[![@vishal-chdhry](https://avatars.githubusercontent.com/u/72007651?s=40&v=4)](/vishal-chdhry)

`[fix: set max limit on referrers count](/kyverno/kyverno/pull/8428/commits/e857e768da02f06bc529f99742f1d2f52132b943 "fix: set max limit on referrers count

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>")`
 …

`[e857e76](/kyverno/kyverno/pull/8428/commits/e857e768da02f06bc529f99742f1d2f52132b943)`

```
Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>
```

[![@vishal-chdhry](https://avatars.githubusercontent.com/u/72007651?s=40&v=4)](/vishal-chdhry)

`[feat: add limit to max size of payload](/kyverno/kyverno/pull/8428/commits/1edbc48ca41b6f651e17966e82cc0338e08ed612 "feat: add limit to max size of payload

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>")`
 …

`[1edbc48](/kyverno/kyverno/pull/8428/commits/1edbc48ca41b6f651e17966e82cc0338e08ed612)`

```
Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>
```

[![@vishal-chdhry](https://avatars.githubusercontent.com/u/72007651?s=40&v=4)](/vishal-chdhry)

`[feat: add max count limit on listsignatures](/kyverno/kyverno/pull/8428/commits/838c9a7b999aa2894d30f20bfb44280fa237e5b3 "feat: add max count limit on listsignatures

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>")`
 …

`[838c9a7](/kyverno/kyverno/pull/8428/commits/838c9a7b999aa2894d30f20bfb44280fa237e5b3)`

```
Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>
```

[![@vishal-chdhry](https://avatars.githubusercontent.com/u/72007651?s=40&v=4)](/vishal-chdhry)

`[feat: add max signature size limit in FetchSignatureBlob](/kyverno/kyverno/pull/8428/commits/a7301f9ecca7e3d3115af15c315caa77095818d4 "feat: add max signature size limit in FetchSignatureBlob

Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>")`
 …

`[a7301f9](/kyverno/kyverno/pull/8428/commits/a7301f9ecca7e3d3115af15c315caa77095818d4)`

```
Signed-off-by: Vishal Choudhary <sendtovishalchoudhary@gmail.com>
```

 [![@vishal-chdhry](https://avatars.githubusercontent.com/u/72007651?s=40&u=a36956b6746f3fe097bdf9379a49b34cbaa6379d&v=4)](/vishal-chdhry)
[vishal-chdhry](/vishal-chdhry)
requested review from
[JimBugwadia](/JimBugwadia),
[realshuting](/realshuting),
[eddycharly](/eddycharly) and
[MariamFahmy98](/MariamFahmy98)
[September 17, 2023 10:20](#event-10391136902)

[![@eddycharly](https://avatars.githubusercontent.com/u/47974576?s=80&u=654a2f377d6fea4321d54d25846e1ea6698c3e6c&v=4)](/eddycharly)

Copy link

Member

### **[eddycharly](/eddycharly)** commented [Sep 17, 2023](#issuecomment-1722458327)

| Needs labels/milestone |
| --- |

All reactions

Sorry, something went wrong.

[![@vishal-chdhry](https://avatars.githubusercontent.com/u/72007651?s=40&u=a36956b6746f3fe097bdf9379a49b34cbaa6379d&v=4)](/vishal-chdhry)
[vishal-chdhry](/vishal-chdhry)
added
the
[milestone 1.11.0](/kyverno/kyverno/labels/milestone%201.11.0)
label
[Sep 17, 2023](#event-10391930354)

[![@vishal-chdhry](https://avatars.githubusercontent.com/u/72007651?s=40&u=a36956b6746f3fe097bdf9379a49b34cbaa6379d&v=4)](/vishal-chdhry)
[vishal-chdhry](/vishal-chdhry)
added this to the [Kyverno Release 1.11.0](/kyverno/kyverno/milestone/75) milestone
[Sep 17, 2023](#event-10391930433)

[![@realshuting](https://avatars.githubusercontent.com/u/25727662?s=40&v=4)](/realshuting)

`[Merge branch 'main' into image-verify-vulnurabilities-fix](/kyverno/kyverno/pull/8428/commits/b9f71a5a54770bda459dead61849bbdee6149e2a "Merge branch 'main' into image-verify-vulnurabilities-fix")`

`[b9f71a5](/kyverno/kyverno/pull/8428/commits/b9f71a5a54770bda459dead61849bbdee6149e2a)`

[![realshuting](https://avatars.githubusercontent.com/u/25727662?s=60&v=4)](/realshuting)

**[realshuting](/realshuting)**
approved these changes
[Sep 18, 2023](#pullrequestreview-1630322570)

 [View reviewed changes](/kyverno/kyverno/pull/8428/files/3679f85cfb07b1a4d6cd15586f5f0b99515772b0)

[![@realshuting](https://avatars.githubusercontent.com/u/25727662?s=40&v=4)](/realshuting)

`[Merge branch 'main' into image-verify-vulnurabilities-fix](/kyverno/kyverno/pull/8428/commits/3679f85cfb07b1a4d6cd15586f5f0b99515772b0 "Merge branch 'main' into image-verify-vulnurabilities-fix")`

`[3679f85](/kyverno/kyverno/pull/8428/commits/3679f85cfb07b1a4d6cd15586f5f0b99515772b0)`

[![@realshuting](https://avatars.githubusercontent.com/u/25727662?s=40&u=a61f1c0029aeb7ade724eeb9e77a18c217aea86a&v=4)](/realshuting)
[realshuting](/realshuting)
merged commit [`fec2992`](/kyverno/kyverno/commit/fec2992e3f9fcd6b9c62267522c09b182e7df73b)
into
kyverno:main

[Sep 18, 2023](https://github.com/kyverno/kyverno/pull/8428#event-10394018524)

[![@JimBugwadia](https://avatars.githubusercontent.com/u/5489990?s=40&u=5cc1cd092c3ab5b0009b775a8a534fd8e84d3e40&v=4)](/JimBugwadia)
[JimBugwadia](/JimBugwadia)
changed the title
~~fix: address vulnerability issues in notary implementations~~
Check payload counts and limits for image verification data returned from registries
[Sep 18, 2023](#event-10399262123)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fkyverno%2Fkyverno%2Fpull%2F8428)

Reviewers

[![@realshuting](https://avatars.githubusercontent.com/u/25727662?s=40&v=4)](/realshuting) [realshuting](/realshuting)

realshuting approved these changes

[![@JimBugwadia](https://avatars.githubusercontent.com/u/5489990?s=40&v=4)](/JimBugwadia) [JimBugwadia](/JimBugwadia)

 Awaiting requested review from JimBugwadia

[![@eddycharly](https://avatars.githubusercontent.com/u/47974576?s=40&v=4)](/eddycharly) [eddycharly](/eddycharly)

 Awaiting requested review from eddycharly

[![@MariamFahmy98](https://avatars.githubusercontent.com/u/55502281?s=40&v=4)](/MariamFahmy98) [MariamFahmy98](/MariamFahmy98)

 Awaiting requested review from MariamFahmy98

Assignees

No one assigned

Labels

[milestone 1.11.0](/kyverno/kyverno/labels/milestone%201.11.0)

Projects

None yet

Milestone

 [**Kyverno Release 1.11.0**](/kyverno/kyverno/milestone/75 "Kyverno Release 1.11.0")

Development

Successfully merging this pull request may close these issues.

3 participants

[![@vishal-chdhry](https://avatars.githubusercontent.com/u/72007651?s=52&v=4)](/vishal-chdhry) [![@eddycharly](https://avatars.githubusercontent.com/u/47974576?s=52&v=4)](/eddycharly) [![@realshuting](https://avatars.githubusercontent.com/u/25727662?s=52&v=4)](/realshuting)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_69fe00ed_20250115_095141.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkyverno%2Fkyverno%2Fsecurity%2Fadvisories%2FGHSA-hjpv-68f4-2262)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkyverno%2Fkyverno%2Fsecurity%2Fadvisories%2FGHSA-hjpv-68f4-2262)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=kyverno%2Fkyverno)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kyverno](/kyverno)
/
**[kyverno](/kyverno/kyverno)**
Public

* [Notifications](/login?return_to=%2Fkyverno%2Fkyverno) You must be signed in to change notification settings
* [Fork
  918](/login?return_to=%2Fkyverno%2Fkyverno)
* [Star
   5.9k](/login?return_to=%2Fkyverno%2Fkyverno)

* [Code](/kyverno/kyverno)
* [Issues
  278](/kyverno/kyverno/issues)
* [Pull requests
  55](/kyverno/kyverno/pulls)
* [Discussions](/kyverno/kyverno/discussions)
* [Actions](/kyverno/kyverno/actions)
* [Projects
  2](/kyverno/kyverno/projects)
* [Wiki](/kyverno/kyverno/wiki)
* [Security](/kyverno/kyverno/security)
* [Insights](/kyverno/kyverno/pulse)

Additional navigation options

* [Code](/kyverno/kyverno)
* [Issues](/kyverno/kyverno/issues)
* [Pull requests](/kyverno/kyverno/pulls)
* [Discussions](/kyverno/kyverno/discussions)
* [Actions](/kyverno/kyverno/actions)
* [Projects](/kyverno/kyverno/projects)
* [Wiki](/kyverno/kyverno/wiki)
* [Security](/kyverno/kyverno/security)
* [Insights](/kyverno/kyverno/pulse)

# Denial of service from malicious image manifest

Low

[JimBugwadia](/JimBugwadia)
published
GHSA-hjpv-68f4-2262
Nov 13, 2023

## Package

gomod

github.com/kyverno/kyverno
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

NONE

## Patched versions

1.11.0

## Description

A security vulnerability was found in Kyverno where an attacker could cause denial of service of Kyverno. The vulnerability was in Kyvernos Notary verifier. An attacker would need control over the registry from which Kyverno would fetch signatures. With such a position, the attacker could return a malicious response to Kyverno, when Kyverno would send a request to the registry. The malicious response would cause denial of service of Kyverno, such that other users' admission requests would be blocked from being processed.

This is a vulnerability in a new component released in v1.11.0. The only users affected by this are those that have been building Kyverno from source at the main branch which is not encouraged. Users consuming official Kyverno releases are not affected. There are no known cases of this vulnerability being exploited in the wild.

The vulnerability was found during an ongoing security audit of Kyverno conducted by Ada Logics, facilitated by OSTIF and funded by the CNCF.

### Severity

Low

3.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:L

### CVE ID

CVE-2023-42815

### Weaknesses

No CWEs

### Credits

* [![@AdamKorcz](https://avatars.githubusercontent.com/u/44787359?s=40&v=4)](/AdamKorcz)
  [AdamKorcz](/AdamKorcz)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


